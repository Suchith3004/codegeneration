,Unnamed: 0,NL,Code
18349,16973,Is this possible in SQL?,"select a.claim_ID
from   TableA a, 
       TableB term, 
       TableB paid
where  a.claim_id  =  term.claim_id
and    a.claim_id  =  paid.claim_id
and    term.Claim State  = 'TERMINATED'
and    paid.Claim State  = 'PAID'
and    term.Claim_State_Start_Date >= paid.Claim_State_Start_Date
"
13367,31997,MySQL: Select first row with value in interval,"select min(num), ceiling((num + 1)/5)
from table1
where id = 1
group by ceiling((num + 1)/5);
"
37594,10474,select max version over several fields,"SELECT 
   value, version1, version2, version3
FROM (
   SELECT 
      ROW_NUMBER() OVER (
        PARTITION BY value 
        ORDER BY version1 DESC, version2 DESC, version3 DESC
      ) RN,
      value, version1, version2, version3
   FROM tableName
) T
WHERE RN = 1
"
25252,48207,Getting the most efficient query based on multiple tables/primary & foreign keys,"CREATE NONCLUSTERED INDEX yourIndexName ON yourTableName(yourFieldName)
"
8884,7889,Linq to Entities or SQL Query Diet,"int recordCount = dataContext.Names.Count(i => i.AnotherId == 1);
"
1090,5557,SQL update multiple rows with same value,"UPDATE ibf_members
SET points = points + 500
WHERE mgroup = 15
AND id IN (5, 7, 10, 11, 16, 25);
"
31005,44740,comparing date with a predefined format pl sql,"alter session set nls_date_format = 'dd-mm-yyyy'
"
39860,70053,How can I write this Query in another way,"SELECT u.firstname, u.lastname, u.username, u.alt_id, u.email, cg.group_name
FROM user u LEFT JOIN
     class_group cg
     ON find_in_set(u.id, list_students_id) > 0;
"
35320,67976,How to use case in db2 column select query,"select
  case
    when someid = 1 then date_1
    when someid = 2 then date_2
    when someid = 3 then date_3
    when someid = 4 then date_4
  end as col1
 ,case
    when someid = 1 then xdate_1
    when someid = 2 then xdate_2
    when someid = 3 then xdate_3
    when someid = 4 then xdate_4
  end as col2
from mytable;
"
21161,46237,ms-access 2003 combo box population,"WHERE Type.Category=[Forms]![1A-Event Entry]![Subform Control Name Here].Form![Category]
"
17655,30525,collapsing NULL values in Oracle query,"SELECT DISTINCT
       id,
       MAX(time_in) OVER (PARTITION BY id),
       MAX(time_out) OVER (PARTITION BY id)
FROM (...)
"
10543,33394,Php Mysql Classifieds list stuck,"SELECT m.id, m.subject
  FROM bx_ads_main m JOIN bx_ads_category_subs s 
    ON m.IDClassifiedsSubs = s.ID JOIN bx_ads_category c
    ON s.IDClassified = c.ID
 WHERE c.ID = 1
"
11511,8471,"How does CONVERT (DATETIME, FLOAT) work?","Decimal value    Time Value    Calculation 
=============    ==========    ===========
0.00094444444    12:01:00 AM   1.0 / 24 / 60 (1 day/24 hours/60 minutes per hour)
0.01041666666    12:15:00 AM   1.0 / 24 / 60 * 15
0.02083333333    12:30:00 AM   1.0 / 24 / 60 * 30
0.04166666666    01:00:00 AM   1.0 / 24
"
34497,60779,SQL sum with group by,"SELECT
    GROUPNUMBER,
    SUM(CASE WHEN COUNTRY = 'US' THEN [COUNT] ELSE 0 END) AS US_COUNT,
    SUM(CASE WHEN COUNTRY = 'US' THEN AMOUNT ELSE 0 END) AS US_AMOUNT,
    SUM(CASE WHEN COUNTRY != 'US' THEN [COUNT] ELSE 0 END) AS NON_US_COUNT,
    SUM(CASE WHEN COUNTRY != 'US' THEN AMOUNT ELSE 0 END) AS NON_US_AMOUNT
FROM theTable
GROUP BY GROUPNUMBER
"
21003,40587,"Query rows 9,000,000 to 10,000,000","SELECT count(*)
FROM reports4
WHERE position_geom IS NOT NULL;
"
18463,25736,query to get the monthly amount using mysql,"     SELECT 
         member_id, 
         30*membership_total_amount/DateDiff(membership_enddate, membership_startdate) As monthly_amount
     FROM
         member
"
35893,19395,Scaling values in a column,"$myColumnArray = /* load mysql values here */;   
// order numbers smallest to largest
$uniqueElements = sort(array_unique($myColumnArray));
// calculate increment
$incriment = count($uniqueElements);
// go thru elements in orig array and replace with weighted value
foreach($myColumnArray as &$val){
    // get position of element (i.e. ""4th largest"")
    $position = array_search ($val, $uniqueElements);
    // set it equal to weighted value
    $val = $position * $increment;
}
"
27814,18464,Joining on multiple possible tables,"CREATE TABLE foo (
  id serial primary key,
  name varchar(20),
  activitable_id int UNIQUE,
  FOREIGN KEY (activitable_id) REFERENCES activitables(id)
);
"
29618,14555,Count sum of up and down vote for each item,"SELECT a.asset_id, f.filename,
       coalesce(SUM(v.vote = '1'), 0) as upvote,
       coalesce(SUM(v.vote = '-1'), 0) as downvote
FROM asset a
JOIN asset_files f ON a.asset_id = f.asset_id
LEFT JOIN vote v ON a.asset_id = v.asset_id
GROUP BY a.asset_id
"
37361,66659,"SQL - If two records have same value in two columns, add third column","select a.col1, a.col2, sum(a.col3) as colNew
from test as a
group by a.col1, a.col2;
"
29003,11078,"Removing ending letter from number, and ordering","order by cast(rtrim(substr(col_name, 1, LENGTH(col_name) - 1)) as int);
"
20149,10808,Complex select on a single column,"SELECT count(*) || '|' || count(CASE 
            WHEN email <> ''
                THEN email
            END) || '|' || count(CASE 
            WHEN email = ''
                THEN email
            END) custemaildet
FROM customers 
WHERE cust_grp= 101
"
13589,35520,mysql check value with null,"SELECT * FROM `customer_payment_options` WHERE real_account_id IS NULL
"
18088,72335,Importing data from SQL database in Excel 2003 VS Excel 2010 (VBA),"Set oQuery = WorkBooks(""Book 1"").Sheets(""Sheet 1"").ListObjects(1).QueryTables(1)
"
3068,1280,"simple SQL query not working (emp,dept)","SELECT JOB, SUM(NVL(COMM,0)) AS TOTAL_COMM
FROM
EMP
GROUP BY JOB
"
13361,21771,Convert data from wide format to long format in SQL,"SELECT [VAR1], [VAR2], [VarName] = 'Score1', [Value] = [Score1]
FROM [dbo].[UnknownMe]
UNION ALL
SELECT [VAR1], [VAR2], [VarName] = 'Score2', [Value] = [Score2]
FROM [dbo].[UnknownMe]
UNION ALL
SELECT [VAR1], [VAR2], [VarName] = 'Score3', [Value] = [Score3]
FROM [dbo].[UnknownMe]
"
19097,35569,mysql - How can I get the first result from a subquery?,"SELECT pa.albumId, pa.title, p.src
FROM Album pa
LEFT JOIN Photo p 
  ON p.photoId = (SELECT MIN(photoId) FROM Photo WHERE albumId = pa.albumId)
WHERE pa.userId = 1
"
415,47675,Distinct values in ManyToManyField over a subset of objects in Django,"books = Book.objects.filter(title__contains=""T"")
categories = Category.objects.filter(book__in=books).distinct()
"
15237,6235,Left Join query return bad results,"SELECT u.id, u.name
FROM at_users u 
INNER JOIN (SELECT id_user2 AS friendID FROM at_friends WHERE id_user1 = 1 AND accepted = 1
            UNION 
            SELECT id_user1 AS friendID FROM at_friends WHERE id_user2 = 1 AND accepted = 1
           ) AS A ON u.id = A.friendID
"
21116,54869,Join two tables with one common key in MySQL,"SELECT Table1.app_name, Table1.app_id
FROM Table1
INNER JOIN Table2 ON Table1.app_id = Table2.app_id
"
21036,19808,"""Column 'option_type_id' cannot be null...""","SET @valor := 10;
SET @op1 := @valor * 2 - 1,@op2 := @valor * 2;
"
20083,6795,How to combine date and time from different MySQL columns to compare to a full DateTime?,"SELECT * FROM `mytable` WHERE CONCAT(`d`,' ',`t`) > '2012-02-01 15:00'
"
18227,67887,SQL query to get most,"SELECT TOP 1
    SkillID, s.Description,COUNT(SkillID) AS CountOf
    FROM EmployeeSkills   e
        INNER JOIN Skills s ON e.SkillID=s.SkillID
    GROUP BY SkillID, s.Description
    ORDER BY 3 DESC
"
2060,72544,MySQL bulk INSERT or UPDATE,"INSERT INTO table (a,b,c) VALUES (1,2,3),(4,5,6)
ON DUPLICATE KEY UPDATE c=VALUES(a)+VALUES(b);
"
36603,53054,Select values with duplicate max values sql,"select
   max(sales),
   max(date_) keep (dense_rank first order by sales desc),
   sum(sales),
   min(date_)
from
   table_
"
12092,4696,Calculating number of days between Admission Date and today,"IsNull(ED_DISCHARGE_DATE,getdate())
"
29772,9131,Matching part of a multivalued field to my setString function,"WHERE
   pay_plan LIKE '%*%*' + @MySearchValue; 
"
2053,75430,Joining tables in MySQL with multiple foreign keys,"SELECT r.id, r.start, r.end, pA.desc as pointA, pB.desc as pointB
FROM rides r
JOIN points pA ON pA.id = r.pointA
JOIN points pB ON pB.id = r.pointB
WHERE r.id = 1;
"
35824,29783,"what's the right way of joning two tables, group by a column, and select only one row for each record?","select * from (
    select 
    *,
    row_number() over (partition by c.crew_id order by l.sim_time desc) as rNum
    from crew as c
    inner join TileLog as l (on c.crew_id = l.crew_id)
) as t
where rNum = 1
"
3876,49659,Trying to modify a monthly report to a weekly. Aspen Sql,"SELECT count(*)
  FROM history h
 WHERE h.period = '0:00:15'
       AND h.request = '1'
       AND h.stepped = '1'
       AND h.ts BETWEEN StartTime AND EndTime
       AND (   (h.name = Tag1Name AND h.value = Tag1Cond) 
            OR (h.name = Tag2Name AND h.value = Tag2Cond));
"
31364,32264,SQL - how to return rows containing ALL children rows," SELECT parent_id 
 from XRefTable 
 where ref_id in ( 2, 3 ) 
 group by PARENT_ID 
 having count(distinct ref_id) = 2
"
34558,13253,SQL Server 2005 - removing table triggers?,"SELECT 'DROP TRIGGER ' + name
FROM sysobjects
WHERE type = 'tr'
"
12527,68882,Select Null From A Table When Records May Not Exist,"select distinct
    base.id, 
    Att1.AttributeValue as Attribute1, 
    Att2.AttributeValue as Attribute2,
    Att3.AttributeValue as Attribute3,
    Att4.AttributeValue as Attribute4
from Attributes base
left join Attributes Att1 on base.id = Att1.id and Att1.AttributeType = 1
left join Attributes Att2 on base.id = Att2.id and Att2.AttributeType = 2
left join Attributes Att3 on base.id = Att3.id and Att3.AttributeType = 3
left join Attributes Att4 on base.id = Att4.id and Att4.AttributeType = 4
where base.id = 1
"
33406,42802,update in oracle sql : multiple rows in 1 table,"merge into your_table a 
using ( select rowid rid,
        lead(buyer_name, 1) over (partition by id order by date desc) seller
        from   your_table 
       ) b
       on (a.rowid = b.rid )
when matched then update set a.seller_name= b.seller;
"
16079,53185,Please criticize my proposed database design,"HOUSEHOLD_ATTRIBUTE_RELATIONSHIP 
HouseholdID  | AttributeID 
0            |       0     
3            |       2
etc ... 
"
5624,59964,Postgresql JPA incrementing field,"CREATE SEQUENCE myid_seq;
ALTER TABLE mytable ADD COLUMN myid bigint NOT NULL DEFAULT nextval('myid_seq');
"
6375,6433,Return the last sub sorted row in a table (sql),"SELECT y, Max(x) FROM [table] group by Y
"
30392,67905,SQL server command to create server alias?,"# List existing aliases
Get-WmiObject -Namespace 'root\Microsoft\SqlServer\ComputerManagement10' -Class 'SqlServerAlias' |
    Format-Table -Property 'AliasName', 'ServerName', 'ProtocolName', 'ConnectionString'

# Example script to create an alias
$alias = ([wmiclass] '\\.\root\Microsoft\SqlServer\ComputerManagement10:SqlServerAlias').CreateInstance()
$alias.AliasName = 'bob'
$alias.ConnectionString = '1433' #connection specific parameters depending on the protocol
$alias.ProtocolName = 'tcp'
$alias.ServerName = 'example_server'
$alias.Put() | Out-Null;
"
1473,42452,Using advance SELECT statement for SQL QUERY,"SELECT p.name, p.name_id
FROM people p
JOIN area a
  ON p.name_id = a.name_id
JOIN area_use au
  ON a.area_id = au.area_id
 AND au.veg_grown = 'tomato'
LEFT JOIN area_use au2
  ON a.area_id = au2.area_id
 AND au2.veg_grown <> 'tomato'
WHERE au2.area_id IS NULL;
"
38294,30347,Identify Parent Child records using oracle SQL and avoid merge,"DELETE FROM tablex 
WHERE EXISTS (
    SELECT 1 
    FROM  basetable
    WHERE basetable.row_id = tablex.survivor
          AND basetable.par_ou_id = tablex.loser
    )
"
33977,74163,Query for filling Sequence number on child rows,"update child
    set seq_no = (select count(*)
                  from child c2
                  where c2.parent_id = child.parent_id and
                        c2.id <= child.id
                 );
"
15141,63134,Obtain value of Primary Key for Trigger Updated Row (MySQL),"....
id = OLD.ColumnName
"
5699,67273,Count of dates over a period of time,"SELECT   T1.empid as empid, T1.department as department,
         COUNT(absencedate) AS NumDaysAbsent ,
         startdate, enddate,
FROM     Table1 T1 JOIN
         Table2 T2
         ON t1.empid = t2.empid AND t1.department = t2.department and
            t2.absencedate between t1.startdate and t1.enddate
GROUP BY T1.empid, T1.department, startdate, enddate;
"
18987,5493,Preparing SQL query,"$mysqli = new mysqli(""localhost"", ""my_user"", ""my_password"", ""db"");

if(isset($_GET['id']))
{
    $id = $_GET['id'];
    $q = ""SELECT some_field FROM `objekt_t` WHERE `id`= ?"";

    if ($stmt = $mysqli->prepare($q)) {    
        $stmt->bind_param(""i"", $id);
        $stmt->execute();
        $stmt->bind_result($result);
        $stmt->fetch();
    }
}
"
9269,31336,newid() with Entity Framework 6 Code First,"[DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
public Nullable<Guid> Entity_OID { get; set; }
"
8464,61163,Find unmatched data in SQL,"SELECT *
FROM SAMPLE1 s1
WHERE NOT EXISTS (
        SELECT NULL
        FROM SAMPLE2 s2
        WHERE s1.FruitName LIKE '%' + s2.FruitName + '%'
        )
"
1885,45248,"Relational Algebra union, join and intersect","SELECT DEPTID, CRSNAME
FROM COURSE A
INNER JOIN LECTURERS B on A.DEPTID=B.DEPTID
WHERE B.DEPTID='eENG' or B.DEPTID='CS'
"
24187,74801,MySQL record existence optimization,"SELECT q.title,
       CASE 
         WHEN uq.who_asked = @user_id THEN 1 
         ELSE 0 
       END AS isYourQuestion
  FROM QUESTIONS q
  JOIN USER_QUESTIONS uq ON uq.question_id = q.question_id
"
9821,19325,MongoImport Dates Occurring Before The Epoch,"Dates.each do |d|
  d.mydate = d.mydate.to_date
  d.save
end
"
18866,67598,how can i perfom computed columns in Oracle like in SQL Server,"CREATE TABLE [dbo].[CCtestUsingSubstring] (
   [EmpNumb] INT NOT NULL, 
   [Designation] VARCHAR(50) NOT NULL, 
   [DOBirth] DATETIME NOT NULL, 
   [DORetirement] AS REPLACE([Designation],'E','O') )

insert into [CCtestUsingSubstring] values(1,'Developer',1/10/1992)

Select * from [CCtestUsingSubstring]
"
5455,37034,sql query for merging two tables and then applying count,"select paper_author.author_id,
       count(distinct paper_data.paper_year) as distinct_paper_year_count
from paper_author
  join paper_data on paper_author.paper_id = paper_data.paper_id
group by paper_author.author_id
"
24367,39029,CREATE TABLE where multiple columns are inserted with same value,"CREATE TABLE Test (
  ID int NOT NULL IDENTITY(1,1),
  OverrideSortIndex int,
  Name nvarchar(50) NOT NULL,
  SortIndex AS ISNULL(OverrideSortIndex, ID)
);  
"
26723,54112,Top 2 Rows from every same data in SQL,"SELECT Details
FROM   (SELECT *,
               Row_number()OVER(partition BY Details ORDER BY Details) rn
        FROM   tablename) a
WHERE  rn <= 2 
"
10978,2723,Combining Union results,"SELECT Count(emailID) as ViewsThatMonth, 
         Day(entry_date) as day, 
         Month(entry_date) as month, 
         Year(entry_date) as year
from(
select emailID, Record_Entry AS entry_date 
    from email_views
   where emailID = 110197
UNION ALL 
  select emailID, entry_date 
    from dbo.tblOnlineEmail_Views
   where emailID = 110197
) AS t
Group By Day(entry_date), Month(entry_date), Year(entry_date)
order by 4, 3, 2
"
39424,49405,SQL - Select only one value from multiple fields,"SELECT LTRIM(RTRIM(col1 + col2 + col3 + col4))
"
8149,12345,How to select all records year to date in oracle?,"SELECT * FROM mytable
 WHERE date'1970-01-01' + NUMTODSINTERVAL(create_date, 'SECOND') >= TRUNC(ADD_MONTHS(SYSDATE, -12));
"
36269,41782,MySQL select using group and count for join tables,"SELECT school.NAME, 
       count(student.id) AS Total_Student 
FROM   school 
       LEFT JOIN student 
              ON school.id = student.school_id 
GROUP BY school.id
ORDER BY Total_Student
"
5142,55681,Select with subquery avoid running more than once?,"Select 
     Col_A
    ,Col_B
    ,Col_C
    ,CASE 
        WHEN t.whatevercol IS NOT NULL THEN 1
        ELSE 0
     END CASE AS Col_D,
    t.whatevercol
FROM
    MyTable, (SELECT ...{a very complicated query}...) t
"
30366,48037,Extract only alphabetic characters from VARCHAR column,"select regexp_replace('12-MAR-2014,,1234,DATA,VALUE,12/03/14,,124,End','[[0-9]{2}-(JAN|FEB|MAR|APR|JUN|JUL|AUG|SEP|OCT|NOV|DEC)-[0-9]{4}]*|[^a-zA-Z]+|$','%') from dual
"
3260,1536,Finding parents by matching on children FKs,"SELECT  * FROM Playlists WHERE ID IN(
SELECT PlaylistId FROM PlaylistItems where Title LIKE '%Geographer - Kites%'
INTERSECT
SELECT PlaylistId FROM PlaylistItems where Title LIKE '%Sam Kang%')
"
25168,19293,MYSQL: Problems using COUNT and SUM functions in multi row select,"SELECT * FROM (
  SELECT @t1 := @t1 + 1 AS num, ads.*
  FROM ads, (SELECT @t1 := -1) init
  WHERE city = 'Maitland' AND spot = 'home-banner'
  ORDER BY id ASC
) dt
WHERE dt.num = (
  SELECT SUM(views) % COUNT(id) FROM ads
  WHERE city = 'Maitland' AND spot = 'home-banner')
"
2414,50162,How do I convert SQL Server stored procedure with parameter to Oracle stored procedure with parameter?,"  CREATE OR REPLACE PROCEDURE get_some_table(ref_cursor out sys_refcursor) is
  begin
    open ref_cursor for
      select * from my_schema.some_table;
  end get_some_table;
"
19423,32560,Oracle COALESCE or NVL,"UPDATE OLCACT SET 
    ENDDATE    = pETime, 
    SYSENDDATE = NVL2(pETime, SYSDATE, NULL)
    GRD        = pGRD,
    PASS       = v_pass
"
12832,60162,SQL Server 2008: SQL Query using IF in columns,"   (CASE
     WHEN CONVERT(VARCHAR(10), A.ISL_TAR, 103) = '01/01/1900' THEN
       NULL
     ELSE CONVERT(VARCHAR(10), A.ISL_TAR, 103)
    END) AS 'TARIH'
"
38768,58206,SQL meta table help (mysql),"select  *
from    metas m
join    news n
on      m.rel_id = n.id
where   m.meta_type = 'category'
        and m.meta_id = 55
        and n.status = 1
order by
        n.id desc
limit   0, 10
"
2440,42848,Ranking rows using SQL Server Rank function without skipping a rank number,"select *, DENSE_RANK() over (order by apples) as theRank from #test
"
27706,49084,Postgresql JSON has key,"SELECT (customer_data->>'frameMenuData'->>'frameElement' IS NULL) AS has_frame,
"
17817,38531,How do I fill empty fields based on the most common value of the same?,"UPDATE s
SET s.date_of_birth = (
  SELECT top 1 date_of_birth
  FROM student
  WHERE batch = s.batch
  GROUP BY date_of_birth
  ORDER BY count(*) desc
)
FROM student s
WHERE s.date_of_birth IS NULL
"
14892,11969,How to query for many to many relationship in Sql Server,"SELECT
s.StudentID
,s.StudentNam
,sc.CourseID
,c.CourseName
FROM Student s
LEFT JOIN StudentCourse sc
ON s.StudentID = sc.StudentID
LEFT JOIN Course c
ON sc.CourseID = c.CourseID
WHERE s.StudentID = 1
"
31767,67691,Query Asterisk CDR in MYSQL to list inbound calls by SIP number?,"SELECT 'xxxxxxxxxxx' as 'tel', count(*) as 'count' from CDR where did = 'xxxxxxxxxxx'
"
24407,4874,combine rows into one row in tsql,"WITH C AS(
    SELECT 
    RANK() OVER (PARTITION BY [User] ORDER BY Email) AS [Rank]
    ,[User], Email
    FROM Emails
)
SELECT [User]
    ,MIN(CASE C.[Rank] WHEN 1 THEN Email END) AS [Email1]
    ,MIN(CASE C.[Rank] WHEN 2 THEN Email END) AS [Email2]
    ,MIN(CASE C.[Rank] WHEN 3 THEN Email END) AS [Email3]
FROM C
GROUP BY [User]
"
22264,34281,sql query distinct on multiple columns,"select field1
      ,field2
      ,field3
      ,field4
      ,count (*)
  from foo
 group by field1
         ,field2
         ,field3
         ,field4
having count (*) > 1
"
1278,12211,SQL Coalesce STR results in an INT,"Select tp.PH_F pHF, COALESCE(STR(tp.pH_F, 5, 2), tp.pH_S) pH
     From tblprod tp
"
1047,59127,Search multiple columns for multiple variables and then split by variable name,"select code, count(*) as cnt 
from(
     select event1 as code from log
     union all
     select event2 as code from log
     union all
     select event3 as code from log
     union all
     select event4 as code from log
    )t
where code in('A106', 'A107', 'B465', 'E713')
group by code
"
32358,74382,"By group, check if for each unique value, there is at least one row where the value of the field equals another field's value","select id, max(result) <> 0 as [result2]
from
(
  select id, sum(iif(a=b, 1,0)) > 0 as [result]
  from [table]
  group by id, a
)
group by id
"
9499,14880,Create table taking much longer than select sql oracle,"select * from v$session_wait where sid = <your sid>
"
34738,6918,Calculate the Rates based on the Hour value SQL Server,"declare @t decimal(5,2)=1.3

/* converting to hours */
select cast(@t as int)+@t%1*100/60
"
29987,9890,display the data in subject table using joins,"SELECT S.*, Su.*
FROM Student AS S
INNER JOIN Student_Subject AS SS
    ON S.StudentID = SS.StudentID
INNER JOIN Subject AS Su
    ON SS.OfferCode = Su.OfferCode
"
3753,25892,How can you reference multiple rows in another table?,"CREATE TABLE PersonRoles (
    PersonID int not null,
    RoleID int not null,
    constraint PK_PersonRoles PRIMARY KEY (PersonID,RoleID),
    constraint FK_PersonRoles_Persons FOREIGN KEY (PersonID) references Person (ID),
    constraint FK_PersonRoles_Roles FOREIGN KEY (RoleID) references Role (ID)
)
"
15304,67079,SQL: finding double entries without losing the ID,"SELECT min(ID), Product, Color FROM table GROUP BY Product, Color;
"
3231,494,Replace value in result by a specific value,"SELECT 
    field1 AS 'Name',
    CASE 
        WHEN field2 = 'Foo' 
            THEN 'Bar' 
        WHEN field2 = 'Lorem'
            THEN 'Ipsum'
        ELSE 'Some Value'
    END
    AS 'Type',
    field3 AS 'Description'
FROM table
"
31743,33731,Bad results in SQL query,"SELECT c.course_name 
FROM grades g
JOIN courses c
  ON   g.course_id = c.course_id
GROUP BY c.course_name
HAVING AVG(grade) > 55
"
12849,3100,How Select top 2 values from each group in a table with SQL using this specific query,";With Results
AS
 (
    Select D.JeanID, P.Desc
            , P.Price, rn = ROW_NUMBER() OVER (PARTITION BY D.JeanID ORDER BY P.Price DESC)
    FROM Products P inner join Jeans D 
    on D.CHG_I = P.CHGPI
    Where D.CHG_Date=convert(date,sysdatetime())
 )
SELECT JeanID, Desc, Price
FROM Results
WHERE rn <= 2
"
22801,30393,how to delete a row with an empty column in android database?,"sql.delete(TBL_ITEMS, KEY_TOTAL_AMOUNT + "" IS NULL"", null);
"
27192,2808,MySQL limit by count and return items with same date,"SELECT DISTINCT c.* 
FROM `calendar` c
  JOIN (
       SELECT `date`
       FROM `calendar`
       WHERE `date` >= '2013-05-01'
       LIMIT 2
    ) c2 on c.`date` = c2.`date`
"
26442,4988,SQL WHERE IN (...) sort by order of the list?,"
select t1.*
from t1
inner join
(
  select 1 as id, 1 as num
  union all select 5, 2
  union all select 3, 3
) ids on t1.id = ids.id
order by ids.num
"
21744,75513,Trim null values in AS400,"SELECT * 
FROM A INNER JOIN B 
    ON TRIM(TRAILING x'00' FROM A.ITEM) 
        = TRIM(TRAILING x'00' FROM B.ITEM);
"
21561,37313,Android SQLite - why is my db re-created each time?,"super(context, null, null, VERSION);
"
18310,63179,Average distance between user visits,";WITH CTE AS (
   SELECT UserID, DateTimeOut, LEAD(DateTimeIn) OVER (PARTITION BY UserID ORDER BY DateTimeIn asc) as 'NextCheckIn'
   FROM @Visits
)
Select AVG(Seconds) as 'AvgRecency' From (
    SELECT UserID, ISNULL(DATEDIFF(SECOND, DateTimeOut, NextCheckIn), 0) as 'Seconds'
    FROM CTE 
    WHERE NextCheckIn IS NOT NULL
) A
"
5900,23067,Printing source code from sql server 2005 stored procedures,"DECLARE @stored_procedure_code nvarchar(MAX) = ''

SELECT @stored_procedure_code = @stored_procedure_code + '
/*****************************************************************************/
GO

' + ISNULL(OBJECT_DEFINITION(object_id),'')
FROM sys.procedures 
WHERE object_id IN (object_id('foo'),object_id('foo_bar'))

SELECT  @stored_procedure_code AS [processing-instruction(x)] FOR XML PATH('') 
"
21776,36501,Retain NULL in MAX() ORDER BY,"select seq_no, timestamp, 
       (case when timestamp is not null
             then max(timestamp) over (partition by seq_no)
        end) as maxtimestamp
from temp
"
28413,15300,Determine monthly values of timestamped records,"select left(date,7) as the_month, min(price),max(price),avg(price)
from fruit_price
where fruit_id = 2
and date >= concat(left(date_sub(curdate(), interval 11 month),7),'-01')
group by the_month;
"
12095,35561,Sum multiple columns using a subquery,"SELECT a.name, 
       SUM(B.sequence + B.length)    AS total
 FROM Tbl1 A
      INNER JOIN Tbl2 B
         ON B.sequence = A.sequence
WHERE A.loc <> -1
  AND A.id = 10201
      GROUP BY a.name
      ORDER BY A.location
"
7350,11023,How to select field with particular value or null from joined table,"select A.x,B.y from A left outer join B on A.id= B.a_id and ( b.y ='abc' or b.y is null )
"
38466,57906,Retrieving a list of blog posts with related tags with less query,"SELECT
  It.ItemID,
  It.Title [ItemTitle],
  Tg.TagID,
  Tg.Title [TagTitle]
FROM Item It
LEFT OUTER JOIN Tag Tg
ON It.ItemID = Tg.ItemID
"
8855,2021,How to use Replace with %," select left(testfield, charindex('<==#', testfield) - 1)
"
5193,50262,Parent Child Query without using SubQuery,"select a.id,a.name,max(b.date)
from TableA a
join TableB b on b.aid = a.id
group by a.id,a.name
"
7133,66770,SQL AND OR evaluating to different results,"WHERE sp.SupplierID=s.SupplierID
AND sp.ProductID=r.productID
AND (r.Reason LIKE  'Scratched CD'
OR r.Reason LIKE 'Unreadable disk')
"
33168,15953,Populate Total Sales in Mysql,"SELECT Name AS Product, SUM(Quantity) AS QuantitySold, SUM(Quantity * Price) as TotalAmount
FROM sales
GROUP BY Name;
"
12287,16612,SQL - Grouping results of SELECT but keep some values unique,"SELECT year, 
       SUM(wins), 
       SUM(cuts), 
       sum(case when tour = 'EUR' then money end) as moneyEUR,
       sum(case when tour = 'USA' then money end) as moneyUSA
FROM players 
GROUP BY year
"
8416,62224,Hive query equivalent of sql,"select students.course_id from students students LEFT OUTER JOIN courses courses  ON (students.course_id = courses.course_id) where courses.course_id is null;
"
15221,24678,Update data in table1 where duplicates in table2,";WITH cteDedup AS(
  SELECT
    UserId
   ,FName
   ,LName
   ,ROW_NUMBER() OVER(PARTITION BY FName, LName ORDER BY UserID ASC) AS row_num
  FROM UserTable
 )

 UPDATE rt
 SET UserId = original.UserId
 FROM ResultsTable rt
 JOIN cteDedup dupe
   ON rt.UserId = dupe.UserId
 JOIN cteDedup original
   ON dupe.FName = original.FName
   AND dupe.LName = original.LName
 WHERE dupe.row_num <> 1
   AND original.row_num = 1
"
23878,882,SQL: Records on same day but different time,"SELECT *
FROM (
   SELECT *,
      RANK() OVER(PARTITION BY CAST(DateTime_Column AS DATE) ORDER BY DateTime_Column DESC) AS R
   FROM Your_Table) AS Tb
WHERE R = 1
"
6514,49839,unable to create proper sql,"SELECT  *
FROM    message m INNER JOIN
        member snd ON   m.sender = snd.memberid INNER JOIN
        member rcv ON   m.receiver = rcv.memberid
"
25122,18222,How to find matching fields in another table,"SELECT *
FROM Stats, Pages
WHERE  Stats.url LIKE '*' & Pages.PageId & '*'
"
38272,55613,Check if record exists in subquery,"SELECT s.[Id],
       s.[Name],
       CASE WHEN EXISTS (SELECT 1 FROM [dbo].[SourceUser] su WHERE su.SourceId = s.[Id] AND su.UserId = 1)
            THEN CAST(1 AS BIT)
            ELSE CAST(0 AS BIT)
       END AS Access
 FROM [dbo].[Source] s
 INNER JOIN [dbo].[SourceAccount] sa ON sa.SourceId = s.Id
 WHERE sa.AccountId = 1 AND s.SiteId = 1
"
38136,689,Sum of unique entries per day,"SELECT 
  SUM(comission), 
  token, 
  DATE(transdate) 
FROM
  t 
GROUP BY 
  token, 
  DATE(transdate)
"
31419,46198,Get parent with more than 2 child,"SELECT parent
FROM   tablename
GROUP  BY parent
HAVING Count(parent) > 2 
"
27759,42810,Selecting items with same name and adding each value the line holds,"SELECT s.descr, SUM(s.unitqty) AS sum_of_unitqty
FROM saleslines s
GROUP BY s.descr
"
7242,37215,SQL - How to join on similar (not exact) columns,"With RankedItems As
    (
    Select A.DateTime As ADateTime, B.DateTime As BDateTime
        , ROW_NUMBER() OVER ( PARTITION BY A.DateTime ORDER BY ABS( DateDiff(s, A.DateTime, B.DateTime) ) ) As ItemRank
    From A
        Cross Join B
    )
Select 
From RankedItems
Where ItemRank = 1
"
12737,43154,Get result if end_date is 1 month before current month,"select *
from sales
where DATE_FORMAT(date_end, '%Y%m') = DATE_FORMAT(now() - interval 1 month, '%Y%m')
"
27463,9472,Simple TSQL table referencing," CREATE PROCEDURE [dbo].[report
(
 @Date DATETIME='11/11/2011'
)
AS
BEGIN

SELECT *
INTO #Temp
FROM  dbo.vwview
WHERE
        Date = @Date
DECLARE @tblnewReport TABLE
(IS varchar(8))

INSERT
INTO @tblnewReport
SELECT SubreportIS FROM #Temp
"
4243,50319,How to get all records without duplicate,"select distinct productName,description from ForgeRock;
"
33978,27586,SQL - Selecting groups of rows that share a common value,"SELECT acc, ip
FROM YourTable
WHERE ip IN (SELECT ip
             FROM YourTable
             GROUP BY ip
             HAVING COUNT(*) > 1)
ORDER BY ip, acc
"
3115,51492,Is there a way to use Union with Use?,"SELECT
    min(len(Password)) AS minPassword, 
    max(len(Password)) AS maxPassword, 
    avg(len(Password)) AS avgPasswword 
FROM 
    Customer.dbo.Password
UNION
select 
    min(len(password)), 
    max(len(password)), 
    avg(len(password))
FROM 
    Website.dbo.Password
"
16075,48770,How does OLAP address dimensions that are numeric ranges?,"   WHERE event_time BETWEEN '2009.02.03 18:32:41' AND '2009.03.01 18:32:41'
     AND event_time_bucketed BETWEEN '2009.02.03' AND '2009.03.01'
"
33369,51290,Use FLOOR() (or other SQL functions) in Django queries,"MyModel.objects.extra(group='FLOOR(quantity/100)')\
    .values('group')\
    .annotate(count=Sum('quantity'))\
    .order_by()
"
34580,33433,SQL - Joining Tables,"SELECT c.comment_id, c.member_id, c.comment, c.posted, m.screen_name, m.country_code
       SUM(r.points) `member_rep`
FROM blog_comments `c`
LEFT JOIN members `m` USING (member_id)
LEFT JOIN members_reputation `r` USING (member_id)
WHERE c.article_id = ""&article_id&""
ORDER BY c.comment_id DESC
"
27693,237,Logical Modeling difficulty,"Connection(cust_id1, cust_id2, connectdate)
"
6975,54845,Query to count items across multiple columns,"select fish, 
       count(*)
from (
  select fish1 as fish from the_table
  union all
  select fish2 from the_table
  union all
  select fish3 from the table
) t
group by fish
"
30081,54846,Disable a trigger from a trigger Oracle,"EXECUTE IMMEDIATE 'ALTER TRIGGER trigger_name_here DISABLE';
"
10755,75427,Tsql Union Query is breaking sorting in my asp.net gridview,"(Query A)
UNION 
(Query B)
ORDER BY xxx
"
18295,16302,Record filtration issue,"select * from agents a
where railenabled = 1     --assuming 1 means enabled
and not exists (select 1  --not exists to remove all agents whose users have RAL enabled
                from userpermissions b
                where a.companyid = b.companyid
                and b.modulecode = 'RAL'
                and b.enabled = 1
                );
"
15444,41837,Simplest way to fill working day table,";WITH DatesCTE
 AS (

   SELECT CAST('2016-01-01' AS DATE) AS [workingDays]
   UNION ALL

   SELECT DATEADD(DAY, 1, workingdays)
   FROM DatesCTE
   WHERE DATEADD(DAY, 1, workingdays) < '2017-01-01'

)

SELECT *
FROM DatesCTE
WHERE ((DATEPART(dw, workingDays) + @@DATEFIRST) % 7) NOT IN (0, 1)
OPTION (MAXRECURSION 366)
"
15826,58357,SQL - IF statement around AND," SELECT DISTINCT
    id
    name
    active
    FROM team
 WHERE id = 1234
   AND (team.active = 'y'
     AND team.id IN
        {
          query
        }) 
   OR
    (team.active = 'n'
     AND team.id IN
      {
        query
      })
"
26465,66616,how to store sql results into variable in sql server 2008,"DECLARE @Rev1 int
DECLARE @Rev2 int
DECLARE @Rev3 int
DECLARE @Rev4 int
SELECT 
    @Rev1 = SUM(CASE WHEN MAIN_SAT =1 THEN 1 ELSE 0 END),
    @Rev2= SUM(CASE WHEN MAIN_EKL =1 THEN 1 ELSE 0 END),
    @Rev3= SUM(CASE WHEN MAIN_LAM =1 THEN 1 ELSE 0 END),
    @Rev4= SUM(CASE WHEN MAIN_JAC =1THEN 1 ELSE 0 END)
FROM MyTable
WHERE QTR = 1
    AND ACTIVE_FLAG = 1
"
26874,35014,Querying SQL for multiple records,"select column1
from the_table
where column2 in ('Doc1', 'Doc2', 'Doc3')
group by column1
having count(distinct column2) = 3;
"
37179,3258,joining 5 tables to obtain all comments made about goal where id = 2,"select c.*
from goal g 
inner join objectives o on g.id = o.goal_id 
inner join steps s on o.id = s.objective_id 
inner join transaction t on s.id = t.step_id 
inner join comments c on t.comment_id = c.id
where g.id = 2
"
7148,57935,Creating new columns from data in other columns based on primary key,"Select (E FirstName + ' ' + E.LastName) as EmployeeName, 
      E.Title as JobTitle,           
      (R.FirstName + ' ' + R.LastName) as 'ManagerName', 
      R.Title as 'ManagerTitle'
From Employees E
  LEFT JOIN 
     Employees R ON E.ReportsTo = R.Id
Order By ReportsTo
"
17558,39681,Finding the rank or index of some name in an array returned by query,"SELECT t.*, 
       @rownum := @rownum + 1 AS rank
  FROM TABLE t, (SELECT @rownum := 0) r
"
25216,25279,Load data from csv file to oracle table from command line,"LOAD DATA
INFILE 'my_file.dat'
BADFILE 'my_file.bad'
DISCARDFILE 'my_file.dsc'
APPEND
INTO TABLE my_table
...
"
25599,67134,Design generic attachments SQL Table/Entity in EF Code-First,"Entities Table:
==============
EntityId
EntityName

Attachments Table:
=================
AttachmentId
EntityId
Attachment
"
16811,52747,"how to use ""like"" command in below query","procedure alterExtTableFileName(a_tableName varchar2, a_filename varchar2) is
    pragma autonomous_transaction;
begin

    dbms_output.put_line('alterExtTableFileName(TableName=' || a_tableName || ' FileName=' || a_filename || ')');

    execute immediate 'alter table ' || a_tableName || ' LOCATION (''' || a_filename || ''')';
    commit;

exception when others then
    rollback;
    raise;

end alterExtTableFileName;
"
28840,29154,Count how many different countries are in the table,"select  count(distinct country)
from    YourTable
"
19327,66379,Any tools to export the whole Oracle DB as SQL scripts,"SELECT DBMS_METADATA.GET_DDL('TABLE',table_name) FROM USER_TABLES;
"
17621,65880,join two tables in mysql,"SELECT
  a.course_id,
  a.teach_id,
  a.class_id,
  s.student_id,
  s.student_name
FROM Student AS s
INNER JOIN Apsent AS a ON s.student_id = a.student_id;
"
33825,64836,SQL Query: LIKE x%,"WHERE ColA LIKE '%2[%]%' 
"
11273,47920,To display only previous three months even the months before is not exist in database,"SELECT  DATEADD(month, it.id, 0 ) AS month
    ,ISNULL(COUNT(clixsteraccount.rem_registerbycn), 0) AS registration
    ,'REGISTRATION(No)' AS fake_column
FROM    cn
    INNER JOIN ON ca.rem_registerbycn = cn.cn_id
    clixsteraccount ca 
    RIGHT JOIN
    IndexTable it ON it.id = DATEDIFF(month, 0, clixsteraccount.rem_joindate)
WHERE   it.id BETWEEN DATEDIFF(month, 0, @StartDate) - 3 AND DATEDIFF(month, 0, GETDATE())
GROUP BY it.id
"
4894,62059,Mysql problems with Triggers,"...
begin
INSERT INTO customerbkp(cid,cname,cemail,phone,operation) 
    VALUES (NEW.cid, NEW.cname, NEW.cemail, NEW.phone, 'insert');
end;
...
"
11479,27048,SQL Join and result filtering,"SELECT p1.ProductName, p2.ProductName
FROM products p1
CROSS JOIN products p2
WHERE (p1.ProductName, p2.ProductName) NOT IN (
SELECT DISTINCT p3.ProductName, p4.ProductName
    FROM order_details od1
    JOIN products p3
    ON od1.ProductID = p3.ProductID
    CROSS JOIN order_details od2
    ON od1.OrderId = od2.OrderID
    JOIN products p4
    ON od2.ProductId = p4.productid
)
"
19121,40800,Compare result of 'as' expression in 'where' statement,"SELECT (mytable.field1 + 10) AS x FROM `mytable` WHERE (mytable.field1 + 10) < 50;
"
26890,19815,Access SQL Randomizer Not working as intended,"SELECT Questions.QuestionID 
FROM Questions 
WHERE Questions.QuestionDifficulty=[?] 
  AND ( Questions.LastDateRevealed Is Null 
     OR Questions.LastDateRevealed < DateAdd('d',-2,Date()) ) 
  ORDER BY Rnd(Questions.QuestionID * Time());
"
4341,32196,INSERT data into a table only if it matches a field in another table,"INSERT INTO table1(data_1, email) 
VALUES 
(SELECT data_1,email 
     FROM table_2 
     WHERE table_1.email=table2.email)
"
23445,52521,How to select each value of array,"WITH array_data(id,arr) AS ( VALUES
  (1,ARRAY[1,2]),
  (2,ARRAY[5,6,8])
)
SELECT arr,unnest(arr) AS val 
FROM array_data;
"
9911,15191,LINQ to SQL How can I submit changes after closing the connection?,"using (var dataContext = new DataContext(ConnectionString))
{
     dataContext.TABLE_NAME.Attach(modifiedEntity);
     dataContext.SubmitChanges();
}
"
23373,42041,After I Join with same table twice then how to call value with same column name in WHERE clause?,"WHERE t2.SomeOtherField = t1.SomeOtherField
"
37803,58053,Elegant way of doing table sync reports in Oracle?,"select a.keya, a.value a_value, b.keyb, b.value b_value
from table_a a
full outer join table_b b
on a.keya = b.keyb
where a.keya IS NULL
or b.keya IS NULL
or (a.value is null and b.value is not null)
or (a.value is not null and b.value is null)
or a.value <> b.value
"
37542,1714,Finding strings with embedded spaces in a column,"select *
from test t
where column like '%  %';
"
7475,32358,How to generate reliably a random UUID on Oracle?,"grant execute on sys.dbms_crypto to uuid_user;
"
31301,9271,Does Where Clauses with sub-queries in t-sql queries the data for each row?,"WHERE ad.AdvertisementID IN (SELECT AdvertisementID FROM UDF_GetAdvertisements)
"
31193,3791,"Does a SQL UPDATE operation read data to ""local memory""?","BEGIN TRAN

DECLARE @MagicColumn INT;

/*Two concurrent transactions can both read the same pre-update value*/
SELECT @MagicColumn = MagicColumn FROM MagicTable WHERE SomeCondition

UPDATE MagicTable SET MagicColumn = @MagicColumn + 10 WHERE SomeCondition

COMMIT
"
35160,15944,Rename a column that is a Reserved Word,"ALTER TABLE CONTACT_DATA RENAME COLUMN ""NUMBER"" TO PHONE_NUMBER;
"
9909,43206,Get ID from another table through a table,"select
    ptc.ptc_name,
    aud.aud_year
from
    ptc_table ptc
inner join
    ada_table ada
on
    ada.ada_ptcid=ptc.ptc_id
inner join
    aud_table aud
on
    aud.aud_id=ada.ada_aud_id
"
32136,9317,how do i get the number of members on status name,"SELECT COUNT(*)
FROM member inner join mmship
   ON member.member_Id = mmship.member_Id
   INNER JOIN mshipstatus
   ON mshipstatus.mshipstatus_Id = mmship.mshipstatus_Id
WHERE mshipstatus.mshipstatusname = 'prospective'
   AND MONTH(mmship.mmshipstart_date) = MONTH(GETDATE())
"
9257,63670,How can two hierarchies be efficiently merged in SQL Server?,"node_id   parent_id
1         NULL
2         1
3         2
4         3

node_id   parent_id
1         NULL
3         1
5         2
6         1
"
35668,39422,SQL Insert new line,"INSERT INTO [tablename] (id_group,id_item)
SELECT DISTINCT id_group,7
FROM [tablename];
"
1459,61128,How can I fetch records from two tables along with count?,"SELECT o.p_id, COUNT( o.p_id ) AS p_id_count, p.p_name, p.p_price, p.p_image_path
FROM orderitem o
INNER JOIN products p ON o.p_id = p.p_id
GROUP BY o.p_id
ORDER BY p_id_count 
"
26477,14726,"How to select the row of a minimum value of a group, while also using a where clause","select a.courseid, a.lesson, a.personid, a.thedate 
from (
    select personid, courseid, min(thedate) as earliestdate 
    from attendance 
    group by personid, courseid
) as x 
inner join attendance as a 
  on (a.personid = x.personid and 
      a.thedate = x.thedate and 
      a.courseid=x.course_id)
"
16678,51167,how to join table that still retain all values from the main table,"SELECT A.id, 
       A.accnt, 
       A.amount, 
       Sum(I.issued) AS issued 
FROM   accnttbl A
       LEFT JOIN issuedtbl I
              ON A.id = I.id 
                 AND Month(I.dateissue) BETWEEN 1 AND 2 -- Right table filter
WHERE  Year(A.date) = 2016 
GROUP  BY A.id, 
          A.accnt, 
          A.amount 
"
9747,48272,how to avoid data from one column in SQL Server,"where BT.Name <> 'Other'
"
7460,48887,"Validate, filter and convert string to date using Isdate","with ValidDates as
(
    select top 100 InstallDate
    from tblInstalls
    where ISDATE(InstallDate) = 1
    --need an order by here
)

select convert(DATETIME, InstallDate,  103)
from ValidDates
"
7675,46535,Recursive cte to repeat several integers,";WITH Numbers AS
(
    SELECT n = 1
    UNION ALL
    SELECT n + 1
    FROM Numbers
    WHERE n+1 <= 10
),
se7en AS
(
    SELECT n = 1
    UNION ALL
    SELECT n + 1
    FROM se7en 
    WHERE n+1 <= 7
)
SELECT Numbers.n
FROM Numbers CROSS JOIN se7en
"
6313,16613,MSSQL Recursive dateadd,";with cte as (
    select M_ID, STEP, DateTo, AddDays
    from #t1
    where STEP = 1
    union all
    select t.M_ID, t.STEP, dateadd(dd, c.AddDays, c.DateTo), t.AddDays
    from #t1 t
    inner join cte c on t.M_ID = c.M_ID and t.STEP = c.STEP + 1
)

select *
from cte
"
6590,6884,How to do SQL calculation from a view?,"SELECT  Channel,
        SUM(CASE WHEN Type = 'N' THEN -1 ELSE 1 END * total_month_count) ""Calculation""
FROM    yourView
GROUP BY Channel
"
19159,43422,Need suggestions for writing an optimized SQL query,"SELECT j.* 
FROM Job AS j
  JOIN JobType AS jt
    ON jt.id = j.type_id
WHERE jt.code = 'CRT'
  AND NOT EXISTS
      ( SELECT 1
        FROM Job AS p
          JOIN JobType AS pjt
            ON pjt.id = p.type_id 
        WHERE p.user_description = pjt.description || '-' || j.user_description
          AND pjt.code LIKE 'PST%'
      ) ;
"
38040,23010,How to remove a string in sql,"UPDATE Student SET StudentId = REPLACE(StudentId, 'S', '')
"
38839,33306,Limit SQL query to only the top two counts per group,"SELECT
   State,
   flv,
   total
FROM (SELECT
         ROW_NUMBER() OVER ( PARTITION BY state ORDER BY count(INITCAP(TRIM(flavor))) DESC ) RowNumber,
         State,
         INITCAP(TRIM(flavor)) flv,
         count(INITCAP(TRIM(flavor))) total
      FROM favorite_flavor
      GROUP BY state, INITCAP(TRIM(flavor))
      ) dt
WHERE RowNumber <= 2
ORDER BY state ASC, total DESC
"
27507,3548,Writing Lengthy SQL queries via RODBC in R,"my_query <- paste(readLines('your_query.sql'), collapse='\n')
results <- sqlQuery(con, my_query)
"
20411,30178,Sql queries on string columns - sorting according to language,"select  *
from    YourTable
order by
        case 
        when name like '%[... all hebrew letters here ...]%' then name
        end collate Hebrew_CI_AS
,       name collate Latin1_General_CI_AS
"
31034,66703,TSQL query to return most recent record based on another columns value,"Select max(ID), CompanyID, max(Expiration) from Table group by Company ID
"
31264,19910,Compare Every Record from Two Tables,"if exists (select 1 from T1 inner join TB on T1.Col = T2.Col)
"
6875,28002,Optional filter on a left join column,"DECLARE @customer_location_key INT
SET @customer_location_key = 1

SELECT
  I.Issue_Number,
  C.Customer_Location_Code

FROM Issues I
LEFT JOIN Customer_Location C
  ON C.Customer_Location_Key = I.Customer_Location_Key
where (@customer_location_key is null or C.Customer_Location_Key = @customer_location_key)
"
7219,36768,SQL Server: join three tables,"SELECT * 
FROM 
    Table1
INNER JOIN 
    Table2 ON Table1.field1 = Table2.field2
INNER JOIN
    Table3 ON Table1.field2 = Table3.field3
"
2602,70105,Count values over m/n connected tables in SQL,"SELECT n.id,
       n.name,
       COUNT(DISTINCT l.id) AS locations,
       COUNT(DISTINCT d.id) AS downloads
FROM names n LEFT JOIN names_location nl
  ON n.id = nl.name_id
LEFT JOIN downloads dl
  ON n.id = dl.name_id
LEFT JOIN locations l
  ON l.id = nl.location_id
GROUP BY n.id, n.name
"
12942,72979,MySQL for grouping with one column and getting a subgroup from another column,"SELECT COUNT(*) AS ""times"", username, date
FROM mytable 
GROUP BY date, username ORDER BY date DESC
"
23240,22051,Oracle joining mutiple tables," select
 TA.C1,TB.C1,TC.C1,TD.C1, TE.C1
 from  TableA TA          
 INNER JOIN TableB TB ON (TA.C2 = TB.C1)
 INNER JOIN TableC TC ON (TA.C3 = TC.C1)
 LEFT JOIN TableD TD ON (TA.C4 = TD.C1)
 LEFT JOIN TableE TE ON (TD.C2 = TE.C1)
 AND TA.C3 = ""ABC""
"
16992,66647,Comparing two Access tables identical in structure but not data,"SELECT
    t1.CenterName,
    t1.BuildingName,
    t1.FloorNo,
    t1.RoomNo,
    t2.CenterName
FROM
    Table1 AS t1
    LEFT JOIN Table2 AS t2
    ON
            t1.CenterName = t2.CenterName 
        AND t1.BuildingName = t2.BuildingName 
        AND t1.FloorNo = t2.FloorNo
        AND t1.RoomNo = t2.RoomNo
WHERE t2.CenterName Is Null;
"
32533,41928,How to create Insert with Select query in a variables using SQL Server,"SET @insert='INSERT INTO'+ @ndbname+'.[pm]([pmId],[pmCode],[pmName])'  
SET @sqlCommand = @insert + ' ' +'SELECT @id AS spID,[spCode],[spName] `enter code here`FROM' + @0dbname+'.[sp] where spbID = @br and spID = @m'
EXECUTE sp_executesql @sqlCommand, N'@br nvarchar(75),@m nvarchar(75),@id VARCHAR(20)',@br = @br,@m=@m,@id=@id
"
29736,72559,nasty Aggregation in SQLPLUS,"select regexp_replace(col_2, '^\d+-', null), count(1)
from the_next_table
group by regexp_replace(col_2, '^\d+-', null);
"
20914,14711,INSERT SELECT SQL from two tables,"INSERT INTO tbl_StudentPurchaseFromUnibooks (OrderLineID,   StudentID )   
SELECT tbl_OrderLineID.OrderLineID, tbl_Student.StudentID from tbl_OrderLineId left join tbl_Student on ??? WHERE tbl_Student.LoggedIn =""Yes"";
"
1139,35768,How to insert into a table with just one IDENTITY column,"INSERT INTO GroupTable DEFAULT VALUES
"
30568,1881,INNER JOIN with position in second table,"SELECT u.id, u.name, h.points, 
       (select count(*) + 1
        from highscore_table h2 
        WHERE h2.points > h.points) hs_position
FROM user_table u
INNER JOIN highscore_table h ON u.id = h.user_id
ORDER BY u.name
"
6527,17118,Postgres/SQL Join and Update,"update rates_records 
   set column_1 = 'foo', 
       column_2 = 'bar'
from rates 
  where rates.rates_id = rates_records.rates_id
    and rates.state = 'current';
"
19778,5233,SQL Query - Select Statement,"SELECT DISTINCT Y.CusID, Y.Name, ISNULL (Y.S1, Y.S0) AS State
FROM
(
SELECT
X.CusID,
X.Name,
( SELECT MAX ( State ) FROM Address T WHERE T.PhyAddress = 1 AND T.CusID = X.CusID ) AS S1,
( SELECT MAX ( State ) FROM Address T WHERE T.PhyAddress = 0 AND T.CusID = X.CusID ) AS S0
FROM Address AS X
) AS Y
"
22363,66125,Get a list of all functions and procedures in an Oracle database,"SELECT * FROM ALL_OBJECTS WHERE OBJECT_TYPE IN ('FUNCTION','PROCEDURE','PACKAGE')
"
39839,62696,Oracle output in sqlplus,"SET serververoutput ON;
"
7889,29681,Looking for help on obtaining Universal Product Identifiers,"5033290500900 is the 13-digit number allotted by the manufacturer;  
50            indicates UK  
  33290       indicates the manufacturer (Biocare)  
       50090  is the individual item number allotted by the company  
            0 is the checkdigit  
"
18197,48610,Issue with SQL statement with joins on a double aliased table,"SELECT sum(case when sale.value >= 500 then 1 else 0 end) as above500, 
       sum(case when sale.value < 500 then 1 else 0 end) as below500, 
       employee.name 
FROM   employeesale es 
       INNER JOIN employee 
               ON es.employeeid = employee.id 
       LEFT JOIN sale
              ON es.saleid = sale.id 
group by employee.name
"
12567,51053,IP range in pg_hba.conf for remote access to pgsql,"host <database_name> all 10.240.0.0/16 md5
"
21602,57821,At most N rows from each group,"SELECT c1.id, c1.name, c1.company, c1.addr1
FROM CustomerDB c1 LEFT JOIN CustomerDB c2
    ON (c1.addr1 = c2.addr1 and c1.id >= c2.id)
GROUP BY c1.addr1, c1.id, c1.name, c1.company
HAVING COUNT(*) <= 3​
"
27857,74685,how do I select numeric value by a pattern in SQL,"SELECT * FROM transaction1 WHERE CAST(Price AS text) LIKE '%51%';
"
24270,39207,SELECT * FROM WHERE does not find all records,"UPDATE saleslog SET status = 'Pending' WHERE status LIKE '%Pending%'  
"
33716,56496,Merge/combine fields from two database tables,"select 
p.id_product,
p.reference,
s.quantity,
p.price,
p.wholesale_price
from ps_product p
join ps_stock s on s.id_product = p.id_product
"
20247,43720,Access (ADO) query between two hour ranges,"WHERE TimeValue([Date_Time_Of_Birth]) Between #16:00:00# and #18:00:00#

WHERE TimeValue([Date_Time_Of_Birth]) Between #4 PM# and #6 PM#
"
419,443,Turn value into singular row,"declare @T table (  
  Name varchar(50),  
  Sales int  
)

insert into @T values ('Stella',   '2')  
insert into @T values ('Jennifer', '2') 
insert into @T values ('Greg',     '3')

-- Recursive verion
;with People (Name, Sales) as
(
    select Name, Sales
    from @T
    union all
    select Name, Sales - 1
    from People
    where Sales - 1 > 0
)
select Name, 1 as Quantity
from People
option (maxrecursion 0) -- Recurse without limit
"
13620,71879,UPDATE script that runs with SQL-Server as well with PostgreSQL,"UPDATE address a
SET countrycode = (
      SELECT s.isocode
      FROM country s
      WHERE a.idcountry = s.id
);
"
4388,70856,SQL Select column-spanned data over row-spanned,"select report_month
,      substring(convert(varchar, dateadd(month, 1 /*month nr*/, convert(date, report_month + '01', 112)), 112), 1, 6) forcast_month
,      forecast_01 forecast_value
from   tableName
union
all
select report_month
,      substring(convert(varchar, dateadd(month, 2 /*month nr*/, convert(date, report_month + '01', 112)), 112), 1, 6) forcast_month
,      forecast_02 forecast_value
from   tableName
"
8068,24590,"Comparing 2 columns in the same table with the ""Like"" function","SELECT NodeName, DNS
WHERE DNS NOT LIKE NodeName + '%' AND DNS NOT LIKE '%' + NodeName + '%'
"
11295,68677,How to get a specific combination of columns in MySQL,"select 
 e.employee_id, e.salary as emp_salary, e.manager_id, m.salary as mgr_salary
from employees as e
left outer join employees as m on m.employee_id=e.manager_id
where e.salary > m.salary
"
420,47154,"Subtract rows from a table, using subquery which may be empty","SELECT A.* 
FROM A
LEFT JOIN B
ON A.value = B.value
WHERE b.value IS NULL
"
5396,5076,Is there a way to specify location in string when using SQL REPLACE?,"UPDATE table
SET field = (case when right(field, 7) = ',Friday'
                  then left(field, len(field) - 7)
                  else field
             end)


UPDATE table
SET field = (case when left(field, 7) = 'Friday,'
                  then right(field, len(field) - 7)
                  else field
             end)
"
27195,65794,Combination of columns as table's primary key,"  CREATE TABLE IF NOT EXISTS tableName (    
       id_1 INT NOT NULL,
       id_2 INT NOT NULL,
       id_3 INT NOT NULL,
       id_4 INT NOT NULL,
       value VARCHAR(10) NULL,
       CONSTRAINT pk PRIMARY KEY (id_1, id_2, id_3, id_4)
    );
"
4973,39012,MySQL count column values equal to another column,"select a.id, 
  coalesce(b.id_1_count,0), 
  coalesce(c.id_2_count,0)
from so15273831 a
left outer join (
  select id_1, count(*) as id_1_count
  from so15273831
  group by id_1
) b on b.id_1 = a.id
left outer join (
  select id_2, count(*) as id_2_count
  from so15273831
  group by id_2
) c on c.id_2 = a.id
order by a.id;
"
36739,7148,SQL rand() dependent on another column?,"ALTER TABLE tableA ADD version AS CHECKSUM(CityName)  PERSISTED
"
24349,54020,How to handle DROP TABLE if there is a view on a table?,"SELECT DISTINCT so.name,so.xtype
FROM syscomments sc
INNER JOIN sysobjects so ON sc.id=so.id
WHERE sc.TEXT LIKE '%YOUR TABLE%'
"
39125,20535,Should I use indexes for a many-to-many database table?,"CREATE TABLE user_movies (
  user_id INT NOT NULL,
  movie_id INT NOT NULL,
  PRIMARY KEY (user_id, movie_id),
  FOREIGN KEY (user_id) REFERENCES users(user_id),
  FOREIGN KEY (movie_id) REFERENCES movies(movie_id)
) ENGINE=InnoDb;
"
11183,63724,execution time of a stored procedure,"time dbaccess <dbname> file.sql
"
16372,8895,Solution to #13 of SQL Join in SQLZoo,"SELECT mdate, 
       team1, 
       SUM(CASE WHEN teamid = team1 THEN 1 ELSE 0 END) AS score1, 
       team2, 
       SUM(CASE WHEN teamid = team2 THEN 1 ELSE 0 END) AS score2 FROM
    game LEFT JOIN goal ON (id = matchid)
    GROUP BY mdate,team1,team2
    ORDER BY mdate, matchid, team1, team2
"
20422,18511,Calculate difference of the records in a same column,"CASE WHEN KPI IN (1, 4) THEN ACTUAL
     WHEN KPI = 2 THEN KPI / MIN(CASE WHEN KPI = 1 AND KPI <> 0 THEN ACTUAL END) 
                             OVER (PARTITION BY DATE, DIVISION)
     WHEN KPI = 3 THEN KPI / MIN(CASE WHEN KPI = 3 AND KPI <> 0 THEN ACTUAL END) 
                             OVER (PARTITION BY DATE, DIVISION)
END
"
39573,55574,Search query to fetch data,"WHERE
    (Id = '101' OR Id IS NULL) AND
    (name = 'Kumar' OR name IS NULL) AND
    (age = '21' OR age IS NULL)
"
24850,70376,SQL Same ID Populated in Multiple Rows with Different Column Values Populated--Need One ID in One Row,"select id, max(col1) as col1, max(col2) as col2, max(col3) as col3, max(col4) as col4
from t
group by id;
"
6341,26682,SQL Select combine text to a selected item?,"SELECT
   A.PractitionerId,
   'http://www.icuro.co.za/WebForms/Members/Appointments/AppointmentView.aspx?id=' + CAST(A.AppointmentId as varchar(50))
FROM
   Appointment AS A WITH (NOLOCK)
"
15571,39596,SQL date conversion year/datepart to datetime,"DECLARE @tick varchar(20) = '0000113326'
SELECT dateadd(d, cast(right(@tick, 3) as int) - 1, '20' + substring(@tick, 6, 2) + '0101')
"
13370,28252,Selecting 1 word out of a field using SQL,"select 'SRN='+left(stuff(@S, 1, charindex('SRN=', @S)+3, ''), patindex('%[^0-9]%', stuff(@S, 1, charindex('SRN=', @S)+3, '')+' ')-1)
"
12880,55578,Getting data from different tables and databinding same repeater,"select Es.recid,Es.othercolumn, Es.estatetype, Es.otherColumn from Estatetypes Es,record rec where Es.ID = rec.EstatypeID
"
39562,64248,Postgresql turn null into zero,"select coalesce(max(column), 0) from mytable; 
"
3965,43762,select statement over multiple columns in SQLite,"sqlite> select issue,url,steps from help where kw1='ie' or kw2='ie' or kw3='ie' or kw4='ie' or kw5='ie' or kw6='ie' or kw7='ie' or kw8='ie' or kw9='ie' or kw10='ie' or kw11='ie' or kw12='ie';
"
7942,34999,Count and group by join,"SELECT
    products.product,
    COUNT(users.prod_id) AS productsBought
FROM
    A AS products
    INNER JOIN B AS users
        ON products.prod_id = users.prod_id
WHERE products.site_name = 'ebay'
GROUP BY products.product
"
13503,44764,Combine a column in select statement if multiple data is present,"decode(count(distinct prl.suggested_vendor_name) over (partition by prh.requisition_header_id),1,prl.suggested_vendor_name,0,null,'MULTIPLE')
vendor
"
11040,61847,MySQL UPDATE query with nested SELECT query,"UPDATE
    `my_table`
SET
    `my_column_1` = 0
WHERE 
    `my_column_2` = 35
    AND `my_column_3` = 3
    AND `id` != 136
"
22446,55786,Why subquery does not work in teradata?,"SELECT * 
FROM
(
 SELECT *
FROM mytable
) as MY_TABLE;
"
29826,20615,Oracle SQL Query - Help Required,"SELECT T1.PARAM_VAL AS MANUFACTURER,
       T2.PARAM_VAL AS COUNTRY,
       MAX(T1.ID) AS MAX_ID_VAL
FROM TB_TEST_01 T1,TB_TEST_01 T2
WHERE
       T1.ID = T2.ID
   AND T1.PARAM_NM='MANUFACTURER'
   AND T2.PARAM_NM='COUNTRY'
GROUP BY
   T1.PARAM_VAL,T2.PARAM_VAL
"
36209,42105,T-SQL IF-ELSE,"SELECT
    MemberID,
    ProfileTypeID
    PrCountryID,    -- 3
    PrStateID,      -- 4
    PrStateInt
FROM Member
WHERE PrCity IS NOT NULL
AND Viewable = 'Y'
AND SystemID = 2
AND ( @ShowUnclaimed != 'N' 
      OR ( Clamed = 'Y' AND SBIcon = 'N' )
    )
"
3778,56875,SQL View Attributes,"SELECT view_name, Table_Name
FROM INFORMATION_SCHEMA.VIEW_TABLE_USAGE
WHERE View_Name = '<giveViewName>'
ORDER BY view_name, table_name
"
32645,52387,find a date when sales for id reach some level,"SELECT user_id, MIN(pay_date)
FROM 
 (
   SELECT pay_date, user_id,
      SUM(transaction_sum) -- cumulative sum based on pay_date
      OVER (PARTITION BY user_id
            ORDER BY pay_date
            ROWS UNBOUNDED PRECEDING) AS cum_sum
   FROM tab
 ) AS dt
WHERE cum_sum > 100 -- only rows where cumulative sum exceeds limit 
GROUP BY user_id
"
4492,56919,Laravel 4.x migrations on production environment,"if( App::environment() === 'dev' )
{
    $this->call('UserTableSeeder');
} 
"
26895,47635,select specific records with specific ordering without using a common condition,"select studentId, studentName from (
    select 1 as rowOrder, studentID, studentName from <table> where studentID = 4 UNION ALL
    select 2, studentID, studentName from <table> where studentID = 2 UNION ALL
    select 3, studentID, studentName from <table> where studentID = 3 UNION ALL
    select 4, studentID, studentName from <table> where studentID = 5 UNION ALL
    select 5, studentID, studentName from <table> where studentID = 7) as x
order by rowOrder
"
26443,30280,SQL get data from column(YYY0) with same number as different column(XXXX0) with the maximum date,"SELECT id,
CASE
WHEN YYYY0 > YYY1 AND YYY0 > YYY2 ... AND YYY0 > YYY9 THEN XXX0
WHEN YYY1 > YYY2 ... AND YYY0 > YYY9 THEN XXX1
...
ELSE XXX9 AS LabelX,
CASE
WHEN YYYY0 > YYY1 AND YYY0 > YYY2 ... AND YYY0 > YYY9 THEN YYY0
WHEN YYY1 > YYY2 ... AND YYY0 > YYY9 THEN YYY1
...
ELSE YYY9 AS LabelY,
...
"
3395,61357,SQL Join using on the fly alias column,"LEFT JOIN (SELECT
           --attributes you need from projects... 
           CONCAT(p1.open_year,'-',p1.open_month,'-',COALESCE(NULLIF(p1.open_day,''), '30')) AS open_date 
           FROM projects) p1 ON (restaurants.id = p1.restaurant_id)
"
30274,54303,having count don´t work," select l.descripcion, count(r.cod_cliente) from reclamo r
        join cliente c on r.cod_cliente = c.cod_cliente 
        join localidad l on c.cod_localidad = l.cod_localidad
        group by l.descripcion
        having count(r.cod_cliente) >10;
"
53,20453,What's the appropiate method to store values from fragments?,"public class MyDatabaseHandler extends SQLiteOpenHelper{
    private static MyDatabaseHandler databaseHandlerInstance; 

    public static synchronized MyDatabaseHandler getInstance(Context context) {
      if(databaseHandlerInstance ==  null)
         databaseHandlerInstance = new MyDatabaseHandler(Context context);

      return databaseHandlerInstance;
    } 

    public MyDatabaseHandler(Context context){
        // Call to super class
        //
    }

   // ..... onCreate calls
}
"
19646,16037,PostgreSQL CSV import from command line,"psql -c ""COPY tbname FROM '/tmp/the_file.csv' delimiter '|' csv;""
"
24608,49170,How can I add the array to the array of arrays in SQL (Postgres),"select '{{1,A, 1},{A,B,C},{45,46,47}}'::text[] || '{Z, T, null}';
                ?column?                 
-----------------------------------------
 {{1,A,1},{A,B,C},{45,46,47},{Z,T,NULL}}
"
6235,35904,Classifying months in periods,"select
    year, mn,
    row_number() over (order by year, mn) as period
from t
"
15679,5827,Sql query to find difference between date,"SELECT DATEDIFF(SELECT DATE_ADD(start_date,INTERVAL 1 DAY),end_date);
"
39755,32657,"SQL find latest dates, why do we need the 'inner join'","username      ip              timestamp
--------      --------------  ---------
bob           167.49.122.122  2016-01-05
john          167.49.122.123  2016-02-02
bob           167.49.122.124  2016-04-01
"
5151,18705,SQL Report Builder: get another value from a parameter?,"=Lookup(Parameters!Month.Value, Fields!Month.Value, Fields!FinYearStart.Value, ""MonthsDataset"")
"
24122,57325,How can I add a condition to a WHERE clause depending on a separate table's value when given an ID for that table?,"SELECT COUNT(s.id)
FROM salesperson s, businesstrip b
WHERE b.id = @BusinessTrip_ID
  AND s.isEligibleForTrip
  AND (s.canSpeakFrench OR NOT b.requiresFrench)
"
38099,6078,ORM Django LEFT JOIN + GROUP BY,"def last_contract_expire():
    return Player.objects.all().annotate(max_date_leaved=Max('membership__date_leaved'))
"
14688,41545,How do I get the index of VARRAY items after converting to a table," select t1, row_number() over ( partition by t1 order by t1), t2.* from
 (select 'X' as t1 from dual UNION select 'Y' from dual) t1,
 table (sys.odcivarchar2list('a', 'b', 'c'))             t2;
"
34998,30443,connecting to sybase DB in perl without DBI,"#!/usr/bin/perl

use strict;
use warnings;

my $result = qx { isql -Uxx -Pxxxxxxx -Dxxxx <<EOF
set nocount on
select count(*) from XXX
go
exit
EOF
};
print ""result is :"";
print $result;
print ""\nbye bye\n"";
"
30548,23808,MySQL: copy information from table to another with opposite value,"update 
user u join details d on d.user_id = u.id 
set u.appear = case when d.appaer = 'true' then 'false' else 'true' end ;
"
36865,32022,How to build a conditional SQL query,"SELECT * FROM table WHERE startDate < NOW() AND
                          (endDate IS NULL OR endDate > NOW())
"
5109,54917,OrderBy a relation in an entity,"$query = $repo->createQueryBuilder('p')
    ->join('p.dogShowClass', 'd')
    ->orderBy('d.weight', 'ASC')
    ->getQuery()
;
"
6356,44785,SQL how to count the number of credit cards that had x transactions per month,"select yr, mon,
       sum(cnt >= 1) as trans_1,
       sum(cnt >= 5) as trans_5,
       sum(cnt >= 10) as trans_10,
       sum(cnt >= 20) as trans_20
from (select year(transdate) as yr, month(transdate) as mon, card_id, count(*) as cnt
      from trans
      group by card_id, year(transdate), month(transdate)
     ) d
group by yr, mon;
"
7587,18879,Query by a LONG column,"select 
   dbms_lob.instr(clob_contents,'TLP')
from 
   (select 
        dbms_metadata.get_ddl('VIEW','LOCKED_DOCUMENTS_V', 'SCHEMA') clob_contents 
    from 
        dual) get_clob
"
2261,57501,SQL MAX() function selects the greatest in absolute value even if I don't use ABS()?,"SELECT TAG, MAX(cast(VALUE as decimal(10,1)))
FROM TABLE
GROUP BY TAG
"
15093,56012,Outer Join or NOT IN,"SELECT     titles.title_id, titles.title, publishers.pub_id, sales.payterms,   
           titles.price, titles.advance, titles.royalty

FROM       publishers INNER JOIN
           titles ON publishers.pub_id = titles.pub_id LEFT JOIN
           sales ON titles.title_id = sales.title_id
WHERE     sales.qty IS NULL
"
19505,24250,Programmatically Determine Tables/Other Objects Referenced in an Oracle Stored Procedure/Package,"select * from user_dependencies where name='NAME_OF_YOUR_PROCEDURE';
"
28665,53507,How do I create a SQL query to increase an amount by a percentage?,"UPDATE table1
    SET amount = (case when amount < 140 then amount * 1.07
                       else amount * 1.05
                  end);
"
3944,24075,SQL - AND statements,"select `enum`
from table1
group by `enum`
having sum(package = 'ACCESS') > 0 and
       sum(package = 'HTML') > 0;
"
20703,43711,Running Total with minimum balance after modulus,"WITH RunningTotal AS (
SELECT Id, ListItem, SUM(ListItem) OVER (ORDER BY Id) AS RT FROM     @Table)


SELECT Id, ListItem, RT, CASE WHEN RT > 100 THEN RT % 50 + 50 ELSE RT END AS NewRT
FROM RunningTotal
"
21401,13262,SQL Server 2005 - T-SQL - How to generate int ID?,"CREATE TABLE dbo.YourTable( ID INT IDENTITY(1,1) ......
"
24395,14625,How to write case in where statement in sql server,"where  @colorParameter = 'RED' 
       or ( @colorParameter <> 'RED' and tblplant.color <> 'RED')
"
35037,58923,Oracle Statement for outer join,"SELECT M.ModuleID, M.ModuleData, M.ModuleSectionID, U.UserProfileID, U.UserID, U.ModuleID
    FROM Module m, UserProfile u 
 WHERE M.ModuleSctionID = <MODULE_SECTIONID_PARAMETER>
 AND M.ModuleID = U.ModuleID(+)
 AND <USER_ID_PARAMETER> = U.UserID (+)
"
27126,21336,Translate SQL Query into LINQ Query,"db.Server
    .Where
    (
        x=>
            db.Gruppen
            .Where(g=>g.Id == 1)
            .Select(g=>g.Name)
            .Contains(x.GruppenName)
    );
"
2411,53168,How to retreive Max Date from a left outer join?,"SELECT client_headquarter.id, max(clients.tscreated)
FROM client_headquarter 
LEFT OUTER JOIN clients ON clients.headquarterid = client_headquarter.id
GROUP BY client_headquarter.id
ORDER BY MAX(clients.tscreated) ASC
"
35976,30875,Delete duplicated rows and Update references,"--updates the data table to the min ids for each name
update Data
set id = final_id
from
  Data
join
  Doubles 
on Doubles.id = Data.id
join
(
  select 
    name
    min(id) as final_id
  from Doubles
  group by name
) min_ids
on min_ids.name = Doubles.name

--deletes redundant ids from the Doubles table
delete 
from Doubles
where id not in
(
  select 
    min(id) as final_id
  from Doubles
  group by name
)
"
6084,46283,Help with select MS Sql Select statement,"select UserID,  min(Num1),  min(Num2), min(Code), min(Name), max(Cat)
from tbl
group by userID
"
2286,40897,How to insert a record in many to many relationship tables?,"alter table teacher_student
   add constraint s_t_fk_t foreign key (T_Id)
   references teachers (id)
   on delete cascade
   on update cascade;

alter table teacher_student
   add constraint s_t_fk_s foreign key (S_Id)
   references students (id)
   on delete cascade
   on update cascade;
"
38263,45591,Data annotation validation for determining rage of data does not work,"Microsoft jQuery Unobtrusive Validation (at least 2.0.30116.0)
Microsoft jQuery Unobtrusive Ajax (at least 2.0.30116.0)
jQuery Validation 1.11.1
"
19780,36821,One select on two tables with NULL and not null,"select ID
      ,NAME
      ,COLOR
      ,COMPANY_SHORT_NR
from table1
     LEFT OUTER JOIN table2 ON ( COMPANY_SHORT_NR = SHORT )
"
8845,6002,Compare only DATE from 2 datetime columns - sql,"Select * from Admissions
Where DATEDIFF(dd,AdmitDateTime,DepartDateTime)=0
"
29579,36203,Data not fetch on where clause,"CASE WHEN d.ReceiptFrequency='Annual' THEN 1 WHEN d.ReceiptFrequency='Quarter' THEN 1 WHEN d.ReceiptFrequency='Month' THEN 12 WHEN d.ReceiptFrequency='SemiAnnual' THEN 2 ELSE 1 END -1))
"
16986,40353,Select next value where it equals another value,"select 1 + year(dateadd(day, -7 * week_number, week_ending_date))
"
21603,60519,mysql get free spots in query,"select t.Id
from Tent as t
left join (
    select p.tentId, count(*) as occupiedSpots
    from person as p
    group by p.tentId) as i ON i.tentId = z.id
where t.numberOfSpots > IFNULL(i.occupiedSpots,0)
"
35595,6058,Insert values in table only one column changes value,"INSERT INTO table(GROUP_ID, PROJECTS)
    select 10001, 1 from dual union all
    select 10001, 2 from dual union all
    . . . ;
"
12433,2053,"MySQL/ASP Paging, COUNT with LIMIT","select count(*)
from (
    <whatever is your main query goes here, without LIMIT>
)
"
9377,45293,Predicate for NSFetchRequest Core Data based on content in other entity list,"[NSPredicate predicateWithFormat:@""(first_user_id = %@ OR second_user_id) AND status = %@"",@(u_id),@(u_id),@""CONF""];
"
38277,17905,"sql, number of user of each group","select g.Name, count(u.usergroupId) as members
from groupUser g left join user u 
on  u.usergroupId = g.id
group by g.Name
"
19383,72907,Summing a column value in a table including duplicates,"select 
 classID, 
 Name, 
 Days, 
 sum(specHours) as TotalSpecHours 
from 
 (
 select distinct ClassId, Name, Days, SpecHours from myTable )t
  group by classID, Name, Days
"
31361,44131,Statistics Query Water Quality MS ACCESS,"SELECT [SITE ID], [Parameter],
       Min(Results) As MinOfResults,
       Max(Results) As MaxOfResults,
       Avg(Results) As AvgOfResults,
       StDev(Results) As StDevOfResults,           
       Count(Results) As CountOfResults
FROM Chemistry1
WHERE [SITE ID] = 'LB-100' 
  AND [Parameter] = 'Calcium, Dissolved'
  AND Year([SampleDate]) = 2014
GROUP BY [SITE ID], [Parameter]
"
5192,18598,How to find the query sent through ODAC to Oracle Database when using Entity Framework (EF),"cshay Dec 3, 2011 9:58 AM (in response to 900653)
You can turn on ODP.NET tracing. See the ODP.NET doc for more details:

1) Close VS
2) In windows registry, change registry value 
    \\HKEY_LOCAL_MACHINE\SOFTWARE\ORACLE\ODP.NET\4..........\TraceLevel
    to 1
3) Relaunch VS
4) Reproduce the problem
5) Close VS2010
6) Look for the odpnet trace file in the root of C I believe.
7) Undo the registry value (set it back to 0) so you don't impact performance
"
30686,38887,Sql recursive query to read hierarchical data,"   SELECT childid
   FROM btab
   START WITH parentId = 1
   CONNECT BY PRIOR  childId = parentId;
"
38583,66089,"SQL Server - Select Rows, Remove Duplicates But Keep row with highest date",";WITH Actions AS
(
   SELECT 
       ActionID, ActionType, ActionDate, UserID, ContentID,
       RowNum = ROW_NUMBER() OVER(PARTITION BY ContentID, ActionType ORDER BY ActionDate DESC)
   FROM 
       dbo.YourTable
   WHERE
      ......
)
SELECT 
   ActionID, ActionType, ActionDate, UserID, ContentID,
FROM 
   Actions
WHERE
   RowNum = 1
ORDER BY 
   ActionDate DESC
"
29358,36919,Beginner SQL question(s),"UPDATE c
SET c.CreditLimit = c.CreditLimit * 1.25
FROM Customers c
WHERE 
(SELECT COUNT(*) FROM Orders o WHERE o.CustomerId = c.CustomerId AND o.OrderAmount > 250)
>= 2
"
26897,38819,loop with variable in sqlite3,"use strict; use warnings;

my $formatString = ""attach 'database%04d.db3' as toimport;
insert into [main].[Titles] select * from [toimport].[Titles];
insert into [main].[TitlesData] select * from [toimport].[TitlesData];
DETACH DATABASE toimport;\n"";

for (my $variable = 1; $variable <= 30; ++$variable) {
        printf ($formatString, $variable);
}
"
4172,1413,Sails.js expireAfterSeconds option in the model,"// config/bootstrap.js
exports.bootstrap = function (done) {

    YourModelName.native(function (err, collection) {
        // define index properties
        collection.ensureIndex( { ""createdAt"": 1 }, { expireAfterSeconds: 3600 } );

        // be sure to call the bootstrap callback to indicate completion
        done();
    });
}
"
8734,66484,Write a self join query?," select E1.ID,E1.EmpName, E.EmpName as BossName from #tmpEmployee E right join #tmpEmployee E1 on E1.EmpBossID=E.ID

ID  EmpName BossName
1   Abhijit Haris
2   Haris   Sanal
3   Sanal   NULL
"
16426,65326,Why does Create Table create a weirdly named key for the primary key?,"CREATE TABLE [dbo].[TableExample] 
(
     [TEID] [int] IDENTITY(1,1) NOT NULL,
     CONSTRAINT [PK_TableExample] PRIMARY KEY CLUSTERED ([TEID] ASC)
)
"
11089,18673,MSSQL - No Result or NULL,"IF EXISTS (
SELECT myValue FROM myTable WHERE asd = 'thisIs'
) 
BEGIN
    SELECT myValue FROM myTable WHERE asd = 'thisIs'
END
ELSE 
BEGIN
    EXEC SomeOtherCode
END
"
23376,49281,Join table and applying filter?,"select p.ServiceID, i.InsuraneID, i.Name, p.Amount, p.Month, p.Type
from Pymt p
inner join Ins i on p.InsuranceID = i.InsuranceID
where p.Month='Jun15' and p.Type=1
"
29104,56700,"update tab1 set col1=col2,col2=col1","UPDATE  tabl
SET     col1 = col2,
        col2 = col1
"
14228,45832,How to substract the results of queries from each other?,"select l1.name
from table_1 l1
where not exists (select 1 from table_2 l2 where l2.name = l1.name) and
      not exists (select 1 from table_3 l3 where l3.name = l1.name);
"
25992,13485,Combining two queries,"select w.*
from user_groups ug
inner join widget_access_permissions wap on ug.id = wap.allowed
inner join widgets w on wap.widget_id = w.widget_id
where ug.employee_code = @user
and w.widget_name like @phrase
EXCEPT
select w.*
from user_groups ug
inner join widget_deny_permissions wdp on ug.id = wdp.denied
inner join widgets w on wdp.widget_id = w.widget_id
where ug.employee_code = @user
and w.widget_name like @phrase
"
11355,30069,Oracle SQL Current and previous status in the same output record,"   SELECT last_name, hire_date, salary,
   LAG(salary, 1, 0) OVER (ORDER BY hire_date) AS prev_sal
   FROM employees
   WHERE job_id = 'PU_CLERK';
"
35663,18012,Access 2010 conditional selection in query,"SELECT Asset_ID, 
       Asset_Description, 
       Problem_ID
       IIF(IsNull(Date), Helpdesk_Person, CStr(Date) + Description) as Solution
FROM Problems
"
6965,60595,Query optimization on a Table with 1 Million rows,"CREATE NONCLUSTERED INDEX NCI_TB_AGENDA_VENDEDOR_VENDEDORES_EMAIL 
    ON [TB_AGENDA-VENDEDOR_VENDEDORES] (EMAiL)
"
1435,40777,Query database where month is equal to,"... MONTH(STR_TO_DATE(matrix.col_id_3,'%Y%m%d')) = 1 ...
"
28766,46967,Django Model ValueError,"if form.is_valid():
  faculty_str = form.cleaned_data['faculty']
  (faculty, was_created) = Faculty.objects.get_or_create(name=faculty_str, ...)
  # It's hard to tell if you are using a ModelForm or just a normal Form. Anyway, assume we already have access to the Subject object
  subject.faculty = faculty
  subject.save()
"
33133,52590,How to use a parameter for varchar length in TSQL?,"DECLARE
      @interval INT = 121
    , @length INT = 10;

SELECT LEFT(CONVERT(VARCHAR(100), GETDATE(), @interval), @length)
"
607,74905,Find duplicate records in MySQL without named column,"select distinct lead_id
from tablename as t1
where exists (
  select 1
  from tablename as t2
  where t1.field_number = t2.field_number
  and   t1.value = t2.value 
  and   t1.lead_id <> t2.lead_id 
  )
"
19941,72464,How to separate positive and negative numbers into their own columns?,"select activity_dt, sum(case when activity_amt < 0 then activity_amt else 0 end) as debits, sum(case when activity_amt > 0 then activity_amt else 0 end) as credits
from the_table
group by activity_dt
order by activity_dt
"
9812,50140,removing non-matching rows based on order in SQL within a WITH statement,"SELECT tc.*, inml.ItemName
FROM ItemCategories tc left outer join
     (select inml.*, row_number() over (partition by inml.ItemId order by hasname, langId) as seqnum
      from ItemNameMultiLang
     ) inml
     on tc.ItemItem = inml.ItemId and
        inml.seqnum = 1
ORDER BY tc.ItemId;
"
10638,70074,Improve join performance,"select *
from a join
     b
     on a.ACCOUNT_NUMBER = b.ACCOUNT_NUMBER AND
        TRUNC(a.CREATE_DATE) BETWEEN b.START_DATE AND b.END_DATE;
"
14822,48221,How to select all rows where mycolumn is an integer value?,"SELECT * FROM mytable WHERE mycolumn REGEXP '^[0-9]+$'
"
26904,44739,How to get separate fields data with IF() statement in single query,"SELECT
    SUM( IF(i.status = 'unpaid', i.total_amount, 0) ) unpaid, 
    SUM( IF(i.status = 'partial', i.paid_amount, 0) ) partial 
FROM {CI}invoices i 
WHERE
    i.customer_id = ? AND
    date(i.invoice_date) < '2014-01-01' AND
    i.status IN ('unpaid', 'partial')
"
17506,36154,Cast irregular string to integer,"SELECT * 
FROM table 
WHERE CAST(SUBSTRING(bad_column, 1, CHARINDEX('+', bad_column)) AS INT) = 23;
"
12579,21128,Oracle partitioning solution for DELETE performance problem,"CREATE PROCEDURE add_case (case_id, ...) AS
BEGIN
   EXECUTE IMMEDIATE 'ALTER TABLE OptimizationRun ADD partition...';
   /* repeat for each child table */
   INSERT INTO Case VALUES (...);
END;
"
19643,38089,Merge two different rows in a table if most of the columns hold the same data except two which are alternatingly null,"SELECT  ID, 
        MAX(Included) Included,
        MAX(Excluded) Excluded
FROM    TableName
GROUP   BY ID
"
29234,24581,How to select from a DATETIME column using only a date?,"SELECT * 
FROM myTable
WHERE date(postedOn) =  '2012-06-06'
"
14776,34060,NodeJS + MongoDB: find() with specific conditions,"var condition = {
    ""stain"": ""false"",
    ""black"": ""true"",
    ""titan"": ""false"",
    ""special"": ""true"",
}

for (var i in condition) {
    if (condition[i] != ""true"") {
        delete condition[i];
    }
}

collection.find(condition ,function(err, companies) {
    companies.each(function(err, company){
        //do smth with found
    });
});
"
4293,37429,Substring - T-SQL,"with a as
(select 'abc_ Part1ID =efg_ Part2ID =jkl' a)
select a,
       substring(a,
                 charindex('_ Part1ID =',a)+len('_ Part1ID ='),
                 charindex('_ Part2ID =',a)-charindex('_ Part1ID =',a)-len('_ Part1ID ='))
from a
"
35517,69671,MySQL Where NOT IN curDATE(),"select d.*
from deals d
join deals_bookings b on d.id = b.deal_id
where b.date > curdate()
  and b.deal_id not in (
    select deal_id
    from deals_bookings
    where date <= curdate()
)
order by b.date desc
"
20977,11951,need to update timestamp field by subtracting 4 hours from each record,"UPDATE yourtable SET created_at = created_at - INTERVAL 4 HOUR;
"
38872,22914,How to count students who got equal marks and also show the marks of that group in SQL Server,"select count(StudentName) as NoOfStudents, marks
from tablename
group by marks
order by marks desc
"
5273,49091,String compare in SQL Server !,"update T1 set WorkerName = T2.WorkerId
from T1, T2
where T1.WorkerName like T2.WokerName + ',%'
"
15939,57128,Dynamic Like Statement in SQL,"SELECT column 
  FROM table AS T1
       INNER JOIN Params AS P1
          ON T1.column LIKE '%' + P1.param + '%';
"
20593,25512,SQL delete from related tables,"DELETE a 
FROM tGeoQuestions as a
JOIN tGeoQuizToQuestion as b 
ON a.id = b.questionid
AND b.quizId = @quizId


DELETE tGeoQuizToQuestion  WHERE quizId = @quizId
"
31468,26199,Join two tables based on relationship defined in third table,"SELECT Activity.ActivityText as Activity, Action.ActionText as ApplicableAction
FROM ActivityAction
    INNER JOIN Activity
        ON ActivityAction.ActivityId = Activity.ActivityId
    INNER JOIN Action 
        ON ActivityAction.ActionId = Action.ActionId
"
6757,64337,Dynamically create tables based on comma delimited string in SQL stored proceedure,"BEGIN
       v_sql:='Create table empx (id int)';
       execute immediate v_sql; 
END;
"
6944,55004,Join Strings in Query output,"db.users.aggregate([
   { ""$project"": {
       ""FirstName"": 1,
       ""Lastname"": 1,
       ""FullName"": { ""$concat"": [ ""$FirstName"", "" "", ""$Lastname"" ] }
   }}
])
"
18394,54021,SELECT count(*) on Intermediary Table with Many-Many relationship Only if Exists in Both Related Tables,"SELECT c.idCourse, c.name, count(*) as count  
FROM courseusers as cu  
   LEFT JOIN course as c  
       ON cu.idCourse=c.idCourse  
   LEFT JOIN users as usr  
       ON (usr.idUser=u.idUser)  
GROUP BY u.idCourse 
ORDER BY count DESC  
LIMIT 3 
"
31430,44503,Fill the table with data (Player Rankings),"INSERT INTO totals (id_gamer, name_gamer, total_points)
SELECT p.id, p.name, IFNULL(SUM(g.points), 0)
FROM players AS p
LEFT JOIN games AS g ON p.id = g.id_gamer
GROUP BY p.id
"
36394,62104,SQL select duplicates on specific day,"SELECT 
      USERNAME
    , DATE_CREATED 
FROM 
(
  SELECT 
       USERNAME
    ,  DATE_CREATED
    ,  COUNT( *) over ( PARTITION by USERNAME, TRUNC( DATE_CREATED, 'DD') ) cnt
  FROM THE_TABLE
)
WHERE cnt > 1
;
"
27423,46846,Syntax for adding inverted commas in T-SQL using Visual Studio (SQL),"where ',' + @PostCode + ',' like '%,' + PCode + ',%'
"
7223,47974,Need to get rows where combination of two columns both exist and don't exit,"select ac.id1, ac.id2, count(ac.id1) as cnt
from (select distinct id1 from AllCovered) ac1 cross join
     (select distinct id2 from AllCovered) ac2 left join
     AllCovered ac
     on ac.id1 = ac1.id1 and ac.id2 = ac2.id2
group by ac.id1, ac.id2;
"
14316,22243,SQL Server 2005 - how to know if a field is a Primary Key?,"SELECT  
    T.TABLE_NAME
FROM  
    INFORMATION_SCHEMA.TABLE_CONSTRAINTS T 
    INNER JOIN 
        INFORMATION_SCHEMA.KEY_COLUMN_USAGE K 
        ON T.CONSTRAINT_NAME = K.CONSTRAINT_NAME  
WHERE 
    T.CONSTRAINT_TYPE = 'PRIMARY KEY'  
    AND K.COLUMN_NAME = @column_name
"
1642,37142,How do I perform a simple join on multiple tables?,"SELECT p.*,
       m.first_name,
       m.last_name
FROM payments p
INNER JOIN members m
  ON m.member_id = p.member_id
INNER JOIN member_to_group mg
  ON mg.member_id = m.member_id
WHERE mg.group_id = 12
"
10808,23005,How can I replace all values in this string?,"with s as (
select 'Test size=""7"" size=""14"" text size=""14"" line=""22"" other size=""10""  size=""9"" ' as str
  from dual
       )
select regexp_replace(str, 'size=""\d+""', 'size=""8""', 1, 0)
  from s
"
27289,66950,Why INSERT /*+APPEND*/ is used?," insert into <table> SELECT * FROM ....
"
35515,14016,Crystal Reports without database & dataset,"    report.SetDataSource(objectList.ToArray())
"
18614,5227,Get highest count for specific rows,"select coalesce(max(t.cnt), 0) as max_cnt
  from (select count(*) as cnt
          from tbl
         where kat_id = x
           and type = 'A'
           and SubKat_ID is not null
         group by SubKat_ID) t
"
38335,23864,HsqlDB 1.8 Date Functions,"CAST ('2012-09-20 21:30:15.786' AS TIMESTAMP)
"
14792,32445,Copying only the Filename of Excel files from folder with the help of sas,"%macro list_excel(location);
filename _dir_ ""%bquote(&location.)"";
data _null_;
  handle=dopen( '_dir_' );
  if handle > 0 then do;
    count=dnum(handle);
    do i=1 to count;
      memname=dread(handle,i);
      if index(memname,'.xls') then  put memname;
    end;
  end;
  rc=dclose(handle);
run;
filename _dir_ clear;
%mend;

/* example usage */
%list_excel(C:\temp\); 
"
14808,1761,Dynamic SQL string wildcard % causes 'Invalid Column Name' in Visual Studio,"...  ' AND Username LIKE ''' + @Username + '%'''
"
12688,8908,Select rows with same other ID in join table,"select pa2.*
from person_address pa1 join
     person_address pa2
     on pa1.address_id = pa2.address_id and
        pa1.person_id <> pas2.person_id
where pa1.person_id = ?
"
26222,44422,How to select data from database higher than exact number,"SELECT userName,min(time) time 
FROM game WHERE time > 10 
group by userName 
order by time ASC LIMIT 15;
"
23561,60683,Flyway: How to support cleaning of multiple schemas with same lifecycle?,"flyway.schemas=schema1,schema2,schema3
"
13336,1883,Set default value on a field in a table only if null,"ALTER TABLE some_table
  ADD CONSTRAINT DF_some_field
  DEFAULT 'some_default_value'
  FOR some_field
"
36303,38880,Determining the connections to Mongo," > db.serverStatus().connections
 { ""current"" : 4, ""available"" : 15996, ""totalCreated"" : NumberLong(116) }
"
6101,66383,How can I find every row in a table where the value of a field is contained in a specific string?,"Select * From names where 'Bob Marley' Like CONCAT('%', FirstName, '%')
"
7819,27666,T-SQL: Include a row count as a column for unique rows,"SELECT Col1, Col2, Col3, COUNT(*) AS Total
FROM TableA
GROUP BY Col1, Col2, Col3
"
22800,74527,SQL Group By Percentage Increments,"select t.pcbracket as [% Bracket], count(*) as [NumWithMark]
from (
  select case  
    when mark between 0 and 9 then ' 0- 9'
    when mark between 10 and 19 then '10-19'
    when mark between 20 and 29 then '20-29'
    when mark between 30 and 39 then '30-39'
    else '40-100' end as pcbracket
  from testresults) t
group by t.pcbracket
"
36097,10041,SQL Server ISNULL / Coalesce still returning empty lists,"SELECT    COALESCE(b_limit, a_limit) AS limit
FROM      (SELECT 1 AS a_limit) a
LEFT JOIN (SELECT limit AS b_limit
           FROM   user
           WHERE  userID = 'testUser') b ON 1 = 1
"
20546,18216,SQL Query Giving Unique Fields Per User With Count,"SELECT Username,
       Choice,
       Count(Choice)
FROM   Likes
GROUP  BY Username,
          choice 
"
31248,15254,SQL Server - Query Execution Plan For Conditional Statements,"DECLARE @condition BIT

IF @condition = 1 
BEGIN 
 EXEC MyProc1
END 
ELSE 
BEGIN 
 EXEC MyProc2
END
"
36146,24156,Using delimiters to split column in T-SQL while skipping delimiters,"UPDATE Files 
SET Col_A = dbo.fnSplit(FileName, '_', 1),
    Col_B = dbo.fnSplit(FileName, '_', 2) 
        + '_' + dbo.fnSplit(FileName, '_', 3)
        + '_' + dbo.fnSplit(FileName, '_', 4),
    Col_C = dbo.fnSplit(FileName, '_', 5), 
    Col_D = dbo.fnSplit(FileName, '_', 6),
    Col_E = dbo.fnSplit(FileName, '_', 7)
etc
"
14202,29130,Select latest entry using date field (no repeats),"SELECT asset_id, entered_date, max(modified_date)
FROM price_data
GROUP BY asset_id, entered_date
"
3648,28851,First timers database schema for a MySQL database,"Q> Is this a structurally sound design?
A> Yes
Q> Is it inadvisable to have columns besides foreign keys in a linking table?
A> It's common to have additional columns
"
19700,66294,printing rank of a player and his(her) neighbors,"WITH ranking AS
(
  SELECT *,
         RANK() OVER (ORDER BY score DESC) userRank
  FROM   TableName  
)
SELECT *
FROM   ranking
WHERE  userRank BETWEEN
        (SELECT userRank - 1 FROM ranking WHERE userID = 'bbb') AND
        (SELECT userRank + 1 FROM ranking WHERE userID = 'bbb')
"
5249,11008,Counting Distinct ID,"SELECT COUNT(DISTINCT q_id) AS Count
FROM table1
WHERE q_id IN (
    SELECT q_id
    FROM table1
    GROUP BY q_id
    HAVING MIN(q_status)<> 'Called'
)
"
31394,15278,"select same data from two columns in a table, and using one sql statement to show all data","select * from em where (birth, high) in (('11/23','65'),('05/16','50'));
"
18286,64400,mysql - select rows between start year and start month to end year and end month?,"SELECT * FROM table AS t
WHERE  t.column1
       BETWEEN STR_TO_DATE(CONCAT('<start year>', '<start month>', '01'), '%Y%m%d') AND 
               LAST_DAY(STR_TO_DATE(CONCAT('<start end>', '<start end>','01'), '%Y%m%d'));
"
7873,30989,SQL Query to retrieve data while excluding a set of rows,"SELECT DISTINCT Id, ObjectName 
FROM Objects 
WHERE Id NOT IN (
SELECT DISTINCT ObjectDetails.ObjectID 
FROM ObjectDetails
INNER JOIN Components ON ObjectDetails.ComponentID = Components.Id
WHERE Components.ComponentName = 'A' OR Components.ComponentName = 'B'
)
"
8092,50894,How to show records were 3 fields match,"select *
from tab
qualify 
   count(*) 
   over (partition by field1, field2, field3) > 1
"
14305,72120,How to find values from one table to limit other table?,"SELECT *
FROM QuestionTable
WHERE ID NOT IN
    (SELECT IDOFQuestion as ID FROM tableQuestion WHERE USER = 'USERHERE')
"
35637,54705,"Sorting in SQL: Oldest records, but no repeat value within x rows","SELECT
  homepage_queue.photo
FROM
  homepage_queue
INNER JOIN
  photos
    ON photos.id = homepage_queue.photo
LEFT JOIN
  (SELECT photographer, COUNT(*) AS occurances FROM last_five GROUP BY photographer) AS last_five
    ON last_five.photographer = photos.photographer
ORDER BY
  last_five.occurances ASC,
  homepage_queue.queued_time
LIMIT
  1
"
16714,55111,Create a column and make it default to a value,"ALTER TABLE [myTable]
ADD [ShippingOption] [bit] NULL DEFAULT 1 WITH VALUES;
"
1850,60545,Select all rows from a table where value on a column differs from previous value on that column,"with C
(
  select *,
         lag(mycolumn) over(partition by company_id order by Date) as lagmycolumn,
         lead(mycolumn) over(partition by company_id order by Date) as leadmycolumn
  from YourTable
)
select company_id, Date, mycolumn
from C
where mycolumn <> lagmycolumn or
      mycolumn <> leadmycolumn
"
19133,32068,Performance: rank() vs sub-query. Sub query have lower cost?,"select * 
  from (select *
          from teste_rank r
          where data_mov <= trunc(sysdate) 
            and codigo = 1
        order by data_mov desc)
  where rownum=1;
"
33942,23962,Setting Oracle Timestamp with Coldfusion,"<cfquery name=""qTest"">
  insert into myTable(myTimestampCol)
  values (<cfqueryparam cfsqltype=""cf_sql_timestamp"" value=""#now()#"" />)
</cfquery>
"
15046,57931,SQL selecting specific field with defined values," SELECT ID, Value, case when LoopupID =1 then 'yes' else 'no' end as result
FROM Table1
"
23335,59720,Where Used Statements in SQL,"SELECT OBJECT_NAME(OBJECT_ID) AS NameofConstraint,
SCHEMA_NAME(schema_id) AS SchemaName,
OBJECT_NAME(parent_object_id) AS TableName,
type_desc AS ConstraintType
FROM sys.objects
WHERE type_desc LIKE '%CONSTRAINT'
AND  OBJECT_NAME(OBJECT_ID) LIKE 'FK_%'
"
6529,13186,mySQL : Sort ID by a given string of ID ? (Building breadcrumbs for hierarchical-data),"SELECT * 
FROM category
WHERE category_ID
IN ( 1, 6, 7, 8 ) 
ORDER BY category_ID =1 DESC , category_ID =8 DESC , category_ID =7 DESC , category_ID =6 DESC 
"
11663,46572,GRANT privileges on child table which specific parent,"ALTER TABLE Property ENABLE ROW LEVEL SECURITY;

CREATE POLICY Property_Administrator ON property TO Administrators
    USING (SELEcT true FROM condo WHERE condo.condo_id=property.condo_id AND  condo.admin_id= current_user);
"
2975,26205,If else statement mysql,"SELECT …
FROM Town
LEFT JOIN Department ON Department.id = Town.department
LEFT JOIN Region ON Region.id = COALESCE(Town.region, Department.region)
LEFT JOIN Country ON Country.id = COALESCE(Town.country, Region.country)
"
30349,15671,Update multiple rows of a table having specific value in particular column equal to value calculated from two other tables,"UPDATE  c
SET     c.Price = c.Quantity * a.Rate
FROM    TableC c
        INNER JOIN TableB b
            ON c.ProductID = b.ProductID
        INNER JOIN TableA a
            ON b.StoreID = a.StoreID
WHERE   c.Price = 0
"
38662,71598,SQL command to clear specific text,"USE Server 
SELECT 
  firstName AS EmployeeFirstname
, lastName AS EmployeeLastname
, title AS EmployeeTitle
, id AS EmployeeID
, 
  Case 
  When emailAddress Like '%@mycompany.com' 
      Then  emailAddress
  Else Null
  End AS EmployeeEmailAddress 
FROM db.Information 
WHERE ISNUMERIC(id)<> 0 
  AND empStatus = 'A'
"
7389,34818,Sorting rows by count of a many-to-many associated record,"SELECT v.x, v.y, count(*) AS keyword_count
FROM ""venues"" v
  INNER JOIN ""check_ins""   c  ON c.""venue_id""     = v.""id""
  INNER JOIN ""keywordings"" ks ON ks.""check_in_id"" = c.""id""
  INNER JOIN ""keywords""    k  ON ks.""keyword_id""  = k.""id""
WHERE (k.""name"" = 'foobar')
GROUP BY v.x, v.y
ORDER BY 3
"
841,58960,CASE statement to combine two columns except when first characters not similar,"SELECT 
    CASE 
       WHEN left(LastName1,4) <> left(LastName2,4) 
          THEN LastName1 + ', ' + LastName2 
       ELSE LastName1 END AS LastName
"
5949,705,Time period in group by sql query,"SELECT (CASE WHEN TIME(datetime) BETWEEN '10:00:00' AND '15:00:00' THEN 'Morning' 
             WHEN TIME(datetime) BETWEEN '15:00:00' AND '21:00:00' THEN 'Evening' 
             ELSE 'NA'
        END) AS time_period, 
       COUNT(id_reservation) AS total_reservations 
FROM reservations 
GROUP BY time_period;
"
29636,1950,transposing rows to columns in postgres,"SELECT *
FROM  (
   SELECT right(key, -10) AS name_id
   WHERE ""value"" ~~ 'Value%'
   ) n
FULL JOIN (
   SELECT right(key, -10) AS name_id, id AS desc_id
   WHERE ""value"" ~~ 'Desc%'
   ) d USING name_id;
"
18930,9526,Using hibernate as backing for large dataset in JTable,"Query q = entityManager.createQuery(""from someTable tbl order by tbl.id asc"");
q.setFirstResult((pageNum -1)*pagesize).setMaxResults(pagesize); 
"
34650,49533,sql query - filtering duplicate values to create report,"SELECT * FROM yourtable 
WHERE NewID IN (
  SELECT NewID FROM yourtable
  GROUP BY OfficeCD,NewID,Year,Type
  HAVING Count(*)>1
)
"
30185,15604,How to get last day of last week in sql?,"SELECT DATEADD(day,
               -1 - (DATEPART(dw, GETDATE()) + @@DATEFIRST - 2) % 7,
               GETDATE()
       ) AS LastSunday
"
30325,29883,How to calculate database column statistics given the table and column name?,"
CREATE PROCEDURE my_proc @tablename sysname AS
   SELECT * FROM @tablename
"
18176,58413,How can I order the rows inside a table by a column (but not the `SELECT`'s response)?,"select bar
from t
where foo = $FOO
"
13889,10755,Here is one possible way to find random rows in a table? Is there a better method?,"select TOP 30 *
from orders o inner join
     store s
     on o.Retailer_ID = s.ID
where s.Name='XXXX'
order by newid();
"
13096,75496,sql max/min query and data transformation,"SELECT shipment_id
    , (SELECT TOP 1 time 
    	FROM test AS [b] 
    	WHERE b.shipment_id = a.shipment_id 
    	AND b.stop_seq = MIN(a.stop_seq)) AS [start]
    , (SELECT TOP 1 time 
    	FROM test AS [b] 
    	WHERE b.shipment_id = a.shipment_id 
    	AND b.stop_seq = MAX(a.stop_seq)) AS [end]
FROM test AS [a]
GROUP BY shipment_id
"
16252,15891,SQL Server 2005 or LINQ query: joining two tables and calculate field,"var query = from table1 in data.Table1s
                join table2 in data.Table2s
                on table1.ID equals table2.ID
    into x            
    select new {
        table1.Shirt,
        Pants = x.Sum(c=>c.Pants) + table1.Pants,
        table1.Shoes
};
"
34013,66248,Getting two different date format using same query in SQL Server 2008,"select 
CONVERT(varchar(10),CAST('3/16/2015 12:00:00 AM ' AS DATETIME),103)
"
31151,65860,SQL Server : append string not working if col is empty,"UPDATE 
    table
SET 
    col1 = ISNULL(col1, '') + ';somestring'
WHERE 
    col2 = rowID
"
26967,36374,Update a third table from two other tables,"UPDATE
  table3 t
  LEFT JOIN (
    select     x.`1ID`, y.`2ID`
    from       table1 x
    inner join table2 y on x.orderid = y.orderid
  ) foo ON t.table2id = foo.`2ID`
SET
  t.table1id = foo.`1ID`
WHERE
  t.table1id IS NULL
"
33836,47421,How can I find the database path for iPhone/iPad device or iPhone/iPad simulator?,"NSString *databaseName = @""mainDB.sqlite"";
NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDir = [documentPaths objectAtIndex:0];
databasePath = [documentsDir stringByAppendingPathComponent:databaseName];
"
35634,69503,Getting individual counts of last three distinct rows in column of data retrieved from multiple tables,"SELECT TOP 3 ST.EffectiveDate, COUNT(*) as cnt
FROM Person.Contact C INNER JOIN
     Sales.SalesPerson SP
     ON C.ContactID = SP.SalesPersonID FULL OUTER JOIN
     Sales.SalesTerritory ST
     ON ST.TerritoryID = SP.TerritoryID
GROUP BY ST.EffectiveDate
ORDER BY ST.EffectiveDate DESC
"
30165,28204,SQL Like question,"SELECT id FROM table WHERE title RLIKE ""(Xbox|Video)""
"
22864,27238,Selecting all rows where one field contains the same value,"SELECT * 
  FROM MyTable
 WHERE SomeID IN (
                   SELECT SomeID
                     FROM MyTable
                    WHERE Salesman IN ('Ashley','Barney')
                 GROUP BY SomeID
                   HAVING count(distinct Salesman) = 2
                 )
"
12844,12145,Add an overall average row to Report Builder report,"=Sum(Fields!numOfStudents.Value * Fields!avgGpa.Value)
  / Sum(Fields!numOfStudents.Value)
"
24357,18752,SQL: Count Clause,"SELECT Verticals.Vertical_Name as V_name, COUNT(*) AS [Count]
FROM Impressions
Inner Join Verticals ON Impressions.Campaign_id = Verticals.Campaign_id
GROUP BY Verticals.Vertical_Name
"
39723,56669,Mysql - How to quit/exit from stored procedure,"CREATE PROCEDURE SP_Reporting(IN tablename VARCHAR(20))
proc_label:BEGIN
     IF tablename IS NULL THEN
          LEAVE proc_label;
     END IF;

     #proceed the code
END;
"
18686,50529,PostgreSQL group by with sum,"SELECT  m_warehouse_id, SUM(qtyonhand) totalQuantity
FROM adempiere.rv_storage
WHERE rv_storage.m_product_id=1000412
GROUP BY m_warehouse_id
ORDER BY m_warehouse_id;
"
23642,66934,How to find Oracle's SID Password?,"ALTER USER admin IDENTIFIED BY <<password>>
"
3952,14948,How to join multiple tables in MySQL?,"SELECT DISTINCT concat(c.fname,"" "", c.lname) AS fullname, s.description
FROM customer c 
INNER JOIN orders o ON c.customer_num = o.customer_num
INNER JOIN items i ON o.order_num = i.order_num
INNER JOIN stock s on s.stock_num = i.stock_num
WHERE i.manu_code = 'ANZ'
"
30794,18158,Extract Delimited values and create columns with T-SQL,"select *,  
SUBSTRING(Result,2,2) as VF021,  
SUBSTRING(Result,5,2) as VF02b,  
SUBSTRING(Result,8,2) as VF02c,  
SUBSTRING(Result,11,2) as VF05b  
from DQS_RAW
"
4093,23124,select columns matching," SELECT c1, c2, c3
 FROM   t1
 UNION
 SELECT b.c1, b.c2, b.c3
 FROM   t1 a inner join t2 b ON
         (a.c1 = b.c1) and (a.c1 = b.c1)
 WHERE  (b.c1,b.c2) NOT IN (SELECT c1,c2 FROM t1)
"
28209,5686,Whats the right syntax for the string comparison query involving variable name in PostgreSQL?,"SELECT *
FROM name
WHERE strpos(LastName, FirstName) > 0;
"
7636,41694,Using currency $ format with sql server?,"Label1.Text = string.Format(""Amount is {0:c}"", amount);
"
10449,51926,Ordering resultset in specific order,"order by (case when state = 'NY' then 0 else 1 end),
         state
"
34034,47453,Count tables with the same ID in a column and display the highest,"select t1.subject
from mytable t1
join mytable t2 on t2.thread = t1.id
where t1.thread is null
group by 1
order by count(*) desc
limit 5
"
19792,60098,Selecting column based on a field value in MYSQL,"    SELECT p.id, p.name, 
           CASE WHEN p.team = 1 THEN e.team_1 ELSE e.team_2 END AS Team_Name 
      FROM Players p 
 LEFT JOIN Events e 
        ON e.id = p.event_id 
     WHERE p.id = 2
"
39108,18466,TSQL Replace with Length Constraint,"CASE WHEN MyCondition = 1 AND (INT_FIELD_ONE IS NOT NULL OR INT_FIELD_TWO IS NOT NULL) THEN concat..
     WHEN MyCondition = 1 THEN NULL -- at that point we know that both are null
     ELSE ... END
"
12885,69760,Convert String ISO-8601 date to oracle's timestamp datatype,"SELECT to_timestamp_tz ('2014-09-12T11:53:06+00:00', 'YYYY-MM-DD""T""HH24:MI:SSTZH:TZM')
FROM DUAL

TO_TIMESTAMP_TZ('2014-09-12T11:53:06+00:00','YYYY-MM-DD""T""HH24:MI:SSTZH:TZM
---------------------------------------------------------------------------
12-SEP-14 11.53.06.000000000 +00:00
"
36614,74617,Searching a Record from Middle of the Table,"SELECT b.id AS next_id FROM tableb b LEFT JOIN tablea a 
ON (b.id =a.Table_b_fk ) WHERE b.M1=100 AND b.M2 =100 AND b.id >4 
ORDER BY b.id ASC  LIMIT 1
"
3788,70153,Mysql: enum confusion,"Employee (emp)
-------
id
name

Interest
-------
id
description

Employee_Interest
--------
employeeID
interestID
"
12252,64085,Randomly picking entity not yet in a join table,"SELECT i.id
FROM items i 
LEFT JOIN users_items ui ON ( i.id = ui.item_id AND ui.users_id = 2 )
WHERE ui.item_id IS NULL;
"
26862,58986,SQL select statement filtering,"declare @UseThree as bit = 1;
if exists (select 1 from testtable where rowval in (10,4))
set @UseThree = 0;

select COUNT(*) 
from testtable
where (@UseThree = 1 AND rowval=3)
    OR
    (@UseThree = 0 AND rowval in (10,4))
"
8391,48385,Database design: user with contact information,"CREATE TABLE users (
  id INT UNSIGNED NOT NULL,
  foo VARCHAR(50),
  PRIMARY KEY (id) );

CREATE TABLE user_contact_info (
  id INT UNSIGNED NOT NULL,
  user_id INT UNSIGNED NOT NULL,
  contact_type VARCHAR(40) NOT NULL,
  phone VARCHAR(20),
  email VARCHAR(200),
  address VARCHAR(200),
  postal_box VARCHAR(20),
  PRIMARY KEY (id, user_id) );
"
22798,14793,How to update a table taking values to a second sql instance?,"UPDATE p
    SET column1 = t.column1
from <dbname>.<schema>.mytable p
join <TestLinkedServerName>.<dbname>.<schema>.mytable t
    on p.<id> = t.<id>
"
26326,4357,transpose column headers to rows in postgresql,"SELECT
   unnest(array['value1Count', 'value2Count', 'value3Count']) AS ""Values"",
   unnest(array[value1Count, value2Count, value3Count]) AS ""Count""
FROM view_name
ORDER BY ""Values""
"
9752,3922,How to Output a file during a query/job,"DECLARE @shell_cmd VARCHAR(8000);
-- build your BCP command exporting to file
EXECUTE master.sys.xp_cmdshell @shell_cmd;
"
5740,27079,Copy column data from one table to another in SQLite,"insert into table1 (_id)
select _id from table2;
"
17128,52796,How to count specific number's occurence in select statement?,"SELECT Tag, COUNT(*) Total
FROM Tags
GROUP BY Tag
"
13811,14060,Select table and replace column by value from another table,"SELECT id,
       (SELECT Max(code)
        FROM   table2),
       name
FROM   table1 A
WHERE  code = (SELECT Max(code) code
               FROM   table1) 
"
7624,5380,SQL Server pivot does not group,"WITH CTE
     AS (SELECT [DepartmentName],
                [Gender],
                [BaseRate]
         FROM   [AdventureWorks].[dbo].[DimEmployee])
SELECT [DepartmentName],
       [M],
       [F]
FROM   CTE PIVOT (Avg(BaseRate) FOR [Gender] IN ([M], [F])) AS P 
"
11421,21804,How to use a column from joined table in a join with a subquery,"SELECT *
FROM MainTable m
INNER JOIN JoinedTable j on j.ForeignID = m.ID
CROSS APPLY (SELECT TOP 1 *
            FROM SubQueryTable sq
            WHERE  sq.ForeignID = j.ID
            ORDER BY VersionColumn DESC) sj
"
35460,42339,SAS: Summing to different levels,"PROC TABULATE data=yourdata;
   CLASS Region State County City District;
   VAR Sales;
   TABLE Region*(State*(County*(City*(District ALL) ALL) ALL) ALL) ALL,
        Sales*sum;
RUN; 
"
9600,41552,Filter SQL query based on scalar function result,"Select * from (
SELECT *, [dbo].[myFunc] (X.Prop1) AS Width FROM X 
) T
WHERE Width > 0
"
14303,21134,Full text search using contains shows different results with same database content,"SELECT name FROM Recipes WHERE 
CONTAINS(name, 'FORMSOF (INFLECTIONAL, apple) AND FORMSOF (INFLECTIONAL,pies)', language 1033)
"
10160,14394,query that subtracts sum of one column from another,"SELECT x.*
     , x.a - SUM(y.b) 
  FROM my_table x 
  JOIN my_table y 
    ON y.date_created <= x.date_created 
 GROUP 
    BY x.id;
"
21927,50459,sql sum previous rows based on value of current row,";WITH MyCTE AS
(
    SELECT
        RoomTypeID,
        DayNo,
        RoomNo,
        IsDormitory,
        AdultsNo,
        SUM(CASE WHEN IsDormitory = 1 THEN AdultsNo ELSE 0 END) OVER (PARTITION BY RoomTypeID, DayNo ORDER BY RoomNo ROWS UNBOUNDED PRECEDING) AS Tmp
    FROM
        #tbl
)
SELECT *
FROM MyCTE
"
3818,25974,MySQL: Query for most recent entires of distict fields set prior to specified date,"select c.*
from components c
where c.date = (select max(c2.date)
                from components c2
                where c2.sys_id = c.sys_id and
                      c2.serial_num = c.serial_num and
                      c2.date <= '2010-02-05'
               );
"
19760,33657,Pivot - How would i do this?,"select productid,
       sum(IsProcess * Yield) ProcessYield,
       sum(IsCosmetic * Yield) CosmeticYield
from myTable
group by productid
"
3820,3957,Check same long condition on two columns,"...WHERE ARRAY[x,y] <@ ARRAY[0,1,4,6,7]
"
32147,70495,"is ""select count(*) from..."" more reliable than @@ROWCOUNT?","DECLARE @rows int 
...
[insert or update a table]
SET @rows = @@rowcount
"
30659,12626,mysql substring get only characters,"select documentnumber
from transactionheader
where  documentnumber  LIKE 'RCV%'
"
15672,40856,stored procedure pattern match," select a_val, b_val
   into vara_val, varb_val 
   from DATA_TABLE 
   where CALLNUM LIKE NumberPattern || '%';
"
6115,7925,ORACLE USER role to limit user to view and execute function without modifying it,"-- As sysdba:
-- 1) create an user account
create user <username> identified by <password>;
-- 2) allow user to log in
grant create session to <username>;
-- 3) allow user to execute a single procedure in other schema
grant execute on <other_schema.procedure_name> to <username>;
"
30475,50105,return latest version of a drupal node,"SELECT  m.*
FROM    (
        SELECT  nid, MAX(vid) AS mvid
        FROM    mytable
        GROUP BY
                nid
        ) q
JOIN    mytable m
ON      (m.nid, m.vid) = (q.nid, q.mvid)
"
35197,58251,mysql solution for adding all users without duplicates,"INSERT INTO follows(user_id, other_id) 
SELECT id, 1 as other_id 
FROM users
WHERE NOT EXISTS(SELECT ! FROM follows WHERE user_id = users.Id and other_id = 1)
"
6288,52968,How apply multiple choice conditions in Select command,"CREATE PROCEDURE usp_Test
  @param1 int = NULL
, @param2 int = NULL
, @param3 int = NULL
AS
BEGIN
  SELECT * FROM Tab1
  WHERE (Para1 = @param1 OR @param1 IS NULL)
    AND (Para2 = @param2 OR @param2 IS NULL)
    AND (Para3 = @param3 OR @param3 IS NULL)
END
"
15297,47651,How to do this simple MySQL statement without resorting to a sub query?,"SELECT user_id, avatar
FROM profile_views AS PV
     INNER JOIN users AS U ON U.user_id = PV.profile_user_id
WHERE PV.viewer_user_id = 1
"
28347,28688,Don't show duplicated rows SQLITE,"select c.c_name, group_concat(i.i_name) ingre
from cocktail c
inner join ingredients i
  on c.id = i.c_id
where c.id = 1
group by c.c_name
"
11958,40658,How to change the string using convert in ms sql?,"CONVERT(NVARCHAR, MAX([DateTime]) - MIN(DateTime]), 108) AS [Hours Works]
"
32312,33571,Is it possible to restrict a sql table to only have a single row at the design stage,"alter table dbo.KeyNumbers add OneAndOnly as ('OneAndOnly');

alter table dbo.KeyNumbers add constraint unq_OneAndOnly unique (OneAndOnly);
"
28792,1811,Adding count(*) from a join to a query," SELECT profiles.photo, postings.postid, postings.text, postings.date, members.fname,members.lname, members.userid,
 likes.like_count
 FROM profiles, members, postings
 LEFT JOIN (SELECT post_id, COUNT(*) like_count FROM likes GROUP BY post_id) as likes
      ON postings.postid=likes.post_id
 WHERE postings.wallid=postings.posterid 
 AND postings.wallid=members.userid 
 AND postings.wallid=profiles.userid 
"
7463,42061,Can I update a records value using an additon?,"UPDATE tbl 
SET col =col+1 
WHERE id = ?
"
35009,59449,Efficient query for the first result in groups (postgresql 9),"SELECT name, date
FROM
  (
    SELECT DISTINCT ON (name) name, date
    FROM table
    ORDER BY name, date
  ) AS id_date
ORDER BY date
LIMIT 300;
"
2489,34013,Oracle Group By Issue,"SELECT id,
       id_idea,
       date_vote
FROM   (SELECT id,
               id_idea,
               date_vote,
               Row_number() over (PARTITION BY id_idea 
                                      ORDER BY date_vote DESC NULLS LAST) AS rn
        FROM   VOTE) AS t
WHERE  rn = 1  
"
10600,42264,Table Transpose in SQL,"SELECT US,
       CA,
       GB,
       AU
FROM   Yourtable
       PIVOT (Max(total)
             FOR county IN (US,
                            CA,
                            GB,
                            AU)) pv 
"
27772,472,SQL Creating a Table with constraints," CREATE TABLE NEW_TABLE
 (
     EMP_NUM NUMBER(5, 0) NOT NULL PRIMARY KEY, 
     RTG_CODE CHAR(5 BYTE) NOT NULL,
     EARNED_DATE DATE NOT NULL,
     FOREIGN KEY (RTG_CODE) REFERENCES RTG(RTG_CODE)
 );
"
4752,64632,"MySQL - Finding mismatches between sets of ""batched"" data","SELECT * 
FROM order_addresses o1
  INNER JOIN order_addresses o2 
  ON o1.parent_id = o2.parent_id 
  AND o1.entity_id <> o2.entity_id
WHERE o1.last_name <> o2.last_name
  OR o1.zip_code <> o2.zip_code
"
36220,45477,How to get min value of a column which is present in three different table for a particular record,"SELECT MemberId, MIN(Date) AS ""Min_Date""
FROM (
    SELECT MemberId, Cov_End_Date  AS ""Date"" FROM Cov_End
    UNION ALL
    SELECT MemberId, Opt_out_date  AS ""Date"" FROM Opt_Out
    UNION ALL
    SELECT MemberId, Deceased_Date AS ""Date"" FROM Decsd_Date
) src
GROUP BY MemberId
"
35760,14071,"How can I make a query, selecting only CATEGORIES which have PRODUCTS into it?","SELECT *
FROM Categories
WHERE EXISTS(
  SELECT NULL
  FROM products
  JOIN SubCategories ON products.fkSubCatID = SubCategories.PkSubCatID
  WHERE SubCategories.fkCatID = Categories.pkCatID
  HAVING Count(*) > 2)
"
32203,63417,MySQL performance issue - lots and lots of ORing,"SELECT * FROM my_table;
"
34390,68060,How to create a dynamic query using EOD SQL?,"@Select(""SELECT storename FROM broadcastrecipient WHERE storecity IN (SELECT * FROM tmp_cities)"")
public List<String> getStoresForCurrentCities();
"
28156,56640,Update Extended Properties of a Stored Procedure,"string query = ""EXEC sp_updateextendedproperty  "";
query += ""     @name = N'Caption'  "";
query += ""     ,@value = 'newValue.'   ""; 
query += ""     ,@level0type = N'Schema', @level0name = dbo    "";
query += ""     ,@level1type = N'Procedure',  @level1name = STOREDPROCNAME    "";
query += ""     ,@level2type = N'Property', @level2name = Caption;    "";
"
35185,21479,Get multiple records for the same row of master table,"SELECT u.userID, u.userNAME, u.emailadd, u.phone, l.schoolid
FROM Users u
inner join Lookup l on u.userid = l.userid
"
37827,73459,SQL Server Check for IsNull and for Zero,"SET @SomeVariable = @AnotherVariable / COALESCE(
        CASE 
             WHEN @VariableEqualToZero = 0 THEN 1
             ELSE @VariableEqualToZero
        END, 1) - 1
"
35682,62000,How can I use an oracle keyword as an alias?,"SELECT DATA.EXT_ID AS ""NUMBER"" FROM DATA;
"
8439,39357,Select non-matching record in same table - SQL,"select distinct(report_number)
from reports 
where report_type='A' and report_number not in (select report_number from reports where report_type='B')
"
17403,74692,SQL advanced sub select query,"SELECT t1.field1, t1.field2, t1.field3 FROM table1 t1
INNER JOIN table2 t2
    ON t1.field1 = t2.field1
   AND t1.field2 = t2.field2
   AND t1.field3 = t2.field3
   AND t2.... // Use this as WHERE condition
"
13595,61151,Insert-Select for single result of multiple rows in same table,"--INSERT INTO DocTag  (DocId,TagId)
SELECT DISTINCT DocId, 3000
FROM DocTag  t1 
WHERE TagId IN(8,2)
-- Check the DocId also has a TagId `IN(45,32,15)`
AND EXISTS (SELECT 1 FROM DocTag  t2 
            WHERE t2.DocId=t1.DocId AND t2.TagId IN(45,32,15))
-- Check the new tag mapping doesn't already exists
AND NOT EXISTS(SELECT 1 FROM DocTag  t3 
               WHERE t3.DocId=t1.DocId AND t3.TagId=3000)
"
14665,12518,"Data SE / SQL Query - Return all columns, not just most recent selected when storing in variable","SELECT *
FROM Posts P1
INNER JOIN (SELECT ParentId, Id 
            FROM Posts
            WHERE OwnerUserId = 5620297
            AND PostTypeId = 2) P2
    ON P1.Id = P2.ParentId
    AND P1.AcceptedAnswerId <> P2.Id;
"
8928,43828,SQL COUNT Returning count of items that use a specific property,"SELECT color.id_color, color.title, COUNT(theme_color.id_theme)
  FROM color INNER JOIN theme_color ON color.id_color = theme_color.id_color
GROUP BY color.id_color, color.title
"
7398,37954,"How to track which tables/views/etc depends from a table, in Oracle","SELECT NAME
from user_dependencies
where referenced_name = 'PRICE'
"
22303,9872,SQL select query not working with variable parameter in my servelets,"ResultSet rs = stmnt.executeQuery(""select * from ZEE.WORDCOUNT where WORD ='"" + searchTxt+""'"");
"
30193,68252,non duplicate multiple SQL records I can't get rid of,"SELECT ppp.DeptID, mis.UserID, mis.[Name],
       COALESCE(MAX(CASE WHEN mis.ProviderID IS NOT NULL THEN 'YES' END), 'NO') as IsProv,
       COALESCE(MAX(CASE WHEN af.FacilityID <> 'PSY' THEN 'Not Restricted' END), 'Restricted') as SIgnOnFacility,
       COALESCE(MAX(CASE WHEN fr.FacilitiesRestrictedID <> 'PSY' THEN 'Not Restricted' END) as FacilityToRestrict,
        mis.Active
FROM . . .
GROUP BY ppp.DeptID, mis.UserID, mis.[Name], mis_Active;
"
39245,41245,How to replace characters before a number in sql,"SELECT REPLACE(Name, SUBSTR(Name, 1, REGEXP_INSTR( Name, '[0-9]', 1)-1), 'Port ')
 FROM PORT
"
10330,35857,how get min group row only in mysql?,"SELECT t.name, t.mygroup, t.scale
    FROM test1 t
        INNER JOIN (SELECT mygroup, MIN(scale) AS MinScale
                        FROM test1
                        GROUP BY mygroup) q
            ON t.mygroup = q.mygroup
                AND t.scale = q.MinScale
"
17404,52555,Change an attribute value when a select query is run in SQL,"CREATE PROCEDURE AUTOUPDATE(in InID INT)
   BEGIN
     SELECT * FROM [TABLE] 
     where [TABLE].ID = InID 
     UPDATE [TABLE] SET read = 1
     where [TABLE].ID = InID 
   END
"
39349,20317,MSSQL 2008: Get last updated record by specific field,"select c.*
from content c cross apply
     (select top 1 c2.*
      from content c2
      where c2.contentId = c.contentId and c2.UpdatedAt < c.UpdatedAt
      order by c2.UpdatedAt desc
     ) cprev
where c.FileId <> cprev.FileId;
"
36009,55339,Using LIKE to Get Substrings,"SELECT SUBSTRING(
          expr, 
          CHARINDEX( '@', expr ), 
          ISNULL( 
            NULLIF( 
              CHARINDEX( ' ', expr, CHARINDEX( '@', expr ) ), 
              0 ), 
            LEN( expr ) ) 
          - CHARINDEX( '@', expr ) + 1 )
       AS output
FROM   tbl
WHERE  expr LIKE '%@%'
"
35839,71659,How to get unique set of rows from SQL where uniqueness is defined by 2 columns?,"SELECT T1.*
FROM Table1 T1
LEFT JOIN Table1 T2
ON T1.ID != T2.ID AND T1.Name = T2.Name AND T1.Parent = T2.Parent
WHERE T2.ID IS NULL
"
6450,4462,SQL query help,"SELECT TableA.CID
FROM TableA
JOIN TableB ON TableA.AID = TableB.AID
WHERE TableB.status = 1
GROUP BY TableA.CID
HAVING COUNT(*) > 1
"
39835,50825,Select rows from one tables which are not available in the second table,"select * from table1 
where not exists
(
  select host, user, name
  from table2
  where table2.host = table1.host and 
        table2.user = table1.user and 
        table2.name = table1.name
)
"
2544,23613,Copy from one table to another table,"INSERT INTO original_table
  (id, state, city, address)
SELECT t.id, s.id, c.id, t.address
FROM   temp_table t
  JOIN states     s ON s.state_name = t.state
  JOIN cities     c ON c.city_name  = t.city
"
91,18206,Getting the average price of products in a category,"SELECT AVG(product_price) FROM Products WHERE products_id IN (SELECT products_id FROM Products_to_Categories WHERE categories_id = x)
"
7052,41170,MySQL trying to reuse results of subquery in an efficient way,"Select 
    q,
    count(x),
    y,
    i
From 
    tableA a
       inner join
    tableC c
       on cond and c.id = a.q
       cross join -- is this an inner join?
    tableB b
Where
    conds
Group By
    q, 
    y, 
    i
"
16822,56628,"Convert ""_"" to "" "" when selecting column names in SQL?","SELECT REPLACE(COLUMN_NAME, '_', ' ') AS Name
FROM INFORMATION_SCHEMA.COLUMNS
WHERE (TABLE_NAME = 'IM_NOTES')
"
16938,13010,MySQL: Select min date with max hour,"SELECT MAX(myColumn) FROM myTable WHERE myColumn < (
  SELECT DATE(MIN(myColumn)) + INTERVAL 1 DAY FROM myTable
)
"
31992,33821,How to join on subqueries using ARel?,"a = A.arel_table  
b = B.arel_table

subquery = b.project(b[:a_id].as('A_id')).where{c > 4}  
subquery = subquery.as('intm_table')  
query = A.join(subquery).on(subquery[:A_id].eq(a[:id]))
"
4286,52458,What is the behavior of an application when upgdraded at appstore,"if it differ then 
    update schema, 
and if its same 
    no need to make any changes.
"
39106,75578,"Insert specified columns from multiple tables into one table, using WHILE loop","INSERT INTO TableC (
  Column_01, Column_02, Column_03 ...
)
SELECT 
  TableA.Col_A, Table_A.Col_B, 0 ...
FROM TableA
UNION
SELECT 0, 0, TableB.Col_D, TableB.Col_E, ...
FROM TableB
"
12576,39350,How to join two tables with two conditions?,"SELECT Count(c.CompanyID) 
FROM dbo.LLOAN As LL
LEFT JOIN dbo.Company As C 
ON (C.CountryID = LL.SourceID) 
AND (C.CompanyID = LL.LOAN_COMPANY) 
"
38210,16696,Group By with count doesn't work,"SELECT projects.AgencyId,projects.ProgramId,count(projects.ProjStatusByMin) as status,
projects.ProjStatusByMin 
from projects 
where projects.AgencyId=40 
group by projects.ProjStatusByMin, projects.AgencyId,projects.ProgramId
"
32106,18300,T-SQL add delimiter between data when using OPENROWSET and XML,"select
    c.value('(name)[1]', 'varchar(max)') as [Name],
    nullif(
      replace(
        c.query('
          for $i in stuff/note/text()
          return concat($i, "","")
         '
        ).value('.', 'nvarchar(max)') + ','
      ,',,','')
    , ',')
from @data.nodes ('/root/item') as t(c)
"
16123,33748,SQL add month to a query without calendar table,";with M as (
  select 1 as month union
  select 2 union
  select 3 union
  select 4 union
  select 5 union
  select 6 union
  select 7 union
  select 8 union
  select 9 union
  select 10 union
  select 11 union
  select 12
)
Select ID, M.Month,
Sum((Case When Month(Date1)=M.Month then 1 else 0 END)) as [Date1 Count],   
Sum((Case When Month(Date2)=M.Month then 1 else 0 END)) as [Date2 Count],  
Sum((Case When Month(Date3)=M.Month then 1 else 0 END)) as [Date3 Count]  
From M,Table1
Group by ID,M.month
"
17632,18492,Validate person without value in date column,"UPDATE employees 
   SET is_valid = (CASE WHEN datecolumn1 IS NULL
                        THEN 1
                        ELSE 0
                    END)
 WHERE empid IN (SELECT e.empid
                   FROM employees e
                  GROUP BY emempid
                 HAVING COUNT(*) > 1)
"
18294,48874,Returning other columns of aggregate result,"SELECT
  *
FROM
  yourTable
INNER JOIN
  (SELECT col1, MAX(col2) as max_col2 FROM yourTable GROUP BY col1) AS lookup
    ON  yourtable.col1 = lookup.col1
    AND yourtable.col2 = lookup.col2
"
25300,16876,(kdb+/Q language) Creating separate table files from CSV import Parser(edited),"foo:{t:flip colnames!(""SDTISSISFISS"";"","") 0:x;
     `:newA upsert select from t where Condition = `SomeCondition;
     `:newB upsert select from t where not Condition = `SomeCondition}

.Q.fsn[foo;`:C:/myDir/data.csv;5000000]
"
38692,41288,MySQL Adding columns together,"SELECT column1,sum(column2) FROM table
group by column1
"
17677,32542,Query to check the degree of parallelism on a table,"SELECT degree
  FROM user_tables
 WHERE table_name = <<some table name>>
"
23701,24274,SQL - Average number of records within a time period,"select customer_id,  count(date_created), avg(revenue) from table t 
join (
select customer_id,  min(date_created) as min_date from table t where loan_status = 'approved' group by customer_id ) s 
on t.customer_id = s.customer_id 
where t.date_created between s.min_date and DATEADD(month, 4, s.min_date) and t.loan_status = 'approved' 
"
9718,28579,Access SQL: Not Equals on Null Text Field,"WHERE (NOT (Nz(NewMaster.[Risk Mitigation Status],""0"") = ""Complete""));
"
2450,73044,Delete all records from all tables of database,"CREATE PROCEDURE sp_EmplyAllTable
AS
EXEC sp_MSForEachTable ‘ALTER TABLE ? NOCHECK CONSTRAINT ALL’
EXEC sp_MSForEachTable ‘DELETE FROM ?’
EXEC sp_MSForEachTable ‘ALTER TABLE ? CHECK CONSTRAINT ALL’
GO
"
25086,63963,SQL and number combination search,"select * from Temp
where 'N1' in (F1,F2,F3,F4,F5,F6,F7,F8,F9,F10)
  and 'N2' in (F1,F2,F3,F4,F5,F6,F7,F8,F9,F10)
  and 'N3' in (F1,F2,F3,F4,F5,F6,F7,F8,F9,F10)
  and 'N4' in (F1,F2,F3,F4,F5,F6,F7,F8,F9,F10)
"
6212,4409,Need to join two tables where all data is correct in table A,"select [Your column list] from tableA A
inner join tableB B
on A.EANno = B.EANno

union all

select [Your column list] from tableB B
where B.EANno not in (select distinct EANno from tableA)
"
15157,13422,How to list every accounts information and sum in sql without using a loop,"select
  account.accountNo,
  count(1) as number_of_events,
  sum(case when event.amount > 0 then event.amount else 0 end) as deposits,
  sum(case when event.amount < 0 then event.amount else 0 end) as withdrawals,
  sum(event.amount) as sum_deposits_withdrawals
from
  account
inner join
  event on
  event.accountNo = account.accountNo
group by
  account.accountNo
"
14527,70304,Oracle SQL - date comparison does not work,"where schedfinish >= trunc(current_date)
and schedfinish < trunc(current_date + 2)
"
25994,27903,Inserting XML documents into SQL Server 2008 database,"CREATE PROCEDURE sp_XMLLoad
   @FileName
AS SET NOCOUNT ON
SELECT  X.article.query('id').value('.', 'INT'),
        X.article.query('article').value('.', 'VARCHAR(50)'),   
        X.article.query('/doc/text()').value('.', 'VARCHAR(MAX)')
FROM (
      SELECT CAST(x AS XML)
      FROM OPENROWSET(
            BULK @FileName,
            SINGLE_BLOB) AS T(x)
"
39449,36944,Export result from oracle to excel or txt?,"Sub DisplayDBATables()

  Dim cn As ADODB.Connection
  Dim rs As ADODB.Recordset

  Set cn = New ADODB.Connection
  Set rs = New ADODB.Recordset

  cn.Open ( _
    ""User ID=rene""        & _
    "";Password=my_secret"" & _
    "";Data Source=XE""     & _
    "";Provider=MSDAORA.1"" )

  rs.Open ""select * from dba_tables"", cn

  Cells(1, 1).CopyFromRecordset rs

End Sub
"
10361,63038,Scala DBs? Relational algebra?," www.scala-lang.org/node/6539

 http://code.google.com/p/orbroker/
"
37132,58263,Language/Framework support for Interacting With CouchDB,"# Create the database
server = Couch::Server.new(""localhost"", ""5984"")
server.put(""/foo/"", """")

# Insert a new document into the database
doc = <<-JSON
{""type"":""comment"",""body"":""First Post!""}
JSON
server.put(""/foo/document_id"", doc)

# Get the document back later
res = server.get(""/foo/document_id"")
json = res.body
puts json
"
5861,5866,2 Foreign Keys referencing the same Primary Key in MySQL,"select f.friendsID, 
  s1.name as personA_name, 
  s2.name as personB_name
from friends f
  inner join student s1 on s1.sID = f.personA
  inner join student s2 on s2.sID = f.personB
"
31031,73436,Trigger to update values,"create or replace trigger aud_upd_biur
before insert or update on your_audit_table
for each row
begin
     if :new.col1 = 'null'
     then
         :new.col1 := null;
     end if;
     if :new.col2 = 'null'
     then
         :new.col2 := null;
     end if;
     ....
     if :new.col99 = 'null'
     then
         :new.col99 := null;
     end if;
end;
"
22231,64976,sqlite changing a value using joins,"UPDATE Monday
SET recipe_id = (SELECT key
                 FROM Recipes
                 WHERE name = Monday.recipe_name)
"
19368,72272,Find the max mile reference for each corridor within dataset,"select t.corridor_code_rb,t.frfpost,t.trfpost
from SEC_SEGMENTS t
join (select corridor_code_rb, max(s.trfpost) as trfpost from SEC_SEGMENTS 
      group by corridor_code_rb) s
on t.trfpost = s.trfpost
where t.dir = 'I' and t.lane = 1
"
32382,20512,SQL JOIN : Help using join inisted subquery,"SELECT e.id, 
       e.name 
FROM   emp e 
       INNER JOIN deptid D_X 
               ON e.empid = d_x.empid 
                  AND deptid = 'X' 
       LEFT JOIN deptid D_Y 
              ON e.empid = d_Y.empid 
                 AND deptid = 'Y'
WHERE  d_Y.empid IS NULL 
"
35281,57591,"SQL Server, Oracle8i syntax","select  '''' + convert(varchar,event_key) + '''' +',' as Event_K
from mytable
"
1392,39796,Is there an ANSI SQL alternative to the MYSQL LIMIT keyword?,"-- DB2
select * from table fetch first 10 rows only 
-- Informix 
select first 10 * from table 
-- Microsoft SQL Server and Access 
select top 10 * from table 
-- MySQL and PostgreSQL 
select * from table limit 10 
-- Oracle 
select * from (select * from table) where rownum <= 10
"
31127,58188,Correlated subquery in SQL,"SELECT  *
FROM    Patients p
        CROSS APPLY ( SELECT    MAX(ModifiedAt) AS ModifiedAt
                      FROM      ResultsStored rs
                      WHERE     p.RowId = rs.RowId
                    ) a
WHERE   a.ModifiedAt > p.ModifiedAt
"
35771,8550,How to write the following SQL query,"select distinct url 
from sample s1
where exists (
     select url 
     from sample s2 
     where 
     s2.url=s1.url
     and timestampdiff(HOUR, s2.timestamp, s1.timestamp)>=1
    )
"
10773,5766,Remove rows with the same value in specific column from Datagridview.,"SELECT *
FROM dbo.yourTable t
WHERE EXISTS (         
              SELECT 1
              FROM dbo.yourTable t2
              WHERE t2.Column3 = t.Column3
              HAVING COUNT(*) = 1
              )
"
14877,3439,How to count rows from SQL DB table in VB.NET WPF application?,"Dim cmd As SqlCommand = New SqlCommand(""SELECT  qnumber,"" + item + "" FROM tencmpC1"", cc)
Dim adp As New SqlDataAdapter(cmd)
cmd.Connection.Open()
Dim ds As new Data.Dataset 
Dim dt as new Data.DataTable
adp.Fill(ds)
dt=ds.Tables(0)
Dim count as Integer=dt.Rows.Count    
"
12232,47072,Table Pivot with AVG inside MAX(DECODE()),"SELECT x.NAME as ""Drink"", 
(MAX(DECODE(x.TYPE, 'Small', avg, NULL))) Small,
(MAX(DECODE(x.""TYPE"", 'Medium', avg, NULL))) Medium,
(MAX(DECODE(x.""TYPE"", 'Large', avg, NULL))) Large
FROM (
      SELECT Size.""TYPE"", Drink.NAME, Round(AVG(Size.price),2) avg 
      FROM Drink, Price 
      WHERE Drink.drink_id = Size.drink_id
      GROUP BY Size.""TYPE"", Drink.NAME) x
GROUP BY x.NAME
ORDER BY x.NAME;
"
20732,69668,get last records with different values in a column,"SELECT Id, Data, Date, Transition
FROM mytable
WHERE Id IN (SELECT MAX(Id)
             FROM mytable
             GROUP BY Data, Transition
             HAVING COUNT(*) > 1)
"
17629,33262,Conditional where in SQL based on Value?,"WHERE (param='redeem' and balance <=0) or (param='purchase' and balance>=0) or (param='redeem AND purchase ')
"
18768,37230,LINQ Nested Query help,"from person in People
from event in person.Events
where event.Type == ""Invitation"" &&
 !person.Events.Any(event => event.Type == ""Something"" && event.Conference == ""someString"")
select new {person, event}
"
36306,29006,How to merge(with getting sum) some duplicate data in sql table?,"SELECT User_ID, Cash_In, Cash_out 
FROM 
(SELECT wa.User_ID, count(case when tt.ID = '1' then 1 else null end) Cash_In,
        count(case when tt.ID = '2' then 1 else null end)  Cash_out 
FROM mwt_wallet_transactions t, mwt_txn_types tt, mwt_user_wallet wa
WHERE t.txn_code = tt.ID and
t.a_number = wa.id
GROUP BY wa.User_ID)
ORDER BY mobile_no;
"
16213,20528,Suppress a duplicate row in SQL Server 2005 based on condition and list remaining rows that don't meet the condition,"SELECT SHPMNT_NO, TOT_WEIGHT, MAX(HAZARD) as HAZARD
FROM myTable
GROUP BY SHPMNT_NO, TOT_WEIGHT
"
16847,47419,SQL query table filtering,"select Distinct Meal from NewTab NT
where not exists 
   (select 1 from NewTab where NeededQty>AvailableQty 
    and NT.Meal = Meal);
"
18920,49586,SQL Query finding field with multiple rows,"SELECT EMP 
FROM Z_INSUR 
WHERE INSUR_TYPE = 'M'
GROUP BY EMP 
HAVING count(*) > 1;
"
19933,21687,Delaying the trigger invocation after an insert oracle,"create trigger trg
after insert on tab
for each row
declare
  jl_ob number;
begin
  dbms_job.submit
    ( job => l_job
    , what => 'myproc(:new.id);'
    , next_date => sysdate+1/24/60 -- One minute later
    );
end;
"
10023,8695,Dynamic SQL To Dynamic LINQ in VB.NET with MS SQL Server 2008,"Dim res As IEnumerable(Of tblPurchasedInventoryObject) = pidc.ExecuteQuery(Of tblPurchasedInventoryObject)(query).ToList
"
18266,498,update table1.col2=table2.col2 when the value in table2.col2 changes,"UPDATE u
  Set payrollID = p.payrollID
FROM User u
INNER JOIN Payroll p ON p.userID = u.userID
WHERE u.payrollID IS NULL
"
1132,33401,Find records without join match,"SELECT  *
FROM    recipients
WHERE   NOT EXISTS
        (
        SELECT  NULL
        FROM    recipients_mails
        WHERE   (recipient_fk, mail_fk) = (recipient_id, 3)
        )
"
22698,26154,convert datetime to varchar(50),"SELECT convert(varchar, getdate(), 103) 
+' '+ CONVERT(varchar(15),CAST(getdate() AS TIME),100)
"
6430,40776,SQL Server : Not So Simple IF Statement,"DECLARE @count INT
SET @count = isnull((SELECT TOP 1 [count] from products WHERE [count] > 1),0)
IF (@count > 1)
    BEGIN
        PRINT 'It works!'
    END
"
24392,62860,How to understand what I need to do in a query,"SELECT name,continent,population FROM world x
  WHERE 25000000 >= ALL (
    SELECT population FROM world y
     WHERE x.continent=y.continent
       AND y.population>0)
"
10512,23264,SQL insert into select return values,"INSERT INTO mytable 
([id], [name], [tran_status])
OUTPUT INSERTED.[id],
INSERTED.tran_status
SELECT...
"
24794,2930,MySQL manual change tracking,"CREATE TABLE t1 (
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT ON UPDATE CURRENT_TIMESTAMP
);
"
8045,65538,Circular buffer using SQL,"  select id
  from mytable
  order by !(id>3), id
  limit 5
"
833,35138,trying to get the word with starting upper case on first letter using mysql,"select CONCAT(UPPER(SUBSTRING(visit_Status, 1, 1)), 
      LOWER(SUBSTRING(visit_Status FROM 2))) as Status ......
"
8090,69505,Create a DATABASE using as a Name from a Variable,"-- Set Data Base name
DECLARE @DataBaseName sysname;
SET @DataBaseName = 'DbCmsWebsiteTest';

IF (@DataBaseName  LIKE '%[^0-9A-Z]%')
    RAISERROR('Invalid Characters in Name, %s',16,1,@DataBaseName)
ELSE
    BEGIN
    SET @DataBaseName = QUOTENAME(@DataBaseName)
    EXEC('CREATE DATABASE '+ @DataBaseName)
    END
"
30118,68007,Oracle.ManagedDataAccess.EntityFramework - ORA-01918: user 'dbo' does not exist,"public partial class MyAppContext : DbContext
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.HasDefaultSchema(""UPPERCASE_SCHEMA_NAME"");
...
"
9717,46018,Is there a way to use the LIKE operator from an entity framework query?,"context.Users.Where(usr =>
    usr.Username.StartsWith(usernameToMatch) &&
    usr.Username.EndsWith(usernameToMatch) &&
    usr.Username == usernameToMatch
)
"
36471,9950,SQL: get monthly sales together with sales of the last four months,"select 
center_id, month_id, sales_amt,
(
sales_amt + 
lead (sales_amt,1,0) over (PARTITION BY center_id ORDER BY month_id desc) +
  lead (sales_amt,2,0) over (PARTITION BY center_id ORDER BY month_id desc) +
  lead (sales_amt,3,0) over (PARTITION BY center_id ORDER BY month_id desc)
) sales_4_month
from Sales
"
29539,2678,MySQL Convert String To Date Calculate Age And Order BY Age,"SELECT  EXTRACT(YEAR FROM (FROM_DAYS(DATEDIFF(NOW(),STR_TO_DATE(birthday, '%m/%d/%Y'))))) + 0 age,
        COUNT(*) TotalCount
FROM    tableNAme
GROUP   BY EXTRACT(YEAR FROM (FROM_DAYS(DATEDIFF(NOW(),STR_TO_DATE(birthday, '%m/%d/%Y'))))) + 0
ORDER   BY TotalCount DESC
"
23600,59254,SQL like concat doesn't select specific value,"SELECT * 
FROM Table1 INNER JOIN
     Table2
     ON concat(', ', Table1.itemsid, ', ') LIKE CONCAT ('%, ', Table2.id, ', %') 
WHERE Table1.name = 'Jorn';
"
30853,39466,Limit SQL by the sum of the row's value,"SET @runtot:=0;
 SELECT 
    q1.t,
    q1.s,
    (@runtot := @runtot + q1.s) AS rt
 FROM 
    (SELECT Date AS t,
     SIZE AS s
     FROM  Table1
     ORDER  BY Date
     ) AS q1
WHERE @runtot + q1.s <= 20
"
32949,37465,Oracle ROWID values,"select value
  from nls_session_parameters
 where parameter = 'NLS_SORT';

VALUE
------------------------------
BINARY
"
3871,42888,Concatenate Main Group to Subgroup via FOR XML PATH,"select Location + ',' + aa as 'CSV' from 
(
SELECT t.Location, STUFF(
(SELECT ',' + convert(varchar(5), s.Degrees) as aa
FROM MonthlyTemps s
WHERE s.Location = t.Location
--FOR XML PATH('')),1,1,'') AS CSV
FOR XML PATH(''), TYPE).value('.', 'VARCHAR(MAX)'),1,1,'') AS CSV
FROM MonthlyTemps AS t
GROUP BY t.Location
) as temp
"
30492,14224,Expression in computed column,"ALTER TABLE dbo.tablename ADD Total
  AS CONVERT(DECIMAL(10,1),
    (Col2 * CASE WHEN Col1 < 1 THEN 1.0 ELSE Col1 END));
"
38415,54920,Is it possible to report on 2 tables without using a subquery?,"SELECT *
FROM building
LEFT JOIN (SELECT building, etc. FROM men GROUP BY etc.) AS men_summary
    ON building.name = men_summary.building_name
LEFT JOIN (SELECT building, etc. FROM women GROUP BY etc.) AS women_summary
    ON building.name = women_summary.building_name
"
1880,66994,How to optimize mysql query with an inner query,"select p.*
from `products` p
left outer join (
    select `id`
    from `purcheased`
    where `userId` = 14 
        and `price` > 100 
        and `reversed` = 0
) pu on p.id = pu.id
where p.`active` = 1 
    and p.`group` = 6 
    and pu.id is null
order by p.`price` 
limit 0, 500
"
31546,58302,TSQL Get rows with a certain time for each day,"SELECT * FROM OperatorRTPPM
WHERE CONVERT(varchar(5),snapshotTime, 108) = '01:59'
AND snapshotTime > '2015-09-20' AND snapshotTime < DATEADD(d, 1, '2015-09-22 02:00')
AND code = 54
"
22840,38678,Group by Date -Month -Day Hour and Time Query,"SELECT dateadd(minute, datediff(minute, 0, rundate), 0) , 
       count( distinct dateadd(minute, datediff(minute, 0, JobDateStamp), 0))
FROM tbl_tasks
GROUP by dateadd(minute, datediff(minute, 0, rundate), 0) 
"
29556,1041,Access Query to Delete data based on Complex criteria,"delete from raw as r
    where requestid not in (select requestid
                            from raw as r2
                            where r2.ActionBy = ""Harford, Claran"" and
                                  r2.requestid = r.requestid
                           );
"
36283,23037,Can you have a partial Identity column in SQL Server?,"SELECT 
   TicketNUmber, 
   ROW_NUMBER() OVER (PARTITION BY TicketNumber ORDER BY TicketDate) AS StepNumber
FROM YourTable
"
31074,61095,MS Access average after subtracting,"SELECT col3, Format(Avg([col2]-[col1]),""hh:mm:ss"") AS TimeDiff
FROM Table1
GROUP BY col3;
"
21584,14194,writing procedure output to file with column header,"-- Create Temp Table 
CREATE TABLE #TMP_TABLE(COL1 varchar(50), COL2 varchar(50), COL3 varchar(100));

-- Insert Stored Proc Data in Temp Table
INSERT INTO #TMP_TABLE
EXEC dbo.myproc;

-- Select Column name + Date (Use ' not "" for String delimiter)
SELECT 'COL1', 'COL2', 'COL3'
UNION ALL
SELECT * FROM #TMP_TABLE;
"
37978,33546,How to add two columns from two separate MS SQL queries with different number of rows,"select ProductID, (inv.Inventory + s.Sales) as BalanceInventory
from
( 
    select  ProductID, Inventory
    from [table]
    where xxx
) inv
left outer join
(
   select  ProductID, Sales 
    from [table]
    where xxx
) s on (s.ProductID = inv.ProductID)
"
22010,2137,Select from multiple tables with multiple where clauses,"select 
    casestatus.casestatusid,
    casestatusdesc,
    COUNT(caseid)
from casestatus
    left join cases 
        on casestatus.casestatusid = cases.casestatusid
        and cases.isdeleted=0
where
    casestatus.isdeleted=0
group by    
    casestatus.casestatusid,
    casestatusdesc
"
5198,18580,Selecting data where there's less than 10 linked rows,"select a.Id from proxy a, account b
where a.ID = b.proxyId
group by a.ID
having count(*) <= 10
"
21508,30407,Best SQL type for 2000 characters,"ALTER TABLE ctrc ADD [cert_length] as LEN (x509certificate);
"
28883,35928,PostgreSQL - Check column value and update after removing any symbols,"select id, 
       regexp_replace(lower(username), '[^a-z]', '', 'gi') as clean_user_name
from users;
"
19243,7059,Separating variables in a SAS data set,"data Range_data_1(keep=Range Row HGT V);
    set Range_data;
run;

data Range_data_2(keep=Range Row HGT2 V2);
    set Range_data;
run;

data Range_data_3(keep=Range Row HGT3 V3);
    set Range_data;
run;

data Range_data_4(keep=Range Row HGT4 V4);
    set Range_data;
run;

data All_Range;
    set Range_data_1 Range_data_2 Range_data_3 Range_data_4;
run;
"
21629,18937,Select earliest of two nullable datetimes,"SELECT IF(Date1 IS NULL OR Date2 IS NULL, 
          COALESCE(DATE1, DATE2), 
          LEAST(DATE1, DATE2)
       ) AS EarlyDate 
FROM MyTable
"
29215,1724,Oracle SQL Migrate Data Optimization,"insert /*+APPEND+*/ INTO UserTablebBackUp(id_backup) select a.id from usertable a
left outer join userblacklist b on a.id=b.id where b.id is null 
"
19699,69442,Mysql- One table Two query in one statement,"SELECT card_id
FROM
(
    SELECT card_id, MONTH(days) AS card_month, SUM(YTL) as card_sum
    FROM expenses
    WHERE days BETWEEN ""2014-05-01"" AND ""2015-06-30""
    GROUP BY card_id, card_month
    HAVING card_sum >= 40
) sub0
GROUP BY card_id 
HAVING COUNT(*) = 2
"
33931,49208,identify insert stored proc,"SELECT OBJECT_NAME(m.object_id), m.*
  FROM SYS.SQL_MODULES m
 WHERE m.definition like N'%INSERT INTO my_table_name%'
"
39583,65782,SQL Nearest Neighbor Query (Movie Recommendation Algorithm),"select name, count(distinct [user]) from myshows recommend
inner join tvshows on recommend.show = tvshows.showid
where [user] in 
(   
    select other.[user] from 
        ( select show from myshows where [User] = @user ) my,
        ( select show, [user] from myshows where [user] <> @user ) other
    where my.show = other.show
)   
and show not in ( select show from myshows where [User] = @user ) 
group by name
order by count(distinct [user]) desc
"
5311,53723,Need to retrieve 2nd to last word in SQL,"select t.*
from (select t.*, row_number() over (partition by t.id order by ind desc) as seqnum
      from table t outer apply
           splitstring(t.[desc])(str, ind)
     ) t
where seqnum = 2;
"
36089,45323,how to join three tables and retrieve selected columns from the three tables and in oracle?,"select cu.cust_id, cu.cust_name, ci.location
  from cinema ci
  join booking b
    on ci.c_id = b.c_id
  join customer cu
    on b.cust_id = cu.cust_id
 where ci.location <> 'Paris'
"
23824,46014,Selecting value via substracting another value from a total number,"SELECT ID FROM FA WHERE MASS = 800 - (SELECT MASS FROM FA WHERE ID = '14:0')
"
6524,62861,Is there a way to alter many tables to add default values to a common column name?,"DECLARE
    cnt NUMBER;
BEGIN
    FOR x IN (
        SELECT DISTINCT t.table_name 
        FROM user_tables t
            INNER JOIN user_tab_columns c ON c.table_name = t.table_name
    ) LOOP
        EXECUTE IMMEDIATE 'ALTER TABLE (SCHEMA.' || x.table_name || ') MODIFY(VARIETY DEFAULT ''COMEDY'')';
    END LOOP;
END;
"
18354,58119,Calculating difference of dates In Postgresql,"Question.LoggedTime - MIN(qUpdate.UpdateTime)
"
34878,23846,Select where another table is equal to,"SELECT *      
  FROM queue      JOIN link 
    ON queue.pid = link.id  
 WHERE EXISTS(SELECT 1 FROM settings WHERE process = 1)
 ORDER BY timestamp DESC 
"
16320,73486,Joining multiple tables in SQL,"SELECT *
FROM   T1
       INNER JOIN T2
         ON T2.C = T1.C
       INNER JOIN T3
                  LEFT JOIN T4
                    ON T4.C = T3.C
         ON T3.C = T2.C 
"
16255,9736,"In SQLite, How do I exclude rows which contain certain strings?","select * from table where column not like '%|||%'
"
5267,149,Group by column and display count from all tables in mysql,"SELECT type, MAX(count_table1) as count_table1, MAX(count_table2) as count_table2 FROM (
(
    SELECT type, COUNT(*) AS count_table1, 0 AS count_table2
    FROM Table1
    GROUP BY type
) UNION (
    SELECT type, 0 AS count_table1, COUNT(*) AS count_table2
    FROM Table2
    GROUP BY type)
) AS tmp
GROUP BY type
"
36234,38314,Add ellipsis with substring_index MySQL,"select (case when @string = substring_index(@string, ', ', 3)
             then substring_index(@string, ', ', 3)
             else concat(substring_index(@string, ', ', 3), '...')
        end)
"
22458,1111,Oracle how to add generated column to a select *,"SELECT (col4 * (col1+col2+col3) + 13) as gen1, table1.*
  FROM table1
  WHERE col3 > 123
    AND col4 = 5
  ORDER BY col1, col2
"
36376,63427,SQL-92 (Filemaker): How can I UPDATE a list of sequential numbers?,"
CREATE TABLE sorting (sid numeric(10,10), rn int);

INSERT INTO sorting (sid, rn)
SELECT SortID, RecordNumber FROM Beleg
WHERE Year ( Valuta ) = 2016
AND Ursprungskonto = 1210
ORDER BY SortID;

UPDATE Beleg SET SortID = (SELECT rn FROM sorting WHERE sid=Beleg.SortID)
WHERE Year ( Valuta ) = 2016
AND Ursprungskonto = 1210;

DROP TABLE sorting;
"
28305,72275,How can I get a row which has biggest value?,"
WITH C AS ( SELECT MAX(IMAGE_ORD) M FROM TBL_IMAGE )
SELECT 
  TBL_IMAGE.IMAGE_PATH, TBL_IMAGE.IMAGE_ID, TBL_IMAGE.DOC_NID 
FROM
  TBL_IMAGE JOIN C ON IMAGE_ORD = C.M
WHERE ROWNUM < 2
"
20250,39430,LinqPad4 does not show results,"testing.Dump();
"
16607,72776,i'm getting value in select tag after assigned it should not display in the select tag,"SELECT veh.* FROM vehicle AS veh
LEFT JOIN allocate_driver as allDr 
ON veh.vehicle_id = allDr.vehicle_id
WHERE allDr.vehicle_id IS NULL
"
24831,15967,is it possible to Sum values grouped by month?,"SELECT YEAR([Calendar Date]) As [YEAR],
       Month([Calendar Date]) As [Month],
       SUM([Working Day] As [Working Days]
FROM [Calendar]
GROUP BY YEAR([Calendar Date]), 
         Month([Calendar Date]) 
"
23090,29037,How to find total count of all null values in mysql,"SELECT SUM(col1 IS NULL) + SUM(col2 IS NULL) + SUM(col3 IS NULL) ... AS NullCount
FROM YourTable
"
5965,36202,Making logs expire relative to the timestamp and not the indexing time(system time),"{
    ""tweet"" : {
        ""_timestamp"" : {
            ""enabled"" : true,
            ""path"" : ""post_date""
        }
    }
}
"
10191,12674,Join wip_discrete_jobs_v and wip_move_transactions_v,"select *
from
(
    select * -- replace this with the columns that you want
       , row_number() over(partition by j.wip_entity_id order by m.trans_date desc) rn
    from wip_discrete_jobs_v j
    inner join wip_move_transactions_v m
        on j.wip_entity_id = m.wip_entity_id  -- add the columns you join on 
        and j.organization_id = m.organization_id
) d
where rn = 1
"
19227,15036,How to update value of fields in a table found in every schema on an Oracle Server,"FOR tbl IN (SELECT owner, table_name
              FROM dba_tables
             WHERE table_name = 'MYTABLE')
LOOP
  EXECUTE IMMEDIATE 'update ' || tbl.owner || '.' || tbl.table_name ||
                    '  set field1 = ''N'', ' ||
                    '      field2 = null ';
END LOOP;
"
33797,30276,Delete SQL Query,"UPDATE table_name SET
column_name = null
WHERE another_column_name = 'some value'
"
14082,71140,"need help joining two tables, sql","select 
    employees.employee_name.employee_id,
    employees.employee_name,
    managers.employee_name as manager_name
from table1 as employees
    left join table2
        on table2.employee_id = employees.employee_id
    left join table1 as managers
        on managers.employee_id = table2.manager_id
"
15250,11715,Insert a part of a table into another table,"INSERT INTO B (supplier_id, supplier_name)
SELECT supplier_id, supplier_name FROM A
WHERE abc > 10;
"
33908,59961,query that returns distinct count of each value in each column,"SELECT col, val, count(*)
FROM (
  SELECT unnest(array['A','B','C','D','E']) AS col,
         unnest(array[A,B,C,D,E]) AS val
  FROM mytable) AS t
GROUP BY col, val
"
8450,40624,How to floor a number in sql based on a range,"select 10*floor(val / 10)
"
247,17902,Getting last entry for each of a distinct column value,"select distinct on (type) id, type, amount
from table
order by type, id desc;
"
25522,27567,SQL Substring using two charindexes problem,"DECLARE @str VARCHAR(500) 
SET @str = 'Barcode: 22037 CaseSize: 1 Qty: 3'
SELECT RTRIM(LTRIM(SUBSTRING(@str, 
                             CharIndex('CaseSize: ', @str) + 10, 
                             (CHARINDEX('Qty:', @str )-(CharIndex('CaseSize: ', @str) + 10)))))
"
22525,58612,Select limit percent,"SELECT *
FROM    (
    SELECT tablename.*, @counter := @counter +1 AS counter
    FROM (select @counter:=0) AS initvar, tablename
    ORDER BY value DESC   
) AS X
where counter <= (10/100 * @counter);
ORDER BY value DESC
"
32914,35614,PostgreSQL ORDER BY column position (and not by column name),"SELECT firstname, lastname 
FROM person 
ORDER BY 2;  --2nd column
"
1347,50450,How to sum numbers in a delimited string using SQL Server,"WITH cte AS (
  SELECT
    '23|12|12|32|43' + '|' AS string
    ,0 AS total
  UNION ALL
  SELECT
    RIGHT(string, LEN(string) - PATINDEX('%|%', string))
    ,CAST(LEFT(string, PATINDEX('%|%', string) - 1) AS INT) + 10
  FROM cte
  WHERE PATINDEX('%|%', string) > 0

)
SELECT SUM(total) AS total FROM cte
"
8089,46318,AND and OR in oracle sql,"SELECT * 
FROM   HR_EMP_TRANSFER t1
       FULL OUTER JOIN
       HR_EMP_PROFILE_MSTR_TT t2
       ON (    t1.APPROVAL_STATUS = t2.APPROVAL_STATUS
           AND t1.EMPNO = t2.EMPNO )
WHERE (t1.APPROVAL_STATUS='P' and t1.EMPNO = '13724')
   OR (t2.APPROVAL_STATUS='P' and t2.EMPNO = '13724')
"
23096,66038,Check if matching record exists in joined table,"SELECT
    categories.id,
    categories.title,
    CASE WHEN COUNT(prodvscats.id) = 0 THEN 0 ELSE 1 END AS product_exists
FROM categories
LEFT JOIN prodvscats ON categories.id = prodvscats.categories_id 
GROUP BY categories.id, categories.title
"
5934,68315,select column as true / false if id is exists in another table,"SELECT members.id, members.name, 
       IF(services.mid IS NULL, FALSE, TRUE) as services
FROM members
LEFT JOIN services ON (members.id = services.mid)
"
4366,34834,Counting depending on a field,"select vessel,
  crane_no,
  count(container_no) tot_moves,
  count(case when completed_on is null then container_no end) as pending,
  count(case when completed_on is not null then container_no end) as completed,
min(completed_on) first_m,
max(completed_on) last_m
from
containers
group by vessel, crane_no;
"
26672,65620,Insert into with a sub select * not working,"INSERT INTO TableA (col1, col2)
SELECT col1, col2 FROM TableB
"
18309,50021,selecting rows in the last 5 minutes using unix time stamp,"SELECT COUNT(id), from_unixtime(`timestamp` / 1000, '%Y-%m-%d %H:%i')
FROM `table`
WHERE `timestamp` >= unix_timestamp(CURRENT_TIMESTAMP - INTERVAL 5 MINUTE) * 1000
"
9190,12441,How to execute datediff on multiple rows,"select datediff(DAY,'2010-01-21',date_of_birth)
from people
"
9451,1345,Oracle: Recursively self referential join with nth level record,"SELECT m.*,
  CONNECT_BY_ROOT id AS second_level_parent_id
FROM my_table m
WHERE CONNECT_BY_ROOT level =2
  CONNECT BY prior id    = parent_id;
"
22477,34643,How to get an input (like firstname) from user in Telegram bot?,"$content    = file_get_contents(""php://input"");
$update     = json_decode($content, true);

$chatID         = $update[""message""][""chat""][""id""];
$userName       = $update[""message""][""from""][""first_name""];
$userMessage    = $update[""message""][""text""];
"
23525,40905,retrieving the data from firebase database and manipulate it in swift,"let title = snapshot.value.objectForKey(""title"")
let detail = snapshot.value.objectForKey(""detail"")

print(""Title : \(title), Detail : \(detail)"")
"
14883,45102,SQL statement with several joins,"SELECT * 
FROM `Post` AS `p` 
LEFT JOIN `CategoryBinding` AS `cb` ON p.ID = cb.postID 
LEFT JOIN `Category` AS `c` ON cb.categoryID = c.ID
INNER JOIN `Post` AS `p2` ON p.id = p2.id
WHERE p.id in
(
    SELECT p2.id
    FROM `Post` as `p2`
    LEFT JOIN `CategoryBinding` AS `cb` ON p2.ID = cb.postID 
    LEFT JOIN `Category` AS `c` ON cb.categoryID = c.ID
    WHERE c.id = @SomeCategory
)
"
23812,53166,How to select just the row in the second table?,"select t1.date, case when t3.IDCLIENT is not NULL then t3.value else t2.value end as Value
from Table1 t1 inner join Table2 t2 on t1.IDCLIENT = t2.IDCLIENT inner join
Table3 t3 on t1.IDCLIENT = t3.IDCLIENT
"
13311,56172,Selecting groups in which all elements satisfy a condition,"SELECT position_id
FROM trades
GROUP BY position_id
HAVING COUNT(*)=COUNT(exit_date)
"
30395,70573,How to retrieve all rows thats co-ords are within a specifc radius in MySql Database,"select * from table where POW((_lat_-lat1),2) + POW((_lng_-lng1),2) < 1 
"
1424,75334,create or replace table in oracle pl/sql,"SELECT COUNT(*)
  INTO nCount
  FROM USER_TABLES
  WHERE TABLE_NAME = 'FOOBAR';

IF nCount <> 0 THEN
  EXECUTE IMMEDIATE 'DROP TABLE FOOBAR';
END IF;

EXECUTE IMMEDIATE 'CREATE TABLE FOOBAR(...)';
"
39103,10223,Select only if related entities collumn contains specific value,"SELECT c.pkId, c.Name FROM Company c
INNER JOIN License l ON c.pkId=l.CompanyId
WHERE l.Name LIKE '%Test%'
EXCEPT
SELECT c.pkId, c.Name FROM Company c
INNER JOIN License l ON c.pkId=l.CompanyId
WHERE l.Name NOT LIKE '%Test%'
"
36727,71901,SQL mass insert based off of data pulled from another table,"insert into table2 (Xid, configKey, ConfigVal)
select id, 'doSomething', 'true'
from table1
"
26420,24347,Is there a way to reuse a window in teradata?,"SELECT sum(salary) OVER (PARTITION BY depname ORDER BY salary DESC), avg(salary) OVER (PARTITION BY depname ORDER BY salary DESC)
FROM empsalary;
"
37670,8008,MySQL - Transferring data,"Update YourTable
set shortDate = date_format(`Date`, '%m%d')
"
4414,64215,String concatenation in where clause,"select  *
from    property.lease_period
where
(suite_id = 'CCBG08' AND lease_id = '205059') OR 
(suite_id = 'CCBG14' AND lease_id = '152424') OR 
(suite_id = 'CCCF048' AND lease_id = '150659')
"
2916,18367,Oracle Equivalent for IIF in Access SQL?,"select case 
         when x >= 0 then 'Positive'
         else 'Negative'
       end as sign
from tablename;
"
31064,71019,Oracle select: Fastest way to get total number of rows,"select * 
  from (select c.*, count(*) over() cnt 
          from (select * from table where x = 'a' etc) c 
         where rownum <= 2) 
 where cnt = 1;
"
39640,41225,Sql Server upper lower and index logic,"SELECT
    UPPER(LEFT(FirstName, 1)) + LOWER(RIGHT(FirstName, LEN(FirstName) - 1)) AS FirstName,
    UPPER(LEFT(LastName, 1)) + LOWER(RIGHT(LastName, LEN(LastName) - 1)) AS LastName
FROM MyTable
"
28092,30385,How to Ommit DataGridViewRow from DataSource Based on Another Table's Data,"Dim dtTemp As DataTable = dtOpenBills.Clone()
For Each dr As DataRow in dtOpenBills.Rows
    If Cint(dr(""OpenBillID"")) <> 1287  Then
       Dim drTemp As DataRow = dtTemp.NewRow()
       drTemp = dr
       dtTemp.Rows.Add(drTemp)
    End If
Next
DataGridViewName.DataSource = dtTemp
DataGridViewName.Refresh()  'Might not be needed
"
3591,33093,Update several posts' attachment with SQL,"UPDATE wp_postmeta
SET meta_value = (select meta_value from wp_postmeta where post_id = *attatchment-post’s id* AND meta_key = '*my attachment*')
WHERE post_id IN (SELECT ID FROM wp_posts WHERE post_title LIKE ‘%*part of title*%’;
) AND meta_key = '*my attachment*' 
"
10657,21419,Altering column on two tables simultaneously,"UPDATE playerRegSeason s
INNER JOIN players p ON s.playerID = p.playerID
SET s.NewPlayerID =  p.NewPlayerID
"
35503,46821,Date problem in MYSQL Query,"SELECT SUM(transaction_amount)
WHERE YEAR(transaction_date) = '2008'
GROUP BY YEAR(transaction_date)
"
24140,21367,I need to remove leading zeros after a decimal point,"LEFT([Year.Docid], 5) + CAST(CAST(RIGHT([Year.Docid], 9) AS int) AS varchar(10))
"
15857,115,How to make SQL query faster?,"select * 
from t1
left join t2 on t1.id1 = t2.id
where t2.id is null
"
3291,61715,Query performance on two databases on one server,"Live - Cardinality Estimate Expression=""CONVERT_IMPLICIT(nchar(18),[pn].[PartNumber],0)""

Test - Cardinality Estimate Expression=""CONVERT_IMPLICIT(nvarchar(50),[pn].[PartNumber],0)""
"
14931,27076,SQL expression to get names of friends,"select relationship.requester, relationship.requested, 
       requester.firstname, requester.lastname,
       requested.firstname, requested.lastname,
from relationship
left join user as requester on user.guid = relationship.requester 
left join user as requested on user.guid = relationship.requested
where relationship.requester = {$userid}
  and relationship.approved = 1
"
14066,45748,In Windows batch - how do I replace single quote with escape single quote to feed SQL,"setlocal EnableDelayedExpansion
for /F ""eol=; tokens=1,2,3,4,5,6* delims=, "" %%a in (myfile.txt) do (
    set ""c_tmp=%%c"" & set ""c_tmp=!c_tmp:'=''!""
    sqlcmd -SmYSerbver  -Uhhh -P12345 -dmyDB_Admin -Q""insert into tableA (UserID,FirstName,LastName,Email,DisplayName,OrgUnit,LoadDate) values('%%a','%%b','!c_tmp!','%%d','%%e','%%f',getdate())""
)
endlocal
"
32289,38663,Assistance with creating an UPDATE statement please,"UPDATE t1
SET t1.Col1 = t2.Col1,
    t1.Col2 = t2.Col2
FROM DestTable t1
INNER JOIN StagingTable t2 ON (t1.Col1 = t2.Col1 AND t1.Col2 = t2.Col2)
"
36738,27808,SQL query to select from two tables with if condition,"  SELECT    * 
    FROM    Notification n
            LEFT OUTER JOIN Acknowledgment a ON a.parent_id = n.id
  WHERE     (a.parent_id IS NULL OR a.status = @somevalue)
"
19421,16404,Check if string variations exists in another string,"CASE 
    WHEN 
     instr(trim(lower(Full_Name)), 
     trim(lower(REGEXP_SUBSTR(Partial_Name, '[^,]+', 1, 1)))) > 0
       AND 
     instr(trim(lower(Full_Name)), 
     trim(lower(REGEXP_SUBSTR(Partial_Name, '[^,]+', 1, 2)))) > 0
    THEN 'Y'
    ELSE 'N'
END AS MATCHING_NAMES
"
11191,61885,Is there a way to use the current row's (that is about to be inserted) id number inside query itself?,"INSERT INTO table (id, intro, detail, image)
SELECT id, 'introtext', 'detailtext', CONCAT('id_', id, '.jpg')
FROM (  SELECT AUTO_INCREMENT AS id
        FROM `information_schema`.`TABLES`
        WHERE `TABLE_SCHEMA` LIKE 'database_name' AND `TABLE_NAME` LIKE 'table') AS h
"
13650,57422,SQL Server: Can a query return results to multi-part searches in one step?,"SELECT Car_ID, 
    CASE WHEN Model_Id = 5 AND Car_Type_Id = 7 AND Year = 2006 THEN 1 
         WHEN Model_Id = 5 AND Car_Type_Id = 7 THEN 2 
         WHEN Model_Id = 5 THEN 3 
         ELSE 4 
    END as ResultOrder
FROM Cars 
WHERE Make_ID = 1 
ORDER BY ResultOrder
"
1562,44145,How to get the number of distinct records in a SQL Server 2008 database?,"select
    count( distinct Country_Country_Id ) 
from users
"
29338,1975,How to check for available stock and allocate them to an order using a view in SQL Server,"select o.*,
       (s.stockcount -
        sum(o.ordercount) over (partition by itemid order by date)
       ) as stockleft
from orderrow o join
     stock s
     on o.itemid = s.itemid;
"
26938,11335,Get rows with same id and must have certain values combined,"SELECT b.b_id, a.a_id FROM TableA a
INNER JOIN TableB b ON a.a_attribute = b.b_attribute
GROUP BY a.a_id, b.b_id
HAVING COUNT(*) = 3
"
6499,7640,How to manipulate a column selected by * in SQLite?,"SELECT *, COALESCE(colN, 'FOO') as CoalescedColN
"
20798,13352,MySQL - on duplicate key - CASE WHEN THEN ELSE doesnt work,"INSERT INTO TableName (uid,A,B) 
VALUES (uid,A[2],B[2]) 
ON DUPLICATE KEY 
UPDATE  A= (IF(B=B[2],A,A[2])), 
        B= B[2]+1;
"
8624,45325,Simple query for the relationship,"select e.emp_id, e.lname from 
Employee e join contactInfo c on e.emp_id = c.emp_id 
join phones p on c.contid = p.cont_id 
join phonetype pt on pt.phoneType_id = p.phoneType_id 
join Department d on d.dept_id = e.dept_id
where d.type = 'tech' and pt.type = 'W'
"
5668,6656,Check that a DB link is actually pointing to the right server,"select property_value 
from database_properties@<database_link> 
where property_name='GLOBAL_DB_NAME'
"
1351,65012,How do I return a row from one table with the number of matching id's from a second table in MySQL?,"SELECT
    d.id,
    d.creator,
    d.date,
    d.title,
    (select count(*) from r where r.discussion_id = d.id) num
FROM 
    discussions d
"
36144,53673,"How to list 'AAA','AAB','AAC'.......'ZZZ' with a SQL Server query","with toupdate as (
      select t.*, row_number() over (order by id) - 1 as seqnum
      from t
     )
update toupdate
    set picking_order = (ascii(char('A') + seqnum / (26*26)) +
                         ascii(char('A') + (seqnum / 26) % 26) +
                         ascii(char('A') + seqnum % 26)
                        );
"
39925,62625,Creating SQL users and restricting their permissions,"
--Replace db with your database name
USE db

--Create a database role
CREATE ROLE db_execonly

--Grant EXEC permissions to the role
GRANT EXECUTE TO db_execonly

--Add users to the new role
EXEC sp_addrolemember 'db_execonly', 'user1'
EXEC sp_addrolemember 'db_execonly', 'user2'

--Deny permissions to specific objects for user2
DENY EXEC ON OBJECT::dbo.usp_sproc1 TO user2
DENY EXEC ON OBJECT::dbo.usp_sproc2 TO user2
"
18504,74454,Oracle regex for all characters after a specific character,"regexp_replace( CUST_PART_NO, '(.*)(R)(.*)', '\3' )
"
26219,16310,MySQL: SELECTing by hash: is this possible?,"SELECT * FROM table WHERE MD5(column) = 'd41d8cd98f00b204e9800998ecf8427e'
"
37191,28580,"MySQL take a range of values based on a column of descending numbers, and then randomize that range","$sql_rand_limit_range = ""SELECT * FROM posts 
                         WHERE active='y' 
                         AND front_weight BETWEEN 1 AND 20 
                         ORDER BY RAND()"";
"
23093,34563,Is this a well documented pattern?,"execute(""Select a,b from tableA;""+
  ""Select c,d from tableB;""+
  ""Select e,f from tableC"");
"
10046,64095,Convert SQL to Linq where there is in clause,"Dim projectIds = New Integer() {840, 841, 842}
Dim result = From proj In db.tblFacilityProjects _
             Where proj.FreedomEnabled = True AndAlso _
                   projectIds.Contains(proj.ProjectID) _
             Select FacilityID
"
4829,52035,Efficient SQL to merge results or leave to client browser javascript?,"  SELECT MAX(CASE WHEN t.ani = 'cows' THEN t.num ELSE NULL END) AS cows,
         MAX(CASE WHEN t.ani = 'pigs' THEN t.num ELSE NULL END) AS pigs,
         t.country
    FROM YOUR_TABLE t
GROUP BY t.country
ORDER BY t.country
"
5492,49822,Silverstripe LeftJoin WHERE two values,"select c.*
from customers c join
     customer_products cp
     on c.customerid = cp.customerid join
     products p
     on p.productid = cp.productid
where p.name in ('Pen', 'Car', 'Watch')
group by c.customerid
having sum(p.name = 'Pen') > 0 and
       sum(p.name = 'Car') > 0 and
       sum(p.name = 'Watch') > 0;
"
30100,34862,Correlated Subquery,"SELECT
  ""60+ DAYS"",
  ""30-60 DAYS"",
  ""7-30 DAYS"",
  (""60+ DAYS"" + ""30-60 DAYS"" + ""7-30 DAYS"") as ""TOTAL"",
  ...
"
33722,49250,SQL check with an if statement,"Alter Table Invoices WITH NOCHECK
ADD CHECK (   (PaymentTotal > 0 AND PaymentDate IS NOT NULL) 
           OR (PaymentTotal = 0 ) ) 
"
35470,8332,MySql Select query,"select status,
       count(*) as num,
       group_concat(id) as ids
from tests as status_stats
union all
select null as status,
       count(*) as num,
       group_concat(id) as ids
from tests as total_stats
"
12786,66998,Updating data in a table,"update criminals set charge1 = 
replace(charge1,substring(charge1, charindex('#',charge1), len(charge1)),'')
where charindex('#',charge1) > 0
"
23104,1335,Combining two nested SELECT with DISTINCT?,"SELECT Kontonr , Name FROM Geldkonto
WHERE Kontonr in (SELECT DISTINCT Ursprungskonto FROM Beleg
WHERE YEAR ( Valuta ) = 2016)
"
12014,46042,SQL return the row ONLY with the later date,"SELECT *
FROM (
  SELECT user_id,
         school_id,
         row_number() over (partition by user_id order by graduation_date desc) position
  FROM user_school
) us,
[user] u
WHERE us.user_id = u.user_id
  AND position = 1 /* limits to highest graduation date */
"
24842,2811,Grant read and write to user for a table,"GRANT SELECT,INSERT,DELETE,UPDATE ON TABLE TO USER;
"
9859,11654,how to delete one of the two duplicate records in db2 database,"sql [ctx] C1 = { SELECT * FROM MyTable ORDER BY dup_column };

sql {  FETCH C1 INTO row  };
while ( !C1.endFetch() )  {
    if ( row.dup_column = prevrow.dup_column ) {
        sql [ctx] { DELETE FROM MyTable
                     WHERE CURRENT OF C1  };
    }

    prevrow.dup_column = row.dup_column;

    sql { FETCH C1 INTO ...     };
}
C1.close();
"
20843,43166,Basic SQL query question,"SELECT     
  Base.ReportDate, 
  Base.PropertyCode, 
  Base.FirstName, 
  Base.MiddleName, 
  Base.LastName, 
  Person.FirstName, 
  Person.MiddleName, 
  Person.LastName
FROM  Base
LEFT JOIN (
    SELECT LeaseID, MIN(TenantID) AS [TenantID]
    FROM LeaseT
    GROUP BY LeaseID) AS [LeaseT_SinglePerson] ON Base.LeaseID = [LeaseT_SinglePerson].LeaseID
LEFT JOIN Person ON [LeaseT_SinglePerson].TenantID = Person.ID
"
32735,11428,Querying a django DB with model forms,"def query_queries(request):
    form = QueryForm(request.POST or None)
    if form.is_valid():
        # this is the same as doing
        # Query.objects.filter(studyName=form.cleaned_data['studyName']...)
        queries = Query.objects.filter(**form.cleaned_data)

    context = {
        'queries': queries
    }
    return render(request, ""query_queries.html"", context)
"
28302,3235,ORACLE SQL // IF ELSE?,"LEFT JOIN (SELECT *
             FROM PILOTAGE_USINES_VALEURS
             WHERE C_INDICATEUR IS NOT NULL) v
  ON v.ID_USINE = d.ID_USINE
     AND v.ANNEE = 2015
     AND v.MOIS = D.MOIS
     AND v.C_INDICATEUR = pi1.C_INDICATEUR
     AND pi1.C_INDICATEUR IS NOT NULL
"
13317,71534,mysql how to get rows with max date when grouping?,"SELECT  a.*
FROM    tableName a
        INNER JOIN 
        (
            SELECT  product, MAX(date) mxdate
            FROM    tableName
            GROUP   BY product
        ) b ON a.product = b.product
                AND a.date = b.mxdate
"
31732,15464,Sybase Sql query not returning error,"CREATE TABLE #temp
(
    a INT NULL,
    b INT NULL
)

INSERT #temp 
SELECT 1, NULL
UNION 
SELECT 2, 2

DECLARE @b INt
SELECT @b = 2

SELECT * FROM #temp
WHERE 
b = isnull(@b,b)
"
20458,61653,How can I use LEFT & RIGHT Functions in SQL to get last 3 characters?,"SELECT  RIGHT(RTRIM(column), 3),
        LEFT(column, LEN(column) - 3)
FROM    table
"
13686,74022,SQL: How do I combine tables on a single but non-unique identifier?,"select coalesce(t1.id, t2.id) as id,
       t1.value, t2.value
from (select t1.*, row_number() over (partition by id order by (select NULL)) as seqnum
      from table1 t1
     ) t1 full outer join
     (select t2.*, row_number() over (partition by id order by (select NULL)) as seqnum
      from table2 t2
     ) t2
     on t1.id = t2.id and t1.seqnum = t2.seqnum;
"
39656,18773,Oracle 11g - FOR loop that inserts only weekdays into a table?," BEGIN
  FOR i IN 1..365 LOOP
    IF( to_char(sysdate-1+i,'fmDAY') NOT IN ('SATURDAY', 'SUNDAY') )
    THEN
      INSERT INTO MY_TABLE (ID, MY_DATE)
        VALUES (i, (to_date(sysdate,'DD-MON-YY')-1)+i);
    END IF;
  END LOOP;
 END;
"
26297,32199,How to use only one matching row of association table to join parents,"select
   A.col1,
   B.col1
from A
join (select 
        FK_A,
        FK_B, 
        row_number() OVER (partition by FK_A ORDER BY FK_B) as rn
      from AB 
     ) jtable ON A.PK_A = jtalbe.FK_A AND rn = 1
join B ON B.PK_B = jtable.FK_B
"
28601,25581,To grab codeigniter database name,"$this->db->database;
"
26570,12161,sql update column value using result in another table,"select t1.fruit, t1.quantity * t2.factor
from t1
cross join t2
"
26156,33558,Checking if a column has a null value tsql,"if(@ProdID IS NULL)
begin 
raiserror('The product does not exist',16,1)
return 1
end
return 0
"
33428,52426,MySQL select rows where other 3 rows exist,"SELECT e.Id
FROM entities e INNER JOIN published P
ON e.Id = P.Id
WHERE status in ('sold','bought','transferred')
GROUP BY e.Id
HAVING COUNT(DISTINCT Status) >= 3
"
39392,71424,Microsoft Access Query Top 50% and Last 50% Values,"select * 
from TABLE
where TABLEID not in (
    select top (
        (select count(*) from TABLE) - 700000
    ) TABLEID
    from TABLE
)
"
16010,40089,SQL: SELECT if entry in one column corresponds to another column of a different table,"SELECT DISTINCT n.node_name, n.data
    FROM nodes n
        INNER JOIN nodeActivity na
            ON n.node_name = na.node_name
                AND na.time = '00:00:00'
"
5579,41911,Query table value aliasing in Oracle SQL,"SELECT vendor_name, vendor_state, vendor_state AS vendor_state_new
  FROM vendors 
 WHERE vendor_state IN 'CA'
 UNION
SELECT vendor_name, vendor_state, 'Outside CA' AS vendor_state_new
  FROM vendors
 WHERE vendor_state NOT IN 'CA'
ORDER BY vendor_name
"
24670,23817,How to format given number in Oracle to specific pattern?,"SELECT CONCAT('P', LPAD(my_number, case when length(my_number) < 6 then 5 else length(my_number) end, '0')) FROM DUAL;
"
21373,8651,Subquery for particular field value during INSERT from Table1 to Table2 in Oracle?,"INSERT INTO Table2 (CUSTOMER_ID, MERCHANT_ID, col1, col2, etc...)
SELECT t3.ID, t4.ID, t1.col1, t2.col2, etc..
FROM Table1 t1 
INNER JOIN Table3 t3 ON t1.CUSTOMER = t3.CUSTOMER_DESC
INNER JOIN Table4 t4 ON t1.MERCHANT = t4.MERCHANT_DESC
"
3279,59377,"Joining(?) or unioning(?) values from two columns in two tables, filling in the blank","Select ID,col_a,col_b,col_union, 'Len_' + col_union,Length(col_union) as Ln from 
(
Select ID,col_a,col_b,Col_c as col_union from myUnionA 
Union All
Select A_ID,a.col_a,a.col_b,Col_d as col_union from  myUnionb  as b
inner join myUnionA as a on  a.ID = b.A_ID
)a
order by ID,col_union
"
15718,68894,SQL SELF JOIN TO CONCATENATE COLUMNS,"SELECT ServiceEntryID, PartDescription = 
    STUFF((SELECT ' | ' + CAST(b.ID AS NVARCHAR) + ' ~ ' + PartDescription
           FROM Part b
            INNER JOIN ServiceEntryPart c
                ON c.PartId = b.ID
           WHERE c.ServiceEntryID = a.ServiceEntryID
           FOR XML PATH('')), 1, 3, '')
FROM ServiceEntryPart a
GROUP BY ServiceEntryID
"
7203,29254,Run a query with a LIMIT/OFFSET and also get the total number of rows,"SELECT *, count(*) OVER() AS full_count
FROM   tbl
WHERE  /* whatever */
ORDER  BY col1
LIMIT  ?
OFFSET ?"
36822,49694,Return a substring from a field in SQL,"SELECT ID, SUBSTRING(content, PATINDEX('%CTid%', content) + 5, PATINDEX('%[^0-9]%', SUBSTRING(content, PATINDEX('%CTid%', content) + 5, 12)) - 1) AS CTid       
FROM ARTICLES
WHERE content LIKE '%CTid%'
"
15024,12331,mysql: unique value in a field with respect to another field,"create unique index idx_tbl_col2_col3 on (col2, col3)
"
38273,43464,Select values which are distinct in a group but not overall,"SELECT `title`
FROM `xyz`
GROUP BY `year`
       , `title`
ORDER BY `title
"
18558,36786,Joining tables with anonymous foreign keys,"Select b.rec_id,'Blog' as type from tblBlogs b
inner join tblTagAnchors ta on ta.anchor = b.anchor
where ta.tagid = 5
union
Select t.rec_id,'Tutorials' as type from tblTutorials t
inner join tblTagAnchors ta on ta.anchor = t.anchor
where ta.tagid = 5
"
33336,17144,SQL WHERE IN Clause Returning no Rows when comparing with nested functions (Crystal Reports Command with SQL-92 DB),"WHERE LOCATE(
  CONCAT(',', customer.custid,     ','),
  CONCAT(',', '{?customer_param}', ',')) != 0
"
28850,11337,Fluent NHibernate: load a fixed number of items from a collection,"var feed = session.Get<Feed>(feedId);
var first10Items = session.Filter(feed.Items, """")
                          .SetMaxResults(10)
                          .List<FeedItem>()
"
7285,14820,Select Rows Between Start and End Column (Unix timestamps),"SELECT * FROM deposit_dates
WHERE start <= 1396396810
AND end >= 1396396810;
"
15029,8294,"In TSQL, how to evaluate an expression and assign it to a BIT field?","DECLARE @bitvar BIT 
DECLARE @search_term varchar(128)

set @search_term = 'abc'

SET @bitvar = CASE 
                 WHEN (@search_term = 'abc') THEN 1
                 ELSE 0
              END

select @bitvar
"
36726,41952,Get a specific amount of rows from SQL query,"SELECT TOP 5 id, name from article
"
1867,47832,select query for names of student with marks atleast 60 in two subjects,"SELECT name
FROM yourtable
WHERE (mark1>=60)+(marks2>=60)+(marks3>=60) >= 2
"
19708,17288,Grouping a time field into 5 minute periods in SQL server,"SELECT TIMEFROMPARTS(
         DATEPART(HOUR, yourTimeField),
         DATEPART(MINUTE, yourTimeField) / 5 * 5, 0,
         0,
         0)
FROM yourTable
"
29381,70322,How to do an mySQL query that return unique values from different tables,"SELECT G.name,
   GROUP_CONCAT(P.name)
 FROM  auth_group_permission GP
 INNER JOIN auth_group G ON G.id = GP.group_id
 INNER JOIN auth_permission P ON P.id = GP.permission_id
 WHERE G.name LIKE 'BIG_RA_%'
 GROUP BY G.name
"
31879,19714,Adwords script - exclude campaign name,"WHERE CampaignName DOES_NOT_CONTAIN_IGNORE_CASE 'Test'
"
18101,39163,How can I display rows values in columns sql server?,"SELECT  [Monday] , [Tuesday] , [Wednesday] , [Thursday] , [Friday], [SATURDAY]
FROM 
(SELECT [Day],[Name],RANK() OVER (PARTITION BY [Day] ORDER BY [Day],[Name]) as rnk
 FROM SheduleWorkers) p
 PIVOT(
Min([Name])
FOR [Day] IN
( [Monday] , [Tuesday] , [Wednesday] , [Thursday] , [Friday], [SATURDAY]  )
) AS pvt
"
14961,29328,MYSQL search multiple records in the same table with the same first part of primary key,"select sale_code, sum(price * quantity)
    from sale_item
    group by sale_code
    order by sum(price * quantity) desc
    limit 1;
"
7788,60044,SQL JOIN to get a list of intventory items and alternate items,"SELECT it.INV_ScanCode, it.INV_Name, it.INV_Cost, it.INV_Retail 
FROM   Inventory_Table AS it
UNION ALL
SELECT at.ALT_ScanCode, it.INV_Name, it.INV_Cost, it.INV_Retail 
FROM   Inventory_Table AS it
  INNER JOIN Alternate_Table AS at
  ON at.INV_FK = INV_PK
"
31945,65545,How can I select non-unique fields and their sum in db2?,"SELECT  Code, SUM(Value)
FROM    Table2
GROUP BY Code
"
22703,63271,Access SQL: Choosing which table to SELECT from based on a condition,"SELECT *
FROM Attendance 
WHERE ([a checkbox on a form that indicates whether the user wants the condition] and condition) or
      (not [a checkbox on a form that indicates whether the user wants the condition] )
"
23250,41680,Query help – distinct records with max,"      select person, sport, max( date) as date 
      from activities
      group by person, sport
"
16399,34205,SQL select with multiple conditions on the same table,"select
  *
from
  table1 t1
  inner join table2 age on t1.id = age.id
  inner join table2 gender on t1.id = gender.id
where
  (age.`key` = 'age' and age.value = 20)
  and 
  (gender.`key` = 'gender' and gender.value = 'male')
"
16375,28946,SQL: INNER JOIN + NOT EXIST,"SELECT s.UserID
FROM Students AS s
LEFT OUTER JOIN EnrollStudents AS es ON s.UserID = es.UserID
GROUP BY s.UserID
HAVING COUNT(DISTINCT(es.SubjID)) < (SELECT COUNT(*) FROM Subjects)
"
23623,2863,comma separated list,"select PersonName,

(
SELECT 
  EmailAddress + ','
FROM
  dbo.Email
WHERE
  Email.PersonID = Person.PersonID
ORDER BY
 EmailAddress
FOR XML PATH ('')
) as emailAddresses

from dbo.Person
"
28316,20130,SQL: Update table by mapping two columns to each other,"update table_b as b 
inner join table_a as a on a.User = b.User
set b.value = a.value 
"
32766,42002,UPDATE and return some rows twice,"with list(name) as (
    select first_name 
    from table1 
    where first_name is not null and ready=false
    union all
    select last_name 
    from table1 
    where last_name is not null and ready=false
), u as (
    update table1
    set ready = true
    where
        (first_name is not null or last_name is not null)
        and
        not ready
)
select * from list
"
35468,4978,Getting the items belonging to specified keywords and categories,"SELECT articles.name
FROM articles
inner JOIN ckw ON ckw.article_id = articles.id
inner join ccat on ccat.article_id = articles.id
WHERE ckw.key_id IN (5, 7) 
and ccat.category_id in (12,18)
GROUP BY articles.article_id , articles.name 
HAVING COUNT(distinct ckw.key_id) = 2 
and count(distinct ccat.category_id) = 2 
"
28223,12933,PostgreSQL: How to search a list of strings as a table?,"=> select *
   from (
       values ('1', 'a', 'A'),
              ('2', 'b', 'B'),
              ('3', 'c', 'C')
    ) as t(id, c1, c2)
    where id = '2';

 id | c1 | c2 
----+----+----
 2  | b  | B
(1 row)
"
19340,18908,MSSQL - Concat the result of a query using IN,"DECLARE @consolidatedNicknames varchar(2000)
SET @consolidatedNicknames = ''

SELECT @consolidatedNicknames = 
        STUFF((SELECT ', ' + username.nickname
                FROM username
                WHERE name IN ('John','Marc')
                FOR XML PATH(''),TYPE).value('.','VARCHAR(MAX)')
            , 1, 2, '')
"
25757,34731,SQL Query Help: Returning distinct values from Count subquery,"SELECT Number
FROM Notes 
WHERE Result = 'NA'
GROUP BY Number
HAVING COUNT(Result) > 25
"
15023,52399,Select only newest grouped entries,"SELECT * 
FROM mytable mt 
    JOIN ( SELECT MAX(timestamp) as max, event 
           FROM mytable 
           GROUP BY event) m_mt 
    ON (mt.timestamp = m_mt.max AND mt.event = m_mt.event);
"
32437,9256,"MySQL Order by Date, with NULL first","select t.*
from table t
order by (start_time is null) desc,
         start_time desc
limit 1;
"
32617,52253,varchar2 to timestamp,"SELECT to_char(to_date(T.FEED_TIME,'dd:HH:MI AM')+1, 'dd:HH:MI AM')
FROM FEED_TYPE T WHERE T.FEED_CODE = 'CREDIT';
"
22638,25112,MySQL Select and Order by with a Limit that can change,"SELECT t.*
FROM table t JOIN (
    SELECT points
    FROM table r
    WHERE r.gameid = 2
    ORDER BY r.points DESC
    LIMIT 3
) tr ON t.points = tr.points
WHERE t.gameid = 2
"
2002,35706,Find duplicate ids for each timestamp,"SELECT  timestamp, badge_id
FROM    mytable
GROUP BY
        timestamp, badge_id
HAVING  COUNT(*) > 1
"
1539,52819,SQL Tree Traversal - Mesh nodes,"WITH cte AS (
  SELECT parent, child, 1 AS depth
  FROM MyTable
  UNION ALL
  SELECT t1.parent, t2.child, depth+1
  FROM cte t1
  INNER JOIN @t t2 ON (t2.parent = t1.child)
  WHERE depth < 2
)
SELECT parent, child 
FROM cte
"
29877,60744,How to use two LEFT JOINs on one query?,"SELECT E.id, E.time, E.title, E.body, E.type, C.comments, E.googleID, L.likeCount
FROM elements E
LEFT JOIN(
    SELECT elementID, GROUP_CONCAT(body SEPARATOR '|-|') AS comments
    FROM comments
    GROUP BY elementID
) C on C.elementID = E.id
LEFT JOIN (
    SELECT elementID, COUNT(id) AS likeCount
    FROM likes
    GROUP BY elementID
) L ON L.elementID = E.id;
"
2803,47608,mysql group by with having,"select t1.* from Table1 t1
join 
(SELECT MAX(Part) Part ,Ids from Table1 GROUP BY Ids ) t2
on(t1.Ids=t2.Ids and t1.part =t2.Part)
"
11865,47967,Deleting duplicates based on latest revision in SQL,"delete from rate r where r.rateRevision < (select max(r2.rateRevision) from rate r2 where r.workId = r2.workId)
"
30512,74741,Blank result for criteria not matching IN() statement,";with CTE AS (
SELECT 1 AS col_

UNION ALL 

SELECT 1 + col_
FROM cte

WHERE col_ <100
)

SELECT col_, mt.*
FROM cte

LEFT JOIN myTable mt
ON mt.id = col_
"
29514,71924,tricky SQL when joining,"SELECT objects.id as max_id, objects.episode, shows.name, shows.id
  FROM shows, objects 
 WHERE shows.id = objects.showId
   AND objects.id = (
        SELECT MAX(id) FROM objects
         WHERE name = shows.name
       )
"
13712,34431,"i created a database in my app, but i don't find it in the DDMS","/data/data/package_name/databases
"
28892,50732,How do I extend my query to join the result with another table?,"SELECT t1.col1,t2.col4
FROM table1 t1 
join table2 t2 on
t1.col1 = t2.col3
WHERE t1.col2 IS NOT NULL
"
9352,17336,SQL - Calculated field base on calculated field?,"Column A
Column B
Column C = Column A & Column B
Column D = Case When (Column A & Column B) = 001-002 then XXXX
"
14927,15783,SQL Oracle - Count of repeat call within a relative data range,"select CustomerId, CallDate, 
       (select count(*)
        from table t2
        where t2.CusomerId = t.CustomerId and
              t2.CallDate >= t.CallDate - 5 and t2.CallDate < t.CallDate
       ) as Repeat
from table t;
"
19014,57295,Access Update not working,"SELECT P.Id, P.Name, ""Status"" = 
    CASE
        WHEN R.QuantityReceived < I.QuantityOrdered THEN 'Backorder'
        WHEN R.QuantityReceived = I.QuantityOrdered THEN 'Complete'
        WHEN R.QuantityReceived > I.QuantityOrdered THEN 'Open'
    END
FROM PurchaseOrders P INNER JOIN POItem I on P.PurchaseOrderId = I.PurchaseOrderId
                      INNER JOIN POReceipt R on I.ItemId = R.ItemId
"
30909,45905,SQL DELETE with INNER JOIN,"DELETE s.* FROM spawnlist s
INNER JOIN npc n ON s.npc_templateid = n.idTemplate
WHERE (n.type = ""monster"");
"
18153,42310,A more concise way to format COUNT result with thousands separator?,"SELECT REPLACE(CONVERT(VARCHAR, CAST(COUNT([id]) AS MONEY), 1), '.00', '')
FROM tbl
"
28920,52577,Preventing Sql column overflows,"...
BEGIN TRY
   SET @Id = CONVERT(int, @Criteria)
END TRY
BEGIN CATCH
   SET @Id = NULL
END CATCH
...
"
661,333,"Using SQL DateAdd algorithm, excluding weekends","set @isweekday=case when (DATEPART(dw, @tempdate) + @@DATEFIRST) % 7 NOT IN (0, 1) then 1 else 0 end
"
9649,27823,Group by a common coloumn in a number of tables which are listed in another table,"select
x.date,
sum(x.price) as price
from
(
  (
    select 
    date,
    sum(price) as price
    from A_info
    group by date
  )
  union all
  (
    select
    date,
    sum(price) as price
    from B_info
    group by date
  )
)x
group by x.date
"
11897,67147,How to make comment reply query in MYSQL?,"SELECT *
FROM comments
ORDER BY IF(ParentId = 0, Id, ParentId), Id
"
31358,51675,sql grab duplicate record with same second column,"Select UB.ID, UB.BrokerID, UB.userId
FROM userBroker ub
INNER JOIN userBroker mUB
 on Ub.BrokerID = mub.BrokerID
 and Ub.userID <> mub.UserID
GROUP BY UB.ID, UB.BrokerID, UB.userId
ORDER BY UB.BrokerID, UB.userId, UB.Id
"
14535,27210,Sql group by month and year with rollup,"...
Group by Grouping Sets((datename(month,arvd), datepart(month,arvd), year(arvd)), ())
order by year(arvd), datepart(month,arvd)
"
3976,36954,T SQL: Inner join in sub select query?,"select r.longName, a.Country, count(*)
from ises.tbarticles a
INNER JOIN ref.tbRegions r
On a.RegionCode = r.regionCode
group by  r.longName, a.Country
order by longName
"
10966,2896,Can you query two tables in one statement in Android?,"Cursor c = mApp.getContentResolver().query(ContactsContract.Data.CONTENT_URI,
    null,
    null,
    null,
    ContactsContract.Data.CONTACT_ID + "" ASC"");
"
16414,28198,"Getting Data from a Table, if it exists on another table get it from there","select
  price.item,
  coalesce(sp.value, price.value)
from price
left join sp on sp.item = price.item;
"
5415,16380,Need sum of a fact row grouped by start year and every year after it,"select   c.customer_id, YEAR(c.created_at), SUM(o.amount) as Tot_amt
from     customers c inner join orders o on c.customer_id = o.customer_id
group by c.customer_id, YEAR(c.created_at)
"
14823,5789,Encrypted database password in Play + Slick + HikariCP application,"  def createDecryptedDbConfig (dbConfigProvider: DatabaseConfigProvider) : DatabaseConfig[JdbcProfile] = {
    val dbConfig = dbConfigProvider.get[JdbcProfile]
    val decryptedConfig = dbConfig.config.
      withValue(""db.user"", ConfigValueFactory.fromAnyRef(decrypt(dbConfig.config.getConfig(""db"").getString(""user"")))).
      withValue(""db.password"", ConfigValueFactory.fromAnyRef(decrypt(dbConfig.config.getConfig(""db"").getString(""password""))))
    DatabaseConfig.forConfig[JdbcProfile]("""", decryptedConfig)
  }
"
36971,5171,Including Null values in SQL query,"SELECT round(avg(round((datediff(now(),dateofbirth)/365),0))) as 'Average Age', 
       propertyname 
from apartment
LEFT JOIN buyer ON buyer.propertyID = apartment.propID 
group by propertyname
UNION ALL
SELECT round(avg(round((datediff(now(),dateofbirth)/365),0))) as 'Average Age', 
       propertyname 
from house
LEFT JOIN buyer ON buyer.propertyID = house.propID
group by propertyname
"
29427,42450,Optimizing simple query that takes 1 minute to execute,"SELECT
 i.id,
 ...,
 a.id AS albums_id,
 ...,
 u.id AS users_id,
 ...
FROM images i
  INNER JOIN albums a ON i.albums_id = a.id AND a.access = 'public'
  INNER JOIN users u ON a.users_id = u.id
WHERE i.num_of_views > 0
ORDER BY i.num_of_views DESC
LIMIT 0, 60
"
31425,33455,Find rows where value in column not found in another row,"select t1.Key1, t1.Key2, t1.Type
from table1 t1
left join table1 t2 
          on t1.key1 = t2.key2 
          and t2.type = 'typeb'
where t1.type = 'typea' 
      and t1.key2 is null 
      and t2.key1 is null
"
10849,9710,"Are the results deterministic, if I partition SQL SELECT query without ORDER BY?","SELECT
    *
FROM
    (
    SELECT
        *
    FROM
        Mytable
    ORDER BY SomeCol
    ) foo
"
35700,61958,Copying specific data from one MySQL table to another,"INSERT INTO new (ip)
SELECT old.ip 
FROM old
INNER JOIN new on old.email = new.email;
"
37930,15732,find the table size on IBM netezza sql database from Aginity workbench on win 7,"select used_bytes/pow(1024,3) as used_gb, *
from _v_table_storage_stat
where tablename = 'my_table_name'
"
7280,49190,How to get enum element from index,"CREATE TABLE ranks
SELECT DISTINCT rank+0 as id, CONCAT('',rank) as rank
FROM soldiers
"
7970,13040,How to set a default row for a query that returns no rows?,"SELECT val
FROM myTable
UNION ALL
SELECT 'DEFAULT'
FROM dual
WHERE NOT EXISTS (SELECT * FROM myTable)
"
39440,28989,Extracting year and month from one column and insert it into another,"UPDATE Act
   SET `year` = YEAR(`act_date`)
     , `month` = MONTH(`act_date`);
"
17809,19070,SQL Inserting multilingual data - loses diacritic marks etc,"INSERT INTO [dbName].[dbo].[tbl_Question_i18n]  
       ([QuestionId]  
       ,[LanguageId]  
       ,[QuestionText])  
 VALUES  
       (@lastinsertedquestionid  
       ,@romanian  
       ,N'Număr unic de referinţă (URN)')
"
9801,58005,How to delete some similar rows from a table?,"DELETE
FROM code_sum_country
WHERE code in
 (SELECT code
  FROM code_sum_country
  GROUP BY code
  HAVING COUNT (code) > 1) 
AND country NOT IN
 (SELECT MIN(country)
  FROM code_sum_country
  GROUP BY code
  HAVING COUNT (code) > 1)
"
7470,11838,Pivoting row data into a single column,"declare @str varchar(max)

Select @str = isnull(@str + '|', '') + testing
From temp
Order by testing

Select @str
--Results
Boomerang|Bowling|Boxing|Bull Fighting
"
14817,52360,how to display data from different tables column into one table column,"SELECT     Location =C.Location
           ,Customer =C.Customer
           ,Service =C.Service
           ,Location2=(SELECT B.Location FROM Table2 B  where     B.customerid=C.customerid)
    FROM   Customer C --  Use alais names 
"
35120,61264,selecting the maximum bids overall,"select userid, uname from user1 
where userid in 
(select bidder from bid group by bidder having count(bidder) = 
(select max(c) from (select count(*) as c, bidder from bid group by bidder)));
"
14197,11677,Counting a number of purchases with the same data values in oracle,"SELECT COUNT(PurchaseNo)
FROM PURCHASE
GROUP BY ServiceType, PaymentType, GST
HAVING COUNT(PurchaseNo) >= 1000
"
556,40136,Mysql column string based on int,"select email, 
    CASE language_id WHEN 0 THEN 'English'
                     WHEN 1 THEN 'Japanese'
                     ELSE 'Unknown'
    END as Language
from tgf_mobileuser 
where email is not null;
"
33263,12202,MySQL: Specifying the order I'd like rows returned in,"  SELECT * 
    FROM `table` 
   WHERE some_column IN(1,58,22,9)
ORDER BY FIND_IN_SET(some_column, '1,58,22,9')
"
30534,22669,mysql group_concat not bringing entire data,"
SET [GLOBAL | SESSION] group_concat_max_len = val;
"
13405,59057,SQL Issues With Different Select Statements that are Grouped together,"SELECT TOP 2 * FROM (Select 1 as 'RowNum', OeeID, FkEquipmentType, Nominal, Low from #KpiSetupOee where FkEquipmentType ='WM'
Union
Select 2, OeeID, FkEquipmentType, Nominal, Low from #KpiSetupOee where FkEquipmentType <> 'WM') A Order by 'RowNum', Nominal asc 
"
21211,72526,SQL select Distinct with where clause,"SELECT DISTINCT PersonID
FROM tableName
WHERE PersonID NOT IN
    (
        SELECT PersonID
        FROM tableName
        WHERE KvalifikationId = 2
    )
"
7268,25799,SQL Server sort column based on the same column itself,"SELECT display_order AS CurrentDisplayOrder, 
    ROW_NUMBER() OVER (ORDER BY display_order) AS NewDisplayOrder
FROM YourTable
ORDER BY display_order
"
11746,51253,How to pick the 1 st and last element of each group in a table during group by operation in SQL,"select s.DateAdded, s.Souring, s.Inake, s.placement, s.PreviousSunday, CONCAT(s.DateAdded, ' => ', e.DateEnd) as DateStartEnd
from table_name as s 
inner join (select MAX(DateAdded) as DateEnd, PreviousSunday from table_name group by PreviousSunday) as e on s.PreviousSunday = e.PreviousSunday
group by e.DateEnd
order by s.DateAdded
"
3250,73754,Unexpected performance boost after adding JOIN and ORDER BY to query,"SELECT <cols> FROM profiles INNER JOIN (
    SELECT <primary key cols> FROM profiles
    WHERE x.sex='M' ORDER BY rating LIMIT 100000, 10
) AS x USING(<primary key cols>);
"
20757,17059,PL/SQL Sum by hour,"SELECT TRUNC(stoptime,'HH'), sum(eventcapacity) 
  FROM yourtable
 GROUP BY TRUNC(stoptime,'HH');
"
5371,54398,using having in where clause,"SELECT name,count(*) as num FROM my_table GROUP BY name HAVING num > 3 OR name like '%xyz'
"
18413,49306,Finding how many users have table creation privileges,"select *
from dba_sys_privs
where privilege = 'CREATE TABLE' or privilege = 'CREATE ANY TABLE';
"
23863,41982,Conditional Where clause: Any way to write except dynamic query?,"Select 1 from dbo.EmailAddresses e
    Inner Join Users u On e.UserID = u.UserID
        Where LOWER(EmailAddress) = @EmailAddress               
        And (
            (@For = 1 AND e.JurisdictionID IS NOT NULL) OR
            (@For = 2 AND e.AccountID IS NOT NULL)
        )
"
15523,23804,How to convert columns to rows in sql server,"SELECT ID, Page, Line, City, Value
FROM SourceTable
UNPIVOT
   (Value FOR City IN 
      (C01, C02, C03)
)AS unpvt;
"
28517,8715,Why does this sql statement take so long?,"INSERT INTO tbl_LaunchWeeklyPlan IN 'C:\...\SomeDb.accdb' 
SELECT ID, LaunchID, WeekYear, LaunchWeek, LaunchYear, Quantity, true AS IsActive FROM tbl_LaunchWeeklyPlan t
LEFT JOIN tbl_LaunchWeeklyPlan IN 'C:\...\SomeDb.accdb' f
ON t.ID = f.ID
WHERE f.ID = null
"
21977,23400,When exactly is an AFTER DELETE trigger fired,"1. You delete a row on TABLE1 no COMMIT;
2. TRIGGER performs an action (This takes place before COMMIT or ROLLBACK for step1, but trigger will not have any commit or rollback in it)
3a. You apply commit - Both step1 and step2 gets completed .
3b. You apply rollback- Both step1 and step2 rolled back.
"
15644,20950,How to execute a custom command against a typed dataset,"// if DataSet name is Sales and Table name is Order

namespace SalesTableAdapters // use full namespace here
{
    public partial class OrderTableAdapter
    {
        public void CustomCommand()
        {
            // here you can use the property this.Connection
            // and execute your command
        }
    }
}
"
1481,53834,SQL Oracle Timestamp - arithmetic between two columns,"SELECT start_time - numtodsinterval( closing_hours, 'hour' ) as closing_time
  FROM app.trumps
"
13202,18586,SQL: Sort and Group by Time,"SELECT `Line`, `Order`, Sum(Qty) 
From MyTable 
Group by `Line`, `Order` 
order by `Line`, `Date`, `Time`, `Order`;
"
4345,70330,"Extremely long ""Not In"" request","delete top 1000 from session_events where session_id Not In (SELECT distinct session_id FROM sessions)
"
15526,28072,SQL create a datetime from year and number fields," Select CAST(CAST( incident_year AS varchar(4)) + '-' + 
        CAST(month_number AS varchar(2)) + '-01' AS DATETIME) as incident_Year
 from YourView
"
29803,61339,Improve sql query performance by using ordering?,"create index idx_measurementtable_sensorid_timestamp
    on MeasurementTable(SensorId, Timestamp);
"
4730,22385,Oracle: how to INSERT if a row doesn't exist,"INSERT INTO table
SELECT 'jonny', NULL
  FROM dual -- Not Oracle? No need for dual, drop that line
 WHERE NOT EXISTS (SELECT NULL -- canonical way, but you can select
                               -- anything as EXISTS only checks existence
                     FROM table
                    WHERE name = 'jonny'
                  )
"
7379,35700,SQL expression that fetches data from one table but have criterias involving several,"SELECT *
FROM Table1
WHERE Var1=x

UNION

SELECT *
FROM Table1
JOIN Table2 ON Table1.Var2 = Table2.Var4
WHERE Table1.Var1 <> x -- this is to avoid dups of rows that satisfy both cases
  AND Table2.Var3 = x
"
27723,68957,Replace a specific portion of a string,"UPDATE dbo.my_table
  SET col = REPLACE(col, 'http://123.456.789.000', 'http://www.mysite.com')
  WHERE col LIKE '%http://123.456.789.000%';
"
25793,8549,How to sum two mysql results row by row?,"select sum(value) from table group by `date`
"
8773,40999,Can't we use [specifier] with like operator with Oracle?,"select * from emp where REGEXP_LIKE (customer, '^[sr].*');
"
35309,69014,Using an equality check between columns in a SELECT clause,"case when FirstEvent.TitleID = SecondEvent.TitleID then 1 else 0 end as titlesSameCheck 
"
2449,45937,"Finding duplicates on certain fields, excluding others (Oracle/SQL)","select a.Vendor_No, a.Vendor_Name, a.Address, a.Bank_Acct_No,
       (case when min(Vendor_No) over (PARTITION BY a.Vendor_Name, a.Address, a.Bank_Acct_No) <>
                  max(Vendor_No) over (PARTITION BY a.Vendor_Name, a.Address, a.Bank_Acct_No)
             then 1
             else 0
        end) as IsDup
from vendor_data a;
"
18023,28290,how to merge two sqlite3 databases with same schema having primary key with auto increment,"INSERT INTO student(name, age)
SELECT name, age
FROM toMerge.student;
"
3540,44897,How best to copy entire databases in MS SQL Server?,"(on source server...)
BACKUP DATABASE Northwind
  TO DISK = 'c:\Northwind.bak'

(target server...)
RESTORE FILELISTONLY
  FROM DISK = 'c:\Northwind.bak'

(look at the device names... and determine where you want the mdf and
ldf files to go on this target server)

RESTORE DATABASE TestDB
  FROM DISK = 'c:\Northwind.bak'
  WITH MOVE 'Northwind' TO 'c:\test\testdb.mdf',
  MOVE 'Northwind_log' TO 'c:\test\testdb.ldf'
GO
"
37207,27153,Oracle: best way to deal with NULL values,"creb := coalesce(val, 0);
"
12831,52935,JOIN returns empty set," select ar.*
 from artists ar
 left join titles t
 on ar.artistid = t.artistid
 where ar.webaddress Is not NULL
 and t.ArtistID is null;
"
19125,46312,SQL - remove multiple entries by a non-unique id,"delete from t
where t.billid in (select billid from t where transaction = 'TestValue')
"
13176,29183,Select last 12 rows oracle,"select * from 
    ( select estatisticas, rownum rn
        (SELECT *
        FROM series 
        ORDER BY odata DESC) estatisticas 
        WHERE ponteiro = 50 AND lotus = 30
    order by odata asc) where rownum <=12
"
20014,33567,SQL GROUP BY with aggregate,"SELECT 
  tbl.colA,
  tbl.colB,
  tbl.colC,
  tbl.colD
FROM tbl JOIN (
  SELECT
    colA,
    colB,
    MAX(colD) AS maxD
  FROM tbl
  GROUP BY colA, colB
) g ON tbl.colA = g.colA AND tbl.colB = g.colB AND tbl.colD = g.maxD
"
13526,28788,How to list indexes on materialized views (Oracle),"SELECT owner, object_name, object_type
  FROM all_objects
 WHERE owner = 'SOME_OWNER' 
   AND object_name = 'SOME_TABLE' 
"
19336,20649,TSQL Generate Unique Datetime values,";with cte as
(select *,row_number() over (partition by getdate() order by getdate()) rn from entries)

 update entries
 set [moddate] = dateadd(second,rn,getdate())
 from entries e
 inner join cte c on e.col1 = c.col1
"
14339,16604,Delete all records except the most recent one?,"DELETE student
WHERE ApplicationDateTime <> (SELECT max(ApplicationDateTime) 
                              FROM student s2
                              WHERE s2.StudentID  = student.StudentID)
"
29591,55648,Using BIT datatype to filter a query in the WHERE clause,"WHERE (@param IS NULL)
   OR (@param = 1 AND email IS NOT NULL)
   OR (@param = 0 AND email IS NULL)
"
38709,44237,Find rows where one field is greater than another one,"SELECT ROWID, CreatedAt, UpdatedAt FROM TableName WHERE UpdatedAt > CreateAt;
"
1925,59556,What are the ways to improve the performance for below query,"CREATE INDEX ON REG_LOG (REG_TENANT_ID, REG_LOGGED_TIME);
"
5103,60497,Query Results mismatch the desired results,"SELECT p1.id, p2.id 
FROM person p1, person p2 
WHERE p1.momid = p2.momid 
  AND p1.dadid = p2.dadid
  AND p1.id <> p2.id
"
27869,16175,Finding a related entity which matches one field,"SELECT count(id) as campaign_count, campaign_id
FROM CampaignRegion
WHERE (city_id = 32076 OR district_id = 127 OR state_id = 7 OR country_id = 156)
GROUP BY campaign_id
HAVING campaign_count > 0;
ORDER BY (city_id = 32076) DESC, (country_id = 156) DESC, (state_id = 7) DESC, (district_id = 127) DESC;
"
32238,1370,How can I select rows by range?,"`SELECT * FROM table limit 100` -- get 1st 100 records
`SELECT * FROM table limit 100, 200` -- get 200 records after row 101
"
17921,547,sqlplus gets ORA-12504 when using EZCONNECT syntax,"C:\>sqlplus sys@\""localhost:1521/orcl12\"" as sysdba

SQL*Plus: Release 12.1.0.2.0 Production on Fri Sep 18 13:10:19 2015

Copyright (c) 1982, 2014, Oracle.  All rights reserved.

Enter password:

Connected to:
Oracle Database 12c Enterprise Edition Release 12.1.0.2.0 - 64bit Production
With the Partitioning, OLAP, Advanced Analytics and Real Application Testing options

SQL>
"
1566,27842,MySQL Selecting Linked Rows,"  SELECT a.item_id
    FROM TABLE_A a
    JOIN TABLE_B b ON b.item_id = a.item_id
   WHERE b.user_id IN (1, 2)
GROUP BY a.item_id
  HAVING COUNT(*) = 2
"
16329,62406,How can I select the rest of the row with DISTINCT?,"SELECT *
FROM (
  SELECT 
    users.*,
    (SELECT `message` from messages 
     WHERE 
    (CASE WHEN `user_to_id` = 1 THEN `user_from_id` ELSE `user_to_id` END) = users.user_id
     AND (`user_to_id` = 1 OR `user_from_id` = 1)
     ORDER BY `time` DESC limit 1
     ) AS message
  FROM users
) a 
WHERE message IS NOT NULL
"
18409,72269,SQL Queries in Oracle,"SELECT COUNT(v.FK_patients)
FROM visit v
JOIN Diagnosis d on d.ID_Diagnosis = v.FK_diagnosis --Here is where you connect the tables
WHERE v.Date_Visit BETWEEN
TRUNC(ADD_MONTHS(SYSDATE,-12),'YEAR') AND TRUNC(SYSDATE,'YEAR')-1 ;
"
28052,68559,how to group an ID field and select rows having highest value in another field PostgreSQL,"select distinct on (productid) 
    gtab04.product,
    productid,
    gtab05.mrp,
    gtab05.ptr,
    gtab05.ssr,
    patent
from
    gtab05
    inner join
    gtab07 using(patentid)
    inner join
    gtab04 using(productid)
where qty-iqty > 0
order by productid, gtab05.mrp desc
"
39291,48479,SQL questions for selecting correct data,"SELECT PC.product_id, KC.color_id, C.color_name 
FROM kit_color as KC
LEFT JOIN color as C
ON KC.color_id = C.color_id
LEFT JOIN product_color as PC
ON PC.color_id = C.color_id
WHERE KC.id = %s
"
3595,10803,Formatting text boxes for postal codes & zip codes,"Private Sub txtPostCode_KeyDown(KeyCode As Integer, Shift As Integer)
  If KeyCode = vbKeySpace Then KeyCode = 0
End Sub

Private Sub txtPostCode_KeyPress(KeyAscii As Integer)
  Select Case KeyAscii
    Case Asc(""a"") To Asc(""z"")
      KeyAscii = KeyAscii + Asc(""A"") - Asc(""a"")
  End Select
End Sub
"
37557,59697,Use decode in sql query,"SELECT osuser, machine,
       NVL(DECODE (process, 
                   '1234', 'JDBC', 
                    substr(process, 1, instr(process || '@','@')-1)), 
           'NA') ""PID""
FROM   v$session
WHERE  username IS NOT NULL;
"
517,8748,Truncate multiple tables in SQL Server using stored procedure,"CREATE PROCEDURE truncate_tables
AS
    TRUNCATE TABLE dbo.table1;
    TRUNCATE TABLE dbo.table2;
    TRUNCATE TABLE dbo.table3;
"
13386,26955,Reformat Excel List into Tagged Search,"SITE | TAG 
URL1 | Tag1 
URL1 | Tag2
URL1 | Tag3
URL2 | Tag1
URL2 | Tag3
URL3 | Tag1
"
8872,58094,Searching date MySql,"SELECT * FROM `a` 
WHERE `date` = '2015-06-01'
AND `hour` BETWEEN '16:30:00' AND '17:30:00'
"
3997,50848,oracle - don't transfer blobs,"v_sql := 'SELECT col1, col2, col3, ''(BLOB)'' as blob_col FROM mytable';
"
18411,11890,How to Insert Null Value into a Column which already have a Value using MySQL,"UPDATE your_table
SET    
serialNumber = null
WHERE  ID = 1;
"
12705,68718,Order result with LIKE operator,"SELECT * FROM Customers
WHERE Country LIKE '%land%'
order by charindex('land', Country)
"
22049,10420,How to check if multiple columns exists in SQL Server,"IF  EXISTS (SELECT * FROM sys.columns 
WHERE OBJECT_ID = OBJECT_ID('tableName')
AND( Name = 'columnName1' OR Name = 'columnName2' OR Name = 'columnName3')
)
BEGIN
PRINT 'Your Columns Exist'
END 
"
28701,71747,Oracle select from a list of values with an index,"regexp_substr('value1|value2|value3', '[^|]+', 1, index)
"
19513,74189,Joining two table,"select t1.AttendanceDate, t1.EmployeeCode, case when t2.duration is null then t1.duration else t2.duration end 
from table1 t1 left outer join table t2 on t1.AttendanceDate= t2.AttendanceDate and  t1.EmployeeCode =  t2.EmployeeCode
"
10721,54596,"SQL case when using IN clause, clean way?","where 
(@PartStockID = '' OR PartStockID in (SELECT ID FROM dbo.Split_List_Int(@PartStockID)) OR PMS_PartStock.PartStockID = PMS_PartStock.PartStockID )
"
28763,25236,Update to Exclusive lock conversion,"-- Clustered index (C index)
NCCol2 IDA lockhash (these values are the ""identifier"" of locks)
------ --- --------------
1      11  (29cf3326f583)
2      22  (31178495a25a)

-- Non-Clustered index (NC index)
NCCol2 lockhash
------ --------------
1      (8194443284a0)
2      (61a06abd401c)
"
20282,44995,CASE WHEN - What am I doing wrong?,"AND lp.lease_current_stop_date BETWEEN getdate() AND dateadd(MONTH, @lease_expiry_period, getdate())
"
6455,73627,Select distinct from multiple columns and its matching values sum,"SELECT x.prod
     , SUM(x.prod_qty) AS total
FROM (
       SELECT prod1 AS prod, prod_qty AS total FROM table
          UNION ALL
       SELECT prod2 AS prod, prod_qty AS total FROM table 
          UNION ALL
       SELECT prod3 AS prod, prod_qty AS total FROM table
     ) x 
GROUP BY x.prod
"
7147,46351,Database query in sql server,"use abc;
go

select s.date, s.userid
from dbo.sal s
where s.userid in (
    select e.userid 
    from xyz.dbo.emp e
    where 'a.b' in (e.userid, e.[create])
)
"
9490,39426,Problem updating a sql view,"create view B 
as
     select b.Id,
              b.Name,
              a.*
     from tableB b
     inner join A  on a.Id = b.Id 
"
22751,29720,Performance of DELETE with NOT IN (SELECT ...),"delete from ms_author ma
where not exists (
  select null
  from author a
  where ma.name = a.name
)
"
6070,666,using if statement in mysql query,"SELECT 
*
FROM
 tractions_delivery,
 user_address,
 province,
 city,
 date_send_commodities,users
WHERE
 tractions_delivery.tr_id = $tr_id AND
 tractions_delivery.address_id = user_address.id AND
 user_address.province_id = province.id AND
 user_address.city_id = city.id AND
 CASE WHEN tractions_delivery.send_date_id != 0 THEN date_send_commodities.id = tractions_delivery.send_date_id ELSE 1=1 END AND
 users.id = user_address.user_id
"
37120,9264,How to get count of records added since the start of the current month,"SELECT COUNT(*)
FROM ws_account_log
WHERE
      account_log_account_id='1'
  AND account_log_timestamp >= SUBDATE(CURDATE(), DAYOFMONTH(CURDATE())-1)
"
29861,55985,Select values from a column into a pipe-delimited row,"SELECT Result = STUFF((SELECT '|' + ColumnA
    FROM dbo.[table]
    FOR XML PATH('')), 1, 1, '');
"
4451,58819,How to populate a new table with data from two other tables?,"INSERT INTO Plaatscode
(
  plaatscode,
  stedenadviseur,
  land
)
SELECT
a.plaatscode, v.stedenadviseur, a.land
FROM Accommodatie a
INNER JOIN Vervoer
ON a.plaatscode = v.plaatscode
"
21797,6292,Using Like on a Parameter Variable?,"create table the_table 
(
  category varchar(10),
  [Date] datetime,
  Amount decimal(12, 2)
)

insert into the_table
values
( 'X', '2012-1-1', 10),
( 'X', '2012-1-3', 10),
( 'Y', '2012-1-3', 20),
( 'Y', '2012-1-5', 10)

declare @Variable varchar(10)
set @Variable = 'Y'

Select * 
From the_table 
--Where @Variable Like '%' + category + '%' 
Where category Like '%' + @Variable + '%' 
"
24149,19612,MySQL UPDATE with subquery with group by,"UPDATE Elements e
LEFT JOIN References r ON e.OneName = r.OtherName
SET e.referenced = r.OtherName IS NOT NULL;
"
3780,67672,Insert sequential numbers based on another field - MySQL,"set @p := -1;
set @i := 0;

UPDATE my_table t
    SET page_number = (CASE WHEN @p = t.`parent` THEN @i := @i+ 1 
                            WHEN (@p := t.parent) = NULL THEN NULL -- never happens
                            ELSE @i := 1
                       END)
    ORDER BY t.parent;
"
21380,44335,How to use regexp_substr() with group of delimiter characters?,"SQL> with tbl(str) as (
      select 'SERO02~~~NA_@ERO5' from dual
    )
    select regexp_substr(str, '(.*?)(~~~|$)', 1, level, null, 1) element
    from tbl
    connect by  level <= regexp_count(str, '~~~') + 1;

ELEMENT
-----------------
SERO02
NA_@ERO5

SQL>
"
10965,35223,Conditional column for query based on other columns in MySQL,"select User_id
,case 
    when (YEAR(DOB) < 1980 AND Job_Title = ""manager"")   then 'Old Fart'
    when (YEAR(DOB) < 1980 AND Job_Title = ""associate"") then 'Old Timer'
    when (YEAR(DOB) > 1980 AND Job_Title = ""manager"")   then 'Eager Beaver'
    when (YEAR(DOB) > 1980 AND Job_Title = ""associate"") then 'Slacker'
    else 'nobody'
end
as Real_Title 
from users
"
18700,18802,Jquery flowplayer a href needs two clicks?,"<a href=""-previous page-""> Back </a> 
"
19940,67663,"Order by SUM, but do NOT aggregate the result set (order by subtotals)","select t.*
from table t join
     (select store, sum(amount) as totalamount
      from table t
      group by store
     ) ts
     on t.store = ts.store
order by ts.totalamount desc, ts.store;
"
11122,21952,Postgresql : how can i get desired output as described below,"SELECT t.item,sum(cast(coalese(b.quantity,'0') as integer)) as total_quantity FROM (
    SELECT 'pen' as item
    UNION
    SELECT 'pencil' as item
    UNION
    SELECT 'scale' as item
    UNION
    SELECT 'eraser' as item
    UNION
    SELECT 'sharpener' as item) t
LEFT OUTER JOIN box b
ON(t.item = b.item)
GROUP BY t.item
UNION
(SELECT 'total',sum(quantity)
FROM box)
"
20844,19058,How to stop insertion of Duplicate documents in a mongodb collection,"db.collection.update(
   <query>,
   <update>,
  {
    upsert: <boolean>,
     multi: <boolean>,
    writeConcern: <document>
   }
  )
"
10283,45514,Updating associated table with the values imported from a comma-separated file,"UPDATE [ROLE]   SET
 ProductId=@ProductId,
 [Name]=@Name
WHERE RoleId=@RoleId

DELETE FROM RolePermission  WHERE  RoleId=@RoleId
INSERT INTO RolePermission 
SELECT @RoleId, P.Items
FROM dbo.Split(@PermisionIds, ',') P
"
39045,57962,using left outer join get get all links from the table,"SELECT COALESCE(p.Permalink, '')
FROM Languages l
LEFT JOIN dbo.Product p ON p.IDLanguage = l.IDLanguage
WHERE p.IDProduct = 1 OR p.IDProduct IS NULL
ORDER BY L.IDLanguage
"
26001,42986,Mysql Update Records,"UPDATE SET table SET user_name= CAP_FIRST(CONCAT(SUBSTRING_INDEX(user_name, ' ',-1), ' ', SUBSTRING_INDEX(user_name, ' ',1)))
"
3458,34781,SQL Query Execution more than once?,"SET TRANSACTION ISOLATION LEVEL SERIALIZABLE
GO

BEGIN TRANSACTION

--select * from A
-- update B ....
--update A

WAITFOR DELAY '00:00:02'   -- tables remain locked for 2 secs   hh:mm:ss

commit TRANSACTION
"
12214,6761,Joining two indentic select queries in order to get different rows in different columns,"SELECT tag1, tag2, tag3 FROM
(
(SELECT tag1...) AS t1
LEFT JOIN
(SELECT tag2...) AS t2
ON(t1.tag1 < t2.tag2)
LEFT JOIN (SELECT tag3...) AS t3
ON(t2.tag2 < t3.tag3)
) LIMIT(1);
"
29730,5384,Average a column returned from a subquery,"SELECT SUM(`retail_subtotal`)/count(distinct lead_id) as avg
FROM `order`
WHERE `status` IN ('O')
"
19855,45710,SQL query - filter primary keys,"Select table1.A, table1.B, table2.C, Table3.D
from table1 T1
left outer join table2 on table1.A = table2.A
left outer join tabl3 on table1.B = table3.B
where not exists (select 1 from badTable where A = T1.A and B = T1.B)
"
28142,72668,Oracle TO_DATE not working,"SELECT employee_id, last_name,hire_date
FROM employees WHERE hire_date > TO_DATE('25-JUN-90','dd-mon-RR');
"
36236,5811,Syntax for SQL Server when either of parameter is passed,"WHERE PROCESS_STEP_ID = coalesce( @processStepID, @PROCESS_StepID )
"
39603,9045,Help with SQL query - some magic needed,"SELECT a.ActivityID, a.Duration, a.BilledAt
FROM BilledTime a
LEFT JOIN BilledTime b on a.ActivityID = b.ActivityID AND b.BilledAt > a.BilledAt
WHERE b.ActivityID IS NULL
"
14427,38556,Can't get unique values joining two tables,"SELECT
   MAX(t1.MB#) AS MB#,
   t2.RTU,t2.[Device Manufacturer],t2.PCC#_PRI,t2.PCC#_SEC,t2.[STATION ADDRESS] 
INTO C300_RTU_MASTERBLK_Map
FROM 
   dbombm_PCDIMasterBlk_tbl as t1
   JOIN
   dbo.WOA_PCC_Conn_tbl as t2 ON t1.PCCNo_PRI = t2.PCC#_PRI
GROUP BY
   t2.RTU,t2.[Device Manufacturer],t2.PCC#_PRI,t2.PCC#_SEC,t2.[STATION ADDRESS] 
"
10730,70980,MySQL Alias Column Wildcards,"example: select a.emp_name as task_empame, a.location as task_location from ...
"
10309,51650,SQL query with CONCAT LIKE AND,"SELECT b.* FROM
(
   SELECT a.*, LOWER(CONCAT(a.address, a.name)) AS field_to_check
)b 
WHERE b.field_to_check LIKE (LOWER ('%boston%')) 
 AND  b.field_to_check LIKE (LOWER('%smoke%'));
"
36216,1516,"""WHERE IN"" with strict compliance of matches","SELECT rh.room_id
FROM room_human rh
GROUP BY rh.room_id
HAVING GROUP_CONCAT(rh.human_id ORDER BY rh.human_id)='1,2,3,4,5';
"
14992,8878,SQL - Max dates,"SELECT HIC,CODE,PROVIDER DATE,TypeCode,MAX([Effective Date])[Effective Date]
FROM <TABLE>
GROUP BY HIC,CODE,PROVIDER DATE,TypeCode
"
31393,73934,MySQL filter out self-references,"SELECT e.*
FROM `event` e            # 'e' from 'event'
  LEFT JOIN `event` d     # 'd' from 'derived'; `LEFT JOIN` gets ALL entries from `e`
    ON e.id = d.derivedfrom_id    # match an event `e` with all those `d` derived from it
WHERE d.id IS NULL        # keep only events `e` without derived events `d`
;
"
3062,72208,Compare Values Between Two Tables," select
      isnull(a.item_id,b.item_id) as item_id, isnull(b.qty, 0) - isnull(a.qty, 0) as qty
    from
      table_a a
      full outer join table_b b on a.item_id = b.item_id
"
4519,66783,Get the duplicate records based in 2 columns,"SELECT O.EMP_ID 
FROM ORDERS O 
GROUP BY O.EMP_ID  
HAVING COUNT(distinct O.ITEM_ID) <> COUNT(*)
"
29185,17447,SQL Update Statement in MS Access,"UPDATE Network Inner Join Enclave ON Network.ID=Enclave.ID
SET Network.Location = IIF(Enclave.Site=False, Enclave.Location, """"),
Network.AlternateLocation = IIF(Enclave.Site=True, Enclave.Location, """")
"
28699,14682,using sql variable in sum() like this--sum(@wokao) cause unpredicted result,"SELECT @a, @a:=@a+1, ...;
"
17807,40739,Can a foreign key act as a primary key?,"SELECT
    student_accounts.name AS student_name,
    counselor_accounts.name AS counselor_name
FROM
    student_rec
    INNER JOIN user_accounts AS student_accounts
      ON student_rec.student_number = student_accounts.user_id
    INNER JOIN user_accounts AS counselor_accounts
      ON student_rec.guidance_counselor_id = counselor_accounts.user_id
"
15779,45720,Sum comma separated values in Oracle SQL,"create or replace function calc(i_str in varchar2)
  return number is l_result number;
begin
  execute immediate 'select ' || i_str || ' from dual'
    into l_result;
  return l_result;
exception
  when others then
    return null;
end;

select calc(replace('0,4,2,88,6', ',', '+')) from dual
--> 100
"
38532,15516,ORDERY BY in query with composite field,"SELECT 
    * 
FROM 
    Table
ORDER BY 
    YEAR DESC, 
    MONTH DESC
"
38036,35957,Selecting all records entered in a particular day - MySQL,"WHERE 
     your_timestamp >= search_date 
AND 
     your_timestamp < search_date + INTERVAL 1 DAY
"
35207,74871,Updating table metadata on the fly,"CREATE PROC dbo.OurMetaDataUpdate
   @tablename ...
   @uniqueid ...
WITH EXECUTE AS OWNER
AS
SET NOCOUNT ON

EXEC sp_addextendedproperty ...
GO
"
12634,65351,LISTAGG function with two columns,"select user_id
     , listagg(department || ',' || nvl(position, ' '), '; ')
        within group ( order by record_id )
  from report
"
5595,17170,SQL: how to find maximum value items according a attribute,"SELECT name, dept_name, salary
FROM tbl t
WHERE NOT EXISTS(SELECT salary FROM tbl t2 WHERE t2.salary>t.salary AND t2.dept_name=t.dept_name)
"
8919,5045,how to group by and return sum row in Postgres,"SELECT id, SUM(amount) AS amount
FROM yourtable
GROUP BY id
"
24667,72440,Parse XML Without Knowing The Schema,"SELECT 
    e.e.value('../recordid[1]', 'INT') As [recordid]
    ,e.e.value('fn:local-name(.)', 'NVARCHAR(100)') As [ElementName]
    ,e.e.value('.', 'NVARCHAR(100)') As [Value]
FROM @xml.nodes('/*/*/*') e(e)
WHERE
    e.e.value('fn:local-name(.)', 'NVARCHAR(100)') != 'recordid'
"
26080,22890,where clause with Is null and not in,"WHERE  (   t1.column1 != 'test'
       AND (t2.column1 IS NULL OR t2.column2 IS NULL)
       )
    OR t1.column1 IS NULL
"
36487,62268,How would I convert this query to one using sub queries?,"select p.ProductNumber, p.Name
from product p
where p.ProductSubcategoryID in (select ps.ProductSubcategoryID
                                 from productsubcategory ps
                                 where ps.Name = 'Pedals'
                                )
order by p.ProductNumber;
"
10641,34576,Difference Between Timestamps in Milliseconds in Oracle,"select
  extract(second from systimestamp - doj) * 1000
from
  test1;
"
27614,6314,Representing 'not in' subquery as join,"select e.*
from employees e
left join managers m on e.emp_id = m.emp_id
where m.emp_id is null
"
9030,16293,Exclude rows with specific columns values from SELECT,"SELECT stock, quant
FROM yourTable 
WHERE NOT(stock_status = 10 AND quantity <= 0); 
"
33119,4311,Case condition does not return desirable results,"SELECT
    AccountTitle,
    CASE
        WHEN SourceDocDR < 1 THEN  ''        
        ELSE CAST(SourceDocDR AS VARCHAR(MAX))
    END AS 'Debit',
    CASE
        WHEN SourceDocCR < 1 THEN ''
        ELSE CAST(SourceDocCR AS VARCHAR(MAX))
    END AS 'Credit'
FROM tblAccounting_GL
WHERE 
    MONTH(PostingDate) = MONTH(GETDATE())
GROUP BY 
    AccountTitle, SourceDocDR, SourceDocCR;
"
20106,71339,How can I make SQL case sensitive string comparison on MySQL?,"
col_name COLLATE latin1_general_cs LIKE 'a%'
col_name LIKE 'a%' COLLATE latin1_general_cs
col_name COLLATE latin1_bin LIKE 'a%'
col_name LIKE 'a%' COLLATE latin1_bin
"
25951,28174,Cursor inside trigger and updating the table column," create or replace trigger PT_AD_ROLE after DELETE OR UPDATE on ROLE_TABLE for each row
      begin

       update user_table set lastModifiedTime=current_timestamp() from user_table u,role_table r,user_role  ur where r.role_id=ur.role_id and ur.user_id=u.user_id and r.role_id=:old.role_id;
    end

;
"
20288,35774,how to print a sum of column in all rows in sql,"SELECT 
    a.player_name, 
    a.number_of_goals, 
    (a.number_of_goals / b.goalsum)*100 AS percent_scored,
    b.goalsum
FROM   
    myPlayerInfo a
CROSS JOIN 
    (SELECT SUM(number_of_goals) AS goalsum FROM myPlayerInfo) b
"
20073,75307,Create a new Oracle Application Express (APEX),"update mt_table set username = nvl(v('APP_USER'), user);
"
5782,35677,"Perform a ""Union"" of two tables using ""join"" operator","select coalesce(A.A_Name, B.B_Name)
from A full join B on 1=0;
"
27648,60555,SQL date selecting,"SELECT *
FROM myTable
WHERE ( YEAR(myfield) = '2009')
  AND ( MONTH(myfield) = '1')
"
35844,33914,How to implement a friendship system in my database?,"select case when id_user1=$my_user_id then alias_user2 else alias_user1 end
from friends
where id_user1=$my_user_id or id_user2=$my_user_id
"
31675,47455,How to round a product of two columns in a sql query,"ROUND(orders.quantity * products.price, 2)  AS total
"
34177,74457,Querying all records from two tables,"SELECT 
`a`.`StudentID`,
`q`.`IdQuestion`, 
`q`.`QuestionTXT`, 
`a`.`Answer` 
FROM `questions`  q
LEFT JOIN `answ` a
 ON `a`.`IdQuestion` = `q`.`IdQuestion` 
AND `a`.`StudentID` = 'A'
"
34776,3136,Excel vlookup incorporating SQL table,"SELECT TOP 1 [Value] FROM [MyTable] WHERE [Postcode] = 'AB12 1AA';
"
38164,69856,Select one column multiple time,"select test, 'rent1' from tableA where condA
union
select test, 'rent2' from tableA where condB
"
6184,48106,Minimum price selection,"select min(price)
  from products
  where product_number = :my_product
"
12551,24594,Stored procedure that does not filter if a variable is null,"or t3.AcctCode is null
"
17375,67904,Many-To-Many + WHERE field <> value,"SELECT p FROM BlogRegionBundle:Post p LEFT JOIN p.tags t WHERE t.id = :blogId AND p.state = :state AND p.deleted = 0 AND :user NOT MEMBER OF p.views
"
22395,42650,Copy a Table's data from a Stored Procedure,"USE Master_DB
CREATE PROCEDURE TransferData
 @tableFrom   SYSNAME
 ,@tableTo    SYSNAME
 ,@databaseTo SYSNAME
AS
DECLARE @sql NVARCHAR(MAX)
SET @sql = 'INSERT INTO ' + @databaseTo+ '.dbo.' + @tableTo + '
            SELECT * FROM Master_DB.dbo.' + @tableFrom

EXEC sp_executesql @sql
GO;
"
34151,19907,How would I write a trigger to reorder a sequence number?,"ID   NAME    SEQ
1111 Fred    10
2222 Bob     20
3333 Ted     30
"
17776,59951,Oracle Date Aggregating,"select to_char(dateid, 'YYYY-MM')||'-01' as thedate, count(*)
from picture_table
group by to_char(dateid, 'YYYY-MM')
order by 1, 2
"
30093,30590,How can I get the length of a session in SQL given multiple timestamps?,"SELECT N.SessionId
    ,DATEDIFF(MINUTE, MIN(N.Time), MAX(N.Time)) AS [sessionLenght]
FROM dbName N
WHERE N.SessionId IS NOT NULL
GROUP BY N.SessionId
ORDER BY N.SessionId
"
18013,36062,ORA-00932 inconsistent datatypes expected char got number,"select case when a = 0 then 'INVALID'
            else to_char(a)
       end
  from ( select sum( case when upper(txt) <> lower(txt) then 0
                          else to_number(txt)
                     end ) as a
           from class )
"
36785,59104,Storing multiple date ranges,"  id  userid startDate  EndDate
 ---- ------ ---------- ----------
    1     1  2014-04-01 2014-04-06
    2     1  2014-04-06 2014-04-09
    3     1  2014-04-09 2014-04-11
    4     1  2014-04-11 null
"
22588,62069,Getting two columns referring to one table from the same row in a table?,"SELECT W.LastName + ', ' + W.FirstName AS [Worker], 
       M.LastName + ', ' + M.FirstName AS [Manager], 
       Details.SiteName AS [Site Name], 
       Details.Description AS [Description], 
       Details.Action AS [Action],
FROM Details 
INNER JOIN Staff AS W ON Details.Worker = W.StaffID 
INNER JOIN Staff AS M ON Details.Manager = M.StaffID
"
18510,8201,MySQL Insert Data into Table1 when a matching record is found in Table2,"UPDATE data1 a, Data2 b
SET a.name= b.name
WHERE a.emailaddress = b.emailaddress
"
15148,49849,"Sub query issue, SQL Server 2008","select count(*) from 
( select id, totalcharges from tblVisits where (totalcharges <10000)) t
"
39845,38673,mySQL select distinct and add unique value,"select p.Patient_ID, 
       (@rn := if(@p = p.Patient_ID, @rn,
                  if(@p := p.Patient_ID, @rn + 1, @rn + 1)
                 )
       ) as New_Unique_Value
from t cross join
     (select @rn := 0, @p := -1) params
order by patient_id;
"
24316,8145,get lowest value while using group by and order by,"SELECT fname, lname, min(time) as tune
FROM Times
WHERE event = '1600m'
GROUP BY fname, lname
ORDER BY time
LIMIT 10
"
30858,32385,Find all user in table A that are also in Table B,"select a.user1, a.user2 from a, b 
where (a.user1 == b.user3 and a.user2 == b.user4)
or (a.user1 = b.user4 and a.user2 = b.user3);
"
36754,27511,How to select multiple rows to multiple columns?,"select max(case when id=1 then name end) as name_1,
        max(case when id=2 then name end) as name_2
From test
"
24449,33992,Retrieving rows that share multiple ID's in SQL,"SELECT DISTINCT w.WidId, p.ParId, w.Name
FROM Widget w
JOIN WidgetCategory wc ON wc.WidId=w.Id
JOIN PartCategory   pc ON pc.CatId=wc.CatId
JOIN Part           p  ON p.Id=pc.ParId
"
31624,58836,How to determine the hostname in Oracle APEX?,"function call                    |  result
---------------------------------|-----------------------------------
APEX_UTIL.HOST_URL()             |  http://example.com:5883
APEX_UTIL.HOST_URL('SCRIPT')     |  http://example.com:5883/pls/apex/
APEX_UTIL.HOST_URL('IMGPRE')     |  http://example.com:5883/i/
"
19259,16248,"using not in clause the right way in sql, don't know how to select from gender","select 
   e.lname, e.fname, e.ssn
from employee e
where e.ssn  not in (
                      select essn
                        from dependent
                     )
    AND e.sex = 'Female'
"
11110,58666,SQL Server 2008 select with regular expression,";with T as (
    select 0 as row, CHARINDEX('/', Col) pos, Col from page_data
    union all
    select row + 1, CHARINDEX('/', Col, pos + 1), Col
    from T
    where pos > 0
)
select distinct MIN(Col1) Col
from(
    select 
         row,
         Col,
         (case when row=2 then SUBSTRING(Col, 1, pos-1) else Col end) Col1
    from T 
    where pos > 0 and row<3
)x
group by Col
"
11120,28327,Building a hierarchical tree with a single SQL query,"WITH RECURSIVE tree (id, par, name) AS (
    SELECT id, par, name 
    FROM the_table
    WHERE name = 'Nicole'

    UNION ALL

    SELECT id, par, name 
    FROM the_table tt
      JOIN tree tr ON tr.id = tt.par
)
SELECT *
FROM tree
"
39233,34370,How to extract hour for MySQL FROM_UNIXTIME() results?,"GROUP BY
    DATE_FORMAT(FROM_UNIXTIME(time_column), '%Y %m %d %H'))
"
20309,63685,Search a table using a string,"ALTER PROCEDURE [dbo].[test]
    @search_string varchar(50)
"
5457,69395,How to obtain Max(Rank) for a Specific Month,"select v.*
from (select v.*, rank() over (partition by month order by [rank] desc) as rankrank
      from view v
     ) v
where rankrank = 1;
"
16794,45335,Select rows no more than 6 months old using MySQL,"select id
from your_table
where your_timestamp_column <= (now() - interval 6 month);
"
28183,6309,Table has one record per employee per year. How do I select the record for each employee for the latest year for that employee?,"SELECT employee_ref, firstname, lastname
FROM table
WHERE employment_year = (
    SELECT MAX(employment_year)
    FROM table b
    WHERE b.employee_ref = table.employee_ref)
"
34073,67449,How to show the vertical data horizentally through sql,"SELECT  JID,WID,AccountReference,OEReference,InvoiceNumber
FROM    
( 
    SELECT colname, data FROM YourTableName
) 
p 
PIVOT 
( 
    Max(data) FOR colname 
    IN ([JID],[WID],[AccountReference],[OEReference],[InvoiceNumber])
) AS pvt
"
31520,33047,Shifting primary keys of several rows at once,"UPDATE KEYS
    SET id = -1, version = version + 1
    WHERE id = 1 AND version >= 2;

UPDATE KEYS
    SET id = 1
    WHERE id = -1;
"
23621,36695,Drilling Down the Data ColdFusion,"SELECT p.uid_product, p.txt_prod_name
FROM   tbl_products p  INNER JOIN tbl_product_features f 
           ON p.uid_product = f.uid_prodf_prodid
WHERE  f.uid_prodf_featid IN ( <cfqueryparam cfsqltype=""CF_SQL_INTEGER"" value=""#arguments.uid_features#"" list=""true""> )
GROUP BY p.uid_product, p.txt_prod_name
HAVING COUNT(f.uid_prodf_featid) = <cfqueryparam cfsqltype=""CF_SQL_INTEGER"" value=""#ListLen(arguments.uid_features)#"">
ORDER BY p.txt_prod_name
"
16216,46534,SQL count() with group by not returning 0/zero records,"SELECT division, ISNULL(ct,0) AS ct
FROM divisionTable
LEFT JOIN
(SELECT division, COUNT(ID) as ct FROM Test WHERE role >=101 GROUP BY division) CountQuery
ON divisionTable.division = CountQuery.division
WHERE divisionTable.division IN (1,2,4)
"
32977,44683,SQL Server table creation date query,"SELECT
        [name]
       ,create_date
       ,modify_date
FROM
        sys.tables
"
3381,51571,SQL composite primary key without ordering (pair of integers in either order must be unique),"DELIMITER |
CREATE TRIGGER enforce_friendship_id_order BEFORE INSERT ON UserFriendships
  FOR EACH ROW BEGIN
    SET @lowerId := IF(NEW.userIdA < NEW.userIdB, NEW.userIdA, NEW.userIdB);
    SET @higherId := IF(NEW.userIdA > NEW.userIdB, NEW.userIdA, NEW.userIdB);
    SET NEW.userIdA = @lowerId;
    SET NEW.userIdB = @higherId;
  END;
|
DELIMITER ;
"
21781,24218,MySQL : collect the sum of the associated values,"SELECT date,SUM(in_stock) in_stock,SUM(out_stock) out_stock FROM
 (
 SELECT stock_date date,quantity in_stock,0 out_stock FROM article
  UNION
 SELECT selling_date,0,quantity FROM selling JOIN selling_detail ON selling_detail.selling_id = selling.id
 ) x
GROUP BY date;
"
7458,52117,How do I move (INSERT+DELETE) the last n rows from a table in Jet SQL / Access 2003?,"INSERT INTO ChatArchive (MsgId, MsgText, Filtered, LastFetched) SELECT MsgID, MsgText, Filtered, LastFetched FROM ChatCurrent WHERE ID <= (SELECT MAX(ID) from ChatCurrent) - 500;
DELETE FROM ChatCurrent WHERE MsgId <= (SELECT MAX(MsgId) FROM ChatArchive);
"
18073,46345,Nested SQL statements for Oracle,"select
  b.TITLE,
  a.LASTNAME,
  i.UNITSONHAND
from
  BOOK b
  inner join AUTHOR a on a.AUTHORID = b.AUTHORID
  inner join INVENTORY i on i.BOOKID = b.BOOKID
  inner join BRANCH br on br.BRANCHID = b.BRANCHID
where
  br.BRANCHID = 4
"
11379,42203,Export tables from data modeler to oracle database by sql developer,"-- Generated by Oracle SQL Developer Data Modeler 4.1.0.873
--   at:        2015-05-22 05:39:15 EDT
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g


CREATE TABLE TABLE_1
(
    Column_1 INTEGER NOT NULL ,
    Column_2 BLOB ,
    Column_3 CHAR (4)
) ;

ALTER TABLE TABLE_1 ADD CONSTRAINT TABLE_1_PK PRIMARY KEY ( Column_1 ) ;
"
6914,75625,update using increments in mysql return duplicate key error,"UPDATE x SET y = y + 1 order by y DESC
"
28796,7117,Using WHERE clause to only retrieve results where array field has only ONE element inside,"SELECT *
FROM   attr_lookup
WHERE  array_length(target_tcode, 1) = 1;
"
37945,19339,Sql query to show minutes as hours,"select 
 PSProjectId,CodePattern,NCR,sum(totaltime)/60.0 as totaltime --totaltime is in minutes
  from ct2
group by PSProjectId,CodePattern,NCR
"
28222,56337,Informix SQL - Simple select query is returning unexpected results,"select count(*) 
from id_rec 
where correct_addr <> 'N' 
    or correct_addr is null; 
"
1446,58633,Is there a way to SELECT by a part of a date in SQL?,"SELECT * FROM table WHERE datetime LIKE '2007-05%'
"
4486,60566,mysql update row to previous enum value,"UPDATE tablename SET status = case status when 'b' then 'a'
                                          when 'c' then 'b' end
WHERE id = '1' and status <> 'a'
"
1289,21993,updating a table by joining multiple tables,"UPDATE catalog_topics a
LEFT JOIN catalog_files_join b ON a.catalogID = b.foreignKey
LEFT JOIN catalog_files_join c ON c.foreignKey = b.catalogFileID
LEFT JOIN catalog_files d ON d.catalogFileID = b.catalogFileID
LEFT JOIN catalog_lu_topics e ON a.topicID = e.topicID
SET d.catalogFileID = 'cfil123',
    b.catalogFileID = 'cfil123'
WHERE b.fileTypeID = 'gvl401'
AND c.fileTypeID = 'gvl25'
AND e.parentID = 'top305'
AND a.sortorder =1
AND e.topicID = 'top318'
"
39109,21905,How do I use the LIKE query in and UPDATE statement? *Example provided*,"UPDATE MEMBERS
SET Address = REPLACE(Address, 'Road', 'Rd')
WHERE Address LIKE '*Road'
"
3612,35564,Can't connect with Database with required ORACLE_SID,"Control Panel -> System -> Advance system settings-> Environment Variables
"
17396,64720,SQL Select Statement Interview Query,"SELECT * FROM A
UNION
SELECT * FROM B
"
36261,73466,Merging 2 tables that contain duplicates,"select r.id, r.add, r.jid, r.sid, r.cocode, o.tid, o.date, o.cid
from (select r.*, row_number() over (partition by id order by jid desc) as seqnum
      from r
     ) r join
     o
     on r.id = o.pkey and seqnum = 1;
"
31236,44564,How to convert String date into another date format in SQL server?,"SET DATEFORMAT dmy;
GO
UPDATE #Test
   SET new_CHQ_DATE = CONVERT(VARCHAR(20), CHQ_DATE, 105)
WHERE
   ISDATE(CHQ_DATE) = 1;

--reset DATEFORMAT back to whatever it was
"
11258,63737,How to use Unique Composite Key,"ALTER TABLE Items ADD UNIQUE INDEX(ItemName, ItemSize);
"
30708,31491,In SQL how to compare date values?,"WHERE DATEDIFF(mydata,'2008-11-20') >=0;
"
36505,62079,declare varchar view issues,"CREATE FUNCTION dbo.fxSample(@PROJECTNUMBER VARCHAR(20))
RETURNS TABLE
AS
RETURN
(
    SELECT  SUM(PAFeeAmount) FeeAmount
    FROM    PA02101
    WHERE   PAPROJNUMBER = @PROJECTNUMBER
)

-- Then call like this, just as if it's a table/view just with a parameter
SELECT * FROM dbo.fxSample('hello')
"
24996,2946,Execute procedure in a trigger,"create or replace trigger trg
after insert on emp
for each row
begin
   myproc(:new.empno, :new.ename);
end;
"
38068,71946,Selecting joining records where all rows have a field equalling false,"SELECT * FROM Customers
WHERE ID Not In (SELECT CustomerID FROM Addresses WHERE Active = -1)
"
21600,6895,SELECT DISTINCT only first four numbers,"SELECT LEFT(code, 4) AS code, ticker FROM tbl ORDER BY code;
"
6105,40851,Using foreign key to bilateral action,"CREATE OR REPLACE TRIGGER trName 
AFTER DELETE ON TableB

BEGIN 
    <look if any values from ""TableA.id"" are not used anymore in ""TableB.file_id"">
    <if that is the case, do a DELETE on that ""TableA.id"" line>
END;
/
"
29823,23208,Associate users and roles added to ASPNET SQL Database tables with existing user information,"select *
  from Users as U inner join
    aspnet_Users as aU on aU.UserId = U.UserKey inner join
    aspnet_Membership as aM on aM.UserId = aU.UserId
  where U.UserId = @UserId
"
21451,19457,Oracle Forms 6i Comparing Fields,"Begin

  IF (LTRIM(RTRIM(:field1)) = LTRIM(RTRIM(:field2))) 
  OR (:field1 IS NULL AND :field2 IS NULL) THEN
   Show_Message('Fields Match');

  ELSE
   Show_Message('Fields DO NOT Match');

  END IF;

End;
"
27640,73439,SQL Statement - Based on Total Sum of a Column Type,"Select 
Model
,Quantity
,Price
,ScheduleB
,OrderID
From Table1
WHERE ScheduleB IN 
  (SELECT ScheduleB FROM Table1 GROUP BY ScheduleB HAVING SUM(Quantity * Price) > 2500)
"
26828,67557,SQL join column,"SELECT (cus_first_name || ' ' || cus_last_name) AS full_name
FROM customer
"
19102,9233,SQL Query to produce email list based on specific requirements,"SELECT 
     pf.Email
    ,pf.PostID
FROM 
     PostFollowers pf
INNER JOIN 
     PostComments pc ON 
     pf.PostID = pc.PostID
WHERE 
         pc.Notification_Sent = 0 
     AND pf.UserID != pc.UserID
"
9562,19710,Why is SQL Server misinterpreting this ISO 8601 format date?,"SET DATEFORMAT DMY

SELECT CAST('2013-01-05' AS DATETIME),   /*May*/
       CAST('2013-01-05' AS DATETIME2),  /*Jan*/
       CAST('20130105' AS DATETIME),     /*Jan*/
       CAST('20130105' AS DATETIME2)     /*Jan*/
"
20952,30212,How to prepared statements with Laravel,"DB::connection('database')->statement(""CREATE USER '{$mysqlDatabaseName}'@'%' IDENTIFIED BY '{$mysqlUserPassword}'"");
DB::connection('database')->statement(""CREATE DATABASE IF NOT EXISTS `{$mysqlDatabaseName}`"");
DB::connection('database')->statement(""GRANT ALL PRIVILEGES ON `{$mysqlDatabaseName}`.* TO '{$mysqlDatabaseName}'@'%'"");
"
1386,32058,BEGIN/END and CREATE Table in single .sql file,"BEGIN     
     EXECUTE IMMEDIATE 'DROP TABLE symbols'; 
EXCEPTION     
  WHEN OTHERS THEN         
   IF SQLCODE != -942 THEN     
 --here you have to write something for this exception
 -- if you don't have any activity to do then you can use NULL (atleast)
 -- you can't put this if statement body empty in oracle
 NULL;
END IF; 
END; 
/ 
"
12841,15994,How to create an Sqlite3 database - IOS,"sqlite3 mydata.db
"
30513,47954,Can I combine ten similar SQL queries to one?,"SELECT ji.issuestatus, cf.ID AS customfield_id, ROUND(SUM(cfv.NUMBERVALUE),0) AS mysum
FROM
    jissue ji CROSS JOIN customfield cf
    LEFT JOIN customfieldvalue cfv ON cfv.ISSUE=ji.ID AND cfv.customfield=cf.ID
WHERE
    ji.pkey LIKE '%PB-%'
    AND ji.issuestatus IN (10127,10128,10129,10130,10131)
    AND cf.ID IN IN (11381, 11382)
GROUP BY ji.issuestatus, cf.ID;
"
26525,4383,Microsoft SQL Server uses outdated values in stored procedures,"while @poid is not NULL
BEGIN

    Update Item set Sales = (Select Sales from V_ITEM_Hierarchy where POID=@poid) where ItemID=@poid

    set @poid = null

    Select @poid = i.ItemID
    from V_ITEM_Hierarchy t inner join Item i on (t.POID = i.POID)
    where ( abs(coalesce(t.Sales,0)-coalesce(i.Sales,0)) > 0.0001

END
"
34047,58308,Using cookie to execute SQL select,"var customerName = """";
var customerEmail = """";
if (Request.Cookies[""BookingReq""] != null) {
    var breq = db.Query(""SELECT * FROM BookingRequests WHERE BookingGUID = @0"", Request.Cookies[""BookingReq""].Value);
    //I don't know webmatrix so I don't know what happens to breq if that value doesn't exist - I'll assume it's null
    if (breq != null) {
        customerName = breq.CustomerName;
        customerEmail = breq.CustomerEmail;
    }
}
"
36203,4617,Return 0 for no rows returned using SUM and IIF in MS Access,"SELECT  SUM(IIF([SendDate]=#2/12/2013# AND MailerID = 1, IIF(TotalCount =  null, 0, TotalCount), 0)) AS MailCount  
FROM    MailReport 
"
20916,32810,sql server 2008 - get schema name of the stored procedure getting executed,"OBJECT_SCHEMA_NAME(@@PROCID)
"
14383,19322,Looping through stored procedure results to create string,"DECLARE @Str varchar(100) 
SELECT @Str = COALESCE(@Str + ', ', '') + CAST(iTypeID AS varchar(5)) 
FROM TableName

Select @Str
"
38981,49219,How can I flip rows from one table into columns of a second table?,"SELECT 'ALTER TABLE [Registrant] ADD [' + [ColumnName] + '] NVARCHAR(MAX);' 
FROM [FormField] f
        LEFT JOIN syscolumns c ON OBJECT_NAME(c.id) = 'Registrant' 
                              AND c.Name = f.[ColumnName]
WHERE c.id IS NULL
"
32706,38148,Case statement for a date field with Mysql db,"CASE WHEN po_amend_received_date IS NULL THEN 'Pending'  
else  po_amend_received_date 
end as `po_amend_received_date`
"
12600,50992,Group by using parts of the expression,"SELECT   SUBSTR(name, 1, INSTR(name, '.')), COUNT(*)
FROM     my_table
GROUP BY SUBSTR(name, 1, INSTR(name, '.'))
"
24551,35255,TNSNames.ora entries,"NAMES.DEFAULT_DOMAIN = world
"
39716,14944,Search With Only Given Keywords But Nothing More,"select p.*
from TableOfMaterialNeeds tomn join
     Products p
     on tomn.productid = p.productid join
     TableOfMaterials tom
      on tomn.materialid = tom.materialid
group by p.productid
having sum(find_in_set(tomn.material, @LISTOFMATERIALS) = 0) = 0;
"
13032,57081,Oracle SQL -- decode to multiple elements,"WHERE (table2.encoded_value = 1 AND table1.value_1 = 'a')
   OR (table2.encoded_value = 2 AND table1.value_1 = 'b')
   OR (table2.encoded_value = 3 AND table1.value_1 = 'c')
   OR (table2.encoded_value = 4 AND table1.value_1 in( 'd', 'e', 'f'))
"
39544,66296,SQL join in one row in a query,"SELECT a.username, GROUP_CONCAT(b.productname)
FROM commands a
INNER JOIN products b
ON a.id1 = b.id1
GROUP BY a.username
"
30341,26208,How to insert a record in a table so that the string field with id?,"INSERT INTO GLOBAL_CONTACTS (Name,Title,Sector)
SELECT e.Name,e.Title,s.SectorID
FROM ExcelTable e
INNER JOIN Sectors s
ON e.Sector = s.SectorName
"
11018,75101,creating columns based on column values,"SELECT
    monthly_course_capacities.month,
    max(case when course_capacities.course_kind ='math' then capacity end ) as math,
    max(case when course_capacities.course_kind ='english' then capacity end ) as english,
FROM course_capacities
INNER JOIN monthly_course_capacities ON course_capacities.id = monthly_course_capacities.course_capacity_id
GROUP BY monthly_course_capacities.month
"
30188,45013,Over partition by 2 columns SQL Server,"select *,
       (case when b like 'xf%' 
             then sum(c * e) over (partition by a, rnd )
        end) as sumProduct
into #testing3
from #testing2;
"
12945,67230,Two columns within an ISNULL function in MySql,"SELECT
    COALESCE(individual.Locale, company.Locale) AS Locale
FROM
    individual
INNER JOIN
    company ON company.CompanyId = individual.CompanyId
WHERE
    individual.IndividualId = 1
"
2873,50808,SQL table/column naming conventions,"LEFT JOIN Document d on dt.DocumentType=dt.TypeID --terrible naming convention.... 
"
16046,28422,mysql - add column with precalculated values using closest representation from other table,"SELECT value.*,mapping.* 
  FROM value
  JOIN mapping
  JOIN
     ( SELECT value.id
            , MIN(ABS((value.value1+value.value2)-mapping.value))min_abs 
         FROM value
         JOIN mapping
        GROUP 
           BY id
     ) x
    ON x.id = value.id
   AND x.min_abs = ABS((value.value1+value.value2)-mapping.value)
 ORDER
    BY id;
"
35868,27176,How do I order rows in a specific sequence using MySQL?,"select BookSize(page_count) as Size, count(*) as NmbrBoooks from books
where page_count is not null and page_count > 0 group by Size order by page_count;
"
2123,10496,PostgreSQL return select results AND add them to temporary table?,"with q as (
      <your query here>
     ),
     t as (
      insert into temptable(pk)
          select pk
          from q
     )
select *
from q;
"
33001,33130,How to perform the following join in mysql?,"SELECT  a.ID, a.first_name, a.sport,
        b.hobby
FROM    tableA a
        LEFT JOIN tableB b
            ON a.first_name = b.name
"
38298,61105,"What is the mysql command to ""go back one step""","[...]
mysql> describe my_table_one;
mysql> show tables; -- again
mysql> describe my_table_two;
mysql> show databases; -- again
mysql> use my_db_two;
mysql> ...
"
34419,45008,"sql-server, IF statement within SQL Query","SELECT 
COALESCE(salesHeader.[Ship-to Name], poHeader.[Ship-to Name]) AS DeliveryName
"
37585,10276,Populating a dataset from 2 tables (effective date logic) _simplified_,"SELECT A.THE_DATE, SUM(B.VALUE) AS VALUE_SUM
FROM A
    INNER JOIN B ON
        B.EFFECTIVE_DT_ST <= A.THE_DATE AND
        B.EFFECTIVE_DT_END >= A.THE_DATE

GROUP BY A.THE_DATE 
"
27231,68750,How can I merge all tables within a single sqlite3 database?,"INSERT INTO Dateset_all SELECT * FROM Dataset_123;
"
13705,51714,postgres function that should update date not executing,"-- Articles table
CREATE TRIGGER update_articles_modified_date_to_now BEFORE UPDATE
ON articles FOR EACH ROW EXECUTE PROCEDURE 
  update_modified_date_to_now();

-- Workshop table
CREATE TRIGGER update_workshop_modified_date_to_now BEFORE UPDATE
ON workshop FOR EACH ROW EXECUTE PROCEDURE 
  update_modified_date_to_now();
"
17386,55056,Computing division between the number of rows of two tables in sql server,"SELECT Round( (SELECT Count(*) FROM   a) 
            / (SELECT Count(*) FROM   b), 1) AS final 
"
30582,34029,How to gather data from more than two table and put the result in a new one,"CREATE TABLE Meter_specs
AS
SELECT 
  ar.created_date,
  m.meter_id,
  m.meter_name,
  p.para_name,
  p.para_id
FROM Parameter_value_archive ar
INNER JOIN meter_primary_master m ON ar.meter_id = m.meter_id
INNER JOIN parameter_master     p ON p.para_id = ar.para_id = p.para_id;
"
1981,59205,MySQL for replace with wildcard,"UPDATE table
SET Configuration = CONCAT(
      SUBSTR(Configuration, 1, LOCATE('<tag>', Configuration)+4),
      NEW_DATA,
      SUBSTR(Configuration, LOCATE('</tag>', Configuration)
    )
"
21986,41766,How to remove repetitive rows in MySQL when using JOIN,"SELECT DISTINCT candy.id, candy.name
FROM candy
RIGHT JOIN candytype
ON candy.user_id = 1
AND candytype.candy_id = candy.id;
"
11526,42747,How to find related rows in sql,"SELECT * FROM `post` WHERE `title` LIKE '%7-Zip%' OR '%Portable%' OR '%4.42%'
"
11161,11798,LINQ to SQL With the where with case statement,"var drs = from DataRow dr in Mytable.Rows
            where   
            (col_Con == 'G' ? col_Val : 30) <= (col_Con == 'L' ? 30 : col_Val)
            select dr;
"
36080,25440,Basic SQL Query without using subquery,"SELECT  T.EmployeeID,
        COUNT(*) AS MinDays
FROM    YourTable T
        INNER JOIN
        (   SELECT  DailyDate, MIN([Sales#]) AS MinSales
            FROM    YourTable
            GROUP BY DailyDate
        ) T2
            ON T2.DailyDate = T.DailyDate
            AND T2.[MinSales] = T.[Sales#]
GROUP BY T.EmployeeID;
"
3507,33905,How to count many-to-many relations in postgresql,"select ab1.a as a1, ab2.a as a2, count(*)
from a_b ab1 join
     a_b ab2
     on ab1.b = ab2.b and ab1.a <> ab2.a
     where ab1.a < ab2.a
group by ab1.a, ab2.a
"
19269,45574,Xml without encoding on Oracle 11g,"DECLARE
  doc           dbms_xmldom.domdocument;
  l_output_clob CLOB;
BEGIN

  l_output_clob := ' ';
  doc           := dbms_xmldom.newdomdocument;
  dbms_xmldom.setversion(doc, '1.0"" encoding=""ISO-8859-15');
  dbms_xmldom.writetoclob(doc, l_output_clob);
  dbms_output.put_line(l_output_clob);
END;
"
21191,42003,Compare uniqueidentifier in where clause,"WHERE coalesce(MainTable.RowVersion,'00000000-0000-0000-0000-000000000000') <> coalesce(CloneOfMainTable.RowVersion,'00000000-0000-0000-0000-000000000000')
"
25155,73806,selecting rows after the id given the order,"select t.*
from t
where quantity < (select t2.quantity from t t2 where t2.id = 1)
order by quantity desc;
"
24306,44941,How to select bi-directional mapped rows from a table in MySQL?,"SELECT DISTINCT t.item_code, t.item_name
FROM mytable t
INNER JOIN 
  (SELECT item_code, COUNT(DISTINCT item_name) num FROM mytable GROUP BY item_code) code
  ON (t.item_code = code.item_code)
INNER JOIN 
  (SELECT item_name, COUNT(DISTINCT item_code) num FROM mytable GROUP BY item_name) name
  ON (t.item_name = name.item_name)
WHERE code.num > 1 OR name.num > 1
"
37295,18642,Incorporating an incrementing value into this sql,"select id, perCent, 
       @curRank := if(parent = @prevParent, @curRank + 1, 1) AS rank,
       @prevParent := parent
from (
    select child.id, child.perCent, child.parent
    from likesd parent
    join likesd child
       on parent.id = child.parent
    where parent.type = 3
    order by parent.id, child.perCent desc) x
cross join (SELECT @curRank := 0, @prevParent := null) r
"
29300,71807,How to have a field in Postgresql depending on the previous rows found?,"select date,
       in_out,
       quantity,
       sum(quantity) over (order by date) as quantity
from  table_stock
order by date;
"
8188,75387,How to list unused items from database,"SELECT count(a.account_id), b.meal_id, b.meal_name
FROM mdw_meals_menu b 
LEFT JOIN mdw_customer_accounts a
       on b.meal_id=a.meal_id and
          a.start_date BETWEEN to_date('01-APR-2013','DD-MON-YYYY')
                           AND to_date('30-JUN-2013','DD-MON-YYYY')
GROUP BY b.meal_id, b.meal_name
ORDER BY count(a.account_id) desc, b.meal_id;
"
38452,9744,How to delete row if the previous have the same value in specific a column,"DELETE FROM Table t1 
WHERE EXISTS (SELECT 1 from Table t2 
              WHERE t1.Column2 = t2.Column2 
              AND t2.Id + 1 = t1.Id) 
"
38411,74980,Why am I getting duplicate records for this query? I am performing a Left Outer Join,"SELECT distinct  
    T0.CardCode
    ,T1.CardName
    ,T0.State

FROM CRD1 T0 LEFT OUTER JOIN OCRD T1 ON T0.CardCode=T1.CardCode
"
3018,35399,SQL Server Display details starting ID having maxcount and on," WITH countDefect as (
      SELECT DefectID, COUNT(defectID) cTotal
      FROM Products 
      GROUP BY DefectID
 ),
 rankDefect as ( 
     SELECT DefectID, row_number() over (order by cTotal DESC) as dRank
     FROM countDefect 
 )
 SELECT Product.*, R.dRank
 FROM Products P 
 INNER JOIN rankDefect  R
    ON P.DefectID = R.DefectID
 ORDER BY R.dRank
"
16917,6493,Conditional cumulative SUM in MySQL,"select idStudent,
       SUM( hourCourse * mark ) / SUM( hourCourse ) AS WeightedAvg
from
(
  SELECT t.*,
  case when @idStudent<>t.idStudent
    then @cumSum:=hourCourse
    else @cumSum:=@cumSum+hourCourse
  end as cumSum,
  @idStudent:=t.idStudent
  FROM `test` t,
  (select @idStudent:=0,@cumSum:=0) r
  order by idStudent, `key`
) t
where t.cumSum <= 30
group by idStudent;
"
5816,2915,SQL Two columns of guids no duplicates,"SELECT *
FROM (
        SELECT [Inspection Guid], 
               [SensorData Guid], 
               [DateTime],
               ROW_NUMBER() OVER (PARTITION BY [Inspection Guid] 
                                  ORDER BY [DateTime] DESC) rn
        FROM YourTable
      ) T
WHERE rn = 1
ORDER BY [DateTime] DESC
"
23139,37290,Insert row only if it doesn't exist already in MySQL,"You can add a primary key! It just has to be over two columns and not just one.
ALTER TABLE your_table
ADD PRIMARY KEY(idA, idB)
"
20547,56731,Generates all dates between two dates stored in a table,";WITH DateRange(DateData, EndDate, Opt) AS 
(
    SELECT StartDate, EndDate , Opt FROM #data
    UNION ALL
    SELECT DATEADD(d,1,DateData), EndDate, Opt
    FROM DateRange 
    WHERE DateData < EndDate
)
SELECT DateData, Opt
FROM DateRange
ORDER BY opt, DateData
OPTION (MAXRECURSION 0)
"
37001,70416,Making Excel report into SSRS with Pivot Tables,"=Join(LookupSet(Fields!grade.Value & Fields!od.Value & Fields!wall.Value & Fields!id.Value, Fields!grade.Value & Fields!od.Value & Fields!wall.Value & Fields!id.Value, RTrim(Fields!stock_number.Value), ""FOC""), "", "")
"
30496,70292,Retrieve nested parent child xml based on parent xml in sql xml,"select Firstname,
       Lastname,
       class as ""Details/class"",
       mark as ""Details/mark""
from Student
for xml path('Students'), type
"
376,68979,Select distinct rows whilst grouping by max value,"select  *
from    (
        select  row_number() over (partition by ID 
                                   order by EventTime desc) as rn
        ,       *
        from    YourTable
        ) as SubQueryAlias
where   rn = 1
"
8729,63051,SQL AND NOT and AND equivalents,"AND (wo.ci_cnc_date IS NULL OR p.prioid == '1 - Routine')    
"
19682,24409,Making an column auto increment through script,"`CREATE OR REPLACE TRIGGER table_a_BEFORE_INSERT_TRIGGER 
BEFORE INSERT ON table_a 
FOR EACH ROW
BEGIN
  SELECT increment_seq.NEXTVAL
  INTO   :new.id
  FROM   dual;
END;
/`
"
29480,253,Format a money field in SQL without converting to varchar?,"echo money_format('$%i', 3.4); // echos '$3.40'
//                       ^ here is your number, no formatting from the db!
"
24927,58868,AS NewCompoundField - Concatenating values which may be NULL,"SELECT      
        COALESCE([Site].Address1 + CHAR(13), '')  + 
        COALESCE([Site].Address2 + CHAR(13), '')  + 
        COALESCE([Site].Address3 + CHAR(13), '')  + 
        COALESCE([Site].Town + CHAR(13), '') + 
        [Site].eCounty AS SiteAddress
FROM [Site]
"
33076,74402,Using @@IDENTITY in SQL on a specific table,"IDENT_CURRENT( 'table_name' )
"
20359,3084,Is it possible to combine a pivot/transform query with another table (to add an additional column of data)?,"select a.*, b.extracolumn
from othertable b
join ( ... ) a
on a.ID = b.ID
"
25145,61453,Selecting two conditions simultaneously,"select Doctors.DocNumbers, Doctors.idNum
from Doctors
inner join Workdays as Workdays1 on Workdays1.DocNum = Doctors.DocNumbers and Workdays1.Workday = 1
inner join Workdays as Workdays3 on Workdays3.DocNum = Doctors.DocNumbers and Workdays3.Workday = 3;
"
12469,52971,"Complicated SQL Query, listing a tree in single query","SELECT
  LEVEL, BOMCODE, ITEMCODE, QTY
FROM
  BOMS
WHERE
  LEVEL <= 30
  START WITH BOMCODE      = 'XYZ'
  CONNECT BY PRIOR ITEMCODE = BOMCODE
ORDER BY
  LEVEL, BOMCODE, ITEMCODE, QTY
;
"
9545,19819,The most efficient way to store photo reference in a database,"id
order
user_id
desc
photo_url_800
photo_url_150
photo_url_45
date_uploaded
"
25432,7056,Mysql query select non-members,"SELECT c.id, 
  c.name 
FROM customers c
WHERE not exists (select customer_id
                  from modulemembers m
                  where c.id = m.customer_id)
order by c.name
"
3343,41584,Fix duplicate entries in mysql table,"UPDATE Coords SET propertyID = propertyID - 1 WHERE propertyID > 4271
"
17700,3583,REGEXP_REPLACE back-reference,"([0-9]+)
"
39402,55576,UNION of two queries using a subquery?,"with sub as
 (some giant sql join)
select max(id), somefield
  from sub
 group by somefield
union all
select min(id), someotherfield from sub group by someotherfield
"
26881,9583,TSQL: conditional group by query,"select * from yourtable t
where exists (
  select 1
  from yourtable c
  where c.room_id = t.room_id 
  group by c.room_id
  having min(case when status = 'vacant' then inspection_date end) <
         max(case when status = 'occupied' then inspection_date end)
  )
"
31574,31426,"count the instances of value in sub-query, update table","
SELECT id, mytype, COUNT(*) 
FROM table_name
GROUP BY id, mytype 
"
38016,41159,Wrong difference in minutes in Oracle (DATE2-DATE1)*24*60,"select inter,
       extract (day from inter) days,
       extract (hour from inter) hours,
       extract (minute from inter) minutes,
       extract (second from inter) seconds
from
(select 
  cast(date2 as timestamp) - cast(date1 as timestamp) inter
FROM
(
  SELECT
    TO_DATE('2014-06-06 10:30:00', 'YYYY-MM-DD HH24:MI:SS') DATE1,
    to_date('2014-06-06 11:25', 'YYYY-MM-DD HH24:MI') date2
  from dual
));
"
3217,58843,Tricky Recursive MySQL query,"with recursive tree (userid, siblingid) as
(
   select userid, 
          siblingid
   from users
   where userId = 1
   union all 
   select c.userid,
          c.siblingid
   from users c
     join tree p on p.userid c.siblingId
)
select *
from tree;
"
25619,25063,How to quote values for LuaSQL?,"require(""sqlite3"")

db = sqlite3.open_memory()

db:exec[[ CREATE TABLE tbl( first_name TEXT, last_name TEXT ); ]]

stmt = db:prepare[[ INSERT INTO tbl(first_name, last_name) VALUES(:first_name, :last_name) ]]

stmt:bind({first_name=""hawkeye"", last_name=""pierce""}):exec()
stmt:bind({first_name=""henry"", last_name=""blake""}):exec()

for r in db:rows(""SELECT * FROM tbl"") do
    print(r.first_name,r.last_name)
end
"
26614,33182,Refactoring the a subquery within a select statement to a join,"select data.WidgetName,
     case when link.id is not null then 1 else 0 end as selected
from Widget_data data
left outer join Widget_link link
    on data.ID = link.data_id and link.productId = 1
where data.expired=0 or link.id is not null
"
3225,4816,Multiple SQL SELECT,"SELECT *
FROM table1,
     table2
WHERE table1.date = 'somedate'
  AND table2.date = 'somedate'
"
38822,60485,Looking for T-SQL scripts to delete a SQL Job,"USE msdb;

GO

EXEC sp_delete_job
    @job_name = N'NightlyBackups' ;

GO
"
3266,64910,SQL: search for null date,"CREATE PROCEDURE dbo.SELECT_MEMBERS

    @ID int = NULL,
    @Name varchar(250)= NULL,
    @Deleted datetime =NULL

AS
BEGIN

 SET NOCOUNT ON;

    SELECT  ID, Name, Deleted 
    FROM dbo.Members 
    WHERE ID = ID
    AND ISNULL(@Name, '') = ISNULL(Name, '')
    AND ISNULL(@Deleted, '') = ISNULL(Deleted, '')


END
GO 
"
37479,65649,Optimizing WHERE clause SQL query,"SELECT 
      C.CourseID 
   FROM 
      Courses C
         LEFT JOIN Students S
            ON C.StudentId = S.StudentId
         LEFT JOIN Students S2
            OR C.StudentId2 = S2.StudentId
   WHERE
         S.StudentId IS NULL 
      OR S2.StudentID IS NULL
"
3882,70948,SQL: Key-Value: values in columns?,"select 
  key
, max( case value-name when 'color' then value else NULL end)      as color
, max( case value-name when 'heght' then value else NULL end)      as height
, max( case value-name when 'whatever' then value else NULL end)   as whatever
from 
  table
group by key
"
10230,65485,"sql query help, syntax help to select records not selected by inner select statement","select pid from table where pid not in (select top 10 pid from table1)
"
37932,8978,"SQL queries: expects more than one results, but only one returns","  SELECT g.genre_name, 
         count(distinct(d.director_id))
    FROM genre g, 
         director d, 
         movie m
   WHERE g.genre_id=m.genre_id 
         AND m.director_id=d.director_id
GROUP BY g.genre_name;   
"
28614,41211,SELECT on MIN column value and CHAR column really slow in MySQL,"alter table requests drop index load_count;
alter table requests drop index spider_index;

alter table requests add index spider_load_count(load_count, spider);
"
26133,25777,SQL - WHERE Condition on SUM(),"SELECT e.*, rt.review_id, (SUM(vt.percent) / COUNT(vt.percent)) AS rating 
FROM catalog_product_entity AS e 
INNER JOIN rating_option_vote AS vt ON e.review_id = vt.review_id 
GROUP BY vt.review_id
HAVING (SUM(vt.percent) / COUNT(vt.percent)) >= 0
ORDER BY (SUM(vt.percent) / COUNT(vt.percent)) ASC
"
30210,49520,F# Select from SQL Server table synonym,"open FSharp.Data

[<Literal>]
let connectionString = @""Data Source=MyServer\MyInstance;Initial Catalog=MyDatabase;Integrated Security=SSPI;""

[<Literal>]
let query = ""select Id, Name from MyTable"" 

type OptionQuery = SqlCommandProvider<query, connectionString>
let cmd = new OptionQuery()

cmd.AsyncExecute() 
|> Async.RunSynchronously
|> Seq.iter (fun row -> printfn ""Found row: %d %s"" row.Id row.Name)

System.Console.Write(""Done"")
System.Console.ReadKey()
"
2386,25229,Inserting a ref value into an object table,"INSERT INTO PROJECT_TABLE
(PROJECT_ID,
PROJECT_ASSIGNED_MEMBER,
PROJECT_TITLE)VALUES(
2,
(SELECT REF(M) FROM project_resources M WHERE M.member_id = 2),
'Bomb');
"
39790,19030,Postgresql Function Volatility Categories,"with q1 as (
    select isallowed(1) res
    ),
q2 as (
    delete from permisions
    where id = 1
    returning id
    )
select 
    id, res, isallowed(1)
from q1
cross join q2;

 id | res | isallowed 
----+-----+-----------
  1 | t   | f
(1 row) 
"
3974,50188,SAS SQL join criteria,"proc sql;
  select var1,var2,var3
  from mysource1;
quit;
"
22547,23751,Oracle Update Join based on a select,"UPDATE lib.client_address
SET allow_to_trade='N'
WHERE client IN
  (SELECT t.client
  FROM lib.trades t ,
    lib.client_address c
  WHERE t.client       = c.client
  AND c.allow_to_trade = 'Y'
  GROUP BY C.GCD_NUMBER,
    t.client,
    c.shortened_name,
    c.allow_to_trade
  HAVING MAX(trade_date) < '01-may-2012'
  );
"
23781,36435,How to do an OR query in Google App Engine,"from google.appengine.ext import ndb

class User(ndb.Model):
    email = db.StringProperty()


options = ndb.QueryOptions(keys_only=True)
condition_1 = ndb.Query(User, options=options).filter(User.email == ""mom@home.com"")
condition_1 = ndb.Query(User, options=options).filter(User.email == ""dad@home.com"")

key_list = list(set(list(condition_1) + list(condition_2)))

mom_and_dad = ndb.get_multi(key_list)
"
36719,46251,How To Rank In Oracle SQL Per Group For Whole Table?,"SELECT 
    D57.PERSON_REF, D57.START_DATE, D57.COMPDATE, 
    RANK() OVER (PARTITION BY PERSON_REF ORDER BY D57.COMPDATE asc) rnk 
FROM D57 
"
27562,39813,How to select rows only with Active status,"SqlStatementSmall = ""SELECT c.*""
            + "" FROM (SELECT b.*, rownum rn""
            + "" FROM (SELECT a.*""
            + "" FROM USERS a""
            + "" ORDER BY %s %s) b""
            + "" WHERE rownum <= ?) c""
            + "" WHERE rn > ? AND USERSTATUS = 'ACTIVE'"";
"
37312,5154,"how to row wise manipulate the data from a ""show databases"" query result set","-- (USE information_schema;)

for db in (select distinct table_schema from tables;)
do:    
    for table in (select table_name from tables where table_schema='$db';)
    do:
        select field,column,attribute from $table;
    done
done
"
35547,47951,"MySQL 5.0 reporting ""concat does not exist""","SELECT CONCAT ('a', 'b');
"
16142,29099,how to use select where in as all required inputs,"select id from tt
where id in (1,2,4,6)
and (select count(distinct id) from tt where id in (1,2,4,6)) = 4
"
8560,17606,How do I inspectdb 1 table from database which Contains 1000 tables,"from django.core.management.commands.inspectdb import Command
from django.conf import settings
from your_project_dir.settings import DATABASES  #  replace `your_project_dir`

settings.configure()
settings.DATABASES = DATABASES

Command().execute(table_name_filter=lambda table_name: table_name in ('table_what_you_need_1', 'table_what_you_need_2', ), database='default')
"
17636,35262,Group by is null or not?,"SELECT  COUNT(MY_TIMESTAMP) AS TOTAL_NOTNULL,
        COUNT(CASE WHEN MY_TIMESTAMP IS NULL THEN 1 END) TOTAL_NULL
FROM    MY_TABLE
"
1595,9128,Combining 2 sql queries into one,"SELECT *
FROM User u1 
INNER JOIN User u2 on u2.id_company = u1.id_company
INNER JOIN Ticket t on t.id_author = u2.id_user
WHERE u1.Name = @SessionUser
"
3093,57975,How do I compare tables of different sizes in sql?,"select * from B, A
where A.ID = B.MatchingField
AND (A.Measurement <> B.Measurement
OR A.String <> B.String)
"
15596,5671,IN and NOT IN clause do not apply,"SELECT p.id
FROM product p INNER JOIN
     tagging tg
     ON p.id = tg.mng_id
GROUP BY p.id
HAVING SUM(tg.tag_id = 34) > 0 AND
       SUM(tg.tag_id = 20) > 0 AND
       SUM(tg.tag_id = 42) = 0;
"
24805,54236,how to delete data from table that has date prior to 2006,"DELETE FROM TABLE_A
 WHERE last_update_date < TO_DATE('01/01/2006', 'MM/DD/YYYY')
"
24947,59040,How to Hide/Show of UI component in oracle adf,"visible=""#{binding.filedName.inputValue != null}""
"
21456,9574,SQL - Combining multiple like queries,"SELECT * 
FROM phonenumbers 
WHERE number SIMILAR TO '555123%|555321%|555987%'
"
28999,392,Building a queue in CouchDB,"function(doc) {
  if(doc.visible)
    emit(doc.created_at, doc)
}
"
16473,31295,SQL clause: newbie question,"select * from tbl where culture = 'es'
UNION
select * from tbl where culture = 'eu'
"
8561,15580,MySQL: refer to SELECT subquery alias in WHERE,"SELECT
    @sx:=SUM(x) AS test,
    (SELECT @sy:=SUM(y) FROM other_table) AS sub_test,
    (@sx + @sy) AS total_sum
FROM my_database
HAVING
    -- SUM(x) <> 0 AND (SELECT SUM(y) FROM other_table) <> 0
    test <> 0 AND sub_test <> 0
"
21194,23933,Removing spaces in concatenated string column in a view,"SELECT ACTNUMBR_1, ACTNUMBR_2, ACTNUMBR_3, 
    REPLACE(ACTNUMBR_1 + '-' + ACTNUMBR_2, ' ', '') AS Match_Account, 
    REPLACE(ACTNUMBR_1 + '-' + ACTNUMBR_2 + '-' + ACTNUMBR_3, ' ', '') AS Full_Account
"
20321,17613,selecting top record in ORACLE join statement between subqueries,"select  m.object, m.operation, m.time, 
  max(p.object) keep (dense_rank first order by p.time) cause,
  max(p.time) keep (dense_rank first order by p.time) cause_time
from a m
join a p on (p.time > m.time)
where m.operation = 'Move'
and p.operation = 'Pickup'
group by m.object, m.operation, m.time;
"
16911,28200,"PostgreSQL: Merge two tables with same column names, add counters","=> create table t1 (name text,cnt int);
=> create table t2 (name text,cnt int);
=> insert into t1 values  ('name1',1), ('name2',2), ('name3',3), ('name4',4);
=> insert into t2 values  ('name3',3), ('name4',4), ('name5',5), ('name6',6);
=> select name,sum(cnt) from ( select * from t1 union all select * from t2 ) X group by name order by 1;

 name  | sum 
-------+-----
 name1 |   1
 name2 |   2
 name3 |   6
 name4 |   8
 name5 |   5
 name6 |   6
(6 rows)
"
13173,662,How to cross join using 3 tables?,"SELECT c.Nama AS Customer, b.No AS No_Barang, d.Qty
FROM customer c
JOIN barang b
LEFT JOIN det_barang d ON c.No = d.No_Cust AND b.No = d.No_Barang
ORDER BY c.No, b.No
"
36087,70205,Oracle: Disable a constraint inside a trigger,"declare
 pragma AUTONOMOUS_TRANSACTION;
begin
 execute immediate 'alter table SESSION_LOGGING ......';
"
5364,37744,MySQL LIKE x || y || z || etc. stops working after first ||,"SELECT username, email FROM users WHERE (username LIKE '%bla%' or username like '%bla2%' or username like '%bla3%') AND last_visit > '2013-05-15 00:00:00'"";
"
12956,15813,SQL to Entities syntax for INNER JOIN and DISTINCT,"var query = (from dr in db.DowntimeReasons
            join e in db.Equipments on dr.Equipment equals e.Equipment
            where e.Emergency
            select e.Equipment).Distinct().ToList();
"
24541,45657,How to select all tags for a post with a given tag in MySQL?," SELECT posts.id, GROUP_CONCAT(post_tags.tag) AS additional_tags
   FROM posts LEFT OUTER JOIN post_tags ON posts.id = post_tags.post_id
   WHERE posts.id IN (SELECT post_id FROM post_tags WHERE tag = :search_tag)
   AND post_tags.tag <> :search_tag
   GROUP BY posts.id
"
24894,22475,SQL - select rows not similar to above in the same column in one table,"select p.*
from (select p.*,
             (@rn := if(@c = club, @rn + 1,
                        if(@c := club, 1, 1)
                       )
             ) as rn
      from players p cross join
           (select @c := '', @rn := 0) params
      order by club
     ) p
order by rn, club;
"
31343,11377,How do I perform math in SQL query on certain conditions?,"case when price.tprprice is not null AND price.tprenddate > @StartDate
     then (price.baseprice - price.tprprice) * itemmovement.qtysold 
else (price.baseprice - itemmovement.price) * itemmovement.qtysold 
end as markdown
"
15804,16633,SELECT from single table one user per company,"SELECT user_display_name, user_name, user_password, user_email
FROM core_user
GROUP BY user_display_name
"
29265,65108,SQL: Returning unassigned rows,"select * 
from prospects p
where not exists (select null from 
                  assignments a
                  where a.prospectid = p.id)
"
19930,70201,How to sort by 2 columns when joining 2 tables?,"  SELECT id_image, occurences
  FROM (
      SELECT id_image, COUNT(id) AS occurences, 2 AS priority 
      FROM images_bookmarks
      GROUP BY id_image
    UNION
      SELECT id_image, COUNT(id) AS occurences, 1 AS priority
      FROM images_likes il 
      GROUP BY id_image
  ) AS favorites
  ORDER BY occurences DESC, priority DESC
"
34454,21989,SQL query select max min value from resultset query,"SELECT ID, AmountInCurrency, ExtractionDate,
       min(ExtractionDate) over () as MinExtractionDate,
       max(ExtractionDate) over () as MaxExtractionDate
FROM Table;
"
33766,1240,SQL select current transaction and reference most recent transaction,"SELECT Item,
       Location,
       Department,
       MonthEnd,
       Price,
       COALESCE(LAG (MonthEnd, 1) OVER (ORDER BY MonthEnd),  MonthEnd) PrevMonthEnd,
       COALESCE(LAG (Price, 1)    OVER (ORDER BY MonthEnd),  price)    PrevPrice ,
       (price - coalesce(LAG (Price, 1) OVER (ORDER BY MonthEnd), price)) PriceDelta
FROM   items
ORDER BY monthend desc
"
6568,52123,How do you put literals into the result a sql result set based on which table was joined to create the row?,"CASE IF S1.ID IS NULL THEN 'SUBTYPE_1' ELSE 'SUBTYPE_2' END AS DISCRIMINATOR,
"
15634,70412,join a column that contains the previous max,"DECLARE @T TABLE (Code VARCHAR(5))
INSERT @T VALUES ('EM010'), ('EM100'), ('EM101'), ('EM105'), ('EM106')

SELECT  T1.Code,
        (   SELECT  MAX(Code)
            FROM    @T t2
            WHERE   t1.Code > t2.Code
        ) AS Code2
FROM    @T t1
"
4392,13828,Can I use DBD::mysql quote() function without a database connection?,"sub quote(){
    my ($s) = @_;
    $s =~ s/\\\\/\\/g;
    $s =~ s/\'/\\'/g;
    $s =~ s/\""/\\""/g;
    $s =~ s/\x08/\\b/g;
    $s =~ s/\n/\\n/g;
    $s =~ s/\r/\\r/g;
    $s =~ s/\t/\\t/g;
    $s =~ s/\x1A/\\Z/g;
    return $s;
}
"
9336,29988,sql query to add days to specific column date,"UPDATE <table> 
SET expiry_date = DATE_ADD(expiry_date , INTERVAL 7 DAY) 
WHERE DATE(expiry_date) >= DATE(NOW());
"
35083,18251,SQL Query to compare two most recently modified row of the same table,"select id, max(case when seqnum = 1 then value end) as value
from (select t.*, row_number() over (partition by id order by modifieddate desc) as seqnum
      from table t
     ) t
group by id
having max(case when seqnum = 1 then value end) <> max(case when seqnum = 2 then value end);
"
2135,19488,I need to set as foreign key which refers to one of the composite primary key in other table,"alter table store add constraint FK_store_merchant foreign key (mId, addId) references merchant (mId,addId)
alter table merchant add constraint FK_merchant_address foreign key (addId) references address (addId)
"
23629,19454,How to find the similar column names from a database table?,"SHOW COLUMNS FROM tbl_name FROM db_name
LIKE '1%'
"
5864,22928,Add missing month into query result,"select count(1) as count, months.month, year(published_at) as year
from months left join articles on months.month = month(published_at)
where published_at >= (now() - interval 1 year) and published_at <= now()
group by month(published_at)
order by year asc, month asc
"
7726,33961,converting to datetime time and extracting month name,";with t(example) as 
(
    select '201512'
)
select
    cast(example + '01' as date) as [DATE],
    datename(month, cast(example + '01' as date)) as [MONTH]
from t


DATE        MONTH
2015-12-01  December
"
14210,32670,How to perform a join in SQL Server without using tables,"DECLARE @a TABLE (str varchar(100))
INSERT INTO @a
VALUES
('a'),
('b')...

DECLARE @b table (str varchar(100))
INSERT INTO @b
VALUES
...

(SELECT str FROM @a
EXCEPT 
SELECT str FROM @b)
UNION
(SELECT str FROM @b
EXCEPT
SELECT str FROM @a)
"
13401,54562,Sqlite Android Quick Question,"SELECT * FROM table WHERE downloaded=0 ORDER BY RANDOM() LIMIT 1;
"
22178,38408,Easy way to find out how many rows in total are stored within SQL Server Database?,"SELECT SUM(row_count)
    FROM sys.dm_db_partition_stats
    WHERE index_id IN (0,1)
    AND OBJECTPROPERTY([object_id], 'IsMsShipped') = 0;
"
28619,37534,Need help to finding pattern,"select substring(col,
                 patindex('%[a-z][a-z][a-z][a-z][0-9][0-9][0-9][0-9][0-9][0-9]%', col),
                 10)
"
22288,26999,Using a Case statement to conditionally modify the number of joins,"declare @Query varchar(max)

set @Query = ' SELECT A         
         FROM myTable
           '

 if (UserGroup <> 'Initial')  
   Begin
     set @Query = @Query +'INNER JOIN Table1 ON MyTable.A = Table1.A'
   End

exec(@Query)
"
34191,3095,check two constrains in subquery,"select * 
from FirstTable
inner join SecondTable
on SecondTable.District = FirstTable.District And
(SecondTable.Age - FirstTable.Age) between -1 and 1
where FirstTable.Name = 'AAA';
"
35371,55707,SQL Select date from second table if id matches,"select s.Security_id, nvl(c.odate, s.Maturity_date) as Maturity_date
from Security s
left join
Callput c
on
s.Security_id = c.Security_id
"
16914,13617,SQL How to Update only first Row,"UPDATE Table SET Checked='Y' 
WHERE ID =(SELECT ID FROM Table WHERE Checked='N' ORDER BY ID LIMIT 1) 
"
7799,38837,Return rows in random order,"SELECT * FROM table
ORDER BY NEWID()
"
33252,20182,Hibernate query multiple times or fetch relevant rows by one query and process them in java,"List<?> listForParameters  = //initialize the list
Session session = //obtain the session 
Criteria crit = session.createCriteria(YourEntityClass.class);
crit.add(Restrictions.in(""ParameterName"", listForParameters  ));
List<?> list = crit.list();
"
27414,9628,How to insert umlaut with correct hex value in Oralce using sqlplus,"SQL> create table foo (
  2    col1 varchar2(1 char)
  3  );

Table created.

SQL> insert into foo values( unistr('\00fc') );

1 row created.

SQL> ed
Wrote file afiedt.buf

  1  select dump(col1, 1016)
  2*   from foo
SQL> /

DUMP(COL1,1016)
-------------------------------------------------------------

Typ=1 Len=2 CharacterSet=AL32UTF8: c3,bc
"
9097,21059,"Convert SQL to Linq - Where, in, Groupby and Having count","<Table>.GroupBy(x => x.np)
       .Where(x => x.Count() > 1)
       .SelectMany(x => x)
"
38359,51929,SSRS: Chart x-axis should show until yesterday date,"where dateadd(day, -1, IntervalDate) >= getdate()-60
"
22046,16405,how to pick string basing on ID wise,"   declare @t table (ID int,value varchar(40))
   insert into @t (ID,value)values (1,'Chemicals(Sulphur4123)'),(2,'Chemicals(Sulphur4123)/RAW')

   select  SUBSTRING(value,
   CHARINDEX('(',value) + 1, 
   CHARINDEX(')',value) - CHARINDEX('(',value) - 1)+
   +reverse(SUBSTRING(reverse(value),1,CHARINDEX('/',reverse(value))))
   AS RESULT from @t
"
29194,22844,Select rows from a table where a timestamp has not been made since the past 60 days,"select a.usernumber
from [user] a 
    left join [transaction] b on a.id = b.user_id 
where a.usernumber is not null
group by a.usernumber
having max(b.timestamp) <= (SELECT getdate()-60)
"
11103,15450,query to get child categories AND know if child categories have child categories of their own,"select  *
,       case 
        when exists (select * from cat c2 where c2.parent_id = c1.cat_id) then 0
        else 1
        end as HasSubcategories
from    cat c1
"
23425,8279,Partitioning function for continuous sequences,"with Lagged as (
  select
    pk,
    case when lag(""to"",1) over (order by pk) is distinct from ""from"" then 1 else 0 end as starts,
    entity_key
  from history
), LaggedGroups as (
  select
    pk,
    sum(starts) over (order by pk) as groups,
    entity_key
  from Lagged
)
  select
    pk,
    row_number() over (
      partition by groups
      order by pk
    ) as ""row_number"",
    entity_key
from LaggedGroups
"
3815,6446,Count Columns Where Date +7 days,"SELECT id,
    (CASE WHEN thisdate BETWEEN getdate() AND DATEADD(day, 7, getdate()) THEN 1 ELSE 0 END +
    CASE WHEN thatdate BETWEEN getdate() AND DATEADD(day, 7, getdate()) THEN 1 ELSE 0 END +
    CASE WHEN otherdate BETWEEN getdate() AND DATEADD(day, 7, getdate()) THEN 1 ELSE 0 END) AS count
FROM <YOUR_TABLE>
"
29807,28265,Problem creating foreign keys in mySql,"alter table users engine=InnoDB;
"
20400,328,Insert same data multiple times,"insert into table(id, name, descr) 
    select i.id, 'asdf', 'this is not a word'
    from (select 4 as id from dual union all
          select 6 from dual union all
          select 7 from dual union all
          select 9 from dual
         ) i;
"
13156,39385,sql how to show row with same column value only once,"SELECT t1.*
FROM table_name t1
WHERE NOT EXISTS (select 1 from tablename t2
                  where t2.project = t1.project
                    and t2.report_date < t1.report_date
                    and t2.percentage_complete = 100)
"
20366,66834,SQL query based on today's date,"SELECT a.name, COUNT(*) AS num 
FROM table2 b 
INNER JOIN table1 a 
ON b.status_id=a.id 
GROUP BY status_id
having b.date  = 1341241153
"
28762,39958,How to get a value in a row when searching in a Database in delphi?,"var Query : TQuery;
    PIN   : string;

begin
  Query.Sql.Text := 'SELECT pin FROM table WHERE id = value'
  Query.Open;
  PIN :+ Query.FieldByName('pin').AsString;
  Query.Close
end;
"
8414,1167,Join tables with distinct highest ranked row,"SELECT
    M.memberID,
    M.memberName,
    G.groupName,
    MG.memberRank
FROM
    Member M
LEFT OUTER JOIN MemberGroup MG ON MG.memberID = M.memberID
LEFT OUTER JOIN MemberGroup MG2 ON
        MG2.memberID = M.memberID AND
        MG2.memberRank > MG.memberRank
INNER JOIN [Group] G ON G.groupid = MG.groupid
WHERE
    MG2.memberid IS NULL
"
35394,73588,SQL MAX( ) function,"SELECT top 1 *
FROM MATCHES
WHERE GOALS_FOR > 2
ORDER BY DATE Desc
"
1846,34061,SQL code to open a stored procedure and read it in SQL Server,"SELECT definition
    FROM sys.sql_modules 
    WHERE object_id = OBJECT_ID('YourSchemaName.YourProcedureName')
"
22648,11578,Recommended SQL database design for tags or tagging,"Table: Item
Columns: ItemID, Title, Content

Table: Tag
Columns: TagID, Title

Table: ItemTag
Columns: ItemID, TagID
"
7924,71735,SQL Help : Update a field,"update [course 1]
inner join [course]
on course.name = [course 1].name
set [course 1].ID = [course].ID;
"
4230,66466,Partition Hive based on the first chars of a field,"CREATE TABLE base2(id int, name String)
PARTITIONED BY (state string);

INSERT OVERWRITE TABLE base2 PARTITION (state)
SELECT id, name, substring(state,0,1)
"
23353,47644,Concatenating multiple results of a query in one row in Oracle,"select c.firstname, c.lastname,
       list_agg(p.product||'-'||p.desc, ' , ') within group (order by p.id) as product_and_desc
from customer c join
     product p
     on c.id = p.customer_id
group by c.firstname, c.lastname;
"
32973,68610,Webmatrix - Order by entry in separate table,"var images = db.query(@""SELECT t1.* FROM Images t1 LEFT JOIN Property t2 ON
    t1.ImageID = t2.Primary_Image WHERE t1.PropertyID = @0 ORDER BY
    t2.Primary_Image DESC"", PropertyID);
"
39665,43504,Show datas from tables that can have a same data in a column in the same table,"SELECT w.url, w.title, a.title, a.authors, 
  d.content, d.title
FROM tb_doc d
INNER JOIN tb_wrapper w  ON d.title = w.title
INNER JOIN
(
   SELECT title, GROUP_CONCAT(author SEPARATOR ', ') AS authors
   FROM  tb_author
   GROUP BY title
 ) a ON w.title = a.title
"
36536,31810,"Fetch Id's that are related to a specific set of items, but not others","SELECT service_id
FROM t1
GROUP BY 1
HAVING
   SUM(CASE WHEN Product IN ('Traffic', 'Weather', 'Travel') THEN 1 ELSE -1 END = 3
"
1626,23503,T-SQL Query against previous queries results,"SELECT DISTINCT c1.*
FROM @CUST c1
WHERE c1.ENTRYDATE BETWEEN '2012-08-01' AND '2012-08-30'
AND NOT EXISTS (SELECT 1 
    FROM @CUST c2 
    WHERE c2.ENTRYDATE < '2012-08-01'
    AND LTRIM(RTRIM(c1.Firstname + c1.Lastname + c1.Company)) = LTRIM(RTRIM(c2.Firstname + c2.Lastname + c2.Company))
)
"
34360,14674,SQL: how do you look for missing ids?,"SELECT t1.id FROM your_list t1
LEFT JOIN your_table t2
  ON t1.id = t2.id
WHERE t2.id IS NULL
"
21693,16320,calculate elapsed time in oracle between entries from one particular condition to whatever condition is next,"SELECT to_char((EVENT_DURATION) + trunc(sysdate), 'HH24:MI:SS') 
FROM (SELECT (DATE_DT - LEAD(DATE_DT) OVER (ORDER BY DATE_DT DESC)) AS EVENT_DURATION
      FROM TEST_CHRIS
     ) tc
WHERE ASSET_ID = 4380 AND EVENTTYPE = 1 AND
      trunc(DATE_DT) = trunc(SYSDATE);
"
27464,31294,Microsoft SQL Server : max records in a column,"SELECT table.*
FROM dbo.X table
WHERE row_numbers IN (SELECT MAX(row_numbers) FROM dbo.X)
"
3431,75017,How to convert XY coordinates to GPS in Oracle Spatial?,"select 
sdo_lrs.locate_pt(sdo_lrs.convert_to_lrs_geom(sdo_cs.transform(shape,8307)),0.02).sdo_ordinates  
from 
TEST_SCHEMA.TEST_TABLE
where 
route='ABC'
and
segmentnum='101.1'
"
18229,7050,SQL - 2 equal queries differently written are not working the same,"select c.Name as 'Country', s.Name as 'State', city.Name as 'City' 
from 
    CountryRegion as city inner join 
    CountryRegion as s on s.Id = city.CountryRegionParentId inner join
    CountryRegion as c on c.Id = s.CountryRegionParentId
where  city.Id=11
"
14212,59342,SQL WHERE insert,"SELECT Recording_artist.artist_name,Musical_genre.musical_genre,
    COUNT(Musical_genre.musical_genre) AS Songs
FROM Recording_artist
    FULL OUTER JOIN Album
        ON Recording_artist.recording_artist_id = Album.recording_artist_id
    RIGHT OUTER JOIN Song
        ON Album.album_id = Song.album_id
    INNER JOIN Musical_genre
        ON Album.musical_genre_id = Musical_genre.musical_genre_id
WHERE Musical_genre.musical_genre = 'Rock'
GROUP BY Recording_artist.artist_name,Musical_genre.musical_genre;
"
17722,29120,Reduce the number of characters in an SQL function in Oracle database,"select c,s,f as f,d as d, v as v from (mysql)
UNION ALL
select c,s,f+(select max(d)-min(d) from mysql)+t.r as f,d+(select max(d)-min(d) from mysql)+t.r as d,0 as v 
from (mysql)
CROSS JOIN 
(
SELECT Rownum r
FROM  dual
CONNECT BY Rownum <= 15
) t
"
11801,1963,Multiple split and assign order_id,"SELECT ""ID"", token, row_number() over (partition by ""ID"")
FROM (
    SELECT ""ID"", s.token
    FROM   
        Table1 t, 
        unnest(string_to_array(translate(t.address, '.,:;-', '     '), ' ')) 
            s(token)
    WHERE token <> ''
    ) sub
"
20204,38318,Roll up sparse table in vertica,"    select session_token, max(col1), max(col2),.., max(colN) 
      from user_session
  group by session_token
"
5170,290,cake php how do a good query,"$this->PbFeedback->find('all', array(
    'contain' => array (
        'Usuario',
        'UltimoMensaje ',
        'eon_feedback' => array (
            'fields' => array ('created','msg','tipo'),
            'conditions' => array ('eon_feedback.status =' => '0')
        )
    ),
    'limit' => 30
);
"
3764,32754,In SQL can you GRANT privileges to MULTIPLE accounts with a single command?,"REVOKE
    priv_type [(column_list)]
      [, priv_type [(column_list)]] ...
    ON [object_type] priv_level
    FROM user [, user] ...

REVOKE ALL PRIVILEGES, GRANT OPTION
    FROM user [, user] ...
"
20588,23057,Select Query to generate and exclude some results by joining two tables,"SELECT home, configName, data, active
FROM config

UNION

SELECT ce.home, c.configName, c.data, c.active
FROM config_exceptions ce
INNER JOIN config c ON c.configName = ce.configName
WHERE ce.data <> c.data
AND c.home = 0
"
29210,6388,Checking Duplicates before inserting into SQL database,"ALTER TABLE clients ADD UNIQUE KEY (clientname);
"
10499,52879,How to remove not null constraint in sql server using query," ALTER TABLE YourTable ALTER COLUMN YourColumn columnType NULL
"
8816,41725,mysql- Averaging values every n row with same id,"select computer, max(time), avg(cpu)
from
(
  select 
    @row_number := case when @computer = computer then @row_number + 1 else 0 end as row_number,
    @computer := computer as computer,
    time, 
    cpu
  from mytable
  cross join (select @row_number := -1, @computer := '') as t
  order by computer, time
) as t
group by computer, row_number div 3
order by computer, row_number div 3;
"
19935,16286,SQL Query for Where IN condition,"SELECT
    * 
FROM 
    user_post
WHERE 
    user_id IN ((SELECT 
                    follow_id 
                FROM 
                    follow 
                WHERE 
                    follow_id=20), 10, 15);
"
38496,41882,Compare two columns from different tables,"SELECT ID, IP_Address, UserName, Comments FROM TABLEA
FULL JOIN TABLEB
ON TABLEA.Comments LIKE '%' + TABLEB.Keywords + '%'
WHERE TABLEA.Comments IS NOT NULL AND TABLEB.Keywords IS NOT NULL
"
32811,13208,Why is this MySQL UPDATE taking forever?,"create index id_idx on A(id);
create index id_idx on B(id);
"
25527,68467,Min Value Oracle with results of subqueries,"AND ELIGTY_MO_YYYYMM BETWEEN '201407' AND
LEAST('201412, (SELECT MAX(whatever) FROM table))
"
8607,19430,Best way to filter queries by parameter?,"(@clientID is null or a.clientID = @clientId) and ...
"
35383,54226,How to select next record value in sql result,"select t.*,
       if(u_id = @u_id, timediff(`timestamp`, @timestamp), NULL) as diff,
       @timestamp := `timestamp`, @u_id := u_id
from table t cross join
     (select @timestamp := 0, @u_id := 0) var
order by u_id, timestamp;
"
897,16475,Do parameterized statements actually change that data that is stored in the database to prevent SQL Injection?,"INSERT INTO @tableName(@fieldName) VALUES (@dataValue)
"
1832,60668,How use JpaRepository Query for select sorted records starting from :start and number of :count,"public interface ItTougaoRepository extends JpaRepository<ItTougao, Long>, PagingAndSortingRepository<ItTougao, Long>{
    public Page<ItTougao> findByAcceptedFalseOrderByCreateDateDesc(Pageable pageable);
    public Page<ItTougao> findByAcceptedTrue(Pageable pageable);
    public Page<ItTougao> findByAcceptedTrueOrderByAcceptDateDesc(Pageable pageable);
}
"
12089,62116,How can I get the last inserted primary key?,"insert into T
output inserted.pk
values ('new item');
"
37826,20283,Select all rows where two columns contain a combination of values,"SELECT * FROM T WHERE (A,B) IN (('1', '1'),('2', '2'));
"
11939,36506,Writing SQL statement to select from multiple rows,"SELECT COUNT(*) as reciprocal_values_no
FROM table_name tbl1
WHERE 
  username = @username
  AND friend_username = @friendusername
  AND status = 0
  AND EXISTS (
    SELECT 1 FROM table_name tbl2 WHERE tbl1.username = tbl2.friend_username AND tbl1.friend_username = tbl2.username )
"
30876,12445,"Need to select most recent record, group by customer and item code","   select
    * -- or whatever columns you actually want
    from
    RDR1
    inner join
    (SELECT itemCode, MAX(docDate) AS docDate
    FROM RDR1 
    WHERE customerCode= 'TEST001' 
    GROUP BY ItemCode) MD
    on MD.docDate = RDR1.docDate
and md.ItemCode = RDR1.ItemCode
"
36732,29829,How might I retrieve unique records from this table?,"select distinct c.* from CardInfo c, CardItems ci
where c.cr_no = ci.cr_no and ci.wc_id = 'test'
"
27836,4335,"Comparing 2 Columns until the 1st "".""","SELECT N.NodeID, N.Caption, N.SysName, N.DNS, N.IP_Address, N.Device_Type
 from Nodes N
 where left(n.sysname, charindex('.', n.sysname + '.') - 1 )
    <> left(n.dns, charindex('.', n.dns + '.') - 1)
 order by N.IP_Address, N.Caption
"
342,17932,Multiplying column by weight in another table requiring a second select and summing in SQL,"select sum(t1.value * t2.weight) 
from t1
join t2 on t1.vid = t2.vid
"
977,46121,SQL data constraints doubts,"CREATE TABLE `test1` (
`id` int(11) unsigned NOT NULL AUTO_INCREMENT,
`nullable` int(11) DEFAULT NULL,
 PRIMARY KEY (`id`),
 UNIQUE KEY `nullable` (`nullable`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

 INTO `test1` (`id`, `nullable`)
 VALUES
  (1, NULL),
(2, NULL),
(3, NULL);
"
24780,28893,How do I query for something that starts with certain characters?,"WHERE SRV_NAME LIKE 'AA%'
"
12521,60433,Sql Getting Top 2 results in each classification,";WITH CTE AS(
  SELECT Name,
         Classification,
         Hits,
         Row_Number() OVER(Partition by name ORDER BY Hits DESC) AS RowNum
  FROM Table4
  )

SELECT Name,
       Classification,
       Hits
FROM CTE
WHERE RowNum <= 2
ORDER BY Name, Hits
"
19576,13490,Selecting Repeat Dates In SQL Query,"select program_name, provider_name, patient_name, service_date
from tablename
group by program_name, provider_name, patient_name, service_date
having count(*) > 1
"
11598,41058,Staff Wages in SQL,"select staffNo,
(Select avg(staffsalary) from staff) as avgSalary,
(select staffSalary from staff where staffNo = S.StaffNo) as Salary,
(Select staffSalary - (select avg(staffSalary) from staff) from staff where staffNo = S.staffNo ) as salDiff
from staff S
where staffSalary > (Select avg(staffSalary) from staff)
"
23496,71775,How to filter a measure based on another measure,"WITH 
  MEMBER [Measures].[CntUsersActive5DaysOrMore] AS 
    Sum
    (
      [UserId].[UserId] //<<< or [UserId].[UserId].[UserId]
     ,IIF
      (
        [Measures].[ACTIVE DAYS] > 5
       ,1
       ,0
      )
    ) 
SELECT 
  [Measures].[CntUsersActive5DaysOrMore] ON 0
FROM [YourCube];
"
8737,36150,Need help in developing DB logic,"""customer [cid] has name [firstname] [lastname]
    AND customer [cid] has a phone number [phonenumber] of type [type] ...""
""customer [cid] can use credit card #[card_no]""
""seat [seatid] is at row [row] and column [column]""
""seat [seatid] is booked""
""seat [seatid] is temporarily committed to an unfinished booking""
...
"
10071,63494,SQL database Structure,"id  |  word  |  parent_id
---------------------------
1   | abc    |  NULL
2   | def    |  1
"
3973,54379,Is it possible to use a database sequence for a non-PK field in a Grails app?,"static mapping = {
    intField1 generator:'sequence', params:[sequence:'sequence_name']
    intField2 generator:'sequence', params:[table: 'hi_value', column: 'next_value', max_lo: 100]
} 
"
21157,72684,Sorting in Query for MySQL database using hibernate,"tasks = (List<Task>)session.createQuery(""from Task as t where t.user.username = :name 
order by t.project.key ASC, t.deliverable.key ASC, t.activity.key ASC"")
.setString(""name"", username).list();
"
18693,27122,Select field of record contains max of another field,"select distinct on (name) p.surname 
from person p
order by name, age desc
"
20088,75001,How to make child as parent in xml tree,"SET OutputRoot.XMLNSC.root.row[rowCnt].product_Info = THE (SELECT ITEM THE(SELECT C.*:Codes.*:Code AS TyrePatternCd FROM T.*:Classification[] AS C 
                    WHERE C.(XMLNSC.Attribute)Type = 'BRAND')
                FROM itemMaster.*:ItemMasterHeader[] AS T );
"
34141,8208,Building a complex MySQL query,"select events.id, group_concat(dates.date) 
from events 
inner join dates on events.id=dates.event_id
where yourcondition
group by events.id
"
2127,22682,copy tables with data to another database in SQL Server 2008,"USE TheOtherDB;

SELECT *
INTO NewTable
FROM TheFirstDB.Schemaname.OldTable
"
34459,42159,how to use PARSENAME,"SELECT CASE
         WHEN YourCol LIKE '%[_]%'
           THEN LEFT(YourCol, CHARINDEX('_', YourCol) - 1)
       END
FROM   YourTable 
"
11131,26385,MySQL nested join with references to unnested table fields,"...
LEFT JOIN  parent  -- removed opening bracket
LEFT JOIN   child ON child.id = parent.childid
                 AND child.abc = first.abc 
                 AND parent.childid = in (0, child.Id) -- removed closing bracket and used 'IN'
...   
"
22420,48703,"SQL Query for duplicate records, retaining a list of the duplicate id's","SELECT GROUP_CONCAT(`user_id` separator ',') as user_ids, 
       message,
       lattitude, 
       longitude, 
       status, 
       img_name    
   FROM table_name 
   GROUP BY img_name, message;
"
33287,23297,Getting rows within a specified range for pagination,"SELECT  a.id ,
        a.title ,
        a.name
FROM    
   ( 
        SELECT ROW_NUMBER() OVER (ORDER BY b.dtetme DESC) AS RowNum, b.*
        FROM  [student] b 
        INNER JOIN [class] c ON  c.id = b.class
        WHERE b.[status] = 1
        AND c.name = 'Science'
    ) a
WHERE RowNum BETWEEN 1 AND 10 -- change numbers here for pages
ORDER BY t.RowNum
"
33667,55042,SQL query to obtain a count of how many items have each possible value for a given column,"SELECT STRFTIME('%H', DATETIME(time, 'unixepoch', 'localtime')), 
COUNT(anotherField)
FROM log
GROUP BY STRFTIME('%H', DATETIME(time, 'unixepoch', 'localtime'));
"
24517,50758,sqlite data from one db to another ,"update `1table` 
set url = (select db2.`2table`.url 
           from db2.`2table` 
           where `1table`.name = db2.`2table`.name);
"
29416,46677,Case Sensitivity in google spreadsheet queries,"=QUERY(Website!$A16:$D, ""select B WHERE (lower(C)=lower('""&$B$1&""') OR lower(B) contains lower('""&$B$1&""'))"", -1)
"
17588,36298,Multiple outer join in the same request,"declaration d
left OUTER JOIN saisiecategoriedeclaration sc on d.niddeclaration = sc.niddeclaration
left OUTER JOIN saisielignedeclaration sl on d.niddeclaration = sl.niddeclaration
left OUTER JOIN reglement r on d.niddeclaration = r.niddeclaration
"
24991,39127,How to in MySQL order rows by number of matches in associative table?,"select r.id, count(i.id) as ing_cnt 
from recipes r
left join recipes_ingredients ri on ri.id_recipes = r.id
left join ingredients i on ri.id_ingredients = i.id
group by r.id
order by ing_cnt desc 
"
21005,75198,sql server break columns into row with join,"select distinct Package_id, package_title, durationindays,videourl,package_image_1 + ',' + package_image_2 + ',' + package_image_3 + ',' + package_image_4 + ',' + package_image_5 As Pacakage,  Rating, AdultPrice
from packages
inner join
rates_and_dates on rates_and_dates.package = packages.package_id
where package_id=1 and adultprice='4500'
"
33749,60966,SQL | select statement | Temp Column data type,"SELECT ColumnName, ROUND(ColumnName,2) AS Rounded
 FROM TableName;
"
7168,28814,"SQL ""chained"" queries?","SELECT s.id, s.name, s.lastname,c.date,c.grade 
FROM classes c
inner join students s
on c.studentid=s.id
WHERE c.date BETWEEN '01/01/2014' AND '01/01/2015'
"
5520,39171,Sum two counts in sql,"SELECT TOP 10 usr.firstname, usr.lastname, count(doc.modifiedBy) AS modified_items, count(doc.createdDate) AS created_items, (count(doc.modifiedBy)) + (count(doc.createdDate)) AS summed_items
FROM document doc
WHERE doc.active = 't' 
GROUP BY usr.firstname, usr.lastname
ORDER BY doc.modified_items DESC
"
26524,38635,Execution plan quotes spill level 1,"CREATE NONCLUSTERED INDEX IX_DATE_COMPLETED
    ON YourTable (DateCompleted); 
"
31257,22416,sql statement insert into with select?,"IF EXISTS(SELECT * FROM table WHERE StudentID = @StudentID)
BEGIN
--update
END
ELSE
BEGIN
--insert
END
"
11702,63649,How to store image in SQL Server database tables column,"insert into tableName (ImageColumn) 
SELECT BulkColumn 
FROM Openrowset( Bulk 'image..Path..here', Single_Blob) as img
"
9380,24222,How to remove array element by different condition within one query in mongodb,"var postid = 1;
var userid = 63111;
var commentid = 7;
db.collection('posts').findOneAndUpdate({$or:[
    {_id:postid, user:userid}, 
    {_id:postid, comments:{$elemMatch:{user:userid, _id:commentid}}}
]}, 
{$pull: {comments: {_id: commentid}}})
"
15565,53874,Mysql DateTime group by 15 mins,"SELECT ... 

GROUP BY ( 4 * HOUR( thistime ) + FLOOR( MINUTE( thistime ) / 15 )) 
"
7080,56218,SQL - Partial Sum of results for two different columns,"SELECT Name, 
    sum(case when Rank in (1, 2) then Score else null end) as Score1,
    sum(case when Rank < 1 or Rank > 2 then Score else null end) as Score2
FROM Table 
GROUP BY Name 
"
14162,36022,TSQL join on possibly empty value,"SELECT A.[id],
       A.[empID],
       A.[firstName],
       A.[lastName],
       A.[emailAddress],
       B.[FirstName] + ' ' +B.[LastName] + ' (' +B.[ntid]+ ')' as managerApproval
FROM   tuitionSubmissions as A
LEFT OUTER JOIN empTable AS B
ON B.[empID] = A.[managerApproval]
FOR    XML PATH ('data'), TYPE, ELEMENTS, ROOT ('root');
"
13197,2571,SQL - Can I have a Group By clause after a nestled Select?,"Select Book_Name,Client_Name, max(date)
From table A
Group By Book_Name,Client_Name
HAVING max(date) < any (select..


                      ...)
"
9201,32305,use GREATEST in MySQL when there are null values,"greatest(
    COALESCE((follette_title.usedbuying_price *1.37), 0),
    COALESCE((amtext.price*1.37), 0),
    COALESCE((nebraska.price *1.2), 0),
    COALESCE((tichenor.price *1.25), 0)
    )
"
19011,30332,Selecting the same row multiple times,";with C as
(
  select ChildID,
         ParentID,
         Occurences - 1 as Occurences
  from @Children
  union all
  select ChildID,
         ParentID,
         Occurences - 1 as Occurences
  from C
  where Occurences > 0
)
select row_number() over(order by ChildID) as IDENT,
       ChildID,
       ParentID
from C
order by IDENT
"
2399,37178,Grouping by and counting but retrieve only one column,"SELECT product_id
FROM accounts_products
GROUP BY product_id
ORDER BY COUNT(*) DESC
LIMIT 1
"
3473,37671,Join two queries together with default values of 0 if empty in Access,"SELECT original_staff_data.*, transaction_data_by_staff.total_rev, transaction_data_by_staff.total_profit
FROM transaction_data_by_staff RIGHT JOIN original_staff_data ON (transaction_data_by_staff.year = original_staff_data.year) AND (transaction_data_by_staff.month = original_staff_data.month)
AND (((transaction_data_by_staff.[staff_uid])=[original_staff_data].[staff_uid]));
"
30291,20017,Why does this parameterized sql query not return results?,"Dim strSQLUser As String = ""Select Name, CompanyID from Users where UserName =@UserName""
"
36673,30906,Dynamic SQL Pivot (with CONVERT DateField,"SET @sql = N'SELECT *
FROM (
        SELECT ivr_reason,  
               CONVERT(CHAR(10),tz_date_hour, 20) AS tz_date_hour, 
               total_usage
        FROM [Genesys_var].[dbo].[app_subcf_results2]
      ) AS D

PIVOT(MAX(total_usage) FOR tz_date_hour IN(' + @cols + N')) AS P;';

EXEC sp_executesql @sql;
GO
"
35662,55805,"Using SQL (for MySQL), how can I UPDATE data on a row based on data from a previous row?","update yourtable y
join (
  select id, scott, @prevNumericId:=
          if(scott REGEXP '^[0-9]+$', scott, @prevNumericId) prevNumericId
  from yourtable, (select @prevNumericId:=0) t
  order by id   
  ) t on y.id = t.id and y.scott = t.scott
set y.scott = concat(t.prevNumericId,y.scott)
where y.scott not REGEXP '^[0-9]+$'
"
9276,42018,Select Item number from Sql Table,"select i.itemnumber
from inventtable i 
join etext e on i.itemnumber = e.itemnumber
where e.Rkey = 1 and e.rval =1 and e.id =2
"
21356,75603,Selecting nested common attributes,"select  'Common Color' as Id
,       (select color from orders where item = 'item a' group by color 
           order by count(*) desc limit 1) as Value
union all
select  'Common Style'
,       (select style from orders where item = 'item a' group by style 
            order by count(*) desc limit 1)
union all
select  'Common Size'
,       (select size from orders where item = 'item a' group by size 
            order by count(*) desc limit 1)
"
20584,49254,SQL Server Insert based of additional query,"INSERT INTO ProductExtra (ProductID, ExtraID) 
   SELECT ProductID, 10739
   FROM ProductSKU 
   JOIN Product ON ProductSKU.ProductID = Product.ID
   WHERE ItemType = 'fire grate'
"
28716,26438,Fastest way to find not null filed in sqlite,"select 1 from [app_status] where [status] is not null limit 1;
"
32712,4323,Joining SQL Server Tables,"SELECT
     [MovieID], [Title],
     STUFF(
         (SELECT ', ' + b.[Title]
          FROM MovieCategory a
               INNER JOIN Category b
                  On a.CategoryID = b.MovieID
          WHERE  a.[MovieID] = d.[MovieID]
          FOR XML PATH ('')) 
          , 1, 1, '')  AS CategoryList
FROM Movie AS d
GROUP BY [MovieID], [Title]
"
1404,25433,How would I query a SQL database to find a date that a record first appeared?,"SELECT date, mail_date, dealer_id 
FROM tableName 
WHERE DATE_DIFF(mail_date, date)>=5
"
33302,7717,Finding a list of un-compilable packages,"    select 'alter '||decode(object_type,'PACKAGE BODY','PACKAGE',object_type)||
       ' '||object_name||' compile '||decode(object_type,'PACKAGE BODY','body;',';')
  from user_objects
where status = 'INVALID'
"
32561,9504,"Return a sql value indicating whether a file exists, using c# and ExecuteCommand","return db.ExecuteQuery<int>(
    Scripts.CheckIfInstalled.Replace(""%tableName%"", tableName)
).Single().Equals(1);
"
3499,31738,EXEC to USE Database,"set @sql = 'use ' + quotename(@new_db_name) + '; disable trigger t1;'
exec (@sql)
"
24698,30865,Keep text formatting in SQL,"select replace(' 
test
test','
','<br/>')
"
2562,25947,show in one column by selecting from multiple column by date,"SELECT user_name, DATE(request_date) request_date, 
       SUM(IF(sim_id = 1, request_amount, 0)) sim_id1, 
       SUM(IF(sim_id = 2, request_amount, 0)) sim_id2, 
       SUM(IF(sim_id = 3, request_amount, 0)) sim_id3, 
       SUM(request_amount) total_amount
FROM Request 
GROUP BY user_name, DATE(request_date)
"
19752,26842,Understanding the output of an EXPLAIN statement (MySQL),"create index my_query_IDX on article (Deleted, _Temporary_Flag, _ComputedDeletedValue, PublishedOn)
"
27819,10814,Selecting all rows in the oldest record," SELECT *
 from [order]
 WHERE OrderDate = (SELECT min(OrderDate) from [order]) 
"
3698,46007,Reset IDs to logical order in SQL,"UPDATE mytable AS t1
JOIN (
   SELECT id, @rn := @rn + 1 AS rn   
   FROM mytable
   CROSS JOIN (SELECT @rn := 0) AS v
   ORDER BY id
) AS t2 ON t1.id = t2.id
SET t1.id = t2.rn;
"
13819,7655,MySQL / Searching Two Tables,"SELECT photoID AS contentID, colA, colB, ..., 'photo' AS ContentType
    FROM photos
UNION ALL
SELECT videoID AS contentID, colA, colB, ..., 'video' AS ContentType
    FROM videos
"
2721,5127,Get the right result from the table,"SELECT 
    route FROM arrivaltimes 
INNER JOIN 
    stops ON arrivaltimes.stop_id = stops.stop_id 
INNER JOIN 
    stops ON arrivaltimes.location = stops.location 
WHERE 
    time_format(arrivaltime,'%H:%i') = time_format(curtime() ,'%H:%i')
ORDER BY 
    arrivaltimes.stop_id DESC LIMIT 1;
"
17048,8503,Finding duplicate rows in SQL Server,"select o.orgName, oc.dupeCount, o.id
from organizations o
inner join (
    SELECT orgName, COUNT(*) AS dupeCount
    FROM organizations
    GROUP BY orgName
    HAVING COUNT(*) > 1
) oc on o.orgName = oc.orgName
"
25997,10224,How to update a column of a table to a scaling value,"with RankedDocument as
(
  select *
    , rn = row_number() over (order by ID)
  from Documents
)
update RankedDocument
set Version = rn
"
12029,65356,Mutual Friends Mysql Query,"SELECT *
FROM friend_list AS f
INNER JOIN friend_list AS mf ON f.friend_id = mf.friend_id
WHERE f.uid = 7
   AND f.status = 1
   AND mf.uid = 3
   AND mf.status = 1
"
21447,44323,Spooling in Oracle adds spaces to columns... how can I avoid it?,"set colsep ""|""

with demo as
   ( select 'Various' as col1, 'test' as col2, 'examples' as col3 from dual
     union all select 'How', 'are', 'you' from dual )
select col1, col2, col3
from   demo;

COL1   |COL2|COL3
-------|----|--------
Various|test|examples
How    |are |you
"
9362,8407,The most useful User-Defined Aggregate Functions,"Title
-----------------
The Hobbit
The Two Towers       -->   The Hobbit, The Two Towers, Leaf by Niggle
Leaf by Niggle
"
8567,72563,MySQL create temporary table with auto_increment id and select query,"CREATE TEMPORARY TABLE tmp (
    id INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY,
    valueName  varchar(16) // whatever type it should be
);

INSERT INTO tmp (valueName) SELECT valueName FROM sometable WHERE ...
"
23970,71987,Using MYSQL GROUP_CONCAT with sub query,"SELECT  *

FROM    table1

WHERE active=1

ORDER BY RAND()

LIMIT 5;
"
16067,56540,Find the accent data in table records,"with t1(data) as (
  select '2ème édition' from dual union all
  select 'Natália' from dual union all
  select 'sravanth' from dual
)
select * from t1 where regexp_like(data,'[àèìòùÀÈÌÒÙáéíóúýÁÉÍÓÚÝâêîôûÂÊÎÔÛãñõÃÑÕäëïöüÿÄËÏÖÜŸçÇßØøÅåÆæœ]');

DATA         
--------------
2ème édition  
Natália       
"
26532,34923,Count of weekdays in a given month,"SELECT
    DATENAME(dw, Date) AS WeekDay
    ,Date
    ,ROW_NUMBER() OVER (ORDER BY Date) AS Day
FROM DateTable
WHERE DATEPART(dw, Date) NOT IN (1, 7)
ORDER BY Date
"
37641,23055,"SQL Query, query to having single field name from different table","SELECT a.id, a.name
FROM TABELA as a
WHERE a.keys = '1'
UNION 
SELECT b.id, b.name 
FROM TABLEB as b
WHERE b.keys = '1'
"
20762,20561,Complex SQL query assistance,"SELECT li.TimetableID, s.Name
FROM LinePaths li INNER JOIN
    (SELECT TimetableID, max(SN) as SN FROM LinePaths) as aux
ON aux.TimetableID = li.TimetableID AND aux.SN = li.SN
INNER JOIN Stations s
ON s.ID = li.StationID
"
22831,74645,How to design a star schema,"DimBranch ( branchNo )
DimLoanManager ( empNo )
DimQuarter ( year, qNo )  -- qNo in (1,2,3,4)
DimWeek ( year, weekNo )  -- weekNo in (0..53), depending on business rules

Measures ( branchNo, empNo, year, qNo, weekNo, numContracts, sumLoans )
"
2038,75276,SQL ORDER String (NumberOrder/Year),"SELECT * FROM `tableX` 
ORDER BY right(n_inscription, 4) * 1,
         substring_index(n_inscription, '/', 1) * 1
"
25057,41939,Convert negative data into positive data in SQL Server,"SELECT ABS(a) AS AbsoluteA, ABS(b) AS AbsoluteB
FROM YourTable
"
7426,24620,How to set (combine) two primary keys in a table ,"ALTER TABLE dbo.YourTableNameHere
ADD CONSTRAINT PK_YourTableNameHere
PRIMARY KEY(Item_Id, Purchase_Id)
"
25436,72693,How to insert a record with validation,"select s.*
from 
(select id, date, value
from secondaryTable ) s ,

(
select id, max(date) as date 
from mainTable
group by id ) a

where s.id = a.id and s.date>a.date
"
31194,26769,How do I choose records with equal values in some column?,"SELECT ide, fn, ln, debt
FROM empl
WHERE ln IN
(
    SELECT ln
    FROM empl
    GROUP BY ln
    HAVING COUNT(*) > 1
)
"
5709,25108,How to benchmark a SQL Server query using SQL Server,"SET STATISTICS TIME ON
"
15841,68524,SQL query how do I make sure only the criteria in a list are in a table,"select * from table1 
where field1 = 1 
and field2 in(2,3)
and NOT EXISTS
  (
   SELECT null
   FROM table1
   where field1 = 1 
   and field2 NOT in (2,3)
   )
"
33778,68752,Select multiple SQL rows into one row,"SELECT 
  SUBSTRING(
    (SELECT ';' + strContract FROM tblContractMail FOR XML PATH('')),
    2,
    2147483647
  )
"
13398,53588,Subtract two dates in SQL and get days of the result,"Select I.Fee
From Item I
WHERE  DATEDIFF(day, GETDATE(), I.DateCreated) < 365
"
6547,11633,How to select all users who made more than 10 submissions,"select userId
from submission   
group by userId
having count(submissionGuid) > 10
"
12366,33880,Question about oracle xe search query,"SELECT * FROM EMPLOYEES WHERE JOB_TITLE = :P1_JOB_TITLE;
"
15266,1737,NOT IN condition in SQL,"SELECT *
FROM tbl1
WHERE NOT EXISTS
(
    SELECT *
    FROM tbl2
    WHERE tbl2.col1 = tbl1.col1
        AND tbl2.col2 = tbl1.col2
)
"
11988,48477,how to delete duplicates from a database table based on a certain field,"delete from tbl
where id NOT in
(
select  min(id)
from tbl
group by sourceid
)
"
36272,13045,SQL Inserting Data into table,"update TableA
    set Col1 = (select Col1 from TableB)
    where Col1 is null
"
32731,31521,Checking the time using VBA?,"If YourDateTimeValue > DateAdd(""h"", 4, Now()) Then
"
35469,40601,How to grab from right in postgressql,"split_part( trim( '}' from split_part(fieldname,'{',12) ), ';', 3)
"
2889,70966,Error conversion varchar datetime,"UPDATE dbo.table 
SET initTime = '2012-08-20T09:30:00.000' 
WHERE id = '0124'
"
15524,68215,Using calculated results of select statement to calculate another column in single statement,"Insert into @Matches(RowId, PercentMatch, Percentage) 
select tRow, MatchingPercent, MatchingPercent * @constantVal
from (
   select distinct t.[Row] as tRow, 
         cast(Max(Counts) as float) / (Abs(Max(Counts) 
         - 
         case 
           when Max(VarLength) >= @tempint then Max(VarLength) 
           else @tempint 
         end) + Max(Counts))* 100 As MatchingPercent 
from @Temp t 
Group by [Row] ) s
"
2226,28732,Non repeating monthly SQL,"SELECT 
  a.userid, 
  MIN(EXTRACT(MONTH FROM a.loginTime)) as month 
FROM login_audit a
WHERE a.loginTime <= '2012-12-31 11:59:59' AND a.loginTime >= '2012-01-01 00:00:00'
GROUP BY a.userid
"
8757,31522,Postgresql - Using subqueries with alter sequence expressions,"select setval('sequenceX', (select max(table_id)+1 from table), false)
"
28769,8095,Convert UPDATE with INNER JOIN from SQL for use in MySQL,"UPDATE product 
SET price = 12.95 
WHERE product_id in
(SELECT product_id 
FROM product_to_category 
INNER JOIN category 
ON product_to_category.category_id = category.category_id 
WHERE category.parent_id = 39)
"
26913,13316,How could create a crosstab SQL query with Django ORM?,"{% regroup line_items by store.name as store_items %}
{% for store in store_items %}    
  <tr>
    <td>{{ store.grouper }}</td>
    {% for item in store.list %}
      <td>{{ item.count }}</td>
    {% endfor %}
  </tr>
{% endfor %}
"
26887,7323,COUNT over multiple columns,"SELECT V, COUNT(*) C
FROM (
    SELECT one V FROM your_table
    UNION ALL
    SELECT two FROM your_table
    UNION ALL
    SELECT three FROM your_table
    UNION ALL
    SELECT four FROM your_table
    UNION ALL
    SELECT five FROM your_table
    UNION ALL
    SELECT six FROM your_table
) Q
GROUP BY V
ORDER BY C DESC;
"
36170,5582,Select a column and add its amount with other rows,"SELECT SUM(YourColumn) as Sum
FROM YourTable
"
37901,38302,Return rows from one of the left outer join table if it fails," CREATE TABLE c AS 
 SELECT  A.entity as Entity,
    A.Name as Name,
    A.Date as Date, 
    NVL(B.Price,0) as Price
 FROM A
 LEFT OUTER JOIN B
    ON A.Entity = B.Entity
    AND A.Name = B.Name
    AND A.Date = B.Date
"
29672,18073,Oracle Regular Expression (REGEXP_LIKE) Too Long Error - ORA-12733,"CREATE OR REPLACE AND RESOLVE JAVA SOURCE NAMED ipv6 as
import java.net.Inet6Address;
public class ipv6
...
create or replace function isProperIPv6Address (string varchar2) return number 
as language java name 'ipv6.isProperIPv6Address(java.lang.String) return int';
"
12809,3984,"mysql, is it possible to have multiple rows with group by?","select t.testid, t.distanceaf3, x.buildnumber
  from tbl t
  left join (select buildnumber, min(testid) as testid
               from tbl
              group by buildnumber) x
    on t.testid = x.testid
"
9174,5019,find out the number of times an ANI has called in the service using sql queries,"SELECT
    SERVICE, ANI, COUNT(*) AS 'ANI_COUNT'
FROM
    MyTable
GROUP BY SERVICE, ANI
"
16035,26146,One SQL query instead of many,"SELECT invited_by_id, COUNT(*) AS invited_count FROM table GROUP BY invited_by_id
"
22134,75098,Locating original record and updating all records to show it,"update NewTable
set OriginalTaskID = 
  (select f.TaskId
   from firstTable f
   where f.ProductId = n.ProductId
     and f.PreviousTaskID = 1)
from newTable n
"
36305,68251,"ASP, sorting database with conditions using multiple columns","select *
from Projects
order by iif(Complete = 'Yes', EndDate, StartDate)
"
39800,12185,SQL join with default attribute value,"SELECT  a.*,
        b.key,
        COALESCE(c.value, b.default) Value
FROM    Objects a
        CROSS JOIN Attributes b
        LEFT JOIN Object_Attributes c
            ON  a.ID = c.object_id AND
                b.key = c.key
ORDER   BY a.ID, b.key
"
16253,59758,How to get the sum?,"select call_type, channel
  , sum(case when status='no answer' then 1 else 0 end) as cnt_no_answer
  , sum(case when status='answered' then 1 else 0 end) as cnt_answer
  , count(status) as cnt_all_stated
  , count(*) as cnt_all_records
from app_account.cc_call
group by call_type, channel;
"
19896,62134,SQL-Server - Ability to pass subset parameter in the select?,"select [date], sum( case when type = 'Electronics' then (ordersize) else 0 end) AS ElectronicsSum,
sum( case when type = 'Electronics' then 1 else 0 end) AS ElectronicsCount,
sum( case when type = 'Books' then (ordersize) else 0 end) AS BooksSum,
sum( case when type = 'Books' then 1 else 0 end) AS BooksCoumt
from orders
group by [date]
"
6581,62129,SQL query to execute insert statement from the result of another sql query,"INSERT INTO People
(FirstName,LastName,Email)
SELECT @FirstName,@LastName,@Email WHERE @Email NOT IN (SELECT Email FROM People)
"
1017,18799,MySQL having if,"SELECT id, name, label, date
FROM items
WHERE date >= date(now()) and date < date(now()) + interval 1 day
GROUP BY label
HAVING (COUNT(id) > 10 and label = 5) or (label <> 5);
"
10099,4408,need to re-arrange data of sql table,"SELECT ID, Email, TM, UR
FROM TABLE
UNION
SELECT ID, EA1 Email, TM1 TM, UR1 UR
FROM TABLE
UNION
SELECT ID, '' Email, TM2 TM, UR2 UR
FROM TABLE
UNION
SELECT ID, '' Email, TM3 TM, UR3 UR
FROM TABLE
"
12653,58388,How to indicate a columns as NOT NULL in a view?,"Create function fnSTestample()
returns @Test TABLE 
(
    tableId varchar(100) not null
)
WITH SCHEMABINDING
as
begin
    insert @Test(tableID)
    select 'some computed value' from dbo.someTable
return
end
"
31020,42541,MySQL match existence of a term amongst comma seperated values using REGEXP,"SELECT * FROM tblnecklaces WHERE nsubcat LIKE '%bank special%';
"
37280,46797,Oracle/SQL - Finding records with one value excluding nulls,"select person, type from table
where type = '1'
and person not in (select person from table where type is null)
"
6079,30468,how to do group by and order by in one query?,"SELECT s.* , f.*
FROM tb_student s 
INNER JOIN
    (SELECT email, MAX(created_on) AS created_on
    FROM tb_fees
    GROUP BY email) Sub1
ON s.email = sub1.email
INNER JOIN tb_fees f 
ON s.email = f.email AND Sub1.created_on = f.created_on
WHERE s.class = 6
"
10598,24688,Calculate closest working day in Postgres,"select max(s.a) as work_day
from (
    select s.a::date
    from generate_series('2012-01-02'::date, '2050-12-31', '1 day') s(a)
    where extract(dow from s.a) between 1 and 5
    except
    select holiday_date
    from holiday_table
    ) s
where s.a < '2012-03-19'
;
"
25113,6905,select rows where column values differ by more than two years,"Select ID, Product, make_date, order_datetime
FROM tbl_order
WHERE make_date < order_datetime - INTERVAL 2 YEAR 
   OR make_date > order_datetime + INTERVAL 2 YEAR ;
"
25474,4774,Keys from functional dependencies,"CD+ = CD
    = CDAB (since CD → AB)
    = CDABE (since ABC → E)
"
8390,66320,Retrieving Values From a Prepared Statement and Select Query in Go,"stmt, err := txn.Prepare(`SELECT id, password FROM public.user WHERE email = $1`)
rows, err := stmt.Query(email)
"
27324,74786,Create a group indicator (SQL),"(CASE WHEN COUNT(*) OVER (partition by name, zip, phone) > 1
      THEN 'X'
      ELSE NULL
  END) duplicate,
DENSE_RANK() OVER (ORDER BY name, zip, phone) group_rank
"
23811,23381,How to count results from groupped subquery,"select distinct sr.SrcLngId, sr.SupplierId
into #myTable99
from SupplierLangs sl

select SrcLngId, count(SrcLngId) as [count] from #myTable99 temp
group by SrcLngId

drop table #myTable99
"
12302,55274,Is there a way to combine count and select query?,"SELECT A.ID, A.Date, COUNT(c.ID) AS Comments
FROM Article A
LEFT JOIN Comment c
  ON A.id = c.FK_Article
GROUP BY A.ID, A.Date
ORDER BY A.ID;
"
15943,66528,find duplicate between two tables,"UPDATE a
SET a.YourFlag = 1
WHERE EXISTS(SELECT 1 FROM b
             WHERE a.ename = b.ename and a.enum = b.enum)
"
25166,74202,Possible to link to another database link?,"SELECT * FROM myView@db1
"
12027,4037,How to behave with GUID column in a self-reference table,"select family.* 
  from table as member 
  join table as familiy 
    on member.ParentID = family.ParentID 
 where member.ItemID = 'firstGUID'
"
8591,27990,Inserting extra rows within table,"INSERT INTO my_table
SELECT item_number, NULL AS operation, NULL AS resource_code 
FROM my_table 
GROUP BY item_number
UNION ALL
SELECT item_number, NULL AS operation, NULL AS resource_code 
FROM my_table 
GROUP BY item_number
"
29669,10079,MS Access SQL query counting values in more than one column,"SELECT OPTION,sum(count) from (
  SELECT OPTION1 as OPTION,COUNT(*) as count FROM Table GROUP BY OPTION1
  union all
  SELECT OPTION2,COUNT(*) as count FROM Table GROUP BY OPTION2
  union all
  SELECT OPTION3,COUNT(*) as count FROM Table GROUP BY OPTION3
)group by OPTION
"
38957,31516,performant query using analytic function to select records with 2 date columns,"select *
  from ( select a.*
              , rank() over ( partition by fname, lname, accountid 
                      order by creation_date desc
                              , update_date desc ) as rnk
           from my_table a )
 where rnk = 1
"
12729,26349,"from each partition, select rows with N distinct values","select t.*
from (select t.*, dense_rank() over (partition by x order by y) as seqnum
      from atable t
     ) t
where seqnum <= 2;
"
36926,57768,Table with columns TABLE_NAME and NUMBER_COLUMNS in Oracle,"select table_name, owner, count(*) as Number_Columns
from all_tab_cols
group by table_name, owner;
"
27432,11005,select row n times with SQL,"select
    pg.showcount,
    p.name,
    g.groupname
from PersonGroup pg
inner join Person p on p.personid = pg.personid
inner join Groups g on g.groupid = pg.groupid
inner join dbo.NumbersTable(1,12,1) n on pg.showcount >= n.i
"
726,29684,How to write query that will do unusual distinct select from sql table?,"SELECT
  CASE WHEN CHARINDEX('<', Message) = 0 THEN Message ELSE LEFT(Message, CHARINDEX('<', Message)-1)) END AS Message
FROM
  yourTable
GROUP BY
  CASE WHEN CHARINDEX('<', Message) = 0 THEN Message ELSE LEFT(Message, CHARINDEX('<', Message)-1)) END
"
32246,47511,Getting single records back from joined tables that may produce multiple records,"select  Student_Name,
        Student_Email,
        (select count(*) 
         from Enrollment e 
         where e.student_id = s.student_id
        ) Number_Of_Enrollments 
 from Student e
"
3021,41520,ON DUPLICATE KEY: multi-column unique constraint,"ALTER TABLE tblname ADD UNIQUE (a,b)
"
25706,66627,Join 2 tables without create table,"Update [Table A]
Set [Table A].[NewColumn] = [someExpresssion]
from [Table A]
LEFT JOIN [Table B]
ON [Table A].Key = [Table B].key;
"
26997,74483,MySQL - Issue with GREATEST() and LEFT JOIN returning NULL,"SELECT COALESCE(s1.school_name, s2.school_name, s3.school_name) as `school`,
"
22858,37469,Determine which tables are locked,"ALTER DATABASE [<dbname>] SET READ_COMMITTED_SNAPSHOT ON
"
36163,47752,"selecting max date in range, excluding multiple other date ranges","SELECT TOP 1 tDate.SeqDate
FROM dbo.fnSeqDates('6/1/2012', '6/30/2012') tDate
    LEFT JOIN bfShow tShow
        ON tDate.SeqDate BETWEEN tShow.DateStart AND tShow.DateEnd
WHERE tShow.ShowID IS NULL -- no matches found
ORDER BY tDate.SeqDate DESC -- to pull the most recent date
"
36616,54051,How to Select the most recent items by dates from another table,"CREATE TABLE #Test
(
Id NVARCHAR(100),
Data DATE
)

INSERT INTO #Test VALUES ('1', '2015-01-04'), ('1', '2015-01-07'), ('2', '2015-01-05'), ('2', '2015-01-08')

SELECT Id, Data
FROM (
    SELECT Id, Data, ROW_NUMBER() OVER (PARTITION BY Id ORDER BY Data DESC) rn
    FROM #Test
    )x
WHERE rn > 1


DROP TABLE #Test
"
39795,17180,How do you create in-line commenting in SQL (with SQL-Server)?,"select SessionSID
, TargetID
--, TargetName
, FEDSurveyName 
, SupplierID
, ClientLK_ResponseStatusID 
from BI_Sessions (nolock)
WHERE EntryDate BETWEEN '05-15-2012' AND '05-16-2012'
AND SupplierID = 336
"
6186,37692,datalog for finding same value of attributes from a model,"student(name, rollno, city) -> string(name), string(rollno), string(city).

studentsPairsFromSameCity(nameA, nameB, city) -> string(nameA), string(nameB), string(city).

studentPairsFromSameCity(nameA, nameB, city)
<-
   student(nameA, _, cityA),
   student(nameB, _, cityB),
   nameA != nameB,
   cityA = cityB.
"
36277,59920,select LIKE first 3 digits in ms access query,"SELECT *
FROM mytable
WHERE left(Telephone,3) = '765'
"
9164,13616,How do I add an MSAccess connection to CodeIgniter or CakePHP?,"$db['access']['hostname'] = ""<dsn name>"";
$db['access']['username'] = """";
$db['access']['password'] = """";
$db['access']['database'] = ""<dsn name>"";
"
25944,826,MySQL. Auto-add in another table,"update table2 t2
  join table1 t1 on t2.product_id = t1.id
set t2.price = t1.price_per_unit * t2.quantity_sold;
"
4715,71312,Using CASE/IF statement in MySQL,"select userid, 
       sum(productgender = 'Men') as men_sum,
       sum(productgender = 'Women') as women_sum,
       sum(productgender = 'None') as none_sum,
       count(*) - sum(productgender = 'Men') * 100 / count(*) as men_percentage
from your_table
group by userid
"
5185,69093,MySQL alter table and convert data from text to datetime,"UPDATE `table`
SET `column` = STR_TO_DATE(`column`,'%d-%M-%Y %h:%i')
"
13345,26664,Compound IDENTITY column in SQL SERVER 2008,"DECLARE @Output table (orderID smallint)  --smallint=2 bytes

BEGIN TRANSACTION

INSERT INTO ORDERS
        (CustomerId ,OrderId ,.....)
        OUTPUT INSERTED.OrderId 
        INTO @Output 
    SELECT
        @CustomerId ,ISNULL(MAX(OrderId),0)+1, @...
        FROM ORDERS WITH (UPDLOCK,HOLDLOCK)
        WHERE CustomerId=@CustomerId 

--any other processing, can use just generated @Output.OrderId value if necessary

COMMIT
"
26883,70339,subtraction returning null value mysql,"set s.tot_cred = s.tot_cred - COALESCE(c.credits,0)
"
18509,17454,"SQL Query Question, Find max of result","SELECT x.aname, x.quantity
  FROM (SELECT r.name, SUM(r.rhowmuch + r.rhowoften) AS quantity
          FROM RATION r
      GROUP BY r.aname
      ORDER BY quantity DESC) x
 WHERE ROWNUM = 1
"
16460,48142,sql using select and adding to a table,"UPDATE `web`.`pro`
SET `pro`.`st` = `pro`.`st` + `s`.`Quantity`
FROM `web`.`pro`
JOIN `shopping cart` `s`
  ON `s`.`Pro_id` = `pro`.`ProdID`;
"
36977,4553,SQL query involving group by and joins,"SELECT
  Project.addDate,
  Project.idOwner,
  Account.Username,
  Project.idProject,
  Project.Price,
  ISNULL(q.offercount, 0) AS offercount
FROM
  (
    SELECT
      o.idProject,
      COUNT(o.idProject) as offercount
    FROM Offer o
    GROUP BY o.idProject
  ) AS q
  RIGHT JOIN Project ON Project.idProject = q.idProject
  INNER JOIN Account ON Account.idAccount = Project.idOwner
ORDER BY addDate DESC
"
11578,61912,How to expand decimal places of a number to a minimum in Oracle PLSQL?,"SQL> SELECT X, to_char(X, 'fm99999999.00000999')
  2    FROM (SELECT 123 X FROM dual UNION ALL
  3          SELECT 123.12 FROM dual UNION ALL
  4          SELECT 123.123456 FROM dual);

         X TO_CHAR(X,'FM99999999.00000999
---------- ------------------------------
       123 123.00000
    123.12 123.12000
123.123456 123.123456
"
23913,10438,retriving all rows with maximum value,"select state as ls,count(*) as total ,max(sales) as ye from  table    
where sales = (select max(sales) from table)
group by state
"
31502,58239,"Mysql, ""insert into“","Insert Into mytable(column1,column2,column3,column4)
Select 'value1',filed1, filed2,filed3 from anothertable where filed4=a_varible
"
12734,49427,How to extract leaf nodes from Oracle XMLTYPE,"WHERE
    t.existsNode( '/*//*' ) = 0
"
27883,18039,Can't return recordcount with the stored procedure with the declaration in it,"CREATE PROCEDURE sp_SalesTaxV3(@ship_zip varchar(20))
AS BEGIN
   DECLARE @tax_rate INT
   SET @tax_rate = 0

   SELECT * FROM tax_rate WHERE zip = ''+@ship_zip+''  
END
"
17255,70602,SQL mass replace column value,"UPDATE mybb_users
SET avatar = REPLACE(`avatar`, 'width=250&height=250', 'width=140&height=140')
WHERE avatar like '%graph.facebook%'
"
17478,74545,Select dummy data for a certain period of years based on some conditions from a main query,"SELECT e.idEmployee, COALESCE(ed.idExceptionDayType, 1) as idExceptionDayType
      y.year, COALESCE(SUM(ed.days), 0) as total
FROM (SELECT DISTINCT idEmployee FROM ExceptionDays) e CROSS JOIN
     (SELECT DISTINCT YEAR(startDate) as year FROM ExceptionDays) y LEFT JOIN
     ExceptionDays ed
     ON ed.idEmployee = e.idEmployee and
        y.year BETWEEN YEAR(ed.startDate) AND year(GETDATE())
GROUP BY e.idEmployee, ed.idExceptionDayType, y.year
"
9373,54910,Which will be the better database design in following situation? Why?," create index my_index on contacts(group_id, status) 
"
38767,59755,MS Access 2002/VBA - join a number of lookup tables to main query?,"SELECT contact_id, name, member_type, electorate
FROM contact 
LEFT JOIN member_types ON contact.member_type_id=member_types.member_type_id
LEFT JOIN electorates ON contact.electorate_id=electorates.electorate_id
"
13849,2669,SQL Server CHECK Constraint - Ensure no duplicates on text,"ALTER TABLE MyTable ADD CONSTRAINT UK_MyUniqueConstraint UNIQUE (MyColumn)
"
22743,6136,how to write a hql to get all records without permissions,"SELECT p
FROM Project p
WHERE p.id NOT IN
  (SELECT authorization.project.id
   FROM ProjectAuthorization authorization
   WHERE authorization.user = :currentUser)
"
34257,53021,WHERE all IS NOT NULL,"select * from schedule 
  where id is not null and foo is not null and bar is not null; -- and so on..
"
30295,16561,Modify argument in batch script,"$srch = '-v\s*(.*?)\s*=\s*%1'
$repl = ""-v `""'`$1'`"" = %1""

(Get-Content old.bat) -replace $srch, $repl | Set-Content new.bat
"
36927,25332,How to represent EAV in CSV?,"product, name_1, value_1, name_2, value_2
apple, size, small, color, green
apple, size, small, color, red
apple, size, large, color, green
apple, size, large, color, red
car, type, coupe, fuel, diesel
car, type, coupe, fuel, gas
car, type, sedan, fuel, diesel
car, type, sedan, fuel, gas
"
21370,25042,How can I avoid a sub-query?,"SELECT  t.*
FROM    t
        INNER JOIN (
          SELECT  ID = MAX(ID)
          FROM    t
          GROUP BY
                  key
        ) tm ON tm.ID = t.ID                  
"
31814,23996,How to custom sort this data in SQL Server 2012?,"select accoutn_name
from test.dbo.accounts
order by left(account_name,charindex('-',account_name,1)-1)
                        ,replace(right(left(account_name,CHARINDEX('-',account_name,1)+2),2),'-', '')
                        ,REPLACE(right(account_name,2),'-','')
"
22876,50454,Easiest way to get a total count and a count of a subset?,"WITH T1 AS (
    SELECT DATEPART(WEEKDAY,start_date) AS weekday
    FROM attend
    WHERE empl_no = 12345
)
SELECT
    (SELECT COUNT(*) FROM T1) AS total,
    (SELECT COUNT(*) FROM T1 WHERE weekday = 2 OR weekday = 6) AS subset
"
1204,61647,sql question .. how can i dynamically add columns to a sql query result set?,"        SELECT <non-pivoted column>,

            [first pivoted column] AS <column name>,

            [second pivoted column] AS <column name>, ...
    From Table 
    PIVOT (
...
FOR 
...
)
"
772,39568,How to get specific byte value from raw in PL/SQL?,"   utl_raw.substr( your_column,
                   5,
                   1 )
"
39366,67642,Which table structure is better,"Receivables:
    RefNo
    Date
ReceivableDollarVals:
    RefNo
    Type
    Amount
"
7322,33892,"Given two users, select every post rated by both users, and the rating of each user towards each post","SELECT r1.post_id, r1.rating AS rating1, r2.rating AS rating2
FROM ratings r1
JOIN ratings r2 ON r1.post_id=r2.post_id AND r1.user_id!=r2.user_id
WHERE r1.user_id=1 AND r2.user_id=2
"
6271,43591,Adding rows in table2 automatically on the basis of a specific column's input in table1,"delimiter //
create trigger ins_table2 after insert on table1
for each row
begin
  declare t2_cnt_index int default 1;
  while t2_cnt_index <= new.num do  
    insert into Table2 (desc2,id1) values (new.desc2,new.id1);
    set t2_cnt_index := t2_cnt_index + 1; 
  end while ;
end ; //
delimiter ;
"
11646,20987,mysql stored function parameter,"DROP FUNCTION IF EXISTS `example`.`test` $$
CREATE FUNCTION `example`.`test` (param INT) RETURNS VARCHAR(32)
BEGIN

  DECLARE new_username VARCHAR(32);

    SELECT `username`
      INTO new_username
      FROM `users`
     WHERE `ID` = param;

    RETURN COALESCE(new_username, 'Username not found');

END $$
"
26032,10580,to_char and to_date are returning different output," SELECT sysdate FROM DUAL
"
22923,60998,SELECT using GROUP BY and HAVING not returning records,"SELECT
    a.FIRSTNAME,
    a.LASTNAME,
    a.PHONE,
    a.EMAIL,
    a.TITLE,
    a.LMU
FROM TM_USER a
INNER JOIN
(
    SELECT LASTNAME
    FROM TM_USER
    GROUP BY LASTNAME
    HAVING COUNT(1) > 1
) b ON a.LASTNAME = b.LASTNAME
"
11308,34758,How to count unique rows in Oracle,"SELECT COUNT(*) 
FROM (SELECT DISTINCT * FROM Table)
"
15433,41826,Replacing NULL and empty string within SELECT statement,"COALESCE(NULLIF(Address.COUNTRY,''), 'United States')
"
23464,22135,SQL query for getting data from 3 tables,"SELECT
   e.Name,
   (SELECT
      SUM(TravelDurationDays)
   FROM
      TravelType1
   WHERE
      EmployeeID = e.EmployeeID
   ) TravelType1Days,
   (SELECT
      COUNT(*)
   FROM
      TravelType2
   WHERE
      EmployeeID = e.EmployeeID AND
      Travel = 'yes'
   ) TravelType2Days
FROM
   Employees e
"
458,22667,ORACLE SQL Query only Overlapping Timeframes,"SELECT *
FROM Emp e
WHERE EXISTS (
  SELECT *
  FROM Emp
  WHERE DEPT = e.DEPT
    AND HIRED_SDT < e.HIRED_EDT
    AND HIRED_EDT > e.HIRED_sDT
    AND NUM <> e.NUM
);
"
10989,66593,How to create a trigger to populate a table from another table in a different database,"create trigger trig1 on dbo.table1 
after insert as 
insert into database2.dbo.table2 (col1,col2,col3) values    (inserted.col1,           inserted.col2)`
"
894,46310,SQL skip or ignore a specific cells,"SELECT NULLIF(Column1, 999999999), 
       NULLIF(Column2, 999999999), 
       NULLIF(Column3, 999999999)
FROM Table
"
2851,3486,Join and Display 2 Columns from One Table refer by Another Table,"SELECT a.username as User_1, b.username as User_2 FROM
table_A t
JOIN table_B b on b.id = t.id_B
JOIN table_B a ON a.id = t.id_A
"
36430,6276,How to add a custom column with a default value in an sql query?,"select first_name, 
       last_name,
       'test' as default_value, --<< a ""virtual"" column containing a character value
       42 as the_answer         --<< another column containing a numeric value
from table1 
  join table2 on table1.id = table2.customer_id;
"
26499,65819,SQL expression problem,"select p.* from Profile p join 
(SELECT UserID, MIN(ProfilePriority) AS ProfilePriority
FROM Profile
WHERE ProfileLanguage = 'en-US' OR ProfilePriority = 2
GROUP BY UserID) tt
on p.userID = tt.UserID and p.ProfilePriority = tt.ProfilePriority
"
19750,14050,How to create a third table based on two other tables,"create table color
(
id_color int not null,
ds_color varchar(50) null,
primary key (id_color)
)

create table color_tops
(
id_color int not null,
id_colortop int not null,
ds_colortop varchar(50) null,
primary key (id_colortop),
foreign key (id_color) references color(id_color)
)

select color.ds_color,
       color_tops.ds_colortops
from   color
       inner join color on (color.id_color = color_tops.ds_colortops)
"
178,27060,SQL how to get indent string of relation of parent and child in table,"select   case when viewname is null then objectid else '......'+objectid end as objectid,
         description,
         priority
from     security_templates_exceptions_item
order by menuid, priority
"
39837,9426,Fast solution to fill create and fill db table with data from csv file,"require 'csv'

CSV.foreach(fileName, :headers => true, encoding: ""UTF-8"") do |row|
  row['myfiled'].to_s
end
"
27253,39545,Query 2 date ranges against the same column in one select statement without using a sub select?,"SELECT CASE WHEN finvdate BETWEEN '6/15/2013' AND '1/15/2014' THEN finvdate ELSE NULL END AS FirstDate,
CASE WHEN finvdate BETWEEN '1/15/2014' AND '04/15/2014' THEN finvdate ELSE NULL END AS SecondDate,
FROM SalesDollars 
"
30334,45940,SQL Trim after final semi colon,"SELECT  MAX(RIGHT(
         E.EVENT_DESC
        ,LENGTH(E.EVENT_DESC) - LOCATE_IN_STRING(E.EVENT_DESC,';',-1)))
FROM    IASDB.EVENT E 
WHERE   SL.INVOICE_NO = E.INVOICE_NO 
AND     E.EVENT_CODE IN 'EDL'
"
6854,74881,Database table join not returning proper result,"SELECT MovieName from MovieMaster 
INNER JOIN DVDBinSlotInfo ON MovieMaster.MovieId = DVDBinSlotInfo.MovieId
WHERE KioskID='901' and Status='DVD'
"
14057,5126,Invoking a PL/SQL function from EclipseLink,"CREATE OR REPLACE FUNCTION f_x (p_id IN NUMBER) RETURN BOOLEAN IS
BEGIN
   RETURN TRUE;
END f_x;

CREATE OR REPLACE PROCEDURE p_x (i_id IN NUMBER, o_val OUT BOOLEAN) IS
BEGIN
  o_val := f_x(i_id);
END p_x;
"
6828,26556,How to find count from two joined tables,"select
 Cat_Name, 
 sum(case when Impact_Level = 'High' then 1 else 0 end) as [Impact_Level_High],
 sum(case when Impact_Level = 'Medium' then 1 else 0 end) as [Impact_Level_Medium],
 sum(case when Impact_Level = 'Low' then 1 else 0 end) as [Impact_Level_Low]
from [Risk_Impact_Assessment]
...
group by Cat_Name;
"
33490,21436,Tricky aggregation Oracle 11G,"select Name, 
   100*(sum(APlusCount) over () - APlusCount) /
   (sum(TotalStudents) over () - TotalStudents) as result
from grades
where name <> 'All';

NAME        RESULT
=================================
Grade1A     43.661971830986
Grade1B     47.142857142857
Grade1C     50
Grade1D     44.444444444444
"
24572,11731,Find certain words in comment posts,"SELECT * FROM GUESTBOOK WHERE `MY COLUMN NAME` LIKE ""%WORD%""
"
1173,74629,MySQL query finding matches across multiple rows,"SELECT a1.dataID
FROM
    Attributes a1
    JOIN Attributes a2 ON
        a1.dataID=a2.dataID
    JOIN Attributes a3 ON
        a2.dataID=a3.dataID
WHERE
    a1.dataID = 1 AND
    a1.attributeID = 1 AND
    a2.attributeID = 2 AND
    a3.attributeID = 3;
"
24527,23394,Classic ASP getting SCOPE_IDENTITY() Value from SQL2005,"CREATE PROCEDURE sp_NewClaim
 (
    @ClaimNumber nvarchar(50),
    @blah............
    .................
)
AS
BEGIN
    SET NOCOUNT ON;

    INSERT INTO Accidente (ClaimNumber,........., RecordNumber)
        VALUES (@ClaimNumber,....., @RecordNumber)

    SELECT SCOPE_IDENTITY()
END
"
22865,51261,Obtain substring in SQL,"select (regexp_split_to_array(registrationno, '\.'))[3]
from subscriber
"
14327,42500,"MYSQL - Select statement, if condition fail return empty string","SELECT agent.name,agency.title FROM agent
LEFT JOIN agency ON agent.titleid = agency.titleid
WHERE agent.id = ""1""
"
1442,5754,How to insert XML to SQL,"select
  Name = XCol.value('../@Index','varchar(25)'),
  Cat = XCol.value('../@Name','varchar(25)'),
  [Index] = XCol.value('@Index','varchar(25)'),
  Slot = XCol.value('@Slot','varchar(25)')
from
  @input.nodes('/ItemList/Section/Item') AS test(XCol)
"
2763,73981,Conditional WHERE-clause at stored procedures,"AND (LW.""testVal"" LIKE :testVal OR :testVal = '*')
"
39642,23900,Query database settings?,"SELECT name,
       snapshot_isolation_state, 
       is_read_committed_snapshot_on
  FROM sys.databases 
 WHERE name = @YourDatabaseName
"
5450,1471,Remove last 2 digits from column1 and append those 2 digits to column2,"SELECT LEFT(Column1, LEN(Column1) - 2) Edited_Column1,
       RIGHT(Column1, 2) + ' ' + Column2 Edited_Column2
FROM   table1
"
17826,66592,SQL - Find names and total budget associated with name,"SELECT SPONSOR,SUM(BUDGET) 
FROM PROJECT 
GROUP BY SPONSOR
"
34911,70716,UPDATE Multiple Rows Using CASE in SQL 2008,"UPDATE Cars
SET  engineSize = CarSpecs1.value, colour = CarSpecs2.value
FROM Cars
INNER JOIN CarSpecs CarSpecs1 
    ON CarsSpecs1.carID = Cars.carID AND CarsSpecs1.specCode =1
INNER JOIN CarSpecs CarSpecs2 
    ON CarsSpecs2.carID = Cars.carID AND CarsSpecs2.specCode =2
"
22310,2757,SQL: how to get more information from a GROUP BY statement,"SELECT  
invoice.customer_name,  
invoice.customer_id,  
sum(invoice.cost) 
FROM invoice 
GROUP BY 
invoice.customer_name, invoice.customer_id
"
34250,18858,Oracle 12c Identity column with Fluent Nhibernate,"Id(x => x.Id).Column(""ID"").GeneratedBy.SequenceIdentity(""Your_Sequence_Name"")
"
22889,56158,SQLite3: Return a NULL if no records exist in SUM(),"SELECT ID,
       SUM(CASE WHEN EVENTS = 3 AND YEAR = 2012 THEN 1 END)
FROM Events_ID
GROUP BY ID;
"
5691,45829,How to ensure that a user in Rails can update/insert/delete only his/her record in a database,"    current_user.fragile_records.find(params[:id]).destroy
"
33570,489,Best method to store data in android application?,"public List<String> readLines(String filename) throws IOException {
    List<String> lines = new ArrayList<String>();
    AssetManager assets = context.getAssets();
    BufferedReader reader = new BufferedReader(new InputStreamReader(assets.open(filename)));
    while(true) {
        String line = reader.readLine();
        if(line == null) {
            break;
        }
        lines.add(line);
    }
    return lines;
}
"
5570,28997,Return All Values that Contain a Specific String using Oracle,"select the_value
from table1
where the_value like ‘%Orange%’
"
11257,46990,Cassandra NoSQL - optimal data structure for domains and pages,"CREATE TABLE page (
  domain_name text,
  domain_suffix text,
  page_url text,
  page_title text,
  page_descr text,
  page_updated timestamp,      
  PRIMARY KEY ((domain_suffix, domain_name), page_updated)
);
"
6075,31112,Selecting data with multi table SQL statement returns unexpected result,"SELECT product.name, GROUP_CONCAT(features.text)
FROM products JOIN product_features ON(products.id = product_features.product_id)
GROUP BY products.id;
"
39833,33045,Proble with joining two tables on subquery condition,"SELECT
    pics.c_name,
    pics.e_post,
vac.e_dateTo
FROM et_pics pics
INNER JOIN et_division div on pics.e_division = div.ob_no
INNER JOIN(select e_pic, max(e_dateTo) from  et_vacations group by e_pic )vac on vac.e_pic = pics.ob_no
WHERE
    (pics.e_fireDate IS NULL OR pics.e_fireDate > getDate()) 
       ORDER BY pics.c_name;
"
13537,36037,How do I enforce SQL join conditions across multiple joined rows?,"SELECT * from tournaments
WHERE id IN
( SELECT tournaments.id
  FROM tournaments INNER JOIN games ON tournaments.game_id = games.id
  GROUP BY tournaments.id
  HAVING MIN(games.event_date) >= now()
)
"
38576,9681,Why does the number 0 evaluate to a blank space,"SELECT CAST(0 AS varchar)        -- Output: '0'
SELECT CAST('' AS smallint)      -- Output: 0
"
6673,52465,What's the syntax for the create table statement in Excel?,"CREATE TABLE `sheetname` (
`DartNumber` VarChar (16)
, `ClientId` VarChar (10)
, `Population` VarChar (30))
"
29613,68099,postgresql aggregate of aggregate (sum of sum),"select d.name, sum(s.amount)
from sales s
join department_employees de on de.worker_id = s.worker_id
join departments d on d.id = de.department_id
group by d.name
"
34737,62642,count diferent data with same name in collumn as 1 count sql server,"SELECT COUNT(*)
FROM (
  SELECT no_req  
  FROM tblcount
  GROUP BY no_req 
  HAVING COUNT(*) = COUNT(CASE WHEN no_order <> '' THEN no_order END) AND 
         COUNT(*) = COUNT(CASE WHEN no_grn <> '' THEN no_grn END)) AS t
"
36322,26626,Calculating the average time between orders for each customer,"select cust_id , avg(orderdate - lag_orderdate) as avg_time_between_orders
from (
    select cust_id , orderDate , lag(orderdate) over (partition by cust_id) as lag_orderdate
    from  orders )
"
17340,66562,How Do I Combine Multiple SQL Queries?,"SELECT worked/available AS PercentageCapacity
FROM ( SELECT worked FROM A ), 
     ( SELECT available FROM B )
"
63,69142,sql practice query issue,"SELECT winner
FROM nobel
GROUP BY winner
HAVING COUNT(DISTINCT subject) > 1
"
31165,73386,SQL to select and order with condition,"$sql = ""SELECT news.*, SUM(news_points.points) as total
          FROM news left join news_points 
            ON news.news_id = news_points.news_id
          GROUP BY news.news_id
          ORDER BY total DESC, news.news_id ASC"";
"
7418,2452,oracle sql query statement NVL not working as desired,"SELECT NVL2( m.first_name ||m.last_name , m.first_name || ' ' || m.last_name, 'No One' )
   || ' supervises '
   || w.first_name
   || ' '
   || w.last_name FROM employees w, employees m WHERE w.manager_id = m.employee_id(+);
"
1468,68155,SQL: nest SUM with MN,"SELECT SUM(lowest_price) FROM
(SELECT MIN(r1.price) AS lowest_price 
FROM rounds r1
INNER JOIN rounds r2 ON r1.market = r2.market
                    AND r1.round = r2.round 
                    AND r1.name = r2.name
WHERE r1.round ='1' 
GROUP BY r1.market) innerSElect
"
11767,5184,How to use a SQL for loop to insert rows into database?,"INSERT INTO articles (id, name)
SELECT x.id, 'article #' || x.id
  FROM generate_series(1,10000000) AS x(id);
"
37307,44127,Aliasing columns based on cross-reference table,"DECLARE @sql NVARCHAR(MAX) = N'';

SELECT @sql += ',' + QUOTENAME(Acronym) + ' AS ' + QUOTENAME(Name)
FROM dbo.AcronymTable;

SET @sql = 'SELECT ' + STUFF(@sql, 1, 1, N'') + ' FROM dbo.Table;';

PRINT @sql;
--EXEC sp_executesql @sql;
"
1725,57324,How to have SQL Inner Join to return first entry or blank if no entry,"SELECT
  Table_1.ID,
  Table_1.Value,
  minval.Value_2
FROM
  Table_1
  /* Subquery returns least Value_2 per group of ID */
  LEFT JOIN (
    SELECT ID, MIN(Value_2) AS Value_2 FROM Table_2 GROUP BY ID
  ) minval ON Table_1.ID = minval.ID
"
37437,71428,SQL Query group by highest revision number,"SELECT A.Id, A.ColumnId, A.Revision
from Bug A 
INNER JOIN
(SELECT ColumnId  MAX(Revision) As MaxRevision 
FROM BUG
GROUP BY ColumnId ) B ON
A.ColumnId = B.ColumnId AND
A.Revision = B.MaxRevision
"
37420,35816,Writing an SQL query to bring back results using a filter,"SELECT quantities.recipe_id
FROM quantities
INNER JOIN recipes ON quantities.recipe_id = recipes.recipe_id
WHERE quantities.ingredient_id = 24 AND recipes.user_id = 6
"
423,55843,Oracle Anti-Join Execution plan question,"cost(FULL TABLE SCAN) < cost(FULL INDEX SCAN) + cost(TABLE ACCESS BY ROWID)
"
34400,57873,Regular Expression to return when invalid character found,"([^a-zA-Z0-9+?/:().,' -])
"
25627,12545,SQL help: find rows in one table which don't exist in second table based on values in two columns,"SELECT * 
FROM Table_1 AS t1
LEFT OUTER JOIN Table_2 AS t2
ON t1.firstname = t2.firstname
AND t1.lastname = t2.lastname
WHERE t2.firstname IS NULL AND t2.lastname IS NULL
"
9305,10966,Very slow query in ORDER BY with larger LIMIT range,"SELECT * 
FROM syslog FORCE INDEX (Facility)
WHERE 
    ReportedTime BETWEEN '2013-11-04' AND '2013-11-05' 
AND Priority<3 
AND Facility=1 
ORDER BY id DESC 
LIMIT 7;
"
18574,72282,What is the best way to get start date and end date of the week between two dates in SQL,";WITH DaysOfWeek AS 
( 
    SELECT {d '2011-04-24'} AS StartOfWeek
    UNION ALL 
    SELECT DATEADD( week, 1, jdr.StartOfWeek) AS StartOfWeek
    FROM JoursDuReleve jdr 
    WHERE DATEADD(week, 1, jdr.StartOfWeek) <= {d '2012-05-05'}
) 
SELECT StartOfWeek, DATEADD(day, 6, StartOfWeek) AS EndOfWeek  
FROM DaysOfWeek
ORDER BY StartOfWeek DESC 
OPTION (MAXRECURSION 0)
"
35326,30110,SELECTing user with earliest time and joining with other data,"SELECT  id,
        CASE WHEN value = 'xyz'
             THEN 'Pending'
             ELSE 'Not Pending'
        END AS status,
        time,
        FIRST_VALUE(user) OVER (PARTITION BY id ORDER BY time) AS first_user
FROM    table1
INNER JOIN
        ...
WHERE   subject IN (...) AND
        field = 'Status'
"
19912,69637,How to move logs from DB to files in Magento EE?,"_saveUrlInfo($visitor)
_saveVisitorUrl($visitor)
_saveCustomerInfo($visitor)
_saveQuoteInfo($visitor)
"
7356,11265,Combine multiple rows into one row to replace null values in columns,"“Vendor1 Price” = MAX(CASE WHEN Ven.Name = ‘Vendor1’ THEN Catalog.Price END),
“Vendor1 ItemNum” = MAX(CASE WHEN Ven.Name = ‘Vendor1’ THEN Catalog.ItemNum END),
“Vendor2 Price” = MAX(CASE WHEN Ven.Name = ‘Vendor2’ THEN Catalog.Price END),
“Vendor2 ItemNum” = MAX(CASE WHEN Ven.Name = ‘Vendor2’ THEN Catalog.ItemNum END)
"
16507,64280,SQL: Verify if date is between two dates,"SELECT Row WHERE MONTH(Orderdate) BETWEEN 1 AND 8
"
24267,73468,"Restrict rows based on a join table, using a count","SELECT e.employeeId, v.maxVacationDays
FROM employees e
         INNER JOIN vacations v ON (v.employeeId = e.employeeId)
WHERE e.isActive = true
GROUP BY e.employeeId, v.maxVacationDays
HAVING COUNT(v.employeeId) > v.maxVacationDays
"
6014,65560,Get following letter from given,";with cte as
(select max(groupcode) maxcode
 from yourtable 
 where left(code,4) = left(@companyname,4))

insert into yourtable (company, groupcode, [status])
select @companyname,
case when maxcode is null then left(@companyname,4) + 'a' else left(maxcode,4) + char(ascii(right(maxcode,1))+1) end,
'created'
from cte
"
475,59356,Insert Inner Join Statement,"INSERT INTO Sales (sProdName, sPrice, sPmtType)
SELECT Item as sProdName, 
       Price as sPrice, 
       'CASH' as sPmtType
FROM   ShoppingCart
"
290,63738,Joining Max Row where Col,"SELECT   `shift`.`uid`, 
         `shift`.`activity`, 
         `users`.`fname`, 
         `users`.`lname` ,
         t.max_time
FROM     `shift`
JOIN     `users` ON `shift`.`uid` = `users`.`id`
JOIN     (SELECT   `uid`, MAX(`time`) AS max_time
          FROM     `times`
          GROUP BY `uid`) t ON shift.uid = t.uid
ORDER BY t.max_time
"
39380,14767,how to add new column in ms access table with this criteria,"SELECT tblFooB.TextB, nz([NumA],0) AS Expr1 INTO tblFooC
FROM tblFooB LEFT JOIN tblFooA ON tblFooB.TextB = tblFooA.TextA;
"
31875,34193,SQL Server correct way to account for the weekend,"select * from table where date = (case
  when datename(dw, getdate()) = 'Friday' then
    convert(varchar, dateadd(day, 7, DATEADD(dd, 0, DATEDIFF(dd, 0,getdate()))), 103)
     + ',' + convert(varchar, dateadd(day, 9, DATEADD(dd, 0, DATEDIFF(dd, 0,getdate()))), 103)
  else
    convert(varchar, dateadd(day, 7, DATEADD(dd, 0, DATEDIFF(dd, 0,getdate()))), 103)
  end)
"
17521,41907,SQL query to find number of users who are in two specific groups,"select 
  u.userid
from
  usergroup u
where
  u.groupid in (27, 714)
group by
  u.userid
having 
  count(u.userid) > 1
"
29435,67819,Truncating timestamps,"SQL> select to_timestamp_tz(to_char(timestamp '2011-02-24 08:30:42 +06:00', 'YYYY-MM-DD HH24 TZH:TZM'), 'YYYY-MM-DD HH24 TZH:TZM') from dual;

TO_TIMESTAMP_TZ(TO_CHAR(TIMESTAMP'2011-02-2408:30:42+06:00','YYYY-MM-DDTZH:
---------------------------------------------------------------------------
24.02.2011 8:00:00,000000000 +06:00
"
24196,8002,Using REGEXP_SUBSTR as split in Oracle,"regexp_substr(a.field, '(\d+):', 1, 1, '', 1),
regexp_substr(a.field, '(\d+):', 1, 2, '', 1),
regexp_substr(a.field, '\S+(\s|-)+\S+'),
regexp_substr(a.field, '\S+(\s|-)+\S+\s+(.*)\s+\S+$', 1, 1, '', 2)
"
30494,10301,Platform Neutral SQL Statement for INSTR or CHARINDEX,"ORACLE uses: INSTR
SQL SERVER uses: PATINDEX, CHARINDEX

ORACLE uses: SUBSTR
SQL SERVER uses: SUBSTRING
"
11,38310,How can I use full outer join?,"SELECT df.numCode as 'numCode', 
       coalesce(tf.dateCurr, '2012-10-29') as 'dateCurr'
FROM dateFile df Full Outer join Contact ct 
On ct.numCode = df.numCode and df.dateCurr = '2012-10-29'
"
35667,71784,SQL - how can I copy a column and its data to a new column in the same table?,"alter table Table1 add newColumn char(32);
update table1 set newColumn=oldColumn;
commit;
"
33297,59731,Finding all items that do not exist in table - SQL,"SELECT TicketNum FROM TicketBooks
WHERE NOT EXISTS
(
    SELECT 1 FROM Tickets WHERE Tickets.TicketNum = TicketBooks.TicketNum
)
"
34082,15836,SQL list only unique / distinct values,"WITH singleRow as ( 
   select count(way), way
   from planet_osm_line 
   group by way
   having count(way) = 1
)
SELECT P.*
FROM planet_osm_line P
JOIN singleRow S
  ON P.way = S.way
"
10831,58013,How to alter the below table?,";with cte as
(
select id,value1,value2,row_number() over(partition by id order by id) as rn from #t
)

select id,value1,value2 from cte where rn=1
"
27139,59497,Query to get intersect,"select spj1.jnum as jnum1, spj2.jnum as jnum2 
from spj spj1
join spj spj2 on spj1.pnum = spj2.pnum and spj1.jnum < spj2.jnum
group by spj1.jnum, spj2.jnum
having count(distinct spj1.pnum) >= 100;
"
17698,28826,SQL Sum If with Multiple Criteria,"SELECT 
 (select name from people as p where p.personid=e.personID) AS name, 
 contract, 
 Sum(labor) AS sum_labor, 
 Sum(materials) AS sum_materials, 
 sum(travel) AS sum_travel, 
 Sum(Labor+Materials+Travel) AS total, 
 Sum(IIf(class='A',Labor+Materials+Travel,0)) AS A, 
 Sum(IIf(class='B',Labor+Materials+Travel,0)) AS B, 
 Sum(IIf(class='C',Labor+Materials+Travel,0)) AS C
FROM expenses as e
GROUP BY contract, personID;
"
2693,26741,reset a time field time with a update query,"UPDATE yourtable SET arrival_time = TIMEDIFF(arrival_time, '24:00:00')
WHERE arrival_time > '23:59:59';
"
16637,65273,Selecting/casting output as integer in SQL,"SELECT 
  CAST(sum(number)/count(number) as UNSIGNED) as average, 
  date 
FROM stats 
WHERE * 
GROUP BY date
"
22225,51221,Postgres function insert into values/parameter range,"'..VALUES ($' + join([2..31], ',$') + ')'
"
5412,26084,how to get coulmns with DEFAULT value in table using GETDDL in ORACLE,"Select TABLE_NAME, COLUMN_NAME, DATA_DEFAULT
from DBA_TAB_COLUMNS
where DATA_DEFAULT is not null
"
19847,72738,Fetch Max from a date column grouped by a particular field,"SELECT DISTINCT MyTable.LogId, MyTable.Entered FROM MyTable
INNER JOIN (SELECT RefId, MAX(Entered) as Entered FROM MyTable GROUP BY RefId) Latest
ON MyTable.RefId = Latest.RefId AND MyTable.Entered = Latest.Entered
"
34485,16084,How to write an SQL script that needs to be executed on many databases?,"SELECT DATABASE() INTO databasename;
"
8512,12619,Using conditional Update - On duplicate key update,"INSERT INTO result(studentName,subjectName,result)
SELECT StudentName,SubjectName,result
FROM temp_main
ON DUPLICATE KEY UPDATE result.result = CASE WHEN result.result = 'Pass' THEN 'Pass' ELSE VALUES(result.result) END
"
17702,57212,Get rows from table1 missing in table2 oracle?,"SELECT 
  a.ID, 
  a.NAME
FROM 
  TABLEA a LEFT JOIN TABLEB b ON a.ID=b.ID 
    LEFT JOIN TABLEC c ON a.ID=c.ID
WHERE 
  b.ID IS NULL AND 
  c.ID IS NULL;
"
1696,11471,How can I convert bigint (UNIX timestamp) to datetime in SQL Server?,"CREATE FUNCTION dbo.fn_ConvertToDateTime (@Datetime BIGINT)
RETURNS DATETIME
AS
BEGIN
    DECLARE @LocalTimeOffset BIGINT
           ,@AdjustedLocalDatetime BIGINT;
    SET @LocalTimeOffset = DATEDIFF(second,GETDATE(),GETUTCDATE())
    SET @AdjustedLocalDatetime = @Datetime - @LocalTimeOffset
    RETURN (SELECT DATEADD(second,@AdjustedLocalDatetime, CAST('1970-01-01 00:00:00' AS datetime)))
END;
GO
"
5857,57002,Return Data on MAX Value (Without Affecting Result of MAX),"SELECT Service_Availability.Service_Product, Service_Availability.Specificity 
FROM Service_Availability 
INNER JOIN (
    SELECT Service_Availability.Service_Product, MAX(Service_Availability.Specificity) AS Spec
    FROM Service_Availability
    WHERE (Service_Availability.State = ""TX"" OR Service_Availability.State = ""CW"")
    GROUP BY Service_Availability.Service_Product ) max_spec
  ON Service_Availability.Service_Product = max_spec.Service_Product
  AND Service_Availability.Specificity = max_spec.Spec
WHERE Service_Availability.Available = TRUE
"
31850,3197,MySQL ORDER problem,"select * 
from myTable
order by field(myID, 8, 7, 6) desc;
"
692,4893,"Oracle PL/SQL Program Not Working, program involves Records and Composite Data","hr_myrecord.hr_longevity := 
    TRUNC(MONTHS_BETWEEN(SYSDATE, hr_myrecord.hr_rec_row.hire_date), 1);
"
8503,13144,PL/SQL time segment calculation,"select extract(hour from numtodsinterval(to_date('14:00:00','HH24:MI:SS') - to_date('13:15:00','HH24:MI:SS'),'DAY'))
||':'|| extract(minute from numtodsinterval(to_date('14:00:00','HH24:MI:SS') - to_date('13:15:00','HH24:MI:SS'),'DAY')) diff
from dual
/

DIFF
------------------

0:45
"
32676,20231,select from unpopulated table - IS NULL does not work,"where 
Sp.sprite_change_ind is null
and sh.TRAN_REQUEST_DATE between sysdate-1 and sysdate
and (sf.stcr_term_code = '201401' or sf.stcr_term_code = '201402')
AND SV.RSTS_ENRL = 'Y'
and trim(NL.DGMR_DEGS_CODE) is null
"
20966,9067,SQL Injection without direct user input,"result = RunQuery(""SELECT * FROM Table"")
"
37454,21038,Changing values to be selected in SQL,"SELECT IIF(GENDER = ""F"", ""FEMALE"", ""MALE"")
"
15030,8442,Script/Much Needed Assistance,"SELECT <<other columns>>,
       (CASE question_table.question 
             WHEN 'A' then 'Loves to game but only plays weekends'
             WHEN 'B' then <<something else>>
             WHEN 'C' ...
             ELSE 'Translation Unknown' 
          END) as new_column_name
  FROM <<your tables>>
 WHERE <<your predicates>>
"
26417,2973,Show only first row of each group excluding NULL,"SELECT PatientID, CaseNo, Gender, Name
  FROM 
(
  SELECT PatientID, CaseNo, Gender, Name, 
         ROW_NUMBER() OVER (PARTITION BY CaseNo ORDER BY Gender) rnum,
         COUNT(*) OVER (PARTITION BY CaseNo) rcnt
    FROM Patients
) q
 WHERE CaseNo IS NULL 
    OR rcnt = 1
    OR (rcnt > 1 AND rnum = 1)
 ORDER  BY Name
"
18543,19205,Does making a column unique force an index to be created?,"create table TestTable (id int)
alter table TestTable add constraint unique_id unique (id)
create unique index ix_TestTable_id on TestTable (id)

select * from sys.indexes where [object_id] = object_id('TestTable')
"
23992,8106,Exclude results from mysql query results,"SELECT gr.group_name
FROM groups gr
WHERE gr.group_id NOT IN (
   SELECT gm.group_id
   FROM groupmembers gm
   WHERE gm.user_id = 5
)
"
811,18076,Avoid SQL WHERE NOT IN Clause,"SELECT * 
FROM  `article` 
LEFT JOIN `blog_article` ON CONCAT(`blog_article`.`article_id`) = `article`.`id`
                            AND  `blog_article`.`blog_id` = 1 -- example value
WHERE `blog_article`.`article_id` is null --replace the not in
"
28879,2551,return mysql result set only if found in other table,"SELECT vg.*
    FROM video_groups vg
    WHERE EXISTS (SELECT 1
                      FROM videos v
                      WHERE v.groupid = vg.id)
"
4999,25520,How do I update a subset of one SQLite table from the entire contents of another?,"INSERT OR REPLACE into firstTable (uid, w, x, y, z) 
  SELECT uid, w, x, y, z FROM secondTable
"
30386,69467,Sql - get previous order which uses the item,"select max(order_id) from order_item where  order_id <299 and item_id =3
"
39159,33339,SQL I have to find the entire row of people that did something the same day. count function?,"select distinct d1.* 
 from Donates d1
       inner join Donates d2
        on  d1.donors = d2.donors
        and trunc(d1.giftdate) = trunc(d2.giftdate)
        and d1.rowid < d2.rowid
 ;
"
36854,32937,SQL - Derived field in WHERE clause,"SELECT * FROM (...) WHERE ...
"
11238,38202,How do I add values of a row based on two unique identifiers,"SELECT Id, 
       Week, 
       SUM(CONVERT(FLOAT,REPLACE(Time,',','.'))) 
FROM   TimeSheet 
GROUP BY Id, Week
"
39047,16562,SQL Server Updating getting id from another table,"UPDATE coinvdept 
SET code = 'ABC123'
WHERE coinv IN (SELECT coinvid FROM coinv WHERE itemnumber = '12345678')
"
3298,53460,SQL Server check for data being updated,"select max_dt, theType from
datalog d inner join
(SELECT max(theDt) as max_dt FROM dataLog) m
on d.theDt = m.max_dt
"
10788,34018,Access join on first record,"SELECT tblProducts.intID
, tblProducts.strTitle
, (SELECT TOP 1 intGroup 
   FROM tblProductGroups 
   WHERE intProduct=tblProducts.intID 
   ORDER BY intGroup ASC) AS intGroup
FROM tblProducts 
WHERE tblProducts.blnActive 
ORDER BY tblProducts.intSort ASC, tblProducts.curPrice ASC
"
8295,12571,SQL: Duplicating data under a separate header,"SELECT ""A/B Shovels"" AS Example, Sum(Duration) AS Duration
FROM status_code
WHERE Example in (""ShovelA"", ""ShovelB"")
UNION
SELECT ""All Shovels"" AS Example, Sum(Duration) AS Duration
FROM status_code
"
35802,8315,Compare two tables and insert the matching content to another table,"INSERT INTO T3
SELECT T2.name, T2.letter, T2.number
FROM T2
    INNER JOIN T1
    ON T2.letter = T1.letter
    AND T2.number = T1.number;
"
9215,8014,Grouping of data,"select name, max(initial) as initial, max(followup) as followup
from t
group by name;
"
33827,59531,SQL join on multiple Rows to Single row,"with myphones
AS
(
    SELECT CustomerId, Phone1 As Phone FROM ContactDetails
    UNION
    SELECT CustomerId, Phone2 As Phone FROM ContactDetails
    UNION
    SELECT CustomerId, Phone3 As Phone FROM ContactDetails
    UNION
    SELECT CustomerId, Phone4 As Phone FROM ContactDetails
)
SELECT p.CustomerId, p.Phone, oc.*
FROM myphones p 
    INNER JOIN outboundcalls oc ON p.Phone = oc.Phone
"
11917,38778,Filter a table with column values represented as rows,"select *
from yourtable
where isnumeric(value) = 1
  and id in (select id from yourtable where value = 'mf')
"
18251,10001,How can one iterate over stored procedure results from within another stored procedure....without cursors?,"CREATE TABLE #t (uniqueid int)
INSERT INTO #t EXEC p_YourStoredProc

UPDATE TargetTable 
SET a.FlagColumn = 1
FROM TargetTable a JOIN #t b 
    ON a.uniqueid = b.uniqueid

DROP TABLE #t
"
10189,37638,count duplicate column values in one row,"select if(col1=col1,1,0) + if(col2=col1,1,0) + if(col3=col1,1,0) as col1values -- col1 is needle
from table
"
13501,46316,Oracle naming not null constraints?,"create table table1(column1 number constraint column1_not_null not null);
"
24783,51296,SQL Date Format,"SELECT DATENAME(dw,GETDATE()) + ', ' + DATENAME(MM, GETDATE()) + ', ' + CAST(DAY(GETDATE()) AS VARCHAR(2)) + ' ' + CAST(YEAR(GETDATE()) AS VARCHAR(4))
"
18098,74354,"SQL - Return A when B is exactly x,y,z","select A
from t
group by A
having sum(case when B = 'A' then 1 else 0 end) > 0 and
       sum(case when B = 'B' then 1 else 0 end) > 0 and
       sum(case when B not in ('A', 'B') then 1 else 0 end) = 0;
"
700,30807,Terribly slow SQL query with COUNT and GROUP BY on two columns,"SELECT user_id, max(user_name), count(*)
FROM posts
GROUP BY user_id
"
28859,41116,help with bucket data count sql,"SELECT sum(yes),sum(no),BMM, BYYYY, DMM, DYYYY FROM (
    SELECT   SUM(  CASE WHEN [insreported] IS NULL THEN 0 WHEN [insreported] = 'YES' THEN 1 ELSE 0 END ) as yes,  SUM(  CASE WHEN [insreported] IS NULL THEN 1 WHEN [insreported] = 'YES' THEN 0 ELSE 1 END )as no, USERID, BMM, BYYYY, DMM, DYYYY
       FROM dbo.agent_insurance_incentive_data
       GROUP BY USERID, BMM, BYYYY, DMM, DYYYY 
    ) derived
GROUP BY BMM, BYYYY, DMM, DYYYY
"
13602,41860,Sum of calculated field,"SELECT t1.a, t2.d*t2.f AS m, SUM(t2.d*t2.f)
FROM table1 AS t1, table2 AS t2 
WHERE t1.a=t2.a GROUP BY t1.b
"
24467,20402,SQL Query Help (Joining two tables),"select ratings.userID, ratings.movieId, info.imdbId, ratings.rating from
ratings inner join info on ratings.movieId = info.movieId
"
36874,62264,How to convert the time difference to hours(with 2 decimal place) in derby?,"select {fn timestampdiff(SQL_TSI_MINUTE, startdate, enddate)}/60 as diff 
"
1511,45287,Displaying values one above the other instead of in the same line which belong to the same row,"SELECT U.TeamID, TD.Team_Name
FROM Match_Schedule
UNPIVOT (TeamID FOR TeamName IN (HomeTeam, AwayTeam)) U
JOIN Team_Detail TD ON U.TeamID = TD.Serno
WHERE Match_Serno = 436
"
37699,64292,Normalizing and composite table structure,"create table employees(employee_id, ..., primary key(employee_id));
create table departments(department_id, ..., primary key(department_id));
create table works_in(
  employee_id, 
  department_id, 
  primary key(employee_id, department_id),
  foreign key(employee_id) references employees(employee_id),
  foreign key(department_id) references departments(department_id)
);
/* Add column datatypes as needed */
"
20960,70746,Help with sql join,"SELECT
    Table1.PersonCode, Table1.Name, Table2.Location, MAX(Table2.ServiceDate)
FROM
    Table1 
    INNER JOIN Table2 on Table1.ID = Table2.Table1ID 
WHERE
    TABLE1.PersonCode = 'XYZ'
GROUP BY
    Table1.PersonCode,Table1.Name, Table2.Location
"
9234,73345,How to select rows with column containing provided values,"SELECT * 
FROM TableName T 
WHERE EXISTS ( SELECT 1 
               FROM TableName
               WHERE T.Col1 = Col1 
                AND  Col3 = 'Aa')
"
29977,8472,INSERT INTO: Reference another field in VALUES statement,"INSERT INTO Exhibitions (ex_eName, ex_eDescription, ex_eDateStart, ex_eDateEnd)
    SELECT 'exhibition name', 'exhibition description', datestart,
           dateStart + interval '5 months'
    FROM . . .;
"
20404,23448,With MySQL how to distinguish between a NULL value and a non-existent value,"SELECT
    m.Id, m.column1,
    CASE WHEN s.Id IS NULL 
             THEN 'Not Exists'
         WHEN s.column2 IS NULL
             THEN 'Null Value'
         ELSE s.column2
    END AS column2
FROM 
    mainTable AS m
  LEFT JOIN
    secondTable As s
      ON s.Id = m.Id ;
"
36958,49353,Is it possible to create a derived table with no rows?,"USING (SELECT 1 as 'key', 1 as 'val' where 1 = 0) AS src (key, val)
"
13648,3206,MySQL right outer join query,"select records.name, records.datefield, IFNULL(salesRep.customersServed,0)
from (
         select employeeId, name, datefield 
         from `SALES_REPRESENTATIVE`, fridays
         where fridays.datefield between '2014-10-01' and '2014-12-31'
         and employeeId in (...)
    ) as records 
    left outer join `Sales_Data` salesData on (salesData.employeeId = records.employeeId and salesData.reportDate = records.datefield)
   order by records.name, records.datefield
"
27127,49228,"INSERT into another table, and then DELETE from the source table","WITH  q AS
        (
        SELECT TOP 18 *
        FROM    pippo
        ORDER BY FIELD1 ASC /* You may want to add ORDER BY here */
        )
DELETE
FROM    q
OUTPUT DELETED.* INTO TableNew
"
34402,37760,How to Select rows based on two columns,"SELECT ID FROM Table WHERE Page = 1 OR (Page = 2 AND Weight <= 1)
"
9683,16868,How to remove xml nodes without attribute in Sql Server,"DECLARE @xml XML = '....'
SET @xml.modify('delete //root/*[not(@ln)]')
"
24907,22143,how to retrieve data from database monthly based on date if data not available it should display null,"select  Years,number as Month,isnull(Total,0) as Total
from(
    select number 
    from master..spt_values 
    where type='P' 
    and number between 1 and 12) seq
cross join (select distinct Year([date]) as Years from Table1) y
left join
    (select Year([date])as Year,month([date])as Month,sum(total) as Total
     from Table1 
     group by  Year([date]),month([date]))t
on seq.number=t.Month
and t.year=y.Years            
"
14174,13514,Derived Column FindString Error,"FINDSTRING(Column_A,""Sewage"",1) > 0 ? 
    SUBSTRING(Column_A, 1, FINDSTRING(Column_A,""Sewage"",1) - 1) + ""SD"" : 
    Column_A
"
5817,1340,MS SQL locking for update,"USE databaseName;
GO
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
GO
BEGIN TRANSACTION;
GO
SELECT * 
    FROM Table1;
GO
SELECT * 
    FROM Table2;
GO
COMMIT TRANSACTION;
GO
"
35952,73778,Determine the specific field that is not equal in sql,"SELECT a.Id , 
       case when a.Name is null then 1
       when a.Number is null then 2
       when a.Floor is null and a.Door is null and a.Zip is null then 3
       when a.Number is not null and a. Floor is not null and a.Door is not null and a.Zip is not null then 0 end as Reason
FROM dbo.[Address] a left join dbo.Item u
       on a.Name = u.Name 
       or a.Number = u.Number
       or a.Door = u.Door 
where  u.ItemId = @id;
"
2841,27110,MySQL - Inner join with WHERE clause,"SELECT `course`.`id`, `course`.`name`  FROM `course` 
INNER JOIN `course_flags`
     ON `course` .`id` = `course_flags`.`course_id` 
     AND (`course_flags`.`flags_id` = 1 OR `course_flags`.`flags_id` = 2)
WHERE 
GROUP BY (course.id)
HAVING COUNT(DISTINCT course_flags.id) = 2;
"
32933,38852,Order By Count (someRecord),"SELECT   full_name, server_name, COUNT(directory)
FROM     some_table
GROUP BY full_name, server_name
ORDER BY 3 DESC
"
330,15189,SQL FOREACH LOOP Syntax,"select unitID, count(*) countSignals
from   signal_table
group by unitID
order by unitID
"
35915,46494,How do you enforce unique across 2 tables in SQL Server,"CREATE TABLE Emp(EPID INT PRIMARY KEY,
    t CHAR(2) NOT NULL, UNIQUE (EPID,t));

CREATE TABLE EmpFT(EPID INT PRIMARY KEY, ... other columns
    t CHAR(2) NOT NULL CHECK (t = 'FT'),
    FOREIGN KEY (EPID,t) REFERENCES Emp (EPID,t));

CREATE TABLE EmpPT(EPID INT PRIMARY KEY, ... other columns
    t CHAR(2) NOT NULL CHECK (t = 'PT'),
    FOREIGN KEY (EPID,t) REFERENCES Emp (EPID,t));
"
7058,2636,TSQL query that would return me the earliest date and the latest date in a table,"SELECT 
       MIN(DateAdded) As FirstDate,
       MAX(DateAdded) As LastDate
FROM
       News;
"
1202,32107,"MySQL: Large table, slow queries, and indexes","SELECT *
FROM my_table
WHERE data_type = 'TXT' and id < 40000
"
19203,34129,order by with distinct name,"select DISTINCT PageOrderID,PageName from ScreenMaster
order by PageOrderID 
"
8620,22062,Oracle Query TermDates Unique results,"select * from
(select t.*, rank() over (partition by RecordID order by TermDate desc) rn
 from MyTable T)
where TermDate is NULL or rn = 1
"
6206,3516,Selecting the frequency of a result that could appear in multiple columns (SQL),"SELECT name, COUNT(1)
  FROM (           SELECT name_1 AS name FROM mytable
         UNION ALL SELECT name_2 AS name FROM mytable
         UNION ALL SELECT name_3 AS name FROM mytable
         UNION ALL SELECT name_4 AS name FROM mytable
         UNION ALL SELECT name_5 AS name FROM mytable
       ) AS myunion
 GROUP BY name
 ORDER BY COUNT(1) DESC LIMIT 6
;
"
15708,25044,PostgreSQL: Get all numbers in a list that were not present in another list,"with a (id) as (values
    (1),(2),(5),(6),(8),(12),(15)
), b (id) as (values
    (1),(3),(7),(8),(15)
)
select id from a
except all
select id from b
;
 id 
----
  6
  5
 12
  2
"
10890,31901,PostgreSQL indices- are these redundant?,"CREATE INDEX alias_pub_idx2
  ON info.palias
  USING btree
  (publisher_id, player_id, pub_player_id);

CREATE INDEX alias_pub_idx3
  ON info.palias
  USING btree
  (publisher_id); /* first column of another index => waste of space */
"
3147,38076,Mathematical Function within Sql Case Statement,"DECLARE 
@Mileage NVARCHAR(75) = NULL,
@IsMiles BIT = 1,
@Converted NVARCHAR(75) = NULL

select a.* from 
(SELECT [Id],Odometer,IsMiles,
CASE when IsMiles=0 THEN OdometerValue * 0.62137 else Odometer end as ConvertedOdometer 
FROM [dbo].[Vehicle]
where IsMiles = 0)a
where a.ConvertedOdometer >=0 AND 
a.ConvertedOdometer <= @Mileage
"
5622,19354,SELECT ... INTO Understanding its behavior,"$sql = $mysqli->query(""SELECT * FROM tbl WHERE id='1'"");
if(!$sql->error)
  $number_of_rows = $sql->num_rows; // for sure it will output 1
"
32481,18742,Creating table with T-SQL - can't see created tables in Object explorer,"USE TestDB
GO

Create Table ....
"
39509,70021,Drop all sequences SqlAlchemy,"engine = create_engine('postgresql://user:password@localhost:5432/test', echo=True)
Base.metadata.drop_all(bind=engine)
"
17387,14025,"Sql help, function parses a string field in table, need to filter returned table in where clause","WHERE String_Finder(Log_Table.Message, 1, 2) NOT LIKE 'NO_TYPE'
"
24105,36162,mysql join on date where one table's date is a month before,"select t1.date_1, (t1.count_1 / t2.count_2) as percent_before
from table1 t1 join
     table2 t2
     on t1.date_1 = (t2.date_2 - interval 1 month);
"
24107,11584,Oracle Stored Procedure Returning Table Structure to PowerShell,"CREATE OR REPLACE PROCEDURE sp_test1( p_cursor OUT SYS_REFCURSOR )
AS
BEGIN
  OPEN p_cursor
   FOR SELECT id, test1, test3
         FROM test_table;
END;
"
16205,66110,Selecting timestamp records in postgres,"CREATE TABLE test AS SELECT TIMESTAMP WITH TIME ZONE '2012-07-30 07:00:00-07' AS tstamp;

SELECT tstamp FROM test WHERE extract(hour from tstamp) > 0;
"
11296,35985,Sum with expression and group by in Access 2007 / VBA,"UPDATE mt
SET rc='DAR'
WHERE  Account IN
(
  SELECT mt.account
  FROM 
    (
    SELECT mt.Account, SUM(mt.[amount]+Nz(mt.[SFS],0)) as total
    FROM mt
    GROUP BY mt.Account
    )    
  WHERE total>=500
);
"
8448,597,SQL WHERE clauses not working,"WHERE (a.campaign_name__c like '%demo%' OR a.campaign_name__c like '%contact%')
and cast(a.firstrespondeddate as date) <> '7/14/2015'
and b.status = 'New' 
and a.contactid is null
and a.leadid is not null
"
17673,61923,How to strip time from datetime column,"SELECT dtvisit1, dtvisit2
FROM Visit
WHERE CONVERT(nvarchar(20), [dtvisit1], 101)  = CONVERT(nvarchar(20), [dtvisit2], 101)
"
15465,18503,Insert while updating a column with a single value in MySQL?,"INSERT INTO newTable (col1, col2, col3) 
SELECT col1, col2,'1984' 
FROM otherTable
"
37578,73660,Convert Minutes in HH:MM in SQL-Server 2008R2,"select cast(minutescol/60 as varchar(100)) + ':' + 
replicate('0', 2-len(minutescol%60)) + cast(minutescol%60 as varchar(100))
"
12423,68269,"What does < variable, variable > mean?","WHERE OBJECTNAME = 'example' 
  AND time > validdate 
  AND validtime < date;
"
17498,61198,TSQL - Query to get count of items associated to each category and subcategory,"SELECT  c.CategoryID
,       c.ParentID
,       c.Text
,       count(distinct i.ItemID)
FROM    Categories c
LEFT JOIN
        Categories c2
ON      c.CategoryID = c2.ParentID
LEFT JOIN    
        Items i
ON      i.CategoryID = c.CategoryID
        or i.CategoryID = c2.CategoryID
GROUP BY
        c.CategoryID
,       c.ParentID
,       c.Text
"
19644,67258,SQL query to return only one lowest price per location from result set,"select r.loc, r.total, r.code
from (select r.*,
             row_number() over (partition by loc order by total desc, code desc) as seqnum
      from @results r
     ) r
where seqnum = 1;
"
25,49966,SQL adding value at every comma separation,"DECLARE @queryRWordsSameType VARCHAR(500) = ''
SELECT @queryRWordsSameType += CASE WHEN @queryRWordsSameType <> '' THEN ',' ELSE '' END + 'CAST([' + name + '] AS NVARCHAR(100)) AS [' + name + ']' + CHAR(13) + CHAR(10)
  FROM syscolumns
 WHERE id = object_id('YOUR_TABLE_NAME')
PRINT @queryRWordsSameType
"
27780,12948,Passing string parameters to linked Oracle Server procedures from SQL Server,"DECLARE @userid varchar(50)
SET @userid = 'MyUserId'
EXECUTE ('BEGIN P_CREATE_USER(?); END;', @userid) AT ORACLE_SERVER
"
2735,49263,How to remove everything before a certain character in SQL Server?,"right(MyColumn, len(MyColumn) - charindex('-', MyColumn))
"
6441,53733,SQL query from multiple columns with prepared statement,"SELECT * FROM contacts WHERE firstName LIKE ? OR lastName LIKE ? OR email LIKE ?
"
29472,32423,Pagination sql query,"Select Top (@PageSize) * 
From Tree
ORDER BY /*TODO: Add column(s)*/
"
31170,11938,Combining different tables in excel by looking up values,"SELECT table1.Client_Name, table2.Client_Info
FROM table1
RIGHT JOIN table2 ON table1.ID_Number = table2.ID_Number
"
28010,56543,Could not connect to database postgres pg_hba (OSX),"$ sudo su
# su postgres -c 'createuser msf -P -h localhost'
"
2424,65271,Best way to store large dataset in SQL Server?,"KeyWords
----------
KeyWordId Int Identity(1,1)
KeyWord VarChar(200)

KeyFieldKeyWords
----------------
Keyfield Int
KeyWordId Int
"
25988,15397,How to use a sql table-valued parameter to filter results?,"create procedure [dbo].[usp_RecipientsSendCheck]
(
    @Type int,
    @RecipientsImports dbo.RecipientsImport READONLY
)
as
begin
    select i.Name
    from @RecipientsImports as i
        left outer join Recipients as r on r.Name = i.Name
        left outer join SendResults as s on s.RecipientId = r.id and s.[Type] = @Type
    where
        r.Name is null or
        s.id is not null
end
"
1215,50911,How can I list all foreign keys referencing a given table in SQL Server?,"EXEC sp_fkeys 'TableName'
"
35036,2057,Selecting column and max,"SELECT   TOP 1 codhospital, COUNT(codmedic) 
FROM     Medic_Hospital
GROUP BY codhospital
ORDER BY 2 DESC
"
1171,60355,SQL: Cleansing dates from OCR'ed documents,"STUFF(STUFF (DateString , 3, 1, '/'), 6, 1, '/')
"
37950,17239,sql to combine two unrelated tables into one,"WITH CTE1 AS
(
    SELECT ROW_NUMBER() OVER(ORDER BY col1) AS ROWNUM, * FROM Table1
),
CTE2 AS
(
    SELECT ROW_NUMBER() OVER (ORDER BY mycol1) AS ROWNUM, * FROM Table2
)
SELECT col1, col2, mycol1, mycol2
FROM CTE1 FULL JOIN CTE2 ON CTE1.ROWNUM = CTE2.ROWNUM
"
37636,57088,"how to use a string that contain ' in SQL ""IN"" clause","select * from tbl_fruit where nm_fruit IN ('Apple''s', 'Orange')
"
20495,20186,How do I make sure there are no duplicates in a mysql table?,"ALTER `table_name` ADD UNIQUE (`first_name`,`last_name`);
"
31302,33988,filter postgresql query result,"Group By Name
having sum(money) > 500
"
15359,29877,What is the SQL query for the below condition?,"  SELECT `company_name`, 
         `employee_name`, 
         COUNT(`cid`) 
    FROM `tbl_reports` 
GROUP BY `company_name`,
         `employee_name`;
"
17501,51581,"PLSQL procedure, which gets the dependend package reference as a parameter","create package body pack_common
as
  procedure proc_a (p_proc_to_call varchar2)
  is
    ...
  begin
    ...
    if p_proc = 'PACK_A' then
       pack_a.proc_b;
    elsif p_proc = 'PACK_B' then
       pack_b.proc_b;
    ...
    end if;
    ...
  end proc_a;
end pack_common;
/
"
33127,48484,MySQL large table performance issues when paging with PHP,"SELECT *
FROM mytable
WHERE field BETWEEN 250000 and 250100
"
31860,5055,Adding Punctuation Marks in SQL,"SELECT 'Frank''s Oracle site' AS text FROM DUAL;
"
17667,25290,3rd Nested Mysql Select Query Causes Huge Performance Issues,"SELECT ccp.*
FROM catalog_category_product ccp
    INNER JOIN sales_flat_order_item sfoi ON ccp.product_id = sfoi.product_id
    INNER JOIN sales_flat_order sfo ON sfoi.order_id = sfo.entity_id
WHERE sfoi.product_type = 'configurable'
    AND sfo.customer_id = 12657
    AND sfo.state = 'complete';
"
15271,56137,Substring-indexing in Oracle,"create index ix_substring on TABLE (substr(COLUMN, 4, 9))
"
9471,27196,"Retrieveing Day, Month and Year separately from Date","DECLARE @yourDate DATETIME
SET @yourDate = '2012-05-22'

SELECT DATEPART(DAY, @yourDate), 
       DATEPART(MONTH, @yourDate),
       DATEPART(YEAR, @yourDate)
"
27559,33990,SQL Select all records where unique composite key,"SELECT
   foo, bar, baz, MIN(gif), MIN(xyz)
FROM
   MyTable
GROUP BY
   foo, bar, baz
"
33967,70800,sql lists out all foreign keys of a primary key,"select ku.* 
from INFORMATION_SCHEMA.table_constraints tc   
INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE ku ON
(tc.CONSTRAINT_NAME = ku.CONSTRAINT_NAME and tc.CONSTRAINT_SCHEMA =   
ku.CONSTRAINT_SCHEMA )
where constraint_type='FOREIGN KEY' and ku.REFERENCED_TABLE_NAME =     
'your_table_name'
"
17423,43624,Informix timestamps in Oracle (via ODBC),"SQL> select sysdate from dual;

SYSDATE
-----------
05/10/2009

SQL> select to_char(sysdate, 'hh24:mi') from dual;

TO_CHAR(SYSDATE,'HH24:MI')
--------------------------
13:55
"
11325,21364,SQL: Convert Date to Null when Date is certian range from Today,"update test_table
    set dte = (case when add_months(dte, -12) < sysdate then dte end);
"
29288,18020,MySQL get only results which are not in other table,"select
s.StudentID from student s
left join studentgroup sg on sg.StudentID = s.StudentID
where sg.StudentID is null
"
31446,20546,linq comparing two lists of ids?,"var result = from pub in pubs
             where pub.PubFeatures.Select(item => pubFeatures.Contains(item.id))
             select pub
"
13885,4554,How to ignore csv fields in phpmyadmin import,"LOAD DATA INFILE 'file.csv'
INTO TABLE t1
(column1, @var1)
"
21006,31674,How can I eliminate the subquery to simplify my query?,"SELECT DISTINCT t1.extension
    , IFNULL(t2.status, t1.status) AS status
    , IFNULL(t2.systemid, t1.systemid) AS systemid
FROM pbx AS t1 
    LEFT OUTER JOIN
    pbx AS t2
    ON t1.extension = t2.extension
        AND t2.status = 'OK'
GROUP BY t1.extension, t2.status
ORDER BY t1.extension
"
5822,41831,Postgresql: Searching within arrays for an arbitrary number of inputs,"SELECT * FROM users WHERE array['Wood','Doe'] <@ fullname;
"
15217,71922,Select rows in master table which have NO join in subtable,"SELECT * FROM result WHERE NOT EXISTS
(SELECT 1 FROM confirmation WHERE confirmation.result_id = result.result_id)
"
37427,9106,Select greater than ORACLE,"SELECT DISTINCT COUNT(*) AS NO_RESERVATIONS, HG.RESV_ID, HR.BOOKING_CUS_ID AS BOOKED_BY, C.CUS_NAME
FROM HOLIDAY_RESERVATION HR INNER JOIN(HOLIDAY_GROUP HG INNER JOIN CUSTOMER C
ON HG.CUS_ID = C.CUS_ID)
ON HR.BOOKING_CUS_ID = HG.CUS_ID
WHERE HR.RESV_ID >= 2
GROUP BY HG.RESV_ID, HR.BOOKING_CUS_ID, C.CUS_NAME
HAVING count(*) > 1;
"
7526,6516,Select randomly And Sort the records,"SELECT ID,name,level
FROM sample
ORDER BY level DESC,NEWID()
"
20048,47883,Retrieving XML into Oracle table,"your_xml := XMLType('<emp Id=""1""><first>Peter</first><last>Fox</last></emp>');

insert into emp (empid, first_name, last_name)
select EXTRACTVALUE(your_xml, '/@Id'), EXTRACTVALUE(your_xml, '/first'), EXTRACTVALUE(your_xml, '/last') 
from dual;
"
28443,14879,Database paid users and trial users in same table,"select u.*
from (User as u
      join Paiduser as p on u.id<>p.user_id)
"
25295,39646,SQL JOIN a table and GROUP BY to get correct row,"FROM forum_topics
JOIN forum_replies ON forum_replies.topic = forum_topics.id
JOIN users usertopic ON forum_topics.createdby = usertopic.id
JOIN users userreplie ON forum_replies.createdby = userreplie.id
JOIN (select topic, max(created) as maxcreated
      from forum_replies
      group by topic
     ) frmax on frmax.topic = forum_replies.topic and
                frmax.maxcreated = forum_replies.created;
"
21353,27661,Copy data table to table with a where clause,"INSERT INTO table1 
SELECT * FROM table2
WHERE TIMESTAM > (select MAX(TIMESTAM) FROM table1);
"
18365,10629,Need a Creative Sql Query :: HELP,"Select id
, Sum(Case when Type='Link' then 1 else 0 end) as Links
, Sum(Case when Type='Forms' then 1 else 0 end) as Forms
, Sum(Case when Type='Page' then 1 else 0 end) as Pages
From SomeTable
Group by ID
"
34040,46576,Using DATEDIFF in WHERE clause Condition,"WHERE [fld_DateResolved] <= DATEADD(Day, -3, CAST(GETDATE() as Date))
"
20715,13724,Using Join to parse out duplicate data,"   SELECT c.Name,c.Email 
   FROM Users c  LEFT JOIN Email e ON (c.email=e.email)
   WHERE (e.email is null) and (c.subscribed=1)
"
23421,48167,how to update all rows of a specified data group in SQL server based on a condition?,"UPDATE MyTable
SET IsConsideredNewHire = 0
WHERE ControlGroupID IN (SELECT DISTINCT ControlGroupID 
                         FROM MyTable
                         WHERE IsConsideredNewHire=0)
"
24308,1754,"About randomly selecting some rows from a table, then taking the average","CREATE TABLE output (Selection INT, Avg_Height FLOAT)
GO
DECLARE @intFlag INT
SET @intFlag = 1
WHILE (@intFlag <=5)
BEGIN

    WITH cte AS (SELECT TOP 4 *
                 FROM Table1
                 ORDER BY NEWID())
    INSERT INTO output
    SELECT @intFlag, AVG(Height*1.0)
    FROM cte

SET @intFlag = @intFlag + 1
END
GO
"
13490,34133,SQL Server - Constructing a Column Definition,"select table_name, column_name,
column_definition = data_type + isnull('(' + convert(varchar, character_maximum_length) + ')', '') 
from information_schema.columns
"
33010,65379,Accent and case insensitive COLLATE equivalent in Oracle,"SELECT *
FROM MyTable
WHERE NLSSORT(MyField, 'NLS_SORT = Latin_CI') = NLSSORT('BobDillon', 'NLS_SORT = Latin_CI')
"
19494,2791,Checking for date range conflicts with Access,"SELECT *
FROM Bookings
WHERE CarID = 7
AND StartDate < user_end_date
AND EndDate > user_start_date
"
9376,59968,How to sort in a different way,"SELECT * FROM countries
ORDER BY title='Italy' DESC, title
"
29699,53081,Doing calculation on SQL count() value,"SELECT InShelf, free - InShelf
FROM (
    SELECT count(*) AS Inshelf, free
    FROM stockproduct
    WHERE StockNum = 1 AND checkOutData IS NULL
    GROUP BY somefield
) AS a
"
22061,30064,MSSQL Cursor for huge tables cannot allocate space,"WHERE
    MD2.iBatchNumber = @iBatchNumber
ORDER BY
    MD2.sTableName, MD2.iRowIndex
"
2911,15060,SQL IF NULL From SELECT statement,"IF (SELECT NULL) IS NULL
    PRINT 1
ELSE
    PRINT 2
"
18170,40444,mysql create user only when the user doesn't exist,"GRANT ALL PRIVILEGES  ON db_name.* 
TO 'user'@'%' IDENTIFIED BY 'password' 
WITH GRANT OPTION;
"
5172,3645,How To Use The Where & Like Operator Together in SQL?,"SELECT firstname, lastname, state
FROM instructors
WHERE state = 'ga'
AND lastname LIKE '*son*'
"
26692,14428,Setting Up SqlConnection string in vb.net for a local database created through visual studio 2010," Private sqlConn As New SqlConnection(""Data Source=(local)|DataDirectory|\Outcomes.sdf;database=Outcomes;Integrated Security=true"")
"
31921,38204,Multiple group by query,"select t1.ItemNumber,t1.CountRows,t2.CountTest
from TableA t1, TableB t2
WHERE t1.ItemNumber=t2.ItemNumber
"
35156,22744,"mysql, include the first child in parent","SELECT a.id_album, a.name, count(p.id_photo) AS photos, p.id_photo, p.image 
FROM album a
LEFT JOIN photo p ON a.id_album = p.album 
GROUP BY a.id_album 
HAVING photos > 0;
"
8072,30290,SQL Server : CASE when any of 10 columns agree,"WHEN t1.item1 IN (T2.item1, T2.item2, T2.item3)
"
1302,8893,Generating tag cloud count given these 3 tables,"SELECT dbo.AlbumTags.Tag_Name, 
       COUNT(dbo.AlbumTagBridge.Tag_Id) AS Cnt
FROM dbo.AlbumTagBridge 
INNER JOIN dbo.AlbumTags ON dbo.AlbumTagBridge.Tag_Id = dbo.AlbumTags.Tag_ID
GROUP BY dbo.AlbumTags.Tag_Name
"
735,2586,SQL Group with Order by,"SELECT  Category
FROM    Article
GROUP BY
        Category
ORDER BY
        MAX(DatePublished) DESC
"
31451,45166,"Question for Conflict in insertion of data in DB by user and admin, see below for description","User finds record
Application stores (hash of) record in memory
User modifies copy of record
User instructs application to write record to database
Application retrieves current database state, compares to original
If identical
     write change to database
If not identical 
     notify user
"
25556,42084,Determine CaseSensitive in WHERE clause,"SELECT * FROM myTable
WHERE myColumn = 'New'
AND BINARY(myColumn) = BINARY('New');
"
30699,9017,How to get the First and Last record,";With CTE
AS (
    SELECT [DATE],DriverId, CodeId,
          , ROW_NUMBER() OVER (ORDER BY [DATE] ASC) rn_Stop
          , ROW_NUMBER() OVER (ORDER BY [DATE] DESC) rn_Go
    FROM Table_Name
   )
DELETE FROM CTE
WHERE 
      (rn_Stop = 1 AND CodeId = 23)
OR  
      (rn_Go   = 1 AND CodeId = 22)
"
1804,71637,Calculating record size include field have 4B real number,"Name (30B) 30
SSN (9B) 9
Dept (9B) 3
Address (40B) 40
Phone (9B) 9
Birthdate (8B) 8
SEX (1B) 1
Jobcode (4B) 4
Salary (4B, real number) 4 + 4
Calculate 1
"
37913,49920,Display NULL instead of zero,"select case when your_column = '0.0000' then null
            else your_column
       end as your_column
from your_table
"
33837,8166,SQL query to find resource containing more than one tag,"select t.MD5, r.Title, r.Link, t.Category
from Resource r inner join Tags t on r.MD5 = t.MD5
where exists (select category from Tags t1 where category = @tag and t1.MD5 = r.MD5)
and exists (select category from Tags t1 where category = @tag2 and t1.MD5 = r.MD5)
"
18621,46112,find second highest from each group in sql?,"SELECT encounterID, dateAndTime
FROM (
  SELECT encounterID, dateAndTime,
         @rn := IF(@eID = encounterID, @rn + 1,
                   IF(@eID := encounterID, 1, 1)) AS rn
  FROM mytable
  CROSS JOIN (SELECT @rn := 0, @eID := 0) AS vars
  ORDER BY encounterID, dateAndTime DESC) AS t
WHERE t.rn = 2
"
25748,19998,cross joining two tables,"SELECT S.boardid, S.schoolid, A.[subject], B.cnt1, B.cnt2, B.cnt3
FROM (SELECT DISTINCT boardid, schoolid FROM YourTable) S
CROSS JOIN #A A
LEFT JOIN YourTable B
    ON B.boardid = S.boardid AND  B.schoolid = S.schoolid 
    AND A.[subject] = B.[subject]
"
21541,45194,Fetch data from more then 5 tables from UserID common in MySQL,"SELECT
    columnName
FROM
(
    SELECT userID, columnName FROM tblcategory1
    UNION ALL
    SELECT userID, columnName FROM tblcategory2
    UNION ALL
    SELECT userID, columnName FROM tblcategory3
    UNION ALL
    SELECT userID, columnName FROM tblcategory4
    UNION ALL
    SELECT userID, columnName FROM tblcategory5
)
   ilvCategoryAll
WHERE
   userID = 1
"
36038,1014,Handling null values with join across multiple tables,"SELECT  tblCounty.ID, 
    ISNULL(tblAddress.Code, 'none')
    --Whatever you want to select
FROM tblCounty
LEFT JOIN tblCode ON tblCounty.Name = tblCode.Name
    LEFT JOIN tblAddres ON ISNULL(tblCode.Code, 'none') = ISNULL(tblAddress.Code, 'none')
"
8811,12124,Counting a cell up per Objects,"Insert Into My_Test (My_Id,My_Num,My_Data)
SELECT my_Id,(
    SELECT MAX(NVL(My_Num,0)) + 1     
    From My_Test 
    where my_id = b.my_id
  )
,My_Data
From My_Test2 B
where my_id = <your id>;
"
1233,96,Grouping by MONTH in SQL,"select MONTH(DATE) As ""Month""
from DW******.SL****
Group By MONTH(DATE)
Order by MONTH(DATE)
"
36263,26310,MySQL percentage (a bit complex?),"  SELECT x.movieid,
         x.score,
         COUNT(x.userid) / y.score_count  AS percentage
    FROM YOUR_TABLE x
    JOIN (SELECT t.movieid,
                 COUNT(t.score) AS score_count
            FROM YOUR_TABLE t
        GROUP BY t.movieid) y ON y.movieid = x.movieid
GROUP BY x.movieid, x.score
"
88,71220,Check if character column contains numeric value in DB/2 with sql," SELECT        *
 FROM           tab e, tab n
 WHERE        (e.LN = 0001) AND  (n.RMK LIKE CONCAT(RTRIM(CONCAT('%', CHAR(e.ORDNO))), '%'))
"
37414,43750,SELECT SUM returns a row when there are no records,"select my_sum
from
(SELECT SUM(dummy) as my_sum FROM DUAL WHERE 1=2)
where
my_sum is not null
"
30999,29634,merge 2 identical tables rows,"SELECT id, total, 'OK' as status
FROM First_Table
UNION ALL
SELECT id, total, 'CANCEL' as status
FROM Second_Table
"
23658,4973,How to aggregate related object counts in a view effectively?,"CREATE TRIGGER product_increase_likes AFTER INSERT ON Likes
    FOR EACH ROW BEGIN
        UPDATE Products SET likes_count=likes_count+1 WHERE id=NEW.product_id
    END;

CREATE TRIGGER product_decrease_likes AFTER DELETE ON Likes
    FOR EACH ROW BEGIN
        UPDATE Products SET likes_count=likes_count-1 WHERE id=OLD.product_id
    END;
"
4354,75114,Logic in stored procedure,"declare @DisAvg float
declare @DelAvg float

-- Instantiate #PV etc

select
  @DisAvg = avg(Dis) / 8,
  @DelAvg = avg(Del)
from
  #PV

if @DisAvg > 20
  return
else
  -- Do something else
"
2808,71213,How to get the columns from three different tables?,"SELECT 
mg.go_id,
mm.mirna ,
g.go_id , 
g.category, 
g.evidence, 
g.term , 
mg.MSU7_LOC 
FROM  mirna_mrna mm
inner join  mrna_go mg on mg.MSU7_LOC = mm.MSU7_LOC 
inner join  gene_ontology g  on mg.go_id = g.go_id 
where mg.go_id in ('GO:0009058') ;
"
39307,53090,Modifying hyphenated data with r,"x <- c('11111-111-11', '11111-1111-1', '1111-1111-11')
y <- strsplit(x, '-')
myfun <- function(y) {
  first <- sprintf('%05d', as.integer(y[1]))
  second <- sprintf('%04d', as.integer(y[2]))
  third <- sprintf('%02d', as.integer(y[3]))

  paste(first, second, third, sep='-')
}

sapply(y, myfun)
# [1] ""11111-0111-11"" ""11111-1111-01"" ""01111-1111-11""
"
13702,48132,"Two tables with linking column ""id"" that return only unique ""id"" lines for the parent table","SELECT T.*, P.* 
FROM Threads 
INNER JOIN POSTS P ON T.id = P.id 
WHERE ((T.subject LIKE '%blue%') OR (P.post LIKE '%blue%')) 
AND P.Timestamp = (Select min(P2.timestamp) from posts P2 where ID = T.ID) 
ORDER BY P.timestamp
"
38405,10759,MySQL - One SQL request instead two (both request include diffrent COUNT(*),"select product, 
       count(*) as total_count
       sum(
         case when opinion='pos' then 1 
         else 0 end
       ) as pos_count
from the_table
group by product;
"
22465,48761,SQL: How do I return zeroes where there is nothing to aggregate across?,"SELECT TypeIds.TypeId, Genders.Gender, COALESCE(SUM(T1.Count), 0)
FROM (
    SELECT 1 AS TypeId
    UNION ALL
    SELECT 2
    UNION ALL
    SELECT 3
) AS TypeIds
CROSS JOIN (
    SELECT 'M' AS Gender
    UNION ALL
    SELECT 'F'
) AS Genders
LEFT JOIN Table1 AS T1
ON TypeIds.TypeId = T1.TypeId AND Genders.Gender = T1.Gender
GROUP BY TypeIds.TypeId, Genders.Gender
"
24058,50314,update two table when a update table have one more field then first,"insert into B select col1,col2,col3,null from A
"
25505,8979,SQL Grouping by offset date range,"SELECT NAME,YEAR(DATEADD(D, -1, DATE)), MONTH(DATEADD(D, -1, DATE)), SUM(GAIN) Gain_Total
FROM GainTable
GROUP BY Name, YEAR(DATEADD(D, -1, DATE)), MONTH(DATEADD(D, -1, DATE))
"
37890,42919,Using SQL JOINs,"SELECT p.*, l.Country
FROM kal_db.dbo.Player as p
INNER JOIN kal_Auth.dbo.Login as l
ON p.UID = l.UID
"
12101,37021,How to convert oracle resultset to XML in VBScript,"select dbms_xmlgen.getxml( 'select * from emp') from dual
"
37212,39530,"How make sql query ""not in"" more simply use only ""join""?","select a.id from selzde.elorder a
inner join selzde.elorder b on a.name = b.name 
and a.workname = b.workname 
and b.id = needId
left outer join selzde.drugselorder d on a.id = d.id_elorder
where d.id_elorder is null
"
20260,54397,SQL SELECT Query with group and distinct,"select 
  bm, 
  sum(case when act = 'yes' then 1 else 0 end) as ""Count of yes"",
  sum(case when act = 'no'  then 1 else 0 end) as ""Count of no""
from t
group by bm;
"
5607,5802,retrieve result set from a stored Procedure,"IF @FirstOnly=1
BEGIN
   RETURN
END
"
22809,38729,Want to duplicate rows in a SQL view,"select date, beg, end, 'AM' as tod
from reservations r
where beg < '13:00'
union all
select date, beg, end, 'PM' as tod
from reservations r
where end >= '13:00';
"
30488,61916,Separate table for reference or Should I use one table?,"ENUM ( 'MALE' , 'FEMALE') .
"
37477,74624,Extract two many-to-many's in one query,"SELECT n.*, c2.* FROM country c
  JOIN country_news cn
    ON cn.country_id = c.id
  JOIN news n
    ON cn.news_id = n.id
  LEFT JOIN country_news cn2
    ON cn2.news_id = n.id
  LEFT JOIN country c2
    ON cn2.country_id = c2.id
WHERE c.id = 1
"
11568,34416,How to join table with another that have count?,"SELECT p2.*, p1.cnt_typec 
FROM zp01 p2 
JOIN (
  SELECT TYPEC, count(TYPEC) AS cnt_typec 
  FROM planning_cuisson 
  GROUP BY TYPEC 
  HAVING COUNT(TYPEC) > 0
) p1
WHERE p2.type_cuisson = p1.typec 
ORDER BY cnt_typec ASC;
"
25573,8427,Join query with not equal,"SELECT cr.id, cr.type
FROM mydb.customer cr 
LEFT JOIN mydb.plan1 p1
    ON cr.id = p1.id 
LEFT JOIN mydb.plan2 p2
    ON cr.id = p2.id
LEFT JOIN mydb.plan3 p3
    ON cr.id = p3.id
WHERE p1.id IS NULL AND p2.id IS NULL AND p3.id iS NULL AND
    cr.type = 'male'
"
39554,36857,Query to get summary of survey questions answered (distinct column values),"SELECT
    (SUM(happy_or_sad = 'no') / COUNT(*)) * 100 AS percentage_no,
    (SUM(happy_or_sad = 'yes') / COUNT(*)) * 100 AS percentage_yes,
    (SUM(happy_or_sad = 'sometimes') / COUNT(*)) * 100 AS percentage_sometimes,
FROM
    survey_result
"
9833,66797,MySQL InnoDB Global Var?,"START TRANSACTION;
SELECT @m:=MID, sender, receiver, content FROM queue WHERE mutex = 0 ORDER BY MID ASC limit 1 FOR UPDATE; 
UPDATE queue set mutex = -1 WHERE MID = @m;
COMMIT;
"
2197,2259,Oracle SQL 'select' with 1 column having combined values,"select pk_id,col1,col2,col3,
                    LISTAGG (t2.col4, ';') WITHIN GROUP (ORDER BY t2.col4) AS col4
from t1 left join t2 on t1.pk_id=t2.fk_id
group by pk_id, col1, col2, col3;
"
37018,60233,SQL to get distinct records with PK,"select min(id) as id, col1, col2
from Tablex
group by col1, col2
"
15940,19939,Complex SQL query on one table,"SELECT
  competitor_id,
  COUNT(*) AS Matches,
  COUNT(CASE WHEN goals_scored_my_team > goals_scored_comp THEN 1 END) AS Wins,
  COUNT(CASE WHEN goals_scored_my_team < goals_scored_comp THEN 1 END) AS Losses,
  COUNT(CASE WHEN goals_scored_my_team = goals_scored_comp THEN 1 END) AS Draws
FROM matches
GROUP BY
  competitor_id
;
"
19356,63711,How to optimize/replace cursor in SQL?,"SELECT s.StudentId, COUNT(*) AS CreationCount 
FROM Student s
INNER JOIN CreationHist c
    ON c.StudentId = s.StudentId
WHERE c.CreateDate = '05/02/2011'
GROUP BY s.StudentId
"
23612,52469,MySQL Search Between Date and Time,"SELECT catsid,id,dates,times,endtimes,published,title 
  FROM jos_eventlist_events 
  WHERE catsid = 6 AND published = 1
    AND (CONCAT(dates, ' ', times)>= NOW()  
         OR (     CONCAT(dates, ' ', times) < NOW() 
              AND CONCAT(enddates, ' ', endtimes) >= NOW() ) )
  ORDER BY CONCAT(dates, ' ', times)
  LIMIT 1
"
7447,57626,Current timestamp Nhibernate,"item.accpt_date = session.CreateSQLQuery(""select current_timestamp"")
                         .UniqueResult<DateTime>();
"
23170,27695,Update: You can't specify target table 'table' for update in FROM clause,"UPDATE tec_onoff_file a
  LEFT 
  JOIN tec_onoff_file n
    ON b.curracctnbr = a.curracctnbr 
   AND b.emailtype ='RENW'
   SET emailtype = 'REIN'
 WHERE a.transtype = 'REIN'
   AND b.transtype IS NULL;
"
76,43787,SQL group by with a count,"SELECT  company
FROM    tableName
GROUP   BY company, name
HAVING  COUNT(DISTINCT age) <> 1
"
9074,8217,SQL reports how to count number of records that match a certain criteria,"Select Date
    , Sum( Case When Status = 1 Then 1 Else 0 End ) Status1Count
    , Sum( Case When Status = 2 Then 1 Else 0 End ) Status2Count
    , Sum( Case When Status = 3 Then 1 Else 0 End ) Status3Count
From MyTable
Group By Date
"
33562,29772,Do SELECT COUNT from 2 tables in MySQL,"SELECT Count(DISTINCT s.SID) STUDENTCOUNT,
       sd.DEPARTMENT,
       sd.REGISTRATIONDATE,
       Count(CASE
               WHEN ENROLLDATE BETWEEN REGISTRATIONDATE AND REGISTRATIONDATE + 28 THEN 1
             END) StudentInCourseCount
FROM   STUDENT S
       LEFT JOIN COURSE C
         ON S.SID = C.SID
GROUP  BY DEPARTMENT,
          REGISTRATIONDATE 
"
11151,62014,Restrict column with multiple values not appear if one condition is also met," select * from table
 where c3 in(
 select distinct c3 from table
 minus
 select distinct from table where c2 = 'no' )
"
37318,10924,Two ORDER BY clauses and a LIMIT,"SELECT *
FROM (
   SELECT id, names
   FROM items 
   ORDER BY ratings DESC
   LIMIT 10
   ) t
ORDER BY names
"
20755,30751,Looping Horizontal Data and Creating Multiple Records per Column,"INSERT SalesmanDetail
      (SalesmanID, SalesmanName, Account)
SELECT SalesmanID, SalesmanName, Account
FROM dbo.SalesmanAccts
UNPIVOT (Account FOR AccountNumber IN (Account1,Account2,Account3) ) p
"
12138,40027,SQL inserting in to a table more than one row,"insert into HISTORYTEACHES
select '2', course_id, '1', 'Spring', '2016'
from HISTORYCOURSE 
where course_id like '2%'
"
11971,11154,how to write Instead of update? - Trigger,"CREATE TRIGGER IF NOT EXISTS prevent_col_a_change
BEFORE UPDATE OF col_a ON a
BEGIN
    SELECT RAISE(ABORT, 'COL_A must not be changed');
END;
"
23094,6070,"SELECT entry in SQLite, without a WHERE condition?","result = db.rawQuery(""SELECT col FROM tbl"", new String[0]);
"
33480,10084,Using SUBSTR() AND INSTR() find end of string,"aux = substr(string, instr(string, '=') + 1)
"
29424,50427,UPDATE set table with 3 different tables foreign key and primary key,"update employee e
  join department d using (d#)
   set e.d# = 3
 where d.dname = 'SPORTS'; 
"
11425,7623,Access VBA Filtering a combo box list based on Date field,"EquipmentID1.RowSource = _
  ""SELECT tblEquipment.Equipment, tblEquipment.UnavailableFrom "" & _
  ""FROM tblEquipment "" & _
  ""WHERE tblEquipment.UnavailableFrom >= #"" & Me!EndDate & ""# "" & _
    ""OR tblEquipment.UnavailableFrom Is Null;""
"
29979,14113,sql join query to linq syntax,"var results = from rs in db.ratesSchedule
              join ud in db.userdetails on 
                  new { rs.sid, rs.tabletype } equals 
                  new { ud.sid, tabletype = ""d"" }
"
6742,40559,query explode multiple values in one column,"select cc.company_name,group_concat(c.name)
from company_classifications cc 
inner join classifications c 
on c.id = find_in_set(c.id,cc.classifications)
group by cc.company_name;
"
27441,29668,Select query with missing rows or zero values?,"SELECT A.label AS a_label, COALESCE(C.label, 'none') AS c_label
FROM      A
JOIN      B ON B.id = A.B_id
LEFT JOIN C ON C.id = B.C_id;
"
22013,61010,database design for category and sub-category and brand list,"Category:
  Electronics
Subcategory (of Electronics):                Brand:
   Mobile                                      Nokia
   TV                                          Sumsung 
Subcategory_Brand(of Mobile)                    
  Nokia
  Samsung
"
2695,63133,Showing top 10 results in a table (SQL Server),"SELECT TOP 10 ItemID, Itemname, Quantity, Price,
CONVERT(Decimal(8,0),ROUND((Quantity*price),2)) AS Total
FROM Item
ORDER BY Quantity * Price DESC
"
26747,16052,Inserting dates to Oracle database through Zend_Db,"$createdDate = $entry->createdDate->toString('yyyy-MM-dd');
$data = array(
    'ID' => $entry->id,
    'STATE' => $entry->state,        
    'CREATED_DATE' => new Zend_Db_Expr(""date '$createdDate'"")
);
$this->_getGateway()->insert($data);
"
15180,44050,Oracle string aggregation in group by,"SELECT COLUMN1, LISTAGG(COLUMN2, ',') WITHIN GROUP (ORDER BY COLUMN1) AS COLUMN2s
FROM TABLE
GROUP BY COLUMN1;
"
39535,10971,Mysql max value from 3 different columns,"    select id from tablex where GREATEST(column1, column2, column3) > 69
"
21550,47132,OO program and SQL database,"class = > table
instance => row
attribute => column
"
10445,10801,Counting 2 fields while grouping by 1,"SELECT tmpTbl.Agent, 
       Count(tmpTbl.Calls) AS CountOfCalls, 
       Sum(IIf([tmpTbl].[Success]=""No"",1,0)) AS Failed
FROM tmpTbl
GROUP BY tmpTbl.Agent;
"
3506,56990,Auto id for select statements in Oracle,"SELECT ROWID,ROWNUM,name from ITEMS;
"
782,61971,Complex ordering in Django,"Cat.objects.order_by('dog__timestamp')
"
14856,10326,Unexpected query results with multiple joins - mysql,"SELECT p.PurchActvtyID, a1.name AS billName, a1.address1 AS billAddress1, a2.name AS shipName, a2.address1 AS shipAddress1
FROM arrc_PurchaseActivity p
LEFT OUTER JOIN jos_customers_addresses a1 ON p.AcctID = a1.customer_id
LEFT OUTER JOIN jos_customers_addresses a2 ON p.ShipAddrID = a2.id
GROUP BY p.PurchActvtyID
ORDER BY p.PurchActvtyID ASC
"
21644,12359,"SQL query, AVG and COUNT on multiple tables","SELECT l.isbn, v.rating, r.rec
FROM book l, 
    (SELECT isbn, AVG(rating) AS rating FROM ratings GROUP BY isbn) v,
    (SELECT isbn, COUNT(isbn) AS rec FROM recommend GROUP BY isbn) r
WHERE l.isbn=v.isbn AND l.isbn=r.isbn
"
17231,30218,SQL Update query with CASE WHEN,"UPDATE Table_Main SET filtered = CASE WHEN (subTable.name='CS') 
THEN false ELSE true END 
FROM subTable 
WHERE subTable.id = mainTable.""CTYPE""
"
39211,6101,"postgres sql, date_trunc without extra zeroes","SELECT date_trunc(...)::date;
"
7885,54425,How to design usage of Global temp table for a multi-user environment? (or alternatives),"set query = 'select ....'+ pivotcols + 
            ' into ##temp_table' + REPLACE(CAST(NEWID() as varchar(50)), '-','')
"
24284,42419,How can I reliably convert YYYYMMDDhhmmss<offset> to a date/time?,"print convert(datetime,stuff(stuff(stuff(LEFT('20150614140520-0500',14) , 9, 0, ' '), 12, 0, ':'), 15, 0, ':')) 
"
5108,74184,SQL - dividing count on one table from another and grouping the results,"select fp.age, 
       (count(cl.id)::numeric / count(*)::numeric) * 100 as ration,
       count(cl.id) as class_count, 
       count(*) as age_count
from football_players fp
  left join class cl on fp.id = cl.id
group by fp.age  
"
28770,26086,Format data in sql server,"SELECT distinct t1.Name, 
  SUBSTRING((
    SELECT ',' + cast(t2.Id as varchar(30))
    FROM Status t2
    WHERE t2.Name = t1.Name
    FOR XML PATH('')), 2, 1000000) as [Id List]
FROM Status t1
"
16385,52481,Using a Sub-Select as a Returned Column,"SELECT st.Id, st.Name, GROUP_CONCAT(ct.ClassId) AS ClassList
    FROM StudentTable st
        INNER JOIN ClassTable ct
            ON st.Id = ct.Id
    GROUP BY st.Id, st.Name
"
14047,17386,If connection fails between linked servers on SQL Server 2008,"BEGIN TRANSACTION
BEGIN TRY
    --UPDATE
    COMMIT TRANSACTION
END TRY
BEGIN CATCH
    --INSERT INTO UpdateFail TABLE
    ROLLBACK TRANSACTION 
END CATCH
"
148,42828,SQL - Order By Different case on one column,"SELECT * 
  FROM TableName
 ORDER BY 
    CASE 
      WHEN CHECKING_ACCT_MONTHS = 'AVERAGE' 
      THEN 1 ELSE 0 
   END, 
   CHECKING_ACCT_MONTHS DESC
"
10745,29397,SQL: Turn a subquery into a join: How to refer to outside table in nested join where clause?,"WITH qry AS
(
    SELECT afield1, 
           afield2, 
           b.field1 AS bfield1,
           ROW_NUMBER() OVER(PARTITION BY a.id ORDER BY field1) rn
      FROM sometable a LEFT JOIN anothertable b
        ON b.aForeignKey = a.id
)
SELECT *
  FROM qry
 WHERE rn = 1
"
9486,65576,Using multiple date ranges in Amazon Redshift,"date(date) >= date(dateadd(week,-6, current_date))
OR (
  date(date) >= date(dateadd(week,-55, current_date))
  AND
  date(date) <= date(dateadd(week,-51, current_date))
)
"
31842,47804,Group By and Join (DB2),"SELECT 
   btst.Ordnungsbegriff AS BBNR,
   COUNT(vp.KVNR) 
   FROM 

   ...
GROUP BY vz.""VALIDTO"", vz.""BETRIEBSNUMMER"", btst.Ordnungsbegriff 
"
32306,37813,Drupal get database configuration,"<?php
  global $db_url;
  $creds =  parse_url($db_url);
  print $creds['user'];
  print $creds['pass'];
  var_dump($creds);
?>
"
37298,8338,finding duplicates in a table ,"select  ID
,       MC
from    Trace
group by
        ID
,       MC
having  count(*) > 1
"
8476,11960,how to write sql query without alias,"select data.time,
    vData.time,
    data.Signal,
    drivers.name,
    drivers.lastname,
    vehicles.vehicle,
    data.Reg
from data 
inner join vData on data.id != vData.id and data.serial = vData.serial
inner join drivers on data.FK_ID_driver = drivers.ID_driver
inner join vehicles on data.Reg = vehicles.Reg
where TIMEDIFF(vData.time, data.time) between '00:15:00' and '00:30:00';
"
4650,70483,How to migrate data between MySQL bases on different servers?,"INSERT INTO T2 
(ID, Name, UserID) 
SELECT id, SUBSTR(title, 0, 100), uid 
FROM T1
"
24442,58877,SQL Join Two Columns In Same Table,"SELECT count(*) FROM segment
WHERE name NOT IN
(
    SELECT segment_name FROM segment_segment_assoc
    UNION
    SELECT child_name FROM segment_segment_assoc
)
"
22741,73257,How to ignore nulls in an Oracle analytic function,"select
  FIRST_VALUE(BILL_ID) OVER(PARTITION BY ACCOUNT_ID ORDER BY BILL_DT DESC NULLS LAST) bill_id,
  FIRST_VALUE(BILL_DATE) OVER(PARTITION BY ACCOUNT_ID ORDER BY BILL_DT DESC NULLS LAST) bill_date
...
"
21694,50110,How to alias in rethinkdb?,"r.table(""table_name"").map({
    alias_name: r.row(""column_name"")
})
"
32822,3132,Exclude the specific kind of record,"SELECT * FROM dbo.Table1 t1
WHERE [Type] != 'Average' 
OR EXISTS (SELECT * FROM Table1 t2 
           WHERE t1.UniqueId = t2.UniqueId 
             AND t1.[Type] = 'Average' 
             AND t2.[Type] IN ('first','additional'))
"
1779,2680,SQL database views,"CREATE VIEW InvoicesWeek30 AS
    SELECT foo, bar, CustomerID
    FROM  Invoices
    WHERE InvoiceDate BETWEEN Date1 AND Date2

 ...
 SELECT * FROM InvoicesWeek30 WHERE CustomerID = 99
"
18069,47682,SQL query for finding rows with special characters only,"SELECT
    TemplateID,
    Body
FROM
    #Template
WHERE
    Body LIKE '%[^0-9a-zA-Z ]%'
"
21798,7368,SQL Joint 2 table without dublicate rows,"SELECT c.id, c.pagetitle as title, c.introtext, c.pub_date as publishdate,
       group_concat(cv.value) as sphotos
FROM `modx_site_content` c JOIN
     `modx_site_tmplvar_contentvalues` cv
     ON cv.`contentid`= c.id
WHERE c.parent IN (1153, 3271) AND c.pub_date > 0 AND
      `tmplvarid` IN (10, 15, 19) 
GROUP BY c.id, c.pagetitle, c.introtext, c.pub_date
Order by c.`pub_date` DESC
LIMIT 20;
"
26506,67833,SQL case another existing column,"CASE 
   WHEN Employee = 'No' 
      THEN '0' 
   WHEN Employee = 'yes' OR table.Name = 'Emp'
      THEN '1' 
   ELSE 0 
END
"
27104,42435,how to move tables from public to other schema in Postgres,"ALTER TABLE yksus1
    SET SCHEMA firma1;
"
21813,41962,adding unique values to existing table in mySql,"Insert into NEW_TABLE
(select   @row := @row + 1 as generateId, col1, col2 
 from ORIGINAL_TABLE, (SELECT @row := 0)row)
"
25110,8766,SQL: Group by count(*) as pct of total table row count,"select categorynum,count,100*count/(sum(count) over ())::numeric as count_pct
from(
    select categorynum,count(1)
    from tbl
    group by categorynum
)a;
"
21716,66098,Update a column using values from another column that match a specific criteria,"UPDATE zen_customers 
SET customers_fax = customers_telephone
WHERE customers_telephone like '07%'
"
19223,10866,Delete specific word from table column in MySQL?,"update your_table
set your_column = concat(SUBSTRING_INDEX(your_column, '-', 1), '-',
                         SUBSTRING_INDEX(your_column, '-', -1))
"
30735,35419,"SQL: Unable To Join These Two Tables (EAV Architechture, Magento)","SELECT e.entity_id, eav.value AS name, eav2.value as price
  FROM catalog_product_entity e
  JOIN catalog_product_entity_varchar eav
    ON e.entity_id = eav.entity_id
  JOIN eav_attribute ea
    ON eav.attribute_id = ea.attribute_id
  JOIN catalog_product_entity_decimal eav2
    ON e.entity_id = eav2.entity_id
  JOIN eav_attribute ea2
    ON eav2.attribute_id = ea2.attribute_id
 WHERE ea.attribute_code = 'name'
   and ea2.attribute_code = 'price'
"
634,24074,Fastest way to compare if two tables have exactly the same contents,"create table atable (
  id int,
  field1 int,
  field2 varchar(16)
  )

create table btable (
  id int,
  field1 int,
  field2 varchar(16)
  )

select * from atable as a
join btable as b on a.id = b.id
where a.field1 != b.field1
or a.field2 != b.field2
"
8562,16796,Select data from three different tables with null data,"SELECT *
FROM [USER]
INNER JOIN [ParentChild] ON ([ParentChild].UserId = [USER].Id) 
LEFT JOIN [Location] ON ([Location].UserId = [USER].Id)
WHERE ParentId=7
"
9657,17813,SQL Only equal to day and month not year,"SELECT username FROM table_name 
WHERE MONTH(birthday)=MONTH('$birthday') 
AND DAY(birthday)=DAY('$birthday')
"
8425,46983,SQL complex sorting by two columns,"SELECT name,reviews,average 
FROM profiles 
WHERE average >= 7 
   AND reviews >= 50 
ORDER BY (average*.7 + reviews*.3) 
LIMIT 5
"
38370,30932,Rounding decimal in sql server,"SELECT round(0.96855, 3, 1)
"
13551,72722,Return min value from query with inner join,"SELECT POI.Name FROM POI INNER JOIN rtgitems ON POI.Vote=rtgitems.item where totalrate= (select min(totalrate) from rtgitems)
GROUP BY POI.Name 
"
6625,3914,vb6 font charset oracle,"Dim Content() As Byte
Content = ChrW(&HFEFF) & StringVariable
FileNum = FreeFile()
Open FileName For Binary As #FileNum
Put #filenum, Content
Close #FileNum
"
28325,74228,How to change the size of a column in a view dynamically,"CREATE VIEW dbo.EmployeeView
WITH SCHEMABINDING
AS
    SELECT
        /* Other Columns */
        CASE
          WHEN LEN(EmployeeAddress) > 50
            THEN SUBSTRING(EmployeeAddress,1,50) + '...'
          ELSE EmployeeAddress
        END as EmployeeAddress
    FROM
        dbo.Employee
"
36812,63715,How to Extract Numeric Range from Text in SQL,"with cte as
(
    select 'p.G12_V14insR' as AA_SYNTAX from dual
)

select 
    REGEXP_SUBSTR(AA_SYNTAX,'p\.[[:alpha:]]+([[:digit:]]+)', 1, 1, NULL, 1) as Bottom 
    ,REGEXP_SUBSTR(AA_SYNTAX,'\_[[:alpha:]]+([[:digit:]]+)', 1, 1, NULL, 1) as Top 
from cte
"
37351,69256,Oracle move column to the first position,"RENAME tab1 TO tab1_old;

CREATE TABLE tab1 AS SELECT id, <the rest of your columns> FROM tab1_old;
"
31537,469,How To Select Distinct Row Based On Multiple Fields,"WITH CTE
AS
(
   SELECT *,
     ROW_NUMBER() OVER(PARTITION BY Owner 
                       ORDER BY Date DESC) AS RN
   FROM tablename
)
SELECT ID, Name, Date, Location, Owner
FROM CTE
WHERE RN = 1;
"
24499,20931,Sql Group By Max Value in one column,"WITH CTE AS
(
   SELECT 
      CallId, 
      ProblemDescription, 
      CurrentAction, 
      CurrentEngineer, 
      EventNumber,
      Rank = DENSE_RANK() OVER (PARTITION BY CallId ORDER BY EventNumber DESC)
   FROM dbo.TableName
)
SELECT 
   CallId, ProblemDescription, CurrentAction, CurrentEngineer, EventNumber
FROM 
   CTE
WHERE 
   RANK = 1
"
787,25062,finding distinct elements in a column without using keyword DISTINCT in sql,"SELECT v1
FROM ztable
GROUP by v1
        ;
"
1651,62634,Sql Calculating Averages,"SELECT T.DistrictName, T.TownName, T.CropName, avg(T.pest)
FROM (
    SELECT DistrictName, TownName, CropName, cast(Pests as float) as pest
    FROM [dw_staging].[dbo].[StagingTable]
) as T
group by T.DistrictName, T.TownName, T.CropName
GO
"
28894,54991,"oracle query to get max hour every day, and corresponding row values","SELECT trunc(insert_time),
       log_value
  FROM (
    SELECT insert_time,
           log_value,
           rank() over (partition by trunc(insert_time)
                            order by insert_time desc) rnk
      FROM log)
 WHERE rnk = 1
"
10434,5769,Find tablespaces used within datapump dump file,"impdp directory=expdir dumpfile=myexp.dmp sqlfile=myddl.sql
"
17946,1583,Searching inside a SQL record with date limits,"select order_number
from t
having sum(case when DATEDIFF(day, date, getdate()) < 2 and
                     Note like '%OBC%'
                then 1 else 0
           end) = 0
"
27057,8001,MySQL Query: Write max(Date) from whole table to each row,"SELECT  n.*
FROM    news n
        INNER JOIN
        (
            SELECT  ID, Max(LastEdited) lastEdit
            FROM news
            GROUP BY ID
        ) x ON n.ID = x.ID AND 
               n.LastEdited = x.LastEdit
-- WHERE ...
-- ORDER BY ...
-- LIMIT ...
"
25391,32122,Cut string from last dash,"SELECT (CASE WHEN @String like '%-%'
             THEN LTRIM(RIGHT(@String, CHARINDEX(' ', REVERSE(@String))))
             ELSE @String
        END)
"
32455,26992,how to select sum of column based on date,"SELECT SUM(value) AS value_today FROM table_value WHERE date = CURDATE()
"
15132,59440,How do I Compare columns of records from the same table?,"SELECT
  t.*,
  CASE WHEN EXISTS(
    SELECT * FROM testing WHERE id <> t.id AND Name = t.Name AND Fee = t.Fee AND Amt = t.Amt
  ) THEN 'Y' ELSE 'N' END SameDataExistYN
FROM
  testing t 
;
"
27991,28584,sql query by passing te values in one table,"SELECT TableA.EMPLOYEEID, SKILLSETCODE,CERTID, LASTNAME, FIRSTNAME, MIDDLEINITIAL 
FROM TableA, TableB
WHERE TableA.EMPLOYEEID = TableB.employeeid 
and TableB.key_user='249'
"
24031,71883,"SQL Server: CTE, how to get last row number","
select database_name, max(backup_finish_date)
from bckHist
group by database_name
"
36160,14769,Rollback + Commit some changes,"  PRAGMA AUTONOMOUS_TRANSACTION;
"
3730,47454,need to convert number to string with nvl and to_char in sql developer,"select  d.department_id,
        d.department_name,
        d.location_id,
        coalesce(d.manager_id, 'No Manager'),
        coalesce(e.first_name||' '||e.last_name, 'No Manager')  as manager
from    departments d
left outer join
        employees e 
        on d.manager_id = e.employee_id;
"
11465,17324,Get id of max value in group,"SELECT `id` 
FROM `mytable` 
WHERE (`group_id`, `time`) IN (
  SELECT `group_id`, MAX(`time`) as `time` 
  FROM `mytable`
  GROUP BY `group_id`
)
"
26342,52637,Oracle Query to sum a column by every date range in another table,"SELECT T2.ST_DT, T2.END_DT, 
(
    SELECT SUM(T1.NO_OF_PAX)
    FROM TABLE1 T1
    WHERE T1.DT BETWEEN T2.ST_DT AND T2.END_DT
) NO_OF_PAX
FROM TABLE2 T2
ORDER BY T2.ST_DT ASC
"
3758,31666,How to make this SELECT Query in DELETE Query?,"DELETE a.* FROM accounts a
JOIN (SELECT email
      FROM accounts
      GROUP BY email
      HAVING COUNT(*) > 1) dup
ON a.email = dup.email
"
23414,39644,Should I store multiple ids as varchar and use FIND_IN_SET?,"SELECT FIND_IN_SET('b','a,b,c,d');
"
13768,31630,Fetch data from two different tables in one query,"SELECT id, Name, First name, Place FROM tbl_Friend
  WHERE Place= 1
UNION ALL
SELECT id, Name, First name, Place FROM tbl_Colleague
  WHERE Place= 1
"
5377,49781,Get Hours and Minutes (HH:MM) from date," SELECT CONVERT(VARCHAR(5),getdate(),108) 
"
13926,59630,Help with SQL totals and sums,"select
  a.acct_no, m.cmcl_forecast_cleared, b.name,
  count(*) as TotalChecks,
  Sum(m.check_amount) as TotalAmount
from ap_master m   
join accounts a on a.acct_id=m.account_tag  
join banks b on b.bank_id=a.bank_id  
where m.cmcl_bank_cleared is null 
group by a.acct_no, m.cmcl_forecast_cleared, b.name
order by a.acct_no, m.cmcl_forecast_cleared, b.name
"
35458,6082,How to avoid SQL Injection with Update command in Npgsql?,"string UpdateCmd = ""update dx set chronic = @p1 where (trim(lower(cdesc)), trim(cicd9)) = (@p2);"";

using (NpgsqlCommand command = new NpgsqlCommand(UpdateCmd, conn))
{
    cmd.Parameters.AddWithValue(""p1"", ""chronic"");
    cmd.Parameters.AddWithValue(""p2"", ""value"");
    cmd.ExecuteNonQuery();
}
"
10592,60484,How to Query 2 SQL databases and compare results,"Select * 
From Customers b
Where bactive = 'True'
and exists
(Select 'x' from 
database1.dbo.Customers A
where a.dtcreated > @startdate
and a.key = b.key)
"
9918,15370,Reading the number of rows inserted from another ongoing transaction,"SELECT COUNT(*) FROM Table2 WITH (NOLOCK);
"
29615,67315,SQL Add Colums a unique hash,"ALTER TABLE users ADD COLUMN hash varchar(37);

CREATE TRIGGER users_hash_tr
BEFORE INSERT ON users 
FOR EACH ROW
SET new.hash = uuid();
"
8580,31063,How to get time part from SQL Server 2005 datetime in 'HH:mm tt' format,"SELECT LTRIM(RIGHT(CONVERT(VARCHAR(20), GETDATE(), 100), 7))
"
37745,36970,How to do full join on one field and inner join on another from same table,"sum(case when t2.chain is null then 0 else t1.qty end) as t1Total
"
905,33553,SQL Query Display records only when value is missing,"SELECT
  employee.name
FROM
  employee
  LEFT OUTER JOIN address ON address.refid = employee.refid AND address.type_add_id = 2
WHERE
  address.type_add_id IS NULL
"
23285,15659,Oracle Sequences exclude specified number,"alter sequence seq_name
increment by 124;
"
20899,52582,SQL multiple join tidy up,"SELECT board.*,
    `user`.username,
    numlikes 
FROM board
INNER JOIN `user` ON board.user_id = `user`.user_id
LEFT JOIN (
    SELECT pins.board_id, COUNT(source_user_id) AS numlikes
    FROM likes 
    INNER JOIN pins ON pins.id = likes.pin_id 
    GROUP BY pins.board_id
) likes ON board.id = likes.board_id
WHERE who_can_tag='' 
ORDER BY numlikes DESC 
LIMIT 10
"
13738,64178,Issues on designing SQL users table,"table_users
  id
  name
  email
  password
  is_admin

table_teachers
  user_id
  teacher_only_a
  teacher_only_b

table_students 
  user_id
  student_only_a
  student_only_b
"
26350,67958,how to do select distinct select in sql?,"INSERT INTO myTable2 (ID, STATUS, TIME, DESCRIPTION)
SELECT t1.ID, t1.STATUS, t1.TIME, t1.DESCRIPTION FROM table_1 as t1 
WHERE STATUS = 'complete' 
OR TIME = (SELECT min(TIME) FROM table_1 WHERE ID = t1.ID) 
ORDER BY ID asc, STATUS desc
"
26866,68729,Taking n random elements from a table with a constraint,"select * from <table> where <constrain> order by RAND() limit 0,<n>
"
33102,3015,How to call a shell script from PLSQL program,"
create or replace procedure host( cmd in varchar2 )
as
    status number;
begin
    dbms_pipe.pack_message( cmd );
    status := dbms_pipe.send_message( 'HOST_PIPE' );
    if ( status <> 0 ) then raise_application_error( -20001, 'Pipe error' );
    end if;
end;
/
"
35248,17585,SQL: N-N Select * from table1 and detect if relation exists with the other of a specific user id,"select p.*,
       (case when ulp.id_user is not null then 'Y' else 'N' end) as UserLikesPlace
from places p left outer join
     user_like_places ulp
     on p.id = ulp.id_place and
        ulp.id_user = @IDUSER;
"
25911,9642,Generating Random String in PL/SQL(oracle 9i) with restricted Letters,"select xmlagg(xmlelement(""r"", ch)).extract('//text()').getstringval()
from
(
  select distinct first_value(ch) over (partition by lower(ch)) as ch
  from (
    select substr('abcdefghijklmnpqrstuvwxyzABCDEFGHIJKLMNPQRSTUVWXYZ123456789',
        level, 1) as ch
    from dual 
    connect by level <= 59
    order by dbms_random.value
  )
  where rownum <= dbms_random.value(10,13)
);
"
31213,6502,Database Toll Layout,"ALTER TABLE Tarif ADD CONSTRAINT FK_autobahn_id FOREIGN KEY (autobahn_id) REFERENCES Autobahn(ID) ON UPDATE CASCADE ON DELETE CASCADE
"
30010,68601,Which way is the best way to grant read access to a remote database-server?,"mysql -u root -p mysql
mysql> update db set Host='999.999.999.999' where Db='MyDB';
mysql> update user set Host='999.999.999.999' where user='RemoteUsername';
mysql> exit;
"
390,19872,SQL Query - Distinct results,"select  People.ID
,       count(distinct Species)
from    People
join    Pet
on      Pet.OwnerID = People.ID
group by
        People.ID
"
27961,54341,Drop All User-Defined Types from SQL Server,"select  'drop type ' + quotename(schema_name(schema_id)) + '.' + quotename(name)
from sys.types
where is_user_defined = 1
"
12619,30714,DateAdd in ms access Sql select in vb.net,"SELECT Table1.ID, dateadd(""m"",2,Table1.dte) as NextDate
FROM Table1; 
"
28903,49736,WHERE expiry_date > (current_date - 30 * interval '1 day'),"regress=> SELECT current_date,  (current_date - 30 * interval '1 day'), expiry_date
regress-> FROM listings
regress-> WHERE id = '96144752ad41b6bf';
    date    |      ?column?       |          expiry_date          
------------+---------------------+-------------------------------
 2014-03-19 | 2014-02-17 00:00:00 | 2014-03-09 10:33:25.855162+08
(1 row)
"
12088,49425,Can I first SELECT and then DELETE records in one t-SQL transaction?,"delete from [tbl] output deleted.* WHERE [id] > 6
"
10997,61136,How to use an IN Clause with a user defined list,"SELECT SUM(net_sales)
FROM Sales_tb
WHERE 
    Store_number IN (SELECT Item FROM dbo.SplitStrings(@list, ','))
"
12973,54709,"my statements returns empty row, eventho there records with values","$result = mysqli_query($connection, ""SELECT * FROM gastenboek"");
print $row_cnt = mysqli_num_rows($result);
echo '<br /><br />';

while($item = mysqli_fetch_assoc($result)){
    echo $item['comment'];
}
"
35118,15316,Splitting flat file rows to multiple flat files SSIS,"int val = Convert.ToInt32(Dts.Variables[""Counter""].Value);
Dts.Connections[""destinationConnectionName""].ConnectionString = ""c:\\yourpath\\"" + val.ToString() + "".txt"";
"
23242,57684,Return records repeated according to field value,"WITH RECURSIVE tQty AS(
    SELECT ta.name, ta.qty
       FROM T ta
       WHERE(ta.qty > 0)
 UNION ALL
    SELECT tb.name, tb.qty-1
       FROM tQty tb
       WHERE(tb.qty-1 > 0)
 )
 SELECT name,qty FROM tQty
       ORDER BY name
"
37027,69645,Turn two queries into one,"SELECT
    wallPost.*,
    user.currentDefault,
    user.displayName,
    user.userName,
    wallpost_commentcount.total
FROM
    wallPost
        INNER JOIN user ON user.id=wallPost.sourceUserId
        LEFT JOIN (SELECT wallPostId,COUNT(*) as total FROM comment GROUP BY wallPostId) as wallpost_commentcount ON (wallpost_commentcount.wallPostId=wallPost.id)
WHERE
    wallPost.recipientId = ?
ORDER BY wallPost.id DESC
"
3219,38406,how to do inner join and right outer join in the same query,"from f in context.FeatureTbls
join mp in (
    from p in context.ParameterTbls
    join mp2f in context.Map_Parameter_To_Feature on p.ParameterId equals mp2f.ParameterId
    select new { mp2f.FeatureId, p.ParameterId, p.ParameterName }
) on f.FeatureId equals mp.FeatureId into ps
from p in ps.DefaultIfEmpty()
select new { f.FeatureId, f.FeatureName, null == p.ParameterId ? (int?)null : p.ParameterId, null == p.ParameterName ? null : p.ParameterName }
"
11449,29807,How to group result in the same line : Many to Many relationship by using MySQL,"SELECT  product.product_name, GROUP_CONCAT(provider.provider_name SEPARATOR '/') 
FROM  product, provider, provider_product 
WHERE product.id_product = provider_product.ref_product 
AND provider.id_provider = provider_product.ref_provider 
GROUP BY product.product_name
"
7996,38493,select records which do not have a specific flag Oracle,"select distinct orgkey
from phone_table p1
where not exists (select 1 from phone_table p2
                  where p1.orgkey = p2.orgkey
                    and p2.preffered_flg = 'Y')
"
24860,13169,Select one (highest) score per userid OR nickname column,"SELECT   nickname, userid, MAX(score)
FROM     my_table
GROUP BY nickname, userid
"
34989,68025,How to select a date and ignor the time,"select datepart(dw, CONVERT(DATE,[Order].PerformDate)) 
GROUP BY CONVERT(DATE,[Order].PerformDate)
"
30367,52429,same type of value in a single row using case or decode,"SELECT M.pl_rpflag, Sum(M.Area) FROM 
(
  SELECT (CASE WHEN croptype_code < 13 THEN 'Pedi' ELSE 'Paudha' end) AS pl_rpflag,
    nvl(sum(gh_area),0) AS Area
  FROM w_cane_survey_2013
  WHERE unit_code = '03' 
    AND gh_vill = '9991' 
    AND gh_grow= '1'
) AS M
GROUP BY M.pl_rpflag
"
26638,32166,Insert values from another table,"INSERT INTO Organizations( name, IndustryId, LocationId )
SELECT o.Nameofthecompany, i.Id, l.Id
FROM Organization AS o
LEFT JOIN Industries AS i ON o.industrytype = i.Name
LEFT JOIN Location AS l ON o.Location = l.Name
"
31986,20975,MySQL - Multiple Union,"select
  b.id,
  b.name,
  b.middle_id,
  m.top_id,
  m.name,
  t.name
from bottom as b
  left join (select  id,`name`, top_id  from Middle) as m  on m.id = b.middle_id
  left join (select  id,`name`from Top) as t   on t.id = m.top_id
"
28582,38295,basic sql query -- where prefix =,"SELECT model FROM cars WHERE model like 'Ex%'; 
"
6055,3287,SQL - Products with No Sales,"SELECT product.productid
FROM product
LEFT JOIN orderline USING (productid)
WHERE orderline.productid IS NULL
ORDER BY product.productid
"
5359,25148,Handling versions,"release_id, 
version_id, --foreign key 
type, -- this is either UPDATE or PATCH
release_name, -- this is the full ver number 1.0.1, for instances
changelog,
download_link
"
34771,21153,Getting different between two variable of type time in Sql,"----query start---
DECLARE @time1 time(7) = '16:02:27.5930000'
DECLARE @time2 time(7) = CONVERT(time(7),GETDATE()) 
Declare @diffint int = 0
select @diffint = DATEDIFF(MINUTE, convert(datetime,@time1), convert(datetime,@time2)) 

select @diffint  [Diff in min],convert(datetime,@time1) as time1, convert(datetime,@time2) as time2

----query end ---
"
8630,74551,How do I do this SQL SELECT statement?,"SELECT  sno
FROM    (
        SELECT  DISTINCT sno
        FROM    spj
        WHERE   pno = 3
        ) q
WHERE   sno NOT IN
        (
        SELECT  sno
        FROM    spj
        WHERE   pno = 5
        )
"
12173,33991,postgresql retype in index,"CREATE INDEX i_users_user_id
ON users
USING btree ((user_id::character varying));
"
17641,17274,"Crystal Reports Cross-Tab, Grouping by Database Field","CustomerName

Total


Red Products  Product Code1     3     24     72
              Product Code2     3     24     72

Blue Products Product Code3     3     24     72
"
32017,50949,Sort mysql data by count and timestamp,"SELECT searchstring 
FROM trending 
WHERE 
  timestamp > DATE_SUB(NOW(), INTERVAL 1 DAY)
ORDER BY count DESC 
LIMIT 5
"
3392,30131,SQL Query - select data from table A based on two fields in table B,"Select B.Name
From A
Inner Join B
  On A.date = B.date
  And A.step = B.step
Where A.status = '1'
"
15697,918,SQL count on a field which is a code,"SELECT qId,
       SUM(CASE WHEN TOGGLE_VALUE='Yes' THEN 1 ELSE 0 END) AS YesQty,
       SUM(CASE WHEN TOGGLE_VALUE='No' THEN 1 ELSE 0 END) AS NoQty,
       SUM(CASE WHEN TOGGLE_VALUE='NA' THEN 1 ELSE 0 END) AS NAQty,
       SUM(CASE WHEN TOGGLE_VALUE='Resolved' THEN 1 ELSE 0 END) AS ResolvedQty
  FROM ANSWERS 
 GROUP BY qId
"
37104,24455,MYSQL auto fill column values from another table,"**Sellers**
1. Seller_id
2. Seller_name
3. Seller_logo

**Details**
1. Details_id
2. Seller_id (foreign key)
3. Product
4. Price
"
30296,59150,Adding a unique ID number to a difference of tables,"with cte as (
select * 
from sys.tables
), maxid as (
    select MAX(OBJECT_ID) maxid from sys.tables
)
select 
    rn = maxid + ROW_NUMBER() over (order by name), *
from cte
cross join maxid
"
23590,62299,Having query in SQL aliases,"FROM Customer AS c JOIN Orders AS o ON c.CustomerID = o.CustomerID
"
30957,72583,reducing table so as to get island,"SELECT a.*
FROM TableX AS a
WHERE EXISTS
      ( SELECT *
        FROM TABleX AS b
        WHERE b.X = a.X
          AND ( b.Z = a.Z + 1
             OR b.Z = a.Z - 1
              )
      )
"
6396,48148,Is there any method in Triggers to skip update/insert from particular user in DB2?,"if current_user is not in blocked_user_table
then
    insert in table b
end
"
2227,70951,select sum of values: grouped by sign,"SELECT 
  YEAR(date), 
  SUM(CASE WHEN value > 0 THEN value ELSE 0 END) as positives_sum,
  SUM(CASE WHEN value < 0 THEN value ELSE 0 END) as negatives_sum
FROM 
  table 
GROUP BY
  YEAR(date)
"
27440,773,SQL Server 2008 Query to Delete All Rows Where Values Are Not Found in 3 Other tables,"DELETE A FROM A 
LEFT JOIN B ON A.itemnum = B.itemnum
LEFT JOIN C ON A.itemnum = C.itemnum
WHERE b.itemnum IS NULL
  AND c.itemnum IS NULL;
"
10062,20556,Reverse/Blow out a GROUP BY,"WITH CTE AS (
    SELECT OwnerNumber,ItemCode,ItemNumber,CountOfItems FROM table

    UNION ALL SELECT OwnerNumber,ItemCode,ItemNumber,CountOfItems-1
    FROM CTE
    WHERE CountOfItems >= 2
)
SELECT OwnerNumber,ItemCode,ItemNumber
FROM CTE
ORDER BY ItemNumber
OPTION (MAXRECURSION 0);
"
28835,15881,Sum of specific values in SQL,"select SUM(v)
from
(

select * -- ID, r, v 
from 
(select * from yourtable) u
unpivot
( r for co in (co1, co2, co3)) as u1
unpivot
(  v for va in (va1, va2, va3)) as u2
where RIGHT(co,1) = RIGHT(va,1)
) v
WHERE R = 'AA1' -- etc
"
20967,68385,converting integer to date and getting records based on this date,"SELECT *
FROM webFormsInstances 
WHERE formStage <> 'Complete' 
      AND formActionDate < CONVERT(int, CONVERT(varchar(8), dateAdd(day,-14, getdate()), 112))
ORDER BY formActionDateTime DESC
"
21825,63209,Selecting all projects and tasks for a specific userID,"select *
from users u
left join projects p
    on u.userid = p.userid
left join tasks t
    on p.projectid = t.projectid
where u.userid = ?
"
25614,55166,SQLite Query _ Select only different Varchar and add them to one,"SELECT GROUP_CONCAT(name,'')
FROM (
  SELECT DISTINCT name
  FROM testtable
  WHERE ID<=10
  ORDER BY name
);
"
34432,22277,"Using numbers with multiple decimal points (ex. 1.4.4) in MySql, is it possible?","version * 10000 + revision * 100 + patch
"
7535,48547,SQL Two Tables with One Unique column,"SELECT Company, Servername FROM tbl_backupchecks
UNION
SELECT Company, Servername FROM tbl_backupchecks_sqlbak
"
1799,51157,XML datatype function does not exists?,"Select x.a.query('.') FROM @XmlEl.nodes('p/span') x(a)
"
19413,63410,SQL 'ends-with' Command,"Select * from users where email like '%yahoo.com'
"
14395,23356,SQL query to select the latest records with a distinct subject,"SELECT id, subject,  content, moreContent, modified
FROM (
   SELECT id, subject,  content, moreContent, modified,
          ROW_NUMBER() OVER (PARTITION BY subject 
                             ORDER BY modified DESC) AS rn
   FROM [CareManagement].[dbo].[Careplans] ) t
WHERE rn = 1
"
28013,69755,Find Groups of data that could have a change in a second related column,"SELECT column1
FROM yourTable
GROUP BY column1
HAVING COUNT(DISTINCT columns2) > 1
"
34780,45529,"How to identify the operation type(insert,update,delete) in SQL Server trigger","DECLARE @event_type varchar(42)
IF EXISTS(SELECT * FROM inserted)
  IF EXISTS(SELECT * FROM deleted)
    SELECT @event_type = 'update'
ELSE
    SELECT @event_type = 'insert'
ELSE
  IF EXISTS(SELECT * FROM deleted)
    SELECT @event_type = 'delete'
  ELSE
    --no rows affected - cannot determine event
    SELECT @event_type = 'unknown'
"
8381,17067,How does one store 'packages' of multiple products within a database,"CREATE TABLE Package_Items (
  package_id INT NOT NULL 
  item_id INT NOT NULL,
  item_quantity INT NOT NULL DEFAULT 1,
  FOREIGN KEY (package_id) REFERENCES Product_Info (ID),
  FOREIGN KEY (item_id) REFERENCES Product_Info (ID)
  PRIMARY KEY (package_id, item_id)
);
"
12425,67643,Select count(*) from multiple tables,"SELECT  (
        SELECT COUNT(*)
        FROM   tab1
        ) AS count1,
        (
        SELECT COUNT(*)
        FROM   tab2
        ) AS count2
FROM    dual
"
36570,69881,Calculate Duration between two dates (Month and Year will be Considered),"Declare @SDate DateTime ='06-Jan-2009'
Declare @EDate DateTime ='12-Oct-2009'


select case when DateDiff(M,@sDate,@EDate) <=12 
            then DateDiff(M,@sDate,@EDate) 
            else Round( ( Convert(Decimal(18,0)
                                   ,DateDiff(M,@sDate,@EDate)/12.0)),0) end
"
22747,61292,MS Access. SQL. get current time,"SELECT Month(date_of_visit), Sum(cost)
FROM VISIT
WHERE Year(date_of_visit) = Year(Date())
GROUP BY Month(date_of_visit);
"
36527,72259,SQL Select rows that have higher timestamp value,"SELECT 
       t.Code,
       t.kind,
       t.timestamp 
FROM   table t 
       LEFT JOIN table t2 
         ON t.code = t2.code 
            AND t.kind = 'I' 
            AND t2.kind = 'O' 
WHERE  t2.code IS NULL 
"
34431,54557,"SQL, Group by one colum","Select id, version, sequence
From DataTable dt
where version =
    (Select Max(version)
     From DataTable 
     where Sequence = dt.Sequence)
"
18833,57409,How to Convert Varchar(1) to Bit in Sql Query?,"select case when your_varchar_column = 'N' 
            then 1 
            else 0 
       end as your_bool_result
from your_table
"
33693,35848,Update table using inner join on several fields,"update B
set B.NBR_OF_BACKUP=I.NBR_OF_BACKUP - 1
FROM BACKUP_TABLE B
INNER JOIN (SELECT id_backup, count(*) as nbr_of_backup FROM tbl GROUP BY id_backup) I 
ON B.ID_BACKUP=i.id_backup 
"
39557,15193,MYSQL parent relations,"select t1.name, t2.name as parent_name 
from categories t1 
left join categories t2 on t1.parent_id = t2.id
"
3996,56522,mysql query not returning all results when using case,"select s.name,s.id,s.level,
CASE WHEN g.photo_url IS NULL THEN 'no-image.png'  
ELSE g.photo_url END 
AS photo_url  
from sub_category s
left join gallery g 
on g.main_id=s.id 
on g.type_id='9' 
where s.category_id='2' 
and s.level='1'
"
12716,37224,How to combine multiple tables that vary slightly in columns,"SELECT
    id,
    colA,
    colB,
    NULL AS colC,
    NULL AS colD
FROM
    Table1
UNION ALL
SELECT
    id,
    colA,
    colB,
    colC,
    NULL AS colD
FROM
    Table2
UNION ALL
SELECT
    id,
    colA,
    colB,
    NULL AS colC,
    colD
FROM
    Table3
"
9994,31356,Complex SQL Query in one table,"SELECT *
FROM MyTable t1
WHERE EXISTS (
    SELECT * FROM MyTable t2
    WHERE t1.LotNumber=t2.LotNumber AND t1.Country <> t2.Country
)
"
18682,25208,In sql is there another way to clear temp db and its log other than restarting the service?,"USE [tempdb]
GO
DBCC SHRINKFILE (N'templog' , 0)
GO
DBCC SHRINKFILE (N'tempdev' , 0)
GO
"
2130,42313,I want to do a UNION with two SELECTS and put inside a table,"FROM (SELECT * FROM Mail.dbo.CheckMe
WHERE Value = '120' OR Value = '220'
UNION
SELECT * FROM Mail.dbo.CheckMeTwo
WHERE Value = '120' OR Value = '220') T
"
25262,3661,Count occurence of values between 2 dynamic dates in MySQL,"SELECT distinct user_id
FROM EventTable e
WHERE EXISTS(SELECT 1 FROM EventTable e2
             WHERE ABS(DATEDIFF(e.date,e2.date)) < 7
              AND e.user_id = e2.user_id)
"
19672,47028,"In sqlite many-to-many example, how to get bookmarks common to 2 tags?","SELECT *
FROM bookmarks
WHERE bm_id IN (SELECT bookmark_id FROM bookmarktag WHERE tag_id = 2
                INTERSECT
                SELECT bookmark_id FROM bookmarktag WHERE tag_id = 3)
"
11806,18518,Change the encoding of a MySQL database,"ALTER DATABASE `test` CHARACTER SET utf8 COLLATE utf8_general_ci;
"
913,67300,Subquery with multiple results combined into a single field?,"  SELECT i.name AS itemname,
         GROUP_CONCAT(s.id ORDER BY s.id) AS salesids,
         GROUP_CONCAT(s.date ORDER BY s.date) AS salesdates,
         GROUP_CONCAT(s.containerid ORDER BY s.containerid) AS containerids,
         GROUP_CONCAT(c.name ORDER BY c.name) AS containertypes
    FROM ITEMS i
    JOIN SALE s ON s.id = i.salesid
    JOIN CONTAINERS c ON c.id = s.containerid
GROUP BY i.name
"
3910,43040,Can't figure out correct SQL query for historical table records,"SELECT t.* 
FROM table t
JOIN (SELECT rid, MAX(revision) MaxRevision FROM table GROUP BY rid) mt
ON t.rid = mt.rid AND t.revision = mt.MaxRevision
"
28182,2488,Postgres SQL script with loop," UPDATE second_table ST
 SET ST.id = FT.id
 FROM first_table FT
 WHERE ST.date BETWEEN FT.run_date + interval '4 hour'
                   AND FT.run_date + interval '4 hour' + interval '1 day'
"
9481,3687,bind's queries per second by an SQL query,"group by to_char(log_time, 'HH24:MI:SS'), log_client
"
23172,73533,Oracle find tablename given an index name,"SELECT table_name
FROM all_indexes
WHERE index_name = 'YOUR_INDEX'
"
6266,35636,SQL counting distinct elements of overlapping sets,"Select Count(column_alias) From
( Select set1 As column_alias From Table1 
Union 
Select set2 From Table1 )
"
9526,7402,select first x records per group,"with cte as (
SELECT 
    p.title as entryname, cname,
    ROW_NUMBER() OVER (PARTITION BY c.id ORDER BY p.id) rn
FROM company c
    INNER JOIN  product p 
    ON  p.cid = c.cid 
WHERE p.title LIKE '%steel%'
GROUP By cname, ca.title    
)
SELECT 
    p.title as entryname, cname,
FROM CTE where rn <= 3
"
7184,692,SQL Logic: Finding Non-Duplicates with Similar Rows,"select DatabaseName
from
(
    SELECT UPPER(ta.DB_NAME) AS DatabaseName
    FROM [CMS].[dbo].[TABLE_A] AS ta
    GROUP BY UPPER(ta.DB_NAME)

    UNION ALL

    SELECT UPPER(tb.DB_NAME) AS DatabaseName
    FROM [CMS].[dbo].[TABLE_B] as tb
    GROUP BY UPPER(tb.DB_NAME) 
) x
group by DatabaseName
having count(*) < 2
EXCEPT
(
    select DN_Name 
    from CMS.dbo.TABLE_C_EXCEPTION
) 
"
8931,32717,Does something like Common Table Expressions exist in PL/SQL?,"with cte as (select * from emp)
select * from cte join dept on dept.deptno = cte.deptno;
"
12802,47632,Generating test table from existing data using SQL,"INSERT INTO table1 (col1,col2,col3,col4,...,col10) VALUES(
  (SELECT col1 FROM table2 WHERE rowid = #) as col1,
  (SELECT col2 FROM table2 WHERE rowid = #) as col2,
  (SELECT col3 FROM table2 WHERE rowid = #) as col3,
  (SELECT col4 FROM table2 WHERE rowid = #) as col4,
  ...,
  (SELECT col10 FROM table2 WHERE rowid = #) as col10,
)
"
34562,16494,Select Query Optimization,"Select top (1) @tId = TransId
From Table1
Where FName = 'Vincent' And LName = 'Hall'
Order By (case when CustId = 1 then 1 else 2 end),
         TimeStamp Desc;
"
27264,12715,SQL query to return records matching 0 or 00 or 000 or ... only,"select * from table
where LEN(field) > 0 and field not like '%[^0]%'
"
7945,54451,Why aggregate functions in PostgreSQL do not work with boolean data type,"SELECT b1 = ANY((SELECT b2 FROM t2 ...)) FROM t1 ...;
"
31886,224,Oracle: How to incorporate NVL to this FULL Join?,"select
race_id,
horse_id,
horse_wins,
jockey_id,
jockey_wins,
NVL(horse_wins, 0) + NVL(jockey_wins, 0) wins
from
proj_entry a
FULL JOIN
tot_h_wins b
ON 
a.horse_id = b.horse
FULL JOIN
tot_j_wins c
ON
a.jockey_id = c.jockey
where 
race_id = 1
"
31723,44744,How Do I Count Unique Rows In Sql Vb.Net,"Using con = new MySqlConnection(....)
Using cmd = new MySqlCommand(""select product, Sum(amount) from tableName GROUP BY product"", con)
   con.Open()
   Dim dt = new DataTable()
   Using dr = cmd.ExecuteReader()
      dt.Load(dr)
      dataGridView.DataSource = dt
   End Using
End Using
End Using
"
37158,44510,Postgresql distinct by priority,"select distinct on (postcards.id)
    postcards.id, postcards.title, rational
from
(
    select
        postcards.id, postcards.title,
        some_complex_condition as rational
    from postcards
) as postcards
order by postcards.id, rational
"
3592,48893,How to get the result of select statement grouped by a column to perform join statement on it?,"SELECT t1.Id, ....
FROM Table1 t1
INNER JOIN 
(
    SELECT Id, COUNT(*)
    FROM Table2 
    GROUP BY Id
) t2 ON t1.Id = t2.Table1Id
"
28563,22761,mysql query returning the same row multiple times,"SELECT off.*
    , resp.tracking_date
    , resp.paid_date
    , resp.total_value
    , resp.total_conversion
FROM tbl_offers AS off
    INNER JOIN tbl_tracking AS tr ON tr.offer_id = off.id
    INNER JOIN tbl_trackvalue AS resp ON resp.tracking_id = tr.id
WHERE off.offer_type = 'cash_offer'
AND tr.user_id = '1454'
AND resp.total_value !=0
AND resp.payment_status = 'paid'
LIMIT 0 , 30
"
35530,22322,Trying to understand the logic of complex SQL queries in MySQL and relational algebra,"select
  dept.did as `department`,
  avg(age) as `avgAge`
from
  dept,works,emp
where
  emp.eid=works.eid and 
  dept.did=works.did
group by
  dept.did
order by
  2 desc
limit 1
"
11961,33326,cursor values in SQL query,"declare
  l_count pls_integer;
begin
  for r_cur in (
    select columnname
    from shiv_tab_col
  )
  loop
    execute immediate 
      'select count(1) from ser_shiv_syn where '||r_cur.columnname||' is null' 
    into l_count;
    dbms_output.put_line(l_count);
    dbms_output.put_line(r_cur.columnname);
  end loop;
end;
/
"
13936,19863,how to set default value for column of new created table from select statement in 11g,"create table t1 (id number default 1 not null);
insert into t1 (id) values (2);

create table t2 (id default 1 not null)
as select * from t1;
"
30902,20781,insert an xml payload into a column as it is,"set @xml = convert(XML,
'
<PostTransAuctionBidsResponse>
  <AuctionBidsResponse>
    <AuctionBidOutput>
      <BidOfferRef>-1</BidOfferRef>
      <Reason>xxx : Provider/Auction/Customer is not valid'</Reason>
      <Provider>HGM</Provider>
    </AuctionBidOutput>
  </AuctionBidsResponse>
</PostTransAuctionBidsResponse>
', 1)

set @Content = convert(varchar(max),@xml, 1)
"
22502,62824,Ordering of columns in where clause when using SQL::Abstract,"#!/usr/bin/perl

use strict; use warnings;

use SQL::Abstract;

my $sql = SQL::Abstract->new;

my ($stmt, @bind) = $sql->select(
    tickets => '*',
    {
        -and => [
            requestor => 'inna',
            status => { '!=', 'completed' },
            worker => ['nwiger', 'rcwe', 'sfz'],
        ],
    }
);

print ""$stmt\n"";
"
31895,28648,SQL - Use results of a query as basis for two other queries in one statement,"SELECT COUNT(*) as totaloccurs, COUNT(@conditions@) as suboccurs
FROM (@total@ as t1)
"
1927,11423,SQL Question: How to avoid 200 If-Else Statements?,"INSERT INTO table3 (username, newprofile) 
SELECT t1.username, t2.newprofile
FROM table1 t1 INNER JOIN table2 t2 ON t1.oldProfile = t2.OldProfile
"
36342,39561,problem with bulk data update in sql,"update table 
set accountno = REPLACE(accountno,',', '')
"
34245,54894,SQL insert and id with auto_increment,"INSERT INTO persons(Column1, col2, ...)
VALUES (16, 'First Name', ...)
"
16317,72997,Limit user in sql plus to a single record in a table,"select * from employee t
where sys_context('USERENV','SESSION_USER') = t.empname`enter code here
"
15031,52050,How to concat values which retrieved from database,"SELECT CAST(DATEPART(dd,GETDATE()) as varchar(10))
  +CAST(DATEPART(mm,GETDATE()) as varchar(10))
  +RIGHT(CAST(DATEPART(YY,GETDATE()) as varchar(10)),2)
"
31129,13813,Sql custom statement,"SELECT SUM(Rly) FROM
(SELECT ID, CASE WHEN Accident.Rly = 'CR' THEN 1 ELSE 0 END Rly
FROM Accident)
"
7471,68589,Need to use SQL variable to define namespace for XML.Value selection,";WITH XMLNAMESPACES ('http://www.test.org/xml/' as test, 'http://www.test.org/xml/' as test2)
SELECT id,
       name,
       [XML].value('(//test:Address[1][test2:Global=1]/test:Street)[1] ', 'varchar(max)') AS streetLocation1,
       [XML].value('(//test:Address[2][test2:Global=1]/test:Street)[1] ', 'varchar(max)') AS streetLocation2 
FROM  TEST
"
18092,32467,Trim numbers after decimal in SQL in my equation,"select c.claimnumber, 
       to_char(c.RECEIPTDATE,'mm/dd/yyyy') as receiptdate,
       trunc(sysdate - c.RECEIPTDATE) as daysbetween
from claim c
where c.RECEIPTDATE > sysdate -10 
"
32940,8889,Looping through column names with dynamic SQL,"Declare @sql varchar(max) = ''
declare @tablename as varchar(255) = 'test'

select @sql = @sql + 'select [' + c.name + '],count(*) as ''' + c.name +  ''' from [' + t.name + '] group by [' + c.name + '] order by 2 desc; ' 
from sys.columns c
inner join sys.tables t on c.object_id = t.object_id
where t.name = @tablename

EXEC (@sql)
"
187,64198,How can I get the last position of my Technical in this query?,"SELECT P.Longitud, P.Latitude, P.idTecnico
FROM Posicion P
INNER JOIN (Select max(Uptade_at) maxUptade_at, IdTechnico from Posicion group by IdTecnico) P2
on P.IDTecnico = P2.P.IdTecnico
and P.Uptade_at = maxUptade_at
"
956,75555,How to use variable in SQL statements and assign answer to variable,"name = db.execute ""SELECT price FROM Products WHERE product_code = ?"", bind_variable_here
"
22118,29211,How to perform Oracle sql order by with captial case string,"select city_name
from city
order by (case when city_name=upper(city_name) then 2 else 1 end),
         city_name;
"
38365,63468,Max count by customer and category,"select Account, ProductCategory
from (select Account, ProductCategory, count(*) as cnt,
             row_number() over (partition by Account order by count(*) desc) as seqnum
      from table t
      group by Account, ProductCategory
     ) apc
where seqnum = 1;
"
34959,49166,SQL - OVER and ORDERBY,"SELECT Foo.*,
    ROW_NUMBER() OVER (
        ORDER BY 
            NULL ASC,
            Foo.MeetingDate DESC
    ) AS RowOrder
"
1746,4293,access form checkboxes populate sql in vba,"Private Sub CommandButton1_Click()
  Dim strSQL = ""select * from mytable where 1=1""
  Dim cCont As Control
  For Each cCont In Me.Controls
      If TypeName(cCont) = ""Checkbox"" And cCont.Checked Then
          strSQL = strSQL + "" or year="" + cCont.Text
      End If
  Next cCont
"
9779,42283,SQL - Rounding decimals from a count sum without a column,"cast((COUNT(v.id) * r.res_cpm/1000)as decimal (10,2))
"
28065,32073,Cost of clustering index vs non-clustering,"select r.* from R where R.a = 100
"
27455,74217,A more readable way of writing the following SQL query,"SELECT avgbefore - avgafter
FROM ( 
    SELECT avg(CASE WHEN year < 1980 THEN avgs ELSE null END) as avgbefore,
           avg(CASE WHEN year >= 1980 THEN avgs ELSE null END) as avgafter
    FROM averages
) t
"
28615,72030,how to add a sub select query,"SELECT TSTVersion_ID, 
       xTSTVersions.TSTVersion,
       TSTPatch,
       Licenses.Program
FROM xTSTVersions
INNER JOIN (SELECT TSTVersion    
          FROM xTSTVersions
          GROUP BY TSTVersion 
      HAVING count(TSTVersion) = 1) dup
ON xTSTVersions.TSTVersion = dup.TSTVersion
INNER JOIN Licenses
ON xTSTVersions.TSTVersion_ID = Licenses.TSTVersion_ID
"
2263,33646,Oracle Query - Selecting records using column data from first table,"select *
from table1 as t1
where dbms_xmlgen.getxmltype('select * from ' || 
                             t1.table2name ||
                             ' where datetocheck > add_months(sysdate, -6)
').extract('//text()').getstringval() is not null
"
402,41207,Add users and groups to other groups and get all the hierarchy to top using sql,"    WITH UserBelongTo (Type,EntityID,GroupID)
AS
(
    select a.Type, a.EntityID, a.GroupID from Groups a 
    where a.EntityID in  (select Groups.GroupID from Groups where EntityID=1 and Type=1)
    and a.Type=2

    union all
    select a.Type, a.EntityID, a.GroupID from Groups a 
    inner join UserBelongTo c on c.GroupID=a.EntityID
    where  a.Type=2
)   

select distinct  * from UserBelongTo
"
14690,15948,SQL Query / Stored proc to count monthly average of daily sums,"select yr, mon, avg(amt)
from (SELECT extract(year from tdate) as yr, extract(month from tdate) as mon,
             extract(day from tdate) as day,
             SUM(IIF(INOUT = 0, AMOUNT, -AMOUNT)) as amt
      FROM PETTYCASH
      WHERE TDATE < '2012-01-01'
      group by extract(year from tdate), extract(month from tdate),
               extract(day from tdate)
     ) t
group by yr, mon
order by yr, mon
"
20367,26173,TSQL Max in a Range,"SELECT foo1, foo2, foo3, field_etc, max(Score) MaxScore
 from (select foo1, foo2, foo3, field_etc, Score1, Score2, Score3, Score4, Score5
        from SomeTable) base
  unpivot (Score
           for WhichScore
           in (Score1, Score2, Score3, Score4, Score5)) upvt
  group by foo1, foo2, foo3, field_etc
"
2702,22330,Creating a dynamic table from dynamic SQL,"declare @query varchar(max) = 
'select * into #t from table'
EXEC(@query) 
select * FROM #t
"
5793,8822,Having/Where clause not working for Haversine Formula using Microsoft SQL,"select * FROM (SELECT *, ( 3960 * acos( cos( radians( 33.650800 ) ) *
cos( radians( Latitude ) ) * cos( radians(  Longitude  ) - radians( -117.891729 ) ) +
sin( radians( 33.650800 ) ) * sin( radians(  Latitude  ) ) ) ) AS Distance 
FROM test) as T WHERE T.Distance < 10
"
14452,70855,Creating a view that consist column with static info,"CREATE VIEW TEST AS 
(
    SELECT a.ID, a.E_ID, b.CAT1 as C1, c.CAT1 as C2, 'NL' AS add1, 'RS' AS add2
    FROM RECP a
    JOIN ART  b on (a.ID=b.SKU)
    JOIN ART  c on (E_ID=c.SKU)
)
"
16236,74579,Teradata equivalent for lead and lag function of oracle,"SELECT CALENDAR_DATE
     , MAX(CALENDAR_DATE)
       OVER(PARTITION BY 1 ORDER BY CALENDAR_DATE
            ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING) AS Lag_ --Yesterday
     , MIN(CALENDAR_DATE)
            OVER(PARTITION BY 1 ORDER BY CALENDAR_DATE
            ROWS BETWEEN 1 FOLLOWING AND 1 FOLLOWING) AS Lead_ --Tomorrow
FROM SysCalendar.CALENDAR
WHERE year_of_calendar = 2011
  AND month_of_year = 11
"
31447,38270,Join Two Tables and then Group By,"SELECT
    cn.country_name,
    COUNT(DISTINCT c.c_id) AS count_of_cities
FROM
    COUNTRY cn LEFT JOIN
    CITY c ON c.id = cn.id
GROUP BY cn.country_name
"
30734,8823,Efficient lookup in a range table,"select organization from (
    select ip_end, organization
    from iptable
    where ip_start <= 1234
    order by ip_start desc
    limit 1
) subqry where 1234 <= ip_end
"
3619,72216,"How to query two different fields from a table, and make it appear in the same row?","Select table1.Stuff, B.Vales as Value1, C.Values as Value2
 From table1, table2 as B, table2 as C
   Where table1.foreing = B.id_table and table1.foreing2 = C.id_table
"
4072,64571,SQLite Database Update Needs Application to ReOpen to Actually Show New Values,"String sql = ""UPDATE "" + DATABASE_TABLE + "" SET "" + KEY_ANSWER_1_COUNT + "" = ?, "" +KEY_ANSWER_2_COUNT + "" = ?, "" + KEY_ANSWER_3_COUNT + "" = ? WHERE "" + KEY_FORM_NO + "" = ? AND "" + KEY_QUESTION_NAME + "" = ?"";
Cursor c = db.execSQL(sql, new String[]{answer_1_count, answer_2_count, answer_3_count, form_no, question_name});
"
16104,34457,mySQL: Updating multiple values in a record with a SELECT from another table,"UPDATE `foo`, `bar`
SET `foo`.`x` = `bar`.`x`, 
    `foo`.`y` = `bar`.`y`, 
    `foo`.`z` = `bar`.`z`
WHERE `id` = 'baz';
"
25090,66446,Order by best match then by name,"ORDER BY CASE WHEN col like 'foo%' THEN 1 ELSE 2 END,col
"
6793,54504,Map integer(id) to text string?,"SELECT *, CASE type WHEN 1 THEN 'abc' WHEN 2 THEN 'xyz' END as stringType
FROM orders
"
8127,30928,Query on YAML in MySQL,"UNIX_TIMESTAMP(
  SUBSTRING(customers.preferences, 
    LOCATE(\""last_changed_prefs_at\"", cusstomers.preferences) + 22, 29)
) BETWEEN UNIX_TIMESTAMP(:period_start) AND UNIX_TIMESTAMP(:period_end)
"
7410,27004,Reordering data in a table,"declare @maxcoord int;
declare @rowid int; set @rowid = 35395

select @maxcoord = max(value) from table where row = @rowid

update table set value = @maxcoord - value 
where row = @rowid
"
30348,48714,How to Count Sub Comments from the same table,"SELECT c1. * , COUNT( c2.parent_id ) 
FROM comments c1
LEFT JOIN comments c2 ON c2.parent_id = c1.comment_id
WHERE c1.parent_id IS NULL 
AND c1.thread_id =122
GROUP BY c1.comment_id
ORDER BY c1.date_comment ASC
"
12172,29570,Update Multiple Rows using CASE statement,"UPDATE Staging_X 
SET [NoMaterial] = 
    case when [Up]+[Test]+[Mon]+[Down_percentage]=0 
    then 168 else [Lost]*1.68 end
WHERE [NoMaterial] is null
"
22786,66626,Creation date column in SQL table,"ALTER TABLE table
ADD column NOT NULL DEFAULT (GETDATE())
"
27939,32554,Select the just-inserted record with a composite Primary Key,"Declare @NewSeqTable Table( Order_Seq int not null )

Insert MyTable( some_id, order_seq, otherPkCol, otherPkCol2 )
Output inserted.order_seq Into @NewSeqTable
Select @some_id, Max( order_seq ) + 1, otherPkCol, otherPkCol2
From MyTable
Where some_id = @some_id

Select Order_Seq
From @NewSeqTable
"
14178,10255,How to run the following Oracle exec statements in SQL Developer?,"DECLARE
    output1 NUMBER;
    output2 VARCHAR2(100);
BEGIN
    rp_orader_closure_pxkg.rp_exaec_close_SILvl_WKO('aaa', '1', 
        '10aaa001a6414339', output1, output2);
END;
"
20937,64220,Update Table Set From is not working as expected,"update p
set Parent_Item_NBR = p1.item_nbr
from project p
join project p1
on p.serial_num = p1.serial_num
and isnull(p.parent_seqno,1) = p1.seqno
"
21042,18439,I can't get mysql to return last row when using the aggregate MIN,"SELECT underlying,volatility,price FROM shares
where (id,price) IN (
    SELECT id,MIN(price) FROM shares
    where DATE(issueDate) >= DATE(NOW())
    group by id
) order by price asc limit 1;
"
28610,27195,Using case to select field based on value of another field,"SELECT b.Bookingtype, b.Bookingnum
     , COALESCE(main.date, b.date) AS date
FROM   bookings b
LEFT   JOIN bookings main ON b.Bookingtype = 'sub'
                         AND main.Bookingnum = left(b.Bookingnum, 4);
"
4434,25410,"Strange SQL result order by date, count(date)","SELECT 
    MAX(date) AS maxdate, 
    COUNT(date) AS anzahl 
FROM 
    pointLog 
WHERE 
    uid = 1 ;
"
29387,1102,Repositioning columns in DBGrid in Delphi,"function GetColumn(aGrid : TDBGrid; aFieldName : string) : TColumn;
var
  I : integer;
begin
  for I := 0 to DBGrid.Columns.Count-1 do
    if aDBGrid.Columns[I].FieldName = aFieldName then
    begin
      Result := aDBGrid.Columns[I];
      exit;
    end;
  Result := nil;
end;
"
13788,68014,Can't think of a query structure to normalize this table,"UPDATE
  city_state cs
  INNER JOIN state s ON s.StateAbbr = cs.State
SET
  cs.StateID = s.StateID
"
14685,44851,Insert using single insert statement,"Query
INSERT INTO tblSubscriptions (UserID, ProductID, IsActive, SubscriptionDays, Price, MonthlyPrice, ProductType, CurrencyID)
SELECT UserID, 7, 1, 0, 0, 0, 30, 1 FROM tblUser WHERE ISNULL(SubscriptionType, 0) IN (1, 0)
"
8608,3055,Conditional Split in SSIS based on the number of times a character appears in a string,"LEN([email]) - LEN(REPLACE([email], ""@"", """"))
"
3424,69222,How to combine two simple sql queries,"SELECT p.avatar
from person p join
     person_magazine pm
     on pm.person_id = p.id join
     magazine m
     on pm.magazine_id = m.id
where p.newsletter = 1 and m.name = 'Web Designer'
"
34557,28875,sql query returning invalid rows,"select distinct tz.zip,td.DTV_eligible,tu.cuid,tu.actvty_date
from T_ZIP5 tz left join T_DTV_CNTY_ELIGIBILITY td on tz.FIPS_CNTY=td.CNTY_FIPS 
left join T_USER_ACTIVITY tu on tz.zip=tu.zip
where tz.FIPS_CNTY='51001' 
"
21250,29399,Database scheme for searching my age groups,"select *
from your_table
where $n between coalesce(lower_age, $n) and coalesce(upper_age, $n)
"
33499,35961,how to find out log size of each of the database in sql server 2005?,"EXECUTE sp_msforeachdb 'SELECT *, GETDATE() FROM [?].sys.database_files'
"
39953,13816,Use of REPLACE in SQL Query for newline/ carriage return characters,"DECLARE @var NVARCHAR(255), @i INT;

SET @i = 1;

SELECT @var = AccountType FROM dbo.Account
  WHERE AccountNumber = 200
  AND AccountType LIKE '%Daily%';

CREATE TABLE #x(i INT PRIMARY KEY, c NCHAR(1), a NCHAR(1));

WHILE @i <= LEN(@var)
BEGIN
  INSERT #x 
    SELECT SUBSTRING(@var, @i, 1), ASCII(SUBSTRING(@var, @i, 1));

  SET @i = @i + 1;
END

SELECT i,c,a FROM #x ORDER BY i;
"
25755,28582,Restoring a backup using SQLCommand in VB.NET,"string connStr = ""Data Source=(local);Initial Catalog=db;
       Integrated Security=SSPI;Connection Timeout=30"";
"
10926,6111,Oracle SQL: How do I convert the substrings in a string using to_char,"SELECT regexp_replace(regexp_replace ('234234234.88, 24444.88, 54523234.78, and 1044.52 are numbers in this example.', 
'(([0-9]{3})\.)',
',\1'),'(([0-9]{3}),)',',\1')
FROM dual
"
24639,50649,SQL SERVER DATETIME FORMAT,"set language french
select cast(getdate() as varchar(50))
-->
févr 8 2013 9:45AM
"
25482,28712,Getting always 0 rows when using @@ROWCOUNT before IF EXISTS statement,"  SELECT TOP 1 1 FROM Provider.Site
  SELECT @@ROWCOUNT; --Returns 1

IF EXISTS (SELECT TOP 1 1 FROM Provider.Site) --Returns one row.
    SELECT @@ROWCOUNT; --Returns always 0
"
250,46552,Mysql left join to get unique topics,"SELECT t.topic_id
     , IF(l.user_id IS NULL, 0, 1) AS liked
FROM topic t LEFT JOIN like l ON t.topic_id= l.topic_id AND l.user_id = ?
"
39807,53113,How can you format a persisted column as a padded integer string [SQL Server 2008],"SELECT RIGHT('00000' + CAST(ID AS VARCHAR(5)), 5) + RefNum
"
26867,54047,Multiple rows concatenated in sql,"select distinct t1.id,
  STUFF((SELECT distinct '+ ' + t2.data
         from yourtable t2
         where t1.id = t2.id
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,2,'') data
from yourtable t1;
"
11208,26778,SQL Server : USE database precedence issue,"IF EXISTS(select * from sys.databases where name='MyDB')
 BEGIN
   EXEC('
     USE MyDB
     EXEC(''
       DROP USER [tester]
        .
        .
        . 
     '')  
   ')
 END
ELSE
 PRINT 'MyDB database is not available'
"
7906,27527,for-loop add columns using SQL in MS Access,"Sub toto()
    Dim db As Database, i As Integer
    Set db = CurrentDb
    For i = 1 To 10
        db.Execute "" ALTER TABLE time_series "" _
                    & ""ADD COLUMN F_"" & i & "" Number;""
    Next i
    Set db = Nothing
End Sub
"
33049,16461,MYSQL Copying One Table to Another Table With Conversion of Columns,"INSERT INTO new_database.table1 (id, product, is_default) 
SELECT id, product, IF(is_default='Y',1,0) as isdefault FROM old_database.table1
"
1702,72978,Counting multiple columns with the same criteria,"select t1.name, 
count(case when t1.alpha ='T' then 1 end),
count(case when t1.bravo='T' then 1 end),
count(case when t1.charlie='T' then 1 end)
from t1
group by name
order by name asc;
"
18141,20667,get empty result from sql query,"SELECT    p1.cost AS V1, p2.cost AS V2 , p3.cost AS V3 
FROM      product p1
LEFT JOIN product p2 on p2.id = 2
LEFT JOIN product p3 on p3.id = 3
WHERE     p1.id = 1
"
16405,61682,Converting varchars into two points Decimal value by using SQL,"SELECT 
    CAST(
        CONCAT(SUBSTRING(test_value,1, LENGTH(test_value) -2),
               '.',
               SUBSTRING(test_value, LENGTH(test_value) -1, 1))
    AS DECIMAL(7,1))
FROM TEST
WHERE SUBSTRING(test_value, LENGTH(test_value)) = 'A' 
|| SUBSTRING(test_value, LENGTH(test_value)) = 'H'
-- keep adding above line for the rest of the ending characters you want
"
39200,57334,Using the MIN function in the having clause,"SELECT *
FROM(SELECT first_name, salary
     FROM Employees
     ORDER BY salary
) WHERE ROWNUM = 1
"
1591,42388,How to Select foreign key names instead of number in SQL Server,"SELECT
   cad.id, cad.name, cad.gender, cad.age,
   professional.name,
   agegroup.desc,
   ativity.name
FROM cad INNER JOIN professional ON cad.fok_professional = professional.id
         INNER JOIN agegroup ON cad.fok_agegroup = agegroup.id
         INNER JOIN ativity ON cad.fok_ativity = ativity.id
"
32594,60422,"Equally divide resultset into groups, with cursor or not?","SELECT  *,
        NTILE((SELECT CAST(CEILING(COUNT(*) / 6.00) AS INT) FROM drivers)) OVER (ORDER BY id) AS heat
FROM    drivers
"
32872,43507,Excluding a Null value returns 0 rows in a sub query,"select * 
from tbl_A A
where not exists (select distinct ID 
                  from tbl_B b
                  where a.id = b.id)
"
35512,32248,"String truncate on length, but no chopping up of words allowed","SELECT
  LEFT(str, cutpos) AS str1,
  SUBSTRING(str, cutpos + 1) AS str2
FROM (
  SELECT
    @str AS str,
    @len - IFNULL(NULLIF(LOCATE(' ', REVERSE(LEFT(@str, @len))), 0) - 1, 0) AS cutpos
) s
"
7046,54460,"SQL Return Unique Count from 3 Columns - DateTime, Vehicle, Driver","SELECT
    m.CurrentDateTime, v.VehicleName, count(distinct m.Driver)
FROM
    Vehicles AS v INNER JOIN
    MainData AS m
    ON l.VehicleID = m.VehicleID
WHERE
    v.VehicleName = 'Car 1' 
GROUP BY
    m.CurrentDateTime 
    , v.VehicleName
ORDER BY 
    m.CurrentDateTime 
    , v.VehicleName
"
8921,18105,What is the mysterious 'timestamp' datatype in Sybase?,"varbinary(8) null
"
15641,67180,Select rows from table where value in column appears ones,"SELECT colnum, coldate,colid 
FROM 
( 
 select *,COUNT(1) OVER (PARTITION BY colnum) as cnt 
from (SELECT DISTINCT colnum, coldate,colid from testing ) t
) q
where  q.cnt=1 and q.coldate in ('2015-01-01') and q.colid = 1
"
9815,63086,Select data from two rows of the same table,"SELECT 
  rec_prison.location as 'Recieving Location',
  cur_prison.location as 'Current Location'
FROM TransferRequest tr
INNER JOIN Prison rec_prison 
  ON rec_prison.prisonID = tr.receivingPrison 
INNER JOIN Prison cur_prison 
  ON cur_prison.prisonID = tr.currentPrison;
"
21069,27072,SELECT a data using a keyword that exists in all columns (SQL),"   select 
    mytable.* , FROM mytable
JOIN
( 
    select 
      id, 
      IFNULL(col1,'')+IFNULL(col2,'')+...+IFNULL(colN,'') concatenated
      FROM mytable
) T ON T.Id = mytable.Id
where   t.concatenated like '%x%'
"
2202,25785,Group by after left and inner joins,"SELECT e.Type as DT, count(*) as count
FROM
[RawGps32.T20160601] c
LEFT JOIN
[VN_20160601] d
ON c.Id1 = d.Id1
INNER JOIN [SF.DT] e
ON d.Id1 = e.Id1
WHERE c.Id1 in (3928,3602,1285,4663,96546)
GROUP BY e.Type
ORDER BY e.Type
"
18856,25801,Selecting maximum column and row id,"SELECT MAX(a.seq), (SELECT id FROM t1 as b where b.ident=a.ident AND MAX(a.seq) = b.seq LIMIT 1) as id FROM t1 AS a GROUP BY a.ident;
"
32232,21514,Access 2003 Query Dilemma,"    GROUP BY Roster.UserID, 
        EventLog.Type, 
        IIf([EventLog]![LogType] Like ""Acc*"" And 
[EventLog]![Action] Like ""Wri*"",[EventLog]![Date],Date()-183)
"
2744,48356,SQL multiple Select ... where id in and a DISTINCT,"SELECT DISTINCT TP_Test_Info.id, TP_Test_Info.name
FROM TP_Test_Info
JOIN TP_Test_Sections 
  ON TP_Test_Sections.test_id = TP_Test_Info.id
JOIN TP_Test_Questions 
  ON TP_Test_Questions.section_id = TP_Test_Sections.id
JOIN TP_Student_Answers 
  ON TP_Student_Answers.question_id = TP_Test_Questions.id
WHERE TP_Student_Answers.student_id = 751
"
31878,24196,"Doctrine query : confusing addWhere, andWhere, orWhere","$q->andWhere('(l.ldap_group_id IN ( ' . implode("","", $permissions_id) . ') OR l.ldap_group_id IS NULL )' );
"
16852,18457,"Depents on the declared values,List the records","where ( 
   (@BranchID is null and od.DebtIsPayed=@DebtIsPayed)
or (@DebtIsPayed is null and og.BranchId=@BranchId)
) and (@PaymentDate is null or PaymentDate > @PaymentDate )
"
7768,22476,SQL Server sp_ExecuteSQL and Execution Plans,"SELECT usecounts, cacheobjtype, objtype, text, query_plan, value as set_options
FROM sys.dm_exec_cached_plans 
CROSS APPLY sys.dm_exec_sql_text(plan_handle) 
CROSS APPLY sys.dm_exec_query_plan(plan_handle) 
cross APPLY sys.dm_exec_plan_attributes(plan_handle) AS epa
where text like '%Some unique string in your query%' 
                                          and attribute='set_options'
"
20581,58579,Is there a generic workaround to express a derived column list in Oracle (and MySQL)?,"SELECT null AS a, null AS b, null AS c FROM dual WHERE false
UNION ALL
SELECT <expr>, <expr>, <expr>
FROM <realtable>...
"
39552,64595,Getting 2 different records rows in the same sql join,"SELECT u.name
     , u.picture_url
     , m.id_user_winner
     , m.id_user_loser
     , e.name
     , e.picture_url
     , m.date_match 
FROM matches m JOIN users u ON u.id_user = m.id_user_winner AND u.id_user = 3
               JOIN users e ON e.id_user = m.id_user_loser
"
23749,11523,Using the results of a stored procedure in a loop with a condition,"$Active = invoke-sqlcmd ""sp_whoisactive"" -database $DATABASE -serverinstance $SQLSERVER     -verbose
    If ($Active) {
        ""There is something active on the database server. Stopping.""
        }
    Else {
         ""There is nothing active on the database server."" }
"
24571,65305,Update of each row with random row value,";WITH n1 AS (SELECT Name, rn = ROW_NUMBER() OVER (ORDER BY Name)    FROM #Name),
      n2 AS (SELECT Name, rn = ROW_NUMBER() OVER (ORDER BY NEWID()) FROM #Name2)
UPDATE n1 SET Name = n2.Name
  FROM n1 INNER JOIN n2 ON n1.rn = n2.rn;
"
25769,15627,SQL: pointing a duplicate data,";WITH CTE_Duplicates1 AS
(
SELECT MIN(ID) OVER (PARTITION BY col1, col2) Mn,
       ROW_NUMBER() OVER (PARTITION BY col1, col2 ORDER BY ID) Rn,
       *
FROM tableA       
)
UPDATE CTE_Duplicates1
SET qnxtStatus = 'Duplicate of ID =' + CAST(Mn AS VARCHAR(11))
WHERE Rn > 1
"
699,4032,HSQLSB - Select a random row from a db,"SELECT p.name as foo
From Playlist p
ORDER BY RAND() LIMIT 1
"
23406,24930,Selecting rows with max attribute value,"SELECT * From Table1 T
         JOIN (SELECT clientid,Max(version) As MVer 
               From Table1 Group By clientid) S
         ON T.clientid = S.clientid And T.version  = S.MVer
"
33953,61036,Access to SQL: IFF function,"CASE WHEN SomeColumn = 'CR' THEN 'credit'
     WHEN SomeColumn = 'NCR' THEN 'non-credit'
END
"
32881,52364,NUMTODSINTERVAL in PostgreSQL,"select cast(num || unit as interval)
"
23117,15212,How to write following Select in sqlite,"SELECT a.id FROM a 
       WHERE a.bar=''  
          OR a.bar IN (SELECT b.barcode FROM b WHERE b.barcode='active')
"
30945,43049,How do I issue SELECT queries on both tables in an M:N relationship?,"select b.title, a.name
  from authors a
  join books_authors_link bal
    on a.id = bal.author_id
  join books b
    on b.id = bal.book_id
"
4001,25065,LINQ to SQL Left Outer Join,"var query = from c in db.Customers
            join o in db.Orders
               on c.CustomerID equals o.CustomerID into sr
            from x in sr.DefaultIfEmpty()
            select new {
               CustomerID= c.CustomerID, ContactName=c.ContactName,
               OrderID = x.OrderID == null ? -1 : x.OrderID};   
"
13949,9331,Extract Unique Pairs from Table Containing Reciprocal Relationships,"select distinct
    case when Person1 > Person2 then Person2 else Person1 end as Person1,
    case when Person1 > Person2 then Person1 else Person2 end as Person2
from
    couples
where
    relationshiptype = 'Married'
"
33859,19674,A for loop in MYSQL WHERE clause?,"SELECT name, surname, id 
FROM person
WHERE id in(1, 2, 3, 4);
"
23081,12604,"PostgreSQL, splitting to rows and recognizing the first part","SELECT t1.id, value,
       (case when values like value || '%' then 'yes' end) as first
FROM (SELECT t1.id,  t1.values,
             regexp_split_to_table(t1.values, E',') as value
      FROM t1
     ) t1;
"
20559,62955,Import data from another table with Common Fields,"update table2 set identity = (select 
    identity from table1 where act_num = table2.act_num);
"
7555,52370,check if a value exists in array of constants in oracle,"if v_type IN ('ABC','DEF','ASD') then
  do things;
end if;
"
19914,50734,Mysql group_concat with distinct values from another row,"SELECT
  SUM(amount) totalamount,
  GROUP_CONCAT(amount) amounts,
  GROUP_CONCAT(doc_number) docno,
  doc_date docdate,
  scheme_description schemedesc
FROM (
  SELECT scheme_description, doc_date, doc_number, SUM(amount) amount
    FROM credit_notes
    GROUP BY scheme_description, doc_date, doc_number) t
GROUP BY scheme_description, doc_date
"
37096,33031,Mssql grouping by a column and joining it with the amount of occurances there exist in the table,"select My_column, count(1) as cnt
from my_table
group by My_column
"
25760,59947,Microsoft SQL Querying Hours in Timestamp,"SELECT *
    FROM YourTable
    WHERE DATEPART(hh, YourColumn) BETWEEN 18 AND 20
"
24339,15960,How to Update the Date without changing its Time Using SQL Server?,"UPDATE
   MyTable
SET
   StockDate = DATEADD(day, DATEDIFF(day, StockDate, '20110930'), StockDate)
WHERE
   ...
"
22032,40854,"Can MYSQL filter by date if date is stored as text? ex ""02/10/1984""","AND STR_TO_DATE(cfv0.value, '%m/%d/%Y') >= STR_TO_DATE('01/02/2004', '%m/%d/%Y')
"
26712,1431,Sort columns based on the order inside SQL in function,"ORDER BY CASE WHEN ID = 12 THEN 1
              WHEN ID = 6 THEN 2
              WHEN ID = 4 THEN 3
              WHEN ID = 3 THEN 4
              WHEN ID = 13 THEN 5
              ELSE 6
         END, ID
"
5124,8529,Can I check that two sub query return the same result without using stored procedure?,"select OtherObjId, active
from MyTable
where ObjId = 1
except
select OtherObjId, active
from MyTable
where ObjId = 54
"
35590,36681,Django DB API equivalent of a somewhat complex SQL query,"from django.db.models import Max
mail_list = Mail.objects.values('conversation_id').annotate(Max('id'))
conversation_id_list = mail_list.values_list('id__max',flat=True)
conversation_list = Mail.objects.filter(id__in=conversation_id_list)
"
9421,29553,SQL: And / or matches with a many-to-many join,"SELECT * FROM photos p
WHERE 1=1
AND EXISTS ( SELECT * FROM photos_term pt
    WHERE pt.photo_id = p.id AND term_id IN (1,2)
    )
AND EXISTS ( SELECT * FROM photos_term pt
    WHERE pt.photo_id = p.id AND term_id IN (3,4,5)
    )
AND EXISTS ( SELECT * FROM photos_term pt
    WHERE pt.photo_id = p.id AND term_id IN (6)
    )
    ;
"
7336,68224,how to catch NULL values using case statement,"select contactid,Title,FirstName,MiddleName,
case ISNULL(MiddleName, 'NULLVALUE')
when 'R.' then 'Robert'
when 'B.' then 'Bids'
when 'J.' then 'John'
when 'NULLVALUE' then 'New Name'
else 'No Name'
end, LastName from Person.Contact
"
11228,20000,How to make a clean Join using different colums without duplicates,"SELECT 
  s.student_name,
  e.class_name 
FROM 
  student s 
  LEFT JOIN enrolled e ON s.student_id = e.student_id 
GROUP BY student_name;
"
17406,10661,Select a group of records that are the last one to their own type,"  select lch.ChequeID,max(lch.Date),lch.HolderID  
  from LCheque lch
  group by lch.ChequeID,lch.HolderID  
"
16020,25303,Foreach in MYSQL,"SELECT Min(`Age`)  AS `Lowest Age`, 
       `Rating` 
FROM   `SAILORS` 
GROUP  BY `Rating` 
"
1378,3165,Excel Postgresql Database Connection Use Cell as Date,"SELECT usda_cattle_auctions.weight_average, usda_cattle_auctions.average_price
FROM public.usda_cattle_auctions usda_cattle_auctions
WHERE (usda_cattle_auctions.report_date>= ? And usda_cattle_auctions.report_date<={d '2014-10-25'}) AND (usda_cattle_auctions.state='CO') AND (usda_cattle_auctions.gender='Steers') AND (usda_cattle_auctions.class_type='Feeder')
ORDER BY usda_cattle_auctions.report_date DESC
"
21535,74919,Select rows until to amount,"SELECT o.id, o.name, o.price, o.date
FROM (SELECT o.id, o.name, o.price, o.date, (@totalPrice:=@totalPrice + o.price) totalPrice
      FROM offers o, (SELECT @totalPrice:=0) A
      ORDER BY o.date
     ) AS o
WHERE o.totalPrice <= 1500
"
26453,75161,MySQL three table join,"SELECT t2.userid, t2.revid, t2.revdes, t2.mobile, t3.revloc,
    t1.mobile IS NOT NULL AS inTable1
FROM Table2 t2 LEFT JOIN Table1 t1
    ON t2.mobile = t1.mobile
LEFT JOIN Table3 t3
      ON t2.revid = t3.revid
WHERE t2.userid = 2
"
16502,73672,How do you populate database in firebase?,"var ref = new Firebase(""https://YOUR_FIREBASE_URL.firebaseio.com/"");
ref.update({message:""Hello""});
"
19638,15941,Merging multiple rows into one row,"Create FUNCTION [dbo].[GetResults] 
(
    @ID int
)
RETURNS varchar(200)
AS
BEGIN
    DECLARE @Result varchar(200)

    SELECT @Result = COALESCE(@Result + ', ','') + Value
    From
        (   
            SELECT  Value
            FROM       MyTable
            WHERE     (ID > @ID)

        ) UniqueValues

    RETURN @Result

END
"
17544,48026,Concatenate second field with first field in mysql query,"select t1.id, t1.year, t1.id2,
    group_concat(distinct t2.year1 order by t2.year) year1,
    group_concat(distinct t2.year2 order by t2.year2) year2
from mytable t1
join mytable t2 on t2.id = t1.id 
    and t2.year = t1.year 
    and t2.id2 <= t1.id2
group by t1.id, t1.year, t1.id2
order by t1.id, t1.year, t1.id2
"
38148,62426,How to use not exists in a sql query with w3schools?,"select o1.customerid
      ,o1.shipperid
from orders as o1
where o1.shipperid = 1 
and not exists (
    select o2.orderid 
    from orders as o2
    where o1.customerid = o2.customerid
    and o2.shipperid = 3)
order by customerid
;
"
18382,30976,SQL query with a CASE statement,"UPDATE myTableName
   SET myColumnValue=myColumnValue + .5
 WHERE ID = 'someIndex'
   AND ([In] <= '12/1/2011' ) 
   AND ([Out] >= '12/7/2011' )
"
9713,68416,"Using ""case"" with ""or"" in a where clause","select Nom
from tab
where (
    libelle != ''
    and (
        Nom like Nom1
        or Nom like Nom2
    )
)
or (
    libelle = ''
    and Nom like Nom3
)
"
9445,59945,"Oracle - Transferring records between two instances, via synonyms?","COPY FROM username/password@hostname:port/SERVICENAME TO username_owner/password@hostname:port/SERVICENAME APPEND TABLE1 USING SELECT * from TABLE1;
"
7966,68470,"postgresql way to insert row with ""ON CONFLICT"" clause semantics","/**
CREATE TABLE foo(id serial primary key, content text unique);
**/

WITH replace AS (
    DELETE FROM foo
    WHERE
        content = 'bar'
    RETURNING content
)
INSERT INTO 
    foo(content) -- values:
SELECT
    *
FROM replace RIGHT JOIN (SELECT CAST('bar' AS text) as content) sub USING(content);
"
34477,57167,How can I create a CHECK constraint on a VARCHAR column in SQL Server specifying a minimum data length?,"ALTER TABLE [dbo].[YOUR_TABLE]
ADD CONSTRAINT [MinLengthConstraint] CHECK (DATALENGTH([your_column]) > 2)
"
12341,30459,Simple explanation for UNION,"select * from A
union  -- or union all
select * from B
"
2345,31489,transferring data from table to table after deleting them,"INSERT INTO table_2 (id,name,salary)
SELECT id,name,salary
FROM dbo.table1
"
17855,64268,SQL: how to get rows containing only certain ids?,"SELECT `group` 
FROM myTable
GROUP BY `group`
HAVING GROUP_CONCAT(DISTINCT `user` ORDER BY `user`) = '1,2';
"
24656,27547,Sql Server select with regular expression,"SELECT SUBSTRING(column1,0,(CHARINDEX('.',column1,CHARINDEX('.',column1)+1))) 
FROM Table1
"
11008,736,Select where item contains all tags but does not have any unwanted tags,"SELECT * FROM media
INNER JOIN media_tags ON media_tags.media_id = media.id
INNER JOIN tags ON (tags.id=media_tags.tag_id)
WHERE (tags.name = 'object' OR tags.name = 'vehicle')
AND 0 = (
  SELECT COUNT(*)
  FROM tags as T1
  WHERE T1.id = media_tags.tag_id
  AND tags.name IN ('van','truck')
)
GROUP BY media.id
HAVING COUNT(distinct media_tags.tag_id) = 2;
"
39196,39280,Optimizing query still takes a bit long time,"SELECT DISTINCT A.MBLNR
FROM MKPF A LEFT JOIN
     MSEG B
     ON B.SMBLN = A.MBLNR AND AND B.XBLNR_MKPF = '0150525913'
WHERE A.XBLNR = '0150525913' and A.MANDT='368' and B.SMBLN is null;
"
8752,2708,Netbeans MySql Database connection,"     C:\mysql\bin

     C:\Program Files\MySQL\MySQL Server 5.1\bin

     Installation Folder~\xampp\mysql\bin
"
15403,35579,collating stats into time chunks,"SELECT
    DATE_FORMAT( time, ""%H:%i"" ),
    SUM( bytesIn ),
    SUM( butesOut )
FROM
    stats
WHERE
    time BETWEEN <start> AND <end>
GROUP BY
    DATE_FORMAT( time, ""%H:%i"" )
"
23428,45699,Get items before and after an item - SQL Query,"WITH NumberedZipCodes AS
(SELECT SELECT ROW_NUMBER() OVER (ORDER BY ZipCode) AS RowNumber, *
FROM ZipCodes)

SELECT * From NumberedZipCodes
WHERE RowNumber BETWEEN
(SELECT RowNumber FROM NumberedZipCodes WHERE ZipCode=91803) - 3
AND (SELECT RowNumber FROM NumberedPerson WHERE ZipCode=91803) + 3
"
16780,62866,Replace empty values as 0 instead of null while joining two tables in sql,"declare @t table (ID int)
declare @t1 table (ID int)

insert into @t (id) values (1)

select t.ID,ISNULL(TT.ID,0)id  from @t t
LEFT JOIN @t1 tt
ON t.ID = tt.ID 
"
17539,69404,How to create a query to get all records from one table and fill in field information from a second table with a where statement?,"SELECT Prem.meter_miu_id, JimsQueryByColl.*, Prem.longitude, Prem.latitude
FROM Prem LEFT JOIN JimsQueryByColl 
ON (Prem.meter_miu_id = JimsQueryByColl.[MIU ID] 
AND JimsQueryByColl.Collector=""Frederick Road"")
"
15975,36652,Convert select query result to XML format in SQL Server,"select K.KeyWord as Result 
from ... as k
where ...
for xml path(''), root('Root'), binary base64
"
17144,71830,"Using a connection string where the password contains a ""@"" sign?","new Mongo(""mongodb://host/db"", array(""username"" => $username, ""password"" => $password));
"
1620,33810,SQL Server 2005 - Nested recursive query :(,"SELECT
  e.FirstName,
  e.LastName,
  e.Company,
  (
    SELECT COUNT(*)
    FROM Files f
    JOIN Employees e2 ON f.EmployeeID = e2.id
    WHERE e2.CompanyID = e.CompanyID
  ) as 'FileCount'
FROM
  Employees e
"
8515,28246,Oracle: How to count null and non-null rows,"SELECT count(a) nb_a_not_null,
       count(b) nb_b_not_null,
       count(*) - count(a) nb_a_null,
       count(*) - count(b) nb_b_null,
       count(case when a is not null and b is not null then 1 end)nb_a_b_not_null
       count(case when a is null and b is null then 1 end) nb_a_and_b_null
  FROM my_table
"
30693,59405,select next record against particular ID,"select *
from ejamatPass
where AutoID>17
order by AutoID
limit 1;
"
25799,52669,How to detect and remove a column that contains only null values?,"SELECT 1  -- no GROUP BY therefore use a literal
  FROM Locations
HAVING COUNT(a) = 0 
       AND COUNT(*) > 0;
"
24385,5736,Update column using case expression sql,"Declare @Temp Varchar(20)

Update Logins
Set ColValue = Case When @Temp <> '' Then @Temp 
                    Else ColValue 
               End
Where Code=1
"
27822,63477,SQL SELECT column letter prefix,"SELECT 'A' + CAST(ID as VARCHAR(15))
FROM...
"
25026,45424,Comparing dates in Oracle using the decode function,"select case when date1 >= date2 then date2 else date1 end from Your_Table;
"
35689,15206,Merge/Update records from the same table,"Update 
     user2.userkey = user1.userkey, 
     user2.uservalue = user1.uservalue 
FROM 
     MyTable user2 INNER JOIN MyTable user1 ON user1.YourKey = user2.YourKey
"
5541,34737,Query JSON inside SQL Server 2012 column,"SELECT *
FROM tb1
JOIN tb2 on tb2.bvin = 
    SUBSTRING(
        tb1.json
        ,CHARINDEX('""bvin"":""', tb1.json) + LEN('""bvin"":""')
        ,CHARINDEX('""', tb1.json, CHARINDEX('""bvin"":""', tb1.json) + LEN('""bvin"":""')) - CHARINDEX('""bvin"":""', tb1.json) - LEN('""bvin"":""')
    )
"
9748,73127,sql filter many to many relationship,"SELECT
    ct.competition_id FROM
    competitions c
JOIN competition_type ct ON ct.competition_id = c.id AND ct.Type_id = 1 
WHERE
    NOT EXISTS(SELECT * FROM competitions c2 
                     JOIN competition_type ct2 
                     ON ct2.competition_id = c2.id AND ct2.Type_id = 2 
                     WHERE c2.id = c.id)
"
6389,19033,Detecting last row of a group,"select uid,something,
  ROW_NUMBER() OVER (PARTITION BY uid ORDER BY something desc) as row
from
  someTable
"
16074,7827,Query for a non existing key in a big scale mongoDB database,"db.foo.find()._addSpecial( ""$maxScan"" , 50 )
"
39751,27643,How do I format a date column in MySQL?,"SELECT DATE_FORMAT(your_date_column, '%c/%d/%Y') FROM table
"
22045,37338,Joining records from same table,"select id1,id2,id3, date1, 
isnull(lead(date1) over(partition by id1,id2,id3 order by date1)-1, '99991231') as date2
from test
"
1397,69156,Query to find duplicate record in oracle,"select min(a.rowindex)rowindx, b.rowindex rowindx1 
from dedupinitial1 a,
dedupinitial1 b 
where a.rowindex <= b.rowindex 
 and a.name = b.name
group by b.rowindex
order by 1;
"
9267,3004,"Add dynamic values in sql where clause, but its not working","var mySQL = ""SELECT SUM(amount1) AS OrderTotal FROM budget1 WHERE month='""+hello+""'"";

transaction.executeSql(mySQL, [], dataSelectHandler, errorHandler);
"
15395,17700,Table name in Firebird has a lot of extra space,"RDB$RELATION_NAME is CHAR(31)
"
30227,1744,SQL Cross Apply Count,"INSERT INTO    @dest (val1, val2)
SELECT         t2.crossVal, t1.tempVal
FROM           @tempTable t1
CROSS APPLY    dbo.TableValuedFunction(t1.IDColumn) t2
GROUP BY t2.crossVal, t1.tempVal
HAVING COUNT(*) > 1
"
29708,31751,Calclute number of fields,"SELECT t.NameTag, COUNT(*)
    FROM ArtiTag at
        INNER JOIN Tag t
            ON at.idTag = t.idTag
    GROUP BY t.NameTag;
"
3435,43603,Joining a derived table based on specific data from the outside query,"SELECT a.viewerid, a.id, v.id AS entry, a.jobid, v.sourceid, v.cost, a.applicant
FROM a_views a
    CROSS APPLY (
        SELECT TOP 1 id, sourceid, cost FROM a_views vt
        WHERE vt.viewerid = a.viewerid
          AND vt.viewed_at <= a.viewed_at
          AND vt.referrer NOT LIKE '%' + vt.hostName + '%'
          ORDER BY viewed_at DESC
    ) v
"
3942,51798,SQL Server alternative to dynamic query,"AND ((ISNULL(@Mail,'') = '' or mail = @mail) OR (ISNULL(@Phone,'') = '' or Phone like '%' + @Phone))
"
14677,10634,How to search multple database entries by 2 columns,"SELECT *
FROM TicketDetails as t1
INNER JOIN TicketDetails as t2
ON t1.Ticket = t2.Ticket
WHERE t1.Description='BOGO' AND t2.Description='$5 OFF'
"
32913,69941,Query also returns column with value 0,"SELECT 
    q.id_quest,
    q.desc_quest,
    COUNT(a.id_quest) as total_answer
FROM tb_question q
LEFT OUTER JOIN tb_answer a ON q.id_quest = a.id_quest
GROUP BY q.id_quest
"
32263,57647,SQL how to join these tables,"SELECT COUNT(a.id) as total_votes, c.name as country_name
FROM Votes a
LEFT JOIN CARS b
ON a.car_id = b.id
LEFT JOIN Countries c
ON b.country_id = c.id
GROUP BY b.name, c.name
ORDER BY total_votes DESC
"
31107,60635,Postgres create timestamp ( current date + specific time ) format,"CURRENT_DATE + TIME '23:59:59'
"
23220,12166,sql parent child table interview question,"select id,name,parentid
from table
where parentid = 1
union
select id,name,parentid
from table
where parentid in (select id
from table
where parentid = 1)
"
28244,19792,how to join two tables,"SELECT
    v.VenueID,
    v.VenueName,
    v.EventID,
    e.EventName
FROM
    VenueTable v
INNER JOIN
    EventTable e 
    ON (v.EventId = e.EventId)

UNION

SELECT
    v.VenueID,
    v.VenueName,
    v.EventID,
    e.EventName
FROM
    VenueTable v
INNER JOIN
    EventTable e 
    ON (v.VenueID = e.VenueID)
"
15340,12778,simplify SQL statement by using CTE,"SELECT A.a, 
       A.b, 
       B.c,
       CalculatedValue,
       B.d
FROM    
       dbo.TableA A 
INNER JOIN
        dbo.TableB B 
        ON (...)
CROSS APPLY 
        (SELECT (CASE WHEN ... THEN ... ELSE ... END)) CxA(CalculatedValue)
WHERE CalculatedValue BETWEEN @DayStart AND @DayEnd
GROUP BY A.a, CalculatedValue, B.c
"
16517,4340,Limiting integer data type field lengths,"delimiter //
CREATE TRIGGER trigger_check BEFORE INSERT ON your_table
FOR EACH ROW 
BEGIN 
    IF NEW.NUM > 99999 THEN 
        SET NEW.NUM = 0; 
    END IF; 
END
//
"
25288,15549,Hibernate Annotations to create relationship,"   @ManyToMany(cascade=CascadeType.ALL)
        @JoinTable(
           name = ""jointablename"",
           joinColumns = @JoinColumn(name = ""FlexRowId""), 
           inverseJoinColumns = @JoinColumn(name = ""FlexRowId"")
         )
private List<Referrer> referrers = new ArrayList<Referrer>();
"
21952,57650,Excluding statistic using Data Pump API,"dbms_datapump.METADATA_FILTER(
  handle = your_handle_here,
  name = 'EXCLUDE_PATH_LIST',
  value = 'STATISTICS'
);
"
6349,5432,Doing arithmetic on alias in SQL,"SELECT X.MYALIASNAME1 - X.MYALIASNAME2 AS MYALIASNAME3 FROM
(
    SELECT 
        MY_COMPLEX_EXPRESSION_USING_SUM_AND_CASEWHEN AS MYALIASNAME1, 
        MY_SECOND_COMPLEX_EXPRESSION_USING_SUM_AND_CASEWHEN AS MYALIASNAME2

    FROM 
        MYTABLE
)X
"
4750,22333,"MySQL 1,000's of OR Statements (Good Idea?)","Select * from table where twitterid in (123,456,789,...)
"
27467,54068,mysql one to many in one row," SELECT t1.`id_c`,c.`name`,t1.latest,t1.`note` FROM `tablea`c

 INNER JOIN
 (
 SELECT t2.`id_c`,t2.latest,t3.`note` from `tableb` t3 

 INNER JOIN

 (SELECT `id_c`,MAX(`data_visited`) AS latest from
`tableb` 
GROUP BY(`id_c`))t2
 ON (t3.`id_c`=t2.`id_c`) AND (t3.`data_visited`=t2.latest)

)t1
ON(c.`id_c`=t1.`id_c`) 
"
2709,5977,How to get one value from other categories in php mysql?,"SELECT  a.*
FROM    TableName a
        INNER JOIN
        (
            SELECT  catid, MAX(DATE) max_date
            FROM    tableName
            GROUP   BY catID
        ) b ON  a.catID = b.catID AND
                a.date = b.max_date
"
14366,27262,SQL SUM - I don't want to loose precision when summing floating point data,"SELECT SUM(CCur(Price) * Qty)
FROM Invoices;

SELECT SUM(CCur(Amount))
FROM Invoices;
"
27583,72960,How to get entries from SQL that only appear in certain value?,"select distinct(DeviceID) from YourTable
WHERE Transmission = 'Inventory'
and DeviceID not in
( select distinct(DeviceID) from YourTable
  WHERE Transmission in('Starting', 'Stopping')
);
"
4394,34631,Mysql query different random conditions,"SELECT question FROM 
(
(SELECT question FROM QUESTION WHERE questionType = 'Identification' ORDER BY RAND() LIMIT 10)
UNION ALL
(SELECT question FROM QUESTION WHERE questionType = 'Multiple Choice' ORDER BY RAND() LIMIT 20)
) T
ORDER BY RAND()
"
31279,30811,Insert Data from one table to another in the Same Database due to import wizard,"INSERT INTO [JDatabase].[dbo].[MineOp] (Name)
SELECT Name
FROM [JDatabase].[dbo].[MineOp$];
"
30929,33064,How to use Case When with Between in db2," SELECT CHANNEL,PLG,TRANTYPE,SOA_VALUE
    FROM TABLE_X          
      WHERE ROLE = (CASE 
    WHEN (120 >= 100 AND 120 <=500) THEN 'RSM'
    WHEN 120 > 500 THEN 'TMM'
    ELSE NULL
                   end)
"
5858,25624,"Sql Query, Select distinct rows where not null","SELECT id, name, city, state, max(phone) AS phone, max(price) AS price
FROM   tbl
GROUP  BY id, name, city, state;
"
13893,21237,Averaging a count group,"SELECT AVG(totalCount) FROM (
    SELECT DATE( DATE ) DATE, COUNT( number ) totalCOunt
    FROM numbers
    GROUP BY DATE( DATE ) 
    LIMIT 0 , 30) TBL1
"
19511,49151,SQL grouping by value pairs in multiple columns and eliminating identical tuples,"SELECT least(origin, destination) as city1,
       greatest(origin, destination) as city2, count(*) as cnt
FROM Flights f
GROUP BY least(origin, destination), greatest(origin, destination)
"
13296,5551,SQL Count the distinct values that accomplish two condition for a single row,"SELECT COUNT(distinct userid)
FROM (
    SELECT userid 
    FROM mytable 
    WHERE platform in ('iOS', 'android')
    GROUP BY userid
    HAVING COUNT(distinct platform) = 2
)
"
36082,24981,Rounding money to a decimal in SQL Server,"DECLARE @Val1 money = 554.5344
DECLARE @Val2 money = 84020.37
DECLARE @Result decimal(6,5) = cast(@Val1 as float)/@Val2*100
SELECT @Result
"
6958,50660,"sqlplus - using a bind variable in ""IN"" clause","type t_id_table is table OF other_table.id%type index by binary_integer;
v_table t_id_table;

-- fill the table
select id
bulk collect into v_table
from other_table 
where abc in ('&val1','&val2','&val3');     

-- then at a later stage...    

select *
from some_table st
,    table(cast(v_table AS t_id_table)) idt
where st.id = idt.id;
"
2332,7246,"2 X-Axis row, 1 Y-Axis Column and 2 Z-Axis Value Pivot Table SQL Server 2008 query","SELECT  consignee , shipper ,
        jan_cm1 = MAX (CASE WHEN month = 'Jan' THEN cm1 END),
        jan_lss = MAX (CASE WHEN month = 'Jan' THEN lss END),
        feb_cm1 = MAX (CASE WHEN month = 'Feb' THEN cm1 END),
        feb_lss = MAX (CASE WHEN month = 'Feb' THEN lss END)
FROM    yourtable
GROUP BY consignee , shipper 
"
25292,60393,PostgreSQL select master records and display details columns for specific record,"SELECT DISTINCT ON (m.id)
       m.*, d.datetime, d.title AS title_details
FROM   master m
LEFT   JOIN details d ON d.master_id = m.id
ORDER  BY m.id, d.datetime DESC;
"
30690,65750,sql conditional WHERE clause CASE WHEN,"where coalesce(date1,date2) between '2010-01-01' and '2011-01-01'
"
22866,48859,Data Relationship patterns,"Incidents::with(array('location', function($q) use ($areaId) {
    return $q->where('area_id', $areaId);
}))->get();
"
3429,63956,NOT IN clause and NULL value,"WHERE NAME NOT IN ('C') OR NAME IS NULL
"
10651,21772,"How to replace part of string in a column, in oracle","UPDATE Mytable t
   SET column = REPLACE(t.U_MSG, ', CALL HELPDESK', ' CALL HELPDESK')
"
21962,61388,null and empty string in Firebird,"CREATE OR ALTER TRIGGER YOUR_TABELE_BIU0 FOR YOUR_TABELE
ACTIVE BEFORE INSERT OR UPDATE POSITION 0
AS
begin
  IF (CHAR_LENGTH(new.YOURFIELD)=0) THEN
    exception E_NOT_EMPTY 'field can not be empty';
end
"
18298,58019,Oracle - storing user settings,"**User**
UserId
UserData

**Team**
TeamId
TeamData


**UserTeam**
UserId
TeamId

foreign key constraints to user and team table

**UseScore** 
UserId
TeamId
ActivityId
Score

foreign key constraints to user, team and activity table
"
32094,42866,Temporarily create a row?,"SELECT numberOfThings,
       TypeOfThings 
FROM thingsTable tt 
UNION ALL 
SELECT 24, 'Fake Type of Things'
"
11333,20514,Quick SQL question: Correct syntax for creating a table with a primary key in H2?,"CREATE TABLE MyTableName(PKFieldName IDENTITY PRIMARY KEY, StringFieldName VARCHAR(255))
"
20025,22629,Order by within an order by in SQL,"-- copied from the accepted answer
select p.* from people p  
join (select p1.first_name, p1.last_name 
      from people p1 where p1.id = 17
     )un
  on un.first_name = p.first_name 
where p.last_name like un.last_name || '%'
-- ADDED
order by  -- find the MAX for each name
   max(col2) over (partition by un.last_name),
   last_name
"
2992,25049,Dealing with database access in transformer stacks,"class (Monad m, Applicative m, Functor m, MonadIO m, ConnectionManager (Conn m), PersistBackendConn (Conn m)) => PersistBackend m where
  type Conn m
  getConnection :: m (Conn m)

instance (Monad m, Applicative m, Functor m, MonadIO m, PersistBackendConn conn) => PersistBackend (ReaderT conn m) where
  type Conn (ReaderT conn m) = conn
  getConnection = ask
"
30330,26264,SQL: Rows before and after given row,"select 
   (select count(*) from SalesLT.Customer where customerid < 55) as rows_before,
   (select count(*) from SalesLT.Customer where customerid > 55) as rows_after,
   CustomerID, FirstName
from SalesLT.Customer
where CustomerID = 55
"
39709,57087,SQL Statement to retrieve information from multiple tables,"SELECT * 
FROM (tableA A INNER JOIN tableB B ON A.cust_id=B.cust_id)

INNER JOIN  tableE E ON E.product_id=A.prod_id
INNER JOIN (tableC C INNER JOIN tabldeD D ON D.country_id)
ON D.country_code = E.country_code1
WHERE A.statusCode IN(1,2,3)
"
4930,37952,MySQL strict select of rows involving many to many tables,"SELECT B_id FROM AB
WHERE A_id IN (1,2,3)
GROUP BY B_id
HAVING COUNT(DISTINCT A_id) = 3;
"
13404,74153,Getting the the number of blogs with more than x subscribers,"SELECT id, title, COUNT(*) as subs_count  
FROM `blogs`, `subscribers`  
WHERE `blogs`.`id` = `subscribers`.`blog_id`
GROUP BY `blog_id`
HAVING COUNT(*) >= 2
ORDER BY subs_count DESC;
"
5449,35683,Changing 200 Columns from varchar to float,"select 'alter table tablename '
select 'alter column [' + name + '] float not NULL' 
from sys.syscolumns where id = objectid(tablename) order by name
"
5531,15916,"INSERT INTO, SELECT DISTINCT - ignoring duplicate key entries","INSERT INTO songs(ID)
SELECT DISTINCT songsID FROM iTunesImport
WHERE (songsID IS NOT NULL)
AND songsID NOT IN (SELECT ID FROM songs)
"
28542,31231,How to select all values between 2 tables in SQL?,"SELECT     q.Question_ID, 
           r.Response_Day
FROM       Question AS ""q""
           LEFT JOIN Response AS ""r""
                ON r.Question_ID = q.Question_ID;
"
13985,4630,eliminating unnecessary database hits in django,"def cartest(request):
    cars = list(Car._default_manager.filter(user__username__exact='michael')[:5])
    first_car_name = car[0]
    another_car = car[1]
    return HttpResponse(len(connection.queries))
"
38392,41120,SQL Server: Return row numbers while keeping DISTINCT in effect,"SELECT 
[This]
,[That]
,row_num = ROW_NUMBER() OVER ( ORDER BY [This] )
FROM MyTable
group by [This],[That]
"
37320,49299,sybase sql way of converting seconds value to hours minutes and seconds," HH = floor(seconds / 3600)
 MM = floor(seconds / 60) % 60
 SS = seconds % 60
"
38186,45238,MS ACCESS SQL Query on two tables,"select g.home, ht.city as home_city, 
       g.visitor, vt.city as visitor_city, 
       g.date, g.result
from (games as g
     inner join teams as ht on g.home = ht.name)
     inner join teams as vt on g.visitor = vt.name
"
35340,21899,MySQL LEFT JOIN - Values can be NULL," SELECT cs.case_id, cs.child_firstname, gu.*
   FROM tblcases cs 

        LEFT JOIN tblguardians gu
        ON cs.case_id = gu.case_id 
    AND gu.firstname LIKE '%sally%' /* <- this line was moved up from WHERE */

  WHERE cs.child_firstname = '%craig%' 
"
32073,175,How do I force sqlite to merge journal file into main database?,"db.rawQuery(""PRAGMA journal_mode=OFF"", null).close();
"
7554,7167,How can i optimize this mysql query ? i use IN() operator,"SELECT users.* 
FROM users 
LEFT OUTER JOIN images ON user.usid = images.usid AND images.status = 0
WHERE images.usid IS NULL
AND us_status = 0
"
11028,75045,How to modify the date column values?,"DECLARE @Table TABLE(
    	Val VARCHAR(10)
)

INSERT INTO @Table (Val) SELECT '2009/01/31'
INSERT INTO @Table (Val) SELECT '2009/02/00'

SELECT * FROM @Table

SELECT  CAST(SUBSTRING(Val, 1, 8) + CASE WHEN SUBSTRING(Val, 9, 2) = '00' THEN '01' ELSE SUBSTRING(Val, 9, 2) END AS DATETIME) + CASE WHEN SUBSTRING(Val, 9, 2) = '00' THEN -1 ELSE 0 END
FROM    @Table
"
32296,33930,SQL Server ID reseed after deleltion of a middle record,"select t.*, row_number() over (order by id) as seqnum
from t;
"
34480,46348,Can I use pure SQL to return a range that includes one value less than the start value?,"select * from movies
where
  start_time > 17 and start_time < 34
  or start_time in (select max(start_time) from movies
                    where start_time <= 17)
"
38638,46564,Executing a command in SQL Server 2012 from VBScript,"dim dbconn, connect
connect = ""Driver={SQL Server};Server=XXX;database=XXX;uid=XXX;pwd=XXX""
Set dbconn = CreateObject(""ADODB.Connection"")
dbconn.Open connect
dbconn.Execute(SQL)
"
27633,35224,Insert into row if value exists in a different table," UPDATE Users u
 SET ValueToUpdate = 'some value'
 WHERE EXISTS (SELECT 1 FROM Subscribers S WHERE s.userid = u.userid);
"
6869,14869,How does SQL Server retrieve a plan out of the plan cache?,"logical reads X, physical reads Y
"
23789,72610,Need help for the SQL Distinct," SELECT col1, min(col2) as col2
      FROM T
     GROUP BY col1
"
33821,9046,Can I return a string based on a value in the table?,"SELECT 
  CASE 
     operation
  WHEN 1 THEN 'OP1'
  WHEN 2 THEN 'OP2'
  WHEN 3 THEN 'OP3'
  WHEN 4 THEN 'OP4'
  ELSE
     'Unknown OP'
  END OperationName
  , 
[...] FROM tableName
"
37579,890,Regular expression in google big query,"SELECT DebugData
CASE
 WHEN lower(DebugData) LIKE 'veri%' THEN 'Verizon'
 WHEN REGEXP_MATCH(LOWER(DebugData),r'^\d+[^a-zA-Z]*$') THEN c.Network 
 ELSE REGEXP_REPLACE(lower(DebugData),r'[^a-zA-Z]', ' ')
END
AS ActualCarrier
From table
"
37994,8860,pgSQL order by desc not work correctly or what I did is wrong?,"SELECT unnest(string_to_array(q.mycolumn, ',')) id 
FROM mytable q 
ORDER BY cast(unnest(string_to_array(q.mycolumn, ',')) as int) DESC;
"
34830,26397,Take thousand value in SQL,"SELECT CONVERT(INT,YourColumn) % 1000
FROM dbo.YourTable
"
618,43217,SELECT exact table records from a comma-delimited array using T-SQL,"select productID, price 
from Products  
where @array = productID --only one item, can use index
    or @array like productID + ',%'  --array starts with item, can use index
    or @array like '%, ' + productID + ',%' --item is in the middle of @array, cannot use index
    or @array like '%, ' + productID --item is at the end of @array, cannot use index
    or @array like '%,' + productID
"
12151,57008,"SQL: All records from one table, and all records from another, including null","SELECT 
    #CrossTable.languageID, 
    #CrossTable.ModuleID,
    COUNT(#userspassed.userID) as users 
FROM 
    #CrossTable
LEFT JOIN
    #userspassed ON 
      #CrossTable.LanguageID = #userspassed.languageid
      AND #CrossTable.ModuleeID = #userspassed.moduleid
GROUP BY #CrossTable.LanguageID, #CrossTable.ModuleID
"
36011,44606,missing some results from mysql query,"SELECT
   IFNULL(m.local_mir, o.localParty) as local,
   IFNULL(m.remote_mir, o.remoteParty) as remote
FROM 
   data as o
   LEFT JOIN mirror_data as m 
      ON (o.localParty = m.local OR o.remoteParty = m.remote)
LIMIT 
   0,10;
"
13886,48556,Automatic Adjusting Range Table,"CREATE TABLE MY_TABLE
(START_AT    NUMBER,
 VALUE       NUMBER,
 CONSTRAINT MY_TABLE_PK (START_AT)
);
"
13784,30575,PostgreSQL: top n entries per item in same table,"SELECT *
FROM (
   SELECT uid,
          title, 
          amount, 
          maker, 
          widgets,
          rank() over (partition by maker order by amount desc) as rank
   FROM entry  
) t
WHERE rank <= 3
"
17439,63732,"Interleaving the rows of two different SQL tables, sorting by date","select created_at, 'a' as tab_name from table_a 
union all
select created_at, 'b' as tab_name from table_b
order by created_at
"
10475,5722,Transactional SELECT and INSERT,"DECLARE @UserId nvarchar(50) = 'john'
DECLARE @LicenseId int = 902

INSERT INTO dbo.VolumeLicenseUsers (LicenseId, UserId)
SELECT l.LicenseId, @UserId
FROM
    dbo.VolumeLicenses l 
    LEFT OUTER JOIN dbo.VolumeLicenseUsers u ON u.LicenseId = l.LicenseId
WHERE l.LicenseId = @LicenseId
GROUP BY l.LicenseId, l.TotalLicenses
HAVING COUNT(u.UserId) < l.TotalLicenses

-- Did it work?
SELECT * FROM dbo.VolumeLicenseUsers 
WHERE LicenseId = @LicenseId AND UserId = @UserId
"
30868,67071,SQL Join query with filter condition : performance,"SELECT
  stuff
FROM 
  foo
INNER JOIN
  bar
    ON  (join predicates here)
WHERE
  (static filters here)
"
13943,33000,Why I cannot select from some selected results?,"select * from
(
select * from dbo.[sometable]
) as X 
"
38845,61288,Find common substrings in a column using SQL,"declare @keywords table
(
    word varchar(100)
)
insert into @keywords values ('catching')
insert into @keywords values ('unicorns')

select kw.word, count(*) as NumMessages
from your_table t
inner join @keywords kw on t.comment like '%' + kw.word + '%'
group by kw.word
order by NumMessages
"
15786,15833,CHARINDEX always 0 when looking for substring,"CHARINDEX('ABCD', g.letters)
"
518,72566,"In SQL, how to select the top 2 rows for each group","SELECT *
FROM   test s
WHERE 
        (
            SELECT  COUNT(*) 
            FROM    test  f
            WHERE f.name = s.name AND 
                  f.score >= s.score
        ) <= 2
"
37572,11744,SQL Server 2005 - content of variable is lost upon,"UPDATE myTable
SET [Names and parties] = @MP
WHERE myTable.[Local Region] = 'Wales'
"
30133,75105,Find MAX LEN name against duplicate IDs,";WITH CTE AS
(
    SELECT id, 
           name, 
           RN = ROW_NUMBER() OVER(PARTITION BY id ORDER BY LEN(name) DESC)
)
SELECT id,
       name
FROM CTE
WHERE RN = 1;
"
16416,43551,Trouble converting simple SQL to Linq,"var results = db.tblForumAuthors.GroupBy(r => new {Year = r.Join_date.Year, Month =  r.Join_date.Month})
                .Select(g => new {Registrations = g.Count(),  g.Key.Year, g.Key.Month})
                .OrderBy(r => r.Year)
                .ThenBy(r => r.Month)
"
25058,37223,sql query for report - select min date,"SELECT
    searchterm,
    MIN(dateadded) AS minDateAdded, 
    MAX(dateadded) AS maxDateAdded, 
    count(*) as recCount
FROM SearchTable 
GROUP BY searchterm
"
38760,25797,What is the best way to assign the returned value of a stored proc to a variable in SQL?,"declare @localVariable int
exec @localVariable =GetMyValue
select @localVariable
"
29028,56678,How to translate this sql to left join without subquery？,"select dl.*
from dev_location dl
where not exists (select 1
                  from dev_location dl2
                  where dl2.device_id = dl.device_id and
                        dl2.id > dl.id
                 );
"
23050,27481,SQL: Query based on multiple records,"   select a.PERSON_NO
   from personTable a
   where exists (select 1 from personTable where PERSON_NO = a.PERSON_NO
                 and CITY_NAME = 'City A')
   and exists (select 1 from personTable where PERSON_NO = a.PERSON_NO
                 and CITY_NAME = 'City B')
   and exists (select 1 from personTable where PERSON_NO = a.PERSON_NO
                 and CITY_NAME = 'City C')
"
32173,34152,Difference between value and avg(value),"select
    id,
    value,
    avgValue,
    avgValue - value as Diff
from
    table1
  cross join
    ( 
      select
          avg(value) as AvgValue
      from
          table1
    ) t2
where
    value < avgValue
"
36195,37881,Set value of checkbox to false,"If TextBoxName.Value = ""Value of item you are comparing to"" Then
    CheckBoxName.Value = False
End If
"
6179,1139,Delete Using Multiple Tables and repeat table in the subquery,"DELETE e1
FROM Employee AS e1
JOIN (SELECT deptID
      FROM Employee AS e
      JOIN Sales AS s ON e.ID = s.ID
      GROUP BY deptID
      HAVING SUM(Sales) <= 400) AS d
ON e1.deptID = d.deptID
"
17050,43415,SQL Server Auto-Increment Next INSERT Query,"CREATE TABLE example (ID int IDENTITY(1,1), Stuff VARCHAR(255))

INSERT INTO example (Stuff) VALUES ('Hello World!')
"
197,16851,"Oracle SQL - I want to combine multiple queries and group by the date, but the dates are pulling from different sources.","SELECT * FROM Table1 T1
INNER JOIN Table2 T2 ON T1.The_Date = T2.The_Date
INNER JOIN Table3 T3 ON T1.The_Date = T3.The_Date
...
INNER JOIN TableN TN ON T1.The_Date = TN.The_Date
"
26127,30971,Group by month and year in MySQL,"GROUP BY YEAR(t.summaryDateTime), MONTH(t.summaryDateTime) DESC;
"
15429,59579,"Oracle Insert, Update, Delete Trigger with Join","INSERT INTO Analysis_Set_Trts ( ID, Name, f_lAnalysisSetKey, f_lTreatmentKey,
  f_lOrder ) 
SELECT :new.ID, :new.Name, :new.f_lAnalysisSetKey, :new.f_lTreatmentKey,
  :new.f_lOrder                            
FROM Analysis_Sets parentT 
WHERE parentT.ID = :new.f_lAnalysisSetKey
AND ((IsMemberOf('db_owner')=1) or (IsMemberOf(parentT.UpdateRole)=1));
"
5308,6690,I cant view the images from data base in an image view,"String imageId=imageArray[pos];
Drawable drawable = getResources().getDrawable(getResources()
                      .getIdentifier(imageId, ""drawable"", getPackageName()));
imageview1.setImageDrawable(drawable);
"
34303,13936,Sql Server View show records with no data in certain tables,"Select a.field1,b.field2
from tablea A
left outer join tableb b on b.fieldc = a.fieldc
"
3916,8619,SQL command to concatenate several rows into one cell?,"SELECT foo, GROUP_CONCAT(DISTINCT bar ORDER BY bar) AS bars
FROM foo_table
LEFT JOIN bar_table ON bar_table.foo_id = foo_table.foo_id
"
29298,20108,Set column type with a select ... into statement,"SELECT DISTINCTROW 
    AR_Server_Pre.OrderID, 
    CCur(AR_Server_Pre.LineTotal) AS LineTotal, 
...
"
20645,27298,Oracle bind vars does not work with ActiveRecord,"select sql_fulltext 
from v$sql
where upper(sql_fulltext) like '%TABLE IN YOUR APP%'
"
28676,11801,psql table querying,"SELECT
    p.id,
    p.name,
    count(m1.*) + count(m2.*) as matches,
    count(w.*) as wins
FROM players p
LEFT JOIN matches m1
ON m.p_one_id = p.id
LEFT JOIN matches m2
on m.p_two_id = p.id
LEFT JOIN wins w
ON w.p_id = p.id
GROUP BY p.id, p.name
"
1960,52918,Insert double quotes into SQL output,"SELECT QUOTENAME(First, '""'), QUOTENAME(Last, '""'), QUOTENAME(Email, '""')
    FROM People
"
15115,8051,The most efficient way to schedule content on a website,"SELECT id, header, text, ... 
  FROM CONTENT
 WHERE online_at < current_timestamp
 MINUS
SELECT id, header, text, ... 
  FROM CONTENT
 WHERE offline_at < current_timestamp
"
9103,17452,How to update multiple Columns in T-SQL from Multikey tables,"UPDATE  a
SET     a.fieldA = b.fieldA,
        a.fieldB = b.fieldB
FROM    TableA a
        INNER JOIN TableB b
            ON  a.keyA = b.keyA AND
                a.keyB = b.keyB
"
21030,59984,How to loop a MySQL query and return the result as a single result set ? use function or prcedure?,"select count(id) links ,sum(download_count) dowloads, user_id from file_list_user group by user_id
"
2514,10417,How to avoid While Loop in Sql,"INSERT INTO [Table_name] (
    [Column1]
   ,[Column2]
   ,[Column3]
   ,[Column4]
   ,[Column5]
)
SELECT TOP 35000
       7
      ,@Id + ROW_NUMBER() OVER (ORDER BY objects1.object_id)
      ,'20130909 16:42:43.157'
      ,0
      ,NEWID()
FROM sys.objects AS objects1
     CROSS JOIN sys.objects AS objects2
"
9784,9198,Having questions as field name in database design,"SELECT NOW() 'What time is it?',
       t.weatherNice 'Is the weather nice?'
  FROM table t
"
33531,51902,Type-based database design,"Student:
   id
   name
   class
   ...

Teacher:
   id
   name
   subject
   ...

voterType
   id 
   description (student or teacher)

contest:
   id
   description (ex: 1st Semester 2013)

contestVotes:
   id
   contestId
   voterType (Teacher or Student)
   voterId
   ratingTypeId
"
8460,41395,Sum or Multiply in SQL Server,"Number3 as (Number1 + Number2)
"
30674,11668,Difficulty in sql select query,"SELECT o.office_id, 
       o.office_location, 
       m.manager_id, 
       count(*) staff_count
  from staff s
 inner join manager m
    on m.manager_id = s.manager_id
 inner join office o
    on o.office_id = m.office_id
 group by o.office_id, 
          o.office_location,
          m.manager_id;
"
21327,55422,flattening a table with SQL,"select t1.Team,
       max(case when t1.Value_Descriptor = 'Coach' then t1.Value end) as Coach,
       max(case when t1.Value_Descriptor = 'Manager' then t1.Value end) as Manager,
       max(case when t1.Value_Descriptor = 'City' then t1.Value end) as City
  from table1 t1
 group by t1.Team
"
27085,29514,How to create some kind of iterator (or artificial id) for a given set of rows?,"select *
from
(
  select col,
     row_number() over(order by col) rn
  from yourtable
) src
order by random()
"
29299,73651,Most performant of Two SQL Double joins,"SELECT A.key1, A.key2, A.field, B.otherfield
FROM A LEFT JOIN B 
  ON (A.key1 = B.key1) 
 AND (A.key2 = B.key2);
"
1905,68364,How to use keywords as column names in Derby,"create table test ( ""OPEN"" integer );
"
1939,17505,Get all the columns in a database at once in sql/apex,"select COLUMN_NAME from ALL_TAB_COLUMNS 
"
10444,68210,Efficiently detecting concurrent insertions using standard SQL,"CREATE TABLE message_subscription (
  message_subscription_id NUMBER PRIMARY KEY,
  message_id RAW(32) NOT NULLL,
  monitor_id NUMBER NOT NULL,
  CONSTRAINT uk_message_sub UNIQUE (message_id, monitor_id)
);

INSERT INTO message_subscription
  SELECT message_subscription_seq.nextval,
         sys_guid,
         monitor_id
    FROM monitor_subscribers;
"
22087,52133,Optimizing query with nested where clauses,"SELECT CALLID FROM CALLS
WHERE CALLS.USERID_OPENED_BY = 1 
union
SELECT CALLID FROM CALLS
WHERE CALLS.AREAID IN (1,2,3)
union 
SELECT CALLID FROM CALLS
WHERE CALLS.TYPEID IN (1,2,3) 
"
13693,2118,How can I group by a time interval inside a specific period?,"select timestampdiff(MINUTE, greatest(initial_date,$start_of_range),
 least(final_date,$end_of_range)) from tbl where initial_date between 
 $start_of_range and $end_of_range or 
 final_date between $start_of_range and $end_of_range
"
18442,61688,How to get the MAX(Hour) and The MIN(Hour) for each day in this query?,"SELECT d.IdDiary, d.IdDay, MIN(Hour), MAX(Hour)
FROM Diary AS d
LEFT JOIN DiaryTimetable AS dt ON d.IdDiary = dt.IdDiary
GROUP BY d.IdDiary, d.IdDay
"
18956,58381,current value of a column for every id according to the newest date,"SELECT t.*,
       MAX(CASE WHEN b = c THEN d END) OVER (PARTITION BY a) as d
FROM (SELECT a, b, max(b) OVER (PARTITION BY a) AS c
      FROM myTable
     ) t
ORDER BY a, b
"
6220,50220,"How do I implement this multi-table database design/constraint, normalized?","CREATE TABLE elements
(
    class CHAR(1) NOT NULL,
    synthetic_id SERIAL NOT NULL PRIMARY KEY,
    UNIQUE(class, synthetic_id)
);

CREATE TABLE elements_xref
(
    class CHAR(1) NOT NULL,
    synthetic_id INTEGER NOT NULL REFERENCES elements(synthetic_id),
    FOREIGN KEY (class, synthetic_id) REFERENCES elements(class, synthetic_id),
    real_id    CHAR(5) NOT NULL,
    PRIMARY KEY (class, real_id)
);
"
29308,17165,Why is this mySQL query extremely slow?,"SELECT
    t2.products_id,
    count(t2.products_id) AS counter
FROM orders_products t1
JOIN orders_products t2
    ON t2.orders_id = t1.orders_id
    AND t2.products_id != 85094 
WHERE t1.products_id = 85094
GROUP BY t2.products_id
ORDER BY counter DESC
LIMIT 4
"
1071,22397,Understanding GROUP BY with a LIMIT,"select ...
from user 
where exists 
(
  select * from imageComment 
  where imageComment.commentAuthorId = user.id 
  and imageComment.imageAlbumJunctionId = 37
)
"
30958,1985,Creating a table with PSQL as clone of another table but excluding a column,"create table foo like bar;
alter table foo drop column baz;
-- and now full the thing
"
2404,42058,chaining joins back to target table,"SELECT  ra.*
FROM    responses rd
JOIN    responses ra
ON      (ra.id_s, ra.id_p) = (rd.id_s, rd.id_p)
WHERE   (rd.id_q, rd.answer) = (3, 'D')
"
1826,2165,"MySQL, PHP Inner join and show results in different tables html","$h1 = NULL;

while ( $list = mysql_fetch_array($query) ) {
    if($h1 <> $list['contry']) {
        echo ""<h1>"" . $list['contry'] . "":</h1>\n"";

        $h1 = $list['country'];
    }

    echo ""<h3>- "" . $list['name'] . ""</h3>\n"";
}
"
1396,22020,Insert the value from one table into another,"insert into CommisionPickups (pName) 
(select DISTINCT c.ClientName from Clients c
where NOT EXISTS (SELECT 1 FROM CommisionPickups cp
                  WHERE c.ClientName = cp.pName)
)
"
34430,58305,Find value having leading and trailing space in DB table column - Oracle,"select * from my_table
 WHERE
     REGEXP_REPLACE(my_column,'['||chr(1)||'-'||chr(32)||']' ) = 'D0019';
"
15249,7300,BigQuery Basics - FROM clause while quering,"SELECT * FROM StudentInformation as StudentProfile;
"
7396,55982,Count visits on a daily base with one select,"SELECT  day, count(*) AS visits, array_agg(id) AS ids
FROM    generate_series ('2014-02-10'::date
                       , '2014-02-12'::date
                       , interval '1 day') AS d(day)
JOIN    visits ON tsrange(day::timestamp
                        , day::timestamp + interval '1 day') && timeslot
GROUP   BY 1;
"
15183,7112,Load database table in controller cakephp,"$preset = $this->Preset->findAllByName('foo');
"
39395,7296,Database Query only returns column name,"String selectQuery = ""SELECT * FROM"" + DATABASE_TABLE  +""ORDER BY KEY_ROWID DESC LIMIT 1"";
SQLiteDatabase db = this.getWritableDatabase();
Cursor cursor = db.rawQuery(selectQuery, null);
"
38039,60078,join on multiple columns,"    Select TableA.Col1, TableA.Col2, TableB.Val
    FROM Table
    INNER JOIN TableB
          ON TableA.Col1 = TableB.Col1 OR TableA.Col2 = TableB.Col2 
          OR TableA.Col2 = TableB.Col1 OR TableA.Col1 = TableB.Col2
"
33719,43262,Current date in Oracle Db,"SELECT ""DATE"", BUS, VALUE
FROM {your_table}
WHERE ""DATE"" >= trunc(sysdate) and ""DATE"" < trunc(sysdate+1)
"
32111,66930,Is order preserved in UNION ALL using LAST_VALUE?,"SELECT 
  LAST_VALUE(SERIAL_ID) OVER (ORDER BY FLAG
    RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING),
  LAST_VALUE(COLOR) OVER (ORDER BY FLAG
    RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)
FROM (
  SELECT SERIAL_ID, COLOR, 1 AS FLAG FROM TABLE_1
  UNION ALL
  SELECT SERIAL_ID, COLOR, 2 AS FLAG FROM TABLE_2
) WHERE SERIAL_ID = <PUT UNIQUE ID TO TABLE_1 and TABLE_2 HERE>
"
37100,61946,Filtering my SQL to show only those records > 0,"HAVING ISNULL(max(m.Init_Amnt) - sum(d.Amnt-Appl), 1) > 0
"
25419,66952,How can I put validations on a SQL table column?,"CREATE TABLE MyTable
(
 Id INTEGER NOT NULL IDENTITY, 
 Name VARCHAR(20) NOT NULL UNIQUE, -- presumably a candidate key
 Number CHAR(10) NOT NULL
    CHECK (Number LIKE '4[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]')
)
"
36280,71917,2 Questions about Philosophy and Best Practices in Database Development,"processing_time = data_size * num_users
"
4779,40639,sql like clause multiple values,"select t.column1
from @tablea t
inner join @words w on charindex(w.word, t.column1) > 0
group by t.column1 
having count(distinct w.word) = (select count(*) from @words)
"
22526,41409,SQL - Insert 25000 rows at once,"declare @counter int = 0

while @counter < 25000
begin
  insert <yourtablenamehere> (column1, column1, column1, column1)
  values (null, null, null, null)

  select @counter = @counter+1
end
"
22251,64322,Get every 100th record starting from the top,"SELECT   no_id AS `start`, no_id - 100 + 1 AS `end`
FROM     my_table
JOIN     (SELECT MAX(no_id) AS max_no_id
          FROM   my_table)
         ON (max_no_id - no_id) % 100 = 0
ORDER BY no_id DESC
"
1223,21664,Is it OK to re-create many SQL connections (SQL 2008),"using(new TransactionScope())
{
    // Update code to various databases, opening and closing connections.
}
"
25249,50066,What's an elegant way to find the minimum value in each row of a table?,"select least(price1, price2, price3, ..)
from products    
"
7369,27742,"left join table, find both null and match value","select t1.years, t1.numOfppl, t2.years, t2.numOfppl from t1 
full outer join t2 on t1.years=t2.years 
"
38612,10515,SQL How to convert date DD-MM-YYYY to MM-YYYY and retrieve most recent records?,"SELECT TOP(1) * 
FROM your_table 
WHERE date_time_field >= '20120101' 
  AND date_time_field < '20120201' 
ORDER BY date_time_field DESC
"
27087,10337,Efficiency of Order queries in Rails 3,"Post.where(:collection_id => collection_id).order(:updated_at).last
"
4188,14001,SQL Join: Are selects between more than 2 tables still joins?,"select * from testtable
inner join testable2 on col1 = othercolumn
inner join testable3 on col2 = othercolumn
leftjoin testable4 on col3 = othercolumn
"
29617,36128,"Complex query, many joins","SELECT  *
FROM    A
        INNER JOIN B ON B.AID = A.AID
        INNER JOIN C ON C.BID = B.BID
        INNER JOIN D ON D.AID = A.AID
        INNER JOIN E ON E.DID = D.DID
        INNER JOIN F ON F.EID = E.EID
WHERE   C.Field = F.Field
"
1649,45035,Search letters in a specific position in SQL,"SELECT * FROM table WHERE column REGEXP '^..[A-Za-z][A-Za-z]';
"
8311,20633,How to convert sql query with addition and join to linq,"from s in db.Schools
join b in db.Bowlers on s.school_id equals b.school_id
select new {
  bowler_name = b.bowler_name,
  ...
  totalscore = bowler_gm1 + bowler_gm2 + bowler_gm3 ...
};
"
11407,18007,Convert varchar which represents DateTime in universal format (dd/MM/yy hh:mm) to DateTime,"CONVERT(datetime, @varcharDT, 3)
"
25705,53621,mySQL query for empty and NULL value together,"Select userName 
from user 
where picName IS NULL OR 
      picName = ''
"
18258,42130,Trying to find the most expensive book written by a certain author in Oracle SQL,"select b.title, b.retail
from books b join bookauthor ba using (bookid, authorid)
join author a using (authorid)

join (select max(retail) highestprice
from books bb join bookauthor ba using (bookid, authorid)
join author aa using (authorid)
where aa.lname = 'WHITE' and aa.fname = 'LISA'
group by bb.bookid) temp on retail = highestprice

where a.lname = 'WHITE' and a.fname = 'LISA'
"
11357,54269,Group returned result by mysql,"     SELECT name, repeat_status
     FROM `x`
     WHERE labref = '111'
     GROUP BY name ,repeat_status;
"
28330,72791,Cursor with where null or value,"declare findParent_c cursor for
select ID , page
from   dPageHierarchy
where  profileid =  @profileId
and ( (parentid = @parentid) or (parentid is null and @parentid is null) );
"
8364,44612,How do i view recent records from SQL table?,"SELECT TOP 100 *
FROM       Mydata
ORDER BY   [YourField] DESC --Could be the date added column, or the primary key.
"
9842,57035,query to bring columns in single row,"SELECT row
FROM
(
  SELECT fruit_id, fruit_id row FROM fruits
  UNION
  SELECT fruit_id, fruit_name row FROM fruits
) s
WHERE fruit_id = 101;
"
31698,43729,Exiting prematurelly a FOR from an internal IF,"FOR I IN T_TITLE.FIRST.. T_TABLE.LAST LOOP
  IF T_TABLE(I).VAR_TITLE = PAR_TITLE THEN
    V_TITLE_ID = I;
    EXIT;
  END IF;
END LOOP;
"
33157,57436,Sql syntax to always get one,"SELECT  c.Description, r.IsRead, r.UserID
FROM    dbo.Calls c
LEFT JOIN dbo.TicketRead r 
   ON c.CallID = r.TicketID 
   AND r.UserID = 1
"
7021,49727,Mysql Select only percentage of rows,"SELECT title, COUNT(art) AS art_count
FROM table1
GROUP BY art 
HAVING art_count >= (select count(*) * X / 100 from table1)
"
14930,65072,Creating table in other schema oracle using select,"CREATE TABLE schema1.table1 AS (SELECT * FROM SCHEMA.table@LinkedDB);
"
23977,29380,JPQL equivalent of numtodsinterval,"Duration dur = Duration.standardDays(300);
DateTime dt = new DateTime(G2.KAYIT_OLUSTURMA);//Assuming G2.KAYIT_OLUSTURMA is of java.util.Date type
DateTime calc = dt.plus(dur);


SELECT * 
FROM GEBELIKTAKIP G1, GEBEBILDIRIM G2, GEBELIKSONUCU G3 
WHERE G1.GEBELIKBILDIRIM_ID=G2.ID AND G1.GEBELIKSONUC_ID=G3.ID 
AND  G3.KAYIT_OLUSTURMA > :calc
"
18412,10721,Sql instead of insert trigger - insert data if does not exist,"Insert into bbownermap (deviceid, devicenumber)
Select i.ndl_DeviceID, <deviceNum>
From inserted i
  Left join bbownermap b on i.deviceid=b.deviceid
Where b.ownerid is Null
"
7158,28399,Calculating difference in values in one table based on another table in SQL,"select tickid, ticks, minormagnet, min(abs(tickdiff)) tickdiff 
from (
    select ma.TickID, t.Ticks, t.MinorMagnet, tickdiff = t.TickID - oa.TickID 
    from MarketAction ma
    join ticktable t on ma.TickID = t.TickID
    outer apply (
       select top 2 TickID 
       from ticktable 
       where MinorMagnet = 1 
       order by abs(t.Ticks-Ticks) 
    ) oa
) x
group by tickid, ticks, minormagnet;
"
36534,54386,Hiding databases for a login on Microsoft Sql Server 2008R2 and above,"USE master;
GO
DENY VIEW ANY DATABASE TO [newlogin]; 
GO
USE yourDB;
GO
DROP USER newlogin;
GO
USE master;
GO
ALTER AUTHORIZATION ON DATABASE::yourDB TO [newlogin];
GO
"
39819,8999,"How to write query without ""Cube"" function in oracle?","SELECT market_id,item_id,SUM(sale) 
FROM Sales
GROUP BY market_id,item_id
UNION ALL
SELECT market_id,NULL,SUM(sale) 
FROM Sales
GROUP BY market_id,NULL
UNION ALL
SELECT NULL,item_id,SUM(sale) FROM Sales
GROUP BY NULL,item_id
UNION ALL
SELECT NULL, NULL,SUM(sale) 
FROM Sales
GROUP BY NULL, NULL
"
36961,13615,"SCOPE_IDENTITY, multiple inserts, carries value from previous insert if current insert doesn't insert","DECLARE @MY_NEW_ID INT

INSERT INTO TABLE2 (COL1)
SELECT VAL1
FROM TABLE1
WHERE X=Y

IF @@ROWCOUNT>0
BEGIN
   SET @MY_NEW_ID  = SCOPE_IDENTITY()
END

/* DO MORE INSERTS HERE ... */

IF @MY_NEW_ID IS NOT NULL
BEGIN
   INSERT INTO TABLE3 (NEWID) VALUES @MY_NEW_ID  
END
"
34729,69295,How to insert multiple rows into one table for each id of another table,"SELECT * 
FROM TABLE1 T1
LEFT JOIN 
 (SELECT DISTNCT C2_ID, L2_ID, Category
  FROM TABLE2) AS T2 ON T1.C2_ID = T2.C2_ID
"
4830,27294,SQL query using (self?) Join,"Select 
    j1.jobnum,
    j1.empnum
From jobs j1
    Join jobs j2
        On j1.empnum = j2.empnum
Where j2.jobnum = 125
"
6256,1230,Get top n occurences based on related table value,"Select o.Id as OrderId, ol.ProductId, ol.Amount from Orders o 
inner join OrderLines ol 
on o.Id = ol.OrderId where o.Id in 
(Select top 3 OrderId from Orders where OwnerId = @OwnerId) 
Order By o.OrderDate desc
"
26587,23172,Access - SELECT JOIN many to many 2 tables with 3 dictionaries,"  SELECT P.Ext_item_id, P.Ext_shop_id, P.Ext_date_id, S.SALES
  FROM PROMO P
  INNER JOIN SHOP SH ON P.Ext_shop_id = SH.Ext_shop_id
  INNER JOIN ITEM I ON P.Ext_item_id = I.Ext_item_id
  INNER JOIN [DATE] D ON P.Ext_date_id = D.Ext_date_id
  INNER JOIN SALES S 
    ON SH.shop_id=S.shop_id  AND I.item_id = S.item_id  AND D.date_id = S.date_id
"
30332,34997,table aliasing not working in mysql,"select sum(case when Lead_time_Bucket = '0 to 15' then OPEN_POS1 else 0 end) as `0-15`,
       sum(case when Lead_time_Bucket = '16 to 30' then OPEN_POS1 else 0 end) as `16-30`,
       sum(case when Lead_time_Bucket = '> 30' then OPEN_POS1 else 0 end) as `>30`
from `table 2`;
"
16755,3387,SQL join or union,"SELECT *
FROM (
  SELECT id, parent, name, 'category' AS `type`
  FROM course_categories
  UNION ALL
  SELECT ( 1000 + id ) AS id, category, fullname, 'fullname' AS `type`
  FROM course
) courses
INNER JOIN org_courses 
  ON org_course.courseid = courses.id
"
16240,54153,How to create custom abbreviations in SQL?,"with t as (
      select city as c, destination as d
      from thetable
     )
select c, d
from t;
"
20824,65835,SELECT FROM depending on a parameter in SQL,"INNER JOIN Downtime_EquipmentClasses ec 
ON (el.EquipmentClassID = ec.EquipmentClassID)
    AND (  (@Display = 0 AND ec.IsEquipmentRelated = 1) 
        OR (@Display = 1 AND ec.IsEquipmentRelated = 0) 
        OR (@Display = 2) )
"
17589,26833,How to convert SQL Query to Lambda Expression,"from u in context.aspnet_Users 
join m in context.aspnet_Membership on u.UserId equals m.UserId select new { u.UserName, m.IsApproved};
"
29336,56506,SQL Group Entries With 3 Common Values And Return Further Detail from Latest Entry Only,"MAX([Occurred Time]) AS LatestOccurrence
"
27830,24658,How to implement equal/approximate condition for double datatype in mysql?,"SELECT * FROM tablename WHERE ABS(DoubleColumnName-$value)<1E-13
"
18537,7867,Double select from a same table,"SELECT  *
FROM    categories
WHERE   parent_id = 0 
UNION ALL
SELECT  c.* 
FROM    categories c INNER JOIN
        categories p    ON  c.parent_id = p.id
WHERE   p.parent_id = 0 
"
6032,46760,SQL - Structuring code for Group by and Sum in query,"SELECT AbsenceEmployeeID,
       AbsenceCause,
       SUM(numDays)
FROM   que_ABSENCE_Days
GROUP  BY AbsenceEmployeeID,
          AbsenceCause
"
33919,72786,Choice Table-Column from a variable,"@Id AS int
@Day AS nvarchar,
@RefDayId AS int
AS
DECLARE @sql   varchar(500)
SELECT @sql = 'UPDATE dbo.table1 SET table1.'||@Day||' = '||@RefDayId||' WHERE table1.Id = '||@Id
EXECUTE(@sql)
RETURN
"
8204,58338,How to sort particular list in sql," order by sortlist, case when sortlist='list3' then year else null end,
"
38580,8615,How to model this one-to-one relation?,"if(usertype==admin)
  select * from  admins where userid=:id;
else    
  select * from  general where userid=:id;
"
37739,32273,copy table and drop it,"IF (EXISTS (SELECT * 
         FROM INFORMATION_SCHEMA.TABLES 
         WHERE TABLE_NAME = 'tbl2'))
BEGIN
    -- tbl2 exists, so just copy rows
    INSERT INTO tbl2 SELECT * FROM tbl1;
END
ELSE BEGIN
    -- tbl2 doesn't exist, so create new table tbl2 and copy rows 
    SELECT * INTO tbl2 FROM tbl1;
    DROP tbl1;
END
"
22283,67979,"Mysql fails to Join date records, that is visible in the where clause","( DATE(s.ardate8n)>=DATE(b.start_date) 
  AND DATE(s.ardate8n)<=DATE(b.end_date) ) 
"
38342,37631,Select all records between two timestamps and then group by the number of occurrences of a value,"SELECT `email`, COUNT(*)
FROM `incidents`
WHERE `timestamp` BETWEEN '2015-12-01 00:00:00' AND '2015-12-30 23:59:59'
GROUP BY `email`
ORDER BY COUNT(*) DESC
"
25390,69320,oracle partition by group_id and subpartition monthly,"create table some_data ( 
  id number(19,0),
  group_id number(19,0),
  value float,
  timestamp timestamp  -- not good naming
)
PARTITION BY RANGE (""TIMESTAMP"")
INTERVAL (NUMTOYMINTERVAL(1,'MONTH'))
SUBPARTITION BY RANGE (group_id) -- it could be hash or list as well
   subpartition template(
     ...
   )
(
 PARTITION part_1 values LESS THAN (TO_DATE('01.02.2015','DD.MM.YYYY'))
);
"
37070,1408,"Oracle SQL unique constraint A to B, B to A","create unique index on the_table (least(from,to), greatest(from,to));
"
34955,47962,Call stored procedure fail due to Incorrect syntax,"select  dbo.GetHighestDrop( ((clmnA/clmnB)-1)*100, 2, 3) as Col1
from    dbo.tstTable
"
27366,46616,Store each AWS S3 file in a database as a separate row?,"file_id  folder_id     file_path
  1          1       http://s3.aws.amazon.com/my-bucket/folder1/img1a.jpg
  2          1       http://s3.aws.amazon.com/my-bucket/folder1/img1b.jpg
  3          2       http://s3.aws.amazon.com/my-bucket/folder2/img2a.jpg
  4          2       http://s3.aws.amazon.com/my-bucket/folder2/img2b.jpg
"
1853,29725,How do I find the maximum database space and the used database space in SQL Azure?,"SELECT SUM(reserved_page_count)*8.0/1024
FROM sys.dm_db_partition_stats; 
"
8370,73417,Save method don't work when I have both x and x_id fields in my table in cakephp 3,"$this->belongsTo('Languages', [
    'alias' => 'Languages',
    'foreignKey' => 'language_id',
    'propertyName' => 'preferred_language'
]);
"
36811,37965,SQL - What type of join is it and the best way to rewrite?,"SELECT *
FROM a, b

SELECT *
FROM a CROSS JOIN b
"
30331,50532,select data and if duplicate id add (sum) the data,"SELECT ID, SUM(a) as a, SUM(b) as B
FROM MyTable
GROUP BY ID
"
38455,44600,DB2 date format day leading zero,"select REPLACE(VARCHAR_FORMAT(myDateField, 'Mon DD'), ' 0', ' ')
"
18648,74969,SQL join three tables (one is relational table),"select case when person_source.id is not null
            then source.name
       end ""name""
from source
left join person_source
  on source.id = person_source.source_id
  and person_source.person_sources_id = :id
order by source.id
"
22911,43277,Getting output in PLSQL procedure,"create or replace procedure testp as
begin
  insert into a (a) values (1);
  dbms_output.put_line( sql%rowcount || ' row inserted. ' );
end;
"
17595,22326,"Why are ""Null Like X"" and ""Not (Null Like X)"" equal?","NULL LIKE 'X'
NULL NOT LIKE 'X'
NOT (NULL LIKE 'X')
NOT (NULL NOT LIKE 'X')
"
2596,57898,SQL Query with Sum of Related Table,"select c.ID, c.LastName
from Clients c
join Orders o on o.ClientId=c.Id
join Payments p on p.OrderId=o.Id
where p.PaymentDate >= '2011-01-01'
group by c.ID, c.LastName
having sum(p.PaymentAmount) > 1000
"
4678,5096,SQL stored proc: How to detect whether optional output argument was passed or not?,"CREATE PROCEDURE dbo.sp_get_info
    @Identifier nvarchar(50),
    @field nvarchar(50),
    @value nvarchar(50) output
"
2644,25076,Getting data from a JOIN in SQL,"SELECT Products.ProductName, [Order Details].OrderID, [Order Details].Qty 
FROM Products 
INNER JOIN [Order Details] ON Products.ProductID = [Order Details].ProductID 
WHERE [Order Details].Quantity = (SELECT MAX(p.Quantity) FROM [Order Details] p WHERE p.ProductID = Products.ProductID)
"
36790,25356,check at least a record exists,"SELECT
  *,
  CASE WHEN EXISTS (SELECT *
                      FROM attachments
                     WHERE cust_id = customers.cust_id)
       THEN 1
       ELSE 0 END  AS has_attach
FROM
  customers
"
33272,11177,Why sub SQL in FROM area can't be null?,"select col_1,
       col_2
  from tbl_a A
          inner join
       tbl_b B
          on A.col_1 = B.col_1
             and A.col_2 = B.col_2
          left join
       ( select col_1,col_2 from tbl_c where clo_c_1 <> '1' ) C
          on
             C.col_2 = A.col_2
"
20135,63112,Oracle query group by type,"SELECT CASE WHEN type IN ('A', 'B') THEN type ELSE 'OTHERS' END AS type,
       SUM(qty) AS qty
  FROM x
GROUP BY CASE WHEN type IN ('A', 'B') THEN type ELSE 'OTHERS' END
ORDER BY 1
"
34701,1528,SQL Server 2005 For XML Explicit - Need help formatting,"SELECT 1 AS Tag,
0 AS Parent,
AccountNumber AS [Root!1!AccountNumber!element]
FROM Location.LocationMDAccount
WHERE LocationID = 'long-guid-here'
FOR XML EXPLICIT
"
35765,30463,MS Access query to get last 2 days,"SELECT [DATE_COLUMN]
FROM [TABLE]
WHERE [DATE_COLUMN] >= (SELECT DateAdd(""d"", -2, Max([DATE_COLUMN])) FROM [TABLE])
"
26334,27720,Maximum count in SQL,"with x as (
select l.leaguename, count(distinct p.playerid) as player_count 
from player p join league l on p.leagueid = l.leagueid
group by l.leaguename)
, y as (select max(player_count) player_count from x)
select x.leaguename, y.player_count
from x join y on x.player_count = y.player_count
order by x.leaguename
"
38652,19037,SQL set variable to a value in the current row,"SELECT @agentID = agentID FROM agentTable WHERE @index = rowID;
"
11378,68533,Nullable foreign key,"SELECT 
  Useraccount.Name, 
  Company.Name  
FROM Useraccount
LEFT JOIN Company ON Useraccount.CompanyId = Company.ID;
"
5442,48527,SQL Ranking Function,"SELECT playerID
    ,yearID
    ,Batting_average
    ,franchName
    ,rank() OVER (ORDER BY batting_average DESC) Batting_average_rank
FROM Material_Batting
WHERE yearID = 2013
ORDER BY Batting_average
"
36992,26848,Add multiple values in table's column against specific id,"create table T (
    ID char(8) not null,
    /* other columns */
    constraint PK_T PRIMARY KEY (ID)
)

create table PhoneNumbers (
    ID char(8) not null,
    PhoneType varchar(12) not null,
    Number varchar(15) not null,
    constraint PK_PhoneNumbers PRIMARY KEY (PhoneNumbers,PhoneType),
    constraint CK_PhoneNumber_Types CHECK (PhoneType in ('Home','Work','Mobile')),
    constraint FK_PhoneNUmbers_T FOREIGN KEY (ID) references T(ID)
)
"
30397,13146,SQL: Count() based on column value,"select companyId,
  sum(case when outcomeid = 36 then 1 else 0 end) SalesCount,
  sum(case when outcomeid <> 36 then 1 else 0 end) NonSalesCount
from yourtable
group by companyId;
"
15727,30270,Oracle text search default Stop words for non english locales,"drdefus.sql - american
drdefd.sql  - german
"
27038,50814,SQL Server - Add conditional inner join,"SELECT C.AwardId, C.ProgramName, Count(ClientId) as Intakes 
FROM Client C
LEFT JOIN UserRoleEntity URE ON C.AwardId = URE.EntityId 
LEFT JOIN UserRole UR ON URE.UserRoleId = UR.Id AND UR.CDPUserId = @UserId
WHERE C.Id = @ClientId
 AND (   testFunction(@UserId) = 0
      OR (testFunction(@UserId) <> 0 AND URE.AwardID IS NOT NULL AND UR.ID IS NOT NULL))
GROUP BY C.AwardId, C.ProgramName
"
37208,2721,Select min returns empty row,"SELECT MIN(price), MIN(year)
FROM tblProduct
WHERE price <> ''
"
15144,45701,Fluent nHibernate QueryOver SQL 'CASE' equivalent,"var result = session.QueryOver<MyEntity>()
    .Select(Projections.Alias(
        Projections.Conditional(Restrictions.Eq(""type"", 'a'),
            Projections.Property(t => t.name),
            Projections.Property(t => t.othername)),
        ""Name""
    )
    .List();
"
31636,1474,Select multiple minimum values,"WITH lb as (
      SELECT l.type, COUNT(b.num) as cnt
      FROM loan l LEFT JOIN
           borrower b
           ON l.no = b.num
      GROUP BY l.type
     )
SELECT lb.type
FROM lb
WHERE lb.cnt = (SELECT MIN(lb.cnt) FROM lb);
"
15174,251,INSERT statement with existing records,"insert into tbl(item_name, item_price) 
select item_name, item_price 
  from tbl 
 where id = 5
"
23072,29574,Sorting a tree while maintaining structure,"with recursive
ordered_tree as (
select tree.*,
       array[row_number() over w] as score_path
from   tree
where  depth = 1
window w as (order by tree.score desc)
union all
select tree.*,
       parent.score_path || array[row_number() over w] as score_path
from   tree
join   ordered_tree as parent on parent.id = tree.parent_id
window w as (partition by tree.parent_id order by tree.score desc)
)
select *
from   ordered_tree
order by score_path
"
7431,63159,SQL Server - update on-the-fly added column,"SELECT id,
       (CASE WHEN id=1 THEN 200 ELSE 100 END) AS NewCol
...
FROM Table
"
10765,26266,How to SUM an AS column in SQL,"SELECT SUM(WF.Frequency * WW.Weight) AS Product
FROM WF 
INNER JOIN WW ON WW.Word = WF.word
"
22230,47988,"How to convert Oracle ""TIME"" to JDBC Time in query?","String sql = ""Select to_date('1970-01-01 ' || ? ,'YYYY-MM-DD HH24:MI:SS) as MY_TIME from dual"";
Connection conn = null; //get Connection from somewhere
PreparedStatement stmt = conn.prepareStatement(sql);
stmt.setString(1, ""16:31:59"");
ResultSet rs = stmt.executeQuery();
rs.next(); //get to first element of result set;
java.sql.Time myTime = rs.getTime(1);
"
37157,6548,Replacing data of one table using another table in Mysql,"UPDATE locality JOIN city ON locality.City = city.city_name SET locality.City = city.city_id
"
24285,34899,Using CASE for an optional predicate,"SELECT email, u.user_id, first_name, last_name, rights
FROM users u
     LEFT JOIN manager_depts d ON d.company_id = u.company_id and d.dept_id = 2
WHERE company_id = 2141 AND receives_emails = 'y'
  AND (u.rights != 'manager' OR d.user_id IS NOT NULL)
"
39743,73546,Convert rows into columns without using PIVOT or Cased Aggregate Functions,"select customer,
       max(case when seqnum = 1 then distributor end) as distributor1,
       max(case when seqnum = 2 then distributor end) as distributor2
from (select t.*,
             row_number() over (partition by customer order by (select null)) as seqnum
      from t
     ) t
group by customer;
"
18178,11703,how to paste numbers with thousand separator from excel to sqldeveloper table editor,"Sub nospace()

Application.FindFormat.NumberFormat = ""#,##0""
Application.ReplaceFormat.NumberFormat = ""0""

Cells.Replace What:="""", Replacement:="""", _
    SearchFormat:=True, ReplaceFormat:=True

End Sub
"
29271,14900,Change a char in all records in SQL Server,"Update dbo.table
Set    col = replace(col, '_', '');
"
34790,42806,Database Design - Drop Down Input Box Issue,"ID |  TYPE  | VALUE
1  | PET    | BIRD
2  | PET    | DOG
3  | PET    | FISH
4  | SEASON | FALL
5  | SEASON | WINTER
6  | SEASON | SPRING
7  | SEASON | SUMMER
"
30078,13331,Pivot Assistance,"Select TR.Agent_ID
  ,TR.EvalForm_ID
  ,Max(TR.[1.0 Compliance]) [1.0 Compliance]
  ,Max(TR.REg_Fail)  REg_Fail
  ,Max(TR.[Marketing Guidelines]) [Marketing Guidelines]
FROM #TrendResults AS TR
WHERE TR.EvalForm_ID ='225777'
GROUP BY TR.Agent_ID, TR.EvalForm_ID;
"
5878,50393,Using alias in query and using it,"SELECT temp, temp / 5
FROM (
    SELECT (a/b) AS temp
    FROM xyz
) AS T1
"
34656,43573,SQL Duplicated Count Without Removing,"SELECT t.id1, t.id2, t.value, cnt
FROM   my_table t
JOIN   (SELECT   id1, count(*) AS cnt
        FROM     my_table
        GROUP BY id1) c ON t.id1 = c.id1
"
13623,62291,Select last 30 days with a sql query,";WITH CTE AS
(
    SELECT convert(date,GETDATE()) sDate, DATENAME(DW, GETDATE()) sDayofWeek
    UNION ALL
    SELECT DATEADD(DAY,-1,sDate), DATENAME(DW, DATEADD(DAY,-1,sDate))
    FROM CTE
    WHERE sDate > GETDATE()-29
)
SELECT * FROM CTE
"
22150,60582,SQL implement Table struct,"select table_name, column_name , data_type, attr_name, attr_type_name
from 
    user_tab_cols
    left outer join user_type_attrs 
    on(data_type = type_name)
where table_name = 'CAR'
;
"
22243,12439,Using Raw SQL with Doctrine,"$q = Doctrine_Manager::getInstance()->getCurrentConnection();
$result = $q->execute("" -- RAW SQL HERE -- "");
"
17598,74966,MySQL delete records after deleting group which they belong,"delete from `Companies` where `company_size` NOT IN (select `symbol` from `groups`);
"
774,66004,SQL - Group by numbers according to their difference,"select col1, col2, sum(group_gen) over (order by col2) as grp
from (
  select col1, col2,
         case when col2 - lag(col2) over (order by col2) > 1 then 1 else 0 end as group_gen
  from some_table
)
"
33045,65128,Group by select that returns only groups with updated rows,"SELECT distinct c.Company_FK, c.Year, c.Month, b.Amount FROM Postings c
INNER JOIN
(SELECT Company_FK, Year, Month, Sum(Amount) as 'Amount'
FROM Postings
GROUP BY Company_FK, Year, Month) b ON c.Company_FK = b.Company_FK and c.Year = b.Year and c.Month = b.Month
WHERE c.Handled = 0
"
7790,16773,Average elapsed days between two dates at customer level,"   SELECT 
     CLIENT,
     AVG(DATEDIFF(dd,DATEIN_DT,DATEOUT_DT)) AverageVisitTime
   FROM VISIT_TABLE
   GROUP BY CLIENT
"
31444,20259,Check order of rows in mysql,"SELECT user_id, CASE WHEN @user_id = user_id 
    THEN @rownum := @rownum + 1 
    ELSE ((@user_id := user_id) * 0) + (@rownum := 1) END AS rownum
FROM (  SELECT user_id
        FROM bids, (SELECT @rownum := 0, @user_id := NULL) AS vars
        WHERE auction_id = 1
        ORDER BY created DESC) AS h
HAVING user_id = '{$user->id}' AND rownum >= 3
"
32748,52520,Bracket for IF statement in Stored Procedure,"IF(@item!=0)
begin
/*Do stub*/
RETURN   
/* without the brakets , this return does not belong to if  */
end 
"
10856,31551,How do I call a SQL Server 2000 DTS package in VB.net,"process.start(""dtsrun /S """"server name"""" /U sa /N """"d:\task.dts"""""")
"
1606,16987,Create mySQL junction table from single table with parent-child relationship,"SELECT  a.number parent,
        b.number child
FROM    TableName a
        CROSS JOIN TableName b
WHERE   a.parent = 1 AND
        b.parent = 0
ORDER   BY a.number, b.number
"
26694,34548,sql how to extract from two tables and join them like the example,"SELECT ID, Sum1, 0 AS Sum2
FROM TableA

UNION ALL

SELECT ID, 0 AS Sum1, Sum2
FROM TableB
"
36696,36622,create a table with composed primary keys,"course
---------
id_course    (Primary Key)
title

course_group
------------
id_course    (FK referencing course) } composite PK
id_groupe    (FK referencing groupe) }
"
18332,45575,COALESCE function and to get the data from the supporting field,"SELECT COALESCE(TestCode1 + ' - TestCode1',
                TestCode2 + ' - TestCode2',
                TestCode3 + ' - TestCode3',
                ''
               ) TestCode
FROM SOMEORDER;
"
26123,11407,"Combine data from 2 ""strange"" tables","WHERE MovieID IN
(
SELECT 
    MovieID
FROM
    MovieTable
LEFT JOIN TICKETS ON MovieID = TICKETS.movieID
LEFT JOIN CUSTOMER ON TICKETS.ID = CUSTOMER.ID
WHERE
CUSTOMER.customer_sex LIKE 'Male'
AND Tickets.ticket_date > '2016-02-16')
)
"
9635,32271,SQL - Adding an avg column to a detail table,"AVG(order_amount) OVER (PARTITION BY custID, month)
"
29425,46888,Order by date from two tables using Union alternative,"SELECT IF(comment = 'view', 'view', 'comment') AS type, comment, fullname, created_at
FROM
(
  SELECT comment, fullname, comments.created_at
  FROM comments
  WHERE comments.photo_id = 14
  UNION
  SELECT 'view', user, views.created_at
  FROM views
  WHERE views.pid = 14
) tbl
ORDER BY created_at DESC
"
21906,13328,Getting all fields from table filtered by MAX(Column1),";with cte as(select *, row_number(partition by tin order by specified desc, id desc) as rn
             from tablename)
select * from cte where rn = 1
"
1592,16730,how to convert linq query to sql,"dc.GetCommand(query).CommandText
"
15731,54793,inserting data from two tables into one,"insert into total (Id, name, Total_days_working, Total_nights_working, Total)
Select Workers_day.id,Workers_day.name,
IIf([day_one]>0,1,0)+IIf([day_two]>0,1,0) as Total_days_working,
IIf([night_one]>0,1,0)+IIf([night_two]>0,1,0) as Total_nights_working,
Total_days_working+Total_nights_working AS Total
From Workers_day,Workers_night
Where Workers_day.id = Workers_night.id
"
20697,19015,conditional sql query,"SELECT t2.name,  IF(t1.type='R',t2.revolution,t2.nibs) as value 
FROM table1 t1 
LEFT JOIN table2 t2 ON t1.data2 = t2.name
WHERE t1.data1 = ?
"
29363,24485,Same SQL query on each array element,"select   the_table.room,MIN(eventtime) as event_start_time_of_day
from     the_table
group by the_table.room;
"
29031,11881,How do I insert one value into one column?,"INSERT INTO Table (field)
VALUES (@datapassedin)
"
5795,74968,Compare a string to the system time," select 
 *
from
 table where 
 date(to_date(time_stamp,'DD-MM-YYYY HH:MI:SS')) < [current system time]
"
2011,39318,Lookup from multiple tables,"SELECT so.[Group Name], o.[Organisation Name]
FROM Organisations AS o
LEFT JOIN [Sub-Organisations] AS so
    so.[Organisation Name] = o.[Organisation Name]
    -- Or whatever your parent child relationship identifier is
"
39599,32632,mySQL - Combining result from rows depending on count in first row?,"select order_number, dr_amount, dr_speed, oi_amount, oi_up
from data
where order_number in (select order_number
                       from data
                       where oi_amount IS NOT NULL
                       group by order_number
                       having count(*) < 2
                      ) and
      dr_amount is not null;
"
35111,46043,adding values to code from a spreadsheet,"=CONCATENATE(""<div class=""""product-page-wrapper""""><div class=""""product-page-img""""><img alt="""""""" width=""""137"""" height=""""125"""" src=""""/Portals/6/aggProd.png"""" /></div><div class=""""product-page-title"""">"",A2,""</div>"", ""...etc..."")
"
38423,6085,Best table structure for tracking state changes,"SELECT *
FROM Components c
JOIN StatusHistoryItems shi on c.ID = shi.ComponentID
     AND c.IsCurrent = 1 --this condition will join exactly one row
"
19292,74406,Help creating a single SELECT statement for SQL Reports,"select Account, 
    sum(case when Type='D' then Amount * -1 else Amount end) as AmountSum
from Payment
group by Account
"
12618,60205,MS Access validation rule,"UPDATE yourTable
SET me = LEFT(TNS_Type, 1)
"
3007,57078,SQL Server query + joining results,"select a.ID,Received,Sent
from(
  SELECT recipientid AS ID,
  COUNT(*) AS Recieved FROM Inbox
  GROUP BY recipientid
)a
full outer join(
  SELECT SenderId as ID,
  COUNT(*) AS [Sent] FROM Inbox
  GROUP BY SenderId
)b
on (a.ID = b.ID)
order by a.ID;
"
17472,44618,SQL changing a value to upper or lower case,"SELECT UPPER(firstname) FROM Person

SELECT LOWER(firstname) FROM Person
"
39929,6668,Query a table with 2 foreign keys,"SELECT m.id, m.name, a.personID, a.TableName
FROM Mail m
INNER JOIN (SELECT s.mailid, s.personID, 'Source' AS TableName
            FROM Source s 
           UNION ALL
            SELECT d.mailid, d.personID, 'Destination' AS TableName
            FROM Destination d
           ) AS a ON m.id = a.mailid
ORDER BY m.id, a.TableName;
"
36449,34249,SQL Replace blank result value in GROUP BY results,"case when Ks2en = '' then 'No KS2' else ks2en end as 'KS2' 
"
37708,26716,Remove dots and commas from column values,"replace('Your String','charater you want to replace','with what')


stuff('Your String',position,count,'data') 
"
21347,70715,Oracle query needs to return the highest date from result,"SELECT * FROM
( SELECT custid,reason,date FROM OPT opt WHERE opt.custid = 167043
  ORDER BY date DESC
) 
WHERE ROWNUM = 1;
"
26313,38349,How to determine birth week in current year for 7 day coupon,"with sourceData as (
  select 'John Brown' FullName, DATE '1965-01-1' BirthDate 
  from dual
), BirthDatesThisYear as
(
  select 
    FullName,
    Add_Months(BirthDate, (extract(YEAR from sysdate)- extract(YEAR from birthdate))*12) BirthDateThisYear
  from sourceData
)
select 
  FullName,
  NEXT_DAY(BirthDateThisYear-8,'MON') PreviousMonday,
  NEXT_DAY(BirthDateThisYear-8,'MON')+6 NextSundayFromPrevMonday
from BirthDatesThisYear;
"
18207,4091,use recursive common table expressions like a while loop,"WITH    days (d, maxd) AS
        (
        SELECT  MIN(date), MAX(date)
        FROM    log
        UNION ALL
        SELECT  DATEADD(day, 1, d), maxd
        FROM    days
        WHERE   d < maxd
        )
SELECT  d, COUNT(id)
FROM    days
LEFT JOIN
        log l
ON      l.date = d
GROUP BY
        d
"
28113,35871,SQL query to report duration untill next log entry,"with cte as (
    select
        status,
        lead(status_change_date) over(order by status_change_date) as next_date,
        status_change_date
    from Table1
)
select
    status, count(*) as cnt,
    sum(next_date - status_change_date) as duration
from cte
where next_date is not null
group by status
"
22,47280,How to implement sql Query to do Outer Joins based on 2 columns,"SELECT tm.userid,
  ty.courseid,
  CASE WHEN tx.cid IS NULL THEN 'not done' ELSE 'done' END AS 'F'
FROM tablem tm
JOIN tabley ty ON 1=1
LEFT JOIN tablex tx ON tm.userid = tx.userid AND ty.courseid = tx.cid
ORDER BY tm.USERID
"
20935,51385,Return date from function in PL/SQL,"rec := to_date(a||'/'||b||'/'||c,'YY/MM/DD');
"
9502,54857,SQL: How to get the original sorting when joining two tables,"order by Table1.Name, Table2.Money
"
39923,4056,SQL query to group by data but with order by clause,"SELECT
    guest_no,
    hotel_no,
    room_no,
    COUNT(1) AS BookingCount
FROM
    booking
GROUP BY
    guest_no,
    hotel_no,
    room_no
ORDER BY
    MAX(date_to) DESC;
"
15771,25233,mysql update field's character,"UPDATE yourtable SET `alias`=REPLACE(`alias`,'_','.');
"
10484,5063,Find units with zero categories,"SELECT u.id, u.name
FROM Unit as u
LEFT JOIN UnitCategoryIndex as uci
ON u.id = uci.UnitId
where uci.id is null
"
10005,44339,"In Play, can I apply different Evolutions depending on database type?","lazy val default = Database.forDataSource {
    val defaultSource = current.configuration.getString(""db.test.url"").fold(""default"")(_ => ""test"")
    new play.api.db.DB.getDataSource(defaultSource)
}
"
29983,51956,SQL using sp_HelpText to view a stored procedure on a linked server,"EXEC  [ServerName].[DatabaseName].dbo.sp_HelpText 'storedProcName'
"
20483,13716,access query to filter and combine count,"SELECT DISTINCT tableA.num, [tableA].[val]+[tableB].[val] AS Expr1
FROM tableA INNER JOIN tableB ON tableA.num = tableB.num
WHERE (((tableA.val)>=6) AND ((tableB.val)>=6));
"
30248,27116,SQL Integrity Constraint VarChar Comparison,"CREATE TABLE User
(
    UNAME VARCHAR(100),
    FNAME VARCHAR(100),
    LNAME VARCHAR(100),
    CONSTRAINT CHECK_USERS 
        CHECK(INSTR(UNAME, FNAME) = 0 AND INSTR(UNAME, LNAME) = 0)
)
"
23028,4841,Convert Column Heading to row data - sql,"SELECT 
   CASE Region 
    WHEN 1 THEN 'North'
    WHEN 2 THEN 'South' 
    WHEN 3 THEN 'West'
    WHEN 4 THEN 'East'
    WHEN 5 THEN 'Central' END AS Region  
    , COUNT(ID)   --or your primary key if it is different
FROM ATM
WHERE ATMStatus = 0 AND Bank = 1
GROUP BY Region
"
29370,29345,Teradata / Report Buildeer 3.0 cast date between 2 different data types,"  select jsdate, jsn, junit, jmyear, jmake, jmodel, jseries, jbuyid
    from vehicle_mgmt.AA0888
    where jfinowngp = 'B1' and jfinownbr = '99' and 
CAST(jsdate - 19000000 AS DATE FORMAT 'mm/dd/yyyy') between 
CAST('2015/11/05' AS DATE) 
and CAST('2015/12/31' AS DATE)
"
9773,54094,How to create copy trigger function in PostgreSQL?,"CREATE OR REPLACE FUNCTION save_order_in_history()
  RETURNS trigger
AS $$
BEGIN
  INSERT INTO order_history(order_id, total_price, product_amount)
  VALUES (NEW.id, NEW.total_price, NEW.product_amount);
  RETURN NULL;
END $$ LANGUAGE plpgsql;

CREATE TRIGGER order_trigger AFTER INSERT OR UPDATE
ON ""order"" FOR EACH ROW EXECUTE PROCEDURE save_order_in_history();
"
33477,42271,SQL Get common values by grouping rows,"SELECT group_ID
FROM tableName
WHERE uid IN (1,2,3)
GROUP BY group_ID
HAVING COUNT(*) = 3
"
7609,3735,How to Create MySQL Query to Find Related Posts from Multiple Tables?," SELECT article_id, count(*) as common_term_count FROM 
      (
      SELECT article_id FROM tags WHERE tag IN 
         (SELECT tag FROM tags WHERE article_id = :YourArticle)
      UNION ALL 
      SELECT article_id FROM categories WHERE category IN
         (SELECT category FROM categories WHERE article_id = :YourArticle)
       ) AS accumulator_table 
 GROUP BY article_id ORDER common_term_count DESC
"
3048,24633,Sql Counting rows for two columns where col1 same as col2,"SELECT * FROM
  (SELECT Data1, COUNT(Data1) FROM Table GROUP BY Data1) d1
  JOIN (SELECT Data2, COUNT(Data2) FROM Table GROUP BY Data2 ORDER BY Data2) d2
    ON d1.Data1 = d2.Data2
  ORDER BY d1.Data1;
"
22209,46781,How to delete old data?,"DELETE FROM myTable WHERE [columndate]< DATE_SUB(NOW(), INTERVAL 1 MONTH);
"
18601,38543,How to get date difference between two dates in same year with one date is from an input date not from the year,"SELECT
  DayDiff = DATEDIFF(
    DAY,
    DATEADD(YEAR, CASE WHEN LastOcc > GETDATE() THEN -1 ELSE 0 END, LastOcc),
    GETDATE()
  )
FROM (
  SELECT LastOcc = DATEADD(YEAR, YEAR(GETDATE()) - YEAR(@InputDate), @InputDate)
) s
"
27987,66990,GROUPING ORDER BY - SQL,"ORDER BY marks DESC, time ASC
"
26536,46720,Please help on a complicated sql query,"select client_name, count(*) as transactions
from TableA
group by client_name
order by count(*) DESC
"
19426,69270,Update column of a table based on array of varchar in PostgreSQL,"update t
set    colorcode = middle.cc
from   (
        select id, ('{#FF8484,#FF82A9,#FA82FF,#C682FF,#8782FF}'::text[])[rn] as cc
        from   (select id, row_number() over (order by id) as rn from t) as base
        where  rn <= 5
       ) as middle
where middle.id = t.id;
"
6024,33904,To NULL particular fields in retrieval time in sql,"select isnull(column1+',','')+isnull(column2+',','')+isnull(column3,'') AS column4 from table
"
13591,61677,efficient way to JOIN in SQL,"SELECT *
FROM
 (
   SELECT *,
     RANK()  -- max date gets rank #1
     OVER (PARTITION BY a.article_id
           ORDER BY a.load_date DESC) rn
   FROM sales s
   INNER JOIN articles a
   ON s.article_id = a.article_id
 ) dt
WHER rn = 1
"
38085,829,MySQL IN BETWEEN with no condition,"... AND `entry_datetime` BETWEEN '1000-01-01 00:00:00' AND '9999-12-31 23:59:59'
"
34554,9107,SQL Count for a Date Column,"SELECT
 COUNT(date)
 , TRUNC(DATE,'MON')
FROM TABLE
GROUP BY TRUNC(DATE,'MON')
HAVING COUNT(DATE) > 3
"
11242,3142,Remove duplicates based on a condition,";WITH DATA AS
(
    SELECT TRXID, MAX(YourTimestampColumn) AS TS
    FROM YourTable
    GROUP BY TRXID
    HAVING COUNT(*) > 1
)
DELETE T
FROM YourTable AS T
INNER JOIN DATA AS D
    ON T.TRXID = D.TRXID
   AND T.YourTimestampColumn = D.TS;
"
2463,55383,SQL query to get product sales by category for each month,"SELECT 
YEAR(o.OrderDate) as [Sales Year],
MONTH(o.OrderDate) as [Sales Month],
SUM(case when c.catid = 1 then o.TotalAmount else 0 end) AS [Dispenser Sales],
SUM(case when c.catid = 2 then o.TotalAmount else 0 end) AS [Refill Sales]
FROM Orders o
join orderdetails od on o.order_id = od.orderid
join store s on s.pro_id = od.pro_id
join category c on c.catid = s.catid
GROUP BY YEAR(o.OrderDate), MONTH(o.OrderDate)
ORDER BY YEAR(o.OrderDate), MONTH(o.OrderDate)
"
9347,39502,What is going wrong in this?,"ArrayList<String> tables = new ArrayList<String>();
Cursor mCursor = db.query(""sqlite_master"", new String[]{""name""}, ""type = table"",
        null,null,null,null);
if (mCursor.getCount() > 0) {
    for (mCursor.moveToFirst(), !mCursor.isAfterLast(), mCursor.moveToNext()) {
        tables.add(mCursor.getString(0));
    }
}
/** Important! always close cursors and DB's */
mCursor.close();
db.close();
return tables;
"
32870,62198,Change the result to decimal in sql server,"cast(sum(M1) as decimal(9,2))/cast(sum(M2) as decimal(9,2))
"
35593,21983,Where clause in select statement when joining to table,"Select l.location_id, l.address_line_1, l.address_line_2, l.address_line_3, l.address_line_4, l.postcode, l.name, e.employee_name, l.location_type, l.mapped_wh_id, l.client_code
from T_3PL_location l
LEFT JOIN t_engineer e on l.location_id = e.location_id
WHERE l.location_id LIKE '%' AND (NVL(e.employee_name,"""") LIKE '%')
ORDER BY l.location_id;
"
5754,18969,boolean check for empty date field,"SELECT TOP 1 ordersTable.startDate, ordersTable.endDate
, IIF(ordersTable.endDate Is Null, ""Yes"", ""No"") As IsEmpty
FROM ordersTable 
WHERE ordersTable.customerID=1 
ORDER BY ordersTable.startDate DESC;
"
37861,3773,counting mysql values,"  SELECT TAG_DESC as 'Description', 
         COUNT(TAG_DESC) as 'Occurances' 
    FROM table_name 
GROUP BY TAG_DESC
"
18276,30006,Iterating through date ranges,"Impression.where(:impressionable_id => document).where(""YEAR(created_at) = ? && MONTH(created_at) = ? && DAY(created_at) = ?"",date.year,date.month,date.day).count
"
3822,38056,Get data from 3 database tables,"SELECT C.ID, C.TEXT, C.ROOMID, U.USERNAME, U2.USERNAME 
FROM  COMMENT C 
INNER JOIN COMMENTRATE CR ON C.ID = CR.COMMENTID
INNER JOIN  USERS U ON C.USERID = U.ID
INNER JOIN  USERS U2 ON CR.USERID = U2.ID
WHERE U.USERNAME IN ('username1', 'username2')
ORDER BY C.ROOMID
"
7894,26892,displaying a number in the following format '$454-25' in Oracle,"REPLACE(TO_CHAR(00145248.25,'$999,999,999,999.99'),'.','-')
"
11199,38607,SQL View returning filtered data from unnormalized table,"select distinct on (transponder, country, system) * from some_table
order by transponder, country, system, time desc
"
38542,29056,Comparing two rows in a table,"select count(distinct professorID) as prof_count
from vorlesungen
where nameOfTheLecture in ('Logik','Erkenntnistheorie')
"
38046,74303,how to generate Serial numbers +Add 1 in select statement,"SELECT party_code, 1 + ROW_NUMBER() OVER (ORDER BY party_code) AS [serial number]
FROM myTable
ORDER BY party_code
"
14754,10819,"Postgresql, made domain named 'name', how can I delete it?","DROP DOMAIN public.name;
"
3894,62946,Oracle: Is it possible to choose which table to join based on a column value?,"SELECT AI.*
FROM ACTION_ITEMS AI
LEFT JOIN INCIDENTS ON AI.SOURCE_TYPE = 'INC' AND (AI.SOURCE_ID = INCIDENTS.ID)
LEFT JOIN AUDITS    ON AI.SOURCE_TYPE = 'AUD' AND (AI.SOURCE_ID = INCIDENTS.ID)
"
29781,42466,complex query to get total balance for each day,"SELECT dnt, 
   @running_bal := @running_bal + `Balance` as `Balance`
FROM 
  (SELECT dnt, SUM(Credit) - SUM(Debit) as `Balance` FROM transactions GROUP BY dnt) tmp,
  (SELECT @running_bal := 0) tempName
ORDER BY dnt ASC
"
26768,62846,SQL convert sample points into durations,"select groupid, pid, min(time), max(time)
from (select t.*,
             (dense_rank() over (order by time) -
              row_number() over (partition by pid order by time)
             ) as groupid
      from t
     ) t
group by groupid, pid
"
35875,74305,Select from two tables and set null column,"select row_number() over (order by scheduleID desc) as schedule, scheduleID, 
       Driver_ID, FirstName, LastName
From Schedule left join
     Employee
     on EmployeID = Driver_ID
where scheduleDate = '2015-05-21';
"
9576,10351,how to check condition while creating view in sql,"group_concat(IFNULL(`a`.`license`, 'NULL') separator '||') AS `license`,
"
36375,35385,How to write this query in SQL with category and date sum,"SELECT
    DATE_FORMAT(DATE, '%Y %b') AS MONTH,
    SUM(AMOUNT) AS TOTAL,
    SUM(IF(CATEGORY='A', AMOUNT, 0)) AS `Category-A`,
    SUM(IF(CATEGORY='B', AMOUNT, 0)) AS `Category-B`,
    SUM(IF(CATEGORY='C', AMOUNT, 0)) AS `Category-C`
FROM your_table
GROUP BY MONTH;
"
33923,11148,Pivoting equivalent in postgresql,"Select YR, 
  sum(case when ListeningProfRating = 1 then 1 else 0 end) As Begining,
  sum(case when ListeningProfRating = 2 then 1 else 0 end) As Inter,
  sum(case when ListeningProfRating = 3 then 1 else 0 end) As Advanced,
  sum(case when ListeningProfRating = 4 then 1 else 0 end) As AdvHigh
  Campus 
from mytable
Where YR = '2014' 
  AND ListeningScoreCode IN('S', 'B')
group by yr, campus
"
36725,25634,Using DISTINCT in SQL Query,"SELECT DISTINCT 
    Suppliers.SupplierID, Customers.CompanyName, Products.ProductName,    
    Orders.OrderDate
FROM         
    Suppliers INNER JOIN
    Products ON Suppliers.SupplierID = Products.SupplierID CROSS JOIN
    Customers INNER JOIN
    Orders ON Customers.CustomerID = Orders.CustomerID
WHERE 
    Orders.OrderDate <='1/1/1999'
ORDER BY     
    Suppliers.SupplierID
"
16918,59756,How to join results of 2 tables based on not condition,"SELECT id, name, partNumber, Aid, Aname, Apart
FROM TableB AS t
CROSS JOIN (SELECT id AS Aid, name AS Aname, partNumber AS Apart
            FROM TableA AS a
            WHERE NOT EXISTS (SELECT 1
                              FROM TableB AS b
                              WHERE b.partNumber = a.partNumber)) AS c
ORDER BY id    
"
28207,15822,remove all numeric characters from column mysql,"Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(column,'9',''),'8',''),'7',''),'6',''),'5',''),'4',''),'3',''),'2',''),'1',''),'0','')
"
19657,52812,Is there a way to rename a similarly named column from two tables when performing a join?,"SELECT p.*, om.MemberId, etc..
"
20835,49836,Selecting top 10 counts in SQLite,"SELECT BY COUNT(author)
    ,author
FROM table_name
GROUP BY author
ORDER BY COUNT(author) DESC LIMIT 10;
"
39289,34593,Mysql display values if i have only user entered value,"(SELECT * FROM myTable WHERE STR_TO_DATE('07.11.1986', '%d./%m./%Y')  < data ORDER BY data ASC LIMIT 1)
UNION ALL
(SELECT * FROM myTable WHERE STR_TO_DATE('07.11.1986', '%d./%m./%Y')  > data ORDER BY data DESC LIMIT 1)
"
15419,44219,select max value within grouped ids,"select m.ID, m.RefID, g.value
from myTable m inner join
(
 select max(value) as value, RefID from myTable group by RefID
) g
on m.RefID = g.RefID
"
5153,62715,Is the join query correct?,"SELECT 
    alias, type, sha, originalname 
FROM 
    ad_categories 
LEFT JOIN 
    ad_location ON ad_location.alias = '?' 
LEFT JOIN 
    ad_data ON ad_data.cid=ad_categories.id AND ad_location.id=ad_data.lid 
LEFT JOIN 
    ad_image ON ad_image.pid=ad_data.id GROUP BY type;
"
11783,33068,Variable in LIKE clause,"select Address
FROM   Addresses
WHERE  Address NOT LIKE HouseNumber + ' %'
"
21192,67213,Get the value from a default constraint,"SELECT 
    DefaultConstraintName = df.name,
    df.definition
FROM 
    sys.default_constraints df
INNER JOIN 
    sys.tables t ON df.parent_object_id = t.object_id
INNER JOIN 
    sys.columns c ON c.object_id = df.parent_object_id AND df.parent_column_id = c.column_id
WHERE 
    t.Name = N'YourTableNameHere'
    AND c.Name = N'YourColumnNameHere'
"
26719,2691,SQL Server: Computed Column defintions retrievable from Database?,"create table dbo.Foo
(
StartDate int,
CallDT AS (CONVERT([datetime],dateadd(second,[StartDate],'01/01/1970'),(0)))
)

select definition 
from sys.computed_columns 
where name='CallDT' and object_id=object_id('dbo.Foo')
"
15907,37587,How to list out Top 10 salaries with out using TOP,"SELECT  Salary
from
(
  SELECT  Salary, Row_Number() OVER(ORDER BY SALARY desc) AS 'Salaries'
FROM User2
)#emp 
  WHERE  Salaries <=10 order by salary desc
"
15969,64059,SQLite: query excluding rows depending on combinations of values from other columns,"WITH
excluded_positions(position_x, position_y, position_z) AS (
  VALUES (10, 30, 500),
         (45, 0, 75),
         ...),
excluded_rowids AS (
  SELECT mytable.rowid
  FROM mytable
  JOIN excluded_positions USING (position_x, position_y, position_z))
SELECT ValuesA, ValuesB, ValuesC
FROM mytable
WHERE ...
  AND rowid NOT IN excluded_rowids
"
4964,72383,"IF statements based on numerical value(1,0) in table to determine string result","SELECT a.id, a.company_id, 
(CASE WHEN p.teacher_status = '1' THEN  'YES' ELSE 'NO' END
) AS teacher,
(CASE WHEN p.student_status = 1 THEN  'YES' ELSE 'NO' END
) AS student,
p.teacher_status, /* for testing purpose only to view the field value */
p.student_status  /* for testing purpose only to view the field value */
FROM company a
LEFT JOIN person p
ON a.company_id = p.company_id
"
28639,44805,How can I round a date object to the end of the month in MySQL?,"SELECT LAST_DAY(DATE_ADD('2010-11-24', INTERVAL 3 YEAR))
"
9270,40410,Oracle object types & object tables,"select ot.table_name, tt.type_name
  from (
select t.type_name,
       connect_by_root t.supertype_name rkey
  from user_types t
connect by prior t.type_name = t.supertype_name ) tt,
       user_object_tables ot
       where ot.table_type = tt.type_name or ot.table_type = rkey
"
2084,72412,SQL Group By Help Required,"Select Date
     , count(case when Name = 'Peter' then 1 else null end)
     , count(case when Name = 'John' then 1 else null end)
     , count(case when Name = 'Mark' then 1 else null end)
From People
Group By Date;
"
18897,30716,TSQL merge 2 dataset with even number of rows next to eachother,"SELECT
    T1.Col1,
    T2.Col1
FROM
    (SELECT Col1, ROW_NUMBER() OVER (ORDER BY Col1) AS N FROM Table1) T1
INNER JOIN
    (SELECT Col1, ROW_NUMBER() OVER (ORDER BY Col1) AS N FROM Table2) T2
ON T1.N = T2.N
"
1708,59352,Boolean Expressions in SQL Select list,"select 'Test Name', 
    case when foo = 'Result' then 1 else 0 end 
    from bar where baz = (some criteria)
"
8685,38181,Include row number in query result (SQL Server),"Select ....
    , Row_Number() Over ( Order By T.SomeColumn ) As Num
From Table As T
Order By T.SomeColumn
"
33822,52990,How to get xml from many records?,"SELECT ProductId,
    a.b.value('@upccode','int') as UPC,
    a.b.value('@dateadded','date') as DateAdded
FROM Products
  CROSS APPLY ProductsXML.nodes('xml/Product/UPC')a(b);
"
6190,21939,sql distinct on one column of a group,"select distinct t.inta , 
                (select top 1 a.name from nydta.adres a where a.inta=t.inta) name,
                (select top 1 a.PHH from nydta.adres a where a.inta=t.inta) PHH
from nydta.adres t
where inta <> ' '
"
26813,16317,Django filter multiple columns with a list of tuples,"Simple.objects.extra(where=['(a,b) in %s' % your_list])
"
2661,27868,MySQL View: How do I set default value of a calculated field to 0?,"coalesce(
    round(
        ((Surveys.RejectedAsAdvertising / Surveys.Responses) * 100)
        ,0)
    ,0)
    AS PercentageAdvertising
"
14791,44713,Update local database using remote database data,"create or replace
PROCEDURE       ""LOAD_USERNAME"" 
IS
   cursor usu is
select distinct local_user.userid,your_dblink_table.cod_user
      from local_user, user_table@bdlink your_dblink_table
where local_user.userid=your_dblink_table.codperson
and local_user.externaluserid=local_user.userid;
BEGIN
   for usu_rec in usu
   loop
      update loc_user set username =usu_rec.cod_user
where externauserid=usu_rec.userid;
 end loop;
commit;
END;
"
30253,72398,Is there any way to combine IN with LIKE in an SQL statement?,"select p.*
from
  (select code_wildcard
   from second
   where id = 1) s
  join parent p
      on p.office_code like s.code_wildcard
"
4749,60255,How do I Get a WPF DataGrid to Save Changes Back to the DataBase?,"public CustomerDataProvider()
{
    NorthwindDataSet dataset = new NorthwindDataSet();

    adapter = new CustomersTableAdapter();
    adapter.Fill(dataset.Customers);

    dataset.Customers.CustomersRowChanged +=
        new NorthwindDataSet.CustomersRowChangeEventHandler(CustomersRowModified);
    dataset.Customers.CustomersRowDeleted +=
        new NorthwindDataSet.CustomersRowChangeEventHandler(CustomersRowModified);
}

void CustomersRowModified(object sender, NorthwindDataSet.CustomersRowChangeEvent e)
{
    adapter.Update(dataset.Customers);
}
"
2760,11695,Oracle Spool using Dynamic SQL,"set linesize 10000 pagesize 0 embedded on
set heading off feedback off verify off trimspool on trimout on  termout off
set underline off

SPOOL myfilename.sql

SELECT 'SELECT table_name||'',''||column_name FROM USER_TAB_COLS WHERE ROWNUM < 10;' gen_sql_ FROM DUAL;

SPOOL OFF

spool results.csv

@myfilename.sql

SPOOL OFF
"
36646,22481,Fixing Joined Many-to-Many MySQL Query,"SELECT GROUP_CONCAT(distinct `a`.`attr`) AS `attrs` . . .
"
19497,9316,MySQL: Get rows with different arguments,"SELECT name_id
FROM attributes
WHERE skill IN ('css', 'html')
GROUP BY name_id
HAVING COUNT(DISTINCT skill) = 2
"
39674,54576,Inserting output parameters from stored procedure directly,"--INSERT...EXECUTE procedure example
INSERT author_sales EXECUTE get_author_sales
"
12690,12677,Comma-separated values (CSV) parameter filtering,"Declare @IDs Varchar(100)
SET @IDs = '2,4,6'

Select IsNull(STUFF((Select ', '+ CAST([Name] As Varchar(100)) From [TableName]
Where CharIndex(','+Convert(Varchar,[ID])+',', ','+@IDs+',')> 0
For XML Path('')),1,1,''),'') As [ColumnName]
"
17076,21152,is there a way to convert the time format in the mysql,"SELECT FROM_UNIXTIME(`updatetime`, '%m-%d') AS `updatetime` 
  FROM `node_software`
"
12032,2428,A SQL lookup on two tables;,"SELECT
    Student.name
FROM Student s
JOIN Teacher t
  ON t.s_id = s.id
WHERE Teacher.name=""Prof. David"";
"
35357,46817,How do delete related data in MySQL tables in a database?," DELETE Tasks, Activities
 FROM Tasks INNER JOIN Activities
 ON Tasks.KeyID = Activities.Task
 WHERE Tasks.User = 'User Name Here'
"
20181,27003,Merge table results using SQL Query,"SELECT PageID,
       MAX(CanView)   [CanView],
       MAX(CanDelete) [CanDelete],
       MAX(CanEdit)   [CanEdit]
FROM   table
--WHERE  UserGroupID in(1,2)
GROUP  BY PageID 
"
22533,919,Test for COUNT()>X inside SQLite trigger,"CREATE TRIGGER mytrigger
BEFORE INSERT ON mytable
BEGIN
    SELECT CASE WHEN 
        (SELECT COUNT (*) FROM mytable) >= 3
    THEN
        RAISE(FAIL, ""Activated - mytrigger."")
    END;
END;
"
35243,41640,"using min, max and avg in mysql query","select 'Min', product_id 
from productlist
where cost = (select min(cost) from productlist)
UNION 
select 'Max', product_id
from productlist
where cost = (select MAX(cost) from productlist)
UNION 
select 'Avg', round(AVG(cost),0) as Avg
from productlist
"
30522,67688,Maintain sql order in mysql after group,"select  site_id
,       max(count) as TopCount
from    tags 
where   match (tag) against ('statistici' in boolean mode) 
group by 
        site_id 
order by
        TopCount DESC
"
26580,17106,How to UPDATE column with ROW_NUMBER() in Teradata?,"UPDATE test1
FROM
 ( SELECT ROW_NUMBER() OVER (ORDER BY emp_id) AS rn,
     emp_id 
   FROM test1
 ) AS src
SET emp_id = src.rn
WHERE test1.emp_id = src.emp_id -- must be unique column(s)
"
28753,22881,Variable Custom Fields in a Page in Silverstripe; Populate Table,"// HobbyPage.php
class HobbyPage extends Page {

    private static $has_many = array(
        'Hobbies' => 'HobbyPage'
    );

}

// Hobby.php
class Hobby extends DataObject {

    private static $has_one = array(
        'HobbyPage' => 'HobbyPage'
    );

    private static $db = array(
        'Title' => 'Varchar(250)',
        // Any extra fields you want
    );

}
"
22516,23388,"How to use date variable in sql developer's ""Enter Binds"" dialog?","select first_name,
       last_name,
       dob,
       org
  from emp
 where dob > to_date(:highDate,'YYYY-MON-DD');
"
37150,40274,SQL how to select product where each data has a duration less than 300000 ms,"select  r.UPC ,r.Id, res.ISRC , res.Duration ,COUNT( res.ISRC) from Release r 
inner join ReleaseResource rr on rr.ReleaseId=r.Id
inner join Resource res on res.Id=rr.ResourceId
inner join ReleaseTerritory rt on rt.ReleaseId=r.id
where   not r.OwningTerritoryId in (31,201,41,125) and  r.TrackCount=11 and rt.IsDeleted=0
group by r.UPC ,r.Id, res.ISRC , res.Duration
having COUNT( distinct rt.TerritoryId)=10  AND MAX(res.Duration)<5*60000
order by r.upc
"
32035,70720,MySQL query optimization: Multiple SELECT IN to LEFT JOIN,"select distinct
  u.id, u.first_name, u.last_name, u.description, u.email 
from 
  assigned a
  left join assigned ap on ap.id_project = a.id_project
  left join projects p on p.id = a.id_project
  inner join users u on u.id = ap.id_user or u.id = p.id_user
where
  a.id_user = 1
"
25023,69566,SQL select where not in select statement,"SELECT ID
  FROM PART
 WHERE NOT EXISTS 
    (
        SELECT 1
        FROM USER_DEF_FIELDS
        WHERE PROGRAM_ID = 'VMPRTMNT' 
          AND ID = 'UDF-0000029'
          AND DOCUMENT_ID = PART.ID
    )
"
13085,44857,MySQL statement to get min value with max ID,"select * from table where id in (
SELECT max(id)
FROM table as a
where a.price = (select min(price) from table as b where a.type=b.type)
group by type
) as t
"
16322,32109,How can I list the columns in INFORMATION_SCHEMA.COLUMNS?,"SELECT column_name, data_type 
FROM INFORMATION_SCHEMA.COLUMNS 
where table_name = 'columns'
  and table_schema = 'information_schema';
"
6442,40160,Find all nodes within a subtree that has 0 or 1 children,"SELECT t1.*, t2.numchildren
FROM user_tree t1
LEFT JOIN ( SELECT parent_id, COUNT(*) AS numchildren
            FROM user_tree
            GROUP BY parent_id ) t2
ON t1.id = t2.parent_id
WHERE t2.numchildren IS NULL
OR t2.numchildren = 1;
"
27387,67604,Merge Statement for more than hundreds of columns,"SELECT
    col.name
    , N'    OR NOT(a.' + QUOTENAME(col.name) + N' = b.' + QUOTENAME(col.name) + N' OR (a.' + QUOTENAME(col.name) + N' IS NULL AND b.' + QUOTENAME(col.name) + N' IS NULL))'
FROM sys.columns col
JOIN sys.objects obj ON col.object_id = obj.object_id
JOIN sys.types tp ON col.user_type_id = tp.user_type_id
WHERE obj.name = 'TableNameHere' AND col.is_computed = 0
ORDER BY col.column_id
"
34409,12735,SQL: 2 Counts using joins?,"select count(distinct UnitId) as Units, count(*) as Pieces
from Piece
where Category = 'A'
"
13429,50656,sql How to achive this view table,"SELECT c1 as group1, SUM(c2) as group2, SUM(c4) as group3, SUM(c5) as group4
FROM table
WHERE c3 = ""yes""
GROUP BY c1
"
10541,48318,MySQL Query: Displaying counts for many groups with many records,"SELECT jurasdiction_id, quarter, COUNT(*) AS num
FROM inspections
GROUP BY jurasdiction_id, quarter
"
8526,27602,"sql sort by int, except for one int value which has a different order","    SELECT name, to_order
FROM Table1
ORDER BY
    (
     CASE
       WHEN to_order = 1 THEN 0
       WHEN to_order = 3 THEN 1
       ELSE 2
     END
    ),
    to_order
"
15294,75628,Data Difference Between Where Clause and AND Clause,"SELECT * 
FROM TABLE1 T1
LEFT OUTER JOIN TABLE2 T2 ON (T1.ID = T2.ID
                              AND T1.STATUS = 'A'
                              AND T2.STATUS = 'A')
INNER JOIN TABLE3 T3 ON (T2.ID = T3.ID)
WHERE T3.STATUS = 'A'
"
33596,65617,SQL query - find parent posts where no children posts exist,"select q.*
from tblQuestions q 
left outer join tblReplies r on q.queID = r.repQuestionID
where r.repQuestionID is null
"
4288,71574,Value in one field as lookup from same table,"select c.id, 
left(c.title, instrrev(c.title, ""/"")-1)  as parentValue
, p.id as parentID
from nodeIDs c
left join
nodeIDs p
on left(c.title, instrrev(c.title, ""/"")-1) = p.title
"
329,50706,Can I delete rows from 2 tables in one single SQL statement?,"DELETE reviews, reviews_description 
  FROM reviews r
  JOIN reviews_description rd
 WHERE reviews.reviews_id = reviews_description.reviews_id
   AND reviews.customers_id = 54183
"
3357,9186,SQL SUM column value once per one-to-many relationship ID,"select sum(numpayments), sum(amount), sum(totalpayments)
from (select p.paymentid, count(*) as numpayments, sum(orderamount) as amount,
             max(TotalPaymentAmount) as totalpayments
      from payment p
      group by p.paymentid
     ) p;
"
8236,28066,MySQL - how do I write this Query,"SELECT a.Actor_name, d.Director_name
FROM (
  (SELECT DISTINCT Actor_name from movie) a
  CROSS JOIN
  (SELECT DISTINCT Director_name from movie) d
) WHERE NOT EXISTS (
  SELECT * FROM movie m
  WHERE m.Actor_name=a.Actor_name
    AND m.Director_name=d.Director_name
)
"
37530,40251,Excel-to-Excel data connection gives limited SQL options,"SELECT
[ID],
[Gift],
Now() AS [Refresh Date]
"
28433,11905,"Solr, multiple indexes","concat('product-',cast(ProductId as char)) as id,
'product' as type,
"
7198,23025,Select row based on identifier and value from another row,"select d.*
from dataset d
where d.value <> 'Y' and
      exists (select 1
              from dataset d2
              where d2.parent_id = d.parent_id and d2.value = 'Y'
             );
"
39589,43236,Query making sum in the next child level of hierarchy,"select p.idleader, sum(earningvalue) as earningvalue
from person p join
     earnings e
     on e.idperson = p.idperson
group by p.idleader;
"
25519,16354,Pseudo Code for a Merge Join (Left Outer Join) In SSIS,"Get first record from leftList
Get first record from rightList

While not at the end of either list
begin
    if leftList key matches right list key
    begin 
        return (leftList and rightList row)
        move to next rightList row
    end
    else if no previous match found on leftList
    begin
        return (leftList)
        move to next leftList row
    end
    else 
        move to next leftList row
end
"
14017,60047,Simple MySQL Query returning invalid result,"SELECT * FROM product
WHERE  name LIKE '%test%'  AND  
        price BETWEEN 160 AND 200
LIMIT 50
"
8531,41602,SQL Update from a Selection + Where condition on this Selection,"update t1
    set x = (select t2.x from table t2 where t2.y = t.y and t2.z = 2);
"
38369,2313,Sqlite: get Count and Max of children in second tables,"SELECT s._id, s.name, COUNT(i._id) count, MAX(i._id) max
FROM sector s
LEFT JOIN images i ON s._id = i.sector_id
GROUP BY s._id, s.name
"
13709,73137,left join of 3 tables according to one table,"SELECT Filters.filterId
FROM Filters
  Left JOIN FilterDoctors   On FilterDoctors.filterId = Filters.filterId 
  Left JOIN IncidentDoctors On IncidentDoctors.doctorId = FilterDoctors.DoctorId
  Left JOIN Appointments    On ( Appointments.doctorId = FilterDoctors.DoctorId 
                                 AND Appointment.RelatedIncidentId = IncidentDoctors.IncidentId)
WHERE ( IncidentDoctors.IncidentId = @IncidentId
        OR FilterDoctors.DoctorId IS NULL)
GROUP BY Filters.filterId;
"
10049,43243,How to filter out models with null properties in Yii2,"$query = Product::find() 
    ->with('translation', 'accessories')
    ->innerJoinWith('price')
    ->asArray()
    ->all();
"
23503,44327,Return distinct rows after averaging on group,"SELECT            YEAR(periodEndDate), AVG(TotTermLoans), companyName 
FROM              MyTable
GROUP BY          YEAR(periodEndDate), companyName
"
1101,19424,Cannot check for null values in sql database,"query {
    for h in dc.Table do
    where h.SectorId.HasValue
    select h
}
"
12246,47064,Mysql EAV match row as field or entity's property value,"SELECT 
    o.create_date,
    o.title,
    o.author,
    op1.value AS start_date,
    op2.value AS end_date,
    ...
FROM object o
LEFT JOIN object_properties op1 ON op1.object_id=o.object_id AND op1.type_id=1
LEFT JOIN object_properties op2 ON op2.object_id=o.object_id AND op2.type_id=2
"
27111,64598,Comparing two variables in SQL,"DECLARE @A INT = 1,
        @B INT = NULL;

IF (@B != @A or @B is  null )
    SELECT 1;
ELSE IF (@B = @A)
    SELECT 2;
ELSE
    SELECT 3;
"
28689,19853,SQL Case Query Optimization,"(case when exists (select 1
                   from transaction_lines tl
                   where tl.item_id_0 = 'msa500' and
                         tl.transaction_id = transactions.transaction_id
                  )
      then 'Yes'
      else 'No'
 end) as ContainsMSA500 
"
6884,58901,"SQL group by, how to define which record for each group, eg. the latest, is used","select * 
  from tablename a
 where a.updated = (select max(updated) 
                      from tablename b
                     where a.product_identifier = b.product_identifier)
"
38999,23858,Multiple of same result even with group by,"SELECT pc.product_code,
       COUNT(*) as count,
       sum(o.monthly_base_charge) as ""Monthly Fee""
FROM orders o join
     product_catalog pc
     on pc.product_catalog_id = o.product_catalog_id
GROUP BY pc.product_code
ORDER BY count DESC;
"
18801,68852,select query with where condition in oracle 10g giving ORA-00933: SQL command not properly ended,"SELECT * from  (Select M.*, Rownum R From IMDB1_FINANCE_ACTUAL M) where  r > 0 and r <= 10 AND ONSITE_MANAGER=q'!'bikram'!'
"
34511,75150,PostgreSQL calculate threshold query,"UPDATE t1
SET threshold = sub.thr
FROM (
  SELECT id, 100. * (rank() OVER (ORDER BY value) - 1) / count(*) OVER () AS thr
  FROM t1) sub
WHERE t1.id = sub.id;
"
17112,63512,How to resolve this MySQL query?,"SELECT * from mainlist m
LEFT JOIN mainlist mu 
ON mu.pTime = ( SELECT md.pTime FROM mainlist md 
            WHERE m.pTime < md.pTime
            AND m.STD < md.STD
            AND m.STD_positive <> md.STD_positive
            ORDER BY md.pTime
            LIMIT 1 ) 
"
13221,23893,How to delete the top 1000 rows from a table using Sql Server 2008?,";WITH CTE AS
(
SELECT TOP 1000 *
FROM [mytab]
ORDER BY a1
)
DELETE FROM CTE
"
654,72870,Update table with data from a second table,"UPDATE table1 t
JOIN table2 t2 ON t.ID = t2.ID
SET t.title = t2.value
WHERE t2.attribute='title';
"
14752,58628,Substring from string oracle,"with t(d) as (
  select 'A-20-1-1' from dual union all
  select 'A-10-10-4' from dual union all
  select 'A-10-11-1' from dual 
)
select REPLACE(SUBSTR(d, INSTR(d, '-', 1, 2) + 1), SUBSTR(d, INSTR(d, '-', 1, 3))) from t

RES
---
  1
 10
 11
"
371,64069,How to remove duplicate rows with CTE when partitioning by another table's column?,"WITH cte AS (
    SELECT i.Id,
           ROW_NUMBER() OVER (PARTITION BY GroupId ORDER BY Created) AS Rnk
    FROM   @Item AS i
           JOIN @ItemType AS it ON i.ItemTypeId = it.Id
)
DELETE FROM @Item
WHERE Id IN (SELECT Id FROM cte WHERE Rnk > 1);
"
18622,15489,Check for existence of an XML Schema Collection?,"IF EXISTS (SELECT * FROM sys.xml_schema_collections WHERE name = 'MySchema')
"
18256,291,How to delete single row using a trigger,"SELECT COUNT(*) FROM Deleted  
"
6745,70158,how to get columns have long spaces ( multiple spaces),"with src as (select 'a' as name,'yes' as description from dual
union all 
select 'b','       ' from dual
union all
select 'c',' ' from dual
union all
select 'd',null from dual)
select * from src where regexp_like(description,'^[ ]+$'))
"
30986,60123,sql query returns 0 if parameter is null (Open Office base),"SELECT ""IDpupil"", 
       ""name"", 
       ""class"" 
  FROM ""pupils"" 
"
25126,781,What is the best way to handle multiple permission types?,"""[Flags]public enum Permission{    VIEWUSERS = 1, // 2^0 // 0000 0001    EDITUSERS = 2, // 2^1 // 0000 0010    VIEWPRODUCTS = 4, // 2^2 // 0000 0100    EDITPRODUCTS = 8, // 2^3 // 0000 1000    VIEWCLIENTS = 16, // 2^4 // 0001 0000    EDITCLIENTS = 32, // 2^5 // 0010 0000    DELETECLIENTS = 64, // 2^6 // 0100 0000}"""
15013,60106,"MySQL Self referencing table, display hierarchy in one row with combined fields","Name:    GetAllTitles
Input:   InputID

Steps:   `While ID <> null
{
    select TABLE_A_ID,title from table where ID='InputID';
    If TABLE_A_ID is not null then,
    {
        // Save title to temp
        // Save TABLE_A_ID to InputID
        return CONCAT(temp,GetAllTitles(InputID));
    }
    else {  return emptystring;
    }
}`
"
27888,54752,Three way join in sql,"  SELECT GUEST_ADDRESS.ADDRESS_CODE,(GUEST_FNAME+' '+GUEST_LNAME) AS GUEST_NAMES
  FROM GUEST 
  JOIN GUEST_ADDRESS ON GUEST.ADDRESS_NUM = GUEST_ADDRESS.ADDRESS_NUM
  JOIN ACTUAL_ADDRESS ON GUEST_ADDRESS.ADDRESS_CODE = ACTUAL_ADDRESS.ADDRESS_CODE
"
20187,27629,How do I need to change my sql to get what I want in this case?,"select * from (
    select t2.id2, t1.date, t2.data, 
        row_number() over (partition by t2.data order by t1.date desc) rn
    from table1 t1
    join table2 t2 on t1.id = t2.id2
) t where rn = 1
"
6148,44012,SQL Server Management Studio: The multi-part identifier could not be bound,"select FirstName +' '+ LastName as FullName 
from EMPLOYEE
INNER JOIN PROJECT
on EmployeeID = PROJECT.Manager
group by FirstName +' '+ LastName
Having count(PROJECT.Manager) >= 2
"
39792,59736,MySQL Join multiple tables on common column with no order of importance,"SELECT DISTINCT email FROM table_a
UNION SELECT DISTINCT email FROM table_b
UNION SELECT DISTINCT email FROM table_c
...
"
35767,4044,Select particular result randomly from a table for a certain partition,"select i.*
from info i
where type = 'B'
union all
select i.*
from info i
where not exists (select 1 from info i2 where i2.name = i.name and i2.type = 'B');
"
14536,36284,Aggregate SQL query grouping by month,"SELECT YEAR(TransactionDate), MONTH(TransactionDate), SUM(Usage)
FROM YourTable
WHERE (TransactionDate Between [Some Start Date] AND[Some End Date])
GROUP BY YEAR(TransactionDate), MONTH(TransactionDate)
ORDER BY YEAR(Created), MONTH(Created)
"
36580,29033,Combining DateSerial with >= & <,"    dbo_agreements_1.end_date >= DateSerial(Year(Date()), Month(Date()) -1, 1)
AND dbo_agreements_1.end_date < DateSerial(Year(Date()), Month(Date()), 1)
"
33221,23883,SQLite: Calculate col based on the result of other Calculated Col,"SELECT a, a+1 AS b, (a+1)*2 AS c FROM test
"
12785,51501,Maximize Database View With Multiple Or Statement,"SELECT ut.USER_NAME, familyInfo.FAMILY_NAME
FROM USER_TABLE ut
LEFT OUTER JOIN
(
    SELECT
    (
        UPPER(ft.FATHER_USER_NAME) || ',' || 
        UPPER(ft.MOTHER_USER_NAME) || ',' || 
        ... (etc)
    ) AS MEMBERS,
    ft.*
    FROM FAMILY_TABLE ft
) familtyInfo
ON familyInfo.MEMBERS LIKE ('%' || UPPER(ut.USER_NAME) || '%');
"
12669,15381,A function calculating average age in years in SQL [postgresql]," SELECT AVG(AGE(dateofbirth)) 
   FROM person 
"
11167,13579,How to do one where BEFORE multiple inserts in SQL Server,"INSERT INTO mytable 
(id, age, name)
SELECT * FROM
(
    SELECT 1 AS id, 33 AS age, 'john' AS name
    UNION ALL
    SELECT 2, 28, 'james'
    UNION ALL
    SELECT 3, 20, 'Harry' 
) T1
WHERE NOT EXISTS (SELECT 1 FROM mytable WHERE age IN (22, 28, 30))
"
35837,17193,How do I set the window title for a SQL*Plus (Windows) instance?,"[DllImport(""user32.dll"", SetLastError =true, CharSet =CharSet.Auto)]
static extern IntPtr SetWindowText(IntPtr hwnd, String lpString);

Process process = new Process();
process.StartInfo.FileName = ""sqlplusw"";
process.Start();
process.WaitForInputIdle();
SetWindowText(process.MainWindowHandle, ""PRODUCTION - BE CAREFUL!!"");
"
3579,74754,Using DateDiff() in Oracle,"CREATE OR REPLACE FUNCTION dateDiff( p_dt1 IN DATE,
                                     p_dt2 IN DATE )
  RETURN NUMBER
IS
BEGIN
  RETURN p_dt1 - p_dt2;
END;
"
26996,41411,Join two tables without subquery,"SELECT A.idContactOwner, B.whatEverFields, count(A.idContactOwner) AS counter
FROM contacts A, customers B
WHERE A.idContactOwner=B.id 
GROUP BY A.idContactOwner 
HAVING counter>5;
"
24913,32698,Oracle - comparing default value of a column,"BEGIN
FOR rec IN (SELECT T.TABLE_NAME,CL.COLUMN_NAME,CL.DATA_DEFAULT
    FROM   SYS.USER_TABLES T
               JOIN SYS.USER_TAB_COLUMNS CL ON T.TABLE_NAME = CL.TABLE_NAME
   ORDER  BY t.table_name) LOOP

  IF rec.DATA_DEFAULT = 'null' THEN
    dbms_output.put_line(rec.table_name || ' ' || rec.COLUMN_NAME);
  END IF;
END LOOP;
END;
"
17244,36142,MySQL : sum of every day,"SELECT    DATE(datetime) as DATE, SUM(`count`) totalCOunt
FROM      tableName
GROUP BY  DATE(datetime)
"
24822,42510,MySQL Remove part of string after specific charater,"UPDATE MAPPINGS
    SET MAIN = SUBSTRING_INDEX(MAIN, '>', 1)
    WHERE MAIN LIKE '%>%' AND USERID = '1578';
"
23442,71456,Loading a CSV file with inconsistent spaces after commas,"LOAD DATA INFILE 'file.csv'
INTO TABLE t1 (column1, @col2, @col3, @col4)
SET
  column2 = TRIM(@col2),
  column3 = TRIM(@col3),
  column4 = TRIM(@col4)
"
17158,26691,Select all Users related to Company,"select Department.manager as user_id, Company.id
from Company
join Department on Department.company=Company.id

union

select Company.owner as user_id, Company.id
from Company
"
10956,56024,"Using ""IN"" operator in a dynamic query","Declare @ContactId VarChar(8000) 

Select @ContactId = '1,2,3'
Select *  
From Person.Contact 
where ',' + @contactID + ',' like '%,'+convert(varchar(50),contactid)+',%'
"
35625,44705,Grouping 'like' rows in SQL and summing?,"SELECT MemberSep, Location, Consumer, SUM(TODKWH001), SUM(TODKWH002)
FROM yourtable
GROUP BY MemberSep, Location, Consumer
"
5423,53112,In MySQL: How to pass a table name as stored procedure and/or function argument?,"CREATE  PROCEDURE `test1`(IN tab_name VARCHAR(40) )
BEGIN
 SET @t1 =CONCAT('SELECT * FROM ',tab_name );
 PREPARE stmt3 FROM @t1;
 EXECUTE stmt3;
 DEALLOCATE PREPARE stmt3;
END $$
"
33742,34437,SQL - Unable to correctly calculate a SUM,"select sum(oi.quantity), sum(o.total) as total, 
       o.employee_id as empl 
from orders o join
     (select oi.order_id, sum(oi.quantity) as quantity 
      from order_items oi
      group by oi.order_id
     ) oi
     on oi.order_id = o.id 
group by o.employee_id;
"
7575,63249,check the consultant_id of the current application user - ORACLE,"SELECT consultant_id
FROM lds_consultant
WHERE cst_name LIKE :app_user || ' %'
"
14006,46156,Pass a condition in a sql query,"SELECT COALESCE(e.field1, 'plop1') AS field1 FROM table e
"
12714,25743,UPDATE table with information from 2 other tables,"UPDATE (PB 
INNER JOIN Noeuds ON PB.NOEUD = Noeuds.NOEUD) 
INNER JOIN ColInfo ON Noeuds.NUM_COL = ColInfo.NUM_COL 
SET PB.FORFAIT = ""E""
WHERE (((ColInfo.INTEREXTER)=2));
"
14853,53056,How to join my tables?,"select e.id as employeeid,
       d.id as documentid,
       de.state as state     
from employee e
--this could be an inner join but your example is confusing
left join document d on e.id = d.id 
left join docemp de on e.id = de.empid 
                   and d.id = de.docid;
"
6731,9089,combining multiple columns in two tables,"SELECT t1.id, t21.name, t22.name, t23.name
FROM T1 
    INNER JOIN T2 t21 ON t21.id = T1.referencePerson1ID
    INNER JOIN T2 t22 ON t22.id = T1.referencePerson2ID
    INNER JOIN T2 t23 ON t23.id = T1.referencePerson3ID
WHERE T1.id = 1
"
12876,74098,Select query and unknow predicate value,"SELECT * FROM resources AS r WHERE r.type =
(SELECT type FROM resources s  where s.culture= 'sk' and s.key= 'test')
"
16758,67238,SQL aggregate functions,"HAVING (Sum(s.quantity*s.price)) > @X
"
10720,28783,Data URI vs. Binary in Database,"ImageResult: 2 requests, 200ms, 3.2KB
DATA URI: 2 requests, 200ms, 3.9KB
"
25936,4944,return a string of comma delimited numbers from a sql query,"SELECT  ID
       ,STUFF((SELECT ', ' + CAST(data AS VARCHAR(10)) [text()]
         FROM B 
         WHERE TableBId = A.ID
         FOR XML PATH(''), TYPE)
        .value('.','NVARCHAR(MAX)'),1,2,' ') Comma_Output
FROM A
GROUP BY ID 
"
31222,39396,PLSQL CLOBS into variables,"DECLARE
  clob_rec CLOB;
  n_rec NUMBER:=100;
  x XMLType;
BEGIN
  SELECT LOB INTO clob_rec FROM table1 WHERE ID = 1234;
  x := XMLType(clob_rec);
  n_rec := x.EXTRACT('//XPTO/text()', 'xmlns:XPTO').getNumVal();
END;
"
31185,67890,What is the difference between SERVERPROPERTY('MACHINENAME') and HOST_NAME(),"SELECT SERVERPROPERTY('ComputerNamePhysicalNetBIOS');
"
38431,46992,Compare strings by matching words,"select count(*) from
(
(select distinct unnest(string_to_array(upper('the quick brown fox jumps over the lazy dog'),' ')))
intersect all
(select distinct unnest(string_to_array(upper('the pen lies over the table'),' ')))
) t3
"
8967,22637,COUNT with DISTINCT,"SELECT  shippingid,
        COUNT(*) Items,
        ShipDate 
FROM mytable
WHERE customerID = 'C1'
GROUP BY shippingid,
         ShipDate 
"
3773,11393,Oracle SQL Statement Order By,"select INDEX_NAME, COLUMN_NAME, COLUMN_POSITION
FROM (SELECT INDEX_NAME, COLUMN_NAME, COLUMN_POSITION,
             count(*) over (partition by INDEX_NAME) as cnt
      FROM ALL_IND_COLUMNS
      WHERE TABLE_OWNER = 'ABC'
     ) t
order by cnt, INDEX_NAME
"
34314,68783,how to use distinct in join when i have null value,"SELECT data.*
FROM
    (
      SELECT 
           sc.*,df.Name,foods.FoodName ,ROW_NUMBER() OVER(PARTITION BY foods.foodID ORDER BY sc.ScheduleID) as rn
      FROM R_Schedule as sc
       left join R_DaysOfWeek as df on sc.DayId=df.DayId
       join R_Foods as foods on sc.FoodId=foods.FoodId 
      where  sc.dayId=6  
    ) AS data
WHERE
  data.rn = 1
"
1538,2743,Display column values only once,"SELECT ID
       ,CASE WHEN ROW_NUMBER() OVER(PARTITION BY ID ORDER BY ID) = 1  
            THEN Amount
            ELSE 0.00
        END [AMOUNT]
FROM TABLE
Order by ID, Amount Desc
"
31233,63057,Which DB am i connected to currently?,"select sys_context
       ( 'userenv'
       , 'instance_name'
       )
from   dual
"
27817,27762,SQL Update to flip sign of a value?,"update my_table
  set amount = -amount
  where <whatever>
"
29862,64963,"I have a users table and amount table, I would like to show all users with amount even when the amount is null or zero","SELECT u.Id,u.FirstName,u.LastName,u.Email,SUM(a.Amount) Amount 
FROM   users u LEFT JOIN amount a ON i.ID = a.ID
       AND a.ExpenseDate >= '2013-05-12' 
GROUP  BY u.Id
"
34530,58504,Joining with wildcard not matching strings,"INNER JOIN drugPrices dp ON
    (ddh.drugName LIKE '%' + dp.drugName + '%'
  OR ddh.drugName LIKE '%' + dp.drugBrandName + '%')
"
10290,14401,SQL group: count multiple things,"SELECT count(*) as `amount`
     , count(hour(date)) as `Hour`
     , count(day(date)) as `Day_Count`
FROM table 
GROUP BY hour(Date), day(date)
"
6898,15695,SQL Server Relation table parent->child and cycle cascade,"CREATE TRIGGER dbo.Person_Delete
ON dbo.Person
FOR DELETE
AS
  DELETE dbo.Person_Relation 
  WHERE Id_person_parent IN (SELECT Id FROM deleted)
    OR Id_person_child IN (SELECT Id FROM deleted);
"
38458,53264,SQL output from dynamic SQL,"IF EXISTS ( SELECT 1 FROM MyTable 
            WHERE TableName = @TableName 
            AND TheKey = convert(varchar(50), @LoadGuid))
BEGIN
    -- Your logic here
END
"
19527,75002,How to get records from SQL,"SELECT      A.No, 
            SUM(A.Value) AS [IN], 
            SUM(ISNULL(B.Value, 0)) AS [OUT]
FROM        dbo.A A 
LEFT JOIN   dbo.B B ON A.No = B.No AND B.Flag = N'1'
WHERE       A.Flag = N'1'
GROUP BY    A.No
"
14800,32357,MS SQL - CASE vs IF performance,"if @Classification < 5
    if @Classification < 3
        if @Classification = 1
        else . . .
    else if @Classification = 3 . . .
    else . . .
else . . .
"
3126,49,T-SQL List Dump Devices,"SELECT * FROM sys.backup_devices
"
32557,68532,update column based on 2 keys sql server,"UPDATE  t
SET     t.id = other.id
FROM    Traget t
JOIN    (SELECT r.code, m.id
      FROM Master m
      INNER JOIN Reference r ON m.From = r.From AND m.To = r.To
      ) other
ON      t.Code = other.Code
"
16390,9971,MYSQL show all rows where no duplicates found,"select t.col1, t.col2
from table t
group by t.col1, t.col2
having count(*) = 1;
"
13959,21799,AVG COUNT Query,"select H.Country, count(W.ic) / count(distinct H.hid) as [Average]
from Hospital as H
    left outer join Work as W on W.Hid = H.Hid
group by H.Country
"
34694,33966,Case insensitive in SQLite,"SELECT id,name 
FROM trait 
WHERE UPPER(name) IN (""RATIO"")
"
32833,34388,check if two articles have a common tag in between,"SELECT 1 FROM your_table a
INNER JOIN your_table b ON a.tag = b.tag
WHERE a.article = 1 AND b.article = 2
"
36609,62181,Return Single Value From Subquery nested inside a case statment,"SELECT TeacherID, StartTime, EndTime,
       (Case TeacherScheduleArchice.TeacherStudent_ServiceTypeID
            When 0 THEN ''
            Else (SELECT Top(1) DistrictName
                  From Districts
                  Where District.TeacherStudent_ServiceTypeID =  TeacherScheduleArchice.TeacherStudent_ServiceTypeID
                 )
       END) As District
FROM  TeacherScheduleArchive;
"
33629,39320,MySQL - How Do I Count Nulls and Not Nulls?,"SELECT prod_code,
       COUNT(email) AS total_installs,
       COUNT(install_slot) AS used_installs
FROM installs
WHERE email='example@example.com'
GROUP BY prod_code
"
28375,70260,Create new table with number of incidents per month,"SELECT EXTRACT(month FROM dateofcall) AS x,
       COUNT(*) AS incidents    
FROM
   incidents
GROUP BY
    EXTRACT(month FROM dateofcall)
ORDER BY
    EXTRACT(month FROM dateofcall)
"
36930,13917,SQL query to select rows where the year is between two dates,"SELECT * FROM Articleprice
WHERE '2007-12-31' >= from_Date AND to_date > '2007-01-01'
"
14860,47399,SQL match on letter and number arrangement without using regular expressions,"SELECT myCol 
FROM myTable 
WHERE SUBSTRING(myCol, 1 , 1) >= 'A' 
AND SUBSTRING(myCol, 1 , 1) <= 'Z' 
AND SUBSTRING(myCol, 2 , 1) >= 'A' 
AND SUBSTRING(myCol, 2 , 1) <= 'Z' 
AND SUBSTRING(myCol, 3 , 1) >= '0' 
AND SUBSTRING(myCol, 3 , 1) <= '9'
"
39210,34797,SQL to retrieve thickness values with small variance,"select * 
from table t1
join table t2 on t1.substid < t2.substid
join table t3 on t2.substid < t3.substid
where abs(t1.thickness - t2.thickness) <= 3 and
      abs(t1.thickness - t3.thickness) <= 3 and
      abs(t2.thickness - t3.thickness) <= 3
"
28361,32929,MySQL - Is it possible to get all sub-items in a hierarchy?,"SELECT j.*
FROM tablename o
JOIN tablename j
WHERE j.path LIKE CONCAT (o.path,'/%')
AND  j.id != o.id  -- skip parent asked for.
WHERE o.id = <the id of the node you're looking for>;
"
680,25272,Show MAX value with a join,"SELECT p.playername, s1.totalscore , s1.car, s1.track
FROM player p
INNER JOIN 
score s1 on p.id = s1.player_id
WHERE s1.totalscore = ( SELECT MAX(totalscore) FROM score s2 WHERE s2.player_id=s1.player_id)
ORDER BY s1.totalscore DESC
LIMIT 10
"
26569,56043,Calculating percentage participation across columns,";with infoCte as (
select pid, hid, count(*) as visitcount
from visits
group by pid, hid
) 

select * 
from infocte i
where visitcount > (
    select count(*) / 2 as midcount
        from visits v
        where v.pid = i.pid
) 
"
27826,59575,Please help me understand why MySQL call is invalid,"SELECT 
  a.name, 
  a.value 
FROM Table_A a 
  LEFT OUTER JOIN Table_B b ON a.ID = b.ID AND b.state = 'NC'
WHERE b.ID is null 
"
1775,9769,Need help please with a mysql query,"Select asgn.user_id, asgn.ticket_id, answ.answer
from
Assigned asgn
inner join
Answers answ
on asgn.user_id = answ.id_per
and asgn.ticket_id = answ.id_ticket
and upper(answer) like '%YES%'
"
22128,540,Sql query to find Id tagged to multiple rows,"Select studentId 
from student  
where subject_Id in ('1', '3', '4')
group by studentId 
having count(distinct subject_Id) = 3
"
30812,17616,Combine multiple rows (of one column) from mysql request into one field,"select group_concat(col1intermediate) as col1total
from
  (select group_concat(col1) as col1intermediate
  from table1
  group by col3, col2
  having count(*)>1) as alias_subquery
"
35501,61836,How can I get multiple averages from multiple rows using Mysql,"SELECT ROUND(AVG(overallRating), 0), count(*) as Total, gameID
FROM gameSurvey
GROUP BY gameID
"
26121,53663,How to create a multidimensional array,"DECLARE

TYPE table1 IS TABLE OF NUMBER 
  INDEX BY PLS_INTEGER;

TYPE table2 IS TABLE OF table1
  INDEX BY PLS_INTEGER;
var_i table2

BEGIN

var_i (1) (1) := 1;
var_i (1) (2) := 12;

END;
"
1629,26854,COALESCE db2 date,"SELECT 
     type
    ,DATE(TIMESTAMP_FORMAT(datefield1,'YYYYDDD')) AS DateEntered
    ,DATE(COALESCE(TIMESTAMP_FORMAT(datefield2,'YYYYDDD'),'0001-01-01')) AS Renewed
FROM MYDATA
WHERE DATE(TIMESTAMP_FORMAT(COALESCE(datefield1, rendt7),'YYYYDDD'))
    BETWEEN @date1 AND @date2
"
29501,63198,Numeric result blank for T-SQL union,"SELECT product, price
FROM tableA

UNION ALL

SELECT '', SUM(price)
FROM tableB

UNION ALL

SELECT 'space', NULL
FROM tableC
"
33842,1734,Counting Subqueries,"select
    ThisTable.id,
    title,
    price,
    other_count
from
(
    select
        id,
        count(*) as other_count
    from OtherTable
    group by id
) OtherTableCount
    inner join ThisTable
        on ThisTable.id = OtherTable.id
"
1675,6133,"Sort comments by upvotes-downvotes, make sure ones without votes are displayed above negative","SELECT c_id, c_text, c_date, c_parentid, u_username,
       coalesce((select sum(cv.cv_type = '1') from comment_votes cv where cv.cv_commentid= c.c_id ), 0) as upvotes,
       coalesce((select sum(cv.cv_type = '0') from comment_votes cv where cv.cv_commentid = c.c_id ), 0) as downvotes
FROM comments c INNER JOIN
     users u
     ON u.u_id = c.c_userid
WHERE c.c_postid = ? AND c.c_parentid = 0
ORDER BY upvotes - downvotes DESC
LIMIT 100;
"
21208,72974,SQL - Add Data to Existing Data From Another Table,"UPDATE tt
SET Bonus = coalesce(
        (select SUM(Points) as Points
        from bonus b
        where b.AgtID = tt.AgtID
        and ContestID = 21
        group by AgtID),0)
FROM @table tt;
"
969,42157,"MySQL Query with left join, group by and order by extremely slow","SELECT p.id, p.page_title AS name,
       v.bounce, v.goal,v.volume
FROM pages p LEFT JOIN
     (SELECT page_id, sum(v.bounce) as bounce, sum(v.goal) as goal,
             count(*) as volumn
      FROM visitors v
      GROUP BY page_id
     ) v
     ON pages.id = v.page_id
ORDER BY volume DESC;
"
4173,23240,Working with IF/ELSE and inserting into temp tables,"DECLARE @contentID int, @contenttype varchar
SET @contentid = 28861
SET @contenttype = 'resource'
SELECT @contenttype 
"
26338,32788,How to make a nested query?,"SELECT  u.*,
        (
        SELECT  COUNT(*)
        FROM    users ui
        WHERE   ui.invited_by_id = u.id
        ) AS cnt
FROM    users u    
"
6545,17432,"MySQL - display rows of names and addresses grouped by name, where name occures more than once","SELECT t.name_id,
       t.last_name,
       a.street_address
  FROM NAME t
  JOIN ADDRESS a ON a.name_id = t.name_id
  JOIN (SELECT n.last_name
          FROM NAME n
      GROUP BY n.last_name
        HAVING COUNT(*) > 1) nn ON nn.last_name = t.last_name
"
15624,50229,Select rows which appear more than given number of times in table,"SELECT t.*
FROM   t
JOIN   (SELECT   name, surname, COUNT(*)
        FROM     t
        GROUP BY name, surname
        HAVING   COUNT(*) > 10) aggr ON t.name = aggr.name AND 
                                        t.surname = aggr.surname
"
5829,34610,How to find timeslot conflict in SQL query,"SELECT count(1) 
FROM t1 INNER JOIN
     t2
     ON CAST(t1.StartTime as TIME) < CAST(t2.EndTime as TIME) and
        CAST(t1.EndTime as TIME) > CAST(t2.StartTime as TIME);
"
36508,33365,Oracle SQL. Time between states,"select id,trunc(next_day - day) from 
(select id,day,lead(day) over (order by day) next_day
from date_test)
where id = '00';
"
32915,22663,What should I put in the Rails model definition for the index I just added to a MS SQL Server 2008R2 column?,"def up
  execute ""ALTER TABLE orders ADD UNIQUE ordering_date_ndx (ordering_date)""
end
"
8301,61421,How to find lowest count of rows for a value in SQL Server 2005,"SELECT TOP 1 UserName, COUNT(*) 
FROM myTable 
GROUP BY UserName 
ORDER BY COUNT(*) ASC
"
11169,65513,How to sort users in descendant order by the value of another table? ( rails ),"User.joins(:orders).group(""users.id"").order('count(orders.id) desc').all
"
32809,71147,MySql Query for getting field value as count,"    SELECT message_pairs.*, 
           count(all_messages.id) AS unread_msg_count 
      FROM all_messages 
           RIGHT JOIN message_pairs 
                ON message_pairs.id = all_messages.pair_id 
     WHERE is_read = 0 
    GROUP BY 
           message_pairs.*;
"
10261,19649,How to keep a rolling counter on unique dates in SQL? (ORACLE),"SELECT Customer, Date, Row_Number() Over (Partition By Customer Order By Date) RN
FROM YourTable
ORDER BY Customer, Date
"
34415,42160,Query to return 1 row of each duplicate,"SELECT DISTINCT Claim, Line, Doctor, Received, Paid
FROM tableName
"
2807,5753,How to do <Enter> in SQL?,"select text1 || E'\n' || text2
from A
join B u
using (id)
"
33442,40864,SQL - IF a value equals a certain number then the amount of rows should equal that certain number,"select T.Name from test12 T join master..spt_values M
on T.number>M.number
where type='p'
"
6650,27984,Issue with null value using select statement,"SELECT ID, DT, STAT 
FROM myTable 
WHERE ID = 542 and ISNULL(FLAG,'NULL') <> 'COMPLETE'
"
31549,31089,select multiple column from one table and insert into another as rows,"INSERT INTO email (userid,email_address)
SELECT id, email  FROM user
UNION SELECT id, email2  FROM user
UNION SELECT id, email3 FROM user
"
23075,61605,SQL Query to update data from 2 tables into another one,"UPDATE  table_a a
        INNER JOIN table_b b
            ON a.id = b.rel_id
        INNER JOIN table_c c
            ON a.id = c.rel_id
SET     a.date = b.date,
        a.valid = c.valid
"
4550,54822,How to Find the Last Week's Most Sold Books in SQL,"SELECT top 10 b.bookID, COUNT(b.bookID) 
FROM TbSoldBooks b  
GROUP BY b.bookID
Where SaleDate >= DateAdd(day, -7, getDate()) -- last week
Order by 2 desc

SELECT top 10 b.bookID, COUNT(b.bookID) 
FROM TbSoldBooks b  
GROUP BY b.bookID
Where SaleDate >= DateAdd(month, -1, getDate()) -- last month
Order by 2 desc
"
35938,73085,Make value of a parameter the column name without dynamic SQL,"DECLARE @input VARCHAR(10) = ' Person '; 

DECLARE @sql NVARCHAR(MAX) = '
SELECT count(*) AS  [@Input Open Data]    
FROM #Accounts a JOIN
     dbo.FileFeed t
     On t.ID = a.AccountID     
GROUP BY a.accountid';

SET @sql = REPLACE(@sql, '@Input', @Input);

exec sp_executesql @sql;
"
10242,74941,Retrieving records from design containing multiple hierarchy,"SELECT Types.ID, COALESCE(SubType1.Name, Type2.Name, Type3.Name) as Name,
  COALESCE(SubType2.Description, Type1.Description, Type2.Description) as Description,
  ...
FROM Types
  LEFT JOIN SubType1 ON (Types.ID = SubType1.ID)
  LEFT JOIN SubType2 ON (Types.ID = SubType2.ID)
  ... 
WHERE ...
ORDER BY Types.Insert_Date;
"
35354,46454,Is it possible to rewrite a NOT IN query to use indexes?,"Select A.*
From table a
left join table2 b 
 on a.table-column = b.table-column
WHERE b.table-column is null
"
13078,15172,Find duplicates in a one to many relationship in SQL,"SELECT words, count(*), group_concat(idtag) as tags
FROM (SELECT idTag, GROUP_CONCAT(idWord order by position ASC SEPARATOR ' ') AS words
      FROM tTagWord
      GROUP BY idTag
     ) t
GROUP BY words
HAVING count(*) > 1;
"
16346,2474,Left Join; Only if there is at least one matching record,"IF EXISTS(SELECT * FROM Table1 T1 INNER JOIN Table3 T3 ON T1.ID=T3.ID)
    SELECT *
    FROM Table1 AS t1
    INNER JOIN Table2 AS t2 ON t1.ID = t2.ID
    LEFT JOIN Table3 AS t3 ON t1.ID = t3.ID
    LEFT JOIN Table4 AS t4 ON t3.ID = t4.ID
ELSE  
    SELECT *
    FROM Table1 AS t1
    INNER JOIN Table2 AS t2 ON t1.ID = t2.ID
"
34460,56237,How to avoid the same calculations on column values over and over again in a select?,"WITH CTE AS
(
    SELECT
        a.col1+b.col2*c.col4 as calc_col1
    FROM ....
),
CTE2 AS (
    SELECT CTE.*
        ,calc_col1 + xxx as calc_col1_PLUS_MORE
    FROM CTE
)
SELECT ...
FROM CTE2 c
INNER JOIN ... d
    ON c.calc_col1 < d.some_threshold
WHERE c.calc_col1 > 0
"
32667,64715,sql query - how to count values in a row separately?,"SELECT SUM(CASE WHEN secondperson='' THEN 1 ELSE 2 END) FROM thetable;
"
2725,39805,"selecting rows with near identical data, apart from 1 field","select distinct col1, col2,
  Stuff((SELECT N', ' + col3 
         FROM yourtable t2
         where t1.col1 = t2.col1
         FOR XML PATH(''),TYPE)
        .value('text()[1]','nvarchar(max)'),1,2,N'')
from yourtable t1
"
2513,20753,SQL Server - Order by part of a result,"SELECT CONVERT(CHAR(8), DateAdd(minute, -601, DailyDate ), 10) as DailyDate  FROM
table  
ORDER BY SUBSTRING(CONVERT(CHAR(8), DateAdd(minute, -601, DailyDate ), 10), 7, 2), 
         SUBSTRING(CONVERT(CHAR(8), DateAdd(minute, -601, DailyDate ), 10), 4, 2)
"
28388,18395,Value of id corresponding to max value of another column,"select 
    staff_id as id,
    totalrentaltranscations
from a_table
order by 2 desc
limit 1;
"
5082,50397,Subtract values from a DropDownList,"SELECT 
  UserID,
  SUM(
    CASE
      WHEN [DATE] = @Date2 THEN Count
      ELSE -1*Count
    END
   ) AS Counter
FROM [CountTable]
WHERE (([Date] = @Date) OR ([Date] = @Date2))
GROUP BY UserID
"
10142,22675,How to copy table without primary key to another one,"INSERT INTO Data (time, serial_number...)
  SELECT (time, serial_number...) FROM Temp_data;
"
5674,10607,"POSGRESQL UPDATE ""insert"" infront of existing data","UPDATE table
SET column = 'my prepended text' || column
WHERE condition
"
14150,24844,how to export a varchar2 from oracledb containing special characters and process it from bash,"replace(
 replace(
  utl_raw.cast_to_varchar2(
   UTL_ENCODE.base64_encode(utl_raw.cast_to_raw(...))
  ), chr(10), ''
 ), chr(13), ''
)
"
27026,41121,How to detect MS Access database or SQL Server Compact Edition (MSSQL CE) by a query?,"select @@version
"
10156,57103,Nested select to LINQ,"var nestedquery= (from m in context.MoneyTable
                  where m.year >= 2014
                  group m by m.department into g
                  select g.Sum(e=>e.money)).ToList();

var result= new { minMon= nestedquery.Min(e=>e), maxMon=nestedquery.Max(e=>e)};
"
16908,73263,Merging multiple queries preferentially,"select distinct Word
from
(
  select Word, 1 as WordOrder from table1
  union
  select Word, 2 as WordOrder from table2
) X
order by WordOrder
"
29670,29087,SQL String Comparision Ignoring White Space,"WHERE REPLACE (column, ' ', '') LIKE 'SupervisionCharges'
"
6100,40690,MySQL subquery to count user results in another table is sloooooooow,"SELECT users.email, COUNT(r.result_id) as results
FROM users
INNER JOIN users_groups ON users_groups.user_id=users.id
INNER JOIN programmes_results r on ((r.client_id=users.client_id) AND (r.email=users.email))
WHERE users.client_id='130' AND users_groups.group_id IN (5)
group by users.email
ORDER BY users.email asc
LIMIT 10
"
36662,58293,How to implement capitalization in nHibernate?,"UPDATE T_Example  
    SET MT_Lang_DE = upper(substring(MT_Lang_DE, 1, 1)) + substring(lower(MT_Lang_DE), 2, length(MT_Lang_DE)-1)
"
38971,46073,mysql query optimization (using sum function ),"SET @tot := 0; 
SELECT  total_usage 
    FROM  
      ( SELECT  @usage := acctinputoctets + acctoutputoctets AS usage,
                @tot := @tot + @usage / 8388608 AS total_usage
            FROM  radacct
            WHERE username ='fktmbishals'
            ORDER BY  ?? 
      ) x
    HAVING  Total < 500; 
"
27951,59972,To retrieve data whose third character is '_' underscore?,"select name from t1 where SUBSTRING(name, 3 , 1) = '_'
"
6997,45923,Delete all ID's that don't have a specific value,"DELETE FROM yourtable
WHERE  house_id NOT IN(SELECT house_id
                       FROM   yourtable
                       WHERE  Pet = 'dog') 
"
23397,57877,Finding IDs that join with multiple alternate IDs matching criteria,"select c.client_name as ""Client"", m.meeting_id as ""Meeting ID"", m.meeting_date as ""Meeting Date"",
       count(distinct f.fee_id ) as ""Consultation Fees Charged""
from client c inner join
     meetings m
     on c.client_id = m.client_id inner join
     fees f
     on m.meeting_id = f.meeting_id
where f.fee_type = 'CONS'
group by c.client_name, m.meeting_id, m.meeting_date
having count(*) > 1;
"
38483,50611,Re-arrange columns after Unpivot ORACLE,"SELECT ID, CUSTOMER_ID, QUANTITY, P FROM
(SELECT *
FROM   unpivot_test
UNPIVOT (quantity FOR product_code IN (product_code_a AS 'A', product_code_b AS 'B',  
product_code_c AS 'C', product_code_d AS 'D')));
"
19703,17046,SQL update for the varchar column,"UPDATE {table}
SET AttachmentCopyLoc ='V' + substring(AttachmentCopyLoc,2,len(AttachmentCopyLoc )) 
where AttachmentCopyLoc like 'D%'
"
563,65751,Return Boolean Value on SQL Select Statement,"SELECT CASE WHEN EXISTS (
    SELECT *
    FROM [User]
    WHERE UserID = 20070022
)
THEN CAST(1 AS BIT)
ELSE CAST(0 AS BIT) END
"
3557,47192,T-SQL: Paging WITH TIES,"select *
from @temp
where [timestamp] in (select top 4 [timestamp] from @temp order by [TimeStamp])
"
4259,46834,Delete all records unless 1 or more sub record meet a criteria,"DELETE c FROM Cars c
WHERE NOT EXISTS
(
    SELECT 1 FROM Passengers p
    WHERE p.Name = 'Jim'
      AND p.CarID = c.ID
)
"
23972,70578,BASH List header of empty sqlite database,"sqlite3 your.db ""pragma table_info(your_table)""
"
4213,22783,"mySQL like, but not like","REPLACE(str , 'foo.com', ' ') like '%.com%'
"
5540,46067,SQL Select pattern like column_name,"SELECT column_name
FROM table_name 
WHERE instr('c:/tests/two/fail/results', column_name) > 0;
"
37996,14219,PLSQL Merge delete,"BEGIN

FOR r in (select a1,a2,b1,b2,b.rowid from a full outer join b on a.a1=b.b1)
loop

  if r.a1 is null 
  then 
     delete from b where rowid=r.rowid;
  end if;

  if r.b1 is null
  then 
     insert into b values (r.a1, r.a2);
  end if;

end loop;
END;
"
278,45505,How to create a query by using a substring of a field as argument?,"SELECT *
FROM TABLE
WHERE CAST(SUBSTRING(A.Zipcode, 1, 4) AS INT) BETWEEN 3000
        AND 3100
"
32771,674,Caching database data,"Rails.cache.write(:records, @records)
"
3208,54210,How to use conditional operator in sql,"select case
         when PhoneNum is null then -- MobileNum only
           MobileNum
         when MobileNum is null then -- PhoneNum only
           PhoneNum
         when (PhoneNum is not null) and (MobileNum is not null) then -- Both
           MobileNum || ',' || PhoneNum
         else -- Neither MobileNum no PhoneNum  
           'No Phone'
       end as ContactNumber      
  from dbo.BusinessDetails as Business
"
23201,25156,SQL Join - All stores where employee has NOT worked,"select *
from stores s
where ID not in (
    select StoreID
    from EmployeeStoreRelationshipTable
    where employeeId=[employeeID])
"
26738,46947,Using distinct in XMLAGG on duplicating records,"SQL> select XMLAGG(XMLELEMENT(E, cust_name || ',')).EXTRACT('//text()')
  2   from (SELECT distinct cust_name, cust_addr_type FROM cust_data)
  3  where cust_addr_type ='old_address';

XMLAGG(XMLELEMENT
-----------------
cust1,cust2,
"
19619,16733,SQL optional parameter?,"select t1.Id, t1.Name, t2.comment
from table1 t1
left join table2 t2 on t1.id=t2.Uid
"
3134,48922,MySQL show grouped results,"select stamp, 
       SUBSTR(`values`,1,INSTR(`values`,',')-1) as value1,
       NULLIF(TRIM(',' FROM SUBSTR(`values`,INSTR(`values`,',')+1)),'') as value2,
       `values`
FROM
(
SELECT stamp, `group`,CONCAT( GROUP_CONCAT(`value`) ,',') AS `values`
FROM stamps
GROUP BY stamp, `group`
) aggr
"
20301,24387,Is there a way to include duplicates from MySQL query: select..from..where..id in (list),"SELECT * FROM table
inner join (
   select 1 as sort, 2 as value union all
   select 2, 4 union all
   select 3, 6 union all
   select 4, 1 union all
   select 5, 1 union all
   select 6, 2) X on X.value=table.id
ORDER BY X.sort
"
24328,27712,I need help writing a complex SELECT statement,"SELECT
    id,
    name,
    (SELECT COUNT(*) FROM attendance att WHERE att.event = ev.id) AS attending
FROM
    event ev
ORDER BY
    attending DESC
"
12213,42012,Oracle SQL: Creating unique teamid from existing table,"select upper(substr(deptname,1,3)) || upper(substr(color,1,2)) 
|| rownum from dept;
"
33373,32050,MySQL query AND OR operator Logic,"$query=""
  SELECT cID 
  FROM conversation
  WHERE 
      /* to Jake, from Connor */
     (`to`='$to' AND `from`='$from')
      /* OR to connor, from jake */ 
     OR  (`to`='$from' AND `from`='$to')"";
"
2653,31488,Recurring Selection of rows based on value of the value in previous row,"SELECT id, name, mgrid
FROM emp
START WITH id = 101
CONNECT BY PRIOR mgrid = id
ORDER BY id
"
9323,46434,Count total when grouping by two columns,"SELECT [supplier], [client_name], COUNT(1) AS total
FROM data
GROUP BY [supplier], [client_name];
"
30931,70433,Update function in TSQL trigger,"IF EXISTS (
    SELECT
        *
    FROM
        INSERTED I
        JOIN
        DELETED D ON I.key = D.key
    WHERE
        D.valuecol <> I.valuecol --watch for NULLs!
    )
   blah
"
35619,31668,SQL query to add or subtract values based on another field,"SELECT SUM( CASE
               WHEN t.Sign = 'Pos' THEN t.Value
               ELSE t.Value * -1
            END
          ) AS Total
FROM YourTable AS t
"
6866,15801,How to use where clause in Query with LEFT JOIN?,"SELECT 
    pil.[Buy-from Vendor No_] 
  ,  pil.No_, pil.Amount
  , pil.Quantity 
FROM dbo.[UAB „Arvi cukrus“ 2011$Purch_ Inv_ Line] pil
LEFT JOIN dbo.[„blk“ 2011$Purch_ Inv_ Header] Pih ON pil.[Document No_]=pih.No_
WHERE pil.Type=5
ORDER BY pil.amount
"
33451,69804,SQL Total of addresses with null values in selected fields,"select sum(house_number)
from yourtable 
where house_name is null and po_box is null
"
4139,24761,How to Hide Tables from view if Value = 0,"SELECT MSG_TYPE_ID, COUNT(*)
FROM DB1 WITH (NOLOCK)
WHERE MSG_TYPE_ID IN ('0', '1', '2', '3', '5')
GROUP BY MSG_TYPE_ID;
"
1833,7881,Temporary table with two tables data with no column in common should return data in one column,"Select max(col1), max(col2), max(col3).... from #Test
group by col1,col2,col3....
"
7445,57477,need help with a simple SQL update statement,"UPDATE <table>
   SET not_string = TRIM( TO_CHAR( TO_NUMBER( not_string ), '999999999999' ) )
 WHERE TO_NUMBER( not_string ) = TRUNC( TO_NUMBER( not_string ) )
"
12107,10132,How to select all records from one table which are not already selected by user?,"select tt.trainingCode
from TotalTraining tt left join
     SelectedTraining st
     on tt.trainingCode = st.trainingCode and
        st.EmpCode = 7190 and
        st.appraisalId = 12
where st.trainingCode is null ;
"
39660,59672,Combine multiple observations in R,"# Read in your example data
df <- read.table(text=""user1, hashtag1, hashtag2 
user1, hashtag3, hashtag4 
user2, hashtag5, hashtag6 
user2, hashtag7, hashtag8"", sep="","", header=FALSE, stringsAsFactors=FALSE)


lapply(split(df[-1], df[1]), function(X) unname(unlist(X)))
# $user1
# [1] "" hashtag1""  "" hashtag3""  "" hashtag2 "" "" hashtag4 ""
# 
# $user2
# [1] "" hashtag5""  "" hashtag7""  "" hashtag6 "" "" hashtag8"" 
"
9825,23223,Rounding to the nearest all number in sql server 2008,"ROUND ( numeric_expression , length [ ,function ] )
SELECT ROUND(4.4, 0) -- Gives 4.0
SELECT ROUND(4.6, 0) -- Gives 5.0
SELECT ROUND(2.664543, 1)  -- Gives 2.70000
SELECT ROUND(4.2432, 1) -- Gives 4.2000

SELECT CAST(ROUND(4.2432, 1) as NUMERIC(36,2))  -- Gives 4.20
"
35544,32096,SQL Select Convention,"SELECT Id, Name
    FROM Table1
    JOIN Table2 
        ON Table2.FK1 = Table2.FK1
"
11565,31929,Spring Security Without Role-Base Using Database,"<security:http auto-config=""true"" use-expressions=""true"">
    <security:intercept-url pattern=""/login"" access=""permitAll"" />
    <security:intercept-url pattern=""/registration"" access=""permitAll"" />
    <security:intercept-url pattern=""/**"" access=""isAuthenticated()"" />
     ...
</security:http>
"
37622,38138,Oracle right join 3 tables but only has to match 1,"select p.id,
  p.name,
  a.price Price_A,
  b.price Price_B,
  c.price Price_C
from products p
left join pricea a
  on p.id = a.product_id
left join priceb b
  on p.id = b.product_id
left join pricec c
  on p.id = c.product_id
where a.price is not null
  or b.price is not null
  or c.price is not null
"
5552,23910,MYSQL: Vacant / occupied rooms as now,"select rct.room_category AS room_category,
       group_concat(rc.room_name separator ',') AS vacant_beds
from room_charges rc join
     room_category rct
     on rc.room_category = rct.id left join
     patient_detail pd
     on rc.id = pd.room_name and
        (pd. discharge_date_time is null or
         curdate() between admission_date_time and discharge_date_time)
where pd.id is null
group by rc.room_category ;
"
27966,3283,MySQL joined subqueries optimization,"SELECT asiento, fecha 
FROM 
( 
    SELECT id_diario, asiento, fecha, SUM(debe) AS debe, SUM(haber) AS haber 
    FROM apuntes 
    GROUP BY id_diario, asiento, fecha 
) sub0 
GROUP BY asiento, fecha 
HAVING MIN(debe) != MAX(debe) 
OR MIN(haber) != MAX(haber)
"
21868,23890,sql query select date equal rows from datetime,"select USERNAME from ACCESSACTIVITY where UPPER(LOCATION)=UPPER('remote-PC')and DATE(TIMESTAMP) = STR_TO_DATE('28-05-2016 ','%d-%m-%Y')
"
34198,11395,Why does updating only some rows delete the rest of the rows in the column?,"UPDATE t100 SET text = (SELECT text FROM t50 WHERE t50.id = t100.id)
WHERE t100.id IN (SELECT id FROM t50)
"
10280,38062,If subquery returns null value for a field update the field with default value,"UPDATE TABLE x SET field = IFNULL(SUBQUERY, default_value) WHERE ... 
"
12604,73167,how do i get the min timestamp value of the same Id number with its corresponding Value using sql,"SELECT EmployeeCode
    , Timestamp
    , Value
FROM (
    SELECT RANK() OVER (PARTITION BY EmployeeCode ORDER BY Timestamp) AS RN
        , EmployeeCode
        , Timestamp
        , Value
    FROM dbo.SampleTable
    ) AS ST
WHERE ST.RN = 1;
"
13905,63859,Converting date format 01-01-1990 to 01-jan-1990,"REPLACE(CONVERT(VARCHAR(15), pr.[Date], 106), ' ', '-')
"
15238,5058,Query the id and number of times hired for DVDs hired in a month,"select dvdID as 'unique number', count(*) as 'times hired' 
from MonthlyRental 
where month(dateHired) = 8 
group by dvdId
"
28609,45977,Optimizing MySQL query with nested select statements?,"Select
    an.uuid 
From
    alf_node an
        Inner Join
    alf_node_properties anp
        On an.id = anp.node_id 
        Inner Join
    alf_content_data acd 
        On anp.long_value = acd.id 
Where
    acd.content_url_id = $content_path_id
"
4031,36519,How can I make a predicate with this?,"[NSPredicate predicateWithFormat:
    @""language.languageCode == %@ OR
    (language.languageCode = 'en' AND NOT (question IN %@))"", languageCode, foundLanguages]
"
17607,15738,Order results by `OR` statements MySQL,"SELECT
FROM 
WHERE
ORDER BY FIELD(message, 'pineapple juice', 'pineapple', 'juice')
"
29054,26862,how to replace text using a query,"UPDATE YOUR_TABLE SET `text` = REPLACE(`text`, 'hello', 'hi')
"
34752,5619,Join table on XML column with multiple values,"select
    fgz_leveranciers.*,
    xmldata.i
from
    fgz_leveranciers
    left join
    (                
        Select x.t.value('.','int') i
        from fgz_merken
            cross apply lst_leveranciers.nodes('lst_leveranciers/lst_leveranciers/value') as x(t)
      ) xmldata
    on fgz_leveranciers.i = xmldata.i
"
24977,59873,SQL Server queries,"sql =""select * from account WHERE convert(varchar(50),siteid) like '%""+a+""%' or refrenceno like '%""+a+""%' or oldrefrenceno like '%""+a+""%' ""; 
"
38149,69875,"SQL database design for storing different types of ""Person""","Create table `person_role` (
id int not null,
roleName varchar(255) not null,
PRIMARY KEY(`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;

Create table `person`(
id int not null.
name varchar(255) not null,
lastName varchar(255) not null,
role int not null,
PRIMARY KEY(`id`),
CONSTRAINT FOREIGN KEY(`role`) REFERENCES person_role(`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;
"
1987,59142,Get previous / next record in sqlite,"SELECT DISTINCT name FROM items
WHERE something = 'foo'
AND name < (SELECT name FROM items WHERE name = ...)
ORDER BY name DESC
LIMIT 1
"
19260,30574,"SQL Server 2005, wide indexes, computed columns, and sargable queries","Alter Table Add NameHash Hashbytes('SHA1', [Name])
"
32302,39366,setting up unique constraint on referenced collumns in oracle 10g xe,"CREATE UNIQUE INDEX unqIndex
    ON CompetitionsLanguages(CompetitionsLanguages, CompetitionsLanguages);
"
13218,38683,MySQL: UPDATE table with COUNT from another table?,"UPDATE tbl1 SET num = (SELECT COUNT(*) FROM tbl2 WHERE id=tbl1.id)
"
16111,52327,Order by data depending on a specific value of column,"select T1.*
from Table1 as t1
    left outer join Table1 as T2 on T2.id = T1.id and T2.Pid = 2
order by T2.Name, T1.Pid
"
24886,65720,SQL Server Update Using Multiple Tables,"UPDATE A
SET A.A1 = 'TRUE' 
FROM Attendance A
INNER JOIN Student S
    ON A.StudentId = S.ID
INNER JOIN Module M
    ON A.ModuleId = M.ID
WHERE S.ID = '3a0070c48' 
AND M.[Day] = 'Friday' 
AND '1100' BETWEEN M.StartTime AND M.EndTime
"
28337,72737,What's the difference between these two methods to drop a database?,"IF EXISTS(
    select *
    from master.sys.databases
    where name = 'mydatabase')
DROP DATABASE mydatabase;
"
32381,33421,How to remove duplicates and get the greatest value,"select max(id),value From foo
group by value
order by max(id) desc
"
7284,37237,How do I make the rows of a lookup table into the columns of a query?,"SELECT s.student_id, s.name,
  SUM(i.name = 'a') AS interest_a,
  SUM(i.name = 'b') AS interest_b,
  SUM(i.name = 'c') AS interest_c
FROM students s
INNER JOIN interest_lookup l USING (student_id)
INNER JOIN interests i USING (interest_id)
GROUP BY s.student_id;
"
1014,60423,Excel function to make SQL-like queries on worksheet data?,"Sub DemoConnection()
    Dim c As Connections
    Dim wb As Workbook
    Dim i As Long
    Dim strSQL As String

    Set wb = ActiveWorkbook
    Set c = wb.Connections
    For i = 1 To c.Count
        ' Reresh the data
        c(i).Refresh 
        ' view the SQL query
        strSQL = c(i).ODBCConnection.CommandText
        MsgBox strSQL
    Next
End Sub
"
7153,426,SQL count many-to-many relations in common,"select pu.id_user, count(pux.id_page) as PagesInCommonWithX
from page_user pu left join
     page_user pux
     on pu.id_page = pux.id_page and
        pux.id_user = $x
group by pu.id_user;
"
3288,46477,SQL update that seems to require GROUP BY,"UPDATE mytable
INNER JOIN (
  select first, last, COUNT(pkey) > 1 Result
  FROM mytable
  LEFT JOIN worker ON first=worker_first_name AND last=worker_last_name
  GROUP BY first, last) OTHER
    on OTHER.first = mytable.first
   and OTHER.last = mytable.last
SET taint = OTHER.Result;
"
1401,27141,Find block number of a table in Oracle database,"select owner, segment_name, tablespace_name, file_id, block_id
from dba_extents
where segment_name = 'FND_USER';
"
35109,65495,Pattern matching in a column in Oracle SQL,"SELECT * FROM YourTable t
WHERE EXISTS(SELECT 1 FROM YourTable s
             WHERE replace(t.YourCol,' ','') = replace(s.YourCol,' ','')
              and t.YourCol <> s.YourCol)
"
14058,20077,MySQL group by with multiple column sums and a total sum for each group,"SELECT person, 
       sum(positive_vote) totalPositive, 
       sum(negative_vote) totalNegative,
       (sum(positive_vote) + sum(negative_vote)) totalVotes
FROM Votes 
GROUP BY person
-- HAVING (sum(positive_vote) + sum(negative_vote)) < 5
"
16362,26605,SQL conditional SELECT with possible NULL,"SELECT Name
    , Address
    , CASE WHEN REHIRE_DATE IS NULL THEN HIRE_DATE ELSE REHIRE_DATE END
FROM Employee
"
27871,15195,I do not want all the values in my table,"insert into TableB (SELECT * FROM TableA ORDER BY timestamp DESC LIMIT 100)
"
19154,56182,Sql automatically update,"UPDATE p
SET p.arenda = CASE WHEN p.PlotArea IS NULL THEN 'no' -- For not matched 
                    ELSE 'yes' -- for matched
               END
FROM nbProcuri p
LEFT JOIN Cadastrial c ON p.PlotArea = c.PlotArea
LEFT JOIN nbAchizitii a
      ON p.PlotArea = a.PlotArea and p.CtrNo = a.CtrNo
WHERE a.CtrNO IS NULL 
  AND a.PlotArea IS NULL;
"
37261,49293,How to access an index of a string in PL/SQL?,"DECLARE
  str VARCHAR2(20);
BEGIN
  str:='Test';

  FOR i IN 1..LENGTH(str) LOOP
    DBMS_OUTPUT.PUT_LINE('Character at index ' || i || ' is ' || SUBSTR(str, i, 1));
  END LOOP;
END;
"
1156,20942,Choose column based on max() of another column,",CAST((SELECT TOP 1 t2.create_date from acct_transaction t2 
            WHERE t2.case_sk = act.case_sk AND (t2.trans_type = 'F')
            order by t2.amount, t2.create_date DESC) AS date) AS 'max_date'
"
17100,34371,"What is the SQL syntax for joining two tables, comparing and updating?","UPDATE table1
SET table.column1 = table2.column2
FROM table1
inner join table2 ON table1.KEY = table2.KEY
           and table1.column4 = something 
           and table1.DATE between '10/12/14' and '10/15/14'
           and table1.column1 != table2.column2
"
14350,37947,Adding a column with values in query,"SELECT id
     , fruit
     , CASE fruit 
         WHEN 'Apple' THEN 'YES' 
         ELSE 'NO' 
       END AS MyFavorite
FROM   exampleTable
"
30212,74823,PostgreSQL search column for like strings,"select
  Col_2,
  count(*)
from 
  your_table
group by
  Col_2
having
  count(*) > 1
"
8239,48603,Get the space used by a table in Apache Derby,"select
    tableName,
    (select sum(numallocatedpages * pagesize) from new org.apache.derby.diag.SpaceTable('APP', t.tablename) x) as size
from SYS.SYSTABLES t
order by size desc
"
1851,49999,"PHP / MySQL question, more the latter","SELECT 
  CONCAT('Q', QUARTER(inv.duedate), ' ', YEAR(inv.duedate)) as quarter,
  SUM(inv.total) as total
FROM
  invoices inv
  LEFT JOIN clients cli ON inv.client_id = cli.id 
WHERE
  cli.country = 'CA'
GROUP BY
  quarter
"
37679,36903,How to write or append to text file using sql?,"exec master..xp_cmdshell 'echo pranay test application > d:\file.txt'
"
14651,39601,Creating insert statements with F#,"let loadStockPrices ticker =
  use client = new WebClient()
  let url = sprintf ""http://ichart.finance.yahoo.com/table.csv?s=%s&g=d&ignore=.csv"" ticker
  use stringReader = new StringReader(client.DownloadString(url))
  use csvReader = new CsvReader(stringReader, hasHeaders=true)
  use con = new SqlConnection(""<connection_string>"")
  con.Open()
  use bulkCopy = new SqlBulkCopy(con, DestinationTableName=""<destination_table>"")
  bulkCopy.WriteToServer(csvReader)
"
6806,9463,Is it possible to set mySQL to have a saturday as the start of the week?,"
date_sub(t.date, interval if(dayofweek(t.date)-$weekStartingDay >= 0, dayofweek(t.date)-$weekStartingDay, dayofweek(t.date)-$weekStartingDay+7) day) week_start

date_sub(t.date, interval if(dayofweek(t.date)-$weekStartingDay >= 0, dayofweek(t.date)-$weekStartingDay, dayofweek(t.date)-$weekStartingDay+7) - 6 day) week_end
"
2809,8169,Save Result of SQL Statement to Use Elsewhere,"select count(0)
from messages as m
join files as f on f.messageid=m.messageid
where m.datesent>'2014-07-01'
"
18707,27584,Insert multiple rows from select into another table,"insert into table1(col1, col2, col3)
    select 1, col2, 0
    from <your other query here>;
"
36539,42799,sql subquery statement with a join,"select s.*, c.area
from servicio s outer apply
     (select top 1 c.*
      from comments c
      where c.swo = s.swo
      order by c.date desc
     ) c;
"
35552,47689,SQL Server Bulk Insert,"* The data file contains greater or fewer columns than the table or view.

* The columns are in a different order.

* The column delimiters vary.

* There are other changes in the data format. Format files are usually created by using the bcp utility and modified with a text editor as needed. For more information, see bcp Utility.
"
34796,41471,How to query multiple tables with a single query,"users (userId, name)
movies (movieId, movieInfo)
recommendations (fromUserId, toUserId, movieId, comment)

SELECT fromUser.name, toUser.name, m.movieInfo, r.comment
FROM recommendations r
INNER JOIN movies m ON m.movieId = r.movieId
INNER JOIN users fromUser ON r.fromUserId = fromUser.userId
INNER JOIN users toUser ON r.toUserId = toUser.userId
WHERE r.toUserId = << my user id, or whatever your criteria are >>
"
30417,15419,How can I create table as select (CTAS) in oracle?,"CREATE TABLE au_books_zl
AS
  SELECT au_id,
         fname,
         lname,
         title_id,
         title,
         pub_id,
         price,
         price * sales as revenue
    FROM <<whatever tables you need to select from>>
   WHERE <<whatever conditions you need to apply>>
"
10558,61395,NULL to zero with ISNULL,"SELECT
  name,
  SUM(IFNULL(growth, 0))                         AS sum_buy_price,
  SUM(IFNULL(recovery, 0))                       AS sum_msrp,
  SUM(IFNULL(growth, 0))+SUM(IFNULL(recovery,0)) AS total
FROM
  orders
WHERE
  id = '$id'
GROUP BY
  name
"
13778,33587,oracle query - additional where condition depending on a field,"WHERE t.something = 'something' AND
      (t.lastname = 'smith' or t.name <> 'john')
"
28545,1637,MySQL result redirection / linked rows?,"SELECT DISTINCT Table,Length,Height FROM Inventory WHERE ID IN (SELECT DISTINCT ID FROM Inventory WHERE length < x and Parent => 0) AND Parent = NULL
"
5194,69369,How to select first 10 elements from database using SQL?,"SELECT * FROM clients ORDER BY id LIMIT 10;
"
15074,65135,Optimize long mysql query,"user.id NOT IN (SELECT id FROM idExemptTable)
"
5390,64142,Login Server Side Logic,"// coming from your login page
$dbh = new PDO(…);
$sth = $dbh->prepare('SELECT `digest` FROM `users` WHERE `name` = :name LIMIT 1');
$sth->prepare(array( ':name' => $_POST['username'] ));
$result = $sth->fetch();

if($result !== FALSE && crypt($_POST['password'], $result['digest']) === $result['digest']) {
  printf('You logged in successfully as %s', htmlspecialchars($_POST['username']));
} else {
  echo 'Sorry, username and/or password did not match! Please try again.';
  sleep(1);
  exit;
}
"
27638,31508,Update another table when field is changed,"Private Sub Text4_Exit(Cancel As Integer)
Dim strSQL As String
strSQL = ""UPDATE Quantity "" _
& ""SET [DateProduced] = #"" & Format(Me.Text4.Value, ""dd-mm-yyyy"") & ""#"" _
& ""WHERE [ID] = ("" & Me![Text0] & "");""

DoCmd.RunSQL strSQL

End Sub
"
31003,24238,I have a column that contains comments. I need to substring the value between two know words. SQL,"DECLARE @VAR VARCHAR(100)
SET @VAR='asdfasdfasfasdfasfa asasfd Occurance Date: 10/14/2013 type: drug physician xyz'

DECLARE @Begin_Pattern VARCHAR(100)
SET @Begin_Pattern='Occurance Date: '    

SELECT SUBSTRING(@VAR,(PATINDEX('%Occurance Date: %',@VAR)+LEN(@Begin_Pattern)),11)
"
2403,36889,Summing MAX and MIN values in the same column,"SELECT (MAX(payrate)+MIN(payrate))/2 AS PAYRATE
FROM    PAYCHECKS
WHERE PAYROLCD in ('01', '02') 
AND PYRLRTYP = 1 
AND EMPLOYID = A.EMPLOYID 
AND PYADNMBR = A.PYADNMBR
"
23398,22134,DBIx::Class get the dbh,"my $dbh = $c->model( 'My::DB' )->storage->dbh;
"
9027,40843,Need guidance with a complicated (probably join) query in JPQL,"em.createQuery(""SELECT count(a) FROM AnswerEntity a WHERE a.choice.choiceID = :p ""
                    + ""AND a.userId IN ""
                    + ""(SELECT us.userId FROM UserState us WHERE us.state = com.company.model.UserVotingState.DONE)"");
"
38910,45272,Make select sum() not return null,"SELECT 
sum(time) as sumToPay, 
w.name, 
w.lname 
FROM `service` s 
join worker w on s.worker_id = w.id 
group by s.worker_id 
having sum(time) > 0
"
35098,68233,"Expecting a null returned from XML.value() in SQL, but getting 0","SELECT @SearchFilter.value('(/KeywordSearch/SelfEmployed/text())[1]', 'varchar(100)')
"
36201,45196,mysql outer join with where,"SELECT l.username, p.phone, a.contact_name 
FROM Login l
LEFT OUTER JOIN PhoneNumber p ON l.id = p.user_id
LEFT OUTER JOIN AddressBook a ON p.phone = a.phone AND a.user_id = 67
"
2069,52621,"sql, return rows when multiple rows have specific values?","SELECT UserID
FROM mytable
WHERE CommunicationID IN ('Com1', 'Com2', 'Com3') 
GROUP BY UserID
HAVING COUNT(DISTINCT CommunicationID) = 3
"
28229,74846,How do I do a WHERE on the COUNT(name) produced by a GROUP BY clause?,"SELECT topic, COUNT(name) AS counter
FROM blah
GROUP BY topic
HAVING COUNT(name) <> 1
"
30394,1281,SQL insert with one row duplicate rows,"Create table TableName AS (Select Distinct [id] as id, [ahccs] as ahccs, [info] as info, [endDate] as endDate From Table_Name)
"
25304,74276,MySQL INSERT [...] SELECT with mixed data (from SELECT clause and hand-inserted values)?," INSERT oc_product_to_store (productid, storeid)
 SELECT productid, 2
 FROM oc_product_to_store 
 WHERE storedid=1
"
29745,73211,Oracle TIMESTAMP Comparison with TO_TIMESTAMP function,"SELECT count(*)
  FROM RPT.AUDIT a
  WHERE a.CURRENT_TIMESTAMP > TO_TIMESTAMP('11-16-2014 00:00:00', 'mm-dd-yyyy hh24:mi:ss')
"
23189,22485,How to apply multiple between operator in SQL,"select * from table where amount between 100 AND 1000
UNION
select * from table where amount between -1000 AND -100
"
4457,15112,SQL Sum of each character in a number,"DECLARE @someInt INT = 16273481


-- you could put this all into a function
-- and then it would be reusable...
-- 
-- like... SELECT SumOfIndividualIntegers(16273481)

DECLARE @count INT = LEN(@someInt),
        @counter INT = 1

DECLARE @Sum INT = 0

WHILE @counter <= @count
BEGIN
    SELECT @sum += CAST(SUBSTRING(CAST(@someInt AS VARCHAR), @counter, 1) AS int)
    SELECT @counter += 1
END

SELECT @sum --32
-- and then you would RETURN @sum instead
"
8859,63913,SQL exclude duplicated pairs of columns from a two-column select,"SELECT DISTINCT re1.name, re2.name 
FROM reviewer re1
  INNER JOIN rating ra1
    ON re1.rid=ra1.rid
CROSS JOIN
  reviewer re2
  INNER JOIN rating ra2
    ON re2.rid=ra2.rid
WHERE ra1.mid=ra2.mid AND  re1.rid > re2.rid;
"
33115,21969,Recursive SQL Server query,"WITH CTE
AS
(
   SELECT reviewer, reviewee
   FROM TableName 
   WHERE reviewee = @revieweeID
   UNION ALL
   SELECT p.reviewer, p.reviewee 
   FROM CTE c
   INNER JOIN TableName p ON c.reviewee = p.reviewer
)
SELECT * 
FROM CTE;
--- WHERE reviewer = @reviewerID;
"
39426,74914,A quick SQL query to generate example data,"INSERT INTO `Logins` (`User_ID`, `Date_Login`, `Location`)
SELECT
  users.ID AS `User_ID`,
  DATE_SUB(NOW(), INTERVAL FLOOR(1 + (RAND() * (365 * 2))) DAY) AS `Date_Login`,
  IF(RAND() > 0.8, 'admin', 'site') AS `Location`
FROM users
ORDER BY RAND()
LIMIT 1;
"
24373,45308,Addressing ORACLE_HOME values diversity,"C:\oracle_python\instantclient_11_2
C:\oracle\32bit\product\11.2.0\client_1\bin
C:\oracle\product\11.2.0\client_1\bin
"
19715,10995,How to alter SQL Table default data type during design,"HKEY_CURRENT_USER\Software\Microsoft\Microsoft SQL Server\100\Tools\Shell\DataProject
"
19067,59614,How to find rows in one table that have no corresponding row in another table,"select tableA.id from tableA left outer join tableB on (tableA.id = tableB.id)
where tableB.id is null
order by tableA.id desc
"
36068,6790,query the second table with the result of first,"SELECT
  s.*
FROM STUDENTS s
INNER JOIN StudentMarks m ON s.STUDENTID = m.STUDENTID ;

SELECT
  m.*
FROM STUDENTS s
INNER JOIN StudentMarks m ON s.STUDENTID = m.STUDENTID ;
"
32418,55521,Mysql storage engine for log table,"InnoDB has been designed for maximum performance when processing large data volumes. 
Its CPU efficiency is probably not matched by any other disk-based relational database
engine.
"
35699,1485,How can I optimally filter a view from a stored procedure that accepts lots of nullable parameters?,"SELECT
  <columns>
FROM
  MyView
WHERE
  (@Param1 IS NULL OR ColA = @Param1)
  AND (@Param2 IS NULL OR ColB = @Param2)
...
"
20283,26521,Updating a Table after some values are inserted into it in SQL Server 2008,"create procedure dbo.test

as

begin 

create table #temp (
name varchar(100) ,
id int
)

insert #temp
select name ,
       id 
from master..sysobjects

update #temp

set name='ALL Same'

from #temp

select * from #temp

drop table #temp

end
go
"
22578,17229,SQL - ISNULL Record Value,"SELECT
 FirstName,
 LastName,
 CASE when R.BirthDate IS NULL THEN FALSE
 ELSE TRUE
END  as HasRecord
FROM
 Person p
left join BirthRecords R on p.SSN = R.SSN
"
20709,63469,Sum based on specific condition - Oracle,"SUM(transaction_amount) 
  OVER (PARTITION BY account_number, trunc(transaction_date)
            ORDER BY transaction_date) rolling_sum
"
6565,32251,SQL Server wildcard select with a twist,"SELECT FROM DESCRIPTION..LONG
    WHERE DESCR LIKE '%[ ""\/-]age[,.:;'' ""\/-]%'
"
9360,36633,How to generate this sql query?,"  select Sum(VisitingCount), [Time]
  from #Temp group by [Time]
Union All
  select count(page) as VisitingCount, 
  (datepart(hour,Date)*60+datepart(minute,Date))/30 as [Time]
  from scr_SecuristLog
  where Date between '2009-05-04 10:30' and '2009-05-04 12:30'
  GROUP BY (datepart(hour,Date)*60+datepart(minute,Date))/30--scr
order by 2 desc
"
22267,56022,How do I find/replace rows in oracle having text containing % and other special characters,"update temp 
set address = regexp_replace(address,'[%|^\/]',' ') 
where regexp_like(address, '[%|^\/]')
"
39506,40644,Inserting n number of records with T-SQL,"DECLARE @tblRows TABLE (pos int identity(0,1), num int) 
DECLARE @numRows int,@i int


SET @numRows = DATEDIFF(dd,@start,@end) + 1
SET @i=1

WHILE @i<@numRows
begin
	INSERT @tblRows SELECT TOP 1 1 FROM sysobjects a

	SET @i=@i+1
end
"
32355,29864,faster way to do this select query,"SELECT FirstName, LastName, ID FROM EMPLOYEE WHERE FirstName = 'Test%'
OR (FirstName <> 'Test%' AND LastName = 'Test%')
"
29630,17009,Explanation about nested loop,"    SELECT T1.Col2
      FROM Table1 T1
INNER JOIN Table2 T2 ON T1.Col1 = T2.Col1 
     WHERE T1.Col1 BETWEEN 1 AND 36
"
35773,60825,how to Delete the rows those are not present in Table 1,"DELETE FROM `Table 1` t1
WHERE NOT EXISTS (
    SELECT 1 FROM `Table 2` t2
    WHERE t2.`Column A(Foreign)` = t1.`Column A(Foreign)`
)
"
18529,63201,SQL Server : check if number is in comma separated list,"DECLARE @id INT = 3
DECLARE @stringId VARCHAR(50) = CAST(@id AS VARCHAR(50))

SELECT * 
FROM MyTable 
WHERE categoryIds = @stringId -- When there is only 1 id in the table
OR categoryIds LIKE @stringId + ',%' -- When the id is the first one
OR categoryIds LIKE '%,' + @stringId + ',%' -- When the id is in the middle
OR categoryIds LIKE '%,' + @stringId -- When the id is at the end
"
6475,23142,Find conversation between one or more users,"SELECT cu.`conversation_id` 
FROM `conversation_user` cu 
INNER JOIN (
    SELECT `conversation_id`
    FROM `conversation_user` 
    WHERE `user_id` IN (X, Y) 
    GROUP BY `conversation_id` HAVING COUNT(*) = Z 
) cu2 ON cu.conversation_id=cu2.conversation_id
GROUP BY `conversation_id` 
HAVING COUNT(*) = Z;
"
27690,36182,How to SELECT TOP 5 and then the following 5?,"SELECT * FROM news ORDER BY ID DESC LIMIT 5, 5
"
4970,3574,Joining mulitple tables on a varchar key - MYSQL : Performance Issues,"            Select t1.Time1,t2.Topic_ID,t3_Location_id 
        from
        (select ID,Time1 from tbl1 where time > 400 and < 500 group by        ID,Time1) as t1
        inner join tbl2 as t2 on t2.Id = t1.ID
        inner join tbl3 as t3 on t2.id = t3.ID
        where t2.topic_ID = 2
"
30801,60453,Ignoring null values in in a postgresql rank() window function,"select Person, 
       (case when arrival_time is not null
             then rank() over (partition by Restaurant order by arrival_time asc) 
        end) as arrival_rank
from dinner_show_up; 
"
22643,25941,LINQ version of SQL's LIKE statement,"from item in db.Table1
where SqlMethods.Like(item.Column1, ""__0%"")
select item;
"
28819,20894,SQL OVER clause alternative,"select d.*
from data d
where exists (select 1
              from data d2
              where d2.value1 = d.value1 and d2.value2 = d.value2 and
                    d2.id <> d.id
             );
"
26153,37691,Optimizing MySQL table index/query,"UPDATE rates SET currency = LOWER(currency) WHERE 1;
"
18415,68877,"SQL Query for finding values that do not exist in one table, with WHERE clause","SELECT D.firstname, D.surname
FROM student_details D 
WHERE NOT EXISTS (SELECT * FROM membership_fee_payments P  
                  WHERE P.student_id = D.student_id 
                      AND P.payment_year = '2012' 
                      AND P.payment_month = 'March'
                 )
"
20728,60383,Getting rows that contain a value from another table SAS,"data t1;
input id $;
datalines;
123
456
789
;;;;
run;

data t2;
input @1 id $8.;
datalines;
123 456
234 567
;;;
run;

proc sql;
select t1.*
from t1,t2
where t2.id contains compress(t1.id);
quit;
"
5045,26738,SQL Find duplicate sets,"select * from
(
  select SetID, setitemuniquestring,
         count(*) OVER (PARTITION BY setitemuniquestring) as cnt
  from
  (
    select S.SetID,
      (select ',' + I.ItemID
       from tblSetItem I
       where S.SetID = I.SetID
       order by u.ItemID ASC
       for xml path('')
      ) as setitemuniquestring
    from tblSet S
    group by S.SetID
  ) sub
) sub2
where cnt > 2
"
392,62818,SQL Query across multiple SQL servers,"SELECT  *
FROM    [Db1].[dbo].table1 A
INNER JOIN [Server2].[Db1].[dbo].table2 B 
ON A.Id = B.Id
"
37144,26559,MySQL logging a user on from one table & count occurrences from another in same statement,"SELECT a.aId,
       a.aEmail,
       a.aBio,
       a.aReg,
       (SELECT COUNT(*) 
          FROM messages 
         WHERE mRead=0 AND mReciever=a.aId) occurrences
  FROM authors a
 WHERE a.aEmail = 'email@mail.com' AND a.aPass = '*****'
"
19046,47726,Writing a select statement inside an Oracle user-defined function,"CREATE OR REPLACE FUNCTION GET_GROUP_BY_ID 
RETURN VARCHAR2 AS

  my_result FAV_GROUP.NAME%TYPE;

BEGIN

  SELECT fav_group.name 
    INTO my_result 
    FROM fav_group 
   WHERE fav_group.id = 12345;

  RETURN my_result;

END GET_GROUP_BY_ID;
"
22821,24194,sqlite determine if index is used,"> EXPLAIN QUERY PLAN SELECT * from events WHERE type='comment' AND TIMESTAMP > $time AND PAGE = '$page' LIMIT 1
0|0|0|SEARCH TABLE events USING INDEX MyLittleIndex (page=?)
"
12472,35971,Full outer join on a table itself and run some window functions,"select min(past_id) as id, min(past_time) as event_time, 0 as freq1, 0 as freq2
from t
union all
(select current_id, current_time,
        sum(freq1) over (order by current_time),
        sum(freq2) over (order by current_time)
 from (select current_id, current_time, freq1, freq2,
              row_number() over (partition by current_id order by past_id desc) as seqnum
       from t
      ) t
  where seqnum = 1
);
"
18019,57717,Query select a bulk of IDs from a table - SQL,"INSERT INTO mytable (col1, col2) SELECT 'foo', 0 UNION SELECT 'bar', 1 
"
21029,33816,joining 3 field in mysql," SELECT
 SUM(CASE WHEN s.score < 0 THEN s.score ELSE 0 END) n_sum,
 SUM(CASE WHEN s.score > 0 THEN s.score ELSE 0 END) p_sum,
 SUM(s.score) `sum`
 FROM scores_ofexpert s
   WHERE s.user_id = '30' 
"
7629,23023,How to retrieve the date from a MongoDB ObjectId using SQL,"SELECT FROM_UNIXTIME(CAST(CONV(SUBSTR(objectId, 1, 8), 16, 10) AS UNSIGNED)) FROM table
"
16746,53140,Row permissions based on child rows,"SELECT * FROM events where id NOT IN(
  SELECT event_id FROM events_accounts WHERE account_id NOT IN(
    SELECT account_id FROM users_accounts WHERE user_id = @user_id
))
"
19452,9389,Select row twice if it matches IF condition twice,"insert into ...
select ... where product_name = ...
union all
select ... where product_name = ...
union all
...
"
2633,52016,SQL Server: generating varchar as number with some conditions,"With x as (
    Select
        reference_subjektu,
        min(reference_subjektu) over (partition by ico) nval
    from
        expozitura
) update
    x
set
    reference_subjektu = nval
where
    reference_subjektu != nval;
"
22345,27252,Sql query not giving desire result for android application?,"SELECT alumni_custom_fields. _id,alumni_custom_fields.field_label as key ,alumni_custom_field_data.custom_field_value as value FROM alumni_custom_fields LEFT JOIN alumni_custom_field_data ON alumni_custom_fields._id=alumni_custom_field_data.custom_field_id and alumni_id ='""+alumniId+""' order by sequence
"
33354,5251,"In Sql, how can one change a value using a case statement?","SELECT 
users.UserName,
users.phone,
users.email,
users.status,
CASE WHEN users.group_id=3 THEN 5 ELSE users.group_id END AS RoleId
...
"
5358,13824,Sql server job to track DB changes,"CREATE TRIGGER safety 
ON DATABASE 
FOR CREATE_TABLE, DROP_TABLE, ALTER_TABLE 

AS
   EXEC msdb..sp_start_job 
       @job_name = 'JobName';
 GO
"
33911,70197,Copy Column A from Table 1 and column B from Table 2 into Table 3 columns A and B,"INSERT INTO TABLE3 (A, B)
SELECT TABLE1.A, TABLE2.B
FROM TABLE1, TABLE2
"
33203,41655,SQL query to get all the combinations of two columns,"SELECT Flag1, Flag2, COUNT(GeneId) as NumGenes
FROM genetable
GROUP BY Flag1, Flag2
"
6094,502,Sqlite select max query and sorting,"select * 
from table
where product_price = (SELECT max(product_price) FROM table)
order by id desc
limit 1
"
5794,18452,"Is it possible to order ""first n"" records randomly with only one SELECT?","SELECT name, view_count 
FROM `ex`.`item` 
where status='available' 
order by rand(), view_count asc limit 40;
"
22052,70049,Concatenate 2 values from the same column with different conditions,"select user_id, concat(F_name, ' ', L_name)
From
(
select user_id, 
       max(case when key = 'firstname' then value end) F_name,
       max(case when key = 'lastname' then value end) as L_name
From Yourtable
Group by user_id
) A
"
25268,29938,Merge rows with same column value into 1 - Oracle,"select DB,NR,sum(amount) from table group by NR,DB
"
39602,63921,SQL query to get most comments since last month,"select post_id, count(*)
from (select c.*, max(comment_date) over (partition by post_id) as maxcd
      from comments c
     ) c
where comment_date >= maxcd - interval '1 month'
group by post_id;
"
31144,37003,Database Cross Table Association Logic,"CREATE TABLE Forms_Using_Fields
(
    FormID    INTEGER NOT NULL REFERENCES Forms(Id),
    FieldID   INTEGER NOT NULL REFERENCES Form_Fields(Id),
    PRIMARY KEY (FormId, FieldId),
    Seqno     INTEGER NOT NULL,  -- Sequence number of field on form
    ...
);
"
9921,27832,"How to order by custom rule, e.g. how to order like 4,2,1,3","SELECT * FROM foo ORDER BY FIELD(season_id, 4, 2, 1, 3);
"
26392,51544,T-SQL Group by day date but i want show query full date,"SELECT CAST(T1.UI_CreateDate as DATE) AS DATEDAY, COUNT(*) AS TOTALCOUNT 
FROM mydb.dbo.LP_UseImpression T1
WHERE T1.UI_BR_BO_ID = 45  
GROUP BY CAST(T1.UI_CreateDate as DATE)
ORDER BY DATEDAY;
"
12178,20863,mysql keep subquery out of a join,"select t1.date,
       count(distinct case when t1.pid = t2.pid_raw then t1.pid end) as NumMatches,
       (count(distinct case when t1.pid = t2.pid_raw then t1.pid end) / 
        count(distinct case when t1.pid = t2.pid_raw then t2.pid_raw end) 
       ) as percentage_pid
from table1 t1 left join
     table2 t2
     on t2.date_raw between t1.date - interval 31 day and t1.date
group by t1.date;
"
32971,43553,Insert into certain columns,"insert into table2
(
    col2, col3, col4
)
select col1, col2, col3
from table1
"
33412,31378,How to optimize ABAP query,"SELECT foo bar baz
  FROM ZVBAPIUSW01 UP TO 1 ROWS
  INTO (l_foo, l_bar, l_baz)
  WHERE OBJID = ID
  ORDER BY updpass DESCENDING updpasstime DESCENDING.
"
35852,34833,Do isolation levels only apply to SELECTS and not UPDATES?,"Thread A: UPDATE ... SET ..., version = 6 WHERE primary_key = 1234 AND version = 5
Thread B: UPDATE ... SET ..., version = 6 primary_key = 1234 AND version = 5
"
33631,57994,SQL Query to select row in db who's publish time and end time should not overlap,"SELECT question_id FROM questions
where '"".$publish_date.""' BETWEEN publish_date AND end_date
AND '"".$publish_time."" BETWEEN publish_time AND end_time
"
12405,23386,Xquery SQL contains,"with xmlnamespaces(default 'http://schemas.xxx.xxx.xxx')
select *
from Table
where [XML].exist('/Node/SubNode/SubSubNode [contains(ContentNode[1],"","")]')=1
"
35294,42792,Delete a row in a table after an hour it is inserter using sql query,"DELETE FROM detail1 WHERE date < DATETIME('NOW', '-1 hours');
"
6283,43937,Perform INSERT in Stored Procedure after SELECT,"INSERT INTO Message (username, message)
SELECT username, 'Happy Birthday'
FROM Users
WHERE birthday = todaysDate
"
38880,69924,Are Concurrent SQL inserts into the same table transactionally safe?,"""MyISAM supports concurrent inserts...""
"
1883,63393,Divide two columns into group by function SQL,"select col1, col2, col3, 
       sum(value1) as col4, 
       col5, 
       sum(value1) / col5 as col6
from table1
group by col1, col2, col3, col5
"
24397,54600,getting sum of count() in groupby,"GROUP BY date(alertDate)
"
12356,5106,Run script multiple times using variable in constraint,"INSERT  Table2
        (Produce, Cust1_Totals, Cust2_Totals, Cust3_Totals)
SELECT  Fruit
,       SUM(case when Customer_ID = 1 then quantity end)
,       SUM(case when Customer_ID = 2 then quantity end)
,       SUM(case when Customer_ID = 3 then quantity end)
FROM    Table1
WHERE   Customer_ID IN (1,2,3)
GROUP BY 
        Fruit
"
2783,38339,TSQL: union results from two selects (procedures?),"create table #sometable (table definition here)

if @Param = 1 or @Param = 3 begin
    insert #sometable exec PROCEDURE1
end

if @Param = 2 or @Param = 3 begin
    insert #sometable exec PROCEDURE2
end

select * from #sometable
"
34146,71130,Find records with a time field in the last 24 hours,"select somefield from yourtable where timefield >= subtime(current_timestamp(), '1 00:00:00');
"
23685,13812,"MySQL, sort integer character by character","ORDER BY CAST(myField AS CHAR)
"
2468,12142,How to do a batch insert in MySQL,"
INSERT INTO tbl_name (a,b,c) VALUES(1,2,3),(4,5,6),(7,8,9);
"
39686,33179,MySQL count useragents with distinct IP addresses,"SELECT
    COUNT(*) as event_count,
    COUNT(DISTINCT ip) as ip_count,
    COUNT(DISTINCT (case when useragent LIKE '%iPad%' then ip end)) as ipad_users
FROM events;
"
18169,31520,Oracle SQL to get count of first occurrences of a row in the full data set filtered by date?,"SELECT event_type, date_value
from (
  SELECT event_type, min(date_value) as date_value
  from your_table
  where date_value <= date '2013-03-10'
  group by event_type
)
where date_value >= date '2013-03-07'
"
13813,42482,SQL Merge two tables - Order BY,"order by case [Week] 
    when 'Overall' then 1
    when 'Week3' then 2
    when 'Week2' then 3
    when 'Week1' then 4
end
"
39946,75510,Select each month between a start and end date,"SELECT generate_series('2010-04-01', '2011-02-01', interval '1 month')::date
"
35815,39071,Increasing Alphanumeric value in user defined function,"DECLARE @prefix varchar(20), @numberstr varchar(20), @number int, @Val varchar(40)

SELECT @Val = 'ABCD000006'
--SELECT @Val = 'A03'

SELECT @prefix = LEFT(@Val, PATINDEX ('%[0-9]%', @Val) -1)
SELECT @numberstr = SUBSTRING(@Val, PATINDEX ('%[0-9]%', @Val), 8000)
SELECT @number = CAST(@numberstr AS int) + 1
SELECT @prefix + RIGHT(REPLACE(SPACE(LEN(@numberstr)), ' ', '0') + CAST(@number AS varchar(20)), LEN(@numberstr))
"
15035,42535,Why my strings can't be sorted like i want when i insert values from textview?,"Cursor cursor = sqLiteDatabase.query(MYDATABASE_TABLE, columns, 
        null, null, null, null, ""CAST("" + KEY_CONTENT + "" as integer) desc"");
"
3607,35170,CF/SQL Check to see if date is past and if another field is completed,"SELECT *  
FROM received     
WHERE Date_Due > CAST(GETDATE() AS DATE)
  AND Date_Complete IS NULL
"
5243,52390,Mysql: Execute query for each date,"SELECT date,SUM(rainmm) FROM weather WHERE MOD(minute(time),60)=0
GROUP BY date
ORDER BY date;
"
39107,10684,Using every subqueries on where clause to count in SQL Server,"SELECT Month, Crime_type, COUNT(*) as TOTAL
FROM MainTable m
INNER JOIN TableLL t
   on ABS(m.MainTableLongitude - t.Longitude) < 0.014347 
  and ABS(m.MainTableLongitude - t.Latitude) < 0.023033
GROUP BY Crime_type,MONTH
"
9872,49766,Reproducing a nested not in statement through a join statement,"select p.productid, p.name
from production.product p
left join sales.salesorderdetail sod on sod.productid = p.productid
where sod.ProductID is null
order by p.productid;
"
10702,33980,Database Design for a Hotel Reservation System,"table: Room
roomno INT
phone_number INT
number_of_beds INT
smoking_allowed BOOLEAN

table: Occupancy
client_id BIGINT (FK referencing Client) (part of PK)
roomno INT (FK referencing Room) (part of PK)
checkin_time DATETIME

table: pastStays
client_id BIGINT (FK referencing Client) (part of PK)
roomno INT (FK referencing Room) (part of PK)
checkin_time DATETIME
checkout_time DATETIME
"
16701,9353,Mysql sum using a group by on one field while also considering another field,"select t1.name, t2.attr, sum(t2.amount) from t1
join t2 on t1.id = t2.id
group by t1.name, t2.attr
"
7141,22918,See all tables referencing a primary key,"select table_name
  from all_constraints
 where r_owner = 'OWNER'
   and r_constraint_name = 'YOUR_PRIMARY_KEY'
"
9710,69589,Loop through all schemas in Talend,"tFlowToIterate_1----(iterate)-----tOracleRow_1------(OnComponentOk)------tOracleInput_1
"
20926,10601,sql set the week number start,"select DATEDIFF(week, '1-Nov-2014', GETDATE()) + 1
OutPut: 45
"
28532,55594,How to improve the search efficiency of SQLite database?,"WHERE x = ... AND y=... AND zoom=... AND type =...
"
35080,52677,Can't get LEFT OUTER JOIN to work through an intersect table,"select
  thing.name,
  f.name
from
  thing
  left outer join thing_feature tf on thing.id = tf.thing_id
  left outer join feature f on tf.feature_id = f.id;
"
12535,67088,Get full name based on username for 2 columns,"SELECT b.book AS Book, bn.fullname AS Analyst,
       sn.fullname AS Supervisor
FROM books b left join
     names bn
     on b.analyst = bn.username left join
     names sn
     on b.supervisor = sn.username;
"
12169,8957,Group by in sql query,"select id_zamowienia
,      login
,      imie
,      sum(wartosc_netto) wartosc_netto
from   tableName
group
by     id_zamowienia
,      login
,      imie
"
7602,64460,Unix shell script run SQL scripts in parallel,"  sqlplus user1/pw @/home/scripts/tst1.sql
  sqlplus user1/pw @/home/scripts/tst2.sql &
  pid2=$!
  sqlplus user1/pw @/home/scripts/tst3.sql &
  pid3=$!
  # pseudo-code:
  # while (`ps -p""$pid2,$pid3"" | wc -l` != ""1"");
  sqlplus user1/pw @/home/scripts/tst4.sql
"
21393,8352,Mysql query NOT IN,"SELECT *,MATCH(file_name_keyword) AGAINST('$file_name_keyword') 
FROM `uploaded` 
WHERE (MATCH(file_name_keyword) AGAINST('$file_name_keyword') OR file_name_keyword REGEXP '.*($file_name_keyword).*' )
AND id NOT IN (57)
LIMIT 8
"
14854,42148,Prevent delete on single row with trigger,"CREATE TRIGGER deleteWorkspace ON Workspaces
FOR DELETE AS

IF(SELECT COUNT(*) FROM deleted) = 1
BEGIN
RAISERROR('Single Delete Not Allowed!', 16, 1)
ROLLBACK
END
ELSE
RAISERROR('Multiple Rows Being Deleted, Allowed!', 16, 1)
BEGIN
END

END
GO
"
28260,56159,How to get ODBC connection by name?,"OdbcConnection connection = new OdbcConnection(""DSN=MyDataSourceName"");
"
22497,37605,Just started sqlite. How do I do refined searches?,"SELECT * FROM actors WHERE birth_year > 1956;
"
7720,54306,selecting latest result from a table using SQL query,"    SELECT  id, policy, first, last, amount, created
    FROM    yourtable yt
            INNER JOIN
            (SELECT policy,MAX(id) as id
            FROM yourtable
GROUP BY policy) maxid ON yt.policy = maxid.policy 
                                    AND yt.id = maxid.id
"
14751,4295,subquery to derive a value if all values of the column is the same for,"select t.*,
       (case when min(NumEmployees) over (partition by grp) =
                  max(NumEmployees) over (partition by grp)
             then 1
             else 0
        end) as DerivedField
from table t;
"
37020,73897,sql count mismatch,"select count(*) from TMP_ORDER_ACTION_PSTN_CP_11035 where STATUS is null;
"
9847,6526,MySQL SQL Query to Delete a String From Records,"UPDATE table SET post_content = REPLACE(post_content, 'String: [css3_grid id=''gcse'']', '');
"
12034,65457,"Mysql subtracting values using row selected from min timestamp, grouping by id","select t.user_id, max(t.overall_exp - tprev.overall_exp)
from tracker t join
     tracker tprev
     on tprev.user_id = t.user_id and
        date(tprev.timestamp) = date(SUBDATE(t.timestamp, INTERVAL 1 DAY))
group by t.user_id
"
12972,74752,"SQL syntax issue using ""IN"" keyword with dynamic data","IN (SELECT myField from #myTable)
"
3198,44944,Crystal Report using between but only 1 parameter is showing when Entering date values,"ACC_PERIOD

is between      {?ACC_PERIOD}
                {?ACC_PERIOD2}
"
32621,35086,Inserting and transforming data from SQL table,"SELECT
    date,
    id,
    SUM(CASE WHEN status_id = 1 THEN status_time ELSE 0 END) AS lunch,
    SUM(CASE WHEN status_id = 2 THEN status_time ELSE 0 END) AS break,
    SUM(CASE WHEN status_id = 3 THEN status_time ELSE 0 END) AS vacation
FROM
    My_Table
GROUP BY
    date,
    id
"
1797,6722,Importing a mysql database with command line,"mysql -u db_username -p db_pw -h localhost -D existing_empty_db_name < new_db.sql 
"
15317,9372,Regarding sql query,"INSERT INTO TEST_DETAILS
  (seqnbr, trpid, type)
 SELECT '&seqid', rd.rep_id, '3'
     FROM (SELECT LEVEL + 13
             FROM DUAL
       CONNECT BY LEVEL <= 13) x
LEFT JOIN REF_DETAILS rd ON rd.rep_id = x.level
                        AND rd.rep_id > 13
"
4236,40292,How do I cross-join a table with a list?,"select a.*, b.val
from a lateral view explode(array(1,2,3,4)) b as val;
"
29125,17451,Query returning null on a column with info,"SELECT
    hotelName,
    roomNo

FROM
    hotel

INNER JOIN
    room

ON
    hotel.HotelNo = room.HotelNo 
"
2143,64984,Count items and create an array,"SELECT a, array_agg(bs) AS b_list
FROM  (
    SELECT a, b || ':' || count(*) AS bs  -- coerced to text automatically
    FROM   tbl
    GROUP  BY a, b
    ORDER  BY a, b   -- to sort b_list in the result
    ) x
GROUP  BY a;
"
17025,22797,SQL show records that don't exist in my table variable,"FROM YourQuery q
WHERE NOT EXISTS 
(
SELECT * FROM @TableVar t
WHERE t.OrderId = q.OrderId
  and t.UnitId = q.UnitId 
  and t.OrderServiceId=q.OrderServiceId
)
"
35791,52846,Converting to date with multiple possible masks in Oracle,"SQL> select to_date('2009.12.31','YYYY/MM/DD') from dual;

TO_DATE('20
-----------
31-DEC-2009
"
16241,536,Select date that's in given date's interval,"WHERE datum between date_sub( '2013-06-11 18:40', interval 90 minute) and
    date_add( '2013-06-11 18:40', interval 90 minute)
"
26646,4251,SQL DataRetrival in VB.net Datatypes Error,"connection = New System.Data.OleDb.OleDbConnection(""Provider = Microsoft.Jet.OLEDB.4.0 ;Data Source="" & Filepath & "" ;Extended Properties='Excel 8.0;HDR=Yes;IMEX=1;'"")
"
35327,69106,How to drop all stored procedures at once in SQL Server database?,"declare @procName varchar(500)
declare cur cursor 

for select [name] from sys.objects where type = 'p'
open cur
fetch next from cur into @procName
while @@fetch_status = 0
begin
    exec('drop procedure [' + @procName + ']')
    fetch next from cur into @procName
end
close cur
deallocate cur
"
32037,62964,Select rows matching a pattern using LIKE,"select ...
from ....
where attr like '%<t1>%</t1>%' 
and attr not like '%<t1>1600</t1>%'
"
11936,45799,SQL Server 2008 - Updating only a specific number of rows within a table,"WITH CTE AS
(
   SELECT rn = ROW_NUMBER() OVER (ORDER BY ref, id),
          ref, id, text
   FROM   MyTable
   WHERE  ref = 555 AND  id = 7
)
UPDATE CTE SET text = 'Matched' 
WHERE RN <= 400
"
3156,70932,Counting the number of first place scores with mysql,"select 
    concat(h.username ,"" has "", count(h.username),"" high scores "")
from
    highscores h inner join
    (select lid, max(score) as maxscore
     from highscores group by lid) t on h.lid = t.lid and h.score = t.maxscore
group by h.username
"
28315,50757,oracle trigger select updated row,"CREATE OR REPLACE TRIGGER Z_ONUPDATELOGIN
  AFTER UPDATE OF LAST_LOGGED_IN_DATE ON CMN_SEC_USERS
  FOR EACH ROW
BEGIN
    INSERT INTO Z_LOGIN (name, login_date) 
    VALUES (:NEW.first_name || :NEW.last_name, 
            :NEW.last_logged_in_date);  
END;
"
14764,35590,using PARSENAME to find the last item in a list,"select right(@string2, charindex('.', reverse(@string2), 1) - 1)
"
17547,17565,How can I find out the date of the last change on a table in Teradata?,"SELECT TABLENAME, LASTALTERTIMESTAMP 
FROM DBC.TABLES
WHERE DATABASENAME = 'My DB Name' -- OPTIONAL
ORDER BY LASTALTERTIMESTAMP DESC
"
18132,67043,Year-To-Date Summary by Month in Access SQL,"SELECT FORMAT(t1.completionDate,""mmm-yy"") AS [month], (
        SELECT SUM(t2.amount)
        FROM projects AS t2
        WHERE MONTH(t2.completionDate) <= MONTH(t1.completionDate)
    ) AS [amount]
FROM projects AS t1;
"
1331,11316,"Select all rows, with specific characteristics, with same subdata by grouping them through a same row value in oracle","SELECT *
FROM tbl t
WHERE
    CONNECTION IN(
        SELECT CONNECTION
        FROM tbl
        GROUP BY CONNECTION
        HAVING
            SUM(CASE WHEN STATE = 'N' THEN 1 ELSE 0 END) > 0
            AND SUM(CASE WHEN STATE <> 'N' THEN 1 ELSE 0 END) = 0
    )
"
36633,54519,Need help writing recursive query,"SELECT t1.Id,t1.name,sum(t2.Qty)
FROM NameQty t1
    LEFT JOIN NameQty t2 ON t1.name=t2.name AND t1.Id>t2.Id
GROUP BY t1.Id,t1.name
ORDER BY t1.Id
"
32869,40131,Multiple outer joins semantics,"SELECT *
FROM table1 tab1 
LEFT OUTER JOIN table2 tab2 ON tab1.fg = tab2.fg
LEFT OUTER JOIN table4 tab4 ON tab1.ss = tab4.ss
INNER JOIN table3 tab3 ON tab4.xya = tab3.xya
LEFT OUTER JOIN table5 tab5 ON tab4.kk = tab5.kk
"
29322,11028,Join same table with results on one row,"select
    quantity,
    sum(case when websiteid is null and customergroupid is null
         then price
         end) as sprice,
    sum(case when websiteid is not null and customergroupid is null
        then price
        end) as wprice,
    sum(case when customergroupid is not null
        then price
        end) as cprice
from
  t
group by
  quantity
"
335,64472,Selecting rows with the highest date,"SELECT *
FROM Table
INNER JOIN 
(SELECT Name, MAX(Date) as TopDate
FROM Table
WHERE Type = 'FRUIT'
GROUP BY Name) AS EachItem ON 
    EachItem.TopDate = Table.Date 
    AND EachItem.Name = Table.Name
"
510,72515,two tables and trying to access info from another table,"SELECT u.firstName, u.lastName, t.*
FROM users u INNER JOIN tickets t
    ON u.id = t.user
WHERE u.firstName = ???
  AND u.lastName = ???
"
27893,50752,Removing padded zeroes in Hexadecimal column,"Select  replace(rtrim(replace('C700DBBF000000','0',' ')),' ','0');
"
38691,1191,How do I convert an arbitrary list of strings to a SQL rowset?,"SELECT 'foo'
UNION
SELECT 'bar'
UNION
SELECT 'baz'
"
1524,56999,"sql ""group by"" same PersonID, different PersonNames. Eliminate duplicates","SELECT    ID,
          MAX(Name) AS Name
FROM      [YourTable]
GROUP BY  ID
"
38302,49479,SQL script for incrementing dates,"UPDATE yourtable
SET yourdate = dateadd(dd, 3, yourdate)
WHERE datepart(weekday,yourdate)=6
"
12502,4164,Grouping by an aggregate column,";with x as (
    select *,
    lag(widget) over(order by id) as lg
    from #t
),
y as (
    select *, sum(case when widget<>lg then 1 else 0 end) over(order by id) as grp
    from x
)
select widget, min(part), count(*)
from y
group by widget, grp
"
26446,19830,Oracle Hierarchical Query: Include Start With in result and optimization,"select pc.child
from parentChild pc
start with pc.Parent=""abc""
connect by nocycle prior pc.child = pc.parent
union
Select pc.parent from dual
"
594,2303,"Using sql, how can I simultaneously count the filtered and unfiltered occurrences of an attribute?","SELECT account_id, 
        count(case when attribute LIKE '%filter%' then 1 end) as filtered_count,
        count(*) as total_count
FROM my_table
GROUP BY account_id
ORDER BY account_id;
"
25127,21981,Update redshift column value with modified data from other column,"UPDATE
  schema.table_name
SET
  data_id = SPLIT_PART(REGEXP_SUBSTR(data_column, 'pattern=[^&]*'),'=',2)::BIGINT;
"
20195,69698,i am trying to use an input from the user as part of a connection string to a SQL database,"Dim str As String = ""Data Source=DESKTOP; uid="" & ID & ""; pwd="" & PASS & "";database=DB"" 
"
22294,19867,SQL: LIKE with OR vs IN,"WHERE NAME LIKE 'EXPRESSION_%' 
"
31352,17709,Auth::attempt changing default password to default field like in DB,"public function getAuthPassword()
{
     return $this->attributes['passwordFieldinYourTable'];//change the 'passwordFieldinYourTable' with the name of your field in the table
}
"
7422,59276,MySQL ranking query,"select r.*, @row:=@row+1 rank 
  from 
    (SELECT u.user_id,r.totalVotes votes,r.totalPoints rating
       FROM mismatch_user u 
         LEFT JOIN ratingItems r ON u.user_id=r.uniqueName
    ) r
    join (SELECT @row:=0) pos 
ORDER BY r.votes DESC, r.rating DESC
"
10140,67838,Multidimensional Tables in PostgreSQL,"create table COMMENTS(
    COMMENT_ID serial primary key,
    POST_ID integer not null foreign key references POSTS(ID),
    PARENT_COMMENT_ID integer foreign key references COMMENTS(COMMENT_ID),
    CREATED_BY ...
    CONTENT ...
)
"
11673,10406,JOIN syntax and order for multiple tables,"SELECT v1_col, p1_col
FROM p1_tbl
JOIN v1_tbl ON p1_date >= v1_date
JOIN v2_tbl ON v2_uid = v1_uid
JOIN v3_tbl ON v3_uid = v1_uid
JOIN  p_tbl ON p_uid = p1_uid 
JOIN p2_tbl ON p2_uid = p1_uid AND p2_id = v2_id
JOIN p3_tbl ON p3_uid = p1_uid AND p3_id = v3_id
WHERE p1_code = 1
  AND v1_code = 1
"
1924,33018,"MySQL Order_By date column and integer column, but specify ordering rules of integer column?","SELECT   *
FROM     `my_table`
ORDER BY CASE `integer` WHEN 2 THEN 1 ELSE 0 END DESC, `date` ASC
"
4688,53348,H2 DB CSVWRITE Duplicate Double Quotes Inside a String,"CALL CSVWRITE(
  '#DELTA_CSV_DIR#/DELTA.csv', 
  'SELECT ccc from temptemp', 
  'fieldSeparator=| fieldDelimiter= escape=');
"
22950,22685,SQL grammar for INSERT SELECT ON DUPLICATE UPDATE,"INSERT INTO tbdetail (detail, views)

SELECT detail, SUM(views) AS viewsall FROM tb GROUP BY detail

ON DUPLICATE KEY UPDATE views = views + VALUES(views);
"
6577,60481,Joining three tables in Laravel with conflicting column names,"$events = DB::table('events')
            ->join ('locations', 'events.location_id', '=', 'locations.id')
            ->join('orgs', 'events.org_id', '=', 'orgs.id')
            ->select('events.id', 'events.name as event_name', 'orgs.name as org', 'locations.name as location')
            ->get();
return response()->json($events);
"
3865,20734,INSERT INTO based on result of WHERE in double JOIN,"INSERT INTO 
  tbl_his (a_fk, coef) 
SELECT 
  tbl_a.id, 
  CASE WHEN tbl_c.switch = 0 THEN 100 ELSE 50 END
FROM
  tbl_a
LEFT JOIN
  tbl_b
ON
  tbl_a.b_fk = tbl_b.id
LEFT JOIN
  tbl_c
ON
  tbl_b.c_fk = tbl_c.c_id
"
38270,68941,Get data whether the id is there or not,"SELECT sub.SubDivisionID, sub.SubDivisionName, csxref.SubDivisionID AS Assigned
FROM SubDivision AS sub
LEFT JOIN (
    SELECT t.SubDivision 
    FROM CustomerSubDivisionXREF AS t 
    WHERE t.CustomerID = 9
) AS csxref ON sub.SubDivisionID = cxsref.SubDivisionID
"
14098,9280,"Combine two different select statements, one distinct the other not","SELECT * FROM StevesTable t 
WHERE t.data1 = '%s' 
AND t.data2 = to_date('%s','DD/MM/YYYY')
AND t.data1 in (select distinct data1 FROM anothertable ftt
    join table1 tab on tab.somedata = ftt.somedata
    where tab.somedata = 0
    and tab.someotherdata = 1)
"
22902,69920,Split intervals of numbers into groups,"select min(value) min, max(value) max
from (select value, ROW_NUMBER() over (order by value) - value as [key] 
      from t) v
group by [key]
order by min
"
35790,240,Show running query in postgresql,"track_activity_query_size = 1024
"
34271,29554,Output dates in MMDDYYYY format efficiently,"SELECT REPLACE(CONVERT(VARCHAR(10), RowUpdateDateTime, 110),'-','') from MyTable
"
29253,47200,MySQL SELECT x FROM a WHERE NOT IN ( SELECT x FROM b ) - Unexpected result,"SELECT  *
FROM    match m
WHERE   NOT EXISTS
        (
        SELECT  1
        FROM    email e
        WHERE   e.id = m.id
        )
"
1898,36535,How to write SQL with count and group by common fields from two tables,"SELECT 
  COALESCE(Shape, t2.PickedShape) AS Shape, COUNT(Shape) AS Available,
  ISNULL(Picked, 0) AS Picked, ISNULL(Finished, 0) AS Finished
FROM 
 Store 
FULL JOIN 
  (SELECT PickedShape, COUNT(1) As Picked, SUM(CASE WHEN Finished='Y' THEN 1 ELSE 0 END) AS Finished 
   FROM Record 
   GROUP BY PickedShape) t2 ON Store.Shape = t2.PickedShape
GROUP BY 
  Shape, t2.PickedShape, Picked, Finished
"
35231,12890,Assign value to a column based on values of other columns in the same table,"select 
  dateid, 
  orderid, 
  trunc((row_number() over (partition by dateid order by orderid) +1 ) / 2) as batch
from mytable;
"
27138,13938,MySQL Append-Only Model - Clean up query using DELETE,"DELETE t1 FROM
  table1 AS t1, table1 AS t2
WHERE 
  t1.id = t2.id
AND 
  t1.timestamp < t2.timestamp;
"
31903,67135,Joining tables in SQL,"SELECT  t.topicname, m. *, ms.avatar
FROM    `messages` m
JOIN    topics t
ON      t.topicid = m.topicid
LEFT JOIN
        users u
ON      u.username = m.author
LEFT JOIN
        misc ms
ON      ms.userid = u.userid
ORDER BY
        m.postdate DESC
LIMIT 5
"
4738,72824,Best way to store randomized items from RPG's?,"Items:
------
ItemID int primary key
ItemName varchar(50)

Stats:
------
StatID int primary key
StatName varchar(50)

ItemStats:
----------
ItemStatID int primary key
ItemID int foreign key (Items.ItemID)
StatID int foreign key (Stats.StatID)
Value int
"
18562,7119,Adding another column based on different criteria (SQL-server),"SELECT c.Agent, 
       SUM(s.price) AS TotalSales,
       SUM(CASE 
               WHEN s.OutboundCallDate IS NOT NULL THEN s.price
               ELSE 0
           END) AS OutboundSales
FROM contact c, sales s
WHERE c.id = s.id
GROUP BY c.agent 
"
24484,40448,android sqlite doesn' support arabic,"BufferedReader reader = new BufferedReader(new InputStreamReader(
                ctx.getAssets().open(""textFile.txt""), ""UTF-8""));
"
33532,57071,SQL Query that suggest next quizes of every user,"SELECT user_id, IFNULL((q_count+1) % 4, 0) AS next
FROM   users LEFT JOIN (
  completed_quizes NATURAL JOIN (
    SELECT   user_id, MAX(completion_date) AS completion_date
    FROM     completed_quizes
    GROUP BY user_id
  ) AS t
) USING (user_id)
"
31687,71191,Exposing more fields on group by sql,"SELECT a.*, b.* FROM
BMP_VISITS_SITES a
OUTER APPLY
(
    SELECT TOP 1 *
    FROM BMP_VISITS_COMMENTS b
    WHERE b.StationID = a.StationID
    ORDER BY LastDateObserved DESC
) b
"
1661,49738,D: (ddbc) can I do SELECT with one request?,"auto users = stmt.select!User.array
"
73,37758,SQL - passing variable from first select to second select,"SELECT a.ItemID, a.Name
FROM things a
WHERE name IN (SELECT name FROM things WHERE itemID = 1)
"
32078,64443,select data from two tables using simple sql query,"if not exists(select * from DeliveryTemplate where TemplateId=2)
                begin 
                   select u.usersCode, 1,2,'User {UsersCode}',' hello {Username},', null, dt.DeliveryCode 
                   from User u
                   left join DeliveryTemplate dt on u.Id = dt.UserId
                end
"
21468,61118,the multi-part identifier could not be bound after multi inclusion of one table in join,"INNER JOIN [dbo].pstl_Unit AS pos ON pos.UnitId = pstl_UnitPosition.FK_Unit
INNER JOIN [dbo].pstl_Unit AS vis ON vis.UnitId = VW_PERS_Visibilite.FK_Unit
"
60,47620,SQL Count function - simple aggregate needed,"select name, count(*) over (partition by name) as name_count, amount
from table t;
"
30634,39239,Create sequence with specific set of values in oracle,"create sequence seq_alternate 
   minvalue -1
   maxvalue 1
   start with 1
   increment by 2
   nocache
   cycle;
"
13044,2921,left outer joining three tables in oracle,"SELECT t1.tb1_a, COALESCE(t3.tb3_a, 'No city for him yet') AS City
FROM table1 t1
LEFT JOIN (
    SELECT MAX(tb2_b) AS tb2_b, tb2_a
    FROM table2
    GROUP BY tb2_a
) t2 ON (t2.tb2_a = t1.tb1_a)
LEFT JOIN table3 t3 ON (t3.tb3_a = t3.tb2_b);
"
980,16371,Swift 2 - How can I run a code after an asynchronous method?,"ref.observeSingleEventOfType(.Value, withBlock: { snapshot in
    print(snapshot.value.objectForKey(""Table"")!)
    s = snapshot.value.objectForKey(""items:"")! as! String

    Str = s.componentsSeparatedByString("","")

    for part in Str {
        print(part)
    }
})
"
11305,8880,MYSQL: LIKE with Except Condition,"select schema_name 
  from information_schema.schemata
 where schema_name like '%sample%'
   and schema_name not like '%fallback%'
"
32443,20862,How do you select values from two different tables with a join/union?,"SELECT u.Name, a.URL 
FROM users u 
join application a
on u.ID = a.UserID
"
32074,35464,SQL Server query runs slower when nothing is returned,"with tree(NodeId,CategoryId,ParentId) as (
        select ct.NodeId, ct.CategoryId, ct.ParentId
        from dbo.CategoryTree as ct
        where ct.NodeId = 6
        union all
        select t.NodeId, t.CategoryId, t.ParentId from dbo.CategoryTree as t
        inner join tree as t2 on t.ParentId = t2.NodeId
    )"
16514,24776,"Using ""Is Null"" as a criteria based on a form","SELECT t.atext
FROM Table1 t
WHERE IsNull([atext])=[Forms]![Reports]![Status - Null]
"
22572,6470,multiple top n queries,"SELECT team_id,
       SUM(points)
  FROM (
        SELECT t.team_id, 
               p.points
               ROW_NUMBER() OVER(PARTITION BY team_id ORDER BY player_id, p.rowid) rn
          FROM teams t, players p
              WHERE t.team_id = p.team_id
                AND p.wasSick = 0
        )
 WHERE rn < 12
 GROUP BY team_id
"
31846,69973,Compare Multiple Values SQL,"SELECT 
    A.Cust_nbr,
    A.Avg_Sales,
    CASE WHEN B.MaxSale < A.Avg_Sales THEN 1 ELSE 0 END IsAlwaysBelowAverage
FROM 
    Table1 A
     LEFT JOIN 
      (
        SELECT 
            Cust_Nbr,
            MAX(Weekly_Sales) AS MaxSale
        FROM Table2 
      ) B ON 
        A.Cust_Nbr = B.Cust_Nbr 
"
13046,42896,Show SQL table other way,"select Code, A, B
from
  (
    select Code, Zone, Price 
    from YourTable
  ) T
pivot
  (
    min(Price) for Zone in (A, B)
  ) P
"
39847,21934,For Loop With Object Table?,"for x in (select value(t) v from person_obj_table t where lastName = 'Smith') loop
  dbms_output.put_line(x.v.get_fullName);
end loop;
"
27902,57247,"sql server stored proc times out and query does not time out, why?","CREATE PROCEDURE [TestSproc]
    @Param1 INTEGER
AS
BEGIN
DECLARE @Param1_LOCAL INTEGER
SET @Param1_LOCAL = @Param1

SELECT Something
FROM Somewhere
WHERE SomeField = @Param1_LOCAL 
END
"
34418,11597,"Select MAX value from other table, if any","SELECT u.Name AS Name, c.Comment AS Comment, c.Posted AS Posted
FROM User u LEFT JOIN
     (SELECT UserID, MAX(Posted) AS Posted
      FROM Comments c2
      GROUP BY UserID
     ) c2
     ON u.ID = c2.UserID LEFT JOIN
     Comments c
     ON c2.Posted = c.Posted
ORDER BY Posted DESC;
"
33840,71458,Using onUpGrade with multiple versions of App to add columns,"if(oldVersion < 5)
  ... sql alter statement for the first new column ...

if(oldVersion < 6)
  ... next sql alter statement
"
19618,41291,Update mysql table column,"UPDATE contact_details 
SET created_date2 = CONCAT('0', created_date2) 
WHERE LENGTH(created_date2) < 10
"
3233,45777,MySQL LEFT JOIN dates with order,"SELECT
    s.id,
    s.name,
    s.key,
    s.code,
    m.first_value_generated_at,
    m.last_value_generated_at
FROM sensors s JOIN 
   (SELECT
      sensor_id,
      MIN(generated_at) as first_value_generated_at,
      MAX(generated_at) as last_value_generated_at
    FROM
      measurements
    GROUP BY
      sensor_id
   ) m ON s.id = m.sensor_id
ORDER BY
    s.id
"
20134,2264,Creating dynamic sql statement,"OPEN P_REFCUR FOR
    'SELECT * FROM MYTABLE WHERE '||P_COLUMN||' = :val' USING P_VALUE;
"
19550,60541,Create a Summarized report using Mysql Query,"SELECT
  Cat,
  Sub_Cat,
  SUM(Amt) as total
FROM
  my_table
GROUP BY
  Cat,
  Sub_Cat
"
7137,59655,Separate SQL queries per word for dynamic pages?,"SELECT page_title, page_text, page_footer, page_blah 
FROM page_table
WHERE page_id = 123 AND lang = 'FR'
"
24677,7989,Select values from two tables using loop,"SELECT * 
FROM CategoryTable CT
    LEFT JOIN TextTable TT ON CT.Category = TT.Category
"
24408,73692,How to select MAX in a sub query in Linq to Sql,"MyTable
.GroupBy(row => row.ItemId)
.Select(grouping => 
    new
    {   
        ItemId = grouping.Key, 
        Version = grouping.Max(row => row.Version),
    });
"
12608,62266,Add rows to a table for each ID from a result-set,"INSERT INTO order_details (order_id, item_id, date)
SELECT UNIQUE
  order_id,
  1000027,
  getDate()
FROM order_details 
WHERE date = '01/01/2011'
  AND item_id <> 1000027
"
18263,52075,How to sort by count with postgresql?,"select 
    count(w.id) as mycount,
    w.company_id,
    c.company_name,
    c.city
from 
    companies c 
    left join workers w on 
        c.id=w.company_id 
group by 
    w.company_id,
    c.company_name,
    c.city
order by mycount desc;
"
34922,12512,MYSQL query INNER JOIN two table,"SELECT COUNT(*)
FROM students
WHERE class_id = 1
   OR class_id IN ( SELECT child_class_id
                    FROM child_classes
                    WHERE parent_class_id = 1
                  )
"
4780,69321,How do I define a stored procedure that returns table?,"create function MyFunction()
returns table
as
return (select  X.tTitle,Y.Description
    from X
    inner join Y
        on x.Id = Y.ID)
"
9440,18746,Regex for non ANSI-style joins?,"FROM [\s\S]*?,[\s\S]*?WHERE
"
5873,11908,SQL Joins Excluding Data,"select f.name, a.price, b.price
from Fruit f
left join ProduceStoreA a on a.Name = f.Name
left join ProduceStoreB b on b.Name = f.Name
"
11309,63244,SQL Server - Add a column to a table that calculates the age,"CREATE TABLE [dbo].[DateDemo]
(
    [MDate] [date] NULL,
    [age]  AS (datediff(day, [MDATE], getdate())) -- This is a computed column
);
"
25886,5599,Prioritize SQL WHERE clause,"SELECT *
FROM `table`
WHERE x = 'hello' OR x = 'bye'
order by (case when x = 'hello' then 1 else 2 end)
LIMIT 1'
"
26429,1872,How to create this SQL constraint,"ALTER TABLE ParentTable ADD 
   UNIQUE (ParentTableId);

ALTER TABLE ChildTable ADD 
   FOREIGN KEY (ParentTableId)
   REFERENCES ParentTable (ParentTableId);
"
30057,37104,Grouping by intervals,"select count(*), round(mynum/3.0) foo from mytable group by foo;
"
35233,40589,SQL using where contains to return rows based on the content of another table,"SELECT * FROM Stores s
WHERE EXISTS (
    SELECT * FROM Countries
    WHERE CONTAINS(s.Address1, Town) OR CONTAINS(s.Address2, Town)
)
"
4628,54729,improve or shorten sql query select Result on table [Date],"Select 
    ID, 
    FromDate, 
    ToDate,
    (case when convert(varchar(8),ToDate,112) <= convert(varchar(8),getdate(),112) then 'Expired'       
        when convert(varchar(8),getdate(),112) between convert(varchar(8),FromDate,112) and convert(varchar(8),ToDate,112) then 'Active'
        when convert(varchar(8),FromDate,112) >= convert(varchar(8),getdate(),112) then 'Inactive' end )'Result'
from Date
"
26744,68805,Is it possible to sort by lower case in MonetDB?,"select lower('Hello')
"
13934,5362,Select highest record of type per foreign key,"select
    l.*
from
    log l
    inner join (
    select
        max(log_id) as maxid
    from
        log
    group by
        domain_id,
        type
    ) l2 on
        l.log_id = l2.maxid
"
33764,52750,Count number of Rows with the same value in a Column,"SELECT book_count,a.author_id,a.fn, a.ln 
FROM author a
JOIN
(
  SELECT c.author_id,COUNT(*) book_count FROM book c
  GROUP BY c.author_id
) b 
ON a.author_id = b.author_id
ORDER BY book_count DESC LIMIT 1
"
35851,59016,In Oracle/SQL how to select rows where the value of the columns remained the same,"select budget
from your_table
group by budget
having count(distinct salary) = 1
"
1029,7878,Importing Data From Postgres Table into SQL Server view,"SELECT * FROM OpenQuery(PGEXAMPLE, 'select * from yourtable');
"
10458,66924,Inserting 0 in sql server by default,"DECLARE @OutputTbl TABLE (ID INT)
insert into Table(Name) values ('hello');

RETURN SCOPE_IDENTITY();
"
2280,8617,How do I Remove an entry which is more than 30 seconds old And has null value,"select * from dbo.ONE where LastLogin is NULL and  
                            datediff(ss,regdate,GetDate())<30
"
2794,40882,Automatically naming columns in MySQL,"sum(year(time_utc)=2013 AND month(time_utc)=1) as 'January 2013',
"
10167,51712,if user-defined type is null then select whole table,"select *
from tbl_something
where ( not exists(select 1 from @HaveItemList ) 
        or itemID in (select Defindex from @HaveItemList ))
"
4150,23526,Finding maxiumum in a group with a single select,"SELECT parent, 
       MAX(child) KEEP (DENSE_RANK FIRST ORDER BY date DESC) lastchild, 
       MAX(date) lastdate 
  FROM t
 GROUP BY parent
"
36612,60878,MySQL: Statement with 'LIKE' order by degree of resemblance,"SELECT * 
from table_name 
WHERE column_name LIKE '%inter%'
order by length(column_name) desc
"
26935,70739,Double join on a table on the same field,"SELECT 
  fly.codeAirport1, 
  a1.value as valueAirport1,
  fly.codeAiport2,
  a2.value as valueAirport2
FROM
  fly
LEFT JOIN 
  airports a1 ON a1.code = fly.codeAirport1
LEFT JOIN 
  airports a2 ON a2.code = fly.codeAirport2
"
33111,46019,"How to group by column, order by a different column, and limit each group to one row?","SELECT ns.Name, MAX(ns.Score) AS Score
FROM NameScore AS ns
GROUP BY ns.Name
ORDER BY ns.Name ASC
"
26109,26077,MySQL - next / previous ID wih cycling,"SELECT COALESCE((SELECT id FROM `foto` WHERE id<'$this->id' ORDER BY DESC id LIMIT 1),
       (SELECT  MAX(id) FROM `foto`))  AS `prev`,
       COALESCE((SELECT id FROM `foto` WHERE id>'$this->id' ORDER BY id LIMIT 1 ),
       (SELECT MIN(id) FROM `foto`)) AS `next`
"
1845,36013,SUM until value ordered by column,"Select
  Qty,
  Weight
From (
  Select
    Qty,
    Weight,
    Sum(Qty) Over(Order By Weight Desc Rows Between Unbounded Preceding And Current Row) As RunningQty
  From
    Test
  Where
    Product = 'PEN'
  ) a
Where
   RunningQty <= 200
"
33089,38154,How to call the stored procedure from select statment,"select p.*,
       stuff((select ',' + variant_name
              from variant v
              where v.productid = p.productid
              for xml path ('')
             ), 1, 1, ''
            ) as variants
from product p;
"
34612,32758,SQL: select rows where sum of a column satisfies a condition,";with  CTE1 as 
(
    SELECT 
        ID, Price, Price as CUM_SUM 
    FROM YourTable 
    WHERE ID=1

    UNION ALL

    SELECT 
        c.ID, c.Price, c.Price+c1.CUM_SUM as CUM_SUM 
    FROM CTE1 c1 INNER JOIN 
        YourTable c on c.ID=c1.ID+1
    WHERE 10 >c1.CUM_SUM
)
select * from CTE1
"
8487,71018,Load MIT-BIH Arrhythmia ECG database onto MATLAB,"load ('100m.mat')          % the signal will be loaded to ""val"" matrix
val = (val - 1024)/200;    % you have to remove ""base"" and ""gain""
ECGsignal = val(1,1:1000); % select the lead (Lead I)
Fs = 360;                  % sampling frequecy
t = (0:length(ECGsignal)-1)/Fs;  % time
plot(t,ECGsignal)
"
18054,21428,Tossing out certain result rows in a left join,"select a.deptno, a.deptname, min(b.empno)
from #dept a
left join #emp b
on a.deptno = b.workdept
group by a.deptno, a.deptname
"
34329,51273,return single value of first row when query return more than one row,"SELECT `ID` FROM tabel WHERE quiz_id = '$ID ORDER BY `ID` LIMIT 1
"
35960,55870,Unique combination in a table,"CREATE UNIQUE INDEX picture_homepage_uni ON picture (house_id) WHERE homepage;
"
15285,33690,How do I select clients with no valid email addresses?,"SELECT  *
FROM    tblclient
WHERE   intpkautoclientid NOT IN
        (
        SELECT  intfkclientid
        FROM    tblclientcontact
        WHERE   stremail > ''
        )
"
23355,4603,The inverse of a between select PSQL,"SELECT * 
FROM projects 
WHERE lastactivity NOT BETWEEN 2015-08-3 AND 2015-09-11;
"
24012,69202,Oracle DELETE statement with subquery factoring,"DELETE FROM tbl WHERE tbl.id IN
(WITH X AS (), Y AS (), Z AS ()
SELECT id FROM TBL
 WHERE TBL.ID IN (SELECT ID FROM Z));
"
10322,25860,UPDATE row when matching row exists in another table,"UPDATE A
SET A.[ResponseLetterSent] = 1 
FROM [LenqReloaded].[dbo].[Enquiry] A
WHERE A.[ResponseLetterSent] IS NULL 
    AND EXISTS ( SELECT * FROM [LenqReloaded].[dbo].[Attachment] B WHERE A.[EnquiryID] = B.[EnquiryID] )
"
27487,9853,Getting the whole row from grouped result,"select a.id, a.productid, a.price
from mytable a,
    (select productid, max(datechanged) as maxdatechanged
    from mytable
    group by productid) as b
where a.productid = b.productid and a.datechanged = b.maxdatechanged
"
2564,66257,Unique sorted list of column values from 2 tables,"select distinct email from contacts order by email // Your first query
union
select distinct email from customers order by email // Your second query
"
18250,29859,SQL Server: return placeholder / text if Left Join has no result,"coalesce(E.itemName, '---') as levelMain
coalesce(D.itemName, '---') as levelSub
"
18115,64071,Query between three tables,"select images.image_id, ... from images
inner join favs on images.image_id = favs.image_id
inner join users on users.user_id = favs.user_id
where users.user_id = [...]
"
6207,62383,How to convert column values to column names in teradata?,"select
   Name,
   max(case when Subjects = 'math' then 'Y' else 'N' end) as Math,
   max(case when Subjects = 'science' then 'Y' else 'N' end) as Science,
   max(case when Subjects = 'english' then 'Y' else 'N' end) as English
from tab
group by Name
"
7770,45563,How to multiple join the same table?,"SELECT isNull(l1.LocationName,'') AS LocationFrom, isNull(l2.LocationName,'') AS LocationTo, c.Duration 
FROM Connection c 
left outer JOIN Location l1 ON l1.LocationID= c.LocationIDFrom
left outer JOIN Location l2 ON l2.LocationID= c.LocationIDTo
"
20002,56977,Is there a possibility to change the order of a string with numeric value,"01
02
03
..
10
11
..
99
"
28351,1556,SQL select and match from multiple tables,"SELECT TOP 10000
  [Logs].[LogUID],
  [LogGroups].[LogUID],
  [LogGroups].[GroupUID]
FROM
  [log].[dbo].[Logs]
INNER JOIN
  [log].[dbo].[LogGroups]
    ON [Logs].[LogUID] = [LogGroups].LogUID ; 
"
14655,36953,sql - Select Statement where not exists a condition for each id ?,"SELECT ActivityID 
FROM   dbo.Activity As x
WHERE  NOT EXISTS (
         SELECT ActivityID
         FROM   dbo.Activity
         WHERE  DateEnd ='9999-12-31'
         AND    ActivityID = x.ActivityID
       )
"
27610,27830,Selecting items in MySQL database within a certain day," SELECT * FROM activities
 WHERE  date(timestamp) between start_date
 and DATE_SUB(start_date,interval x day))
"
4206,51810,assign a flag number to fixed number ofobservations,"data myData_flagged;
    set myData;
    flag = int((_N_-1)/20);
run;
"
9059,71847,MySQL REGEXP to SQL Server,"replace(replace(somefield,' ',''),' ','') in ('ASD','|ASD','|ASD|','ASD|')
and
somefield like '%ASD%'
"
34813,24738,"Updating tables from generate_series(int, int) function Postgres 9.0","update data 
   set ordering = t.rn
  from (select pk_column, 
               row_number() over (partition by clientid  order by pk_column) as rn
          from data
       ) t
where t.pk_column = data.pk_column;
"
30241,54319,Using aggregate functions in SQL query,"select Emp_ID, F_Name, count(Act_ID), avg(Percent_Complete)
from ATT_Table, Employee_Table where ATT_Table.Assigned_To_ID = Employee_Table.Emp_ID
group by Emp_ID, F_Name
"
33783,64422,Oracle query for displaying View meta data," SELECT O.Owner, O.object_name, C.ColumN_Name, C.Data_Type, O.Object_type, O.Object_Type, 
    AD.Referenced_name, AD.Referenced_Type
  FROM ALL_TAB_COLS c
  INNER JOIN ALL_OBJECTS O
    ON c.TABLE_NAME = o.object_name
    and C.Owner = O.Owner
  INNER JOIN ALL_DEPENDENCIES AD
    on AD.Name = O.Object_Name
    and AD.Owner = O.Owner
  WHERE  o.object_type = 'VIEW' 
  and O.owner = user
  ORDER BY c.table_name, c.column_id;
"
8062,27731,How do I select those records where the group by clause returns 2 or more?,"SELECT item_id
FROM items
WHERE type_id IN (
  SELECT type_id
  FROM items
  GROUP BY type_id
  HAVING COUNT(item_id) = 2
)
"
31730,68962,Returning Unique Values in Acess database with several columns,"SELECT Child, MIN(Parent) AS Parent, postnummer FROM (
SELECT barn.förnamn+' '+barn.efternamn AS Child, målsman.förnamn+' '+målsman.efternamn AS Parent, Målsman.postnummer as postnummer
FROM barn INNER JOIN Målsman ON barn.Postnummer = Målsman.Postnummer
WHERE (((Målsman.postnummer) Like '*23*'))
) a
GROUP BY child, postnummer
"
23761,3194,"Should I use ""RecordID"" as a column name?","Records - TABLE  
RecordID- int - pk  
SectionID int - fk
ApplicationID - fk  
Answer1 - text  
Answer2 - text  

Sections - TABLE
SectionId int - pk
SectionSequence int
"
19562,71264,mysql query to count number of times each Id has been used,"SELECT UserId, COUNT(*)
FROM badges
GROUP BY UserId
ORDER BY COUNT(*) DESC
"
24847,30331,Grant execute permission for a user on all stored procedures in database?,"CREATE ROLE <abc>
GRANT EXECUTE TO <abc>
"
24249,32297,SQLite regular Expressions regex get exact word by number,"^(\S+\s+){5}151
"
26272,34810,Count how many times a record appears,"=SUM(IIF(Fields!shloc.Value=""Test"", 1,0))
"
22695,22395,How can I select the record with the 2nd highest salary in database Oracle?,"select * from (
  select e.*, row_number() over (order by sal desc) rn from emp e
)
where rn = 2;
"
15188,32916,Access to Result sets from within Stored procedures Transact-SQL SQL Server,"INSERT INTO #Table (...columns...)
EXEC MySproc ...parameters...
"
21004,55072,How to combine two stored procedures,"create table #TableOne (BankCode nvarchar, Amt money)
create table #TableTwo (BankCode nvarchar, Amt money)

INSERT INTO #TableOne EXEC spDisplayBankConsolidate 'pname',@yr=2013
INSERT INTO #TableOne EXEC spDisplayBankConsolidate 'pname',@yr=2013,@equal='Eq'

select
    t1.BankCode, 
    t1.Amt as Opening, 
    t2.Amt as Closing
from #TableOne t1
inner join #TableTwo t2 on t1.BankCode = t2.BankCode
"
14086,5137,mySQL sum of two values in 2 different tables,"SELECT reference, SUM(quantity) AS total_quantity
FROM (
  SELECT reference, quantity
  FROM table_1

  UNION ALL

  SELECT reference, quantity
  FROM table_2) AS t
GROUP BY reference
"
29389,73296,mysql get last N records with MAX(date),"SELECT prh.*
FROM product_rate_history prh INNER JOIN
     (SELECT max(created_on) as maxco
      FROM product_rate_history
      WHERE prh.product_id = 16
      GROUP BY Date(created_on)
     ) prh2
     ON prh.created_on = prh2.maxco
WHERE prh.product_id = 16
ORDER BY prh.created_on DESC;
"
10238,8204,Combining two columns data into one using SQL Server 2008 R2,"select cola as columnName
from test
union
select colb as columnName 
from test
"
26082,29524,TIMESTAMP and SYSDATE,"timestampfield > current_timestamp - interval '1' hour
"
27574,72220,"SQL Server : select distinct, but indicate whether another column is null?","SELECT  Key1,
        CASE WHEN MAX(Scheduled) IS NULL
            THEN 'False'
            ELSE 'TRUE'
        END AS IsAnyScheduled
FROM    tableName
GROUP   BY Key1
"
11322,56909,Is it possible to use 1column extract to 4 column,"select id,
sum(case when status = 'present' then 1 else 0 end) as present,
sum(case when status = 'absent'  then 1 else 0 end) as absent,
sum(case when status = 'leave'   then 1 else 0 end) as leave
from tbchecked
group by id
"
32408,11370,ms-access selecting the problematic data,"select Col1, Col2 from MyTable
where Col1 not in (
    select Col1 
    from MyTable 
    where Col2 = 'ok'
)
"
31061,64513,Unable to add DOUBLE and VARCHAR columns with CAST(),"SELECT CONCAT_WS("""", ""$"", FORMAT(COALESCE(db.billing.cost_per_month, 0.00), 2)) AS ""Monthly Cost"",
  CONCAT_WS("""", ""$"", FORMAT(COALESCE(db.billing.additional_cost, 0.00),  2)) AS ""Additional Cost"",
  CONCAT_WS("""", ""$"", FORMAT(COALESCE(db.billing.cost_per_month, 0.00) AS DECIMAL(60, 2)) + COALESCE(db.billing.additional_cost, 0.00), 2)) AS ""Total Cost""
  FROM db.billing;
"
27198,52910,Inserting Duplicate rows by updating its value in MYSQl,"insert into tablename (Column1, Column2, Column3, Column4, Column5, Column6) 
select ""BD"",""AD2"",""C2"", column4,""P2"",""0"" 
from tablename where 
column4 in (select distinct column4 from test) 
and column4 not in (select distinct column4 from test where column5 = ""P2"");
"
22994,27134,"SPIP API SQL, left join on a custom table","CREATE TABLE IF NOT EXISTS `spip_random` (
  `id_random` bigint(21) NOT NULL AUTO_INCREMENT,
  `objet` varchar(25) NOT NULL,
  `id_objet` bigint(21) NOT NULL DEFAULT '0',
  `type` text NOT NULL,
  `date_picked` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  PRIMARY KEY (`id_random`),
  KEY `objet` (`objet`,`id_objet`),
  KEY `id_random` (`id_random`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;
"
9722,62513,Total ROWS selected in a LOOP ORACLE PL/SQL,"DECLARE
  strLast_ID  VARCHAR2(1000) := NULL;

  CURSOR CLEEVECTOR IS
    select regexp_substr(p_checkboxes,'[^,]+', 1, level) ID
      from dual
      connect by regexp_substr(p_checkboxes, '[^,]+', 1, level) is not null;
BEGIN
  FOR X IN CLEEVECTOR LOOP
    IF strLast_ID IS NOT NULL THEN
      -- code to process strLast_ID
    END IF;

    strLast_ID := X.ID;
  END LOOP;
END;
"
3790,67184,Oracle - Get MAX value from concatenated fields,"SELECT DATEINI||' '||HOURINI AS STARTED, TASK, TASK_CODE
FROM TB_TASKS WHERE TO_DATE(DATEINI||' '||HOURINI,'DD/MM/YYYY HH:MI:SS') IN 
  (SELECT MAX(TO_DATE(DATEINI||' '||HOURINI,'DD/MM/YYYY HH:MI:SS')) FROM TB_TASKS GROUP BY TASK_CODE) 
ORDER BY DATEINI DESC, HOURINI DESC;
"
10587,57911,Designing A Database For User Friendship,"( SELECT u.id, u.name
  FROM friendship f, user u
  WHERE f.user1 = 1 AND f.user2 = u.id )
UNION ALL
( SELECT u.id, u.name
  FROM friendship f, user u
  WHERE f.user2 = 1 AND f.user1 = u.id )
"
19294,65704,Replace/Assign a value in select statement,"select CASE paymentType WHEN 'p' THEN 'Part' WHEN 'f' THEN 'Full' END AS paymentType from paymentAccount
"
31592,7547,Is is possible to simplify this SQL UNION query?,"SELECT DISTINCT table2.id
FROM table1
INNER JOIN table2
ON ( table1.t_id = table2.id OR table1.t2_id = table2.id )
WHERE table1.id = 1
;
"
35407,7458,Set AVG result AS column,"SELECT ....
       (SELECT AVG(TagValueInteger) FROM tTagHistory) as DataExtraLineValue
       ....
"
12549,20100,Replace MySQL column data with new data?,"UPDATE forum_members SET group_id = 1;
"
38936,70562,how can I change values inside a variable?,"var1 := 'changed';
"
13285,54174,Partial change of value in SQL Server,"UPDATE [dbo].[TimeDim]
SET [dbo].[TimeDim].Date_Name =REPLACE(Date_Name, 'Tuesday', 'Tuesday in my language')
WHERE [dbo].[TimeDim].Date_Name LIKE '%Tuesday%'
"
36126,69888,MySQL bulk value insert,"LOAD DATA INFILE '/where/the/file/is'
INTO TABLE table (email)
FIELDS TERMINATED BY ','
LINES STARTING BY '';
"
31075,48121,SQL select values with or,"select a,b
from database
where source = 2

union

select c,d
from database
where target = 2
"
29047,43101,How can I write a query with 2 states?,"SELECT distinct SaleType.ID, SaleType.Code, SaleType.Name
 FROM Customer left join SaleType_Customer  
on CustomerID = Customer.Id 
,SaleType
where (SaleTypeID = SaleType.Id or SaleTypeID is NULL)
and Customer.ID= 4;
"
17228,74913,Oracle Format non date To Date in oracle,"TO_DATE('04082014', 'DDMMYYYY')
"
28494,57819,Column Row Transpose in Oracle Sql,"WITH t AS
     (SELECT 1001 studentid, 'john' NAME FROM dual
     UNION ALL
     SELECT 1002, 'kane' FROM dual
     )
SELECT * FROM (
SELECT studentid, NAME FROM t)
pivot (max(studentid) for name in ('john' John, 'kane' Kane));
"
35452,14914,Extracting a part of String in SQL Server,"declare @str varchar(100)

set @str='xxxxx(aaa)'

---- extracts xxxxx
select SUBSTRING(@str,0,CHARINDEX('(',@str)) 

---- extracts aaa
select SUBSTRING(@str,CHARINDEX('(',@str)+1,CHARINDEX(')',@str)-CHARINDEX('(',@str)-1)
"
30988,70608,SQL multiple join query,"SELECT ... 
FROM users u 
    JOIN players p ON u.player = p.name
    LEFT JOIN teams t ON p.team = t.id
WHERE u.id = ? 
"
26212,61571,Mixing string with query MySQL,"SELECT concat(
'SELECT c.name COLLATE SQL_Latin1_General_CP1_CI_AS colName, o.name COLLATE SQL_Latin1_General_CP1_CI_AS tableName, '''
, DB , ''' db FROM ' , DB 
, '.sys.all_columns as c INNER JOIN ' , DB 
, 
'.sys.all_objects o ON c.object_id = o.object_id WHERE c.name like ''%password%'' AND type = ''U'' UNION'
)  FROM DB 
"
20087,36851,SQL Table Valued Parameter - Default Value,"SELECT * 
FROM tableName
WHERE not exists(select * from @TVP)
    or RecordID IN (SELECT * FROM @TVP)
"
38228,49025,how to select the records whose several fields' combination will equal to a specific value,"select * from Table where (col1 = ""ab"" or col2 = ""ab"" or Col3 = ""ab"") 
and (col1 = ""bc"" or col2 = ""bc"" or Col3 = ""bc"")
"
37028,39890,SQL SELECT names LIKE $name but not exact same name twice,"SELECT custName, date, id 
FROM booking b
INNER JOIN
(
    SELECT max(date) MaxDate, custName
    FROM booking
    WHERE custName LIKE '%$s%'
    GROUP BY custName
) bm
  ON b.custName = bm.custName
  AND b.date = bm.maxDate
WHERE custName LIKE '%$s%'
ORDER BY b.date DESC
"
13390,62272,Data history tracking best practice,"CREATE TABLE history.tbl AS
  (history_id BIGSERIAL PRIMARY KEY, 
  event_time TIMESTAMP DEFAULT NOW(), 
  action CHAR(1), 
  LIKE public.tpl);
"
29881,57428,To find a solution to the problem with LEFT JOIN's IN in SQL,"SELECT questions.title, questions.question_id, tags.tag
FROM questions
LEFT JOIN tags
ON questions.question_id = tags.question_id
WHERE questions.question_id = 14
ORDER BY was_sent_at_time
DESC LIMIT 50;
"
32708,36863,compare counts of values in two tables,";WITH CTE1 AS
(
   SELECT ColName
          COUNT(ColName) AS NameCount
   FROM   Table1
   GROUP BY ColName
),CTE2 AS
(
   SELECT ColName
          COUNT(ColName) AS NameCount
   FROM   Table2
   GROUP BY ColName
)
SELECT * 
FROM   CTE1 C1
       FULL OUTER JOIN CTE2 C2
       ON C1.ColName = C2.ColName
WHERE  C1.NameCount <> C2.NameCount
"
35299,6045,How to get the cumulative column from my sales table?,"SELECT t1.*, sum(t2.amount)
FROM Table1 t1
INNER JOIN Table1 t2 ON t1.pid = t2.pid AND t1.month >= t2.month
GROUP BY t1.pid, t1.month, t1.amount
"
14621,28569,sql sum and excel sum difference,"USE [BudgetDb]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[tblItem](
[ItemCode] [varchar](4) COLLATE Arabic_CI_AS NOT NULL
[GrsPrice] [real] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF 
"
5251,22673,How to count the number of times an element appears consecutively in a table in Teradata?,"  select id,
         count(*)
    from (select x.*,
                 row_number() over(partition by id order by ord) -
                 row_number() over(partition by id, seg order by ord) as grp
            from tbl x) x
   where seg = 'B'
group by id, grp
order by grp
"
29134,37547,How to group by string ID in sql server 2008,"SELECT LEFT(ID, 8) AS nID,
       SUM(Value) AS tot
FROM your_table
GROUP BY LEFT(ID, 8)
"
17126,51575,Do some calculations of the values from two table and store it in one of the table,"UPDATE table1
JOIN table2 ON table1.email=table2.email
SET table1.value = (table2.result + table1.value) / 2
WHERE table1.email = ""abc@gmail.com""
"
33677,9541,"In redis, how do i remove keys?","for key in `echo 'KEYS user*' | redis-cli | awk '{print $1}'`
 do echo DEL $key
done | redis-cli
"
10763,38026,Query multiple values from one column,"select count (*) as NEWCOL
  from table1
  where COL1 = 'val1'
    and COL2 = 'val1'
    and (COL3 = 'val1' or COL3 = 'val2')
      ;
"
3555,17440,Wanted [ Example of SQL transactions ],"START TRANSACTION;
UPDATE BankAccount SET Balance=Balance-5 WHERE Owner='James';
UPDATE BankAccount SET Balance=Balance+5 WHERE Owner='Gord';
COMMIT;
"
5209,52073,Postgres: Get aggregation query based on multiple values in a column,"SELECT owner_id, count(partner_id),
       sum(case when level = 'gold' then 1 else 0 end) as gold,
       sum(case when level = 'silver' then 1 else 0 end) as silver,
       sum(case when level = 'bronze' then 1 else 0 end) as bronze
FROM owner_partner
GROUP BY owner_id;
"
22480,43064,SQL WHERE (contains or equal),"SELECT 
  posts.employee_id, 
  max(posts.month) as ""month"", 
  max(posts.year) as ""year""
FROM posts
WHERE 
 (posts.month = 9  AND posts.year  = 2013)  
 OR 
 (posts.month IS NULL AND posts.year  IS NULL)
GROUP BY posts.employee_id
"
18970,65400,Django forum database design,"class Thread(models.Model):
    subscribers = models.ManyToManyField(User)
    other attributes...
"
30068,19532,how can an unrelated table specified in FROM-clause affect the outcome of SUM()?,"SELECT SUM(OD.quantityOrdered)
 FROM OrderDetails OD JOIN Offices O 
 ON OD.somecol=O.someothercol
"
18474,17661,Which relation between database tables will be proper?,"ratings {
  id integer,
  userId integer, -- FK to users table
  referenceId integer, -- This is not a FK, but will contain the ID of the artist/album/song
  type char, -- a = album, A = artist, s = song
  rating int
}
"
31473,51711,Can i have multiple select but only return one result set,"IF EXISTS (SELECT 1 FROM A WHERE A.name = 'linköping')
BEGIN
    SELECT * FROM A WHERE A.name = 'linköping'
END
ELSE 
BEGIN
    SELECT * FROM A WHERE A.amount = 45
END
"
8486,20547,How to add up column data values when using GROUP BY,"SELECT A.CustomerNumber,
       A.Date,
       A.SalesDocNumber,
       A.Amount
       B.CCF
FROM TableA A
INNER JOIN (SELECT SalesDocNumber, SUM(CCF) AS CCF FROM TableB GROUP BY SalesDocNumber) B
ON A.SalesDocNumber = B.SalesDocNumber
"
4881,2883,Updating MySQL Blob Field,"UPDATE users u1
  JOIN users u2
    ON u2.user_id = 1
   SET    u1.user_permissions = u2.user_permissions
 WHERE  u1.user_id IN (3,4,5);
"
38252,60100,Incrementing counter on each duplicate in column,"SELECT 
  t.*, 
  @i:=IF(id=@id, @i+1, 1) AS num, 
  @id:=id 
FROM 
  t 
  CROSS JOIN (SELECT @i:=0, @id:=0) AS init 
ORDER BY id
"
28008,20755,JOIN table when selecting a max value of columns,"SELECT t.*
FROM
(
   SELECT
     *,
     ROW_NUMBER() OVER (PARTITION BY CommentID ORDER BY CreateDateTime desc) as rn
   FROM
     tbCommentBreadCrumb
     WHERE CommentStatusTypeID = 4
            AND    CreateDateTime <= {ts '2014-02-09 09:44:57'}
) t
JOIN tbComment c ON t.CommentID = c.CommentID
WHERE
   t.rn = 1
AND c.CommentIsLocked = 1
ORDER BY CommentStatusID DESC
"
38043,47438,Coordinates conversion,"ST_Transform(the_geom,4326)
"
27265,65635,SQL Group Select Query,"select t1.* from(select password, IpAddress 
from YourTable
group by password, IpAddress
having count(*) > 1) t2
join YourTable t1 on t1.IpAddress = t2.IpAddress
and t1.password= t2.password
"
3779,28277,Join multiple databases in one View -- SQL Server Mangement Studio,"SELECT columns
FROM database2.dbo.table 
"
10162,24758,Android SQL Database returns null a String field with data that is really large,"TwitterObjectFactory.getRawJSON(status);
"
31891,60890,Is it possible to use a nested select statement as a column that has multiple rows?,"select o.id, o.date, o.customer, o.status,
       group_concat(i.item_name, ' (item id ', i.item_id, ')' separator '
') as item_list
from order o inner join
     order_items i
     on o.id = i.order_id 
where o.status = 'open'
group by o.id, o.date, o.customer, o.status
order by date asc;
"
34386,65384,SQL join several tables based on latest entry in transaction table per join record,"SELECT
  eventTable.EvtName AS EvtD,
  transTable.TranAct AS LastTrans,
  userTable.UserName AS UsrNm,
FROM
  transTable
  INNER JOIN (
    SELECT evId, MAX(UID) uid FROM transTable GROUP BY evId 
  ) last ON last.evId = transTable.evId AND last.uid = transTable.uid
  INNER JOIN eventTable ON eventTable.evId = transTable.evId
  INNER JOIN userTable ON userTable.usId = transTable.usId
"
29688,25498,Convert or cast varchar MM/DD/YYYY data into datetime MM/DD/YYYY,"DECLARE @s DATETIME, @e DATETIME;

SELECT @s = CONVERT(DATETIME, '03/13/2013', 101),
       @e = CONVERT(DATETIME, '03/26/2013', 101);

SELECT <cols>
FROM dbo.table_name
  WHERE datetime_column >= @s
  AND datetime_column < DATEADD(DAY, 1, @e);
"
28616,60533,"In Oracle SQL, how to get the time for only this current week?","with dates as (select trunc(sysdate, 'mm') - 10 + level dt
               from   dual
               connect by level <= 40)
select dt
from   dates
where  dt >= trunc(sysdate, 'iw')
and    dt <= sysdate; -- only needed if the dates in the column could be beyond now.
"
22173,17695,"sql select, get cars which are due a job","select c.id,c.reg,c.type
from cars c
where not exists 
(
  select NULL
  from jobs j
  where j.id = c.id
  and j.date >= CURRENT_DATE - INTERVAL 3 WEEK
);
"
36123,64861,Query database for list of records intersecting with relational table,"select movie.name
from movie
join moviehascast mc on mc.movieid = movie.id
join cast on cast.id = mc.castid
where cast.name in (@actor1, @actor2)
group by movie.name
having count(1) = @numberOfActorsSearched
"
24492,27985,Mysql result not returned if count 0,"SELECT 
    levels.id,
    levels.name,
    COUNT(pages.id) as pageCount
FROM levels
LEFT JOIN page_levels
    ON levels.id = page_levels.level_id
LEFT JOIN wp_pages AS pages
    ON page_levels.page_id = pages.id AND pages.status = 'open'
GROUP BY levels.id
"
10563,75485,Insert into a temporary table and update another table in one SQL query (Oracle),"DECLARE
  id_table_t IS TABLE OF original.id%TYPE INDEX BY PLS_INTEGER;
  id_table id_table_t;
BEGIN
  UPDATE original SET valid='t' WHERE status='t'
  RETURNING id INTO id_table;
  FORALL i IN 1..id_table.COUNT
    INSERT INTO temp_table
    VALUES (id_table(i));
END;
/

SELECT * FROM original WHERE temp_table.id = original.id;
"
25734,52431,SQL how to implement if and else by checking column value,"SELECT 
    reservations.customerid, 
    reservations.roomno, 
    rooms.rate, 
    reservations.checkin_date, 
    reservations.billed_nights, 
    reservations.status,
    DateDiff(""d"", checkin_date, IIF(status = 'checkout', checkout_date, Now())) As DueNights
FROM 
    reservations 
    INNER JOIN      
    rooms  
    ON reservations.roomno = rooms.roomno;
"
28016,2236,SET XACT_ABORT ON not Worked in Create Procedure," CREATE PROCEDURE [Members].[MyProc](
 ........

 )
 AS
 SET XACT_ABORT ON
BEGIN
BEGIN TRANSACTION [MyProcCHK]
....
COMMIT TRANSACTION [MyProcCHK]
END
GO
"
39566,1010,Sum of different column in SQL,"select 
    ItemCode,
    SUM(case SelectedSupplier
        when 1 then Supplier1Price
        when 2 then Supplier2Price
        when 3 then Supplier3Price
    end) as SupplierPrice
from CanvassTable
group by ItemCode
"
34107,55471,SQL how to change string from eg. 01/06/2012 to 2012-06-01,"update table_a set field_b=concat(substring(field_b, 6, 4), '-', substring(field_b, 3, 2), '-', substring(field_b, 0, 2))
"
9066,56425,Oracle select with aggregate but not group by all columns,"SELECT e.firstname, e.lastname, max(ed.startdate), count(ed.departmentName)
  FROM employee e, employeeDepartment ed
 WHERE e.employee_id = ed.employee_id
 GROUP by e.firstname, e.lastname
"
5310,18906,Oracle Cursor with conditional Select statement,"SELECT * FROM Test1 WHERE condition = 't1'
UNION ALL
SELECT * FROM Test2 WHERE condition = 't2'
"
1192,54703,Which layout is better for this database table?,"CREATE TABLE `Questions` (
  `QuestionId` int(11) NOT NULL AUTO_INCREMENT,
  `AnswerId` int(11) DEFAULT NULL,
  PRIMARY KEY (`QuestionId`),
  KEY `FK_Answer` (`AnswerId`),
  CONSTRAINT `FK_Answer` FOREIGN KEY (`AnswerId`) REFERENCES `Answers` (`AnswersId`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `Answers` (
  `AnswerId` int(11) NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`AnswerId`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
"
55,1537,Inserting missing entries when doing a GROUP BY?,"SELECT fw.Year AS 'AYear',
       fk.Week AS 'AWeek',
       SUM(CASE WHEN t.startdate is not null then 1 ELSE 0 END)
FROM FakeWeeks fw
LEFT OUTER JOIN #TEMP t ON DATEPART(YEAR,startdate) = fw.year AND DATEPART(wk,startdate) = fw.week
GROUP BY DATEPART(YEAR,startdate),DATEPART(wk,startdate)
ORDER BY 1,2
"
4265,378,using the difference between two dates in a WHERE clause,"SELECT * FROM tableName WHERE TIMESTAMPDIFF(MINUTE,timestamp,NOW()) < 10
"
39218,66091,Conditional UPDATE in MySql,"UPDATE relation 
   SET name1 = CASE WHEN userid1 = 3 THEN 'jack' ELSE name1 END,
       name2 = CASE WHEN userid2 = 3 THEN 'jack' ELSE name2 END
WHERE (userid1 = 3 AND userid2 = 4) 
   OR (userid1 = 4 AND userid2 = 3);
"
31305,26070,MySQL DATE_FORMAT not outputting dates in correct order,"  SELECT * 
    FROM schedule 
   WHERE username='"".$_SESSION['username'].""' 
ORDER BY STR_TO_DATE(date, '%d/%m/%Y') ASC, start_time ASC
"
3708,3121,Put together two counters with different conditions,"SELECT a.id, a.name, count(*),
       sum(case when retweet = true then 1 else 0 end) as retweets
FROM authors AS a
INNER JOIN tweets AS t 
ON t.fromuser_id = a.id
GROUP BY a.id, a.name
ORDER BY count(*)
"
37746,48342,trying to figure out the best database schema,"  SELECT e.event_name,
         SUM(invited.contact_id) 'total_invited',
         SUM(confirmed.contact_id) 'total_invitations_confirmed'
    FROM EVENT e
    JOIN INVITATIONS invited ON invited.event_id = e.event_id
    JOIN INVITATIONS confirmed ON confirmed.event_id = e.event_id
                            AND confirmed.responded = 'Y'
GROUP BY e.event_id, e.event_name
"
9012,66780,Select sub-categories from category where sub-cat has multiple parents,"SELECT name, LEFT(parent, INSTR(@parent, ',')-1),
 SUBSTR(parent,INSTR(parent, ',')+1,LENGTH(parent)) from cat WHERE thisCat.ID (**unspecified**) IN (parent)
"
30092,61071,SQL get two items from latest four sets,"SET @rownum=0;
SET @last_group_id=0;
SELECT * FROM (
  SELECT gp.*,gs.*,@rownum:=IF(gp.set_id<>@last_group_id,1,@rownum+1) AS rn,
  @last_group_id:=gp.set_id FROM GalleryPics gp JOIN 
  (
    SELECT * FROM GallerySets WHERE set_status='online' 
    ORDER BY set_dateadded DESC LIMIT 4
  ) AS gs
  ON gs.set_id = gp.set_id 
  GROUP BY gp.set_id 
  ORDER BY gp.set_id,gp.pic_dateadded 
) tmp WHERE rn < 3
"
28167,37530,Create an aggregate checksum of a column,"select sum(crc32(some_column)) from some_table;
"
30234,71539,Conditional ORDER BY depending on column values,"SELECT TOP 1 FROM ... ORDER BY 
    (CASE WHEN column1 IS NULL THEN column2 ELSE column1 END) 
"
12814,11692,"SQL - find all the rows where the values are the same, or next biggest","select t.*
from table t
where value = (select min(value)
               from table t
               where value >= 6
              );
"
34450,5116,Group and count multiple fields at once,"SELECT ... 
FROM   ads WHERE  [search criteria]
"
37813,28423,is it possible to use ORDER BY column not in the GROUP BY?,"order by min([date_in])
"
20085,47503,Cannot generate records using Choose(Denali) and Recursive CTE,"Cast( Choose(((ID%4)+1),'India','Australia','England','Belgium') as varchar(100))
"
5597,46589,If string was too long then CONCAT() runs,"SELECT id,
CONCAT(SUBSTR(col, 1, 4), IF(LENGTH(col)>4,' ...','')) AS new_col 
FROM `table`
"
20022,70206,MySQL query with WHERE NOT EXISTS returning no rows,"SELECT c.course_id, c.course
FROM course AS c
    LEFT JOIN course_tutor_link AS ctl 
        ON c.course_id=ctl.course_id AND ctl.user_id=9
WHERE ctl.course_id IS NULL
"
12424,44743,SQL (any) Request for insight on a query optimization,"select a.* from a where a.id in (select id from b where b.id = a.id)

select a.* from a where a.id in (select id from b)
"
22479,51629,Select with SQL the oldest payment associated to a list of persons,"select *
from (
   select id_person, 
          payment_date,
          row_number() over (partition by id_person order by payment_date) as rn
   from payment
   where id_person ind (1,2,5,10)
) t
where rn = 1
"
38914,31388,Sql View to calculate column based on another column,"sum(case when t.credit then t.amount else -t.amount end)
"
14866,33292,Oracle range and subquery,"SELECT a.*
FROM schedule a
WHERE user_id = 0
  AND NOT EXISTS (
    SELECT NULL
      FROM schedule b
      WHERE b.user_id = 123456
        AND b.start_date <= a.end_date
        AND b.end_date >= a.start_date
  )
"
29252,54744,Compare data of one table with another based on date & Time,"select e.EventID,
       b.BookingID,
       b.TotalVisitors,
       b.BookingDate,
       b.Time,
       b.BookingCancelled
  from EventDatesReporting e
 inner join Bookings b
   -- On same date
    on e.EventDates = b.BookingDate
   -- Overlapping intervals
   and e.EventEndTime >= cast(b.Time as Time)
   and e.EventStartTime < dateadd (hour, 1, cast(b.Time as Time))
   -- Only if booking is not cancelled
   and b.BookingCancelled = 'false'
"
9808,28480,SQL join and get another column,"  SELECT user_games.*, games_steam.name
  FROM user_games
  JOIN games_steam 
  ON user_games.APPID = games_steam.APPID
  WHERE user_games.UID = '76561197996836099'
  GROUP BY user_games.APPID
  ORDER BY games_steam.name ASC
  LIMIT 0, 30
"
18593,13471,Insert into a destination table if the source value is not there in destination table sql,"MERGE table2 AS target
USING table1 AS source
    ON (target.email = source.email)  
WHEN NOT MATCHED BY TARGET 
    THEN INSERT (
        email, 
        country, 
        Phone
    ) VALUES (
        source.email, 
        source.country, 
        source.phone
    );
"
11634,48596,selecting distinct column name with respectives values,"select p_id, userid, min(the_date) from table group by p_id, userid
"
27196,73671,Given a date find the previous &/or current and next x# Dates in MySQL non-linear,"SELECT code, `date`, price
FROM code_prices
WHERE code = @inputCode
  AND `date` >=
        ( SELECT MAX(`date`)
          FROM code_prices
          WHERE code = @inputCode
            AND `date` <= @inputDate
        )
ORDER BY `date`
LIMIT 11
"
20498,56854,SQL Query - join help (Getting lots of results),"SELECT student_id, student_fname, student_lname, company.company_id, company_name, industry
FROM  `student` 
INNER JOIN company ON student.company_id=company.company_id
ORDER BY industry
"
38052,49528,MS Access Select top n query grouped by multiple fields,"SELECT StudentID, Year, Subject,  AVG(TestScore) AS AvgScore
  FROM
(
  SELECT StudentID, Year, Subject, TestScore
   FROM MyTable t
   WHERE TestID IN
  (
   SELECT TOP 3 TestID 
     FROM MyTable
    WHERE StudentID = t.StudentID
      AND Year = t.Year
      AND Subject = t.Subject
    ORDER BY TestScore DESC, TestID
  )
) q
 GROUP BY StudentID, Year, Subject
 ORDER BY StudentID, Year, Subject;
"
825,8255,Return an entire recordset x times (where x is the number of rows in another table),"SELECT * FROM TableA CROSS JOIN TableB
"
26173,58467,Is it an optimistic approach?,"update testtable2
set versioning_column += 1
where versioning_column = @versioning_column
"
22476,52190,Refactored SQL projection?,"CREATE FUNCTION UnifiedData (@LiveOnly bit, @ArchiveOnly bit)
RETURNS TABLE
AS
RETURN (
    SELECT columnA
           ,columnB
           ,columnC
    FROM (
        SELECT 'Live' AS Src, * 
        FROM Data
        WHERE @ArchiveOnly = 0

        UNION ALL

        SELECT 'Archive' AS Src, *
        FROM DataArchive
        WHERE @LiveOnly = 0
    )
)
"
9111,36231,"Mysql query to group by age, 3 months, 6 months, 9 months and 12 months","select (case when date >= date_sub(now(), interval 3 month) then '3month'
             when date >= date_sub(now(), interval 6 month) then '6month'
             when date >= date_sub(now(), interval 9 month) then '9month'
             when date >= date_sub(now(), interval 12 month) then '12month'
        end) as grp, sum(cost) as sumcost
from table t
where date >= date_sub(now(), interval 12 month)
group by grp;
"
27868,28883,How to get the month from a string in sql?,"select datepart(mm, cast('feb2008' as datetime))
"
38795,58637,If logic in SQL or Access queries,"select tab2.[employee name], 
       tab2.[employee id], 
       tab3.[chat info], 
       tab1.[manager id], 
       Nz(tab3.[team name], 'Unknown') as [team name]
    from (tab2
        left join tab1
            on tab2.[employee id] = tab1.[employee id])
        left join tab3
            on tab2.[manager id] = tab3.[manager id]
"
2647,14853,duplicate answers when predicate in more than one field SQL,"SELECT 
    a.*

FROM 
    addresses a
        JOIN
    individuals i
    ON a.AddressID = i.AddressID

GROUP BY
    a.StreetName, i.FirstName, i.Surname

HAVING
    COUNT(1) > 1
"
7222,23280,Conditionally branching in SQL based on the type of a variable," select case
     when ISNUMERIC(T.Value) then T.Value 
     else SomeConversionFunction(T.Value)
 end as SomeAlias
"
10565,30206,MySQL query co-author network,"Select a.authorid,
 b.authorid as coauthorid,
 count(a.textid) as count
From authorship a
Inner join authorship b
On a.textid = b.textid
Where a.authorid < b.authorid
Group by a.authorid,b.authorid
"
9025,40141,query from database where aliases result is same with user input,"select *
from (
    SELECT callid, 
           CASE 
              WHEN callid like '%CA%' THEN 'call' 
           END as channel
   from call 
) t
where channel like '%$VEChan%';
"
10780,21205,MySql INSERT ignores DISTINCT selection,"CREATE TEMPORARY TABLE myTemp
  (SELECT DISTINCT a.test as test FROM runtable a 
  WHERE a.test = ""awesome_testcase""
  AND NOT EXISTS(SELECT b.test FROM workloadtable b WHERE b.test = a.test));

INSERT INTO workloadtable (test)
SELECT test FROM myTemp

DROP TEMPORARY TABLE myTemp
"
23198,54127,Multiple inserts with composite type,"INSERT INTO episodes (id, title, release_date)
VALUES 
((1, 1, 58811), 'Pilot', null),
((1, 2, 58811), 'Vector', null);
"
26754,21414,Need help with query,"SELECT 
  *
FROM 
  chatbox
WHERE
  sender=? or receiver=?
"
16858,21861,SQL Server 2008 Find the min date,"SELECT MIN([date]) 
FROM [DAY] 
WHERE instruction = '-1' 
  AND grade = '14' 
GROUP BY calendarID
       , structureID
"
5560,10450,returning select query with row count,"select  row_number() over (order by FLD_A,FLD_B) as POS,
        FLD_A,
        FLD_B 
    from My_Tbl 
    where FLD_C='p'
"
29560,25024,Sybase Multiple Substrings Search,"AND (entry_txt in ('fight', 'grab', 'push', 'strike', 'hit')
     OR entry_txt like 'confron%'
     OR entry_txt like 'aggres%'
     OR entry_txt like 'assa%')
"
34662,34307,Select columns other than the one specified in GROUP BY clause,"SELECT MAX(c.name), COUNT(distinct e.student_id)
FROM Enrollment e
INNER JOIN Course c ON c.id = e.course_id
GROUP BY e.course_id, c.name
"
26512,27266,SQL statement for value from multiple field,"Select .....
from ....
where (Status = @Status or @Status is null)
and (Created=@Created or @Created is null)
and (Release = @Release or @Release is null)
and (Date = @Date or @Date is null)
"
10036,52762,How to filter rows based on group values in SQL?,"SELECT *
FROM tab
QUALIFY
  -- #1, only PASS
  (     SUM(CASE WHEN result <> 'PASS' THEN 1 ELSE 0 end) 
        OVER (PARTITION BY serialnumber) = 0 
    AND ROW_NUMBER() 
        OVER (PARTITION BY serialnumber
              ORDER BY test) = 1
  )
 OR
  -- #2
  (     SUM(CASE WHEN result <> 'PASS' THEN 1 ELSE 0 end) 
        OVER (PARTITION BY serialnumber) > 0 
    AND result_ <> 'PASS'
  )
"
11618,54893,How to create a list with the n last months in sqlite?,"WITH RECURSIVE months(m) AS (
  SELECT strftime('%Y-%m', 'now')
  UNION ALL
  SELECT strftime('%Y-%m', m || '-01', '-1 month')
  FROM months
  LIMIT 5
)
SELECT m FROM months;
"
24291,68725,Selecting from two table using joins,"SELECT f.favColorID,
c.Color,
CASE WHEN c.colorid = f.colorid THEN 'YES' ELSE 'NO' END IsFavorite
FROM tblColours c, tblFavColours f
ORDER BY 1
"
36973,37180,How to get EF to use an entity as a parameter for an import stored procedure?,"public static class DbContextExtensions
{
    public static SomeType DoTheFoo(this DbContext context,Foo foo)
    {
       return context.ImportedSproc(foo.num1, foo.num2, foo.num3);
    }
}
"
11843,8984,Db schema for a mail client,"messageId    Int
emailAddress varchar(max)  [translates to varchar(8000)]
subject      varchar(1000) [I think this is the max]
body         varchar(max)  [translates to varchar(8000)]
dateSent     datetime
"
28122,58619,Set text of text item dynamically from table in oracle forms,"for v_rec in c_curs_det
loop
  COPY('Some value', v_rec.detail);
end loop;
"
36191,4634,id field is not int and CakePHP,"    echo $this->Form->input('id', array('type' => 'text'));
"
20259,52032,Join two table without foreign key in an insert statement,"declare @a table (name varchar(50),age int)
Declare @b table (id int)

insert into @a 
select 'jack',13
union select 'hanna',28

insert into @b
select 1
union select 2

Select id,name,age from
(
Select a.* ,ROW_Number() over (order by name) as rn
from @a a
)x
JOIN
(
Select b.* ,ROW_Number() over (order by ID) as rn
from @b b
)y
ON x.rn=y.rn
order by ID
"
14207,36318,Retrieve table names from views using PL/SQL script,"SELECT
  * 
FROM
  sys.dba_dependencies 
WHERE referenced_type = 'TABLE'
START WITH ""NAME"" = 'VIEW_NAME_IN_QUESTION'
CONNECT BY PRIOR REFERENCED_NAME = ""NAME"" AND ""TYPE"" = 'VIEW';
"
26344,61978,SELECT same data from same table just with conditions as different columns,"SELECT
    CASE WHEN amount > 0 THEN amount END as posAmount,
    CASE WHEN amount < 0 THEN amount END as negAmount,
    correction
FROM booking
"
13928,41368,How to get null value when summing a column has a null value,"SELECT (case when count(*) = count(oran*deger)
             then SUM(oran*deger/100)
        end)
FROM @tablo;
"
20468,27902,Configuring Postgres database with Liferay,"# PostgreSQL
#
#jdbc.default.driverClassName=org.postgresql.Driver
#jdbc.default.url=jdbc:postgresql://localhost:5432/lportal
#jdbc.default.username=sa
#jdbc.default.password=
"
19568,1525,Finding First Occurrence Based on Multiple Criteria,"select t.*
from table t
where t.sale_date = (select min(t2.sale_date)
                     from table t2
                     where t2.id = t.id and t2.sale_cnt > 0
                    );
"
7128,67726,How to disable the format characters in MySql searching results?,"mysql -u<user> -p<userpwd> --silent <dbname>
"
29942,11394,SQL % Character,"SELECT * FROM t_package   
WHERE t_package.PackageFlags LIKE '*VCCFG=Use_Case_View;'  
"
34183,15904,SQL Running Percentage,"SELECT x.*
     , SUM(y.choice)/COUNT(*) * 100 pct 
  FROM film_choice x 
  JOIN film_choice y 
    ON y.film <= x.film 
 GROUP 
    BY x.film;
"
22459,54409,Return row counts for field that appears more than x times,"SELECT StateCode, Count(*) As StateCodeCount
FROM ZipCodeTerritory
Group By StateCode
HAVING COUNT(*) > 300
"
20555,61211,How to have SQL increase ID by 1 on a column using an insert statement,"INSERT INTO tableA (externalid, tableuiduid) 
select ISNULL(MAX(EXTERNALID) + 1, 0), newid()
from tableA;
"
34366,71095,Is it possible to merge these tables into one array value,"select ct.id 
from snm_content ct
inner join snm_fieldsandfilters_elements fe on fe.item_id = ct.id
inner join snm_fieldsandfilters_connections cn on cn.id = fe.element_id
"
16013,20059,SQL Server - Counting a column with conditions and also outputing percentages,"select [house],
       sum(case when person_age > 35 then 1 else 0 end) as [older than 35],
       avg(case when person_age > 35 then cast(1 as float) else 0
           end) as [percent older than 35]
from cabins
where move_in_date >= '2014-02-01' and move_in_date <= '2014-03-01'
group by [house];
"
18636,16348,MySQL 3 column query return duplicates,"select
*
from relationships T1
INNER JOIN relationshipsT2 on t1.x_Id   = t2.x_Id  where
((T1.y_Id = 1 AND T1.z_Id = 1) AND (T2.y_Id  = 2 AND T2.zz_Id= 3))
"
244,370,How convert '1305' char to the time format,"where    from_time < '0920'
         and to_time > '0850'
"
12406,24090,Data modeling. To split into separate tables or use role based authorization?,"    user_id       part of the primary key
    space_id      the rest of the primary key
    role          1 = contributor to the space, 2=member, 3=admin 4=owner etc
"
38242,23355,How to show 0 when values don't exists?,"select coelesce(p.client, '0') client, coalesce(p.sex,0) sex, coalesce(p.city_id, 0) city_id
from cities c
left join people p on p.city_id = c.id
"
32321,66310,Is there any way to have the JBoss connection pool reconnect to Oracle when connections go bad?,"<check-valid-connection-sql>select 1 from dual</check-valid-connection-sql>
"
37637,30381,easier way to select row matching condition having maximum for a certain column,"SELECT ID, NAME, rn
  FROM (SELECT id, NAME, rank() over(ORDER BY LVL DESC) rn 
          FROM my_table 
         WHERE NAME LIKE 'A%')
 WHERE rn = 1
"
20215,41668,Sql - Simple query with count,"select a.id, (select count(1) from b where id=a.id) cnt from a;
"
10822,272,How can I make an SQL statement that finds unassociated records?,"SELECT countryID, countryCode 
  FROM tblCountry 
  WHERE countryID NOT IN ( SELECT countryID FROM tblProjectCountry )
"
25864,61416,SQL Group By with possible subquery?,"select *
from tblUser t1
inner join (
  SELECT UserId
  FROM tblUser 
  GROUP BY UserId
  having count(distinct UserName) > 1
) t2
  on t1.UserID = t2.UserID
"
30622,1008,view duplicate data in sql statement,"Select *
From participants
Where nokp in
(
  Select nokp
  From participants
  Group by nokp
  Having count(*) > 1
 )
"
2628,29142,Insert multiple rows from multiple rows,"INSERT INTO GiftsToCustomers (GiftId, CustomerId)
SELECT      GiftId, CustomerId
FROM        Gifts
CROSS JOIN  Customers
"
37089,16883,Renumber duplicates to make them unique,"drop sequence if exists s;
create temporary sequence s;
select setval('s', (select max(cast(code as integer)) m from t));

update t
set code = i
from (
    select code, grid, nextval('s') i
    from (
        select code, max(grid) grid
        from t
        group by code
        having count(*) > 1
        order by grid
    ) q
) s
where
    t.code = s.code
    and
    t.grid = s.grid
"
7090,34057,Reputation Formula - Best Approach,"function calc_rep (i_comments in number, i_posts in number, i_ratings in number,
                  i_followers in number, i_following in number, i_badges in number,
                  i_connections in number) return number deterministic is
...
end calc_rep;

function get_rep_for_user (i_user_id in number) is
  v_comments ....
begin
  select .....
  calc_rep (v_comments...)
end get_rep_for_user;
"
2142,2684,Create a view that shows from which table content comes,"SELECT o.date, 'Output' AS type, ol.amount AS amount_out, NULL AS amount_in
FROM   outputline ol
JOIN   output     o USING (outputid)

UNION ALL
SELECT i.date, 'Input', NULL, il.amount
FROM   inputline il
JOIN   input     i USING (inputid)
ORDER  BY date, type;
"
6452,33092,Many Replace after each other in SELECT statement,"replace(replace(replace(varchar2, 'x', '1'), 'y', '2'), 'z', '3')
"
3749,43149,SQL Server - 2008 Column Data Type,"CASE WHEN F.END_DATE IS NOT NULL OR F.REASON IS NOT NULL  THEN 0 ELSE 1 END Enrolled' 
"
373,34387,how do i use this select,"Update MSLStore1_Products set ExternalCoode = right(MSLStore1_Products.productcode, len(MSLStore1_Products.productcode) - LEN(supplier.prefix) )
From 
MSLStore1_Products , supplier WHERE MSLStore1_Products.suppid = 9217 AND MSLStore1_Products.SgpID = 123 and supplier.supno = MSLStore1_Products.suppid 
"
37774,66665,Entity Framework 6 composite key (DateTime + foreign key),"public class MeasuredValueConfiguration : EntityTypeConfiguration<MeasuredValue>{
    public MeasuredValueConfiguration()
        : base() {
        /* ... */

        HasKey(e => new {e.MeasuringPointID, e.Id});           

        /* ... */
    }
}
"
32151,60063,Date Range SQL Query,"SELECT Schedule_ID 
FROM TBL_SCHEDULE 
WHERE CARD_NO = 1000058 
  AND yourDate BETWEEN FromDate AND ToDate
"
35189,39527,"MySql, need a query to retrieve multiple fields from tables in one row","SELECT id, name address, GROUP_CONCAT(phone) as phones
FROM EmpInfo
JOIN EmpContact USING (id)
GROUP BY id;
"
31453,40537,fetching upto a limited condition in oracle query,"      SELECT * FROM (select * from users order by joined DESC) u where rownum<=5
"
25917,50381,Oracle give more priority to like %term than %term%,"select city_desc from mst_city where upper(city_desc) like '%BRANCH%'
order by case when upper(city_desc) like 'BRANCH%' then 1 else 2 end
"
39001,45920,Search and replace part of string in database,"update VersionedFields
set Value = replace(value,'<iframe','<a>iframe')

update VersionedFields
set Value = replace(value,'> </iframe>','</a>')
"
26432,6452,SQL one value in list of values occurs at least once in list," Select * from companylist c left join citylist t on match_zips(c.zips,t.zips)>0
"
35151,51885,Select rows with the same count in a column from a table,"SELECT Name
FROM Person
WHERE SSN <> 1
GROUP BY Name
HAVING COUNT(PetName) = (SELECT COUNT(PetName) FROM PERSON WHERE SSN='1')
"
29452,68722,Column names in each table must be unique. while copy table data from one table to another in sql server,"select k.transactid, k.Hbarcode into Khanger2013
 from KHanger_tbl k
inner join Transaction_tbl t
on t.transactid=k.transactid
where t.dtime <='2013-12-30
"
29659,36115,Is this sql query valid (many-to-many relation),"select concat(professor.name, "" "", professor.surname) as ""Professor"",
       subject.name as ""Subject""
from professor
inner join professor_subject
    on professor.id = professor_subject.professor_id
inner join subject
    on professor_subject.subject_id = subject.id
"
6544,33161,Update Column where two values sum to equal zero in SQL Server,"UPDATE tContractsInTransit
SET Paid = 'true'
FROM
tContractsInTransit cit
INNER JOIN
(SELECT CtrlNo
,SUM(Amt)/COUNT(DISTINCT CtrlNo) AS Tot
 FROM tContractsInTransit
    GROUP BY CtrlNo 
   HAVING SUM(Amt)/COUNT(DISTINCT CtrlNo) = 0) t
   ON cit.CtrlNo = t.CtrlNo
"
2184,75535,Limit the range of numeric values of field,"CREATE TABLE YourTable
(
    Id int not null primary key,
    Year int not null check (Year >= 1995 AND Year <= 2016)
)
"
36579,5415,How to use update trigger to update another table?,"UPDATE table2
SET    table2.annualyear = inserted.intannualyear
FROM   table2
       JOIN inserted
         ON table2.id = inserted.id  
"
39431,71090,MySql - get days remaining,"SELECT *
FROM tblPremiumListings
WHERE created_date + INTERVAL `days` DAY >= CURDATE()
"
25336,67945,oracle materialized view refresh time,"SQL> alter session set nls_date_format = 'yyyy-mm-dd :hh24:mi:ss';

Session changed.

SQL> select sysdate from dual;

SYSDATE
--------------------
2008-12-19 :12:18:28

SQL> select (round(sysdate) + 1/24) + 1  from dual;

(ROUND(SYSDATE)+1/24
--------------------
2008-12-21 :01:00:00
"
21739,56778,Counting all the posts belonging to a category AND its subcategories,"SELECT c.name, COUNT(DISTINCT p.PID) as postCount 
FROM categories AS c 
LEFT JOIN categories AS c2
    ON c2.parent = c.catid
LEFT JOIN categories AS c3
    ON c3.parent = c2.catid
LEFT JOIN posts AS p 
    ON c.CATID = p.category
    OR c2.CATID = p.category
    OR c3.CATID = p.category
WHERE c.parent = '0' 
GROUP BY c.CATID, c.name
ORDER BY c.name ASC
"
4297,21170,sql server - join on null values,"Select hl.*, hls.colorCode, hls.bold 
From HeaderLinks hl
Left Join HeaderLinkStyles hls on hl.LinkId = hls.linkID
order by row asc,[column] ASC
"
739,54701,Trying to copy data from Impala Parquet table to a non-parquet table," CREATE TABLE <text_table> 
     AS 
 SELECT * 
   FROM <parquet_table>
"
32490,70912,Equivalent of SQL SELECT in Pig,"selected = FOREACH AB GENERATE science_score, math_score;
"
38577,32207,Why cannot use compiled Insert statement in Slick,"val i = someQuery.insertInvoker
i.insert( foo )
i.insert( bar )
"
21517,60657,Delete Rows in one table based on row values in this and another table,"DELETE  a
FROM    table1 a
        INNER JOIN table2 b
            ON  a.Stall = b.Stall AND
                a.Fruit = b.Fruit
"
29375,41091,SQL count the number of foods supplied by each supplier even if they did not supply anything,"SELECT 
    a.supplier_id ,
    b.supplier_name ,
    count(a.supplier_id) AS ""number of foods"" 
FROM  
    l_suppliers b , 
    LEFT JOIN  l_foods a ON  a.supplier_id = b.supplier_id  
    GROUP BY  b.supplier_id ,b.supplier_name 
    ORDER BY  b.supplier_id
"
22665,47493,Most efficient way to run an encapsulated query,"select distinct id_user
from table1 t1 join
     tmp_table tmp
     on t1.foo = tmp.foo;
"
25076,28791,SqlServer:Select and group by Month,"SELECT MONTH (pc.createTime) AS MONTH,
       SUM(CASE WHEN pl.partsModelID = 21028 THEN partsModelSum END) AS totalSum
FROM partscontract pc LEFT JOIN
     partscontractlinkmodel  pl
     ON pl.partsContractID = pc.partsContractID AND
        pc.companyID = 8 AND
        pc.createTime BETWEEN '2013/11/01 00:00:00' AND '2014/04/30 23:59:59'
GROUP BY
    MONTH(pc.createTime)
ORDER BY totalSum DESC;
"
16989,1312,MySQL - Get last message from all users,"SELECT
  u1.displayname AS SenderName,
  m.date_sent,
  ...
FROM messages AS m1
INNER JOIN users AS u1 ON m1.sender_id = u1.id
(
   SELECT sender_id, MAX(dateSent) MaxDate
   FROM messages 
   GROUP BY sender_id
   WHERE receiver_id = 4
) AS m2  ON m1.sender_id = m2.sender_id
        AND m1.datesent  = m2.maxdate
"
7514,27061,"Want to select data from two tables, where i need to count a column and join","select b.id, b.name, count(w.name) as Workers
from block b
left join block_worker w on w.block_id = b.id
group by b.id, b.name
"
26054,41323,How to format and print a result of sql query,"SELECT employer, COUNT(*)
FROM yourTable
GROUP BY employer
HAVING COUNT(*) > 1
"
27549,18528,Oracle 11g - Sql with TimeStamp,"select * 
 from Evrak 
Where Evrak.Product_Date  = TO_TIMESTAMP ('25.04.2012:12:00:00','DD.MM.YYYY:HH24:MI:SS')
"
23631,38475,How can I select only the first distinct match from a field in MySQL?,"SELECT name, min(hash) hash
FROM my_table 
WHERE name LIKE '%An%' 
GROUP BY name;
"
2955,3564,Update statement using with clause,"update mytable t
set z = (
  with comp as (
    select b.*, 42 as computed 
    from mytable t 
    where bs_id = 1
  )
  select c.computed
  from  comp c
  where c.id = t.id
)
"
33014,51286,"SQL query with limit on rows from one table, not the result set","SELECT t3.a, t2.b FROM (SELECT * FROM t1 LIMIT 5) t3
LEFT JOIN t2 ON ...
"
32287,26474,Getting a count of two different sets of rows in a table and then dividing them,"select
    (select count(*) from tasks where completed = 1) /
    (select count(*) from tasks where completed = 0)
from dual
"
39085,11050,Display only the largest count in a group by statment,"select t.*
from (SELECT COUNT(type) AS booking, type
      FROM booking b join
           room r
           on r.rno = b.rno AND r.hno = b.hno
      GROUP BY type
      order by count(type) desc
     ) t
where rownum = 1;
"
28899,41568,Grant privileges on database to a user,"BEGIN
  FOR x IN (SELECT *
              FROM dba_tables
             WHERE owner = <<name of schema>>)
  LOOP
    EXECUTE IMMEDIATE 'GRANT select, insert, delete ON ' || 
                         x.owner || '.' || x.table_name ||
                         ' TO <<username>>';
  END LOOP;
END;
"
24696,59767,Finding first and last customer movement SQL Server - tips?,"SELECT *
FROM
( SELECT *, ROW_NUMBER() OVER (PARTITION BY cust_no ORDER BY sales day ASC) as seq1,
            ROW_NUMBER() OVER (PARTITION BY cust_no ORDER BY sales day DESC) as seq2,
) T
where T.seq1 =1 or T.seq2 =1
"
22188,48408,"Sql Server is not combining the results , it is becoming mutually exclusive","select * from @billingEdit
where (HCPC_CODE like '%LCS%' and ALLOWED_AMT > 0)
or (isnull(HCPC_CODE,'') not like '%LCS%');
"
2352,4955,self join mysql complex query,"SELECT c1.id
FROM call_charges c1
LEFT JOIN call_charges c2
ON c1.id = c2.retry_id AND c2.is_paid = 1
WHERE c1.transaction_bid IS NOT NULL
AND c1.is_paid = 0
AND c2.id IS NULL
AND c1.retry_id IS NULL
"
8376,13794,Inverting foreign key effectivly with SQL,"CREATE INDEX husband_id_index ON wife (husband_id);
REINDEX INDEX alt_md_index; -- not sure if this isn't required
"
34036,20210,How do I declare a multi-column PK in MySQL,"CREATE TABLE table_name 
(
    c1 INT NOT NULL,
    c2 INT NOT NULL,
    PRIMARY KEY (c1, c2)
)
"
35480,18674,using order by with union in inner select queries,"select colname,1 as OrderCol from table where <cond1> 
union select colname,2 as OrderCol  from table 
where <cond2>  
order by OrderCol
"
39187,3746,date time difference get hour:minutes:seconds,"SELECT convert(varchar(10),DATEDIFF(hour,t.Paydate,t.DelDate))+'hr:' 
      +convert(varchar(10),DATEDIFF(minute,t.Paydate,t.DelDate)% 60) + 'mnts:' 
      +convert(varchar(10),DATEDIFF(SECOND,t.Paydate,t.DelDate)% 60) +'seconds'
       AS 'DIFF IN HH:MM:SS'
FROM Transaction_tbl t 
WHERE t.transactID=19  
"
16578,56849,SQL WHERE Temporary Column,"SELECT c.CategoryName + ' (' + cast(count(ic.CategoryId) as varchar(255)) + ')' AS CategoryName,
       count(ic.CategoryId) AS NumPhotos,
       c.Slug, c.ParentCategoryId, c.Id
FROM Categories c INNER JOIN
     ItemCategories ic
     on ic.CategoryId = c.Id
GROUP BY c.CategoryName, c.slug, c.ParentCategoryId, c.id
ORDER BY ParentCategoryId DESC;
"
35881,15538,How do / Can you query a backup device?,"USE [master]

RESTORE DATABASE [TestDB] FROM  DISK = N'C:\ProductionDB.bak' 
WITH MOVE N'ProductionDB' TO N'C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\DATA\TestDB.mdf',  
MOVE N'ProductionDB_log' TO N'C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\DATA\TestDB_log.ldf', 
REPLACE

GO
"
5619,39290,SQL replace specific date in a select,"

SELECT 
   productname, 
   DATEADD(YEAR, 42, datediff(day, MIN(case when year(DateAdded) = '1970'
				then  dateadd(YY,CEILING(datediff(YY,DateAdded,'1/1/2012')),DateAdded)
				else a  end ),getdate())/nullif(SalesToDate,0)) as [Days For A Sale] 
   FROM TABLE"
7130,25227,SQL average value for multiple rows,"SELECT 
       table1.A,
       table1.B,
       table1.C,
       table1.D,
       avg(table4.value) value,
       avg(table4.e)     e,
       avg(table4.f)     f,
       avg(table4.g)     g
  from ...
 group by table1.A,
          table1.B,
          table1.C,
          table1.D
"
29024,74078,Getting the most recent posts from all users using Entity Framework/LINQ,"IEnumerable<Post> posts = db.Posts
    .GroupBy(p=>p.UserID)
    .Select(p=>p.OrderByDescending(q=>q.DatePosted).First());
"
15699,30227,compare all fields in access using vba/sql,"Sub exampleSQLComparison()

    Dim rs1 As DAO.Recordset
    Dim rs2 As DAO.Recordset

    '.... set those recordsets via SQL statements

    For Each f In rs1.Fields
        If rs1.Fields(f) <> rs2.Fields(f) Then
            Debug.Print ""Mismatch found for "" + f
        End If

    Next f

End Sub
"
21909,45947,join query on one-to-one Grails domain using GORM with parameters,"String filter = ""hachiko""
def hero = Hero.createCriteria().list {
    familiar {
        like('name', filter)
    }    
}
"
29456,33537,SQL Select First Name and Doesn't Contain Last Name Matching,"select p.*
from tablPerson p
where not exists (select 1
                  from tablPerson p2
                  where p2.LastName = 'Smith' and p2.FirstName = p.FirstName
                 );
"
18775,39761,Pivot Query SQL Duplicating rows,"SELECT *
 FROM (
  SELECT regno,eventb,timec,rfid from  @tmpTable2
 ) AS SourceTable
 PIVOT
(
max(timec)
FOR eventb
IN (
[Veh Reg Time],[Fitness ok time],[RFID Issue time],[MG-IN],[WB IN],
[MG-OUT],      [WB OUT]
)
) AS PivotTableAlias
"
7194,66267,Semivariance of variable,"SELECT COUNT(*)
FROM
Table1
WHERE Value < (SELECT AVG(Value) FROM Table1)
"
34905,42716,SQL troubling exam query,"SELECT a.Fo_Name as 'Larger', 
       b.Fo_Name as 'Smaller',
       a.fo_Comp
FROM Forest a
INNER JOIN Forest b
   ON a.fo_Comp= b.fo_Comp
   AND a.fo_loc = b.fo_loc
   AND a.fo_name <> b.fo_name
WHERE a.fo_size > b.fo_size
"
28450,67549,User-specific database records,"WHERE User_ID = @User_ID 
"
35992,66539,Counting rows from a GROUP BY query using an index,"SELECT COUNT(DISTINCT artist)
FROM media
"
3672,47106,SQL query with distinct values while using inner join,"select lotid,
max(worker) as worker
max(trsdate) as max_date
from test
inner join test1
on test.lotid=test1.lotid
group by lotid
"
7060,53994,Using SELECT in this SQL statement isn't working,"SELECT original_name FROM `renamed` WHERE `key`='fb166'
"
15603,20148,Can SQL query do this?,"select n.id as new_id
      ,a.id as archive_id
      ,record_id
      ,n.record_date as new_date
      ,a.record_date as archive_date
      ,DateDiff(a.record_date, n.record_date) as days_between
  from audit n
  join audit a using(record_id)
 where n.description = 'New Sub'
   and a.description = 'Archieved';
"
32407,73869,Compare two tables and give the output record which does not exist in 1st table,"select T2.Name
from Table2 as T2
where not exists (select * from Table1 as T1 where T1.Name = T2.Name)
"
12554,4598,Can I sacrifice consistency to allow concurrent 'insert or update' and read access to a single table with SQL Server?,"BEGIN TRY
  UPDATE tbl
  SET    tbl.AccessTime = GETDATE()
  FROM   SchemaName.TableName tbl
  WHERE  tbl.ResourceKey = @ResourceKey;

  IF (@@ROWCOUNT = 0)
  BEGIN
    INSERT INTO SchemaName.TableName (ResourceKey, AccessTime)
    VALUES (@ResourceKey, GETDATE());
  END;
END TRY
BEGIN CATCH
  IF (ERROR_NUMBER() <> 2627) -- 2627 = Violation of PRIMARY KEY constraint
  BEGIN
    ;THROW;
  END;
END CATCH;
"
21221,5906,Compare a date string to datetime in SQL Server?," DECLARE @p_date DATETIME
 SET     @p_date = CONVERT( DATETIME, '14 AUG 2008', 106 )

 SELECT  *
 FROM    table1
 WHERE   column_datetime >= @p_date
 AND     column_datetime < DATEADD(d, 1, @p_date)
"
24634,25357,how to sum multiple sql queries together?,"select sum(individual_counts) from
(
  select count(*) as individual_counts from TableA where x = 1
    union all
  select count(*) from TableB where x = 2
....
) as temp_table_name
"
5923,53943,select months and count months from date column,"SELECT MONTH(DateColumn) AS MonthNumber, COUNT(1) AS Occurances
FROM schema.TableName
GROUP BY MONTH(DateColumn)
"
37684,43978,Set line width for oracle cmd line,"set pagesize n
"
23527,65815,truncate integer,"declare @numDigits INT = 3;
declare @maxNumber INT = POWER(10,@numDigits)-1 -- gets ""999"" when using 3 digits, 9999 when using 4 etc


DECLARE @input INT = 1234
DECLARE @output INT = IIF(@input>@maxNumber,@maxNumber,@input)

SELECT @output -- selects 999
"
30623,53416,How to enhance performance of sql query?,"SELECT
  serialnumber,
  state,
  at,
  operatorid,
  LAG(state) OVER (PARTITION BY serialnumber ORDER BY at) AS previous
FROM
  voucher
WHERE
  serialnumber in (SELECT DISTINCT serialnumber FROM voucher WHERE at LIKE '&1')
"
34651,68693,OracleSQL Finding top N rows from a group,"select jobid, jobtitle, pay, name
from (
  select j.jobid, j.jobtitle, e.pay, e.name, 
         row_number() over (partition by j.jobid order by e.pay desc) as rn
  from employees e 
    join jobs j on j.jobid = e.job_id
) 
where rn <= 3
order by jobid, jobtitle, pay desc;
"
28350,64840,Choose a value between two columns SQL - VBA in Excel,"SELECT case when A >= B Then A else B end as Max_value
FROM yourTableName
"
1505,65283,Updating table column date with case expression?,"WHEN CAST(date1 AS DATE) > CAST(date2 AS DATE)
"
37678,72146,If condition of Update Trigger of SQL view,"UPDATE T
SET PercentComplete = CASE Completed
        WHEN 1 THEN 100
        ELSE 0
    END
    ,Userstamp = inserted.Userstamp
    ,Timestamp = getDate()
FROM Task AS T
INNER JOIN INSERTED AS I
    ON I.ID = T.ID
WHERE I.Project = 'Your Project'
"
20320,45453,SELECT rows without duplicates and WHERE IN (),"SELECT formid, avals(data) as datavalues, akeys(data) as datakeys, taskid
FROM (SELECT d.*, row_number() over (partition by formid, taskid order by timestamp desc) as seqnum
      FROM task_form_data d
      WHERE taskid IN (449750, 449699, 449620)
     ) d
WHERE seqnum <= 3
ORDER BY taskid, formid, timestamp DESC;
"
19640,11853,Order sql results using a Count() value from another table,"SELECT 
id, username, status, COALESCE(NumOfPhotos,0) AS NumOfPhotos,COALESCE(NumOfVideos,0) AS NumOfVideos 
FROM dbo.Users u 
LEFT JOIN (SELECT [USER], COUNT(*) AS NumOfPhotos FROM dbo.Photos GROUP BY [USER]) ph ON ph.[USER] = u.ID
LEFT JOIN (SELECT [USER], COUNT(*) AS NumOfVideos FROM dbo.Videos GROUP BY [USER]) vd ON vd.[USER] = u.ID
ORDER BY status ASC, numOfPhotos ASC, NumOfVideos DESC
"
33191,38028,SQL Server Database query help,"DECLARE @pot DATETIME

-- SET @pot TO THE POINT OF TIME YOU WANT THE DETERMINE THE ENTRIES FOR

SELECT @pos, COUNT(*) FROM ProcessData
WHERE @pot BETWEEN Start_At AND End_At
"
1641,804,Equivalent to PostgreSQL array() / array_to_string() functions in Oracle 9i,"SELECT string_agg( name )
  FROM people
"
17884,45423,Join 3 tables in mysql,"$sql = ""SELECT p.id, m.menu_name, m.image_id, i.file_url 
            FROM product p 
            INNER JOIN menu m ON m.id = p.menu_id
            INNER JOIN icon i ON i.id = m.image_id
            WHERE ... "";
"
26265,26865,Can I put update or create statements in from clause in DB2?,"     .-,---------------.   
     V                 |   
>>-FROM----table-reference-+-----------------------------------><
"
12545,36997,Oracle 10g - UTL_MAIL package,"SELECT * FROM ALL_SYNONYMS WHERE OWNER = 'PUBLIC' and table_name LIKE 'UTL%'
"
29499,61616,Duplicate foreign keys in mysql,"ALTER TABLE `a` ADD UNIQUE `unique_index`(`b.id`, `c.id`);
"
19209,37774,how to create hexadecimal identity auto increment column sql server,"    SELECT CONVERT( VARBINARY(8), 100)
    --> 0x00000064
"
4455,71145,Set the column width when outputting to HTML using SQLPLUS?,"SET PAGESIZE 50000
SET MARKUP HTML ON TABLE ""class=detail cellspacing=0"" ENTMAP OFF
column colA heading ""<p style='width:800px'>800SetColA</p>"" format a40

column colB heading ""<p style='width:10px'>10SetColB</p>"" format a40

spool test.html

select level cola, level-5 colb from dual connect by level <10 ;

spool off
"
26258,69684,Updating foreign keys while inserting into new table,"with n as (select nextval('b_id_seq') as newbid,a.id as a_id  from a),
   l as (insert into b(id) select newbid from n returning id as b_id)
 update a set b_id=l.b_id from l,n where a.id=n.a_id and l.b_id=n.newbid;
"
19457,22321,Padding number with 0s before doing a insert into a SQL Server database,"INSERT INTO my_table (Account)  
VALUES (RIGHT('00000000' + CAST(12345 AS VARCHAR(8)), 8))
"
12276,16704,SQLite limit different column then order results,"SELECT * FROM
  (SELECT name, age FROM people ORDER BY age ASC LIMIT 100)
ORDER by name
"
22399,50502,#1452 - Cannot add or update a child row in 2 tables,"-- Areas have to be inserted with null presidents, and updated later
insert into area values (1, null);
insert into member values(1, 1);
update area set presidentmemberid = 1 where areaid = 1;
"
8246,38254,What should the Primary Key be?,"PRIMARY KEY(game_id, platform)
"
13692,54315,Iterate through rows in SQL Server 2008,"DECLARE @ID int
DECLARE IDs CURSOR LOCAL FOR select ID from SAMPLE where Name = @NameParameter

OPEN IDs
FETCH NEXT FROM IDs into @ID
WHILE @@FETCH_STATUS = 0
BEGIN
    exec myproc @ID

    FETCH NEXT FROM IDs into @ID
END

CLOSE IDs
DEALLOCATE IDs
"
37388,2117,SQL Server - Table Metadata,"SELECT   objType, objName, Type, Value
FROM   ::fn_listextendedproperty (null, 'user',
 'dbo', 'table','<your table>', null, null)
"
10057,17160,ado.NET getting fields from a datareader by field AND table name,"SELECT
        OA.id AS ordine_articolo_id, 
        ...
"
36485,24011,Normalise data into one table,"INSERT INTO userssteps
(status,user_id,step_id) 
select 0,
users.id,
steps.id
from users
inner join steps
"
25181,65025,"SQL pull values from ""last month"" when dates have already been declared","select * 
from orders
where to_char(OrderDate,'MM') = to_char(add_months(sysdate,-1),'MM')
"
31932,30025,Index number for records within a pipe-delimited field inside a csv,"SELECT ROW_NUMBER() OVER (PARTITION BY CrimeRecords.CaseNum ORDER BY CrimeRecords.CaseNum) As Idx, CrimeRecords.CaseNum, CrimeRecords.Offense, PrimaryCrime.PrimaryCrime
FROM (SELECT CaseNum ,x.i.value('.','varchar(20)') AS Offense 
            FROM (SELECT CaseNum, CONVERT(XML,'<i>'+REPLACE(CrimeType, '|', '</i><i>') + '</i>') AS d 
                        FROM CrimeView.dbo.tblCrimeData)x1 CROSS APPLY d.nodes('i') AS x(i)) AS CrimeRecords
"
7964,38994,PL/SQL Array to CLOB,"declare 
 v_clob clob;
 v_xml xmltype;
begin
 select xmlagg(XMLELEMENT(""test"",xmlforest(id,val)))
 into v_xml
 from test;
 select v_xml.getclobval
 into v_clob
 from dual;
 dbms_output.put_line(v_clob);
end;
/
"
13257,37618,"Mysql, clean up loose ends","DELETE FROM table_a
WHERE ref_b IS NOT NULL
  AND NOT EXISTS ( SELECT 1 FROM table_b WHERE table_b.id = table_a.ref_b )
"
7062,69360,counting times the most frequent record appears in a table," select top 1 deal_id, count(*) as numtimes 
 from DEAL_COUNTRY
 group by deal_id
 order by count(*) desc
"
8841,2380,Update multiple rows using select statements,"UPDATE table2 t2
   SET t2.value = ( SELECT t1.value FROM table1 t1
                     WHERE t1.ID = t2.ID )
 WHERE EXISTS ( SELECT 1 FROM table1 t1
                 WHERE t1.ID = t2.ID );
"
18066,62347,What to add to SELECT to output 10 RANDOM entries QUICKLY?,"SELECT w1.wort AS column1,
       w2.wort AS column2,
       w3.wort AS column3
FROM (select w1.* from woerter w1 where w1.wort LIKE 'a%' order by random() limit 10) w1 cross join
     (select w2.* from woerter w2 where w2.wort LIKE 'm%' order by random() limit 10) w2 cross join
     (select w3.* from woerter w3 where w3.wort LIKE 'o%' order by random() limit 10) w3
ORDER BY random()
LIMIT 10;
"
25692,22909,SQL View: Comparing an initial table with a profiling table to return values not present in initial table,"SELECT r.RouteId,di.PatrolID,r.TagId
    FROM Routes r
    INNER JOIN (SELECT DISTINCT RouteId, PatrolID from DataImport) as di on di.RouteId = r.RouteId
EXCEPT
SELECT RouteId,PatrolID,TagId
FROM DataImport
"
31712,6751,appending to cursor in oracle,"Select  a.head, a.effective_date,
From table_1 a
Left Join table_2 b On (b.head = a.head And b.effective_date = a.effective_date )
Where a.type_of_action='6' And a.effective_date >= ADD_MONTHS(SYSDATE,-15)  
  And b.head Is Null;
"
6938,43718,Inserting now() from vb6 into mysql,"Dim sqlDate As String
sqlDate = Format$(Now, ""yyyy-mm-dd hh:mm:ss"")

...
cmbVasarlo.ItemData(cmbVasarlo.ListIndex) & "", '"" & sqlDate  & ""', '"" & _ 
oRs1!Cim & ""', "" & logged_user_id & "")""
"
4033,62747,sql counting based upon multiple values in other column - sql server management studio,"select count(*)
from
(
    select usr
    from table_like_below
    where pn in (2,3)
    group by usr
    having count(distinct pn) = 2   -- this guarantees that usr have at least one 2 and at least one 3 in column pn
) T
"
34851,71871,Running SQL based on a query stored within a field?,"declare
  rc sys_refcursor;
  l_id table1.id%type;
begin
  for r_sql in (select id, sql, title from table1) loop
    open rc for r_sql.sql;
    loop
      fetch rc into l_id;
      exit when rc%notfound;
      insert into table2 (id, userid, title) values (r_sql.id, l_id, r_sql.title);
    end loop;
    close rc;
  end loop;
end;
"
39731,20566,ORA-00936: missing expression,"insert into diskgroup_size ( type1 , name , total_mb , used )
SELECT 'BANK',name,total_mb,(total_mb-free_mb)
from v$asm_diskgroup_stat@T24PRD ;
"
25376,33295,sql to generate a column by manipulating previous row and previous column,"create table c2 as
select c1
, sum(c1) over (ORDER BY rowid) as c2
from c1;
"
20840,10648,Get SSAS cube last process time,"SELECT LAST_DATA_UPDATE FROM $system.mdschema_cubes
"
4666,44723,Beginner SQL - Get DISTINCT entries (by column),"select SpeakerName, Min(Time) from OnlineSpeakers
Group by SpeakerName
"
37843,39160,MySQL query all existent and non existent entries from list (inline table),"CREATE TEMPORARY TABLE MyInlineTable (id LONG, content VARCHAR(255) );

INSERT INTO MyInlineTable VALUES
(1, 'name1'),
(2, 'name2');

SELECT * from MyInlineTable LEFT JOIN tags on MyInlineTable.content = tags.name
"
17819,14647,MySQL Query for finding customer interations,"select `table`.`steps`,count(*)
from `table`
inner join (
  SELECT `cUniqueId`,min(`createdDate`) as `date` FROM `table` 
  group by `cUniqueId`
) as `t2` on 
  `table`.`cUniqueId` = `t2`.`cUniqueId` AND
  `table`.`createdDate` = `t2`.`date` 
group by `table`.`steps`
"
16960,52407,calculate variance using SQL,"select  var_pop(price) as variance
from    (
        select  price
        from    YourTable
        order by
                date desc
        limit   3
        ) as SubQueryAlias
"
11793,51128,"Compare Items in the ""IN"" Clause and the resultset","WITH src AS (
  SELECT level id
    FROM dual
 CONNECT BY level <= 5)
SELECT nvl(ent_id, 'Not Found' )
  FROM src
       LEFT OUTER JOIN tc_logs ON (src.id = tc_logs.ent_id)
"
3376,47091,"Removing spaces from a string, SQL","regexp_replace(:P14_search_text, '[[:space:]]*', '');
"
31610,45299,Find Query - Filter by array size after $elemMatch,"db.test.aggregate([
    { ""$match"" : { ""contents.name"" : ""yorkie"" } },
    { ""$unwind"" : ""$contents"" },
    { ""$match"" : { ""contents.name"" : ""yorkie"" } },
    { ""$group"" : { ""_id"" : ""$_id"", ""sz"" : { ""$sum"" : 1 } } },    // use $first to include other fields
    { ""$match"" : { ""sz"" : { ""$gte"" : 2 } } }
])
"
30797,22505,SQL Server : selecting row with column that contains multiple comma delimited values,"select *
from a join
     b
     on ','+b.column_1+',' like '%,'+cast(a.column_1 as varchar(255))+',%'
"
5836,28117,MSQL trigger to insert record in second table based on update of specific field,"CREATE TRIGGER dbo.trg
   ON  customer
   AFTER INSERT,UPDATE
AS 
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    IF EXISTS (SELECT  1 FROM inserted WHERE comm_preference IN ('E', 'B')
        BEGIN
            INSERT INTO email_sent 
            SELECT customerno, email, GETDATE() from inserted
        END        

END
"
36657,55463,Get the first 10 rows for each group,"CREATE View TopOrder AS
SELECT Name, Product, nbOrders
FROM   (SELECT Name, Product, nbOrders,
               DENSE_RANK() OVER (PARTITION BY o.idCustomer
                                  ORDER BY nbOrders DESC) AS rk
        FROM   Customer c
        JOIN   Orders o ON c.idCustomer = o.idCustomer
        JOIN   Product p ON p.idProduct = o.idProduct
       ) t
WHERE  rk <= 10
"
18525,330,sqlplus access and email access using shell script,"alertlog=$(sqlplus -S \/ as sysdba 2> /dev/null <<EOF
SET NEWPAGE 0
SET SPACE 0
SET LINESIZE 80
SET PAGESIZE 0
SET ECHO OFF
SET FEEDBACK OFF
SET VERIFY OFF
SET HEADING OFF
SELECT value 
FROM   v\$parameter 
WHERE  name = 'background_dump_dest';
EOF
)
"
16348,33302,TSQL - Invalid Column Name RowNumber,"SELECT  *
FROM    (SELECT Id, Name,
                ROW_NUMBER() OVER (ORDER BY Id) AS 'RowNumber'
         FROM    Folks
        ) AS A
WHERE   RowNumber = 3
"
36650,7936,solving a Simple SQL query,"SET @College:='Harvard';
SET @sql_text = concat('SELECT * FROM ', @College)

PREPARE stmt FROM @sql_text;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;
"
24352,6352,Q: Login SQL Injection,"...AND username = 'xxx' OR 1=1--
"
323,73502,Convert an Integer to time,"select cast(DATEADD(hour, 13, 0) as time)
"
4824,439,Does Dapper support the like operator?,"term = ""whateverterm"";
var encodeForLike = term => term.Replace(""["", ""[[]"").Replace(""%"", ""[%]""));

string term = ""%"" + encodeForLike(term) + ""%"";
var data = conn.Query(@""
   select top 25 
  Term as Label, 
  Type, 
  ID 
  from SearchTerms 
  WHERE Term like @term"", 
  new { term });
"
29085,20672,Using Alias In When Portion of a Case Statement in Oracle SQL,"select ""Id"",
    case ""Id""
        when 3
        then 'foo'
        else 'bar'
    end AS ""Results""
from (
    select TABLEA.SomeIDNumber AS ""Id"",
    from TABLEA
);
"
23219,37568,"Taking a string and removing commas from it, vb6, SQL?","   Dim strArray() As String
   Dim intCnt As Integer


   strArray = Split(strYourCommaDelimitedData, "","")

   For intCnt = LBound(strArray) To UBound(strArray)
      'Trim(strArray(intCnt)) or CInt(Trim(strArray(intCnt)) 
      'will hold each value use it to select your item
   Next
"
29594,55092,How to use LIKE with ANY in Postgresql?,"drop table if exists temp_a;
create temp table temp_a as
(
    select array['alpha','beta'] as strings
    union all
    select array['gamma','theta']
);

select * 
from (select unnest(strings) as string from temp_a) as sq 
where string ilike '%eta'
"
5997,67782,Conditional MySQL Column,"select i.item_code, i.item_name, 
    case when q.selltype_name = 'unit' then i.item_price else 0 end as unit,
    case when q.selltype_name = 'box' then i.item_price else 0 end as box,
    case when q.selltype_name = 'pound' then i.item_price else 0 end as pound,
    case when q.selltype_name = 'gallon' then i.item_price else 0 end as gallon
from qa_items i
inner join qa_selltypes q on i.selltype_code = q.selltype_code
"
4525,32634,Selecting ranges of dates without overlapping,"select date as startdate, next_date as enddate
from (select d.*,
             lead(code) over (order by date) as next_code,
             lead(date) over (order by date) as next_date
      from dates d
      where code in ('ST', 'ED')
     ) d
where code = 'ST' and
      next_code = 'ED';
"
22185,56241,Drop temporary table when exiting a function,"RETURN QUERY
       SELECT * FROM my_temp_table;
DROP TABLE my_temp_table;
RETURN;
"
20205,51705,ORA-01779: cannot modify a column which maps to a non key-preserved table on updating joined tables,"MERGE INTO uas_mapping_test t1
USING 
(   
  select pt.poid_id0, umt.plan_id
    from norie.plan_t_test pt 
    join norie.UAS_MAPPING_TEST umt on (pt.poid_id0 = umt.plan_id)
) ta ON poid_id0 <> plan_id
WHEN MATCHED THEN UPDATE 
set plan_id = poid_id0
"
7346,6875,SQL Picking Top Date out of the Date Field,"WITH
  sorted_data AS
(
  SELECT
    ROW_NUMBER() OVER (PARTITION BY item_id ORDER BY item_date DESC) AS row_id,
    *
  FROM
    item_data
  WHERE
    item_date <= getDate()
)

SELECT * FROM sorted_data WHERE row_id = 1
"
30558,41470,SQL question regarding searching for data from multiple tables,"SELECT DISTINCT d.* FROM ticket_data d 
LEFT OUTER JOIN ticket_comment c on c.tid = d.id WHERE
  (
   d.subject LIKE '%test%' OR
   d.message LIKE '%test%' OR
   c.comment LIKE '%test%'
  )
"
16166,17358,SQL Table not locked even using tablock & holdlock,"set transaction isolation level serializable 

go

begin transaction 

select * from emp with (TABLOCKX,holdlock)

waitfor delay '00:00:40'

rollback transaction
"
10126,57997,SQL Calculate week number from a date column,"select ReportNo,ReportName,to_char(to_date(Load_Date,'yyyymmdd'),'ww') from Facts
"
20534,39782,How do I work out the average of two columns? Microsoft Access,"AverageMarks: (CourseworkMarks+ExaminationMarks)/2
"
39474,71242,Order By Date when the Date is converted to MM/DD/YY,"SELECT <columns that you want> FROM
(
SELECT 
NAME , 
Format([CREATE_DATE],""dd/mm/yyyy"") AS CREATE_DATE, create_date as orig_createDate
FROM 
TABLE 
)TMP
ORDER BY orig_create_date
"
12186,27479,How to write trigger to generate sequence number for repeated value,"ALTER TRIGGER tr_After_Update_Inser
ON [dbo].[tbl_all_purple_flag_level]
FOR INSERT, UPDATE
AS
BEGIN
 SET NOCOUNT ON;
WITH Updateable
AS
 (
  SELECT [Sno], id,  [visited_count],
        RIGHT('0'+ CAST((ROW_NUMBER() OVER (Partition By id Order By id, [Date] DESC)) as varchar(2)), 2) as duplicate_id
  FROM tbl_all_purple_flag_level 
 )
 UPDATE Updateable
  SET [visited_count] =  duplicate_id
END
"
9907,6851,Using user defined function (UDF) in where clause more than once with running the function only once,"SELECT id, task_name, last_run, func.next_run
FROM tasks
Cross Apply (Select dbo.task_next_run(task_type, @task_schedule_day_of_week, @task_schedule_time, @task_period, @last_run) as next_run) as func
WHERE 
func.next_run < getdate() and
func.next_run > last_run
"
36361,74566,MySQL: Limiting number of results received based on a column value | Combining queries,"SELECT * FROM
(
    SELECT *, @num := if(@some_id = some_id, @num := @num + 1, 1) as row_num,
           @some_id := some_id as some_id
    FROM example
    ORDER BY last_modified DESC
) as e
WHERE row_num <= 5
"
34740,45806,SELECTING with multiple WHERE range conditions on same column,"SELECT A.item_ID, A.item_name
FROM A
LEFT JOIN B ON A.item_ID = B.item_ID
WHERE (B.option_ID=34 AND B.option_value BETWEEN 1000 AND 2000)
      OR (B.option_ID=12 AND B.option_value BETWEEN 0 AND 4000)
GROUP BY A.item_ID
HAVING COUNT(A.item_ID) >= 2
"
13239,34345,How to exclude rows with duplicate columns?,"select distinct id1, id2, data from test where id1 < id2
"
25450,33641,Multiple sub queries,"select created_date,
       count(field1) Enrolled,
       count(case field1 when 'E-mail' then 1 end) Enrolled_as_Email,
       count(case field1 when 'Cell Phone' then 1 end) Enrolled_as_Cell,
       (Select COUNT(*)
        from tbl_TransactionDishout d
        where d.created = c.created_date and
              d.DishoutResponseCode = '0000') Deals_Redeemed
from tblCustomer c
group by created_date
order by created_date
"
36412,54473,ASP.net MVC How to run multiple instances of the same app at the same time in different subdomains?,"/website/sub1
/website/sub2
"
36595,68254,Change Character Allowance,"alter table table_name MODIFY (column_to_change varchar(new size))
"
29292,73295,Filter Row using Oracle SQL in Multiple Data Rows,"     select Record_ID,product from
        (
        select Record_ID, product ,row_number() over(partition by product order by Record_ID ) as r_no
        from ss
        where product not  in (select product from ss where status='Defect'))
        where R_no=1
"
23280,44837,How to distinct sum() when using joins,"SELECT 
    DATE_FORMAT(date, '%Y-%m'), 
    SUM(ok.qty), 
    SUM(reject.qty), 
    ((SUM(reject.qty) / SUM(reject.qty + ok.qty))*100)as reject_percent
FROM ok
inner JOIN (Select Ok_Id,Sum(qty) as qty from Reject group by OK_id) as reject ON ok.id = reject.ok_id
GROUP BY DATE_FORMAT(date, '%Y-%m')
"
10633,30729,Improving work with SQL DataTime,"SELECT IIF(DAY(@A) >= 25,
           DATEADD(d, 25 - DAY(@A), @A),
           DATEADD(d, 25, EOMONTH(@A, -2)))
"
28173,10159,How to insert a seperator string between each character in a string?,"UPDATE tab SET col1 = regexp_replace(col1, '(.)', '\1\s*');
"
13818,34039,How to return column that matched the query in Solr..?,"hl=on&hl.fl=name,displayName,description,extra
"
34684,6681,"Oracle - single-row subquery returns more than one row , Need to fetch all the rows","select * from  sampleTable
             where 
             status = 'A' 
             and SUBSTR(some_code_column, 1, 4)  = 9999
"
21961,67383,MySql join with 2 Tables and 2 join,"SELECT p. * , u.name as username, l.name as lastusername
FROM posts p INNER JOIN
     users u
     ON u.id = p.userid INNER JOIN
     users l
     ON l.id = p.lastuserid;
"
219,38474,"Price plan, feedback on database design","    phoneplan_id (P)
    phone_id (F)
    package_id (F)
    point
"
15511,1983,What is actually sef-join?,"SELECT a.column_name, b.column_name...
FROM table1 a
JOIN table1 b
 ON a.common_field = b.common_field;
"
27702,34411,Custom Fields for a Form representing an object,"CREATE TABLE `attribute_value` ( -- enumerations go in this table
    `attribute` varchar(30), 
    `value` varchar(30), 
    PRIMARY KEY (`attribute`, `value`)
);

CREATE TABLE `eav` ( -- now the values of attributes are restricted
    `entityid` int, 
    `attribute` varchar(30), 
    `value` varchar(30), 
    PRIMARY KEY (`entityid`, `attribute`), 
    FOREIGN KEY (`attribute`, `value`) REFERENCES `attribute_value`(`attribute`, `value`)
);
"
20770,64780,SQL group by with multiple conditions,"SELECT yourtable.*
FROM
  yourtable INNER JOIN (
    SELECT   ip_address,
             MAX(CASE WHEN type='purchase' THEN id END) max_purchase,
             MAX(CASE WHEN type='visit' THEN id END) max_visit
    FROM     yourtable
    GROUP BY ip_address) m
  ON yourtable.id = COALESCE(max_purchase, max_visit)
"
11681,19463,"Mysql - Ordering Facebook posts, comments, and replies correctly","select facebookFeeds.*, facebookComments.id as cID, parentID, facebookComments.userID, facebookComments.name, facebookComments.message as cMessage, facebookComments.createdTime as cCreatedTime from facebookFeeds left join facebookComments on facebookFeeds.id = facebookComments.feedID where facebookComments.accountID = 24 order by facebookFeeds.createdTime desc, if(parentID is null, cID, parentID)
"
36148,65082,SQL: How to find the sum of values where all the records has the same value in a column?,"select student, sum(value)
from payments
group by student
having sum(case when Payment_type is not null then 1 else 0 end) = 0
"
14140,11925,Check table existance in slick 3.0,"val tables = Await.result(db.run(MTable.getTables), 1.seconds).toList
"
19096,52947,How do i dump .schema of SQLite table?,"sqlite3 /data/data/<your-namespace>/databases/<database-name>
"
18976,25033,ORDER BY FIELD with a wilcard?,"ORDER BY
  CASE WHEN myField = 'ttt3' THEN 0 ELSE 1 END,
  myField,
  other_order_col,
  other_order_col2
"
18423,8934,$wpdb MySQL select from main table and join each row with two rows of another table,"select
  main_table.user_id,
  concat(s1.meta_value, ' ', s2.meta_value) as name
from
  main_table left join secondary_table s1
  on main_table.user_id = s1.user_id and s1.meta_key = 'first_name'
  left join secondary_table s2
  on main_table.user_id = s2.user_id and s2.meta_key = 'last_name'
where
  referrer = $referrer
"
8171,35875,Move one column to another,"UPDATE e
SET    e.Specialization = d.Specialization
FROM   Employee e
JOIN   Department d ON e.DeptId = d.DeptId
"
7916,42434,Deleting records that are not joined on in SQL,"DELETE Customers
FROM   Customers c
WHERE NOT EXISTS (
    SELECT 1
    FROM Orders o
    WHERE o.CustomerID = c.ID
)
"
19204,25622,How to check if a count statement returns a specific value,"SELECT rev.name, s.title, count(r.mId)
FROM reviewer rev, song s, rating r 
WHERE (r.rID = rev.rID) AND (r.mID = s.sID) 
GROUP BY rev.name, s.title
HAVING count(r.mId) = 3
"
3573,66778,how to get the range of the price using range in sql?,"SELECT
    price 
FROM 
    my_table
WHERE
    Footage_Range1 <= YOUR_RANGE
ORDER BY
    Footage_Range1 DESC
LIMIT 1
"
1766,44543,SQL Server 2008 list items not in table,"SELECT ss.softwareId AS 'Software ID',
    s.softwareDescription AS 'Software Description',
    sv.vendorName AS 'Vendor Name',
    c.cityName AS 'City Name'
FROM software AS s
left outer JOIN systemSoftware AS ss
ON s.softwareId = ss.softwareId
left outer JOIN softwareVendor AS sv
ON s.vendorId = sv.vendorId
left outer JOIN city AS c
ON sv.zipCode = c.zipCode
WHERE ss.softwareId is NULL
ORDER BY s.softwareId
"
19342,56504,How do I rewrite my SQL query to remove redundant values from a GROUP BY column?,"SELECT CASE WHEN ROW_NUMBER() OVER (PARTITION BY [task] ORDER BY [task]) = 1 THEN [task] ELSE '' END as [task],
 [activity], SUM([consumption]) AS TotalMin 
FROM [TimeTable]
WHERE [name]=@name 
   AND [month]=@month 
   AND [year]=@year 
GROUP BY [task], [activity]
ORDER BY [task] ASC
"
20791,13318,Four Tables show single occurrence for outer most table,"SELECT DISTINCT ON(companies.name, employees.first_name) 
   applicants.id, companies.name, employees.first_name, departments.name, applied_date
FROM applicants
INNER JOIN departments ON applicants.department_id = departments.id
INNER JOIN companies ON departments.university_id = companies.id
INNER JOIN employees ON applicants.student_id = employees.id
ORDER BY companies.name, employees.first_name, applied_date
"
31803,25536,How to optimize query that has the same subquery twice?,"select 'Total_amount', SumTotal, case when SumTotal > 100000 
then 'Good' else 'Not good' end 
from dbo.BusinessUnits bun 
OUTER APPLY (select SUM(Total) 
from dbo.Invoices i where i.BU = bun.BU) CA(SumTotal)
"
1750,50534,limiting union result in oracle,"select *
  from ( select
            ...
          union
         select
            ...
       )
 where rownum <= 500
"
33160,71939,ifnull() function in where clause MYSQL,"select e.name, o.OrgName 
from Employee e
left join Organisation o on o.OrgID = e.OrgID
where e.EmpId = ?; 
"
13339,41648,Using regular expression within a stored procedure,"'([^a-z])'
"
30427,25060,Select highest value for each foreign key using time interval,"SELECT MAX(cms) as value_of_rain 
FROM `rainfall`
WHERE `date` >= SUBDATE( NOW( ) , INTERVAL 10 MINUTE )
GROUP BY LOCATION_ID
"
5593,35998,Select n last linesChubb from table,"SELECT * FROM Author ORDER BY authid DESC LIMIT 10 
"
22570,51849,How to combine multiple queries of different time range in one table scan,"SELECT   provider_id, sum(spent)
FROM     spent_table 
WHERE    (date BETWEEN '20130930' AND '20140101' AND provider_id = 272) OR
         (date BETWEEN '20130730' AND '20131201' AND provider_id = 273)
GROUP BY provider_id
"
25724,19374,"how to link tables together using timestamp sql, mysql","UPDATE
  Flowrate JOIN Dataset ON (Flowrate.TimeStamp = Dataset.Timestamp)
  SET Flowrate.Dataset_id = Dataset.Dataset_Id
"
27486,25701,How to avoid launching a trigger for every row of a prepared statement?,"UPDATE table1 t
SET    field1 = u.field1
FROM (
   VALUES
    ('abc'::text, 1)   -- cast string literal in row 1 to make type unambiguous
   ,('def', 2)
   ,('ghi', 3)
   ) u (field1, filed5)
WHERE  t.field5 = u.field5;
"
37732,73961,How to retrieve matching values from a single column in a table?,"select ID, Avatar
from MyTable
where replace(replace(Avatar, '.resident', ''), ' resident', '') in (
    select replace(replace(Avatar, '.resident', ''), ' resident', '') as Avatar
    from MyTable
    group by replace(replace(Avatar, '.resident', ''), ' resident', '')
    having count(*) > 1
)
"
14481,73526,Average of 10 days in a month using sql server,"SELECT t.Location_Key, td.MONTH_NUMBER, td.YEAR, CASE WHEN (td.DAY_OF_MONTH <= 10) THEN '1-10' ELSE CASE WHEN (td.DAY_OF_MONTH <= 20) THEN '11-20' ELSE '21-31' END END, AVG(t.Value) 
FROM yourTable t
INNER JOIN time_dim td ON td.TIME_KEY = t.Time_key
GROUP BY t.Location_Key, td.MONTH_NUMBER, td.YEAR, CASE WHEN (td.DAY_OF_MONTH <= 10) THEN '1-10' ELSE CASE WHEN (td.DAY_OF_MONTH <= 20) THEN '11-20' ELSE '21-31' END END
"
39421,2712,problem with sql command,"SELECT c.comment_type, c.from_user_id, c.to_user_id, c.message 
FROM comments c 
WHERE 
(SELECT COUNT(*) from friends 
where (id_friend_1=c.from_user_id AND id_friend_2='"" + Session[0] + ""') 
OR ( id_friend_1='""+Session[0]+""' AND id_friend_2=c.from_user_id))>0 
"
4016,54719,Creatuing categories from a column of data,"Select Place, program, 
Sum(if(DiffMonth < 0,1,0)) AS Less,
Sum(if(DiffMonth > 0,1,0)) AS Great
from Table1 GROUP BY Place, program;
"
3860,40192,SQL Getting last date and values associated with description of value in another table,"SELECT Authorizations.*, anotherTable.description
FROM 
(
    SELECT MAX(authorization_date) AS max_date, request_id
    FROM Authorizations
    GROUP BY request_id
) last_auths
INNER JOIN Authorizations ON last_auths.max_date = Authorizations.authorization_date
    AND last_auths.request_id = Authorizations.request_id
INNER JOIN anotherTable ON anotherTable.role_id = Authorizations.role_id
"
28021,3017,SQL Server ROW_NUMBER() Issue,"SELECT * 
FROM   (SELECT * , RANK() OVER (PARTITION BY batchid ORDER BY scaqry) rk 
        FROM   sayimdcpc) t 
WHERE  rk = 1
"
17414,34785,sql remove string from field and update,"Update dbo.authors
Set    city = replace(city, 'Salt', 'Olympic');
"
29906,25418,How do I update n rows in a table?,"UPDATE TOP(@N) ...
"
3013,33432,SQL - How can I remove duplicate rows by last entered value?,";WITH cte
 AS (SELECT ROW_NUMBER() OVER (PARTITION BY person_id, date_work
                                   ORDER BY hours DESC) RN
     FROM   work_hours)
 DELETE FROM cte
 WHERE  RN > 1
"
28050,62041,Remvoing dots from a date in a url,"DECLARE @doc varchar(500) = 'http://local.website.net/doc/q?file=5448245&date=2013.08.29&ref=65457'
SELECT SUBSTRING(@doc,0,CHARINDEX('date=',@doc))+REPLACE(SUBSTRING(@doc,CHARINDEX('date=',@doc),LEN(@doc)),'.','')
"
24283,66339,Using DISTINCT and COUNT together in a MySQL Query,"SELECT COUNT(DISTINCT productId) from  table_name WHERE keyword='$keyword'
"
24650,56351,MySQL Find the total amount of posts per user,"SELECT users.*, count( posts.user_id ) 
FROM posts LEFT JOIN users ON users.id=posts.user_id 
GROUP BY posts.user_id
"
13913,73147,Can you SELECT WHERE something's LIKE and IN at the same time?,"select
  *
from
  Table1 t1
    inner join Table2 t2 on (t1.name like t2.name + '%')
"
21826,45704,JPA query order by comparison of local column and joined table column?,"select t.id,
    case when p.id is null 
        then t.created
        else max(p.created) 
    end 
as derived_max_time
From topic t
left join posts p
on t.id=p.tid
group by t.id
order by derived_max_time desc
"
32122,25616,Does the first insert into a table effectively lock the entire table?,"using (var scope = new System.Transactions.TransactionScope(TransactionScopeOption.Required, new TransactionOptions() { IsolationLevel = IsolationLevel.ReadCommitted, Timeout = TransactionManager.MaximumTimeout}))
"
3650,28759,Export SQL query results as XML in DB2 script,"Select REC2XML(1.0, 'COLATTVAL', 'row', ct) From (SELECT current timestamp as ct FROM sysibm.sysdummy1);
"
1208,20368,SP_RENAME doesn't work,"alter table patient.idp change column idP id <whatever the type is>;
"
16488,63607,changing sql JOIN Syntax to LINQ,"var result = from p in Posts
            join t in Tags on p.ID equals t.ID
            select new { Post = p, Tag = t };
"
25550,70660,How to return multiple values in one column (T-SQL)?,"CREATE FUNCTION [dbo].[GetAliasesById]
(
    @userID int
)
RETURNS varchar(max)
AS
BEGIN
    declare @output varchar(max)
    select @output = COALESCE(@output + ', ', '') + alias
    from UserAliases
    where userid = @userID

    return @output
END

GO

SELECT UserID, dbo.GetAliasesByID(UserID)
FROM UserAliases
GROUP BY UserID

GO
"
4147,71696,Access 2000 automaticly add text to a form entry field,"Private Sub txtFileName_AfterUpdate()
    If Not IsNull(txtFileName) Then
        txtFileName = Trim$(txtFileName)
        If Not Right$(txtFileName, 4) = "".zip"" Then
            txtFileName = txtFileName & "".zip""
        End If
    End If
End Sub
"
12901,71495,Prevent mysql casting string to int in where clause,"SELECT delivery_name 
FROM orders 
WHERE CONCAT('a',orders_id) = CONCAT('a','985225a')
"
14311,14158,How to Obtain Percents? Can I obtain the group Sum and total Sum in the same Query?,"SELECT
   Region,
   Percent =
      Sum(Quantity) * 100.0
      / (SELECT Sum(Quantity) FROM dbo.Table)
FROM dbo.Table
GROUP BY Region

-- alternate denominator for SQL Server 2005 and up:
/ Sum(Quantity) OVER () 
"
38221,26959,How to Get Sum of One Column Based On Other Table in Sql Server,"select c.id, c.customername, sum(isnull(p.price, 0)) as sumprice
  from tblcustomers c
  left join tblpurchases p
    on c.id = p.customerid
 group by c.id, c.customername
"
26352,64583,find number of polygons a line intersects,"declare @line geometry = geometry::STLineFromText('LINESTRING(3 9, 50 20)', 0);

select count(*)
from dbo.Shapes as s
where s.shape.STIntersects(@line) = 1;
"
35133,59602,SQL statement to return the current step in a list of steps that should be passed through and whether the process has ended or not," select *
,case when t1.approved=0 then 'ended'
      when t1.approved=-1 then 'not ended'
      end as stat
from (select Name, Position, Approved from table1 t2
where 
(case when approved=0 then 1
      when position =(select max(position) from table1) and approved=1 then 1  
      when (position= 1 and approved=-1) or (approved=-1 and 1=(select approved from table1 t1 where t1.position=t2.position-1))then 1 
else 0
end) =1 
      order by position)t1
limit 1
"
570,69062,"Displaying last_name, Dept_id, (max)Salary","WITH RCounter AS (
    SELECT department_id, last_Name, Salary,
           DENSE_RANK() OVER(PARTITION BY department_id ORDER BY Salary DESC) AS RowNumberCounter
        FROM <<tablename>>
)
SELECT department_id, last_Name, Salary
    FROM RCounter 
    WHERE RowNumberCounter = 1;
"
13853,40119,getting the index of set bits from an int column in mysql,"SELECT
    MAKE_SET( val, '1', '2', '3', '4', '5', '6', '7', '8', '9' )
FROM
    example
"
28641,34990,How do I select rows where a column value starts with a certain string?,"select * from mytable where name like ""Mr.%""
"
29554,30554,How can I copy all field definitions from one model class to another?,"from somewhere import Patch

class FilteredPatchManager(models.Manager):
    def get_query_set(self, *args, **kwargs):
        return super(FilteredPatchManager, self).get_query_set().exclude(author__contains='@example.com')


class FilteredPatch(Patch)
    objects = FilteredPatchManager()

    class Meta:
        proxy = True
"
19923,49043,SQL SELECT Statement max id,"select group_id, max(id) as max_id
from apps
where type = 1
group by group_id
"
2311,29471,How to split one column into two columns just by counting the charachters and inserting them into another table via a SQL query?,"insert into table2
select left(column1,2), substring(column1, 3, len(column1) ) from table1
"
27048,9222,(Oracle) Joining all_tab_columns and all_cons_columns,"SELECT atc.TABLE_NAME, 
       atc.DATA_TYPE, 
       count(distinct atc.column_name) cols, 
       count(distinct acc.constraint_name) cons
 FROM all_tab_columns atc 
INNER JOIN all_cons_columns acc 
   ON acc.COLUMN_NAME = atc.COLUMN_NAME AND 
      acc.TABLE_NAME = atc.TABLE_NAME
WHERE atc.OWNER = 'PARRANDEROS'
GROUP BY atc.DATA_TYPE, 
         atc.TABLE_NAME;
"
30420,29887,"How do I add Hours, mins, seconds to dateadd sql?","DECLARE @start DATETIME
DECLARE @end DATETIME

SET @start = DATEADD(dd, 0, DATEDIFF(dd, 0, GETUTCDATE()))
SET @end = DATEADD(dd, 1, DATEADD(ms, -3, @start))
"
35923,3882,SQL Left Join losing rows after filtering,"SELECT 1.Label, COUNT(2.values)
FROM Table1 1
    LEFT JOIN Table2 2 ON 1.fk = 1.pk and
              2.Date BETWEEN 1/1/2010 AND 12/31/2010    
GROUP BY 1.Label
"
35877,29015,How to merge two columns in SQL,"Select FinancialId,
        ApplicationId,
        ISNULL(UPPER (InterestSubsidyFinancialDetail.BankName),'') + 
        ISNULL(BankMaster.BankName,'')
        as BankName,    
        InterestSubsidyFinancialDetail.BankId

 From   InterestSubsidyFinancialDetail

 left join BankMaster On BankMaster.BankId = InterestSubsidyFinancialDetail.BankId
"
19066,48118,select values of a specific month from table contain timestamp column,"select count(transaction_id) tot_tran
      ,to_char(max(transaction_dte),'Month') month from tbl_trans
where extract (month from transaction_dte)=7
"
14346,69165,Create a stored procedure to delete rows that have no values,"CREATE PROCEDURE sp_del_inactive_cust

AS

DELETE TOP (1) c
FROM
    customers c
    LEFT OUTER JOIN orders o
        ON C.customer_id = o.customer_id
WHERE
    o.customer_id IS NULL
"
58,65601,Need Help Thinking Through Semi-Complex Query on Two Tables,"SELECT name, dateIn
FROM   dates
WHERE  NOT EXISTS(
         SELECT *
         FROM   cards
         WHERE  cards.personID = dates.personID
            AND cards.cardDate = dates.dateIn
            AND cards.cardColor = 'red'
       )
"
11152,4693,(Common Table Expressions) CTE as part of WHERE clause... possible?,"WITH recursive_cte AS (
   -- root selection (dynamic, generated in code)
   SELECT Bla FROM Table2
   -- recursive part
   UNION ALL
   SELECT …..)
SELECT t.*
  FROM TABLE1 t
  JOIN recursive_cte rc ON rc.key = t.pk
"
34865,2034,MS SQL query - 2 tables same field - decide whitch to use,"SELECT COALESCE(PriceDiscount, Price) AS Price FROM mytable
"
4381,47696,How to query a table with cardinality one to display all the Pk while also displaying the matching elements in a table with FK,"select .....
from A left outer join B
on (A.ApkColumn=B.AfkColumn)
"
39242,19063,"SQL statement, selecting data from specific range of hours","SELECT DATE_FORMAT(COLUMN_NAME, '%H') FROM T_REF
MINUS
SELECT DATE_FORMAT(COLUMN_NAME, '%H') FROM ORIG_TABLE
"
31799,1955,"Change the middle value of numbers to ""xxxx""","UPDATE foo SET bar = INSERT(bar, (LENGTH(bar) - 4) / 2 + 1, 4, 'xxxx');
"
25151,20236,How do I set a variable to the value of only one block in SQL Server,"SELECT @State = state FROM projectlist WHERE project = @project

IF @State = 'active' 
UPDATE ......
ELSE
DELETE .....
"
25447,32035,Referential integrity over table portion,"ALTER TABLE MissionRollAssignments
 ADD CONSTRAINT fk1 FOREIGN KEY (GroupId, Memberid)
 REFERENCES GroupMembers (GroupId, Memberid);

ALTER TABLE MissionRollAssignments
 ADD CONSTRAINT fk2 FOREIGN KEY (GroupId, MissionId)
 REFERENCES Missions (GroupId, MissionId);
"
24206,10842,How to select values that are paired with each in a list of values,"select employee_id
from atable
where role_id in (20, 30, 40)
group by employee_id
having count(distinct role_id) = 3;
"
2288,52501,"""permission denied"" for pg_dump output file","postgres=# \! pg_dump dbName -f /home ..../someWhere/db.sql
"
22867,17382,NLS_LANG setting for JDBC thin driver?,"Locale.setDefault(Locale.<your locale here>);
"
23727,21972,Substring selection within specific repetition of characters,"http:\/\/([^\/]+\/){n}([^\/]+).*$
"
16158,49465,SQLite Insert or Replace Where,"INSERT OR REPLACE INTO decryptionKeys VALUES (""999"",""Birthday"",""25.12.1988"")
"
33278,18265,Update [can check if the date is future ],"select distinct name from mytable
"
8692,16886,SQL subqueries ques :,"select  s.sid
,       s.sname
,       count(distinct b.color) as NumberOfBoatColorsReserved
from    Reserves r
join    Sailors s
on      s.sid = r.sid
join    Boats b
on      b.bid = r.bid
group by
        s.sid
,       s.sname
having  count(distinct b.color) >= 2
"
18191,2218,SQL Many-to-Many Composite Key Link Table Join,"SELECT EventEntryID, EventEntrySource 
FROM Link_Computers_EventEntries
WHERE ComputerID=1 -- Where 1 represents the ""specified"" ComputerID value
"
24006,18021,SQL select orders depending on status and date,"SELECT o.*
,SUM(os.name ='shipped') shipped
FROM 
orders o
LEFT JOIN orders_status os USING(order_status_id)
WHERE o.date_addded  < '2014-04-01'
GROUP BY o.order_id
HAVING shipped =0
"
14091,40579,How to using INNER JOIN if one table is empty or no data,"SELECT room.id_room
     , room.name_room
     , room.available_room - SUM(COALESCE(reservation.reserved_qty, 0)) AS remaining_rooms
    FROM room
        LEFT OUTER JOIN reservation
            ON room.id_room = reservation.id_room
    WHERE
        checkin_date IS NULL OR
        @day BETWEEN checkin_date AND checkout_date
    GROUP BY room.id_room, room.name_room;
"
13529,5574,Multiple Parameter Search in SQL Server 2000,"Select Last_Name, First_Name, Mid_Name, DOB, Home_Phone, Work_Phone from dbo.tblClient
Where (@LastName is null or Last_Name Like '%'+ @LastName)
and (@FirstName is null or First_Name Like '%'+ @FirstName)
and (@HomePhone is null or Home_Phone Like '%'+ @HomePhone)
-- etc...
"
2823,23403,Selecting the last entry in sql database for each id field,"WITH cte 
AS
(
     SELECT *,
         ROW_NUMBER() OVER
         (
             PARTITION BY Reg_No
             ORDER BY Transdate DESC
         ) AS RowNumber
     FROM unithistory
)
SELECT *
FROM cte
WHERE RowNumber = 1
"
16832,7927,Display year in the future,"WITH CTE_TEST AS(
    SELECT 2016 AS NYEAR
    UNION ALL
    SELECT NYEAR+1
    FROM    CTE_TEST
    WHERE NYEAR+1 <= YEAR(GETDATE())
)
SELECT * FROM CTE_TEST
"
3340,57178,SQL Sum count based on an identifier,"SELECT Name,SUM(Cost)
FROM MyTable
GROUP BY Name
"
12395,19098,How can I use a SQL UPDATE statement to add 1 year to a DATETIME column?,"UPDATE Procrastination SET DropDeadDueDate = DATEADD(yyyy,1,DropDeadDueDate)
"
30063,12354,"Two parts mysql query, order the results displaying the ones from the first part, first","(SELECT name, pic0, bio,site
FROM "".$table.""
WHERE ( (name LIKE '%john%' OR name LIKE '%smith%') AND site LIKE ('%site1%') )
ORDER BY ( (name LIKE '%john%' OR name LIKE '%smith%') AND site LIKE ('%site1%') ) DESC)
UNION
(SELECT name, pic0, bio,site
FROM "".$table.""
WHERE ( name IS NOT NULL AND category IN ('drivers', 'construction') AND site LIKE ('%site1%') )
ORDER BY ( (name LIKE '%john%' OR name LIKE '%smith%') AND site LIKE ('%site1%') ) DESC)  
"
7900,64221,Generate a resultset of incrementing dates in TSQL,"declare @dt datetime, @dtEnd datetime
set @dt = getdate()
set @dtEnd = dateadd(day, 100, @dt)

select dateadd(day, number, @dt)
from 
    (select distinct number from master.dbo.spt_values
     where name is null
    ) n
where dateadd(day, number, @dt) < @dtEnd
"
20130,12218,Counting distinct undirected edges in a directed graph in SQL,"select count(*) from (
  select to_there from edges where from_here = 1
  union
  select from_here from edges where to_there = 1
) as whatever
"
3813,10880,Returning results for the whole of yesterday and not the last 24 hours,"select * from message where DATE_PART('day', now() - arrival_timestamp) <= 1
"
16562,59499,make server name as a variable,"exec('select * from ' + @ServerName + '.ClientDatabase.dbo.Client')
"
5685,54163,MySQL Date difference between two rows,"SELECT USER_ID,
       DATEDIFF(MAX(CASE WHEN ACTION=""CLOSE_APP"" THEN timestamp END),
                MIN(CASE WHEN ACTION=""START_APP"" THEN timestamp END)
               ) AS Duration 
FROM MOBILE_LOG AS t 
GROUP BY USER_ID
"
15003,42655,Debug SQL in pgAdmin when SQL contains variables,"PREPARE test AS SELECT * FROM users WHERE first_name = $1;
EXECUTE test ('paul');
DEALLOCATE test;
"
3019,55881,Why doesn't mysql optimize this simple query,"SELECT *
FROM (SELECT * FROM T) t
WHERE pkey = 10;
"
19627,62088,Selecting from two non-related tables at the same time,"select bt.*, ort.*
from bigtable bt cross join
     onerowtable ort
"
5946,20674,DQL complex query in Symfony2 application,"$query = $entityManager->createQuery('
    SELECT detail, product, 
    SUM(detail.quantity) as quantity, SUM(detail.quantity*detail.prize) as euros
    FROM TransactionDetail detail
    LEFT JOIN detail.transaction transaction
    LEFT JOIN detail.product product
    LEFT JOIN transaction.group product ON group.shop = transaction.shop
    WHERE product.category = :category
    AND group.id = :group
    GROUP BY product
');

$results = $query->execute();
"
22908,58645,Simple tag searching with Sphinx,"sql_joined_field = tags from query; tag.assoc.document_id, \
                   tag_content from tags join tag_assoc on \
                   tags.id=tar_assoc.tag_id order by tag.assoc.document_id asc
"
36267,21117,MySQL Query GROUP BY day / month / year,"GROUP BY YEAR(record_date), MONTH(record_date)
"
12847,40819,Update SQL: Take Value from One Column and Replace Null in Another,"update my_table
set Created_By = User_ID
where Created_By is null
"
16951,13888,"In Mongodb , how do I check if all the documents are unique for a value?","function allDifferent() {
    var m = function() { emit(this.name, 1); }
    var r = function(key, emits) {
        var n = 0; emits.forEach(function(v) { n += v; }); return n;
    }
    var result = db.mycol.mapReduce(m, r, { out: ""namecounts"" });
    var allDifferent= (db.namecounts.count( { value: { $gt: 1 } } ) == 0)
    db.namecounts.drop();
    return allDifferent;
}
"
29209,71344,Persistent SQL Table lock from C#,"ALTER DATABASE dbName 
   ADD FILEGROUP ReadOnlyFG;
GO

ALTER DATABASE dbName 
   ADD FILE (
    NAME = ...,
    FILENAME = '...')
   TO FILEGROUP ReadOnlyFG;
GO

ALTER TABLE tableName MOVE TO ReadOnlyFG;
GO

ALTER DATABASE dbName
   MODIFY FILEGROUP ReadOnlyFG READONLY;
"
4056,73673,Repeated use of an alias within a join,";WITH MyCTE AS
(
<Your complicate query here>
)
SELECT fields
FROM MyCTE
JOIN (subquery referencing MyCTE)
...
"
33675,11504,Multiple duplicate columns - valid normalization?,"Item
=====
ItemID
...


ItemLocation
============
ItemID
LocationID
...



Location
========
LocationID
...
"
8339,7176,T/SQL - String Manipulation,"SELECT 
  string as InitialString
  ,LEFT(LEFT(String,5) + replace(replace(replace(RIGHT(String,LEN(String)-5),
  'Sa','S'),'Su','S'),'--','-') + '--',7) as FinalString
FROM TempTable;
"
4317,50363,Database Design For Image Table,"DATATYPE    DATAID    IMAGEID
 1           10         1
 2            8         2
"
39760,21718,select a max for all records,"select t.*, tmax.date as highpricedate, tmax.price as highprice
from tblstock t outer apply
     (select top 1 t2.*
      from tblstock t2
      where t2.symbol = t.symbol
      order by t2.price desc
     ) tmax;
"
26519,30655,What is difference in performance of following 2 queries,"A (id, name)
B (id) includes (class, std)
C (id) includes (result)
D (name) includes (grade)
"
19142,74291,Grouping values from dynamic columns,"Select * from TAB2 A join 
   (Select ID1, ID2, MIN(ROOT), NAME from TAB2 
       group by ID2, ID1, NAME) B
   on A.ID1 = B.ID1 and B.ID2 = A.ID2 and A.NAME = B.NAME
"
12922,30239,Delete rows in one minute intervals with Postgresql,"delete from t
using (
    select
        sensor_id,
        date_trunc('minute', ""timestamp"") as ""minute"",
        min((extract(epoch from ""timestamp"") / 12)::integer * 12) as ""epoch""
    from t
    group by sensor_id, 2
) s
where
    sensor_id = s.sensor_id
    and
    date_trunc('minute', ""timestamp"") = s.minute
    and
    extract(epoch from ""timestamp"") / 12)::integer * 12 != s.epoch
"
30149,10778,How to determine whether the number is float or integer in SQL Server?,"declare @value float = 1

IF FLOOR(@value) <> CEILING(@value)
BEGIN
    PRINT 'this is float number'
END
ELSE
BEGIN
    PRINT 'this is integer number'
END
"
29269,43258,SQL - condition on field value?,"SELECT
    (SELECT AVG(x) FROM table1 WHERE x >= 0) AS x,
    (SELECT AVG(y) FROM table1 WHERE y >= 0) AS y,
    (SELECT AVG(z) FROM table1 WHERE z >= 0) AS z
"
30054,68848,Neo4J / Is SKIP efficient when handling pagination?,"WHERE val > lastOnPreviousPage
LIMIT Y
"
3717,45623,Oracle Query: Making conditional fetch in single query,"SELECT ti.*, 
       nvl(i.id, n.id) itemid, 
       nvl(i.description, n.description) description, 
       nvl(i.col_sumthing, n.col_sumthing) col_sumthing 
  FROM ticketitems ti
  LEFT JOIN itemdetails i ON ti.itemid = i.id
  LEFT JOIN newsitems n ON ti.itemid = n.id
 WHERE ti.ticket = '100'
"
9288,10037,Parse specific strings in SQL Server,"DECLARE @param NVARCHAR(MAX)
SET @param = 'DealerCode = [MAZ3].AccountID:[4340].StartDate=[2015-06-01]'

SELECT 
     Split.a.value('.', 'VARCHAR(100)') AS CVS  
FROM  
(
    SELECT CAST ('<M>' + REPLACE(@param, '.', '</M><M>') + '</M>' AS XML) AS CVS 
) AS A CROSS APPLY CVS.nodes ('/M') AS Split(a)
"
32685,75281,Return all entries in groups where a group member satisfies condition x,"SELECT distinct players.pid
FROM players as injured
INNER JOIN players on players.team_id = injured.team_id
WHERE injured.injury = 'yes'
"
20651,25006,MySQL Age from Date of Birth (ignore nulls),"SELECT  CASE
            WHEN user.DateOfBirth IS NULL THEN """"
            ELSE year(curdate())-year(user.DateOfBirth) - (dayofyear(curdate()) < dayofyear(user.DateOfBirth)) 
        END AS 'Age'
FROM    myTable
"
21107,38703,Loop not working in package,"begin
for x in (
  select person_id
  from   person
  where  exists (
           select null -- see comment below *
           from   bank_details
           where  bank_details.person_id=person.person_id and
                  bank_form in ('Sal','Reimb')
           having count(*) = 2)
loop
  fnd_output(""This is it!)
end loop
end
"
1445,43690,Dlookup in Query criteria: slow,"WHERE tablex.MsgId > CLng(Dlookup(...))
"
768,45669,Mysql query for sum based off a value in a column group by that column,"Select  Paytype, Sum(Amount) As Total
From    Transact
Where   Date Between '2013-12-15' And '2014-05-01'
Group by Paytype
"
3605,12502,sql between for DAYSOFWEEK,"SELECT item_id, DAYOFWEEK(bookdate) as date, bookdate, AVG(price) AS price 
FROM `availables` WHERE (item_id = 16 and DAYOFWEEK(bookdate) IN (7,1,2)) 
GROUP BY DAYOFWEEK(bookdate)
"
21031,25558,Performing a count on an SQL expression,"SELECT count(*) as number_of_items,
    if(first_name <> """", 1, 0)
    + if(last_name <> """", 1, 0)
    + if(current_avatar is not null, 1, 0)
    + if(username <> """" 
        AND email <> """" 
        AND gender <> """" 
        AND date_of_birth <> """" ,1,0) AS completeness 
FROM `user`
GROUP BY completeness
HAVING (completeness = '4')
"
4145,22645,Scoring Formula with Positive/Negative Rank,"SELECT    UserID, WidgetID, Rank, IsPreferred, Rank() over (Partition BY UserID  order by Rank DESC) as Score
FROM         dbo.Table
Where IsPreferred = 1
Union
SELECT    UserID, WidgetID, Rank, IsPreferred, -1 * Rank() over (Partition BY UserID  order by Rank DESC) as Score
FROM         dbo.Table
Where IsPreferred = 0
ORDER BY UserID, Score
"
25874,110,oracle procedure returns integer,"create or replace
FUNCTION Testing
( 
iKey IN VARCHAR2
) RETURN INTEGER
 AS 

BEGIN
  delete from MyTable WHERE 
  TheKey = iKey;

  RETURN SQL%ROWCOUNT;

END Testing;
"
11166,34671,How do I create a summary data item in Cognos Report Studio?,"total([ORIG_AMT] for [LEAD_ACCT],[PART_FLAG])
"
6608,4871,Not in condition does not consider null in Oracle,"select * from grades where grade not in ('B','C') or grade is null
"
38736,26178,How to generate merit list from exam results in SQL Server,";with cte as
(
select *, dense_rank() over (order by ObtainedMarks desc) as Merit_List
from tstResult
)

select * from cte order by Merit_List desc
"
35540,31271,good way to store tags in relational database when there are variable numbers of tags associated with each piece of information,"SELECT tag_name FROM tags WHERE id IN (SELECT tag_id FROM sentence_tag WHERE sentence_id = $sID);
"
9225,75322,Trying to access field using textmerge command,"for i = 2 to whatEverRange
  lcOtherTable = ""strPath\Table"" + allt( str( i ))

  select T1.Field1, T1.Field2, T1.Field3;
      from Table1  T1;
         inner join (lcOtherTable) TX;
            on T1.Field1 = TX.Field1;
      into cursor C_WhateverTempResultSet

   if reccount( ""C_WhateverTempResultSet"" ) > 0
      */ Do whatever with results

   endif 
endfor 
"
35187,17652,SQL Mapping item code from another table,"SELECT 
    [ORDER].TICKET_NUMBER,
    ITEM_DESCRIPTION.ITEM
FROM [ORDER] 
INNER JOIN ITEM DESCRIPTION ON (Order.ITEM=ITEM_DESCRIPTION.CODE)
"
32542,3303,combine SELECTS in ONE VIEW DISPLAY,"CREATE VIEW [account_balance_sums] AS
  SELECT SUM(balance) AS total, SUBSTRING (Account,0,2) AS account_group
    FROM COA
   GROUP BY account_group
  UNION ALL
  SELECT SUM(balance), 'Grand Total'
    FROM account_group
"
32270,63899,MySQL query String contains,"mysql_query(""
SELECT *
FROM `table`
WHERE `column` LIKE '%{$needle}%'
"");
"
2412,25753,How to select all hours between two dates?,"DECLARE @minDateTime AS DATETIME;
DECLARE @maxDateTime AS DATETIME;

SET @minDateTime = '2014-01-13 02:00:00';
SET @maxDateTime = '2014-12-31 14:00:00';

;
WITH Dates_CTE
     AS (SELECT @minDateTime AS Dates
         UNION ALL
         SELECT Dateadd(hh, 1, Dates)
         FROM   Dates_CTE
         WHERE  Dates < @maxDateTime)
SELECT *
FROM   Dates_CTE
OPTION (MAXRECURSION 0) 
"
17418,67742,MySQL: Sum if rows are equal,"SELECT
    client, 
    thickness,
    material,
    SUM(amount) AS TotalAmount
FROM
    Table1
GROUP BY
    client, 
    thickness,
    material 
"
9248,711,Merging two select queries and displaying first queries record in top,"order by (case when LastName = 'Y' then 1 else 0 end) desc,
         LastName
"
23700,9671,Multivalued key in erd?,"*Table2*

id, date, name

Index1: (id, date, name)

*Table2*

id, date, name, favorite_color

Index2: (id, date, name) references Table2.Index1
"
1241,47327,ORACLE JOIN TABLES,"select coalesce(t1.user_id, t2.user_id) as user_id,
       t2.android, t1.osx
from t1 full join
     t2
     on t1.user_id = t2.user_id;
"
14331,70667,How to add '$' after '-' in SQL Query when formatting for currency,"SELECT (CASE WHEN @val < 0 THEN '-' ELSE '' END)+
    '$'+CONVERT(VARCHAR, ABS(CONVERT(MONEY, @val)), 1)
"
6245,10817,How many tables is acceptable in a Database?,"Table: Folders
    FolderId
    FolderName
    OwnerUserId     -- references Users table to identify the owner
    (additional columns as necessary to describe a single folder)

Table: Users
    UserId
    UserName
    (additional columns as necessary to describe a single user)

Table: FolderUsers
    FolderId    -- references Folders table
    UserId      -- references Users table
    Permission  -- (ViewOnly, Edit, Full, etc)
"
28003,30329,How do I create an SQL query that groups by value ranges,"SELECT B.Description, Total = COUNT(*) / CONVERT(money, (SELECT COUNT(*) FROM Target T2))
FROM Target T
JOIN (
    SELECT 	Description = '0 to 10', LBound = 0, UBound = 10 
    UNION ALL 
    SELECT Description = '10 to 20', LBound = 10, UBound = 20
) B ON T.Value >= LBound AND T.Value < B.UBound
GROUP BY B.Description
"
27351,10744,How to execute an oracle stored procedure?,"begin 
    temp_proc;
end;
"
28462,65433,Left Join Query issue of displaying duplicate results,"SELECT p.person_id, p.person_name, p.instructor_role, IFNULL(lj.company_id, 0) as  company_id, lj.person_id, lj.course_name
FROM person as p
LEFT JOIN courses_by_instructors as lj
      ON (lj.person_id = p.person_id AND lj.company_id = 7 )
WHERE instructor_role = 1
GROUP BY p.person_id,lj.course_name
ORDER BY person_name
"
10147,30084,How to restore the initial state of my Oracle 10g?,"DROP USER USER_NAME CASCADE;
"
8527,48882,Get Columns Returned from SQL Statement,"set fmtonly on
go
insert into execution_log_table
([timestamp]
,user_id
,report_id)
values (CURRENT_TIMESTAMP
,1234
,5678)

select *
from (select column1
,column2
from another_table) tbl
"
10696,66986,How to get the affected rows in stored procedure,"if dbinfo('sqlca.sqlerrd2') = 0 then
   return 0;
else
   return 1;
end if;
"
37171,74516,Update on SQL join,"INSERT INTO EMPLOYEE_GOAL_TABLE (EmployeeID, ISGoal1) 
SELECT EMPLOYEE_TABLE.EmployeeID, 'yes' 
FROM EMPLOYEE_TABLE 
WHERE EMPLOYEE_TABLE.EmployeeID NOT IN
(
   SELECT DISTINCT EMPLOYEE_GOAL_TABLE.EmployeeID
   FROM EMPLOYEE_GOAL_TABLE
)
"
32380,14848,how to add a value to existing value using sql query,"update products
set quantity = quantity + 3
"
4509,55431,Combine multiple rows from multiple tables in MySQL,"SELECT u.id, u.first_name, u.last_name, p.meta_value phone, r.meta_value rating,
       u.country, c.country_fullname
FROM user u
LEFT JOIN user_meta p ON u.id=p.user_id AND p.meta_key='phone'
LEFT JOIN user_meta r ON u.id=r.user_id AND r.meta_key='rating'
JOIN country c ON u.country=c.country;
"
27803,56634,Concatenate in classic asp/vbscript SQL string,"SELECT TBL1.ID,
TBL1.COUNTRY As A,
TBL1.STATE As B,
TBL1.CODE As C
FROM TBL1 
  INNER JOIN TBL2 ON CAST(TBL1.COUNTRY AS varchar(20)) + '.' + CAST(TBL1.STATE AS varchar(20)) + '.' + CAST(TBL1.CODE AS varchar(20)) = CAST(TBL2.ID AS varchar(20))
"
16299,45037,Combining two Time Interval queries,"select Arr_Date,
       Interval,
       sum(case when Han_Time > 1800 then 1 else 0 end) as Han_Time_1800,
       sum(case when SL_Time > 300 then 1 else 0 end) as SL_Time_300
from Call_Data
where Han_Time > 1800 or 
      SL_Time > 300
group by Arr_Date, Interval
order by Arr_Date, Interval 
"
31155,40771,query in ms access for pulling data by giving parameters for current date,"SELECT t1.[Ticket Number], t1.[Time Received], 
   t1.[Time Read], t1.[Time Replied], 
   t1.[Replied By], t1.[Called Customer?], 
   t1.[Call Duration], t1.[Email Duration], t1.[General Issue] 
FROM t1 
WHERE [DDATE]=DATE()
"
19246,58902,Issue with NOT LIKE,"SELECT DISTINCT(ItemID)
FROM   Items 
WHERE  ItemID NOT IN 
       (
           SELECT ItemID
           FROM   Items 
           WHERE Brand LIKE '%es%' 
       )
"
27964,15115,Problem joining on the highest value in mysql table,"SELECT p.*, r.*
FROM products AS p
  JOIN revisions AS r USING (product_id)
  LEFT OUTER JOIN revisions AS r2 
    ON (r.product_id = r2.product_id AND r.modified < r2.modified)
WHERE r2.revision_id IS NULL;
"
10539,214,Getting random data from grouped data in one table,"SELECT PATIENT_ID 
FROM TB_Patient 
WHERE PATIENT_GROUP = <group_id> 
ORDER BY RANDOM() 
LIMIT 1
"
22552,40759,"MySQL List Set theory, relational database","select *
from business
where not exists(
  SELECT 1 FROM 
  ( 
      -- nested query that retrieves values of list 1
      SELECT val FROM list1
  ) x
  JOIN
  (
    -- nested query that retrieves values of list 2
      SELECT val FROM list2
  ) y
  ON x.val = y.val
);
"
27643,60476,Group query results by month and year in postgresql,"select to_char(date,'Mon') as mon,
       extract(year from date) as yyyy,
       sum(""Sales"") as ""Sales""
from yourtable
group by 1,2
"
14028,28715,How to get total number of rows in a executed select statement?,"SELECT a.Emp,b.orders, RN = ROW_NUMBER () OVER (ORDER BY a.Emp,b.orders) 
FROM table as a inner join table1 b on a.ID=B.ID
"
34355,61396,SQL: cascade UNION and JOIN,"SELECT
    *
FROM
    TABLE_3
    LEFT JOIN
    (
    SELECT ID_1, name_1, surname_1, FROM T_ONE
    UNION --ALL would be more efficient if results do not overlap, as van's comment said
    SELECT ID_2, name_2, surname_2 FROM TABLE_2
    ) foo  ON TABLE_3.ID_3 = foo.ID_1
"
33142,53142,Creating a trigger to only run when a new table is being created,"CREATE OR REPLACE TRIGGER 
  create_table_trigger
  AFTER CREATE ON SCHEMA
BEGIN
  IF SYS.DICTIONARY_OBJ_TYPE = 'TABLE' THEN
      ....
END;
"
639,52998,SQL EXCEPT performance,"select field1,field2,field3,field4,field5 from dev.dbo.table1 
where field1+field2 in ('string1','string2','string3',...,'string50')
except
select field1,field2,field3,field4,field5 from test.dbo.table1 
where field1+field2 in ('string1','string2','string3',...,'string50')
option (hash join, merge join)
"
17240,71069,sql update statement for two tables," UPDATE menu_items mi 
     JOIN inventory_items ii ON mi.bin_number=ii.bin_number 
         AND mi.location_id=ii.location_id
 SET mi.inventory_item_id = ii.id 
"
13392,646,Mind teaser SQL,"SELECT distinct pt_pc.maker
FROM  
  laptop l 
    inner join product pt_l on pt_l.model=l.model, 
  pc
    inner join product pt_pc on pt_pc.model=pc.model
WHERE pc.speed >=750 and l.speed >=750 and pt_l.maker=pt_pc.maker
"
5623,19507,Store result of dynamic SQL generating XML to XML Variable,"set @sql = N'set @XML = (select * from my.table where tableId = 1 FOR XML AUTO)'
execute sp_executesql @sql, N'@XML XML OUTPUT', @XML OUTPUT
"
7546,20938,Sorting table count by sql,"select u1.firstname,
  u1.id,
  coalesce(u2.total, 0) total
from users u1
left join
(
  SELECT affID, count(affID) Total
  FROM Users 
  group by affID 
) u2
  on u1.id = u2.affID
order by u2.total desc;
"
11486,14211,#1075 MySQL Error,"CREATE TABLE `testing` (
  `id` INT NOT NULL AUTO_INCREMENT, 
  `date` DATE NOT NULL, 
  `text_1` TEXT CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL, 
  `text_2` TEXT CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE = MYISAM ;
"
12444,67652,Sort table by difference of datetimes of rows with same name,"SELECT username,HOUR(TIMEDIFF(MAX(AccessTime),MIN(AccessTime))) timedifference FROM table
GROUP BY username ORDER BY timedifference
"
29195,19869,Get the first space on the left of varchar SQL,"DATALENGTH(@variable)
"
8915,10380,How do I query multiple tables using inner join?,"select A.colx, A.coly, A.colz, B.colx, B.colw, c.cold 
from A inner join B on A.ID=B.A_ID 
     inner join C on C.A_ID=A.ID
"
4269,3362,Check constraint for start/end date,"ALTER TABLE tableX
  ADD CONSTRAINT end_date_later_than_start_date_CK   -- a sensible name 
                                                     -- for the constraint
    CHECK (start_date <= end_date) 
    <optional constraint state>
; 
"
4311,11518,How to query and compare values of two tables?,"UPDATE TimeRequestedTable
INNER JOIN BlockTimesTable ON BlockTimesTable.EmpID = TimeRequestedTable.EmpID
SET AppointTime = ""inputed by user""
WHERE AppointTime BETWEEN startTime and EndTime
"
11790,44315,Confused in my Left Join,"SELECT Year(Date) AS Year, Month(Date) AS Month, Avg(tblSales.Sales) AS AvgSales
FROM tblSales
LEFT JOIN tblHolidays
     ON tblSales.[Date] >= tblHolidays.[Date From]
        AND tblSales.[Date] <= tblHolidays.[Date To]
        AND tblHolidays.[Type] = 1 AND tblHolidays.[Region] = ""All""
WHERE tblHolidays.[Date From] Is Null
GROUP BY Year(Date), Month(Date);
"
11365,31532,"Select statement, table sample, equal distribution","SELECT *
FROM (
    SELECT *, ROW_NUMBER() OVER (ORDER BY id) RN
    FROM Stats
) T
WHERE RN % 100000 = 0
ORDER BY id
"
34421,54095,Select from several tables with fix count rows in relative table,"select m.ThreadId
from members m
group by m.ThreadId
having count(*) = 2 and
       sum(case when m.name = 'AAA' then 1 else 0 end) = 1;
"
32000,37236,Sorting a SQL query by number of fields in a grouped selection,"SELECT product, COUNT(*) AS NumberOfEntries 
FROM Products 
GROUP BY product 
ORDER BY NumberOfEntries DESC
"
24225,16991,Extract text from CLOB PL/SQL NameSpace,"xmltype(replace(t.detailbericht,'ns0:','')).extract('//Tekst_Reden_Afwikkeling/text()').getStringVal() as Tekst_Reden_Afwikkeling
"
26457,54357,"How do I add a ""total_num"" field by aggregating equal values with SQL?","SELECT s.STATE, s.REGION, s.CAPITAL, COUNT(*) as 'COUNT'
FROM secondtable s
JOIN firsttable f ON s.STATE = f.STATE
GROUP BY f.STATE, f.REGION, f.CAPITAL
ORDER BY COUNT(*) DESC
"
8349,52472,Database better inner join for performance in this case,"SELECT *
FROM product p
INNER JOIN product_time pt
    ON pt.product_id = p.id
INNER JOIN (
    SELECT times_id, SUM(time_in_minutes) as time_in_minutes
    FROM times_intervals
    GROUP BY times_id
) AS t
    ON t.times_id = pt.times_id
"
37798,34776,Fill with zero to complete a defined number in sql,"select '11111' || to_char(25, 'FM000000000') from dual;

11111000000025
"
38133,514,Select only the rows where column values appear more than once,"select *
from A
  inner join B on A.id_x = B.id_x
  inner join C on B.id_y = C.id_y
  inner join D on C.id_z = D.id_z
where
  A.date > '2014-01-01'
  and A.id_y = 154
  and D.id_t = 2
  AND  A.id_x IN
  (
  SELECT A.id_x FROM A
  GROUP BY A.id_x
  HAVING count(A.id_x)>1);
"
22016,44985,SQL - Finding continuous entries of a given size,"WITH FreeSeatGroups AS
(
    SELECT S1.SeatID AS StartID,
           (SELECT MIN(S2.SeatID)
            FROM Seats S2 
            WHERE S2.SeatID > S1.SeatID
            AND S2.Reserved = 1) - S1.SeatID AS FreeSeatCount
    FROM Seats AS S1
    WHERE S1.Reserved = 0
)
SELECT StartID, FreeSeatCount
FROM FreeSeatGroups
WHERE FreeSeatCount >= 2
"
5264,23597,How to get start date and end date of an event from end date,"SELECT event_id, event_name,
   LAG (event_end_date ) OVER (ORDER BY event_end_date ASC )+1
                                                         event_start_date,
   event_end_date
 FROM event
"
22726,48398,Concat SQL result,"SELECT R.R_Name, SUM(UG.Occupants) / R.Pax as PercentageOfRoomOccupied
FROM Rooms R
LEFT JOIN UserGroups UG ON R.Id = UG.R_Id
WHERE R.B_ID = 1
GROUP BY R.R_Name, R.Pax
"
2390,26609,3 different sql queries in one row,"select a.asum,b.bsum,(a.asum-b.bsum) from 
       (select SUM(column1) as asum from database1.table1 where condition1)a,
       (SELECT SUM(column2) as bsum from database2.table2 where condition2)b
"
32568,26031,Grab one for each id,"SELECT de.id, d.name, de.title 
FROM discos_events de INNER JOIN places d ON (de.dID = d.id) 
WHERE de.date = (SELECT MAX(t.date)
                 FROM disco_events t
                 WHERE t.dID = de.dID
                       AND unix_timestamp(now()) > t.date)
LIMIT 10;
"
35553,69915,Fetching Columns of a multiple rows in one row,"SELECT *
FROM (
   SELECT attr_name, attr_value
   FROM   test
)
PIVOT
(  MIN(attr_value)
   FOR attr_name IN ( 'ABC','GHI','MNO' )
)
"
24933,20804,How can I write a query with unwated spaces in my text?,"replace(columnToSearch,'  ',' ') 
"
37052,19341,how can I use loop 'for' through a table in SQL to check if a column is 0?,"INSERT INTO Table1 (ColList) 
     SELECT ColList 
       FROM SourceTable 
      WHERE Column1 = 0;

INSERT INTO Table2 (ColList) 
     SELECT ColList 
       FROM SourceTable 
      WHERE (Column1 <> 0 OR Column1 IS NULL);
"
32200,19737,How do I create an If-Then-Else in T-SQL,"Select
    Case When [Value] < 0 Then 0 Else [Value] End
From 
    Example
"
16195,15880,SQL - fetch latest row with data in specific column or just latest row if no data in that column,"SELECT  user_id, address1 
FROM    transaction t 
WHERE   user_id = 70005 
    AND row_id = 
        IFNULL(
          (SELECT MAX(row_id) 
         FROM transaction ti 
         WHERE ti.user_id = t.user_id AND address1 IS NOT NULL),

         (SELECT MAX(row_id) 
         FROM transaction ti 
         WHERE ti.user_id = t.user_id ) 
        );
"
14964,19820,how to take dump of a table in parts and save it on different server?,"mysqldump --host=myserver -u backup mydb > test.sql
"
12205,29004,PLSQL: Possible to use BOOLEAN datatype in SQLPLUS?,"DECLARE
  l_some_bool BOOLEAN := true;
BEGIN
  IF( l_some_bool )
  THEN
    dbms_output.put_line( 'true' );
  END IF;
END;
"
22312,48460,updating(copying) specific column values from tmp table to main table in Mysql,"UPDATE tbl1 t1, tmpTbl1 t2 
SET t1.positionName=t2.positionName, t1.positionId=t2.positionId 
WHERE t1.id=t2.id AND t1.userName=t2.userName;
"
13680,52227,Foreign Keys to Composite Key,"CREATE UNIQUE NONCLUSTERED INDEX SomeIndex ON YourTable(BId,  CId)
"
59,60430,"Insert results of query 2 into query 1, but query 2 has no key","Select tt.TransactionDate, tt.LoanNumber,
       max(tt.TransactionDate) over () as DataDate
From TransactionsTable tt;
"
13115,13879,Select minimum date value in a table,"select Account, security_name, broker_name, balance_bf, tran_amt, tran_date,
   FIRST_VALUE(balance_bf) OVER (PARTITION BY security_name, broker_name ORDER BY tran_date) as first_balance,
   FIRST_VALUE(tran_date) OVER (PARTITION BY security_name, broker_name ORDER BY tran_date) as first_tran_date
from customer_transactions;
"
1813,66837,how to replace string values of column values by SQL Stored Procedure,"UPDATE MyTable SET ColumnNeedUpdate = 
    REPLACE(ColumnNeedUpdate, 'l:\xyz\sfd\', '')
WHERE UserId = 2565
"
26356,42823,How to compare components of a date as a single date in Postgres?,"SELECT DISTINCT ON (release) *
FROM   release_country
ORDER  BY release, date_year, date_month, date_day;
"
21228,9508,Set value to variable and modify based on condition SQL,"select @variable = case
                        when max(max_val) > @variable then @variable
                        else max(max_val)
                    end
from dataset
where account_id = 'abc'
and product = 'xyz'
"
28876,74827,"mysql , max ,groub by","select * from (/* your SQL statement without ""order by""*/) a order by a.message_id desc
"
39082,32069,select a table and join 2 diffrent table,"select *
from book b
left join male m on m.m_id=b.b_author
left join female f on f.f_id=b.b_author*-1
"
7680,47515,Return Order Date Format Differently,"CONVERT(VARCHAR(10),OrderDate,10) as OrderDate
"
7116,11542,mysqli_insert_id() not working?,"mixed mysqli::mysqli_insert_id ( mysqli $link )
"
32524,2048,Counting skill for each person,"select skills, count(*) as cnt
from (select sk.id_person, group_concat(distinct sk.id_skill order by sk.id_skill) as skills
      from person_skill sk
      group by sk.id_person
     ) ps
group by skills;
"
8759,30111,SQL cross-reference table self-reference,"BEGIN;

INSERT INTO participants (type, name)
  SELECT DISTINCT 'team', team_name
  FROM all_names
  UNION
  SELECT DISTINCT 'member', member_name
  FROM all_names;

INSERT INTO belongs_to 
  SELECT m.id, g.id, a.member_start, a.member_end
  FROM all_names a
  JOIN participants m ON m.name = a.member_name
  JOIN participants g ON g.name = a.team_name;

COMMIT;
"
39802,21052,Querying tables based on other column values,"select case when a.id = 1 then a.attr_value_int
            when a.id > 1 then b.some_other_col
            else null end as whatever
from first_table a
     left outer join other_table b
     on ( a.attr_val_ext = b.id )
/
"
13722,22953,Multiple COUNT() for multiple conditions in one query (MySQL),"SELECT color, COUNT(*) FROM t_table GROUP BY color
"
4307,59017,Oracle group/count query,"with t2 as (
    select  ColA2, ColB2, count(*) cnt 
    from TableTwo
    group by ColA2, ColB2 
)
select t1.Id1,
(  select max(cnt) MaxDup
   from t2
   where t2.ColA2=t1.Id1)
from TableOne t1
"
19176,60798,Get the Column Names of a Stored Procedure when using BCP QueryOut,"SELECT 'col1', 'col2'
UNION ALL
SELECT Name1, MAX(Name) OVER (PARTITION BY Name)
FROM table
"
3899,20761,Column Split Sum over a single ID,"select 
  ID,
  Sum(CASE When Year = 2009 then Revenue ELSE 0 END) as Y2009,
  Sum(CASE When Year = 2010 then Revenue ELSE 0 END) as Y2010
From
  YourTable
Group by ID
"
10961,44774,How to search in 5 different fields with all possible choices in no particular order in MySQL using LIKE,"SELECT * FROM Users
WHERE (FirstName LIKE ""%Persons%""
OR LastName LIKE ""%Persons%""
OR Address LIKE ""%Persons%"")
AND (FirstName LIKE ""%Name%""
OR LastName LIKE ""%Name%""
OR Address LIKE ""%Name%"")
AND (FirstName LIKE ""%Fake%""
OR LastName LIKE ""%Fake%""
OR Address LIKE ""%Fake%"")
AND (FirstName LIKE ""%Street%""
OR LastName LIKE ""%Street%""
OR Address LIKE ""%Street%"")
"
8520,46639,What is causing my values to be printed as #,"SET LINESIZE 200
COLUMN 'Pharmaceutical Companies' FORMAT a25
COLUMN 'Drug Count' FORMAT 999,999,999,999
"
26251,68682,SQL - Multiple Group By statements with counts,"select t.A
from mytable as t
group by t.A
having min(t.B) = max(t.B);
"
8713,745,Selecting primary keys that do not have foreign keys in another table,"select u.id
from users u
left outer join actions a on a.user_id = u.id
where a.user_id is null
"
20961,64507,Best way to produce automated exports in tab-delimited form from Teradata?,".EXPORT OUTFILE &dwoutfile MODE RECORD FORMAT TEXT;
"
1070,72743,MYSQL combine view of two table having different number of entry records in date range,"SELECT * FROM
  (SELECT Sale.Date AS Date, Sale.Description AS SaleDescription, """" AS   ExpenseDescription, Sale.Amount AS SaleAmount, """" AS ExpenseAmount
   FROM Sale
   WHERE Sale.Date >= '2014-09-01'
   UNION ALL
   SELECT Expense.Date AS Date, """" AS SaleDescription, Expense.Description AS ExpenseDescription, """" AS SaleAmount, Expense.Amount AS ExpenseAmount
   FROM Expense
   WHERE Expense.Date >= '2014-09-01') AS SaleExpense
ORDER BY
  SaleExpense.Date ASC
"
17399,65173,SQL - Set field value based on count of previous rows values,"  SELECT ID, 
         Name, 
         ROW_NUMBER() OVER (PARTITION BY Name ORDER BY ID) AS Number
    FROM YourTable
ORDER BY ID
"
30382,50618,Sql: Select where a condition is true for all types,"SELECT ProjectId, EmployeeId
FROM Temp
GROUP BY ProjectId, EmployeeId
HAVING MAX(IsWarning    + 0) = 0
   AND MAX(IsExpired    + 0) = 0
   AND MIN(IsIncomplete + 0) = 1
"
30280,65918,How to count the occurence of a column which is the result of a concatenation of a string and integer,"SELECT b.*,
      (b.AUDTORG + CAST(b.SEQUENCENO AS varchar(255)) )as NewID,
      count(*) over (partition by b.AUDTORG + CAST(b.SEQUENCENO AS varchar(255)) ) as Occurence
FROM ADXDAT.dbo.BKENTD b;
"
3166,30653,Delete Duplicate SQL Records,"delete 
   t1 
from 
   tTable t1, tTable t2 
where 
   t1.locationName = t2.locationName and  
   t1.id > t2.id
"
562,6955,SQL-query to find articles with at least one of the listed tags,"select articles.article_id, count(tags.tag_id) as num_tags, group_concat(distinct tag_name separator ',') as tags
from articles, article_tag, tags
where articles.tag_id = article_tag.tag_id
  and article_tag.tag_id = tags.tag_id
  and tags.tag_name in ( 'jazz', 'funk', 'soul', 'Britney Spears' )
group by articles.article_id
order by count(tags.tag_id) desc
"
13652,43726,SQL check value is within variable (and multiple) number of ranges,"SELECT * FROM
   [ADataBase].[dbo].[AFirstTable] first
       inner join
   [DHL].[dbo].[ASecondTable] second
       on
          first.[ALongIDNumber] between second.[StartOfIDRange] and second.[EndOfIDRange]
WHERE
   second.[date] BETWEEN '20100121' AND '20100122'
"
26256,4629,Count all files on SQL,"select * from TABLE
where  regexp_count(notas,',') between 1 and 5
"
4866,66662,Compressing sql rows for oracle 10g,"SELECT type, 
       name, 
       MAX(color) color, 
       MAX(description) description
  FROM table_name
 GROUP BY type, name;
"
13858,65149,How do I determine the collation of a database in SQL 2005?,"SELECT DATABASEPROPERTYEX('{database name}', 'Collation') SQLCollation;
"
38266,56222,Query on a self-referential table,"SELECT  a.""UserID"",
        a.""Name"",
        b.""Name"" As AIDName
FROM    tableName a
        INNER JOIN tableName b
            ON a.""AidID"" = b.""UserID""
"
5152,66684,"Extremely slow query with multitables and LEFT JOIN, both in MySQL and PHP","CREATE INDEX idxrankginsuuid ON rankings(uuid);
CREATE INDEX idxrankingsseller ON rankings(seller);
CREATE INDEX idxrankingskey ON rankings(key);

CREATE INDEX idxitemsuuid ON items(uuid);

CREATE INDEX idxuserseller ON users(seller);
"
30,57050,Where to put condition in JOIN Query?,"SELECT RES.PARTYNAME, RES.DISTRICT, COUNT( RES.CONSTITUENCY ) AS VOTESCOUNT 
FROM voter_count RES 
JOIN 
  (SELECT CONSTITUENCY, MAX(VOTES) AS VOTES 
   FROM voter_count
   GROUP BY CONSTITUENCY) MAXS 
USING (VOTES, CONSTITUENCY)
WHERE RES.DISTRICT = 'nagpur'  
GROUP BY PARTYNAME, DISTRICT
"
12382,31467,a sql query with multiple search word,"select inL.name from dbo.[inventoryLocalization] inL 
where not exists
    (select 1 from fnSplitString(N'red green blue',' ') words 
    where (inL.name NOT LIKE '%'+ words.item +'%'))
"
19995,42284,SQL Server 2008 : update the table with primary key,"MERGE INTO ProductionDB.Schema.ParentTable A
USING DevelopmentDB.Schema.ParentTable B
ON A.ParentID = B.ParentID
WHEN MATCHED THEN
UPDATE SET A.Name = B.Name, A.Value = B.Value;
"
38238,20133,How to update a record using SQL in ASP,"<form action=""divProgramProcess.asp"" id=""countInput"" class=""contact_form"">

<input type=""text""  name=""Shipment_Current"" id=""Shipment_Current"" value=""<% =Shipment_Current %>"" />
<input type=""text""  name=""Couch_Current"" id=""Couch_Current""  value=""<%= Couch_Current %>"" />
<input type=""text""  name=""Person_Available_Current"" id=""Person_Available_Current""  value=""<%= Person_Available_Current %>"" />
<input type=""hidden"" name=""div"" value=""<% =divrec %>"" />
</form>
"
32802,22366,Find count of item that occurs in multiple columns,"select id, sum(cnt) as n_docs
from ((select source_document_id as id, count(*) as cnt
       from similarity
       group by source_document_id
      ) union all
      (select target_document_id as id
       from similarity
       group by target_document_id
      )
     ) t
group by id;
"
34964,55656,How can I compare 2 columns in 2 tables to check for UNEQUAL values,"SELECT * FROM Table1 as T1
LEFT JOIN Table2 as T2 on T1.ColumnA = T2.ColumnB
WHERE T2.T2ID IS NULL
"
15227,37626,Apply grouping to a SQL Server view,"SELECT Cast(Datepart(YEAR, StartDate) AS VARCHAR(4))
       + '-'
       + Cast(Datepart(MONTH, StartDate) AS VARCHAR(2)) AS StartDate,
       Count(ServicePictureID)                          AS TotalPicture
FROM   PictureCount
WHERE  ProjectID = '11'
       AND CreatedDate BETWEEN '2014-10-31' AND '2014-12-06'
GROUP  BY Datepart(YEAR, StartDate),Datepart(MONTH, StartDate) 
"
28662,68995,SQL Group by different time periods with day,"SELECT CAST([Date] AS Date) AS [Date],
COUNT(CASE WHEN DATEPART(hour, [Date]) BETWEEN 9 AND 11 THEN 1 ELSE NULL END)
    AS [Sales 9am-12pm],
COUNT(CASE WHEN DATEPART(hour, [Date]) BETWEEN 12 AND 14 THEN 1 ELSE NULL END) 
    AS [Sales 12pm-3pm],
COUNT(CASE WHEN DATEPART(hour, [Date]) BETWEEN 18 AND 20 THEN 1 ELSE NULL END) 
    AS [Sales 6pm-9pm]
FROM Table
GROUP BY CAST([Date] AS Date) /*For SQL2008*/
"
25554,64957,MS Access: select first occurrence within a group,"SELECT t.CustID, t.OrderYear, Min(t.Quarter)
FROM
    Table1 AS t
    INNER JOIN
    (
        SELECT CustID, Min(OrderYear) AS MinOfOrderYear
        FROM Table1
        GROUP BY CustID
    ) AS sub
    ON
           t.CustID = sub.CustID
       AND t.OrderYear = sub.MinOfOrderYear
GROUP BY t.CustID, t.OrderYear;
"
33286,22993,Create a new column and generate numbers in that column using TSQL,"/*To add the new column*/
ALTER TABLE emps ADD employee_no INT NULL

/*To populate it*/
;WITH T
     AS (SELECT employee_no,
                dense_rank() OVER (ORDER BY employee_name, employee_address) AS
                new_employee_no
         FROM   emps)
UPDATE T
SET    employee_no = new_employee_no   
"
30173,60883,A primary key's issue in mysql,"create table CongViec(
ID_VT int not null,
TenVT text,
loaiVT text,
donvt text,
tinhtrang text, 
xuatxu text, 
soluongton int,
inhhoa text,
ghichu text,
primary key (ID_VT)
);
"
6236,58674,Get information from multiple identical mysql tables,"(SELECT * FROM table1 where date = '2011-06-23')
UNION
(SELECT * FROM table2 where date = '2011-06-23')
UNION    
(SELECT * FROM table3 where date = '2011-06-23')
UNION    
(SELECT * FROM table4 where date = '2011-06-23')
"
37198,8071,How to display monthwise report in mysql,"select otherColumns, 
  max(case when month(productiondate)=1 then value end) Jan,
  max(case when month(productiondate)=2 then value end) Feb,
  max(case when month(productiondate)=3 then value end) Mar,
  max(case when month(productiondate)=4 then value end) Apr,
  max(case when month(productiondate)=5 then value end) May,
  max(case when month(productiondate)=6 then value end) Jun,
  ....
from yourtable
group by otherColumns
"
33886,15603,SQL statement returns wrong values (TOP n ... ORDER BY),"select top n ...
from (
  select ...
  from table
  where ...
  order by ...
)
"
21273,15260,Tip on joining three tables,"SELECT
    o.`order_id` as `Order ID`,
    o.`STATUS` as `Order Status`,
    o.`date_created` as `Date Created`,
    op.`SKU`,
    op.`NAME`,
    o.`STATE`,
    op.`QUANTITY`,
    c.`email`
FROM
    `orders` o
INNER JOIN
    orderProducts op on op.order_id = o.order_id
INNER JOIN
    customers c on c.customer_id = o.customer_id
WHERE
    o.order_id IN (616898, 616901)
"
35358,59438,Oracle :Matching row from first and second table,"SELECT c.code, c.name ,c.section,p.cptprice
  FROM First c, 
       (select * 
          from second 
         where id = 1001 
           and transactionby = 'q@abc.com') p
WHERE c.code IN
           ('00', '00', '00', '00', '01140', '01160', '01180', '01210',
            '01212', '01215', '01200', '01670', '01680', '01682', '00', '00')
  AND c.code = p.code(+)
"
34093,5278,Getting data using distinct in T-SQL,"SELECT CsvLocation, MAX(ExportedDate)
FROM your_table
GROUP BY CsvLocation
"
23067,53064,SQL Select Command with Unicode string is not Retrieving the Expected Data,"SELECT * FROM PARTY 
WHERE NAME LIKE N'رانا عطا ربانی' 
ORDER BY SRNO
"
241,45347,Setting the Date Format in the SQL*Loader Control File,"LOAD DATA
INFILE 'c:/load/CW_COMPLIANCE.csv'
APPEND
INTO TABLE tbl_name
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '""'
(
COMPLETED_ON DATE 'DD Month, YYYY HH:MI:SS AM',
)
"
3374,6812,"ms sql 2008 - one table , multiple filter","Select p1.fkProductId From AttributeBindings p1
    inner join AttributeBindings p2 on p1.fkProductId = p2.fkProductId
where 
    (p1.fkAttributeId = 17 and p1.fkAttributeValueId = 97)
    and (p2.fkAttributeId = 6 and p2.fkAttributeValueId = 11)
"
39994,58542,Django queryset: Filter by reverse key and order by,"last_statuses=Status.objects.filter(
    id__in=Status.objects.order_by('procedure_id', '-pk').distinct('procedure_id')
).filter(status=1)

procedures = Procedure.objects.filter(id__in=last_statuses.values('procedure_id'))
"
36340,67592,Complex SQL Query w/ Multiple Tables,"select customer_id
from orders
group by customer_id
having count(distinct product_id) >= 4
"
8152,45006,"SQL server query, select first date where enough stock","SELECT top 1
cast(t1.Date as  datetime),
T1.Qty
,SUM(cast (T2.Qty as int)) AS cumulqte
FROM
  ##temptest3 T1
    INNER JOIN ##temptest3 T2
        ON cast(t1.Date as  datetime) >= cast(t2.Date as  datetime)
GROUP BY T1.id, cast(t1.Date as  datetime), T1.Qty
HAVING SUM(cast (T2.Qty as int)) >=210
ORDER BY cast(t1.Date as  datetime);
"
33788,24133,"How to find ""holes"" in a table","select ID +1 From Table t1
where not exists (select * from Table t2 where t1.id +1 = t2.id);
"
34988,45294,Sequential scan in postgres is taking surprisingly long. How do I determine the hardware bottleneck?,"51sec * 120MB/sec ~ 6GB
"
28296,43447,"SQL - referencing a column name with [ , ] characters","SELECT
  AVG(""distance[m]"") AS avg_distance
FROM
  distance_table
"
30813,4518,tSQL NOT IN Query,"select ID from
[172.28.101.120].[GenesysIS].dbo.interactions 
where media_type = 'email'
and type = 'Outbound'
AND ID NOT IN (SELECT ID FROM EmailOut)
"
21166,66370,Postgres 9.2 PL/pgSQL simple update in loop,"with new_numbers as (
   select id,  
          trail_id,
          row_number() over (partition by trail_id order by id) as position
   from photos
)
update photos
  set position = nn.position
from new_numbers nn
where nn.id = photos.id;
"
27934,59728,SQLITE: Create View to multiple tables via index,"SELECT access.date, ips.ip, machineIDs.machineID, platforms.platform, platforms.os, apps.application, apps.buildNum, access.responseCode 
FROM access
    LEFT JOIN ips ON access.ip_id = ips.id
    LEFT JOIN machineIDs ON access.machineID_id = machineIDs.id 
    LEFT JOIN platforms ON access.platform_id = platforms.id
    LEFT JOIN apps ON access.application_id = apps.id
"
2008,34268,sql join 2 rows in the same table,"select 
    address.name,
    address.value as address,
    phone.value as phone
from
    yourtable as address left join
    yourtable as phone on address.name = phone.name
where address.type = 'address' and
      (phone.type is null or phone.type = 'phone')
"
11149,71876,Aros table in CakePHP is still including Users even after bindNode,"public $actsAs = array('Acl' => array('type' => 'requester', 'enabled' => false));
"
34372,57190,SQL Replace comma in results without using replace,"SELECT REPLACE(MyField, ',', ';') AS NewFieldName
FROM MyTable
"
23465,34629,PostgreSQL - using to_tsvector with SELECT,"UPDATE users
SET tsv = to_tsvector(s.tsv)
from
    (  
        SELECT id, string_agg(title) tsv
        FROM
            users
            INNER JOIN
            articles ON user.id = articles.user_id 
        GROUP BY user.id
    ) s
where users.id = s.id
"
8797,21350,Retrieving data based on a sorted set of primary keys,"-- Load the array with sort information into temp_snr_tab
for i in 1..varray_of_snr.last loop
  insert into temp_snr_tab values (varray_of_snr(i), i);
end loop;

-- Get the data correctly sorted 
open getdata for
  select field1,
         field2,
         field3
    from MyTable,
         temp_snr_tab snr_tab
   where MyTable.snr = snr_tab.snr
   order by snr_tab.sort_id;
"
270,17927,Can I check which database is running configuration and content for a WSS 3.0 site?,"Event Type: Error
Event Source: Windows SharePoint Services 3
Event Category: Database 
Event ID: 3760
Date:  4/16/2009
Time:  11:51:07 AM
User:  N/A
Computer: IMIAPP03
Description:
SQL database  **'STS_Config'** on SQL Server instance 'np:\\.\pipe\MSSQL$Microsoft##SSEE\sql\query' not found. Additional error  information from SQL Server is included below.

Cannot open database ""STS_Config"" requested by the login. The login failed.
Login failed for user 'NT AUTHORITY\NETWORK SERVICE'.

For more information, see Help and Support Center at http://go.microsoft.com/fwlink/events.asp.
"
16863,70175,Standard approach when mixing several INNER with several LEFT OUTER JOINs,"select . . .
from <really important table> t left outer join
     . . .
"
12731,58355,SQL breaking a string between characters in a view,"declare @a as varchar(100)
set @a='Trading~Concession~Telemetry - OCPD / Low Sales'

select substring(@a,0,patindex('%~%',@a)) as trading_status,reverse(substring(reverse(@a),0,PATINDEX('%~%',(reverse(@a))))) as problem1,
substring(@a,patindex('%~%',@a)+1,10) as problem2
"
3159,50477,GROUP BY clause on multiple joins,"SELECT CM.ClassName ,
SB.SubjectName , count(SA.Day1) as Present,
convert(varchar(10),AttendanceDate , 126)  as AttendancetimeTaken
from studentattendance SA 
inner join studentmaster SM on SA.StudentID=SM.ID  
join ProfessorMaster p on SA.ProfessorID =p.Id 
join Classmaster CM on SA.ClassID = CM.ID 
inner join SubjectMaster SB on SA.SubjectID =SB.ID
where SA.day1 = 'P'
group by CM.ClassName, SB.SubjectName, AttendanceDate
"
37201,43138,What is the sql query for this task to find first and last entry?,"SELECT min(date(timestamp1)) as FirstVisit, max(date(timestamp1)) as LastVisit, count(distinct(date(timestamp1))) as distinctDays from yourtablename
"
17032,25875,"SQL - Last 6 months (12,18,24,30) divisor by 6 months query","SELECT  *
FROM    T
        INNER JOIN
        (   SELECT  [Date] = DATEADD(MONTH, - Number, @Date)
            FROM    Master..spt_values
            WHERE   Type = 'P'
            AND     Number % 6 = 0
        ) D
            ON D.Date = T.LastSalesDate
"
35671,31335,Select and summarize data from three tables,"    SELECT 
orders.id, orders.date, 
SUM(order_details.qty * order_details.cost) AS amount, 
SUM(order_details.qty) AS qty
FROM  orders  
LEFT JOIN order_details ON  order_details.order_id=orders.id 
AND orders.customer_id = 1 
GROUP BY orders.date
HAVING amount is not null AND qty is not null
"
32033,45792,INSERT INTO for each SELECT returns,"insert into some_table (col1, col2, col3)
SELECT field1, field2, 'additional data'
FROM table1 
WHERE field1 IS NOT NULL AND field2 IS NOT NULL
"
23668,46388,MySQL vote history for user with total vote count for each item,"SELECT COUNT(DISTINCT v.VOTE_ID) VOTECOUNT, n.ID, n.NAME
FROM `votes` as v
LEFT JOIN `names` as n
ON n.ID = v.NAME_ID
GROUP BY n.ID, n.NAME
HAVING MAX(CASE WHEN v.VOTER_ID = :id THEN 1 ELSE 0 END) = 1
"
15658,33201,Select a row or rows only when a status change in status column in Oracle,"select carid, carmodel, statusdate, statuscode, duration
from
(
  select carstatus.*, lag(duration) over (order by carid, statusdate) AS previous_duration
  from carstatus
)
where duration <> nvl(previous_duration,-1)
order by carid, statusdate;
"
20136,27955,Parent without child sql,"SELECT * 
FROM parentTable p
WHERE NOT EXISTS(
              SELECT 1
              FROM childTable1 c1
              WHERE c1.parentId = p.id)
     AND NOT EXISTS(
              SELECT 1
              FROM childTable2 c1
              WHERE c1.parentId = p.id)
"
14719,13404,Trigger - Can you conditionally execute depending on columns set in the transaction?,"Create or Replace Trigger testTrigger 
before update of firstname on sampleTable 
for each row
begin
   if not updating('LASTNAME') then
      :new.lastname := null;
   end if;
end;
/
"
29051,5336,one sql instead of 2 for counting,"Select 
SUM(case when substr(id,1, 1) in (1,2) then 1 else 0 end) as M, 
SUM(case when substr(id,1, 1) in (3,4) then 1 else 0 end) as F 
from users where activated=1
"
18168,40818,Finding entry with maximum date range between two columns in SQL,"select
   x.name
from
    (
    select
        fans.name,
        dense_rank() over (order by fans.checkout-fans.checkin desc) as rnk
    from
        fans 
    where
        fans.checkout-fans.checkin is not null
    ) x
where
   x.rnk = 1;
"
20355,34096,TSQL making doesn't work,"with cte as (
    select
        Id, TagNo, Revision,
        row_number() over(partition by TagNo order by Revision desc) as rn
    from Table1
    where Revision <= @Revision
)
select Id, TagNo, Revision
from cte
where rn = 1
"
18370,35782,Is there a way to make an SQL NOT IN query faster?,"SELECT COUNT(DISTINCT l1.mobile_number) 
FROM log_entries as l1
WHERE l1.created_at >= '2015-04-09 00:00:00' 
  AND l1.created_at <= '2015-04-09 23:59:59' 
  AND NOT EXISTS (SELECT * 
                  FROM log_entries l2
                  WHERE l2.created_at < '2015-04-09 00:00:00'
                    AND l2.mobile_number = l1.mobile_number);
"
4415,15255,Select a single result from groups by the min of two values,"select *
from mytable
where not exists
(
  select *
  from mytable better
  where better.id = mytable.id
  and 
  (
    better.value1 < mytable.value1
    or 
    (better.value1 = mytable.value1 and better.value2 < mytable.value2)
  )
);
"
29317,73993,MySQL - Group By Number of Users within Ranges of Unique Login Days and by Department,"select buckets, dept, count(user_name) no_of_u from 
(select 
(case when count(distinct(`time`)) between 1 and 2 then '1-2' 
      when count(distinct(`time`)) between 3 and 4 then '3-4'
      else '5+'
        end) as buckets, dept, user_name
    from change_log where event in ('logged in')  
    group by dept, user_name)
group by buckets, dept
"
32851,48461,Dynamic calculations in a materialized view,"SELECT project,
       time_available,
       date_column,
       employee,
       working_days_in_month,
       time_available - 
         sum(working_days) over (partition by project 
                                     order by date) remaining_days
  FROM mv_working_hours
"
25652,57417,Finding a matching value on two columns,"SELECT DISTINCT t.b
FROM your_table t
INNER JOIN your_table s
ON t.b = s.c
AND t.id <> s.id
"
5362,31856,T-SQL Derived Column in SELECT,"SELECT
INT_VALUE = CAST(NULL AS int)
,STR_VALUE = CAST(NULL as VARCHAR(10)) 
"
13460,37100,Why are double nested NOT EXISTS statements unavoidable in SQL,"select scp.component
from scp join
     projects p
     on scp.pnr = p.pnr
where p.city = 'Foobar Town'
group scp.component
having count(distinct scp.pnr) = (select count(distinct pnr)
                                  from projects
                                  where city = 'Foobar Town'
                                 );
"
34901,37686,Make calc on dates using informix db,"b.work_date <= CURRENT - 12 UNITS MONTH
"
38543,17567,Get rid from one column duplicate values in two column select,"    SELECT t1.NAME, t2.ITEMS
    FROM t1 INNER JOIN t2 ON t1.id = t2.names_id
"
35721,57132,SQlite Design Advice,"T1(id,c1_tbl,c1_id,c2_tbl,c2_id)
"
16169,28845,Replace existing DATE format with another format in SSRS expression,"=iif(isDate(Fields!Test.Value)
     ,FORMAT(
            CDATE(iif(isDate(Fields!Test.Value), Fields!Test.Value, Nothing))
           , ""dd-MMM""
           ) 
   ,Fields!Test.Value)
"
26571,56621,SQL Pivot row to column?,"FINANCE | DOMAIN\USER1 | 1 | DIVISION | 023
FINANCE | DOMAIN\USER1 | 2 | DIVISION | 010
FINANCE | DOMAIN\USER1 | 1 | COMPANY  | 1
FINANCE | DOMAIN\USER1 | 2 | COMPANY  | 2
FINANCE | DOMAIN\USER2 | 1 | COMPANY  | 3
"
9849,66726,Oracle to MySQL syntax question,"for 1 to BOOK.units loop

  INSERT INTO VOUCHER (
      -- VOUCHER_NUMBER handled by auto-increment
      BOOK_ID
    , DENOMINATION
  )
  SELECT 
      b.ID
    , b.DENOMINATION
  FROM BOOK b
  WHERE b.ID = [book ID];

end loop
"
8030,20941,mysql get array of ids,"SELECT 
    a.id, 
    a.name, 
    SUBSTRING_INDEX(GROUP_CONCAT(b.effect_id ORDER BY b.effectcnt DESC), ',', 5) AS top_effect_ids
FROM 
    plants a
INNER JOIN
(
    SELECT plant_id, effect_id, COUNT(1) AS effectcnt
    FROM planteffects
    GROUP BY plant_id, effect_id
) b ON a.id = b.plant_id
GROUP BY 
    a.id, a.name
"
21495,36692,How can I include a SQL Function in my Code First EF query?,"create view transactions_view as
select t.ref, getrefstring(t.ref), ... (other cols you may want)
from transactions t;
"
39230,25484,Error: Attempt to apply non-function in Oracle R enterprise,"ore.connect(user = ""<userid"", sid = ""<sid>""
            , host = ""<dbserver>""
            , password = ""<userpwd""
            , all=TRUE)
"
34244,19019,How to select values from a table (SQL Server database) into a parameter (Stored Procedure)?,"CREATE PROCEDURE [dbo].ValidateStudent
(
    @UserName varchar(50),
    @Password varchar(50),
    @Yes_No int OUTPUT,
    @StudentId int OUTPUT
)
AS
    SET NOCOUNT ON;
SELECT        @StudentId = StudentId, @Yes_No = COUNT(1)
FROM            Student
WHERE        (UserName = @UserName) AND (Password = @Password)
GROUP BY StudentId
"
36217,32411,Select distinct values with count in PostgreSQL,"select country, count(country) AS City_Count
from table
group by country
"
18901,47007,If statement within mySql query,"SELECT *
FROM `events` 
WHERE (event_date = CURDATE() AND event_close_time < CURTIME()) or
      (event_date > CURDATE())
ORDER BY `event_date`;
"
3426,56491,Get similar queries from MySQL,"select id,screen_name,skip
  from TABLE
 where skip=0
   and screen_name in (select t2.screen_name
                         from TABLE t2
                     group by t2.screen_name
                    having count(*)>1 
                      )
"
2825,71335,Oracle get all dates in a month,"select order_number, created_date
from orders
where created_date >= to_date('2012-09-01', 'YYYY-MM-DD') 
and created_date < to_date('2012-10-01', 'YYYY-MM-DD');
"
19047,71611,Need SQL Server SELECT To Return Previous Record Based On A DateTime,"select top 1 [TargetUnit], [TargetDate]
  from tbl
 where [TargetDate] < GETDATE()
 order by [TargetDate] desc
"
6112,15672,How to find duplicate record for same date,"select id, roomid, inv_date, count(room)
from room_inventory
group by id, roomid, inv_date
having count(room) > 1;
"
157,34282,Seemingly trivial MySQL query with if statements,"UPDATE YOUR_TABLE
   SET t3 = CASE 
              WHEN t1 + t2 > 0 THEN (t1 + t2)/2.0
              WHEN t1 + t2 = 0 THEN -9999
              WHEN t1 = 0 THEN t2
              WHEN t2 = 0 THEN t1
            END
"
9704,23673,Strange SQL join,"SELECT DISTINCT beverages.beverageid
FROM beverages
LEFT JOIN invoices ON invoices.beverageid = beverages.beverageid AND (100 <= maxprice AND minprice <= 500)
WHERE maxprice IS NULL
"
4024,10523,Not able to fetch records by Date from database,"Select * from table t1 
where t1.date between '20160511 00:00:00' and '20160513 23:59:59';

select * from table t1 where cast(t1.date as date) IN ('20160511');
"
13325,62666,Update a variable number of rows each with different values in a single SQL command?,"UPDATE MyTable
SET    Order = (CASE Order WHEN 190 THEN 1
                           ELSE Order + 1
                           END)
WHERE  Order BETWEEN 1 AND 190
"
34598,18815,is it possible to have multiple foreign key from the same table?,"select * from Person
join PersonSchedule on PersonSchedule.PersonId= Person.Id
join Schedules on Schedules.Id = PersonSchedule.ScheduleId
"
18846,56886,How to write a SQL Query to get the following ...,"select Items.*, Owners.* 
from Items
left join Owners on Items.OwnerId = Owners.OwnerId
left join OwnerPermissions on OwnerPermissions.OwnerId = Owners.OwnerId
where OwnerPermissions.UserId = $userId
"
12247,74154,Selecting data from a database via a joined table,"SELECT t.*
FROM   trips t
JOIN   client_trip ct USING (trip_id)
WHERE  ct.user_id = ??
"
4351,4041,mysql: select * where first and last name starts with the same letter,"SELECT * FROM `people` WHERE UPPER(LEFT(first_name, 1)) = UPPER(LEFT(last_name, 1))
"
30419,42900,SQL Query show everything after a certain date,"WHERE id IS NOT NULL AND
      concat(right(ez, 4), left(ez, 2)) >= '200202'
"
31919,25998,Predicting rate of inventory depletion based on previous sales,"SELECT i.id,
    i.stock AS current_stock,
    COALESCE(SUM(o.quantity), 0) AS orders_last_2_weeks,
    i.stock - COALESCE(SUM(o.quantity), 0) AS stock_after_2_weeks
FROM items AS i
LEFT OUTER JOIN order_items o
    ON o.item_id = i.id
    AND o.created_at > NOW() - INTERVAL 2 WEEK
GROUP BY i.id
"
18887,37919,How to write a query to get number of queries per minute in a database which is fed with the log files ,"select  convert(nvarchar(16), TimeLog, 120) requestTime,
        count(*)
from    LogData
group by convert(nvarchar(16), TimeLog, 120)`
"
21366,8997,SQL: Prevent a combination of items from being inserted twice,"alter table your_table
    add constraint your_unique_key unique (col1, col2)
/
"
25720,49710,SQL - SELECT DISTINCT and ORDER BY Latest,"SELECT gameName , Max(modified) as modified
FROM myTable 
GROUP BY gameName 
ORDER BY gameName;
"
4384,69741,Remove reversal pairs using SQL,"SELECT SUM(QTY) AS newQTY, DATE, FUEL_TYPE
FROM fuel_transactions
GROUP BY DATE, FUEL_TYPE
"
18941,64420,Indexing SQL for Between query with only one match?,"select * from table1 where Col1 = 
    (select max(Col1) from table1 where Col1 <= 8)
and Col2 = 
    (select min(Col2) from table1 where Col2 >= 8)
"
1516,21491,SQL Update secondary table with data from first table,"# NULL for appID
INSERT INTO Applications 
VALUES (NULL, ""app name"") 

# NULL for fileID, LAST_INSERT_ID() for recently inserted appID
INSERT INTO files 
VALUES (NULL, LAST_INSERT_ID(), ""file name"") 
"
22958,49342,Getting sum of an unbound data column in asp.net Gridview,"int sum = 0;
for (int i = 0; i < GridView1.Rows.Count; i++)
{
    gvr = GridView1.Rows[i] as GridViewRow;
    var lblRowAmount = gvr.FindControl(""lblAmount"") as Label;

    sum += int.Parse(lblRowAmount.Text);
}
Label2.Text = sum.ToString();
"
27315,36555,"Updating and join on multiple rows, which row's value is used?","UPDATE  a
SET     a.Value = b.Value
FROM    tableA AS a
CROSS APPLY
        (
        select  top 1 *
        from    tableB as b
        where   b.id = a.id
        order by
                DateColumn desc
        ) as b
"
7965,70513,SQL: Removing duplicates from column,"CASE RANK() OVER (PARTITION BY li.catnr, li.av_part_no, li.artist, li.title, li.i_status
             ORDER BY bom.av_part_no)
  WHEN 1 THEN nr.c_catnr END AS comp_part_AW
"
28326,16735,MySql field types for simple terms,"create table images (
id int not null auto_increment primary key,
title varchar(50),
grab_date date(),
site varchar(100)
) engine = myisam;
"
23529,28025,Distinct select from sql number column,"SELECT Codes FROM tableX where Codes LIKE '[0-9]%'
"
8103,2950,Deleting duplicates in SQL Server,"DELETE target 
FROM MnA target INNER JOIN MnA temp 
     ON (target.symbol = temp.symbol 
         AND target.direction = temp.symbol
         AND target.start_doy = temp.start_doy
         AND target.diff = temp.diff
         AND target.id != temp.id 
         AND temp.avg_percent > target.avg_percent);
"
12520,31493,Sqlite - query 1 column in two identical tables where column equals a value,"select top 1 column1, column2.. from month1 WHERE task1_done = 1 order by IdentityColumn Desc
union 
select top 1 column1, column2.. from month2 WHERE task1_done = 1 order by IdentityColumn Desc
"
8903,9724,returning table name with columns when queried,"select u.id as ""u.id"", 
       u.name as ""u.name"",
       u.email as ""u.email"",
       f.id as ""f.id"",
       f.name as ""f.name""
FROM users u LEFT OUTER JOIN favorites f ON u.id = f.userID
"
1056,42809,Confused about SELECT and JOIN command in postgresql,"SELECT ""Courses"".description,
       ""Courses"".semester,
       ""Faculties"".name
FROM   ""Courses""
       INNER JOIN ""Faculties""
               ON ""Courses"".instructor_id = ""Faculties"".faculty_id
WHERE  Faculties.name = 'Given Name'; 
"
1049,21738,How do I count more than one column with a where clause? (SQL),"SELECT 
    SUM(IIF(Committees=True, 1, 0))
    , SUM(IIF(Insurance=True, 1, 0))
FROM [Annual Questionnaire]
"
30007,74220,SQL Server after update triggers on 2 tables,"SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
"
13766,8532,"SQL Query NOT IN, EXIST","SELECT 
    a.stagename,
    a.realname
FROM
    Actor a
LEFT JOIN
    ActedIn b ON a.stagename = b.stagename
LEFT JOIN
    Movie c ON b.title = c.title 
    AND a.year = b.year 
    AND c.earnings >= c.budget
WHERE 
    c.title IS NULL
GROUP BY
    a.stagename,
    a.realname
"
13862,47664,MySql ranking system with multiple categories,"SELECT game_id, SUM(cat1+cat2+cat3) score, COUNT(*) votes
FROM game_ranking
GROUP BY game_id
ORDER BY score DESC, votes DESC
"
30566,65268,How to automate insert id into child table with new created id from parent,"SELECT LAST_INSERT_ID();
"
5728,7104,Android SQL update table,"mDb.execSQL(""UPDATE "" + table + "" SET "" + KEY_MODE + "" = 1;"");
"
26984,40060,LIKE and NULL in WHERE clause in SQL,"where @Keyword is null or CustomerName like '%' + @Keyword + '%' 
"
39657,55020,Error querying SQL Server,"select id,sum(amt) over(partition by id) as amt from #t
"
27619,64772,Can I alias multiple columns? How?,"SELECT  d.id
,       d.c1
,       d.c2
,       d1.value as a3
,       d2.value as a6
FROM    data as d
LEFT JOIN
        dictionary as d1
ON      data.id = d1.id
        and d1.key = 'k1'
LEFT JOIN
        dictionary as d2
ON      data.id = d2.id
        and d2.key = 'k2'
"
29202,74066,Optional parameters in Merge," SET      
    Account_ID = CASE 
                    WHEN source.Account_ID IS NULL 
                    THEN target.Account_ID 
                    ELSE source.Account_ID 
                 END
"
9965,71887,Getting MonthAndYear name in sql?,"SELECT DATENAME(month, GETDATE()), DATENAME(year, GETDATE());
"
32417,20984,Oracle: INSERT on condition from other table,"INSERT INTO MyTable(ID, A, B)
SELECT ID,'YES','What' FROM TABLE_2 WHERE ID > 10
"
19984,8256,How to check values in column in Select query," select
 ..
 Agent,
 case when coalesce(MiddleName, '') = '' then FirstName + ' ' + LastName 
      else FirstName + ' ' + MiddleName + ' ' + LastName 
 end as Name,
 ...
 from tbSystemUser 
"
19642,41697,R equivalent of SELECT DISTINCT on two or more fields/variables,"df %>% select(var1, var2) %>% distinct
"
1878,70551,Mysql query with sub-selects taking too long..,"select TAG_NAME, max(concat(time,value)) as time_value
from historical 
group by TAG_NAME
"
1585,38160,How to drop multiple tables having foreign keys in PostgreSQL?,"DROP TABLE foo, bar, baz CASCADE;
"
34849,59809,How to use GROUP BY and COUNT in SQL in this scenario,"SELECT
    SUM(CASE WHEN q1 = 1 THEN 1 ELSE 0 END) as q1_first,
    SUM(CASE WHEN q1 = 2 THEN 1 ELSE 0 END) as q1_second,
    SUM(CASE WHEN q1 = 3 THEN 1 ELSE 0 END) as q1_third
FROM survey
"
503,70166,Oracle 10g: Is there a way to build/compile a package using an SQL statement?,"alter package [your package name] compile;
"
103,31001,selection constraint is plsql,"select
  id,
  alias_one,
  alias_two,
  name
from
  (
  select
    id,
    alias_one,
    alias_two,
    name,
    count (distinct name) over (partition by alias_one, alias_two) as cnt
  from entries
  )
where cnt > 1
"
15149,42875,Oracle POSIX support for REGEXP_LIKE,"SELECT DISTINCT offer_id FROM fop WHERE REGEXP_LIKE (fop.offer_id, '^01[[:alpha:]].*');
"
15757,43645,PostgreSQL - Help Required in Creating View,"CREATE OR REPLACE VIEW queue_interval_wise AS 
SELECT DISTINCT 
    t1.Time,
    t1.Date,
    t1.Label,
    IFNULL(t2.Category, ''),
    t1.Count
FROM Table1 t1
LEFT JOIN Table2 t2 ON t1.Label = t2.Label
"
11864,27189,find unique rows using SQL?,"SELECT name FROM myTable GROUP BY name HAVING COUNT(name) = 1
"
22824,40891,SQL query not working for changing null values,"UPDATE [File]
SET [Date] = '1000-01-01'
WHERE [Date] IS NULL;
"
13420,6675,Count Distinct Assistance,"select c2.Responsible, c.deliveryname,
COUNT(DISTINCT (case..... --conditions here end)) as 'Unique PortStatus(es)'
from table p
join table c on p.OwnerContactID = c.ContactID
join table c2 on c.ContactID = c2.ContactID
where p.PortfolioStatus <>'' and c2.responsible <> ''
group by c.deliveryname,  c2.responsible
"
9708,13684,SQL Server SSIS and Oracle Data Pump,"Corresponding to SSIS ,oracle has oracle warehouse builder.

Oracle data pump is an alternative to EXPORT and Import utility in SQL SERVER.
"
11916,10965,If/Then Statement,"$data = $con->query(""SELECT table1.id,

(case 
when table1.draftid = 0 then table1.content
when table1.draftid != 0 then  table2.content
end) as data,


FROM table1 
JOIN table2 ON table1.draftid = table2.id 
WHERE table1.id IN ("". $column['data'] ."")"");
"
553,20288,sql count function,"SELECT count(wage), first_name
FROM employee, job, link 
WHERE job.wage = 1000 
  AND job.job_id = link.job_id and employee.employee_id = link.employee_id;
GROUP BY first_name
"
29360,40916,How do I get the most recent records based on as of date?,"select number, name, date
from Recent_Table
where Date = (SELECT MAX(DATE) AS recent_date
              FROM Recent_Table
              WHERE DATE < '2015-05-19')
"
9549,67651,"I want to update values in column, based on condition that need to compare data from another table","UPDATE CLIENTS
SET DIFFERENCE = CASE WHEN EXISTS
                 (SELECT 1 FROM DOCUMENT
                  WHERE ID_CLIENT = CLIENTS.ID_CLIENT
                  AND MONTHS_BETWEEN(TO_DATE(DATA,'MM/DD/YYYY'),SYSDATE) > 4) 
                 THEN 'Above' 
                 ELSE 'Below' END
"
33150,71442,Update int column in table with incrementing value,"with cte as 
( select prodID, row_number() over (order by prodID) as rn 
  from table 
)
update cte set prodID = rn + 9
"
14299,18668,"How to write MySQL full-text query with MATCH(), ROUND() & Subquery?","SELECT 
  text,
  ROUND(MATCH(text) AGAINST('$keyword')) AS score,
  date
FROM 
  table_name 
WHERE 
  MATCH(text) AGAINST('$keyword')
ORDER BY 
  score DESC,
  date DESC 
LIMIT 20
OFFSET $s
"
32371,16170,CASE IN statement with multiple values,"SELECT CASE
         WHEN c.Number IN ( '1121231', '31242323' ) THEN 1
         WHEN c.Number IN ( '234523', '2342423' ) THEN 2
       END AS Test
FROM   tblClient c  
"
30336,19201,"Oracle 11g PL/SQL cursor,intersect query","var table.col%type;

BEGIN
OPEN c1;
LOOP    
BEGIN

FETCH c1 into var;    
exit when c1%NOTFOUND;    
INSERT INTO table values (col1, var);
commit;   
EXCEPTION
WHEN DUP_VAL_ON_INDEX THEN         
CONTINUE;  
END;
END LOOP;    
END;
"
32386,35197,SQL Query to return rows with no matches in another table,"SELECT CountryId, COALESCE(t2.cnt, 0) AS usersPerCountry 
FROM (
   SELECT DISTINCT CountryId 
   FROM UserCountry) AS t1
LEFT JOIN (
   SELECT a.CountryId, COUNT(*) AS cnt
   FROM User u 
   INNER JOIN Address a ON u.AddressId = a.Id
   GROUP BY a.CountryId
) AS t2 ON t1.CountryId = t2.CountryId
ORDER BY COALESCE(t2.cnt, 0) DESC
"
18793,66691,MySQL Select Based on Conditional Select,"SELECT
    t.ID,
    t.Reference,
    COALESCE(reffed.Name, t.name) AS name,
    COALESCE(reffed.whatever, t.whatever) AS whatever,
    COALESCE(... and so on ...)
  FROM details t
  LEFT OUTER JOIN details reffed ON t.Reference = reffed.id
"
12019,3786,thousands separator in sql,"SELECT FORMAT(123455213.32, '###,###,###.##')
"
23770,51756,Filter Reverse Pairing in Query,"SELECT a.user_id, b.user_id, count(*) AS num, collect_set(m.movie_title)
FROM ratings a JOIN
     ratings b
     ON a.movie_id = b.movie_id JOIN
     movies m
     ON a.movie_id = m.movie_id
WHERE a.user_id < b.user_id
GROUP BY a.user_id, b.user_id
ORDER BY num DESC;
"
38048,8311,How to check if the specified number of entries from one table matches the number of actual entries in another table?,"select m.pkey, m.pkey2, m.contents, m.contents-isnull(c.actual,0) as missing
from dbo.Main m
left join (
    select pkey, pkey2, count(*) as actual
    from dbo.Contents
    group by pkey, pkey2
) c on c.pkey=m.pkey and c.pkey2=m.pkey2
where isnull(c.actual,0)<>m.contents
"
39339,53051,How can I match a comma separated list against a value?,"SELECT * FROM article WHERE FIND_IN_SET('5', category) != 0;
"
7552,48757,Oracle sql split string in chuncks,"select regexp_substr(s, '.{5}', 1, lvl) chnk 
from (select s, level lvl 
      from (select '00000111112222233333' s from dual) 
      connect by level <= length(s) / 5);
"
14570,55503,Grouping on multiple columns,"SELECT  StoreId, StoreDate, EndDate, COUNT(DISTINCT StoreCode) AS Count
FROM MyTableName
GROUP BY StoreId, StoreDate, EndDate
HAVING COUNT(DISTINCT StoreCode) > 1
"
20173,22757,Locking and concurrency with MySQL,"select . . . for update
select . . . lock in share mode
"
25964,69483,Long detailed listing in SELECT Queries,"SELECT * FROM `table` WHERE `column` = 'value' LIMIT 1\G
"
23755,33067,how to get data from 3 tables in mysql?,"select * from locations
inner join Country on `Country`.`country.id` = locations.`country.id`
inner join State on `State`.`state.id` = locations.`state.id`
inner join City on `City`.`city.id` = locations.`city.id`
"
10266,19684,Tuning And Performance,"INSERT INTO <TABLED>
SELECT A.* FROM <TABLEA> A  
WHERE A.MED_DTL_STATUS='0' 
AND NOT EXISTS (
    SELECT B.TRANS_ID_X_REF 
    FROM <TABLEB> B 
    WHERE B.TRANS_ID_X_REF = A.TRANS_ID
)
AND NOT EXISTS (
    SELECT A2.TRANS_ID 
    FROM <TABLEA> A2 
    WHERE A2.TRANS_ID = A.TRANS_ID
    AND A2.ADJUSTMENT_TYPE='3'
);
"
31164,7958,How to use ruby .map to add quotes to array elements,"array_ids = ['1','2']

array = array_ids.map { |id| ""'#{id}'"" }.join(',')

p array
# => ""'1','2'""

order_sql = ""FIELD(ID,#{array})""

p order_sql
# => ""FIELD(ID,'1','2')""
"
15324,72010,Merge data into one column - sql server 2012,"SELECT * FROM TableA
UNION ALL
SELECT B.Order1,A.Response From 
   (
    (SELECT ROW_NUMBER()OVER(ORDER BY Response)PK,* FROM TableB) A Left Join 
    (SELECT ROW_NUMBER()OVER(ORDER BY Order1)PK,* FROM TableA) B On A.PK=B.PK 
   )
Where Response IS NOT NULL
"
38653,24079,SQL Query make columns results into rows,"select c01 from table
union all
select c02 from table
union all
select c03 from table
union all
select c04 from table
"
6773,71253,"SQL Server: expression in ""IN"" operator","SELECT ShopID, ShopName 
FROM Shops AS shopslist 
WHERE shopslist.ShopType in (SELECT ShopType FROM ShopClasses WHERE ShopClass = 2)
"
19443,43399,Unable to fetch data by joining 4 tables,"INNER JOIN item_type ON item_type.id = item_type_map.type_id
"
34501,34471,Find products that are sold at a price less than mine,"select distinct p1.* 
from prdtfrn p1
join prdtfrn p2 on p1.pid = p2.pid and p2.fid != 1 and p2.price < p1.price
where p1.fid = 1; // fid=1 is known to be 'Audrey'
"
29654,21651,Alter auto-generated sequence,"TRUNCATE table RESTART IDENTITY;
"
2599,1695,SQL Server show non matching records,"select 
* 
from #test a
where exists
(
    select * 
    from 
    #test b
    where a.name = b.name and (a.tag <> b.tag or a.checkVAL <> b.checkVAL)
)
"
12024,44368,Sql sum of count field with different product name once,"Select product, sum(count)
from table_name
group by product
"
22811,32318,Using variable in Oracle Connection Sql Query,"string query = ""select * from crm_visible_v where ownerid in (select sicilno from personel.pkim_kutlama@netdb_1.europe.nortel.com where cikis_tarihi is null start with sicilno ='""+SicilNumvber+""' connect by prior sicilno = amir)"";    
"
11146,26236,SELECT max date from an inner join relation,"SELECT  R.SId ,R.SName,R.Sprice
FROM (SELECT  Staff.SId ,Staff.SName,Sprice,updateStaff.SDate,updateStaff.stime
      FROM Staff
        LEFT JOIN updateStaff ON Staff.SId = updateStaff.SId ) AS R
WHERE R.stime = (SELECT MAX(stime) FROM updateStaff us WHERE us.SId =R.SId
      and us.sdate =(select max(sdate) from updateStaff us2 where us2.sid = us.sid))
ORDER BY R.SId , R.SName
"
10120,52233,change the size of datatype in sql,"alter table tablename modify 
( 
   column_name    varchar2(13)
);
"
17527,13497,How to use CakePHP's database.php file for custom scripts?,"<?php

include(""path/to/cake/config/database.php"");
$db = new DATABASE_CONFIG;

echo $db->default['login'];
echo $db->default['password'];
echo $db->default['database'];

?>
"
39359,36978,Trouble querying results from three tables,"SELECT
  c.id,
  asub.id
FROM
  course c
  JOIN assignment a ON ( c.id = a.course )
  JOIN assignment_submissions asub ON ( asub.ID = a.assignment )
WHERE
  c.id = 10 --your course id goes here OR c.id in (10, 20, 30) -- for multiple IDS
"
10002,29144,Grails: How to reduce DB queries,"import groovy.sql.Sql

class MyService {
  def dataSource

  int myCalc() {
    Sql sql = new Sql(dataSource)
    String query = """"""
select count(*) tot1, 
       (select count(*) from domain_class2) as tot2
  from domain_class1
""""""
    def row = sql.firstRow(query)
    //access properties directly
    println row.tot1
    println row.tot2
  }
}
"
34099,44371,SQL select rows conditionally using CASE expression,"SELECT *
FROM emp
WHERE (CASE WHEN (sal+comm) > 1700 THEN 1
            ELSE 0
       END) = 1
"
13489,43552,SQL (Oracle) Joins when column results are slightly different,"select ...
from table1 t1
 right join table2 t2 on t1.key_id = to_number(substr(t2.doc_num,2));
"
3988,23407,How to get the value of max length in sql server,"SELECT TOP 1 t.value
FROM table AS t
ORDER BY LEN(t.value) DESC
"
18997,65709,How to select multiple results for a single row - MySQL,"   SELECT g.id, g.name, g.desc, GROUP_CONCAT(P.name) AS platforms
    from game g
    JOIN game_platform gp ON gp.game_id = g.id
    JOIN platform P ON gp.platform_id = p.id
    GROUP BY g.id, g.name, g.desc
"
14424,24907,SQL Delete Statement matching criteria,"AND (state != 'PENDING' OR state IS NULL)
"
17330,4942,Update Trigger without using a Cursor,"select i.emp_id,
  case when i.foo <> d.foo then ',foo' else '' end +
  case when i.bar <> d.bar then ',bar' else '' end as changedcolumns
  from inserted as i inner join
    deleted as d on d.emp_id = i.emp_id
"
12698,12466,Stored Procedure with conditional results,"SELECT * from T where T.A = @a and T.B = @b


IF (@@ROWCOUNT = 0)
BEGIN
    SELECT * from T where T.A = @a and T.B IS NULL
END
"
16893,56331,top 10 by category mysql,"SELECT person, category, amount
FROM (
  SELECT person, category, amount,
         @rn := IF(@cat = category, @rn+1,
                   IF(@cat := category, 1, 1)) AS rn
  FROM mytable
  CROSS JOIN (SELECT @rn := 0, @cat := '') AS vars
  ORDER BY category, amount DESC) AS t
WHERE t.rn <= 10
"
21141,68363,"I need to select Year, AVG(score) where COUNT(id) is more than 1 grouped by year","Select Year, AVG(score)
FROM movies
GROUP BY year
HAVING count(*) > 1
ORDER BY year desc;
"
7802,59810,Merging results from two subqueries Postgresql,"SELECT coalesce( t1.""firm_id"", t2.""firm_id"" ) as firm_id,
       coalesce( t1.""type_1"", 0 ) as type_1,
       coalesce( t2.""type_2"", 0 ) as type_2,
       coalesce( t1.""fee_1"", 0 ) 
       +
       coalesce( t2.""fee_2"", 0 ) as total_fee
FROM table1 t1
FULL JOIN table2 t2
ON t1.""firm_id"" = t2.""firm_id""
"
23256,53989,SQL COUNT get zero,"SELECT c.classId, COUNT(s.classId)
FROM classroom c LEFT JOIN
     student s
     ON c.classid = s.classid
GROUP BY c.classId;
"
17976,59512,Can I determine the GROUP BY clause based on a parameter?,"SELECT
   ...,
   DATEPART(yy, MyDBDateField),
   CASE WHEN @groupBy = 1 THEN DATEPART(m, MyDBDateField) ELSE NULL END,
   CASE WHEN @groupBy = 2 THEN DATEPART(d, MyDBDateField) ELSE NULL END
FROM



GROUP BY
   DATEPART(yy, MyDBDateField),
   CASE WHEN @groupBy = 1 THEN DATEPART(m, MyDBDateField) ELSE NULL END,
   CASE WHEN @groupBy = 2 THEN DATEPART(d, MyDBDateField) ELSE NULL  END
"
39322,787,Treat column as different type for sorting,"select name from tbl order by cast(stringColumn as float)
"
35651,38952,Find the all customer names consisting of three or more words (for example King George V),"select name from customers 
where ( length( name )
        -
        length( replace( name, ' ', '' ) ) + 1
      ) >= 3
"
39248,40611,Displaying DateTime.Now in a String column within a SQL table,"select replace(all_text_column, '{DateTime.Now}', current_timestamp)
from your_table
"
23259,31486,"Using CASE statements as a precursor for COUNT function in single (large) SQL query, syntax","SUM(CASE WHEN BIAdmin.Item.ItemStatus = 'inactive' THEN 0 ELSE 1 END) As ActiveItemCount
"
36621,18649,Rpostgresql: Properly escaping strings for input,"postgresqlExecStatement(con, ""DELETE FROM foos WHERE id = $1 AND baz = $2"", list(1, ""bar""))
"
26685,10991,SQL Query with Multiple Or On Statement,"SELECT * FROM Users WHERE Username IN ('A','B'...);
"
4786,62151,SQL Expression to Obtain Sum of All Payments on a Payment Schedule Table,"select sum(PaymentAmount * NumberofMonths) Total
from yourtable
"
39284,16979,How to select DateTime.MinValue (01/01/1970) in MySQL?,"SELECT      IFNULL(MAX(`created`), FROM_UNIXTIME(0)) `lastcreated`
FROM        `tickets`
WHERE       `accnum` = 20088
"
18404,74691,SQL finding second largest value in a table,"select ticker, No_indx_cusip, cor, dt_pnts
from (select b.Ticker, a.CUSIP_ID1 as No_indx_cusip, a.cor, a.dt_pnts,
             row_number() over (partition by b.ticker order by abs(a.cor) desc) as seqnum
      from  tbl1 a 
      inner join tbl3 b
            on a.CUSIP_ID1 = b.CUSIP_ID and a.dt_pnts > 20
     ) t
where seqnum = 2;
"
6171,18055,Conditional SQL Trigger?,"DECLARE @statusOldValue status_type
DECLARE @statusNewValue status_type

SELECT @statusOldValue = status FROM deleted

SELECT @statusNewValue= status FROM inserted

IF (@statusOldValue<>@statusNewValue) THEN
BEGIN
 -- Do what you want
END
"
6344,63012,Grabbing name of column in sql using the same recordset information,"SELECT
    cl.cName,
    ISNULL(sc.cName, '-') AS pName
FROM cleints cl
INNER JOIN CSA.dbo.Clients c
    ON c.clientId = cl.clientID
LEFT JOIN CSA.dbo.Clients sc
    ON sc.clientID = c.sub
WHERE cl.clientID = 3
"
34763,71810,FreeText Query is slow - includes TOP and Order By,"CREATE TABLE #tempResults
(
ID int primary key,
Name varchar(200),
DateMadeNew datetime
)

INSERT INTO #tempResults
SELECT 
      ID, Name, DateMadeNew 
      FROM Product 
      WHERE contains(Name, '""White Dress""')


SELECT TOP 1
    *
    FROM #tempResults
    ORDER BY DateMadeNew desc
"
4740,23312,Implementing Hierarchy in SQL,"SELECT CDATE, SECID, SOURCE, VALUE
FROM (
  SELECT t.CDATE, t.SECID, t.SOURCE, t.VALUE,
    ROW_NUMBER() OVER (PARTITION BY t.CDATE, t.SECID
                       ORDER BY h.HIERARCHY DESC) as nRow
  FROM table1 t
  INNER JOIN table2 h ON h.SOURCE = t.SOURCE
) A
WHERE nRow = 1
"
36818,28876,Exclusive Disjunction,"select p1.product_id,
       coalesce(p2.price, p1.price) as price
  from product_prices p1
  left join product_prices p2
    on p2.product_id = p1.product_id
   and p2.price_type = 'A'
 where p1.price_type = 'B'
"
4103,39157,Create an empty array in an SQL query using PostgreSQL instead of an array with NULL inside,"SELECT
  person.person_name,
  ARRAY(SELECT animal_name FROM pet WHERE person.person_name = pet.person_name) AS pets
FROM
  person;
"
19549,3498,An Oracle Select with time,"select * from recent_activity where systimestamp-lastactivity < interval '5' second;
"
16573,23389,SQL Update doesn't save affected rows?," declare @sql varchar(1000)
 set @sql = 'UPDATE #tablenamenotrelevant# SET ' + @field + ' = 1 WHERE [MemberId] = 1060;'
 exec (@sql)
"
16291,52039,SQL - Can sub-query have a different condition from main query?,"SELECT t1.ID, t1.DESC, 
  ( SELECT COUNT(*)
    FROM TABLE1 t2
    WHERE t1.ID=t2.ID AND t2.STATUS_ID=2) COUNT 
FROM TABLE1 t1
WHERE t1.STATUS_ID=6
"
11328,25655,Required single SQL query,"update <table>
set Gender= case when Gender='Male' then 'Female' 
                 when Gender='Female' then 'Male' 
            end
"
28958,66360,Create a new table from a select command," CREATE TABLE foo
 SELECT bar FROM xyz;
"
1057,6952,SQL query against multiple tables,"SELECT *
FROM pickles
ORDER BY likes DESC
LIMIT 10;
"
459,68011,SQL Syntax for calculating results of returned data,"SELECT 
  CASE WHEN 
    /* res1 */ Power(IsNull(val1X, 0), 2) + Power(IsNull(val1Y, 0), 2) 
    > /* res2 */ Power(IsNull(val2X, 0), 2) + Power(IsNull(val2Y, 0), 2)
  THEN
    /* res1 */ Power(IsNull(val1X, 0), 2) + Power(IsNull(val1Y, 0), 2)
  ELSE
    /* res2 */ Power(IsNull(val2X, 0), 2) + Power(IsNull(val2Y, 0), 2)
  END
FROM
  myTable
"
1518,18981,How can I delete a set of records from sql table,"DELETE FROM table WHERE column LIKE 'arthur_0%';
"
25792,43697,Why wont coalesce or is null work on results from a left join?,"SELECT  a.itemName,
  COALESCE((SELECT itemImageName 
    FROM amgb b
    WHERE a.userId = b.userId AND a.itemId = b.itemId
    LIMIT 1
  ), 'default.jpg') AS itemImageName
FROM amga a 
WHERE a.userId = 1 AND a.itemId = 'US1';
"
21404,43709,Return null or zero when no value is found,"SELECT @t2.id, @t1.name from @t2 LEFT OUTER JOIN @t1 ON @t1.ID = @t2.ID
"
13723,44608,Consolidate 2 tables via a mapping table - Full Joins?,"select a.ID as A_ID, a.Desc as A_Desc, b.ID as B_ID, b.Desc as B_DESC
from Table_A as a left outer join Mapping_Table as m on a.ID = m.A_ID
full outer join Table_B as b on m.B_ID = b.ID
"
25261,20047,Execute immediate dbms_output.put_line,"declare
v_str varchar2(200);
begin
v_str := q'!begin dbms_output.put_line('Hello world'); end;!';
Execute immediate v_str;
end;
/
"
16881,19806,SQL distinct on Date and ignore Time,"SELECT DATE_FORMAT(Date, '%Y-%m-%d') AS Timestamp, AVG(value)
FROM abc
GROUP BY DATE(Date)
"
21175,47265,Efficiently fetching 25 rows with highest sum of two columns (MySQL),"select ur1.*
from (select u.*
      from users u
      order by rank1 desc
      limit 1000
     ) ur1 join
     (select u.*
      from users u
      order by rank2 desc
      limit 1000
     ) ur2
     on ur1.username = ur2.username
order by ur1.rank1 + ur1.rank2 desc
limit 25;
"
5667,7579,Finding Null values in multiple columns in SQL,"SELECT 
CAST (
(SELECT * FROM yourtable FOR XML path('x'),ELEMENTS XSINIL) 
AS XML)
.query('//.[@xsi:nil=""true""]/..')
"
3022,39409,SQLite two columns from table joined on same other table,"SELECT
  TA.name,
  TB.name
FROM T1
  LEFT JOIN T2 TA ON(T1.person1 = TA.id)
  LEFT JOIN T2 TB ON(T1.person2 = TB.id)
"
17932,70863,SQL a numbering column - MySQL,"SELECT @rownum:=@rownum+1 rownum, t.*FROM (SELECT @rownum:=0) r, mytable t;
"
27250,65668,postgres - finding unique users which have specific records,"SELECT user_id
FROM table_user_flags
WHERE flag IN (1,2)
GROUP BY user_id
HAVING COUNT(DISTINCT flag)=2;
"
2165,15394,How to like two columns in one SQL statement,"Select aa, bb
from a, b
where a.aa like '%' + b.bb + '%'
   OR b.bb like '%' + a.aa + '%'
"
30266,16535,Updating records that are exported using BCP utility,"bcp ""select * from `table` order by ID"" <other bcp params> -F @First -L @Last

WITH rows AS (
SELECT <columns to be updated>, ROW_NUMBER() OVER ( ORDER BY ID ) rn FROM `table`
)
UPDATE rows
SET <some indicator>
WHERE rn BETWEEN @First AND @Last
"
8217,51957,"Sort the order of ""ORDER BY"" query","SELECT 
   TICKET_ITEM_ID, 
   TICKET_ITEM_DESC 
FROM ticket_item
INNER JOIN menu_category ON menu_category.CATEGORY_NAME=ticket_item.TICKET_PRINT_CAT
WHERE 
   ticket_item.TICKET_ID = 1 
GROUP BY TICKET_PRINT_CAT
ORDER BY menu_category.BUTTON_SORT
"
35016,10415,How to calculate aggregate property of has_many relation in SQL?,"SELECT
  person.name,
  case when 't' = ANY (SELECT items.stolen 
                       FROM items 
                       WHERE items.person_id = person.id) then TRUE else FALSE end as owns_stolen_items
FROM
  persons
"
2222,50434,When does full text index update in sql server?,"SELECT OBJECT_NAME(object_id), is_enabled, has_crawl_completed, crawl_type, crawl_start_date, crawl_end_date
FROM sys.fulltext_indexes;
"
26336,19353,"MySQL: how to use comma, single quote, and double quote as columns?","SELECT `t1`.`foo's, ""bar""` FROM `t1`;
"
16221,30435,Query criteria from another form's text boxes?,"SELECT [Forms]![frmQuarter]![StartQuarterDateTextbox] AS start_date;

SELECT [Forms]![frmQuarter]![EndQuarterDateTextbox] AS end_date;
"
25266,31866,SQL Server : How to write and execute prepared statement,"exec sp_executesql
    @statement = N'select * from sys.databases where name = @dbname or database_id = @dbid',
    @parameters = N'@dbname sysname, @dbid int',
    @dbname = N'master',
    @dbid = 1
"
7215,53743,Minus operator with composite key,"SELECT * FROM xRef t1
WHERE t1.dcId = 10
      AND NOT EXISTS (SELECT dcId FROM xRef t2
                      WHERE t1.promoId = t2.promoId
                            AND t1.marketId = t2.marketId
                            AND t1.refId = t2.refId
                            AND t2.dcId = 15)
"
5453,9117,MySQL get count() from separate tables,"SELECT
  (select count(id) from table1) as c1,
  (select count(id) from table2) as c2,
  (select count(id) from table3) as c3
"
15868,2894,where cluase on query result,"having amount <> 0
"
30126,13806,Sql group by too many conditions,"select m.*, ms.TotalValue
from MyTable m
inner join (
    select [Order], sum(Price * Quantity) as TotalValue
    from MyTable
    group by [Order]
) ms on m.[Order] = ms.[Order]
"
10003,29804,Insert int variable into xml type ,"declare @id int
set @id = (select ID from tbUsers where Name = 'John_Stack')

declare @xml xml
set @xml = '<users> <user id = ""' + CONVERT(varchar,@id) + '""/></users>'
"
6830,60813,SQL Server 2012 Counting Semicolon separated values,"SELECT Id, REPLACE(FullName, ',', ';') AS FullName, 
       LEN(FullName) - LEN(REPLACE(FullName, ',', '')) + 1 AS [COUNT]
FROM MyTable;
"
16772,45394,Rows not being returned in stored proc,"SELECT  COALESCE(validCount, 0) AS validCount,
        COALESCE(invalidCount, 0) AS invalidCount,
        (
        SELECT  COUNT(*)
        FROM    members m
        WHERE   m.memberId = p.memberId
        ) AS totalMembers
FROM    (
        SELECT  @pMemberId AS memberId
        ) p
LEFT JOIN
        reporting r
ON      r.memberId = p.memberId
"
28448,2069,Selecting a mapping table with fields from two other tables,"SELECT a.field1, c.field2
FROM Table1 a
INNER JOIN Table3 b
ON a.id=b.Table1_id
INNER JOIN Table2 c
ON b.Table2_id = c.id
"
19978,3532,SQL query to find whether all sub-parts exist,"SELECT
    StudentId,
    CourseId,
    MAX(TakenOn) as TakenOn,
    case when Count(CourseId) = 
            (select COUNT(distinct TakenOn) 
            FROM SessionAttendance SessionAttendanceCount
            where SessionAttendanceCount.CourseId = SessionAttendance.CourseId
            ) then
        1
    else
        0
    end AttendedAllSessions
FROM SessionAttendance
GROUP BY StudentId, CourseId
"
15143,75090,How can I find the first start time within various sequences of events?,"select vehicleId, statusId, min(StartTime) as FirstStartTime
from (select se.*,
             (row_number() over (partition by vehicleId  order by StartTime) -
              row_number() over (partition by vehicleId, StatusId order by StartTime)
             ) as grp
      from StatusEvents se
     ) se
group by grp, statusId, vehicleId
order by vehicleId, FirstStartTime;
"
7893,46498,SQL payments matrix,"CREATE VIEW NormalizedPayments (id, Year, Month, Amount) AS
SELECT id,
    2010 AS Year,
    1 AS Month,
    2010_01 AS Amount
FROM Payments
UNION ALL
SELECT id,
    2010 AS Year,
    2 AS Month,
    2010_02 AS Amount
FROM Payments
UNION ALL
SELECT id,
    2010 AS Year,
    3 AS Month,
    2010_03 AS Amount
FROM Payments
"
29102,34239,Table Check Constraint allows invalid data,"ALTER TABLE dbo.testCheck WITH CHECK 
WITH CHECK
ADD CONSTRAINT ck_testCheck 
CHECK (checkMe IS null or checkMe = '1' or checkMe = '2');
"
17181,31392,How to update column text value with concatenation of multiple columns text values?,"Update table_x 
set 
merged_content=
concat('<p>',first_name,' ',last_name,'</p><p><b>Address -</b> ',address,'</p>'); 
"
19980,52435,Get rows if condition is applicable else single row,"with cte as
(select c.*,
        t.Amount,
        max(case xCol when 5 then 1 end) over (partition by c.[Group]) xCol5
 from customers c
 left join transactions t on c.[Customer Code] = t.[Customer Code])
select case xCol5 when 1 then [Customer Code] end [Customer Code],
       [Group],
       sum(Amount) Amount
from cte
group by [Group], case xCol5 when 1 then [Customer Code] end
"
30928,10247,Coalesce/IsNull on stored proc output parameter,"DECLARE @v varchar(5)
EXEC checkCultureCode 'evil', @v OUTPUT
SELECT @v;
"
22830,72137,MS SQL On Using WHERE EXISTS and WHERE NOT EXISTS," SELECT * FROM Test T
  WHERE T.EventId IN
   (
     SELECT EventId FROM Test T WHERE T.Position = 'ABC' AND T.SubPosition = 'DEF'
     EXCEPT
     SELECT EventId FROM Test T WHERE T.Position = 'ABC' AND T.SubPosition IS NULL
   )
"
13147,62983,Having some troubles finding a string for in MySQL,"select * from foo where Concat(foo) regexp '(bar).*(bar)';
"
11123,19752,SQL: Is it possible to merge these two SQL statements into a single query?,"SELECT COUNT(DISTINCT CustomerID) as Total,
       COUNT(DISTINCT CASE WHEN OrderDate >= '2016-01-01' THEN CustomerID END) as Total_2016
FROM Orders;
"
22512,14616,SQL query problem (Oracle),"SELECT
  t1.week
  , t1.location
  , CASE WHEN t2.location is not null THEN 'Y'
         ELSE 'N'
    END AS hasmore
FROM table1 t1
LEFT JOIN (SELECT DISTINCT location FROM table1 WHERE week = '47') t2
  ON (t1.location = t2.location)
WHERE t1.location = 'VH' 
  AND t1.week = '46';
"
11129,2765,Can a primary key be empty? If yes why did this alter cause this result?,"INSERT INTO yourtable (id) VALUES (''); // will not work
"
32002,53635,SQL Analysing Data by Comparing Data Rows,"LAG() OVER (PARTITION BY ORDER BY)
LEAD() OVER (PARTITION BY ORDER BY)
SUM() OVER (ORDER BY)
SUM() OVER (PARTITION BY ORDER BY ROWS BETWEEN UNBOUND PRECEDING AND CURRENT ROW)
"
38161,41929,Why is my Percentage 0 when run on SQL Server?,"ROUND( (100.0*count(fpp.ID)) / ...
"
10282,13570,MySQL select based on the values of multiple columns,"SELECT * FROM table 
WHERE (column_2, column_3) IN (('a', 'b'), ('b', 'z'));
"
36373,23628,SQL Server interval numbers,"with tab1 as
(select table1.*,
 ROW_NUMBER() OVER(ORDER BY (SELECT 1)) -
 ROW_NUMBER() OVER(PARTITION BY status order by Cod) rn1,
 ROW_NUMBER() OVER(ORDER BY (SELECT 1)) -
 ROW_NUMBER() OVER(order by value) rn2
from table1)
select cod,min(value) min_val,max(value) max_val,status 
from tab1
group by cod,status,rn1,rn2;
"
23271,21882,How to write this postgresql dynamic query,"update employees_wgs
  set source = get_nearest_station(x,y);
commit;
"
39265,20971,Matching algorithm in SQL,"select x.name, max(x.rank) 
from matches x
join (
    select name from matches where prop = 1 AND rank > 5
    intersect
    select name from matches where prop = 3 AND rank >= 8
) y
    on x.name = y.name 
group by x.name
order by max(rank);
"
20236,66285,Joining 4 Tables in MS ACCESS,"select . . .
from (((a inner join
        b
        on . . .
       ) inner join
       c
       on . . .
      ) inner join
      d
      on . . .
"
8992,17772,MSSQL Totals per day for a month,"select Date,
  sum(case when [Program label] = 'Salary Day' then count else 0 end) [Salary Day],
  sum(case when [Program label] = 'Monthly' then count else 0 end) [Monthly],
  sum(case when [Program label] = 'Policy' then  count else 0 end) [Policy],
  sum(case when [Program label] = 'Worst Record' then count else 0 end) [Worst Record]
from Totals Group by [Date];
"
37577,39074,SQL of group by in order by,"select a, sum(b)
from (select t.*,
             (row_number() over (order by c) -
              row_number() over (partition by a order by c)
             ) as grp
      from table t
     ) t
group by grp, a
order by min(c);
"
16352,32007,Select TOP 1 from records with weight taken into account,"select top 1 t.*
from (select t.*, cumulative_sum(weight) as cumweight,
             sum(weight) over (partition by NULL) as totalweight
      from t
     ) t
where rand()*(totalweight+1) < cumweight
order by cumweight desc
"
3407,67312,SELECT number of groups resulted from a GROUP BY query,"SELECT count(*)
FROM (
        SELECT 1 as dummy
        FROM MyTable
        WHERE Col2 = 'x'
        GROUP BY Col1
     ) dt
"
31347,27128,SQL Bank DB: return only people with a given property,"  select c.customerID, c.name, a.UAN, a.balance, a.overdraft
  From customer c join current_acc a
  on c.customerID = a.customerID and a ='current account'
"
1682,49313,What is the difference between a keyword and a clause in SQL?,"SELECT  col1
        ,col2
        ,col3
FROM yourTable1 AS t1
INNER JOIN yourTable2 AS t2 ON t1.Id = t2.Id
WHERE col1 = 'aaaa'
AND col2 = 'bbbb'
ORDER BY col1
"
1418,68458,There is a way to generate a list of GUID's using NEWID function?,"SELECT TOP (100) Guid = NEWID() 
FROM [master]..spt_values;
"
21441,22838,Execute Stored Procedure in a Cursor,"create table #t
(
name sysname,
rows bigint,
reserved varchar(50),
data varchar(50),
index_size varchar(50),
unused varchar(50)
)

EXEC  sp_MSForEachtable 'insert into #t EXEC sp_spaceused ''?'''

select name,rows,reserved,data,index_size,unused 
from #t
"
17679,52619,"Stored procedure that Selects, Conditions, sets variables, then inserts/updates into a table","declare @someTable (
    idx int identity(1,1),
    column1 type,
    column2 type,
    etc type )

declare @counter

set @counter = 1

insert into @someTable (column1, column2, etc)
select column1, column2, etc from table1

while @counter < (select max(idx) from @someTable)
begin

   -- loop through records and perform logic
   insert result into table3

   set @counter = @counter + 1

end
"
19453,64298,Execute One Sql Agent Job by 2 users,"CREATE PROCEDURE 
    dbo.AnandPhadkeRunJob
WITH EXECUTE AS 'domain\username'
BEGIN
    SET NOCOUNT ON;
    EXECUTE msdb.dbo.sp_startjob @job_name = 'Do Something';
END
"
7380,595,Insert record into table using default values and values selected from another table using where clause,"SELECT 
    EmployeeID, 
    Name,
    'Retired' 
FROM Employees 
WHERE EmployeeID = '001'
"
20714,23600,Rebuild materialized view log,"SELECT MASTER, LOG_TABLE, COLUMN_NAME 
FROM USER_MVIEW_LOGS
    JOIN USER_TAB_COLS c ON table_name = LOG_TABLE
WHERE MASTER = 'TABLE_WHERE_LOGS_ARE_TAKEN'
"
170,67243,Insert values from a list in a single SQL statement,"INSERT INTO tbl (f1,f2) VALUES(1,2),(3,4),(5,6)...(55,77);
"
18452,21784,Select the lastest version of rows in a database,"select id,version, team, date, time, oppo 
from fixtures A where id in
(
    select max(id)from fixtures 
    where date = ""2012-06-01"" 
    group by team
)
"
30455,26134,SQL group by: using where-clause logic to filter results based on aggregate functions,"select url, avg(contentping+tcpping), count(*) from websites ws, ping pi 
where ws.idwebsite = pi.idwebsite and errortype is null
group by url 
having avg(contenetping+tcpping) < 500
order by avg(contentping+tcpping) asc;
"
10791,24635,How to show the Table Without cutting in Oracle,"set pagesize 1000;
"
10577,51896,Subtract value of a field from a count(*) query,"select p.PlanID, count(*) - p.Capacity
from Vahed as v2
join CustomerInProject c
  on c.VahedID = v2.VahedID
join Plan p
  on p.PlanID = c.PlanID /* or v.PlanID, it's not clear from the question */
group by p.PlanID, p.Capacity
"
14507,54085,MySQL Event Scheduler run 10 times per day,"CREATE EVENT event_name
  ON SCHEDULE
    EVERY 144 MINUTE
    STARTS (TIMESTAMP(CURRENT_DATE) + INTERVAL 1 DAY + INTERVAL 1 HOUR)
  DO
    # Your query
"
32105,47140,TSQL random value from table select in every row,"SELECT 
    ProdCode, 
    ProdName, 
    (
        SELECT TOP 1 ItemCode 
        FROM items 
        WHERE items.Assortment IN (102) AND itemcode <> products.ProdCode
        ORDER BY NEWID(), products.ProdCode
    )
FROM Products
WHERE ProductGroup IN (102) 
"
33728,40056,Why is my query ignoring one of the WHERE clauses?,"select ASIN
from aboProducts
    left join lowestprices
        on aboProducts.asin = lowestprices.productAsin
        and lowestprices.pricedate > (GETDATE()-1)
where lowestprices.productAsin is null
and aboProducts.amzlive=1
"
30337,743,Number of logins per user per day in a date range,"select userId,
       sum(date(timeOfLogin) = date(@day1)) as NumLogins_0,
       sum(date(timeOfLogin) = date(date(@day1) + 1)) as NumLogins_1,
       sum(date(timeOfLogin) = date(date(@day1) + 2)) as NumLogins_2,
       sum(date(timeOfLogin) = date(date(@day1) + 3)) as NumLogins_3,
       sum(date(timeOfLogin) = date(date(@day1) + 4)) as NumLogins_4
from table t
group by userId;
"
32053,44466,COALESCE in Where clause?,"SELECT name FROM names 
WHERE (colA = @colA) OR (colA = 'ALL' AND NOT EXISTS(
                                                SELECT name FROM names 
                                                WHERE colA = @colA)) 
"
6815,40874,SQL SERVER loop through and remove space from value,"UPDATE Country set code = RTRIM(code)
"
7724,45451,How do I insert into two tables all at once in a stored procedure?,"DECLARE @NewID INT

INSERT INTO Customer(LastName,FirstName,......) VALUES(Value1, Value2, .....)

SELECT @NewID = SCOPE_IDENTITY()

INSERT INTO Employment(CID,Employer,.....) VALUES(@NewID, ValueA,..........)
"
20175,25422,Updating a column using values from a Lookup table,"merge into products
using product_type
   on products.prod_code = product_type.prod_code
  and product_type.prod_region is null   
when matched then update
set prod_type = product_type.prod_type;

merge into products
using product_type
   on products.prod_code = product_type.prod_code
  and products.prod_region = product_type.prod_region
when matched then update
set prod_type = product_type.prod_type;
"
30164,43223,Can one efficiently LEFT OUTER JOIN a subset of the left table's rows in Postgres?,"WITH cte AS (
    SELECT id_a, name
    FROM   table_1
    WHERE  expensive_conditions_producing_three_rows
    )
SELECT c.id_a, c.name, t2.id_b
FROM   cte c
LEFT   JOIN table2 t2 ON t2.id_a = c.id_a
                     AND t2.name = (SELECT min(name) FROM cte)
"
7066,56657,SQL - Default Value based on a if command,"ALTER TABLE
        mytable
ADD     is_string_filled AS (CASE WHEN string_field IS NULL THEN 'N' ELSE 'Y' END)
"
5019,9356,SQL: Get last 3 posts of each theme,"SELECT * FROM
(
SELECT
IF(@prev != sq.theme, @rownum:=1, @rownum:=@rownum + 1) AS rownumber, @prev:=sq.theme, sq.*
FROM
(
    SELECT
    *
    FROM
    posts
    , (SELECT @rownum:=0, @prev:=0) r 
    ORDER BY theme, created DESC
) sq
) q
WHERE q.rownumber <= 3
"
23253,60461,How to combine date and time into a timestamp in db2?,"select timestamp(date_col,time_col) from your_table
"
9766,18901,mysql joins are driving me mad!,"SELECT uid
  FROM table-b
  INNER JOIN table-e
      ON table-b.ev_id = table-e.ev_id
  WHERE table-b.p_id NOT IN (SELECT p_id from table-d)
"
10258,13808,How can I SELECT additional columns with a TSQL query using GROUP BY,"SELECT email, entered, first, last
FROM (select v.*, row_number() over (partition by email order by entered desc) as seqnum
      from my_view v
     ) v
WHERE seqnum = 1;
"
6825,37232,Storing Business Hours in a Database,"CREATE TABLE ""business_hours"" (
     ""id"" integer NOT NULL PRIMARY KEY,
     ""business_id"" integer NOT NULL FOREIGN KEY REFERENCES ""businesses"",
     ""day"" integer NOT NULL,
     ""open_time"" time,
     ""close_time"" time
)
"
4950,8336,How to compare two datetime and find minutes,"your exmple

SELECT TIMEDIFF('2014-10-22 23:00:00.000','2014-10-22 20:00:00.000')

OR

SELECT TIMESTAMPDIFF(MINUTE, '2014-10-22 20:00:00', '2014-10-22 23:00:00')
"
32919,28867,"Selecting top results from SQL Count query, including table join - Oracle","SELECT *
FROM
(
SELECT customer.company_name, COUNT (item.pickup_reference) as ""Number of Pickups"" 
FROM customer
JOIN item ON (customer.reference_no=item.pickup_reference) 
GROUP BY customer.company_name, item.pickup_reference
ORDER BY COUNT (customer.company_name) DESC
) 
WHERE rownum <= 10
"
32932,44007,getting mysql max() value,"SELECT Name FROM item
WHERE qty = (SELECT MAX(qty) FROM item)
"
15075,25198,How do I write a query that outputs the row number as a column?,"SELECT ROW_NUMBER() OVER (ORDER BY beatle_name ASC) AS ROWID, * FROM beatles
"
2212,15787,SQL query for finding tables containing a column in my schema,"SELECT table_name
  FROM user_tab_cols
 WHERE column_name = 'IS_REVIEW_APPEALS'
"
11172,21957,How to change Null constraint for all columns ?,"FOR i IN
( SELECT * FROM user_tab_columns WHERE table_name = '<TABLE_NAME>' AND NULLABLE='N'
)
LOOP
  EXECUTE IMMEDIATE 'ALTER TABLE <TABLE_NAME> MODIFY i.COLUMN_NAME NULL';
END LOOP; 
"
16439,19007,Append corresponding brackets automatically using sql server,"Declare  @concatentated_value varchar(max)='aSD',
@append_stringfront varchar (12)='<',
@start_date date='01/06/2013'

SELECT 
     ISNULL(@concatentated_value + ',', '') + 
     ISNULL(@append_stringfront, '') + 
     CONVERT(VARCHAR, DATEADD(DAY, 1, @start_date), 101) + 
     ISNULL(char(ASCII(@append_stringfront)+2), '')
"
37348,45520,Connecting Three Tables SQL,"SELECT  c.*
FROM    tbl_section a
        INNER JOIN tbl_er b
            on a.section_ID = b.section_ID
        INNER JOIN tbl_enroll c
            ON b.student_ID = c.student_ID
WHERE   a.sectionname = 'sectionNameHere'
"
499,31851,Retrieve combined records' fields values based on another field in the record using SQL,"select `key`, group_concat(distinct val) as vals
from your_table
group by `key`
"
26794,63712,MySQL CREATE statement in MSSQL : the KEY keyword?,"CREATE TABLE database1.dbo.a (
  a nvarchar(25),
  b nvarchar(25),
)
GO

CREATE INDEX a_index
  ON database1.dbo.a(a)
GO
"
33372,38926,Insert results from Stored Procedure into table and add an extra column,"DECLARE @readerrorlog_results TABLE (
  LogDate date,
  ProcessInfo varchar(max),
  Text varchar(max)
)

INSERT INTO @readerrorlog_results
      (LogDate,ProcessInfo,Text)
EXEC sp_readerrorlog 0, 1, 'Login failed'

INSERT INTO FailedLogins
      (LogDate,  ServerName,ProcessInfo,Text)
SELECT LogDate,@@SERVERNAME,ProcessInfo,Text FROM @readerrorlog_results
"
5618,50500,SQL: Referencing calculated columns in other parts of the query,"select T1.SubTotal,
       T2.Tax,
       T2.Tax + T1.SubTotal as Total
from Invoice as I
  cross apply (select I.UnitPrice * I.Quantity) as T1(SubTotal)
  cross apply (select T1.SubTotal * (1 - 0.13)) as T2(Tax)
"
21728,3207,MySQL Cross-Table Count(*) Query Help,"SELECT `t1`.`id` , COUNT(`t2`.`id`) AS `count`
FROM `t1` LEFT JOIN `t2` ON `t1`.`id` = `t2`.`id`
GROUP BY `t1`.`id`
"
37365,6154,How to join mysql tables,"SELECT user.name, user.address, user.comment FROM user
UNION ALL
SELECT user_alias.alias, user.address, user.comment 
   FROM user INNER JOIN user_alias on user.name = user_alias.name
ORDER BY name
"
14363,34335,How to skip the first n rows in sql query,"declare @N int= 5 --Any random number

SELECT * FROM (
        SELECT ROW_NUMBER()OVER(ORDER BY ID)AS ID
              ,ID
        FROM TABLE_NAME
)AS tbl 
WHERE ID >= @N + 1
ORDER BY tbl.ID
"
19054,29449,Can a many-to-many join table have more than two columns?,"Team_Id
Position_Code
Member_Id
Start_Date
End_Date NULLABLE
"
37893,30455,Order by mixed alpha-numeric column in MySQL,"ORDER BY (class_code+0), right(class_code, 1)
"
21753,20867,"How to control number of returned rows in an SQL query, without knowing how many rows we need","SELECT C.CommentId, P.PostId FROM Post AS P
LEFT JOIN Comment AS C ON P.PostId = C.PostId
**where p.postID in (select top 2 postID from post order by postID)**
ORDER BY P.PostId ASC
"
31277,39241,How to show all result from one table and check condition,"SELECT v.*, b.bid
FROM TABLE A
LEFT JOIN TABLE B
ON A.AID = B.AID AND B.date > DATE_SUB(CURDATE(), INTERVAL 1 DAY)
"
31250,41734,Create SQL view column from result set,"SELECT *, SUM(Amount) OVER (PARTITION BY YEAR(Posting_Date)) Yearly
FROM la_tbl_lease_projection;
"
25608,21498,How to format the explain plan output in sqlplus,"set linesize value_size
"
20049,1343,SQL statement to randomly select one row having a certain criteria,"SELECT tmp.ID, tmp.Name, tmp.Last_Name, tmp.Location
FROM profiles
LEFT JOIN (SELECT * FROM profiles ORDER BY RAND()) tmp ON (profiles.Location = tmp.Location)
GROUP BY tmp.Location
ORDER BY profiles.Location;
"
10019,52323,Is there way to check if several fields from JOIN are equal?,"SELECT ""Timestamp""
     , Max(CASE WHEN PointId = 1 THEN ""Value"" END) As V1
     , Max(CASE WHEN PointId = 2 THEN ""Value"" END) As V2
     , Max(CASE WHEN PointId = 3 THEN ""Value"" END) As V3
     , Max(CASE WHEN PointId = 4 THEN ""Value"" END) As V4
     , Max(CASE WHEN PointId = 5 THEN ""Value"" END) As V5
FROM   t1
GROUP
    BY ""Timestamp""
"
5889,9272,Dropping rows from a table with condition check - SQLite,"delete from collection
    where cname not like '/mnt/sdcard%';
"
23251,31987,SQL Select ONLY Non-Empty Columns,"Select * 
From TableName 
Where ColumnA Is Not NULL And ColumnA <> '' 
  And ColumnB Is Not NULL And ColumnB <> ''
.......
"
31909,47219,New user unable to login oracle instead showing oracle,"grant connect, resourse to c##nisar;
"
30563,53900,change the value of a query when inserting,"update tab1 set column2 = column1 || 'test' where condition; 
"
6906,26707,Sql query: alter current year with DATEADD,"AND f.fy = YEAR(DATEADD(MM,6,GETDATE()))
"
20292,72852,Is there a fast way to update many records in SQL?,"UPDATE animalTable 
INNER JOIN CodeTable ON animalTable.CodeID = CodeTable.ID 
SET animalTable.cDescription = CodeTable.Description_1;
"
27050,69744,Sql statement with multi ANDs querying the same column,"if(count($parsed_array) > 0)
{
    $this->db->where_in('ItemID', $parsed_array);
}
"
37456,9330,Select a string between two known strings and output greater than one,"DECLARE @c varchar(100)

set @c = 'Leslie|N|McCrory'

SELECT SUBSTRING(STUFF(@c, 1, CHARINDEX('|',@c), ''), 0, CHARINDEX('|', STUFF(@c, 1, CHARINDEX('|',@c), '')))
WHERE LEN(SUBSTRING(STUFF(@c, 1, CHARINDEX('|',@c), ''), 0, CHARINDEX('|', STUFF(@c, 1, CHARINDEX('|',@c), '')))) > 1
"
9613,12599,How to join two columns to the same table,"SELECT U1.Username as UserFrom,U2.Username as UserTo, M.Message
FROM Messages M JOIN
     aspnet_Users U1 ON U1.UserId=M.UserFrom JOIN
     aspnet_Users U2 ON U2.UserId=M.UserTo
"
5072,4998,"PostgreSQL, CIDR - search all ip addresses that are cotained within networks - from cidr array","SELECT * 
  FROM sometable 
 WHERE (   ip_addr  = ANY ('all items from first array') 
        OR ip_addr << ANY ('all item from second array')
       )
"
23728,9909,How to display different views / HTML pages dependent on user?,"<div sec:authorize=""hasRole('ROLE_ADMIN')"">
  //show the save button  
</div>
<div sec:authorize=""hasRole('ROLE_USER')"">
  //show the view button
</div>
"
20957,16013,"Postgres, table1 left join table2 with only 1 row per ID in table1","select distinct on (user_id) * from user_stats order by datestamp desc;
"
37491,30710,Cannot create nested query in teradata,"SELECT  
    o.ID,
    u1.Name, 
    o.CloseDate,
    u2.Name As ManagerName,
FROM OPPORTUNITY  o
INNER JOIN USER u1
   ON u1.ID = o.ID
INNER JOIN USER u2
   ON u2.ID = u1.ManagerID
"
8885,67681,Getting the last database entry with sql is very slow,"SELECT  *
FROM    tableName
WHERE   time = (SELECT MAX(time) FROM device)
"
34590,33926,Relational Database Design for Customer Reviews,"             restquality (m:n)
                |n    |n
                |1    |
user     restaurant   |
 |1       |1          |1
 |        |n       quality
 +----n-review      |1
           |1       |
           |n       |n
        reviewquality (m:n)
"
8186,15526,"Count records by month where date is greater than X (day, month, year)","SELECT 
  Format(Max(FormSentOff),""mmm"") as Mth, 
  Count(*) as CountOfRecords
FROM tblDisclosure
WHERE FormSentOff >= DateAdd(""m"",-11,DateSerial(Year(Date()),Month(Date()),1))
GROUP BY Year(FormSentOff), Month(FormSentOff)
ORDER BY Year(FormSentOff), Month(FormSentOff)
"
20686,74749,SQL Return subquery 'Total Records' to outer query,"DECLARE @totalCount AS INT
DECLARE @result varchar(MAX)

SELECT @totalCount = COUNT(*) OVER(), @result = COALESCE(@result + '', '') + '<result title=""' + [Title] + '"" year=""' + [Year] + '"" type=""' + [Type] + '""/>'
FROM Movies where CONTAINS(Title, '@Title') Order by [Weight] DESC
OFFSET ((@PageNumber - 1) * @RowspPage) ROWS
FETCH NEXT @RowspPage ROWS ONLY
SELECT '<root totalCount=""' + CAST(@totalCount AS VARCHAR) + '"">' + @result + '</root>'
"
37669,33533,Selecting only a portion of a long text/varchar,"SELECT SUBSTRING(notes,
                 PATINDEX('%EXPEDITOR%', notes), 
                (DATALENGTH(notes) - PATINDEX('%EXPEDITOR%', notes))) 
FROM table
"
23275,70589,"Given a table with time periods, query for a list of sum per day","SELECT 
    SUM(NumericColumnName)
    , DateTimePeriods.StartDate
    , DateTimePeriods.EndDate
FROM 
    TableName
    INNER JOIN DateTimePeriods ON TableName.dateColumnName BETWEEN DateTimePeriods.StartDate and DateTimePeriods.EndDate
GROUP BY 
    DateTimePeriods.StartDate
    , DateTimePeriods.EndDate
"
19357,2219,Oracle BI Publisher - How to format numbers as text so that leading zeroes don't dissappear,"<fo:bidi-override direction=""ltr"" unicode-bidi=""bidi-override""><?YOUR_TEL_FIELD?></fo:bidi-override>
"
21478,63729,SQL generate sequential id's based on other column(s),"SELECT *, DENSE_RANK() OVER(ORDER BY Customer DESC)
FROM #OrderRanking
"
14692,9142,How to calculate interval between datetime in MySQL?,"mysql> select abs(datediff('2009-09-18 00:00:00', '2009-10-17 00:00:00'));
+-------------------------------------------------------------+
| abs(datediff('2009-09-18 00:00:00', '2009-10-17 00:00:00')) |
+-------------------------------------------------------------+
|                                                          29 |
+-------------------------------------------------------------+
1 row in set (0.00 sec)
"
9235,7526,What is the best way in SQL to swap the direction of a one-to-many relationship?,"update
    content,
    images
set
    content.image_id = images.id
where
    images.target_id = content.id
    and images.target_type = 'content'
    and images.target_column = 'images'
"
6694,42786,i want to merge two select statements,"SELECT KeywordId,currentposition,PsnUpdateDate,PsnUpdateBy
FROM seo.Tbl_KeywordPosition
WHERE psnupdatedate = '2015-01-22'
UNION
SELECT KeywordId,currentposition,PsnUpdateDate,PsnUpdateBy
FROM seo.Tbl_KeywordPosition
WHERE psnupdatedate ='2015-01-23';
"
28289,56495,MySQL Pivot Table Problem,"select form_id, 
max(case data_label when 'lastName' then data_value else null end) as lastname, 
max(case data_label when 'firstName' then data_value else null end) as firstname,
max(case data_label when 'phone' then data_value else null end) as phone
from mytable 
group by form_id
"
19835,35388,returning date from 30 days ago if current date is null,"SELECT (CASE WHEN lastupdatedatetime is null then DATEADD(day,-30,GETDATE()) ELSE lastupdatedatetime from ..
"
38608,49153,Garbage data while inserting data with special characters in SQL Server 2012 using Perl,"use Encode;
require Encode::Detect;
my $utf8 = decode(""Detect"", $data);
"
4655,2282,MySQL Select Sub-Queries or Joins,"SELECT a.id, 
       a.doctorid, 
       a.firstname, 
       a.lastname, 
       GROUP_CONCAT(distinct c.firstname, ' ', c.lastname) as assignednurse
FROM patients a
LEFT JOIN assignments b ON a.id = b.patientid
LEFT JOIN users c ON c.id = b.nurseid
WHERE a.doctorid = 22
GROUP BY a.id
"
25819,19976,SQL: Variable to update a set of items,";WITH NameHelper AS 
(
    SELECT
        Name,
        SetID
    FROM MyTable
    WHERE Name IS NOT NULL
    GROUP BY Name, SetID
)

UPDATE MyTable SET Name = NameHelper.Name
FROM MyTable
    INNER JOIN NameHelper ON MyTable.SetID = NameHelper.SetID
"
34850,58365,SQL calculation (Oracle),"select fine_id, fine_amount
---------------------------------------------------------------
-- add a coalesce here, in case ""payments"" returns a NULL match
---------------------------------------------------------------
, (fine_amount - coalesce(payments.already_paid, 0)) as outstanding_amount
from Fine left outer join
(
  select fine_id
  , sum(coalesce(payment_amount, 0)) as already_paid
  from Fine_payment
  group by fine_id
) payments
on Fine.fine_id = payments.fine_id
where Fine.fine_amount <> coalesce(payments.already_paid, 0)
"
23435,25926,Select primary Email from multiple emails that match First or Last Name,"select 
    ContactId, FirstName, LastName,
    case 
        when (Email1 like '%'+FirstName+'%' or Email1 like '%'+LastName+'%') then Email1
        when (Email2 like '%'+FirstName+'%' or Email2 like '%'+LastName+'%') then Email2
        when (Email3 like '%'+FirstName+'%' or Email3 like '%'+LastName+'%') then Email3
        else Email1 -- or whatever you want to use as the default
    end as Email
from Contacts
"
23175,16157,sql server 2005 - trigger to hash password at insertion,"create table TestTrigger2 (
TestTriggerID int not null identity(1,1),
Hashed binary(50),
PasswordProxy nvarchar(50)
)

--select HashBytes('MD5', N'This string')

create trigger HashPass2 on TestTrigger2
instead of insert
as 
begin
  insert into TestTrigger2 (Hashed)
    select HashBytes('MD5', '@!98ABc'+PasswordProxy) from inserted
end

insert into TestTrigger2
(PasswordProxy)
values
('My password' )

select *
from TestTrigger2
"
14703,36267,Compued Column FOR XML RAW HASHBYTES,"HASHBYTES('SHA1', ISNULL(CONVERT(varchar(20),[EmployeeID]),'') + '|' + ISNULL(CONVERT(varchar(20),[ClientID]),''))
"
24519,11660,SQL - AS - table doesn't exist - 1146,"SELECT [s? or maybe p?].pid
FROM swapping s INNER JOIN post p ON p.postid=s.postid
WHERE s.mid = '2'
ORDER BY date DESC
LIMIT(0,1)
"
5263,49392,Select distinct values from 3 columns into 1,"select * from (
select col1 as col from table
union 
select col2 as col from table
union
select col3 as col from table
) t where col is not null
order by col
"
24133,13338,finding max possible date in ms sql server 2005+,"CREATE FUNCTION fn_max_date
RETURNS datetime
AS
return cast('12/31/9999 23:59:59.9999' as datetime)
"
27143,69008,PostgreSQL: Casting two separate numeric values to a point,"INSERT INTO New_Table (my_id, my_point)
SELECT
    my_id,
    POINT(x, y)
FROM
    Old_Table
"
32569,3280,T-SQL Conditional IF statement,"SELECT DocID, Version, Name
FROM MyTable t
INNER JOIN (SELECT Name, MAX(Version) as Version
            FROM MyTable
            GROUP BY Name) sub
  ON Sub.name = t.name
  AND sub.version = t.version
"
35264,68185,Is it possible to order mysql records before grouping them?,"SELECT 
userid, 
address,
isdefault
FROM addresses
where isdefault = 1
union
SELECT 
userid, 
address,
isdefault
FROM addresses
where userid not in (select userid from addresses where isdefault = 1)
group by userid 
order by address desc
"
4700,43922,"Return ""YES""/""NO"" based on date comparison in sql","(case when project.PA_SUBMIT_DATE >= project.PA_AGREED_SUBMIT_DATE
      then 'YES' else 'NO'
 end)
"
4140,45560,"Retrieve Data that do not exist in the primary table, exist in the secondary only","select a.* 
from tableA a
Left outer join TableB b
on a.id=b.id
where b.id is NULL
"
21680,39036,How to write two replace functions in one select statement in Oracle,"select replace( replace( message, chr(ACII_Value), 0), chr(10), ' ') 
from my_table;
"
2524,54348,How to increase the chance that an old quote is selected,"select quote from quotes 
    where current date - display date > 1 week
    order by ((current date - display date - 1 week) * random number) desc
    fetch first row only
"
6386,31436,SQL replace old values with new ones,"Update  tbl.Products
Set articlenumber = replace(articlenumber, 's401', 'I00010')
"
14110,37411,CASE will ignore duplicate entries,"SELECT v.post_id, SUM(value = 1) AS likes, SUM(value = 0) AS unlikes,
       MAX(CASE WHEN user_id = 1 THEN vote_id END) AS user1_voteid,
       MAX(CASE WHEN user_id = 1 THEN value END) AS user1_vote
FROM votes v
GROUP BY v.post_id;
"
24828,742,Update record with count as a condition,"    update phone set IsValid=0 where id in
    (select id  from phone
    where id not in (
    select MAX(id)id
    from phone 
    group by phoneNo))
    and IsValid=1
"
31749,33948,help for a JOIN query,"SELECT 
    ads.*,
    c.description as categoryDescription,
    sc.description as subcategoryDescription,
FROM
    ads 
    INNER JOIN category c ON c.categoryID = ads.categoryID
    INNER JOIN subcategory sc ON sc.subcategoryID = ads.subcategoryID
"
23667,75405,sql server 2000 convert datetime to get hhmm,"SELECT REPLACE(CONVERT(varchar(5), GETDATE(), 108), ':', '')
"
21955,1369,RETURN a COUNT each row instead of a sum or single row in POSTGRES,"SELECT  SUM(active::BOOLEAN::INT) AS active, 
        SUM((NOT active::BOOLEAN)::INT) AS inactive, 
        entry_id_ref
FROM    sooper_entry
GROUP BY
        entry_id_ref
"
7881,3113,combine the result of the query in sql,"   SELECT array_agg(dpt), sum(cnt)
   FROM (
      SELECT dpt, count(name) as cnt
      FROM customer
      WHERE dpt='ece' OR dpt='cse'
      GROUP BY dpt) t;
"
19323,28264,How to reduce a long SQL query based on CREATE VIEW?,"SELECT * 
FROM table1
INNER JOIN table2 AS alias1
  ON table1.col1 = alias1.col1
INNER JOIN table2 AS alias2
  ON table1.col2 = alias2.col2
WHERE col2 = 'some_condition'
"
27360,21679,"PostgreSQL - Select distinct(column1, column2) where a condition holds","select least(attr1_id, attr2_id) as attr1, greatest(attr1_id, attr2_id) as attr2
from table t
group by least(attr1_id, attr2_id), greatest(attr1_id, attr2_id) 
having bool_and(rating_d = 1) ;
"
13266,9416,SQL - Multiple queries on same table,"SELECT DeviceName,
       SUM(CASE WHEN JobType = 'copy' THEN PageCount ELSE 0 END) AS Copy,
       SUM(CASE WHEN JobType = 'print' THEN PageCount ELSE 0 END) AS Print
FROM Tracking
GROUP BY DeviceName
"
35713,8540,Improving postgres sub query using coalesce,"SELECT c.id, c.title,
       (exists (SELECT 1 FROM case_messages cm WHERE cm.caseid = c.id and isfinalanswer = true)
       ) as hasfinalanswer
FROM cases c;
"
11636,18341,Selecting on another table if a table does not exist,"SELECT name FROM sqlite_master WHERE type='table' AND name='tbl_lite'
"
10937,56256,MySQL: can't order one side of a union,"SELECT * FROM something WHERE ... UNION SELECT * FROM (SELECT * FROM something WHERE ...  ORDER BY timestamp DESC)a
"
7537,1209,similar to SELECT * in sql but with only a row,"declare @cols nvarchar(max)

select @cols = coalesce(@cols + ', ' + column_name, column_name)
from information_schema.COLUMNS
where TABLE_NAME = 'mytable'

declare @sql nvarchar(max)
select @sql = 'select ' + @cols + ' from myTable where Id = 1'

exec sp_executesql @sql
"
7946,33418,Trouble with a JOIN,"SELECT VU.*, 
       COALESCE(UI.UserImg, 'dflt.jpg') as UserImg,
       COALESCE(CI.Interests, 0) as NumInterests 
FROM [vw_tmpUsers] VU LEFT JOIN
     (SELECT [tmpUserPhotos].UserID, MAX([tmpUserPhotos].uFileName) as UserImg 
      FROM [tmpUserPhotos] 
      GROUP BY UserID
     ) UI 
     ON VU.UserID = UI.UserID ;
"
38859,49410,Structuring user data by email address or by user ID,"users
  uid_0
   name:
   gender:
   etc
  uid_1
   name:
   gender:
   etc
"
8732,66532,How to connect to DB on SERVER for Asp.Net membership?,"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=<<PATH Goes Here>>;Persist Security Info=False;
"
28135,12443,mysql select count resource id #10,"$result = mysql_query(""SELECT COUNT(`category_id`) as count FROM `products_has_product_category`
WHERE `category_id`=1"");

$row = mysql_fetch_object($result);
$count = $row->count;
echo $count;
"
35265,56605,PostgreSQL multi INSERT...RETURNING with multiple columns,"WITH ins1 AS (
   INSERT INTO table1 (username, name,  surname)
   VALUES ('johnee','john','smith')
   RETURNING user_id
   )
, ins2 AS (
   INSERT INTO table2 (user_id, password)
   SELECT ins1.user_id, 'secret'
   FROM   ins1                            -- nothing to return here
   )
INSERT INTO table3 (user_id, adress, city, phone)
SELECT ins1.user_id, ...
FROM   ins1
RETURNING user_id;
"
17137,44104,Android: after SQLite database has data that is deleted how do I confirm database is empty?,"Cursor mCursor = db.rawQuery(""SELECT * FROM "" + DATABASE_TABLE, null);
Boolean isdbempty= mCursor.getCount()>0 ? false:true;
mCursor.close();
"
39018,38308,Oracle : Checking for NOT NULL in Tuples,"select orders.* from orders where Delivery_Date is not null or type !='A'
 /*Assuming type as a char field and this query will output all records 
             excluding deliverydate_null with type ='A' */
"
8932,59148,How in query result add 0-data for don't exist rows?,"SELECT
  NVL(T.DATA, 0) DATA,
  F.MONTH,
  T.YEAR
FROM <your_table> T
PARTITION BY(T.YEAR)
RIGHT JOIN (SELECT LEVEL MONTH FROM DUAL CONNECT BY LEVEL <= 12) F ON T.MONTH = F.MONTH
"
16947,49513,PostgreSQL window function: grouping by column without ordering (~ Python itertools.groupby),"WITH T1 AS
(
    SELECT
        id,
        grp,
        LAG(grp) OVER (ORDER BY id) IS DISTINCT FROM grp AS changes
    FROM yourtable
)
SELECT id, grp, SUM(changes::int) OVER (ORDER BY id) FROM T1
"
36333,59806,how to return only one query result from two query,"Select a.file_path, b.object_uid, b.object_utitle
from images a, (Select  object_uid, object_utitle
    from object_table
    where object_status = 2 and object_place like ""%some_keyword%"") b
where image_id In (
  Select image_id
  from temp_images
  where object_uid IN (b.object_uid) )
"
2254,58075,Merging two SELECTs into one from the same table?,"SELECT Name , MemberNumber
FROM (
    SELECT members.Name, friends.MemberNumber1 as MemberNumber
    FROM friends
    INNER JOIN members ON friends.MemberNumber1= members.MemNo
    WHERE friends.MemberNumber2 LIKE 1

    UNION ALL

    SELECT members.Name, friends.MemberNumber2 as MemberNumber
    FROM friends
    INNER JOIN members ON friends.MemberNumber2= members.MemNo
    WHERE friends.MemberNumber1 LIKE 1) AS derived1
ORDER BY derived1.Name
"
21669,71944,Use autogenerated column to populate another column,"CREATE TABLE Orders (
   ID      int         not null identity(1,1),
   OrderNo varchar(50) not null unique
)

CREATE TABLE #NewIDs ( ID int )

INSERT Orders (OrderNo)
   OUTPUT INSERTED.ID INTO #NewIDs
SELECT 12345

UPDATE o
   SET o.OrderNo = i.ID
FROM Orders o
JOIN #NewIDs i
   ON i.ID = o.ID

SELECT * FROM Orders
"
12571,57820,"How to implement a ""hasChildren"" SELECT statement in SQL?","SELECT MyTable.Id, CASE WHEN EXISTS 
    (SELECT TOP 1 1  --you can actually select anything you want here
     FROM MyTable MyTableCheck 
     WHERE MyTableCheck.ParentId = MyTable.Id
    ) THEN 1 ELSE 0 END AS HasRows
FROM MyTable
"
31262,65945,Transform SQL data set,"select y1.* from YourTable y1
join
(select Columnid,max(versionid) versionid from YourTable 
group by Columnid) as y2
on y1.Columnid = y2.Columnid and y1.versionid = y2.versionid
"
10754,48206,How to limit rows in PostgreSQL SELECT,"SELECT * FROM users LIMIT 5;
"
37121,4160,"Finding records in a range, rounding down when needed","select e.*
from example e
where e.date >= (select max(e2.date) from example e2 where e2.date <= @v_from) and
      e.date <= @v_to;
"
18458,51831,Criteria. Select biggest of two,"cb.selectCase().
    when(cb.greaterThanOrEqualTo(fromT.get(""xValue""), fromS.get(""yValue"")), fromT.get(""xValue"")). //-- If T has max value
    otherwise(fromS.get(""yValue"")); //-- Else, by default select value from S
"
2896,13221,Best way to do sql delete of data when looping through a set,"delete from sdata
    where id in (select id from TempList)
"
10362,50132,How to virtually delete data from multiple tables that are linked by a foreign key?,"SELECT Tbl_Subject.*, Tbl_Domain.isDeleted FROM Tbl_Subject INNER JOIN Tbl_Domain ON ...
"
30086,52987,SQL SELECT MIN(time) where time is a string,"SELECT max(time) from t;

SELECT min(time) from t;
"
37443,9856,How to join tables to see dates with null values?,"WHERE c.date between ""2016-01-01"" and ""2016-01-07""
AND (e.name in(""John"", ""Rob"", ""Jane"") or e.name is null)
"
3866,68381,"SQL Query output: Insert a row, based on a fields value","with    cte(customer,children,crates,i) as 
        (
        Select customer,children, children/80 + case when children%80 = 0 then 0 else 1 end crates, 0 from test
        union all
        select  customer,children,crates
        ,       i + 1
        from    cte
        where   cte.i < cte.crates -1
        )
select  customer,children,crates
from    cte
order by customer
"
23876,41461,How to declare and display a variable in Oracle,"DECLARE
    v_text VARCHAR2(10); -- declare
BEGIN
    v_text := 'Hello';  --assign
    dbms_output.Put_line(v_text); --display
END; 
"
25070,30429,Summarize Table Based on Two Date Fields,"SELECT a.ddate, a.soldamt, b.shippedamt 
FROM 
    (select order_date as ddate, sum(amount) as soldamt from TABLE group by order_date) a  
FULL OUTER JOIN 
    (select shipped_date as ddate, sum(amount) as shippedamt from TABLE group by shipped_date) b
ON a.order_date = b.shipped_date
"
19921,68769,"SQL select with """" netbeans without """"","  create table ""table1"" (id int not null);
  select * from table1 ;  -- ORA-00942: table or view does not exist
  select * from TABLE1;  -- ORA-00942: table or view does not exist
  select * from ""table1""; --ok

  ---------------------------- 
  create table table2 (id int not null); -- or TABLE2, or even ""TABLE2""
  select * from table2 ; -- ok
  select * from TABLE2;  --ok
  select * from ""TABLE2"";  --ok
"
36909,64296,"How to Select A number of data of table record, but before apply a condition on this record?","ALTER PROC [dbo].[SPFetchAllDisActiveUser]
(
    @StartRowIndex INT,
    @MaxRows INT
)
AS

BEGIN

SELECT * FROM
(
    SELECT *, ROW_NUMBER() OVER(ORDER BY [User-ID] ASC) AS RowNum 
    FROM [User-Tbl]
    WHERE [Gu-Id] IS NULL
) AS DisActiveUser
WHERE RowNum BETWEEN @StartRowIndex + 1 AND @MaxRows;

END
"
28391,39255,PostgreSQL: Selecting a DateTime that matches a whole day,"WHERE date_trunc('day', NOW() + INTERVAL '1 day') = date_trunc('day', the_column)
"
35859,9154,Deleting rows that have no associated row in another table,"delete from parent
where a < 10
      and not exists (select * from child where parent.id = child.parent_id)
"
13378,21434,How can I ensure a grant has been performed?,"select *
from all_tab_privs
where table_schema = 'MYSCHEMA'
and table_name = 'ORDERS'
and grantee = 'APP_USER';
"
10995,30537,COUNT using two (or more) columns,"SELECT c.class_name AS 'class Name', s.Child_gender AS 'Gender',
       COUNT(s.student_id) AS 'Count'
FROM student s
INNER JOIN classRegister cr ON s.student_id = cr.student_id 
INNER JOIN classes c ON cr.class_id = c.class_id
GROUP BY s.Child_gender, s.class_id, c.class_name
ORDER BY c.class_name
"
37481,57939,"Merging records with SQL, with some rules","SELECT a.NAME AS NAME,(
SELECT ISNULL(b.INSTRUMENT, '')+ ' '
FROM dbo.COExample b WHERE b.NAME=a.NAME
FOR XML PATH('')) AS INSTRUMENT, MAX(CAST(BOOLEAN1 AS int)) AS BOOLEAN1, MAX(CAST(BOOLEAN2 AS int)) AS BOOLEAN2
FROM dbo.COExample a
GROUP BY a.NAME
"
29349,21113,How do I write this database comparison in Oracle PL/SQL?,"SELECT PRIMARY_KEY
FROM
(
SELECT * FROM x.MY_TABLE
MINUS
SELECT * FROM y.MY_TABLE
) T;
"
24295,26212,Query for finding the tuple with other corresponding elements of value x,"SELECT n1, n2, n3
FROM data
WHERE n4 = 0

EXCEPT

SELECT n1, n2, n3
FROM data
WHERE n4 <> 0
"
13972,12431,Hibernate Query on self join table fails,"Criteria crit = session.createCriteria(Example.class);
crit.add(Restrictions.eq(""name"", dsd.getName()));       
crit.createAlias(""parent"", ""parent"");
crit.add(Restrictions.eq(""parent.name"", dsd.getParent().getName()));
"
38491,26608,how to update multiple column in a single table,"update [dbo].[HRAllowances] set  Amount=@Amount
"
20839,46205,How expensive is access to database? How often do we access to it?,"SELECT 1;    // 0.005 Secs :D
"
35370,39520,Find and group duplicates,"SELECT  a.names NAME,
        b.names DUPE_NAME,
        COUNT(*) NUM_DUPES
FROM    names_tbl a, names_tbl b, md5_tbl md5a, md5_tbl md5b
WHERE   a.id < b.id
AND     a.id = md5a.id
AND     b.id = md5b.id
AND     md5a.md5 = md5b.md5
GROUP BY a.names, b.names
ORDER BY a.names
"
35359,46936,SQL Count() column values,"SELECT t.code, COUNT(*) AS `count`
FROM MyTable t
GROUP BY t.code
ORDER BY COUNT(*) DESC
"
2244,71933,How to run a query across three tables in MySQL using Joins?,"SELECT s.* 
FROM   grades g 
       JOIN module m 
         ON m.moduleid = g.moduleid 
       JOIN student s 
         ON s.studentid = g.studentid 
WHERE  g.studentid LIKE '10%' 
       AND g.grade = 'B' 
       AND m.modulename = 'Intelligent Systems' 
"
29050,69085,"Find duplicates or more in Mysql, delete them except the first one input"," DELETE FROM `80dage_garmin_track` t1
 WHERE EXISTS (SELECT 1 from `80dage_garmin_track` t2
          WHERE t1.Length = t2.Length
           AND t1.Time = t2.Time
           AND t1.idgarmin_track > t2.idgarmin_track)
"
17054,22331,Select Count(Distinct Value) returns 1,"Count(Distinct Cast(O_ID as Int))
"
4144,30269,Creating SQL table with range of months as columns and populating fields with table data,"SELECT  Project, [Jan 2014], [Feb 2014], [Mar 2014], [April 2014]
FROM    T
        PIVOT
        (   SUM(MonthValues)
            FOR Months IN ([Jan 2014], [Feb 2014], [Mar 2014], [April 2014])
        ) pvt;
"
33074,43856,SQL check if group contains NULL,"select id, 
       count(*) - count(value) as value
from your_table
group by id
"
21115,52009,Oracle triggers and stored procedures,"create or replace trigger trg_update_code
  before insert or update on foobar
  for each row
begin
  :new.code := f_generate_code();
end;
/
"
1906,40289,SQl Query to Hibernate Query,"String query = ""from QUESTION order by newid()"";
Query q = session.createQuery(query);
q.setMaxResults(10);
"
27588,68623,Import database from phpmyadmin to webmin,"1.Log into your Virtual control panel
2.Select the domain that the MySQL database belongs to
3.Click on the Edit Databases link towards the left and then click import database.
"
23684,43716,How to get a list of all tables from the database together with column names,"SELECT TABLE_NAME, COLUMN_NAME, DATA_TYPE, IS_NULLABLE, COLUMN_DEFAULT
  FROM INFORMATION_SCHEMA.COLUMNS
  WHERE table_name = 'tbl_name'
  [AND table_schema = 'db_name']
  [AND column_name LIKE 'wild']
"
14187,51838,Sliding Window Average For Multiple Time Periods - SQL Server,"select
    DATEADD(month, -n.number, getdate()) OneMonthFromThisDate,
    avg(datediff(dd, acquisitiontime, createdate)) AverageInThisMonth
from users
join master..spt_values n on n.type='P' and n.number between 1 and 24
where createdate >  DATEADD(month, -n.number, getdate())
  and createdate <= DATEADD(month, 1-n.number, getdate())
  and acquisitionmedium = 'cpc'
  and acquisitionsource = 'google'
  and acquisitiontime is not null
group by n.number, DATEADD(month, -n.number, getdate())
order by n.number
"
30224,9064,How can I see the Original MySQL used to create a view in phpMyAdmin or other program?,"show create view my_view_name;
"
26526,66357,"Running through SQL select statements on oracle apex. One returning ""SQL command not properly ended"" and I don't know why","select F_NAME, L_NAME, POSTCODE
from CUSTOMER
where POSTCODE like 'FB1%' OR POSTCODE like 'FB2%';
"
456,53946,Mysql replace a part from search (replace by pattern),"SET @a = ""..some text1 <a href=\""http://url_1_begin<a href=\""http://url2\"">_url_1_middle_</a>url_1_end\""> some text2 </a> some text3.."";

SELECT REPLACE(REPLACE(@a,""<a href"",""href""),""</a>"",'');
"
12363,26766,How does UPDATE work?,"UPDATE table_to_update 
SET whatever_you_want_to_set 
From temptable 
inner join temptable on temptable.key = table_to_update.key
"
26908,59344,How to set up an extra constraint for 1-to-many relationship without using triggers,"CREATE UNIQUE NONCLUSTERED INDEX [IX_DefaultRecord] ON [dbo].[FooXRef]
(
    [BarID] ASC,
    [DefaultRecord] ASC
)
WHERE ([DefaultRecord]=(1))
"
15597,55516,Multiple conditions on the same column in the WHERE clause,"select PropertyVal
from your_table
where PropertyID = 7
and RecordID in 
(
  select RecordID   
  from your_table
  where PropertyID = 13 AND PropertyVal='Business Development Analyst'
  or PropertyID = 11 AND PropertyVal = 'Chicago'
  group by RecordID   
  having count(distinct PropertyID) = 2
)
"
37177,62305,SQL Server 2008 Insert with WHILE LOOP,"INSERT INTO TheTable(HospitalID, Email, Description)
SELECT 32, Email, Description FROM TheTable
WHERE HospitalID <> 32
"
13666,1341,"SQL help, selecting specific columns","DECLARE @myTable TABLE (myColumn nvarchar(100))
INSERT @myTable (myColumn) VALUES ('Crystal77'), ('Bólido Comidas'), ('PlainEnglish')

SELECT * FROM @myTable
     WHERE myColumn COLLATE Latin1_General_BIN NOT LIKE '%[^ a-zA-Z]%'
"
29932,3266,Need a (simple) SQLite Statement,"SELECT FRIENDS.* from FRIENDS
INNER JOIN FRIENDLIST
ON FRIENDS.FriendID = FRIENDLIST.FriendID
WHERE FRIENDLIST.userID = ?
"
28420,9863,Is there a way to return each value as a row in SQL,"select 'Draft' as Enum
union
select 'Submitted' as Enum
union
select 'Cancelled' as Enum
union
select 'Accepted' as Enum
union
select 'Accepted and Modified' as Enum
union
select 'Open' as Enum
union
select 'Pending' as Enum
union
select 'Seller Reject' as Enum
"
17782,8902,MYSQL QUERY FOR THE FOLLOWING SCENARIO,"order by userid in (1, 3, 4, 5, 6) desc,
         (case when userid in (1, 3, 4, 5, 6) then last_login end) ASC,
         id ASC
"
4134,48414,Sql Delete Multiple Data at Multiple Tables,"DELETE  products, images
FROM products INNER JOIN images
ON  images.productID=products.id and products.id='23'
"
2689,73650,How to find out if select grant is obtained directly or through a role,"select grantee from all_tab_privs 
where table_schema = 'SCOTT' and table_name='EMP'
and privilege = 'SELECT';
"
29633,8516,Oracle - How to have an out ref cursor parameter in a stored procedure?,"create or replace procedure get_info(p_cursor out sys_refcursor)
is
begin
  open p_cursor for
    select *
    from   v$database; 
end;
/
"
8945,7906,Best way to get single MAX value + another column value from SQL,"SELECT B.*, (C.StartPoint + C.Length) AS UsedSize
FROM TableB B
INNER JOIN 
(
  SELECT *, DENSE_RANK() OVER(PARTITION BY C.MajorID, C.MinorID ORDER BY C.StartPoint DESC) AS Rank
  FROM TableC C
) C
ON C.MajorID = B.MajorID
AND C.MinorID = B.MinorID
AND C.Rank = 1
"
33849,48877,How can I do asynchrous database in JavaFX,"public class FlightControllerTask extends Task<LinkedList<Flight>>{
  @Override
  protected LinkedList<Flight> call() throws Exception { 
    // load data
    return data;
  }
}

// usage:
FlightControllerTask task = new FlightControllerTask();
task.setOnSucceeded(ev -> task.getValue());
new Thread(task).start();
"
25540,65236,Replace empty/null string with result from another record,"SELECT
  IIf (
    NZ(TRANSLATION.Text,"""") = """", DEFAULT.TEXT, TRANSLATION.TEXT)
FROM 
  TRANSLATIONS AS TRANSLATION,
  TRANSLATIONS AS DEFAULT, 
  PROGDATA
WHERE
  TRANSLATION.Tag=""prog_"" & PROGDATA.Id
  AND 
  DEFAULT.Tag=""prog"" & PROGDATA.Id
  AND
  TRANSLATION.LanguageId=1 
  AND 
  DEFAULT.LanguageId=2
"
3131,50099,mongodb inbox structure multi addresses,"db.inbox.find({receipients:{$elemMatch:{userId:456,read:false}}})
"
18585,49696,Querying for rows with no foreign key (NOT NULL Foreign key) pointing to them,"SELECT D.Id as Id, A.Id as A_Id, B.Id as B_Id, C.Id as C_Id
FROM D
   LEFT OUTER JOIN A --this is the nullable one
      ON D.Id = A.D_Id
   LEFT OUTER JOIN B
      ON D.Id = B.D_Id
   LEFT OUTER JOIN C
      ON D.Id = C.D_Id
WHERE A.Id IS NULL AND B.Id IS NULL AND C.Id IS NULL
"
21837,47405,How to calculate a total of values from other tables in a column of the select statement,"SELECT co.id, 
       COUNT(do.DenID) AS `Total denominations`, 
       SUM(d.amount) AS `Total amount`
FROM CustOrder co
INNER JOIN DenominationOrder do ON co.id = do.OrderId
INNER JOIN Denomination d ON do.DenId = d.id
GROUP BY co.id
"
33075,32366,SQL Server query related to grouping and counting for inventory analysis,"SELECT part, MIN([Pieces In Stock]/[Pieces Required]) AS PossibleCompleteDolls
FROM tblName 
WHERE [Pieces Required] <> 0
GROUP BY part;
"
5392,48750,Rewriting query to format sql results differently,"WITH cte AS (
  SELECT ""product_type"", ""availDate"", ""quantity"" 
  FROM myTable 
)
SELECT * FROM cte
PIVOT (SUM(""quantity"") AS Quantity for (""availDate"") IN
       ('15-Feb-2013',
        '16-Feb-2013',
        '17-Feb-2013',
        '18-Feb-2013',
        '19-Feb-2013'))
ORDER BY ""product_type""
"
21971,36975,SQL Server 2008 - update a field if date is older than 60 days,"UPDATE user_Group SET Banner_flag = 2, warning_Date2 = GETDATE() 
WHERE DATEDIFF(DAY, warning_Date1, GETDATE()) >= 60 
      AND Banner_flag < 2 --This subject to your mechanism
"
13434,1202,Oracle sql functions,"SELECT id, Type, CreationDate
FROM  ""table""
ORDER BY CreationDate ASC,
         CASE WHEN Type = 'name1' THEN 1
              ELSE 2
         END ASC
"
30482,52670,efficient date comparison in sqlite?,"SELECT date('now', 'start of month');

SELECT COUNT(*) FROM events WHERE millis > ?;
"
19582,63882,How to count distinct elements from different tables in mysql?,"select id, count(id)
from(
  select id from d1
  union all
  select id from d2
  union all
  select id from d3
) t
group by id
"
22853,72483,Comparing 2 tables with same structure in postgreSQL,"SELECT 
     l.*
INTO 
     #someTempTable
FROM 
    lov l
WHERE NOT EXISTS 
(SELECT <<someUniqueOrCompositeKey>> FROM lov_tmp)
"
6262,2672,How to combine the rows of two different tables into the same column?,"SELECT Blah_Blah from Table1 WHERE <some condition>
UNION
SELECT Blah_Blah from Table2 WHERE <some contition>
"
21133,48567,Block a row from reads whilst sp executes,"SELECT @status = status FROM t (UPDLOCK) WHERE t.id = @id
"
5606,53726,Inner and left join on the same tables,"select a.x, a.y
from TableA a
inner join TableB b on a.x = b.x
"
23021,37742,ruby on rails store sql result on a variable,"@answer = q.answers.first # answers is an array, take the first
if @answer.name == ...
"
11808,47236,postgresql group_by with date in localtime,"select date(date_time_field at time zone 'brt')
from ..
group by 1
"
523,50953,Change first 200 record in a column into sequent,"SET @rownumber = 0;
UPDATE your_table
SET your_column = (@rownumber := @rownumber + 1)
ORDER BY the_column_that_defines_the_order_of_the_first_200_records
LIMIT 200;
"
2861,19184,Remove special char using select statement SQL," SELECT ID, REPLACE(CompanyName ,'''', """") as company_name FROM tblCompany
"
28749,30496,SQL Server select duplicated rows,"select NationalIDNumber 
from Ben_VEmployee 
group by NationalIDNumber
having min(DepartmentID) <> max(DepartmentID);
"
17361,28910,Updating a COLUMN Based on a Field Value,"UPDATE TableName
SET A = (CASE WHEN D = 'A' THEN C ELSE A END),
    B = (CASE WHEN D = 'B' THEN C ELSE B END)
"
2067,20946,datediff() not ignoring time,"... DATEDIFF(CURRENT_DATE(), DATE(shouts_stores.date)) <= 7
"
24259,24233,How to get second parent with recursive query in Common Table,"with tmp as (
  select unitId, parentId, unitName, 0 as iteration
  from t
  where unitId = 7
  union all
  select parent.unitId, parent.parentId, parent.unitName, child.iteration + 1
  from tmp child
  join t parent on child.parentId = parent.unitId
  where parent.parentId != 0
)
select top 1 unitId, parentId, unitName from tmp
order by iteration desc
"
35256,74329,"Django sql query,'__startswith date and time'","Mpool.objects.filter(date__gte=start_date, date__lte=end_date)
"
15049,61906,How do I get the return value from a function in Oracle using Toad,"begin
    dbms_output.put_line(packagename.functionname(paraname));
end;
"
17122,24585,Mysql select all that match a number in string,"select * from testtable
where instr(concat(', ', longstring, ', '), ', 2,') >0;

select * from testtable
where instr(concat(', ', longstring, ', '), ', 1,') >0 
and  instr(concat(', ', longstring, ', '), ', 2,') >0;
"
35838,20777,Join two tables who both have a record,"SELECT p.PicID, p.Name, i.Picture
    FROM Products p
        INNER JOIN Images i
            ON p.PicID = i.PicID
"
9195,27702,How can you set a value in an update statement based on 2 parameters?,"UPDATE MyTable
SET FirstName = @FirstName,
    LastName = @LastName,
    JobNumber = CASE WHEN @MyMainParameter IS NOT NULL THEN COALESCE(@JobNumber, JobNumber) ELSE JobNumber END
WHERE ...
"
3525,41942,Loop through all the rows of a temp table and call a stored procedure for each row,"DECLARE @id int
DECLARE @pass varchar(100)

DECLARE cur CURSOR FOR SELECT Id, Password FROM @temp
OPEN cur

FETCH NEXT FROM cur INTO @id, @pass

WHILE @@FETCH_STATUS = 0 BEGIN
    EXEC mysp @id, @pass ... -- call your sp here
    FETCH NEXT FROM cur INTO @id, @pass
END

CLOSE cur    
DEALLOCATE cur
"
26761,44400,Oracle SQL - Joins Syntax/Keywords,"SELECT e.name, e.employeeid, d.sales, d.task, sum(d.hours)
FROM employee e
JOIN timecard d on e.employeeid = d.employeeid
WHERE ...
GROUP BY ...
ORDER BY ...
"
9209,31382,SQL Server Cross Type Query,"SELECT B.BusinessID, U.UserID FROM tblBusiness AS B, tblUser AS U
"
1209,41610,How to avoid nesting sql query with row_number,"select top (20) percent t.*
from testtable t
order by row_number() over (order by id asc)) % 5;
"
7963,36965,Set Limit for a Table Rows In SQL,"create trigger LimitTable
on YourTableToLimit
after insert
as
    declare @tableCount int
    select @tableCount = Count(*)
    from YourTableToLimit

    if @tableCount > 50
    begin
        rollback
    end
go
"
3391,27146,SQL Server Query for distinct rows,"select mindate, count(*) as NumNew
from (select CustId, min(Date) as mindate
      from table t
      group by CustId
     ) c
group by mindate
"
7124,73427,Why isn't this mysql query working?,"SELECT x_commmunities.* 
FROM x_commmunities
JOIN x_community_invites  on x_commmunities.id=x_community_invites.community_id
WHERE x_community_invites.to = '%s' AND x_community_invites.accepted = '%d'
"
10714,29190,Get the total number of rows from two different tables with the same id drops me more rows,"SELECT a.a+b.b as count
FROM (
SELECT count(*) as a
from correccion
where id_acp = '361838021102014'
) a,
(
SELECT count(*) as b
from acciones
where id_acp = '361838021102014' 
) b
"
12537,5407,Advance select query in mysql,"Select cat_id FROM connections c
where 
(id between 1 and 5 AND (c.connector_id = id OR c.user_id = id)
   AND  (c.connector_id = oid OR c.user_id = oid)) 
OR id > 5 AND (oid = user_id and id = connector_id)
"
25913,503,Select Users who have made the most positive contributions,"select 
     count(artc_status) as stats , 
     count(case when artc_status=1 then 1 end) Positive,      
     artc_user[Contributing User] 
from 
    contributions 
group by 
    artc_user 
order by  stats desc;
"
33199,18398,Delete specific word at the beginning,"UPDATE my_table SET path = substring(path, 8, 9999);
where path like '/PicsDB%'
"
20789,57122,SQL CTE Syntax to DELETE / INSERT rows,"BEGIN;

DELETE FROM <some_table> WHERE id = <id_value>;

INSERT INTO <some_table> (id, text_field)
VALUES ( <id_value>, '<text_field_value>')
RETURNING *;

COMMIT;
"
12839,14174,GORM / HQL - LISTAGG,"class MyDomain {
    Long parentId
    String titleAgg

    static mapping = {
        titleAgg formula: '(SELECT LISTAGG(e.title) FROM Entity e WHERE e.parrent = parent_id)'
    }

}
"
24669,51367,Listing specific data in Query,"  SELECT 
  Students.StudentName,
  Students.StudentNumber,
  Schools.SchoolAddress 
FROM
  XSchools 
  INNER JOIN YStudents 
    ON Schools.schoolName = Students.schoolName 
WHERE Schools.schoolName = 'London School' 
"
3777,46333,How to change oracle Date from mm/dd/yyyy formate into MON DD YYYY formate,"select id, to_char(date, 'MON DD YYYY') 
from the_table;
"
27065,26403,Sql Subquery result,"UPDATE A SET A.name = B.Name
FROM A
JOIN C
ON C.latlong = A.latlong
JOIN B
ON B.code = C.code
"
5043,63503,Alternative to subquery,"SELECT t.*
FROM title AS t
LEFT JOIN rank AS r ON (t.title_id = r.title_id AND r.subject_id = 2)
WHERE r.title_id IS NULL
"
5037,67537,Having trouble querying dbpedia,"SELECT ?name WHERE {
  ?person dct:subject <http://dbpedia.org/resource/Category:American_mixed_martial_artists>.
  ?person foaf:givenName ?name
}
"
26698,31052,How do I specify that values in a column must already exist in another table?,"CREATE TABLE t1 (
    id integer PRIMARY KEY,
    txt character varying(30));

CREATE TABLE t2 (
    id integer PRIMARY KEY,
    t1_id integer,
    FOREIGN KEY (t1_id) REFERENCES t1(id));

CREATE VIEW t2ANDt1
AS
   SELECT 
     id,
     t1_id,
     t1.txt
   FROM t2
   INNER JOIN t1 ON t2.t1_id = t1.id
"
9422,63837,SQL : File Name,"SELECT *
    FROM SYS.sysfiles
    WHERE NAME LIKE'[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]%'
"
18180,25629,SQL query with distinct and sum,"SELECT color, fruit, sum(rating)
FROM medleys
GROUP BY color, fruit
"
30245,24988,Manually generate id of document inserted into Mongodb,"var user = new User();
// user._id is already set.
...
user.save();
"
8122,1731,Update the records in a table with certain condtion,"UPDATE table
SET id = CASE WHEN id % 15 = 0 THEN 15 ELSE id % 15 END
"
30738,48805,SQL: Add multiple rows from one table to another when no data for that date in new table,"INSERT INTO Table2 (date, var1a, var2a, var3a)
SELECT date, var1, var2, var3 
FROM Table1 t1
WHERE NOT EXISTS (SELECT 1 FROM Table2 t2 WHERE t2.date = t1.date)
"
1958,16309,How to Trace Procedure execution time?,"/* Start of your procedure */
Declare @startTime datetime = GETDATE()
Declare @duration varchar

/* Your procedure */
...

/* End of your procedure */
Set @duration = CONVERT(VARCHAR(8),GETDATE() - @startTime,108)
Insert into statisticTable 
Values ('procedureName', @duration)
"
2485,53059,Query for before or after the characters,"Select Name from Employees where Name LIKE '%aj'
"
2195,246,Have you ever done SQL injection?,"user: admin
pass: ' OR '1'='1
"
27897,62225,Update query in sql,"UPDATE Table1 set f1 = REPLACE(f1,'""',''), f2 = REPLACE(f2,'""','');
"
11691,5867,SQL: Create table with two indexes,"ALTER TABLE myTable
ADD UNIQUE INDEX `UI_myTable_idB` (`id_B` );
"
1276,18758,Oracle XML - How to escape text between tags.,"SELECT REGEXP_REPLACE(COUNTRY,
                      '(<.*>.*)(&)(.*</.*>)',
                      '\1&amp;\3') AS REPLACEMENT_TEXT
  FROM COUNTRY_LIST;
"
24901,73976,SQL Joining on Different cell values,"SELECT Name,A.Code,B.Code,B.Val 
FROM table1 A
JOIN table2 B ON A.Code =LEFT(B.Code,PATINDEX('%[0-9]%',B.Code)-1)
"
3657,67831,Can Oracle allow Permanent Alias for a table?,"create materialized view M_Parts            
tablespace USERS
refresh fast
as select * from Parts
"
37202,47057,orderby in sql query,"select
  foo,
  bar
from
  bortz
order by
  case foo 
    when 'E' then 1
    when 'C' then 2 
    when 'T' then 3 
    else 4 
  end
"
30374,15731,select distinct on one column and return its row,"SELECT JPNUM, 
       MAX(DESCRIPTION) AS DESCRIPTION
  FROM WORKORDER
 WHERE WORKTYPE = 'INSP'
   AND PARENT = ''
 GROUP BY JPNUM
 ORDER BY JPNUM
"
16600,40348,SQL Query : Fetch Entire Row with Minimum value in the table,"SELECT TOP (1) WITH TIES *
FROM Employee
WHERE EmployeeType = 'P'
ORDER BY Salary
"
18270,56402,Select Failed in Teradata,"sel * from TableA where ssn='9CB2EE'xb
"
23828,10418,select rows if all meets same criteria and only one meets a criteria,"select orderid,
       (case when min(status) = max(status) and min(status) in ('NEW', 'CLOSED')
             then min(status)
             when sum(case when status = 'PENDING' then 1 else 0 end) > 0
             then 'PENDING'
             else 'This case is not described in the question'
        end)
from t
group by orderid;
"
18763,41619,SQL Server 2008 - limiting query by FK,"SELECT TOP 1
 ftt.RANK, p.ProductId, p.SearchableDescription
FROM Products p
INNER JOIN CONTAINSTABLE(Products, SearchableDescription, @FullTextQuery) AS ftt
 ON ftt.[KEY]=p.ProductId
LEFT OUTER JOIN ShopProduct s
 ON (p.ProductId = s.ProductId AND s.ShopId = @ShopId)
WHERE s.ProductId IS NULL
ORDER BY ftt.RANK DESC
"
32069,2196,SQL finding the maximum of all averaged results,"select top 1 id, name, avg (salary)
from instructor
group by id, name
order by avg (salary) desc
"
14874,52136,SQL query to search in a concated string,"SELECT * FROM prospect
WHERE CONCAT(firstname,' ',lastname) LIKE '%ohn Smit%'
"
4002,38363,Retrieve name and address of employees working in department,"SELECT D.DNAME,E.FNAME+' '+E.MINIT+' '+E.LNAME as NAME
FROM EMPLOYEE E INNER JOIN
DEPARTMENT D ON E.DEPARTMENTNUM=D.DEPARTMENTNUM
"
28236,57065,MySQL. Insert UTF-8 characters to database,"if (!$mysqli->set_charset(""utf8"")) {
    printf(""Error loading character set utf8: %s\n"", $mysqli->error);
} else {
    printf(""Current character set: %s\n"", $mysqli->character_set_name());
}
"
5372,53472,Escape percent sign in SQL query regex?,"SELECT * FROM example WHERE content REGEXP '[[:<:]]100%([[:blank:]]|[[:punct:]]|$)';
"
6254,26837,Keep First N number of rows and delete the rest,"DELETE FROM
    ZZ_TEST_FINTABLE 
WHERE
    PROCESS_INSTANCE NOT IN 
    (
        SELECT PROCESS_INSTANCE 
        FROM ZZ_TEST_FINTABLE 
        WHERE ROWNUM < 9
    );
"
1230,67348,Checking for certain data across servers in MySQL,"SELECT count(*) FROM Table1
WHERE userID = 'some_value' AND user_level = 3
"
31670,75068,SQL Adding count (from 2 tables) to existing select (of 3 tables),"SELECT `thread_subject`, COUNT(*) AS PostCount 
FROM `fusion_posts` JOIN `fusion_threads`
ON fusion_posts.thread_id=fusion_threads.thread_id JOIN `fusion_users` 
ON fusion_posts.post_author=fusion_users.user_id 
GROUP BY fusion_posts.thread_id, `thread_subject` 
ORDER BY `post_id` DESC 
LIMIT 16
"
10207,38992,Appending '0' after decimal in Oracle,"to_char(col_name,'999999.000')
"
5400,48449,"Sql order by first, then next","select studentname from table1
order by isedited, ismanuallyadded, studentname
"
9007,46040,Incremental update of Table,"    MERGE A2 AS target
    USING (SELECT * FROM A1) AS source 
    ON (target.Id = source.Id AND target.a1 = Source.a1...) -- More join condition
    WHEN MATCHED THEN 
        UPDATE SET a2 = source.a2, a3 = source.a3 ------ more columns
WHEN NOT MATCHED THEN
    INSERT (Id, A1, a1, a2....)
    VALUES (source.Id, source.a1, source.a2.....) 

WHEN NOT MATCHED BY SOURCE
        THEN DELETE 
END;
"
33246,65004,Getting 1 record even a day includes 2 different record,"DATEADD(DD, DATEDIFF(DD, 0, STARTTIME), 0)  BETWEEN DATEADD(DD, DATEDIFF(DD, 0, <DATE_TIME_PARAMETER>), 0) AND DATEADD(DD, DATEDIFF(DD, 0, <DATE_TIME_PARAMETER>), 0)
"
10438,45184,SQL- Left Join to Replace Not in,"SELECT vp.ruleid 
FROM   #versions vp 
       LEFT JOIN #versions vd 
              ON vd.ruleid = vp.ruleid 
                 AND vd.isdraft = 1 
WHERE  vp.isdraft = 0 
       AND vd.ruleid IS NULL 
"
32664,31803,"Select from the result of a union query, Oracle","SELECT tbl.name
FROM
(
    SELECT name FROM customer
    UNION
    SELECT name FROM vendor
) tbl
"
10709,42873,XML Content Modification in Oracle 11g r2,"for $book in ora:view(""XML_TABLE"")//book
where $book/price > 10
return
  replace value of node $book/title
  with concat($book/title/text(), ""-expensive"")
"
21051,9862,oracle row count into shell script variable,"VAR=""$(sqlplus -S usr/pw@//host:1521/db <<ENDOFSQL
set head off
select count(*) from table;
exit;
ENDOFSQL)""  
echo $VAR
"
260,64378,How to know that MERGE operation was INSERT or UPDATE?,"DECLARE @SummaryOfChanges TABLE(Change VARCHAR(20));

MERGE tblTarget AS Target
USING (SELECT Col1,Col2 FROM tblSource) 
    AS Source
ON (Target.Col1 = Source.Col1)
WHEN MATCHED THEN 
    UPDATE SET target.Col2 = source.Col2 -- Need to get affected rows here
WHEN NOT MATCHED BY TARGET THEN
    INSERT (Col1,Col2) VALUES (Col1,Col2); -- Need to get affected rows here
OUTPUT $action INTO @SummaryOfChanges;

SELECT Change, COUNT(*) AS CountPerChange
FROM @SummaryOfChanges
GROUP BY Change;
"
18342,36773,What kind of JOIN do I need to perform this type of query?,"SELECT car.name, testresults.testname, isnull(testresults.result, 0) FROM 
cars CROSS JOIN
safetytests
LEFT JOIN testresults on safetytests.testid = testresults.testid AND car.id = testresults.carid
"
5824,53942,Return group_concat with multiple rows,"SELECT orderLine.orderId,
       GROUP_CONCAT(orderLine.productId)
FROM orders
  INNER JOIN orderLine ON orders.orderLineId = orderLine.orderId
WHERE orders.orderId = 1
GROUP BY orderLine.orderId
"
22213,72846,NULL from SUM function,"WITH C AS(
    SELECT p_code, p_price, line_units 
    FROM product JOIN line USING (P_CODE)
    WHERE p_code = '23109-HB'
)
INSERT INTO line(inv_number, line_number, p_code, line_units, line_price)
  SELECT 1009, 1, p_code, line_units, SUM(p_price * line_units) FROM C 
"
26159,12748,Just started working with Magento and I wanted to get the number of fields in each table,"SELECT TABLE_NAME, COUNT(COLUMN_NAME) AS NoCOLUMNS
FROM INFORMATION_SCHEMA.COLUMNS 
WHERE TABLE_SCHEMA = '<database_name>'
    AND TABLE_NAME IN (SELECT TABLE_NAME
                       FROM INFORMATION_SCHEMA.TABLES 
                       WHERE TABLE_SCHEMA = '<database_name>')
GROUP BY TABLE_NAME;
"
3071,23375,Find max group value without using Max()/Greatest() function,"select * from 
(
select user,count(posts) cnt from dbtable 
group by user
) t1
left join 
(
select user,count(posts) cnt from dbtable 
group by user
) t2 on (t1.user<>t2.user) and (t1.cnt<t2.cnt)

where t2.cnt is null  
"
34537,11210,How to Split Sql Int Value into Multiple Rows,"create table #splitme (Id int, description varchar(255), quantity int) 
insert #splitme values (1    ,'my desc',          3)
insert #splitme values (2    ,'desc 2',           2)

create table #numbers (num int identity primary key) 
declare @i int 
select @i = max(quantity) from #splitme
while @i > 0
begin   
    insert #numbers default values 
    set @i = @i - 1 
end

select Id, description, 1 from #splitme 
join #numbers on num <= quantity
"
39384,43093,How to Select Used Record in Foreign Key Table,"SELECT 
      A.A_id,
      A.A_name 
FROM Artist A
INNER JOIN Song B
ON A.A_id=B.AID GROUP BY A_id,A_name
"
537,62904,SQL Query Common Value after count,"SELECT f.Name, f.Friend
FROM FRIENDSHIP f INNER JOIN SCHOOL s1 ON f.Name = s1.Name
INNER JOIN SCHOOL s2 ON f.Friend = s2.Name
WHERE s1.School <> s2.School
"
31023,64877,merge two queries with different where into 1,"SELECT  MeasureDate, col1, col2
FROM Table1
WHERE Col3 = 2
  or (Col3 = 1 AND Col4 = 7000);


SELECT  sum(col1) / sum(col2) AS Percentage , GROUP BY MeasureDate
FROM Table1
WHERE Col3 = 2
  or (Col3 = 1 AND Col4 = 7000)
GROUP BY MeasureDate;
"
16900,41959,How to summarize two tables in teradata,"Select t2.datex, t2.caseid, sum(t1.points)
from table1 as t1 join table2 a t2 
on position(trim(t1.caseid) in t2.caseid) > 0
group by 1,2
"
2310,20983,Is there a way in MySQL to choose an order for the beginning and end of rows returned?,"  SELECT u.id
    FROM USERS u
ORDER BY CASE id
           WHEN 4 THEN 1
           WHEN 5 THEN 2
           WHEN 7 THEN 3
           WHEN 8 THEN 4
           WHEN 55 THEN 100000
           WHEN 56 THEN 100001
           WHEN 58 THEN 100002
           ELSE id
         END ASC
"
31143,7147,Oracle calculate 2 date columns to a new one for each row,"UPDATE termine SET alarm_goes_off = (to_date('12/30/1899', 'MM/DD/YYYY') + (termin_start - alarmvorlauf));
"
29201,19292,Adding multiple conditions to MySQL Inner Join,"ALTER TABLE company ADD COLUMN stripped_name VARCHAR(50);
ALTER TABLE company ADD INDEX(stripped_name);
UPDATE TABLE company SET stripped_name = REPLACE(REPLACE(name, '.', ''), ',', '') ;
"
10079,10480,Subquery between three tables using Northwind database with SQL Server,"  WITH CTE AS 
    (SELECT ProductID, 
           o.CustomerID,
           Discount,
           ROW_NUMBER() OVER(PARTITION BY o.CustomerID ORDER BY Discount DESC) Row_num
    FROM [Order Details] od INNER JOIN Orders o
         ON od.OrderID= o.OrderID
    )
    SELECT ProductID, 
           CustomerID,
         Discount
    FROM CTE
    WHERE Row_num = 1
"
17438,16765,What do we consider as a dynamic sql statement?,"""SELECT name FROM names WHERE id="" + this.id;
""SELECT name FROM names WHERE id="" + this.id + "" AND age="" this.age;
"
29137,10929,How to import data from one table to another table in sql,"INSERT INTO table1 (column1,column2)
SELECT oldcolumn1,oldcolumn2
FROM table2 
"
34631,20636,Finding max value from count without using max,"SELECT name, COUNT(vote) AS total_votes
FROM Voters
GROUP BY name
ORDER BY total_votes DESC
LIMIT 1
"
3182,7301,how to display a number without decimal using sql,"SELECT distance, floor(distance / 12) AS Feet, distance mod 12 as Inches
from
products
"
8543,70687,inner join mySQL,"SELECT 
  receivers.username 'Task receiver',
  givers.username 'Task giver', 
  p.project_name, 
  t.task_content
FROM tasks t
INNER JOIN login   receivers ON receivers.user_id = t.task_receiver 
INNER JOIN login   givers    ON givers.user_id    = t.task_giver
INNER JOIN project p         ON t.project_id      = p.project_id
"
35604,22870,mySQL prepend text to column if not null,"UPDATE wp_store_locator 
SET sl_image = CONCAT('http://website.com/wp-content/uploads/2015/06/', sl_image ) 
WHERE sl_image is not NULL
"
297,64090,how to filter in sql script to not include any column null,"SELECT fields
FROM MyTable
WHERE stuff
EXCEPT -- This excludes the below results
SELECT fields
FROM MyTable
WHERE (Col1 + Col2 + Col3....) IS NULL
"
5206,485,Help forming a SQL statement,"SELECT City.Name, COUNT(Attractions.City) as AttractionCount
FROM City
LEFT OUTER JOIN Attractions ON City.City = Attractions.City
GROUP BY City.Name
ORDER BY COUNT(Attractions.City) DESC
"
32724,42483,Select 1 record where two records have the the same values in different columns,"select ""station_1_I"", ""station_2_I"" from mytable
intersect
select ""station_2_I"", ""station_1_I"" from mytable 
             where ""station_2_I"" < ""station_1_I""
"
11925,45551,Delete Rows from pecific Table on Multi-table SELECT,"DELETE r
FROM   reviews r
       INNER JOIN items i ON i.item_id = r.item_id
       INNER JOIN master_cat c ON i.cat_id = c.cat_id
WHERE  category is null
"
13966,72011,select different Max ID's for different customer,"SELECT t.*
FROM (SELECT t.*, MAX(LOADID) OVER (PARTITION BY Customer) as maxLOADID
      FROM MyTable t
     ) t
WHERE LOADID = maxLOADID;
"
29006,70549,Selecting range of records with MySql,"SELECT  @curRow := @curRow + 1 AS row_number,
    myTable.id
FROM myTable  LIMIT 5 OFFSET 6;
"
6562,53658,Hibernate Criteria API Equivalent to Oracle's Decode,"<property name=""name"" formula=""coalesce(first_name, last_name)""/>
"
27551,40590,Multiple inner joins with multiple tables,"SELECT Table4.company, table1.id, table1.value
FROM Table1
    INNER JOIN Table1
        ON Table2.table1_id = Table1.id
    INNER JOIN Table3
        ON Table3.table2_id = Table2.id
    INNER JOIN Table4
        ON Table4.table3_id = Table3.id
"
20424,37176,SQL Server : Query criteria - need to extract date from datetime,"declare
  @period_start datetime ,
  @period_end   datetime

set @period_start = '2015-01-01 00:00:00.000'
set @period_end   = dateadd(month,1,@period_start)

select *
from foo
where foo.myDateTimeColumn >= @period_start
  and foo.myDateTimeColumn <  @period_end
"
19753,63109,SQL Server Table Transformation Query / Combine Column Names With Values,"SELECT
   x.*
FROM tbl t
CROSS APPLY( VALUES
    ('q1', q1),
    ('q2', q2),
    ('q3', q3)
) x(cg, sg)
"
10670,38879,Can I have a rank column that only has the rank for a certain record?,";with sub as
(
    ... your query ...
)
, rnk as
(
select  top 1 [Rank]
from    sub
where   Last_Secondary_School_Provider_Key = 'Auckland University of Technology'
)
select      sub.col1,
            sub.col2,
            sub.col3,
            sub.col4, -- select all cols from sub except rank
            rnk.[Rank] -- and select rank from the rnk block
from        sub
 cross join rnk;
"
27114,47466,"SQLite3, combining multiple INSERT statements?","for(int i = 0;i< value1.length,i++)
{
INSERT INTO CAT_BUD_TAB (_id, CAT_ITEM, IN_OUT) VALUES (null, 'value1[i]', 'value2[i]');
}
"
14669,2919,MySql UPDATE statement with SELECT summarizing data from table 2,"update tablea a
join(
  select 
  token,sum(duration) as duration from tableb
  where state != 'active'
  group by token
)b
on b.token = a.token
set a.downtime = b.duration
"
30796,65838,Query to return text if row is null from oracle db,"SELECT nvl(paramOne, 0), nvl(trim(paramTwo), 'EMPTY')
FROM tableName
WHERE search_param = 'x'
"
1644,20271,Oracle SQL; Determine if value is unique or not in a group,"select pallet_id,
    case 
        when count(case when product_group not in ('LAMINAAT','ACCESSORIE') then 1 end) > 0 then ''
        when count(distinct product_group) > 1 then 'Mix'
        when count(case when product_group = 'LAMINAAT' then 1 end) > 0 then 'LAM'
        else 'ACC'
    end as label
from mytable
group by pallet_id
"
33072,43457,SQL Query - Return rows from table A matching any row in table B,"SELECT
 b.location,
 (other fields of interest)
FROM
 tableB b
JOIN
 (SELECT a.location, min(a.workdate) as min_workdate
   FROM tableA a   
   GROUP BY a.location) c
ON b.location = c.location
WHERE c.min_workdate > '201201'
"
11903,11314,MySQL - Help me construct this query,"SELECT
    Table1.*,
    something1Table.setting AS something1,
    something2Table.setting AS something2,
    something3Table.setting AS something3
FROM Table1
JOIN Table2 AS something1Table ON something1Table.table_1_id = Table1.id AND something1Table.value = 'something'
JOIN Table2 AS something2Table ON something2Table.table_1_id = Table1.id AND something2Table.value = 'something2'
JOIN Table2 AS something3Table ON something3Table.table_1_id = Table1.id AND something3Table.value = 'something3'
"
4600,24021,@SET (SQL) in PHP,"SELECT id from users where timemodified >= UNIX_TIMESTAMP(SUBDATE(curdate(), 28))
"
22336,72855,SQL Query for Product-Tag relationship,"SELECT Tags.ID, Tags.Name, Tags.SortOrder, Tags.ParentID,
       COUNT(DISTINCT ProductTags.ProductID) AS ProductCount, 
       COUNT(DISTINCT ChildTags.ID) AS ChildTagCount
FROM Tags
LEFT OUTER JOIN ProductTags ON Tags.ID = ProductTags.TagID
LEFT OUTER JOIN Tags ChildTags ON Tags.ID = ChildTags.ParentID
GROUP BY Tags.ID, Tags.Name, Tags.SortOrder, Tags.ParentID
"
23289,28129,How do I append data with Oracle's impdp?,"impdp hr/hr TABLES=employees DIRECTORY=dpump_dir1 DUMPFILE=expfull.dmp TABLE_EXISTS_ACTION=APPEND
"
15918,37577,showing sum in last row of table using mysql,"SELECT Col1, Col2 FROM tableName
UNION
SELECT 'SUM' as Col1, SUM(Col2) Col2 FROM tableName
"
2308,4606,How to obtain trend from a table for the same column values in multiple row that needs group by,"SELECT A.Name, A.LastCount, (((A.FirstCount-A.LastCount)/A.FirstCount)*100) Trend
FROM (SELECT A.Name, MAX(IF(A.Interval = 'Last', A.Count, 0)) LastCount, 
             MAX(IF(A.Interval = 'First', A.Count, 0)) FirstCount
      FROM tableA A
      GROUP BY A.Name
     ) AS A
"
27295,63784,SQL Server - SELECT DISTINCT depending on another column value,"WITH records
AS
(
    SELECT  [key], [rev], [IsCurrent],
            ROW_NUMBER() OVER(PARTITION BY [key]
            ORDER BY CASE WHEN [rev] = 1          -- <<== change REV value here
            THEN 0 ELSE 1 END) rn
    FROM    tableName
    WHERE   [Rev] IN (1,0)
)
SELECT  [key], [rev], [IsCurrent]
FROM    records 
WHERE   rn = 1
"
4717,45912,How can I run this UPDATE query faster?,"UPDATE WEB 
SET WEB.ID_D_SUPPORT = DIM.ID_D_SUPPORT 
FROM dbo.F_SUPPORT_WEB WEB
INNER JOIN dbo.D_SUPPORT DIM ON WEB.id_support = DIM.id_support 
   AND (WEB.date_creation BETWEEN DIM.Date_Deb_Valid AND DIM.Date_Fin_Valid)
WHERE WEB.ID_D_SUPPORT <> DIM.ID_D_SUPPORT 
"
39838,57698,MySQL (DEFAULT + ON UPDATE) TIMESTAMPs,"create trigger CreationTimestamp after insert on MyTable for each row
begin
    update MyTable set CreateField = UpdateField where id = new.id
end
"
15792,5993,Grand Totals with Rollup,"With CTE as (
--Insert Existing query without rollup here
)

Select * From CTE

Union All

Select 'Grand Total' as County
    , null as Year
    , SUM(Total) as Total
    , SUM(Q1) as Q1
    , SUM(Q2) as Q2
    , SUM(Q3) as Q3
    , SUM(Q4) as Q4

From CTE
"
28526,58214,"SQL : Count , Sum and Group by","select sum(sm),fk,dt from 
(
select Month(date1)as dt ,COUNT(*) as sm, fk

from table

where status ='OK'

group by fk , MONTH(date1)

union all
select Month(date2)as dt ,COUNT(*) as sm, fk

from table

where status ='OK'

group by fk , MONTH(date2)

)
group by dt,fk
"
24177,71528,How to sort a table using order by clause in desc order using difference in value of two other columns,"select *, like-unlike as customOrder from table order by customOrder desc;
"
24566,27313,"Which is the most memory intensive SQL query: select, update or insert?","SELECT * FROM Table
"
16379,22473,Conditional selecting rows based on a column value,"Select * from tablename where flag=1 
union 
(Select * from tablename a where  (Select count(*) from tablename b 
where a.Range_id=b.RANGE_ID  and b.flag=1)<1)
"
29388,56301,Add total column to cross tab pivot query,", [Completed] + [Open] AS Total
"
18704,30580,TSQL Check for Date difference except for Min Value," SELECT *
 FROM Message m              
 WHERE m.ID NOT IN (SELECT mt.MessageID 
                  FROM MessageTracking mt
                  WHERE mt.SubscriberID = @UserID
                 )
 AND (m.DateExpires > GETDATE()) OR (m.DateExpires = '1900-01-01 00:00:00.000'))
 ORDER BY m.DateCreated DESC
"
31017,70664,how to add specific time to current time using DateAdd?,"dateadd(MINUTE, 30, dateadd(HOUR, 2, @dateyouaddto))
"
31978,18931,sql insert if exists delete if not exists between 2 tables,"MERGE table2 AS t2
USING table1 AS t1
ON (t2.y = t1.x)
WHEN NOT MATCHED BY TARGET 
  THEN INSERT (y) VALUES(t1.x)
WHEN NOT MATCHED BY SOURCE
  THEN DELETE;
"
19151,55311,Insert Loop from select in Oracle,"INSERT INTO table2 
SELECT tb1.cl1, '123456', sysdate
FROM table1 tb1 
WHERE tb1.cl1 NOT IN(SELECT tb2.cl1 FROM table2 tb2)
"
36950,738,Select random sampling from sqlserver quickly,"USE AdventureWorks2008; 
GO 


SELECT FirstName, LastName
FROM Person.Person 
TABLESAMPLE (100 ROWS)
WHERE EmailPromotion = 2;
"
16237,57244,Update table with random record in update statment in SQL Server?,"UPDATE A
SET A.hostessid = B.hostessId
FROM member_info_test A
CROSS APPLY (SELECT TOP 1 hostessId
             FROM hostess_test 
             WHERE A.somecolumn = A.somecolumn
             ORDER BY NEWID()) B
"
5279,53751,SQL Variable current date - 1 day,"select dateformat(dateadd(dd, -1, getdate()), 'yyyy-mm-dd hh:nn:ss.SSSSSS')
"
35167,33940,Avoiding a nested subquery containing a group by,"select distinct r.id, r.description
from races r
  inner join jockey_races jra on r.id = jra.race_id
  inner join jockey_regions jre on jra.jockey_id = jre.jockey_id
group by r.id, r.description, jre.jockey_id
having count(*) > 1
"
133,46840,adodb .FIND question,"DELETE  FROM batchinfo where rowid='105'
AND EXISTS (SELECT * FROM batchinfo WHERE rowid='105' and something='sometext' and somethingelse='moretext')
"
4251,50230,"MySQL, get the three clients who have the max purchases:","SELECT client.name
FROM client
JOIN purchase ON purchase.client_id = client.client_id
JOIN product ON purchase.product_id = product.product_id and product.product_id = 1
GROUP BY client.client_id
ORDER BY COUNT(purchase.purchase_id) DESC
LIMIT 3
"
12962,70027,Select 2 COUNT()'s from MySQL query,"SELECT username, SUM(outcome) AS wins, COUNT(*) - SUM(outcome) AS losses
  FROM tblBattleHistory 
  WHERE battle_type = '0'
  GROUP BY username 
  ORDER BY wins DESC, losses
"
38706,41578,How can I create a blank/hardcoded column in a sql query?,"SELECT
    hat,
    shoe,
    boat,
    0 as placeholder
FROM
    objects
"
6214,3154,Greatest value of multiple columns with column name?,"SELECT @var_max_val:= GREATEST(col1, col2, col3, ...) AS max_value,
       CASE @var_max_val WHEN col1 THEN 'col1'
                         WHEN col2 THEN 'col2'
                         ...
       END AS max_value_column_name
FROM table_name
WHERE ...
"
36470,23745,excel quotes in formula question,"=""=like """"*,"" & othercolumn & "",*""""""
"
2416,30517,Generate linq query to get count of distinct records in single column,"var result = from uh in db.tblUserHashTags
             group uh by uh.HashTagName into g
             let count = g.Count()
             orderby count descending
             select new 
             {
                 HashTagName = g.Key,
                 CountOf = count
             };
"
19806,30167,Verifying the unity of period of time in SQL,"CREATE TRIGGER prevent_overlapping_time
BEFORE INSERT ON TimePeriod
FOR EACH ROW
BEGIN
    SELECT RAISE(ABORT, 'overlapping time')
    FROM TimePeriod
    WHERE NEW.endTime > startTime
      AND NEW.startTime < endTime;
END;
"
9885,59738,"SQL, How to query with multiple foreign keys in a table?","SELECT 
      projects.project_id
    , projects.title
    , projects.start_time
    , projects.description
    , projects.user_id
    , projects.winner_user_id
    , users.username as owner
    , winnerUser.username as winner
FROM projects
INNER 
    JOIN users
    ON projects.user_id=users.user_id
INNER 
    JOIN users winnerUser
    ON projects.winner_user_id=winnerUser.user_id
"
23451,70227,"Access SQL: How to select dates after today if current year, else select all dates","    select monto from cupones where (year(fechapago) = year(date() and (month(fechapago) > month(date()) or (month(fechapago) == month(date() and day(fechapago) > day(date()))( or (year(fechapago()) > year(date()))
"
24457,61315,How do I get the sum of a column as a new row with column data,"select 
  SrNo, Descript, item1, item2, 
  item1+item2 as totalitems
from tbl
ORDER BY SrNo

union all

select  
  max(SrNo) + 1, 'Total', sum(item1), sum(item2), 
  sum(item1+item2) as totalitems
from tbl
"
7179,52252,how do I pull multiple items out of a table with one join?,"On value = value
"
35600,41105,MySQL - delete from table Y based on results of deletion from table X,"DELETE  a, b
FROM    table1 a
        INNER JOIN table2 b
          ON a.name = b.name
WHERE   a.type = 'foo'
"
20827,35732,I want to select multiple column by device id with max date in SQL Server,"SELECT *
FROM (
    SELECT *,
        RN = ROW_NUMBER() OVER(PARTITION BY DeviceId ORDER BY [Time] DESC)
    FROM trackinfo
    WHERE DeviceId IN(11, 12)
) t
WHERE RN = 1
"
3273,3438,MySql - Find values that occur AT LEAST two times without using any aggregate function,"SELECT distinct c1.city_name 
  FROM `city` c1 
  JOIN city c2 
        ON c1.city_name=c2.city_name 
       AND c1.state_name!=c2.state_name
"
25875,15319,unstack hierarchical data,"select 
  coalesce( l3.id_value,l2.id_value) as id_value ,
  l3.description as ""3"",
  l2.description as ""2"",
  l1.description as ""1""
from t l1 inner join
     t l2 on l2.""LEVEL""=2 and l1.id_value = l2.parent_id_value
          left outer join
     t l3 on l3.""LEVEL""=3 and l2.id_value = l3.parent_id_value
where l1.LEVEL = 1
"
39270,39781,MySQL table JOIN with ordering by averages,"select l.link_id,
    l.url,
    l.title,
    l.description,
    lra.AvgRating
from links l
left outer join (
    select link_id, avg(rating) as AvgRating
    from link_ratings
    group by link_id
) lra on l.link_id = lra.link_id
order by lra.AvgRating desc
"
24200,72243,rank() a group of items by count(*),"select item, value, c, total, total_by_item, what_i_need
from test 
group by item, value
model
  dimension by (row_number() over (order by null) d)
  measures (
    item, value,
    count(*) c,
    sum(count(*)) over () total,
    sum(count(*)) over (partition by item) total_by_item,
    1 what_i_need
  )
  rules (
    what_i_need[any] = dense_rank() over (order by total_by_item[cv()] desc)
  )
order by 5 desc;
"
39706,45495,MySQL - Group By SUM with two tables,"select  e.department_emp
,       sum(p.price)
from    (
        select  distinct department_emp
        ,       number_project
        from    Employee
        ) e
join    Projects p
on      p.code_project = e.number_project
group by
        e.department_emp
"
5905,5643,Unknown Column in field list when already in columns,"SELECT rank, damage, playerID 
FROM 
(
  SELECT @rownum := @rownum + 1 rank, damage, playerID
    FROM PlayerStats, (SELECT @rownum := 0) n
   WHERE playerID > 20130000000000 
   ORDER BY damage DESC, modified
) r 
-- WHERE playerID='20130000000004'
ORDER BY rank
"
6494,28868,Sql group by and order by first date entered,"select p.*
from person p
where p.datetime = (select max(p2.datetime) from person p2 where p2.name = p.name);
"
39769,71737,Counting records in a week with matching fields but ignoring matches on the same day,"SELECT ShippingAddress, DATEPART(wk, InvoiceDate), COUNT(*) AS countForWeek
  FROM shipping
  GROUP BY ShippingAddress, DATEPART(wk, InvoiceDate)
  HAVING COUNT(*) > 1
"
37256,30285,How to store the result of a query into an sql variable,"select * from city a 
where not exists 
(select 1 from city b where b.from_city=a.to_city and b.to_city = a.from_city
)
"
24240,4665,Entity Framework Dynamic Lambda to Perform Search,"var lambda = Expression.Lambda<Func<object>>(expression);  
"
13631,19800,DB2 SQL SELECT top 1 group with join,"SELECT PO180M2.PHPPN AS PartNo, (PO180M2.PHVNPD || ' ' || PO180M2.PHVNP2) AS PartDesc, 
       PO180M2.PHUNCT AS UnitCost, Max(PO180M1.POORDT) As MaxPOORDT
FROM PO180M1 
INNER JOIN PO180M2 ON PO180M1.POORNO = PO180M2.PHORNO 
GROUP BY PO180M2.PHPPN, (PO180M2.PHVNPD || ' ' || PO180M2.PHVNP2), PO180M2.PHUNCT
ORDER BY PartNo
"
9143,44955,How to find records that exist in one table but not the other when each record has variations,"SELECT ItemNumber, VendorName
 from Table1
except select ItemNumber, VendorName
 from Table2
"
15406,68126,Optimize query in BigQuery,"SELECT * FROM table WHERE ABS(HASH(id) % 100) == 0
SELECT * FROM table WHERE ABS(HASH(id) % 100) == 1
SELECT * FROM table WHERE ABS(HASH(id) % 100) == 2
SELECT * FROM table WHERE ABS(HASH(id) % 100) == 3
...
SELECT * FROM table WHERE ABS(HASH(id) % 100) == 99
"
7207,28860,How to group duplicate records and then update all members except lowest id for each group?,"update temp1 set publish=0 where id in (select x.id from (select a.id from temp1 a ,temp1 b 
where
a.id<>b.id and (a.name=b.name or a.description=b.description)and a.id>b.id 
group by a.id) as x); 
"
15531,26298,"mysql :: insert into table, data from another table?","INSERT INTO action_2_members (campaign_id, mobile, vote, vote_date)  
SELECT campaign_id, from_number, received_msg, date_received
  FROM `received_txts`
 WHERE `campaign_id` = '8'
"
35172,69344,How to update a column value in one database table using another database table as a reference with SQL,"update  c
set     countryId = lc.Id
from    SQLVersion.dbo.Contact c
join    AccessDBVersion.dbo.tblContact ac
on      ac.Name = c.Name
join    SQLVersion.dbo.Country lc
on      lc.Name = ac.Country
"
393,7426,SQL - return only where specific rows match,"    SELECT
      p1.PASS_NUMBER 
    FROM
      PASS p1
    WHERE
      p1.PASS_LOCATION = 'A'
      AND EXISTS
      (SELECT 
          * 
       FROM 
         PASS p2
        WHERE 
          p1.PASS_NUMBER=p2.PASS_NUMBER 
          AND p2.PASS_LOCATION='B')
    ;
"
21355,28281,SQL Full outer join of similar tables,"SELECT * FROM CTP0002;
union all
SELECT * FROM CTP0003;
"
38631,54839,How do I do a group by with a random aggregation function in SQL Server?,"select Username, 
    COUNT(DISTINCT m.Message) as ""Count"", 
    AVG(m.WordCount) as ""Average"",
    FOO.Message
from
    Messages m
    cross apply
    (select TOP 1 Message, Username
       from Messages m2 
       WHERE m2.Username = m.Username
       order by newid()
    ) FOO
group by m.Username, FOO.Message
order by ""Count"" desc
"
11074,46415,"How to get Result from database by order the condition put in ""IN"" clause?","SELECT *
FROM bfproduct
WHERE productid
IN (23,5,54,3132,32)
ORDER BY
   CASE productid
      WHEN   23 THEN 0
      WHEN    5 THEN 1
      WHEN   54 THEN 2
      WHEN 3132 THEN 3
      WHEN   32 THEN 4
   END
"
32551,44518,Problem Specifying the tables in SQL,"CREATE TABLE Gem
(type VARCHAR (50) NOT NULL,
 hardness INT,
 density  INT,
 PRIMARY KEY (type , hardness, density ),
 FOREIGN KEY (type) references JEWEL(gem type));
"
23919,46308,UPPER() and LOWER() not required?,"SELECT * FROM Table WHERE UPPER(part) = 'SOMEPARTNAME' 
"
9968,55233,How to apply md5 function to field in django orm?,"import hashlib
myModel(models.Model):
    field = models.CharField(max_length=30)
    field_md5 = models.CharField(max_length=16, editable = false )

    def save(self, *args, **kwargs):        
        self.field_md5 = hashlib.md5.new(self.field).digest()
        super(Model, self).save(*args, **kwargs)
"
1908,8523,Cast() doesn't work properly in SQLite?,"SELECT CASE WHEN ImageColumn IS NOT NULL THEN 1 ELSE 0 END AS HasImage
FROM mytable
"
33201,10327,Check for a string in a CLOB,"select tbl3.*
  from tbl1
       inner join tbl2
               on tbl2.art_id = tbl1.art_id
       inner join tbl3
               on tbl3.a1 like '%' || tbl1.project_line_id || '%'
 where tbl2.type = 3;
"
29886,35311,"""SET FOREIGN_KEY_CHECKS = 0;"" Oracle Equivalent","SQL> CREATE TABLE t1 (ID NUMBER PRIMARY KEY);

Table created

SQL> CREATE TABLE t2 (ID NUMBER REFERENCES t1);

Table created

SQL> INSERT INTO t1 VALUES (1);

1 row inserted

SQL> INSERT INTO t2 VALUES (1);

1 row inserted

SQL> -- this fails because of the foreign key
SQL> DROP TABLE t1;

ORA-02449: unique/primary keys in table referenced by foreign keys

SQL> DROP TABLE t1 CASCADE CONSTRAINTS;

Table dropped
"
20738,39977,selecting from sql,"DECLARE @input XML = '<suggestions>
 <suggestion>
  <description>plate.</description> 
 </suggestion>
 <suggestion>
 <description>snack.</description> 
 </suggestion>
</suggestions>'

DECLARE @Suggestions TABLE ([Description] VARCHAR(800))

INSERT INTO @Suggestions
    SELECT
        Sugg.value('(description)[1]', 'varchar(800)')
    FROM
        @input.nodes('/suggestions/suggestion') AS Tbl(Sugg)

SELECT * FROM @Suggestions
"
23302,71483,Change Passcode on aes_encrypt with a query,"UPDATE table1
SET pass1 = aes_encrypt(aes_decrypt(pass1,'oldpasscode'),'newpasscode');
"
27940,38355,SQL Server 2008 - Replacing codes with values in multiple columns,"Select
    Table_1.ID,
    v1.Text,
    v2.Text,
    v3.Text
FROM Table_1
LEFT JOIN Table_2 v1 ON Table_1.Value_code_1 = v1.id
LEFT JOIN Table_2 v2 ON Table_1.Value_code_2 = v2.id
LEFT JOIN Table_2 v3 ON Table_1.Value_code_3 = v3.id;
"
29602,15324,Multiply two values together from a single database column,"SELECT m.Name, m.Processors FROM
(
  SELECT Name, Processors, SUBSTR(Processors, 1, INSTR(Processors, 'x', 1, 1)-1) AS FirstValue,
  SUBSTR(Processors, INSTR(Processors, 'x', 1, 1) + 1, INSTR(Processors, ' ', 1, 1) - INSTR(Processors, 'x', 1, 1)) AS SecondValue
  FROM MyTable
) m 
WHERE m.FirstValue * m.SecondValue > 16
"
38012,33493,"Hibernate batch insert, batch update","hibernate.jdbc.batch_size=50
"
10426,7422,Changing SQL VARCHAR2 date to another date format,"select to_char(to_date(column, 'yyyyMMdd_hhmmss.ttt'), 'dd/MM/yyyy hh:mm:ss,ttt')
from your_table;
"
7987,37520,Oracle SQL: Is it more efficient to use a WHERE clause in a subquery or after the join?,"SELECT a.CUSTOMER_KEY a.LAST_NAME b.TRASACTION_AMT, 
FROM CUSTOMER_TABLE a LEFT JOIN 
     TRANSACTION_TABLE b 
      ON a.CUSTOMER_KEY = b.CUSTOMER_KEY AND b.DATE_TRANSACTION > 20150101
WHERE a.CUSTOMER_ACTIVE_FLAG = 'Y';
"
776,13513,sql with rounding issue,"SELECT (33.333 / 2) FROM dual;
16,6665

SELECT (16.6665 * 2) FROM dual;
33,333
"
23578,71869,SQLite statement to query for Recurring Calendar Events,"-- A time interval must be either completely ""to the left"" or completely
-- ""to the right"" of the other time interval for them not to overlap.
SELECT * FROM EVENT
WHERE
    NOT(
        (:s < DTSTART AND :s < DTEND AND :e < DTSTART AND :e < DTEND)
        OR (:s > DTSTART AND :s > DTEND AND :e > DTSTART AND :e > DTEND)
    )
"
34407,19040,Querying item that is NOT EQUAL in the second table,"Select A.Name, A.VAL1 AS VALUEA1, A.VAL2 AS VALUEB1 
From TableA as A, TableB As B
Where A.NAME = B.NAME AND A.VAL2 != B.VAL2
"
13452,16523,Top 5 comments from a specific post. How to write my SQL,"SELECT *
FROM memberactions
INNER JOIN actions
    ON memberactions.actionid = actions.id
INNER JOIN members
    ON memberactions.memberid = members.id
OUTER APPLY (
    select top(5) *
    FROM actioncomments
    inner join comments ON actioncomments.commentid = comments.id
    inner join members members_2 ON members_2.id = actioncomments.memberid
    WHERE actions.id = actioncomments.actionid
    order by comments.id desc) comments
"
7421,8286,Sum of smalldatetime and format as decimal minutes SQL," SELECT PARSENAME(REPLACE('00:04:56',':','.'),3) * 60 --Convert the hours to minutes
        + PARSENAME(REPLACE('00:04:56',':','.'),2) --Add converted hours to minutes
        + CONVERT(FLOAT, LEFT((CONVERT(INT,(PARSENAME(REPLACE('00:04:56',':','.'),1)))/0.6),2))/100 -- convert to decimal format
"
20391,57434,Matching a group that may or may not exist,"(.*?)\s(\d{5})\s(.+?)\s?(FINLAND|SUOMI)?$
"
6513,11110,How to catch exact date format from value?,"SELECT CASE WHEN ISDATE(Values) = 1 and CHARINDEX('/',Values) > 0 
            THEN CONVERT(VARCHAR(20), Values, 101) 
            ELSE Values
       END AS Val1   
FROM MyTable
"
16693,45319,How to calculate percentage with a Oracle SQL statement with two tables,"select (n/c)*100 pct
from ( select count(*) c from przedmioty ) 
, ( select count(*) n from przedmioty 
    where id_prz NOT IN (select id_prz from transakcje));
"
13925,24031,SQL find last date and last time of event,"SELECT MAX(dateheld) AS 'MaxDate', starttime 
FROM Events
WHERE starttime in 
      (SELECT MAX (starttime) AS temp FROM events)
"
16403,1220,How to create multiple rows from a single row,"SELECT
    Name
  , Seat
  , CA1.Aaisle
  , CA1.Baisle
  , CA1.Caisle
FROM UnPivotMe
CROSS APPLY (
    VALUES 
                (FA1, FB1, FC1)
              , (FA2, FB2, FC2)
              , (FA3, FB3, Fc3)
            ) AS CA1 (Aaisle, Baisle, Caisle)
;
"
1448,68504,how to process a column and return it as part of a query?,"SELECT No AS ""Part Number"", Desc AS ""Description"", 
CASE 
WHEN Draw IS NOT NULL THEN 'Yes'
ELSE 'No'
END AS ""Is Packed""
FROM Part
"
22379,6270,finding most common value across multiple tables,"select ip, count(*) from
(
select ip from bad_guys_1
union ALL
select ip from bad_guys_2
union ALL
select ip from bad_guys_3
union ALL
select ip from bad_guys_4
) as ranking
group by ip
order by count(*) DESC
"
33970,37550,SQL statement for Group Count and Overall Count,"select student, own_80_cnt,
       sum(own_80_cnt) over () total_80_cnt
  from (select student,
               sum(case when score = 80 then 1 else 0 end) as own_80_cnt
          from mytable
         group by student);
"
12204,16446,Count duplicated column data," Select UserId   
        LocationId  
        ProjectId,
       (Select Count(*) From TableName t2 Where t2.UserId = t1.UserID And t2.ProjectId = t1.ProjectId) As Count
 From TableName t1
"
25460,26046,Select Only Numbers From Varchar column,"SELECT REPLACE(columnName,'%','') FROM tableName
WHERE ISNUMERIC(REPLACE(columnName,'%','')) = 1
"
36851,33464,Oracle - how to find columns in a table + stored procedures dependent on them?," INSERT INTO new_table (col1, sproc) 
    SELECT i.column_name, u.name 
    FROM user_tab_columns i, 
         user_source u 
    WHERE lower(i.table_name) like 'table1' 
      AND lower(u.text) like '%' || lower(i.column_name) || '%';
"
5333,30023,Insert INTO from one table to another and change column values,"SELECT a.ID, a.NAME, a.DIRECTOR, b.UNIVERSITYID
INTO FakultetasTemp
FROM Fakultetas a
INNER JOIN SecondTableName b 
   ON a.Universitetas = b.Univesitetas
"
34299,54918,Multiple Tables Ordered GROUP BY or Distinct SQL,"SELECT 
items.id, 
max(items.name) as name,
max(item_flags.flagid) as flagid,
max(COALESCE(item_flags.timestamp, items.timestamp)) AS tm
FROM   
items
LEFT JOIN 
item_flags 
ON 
item_flags.itemid = items.id 
GROUP BY items.id 
ORDER BY tm DESC
"
25087,18837,How do I combine these Selects/Joins?,"SELECT tile, description, link, groupName
FROM table_2
JOIN table_1 ON table_2.userId = table_1.id
JOIN table_3 ON table_3.id = table_2.table_3Id
JOIN table_4 ON table_4.id = table_2.table_4Id
"
761,45611,CSV file with commas in the address,"COPY schemaname.tablename
FROM '/tmp/tablename.csv'
DELIMITER ','
QUOTE '""';
"
9888,63760,How to retrieve records with duplicate in mysql,"SELECT P.P_ID, NAME FROM PLAYER P 
INNER JOIN PLAYER_SCORE PS ON PS.P_ID = P.P_ID
GROUP BY P_ID, NAME, SCORE_1, SCORE_2, SCORE_3, SCORE_4
HAVING count(*) > 1
"
4305,49986,Get a complete list of unique values from multiple columns in multiple tables,"SELECT UserID FROM Table1
UNION
SELECT UserID FROM Table2
UNION
SELECT UserID FROM Table3;
"
6522,39172,Mysql update statement with join involved,"update `tbl_blocks` `b` join
       `tbl_flats` `f`
        on `f`.`fld_block_id` = `b`.`fld_id`
   set  `f`.`fld_mobile_app_password` = '1a1dc91c907325c69271ddf0c944bc72'
   where `f`.`fld_site_id` = 57;
"
37168,54498,"SQL query to get state,then city and address and zip","SELECT state, GROUP_CONCAT('(',address,';)' SEPARATOR '') as        
address,GROUP_CONCAT('(',zip,';)' SEPARATOR '') as zip FROM location Where   
username='ABC@gmail.com' GROUP BY state,city""
"
27587,61837,SQL: Get parent if and only if children have a certain property,"SELECT id 
FROM asset A 
INNER JOIN resource R ON A.id = R.asset_id 
WHERE NOT EXISTS (
     /* Only return results if the asset has resources of all status = '1'  */
     SELECT 1 
     FROM Resources R2
     WHERE A.asset_id = R2.asset_id
     AND R2.status <> '1'
)
"
36538,25744,Refactor SQL query to return results into rows instead of columns,"SELECT C.customer_name
     , P.product_type
FROM Customers C
  JOIN Orders O
    ON O.customer_id=C.customer_id
  JOIN Products P
    ON O.product_id=P.product_id
WHERE C.ID = 111
"
21165,74424,What is the correct SQL for a trigger to copy a record to an identical table?,"CREATE OR REPLACE TRIGGER copy_tab1_tab2_trg AFTER INSERT ON table1
   FOR EACH ROW
BEGIN
    INSERT INTO TABLE2 
       (col1, col2, ..., coln) 
    VALUES 
       (:NEW.col1, :NEW.col2, ..., :NEW.coln);
END;
"
1232,70582,"SQL Server - For XML Path (nested elements, multiple records)","SELECT EmpName AS [Name],
       EmpSalary AS [WageAmount],
       (SELECT 
       Add1 AS [PersonAddress/Address1],
       Add2 AS [PersonAddress/Address2],
       Mobile AS [PersonAddress/Mobile] FROM Employee B WHERE EmpName = A.EmpName
       FOR XML PATH('AdditionalInfo'),type)
FROM   Employee A
GROUP BY EmpName,EmpSalary
FOR XML PATH ('Employee') 
"
26388,46906,Oracle: Why I cannot rely on ROWNUM in a delete clause,"DELETE FROM mytable a
WHERE EXISTS( SELECT 1 FROM mytable b
              WHERE a.id = b.id
              AND a.name = b.name
              AND a.rowid > b.rowid )
"
24749,28747,Hibernate partially fill objects,"SELECT new SomeData(c.name, c.code, c.address) FROM SomeData c
"
23011,3779,"PostgreSQL insert into multiple tables, using foreign key from first insertion in the second insertion","WITH ids AS (
    INSERT INTO media_files (url, mimetype)
    SELECT DISTINCT file_url, 'image/jpeg'
    FROM sections
    WHERE file_url IS NOT NULL
    RETURNING id AS media_file_id, url AS file_url
)
INSERT INTO attachments (media_file_id, section_id)
SELECT ids.media_file_id, s.id
FROM ids
  JOIN sections s ON s.file_url = ids.file_url;
"
13008,382,joins versus correlated exists subqueries,"SELECT c0.documentid
  FROM contentblob AS c0
  JOIN contentblob AS c1 ON c1.documentid = c0.documentid
 WHERE c0.documentid > ? 
   AND c0.blobid = ?
   AND c1.blobid = ?
   AND c0.blobid < c1.blobid
 ORDER BY c0.documentid
"
1536,17540,Merge uneven tables using sql,"SELECT Country, Year, Srcname as combinedCol, Value FROM tbl1
UNION ALL
SELECT Country, Year, Progname as combinedCol, Value FROM tbl2
"
1149,19059,"how to design query for select price where sum(tax) less than price in to different table (tableA,tableB)",";with cte as (
    select 
        a.id, a.tax, a.idprice, b.price, 
        sum(tax) over (partition by a.idprice) sum_tax
    from tableA a
    inner join tableB b
    on a.idprice = b.idprice
)
select * from cte
where sum_tax < price
"
4591,13982,"SQL: Select ""until""","SELECT d.id, d.size, d.date_created
FROM documents d
INNER JOIN documents d2 ON d2.tag_id=d.tag_id AND d2.date_created >= d.date_created
WHERE d.tag_id=26
GROUP BY d.id, d.size, d.date_created
HAVING sum(d2.size) <= 600
ORDER BY d.date_created DESC
"
25598,29325,Modify result of a multiple column query with JOIN,"SELECT events.eventId, events.name, 
string_agg(distinct images.path || ',' || images.alt, ',') AS images
FROM events
LEFT JOIN images ON images.eventId = events.eventId
GROUP BY events.eventId, events.name;
"
7283,2553,Oracle Moving Average without Current Row,"select 
  crd_nb, 
  flng_month, 
  curr_0380,
  avg(curr_0380) over (
    partition by crd_nb 
    order by flng_month 
    ROWS between 30 PRECEDING and 1 preceding
  ) mavg
from us_ordered
"
39579,62921,Oracle sql like multiple conditions with select from other table,"select c.*
from cdr c
where exists (select 1 from temp t where c.dnis like dialcode || '%' );
"
16261,3835,converting to date time with only date and hour passed in,"  SELECT CONVERT(DATETIME, @date + ' ' + convert(varchar(10),@hour) + ':00:00') 
"
8326,34301,cakephp url not retrieving data,"debug($fields);
"
13215,1415,Dynamic SQL query to list all master table's data,"DECLARE @DynamicSql AS VARCHAR (MAX) = '';

SELECT @DynamicSql = @DynamicSql + 'SELECT * FROM ' + name + '; ' 
FROM sysobjects WHERE xtype = 'U' AND name LIKE '%Master' 

-- PRINT @DynamicSql

EXEC (@DynamicSql)
"
659,11473,Is there a way to set a variable in a PostgreSQL statment that can be used in a file path name,"create function copyin( _tablename name, _filename text )
returns void
language plpgsql as $this$
declare sql text;
begin
  sql := 'COPY ' || quote_ident(_tablename) || ' FROM ' || quote_literal(_filename);
  execute sql;
  return;
end;
$this$;

SELECT copyin( 'froobles', '/tmp/froobles.csv' );
"
9162,62749,Retrieve rows in which a coloumn doesn't contain a value,"SELECT * FROM tablename  
WHERE find_in_set(1, userIDs) = 0
"
3096,7813,adding alias row in select query using union,"SELECT 'Name' as name_std,'Age' as age_std, 'Address' as address_std FROM dual
UNION
SELECT name_std,to_char(age_std),address_std FROM Student
"
38592,40157,SQL IN() operator with condition inside,"select *
from dbo.tbl_docs docs
where 
(
  (select count(*) from @states) > 0 
       AND 
   docs.doc_state in(select value from @states)
)
OR
(
  (select count(*) from @states)=0 
      AND 1=1
)
"
25873,16402,How to adapt this simple relational model to a dimensional one?,"dimension_bycicle(key_bicicle, modelName, brandName, type, color, wheelSize, suspension, frameMaterial, brakeManufacturer, gearType, gearModel, yearProduced, modelId)
"
31782,74213,How to format a wildcard query for dates in MS SQL?,"SELECT *
FROM   Table1
WHERE  DATEADD
       (
           year,
           -DATEDIFF(year,'19000101',dateField),
           dateField
       ) BETWEEN'19000801' AND'19000818'
"
39031,40694,SQL: list users with their phone numbers and email addresses,"SELECT ""user"".id, name, array_agg(DISTINCT email) emails, array_agg(DISTINCT phone) phones
FROM ""user""
LEFT JOIN user_email ON user_email.user_id = ""user"".id
LEFT JOIN user_phone ON user_phone.user_id = ""user"".id
GROUP BY ""user"".id
ORDER BY ""user"".id;
"
23456,54321,"SQL Server : setting two variables month and year for previous month, year roll over safe","DECLARE @monthAgo dateTime
DECLARE @month int
DECLARE @year int

SET @monthAgo = DATEADD(month, -1, GETDATE())
SET @month = MONTH(@monthAgo)
SET @year = YEAR(@monthAgo)
"
24607,17876,Postgresql Top N items from a group WHERE N is variable,"with f as (
  select
    id fruit_id,
    fruit,
    row_number() over (partition by fruit order by grade) rn
  from
    fruit
)
select
  o.order_id,
  f.fruit_id
from
  f
    inner join
  ""order"" o
    on o.item = f.fruit
where
  f.rn <= o.quantity
"
28431,68772,Finding N Largest elements in a column,"SELECT   *
FROM     city
ORDER BY population DESC
LIMIT    5 -- or any other N
"
3931,31930,SQL for query cost estimate on SQL Server,"SET SHOWPLAN_XML ON;
GO
SELECT * FROM master..spt_values
GO
SET SHOWPLAN_XML OFF;
"
23053,56196,Can I assign a unique ID to a button that I can get when it is clicked?,"Protected Sub Page_Load(ByVal sender As Object, ByVal e As EventArgs) 
   //create your button then assign the id       
   myButton.ID = ""123""
   // assign a generic event handler for all the buttons in the table.
   AddHandler myButton.Click, AddressOf myButtons_Clicked
End Sub

Protected Sub myButtons_Clicked(ByVal sender As Object, ByVal e As EventArgs)
  Button thebtn = CType(sender, Button)
  string btnID = thebtn.ID
  // pass of the ID to whatever method is doing your processing
End Sub
"
26304,44124,Should I use Post or Put to edit a person in a database and which should I use to add a new person?,"GET    => READ
POST   => CREATE
DELETE => DELETE
PUT    => UPDATE
"
17709,9965,How can we display user who loading the record in MDS,"CREATE TRIGGER [mdm].[SOME_NAME]
  ON  [mdm].[YOUR_BASE_TABLE]
  AFTER INSERT

AS 
BEGIN

  SET NOCOUNT ON;
  UPDATE [mdm].[YOUR_SUBSCRIPTION_VIEW]
  SET [Owner] = [EnterUserName]
  FROM [mdm].[YOUR_SUBSCRIPTION_VIEW]
  WHERE  ID = (SELECT MAX(ID) FROM [mdm].[YOUR_SUBSCRIPTION_VIEW])

END
"
7512,58431,Using Distinct returns duplicate values.How to avoid this?," select Customer, MAX(CustomerID) CustomerID
 from   history
 where  Customer != '' AND Customer LIKE 'Ram%'
 GROUP BY Customer 
"
17880,60257,SQL XML - exist: is there a better way?,"SELECT e.ID 
FROM tblEstimator e
CROSS APPLY e.ProjectsBridge.nodes('/bridging/project') AS T(c)
WHERE T.c.value('@id', 'INT') = @ProjectId
"
26708,49183,How to explorer temp table content when procedure debugging,"    INSERT INTO #tmp_file EXEC ('RESTORE FILELISTONLY FROM DISK = N''' + @database_bak_path + '''') 
    select * from #tmp_file--this can be diaplay on debugging result
    set @database_mdf_oldname = (select LogicalName from #tmp_file where Type = 'D')
    set @database_log_oldname = (select LogicalName from #tmp_file where Type = 'L')
"
4424,12582,Joining three tables together based on common ids,"SELECT 
    c.ID, c.post_title, a.name
FROM 
    wp_tylerposts c
LEFT JOIN
    wp_tylerterm_relationships b
ON
    c.ID = b.object_id
LEFT JOIN
    wp_tylerterms a
ON
    b.term_taxonomy_id = a.term_id
WHERE
    c.post_type = 'sponsor'
"
20756,73827,sql - update statement from another table,"update t1
    set amount = (select top 1 t2.amount
                  from t2
                  where t2.date <= t1.date
                  order by t2.date
                 );
"
11555,75280,How do you transfer all tables between databases using SQL Management Studio?,"INSERT INTO db1.dbo.SmallerTable
SELECT *
  FROM linked_server.db.dbo.LargerTable lt
 WHERE NOT EXISTS(SELECT NULL
                    FROM db1.dbo.SmallerTable st
                   WHERE st.col = lt.col) 
"
38904,34946,SQL Create Statement for Multiple Columns Containing all Given Values,"select *
from table t
where 1 in (A, B, C) and 3 in (A, B, C);
"
33787,13948,which one is a faster/better sql practice?,"SELECT  *
FROM    mytable
WHERE   flagged = 'F'
ORDER BY
        flagged ASC, id ASC
LIMIT 1
"
36238,14679,Generate dates between to date columns,"WITH x ( d ) AS (
    SELECT TO_DATE('2014-12-25', 'yyyy-mm-dd')
    FROM   dual
    UNION ALL
    SELECT d + interval '1' day
    FROM   x
    WHERE  d < TO_DATE('2014-12-31', 'yyyy-mm-dd')
)
SELECT *
FROM   x
"
33352,26280,SQL Select multiple rows with same column values,"select [column1], [column2], [column3], [column4]
from
(
  select [column1], [column2], [column3], [column4],
    row_number() over(partition by column2, column3, column4 order by column1) rn
  from yourtable
) src
where rn <= 3
"
8373,16148,Build MySQL table based on a LIKE from fields in another,"CREATE TABLE ...
AS 
SELECT title, 
       url, 
       CASE
         WHEN course_type LIKE '%Further%' THEN 1
         ELSE 0
       END as further,
       CASE
         WHEN course_type LIKE '%Higher%' THEN 1
         ELSE 0
       END as higher
  FROM `courses`
"
32640,22329,How to add composite primary key to table,"create table D (
  ID numeric(1),
  CODE varchar(2),
  constraint PK_D primary key (ID, CODE)
);
"
37322,56851,SQL Query to summarize data for each column in table,"select
  col        as col_name,
  min(val)   as min, 
  max(val)   as max, 
  count(val) as count
from (
  select col, val 
  from t -- your table here
  unpivot (
    val for col in (col_1, col_2, col_n) -- your columns here
  ) u 
) r
group by col;
"
17862,7248,SQL Query for a key referencing PK,"select  E.empid , E.empName , E2.empName
from TableEmp E
left join TableEmp E2 on E.ManagerID = E2.empid
"
21696,12564,Remove and add ID key index from Access table in VBA,"CurrentDb.Execute ""ALTER TABLE Aux_Tabla1 ALTER COLUMN ID COUNTER(1,1)""
"
28027,21628,who can tell me how to write the SQL,"$sql = ""select 
               *
        from 
                tp_picture 
        where 
                (catid in(13,14,15,20)) 
        order by 
                catid,listorder ASC"";
"
33959,7512,How to write to DB using Linq,"Dim dc as new DataClassesDataContext()

Dim deleteFruits = _
    From f In db.Fruits() _
    Where f.Remove _
    Select f

For Each fruit In deleteFruits
    db.Fruits.DeleteOnSubmit(fruit)
Next

Try
    db.SubmitChanges()
Catch ex As Exception
    Console.WriteLine(ex)
    ' Provide for exceptions
End Try
"
33969,7517,Why LIKE returns no rows selected in sql?,"SELECT NAME, SURNAME
FROM students
WHERE rtrim(SURNAME) LIKE '%n'
"
14422,8867,SQL query with multiple values in table A whose description is in table B,"select Territory, G1.Group_Description as desc1 , G2.Group_Description as desc2 , G3.Group_Description as desc3 , G4.Group_Description as desc4 
from Territory T 
   left outer join [Territory_Group] G1 on T.Group_ID1 = G1.Group_ID
   left outer join [Territory_Group] G2 on T.Group_ID2 = G2.Group_ID
   left outer join [Territory_Group] G3 on T.Group_ID3 = G3.Group_ID
   left outer join [Territory_Group] G4 on T.Group_ID4 = G4.Group_ID
"
21268,72856,MySQL import - How to ignore Drop table if exists line?,"awk '!/^DROP TABLE IF EXISTS/{print}' <dump.file> | mysql <db_name>
"
8565,995,Group By SQL server,"select (case when ref like 'FA%' then 'FA' else 'OTHER' end) as grp,
       sum(ETILIQUIDO) as total
from pn where FDATA between #1# and #2#
group by (case when ref like 'FA%' then 'FA' else 'OTHER' end);
"
38826,23754,Oracle query with just sub selects,"select 
  (SELECT count(1) from tests) TestCount, 
  (select count(1) from customers) CustomerCount, 
  (select count(1) from patients) PatientCount
from dual;
"
32384,20444,How can I update contents on an HTML5 web application,"// use localStorage for persistent storage
// use sessionStorage for per tab storage
saveButton.addEventListener('click', function () {
  window.localStorage.setItem('value', area.value);
  window.localStorage.setItem('timestamp', (new Date()).getTime());
}, false);
textarea.value = window.localStorage.getItem('value');
"
36132,37393,TSQL - SOME | ANY why are they same with different names?,"<some> ::= SOME | ANY
"
23176,60511,SQL select sum from other table as a column via junction table,"SELECT E.EmployeeName, COUNT(T.TaskID) AS [Number of Tasks], SUM(T.Duration) as [Time Spent]
FROM Employee E, EmployeeTasks ET, Tasks T
WHERE ET.EmployeeID = E.EmployeeID AND ET.TaskID = T.TaskID
GROUP BY E.EmployeeName
"
28403,206,how create hibernate criteria query for given sql query,"Criteria criteria = session.createCriteria(Customers.class);
criteria.add(Restrictions.eq(""Country"", ""Germany""));
criteria.add(Restrictions.or(
                             Restrictions.eq(""City"", ""Berlin""),
                             Restrictions.eq(""City"", ""Munchen"")));
"
32700,30505,why does this query return a row with nulls,"SELECT DISTINCT u_id, MAX(timestamp) as time FROM my_table GROUP BY u_id HAVING time IS NOT NULL;
"
3679,60115,Limit results in SQL,"SELECT p1.* FROM Person p1
WHERE p1.id in (
    SELECT TOP 5 p2.id FROM Person p2
    WHERE p2.name = p1.name
)
ORDER BY p1.id
"
26294,50370,Numbering duplicates record in mysql,"SELECT 
ID,
Name,
age,
( 
CASE Name 
WHEN @curType 
THEN @curRow := @curRow + 1 
ELSE @curRow := 1 AND @curType := Name END
) + 1 AS sequence_No

FROM student, (SELECT @curRow := 0, @curType := '') r
ORDER BY  ID,NAME;
"
1154,64634,Using Spool in Oracle 11g,"spool all_queries.txt
select * from A;
select * from B;
select * from C;
spool off

spool only_d_query.txt
select * from D;
spool off

host cat only_d_query.txt >>all_queries.txt

spool all_queries.txt append
select * from E;
spool off
"
11251,53148,Update table with multiple SET arguments,"UPDATE tableA
SET col1 = case col2
    when 'somereference' then 'somedata'
    when 'someotherreference' then 'someotherdata'
    when 'anotherreference' then 'evenmoredata'
    else col1
    end
"
24089,14695,Database Table Synonym/Alias,"CREATE VIEW MOST_RECENT_JOB_LISTINGS AS 
SELECT * FROM job_listings_20151228
"
36225,8074,Get earliest timestamps for user's cards in a mysql data table,"SELECT  `username`, `card_id`, MIN(`timeStamp`)
FROM    `usercardinfo` 
WHERE   `timeStamp` between '2009-04-01' and '2009-06-01'
GROUP BY
        `username`, `card_id`
"
35284,54589,How to create a unique constraint just on the date part of a datetime?,"ALTER TABLE dbo.Entries
   ADD DateOnly as CAST(CompositionDate AS DATE) PERSISTED

CREATE UNIQUE INDEX UX_Entries ON Entries(DateOnly, Slug)
"
24496,64330,Conditional INSERT INTO statement in postgres,"insert into LeadCustomer (Firstname, Surname, BillingAddress, email)
select 
    'John', 'Smith', 
    '6 Brewery close, Buxton, Norfolk', 'cmp.testing@example.com'
where not exists (
    select * from leadcustomer where firstname = 'John' and surname = 'Smith'
);
"
39276,10775,How to remove text in middle of a field-Mysql query,"UPDATE MyDb
SET recepients = REPLACE(REPLACE(recepients, ',abc@gmail.com', ''), 'abc@gmail.com,', '')
"
11582,28521,How to select multiple values from single column with multiple tables in MySQL?,"SELECT table1.name
FROM table1 
JOIN table2 t1_link ON table1.id = t1_link.table1_id
JOIN table3 t1_data ON t1_link.table3_id = t1_data.id AND t1_data.title in ('blue', 'orange')
JOIN table2 t2_link ON table1.id = t2_link.table1_id
JOIN table3 t2_data ON t2_link.table3_id = t2_data.id AND t2_data.title in ('green', 'black')
"
37755,60055,Complex MySQL Query who can solve?,"SELECT product_id,product_name, min(c) Qty
FROM
(
  SELECT p.product_id, p.product_name, p.material_id, count(sd.product_id) c
  FROM product p
  LEFT JOIN scaledata sd
    ON p.product_id=sd.product_id
   AND p.material_id = sd.material_id
  GROUP BY product_id, p.product_name, p.material_id
) a
GROUP BY product_id
"
2619,784,Trigger to increment value,"CREATE OR REPLACE FUNCTION inc_indexVersion()

RETURNS trigger AS

$BODY$
BEGIN
    NEW.indexversion = OLD.indexversion +1;
    RETURN NEW;
END;
$BODY$
LANGUAGE plpgsql;

CREATE TRIGGER inc_trigger
  BEFORE UPDATE
  ON Establishment
  FOR EACH ROW
  EXECUTE PROCEDURE inc_indexVersion();
"
5643,11834,How to use access data in a table that's connected thru a join?,"SELECT * FROM Sections where section_id in (SELECT section_id from AccessControl where user_id=39)
"
12609,22367,UTF 8 from Oracle tables,"select value from nls_database_parameters 
where parameter='NLS_CHARACTERSET'
"
10157,42181,How to select data from a table based on 3 other tables?,"SELECT s.shape_value
FROM shapes s 
INNER JOIN trips t ON s.shape_id = t.shape_id
INNER JOIN stop_times st ON t.trip_id = st.trip_id
INNER JOIN stops ss ON st.stop_id = ss.stop_id
WHERE ss.stop_value < 5;
"
14264,52641,Conditionally sql query,"SELECT * FROM users WHERE name = 'User1'
UNION ALL 
SELECT * FROM users WHERE name = 'Default' 
    AND NOT EXISTS (SELECT 1 FROM users WHERE name='User1')
"
28618,9329,What's the best practise to write SQL to get data as follow?,"SELECT  c.Status,
    	SUM(CASE WHEN u.Gender = 0 THEN 1 ELSE 0 END) Male, --assuming 0 is male
    	SUM(CASE WHEN u.Gender = 1 THEN 1 ELSE 0 END) Female --assuming 1 is female
FROm    Competitors c INNER JOIN
    	UserInfomration u ON c.UserID = u.ID
GROUP BY c.Status
"
12201,43488,SQL Query to concatenate strings or add default value,"SELECT 
  CODPROY, 
  DESCPROY, 
  USER, 
  CODPROY + ' - ' + COALESCE(USER,'NOT AVAILABLE') + ' - ' + DESCPROY AS Expr 
FROM dbo.PROY
"
31796,59302,Insert into SELECT with composite primary key failing SQL Server 2008,"    with    drg as (SELECT DISTINCT patientID, admissionDate, dischargeDate, drgCode from largeTable)
    update  s
    set     s.drgCode = l.drgCode
    from    smallTable s join drg l on 
                s.patientId = l.patientId and
                s.admissionDate = l.admissionDate and
                s.dischargeDate  = l.dischargeDate
"
868,42247,How to create parent child relation in query?,"select t.id
      ,t.ParentID
  from table_name t
 start with t.ParentID = 0
connect by prior t.id = t.ParentID
"
28308,66548,SQL query for counts and accessing another tables,"select attribute, count(*) from users as u, 
(select distinct user_id from Y) as Y2
where U.user_id = Y2.user_id 
group by attribute;
"
16295,59723,MySQL Order By with Limit to MS SQL Order By,"SELECT TOP 1 @thesttax = stax
FROM transfers 
WHERE masterkey = @skey and effdate <= CURRENT_DATE() 
ORDER BY effdate DESC;
"
1803,3344,how to get zero when data is not present for a particular field,"select s.group1, 
  s.class,
  count(d.class) tot
from 
(
  select distinct a.group1, c.class
  from abcd a
  cross join 
  (
    select distinct class
    from abcd
  ) c
) s
left join abcd d
  on s.group1 = d.group1
  and s.class = d.class
group by s.group1, s.class
order by s.group1, s.class;
"
25165,31133,How to sum the Quarter values into Year values in SAS? Proc SQL?," proc sql;
 create table want as
 select substr(time, 1,4) as QTR, sum(value) as total
 from have
 group by calculated QTR;
 quit;
"
525,34960,Concatenating two tables distributively,"SELECT     a.*, b.*
FROM       a
CROSS JOIN b
"
21633,31597,SQL statement to get distinct data,"SELECT DISTINCT ON (user_id)
       id, user_id, name, active
FROM   profiles p
WHERE  NOT EXISTS (
   SELECT 1 FROM profiles
   WHERE  user_id = p.user_id
   AND    active               -- exclude users with any active profiles
   )
ORDER  BY user_id, id DESC;
"
18464,64419,T-SQL Case Condition in Where Clause,"DECLARE @OP INT = 1;
SELECT * FROM Table
WHERE (@OP = 1 AND Table.[status] IN (5,6))
OR (@OP !=1 AND Table.[status] IN (12))
"
35001,63474,"Get the operation type inside a ""Insert or Update"" trigger","create trigger sample_trigger
    before insert or update
    on sample_table
    for each row
begin
    case
        when inserting then
            --do something
        when updating then
            --do something
    end case;
end;
"
5821,46546,How to refine last but one?,"select t.*,
   row_number() 
   over (partition by event_id
         order by event_date desc)
from tab as t
qualify
   row_number() 
   over (partition by event_id
         order by event_date desc) = 2
-- or simply
-- qualify rn = 2
"
34470,67152,Create new column based on values of another column,"Select
    CASE
        WHEN [Activity Type] = 'A' THEN
            CASE WHEN MonitorA_ID is NULL
              OR MonitorA_Date is NULL
              OR MonitorA_Region is NULL
            THEN 1 ELSE 0 END
    END as 'A_Chk'

From Table
"
8868,41707,Add temp column for use in single mysql query as label,"(
SELECT act_id, act_date, act_score, 'act' as description
FROM actsWithScore
WHERE user_id =  '1'
)
UNION ALL 
(

SELECT act_id, vote_date, vote_score, 'votes' as description
FROM votes
WHERE user_voter =  '1'
)
ORDER BY  `act_date`
"
23799,58044,Sum of multiple invoices amount converted to a currency,"select extract(month from created_date) as mon, 
extract(year from created_date) as yyyy, 
sum(case when c.code_from <> 'USD' then amount * c.rate else amount end) as ""Sales"" 
from invoice i
join currency_rates c on i.currency_type_id = c.code_from
where c.code_to = 'USD'
group by 1,2 
order by 2,1
"
19761,34929,Retrieve records from 2 tables,"select *
  from dbo.EnquiryMaster as em
  left join dbo.Requirement as r
    on em.EnquiryId = r.EnquiryID
 where r.MobileIT is null 
   and r.PhoneIT is null
   and em.RService ='No Requirement'
   and em.RSubService ='No Requirement'
   and em.date >= dateadd(day, -15, getdate())
"
38983,25682,Find if a value exists anywhere in a second column and return a result,"select a.job_id, b.link_id, case when b.link is not null then 0.5 else 0 end cycle
from tb a left outer join tb b
on a.job_id = b.link_id;
"
37956,4502,How to count records and display those counted records?,"SELECT CAST(CAST(COUNT([ASSIGNED TO]) as varchar(10)) + ' - ' +  [ASSIGNED TO] as varchar(50))  AS UserCount
FROM dbo.ECRSurvey
GROUP BY [ASSIGNED TO]
"
37118,38037,Left join and excluding non-existent rows on certain matchups,"SELECT *
FROM TABLE1 T1 JOIN
     (SELECT DISTINCT PROP1, PROP2
      FROM TABLE2
     ) TT2
     ON T1.PROP1 = TT2.PROP1 AND t1.PROP2 = TT2.PROP2 LEFT JOIN
     TABLE2 T2
     ON T1.PROP1 = T2.PROP1 AND T1.PROP2 = T2.PROP2 AND T1.NUM = T2.NUM
WHERE T2.NUM IS NULL;
"
39763,55326,T-SQL 2005: Add Date and Time,"DECLARE @Date DATETIME = '2011-1-01 00:00:00.000'
, @Time DATETIME = '1900-01-01 3:31:19.000'

SELECT DATEADD(hh, DATEPART(hh, @Time), DATEADD(mi, DATEPART(mi, @Time), @Date)) --and so on
"
38988,66944,Creating a table without creating a table,"select * 
from ( 
   values 
      ('John', 'Doe'), 
      ('Jane', 'Doe'), 
      ('Arthur', 'Dent')
) as t (first, last)
"
7982,36588,Get closest store for each customer,"111.045*DEGREES(ACOS(COS(RADIANS(lat1)) * COS(RADIANS(lat2)) *
                     COS(RADIANS(long1) - RADIANS(long2)) +
                     SIN(RADIANS(lat1)) * SIN(RADIANS(lat2)))) AS distance_in_km
"
14533,45444,Insert Statement in sql server,"insert into table (datecolumn) values ('2012-04-22 13:23:12')
"
10583,28318,"""distinct count"" and ""distinct count if exists"" in single MySQL select statement","SELECT count(email) emails_sent, count(distinct email) unique_users,
count(distinct if(not exists(select 1 from sent_emails where  date_sent < se.date_sent and se.email = email ),email,null)) new_emailed_users
from sent_emails se where date_sent = '2013-01-10';
"
118,15461,MySQL: Query to get the data with constraints,"WHERE dateofBirth != CURDATE() + INTERVAL 1 day
"
19034,66230,SQL not allowing foreign key if it's a multiple candidate key?,"CREATE TABLE SessionDuration__Record
(
    c_id      CHAR(3)    NOT NULL  REFERENCES Club_Record(c_id),
    sess_id   NUMBER(4)  NOT NULL  CHECK (sess_id >0),
    ""DAY""     CHAR(9)    NOT NULL,
    duration  NUMBER(3)  NOT NULL,
    UNIQUE(c_id, sess_id),
    FOREIGN KEY (c_id, sess_id) REFERENCES Session_Record(c_id, sess_id)
);
"
4244,38746,Performing a multi-table inner/left/right join (or correlated subquery) with count?,"select count(vote.id)
from owner
left join item on (item.owner_id = owner.id)
left join vote on (vote.item_id = item.id)
where owner.id = :id
"
16312,53534,Tool for importing CSV files into MySQL database?,"LOAD DATA INFILE 'data.txt' INTO TABLE tbl_name
 FIELDS TERMINATED BY ',' ENCLOSED BY '""'
 LINES TERMINATED BY '\r\n'
 IGNORE 1 LINES;
"
9122,71310,sql multiple join with OR condition,"SELECT * FROM AA 
  LEFT OUTER JOIN BB  ON (
    AA.id = BB.aa_id
    AND /* SOME_CONDITION */
  ) 
  LEFT OUTER JOIN CC  ON (
    AA.id = CC.aa_id
    AND /* SOME_CONDITION */
  )
ORDER BY AA.id DESC
LIMIT 1000;
"
27933,7620,How to check column value null or having value,"SELECT ProductName,UnitPrice*(UnitsInStock+IFNULL(UnitsOnOrder,0))
FROM Products
"
4153,51175,group by access seperate column,"SELECT   t.date, COUNT(*)
FROM     (SELECT DISTINCT [TimeTrackingLog-sql].date, 
                          [TimeTrackingLog-sql].callerName
          FROM   [TimeTrackingLog-sql]) t
GROUP BY t.date
"
27790,5178,Compare 2 rows in different tables and update if similar,"select a.name,a.[group],2 as [status] from animal a
where exists(select * from mammal b where b.name = a.name and b.[group]=a.[group])
"
12905,17895,How to merge 2 or more columns into one?,"Select Id, Comments 
From 
(
    Select Id, Column1 Comments From MyTable Where Column1 Is Not Null
    Union All
    Select Id, Column2 Comments From MyTable Where Column2 Is Not Null
    Union All
    Select Id, Column3 Comments From MyTable Where Column3 Is Not Null
) DerivedTable
Order by Id
"
27418,50920,Table formatting trouble,"select id, 
       case when code = 4 then 4 end code4, 
       case when code = 4 then `procedure` end procedures4,
       case when code = 6 then 6 end code6,
       case when code = 6 then `procedure` end procedures6
from test
"
39662,26061,"Combine data from multiple Access tables to produce address label, preferring PO box to Physical Address","SELECT 
   t.POBoxNumber As AddrLine1,
   t.POBoxSuburb As AddrLine2,
   t.POBoxCity As AddrLine3,
   t.POBoxPostCode As AddrLine4,
   """"  As AddrLine5
FROM TheTable t 
WHERE t.POBoxNumber Is Not Null
UNION ALL
SELECT 
   AddressBuilding As AddrLine1,
   AddressStreet As AddrLine2,
   AddressSuburb As AddrLine3,
   AddressCity As AddrLine4,
   AddressPostCode As AddrLine5
FROM TheTable t 
WHERE t.POBoxNumber Is Null
"
30545,73707,updating timestamp column with timestamp containing 'T',"select to_timestamp('2014-07-02T10:46:22', 'YYYY-MM-DD""T""HH24:MI:SS') from dual;

TO_TIMESTAMP('2014-07-02T10:46:22','YYYY-MM-DD""T""HH24:MI:SS')
-------------------------------------------------------------
02-JUL-14 10.46.22.000000000                                  
"
18368,51399,ORA-00900: invalid SQL statement- when run a procedure in oracle 10g,"begin
  exam;
end;
"
22416,63233,SQL Search query Result,"if object_id('tempdb..#Temp') is not null drop table #Temp
create table #Temp (FirmName nvarchar(50))

insert into #Temp (FirmName) 
values ('Emlak 17'),
   ('Sanane Emlak'),
   ('GE Emlak => Result'),
   ('45 Emlak'),
   ('Emlak 3Z'),
   ('Burak Emlak')

select * from #Temp
    where Len(LEFT(FirmName, charindex(' ',FirmName, 0))) = 2
       or LEN(RIGHT(FirmName,LEN(FirmName)-CHARINDEX(' ',FirmName))) = 2
"
36350,23909,Oracle - Use table of number as filter in where clause,"SELECT count( o.pap_id) 
  INTO testvar
  FROM pap_operator o
 WHERE o.pap_operator_id IN (SELECT * FROM TABLE(ActiveiteitSAC) );
"
23157,62838,Oracle regex string not beginning with '40821',"^([012356789]|4[123456789]|40[012345679]|408[013456789]|4082[023456789])
"
10222,22504,Combining Values from SQL Table into a Second Table,"UPDATE 
   MainTable
SET 
   MainTable.Source = NewTable.Source
FROM
   MainTable
INNER JOIN 
   NewTable
ON 
   MainTable.ID = NewTable .ID
"
22514,20957,SQL UPDATE: return if row was updated AND exists,"UPDATE  t
SET     status = (CASE WHEN t.status = 'active' THEN 'canceled' ELSE t.status END)
FROM    t AS t2
WHERE   t.id = t2.id
AND     t.id = 1
RETURNING t.id, t.status, t2.status
;
"
19473,36163,Oracle: How can I get all the triggers linked to a specific table?,"SELECT * FROM USER_TRIGGERS WHERE TABLE_NAME = 'NAME_OF_YOUR_TABLE';
"
21764,22088,SQL query two tables,"SELECT ID 
FROM Messages 
WHERE ID NOT IN (
    SELECT ID 
    FROM MessagesRead 
    WHERE UserName = 'your_input_name');
"
15303,3952,MySQL Get rows that do not match with certain conditions,"SELECT * FROM codes NATURAL JOIN (
  SELECT   code
  FROM     codes
  WHERE    type IN (1,2)
  GROUP BY code
  HAVING   COUNT(DISTINCT type) = 1
) t
"
11812,57642,Updating DB depending on value,"UPDATE tblObject 
INNER JOIN tbltarifs ON tblObject.tarif_id = tbltarifs.tarif_id
SET tblObject.active = 0
WHERE DATE_FORMAT(NOW(),'%m-%d-%Y') > DATE_FORMAT(expire_date,'%m-%d-%Y')
"
37527,41687,SQL Sorting with Two Joined Tables,"SELECT p.id, p.name, MAX(a.date_answered)
FROM people p
LEFT JOIN answer_sheets a on p.id = a.personID
GROUP BY p.id, p.name
ORDER BY MAX(date_answered) ASC
"
27811,25678,SQL Statement with joins & where clause,"SELECT * 
    FROM al_posts
    JOIN al_friendships 
    ON al_posts.user_id = al_friendships.user_b 
    AND al_friendships.user_a = '{$_SESSION['UserID']}'                                     
    JOIN al_users ON al_friendships.user_b = al_users.id
"
28146,32675,How to avoid datepart to start from new week on year change,"GROUP BY
    DATEDIFF(week, 0, ad.xDate)
"
19463,60104,Export Delimited Text File from SQL with a second delimiter for each record,"REPLACE([StringField], CHAR(13)+CHAR(10), CHAR(31)) AS [StringField]
"
11041,22178,"How I can add null data to a result set, where it doesn't exist in the DB - without inserting new data","SELECT 
d.device, 
s.service, 
r.hits
FROM dt_devs d
INNER JOIN dt_serv s ON d.serviceID = s.serviceID
LEFT JOIN results r ON d.deviceID = r.deviceID
"
17504,46160,Replace just start of string in sql,"update table t
    set cell = concat('/rr', substr(cell, 4))
    where cell like '/ta%';
"
37534,14117,"New values into ID identity (1,1) column","SELECT 
    ROW_NUMBER() OVER (ORDER BY ID) RowNum,
    ID,
    text
FROM test
"
31490,54943,Join Data from single table,"Select  pid,
        IsNull(max(case when AdressCode = '01' then OwnerName end), '') as OwnerName1,
        IsNull(max(case when AdressCode = '02' then OwnerName end), '') as OwnerName2,
        customernum
from ownertable
group by pid, customernum
Order BY pid, customernum
"
37899,16810,SQL filtering by time when it crosses midnight,"select RecordId, Gender, Age, TimeField
from #testTime
where (cast(Timefield as time) >= '16:30' or cast(Timefield as time) <= '03:00') 
"
19354,19725,Nested SQL function,"SELECT Suppliers.SNAME
FROM Suppliers
INNER JOIN Deliveries
ON Deliveries.S=Suppliers.S
WHERE QTY=(SELECT MAX(Deliveries.QTY) FROM Deliveries)
"
26624,32509,Get recipes which don't include X ingredients,"SELECT r.id, r.title,
       SUM(ingredients_id IN (19, 25, 30, 40)) as ing_match_count,
       COUNT(*) as recipe_ing_count
FROM recipes r JOIN
     recipe_ingredients  ri
     ON ri.recipe_id = recipes.id
GROUP BY r.id, r.title
HAVING ing_match_count > 0 AND
       SUM(ingredients_id in (22, 23)) = 0;
"
31662,26059,How do I insert email to another table without have a duplicate,"INSERT INTO combineusers (Email) 
SELECT * FROM 
(
  SELECT DISTINCT u.Email FROM users u
  LEFT JOIN combineusers c ON (u.email = c.email)
  WHERE c.email IS NULL
) sub
"
18356,3270,Single query to do select and update,"UPDATE YOUR_TABLE
   SET col1 = CASE
                WHEN condition = 1 THEN 1
                WHEN condition IS NULL THEN 0
                ELSE 0
              END
"
24614,23127,SQL:how to find duplicated combinations in two adjacent columns,"select *
from mytable t
join (
    select field3, field4, count(*) from (
      select field3, field4 from mytable where field3 <= field4
      union all
      select field4, field3 from mytable where field3 > field4) x
    group by field3, field4
    having count(*) > 1) y
  on (t.field3 = y.field3 and t.field4 = y.field4)
    or (t.field3 = y.field4 and t.field4 = y.field3)
"
31627,845,How do I create a not mandatory join?,"SELECT `prod_combined`.`sku`, `prod_combined`.`titel`, `prod_combined`.`preis_vk`, `prod_performance`.* 
FROM `prod_combined` 
LEFT JOIN `prod_performance` ON prod_combined.sku = prod_performance.sku
  AND prod_performance.partner_id = 801
  AND prod_performance.active >= 0
WHERE prod_combined.aktiv = 1 
  AND prod_combined.sku = 1006224000  
LIMIT 5
"
38258,13632,T-SQL. How to select Item[i] and Item[i-1] into same row WITHOUT cursor,"DECLARE @Data TABLE ([Key] FLOAT PRIMARY KEY, Value FLOAT)
INSERT @Data VALUES(0.1, 2.0),(0.2, 3.0), (0.3, 5.0), (0.4,4.0)

;WITH CTEData AS
(
SELECT ROW_NUMBER() OVER(ORDER BY [Key]) AS RowNo,
    [Key], Value
FROM @Data
)

SELECT d1.[Key], d2.[Key] AS PreviousKey, d1.Value
FROM CTEData d1
    INNER JOIN CTEData d2 ON d1.RowNo-1 = d2.RowNo
"
124,71185,export query results into CSV file issue in SQL Server,"select 
  Cast(PersonCode as varchar(50)) + '\t'
  + Cast(PersonReference as varchar(50))    
from People
"
34411,55749,How to run an Oracle Query for another timezone,"SELECT NEW_TIME (TO_DATE ('2015-12-01 03:34:46', 'YYYY-MM-DD HH:MI:SS'),
                 'CST',
                 'PST'
                )
FROM DUAL;

Output: 12/1/2015 1:34:46 AM
"
30272,58798,Grouping records in order (SQL),"SELECT COUNT(*) ""count"", MIN(id) starting_id, number
FROM (
  SELECT a.id, a.number, a.number || '-' || COUNT(b.id) seq
  FROM mytable a
  LEFT JOIN mytable b
    ON a.id > b.id AND a.number <> b.number
  GROUP BY a.id, a.number
)
GROUP BY seq
ORDER BY id;
"
11053,74379,How to deal with unlimited columns situation on Oracle?,"SELECT Item_Title Items, Listagg(Seller.Seller_Fname, ',') Within
 GROUP(
 ORDER BY Seller_Fname)
  FROM Item
  JOIN Itemseller ON Itemseller.Is_Itemid = Item.Item_Id
  JOIN Seller ON Seller.Seller_Id = Itemseller.Is_Sellerid
 GROUP BY Item.Item_Title
HAVING COUNT(Itemseller.Is_Itemid) > 1;
"
13789,46092,How to pick columns of table dynamically which are free?,"UPDATE  tableName
SET     ColA = CASE WHEN ColA IS NULL THEN 'NewValue' ELSE ColA END,
        ColB = CASE WHEN ColA NOT NULL AND ColB IS NULL THEN 'NewValue' ELSE ColB END,
        ColC = CASE WHEN ColA NOT NULL AND ColB NOT NULL AND ColC IS NULL THEN 'NewValue' ELSE ColC END
WHERE   ID = 1
"
28922,25240,How do I use case statement to aid altering another field?,"SELECT rsoSourceID,
    rsoDescription, 
    rsoCategory,
    case when rsoSourceID in (254,360,446)
        then 'MoneySavingExpert'
        else null end as SourceName
FROM TableName
"
22268,12452,Find binary duplicate records SQL Server 2008 (Data type image),"    TableID  PaperWorkID GroupID
       1        14          1
       2        15          1
       3        21          2
       4        55          2
"
30484,10414,How to Update A database column with B database column?,"UPDATE B
SET table2Id = A_table1.table2Id
FROM A.dbo.table1 as A_table1
inner join B.dbo.table2 as B on A_table1.NaturalKey = B.NaturalKey
WHERE A_table1.Archive = 1
"
23221,55246,Deleting Duplicate Rows in VIew in SQL Server 2008,"CREATE VIEW [dbo].[View1]
AS
SELECT distinct 
  dbo.Table1.Id, 
  dbo.Table1.Name, 
  dbo.Table1.Client,
  dbo.Table1.Position, 
  dbo.Table2.[Time]
FROM dbo.Table1 
LEFT OUTER JOIN dbo.Table2 
ON dbo.Table1.Id = dbo.Table2.Id
"
29042,31936,Have a subquery return a row instead of a column,";WITH LastEmails
AS
(
   SELECT *, 
     ROW_NUMBER() OVER(ORDER BY Timestamp DESC) rownum
   FROM Emails
   WHERE Contact = @emailId
     AND (IsSent is null OR isSent = 0)
)
SELECT * FROM LastEmails
WHERE rownum = 1;
"
35112,25938,"Linq to sql, aggregate columns ,group by date into listview","Dim results = db.Orders.Where(Function(n) n.CustomerId = customerId).GroupBy(Function(n) n.Date.Year, Function(key, values) New With {.Year = key, .NetTotal = values.Sum(Function(n) n.NetPurchase * n.Quantity * (1 + (n.Discount/100))), .GrossTotal = values.Sum(Function(n) n.GrossPurchase)})
"
27474,42380,Kohana Query Builder support for DATEDIFF?,"$query->where('DATEDIFF(""date"", '.$today.')"", '=', 0);
"
5513,70862,Oracle SQL query performance improvement: minus vs where not exists,"Select 
   t1.column1, t1.column2 
From
   table1 t1, table2 t2
Where 
   t1.id = t2.id
   and t1.some_column = t2.some_column
   and not exists (select 1 from table3 t3 where t1.id = t3.id)
"
35072,59943,SQL - counting rows with specific value,"SELECT   id, SUM(value=0) AS n0, SUM(value=1) AS n1, COUNT(*) AS total
FROM     mytable
GROUP BY id
"
9121,18550,How to force a query to get the results with only all the rows selected?,"SELECT P.Id_Product, P.Name
FROM Products P
    JOIN Features F ON P.id_product = F.id_product 
    JOIN Features F2 ON P.id_product = F2.id_product 
WHERE F.id_feature IN (SELECT id_feature FROM Features WHERE id_product = 5)
GROUP BY P.Id_Product, P.Name
HAVING COUNT(DISTINCT F2.id_Feature) = 3
"
34591,66082,"SQL Query, obtain maximum with no duplicates","select
    p.Id, p.FirstName, p.LastName,
    s.CalculatedScore, s.AccuracyScore, s.TimeScore, s.DistanceScore
from Player as p
    outer apply (
        select top 1 s.*
        from Shot as s
        where s.PlayerId = p.Id
        order by s.CalculatedScore desc
    ) as s
"
4393,17537,How do you bring the schema name into an VIEW in Oracle?,"create or replace view_name
as
select col1, col2, 'schema1' as schema_name
from schema1.table
union all
select col1, col2, 'schema2'
from schema2.table
union all
select col1, col2, 'schema3' 
from schema3.table
...
"
32886,49523,"checking age of a person, the person has date of birth stored as a date","SELECT * FROM person
 WHERE dob <= TRUNC(ADD_MONTHS(SYSDATE, -12));
"
17046,3005,"Query to compute the difference between a SUM and previous SUM, GROUP BY discontinuous dates","SELECT 
    D1.RecDate, 
    TotalVal, 
    TotalVal - NZ(TotalVal2,0) Delta
FROM (
    SELECT RecDate, Sum(Mval) as TotalVal
    FROM DailyVal
    WHERE RecDate >= DateValue(""1/1/2013"")
    GROUP BY RecDate) D1
LEFT JOIN (
    SELECT RecDate, Sum(Mval) as TotalVal2
    FROM DailyVal
    WHERE RecDate >= DateValue(""1/1/2013"")
    GROUP BY RecDate) D2
ON D2.RecDate = (SELECT MAX(RecDate) FROM DailyVal WHERE RecDate < D1.RecDate)

;
"
22265,11625,SQL server select max two dates from a table,"SELECT distinct top 2 Dateadded 
FROM table 
ORDER BY Dateadded desc
"
12823,44777,"Can I use wildcards in ""IN"" MySQL statement?","select * from my_table where field rlike 'apple|orange';
"
38544,50973,SQL Where IN but match all,"SELECT id
FROM yourtable
WHERE genre IN ('Rock', 'Popular', 'Classical')
GROUP BY id
HAVING COUNT(DISTINCT Genre) = 3
"
13006,66308,SQL: why is the HAVING clause rejected in this case?,"SELECT column_name, aggregate_function(column_name)
FROM table_name
WHERE column_name operator value
GROUP BY column_name
HAVING aggregate_function(column_name) operator value; 
"
33612,10423,SQL Query to calculate the difference of a number of fields and passing to ASP script,"SELECT MAX(RemainingCapacityBytes) - MIN(RemainingCapacityBytes) DiffCapacityBytes
   FROM [Check].[dbo].[tbl_BackupChecks_MediaInfo]   
 WHERE Company = 'Company Name' and ModifiedDateTime >= dateadd(d,-7,GETDATE()) 
"
14431,54784,Getting total value from each field?,"SELECT Username,
  SUM(CASE WHEN type = 'Yes' THEN 1 ELSE 0 END) as Yes,
  SUM(CASE WHEN type = 'No' THEN 1 ELSE 0 END) as No,
  SUM(CASE WHEN type = '' THEN 1 ELSE 0 END) as Other,  
  COUNT(*) as TOTAL
  FROM table 
WHERE source = 'CompanyName'
group by Username
order by TOTAL desc;
"
32142,69819,SQL code does not work,"select c.name,a.adress,a.postcode_id from customer c left join Adress a on c.customer_id=a.customer_id where c.customer_id>11
"
21124,44753,How to create a query that returns forums by user,"   SELECT f.id as f_id, f.message, c.id as c_id, c.user_id as c_user_id, c.comment 
   FROM forum_submission f
   LEFT JOIN submission_comment c
   ON c.forum_id=f.id 
   WHERE f.user_id= ? 
   Order by f.id
"
34112,4279,Using normalize-string XPath function from SQL XML query?,"select * from @test where data.exist('ns0:thing[contains(@x, ""hello"")]') != 0 
"
23706,52307,sql: sort from two tables and order by date,"SELECT NULL AS Col1, Name AS Col2, Added AS Col3
FROM A
UNION ALL 
SELECT UserID AS Col1, Username AS Col2, Created AS Col3
FROM B
ORDER BY 3
"
23806,50215,row_nums without using row_number function?,"SELECT id, name, ROW_NUMBER() OVER (ORDER BY name)
  FROM dbo.color
  ORDER BY name;
"
15312,50612,MYSQL - Optimise query to proceed as fast as possible,"SELECT *
FROM $db1 t
WHERE userid <> $userid AND
      NOT EXISTS (select 1 FROM $db2 t2 WHERE uid = $userid and t2.media = t.media)
ORDER BY active ASC
LIMIT 6
"
17013,58203,SQL: Find all previous records for a subset of IDs,"SELECT STUDENT_ID, BOOK_TITLE, TERM
  FROM ASSIGNMENTS
  WHERE STUDENT_ID IN
   (SELECT DISTINCT STUDENT_ID FROM ASSIGNMENTS WHERE TERM = 2012)
  ORDER BY STUDENT_ID, TERM DESC
"
11346,55729,MS Access query table without primary key,"SELECT *
FROM Table1
WHERE Claim IN (SELECT Claim
                FROM Table1
                WHERE Total > 500)
"
7993,65466,SQL Server how to make a good structured database with different tables,"CREATE TABLE dbo.Salary
(
    fkEmployeeId int,
    Salary decimal,
    SalaryYear int,
    SalaryMonth int
);

CREATE INDEX IX_Salary_Employee_Date ON Salary(fkEmployeeId, SalaryYear, SalaryMonth)

DECLARE @Year int = 2016
DECLARE @Month int = 1

SELECT *
FROM Salary s
INNER JOIN MyEmployeeTable e on e.pkEmployeeId = s.fkEmployeeId
WHERE SalaryYear = @Year and SalaryMonth = @Month
"
23929,18914,SQLite : insert multiple value (select from) with insert specified value,"INSERT INTO Table1(idy_table1, idx_table1)
SELECT '1', id_table2 FROM table2;
"
15467,40364,Check rows for same entries in neighbouring columns,"SELECT a.id, a.col1, a.col2
  FROM tbl AS a
  JOIN tbl AS b ON 
      (     a.id=b.id
        AND (a.col1 =  b.col2 OR  a.col2 = b.col1)
        AND (a.col1 != b.col1 AND a.col2 != b.col2)
      )
"
2321,42361,How do I get distinct count values of 2 columns?,"SELECT A
FROM YourTable
UNION
SELECT B
FROM YourTable
"
32040,1546,Recursive CTE to find parent records,"INNER JOIN PreviousClaims parent ON parent.fiData = child.idData
"
8959,3714,Can this be done with a group by clause?,"select doc, code, min(pos) as pos
from t
group by doc, code
"
35521,32255,SQL - table alias scope,"select t.* 
from table t 
join othertable o on t.nameid = o.nameid 
    and o.otherdesc in ('SomeDesc','SomeOtherDesc');
"
13478,13297,Oracle trigger to update an entity in different table,"CREATE OR REPLACE TRIGGER update_flight_booking_info
  AFTER INSERT ON PASSENGER
  FOR EACH ROW

DECLARE
    v_flight_id number;
    v_booking_id number;
BEGIN
    v_booking_id  := :new.booking_id ;

    select flight_id into v_flight_id
    from flight_booking
    where booking_id = v_booking_id;

    update flight
    set NUM_BOOKED = NUM_BOOKED + 1
    where flight_id = v_flight_id;
END;
"
17617,22305,MySQL update table 1 with table 2 data,"UPDATE mailing_email
JOIN   membership ON mailing_email.email = membership.email
SET    mailing_email.communicate = membership.communicate
"
23304,71821,Escaping single quote in PLSQL,"str_comment:='COMMENT ON COLUMN '||rec.table_name||'.'||rec.column_name
            ||' IS '''||REPLACE( rec.description,'''','''''')||'''; ' ;
"
11500,14947,"SQL CASE when using ""AS""","SELECT     warehouse, product, description, 
physical_qty - allocated_qty AS stock,
CASE WHEN (physical_qty - allocated_qty) < 1 THEN 'OUT'
ELSE 'IN' END AS Stock_Status
FROM         scheme.stockm
WHERE     (warehouse = '01') AND (product IN ('A', 'B', 'C'))
"
9126,3236,Export Old SQL table data as UPDATE for New Table (for WHERE id 's is the same),"Update newTable nT
inner join oldTable oT
ON (nT.id=oT.id)
set nT.tell = oT.tell, nT.email=oT.email
"
33650,52740,Postgresql complicated case statement,"select cust_id, indicator, date,
       max(case when indicator = 'y' then date end) over (partition by cust_id
                                                          order by date) as NewCol
from table t;
"
36547,50640,SQL query with JOIN verification needed,"SELECT m.modulename
FROM Module m
WHERE NOT EXISTS 
( SELECT * FROM teacher_Module tm
  INNER JOIN Teacher t 
      ON t.teacher_code = tm.teacher_code t.Initial = 'J' AND t.name = 'Doe'
  WHERE tm.module_code = m.module_code )
"
39142,14454,Check Differences between two Tables with allowed nulls in SQL,"...
WHERE t1.value <> t2.value
OR (t1.value IS NULL AND t2.value IS NOT NULL)
OR (t1.value IS NOT NULL AND t2.value IS NULL);
"
26669,13560,How to perform T9 search method in sql?,"db.rawQuery(""SELECT _id, word, freq FROM dicttable WHERE word GLOB '""+searchWord+""*' ORDER BY freq DESC"",
            null);
"
343,15361,"SQL Server add strings (of 0,1) logically","SELECT 
  on_date,rate_id,type_id,
  MAX(substring(publish_flag, 1,1)) + MAX(substring(publish_flag, 2,1)) + 
  MAX(substring(publish_flag, 3,1)) + MAX(substring(publish_flag, 4,1)) as publish_flag
FROM YourTable
GROUP BY on_date,rate_id,type_id
"
38675,15661,How to update a column fetched by a cursor in TSQL,"UPDATE #T1 
SET    CURRENTPOS = (SELECT SUM(ORDERQUANTITY) - SUM(RECEIVEQUANTITY) 
                     FROM   #POS) 
WHERE  CURRENT OF CURPO 
"
22212,31187,Filter rows based on a value of a column,"SELECT * 
FROM Table1 
WHERE Name='ABC' OR Party<>'IND';
"
14676,64519,SQL complicated select statement,"select g.*
from group g join
     user u
     on g.ownerid = id
where g.name <> u.group;
"
3218,67727,How to find number of observations in postgresql tables,"SELECT reltuples, relpages FROM pg_class WHERE oid = 'table_name'::regclass
"
24489,27664,SQL Server : selecting TOP Records and updating results in another table,"Select
   U.User, Max(L.LogOnDate)
   From Users U
   Join Login L On L.User = U.User
"
7614,21352,"Select query result based on the difference of a ""quantity"" in same column of two tables","select course_id, course_name
from table2
where course_id not in (select course_id from table1)
"
4663,56053,Visual Studio 2010 Design SQL automatically creates alias,"Tools -> Options -> Text Editor -> Transact-SQL -> IntelliSense
"
11738,14463,Backup SQL DB with query and name according to date,"

DECLARE @SQLStatement VARCHAR(2000) 
SET @SQLStatement = N'D:\SQL backups\SERVER1\MYDB-' + CONVERT(nvarchar(30), GETDATE(), 110) +'.bak' 
BACKUP DATABASE [MYDB] TO  DISK = @SQLStatement"
23607,15897,How can I normalize data field in Access that has comma delimited values,"1. Created a Header table that stores all the ""Header Data"", in your case ProdID,Value

2. Created a table containing ""Detail Data"" in your case ProdID,RowNo,Color

3. Insert all Row's ProdID into Header Table
4. Split the values in  the field Color based on index of (,)Comma. For each Substring insert a row into Detail table with ProdID,RowNo,Substring as color.
"
33745,56034,Pivot on joined tables SQL Server,"select t.id1, t.id2, t.a, t.b, 
    max(case when t2.name = 'C1' then t2.vint end) c1,
    max(case when t2.name = 'C2' then t2.vstring end) c2,
    max(case when t2.name = 'C3' then t2.vdata end) c3
from tab1 t
    left join tab2 t2 on t.id1 = t2.id1 and t.id2 = t2.id2 
group by t.id1, t.id2, t.a, t.b
"
38860,30540,I need to create a SQLite table,"CREATE TABLE Readings (
    SITE_ID TEXT UNIQUE REFERENCES SiteData 
    , LOOP_NBR TEXT
    , LOOP_CLOSED BINARY
    , SEQ INTEGER
    , STA TEXT UNIQUE
    , BS TEXT
    , FS TEXT
    , HI TEXT
    , DESC TEXT
 )
"
32468,60747,How to return one single row from groupped by columns,"SELECT TIN, 
SUM(case when Specified=0 then 1 else 0 end) as ZeroSpecified,
SUM(case when Specified<>0 then 1 else 0 end) as NOTZEROSpecified
FROM table
GROUP BY TIN
"
22096,29470,Are these two statements equivalent? (from NerdDinner tutorial),"// Extension method syntax
return from party in entities.Parties
       where party.PartyDate > DateTime.Now
       orderby party.PartyDate
       select party;

// Query expression
return entities.Parties
               .Where(party => party.PartyDate > DateTime.Now)
               .OrderBy(party => party.PartyDate);
"
3863,17699,Difference between sql statements and clause,"SELECT foo FROM bar JOIN quux WHERE x = y;
"
26486,17707,Firebird search and find a string value in all columns,"sqlCommand = 'select * from '|| upper( :TBLNAME );

/* Rest of your code for creating the sqlCommand variable */

viewCommand = ""RECREATE VIEW V_SEARCH_RESULTS AS "" || sqlCommand;

EXECUTE STATEMENT viewCommand;
"
4609,71027,Converting float to decimal in SQL Server 2008,"DECLARE @var FLOAT = 100
SELECT  CAST(@var as decimal(20,12))
"
8718,42111,How to change date format in hive?,"select from_unixtime(unix_timestamp('2016/06/01','yyyy/MM/dd'),'yyyy-MM-dd') from table1; 
"
38156,74253,A conditional JOIN depending on whether the foreign key is NULL?,"SELECT P.personID, P.Name, IFNULL(O.Name, 'None') OrgName
FROM PEOPLE P 
LEFT OUTER JOIN ORGs O ON P.orgID = O.OrgID 
"
20200,38648,How to map a string to a table column in MS Access?,"SELECT ID,
    IIf([Status]='full', True, False) AS [full],
    IIf([Status]='part', True, False) AS [part],
    IIf([Status]='expire', True, False) AS [expire]
FROM Table1
"
21662,9536,Query filtering,"SELECT
    avg(age) avg_age,
    avg(case when gender = 'M' then age end) male_avg_age,
    avg(case when gender = 'F' then age end) female_avg_age
FROM users;
"
7859,44006,How do I add multiple fields in the same row in SQL (ms Access)?,"SQL = ""INSERT INTO tblProviders (Provider, Adress) VALUES ('"" & _
         Me.txtProvider & ""', '"" & Me.txtAdress & ""')""  
'print the result for control
debug.Print SQL  
"
6002,33454,How to get Unique CID and Avatar from this table,"with x as 
(select row_number() over(partition by s1CIDNumber order by Suevey_DT) as rn, *
 from [dbSuppHousing].[dbo].[tblSurvey])
select x.* --add any other columns from tblusers as needed
from x join tblUsers t 
on t.loginname = x.loginname
where x.rn = 1
"
17379,73741,Working of MySQL Query,"SELECT * MyTable 
where Column1 not in (5, 8, 12)
and Column2 <> 300 
and Column3 = 200;
"
36353,20779,SQL Server Geography (Spartial) finding gaps between instances,"select EnvelopeAggreate([Geo]).STDifference( UnionAggregate([Geo]) )
from #temp
"
26164,58407,Counting the number of child records in a one-to-many relationship with SQL only,"select file_id, count(*)
  from data
 group by file_id
"
3804,60222,inserting data from primary key to foreign key,"UPDATE smite s 
JOIN smitetournaments st 
  ON s.tournament=st.tname 
SET s.ID=st.ID
"
12501,5001,"Get hierarchy from ""parent linked"" database","with recursive group_tree as (
  select id_group, 
         id_parent, 
         sequence
  from groups
  where id_parent = 0 -- marks the start of your tree
  union all
  select c.id_group, 
         c.id_parent,
         c.sequence
  from groups p
    join group_tree c on p.id_group = c.id_parent
) 
select *
from group_tree;
"
38885,47789,Return if more than x day of the week,"select customernumber, date, sum(transactionvalue) as transaction_amt
from transactions   
where date >= '2015-01-01' and date < '2015-07-01'
    and datename(weekday, date) = 'Sunday'
and customernumber in (
  select customernumber
  from transactions  
  where date >= '2015-01-01' and date < '2015-07-01'
      and datename(weekday, date) = 'Sunday'
  group by customernumber
  having count(distinct date) >= 3
)    
group by customernumber, date
"
23087,28778,Populating SQLiteDB with initial values,"INSERT INTO mytable (column_a, column_b)
VALUES (val_1, val2), (val_3, val_4), etc
"
34029,52859,SQL Am I using this join correctly?,"SELECT i.dept_name, COUNT(a.s_id)
FROM Instructor i
    LEFT JOIN advisor a ON i.id = a.i_id
GROUP BY i.dept_name;
"
11781,34323,"SQL - Get records from one table that aren't ""LIKE"" in another table","select pr.*
  from products pr
  left join posts po
    on post_title like concat('%', pr.model, '%')
 where post_title is null
"
28848,69294,Group values by month in Access,"SELECT Format([Mese],""mmmm"") + "" "" + Format([Mese],""yyyy"") AS [Date], Sum(Manodopera.Costo_Totale) AS SumOfCosto_Totale
FROM Manodopera
GROUP BY Format([Mese],""mmmm"")+"" ""+Format([Mese],""yyyy"");
"
34886,19951,check result from prepared statements PDO?,"$queryUP = $pdo->prepare(""SELECT * FROM unitprices WHERE id_quot = ?"");
$queryUP->execute(array($idQuotation));

//here you go
$results = $queryUP->fetchAll();

if ($results) { 
   // foreach($results as $rowup) {
      //...
   // }
} else {
   // do another thing
}
"
17274,22896,"Calculate difference between 2 epoch times, large table, optimize having 3 indexes","    SELECT
      FrameNumber,
      case when FlowID <> @currflow or Direction <> @currdir then @diff := 0 else @diff := FrameTimeEpoch - @epoch end as TimeFromLastPacketFromSameDirection
      , @currflow := FlowID, @currdir := Direction, @diff, @epoch := FrameTimeEpoch
    FROM
      packetsbydirection, (select @epoch := 0, @currflow :="""", @currdir := """", @diff := 0) as tmp
    ORDER BY FlowID, Direction, FrameTimeEpoch 
"
1774,71357,null values in mySQL,"ALTER TABLE `table` ALTER `field` SET DEFAULT 'value'
"
39188,24278,Is it possible to use the same table twice in a select query?,"1 1
1 2
1 3
2 1
2 2
2 3
3 1
3 2
3 3
"
4702,6010,"SQL, using data from a number of separate tables to receive an output","select b.Title
from Book b join
     Author a
     on b.BookID = a.BookID join
     Writer w
     on w.AuthId = a.AuthId join
     Publisher p
     on w.PubId = p.PubId
where p.Country like 'Australia'
group by b.Title, b.BookID
having count(*) >= 2;
"
30631,75463,SQL query to group by month part of timestamp,"SELECT month('TIMESTAMP'), SUM( electricity ) AS electricity,  `siteID` 
FROM table
WHERE (
MONTH(  `TimeStamp` ) =10)
GROUP BY siteID, month('TIMESTAMP')
"
39703,4349,SQL Query to fetch all the tasks where Level 0 is C but all the other levels(if any) are in W,"SELECT TaskID
FROM tasks_tbl
GROUP BY TaskID
HAVING MAX(CASE WHEN Level = 0 AND Status = 'C' THEN 1 ELSE 0 END) = 1
AND MAX(CASE WHEN Level > 0 AND Status <> 'W' THEN 1 ELSE 0 END) = 0
"
35028,44862,How do I select columns which has a dot in their column names,"SELECT   * 
FROM     Users 
WHERE    `local.email` = 'burgundy@email.com' 
LIMIT    1
"
5716,14419,SQLite Update Syntax for string concatenation?,"UPDATE TestTable SET description = 'desc of ' || name;
"
12335,57013,MySQL: select first element of a comma-separated list,"SELECT SUBSTRING_INDEX(field, ',', 1)
"
13584,38457,Sum With Inner Join Group by Clause,"select
    CONVERT(varchar,BillDate,103) as BillDate,
    SUM(cash)as ByCash
from    (
        select *,
            row_number() over(partition by MasterID order by ChildID) dedupe
        from childdetails
        ) CD inner join MasterDetails MD on MD.ID=CD.MasterID
where
    CONVERT(varchar,BillDate,103)='22/02/2014'
    and CD.dedupe = 1
group by BillDate
"
24680,4795,How to extract sql dump from mdf file which is attached to SQL Server management studio?,"Tasks -> Generate Scripts
"
38353,60644,How to write the SQL for the following problem?,"select * from MyTable where col2 in
(
select col2
from MyTable
group by col2
having count(*) > 1
) x
"
27218,12689,Difficulty with an SQL query,"SELECT s.uid, s.pid, s.subts
FROM submissions s,
   (SELECT max(subts) as maxdate, pid
     FROM submissions
     GROUP BY pid) maxresults
WHERE s.pid = maxresults.pid
AND s.subts = maxresults.maxdate;
"
26796,30741,SQL - year to date,"... WHERE sDate => '2011-01-01'
"
17180,9609,sql stored procedure convert code to text in string with a raw of codes,"declare @text varchar(50) = '1,2,3,4,5'

;with cte as 
(
    select @text list
) 
select 
(
    select ', '+c.name
    from codes c
    where ','+t1.list+',' like '%,'+cast(c.ID as varchar(10))+',%'
    for xml path(''), type
).value('substring(text()[1], 3)', 'varchar(max)') as NewList
from cte t1
"
6028,72569,Teradata Correlated subquery,"SELECT t.*,
   MIN(amount) -- previous amount
   OVER (PARTITION BY Id
         ORDER BY date_valuation, dafms DESC
         ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING) AS prev_amount,
   MIN(date_valuation) -- previous date
   OVER (PARTITION BY Id
         ORDER BY date_valuation, dafms DESC
         ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING) AS prev_date
FROM test5 AS t
QUALIFY cesitc = '1' -- return only the current row
"
18555,68361,"In SQL, how can I split the values in a bitmask total into a comma delimited string","declare @I integer = 2117

Declare @v varChar(32) = ''
Declare @Bit tinyInt = 0
while @I > 0 Begin
Set @v += case @I %2 WHen 1 Then str(@bit,2,1) + ',' else '' End 
Set @Bit += 1
Set @i /= 2
End
Select case  When len(@v) > 0 Then left(@v, len(@v) -1) else '' End
"
4025,35831,SQL Server 2005 One query to calculation two table,"Select pf.ID as PatientFileID,
    os.TotalOtherServices,
    pd.TotalDeposit
From PatientFiles pf
    Left Join
 (Select Patient_File_ID as PatientfileID, SUM(os.Quantum * os.Price) AS TotalOtherServices
  From OtherServices Group By Patient_File_ID) os on pf.PatientFileID = os.PatientFileID
    Left Join
 (Select Patient_File_ID AS PatientFileID, SUM(Deposit) AS TotalPatientDeposit
  From PatientsDeposits Group By Patient_File_ID) pd on pf.PatientFileID = pd.PatientFileID
"
24201,33596,Simplify and/or optimize sql query with INTERSECT or HAVING,"SELECT DISTINCT taggable_id
FROM   taggings t1
JOIN   taggings t2 USING (taggable_id)
JOIN   taggings t3 USING (taggable_id)
WHERE  t1.tag_id = 1
AND    t2.tag_id = 6
AND    t3.tag_id IN (2, 8);
"
19084,54781,How can I COUNT rows from another table using a SELECT statement when joining?,"SELECT
Reports.ReportID,
EmployeeADcontext,
ReportName,
CreatedDate,
COUNT(Expenses.ExpID) AS ExpCount,
ReportTotal,
Status

FROM
[dbo].[Reports]
INNER JOIN
[dbo].[Expenses]
ON 
[dbo].[Expenses].ReportID = [dbo].[Reports].ReportID

WHERE EmployeeADcontext = @rptEmployeeADcontext

GROUP BY  Reports.ReportID, EmployeeADcontext, ReportName, CreatedDate, 
          ReportTotal,  Status
"
17083,4454,Partitioning SQL query by arbitrary number of rows,"SET @seq = 0;

SELECT SUM(data), ts FROM (
    SELECT @seq := @seq + 1 AS seq, data, ts FROM table ORDER BY ts LIMIT 50
) AS tmp GROUP BY floor(tmp.seq / 3);
"
28580,23344,How can i groupBy using multiple column name?,"   select...
    from (
    select { beauty,general-health,pregnency } as health
    from table) t
    group by health
"
18441,44261,Sql script to eliminate data duplication,"select v = col1 from table1
union select col2 from table1
union select col3 from table1
union select col4 from table2
"
16455,29701,SUM specific set of values in SQL,"Select q.name, sum(q.value) 
from (YOUR_SELECT_QUERY) q
group by q.name
"
28061,9975,How to return dynamic columns from grouped values in SQL Server (Stored Procedure),"select p.[Date], ISNULL([1],0)[Activity1], ISNULL([2],0)[Activity2], ISNULL([3],0)[Activity3], ISNULL([4],0)[Activity4], ISNULL([5],0)[Activity5], ISNULL([6],0)[Activity6] 
FROM
(
    SELECT CONVERT(date, [Date]) [Date], ActivityId, COUNT(*) Total
    from Activity
    group by convert(date, [Date]), ActivityId

) AS Tb

PIVOT
(
    SUM(Total)
    FOR ActivityId IN ([1],[2],[3],[4],[5],[6])
) p
order by convert(date, p.[Date])
"
15819,31781,MySQL - nested select statement for JOIN?,"SELECT *
FROM
(
    SELECT meter_id, supplier, MAX(end_date) end_date
    FROM contract 
    GROUP BY meter_id, supplier
) a
JOIN contract c ON c.meter_id = a.meter_id AND a.end_date = c.end_date
JOIN meter m ON m.meter-id = c.meter_id
JOIN invoice i ON i.contract_id = c.id
"
29022,1170,SQL: select N “most recent” rows in ascending order,"SELECT timestamp, message
FROM
(
     SELECT *
     FROM your_table
     ORDER BY timestamp DESC
     LIMIT 3 
) T1
ORDER BY timestamp
"
11217,47728,MYSQL - Update values of new column based on condition,"UPDATE table 
SET image_result = CASE 
    WHEN image_status = 0 OR image_status = 3 THEN 'Pass' 
    WHEN image_status = 1 OR image_status = 4 THEN 'Warm' 
    ELSE 'Fail' 
END 
"
35245,68657,Missing addwithvalue from dbcommand.parameters,"static class MyExtensions
    {
        public static void AddParameterWithValue(this DbCommand command, string parameterName, object parameterValue)
        {
            var parameter = command.CreateParameter();
            parameter.ParameterName = parameterName;
            parameter.Value = parameterValue;
            command.Parameters.Add(parameter);
        }
    }
"
484,50054,JPA -- named-query vs query,"Query query = entityManager.createQuery("" SELECT u FROM Users u"");
"
27794,59225,Need help working out update statement with 2 criteria,"update c
    set d_userid = cu.d_userid
    from contact c join
         contactuser cu
         on c.userid = cu.userid and c.systemcode = cu.systemcode;
"
22854,13474,SQL: Select new columns based on group order,"select 
    *, 
    case when date = MIN(date) over (partition by groupid order by groupid) then 'TRUE' else 'FALSE' end isFirst,
    case when date = MAX(date) over (partition by groupid order by groupid) then 'TRUE' else 'FALSE' end isLast,
    count(*) over (partition by groupid order by groupid) Channelsingroup,
    datediff(day,date,MAX(date) over (partition by groupid order by groupid)) Daysbeforelast
from your_table
"
23903,27444,"In SQL, how do I get the row with the maximum value for a particular column?","SELECT COUNT(*) as votes, a.member_id 
FROM ballots a
WHERE ballot_id = 1
GROUP BY a.member_id
ORDER BY votes DESC
LIMIT 1
"
4195,15771,"If I have two tables in SQL with a many-many relationship, do I need to create an additional table?"," item_id     (Foreign Key)
 category_id (Foreign Key)
"
7286,62433,Using cursors sql?,"INSERT INTO DestinationTable
SELECT CompanyID, SomeDataColumn
FROM SourceTable
WHERE ISNULL(CompanyID, 0) = 0
"
10718,3991,SQL debug print,"IF @debug = 1
BEGIN
print 'Something'
--or insert into a log table if you need the rows of a temp table 
--or the results of a calculation
END
"
13914,71947,Insert from Select except specific column(s) in Oracle,"insert into yourTable (col1, col2, col3)
select col1, col2, 'diffValue'
  from someTable
 where SomePK = SomeVal;
"
13352,70703,Selecting all the similar MAX values derived from COUNT(),"SELECT Country, COUNT(Name) as People
FROM Citizen 
GROUP BY Country
HAVING COUNT(Name) = (select max(cnt)
                      from (select COUNT(Name) as cnt
                            from Citizen
                            group by Country
                           ) c
                     );
"
37939,12547,sql group by value within substring of char(255) field," select 
 substring_index(substring_index(str,'/',4),'/',-1) as val,
 count(*)  as `count`
 from table
 group by val
"
28942,34048,Write a query that pulls all fields from a table that has date in it,"select column_name
from information_schema.columns
where table_name = 'yourTableName'
and data_type like '%date%'
"
38932,31950,Hibernate: Refrain update on Many-to-Many insert,"CompanyBranch cb1 = entityManager.getReference(CompanyBranch.class, 1);
"
21710,58812,convert word to ascii and return to word adding some value,"SQL> WITH data AS
  2    (SELECT 'admin' str FROM dual
  3    )
  4  SELECT str, LISTAGG(CHR(ASCII(REGEXP_SUBSTR(str, '\w', 1, LEVEL)) + 2), '') WITHIN GROUP(
  5  ORDER BY LEVEL) str_new
  6  FROM data
  7    CONNECT BY LEVEL <= LENGTH(str)
  8  /

STR    STR_NEW
------ -------
admin  cfokp

SQL>
"
1982,57482,How should I represent a unique super-admin privilege in a database?,"select user_id from users
where TimestampWhenMadeSuperAdmin is not null
order by TimestampWhenMadeSuperAdmin desc
fetch first 1 row only;
"
24485,49058,Unpivot with varying number of columns,"select AccountName, Brand, Sales
from yourtable
cross apply
(
  values
    ('Coke', BrandCoke, SalesCoke),
    ('Pepsi', BrandPepsi, SalesPepsi),
    ('Diet', BrandDiet, SalesDiet)
) c (Brand, origCol, Sales)
where origCol is not null;
"
11358,67581,SQL Pivot Problem - multiple aggregates?,"select * 
from Example
unpivot 
(
numbers 
for type in (x,y,z)
) as p
pivot 
(
Max(numbers)
for site in ([A],[B],[C])
) as q
"
26039,57112,retrieve data from movie database,"select max(c.character_name) character_name,
       max(a.name) || ' ' || max(a.surname) actor,
       group_concat(distinct m.title) other_movies
from cast c
join actors a on c.actor_id = a.actor_id
left join cast omc on c.actor_id = omc.actor_id and c.movie_id <> omc.movie_id
left join movies m on omc.movie_id = m.movie_id
where c.movie_id = ?
group by a.actor_id
"
33105,42164,SQL convert multi level xml with attribute into table,"  SELECT 
    Tbl.Col.value('../@ItemID', 'nvarchar(16)') as [ItemID],  
    Tbl.Col.value('@ObjID', 'nvarchar(16)') as [ObjID]   
  FROM 
    @x.nodes('root/items/item/obj') Tbl(Col);
"
38571,67407,Add clients with same name and add it to a different table,"INSERT INTO Table2
   SELECT CUSIP, [DESC], SUM(QUANTITY) AS QUANTITY
   FROM Table1
   GROUP BY CUSIP, [DESC]
"
37504,71513,combining two case queries into one,"SELECT i, 
CASE 
WHEN ((MONTH(CURRENT_DATE )) = SUBSTRING(yearmonth,6))THEN 
  CASE
      WHEN DAY(CURRENT_DATE) = 1 THEN `day1_value`
      WHEN DAY(CURRENT_DATE) = 2 THEN `day1_value`
  END 
END Y
FROM dp;
"
12071,24568,Converted Pages in Books,"select * from Book as b
where not exists
 ( select * from BookPage as bp
   where b.Id = bp.BookId
     and bp.Text is null
 )
"
16306,61237,"MySQL ""fill up"" missing values in histogram","CREATE TABLE ranks
SELECT 0 rank, 20 count
    UNION ALL
SELECT 1 rank, 15 count
    UNION ALL
SELECT 2 rank, 9 count
    UNION ALL
SELECT 6 rank, 3 count
    UNION ALL
SELECT 9 rank, 2 count;

SET @VCounter := -1;

SELECT A.rank, B.count FROM
    (SELECT @VCounter := @VCounter + 1 rank FROM anyTable WHERE @VCounter < 10) A
LEFT JOIN
    ranks B
ON A.rank = B.rank
ORDER BY A.rank;
"
30305,48901,MySQL GROUP_CONCAT + IN() = missing data :-(,"SELECT box.boxID
     , box.color
     , GROUP_CONCAT(DISTINCT boxHas.has SEPARATOR "", "") AS contents
  FROM box
  LEFT JOIN boxHas 
    ON box.boxID=boxHas.boxID
 GROUP BY box.boxID
HAVING SUM(boxHas.has IN ('apple','pear')) >= 2
 ORDER BY box.boxID
"
36017,33177,How to loop from one column cell to another cell in SQL,"<?php
    $query = ""SELECT dateCol from table"";
    $result = $mysqli->query( $query );
    while ($row = $result->fetch_assoc()){
        echo $row[""dateCol""];
    } 
?>
"
16563,48454,set different limit on each tables in SQL,"SELECT *
FROM (SELECT number
      FROM menu
      WHERE user_id = 1
      ORDER BY id
      LIMIT 3) AS number,
JOIN (SELECT *
      FROM users
      WHERE id = 1
      LIMIT 1) AS users
"
28255,1153,Querying a hierarchical table,"SELECT s.class, rec.class
FROM SchoolClass s
INNER JOIN SchoolClass req on s.id_class=req.id_class_req
WHERE SchoolClass.id_cours_prerequis Is Not Null;
"
2183,38730,How to do a insert or replace when the primary key will not be used,"CREATE TABLE test (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  uuid UUID UNIQUE NOT NULL
);
"
12481,67561,Creating Dynamic Column Names from Dynamic Row Number,"SELECT RecId
  , GroupedDataId
  , AnswerText
  , Question = 'ROLE' + CAST(ROW_NUMBER() OVER (partition by RecId
                                                 order by RecId, GroupedDataId) AS VARCHAR(max)) 
FROM example;
"
21538,19778,SQL- Adding a condition,"SELECT CHARTER.CUS_CODE,
       CHARTER.DESTINATION ""AIRPORT"",
       CHARTER.CHAR_DATE,
       CHARTER.CHAR_DISTANCE,
       CHARTER.AC_NUMBER
  FROM CHARTER
 WHERE DESTINATION = 'BNA';
"
11978,56017,Remove subquery from JOIN?,"SELECT
   Previous.NAV as PreviousNAV,
   Todays.NAV as TodaysNav,
   ISNULL((Todays.NAV-Previous.NAV),0) NetChange,
   ISNULL((Todays.NAV-Previous.NAV) / Todays.NAV,0) BAMLIndex
FROM
    Fireball..NAV as Previous
JOIN
    Fireball..NAV as Todays
    ON Previous.portfolioID = Todays.PortfolioID
WHERE Previous.Date BETWEEN @StartDate AND @EndDate 
    AND Previous.PortfolioId = @PortfolioId
    AND Todays.Date = @EndDate
"
10170,44189,Tables join using mapping table,"select t1.id, t3.id
from table1 t1
full outer join mapping t2 on( t1.col2= t2.col1)
full outer join table3 t3 on(t1.year = t3.year and t2.col2 = t3.col2
"
8664,34915,Update based on hierarchy table,";With OrgChart as        
(        
  SELECT id,id as BaseID
  FROM employee WHERE Active=1
  UNION ALL 
  SELECT e.ID, g.BaseID as BaseID         
  FROM employee e 
  JOIN OrgChart g on e.supervisorid=g.id
  WHERE e.Active=0
), ForUpd as
(SELECT ID,BASEID FROM OrgChart WHERE ID<>BAseID)

 UPDATE A SET empid = B.baseID
 FROM component A
 JOIN ForUpd B ON A.empid = B.id
"
21575,19768,SQL Server multiple values in where clause,"SELECT invoicenumber,
       name,
       count
FROM   (SELECT invoicenumber,
               name,
               Count(1) AS count
        FROM   TABLE1
        GROUP  BY invoicenumber,
                  name)
WHERE  count = 2; 
"
16798,24848,SQL efficiently check if an association exists?,"SELECT EXISTS (SELECT 1 FROM NOTES_IN_NOTES n2 WHERE n2.parent_note_id = n0._id) as Has_Subnotes, n0._id, n0.title, n0.details
FROM NOTES n0
INNER JOIN NOTES_IN_LISTS n1 ON n0._id = n1.note_id
WHERE n1.listId = 12
COLLATE NOCASE
"
11723,25508,Combining 2 queries into 1 query,"SELECT b.oprid 
FROM   ps_z_emp_benft a, 
       psoprdefn b, 
       ps_z_emp_yan c 
WHERE  a.emplid = b.emplid 
       AND a.emplid = c.emplid 
       AND A.z_pend_cover = 'Y' 
       AND oprid LIKE 'ZZ%' 
       AND c.z_yan_action_id = 1 
"
36404,6155,mysql inverse text search from two tables,"select keyword from A where keyword not in
   (select A.keyword from A
    inner join B on A.keyword like '%' + B.keyword + '%')
"
630,73037,SQL row to column transposing,"select t.Column1,
       (select column2 from t t2 where t2.column1 = 'Customer' and t2.id <= t.id order by t2.id desc limit 1
       ) as customer,
       (select column2 from t t2 where t2.column1 = 'Account' and t2.id <= t.id order by t2.id desc limit 1
       ) as transaction,
from t
where t.column1= 'Transaction'
"
39034,71318,MS Access VBA - Using SELECT INTO to create a new table and add a record," Dim strSQL As String
 Dim NewTableName As String

 NewTableName = ""[Process Order-Oven "" & Format(Date, ""DD-MM-YYYY"") & ""]""

 strSQL = ""SELECT [Run No], [Product ID], [Process No], [Product Description], "" & _
          ""[Good Product Produced] INTO "" & NewTableName & _
          "" FROM [Process Order] WHERE [Process No] = "" & txtProc

 CurrentDb.Execute strSQL, dbFailOnError
"
28599,8370,SQL Query to find linked records in a single table,"SELECT  *
FROM    CustomerTable C
JOIN    CustomerTable P ON P.ID = C.LinkedID
WHERE   P.Customer = 'A'
"
2905,55226,How can I store an m:m realtionship into a database?,"Person (PersonId)
Language (LanguageId)
Person_Languages (Id,PersonId,LanguageId)
"
16003,59952,Table Storage in Objective-C with cocoa touch,"<bonuses>
    <bonus name=""nameOfBonus1"" value=""30""/>
    <bonus name=""nameOfBonus2"" value=""12""/>
</bonuses>
"
26320,18700,SQL Server Sum rows with string value,"SELECT
     CASE WHEN ISNUMERIC(col1) = 1 THEN CAST(col1 as INT) ELSE 0 END
   + CASE WHEN ISNUMERIC(col2) = 1 THEN CAST(col2 as INT) ELSE 0 END
   + CASE WHEN ISNUMERIC(col3) = 1 THEN CAST(col3 as INT) ELSE 0 END
   + CASE WHEN ISNUMERIC(col4) = 1 THEN CAST(col4 as INT) ELSE 0 END
   + CASE WHEN ISNUMERIC(col5) = 1 THEN CAST(col5 as INT) ELSE 0 END as SumValue
FROM MyTable
"
27361,46273,Combining two rows to a single row,"--PREVIOUSRESULT will be your existing result.

SELECT A.EMPLOYEENO, A.NAME, A.CURRENTFLAG, 
   (SELECT B.LOCATION FROM PREVIOUSRESULT B
    WHERE B.EMPLOYEENO = A.EMPLOYEENO AND B.CURRENTFLAG IS NULL) AS FROMVALUE, 
    A.Location AS ToValue, A.TRANSFERDATE AS EFFECTIVEDATE 
 FROM PREVIOUSRESULT A 
 WHERE A.CURRENTFLAG = 'Y'
"
8866,37933,Figuring out a join between two users excluding where column does not exist for one," SELECT * FROM user_answers t1
 where t1.uid=1 and t1.quid in 
 (select t2.quid from user_answers t2 where t2.uid=2);
"
8174,50683,Re Increment the Primary Column after deletion of the record in table in Sql?,"UPDATE dbo.table 
    SET splr_Slno=splr_Slno-1 
WHERE 
splr_Slno> @splr_Slno AND splr_Id= @Splr_Id
"
16428,12355,Copy a table to another table with different structure,"insert into table1 (col1, col2, col3)
select cast(col1 as signed), col5, col7
from Table1_Temp
"
958,43013,count Query in sql,"SELECT a.Category_Name, COUNT(b.Incident_Id) Number_of_Faults
FROM MainCategory a JOIN Incident b
ON a.Category_id = b.Category_id
GROUP BY a.Category_Name
"
21351,67150,How to use case statement in where clause,"declare @code nvarchar(20) = 'C'

SELECT *
FROM table1
WHERE (@code = 'C' AND value in ('A', 'B', 'C'))
OR (@code = 'E' AND value in ('D', 'E'))
"
15739,45001,select date diff from varchar,"select getdate(), DateString 
---,  getdate()- DateString as DateDiff
, DATEDIFF(DAY,  DateString, getdate())
from dbo.DateChk
"
16894,36587,Multiple Date Ranges for an Employee,"select id, min(date) as startdate, max(date) as enddate
from (select t.*,
             (row_number() over (partition by id order by date) -
              row_number() over (partition by id, ischanged order by date)
             ) as grp
      from table t 
     ) t
where ischanged = 1
group by id, grp;
"
16408,20898,return true if all the the records of first table exists in second table,"SELECT CASE 
         WHEN EXISTS (SELECT id 
                      FROM   @t1 
                      EXCEPT 
                      SELECT id 
                      FROM   @t2) THEN 0 
         ELSE 1 
       END 
"
30583,58029,update column of table with other column,"UPDATE A SET A.col2 = B.col2
FROM TableA A INNER JOIN TableB B ON A.col1 = B.col1 
"
35101,36165,Ruby on rails count and group,"SELECT i.product_id
      ,p.name
      ,sum(i.quantity) AS sum_quantity
FROM   orders o
JOIN   items i ON i.order_id = o.id 
LEFT   JOIN product p USING (product_id)
WHERE  o.client_id = 2 
GROUP  BY 1,2
ORDER  BY 3 DESC, 2 -- with same quantity, order by name
LIMIT  10;
"
26797,18384,Why does x+NULL result in NULL?,"select col1, isNull(col2,0) + isNull(col3,0) as total
from table
"
38754,23550,SQL left joining tables with ambiguous column names,"SELECT L.Title Listing_Title, LC.Title ListingCategory_Title,
       ... all your other columns ...
FROM ListingCategory_Listings LCL
LEFT JOIN Listing L ON LCL.ListingID = L.ID 
LEFT JOIN SiteTree_Live STL ON L.ID = STL.ID 
LEFT JOIN ListingCategory LC ON LCL.ListingCategoryID = LC.ID 
LEFT JOIN File F ON LC.IconID = F.ID
"
39887,51974,Mysql Select statement to and convert timestamp on the fly,"mysql> SELECT STR_TO_DATE('20/10/2014 05:39 PM', '%d/%m/%Y %h:%i %p');
+---------------------------------------------------------+
| STR_TO_DATE('20/10/2014 05:39 PM', '%d/%m/%Y %h:%i %p') |
+---------------------------------------------------------+
| 2014-10-20 17:39:00                                     |
+---------------------------------------------------------+
"
20964,35209,How to enable the record for delete after retrieve in sqlite?,"row.setTag(counter);  //  use counter or index for tag, so you can get the data from LocWiseProfile later
row.setOnClickListener(new OnClickListener()  {
    @Override
    public void onClick(View v)  {
        int tag = (Integer)view.getTag();
        LocWiseProfileBeans cn = LocWiseProfile.get(tag);
        //  Perform delete action here
        //  ...
    }   
});
"
21330,53552,What host name in different database?,"mysql> show variables like 'hostname';
"
37407,1000,SQL query to compare rows,"select * from 
   (select T1.Sequence as S1, T2.Sequence as S2, T1.ID 
    from T as T1, T as T2
    where T1.Sequence < T2.Sequence 
      and T1.Date > T2.Date 
      and T1.ID = T2.ID) Subq
   inner join T on (T.ID = Subq.ID 
               and (T.Sequence = Subq.S1 or T.Sequence = Subq.S2))
"
12157,14574,SQL query to select people interviewed more than once in a year,"SELECT P.ID
      ,Name
      ,Number
      ,Location
      ,InterviewNo
  FROM Person P 
       INNER JOIN 
       (SELECT ID
              ,COUNT(1) AS InterviewNo
          FROM Interview 
         WHERE Year(InterviewDate) = 2013
         GROUP BY ID
        HAVING COUNT(1)> 1) I ON P.ID=I.ID
"
29936,50361,SQL count with some conditions," SELECT Initialdate, OriginalTime, Gate1, 
      Destindate, DestinationTime, Gate2, 
      COUNT(1) as Freq
 FROM TABLE1
 GROUP BY Initialdate, OriginalTime, Gate1, 
      Destindate, DestinationTime, Gate2
"
18,4238,SQL query optimalization: removing the inner select,"SELECT COUNT(*)
FROM (
  SELECT p.prod_id,  p.prod_list_price, avg(c.unit_cost) avg_cost
  FROM products p inner join costs c
   ON c.prod_id = p.prod_id
  GROUP BY p.prod_id, p.prod_list_price
) 
WHERE prod_list_price < 1.15 * avg_cost
"
39977,17013,Subtracting output of 2 SQL queries,"SELECT first_name, last_name 
FROM users 
WHERE rating <> '6'
AND users.id
NOT IN (SELECT DISTINCT first_name, last_name 
             FROM users 
             JOIN mp_positions 
             ON users.id=mp_positions.user_id 
             JOIN mps ON mps.id=mp_positions.mp_id 
             WHERE mps.status_id = '5'
);
"
1043,13686,SQL 2012 User Permissions Possibilities,"alter role db_datareader add member MyWebUser;
alter role db_datawriter add member MyWebUser;
deny select, insert, update, delete on schema::Storage to MyWebUser;
"
13997,60471,Why can't convert DateTime to String when concat,"'my foo' + convert(varchar(12), @foo, 120)
"
7543,45635,Mysql conditional count with group by in where clause,"HAVING COUNT(CASE WHEN to_user_id = 10 THEN 1 END) > 0
"
19300,38649,Merge data from two tables into single column of another table,"INSERT INTO C (Col1)
(
    SELECT Col1 from A
UNION ALL
    SELECT Col1 from B
)
"
8748,20333,Why does LIKE '%%' depend on irrelative joins?,"SELECT *
FROM
(
  SELECT ... FROM mytable t
  LEFT OUTER JOIN mytable2 t2 ON t2.attr = t.attr1
  LEFT OUTER JOIN mytable3 t3 ON t3.attr = t.attr3
  ...
  LEFT OUTER JOIN mytableN tN ON tN.attr = t.attrN
)
WHERE tK_attrP LIKE '%Something%';
"
6249,4412,HTML5 readTransaction not supported on iPad (iOS 3.2)?,"Mozilla/5.0 (iPad; U; CPU OS 3_2 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Version/4.0.4 Mobile/7B334b Safari/531.21.10
"
34623,20031,sqlite 3 sum with inner join returns twice the value it should,"SELECT DISTINCT SPECIES.SPECIES,S.COUNT
FROM SPECIES 
INNER JOIN
(
    SELECT SUM(KILLCOUNT) AS COUNT,TRIP_DATA.SPECIES
    FROM TRIP_DATA
    WHERE TRIPID=""+tripid+"" AND NOT TRIP_DATA.SPECIES =0 
    GROUP BY TRIP_DATA.SPECIES
)S
ON SPECIES.SPECIESIDNO=S.SPECIES
"
1032,7900,SQL Multiple Entry Syntax,"SELECT col1, col2
FROM theTable
GROUP BY col1, col2
HAVING COUNT(*) > 1
"
24742,38291,Display row or NULL in SQL query,"SELECT  registration.firstName, 
        registration.lastName, 
        registration.phone, 
        experience.options, 
        additionalInfo.workshops
FROM    registration
        INNER JOIN experience
            ON registration.identifier = experience.identifier
        LEFT JOIN additionalInfo
            ON additionalInfo.identifier = registration.identifier
WHERE   experience.paid = 'Yes' AND 
        registration.eventName = 'march2013'
ORDER   BY registration.lastName ASC
"
38927,37430,select query with Not IN keyword,"Select *
from tbPatientEncounter pe 
where pe.EncounterIDP not in (Select v.EncounterIDF
                              from tbVoucher v
                              where v.EncounterIDF is not NULL
                             )
"
22024,57001,MySQL - Select to retrieve last datetime,"SELECT country, partner, ok_rate
FROM TABLE WHERE ok_rate <= 98
AND period_duration = (SELECT MAX(period_duration)
                       FROM TABLE)
"
559,46870,Get a List of all Primary Keys in a Database,"EXEC sp_pkeys '<tablename>'
EXEC sp_helpconstraint '<tablename>'
"
12903,31320,SQL: How to select data from this 3 tables,"SELECT p.ProjectID, p.CompanyID, a.AddressID, a.Street
FROM Project p
INNER JOIN Company c
ON p.CompanyID = c.CompanyID
INNER JOIN Address a
ON ISNULL(p.AddressID, c.AddressID) = a.AddressID
"
5608,44235,Query a single value from a column that pulls multiple values,"SELECT DISTINCT 
     pe.prodtree_element_name_l, 
    (SELECT TOP 1 rs2.resource_value
    FROM resource_shortstrings rs2
    WHERE rs2.language_id = '5'
      AND rs2.resource_key = pe.prodtree_element_name_l_rk) AS ""resource_value""
FROM prodtree_element pe
LEFT JOIN resource_shortstrings rs
    ON pe.prodtree_element_name_l_rk = rs.resource_key
WHERE rs.language_id = '5'
    AND pe.prodtree_element_name_l IS NOT NULL
--GROUP BY prodtree_element_name_l
"
38554,52920,Finding rows with the maximum,"SELECT P.*
  FROM Palettes AS P JOIN
       (SELECT name, MAX(""count"") AS max_count
          FROM Palette
         GROUP BY Name) AS MC
       ON MC.Name = P.Name AND P.""count"" = MC.Max_Count;
"
5387,57919,PostgreSQL ORDER BY clause on numerical portion of text column,"SELECT * FROM mytable
ORDER BY right(id, -1)::integer;
"
6892,49934,How to use inner join and cross join in one query?,"select T.PRICE, S.ROW, S.NUMBER, M.TITLE  
    from [cinema_no_keys].[dbo].[TICKET] T 
    inner join [cinema_no_keys].[dbo].[SEAT] S on
        T.ID_SEAT = S.ID_SEAT
    inner join [cinema_no_keys].[dbo].[SHOW] SH on
        SH.DATE_HOUR = T.DATE_HOUR
    inner join [cinema_no_keys].[dbo].[MOVIE] M on
        M.ID_MOVIE = SH.ID_MOVIE
"
9843,22495,How do you examine objects from psql?,"=> SELECT oid FROM pg_catalog.pg_class c WHERE c.relname LIKE 'my_index';
  oid  
-------
 25240
(1 row)
=> SELECT attname, attnum FROM pg_attribute a WHERE a.attrelid = '25240';
     attname      | attnum 
------------------+--------
 iso_country_code |      1
 type_name        |      2
 pg_expression_3  |      3
(3 rows)
=> SELECT pg_get_indexdef(25240, 3, true);
 pg_get_indexdef 
-----------------
 upper(name)
(1 row)
"
33209,26698,Removing duplicate in a column,"select
v.id,
max(c.image_type_id),
max(vp.x), 
max(vp.y),
max(vp.z)
FROM
v,
vp,
c,
WHERE v.id = vp.id 
  AND v.id = c.id
group by v.id;
"
32666,5762,MySQL query returning no results when querying joined table,"AND IFNULL(qo.qoIsCompleted, 0) != 1
"
6484,62338,Split Comma Seperated Values into Rows with SQL Server,"delete from names n
    where exists (select 1
                  from names n2
                  where ',' + n2.nicknames + ',' like '%,' + n.name + ',%' and
                        n2.nameid <> n.nameid
                 );
"
27157,43520,NA values using sqldf,"SELECT AVG(col1)
FROM file
WHERE col1 IS NOT \""NA\""
"
11713,48531,SQL for delete query,"DELETE teammembers FROM teammembers
JOIN teams on teammembers.teamId = teams.teamId
WHERE teams.eventId = 1
"
7126,46170,TSQL Date Format to match jQuery plugin,"$('#timePicker').datetimepicker({
    dateFormat: 'dd-mm-yy'
});
"
15687,2965,SQL find rows with multiple references,"SELECT street_name, store_id, count(*) 
FROM streets 
GROUP BY street_name
HAVING COUNT(DISTINCT store_id) > 1
"
32413,32195,"What does the ""ON"" clause do for this JOIN operation?","SELECT team1, team2 , player
FROM game JOIN goal ON (game.id = goal.matchid)  -- or maybe it's the other way
WHERE player LIKE 'Mario%'                       -- round, game.matchid = goal.id
"
6909,8413,SQL Query to show records,"SELECT * 
FROM users 
WHERE level <> '4'
OR (level = '4' and Activity < 5);
"
23535,41571,Parsing Dates in SQL,"-- If the culture argument isn't provided, the language of current session is used.
SELECT TRY_PARSE('Thu, 4 Jul 2013 09:18:24' AS datetime2) AS 'datetime2'; 
"
15389,37284,select from two tables and always return from one,"select a.*, b.* FROM disp_ofer a
Left join ofer_detl b  
     on b.disp_ofer_data = a.disp_ofer_data and b.esta_cod = a.esta_cod
WHERE 
a.esta_cod = 'Lelis' 
AND
a.disp_ofer_data = '2013-10-30 16:07:20'
"
12633,60702,Query result organization,"SELECT Item_ID, SUM(Quantity), Sum(Sale)
FROM Item
JOIN Purchase ON Item.Item_ID=Purchase.Item_ID
JOIN Transaction ON Purchase.Transaction_ID=Transaction.Transaction_ID
WHERE Client_ID = $ClientId
AND Transaction.Timestamp>= $start
AND Transaction.Timestamp <= $end
GROUP BY Item_ID
ORDER BY SUM(Quantity), SUM(Sale) DESC
"
35279,57105,SQL Update (simple??),"--Do this select first for safety
select c.CustomerName, m.CorrectedName
from TableCustomers c join TableCustomerMapping m on c.CustomerName = m.WrongName

--Update if okay
update c
set c.CustomerName = m.CorrectedName
from TableCustomers c join TableCustomerMapping m on c.CustomerName = m.WrongName
"
10521,41836,YetAnotherForum upgrade sql issue,"Backup DB (again)
Script the index to a new window.
Drop the index.
Apply the udpate.
Check the data does not have nulls and fix if required.
Recreate the index.
"
8598,403,Deploying android database only once,"onCreate(SQLiteDatabase db);
onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion);
"
26083,27680,How to trim text from SQL Server select statement for text consisting of two letters and five digits?,"SELECT 
    SUBSTRING(col, PATINDEX('%[a-zA-Z][a-zA-Z][0-9][0-9][0-9][0-9][0-9]%', '' + col), 7)
FROM TEST
WHERE PATINDEX('%[a-zA-Z][a-zA-Z][0-9][0-9][0-9][0-9][0-9]%', '' + col) <> 0
"
13994,58199,Get List of all last inserted IDs to a table,"declare @inserted table (Id int)

insert into table1(col1,col2,col3)
output inserted.Id into @inserted (Id)
select @val1,@val2,val3
from table2
where value=@value

select * from @inserted
"
18863,11512,"Oracle: Multi-Column ""Closest Match"" Autocomplete Strategy","    create table searcher
    (
    user_id  number, --FK back to users
    search_column  varchar2(50) -- or whatever size column is appropriate
    );

    select u.first_name, u.last_name, u.login. u.email,
utl_match.jaro_winkler_similarity(search_column, 'js')
    from users u
    join
    searcher s
    on (u.user_id = s.user_id)
    where s.search_column like upper('js%')
    order by 5;
"
39911,69910,How do I SELECT the row with maximum value for an attribute in SQL,"SELECT Branche, COUNT(Phones) FROM Branch
GROUP BY Branche
ORDER BY COUNT(Phones) DESC
LIMIT 1
"
12430,73425,"Combining two tables together to get all columns, but I need separate rows for the data instead of one row","SELECT invoice_id, col1, col2, NULL AS pmt_invoice_id, NULL AS colA, NULL AS col
FROM tenant_invoices
UNION ALL
SELECT NULL, NULL, NULL, pmt_invoice_id, colA, colB
FROM tenant_payments
"
33363,3817,SQL query that gives distinct results that match multiple columns,"SELECT document_id
FROM table
WHERE tag = 'tag1' OR tag = 'tag2'
GROUP BY document_id
HAVING COUNT(DISTINCT tag) = 2
"
4021,42520,MySQL and implementing something close to sequences?,"insert into ... select max(..)+1 from ...
"
23366,4352,Implement Partial sorted query in sql server 2005,"Select state
From statemaster
Order By
  Case When stateid = 5 Then 0 Else 1 End,
  state
"
27028,66140,Database Triggers: On Insert,"CREATE TRIGGER trg_Table1_INSERT
ON dbo.Table1 AFTER INSERT 
AS BEGIN
   INSERT INTO dbo.Table2(SerialNo, Name)
      SELECT SerialNo, Name
      FROM Inserted

   INSERT INTO dbo.Table3(SomeOtherCol)
      SELECT SomeOtherCol
      FROM Inserted
END
"
33185,31425,Group by in Oracle?,"select (case when seqnum = 1 then id else '0' end) as id,
       (case when seqnum = 1 then start else ""end"" end) as timestamp,
       unit
from (select t.*,
             row_number() over (partition by id, unit order by start) as seqnum,
             count(*) over (partition by id, unit) as cnt
      from table t
     ) t
where seqnum = 1 or seqnum = cnt;
"
20743,12565,Appending string using an update statement,"create table status(orderid int, updatelog nvarchar(500))

insert into status values(1, 'your previous message')

declare @message nvarchar(500) = 'Staff A 24/10/2014 12:00' + CHAR(13) + 
  'Order completed. Thankyou '

update status 
set updatelog = @message + updatelog
where orderid = 1


select * from status
"
1272,34885,How Magento creates & saves product? Need File & Function name for the same..?,"app/code/core/Mage/Adminhtml/controllers/Catalog/ProductController.php
"
36473,49356,SQL Sever 2008 - How to combine rows with related data,"SELECT rs.AlertName, COUNT(1) Totals
FROM (
    SELECT CASE 
        WHEN AlertName LIKE 'Windows Services%Core' 
            THEN 'Windows Services (Core)'
        WHEN AlertName LIKE 'Windows Services%SQL' 
            THEN 'Windows Services (SQL)'
       ELSE AlertName END AlertName
    from ALERTS) RS
Group By rs.AlertName
"
19384,47290,MySql: does it have namespace-like SCHEMA?,"SELECT * FROM `FOO`.`TABLEFOO1`, `BAR`.`TABLEBAR1` WHERE ...
"
17661,74469,Microsoft SQL Server Management Studio running script from inside a script,"create database foo;
go

use foo;
go

:r createT1.sql
:r createT2.sql
go
"
24459,4193,combine 2 queries,"Select users.ID as UserID,users.Username, policy.ID as PolicyID,policy.PolicyName, source.Path
from users join groups on group.ID = user.groupID_FK 
   join policy on group.policyID_FK = policy.ID
   left join source
      on group.policyID_FK = source.policyID_FK
      and SourceType = 0 
"
15330,13882,mysql daily count grouped by one column,"SELECT  DAYNAME(sip_Date) AS DAY,
        COUNT(DISTINCT sip_callid)
FROM    request_line
WHERE DAYNAME(sip_Date) = 'Saturday' 
GROUP BY DAYNAME(sip_Date)
"
24222,70295,How to get list of all materialized views in oracle,"SELECT *
FROM  all_snapshots;
"
10088,20222,Query Fine Tune,"CREATE NONCLUSTERED INDEX NC_MyCoveringIndex 
   ON Table(UpdateDateTime)
      INCLUDE (Col1, Col2, ..., ColN)
"
27749,34813,Oracle: Creating new database remove existing user,"run > cmd

set ORACLE_sid=<database_name_here>

sqlplus / as sysdba

select username from dba_users;
"
23347,30617,Cannot insert into field with primary key constraint in PostgreSQL,"insert into teams (team_id,team_name)  
select distinct on (team_id) team_id, team_name
from rawtable
order by team_id;
"
15328,27018,How to filter a column in Oracle Sql Developer,"like '%JUL%'
"
1828,65151,Select an XML attribtute of parent node with condition for child node,"select
cfg.session_xml.extract('/ns1:configurationSession/ns1:products/ns1:product[ns1:configId=5621507]/@qty',
'xmlns:ns1=""http://abc.com/schema/service""').getstringval()
from vz_cfg2_sess_xml cfg
"
19924,68798,"What ""type"" do I specify in addCase to return a column?","use Cake\Database\Expression\IdentifierExpression;

// ...

$team_id = $query->newExpr()->addCase(
    [$query->newExpr()->eq('Games.status', 'home_default')],
    [new IdentifierExpression('home_team_id'), new IdentifierExpression('away_team_id')]
);
"
33569,60494,Using ORDER BY and getting most recent version of records,"select id, ""DATE"", COL_A
from (select v.*,
             max(""DATE"") over (partition by substr(col_A, 1, 1),
                                            substr(col_A, 8)
                              ) as maxdate
      from versiones v
     ) v
where ""DATE"" = maxdate;
"
2066,19414,how to select first N row of each group?,"SELECT b.BookId, a.AuthorId, a.AuthorName, b.Title
FROM Author a join
     Book b
     on a.AuthorId = b.AuthorId
where (select count(*)
       from book b2
       where b2.bookId <= b.BookId and b2.AuthorId = b.AuthorId
      ) <= 2;
"
31708,46735,How to execute multiple SQL queries in MySQL Workbench?,"CREATE TABLE testTable(
    Name VARCHAR(20),
    Address VARCHAR(50),
    Gender VARCHAR(10)
);

INSERT INTO testTable
VALUES
('Derp', 'ForeverAlone Street', 'Male'),
('Derpina', 'Whiterun Breezehome', 'Female');

SELECT * FROM testTable;
"
37566,56971,Mysql insert new row,"select * from table order by (id=4) DESC,id ASC
"
23543,22058,Create a Synonym for a database / Change DB views point to,"create synonym [otherDb].[tbl_a] for [DatabaseB].[schemaB].[tbl_a]
create synonym [otherDb].[tbl_b] for [DatabaseB].[schemaB].[tbl_b]
create synonym [otherDb].[tbl_c] for [DatabaseB].[schemaB].[tbl_c]
"
7453,17945,SQL And NULL Values in where clause,"-- This will print TRUE
SET ANSI_NULLS OFF;
IF NULL <> 'A'
    PRINT 'TRUE'
ELSE
    PRINT 'FALSE'

-- This will print FALSE
SET ANSI_NULLS ON;
IF NULL <> 'A'
    PRINT 'TRUE'
ELSE
    PRINT 'FALSE'
"
10875,52823,How to combine sum by same id in sql,"select id, sum(count)
from your_table
group by id
"
27212,48856,using multiple conditions in one query in oracle,"select id, performer, max(END_TIME) from workstep where workstep_name = 'Review' and status ='W_COMPLETED' group by id,performer
"
32941,47818,how to take all values from sql table column on condition?,"select 
*
from [vwMYDATA] 
where
Path like '%' + @path + '%' and
((@status IS NULL )OR (Status = @status or status IS NULL))
"
13772,44769,comparison query taking ages,"select  a.ID, a.adres, a.place, a.postalcode  
from COMPANIES a INNER JOIN COMPANIES b
ON
a.ID <> b.ID
and a.Postcode = b.Postcode  
and a.Adres = b.Adres  
and (  
select COUNT(COMPANYID)  
from USERS  
where COMPANYID=a.ID  
)>(  
select COUNT(COMPANYID)  
from USERS  
where COMPANYID=b.ID  
)
"
9672,57182,SQL algorithm with three identifiers from one table,"select planid, production_nr
from information inf1
where not exists (select 1 from information inf2
                  where inf1.planid = inf2.planid
                  and   status < 3)
"
31804,36102,How to select all ms access table records based on date,"SELECT
  *
FROM
  CHECKOUT
WHERE
  datevalue([CHECK-TIME]) = #2013-07-15#
"
26100,3764,Find names with at least 2 vowels in MySQL,"SELECT `name` FROM `players` WHERE `name` REGEXP '([aeiou].*){2}'
"
25033,56964,Using SQL to INSERT number of records based on QUERY,"INSERT INTO new_table(Event, GradeType, Grade)
SELECT Event, CONCAT(Type, n) AS [GradeType], NULL AS Grade
FROM tab
CROSS APPLY (VALUES (1),(2),(3),(4),(5),(6),(7),(8),(9)) AS n(n)
WHERE n <= Fields;
"
32257,9168,How to use parent result in sub selects?,"Select 
Sum(case when monkey_weight > 20 then monkey_value else 0 end) as WT20, 
Sum(case when monkey_weight > 30 then monkey_value else 0 end) as WT30 
from MonkeyTable mt where monkeySanityLevel > 10
"
49,32851,Percentage of requests SQL,"select sum(case when abc = 'yes' then 1 else 0 end) * 100 / count(*)
from your_table
"
23840,19478,copy data from another table which doesn't exist in the first one.,"INSERT INTO table1 
SELECT * 
FROM db2.table2 
WHERE table1ReferenceID NOT IN(SELECT id_UNIQUE FROM table1);
"
13815,62295,To select matching strings in 2 tables,"SELECT * FROM TableA WHERE M='11' AND Y='29'
UNION ALL
SELECT * FROM TableB WHERE M='11' AND Y='29'
ORDER BY D ASC , Id DESC;
"
37490,6863,SQL - Delete value if incremental pattern not met,"WITH cte AS (
  SELECT *, ROW_NUMBER() OVER (ORDER BY id) rn FROM table1 WHERE data IS NOT NULL
)
DELETE c1 FROM cte c1
LEFT JOIN cte c2 ON (c1.rn = c2.rn+1 OR c1.rn = c2.rn-1) AND c1.data = c2.data
WHERE c2.id IS NULL
"
33371,16818,Create Custom SQL Order By Rules,"drop table if exists jobnumbers ;
create table jobnumbers (id int primary key, number varchar(10)); 
insert jobnumbers values
(  1, 'J09-1893'),
(  2, 'J11-1323'),
(  3, 'J08-0011'),
(  4, 'J09-0234'),
(  5, 'J10-1232'),
(  6, 'J11-1111'),
(  9, 'J99-1111');

select *
from jobnumbers
order by 
  case when number>'J5' then 1900 else 2000 end desc, number desc;
"
26559,31587,SQL query to have certain rows on top based on a value in multiple columns,"SELECT *
FROM TEMP
ORDER BY CASE WHEN Color1='R' OR Color2='R' OR Color3='R' THEN 0 ELSE 1 END
"
7039,69356,Querying PostgreSQL using WHERE clause,"create temp table ip_addresses (ip_address text);
copy ip_addresses from stdin csv; -- pipe your text file here
select * from markers where ip_address in (select * from ip_addresses);
"
19785,6451,Suppress the contents of the SQLplus command in UNIX?,"> sqlplus -s username/password@database
"
15054,14242,Get count if column value does not exist in another table,"select count(*)
from table_2 t2
where t2.success = 1 and t2.c_id = 12345 and
      not exists (select 1 from table_1 t1 where t1.m_id = t2.mid and t1.c_id = 12345);
"
25264,8557,How can I design a select statement to select a subset of values exclusively based on a condition?,"WITH rn AS (
  SELECT *, ROW_NUMBER() OVER(PARTITION BY TransactionID ORDER BY Cost) rn
  FROM Table2
)
SELECT rn.TransactionID, rn.Cost, COALESCE(t1.TotalItemsType1, 0) TotalItemsType1,
       COALESCE(t1.TotalItemsType2, 0) TotalItemsType2
FROM rn LEFT JOIN Table1 t1
  ON rn.TransactionID = t1.TransactionID AND rn.rn = 1
"
32754,61228,Add new rows to a table using id's returned in query,"insert into exp_member_homepage(member_id)
select m.member_id
from exp_members m
left outer join exp_member_homepage mh on m.member_id = mh.member_id
where mh.member_id is null
"
5462,38279,Return types of glob() and like() and failure of using index although 'LIKE optimization' applies,"x = 5  AND  y GLOB 'x*'
"
11366,47223,INSERT from SAS 9.2 to SQL Server 2005 fails when table has a trigger,"SET NOCOUNT ON 
"
12215,20778,"Converting a doubly-nested query to a JOIN statement, and other optimizations","SELECT DISTINCT
  titles.title
FROM
  exp_channel_titles  AS titles
INNER JOIN
  exp_relationships   AS rel
    ON titles.entry_id = rel.rel_child_id
INNER JOIN
  exp_channel_data    AS channel
    ON rel.rel_id = channel.field_id_202
WHERE
  channel.entry_id = 19971
"
6890,58601,Oracle: earliest date of stay (two columns),"SELECT users.id_user, orders.date_stay_start, orders.date_stay_stop
FROM users
JOIN orders 
  ON users.id_user=orders.id_user
INNER JOIN (Select Min(Orders.date_Stay_start) DSS, id_user from orders group by ID_user) o
  ON O.DSS = orders.date_stay_start
 and O.id_user = orders.Id_user
WHERE orders.date_stay_start IS NOT NULL
GROUP BY users.id_user;
"
20667,17724,Removing duplicates from JOIN between two tables (Oracle),"SELECT * FROM ( 
    SELECT 
        n.*, 
        RANK() OVER (PARTITION BY n.MSISDN ORDER BY length(n.prefix) DESC) as rnk
    FROM (
        SELECT * 
        FROM MSISDN a 
        LEFT JOIN RANGES b 
             ON a.msisdn like b. prefix || '%' and a.network = b.network 
        ) n 
    )t
WHERE t.rnk = 1
"
25074,30345,split DB table across two tables,"DECLARE @T1 TABLE (Title varchar(50), NewID int)
INSERT INTO compositeTable (Title, date1, TextContent)
OUTPUT inserted.Title, Inserted.ID INTO @T1
SELECT compositeTable (Title, date1, TextContent)
FROM origArticleTable 


insert into ArticleMeta (compositeID, ArticleID, hasVideo, hasImage, author, date2)
SELECT T1.ID, o.compositeID, o.ArticleID, o.hasVideo, o.hasImage, o.author, o.date2
FROM @T1 T1 
INNER JOIN origArticleTable o ON T1.Title = o.Title
"
35307,8299,Does grails/SQL automatically know which indices to use?,"static mapping = {
        firstName index: 'name_idx'
        lastName index: 'name_idx'
        description index: 'name_idx'
}
"
38794,74847,Build cursor query dynamic in nature?,"CURSOR employeeDepartment  (p_employee_id in number) IS
    SELECT *
    FROM Employee
    LEFT OUTER JOIN Department ON Department.empID = Employee.ID
    WHERE Employee.STATE = 'Washington'
    and ( p_employee_id = 0 or Employee.id= p_employee_id )
    ORDER BY Employee.JoiningDate desc;
"
2418,65917,create xml file from sql script,"select * from table for xml path 
SET @SQL= 'bcp ""exec DBName.dbo.Table"" queryout c:\myfile.xml -w -r -t -SServerName -T'
EXEC Master..xp_CmdShell @SQL 
"
18077,5872,Convert SQL DateTime format,"select stuff(convert(varchar, getdate(), 105), 3, 1, '/') + ' ' + left(convert(varchar, getdate(), 8), 5)
"
6540,61321,SQL Merge multiple columns into one column," (case when s.Department = 'Aero' then '(OA)' 
      when s.Department = 'Terrent' then '(OT)' 
      when s.Department = 'Vertigo' then '(OMG)'
      else ''
  end) as Blah
"
30683,9466,How to distinct on a single column in a query in SQL?,"SELECT users.userid, buildings.building 
FROM (
  SELECT userid, bldgcode FROM facstaff 
  UNION 
  SELECT userid, dorm AS bldgcode FROM students
  LEFT JOIN facstaff ON facstaff.userid = students.userid
  WHERE facstaff.userid IS NULL
) AS users
  INNER JOIN buildings ON users.bldgcode=buildings.bldgcode 
WHERE userid in (<list of users>);
"
32675,38707,Limit by running total in SQLite,"select  *
from    YourTable t1
where   20 > coalesce(
        (
        select  sum(amount)
        from    YourTable t2
        where   t2.id < t1.id
        ), 0)
"
35901,57337,Convert XML to .plist,"plutil -convert xml1 il_tuo_file_binario.plist
"
22997,70486,Inverted select TOP *,"select * from log_table where id > (select max(id) from log_table) - N
"
35424,26922,sql server sum aggregate functions,"SELECT SUM(net) FROM table GROUP BY [year],[month]
"
30766,15636,"Summarise by week, even for empty rows","SELECT Weeks.WeekNum, SUM(sales.quantity) AS sales
FROM Weeks LEFT OUTER JOIN 
 (
    SELECT *
    FROM sales 
    WHERE (sales.transDate BETWEEN @fromDate AND @toDate)
 ) sales
    ON Weeks.WeekNum = DATEPART(week, sales.transDate)
GROUP BY Weeks.WeekNum
"
758,6479,How to implement CANDIDATE key in any MySQL table,"ALTER TABLE MyTable ADD UNIQUE KEY `my_unique_key` (`city`, `state`);
"
38368,24001,SQL define table for treelike structure,"CREATE TABLE [dbo].[Categories]
(
    [Id] INT NOT NULL PRIMARY KEY IDENTITY, 
    [Name] NVARCHAR(50) NOT NULL, 
    [ParentId] INT NOT NULL ,
    ---llow NULL FK_Parent for top-level
    CONSTRAINT [FK_Parent] FOREIGN KEY ([ParentId]) REFERENCES [Categories]([Id])
)
"
9472,12661,Creating an index on an SQLite db using DBIx::Class,"package My::Schema::Result::Artist;

 __PACKAGE__->table('artist');
 __PACKAGE__->add_columns(id => { ... }, name => { ... })

 sub sqlt_deploy_hook {
   my ($self, $sqlt_table) = @_;

   $sqlt_table->add_index(name => 'idx_name', fields => ['name']);
 }

 1;
"
13740,51176,"date greater than a specified date (date, month, year)","select dateofbirth from customer Where DateofBirth  BETWEEN date('1004-01-01') AND date('1980-12-31');  

select dateofbirth from customer where date(dateofbirth)>date('1980-12-01');

select * from customer where date(dateofbirth) < date('now','-30 years');
"
16749,67402,Why is this MySQL query so slow?,"SELECT `User`.`id`
FROM `users` AS `User` 
INNER JOIN `attempts` AS `Attempt` ON `Attempt`.`user_id` = `User`.`id` 
INNER JOIN `resumes` AS `Resume` ON `Resume`.`user_id` = `User`.`id`
WHERE `Attempt`.`test_id` = 964 
    AND `Attempt`.`score` > 10 
    AND `Resume`.`has_file` = 1 
"
3926,57649,ASP / SQL - Dates being echoed different to what the database,"sql = ""SELECT CONVERT(VARCHAR(19), date, 120) as date FROM sales WHERE userid=1""
"
12654,41050,Update a table with join,"UPDATE HCS.ITEMINVENTORY
SET HCS.ITEMINVENTORY.BATCHGROUPING = 'ADMIXED'
WHERE (ITEMINVENTORY.FACILITYCODE = 'B')
    AND (ITEMINVENTORY.FORMULARYSTATUS = 'Y')
    AND EXISTS (
        SELECT 1
        FROM   ITEMDISPENSESIZE
        WHERE  ITEMDISPENSESIZE.ITEMID = ITEMINVENTORY.ITEMID
        AND    ITEMDISPENSESIZE.ITEMNUMBER IN ('18501346','18800284')
    );
"
28036,46809,INSERT or UPDATE from another table in mysql,"   INSERT INTO test2 
   SELECT a, b, c as c1 FROM test1
   ON DUPLICATE KEY UPDATE c = c + c1
"
467,31400,Multiple references on one separate table-column possible?,"SELECT 
     p.model, manufacturer.name AS Manufacturer, 
     subcontractor.name AS Subcontractor
FROM Product AS p LEFT JOIN 
     Manufacturers AS manufacturer  
     ON p.manufacturerID = manufacturer.id LEFT JOIN 
     Manufacturers AS subcontractor 
     ON p.subcontractorID = subcontractor.id
"
36862,24379,Formating number for reporting services,"### ### ##0.## ;(0.00);'-'
"
9598,21012,CakePHP Tree behavior -find specyfic level elements," SELECT n.name,
         COUNT(*)-1 AS level,
         ROUND ((n.rgt - n.lft - 1) / 2) AS offspring
    FROM tree AS n,
         tree AS p
   WHERE n.lft BETWEEN p.lft AND p.rgt
GROUP BY n.lft
ORDER BY n.lft;
"
11819,39453,SQL Table Design Style:,"Animals (animalID, animalName)
Flags (flagID, flagName)
AnimalFlags (animalID, flagID)
"
25173,20746,sql - how to merge different rows into one without group_concat," select user_id, 
       max(case when `key` = 'name' then value end) as name,
       max(case when `key` = 'url' then value end) as url,
       max(case when `key` = 'email' then value end) as email
from your_table
group by user_id
"
32839,52978,Teradata SQL to group by hour interval out of a TIMESTAMP(6),"EXTRACT(HOUR FROM timestampcol)
"
35081,2469,"SQL Select/Join, LIMIT result to 1st entry per element in query list","SELECT
DISTINCT C.PK
,B.PK
,B.tableC_pk
,B.tableA_pk
,A.pk

FROM

tableC C
INNER JOIN
tableB B
ON C.PK = B.tableC_pk
INNER JOIN
tableA A
ON A.PK = B.tableA_pk

INNER JOIN ( SELECT tableC_pk,MAX(PK) AS PK FROM tableB
WHERE tableC_pk IN ('325','322','111')
GROUP BY 1) D
ON C.PK = B.tableC_pk
AND B.PK = D.PK
"
36681,24187,how to count number of unique (by 3rd field in a whole set) ids by type,"SELECT   type, COUNT(*)
FROM     (SELECT acc_fk, type FROM t1 GROUP BY acc_fk) t
GROUP BY type
"
33736,68807,Convert positive data into negetive data (entire column) in Postgres Server," Update table set a= 0-a where a >0
"
363,1048,Oracle string replacement,"UPDATE table
SET col = replace(col, 'item c', '')
"
8180,59654,SQL Query to count Unique records ignoring sub string,"select count(distinct substring_index(col, '-', 1))
from t;
"
6107,58972,How to know whether the created view is valid or not,"select object_name, status from user_objects 
where object_type = 'VIEW' and object_name = 'YOUR_VIEW';
"
36193,14602,MySQL - prevent duplicates for multiple insert statement without using a unique index,"INSERT INTO `table1` (`a`, `b`, `c`)
    select t.*
    from (select 'a' as a, 'b' as b, 'c' as c union all
          select '1', '2', 'bar' union all
          select 'd', 'e', 'f'
         ) t
    where not exists (select 1 from table1 t1 where t1.a = t.a and t1.b = t.b);
"
26562,71342,MySQL add count to query as column,"SELECT   id, COUNT(*)
FROM     history
WHERE    id LIKE '%CLM%'
GROUP BY id
"
9858,43371,JPA hibernate date between query issue,"em.setParameter(""start"", startDate, TemporalType.TIMESTAMP);
em.setParameter(""end"",endDate, TemporalType.TIMESTAMP);
"
33257,48105,Substitute column values in a table,"SELECT LessonCode, SubjectName, ClassName, hour, day
FROM lesson
JOIN class on lesson.ClassCode = class.ClassCode
JOIN subject on lesson.SubjectCode = subject.SubjectCode
"
9769,11318,How to update table from linking table?,"UPDATE zip_code z
SET    type_id = t.id
FROM   temp_zip_type tmp
JOIN   zip_code_type t ON t.value = tmp.temp_type
WHERE  z.zip_5_digit = tmp.temp_zip
AND    z.type_id IS DISTINCT FROM t.id;  -- avoid empty updates
"
37971,66356,Cyrillic symbols in SQL code are not correctly after insert," INSERT INTO Assembly VALUES(N'Македонски парлиамент број 1','','');
"
6536,7646,Select Max and Select other column,"SELECT SectionItem,
       (select MAX(SectionItemID)+1 FROM Core.SectionItem_Lkup) AS SectionItemID
FROM Core.SectionItem_Lkup
"
15888,22934,How to execute different where conditions in a better way,"SELECT item1,item2,item3
FROM table1
WHERE 
  (@flag = 1 and 'my first condition') OR
  (@flag != 1 and 'my secondcondition')
"
20543,9634,sum of value with distinct date sql server,"select actd0v,sum(price0v) from Table_4 group by actd0v      
"
32623,67032,How to weekly group if you have daily data,"SET DATEFIRST 1

    SELECT CAST(MIN( [DATE]) AS VARCHAR(20))+' TO '+CAST (MAX([DATE]) AS VARCHAR(20)) AS DATE,
           SUM(C1) AS GRU,
           SUM(C2) AS C1
    FROM   YOUR_TABLE
    GROUP BY DATEPART(WEEK,[DATE])
    HAVING COUNT(DISTINCT[DATE])=7

SET DATEFIRST 7
"
32855,61846,Getting only day and month from a date field,"select to_char(your_date_column, 'mon-dd') from your_table
"
10415,59547,Basic SQL: How to use properties of one table as a lookup on other tables,"select 
  case when a.cola = 'Z' then z.cola else q.cola end cola,
  case when a.colb = 'Z' then z.colb else q.colb end colb
from tablea a, tableq q, tablez z
"
13975,52055,SQL Server to select conditional on what time of year it currently is,"SELECT Name, Position, StartTerm, EndTerm 
  FROM myTable 
 WHERE YearOfTerms = Year(DateAdd(mm, -4, GetDate()))
"
23166,44628,Junction/Bridge tables Oracle SQL,"CREATE TABLE Employee (
emp_id NUMBER(3) NOT NULL,
emp_name VARCHAR2(30) NOT NULL,
emp_position NUMBER(2) NOT NULL,
emp_salary NUMBER(5) NOT NULL,
position_id NUMBER(2) NOT NULL,
...
"
25030,30143,SQL: Performing substraction only when record exists,"SELECT
    od.OrderDetailID, od.PartNr, od.OrderNr, d.PartName
    , od.Quantity - ISNULL(s.Quantity,0) [RemainsToBeShipped]
FROM OrderDetails AS od
INNER JOIN Parts AS d ON od.NrDet = d.NrDet
LEFT JOIN Shipped as s ON od.OrderDetailID = s.OrderDetailID
"
9075,62377,Amalgamate 2 select statements into 1,"begin
  select * into row_item where <very long operation>;
exception
  when too_many_rows then
    dbms_output.put_line('failure');
end;
"
6538,61706,PostgreSQL: Obtain rows from table from 5 minutes ago,"SELECT * FROM mytable WHERE ""date"" >= NOW() - INTERVAL '5 minutes';
"
20705,40191,Oracle XMLTABLE left outer join doesn't return results when XPath doesn't exist,"select x.id1, x.id2, x.id3
from tbl t
cross join
  xmltable ('/root'
    passing t.xml_data
    columns id1 varchar2 (100) path 'element[id=1]/data',
       id2 varchar2 (100) path 'element[id=2]/data',
       id3 varchar2 (100) path 'element[id=3]/data'
) x;

ID1   ID2   ID3 
----- ----- -----
abc   def        
"
36775,2823,How to make Microsoft BCP export empty string instead of a NUL char?,"...
NULLIF(pri.InstanceName, '') as PerformanceInstanceName,
...
"
2458,66758,How I can change prefixes in all tables in my MySQL DB?,"SELECT 
  GROUP_CONCAT('RENAME TABLE `', TABLE_SCHEMA, '`.`', TABLE_NAME, '` TO `', TABLE_SCHEMA, '`.`prefix_', TABLE_NAME, '`;' SEPARATOR ' ')
FROM 
  `TABLES` WHERE `TABLE_SCHEMA` = ""test"";
"
35075,24727,Need Select top 10 people SQL,"SELECT user_id, COUNT(follow_id) AS total_followers
FROM users 
GROUP BY follow_id 
ORDER BY total_followers LIMIT 10;
"
33769,12018,How to get ID of a newly created SQL Server database,"SELECT database_id FROM sys.databases WHERE name = N'testdb1';
"
8135,68353,Get row with the smallest time interval per value in a table,"SELECT DISTINCT ON (extension)
       start_time, stop_time, extension
FROM   tbl
ORDER  BY extension, (stop_time - start_time);
"
3043,42319,select rows with zero child elements (join),"select * from table1 where key not in (select tab1 from table2)
"
15961,9295,Numbering SQL query results based on groupings,"  select t.*,
         (@rn := if(@s = Section, @rn + 1,
                    if(@s := Section, 1, 1)
                   )
         ) as SubNumber
  from table t cross join
       (select @rn := 0, @s := '') vars
  order by Section;
"
656,7364,Using Object to execute SQL statements in Visual Studio,"Dim ConnString As String = ""server=Mandrew;Initial Catalog=newreptDBtest.accdb""
Dim SqlString As String = ""put your query here, e.g. Select * From Contacts""
Using conn As New OleDbConnection(ConnString)
Using cmd As New OleDbCommand(SqlString, conn)
cmd.CommandType = CommandType.Text
conn.Open()
Using reader As OleDbDataReader = cmd.ExecuteReader()
  While reader.Read()
    'access the data using the reader, e.g. reader(""ColumnName"")
  End While
End Using
End Using
End Using
"
24859,1852,Most efficient way to select lots of values from database,"select i.*
from items i
where i.itemID in (<list of ids>);
"
37743,8973,Calculating minutes within a defined time window?,"select [task end] - [task start] as taskDuration
from tasktable
where [task start] > @WindowStart and [task end] < @WindowEnd
"
16145,74277,How to get the name of students in a certain section,"select u.fname
from users u
join students s on u.user_id = s.user_id
join sections sec on s.section_id = sec.section_id
where sec.section_id = 1
  and sec.year_level_section = 1
"
17321,38513,UPDATE Postgresql where row...else delete,"DELETE FROM your_table_name
WHERE col2 = 'y'
  AND col1 IN (SELECT col1
              FROM your_table_name 
              WHERE col2 = 'x')
"
10986,28928,"trying to get the date of the first and last day of a week, given an arb. date","SELECT to_char(date_col, 'iw') w, trunc(date_col, 'd') st, trunc(date_col, 'd')+6 et
FROM your_table
"
25934,71763,Sql temp table with except,"create table #AddRec(id int) ;

insert into #addrec
select  ed.id
from stg right join 
ed on stg.id=ed.id 
where stg.id is null;

select * from #Addrec
"
23063,37134,SQL query (using joins) / recursion,"with t1vals as (select distinct checkID from t1),
     t2vals as (select distinct LearnerId from t2)
select t2vals.LearnerId, t1vals.CheckId, t3.CheckId
from t1vals cross join
     t2vals left outer join
     t3
     on t3.LearnerId = t2vals.LearnerId and
        t3.CheckId = t1vals.CheckId
"
27889,25861,Select subarray and its length in PostgreSQL,"SELECT l.country, c.list, c.list_count
FROM   location l
LEFT   JOIN (
   SELECT location_id AS id
         ,array_agg(id) AS list
         ,count(*) AS list_count
   FROM   competition
   GROUP  BY 1
   ) c USING (id)
"
27148,45012,"Creating a mapping of users to groups, and getting the group based on user combinations","SELECT groups.name 
FROM user_groups
LEFT JOIN groups
    ON groups.id = user_groups.group_id AND user_id IN (1)
GROUP BY group_id
HAVING COUNT(*) = 1 AND groups.name IS NOT NULL;
"
6215,64922,sql union returns duplicate results,"select count(trade_sid), shortcode 
from
(
    select trade_sid, shortcode 
    from  trade 
    where 
        trade.trade_date <= sysdate and 
        trade.trade_date>= add_months(sysdate, -11) 
    UNION ALL
    select trade_sid, shortcode 
    from trade_archive 
    where 
        trade_archive.trade_date <= sysdate and 
        trade_archive.trade_date>= add_months(sysdate, -11) 
) tt
group by shortcode
order by shortcode
"
3364,67720,"DataMapper query - last year, last month etc","d = DateTime.today
p = d.prev_month
py = d.prev_year
last_month = Data.all(:date => (DateTime.new(p.year, p.month)..DateTime.new(d.year, d.month))
last_year = Data.all(:date => (DateTime.new(py.year)..DateTime.new(d.year))
"
36858,40556,Number of similar columns occurences,"INSERT INTO BATCH_ID (distinct_bench), number)
SELECT  benchID as distinct_bench, COUNT(*) number
FROM    big_table
GROUP   BY BATCH_ID 
"
11895,29970,Mysql count distinct with condition or case,"select sum(CaseStatus = 'Open') as OpenedCount
     , sum(CaseStatus = 'Closed') as ClosedCount
     , sum(CaseStatus = 'Hospitalized') as HospitalizedCount
from (<...>)
"
33563,42167,How to use a inner join with 2 conditions in the same column,"SELECT 
    CASE 
        WHEN CONTACT_TYPE = 'C' THEN
            (SELECT Name FROM CLIENTS c WHERE c.Code = co.Code)
        WHEN CONTACT_TYPE = 'P' THEN
            (SELECT Name FROM PROVIDERS p WHERE p.Code = co.Code)
    END AS [PROVIDER/CLIENT NAME],
    CONTACT_TYPE, EMAIL
FROM
    CONTACTS co;
"
14540,53625,"oracle query - something similar to pivot, but","select * From(
    select * from YourTable
  ) PIVOT (sum(DISTANCE) for (ID_DEST) IN (101, 102, 103));
"
38808,44874,Table cell to count rows in other table,"CREATE TABLE [_member_data] (
  [ID]   INT IDENTITY(1, 1) NOT NULL,
  [Name]  NVARCHAR (100) NOT NULL,
  [Email] NVARCHAR (500) NOT NULL,
  PRIMARY KEY CLUSTERED ([ID] ASC)
);

CREATE VIEW [dbo].[Members] AS
  SELECT ID, Name, Email, COUNT(*)
    FROM _member_data JOIN dbo.Entries ON [Name] = [AssignedTo]
    GROUP BY 1, 2, 3;
"
18923,30154,SQL - only execute 'and' if a condition is true,"SELECT *
FROM table1 AS t1
LEFT JOIN table2 t2 ON t1.a = t2.a
WHERE t2.a = 'some value'
  AND ((t2.b = 'some value' AND t1.c = 'some value') OR t1.c <> 'some value')
"
35240,7693,"Trying to figure out how to write an SQL query to return the nonintersection of two tables for a mysql database, having trouble","select * from Table1 as t1
left join Table2 as t2 
    on  t1.PID =t2.PID
        and t1.WEBSITE  =t2.WEBSITE     
        and t1.KEYWORDS = t2.KEYWORDS
where t2.PID is null
"
7527,924,Increment column A when column B changes value,"select name, hour, value,
       dense_rank() over (order by name) as row_num
from t;
"
3604,30074,Deselect duplicates in sql,"SELECT MAX(id), subid FROM table GROUP BY subid ORDER BY subid DESC
"
17354,26856,SELECT MySQL field that contains a substring,"SELECT  keyword 
FROM    table 
WHERE   ('Tell me about admission info' LIKE CONCAT('%', keyword, '%'))
"
39140,30283,mysql nested select in update,"update orders o1
join orders o2 on o2.id = o1.parent_id
set o1.paid = now()
where o2.paid <> '0000-00-00 00:00:00'
"
4743,2421,SQL build junction table from tags,"select t.tag_id, o.obj_id from tags t
inner join othertable o
on o.[desc] like '%' + t.name + '%'
"
13183,66981,Unable to add tables to Crystal Reports,"For Each oConnection As IConnectionInfo In oReport.DataSourceConnections
    If fUseIntegratedSecurity Then
        oConnection.SetConnection(sServerName, sDatabaseName, True)
    Else
        oConnection.IntegratedSecurity = False
        oConnection.SetConnection(sServerName, sDatabaseName, sUserLogon, sUserPassword)
    End If
Next
"
28390,16557,H2 database corruption,"if (new java.io.File(databaseFileName).exists()) { ... }
"
2395,66995,Select query ordered by two subselects that depend on the outer query,"SELECT 
  v.user_id, 
  SUM(v.points) as addedNum,
  if(
      v.points = 3, @a := 2, if(v.points = 2, @a := 1, @a := 0)
  ) as num_p_three_two
FROM vote v 
JOIN (select @a := 0, @b := 0) as temp
GROUP BY v.user_id
ORDER BY 
addedNum DESC,
num_p_three_two DESC;
"
19079,55767,SQL find non-null columns,"SELECT
     CASE WHEN EXISTS (SELECT * FROM Series WHERE t_stamp BETWEEN @x AND @y AND field1 IS NOT NULL) THEN 1 ELSE 0 END AS field1,
     CASE WHEN EXISTS (SELECT * FROM Series WHERE t_stamp BETWEEN @x AND @y AND field2 IS NOT NULL) THEN 1 ELSE 0 END AS field2,
...
"
16419,52366,Oracle Pattern matching in group by clause,"SELECT regexp_replace(emp_name, '=$', ''), count(*) AS countt
  FROM employees
 GROUP BY regexp_replace(emp_name, '=$', '');
"
15133,29895,How to use aggregate function on column cotainining string values?,"SELECT SUM( dividend ) || '/' || SUM( divisor )
       AS FractionOfSums
     , AVG( dividend / divisor )        
       AS AverageOfFractions
FROM
  ( SELECT CAST(substr(result, 1, position('/' in result)-1 ) AS int)
           AS dividend
         , CAST(substr(result, position('/' in result)+1 ) AS int)
           AS divisor
    FROM rows
  ) AS division
"
25904,20573,does it worth switching a PRIMARY KEY from the type NVARCHAR to the type INT?,"EXEC sp_spaceused 'TableName'
"
19969,71238,MySQL Group multiple events occuring simultaneously on unknown datetime,"SELECT `date` FROM eventlog
GROUP BY `date`
HAVING COUNT(DISTINCT event) = 3
"
19807,37110,Selecting multiple rows with a sub-query,"SELECT name, job 
    FROM Employer 
    WHERE job in (SELECT job FROM employer WHERE dept = sales);
"
32369,52616,Table Name Display,"if(exists(select * from Student where Std_ID = @UserId))
begin
  select 'Student' as TableName
  return;
end
"
2267,68204,SQL count votes in one table include name from another table,"SELECT VotedFor, count(*) As Winners, P.Name
FROM Vote inner join PersonNames as P
on Vote.VotedFor = P.ID
GROUP BY VotedFor, P.Name
ORDER BY count(*) DESC;
"
12070,25815,"Is it possible to return a column in a select statement, only if a variable is set?","DECLARE @sql NVARCHAR(MAX);
SELECT @sql = N'SELECT ' + CASE WHEN @Value = 1 THEN
  'col1, ' ELSE '' END + 'col2 FROM dbo.MyTable;';
PRINT @sql;
--EXEC sp_executesql @sql;
"
19329,62176,T-SQL stored procedures,"CREATE PROCEDURE  getRoles
    @Username varchar(50), 
    @Password varchar(50) 
AS
BEGIN
    Select 
        * 
    from Users as us 
    inner join MappingRoles mr 
    on us.Userid=mr.Userid 
    where us.UserName=@username and us.Password=@password);
END
GO
"
33676,61940,DB2 - How to run an ad hoc select query with a parameter in IBM System i Access for Windows GUI Tool,"CREATE OR REPLACE VARIABLE variableName VARCHAR(50);
SET variableName = 'blah';
SELECT * FROM table WHERE column = variableName;
DROP VARIABLE variableName;
"
7449,1207,How to execute a procedure in a select or for every row of a table,"SELECT
    t.teamname AS team,
    opp.teamname AS opponent, 
    cat.cityname AS at,
    COUNT( * ) AS GamesInCity,
    ( COUNT( * )/ @daysinseason ) AS Pct, 
    dbo.MyUDF(@var,(COUNT( * )/ @daysinseason)) -- the udf should return what you have as output parameter in your procedure
FROM ...
"
2087,44415,MySQL Delete with join,"DELETE FROM dataproc e 
WHERE EXISTS(SELECT 1 FROM unsubscribers j WHERE e.EMAIL = j.EMAIL);
"
39022,5175,Adding Values Per Preceeding Row,"select GraderName, 
       sum(Graded_Items) over(order by GraderName) As Graded_Items
From yourtable  
"
21335,37184,SQL Server Query on joining two tables correctly,"SELECT * FROM Claims AS c
WHERE EXISTS (
    SELECT * FROM Edits AS e1
    WHERE c.ClaimID = e1.ClaimID 
    AND e1.RuleId=205)
AND NOT EXISTS (
    SELECT * FROM Edits AS e2
    WHERE c.ClaimID = e2.ClaimID
    AND e2.RuleId=913)
"
2713,24492,Converting String Date to Date Time in Oracle,"SELECT TO_DATE('Sunday 6/1/2014 8:00AM', 'DAY M/D/YYYY HH:MIAM') FROM DUAL;
"
2663,73105,How can I retrieve information from two different tables in a stored procedure?,"CREATE PROCEDURE dbo.SearchTwoTables
  @search_argument NVARCHAR(255) = N'M%'
AS
BEGIN
  SET NOCOUNT ON;

  SELECT ID, Name FROM dbo.People 
    WHERE Name LIKE @search_argument
  UNION ALL
  SELECT ID, Name FROM dbo.Group
    WHERE Name LIKE @search_argument;
END 
GO
"
5426,8853,MySQL update if record does not exists in other table,"update table_to_update 
set some_column = 123
where id = 1
and id not in (select id from table_b)
"
8216,2406,How to search through directory and copy into database,"for x in *.ext; do psql -d yourdb -qtAc ""copy mytable from '/path/to/files/$x' csv header null ''""; done
"
35202,54300,Include column names in Grails SQL query results,"import org.hibernate.Criteria

def query = """"""Your query""""""
def data = session.createSQLQuery(query)
                .setInteger(""firstResult"", cmd.firstResult)
                .setInteger(""maxResults"", cmd.maxResults)
                .setResultTransformer(Criteria.ALIAS_TO_ENTITY_MAP)
                .list()

data.each{println it.UUID}
"
20041,53144,Get all the rows which are not have leading zero,"select * from tablename
where substring(column1 from 1 for 1) <> '0'
"
995,72875,Remove Duplicates from LEFT OUTER JOIN,"SELECT S.NO, L.KEY 
FROM SHOP S 
LEFT OUTER JOIN LOCATN L 
ON S.NO = L.SHOP
GROUP BY S.NO, L.KEY
"
38696,40967,MySQL group by and where,"SELECT id1, id2, status, 
  (SELECT MAX(value) FROM test1 t2 WHERE t1.id1 = t2.id1) value 
FROM test1 t1
WHERE status = 'VN'
"
8190,45464,Return boolean on mysql select statment after comparing values of particular column,"select 
  course_id, count( distinct weightage ) = 1 as matched
from my_table
group by course_id  
"
24330,59178,SQL Server 2000 - Update rows and return updated rows,"BEGIN TRANSACTION

SELECT * FROM TABLE WITH (ROWLOCK, READPAST, UPDLOCK) WHERE Locked = 0

UPDATE TABLE
SET Locked = 1
WHERE Locked = 0

COMMIT TRANSACTION
"
23772,74863,Having trouble creating a MYSQL-Query which selects Data from two tables,"SELECT t.name,s.InstitutionName      
FROM Employees t
INNER JOIN Institutions s
ON(t.InstitutionID = s.insID
   AND s.Location = 'London')
"
8457,26641,PostgreSQL one to many pivot with crosstab,"SELECT * FROM crosstab(
    'SELECT custid, product, true FROM purchases ORDER BY 1, 2'    
  , $$VALUES ('software 1'::text), ('software 2'), ('software 3')$$)
AS ct (custid int, software1 bool, software2 bool, software3 bool);
"
27595,54969,how to modify an existing check constraint?,"alter table t drop constraint ck ;
alter table t add constraint ck check (n < 0) enable novalidate;
"
7608,33224,"SmallInt vs Date in MySQL - Performance, Flexibility and Size","WHERE t.product_id = 195 AND t.week_id >= 27 AND t.week_id < 40
"
36767,46364,SQL Trigger for comparing on insert,"if (SELECT COUNT(*) FROM tbl_name WHERE id = id_you_want_check >= 1) {
    rollback;
}
"
33326,47555,Select value where the value in the same row but another column is the same,"SELECT t2.regnr
  FROM table1 t1 JOIN table1 t2
    ON t1.samenr = t2.samenr
   AND t2.type = 'Plane'
 WHERE t1.id = ?
"
14170,5,Netezza UPDATE from one table to another,"UPDATE TABLE1 A
SET col1 = B.col1
FROM TABLE2 B
WHERE
A.ID = B.ID AND 
A.DeptID = 3 AND 
B.DeptID = 104
"
10750,21417,TSQL Technique for attribute evaluation,"select pk, col, val
from (select pk, col, val
      from table t
      unpivot (val for col in (attr1, attr2, . . . )) as unpivot
     ) u
where val is not null;
"
31839,65257,"simple sql query, combine results and divide","select (a.count_one / b.count_two) * 100 as final_count from 
(select field_one, count(*) as count_one from table1 group by field_one) a,
(select field_two, count(*) as count_two from table2 group by field_two) b
where a.field_one = b.field_two
"
36416,50559,ANSI Sql query to force return 0 records,"SELECT * FROM (
select
  c.lastname,
  sum(cs.amount)
from customersales cs
join customers c on c.idcustomer=cs.idcustomer
/* where 1=0 */
group by c.idcustomer, c.lastname
) x
WHERE 0=1
"
14610,60083,Is it a good idea to incorporate a Reference Count into every database table?,"DELETE
FROM    photos
WHERE   id NOT IN
        (
        SELECT  photo_id
        FROM    photos_users_like
        )
        AND id NOT IN (
        SELECT  photo_id
        FROM    photos_users_made
        )
        AND id NOT IN (
        SELECT  photo_id
        FROM    photos_users_recommended
        )
"
21188,32210,How to replace fetched values with another column while querying with SQL Server 2008 R2,"select t1.id, 
       t1.name,
       t2.name as name2
from your_table t1
left join your_table t2 on t1.number = t2.id
"
34822,69705,In Postgres is it possible to retrieve distinct date data if the table only contains the datetime field?,"SELECT DISTINCT
    col_name::date
FROM
    table_name
"
35405,63425,Can't store Data URI to database without stripping + characters,"class CustomURLField(forms.URLField):
    def to_python(self, value):
        return value
"
598,48516,"""Friend"" relationships across two mysql tables","select u.u_Name
from friends f, user u
where (f.u_ID1 = '1' and u.u_ID = f.u_ID2) 
  or (f.u_ID2 = '1' and u.u_ID = f.u_ID1)
"
32895,42023,SQL Server 2008: DateDiff() of Min()/ Max() not working,"SELECT PersonalId, Name, LastName,
       Min(TmsPrick) as Mintime, Max(TmsPrick) as Maxtime, 
       DATEDIFF(mi, MIN(TmsPrick), MAX(TmsPrick)) AS Expr1
FROM prickTable
GROUP BY PersonalId, name, lastname, cast(TmsPrick as date)
ORDER BY PersonalId, max(TmsPrick);
"
22860,58632,oracle sql - join with having with and group by?,"SELECT Users.Name, Users.userid AS users,video_id 
FROM watching_list 
    JOIN Users
        ON Users.UserID = watching_list.UserID
GROUP BY Users.userid , video_id, Users.Name
HAVING COUNT(*) > 1;
"
12866,34827,How do I SELECT TOP X where it INCLUDES records based on a criteria?,"WITH CTE_Policy
AS
(
  SELECT newid() as  ID, Policy
  FROM Code
)
SELECT TOP 300
Policy,
CASE WHEN Policy = (SELECT TOP 1 Policy FROM cte_Policy c
                    WHERE SUBSTRING(c.Policy,1,3) = 
                      SUBSTRING(CTE_Policy.Policy,1,3))
THEN 1 ELSE 0 END  AS AtLeastOne

FROM CTE_Policy
ORDER BY AtLeastOne DESC, ID
"
105,20420,Inner join between different database,"SELECT * 
FROM CoreDatabase.dbo.Client c
INNER JOIN DeltaDatabase.dbo.OutStatus os ON c.SourceId = os.OutId
"
744,25309,How can I improve the performance of this stored procedure?,"UPDATE a
SET OrderDate = (select max(InvcDate) from D3.SouthW.dbo.uc_InvoiceLine I 
                 where a.customernumber = custid)  
FROM #tCustomersEmail a  
WHERE orderdate is null
"
30662,55964,Convert this SQL  Count statement to LINQ statement,"context.GoalCards.Count(gc => gc.Completed_Data != null);
"
5963,73275,Count instances of first word in column Oracle SQL using SUBSTR and REGEXP_COUNT,"WITH firstwords AS (
  SELECT (SUBSTR(OBJECT.title, 0, INSTR(OBJECT.title, ' ')-1)) AS WORD
  FROM OBJECT)
SELECT word, count(word)
FROM firstwords
GROUP BY word;
"
29507,57067,Keeping unmatched data in query,"SELECT t.name, MAX(t2.date)
FROM table1 t
     LEFT JOIN table2 t2 on t.name = t2.name and t2.value = 1
WHERE t.type='A'
GROUP BY t.name
"
1567,15059,PL/SQL pseudo Sequencing,"SELECT t.id, s.seq
  FROM (SELECT DISTINCT id FROM myTable) t
      ,(SELECT rownum AS seq
         FROM   dual
         CONNECT BY LEVEL <= 6) s
MINUS
SELECT id, seq
  FROM myTable

ORDER BY 1, 2
"
17828,22603,Select rows with same value as given ID,"select * from mytable 
where name in (
   select name from mytable
   where id = '.$docId.'
)
"
1096,66416,Select all indexes of a type in Oracle,"SELECT *
  FROM dba_indexes
 WHERE index_type IN ('BITMAP', 'FUNCTION-BASED BITMAP' )
"
9728,67074,SQL join statement (counting),"SELECT count(d.id) FROM descriptions d
LEFT JOIN skaters s ON s.id = d.skater_id
WHERE s.name = 'Some Name';
"
10212,21988,howto realise a query which makes a second query to count the sum?,"SELECT first.name, (
 SELECT COUNT(*) 
 FROM second
 WHERE second.first_id=first.id
) as entries
FROM first
"
31332,24472,SQL syntax for checking to see if an INSERT was successful?,"begin try
insert query
print message
end try

begin catch
print message
end catch
"
39717,70216,How to set the 'where' clause on a field with comma-seperated values?,"SELECT  *
FROM    tableName
WHERE   FIND_IN_SET('value3', 'comma separated value here') > 0
"
39618,29740,List the contents of Oracle export dump file,"IMP SCOTT/TIGER SHOW=Y FILE=import_file.dmp
"
35215,879,confusing query,"Insert into xyz 
select * from abc where abc.pk_id = 1234 and exists (select 1 from pqr)
"
16204,6475,MySQL Weekday/Weekend count - Part II,"SELECT 
  fname, 
  MONTH(eventDate), 
  SUM(IF(WEEKDAY(eventDate) < 5,1,0)) AS WeekdayCount,
  SUM(IF(WEEKDAY(eventDate) >= 5,1,0)) AS WeekendCount
FROM eventcal AS e
LEFT JOIN users AS u ON e.primary = u.username
GROUP BY fname, MONTH(eventDate);
"
31719,37435,Reseed identity column in SQL Compact,"ALTER TABLE [MyTable] ALTER COLUMN [Id] IDENTITY (1,1)
"
9387,23013,Oracle REGEXP_SUBSTR not working with my pattern,"([A-Za-z0-9]+)\{([-0-9+ */)(]+)\}#([A-Za-z0-9_]+)#
"
37783,39093,Oracle-DBMS jobs scheduler change the start time,"DBMS_JOB.CHANGE (
   job       => your_job_id,
   interval  => 'trunc(sysdate) + 1 + 9/24');
"
16336,67174,Require an explicit value in an UPDATE statement?,"if Update(column)
    --do whay you want;BEGIN....END;
"
812,41675,Process a Repeatable Subset of Records in a SQL Server 2000 Table,"SELECT id, requestor, status, created, queuetime
FROM requests
WHERE status = 1
    AND ID % 3 + 1 = 2
ORDER BY queuetime
"
536,33707,SQL - SELECT * FROM posts WHERE id_user IN SUBQUERY?,"SELECT * 
FROM 
    posts P
INNER JOIN 
    friends F ON P.id_user = F.id_friend 
WHERE F.id_user  = :some_id_user
"
28845,47324,T-SQL query to remove non matching value from ColumnA where value doesn't exist in ColumnB,"UPDATE TableA
SET columnA = ''
FROM
    TableA 
    LEFT JOIN TableB ON TableA.columnA = TableB.columnB
WHERE
    TableA.columnA IS NOT NULL AND TableA.columnA <> '' AND
    TableB.columnB IS NULL;
"
26280,10089,SQL join 3 tables (based on 2 criterias?),"SELECT
    tt.id,
    CASE WHEN tt.tr_type = 'project' THEN pp.project_name
         WHEN tt.tr_type = 'task' THEN ta.task_name END as name,
    tt.tr_proj_id,
    tt.tr_type,
    tt.tr_min,
FROM time_tracking as tt
   left join time_projects as pp on pp.id = tt.tr_proj_id
   left join time_tasks as ta on ta.id = tt.tr_proj_id
WHERE tt.tr_min > 0
ORDER BY tt.tr_proj_id DESC
"
24658,31135,Comparing two large tables in SQL,"idtracker(uuid) and download_tracker(pluginId)
"
8330,7084,SQL select query help required,"SELECT  t.*
FROM    (
    SELECT  @lim := 2,
            @cg := ''
    ) vars,
    (select * from Table1 order by product,amount, make)  t
WHERE   CASE WHEN @cg <> product THEN @r := @lim ELSE 1 END > 0
    AND (@r := @r - 1) >= 0
    AND (@cg := product) IS NOT NULL
ORDER BY
    product,amount, make
"
943,8383,VBA Code to Close an Access Database Without Leaving a Shell of the application open,"Dim appAccess As New Access.Application

' Do stuff here...

appAccess.Application.Quit
"
5328,47246,How to make this query start digits with ORMLite querybuilder?,"GenericRawResults<T> rawResults = getYourDao().queryRaw(
    ""SELECT * FROM "" + [tables] + "" WHERE "" + [column] + "" REGEXP '[0-9]+'"",
    getYourDao().getRawRowMapper(), String...params);
List<T> dataList = rawResults.getResults();
"
14183,37576,How to include sid and port into an oracle connection string?,"return String.Format(""SERVER=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST={0})(PORT={1}))(CONNECT_DATA=(SID={2})));uid={3};pwd={4};"", host, port, sid, user, pass);
"
24079,481,Can i have one row in select from other table than currently referred ?,"Select count( a.""col_A1"") as ACount
,      sum(a.""col_A2"") as ASum
,      (Select count(b.""col_B1"") from B b) as BCount 
From A a
GROUP BY 1
"
25137,22662,DB2 need help for alter table alter column set data type,"ALTER TABLE MY_TABLE ADD COLUMN Temporary decimal(11,2);
UPDATE MY_TABLE SET Temporary=CAST(COL1 AS DECIMAL(11,2);
ALTER TABLE MY_TABLE DROP COLUMN COL1;
ALTER TABLE MY_TABLE  CHANGE Temporary COL1 decimal(11,2);
"
10370,73371,Check if 2 users are in the same room with mySQL,"SELECT DISTINCT u1.roomID AS roomID
FROM   user_to_room u1, user_to_room u2
WHERE  u1.userID = 1 AND u2.userID = 2
AND    u1.roomID = u2.roomID;
"
3428,54689,"sql-server, count rows where column matches string and id is not repeated","SELECT count(id), state
FROM table_name
WHERE id IN (SELECT id FROM table_name GROUP BY id having count(id) = 1) and state = 'Alabama'
GROUP BY state
"
39455,37198,Separate resultset from hashtable into 3 tables ,"A   B   C
1   2   3
4   5   6
7   8   9
10  11  12
"
5657,49704,Update Statements,"update plantfunctiontable set decommissioned=1 where plantunitid  between 49 and 57
"
12299,12468,Selecting one value and not the other,"SELECT *
FROM <TABLE> 
WHERE CD='S' AND ID NOT IN(SELECT ID FROM <TABLE> WHERE CD='P')
"
19537,17579,Inserting a select statement into a if statement,"UPDATE database.corpdb_10102014.dbo.retail_setup    
SET BATCH_MASTER_POS = myvalue
WHERE class_of_trade = 'Fuel Center'
"
23018,59946,Creating a summary report by group and quarter SQL,"select      id
            , type
            , tag
            , sum(case when qtr = 1 then amt else 0 end) as qtr1
            , sum(case when qtr = 2 then amt else 0 end) as qtr2
from        tbl
group by    id
            , type
            , tag
"
4629,41316,Conditional join of table based on existence of value,"SELECT 
...
CxA.SubscriptionNumber
FROM
    MyTables
CROSS APPLY
    (SELECT CASE 
        WHEN (House of person has subscription)
        THEN (return subscription number of house)
        ELSE (return subscription number of person)
    END) CxA(SubscriptionNumber)
"
31012,19348,SQL-Delete from a table based on a nested query,"DELETE FROM orderdetail 
WHERE orderdetail.order_sequence_number IN 
(
    SELECT id 
    FROM orders 
    WHERE date_ordered BETWEEN X AND Y
)
"
9068,25318,How many times trigger in MySQL is called?,"INSERT INTO trigger_log(query) VALUES(?)
"
33960,5281,Preparing Items List Of Sql-Table,"select  name
,       case 
        when sum(amount1 - amount) < 0 then -sum(amount1 - amount) 
        end as amount
,       case 
        when sum(amount1 - amount) >= 0 then sum(amount1 - amount) 
        end as amount1
from    YourTable
group by
       name
"
7747,37289,Select the customer who has the most different categories in his orders,"Select * from
(
Select C.CUSTOMERID, C.FIRSTNAME , C.LASTNAME, count(distinct P.""CATEGORY"") as Categories
from Customers C
inner join Orders O on O.CUSTOMERID =C.CUSTOMERID
inner join OrderLines OL on O.ORDERID =OL.ORDERID 
inner join Products P on P.PROD_ID =OL.PROD_ID 
group by C.CUSTOMERID, C.FIRSTNAME , C.LASTNAME
Order by count(P.""CATEGORY"") desc)A
WHERE rownum = 1;
"
1621,47305,Is it possible to group by a few different date periods in mysql?,"select '1_Day' as period , count(*) as Total
from likes
where like_date>(sysdate-1)
union
select '7_days'  , count(*)
from likes
where like_date>(sysdate-7)
union
select '1_month'  , count(*)
from likes
where like_date>(sysdate-30)
union
select '1 year'  , count(*)
from likes
where like_date>(sysdate-365)
"
35288,46981,Postgresql : Loop thorugh each table and check for column?,"DO
$$
DECLARE
    rec record;
BEGIN
    FOR rec IN 
        SELECT table_schema, table_name, column_name
        FROM information_schema.columns 
        WHERE column_name = 'x'
    LOOP
        EXECUTE format('ALTER TABLE %I.%I RENAME COLUMN %I TO newname;',
            rec.table_schema, rec.table_name, rec.column_name);
    END LOOP;
END;
$$
LANGUAGE plpgsql;
"
29191,65939,How to use max function with select top in sql,"WITH CTEQuery (AccountId) AS (
    SELECT TOP 10 AccountId 
    FROM TempAccount
)
SELECT MAX(AccountId) 
FROM CTEQuery
"
33559,65277,Inserting rows into a MySQL table based on a query,"INSERT INTO X (xa, xb, xc) 
   SELECT A.a, A.b, A.c
     FROM A
LEFT JOIN X ON A.a = X.x
    WHERE X.x IS NULL
"
10701,2003,Matching two databases and insert same rows to another,"UPDATE db1.table1 JOIN db2.table2 on db1.table1.movie_name = db2.table2.movie_name AND db1.table1.year = db2.table2.year SET db1.table1.synopsis = db2.table2.synopsis, db1.table2.AKA = db2.table2.AKA
"
17477,5628,Find a string between two string values,"SELECT
    SUBSTRING(MyColumn, CHARINDEX('_', MyColumn)+1,
        CHARINDEX('_', MyColumn, CHARINDEX('_', MyColumn)+1)-CHARINDEX('_', MyColumn)-1)
FROM
    MyTable
"
29509,38574,Issues with mixed join query in MySQL 5.5 though worked in MySQL 4.1.25,"select p.id, ps.pid, ps.sid, s.id
from p cross join
     s left join
     ps
     on p.id=ps.pid s and ps.sid=s.id;
"
4137,7360,SQL: Agregate function for user defined type,"source sysibm.max(integer);
"
3502,43337,Designate different connection string within SQL Query,"INSERT INTO dbo.local_table (list, of, columns)
  SELECT list
       , of
       , columns
  FROM   linked_server.database_name.dbo.not_so_local_table
"
34904,43335,How to fetch count of every classid from DB table in Mysql see below for detail,"SELECT classid, COUNT(*) FROM table1 GROUP BY classid;
"
8574,49077,Help me find blocks of data,"SELECT Id, EmployeeID FROM
(
SELECT r.Id, r.EmployeeID, 
(SELECT COUNT(1) FROM recs r1 WHERE (r1.EmployeeID = r.EmployeeID AND r1.id = r.Id-1) AS c1,
(SELECT COUNT(1) FROM recs r2 WHERE (r2.EmployeeID = r.EmployeeID AND r2.id = r.Id-2) AS c2,
(SELECT COUNT(1) FROM recs r3 WHERE (r3.EmployeeID = r.EmployeeID AND r3.id = r.Id-3) AS c3
FROM recs r1) tab1
WHERE (tab1.c1+tab1.c2+tab1.c3 =3);
"
17678,45739,How can I group by date starting at a different time than midnight?,"SELECT CAST(Date as DATE) as DayDate, SUM(Books) as LostBooks
FROM (select rbv.*,
             cast(dateadd(h, -7, date) as date) as newdate
      from RestartBooksView rbv
     )
WHERE Name = 'AUHT167' and newdate > (getdate() - 105)
GROUP BY newdate
ORDER BY CAST(Date as DATE) ASC
"
21292,8751,How to use group by in this cquery?,"SELECT eav.value AS 'unspsc',COUNT( e.sku)
FROM catalog_product_entity e
JOIN catalog_product_entity_varchar eav
  ON e.entity_id = eav.entity_id
JOIN eav_attribute ea
  ON eav.attribute_id = ea.attribute_id
WHERE ea.attribute_code = 'unspsccode'
GROUP BY eav.value
"
25395,57724,multiple rows into a single row,"SELECT DISTINCT
       ACCOUNTNO
      ,STUFF((SELECT DISTINCT ',' + CONCAT(DT,POSTDT,CD,NO,SEQNO)
              FROM Table1 a 
              WHERE a.ACCOUNTNO = b.ACCOUNTNO
              FOR XML PATH(''), TYPE).value('.', 'VARCHAR(MAX)'),1,1,'')

FROM Table1 b
"
19611,1931,How to Pivot the Results of a Stored Procedure in SQL Server,"select *
from 
(
    select date, value, unit
    from 
    (
        select *
        from t1
    ) x
    unpivot ([value] for unit in ([unita], [unitb], [unitc])) u
) a
pivot
(
    sum(value)
    for date in ([2010], [2011], [2012])
) p
"
15308,68812,Case statement that adds column values,"select 
id,
    CAST( (CASE WHEN race1 IS NOT NULL THEN 1 ELSE 0 END)
   +(CASE WHEN race2 IS NOT NULL THEN 1 ELSE 0 END)
   +(CASE WHEN race3 IS NOT NULL THEN 1 ELSE 0 END) AS CHAR) + '-3'
AS General_Turnout
from test4
"
13234,37950,Cannot save structure into mongodb with golang (only empty records created),"type Result struct {
    Nid         string
    Timestamp   int64
    Hexhash     string
    Addr        string
}
"
11211,55093,Using git repository as a database backend,"│              │ Users │ Active users │ DB+edits │ DB only │
├──────────────┼───────┼──────────────┼──────────┼─────────┤
│ MusicBrainz  │  1.2M │     1K/week  │   30 GiB │  20 GiB │
│ en.wikipedia │ 21.5M │   133K/month │    3 TiB │  44 GiB │
│ OSM          │  1.7M │    21K/month │  726 GiB │ 480 GiB │
"
5282,57395,Storing one or several sql statements as a variable in a stored procedure in SQL Server,"DECLARE @SQLQuery varchar(500)

SET @SQLQuery = 'SELECT * FROM Employees WHERE EmployeeID = 123'

EXECUTE(@SQLQuery)
"
11115,27846,"How to process an sql query with the word ""only""?","SELECT Distinct p.FullName
FROM dbo.People p
JOIN dbo.PlacesTheyGo ptg ON ptg.PeopleID = p.PeopleID
WHERE ptg.Place = 'Wedding' 
AND NOT EXISTS (SELECT 1 FROM dbo.PlacesTheyGo ptg2 
WHERE ptg2.PeopleID = p.PeopleID 
AND ptg2.Place <> 'Wedding')
"
784,50841,SQL delete rows by selection of foreign keys,"DELETE  FROM attendees WHERE event_id = IN  (SELECT id FROM events WHERE enddate <= DATE_ADD(CURDATE(), INTERVAL -90 DAY))


DELETE  FROM events WHERE enddate <= DATE_ADD(CURDATE(), INTERVAL -90 DAY)
"
38324,6976,Always show decimal places in SQL?,"TO_CHAR(pAmount, '9,999,999.99');
"
35871,29281,SQL: Return a list of users who visited the same place,"select vy.userid
from visitation vx left join
     visitation vy
     on vx.placeid = vy.placeid and vx.userid <> vy.userid
where vx.userid = 1
group by vy.userid
having count(*) = count(vy.placeid);
"
25465,68218,insert into database the input fields,"<group string="" "">
<field name=""code""/>
<field name=""name""/>
<field name=""nameBilhetes""/>
<field name=""recinto_id"" on_change=""insert_piso(code,name,nameBilhetes,recinto_id)""/>   
</group>
"
27988,9893,How to count number commas present in a CSV file,"with tbl(data_string) as
(
select '1234,""djjdjd"",45566,84774,45666,""djdjd""' from dual
)
select regexp_count(data_string, ',') from tbl;
"
34931,38250,Fetching max number from sqlite database in android," Cursor c=db.rawQuery(""select MAX(index_no) as MAX_NO from CheckIN_master"",null);
     if(c!=null){
         while(c.moveToNext())
         {
             in_no=c.getInt(c.getColumnIndex(""MAX_NO""));
         }
     }
"
22151,61758,Is there a way to break out a row if it meets a certain value?,"select t.id, coalesce(a.alt, t.food) as food
from t outer apply
     (select alt
      from (values ('Apple'), ('Banana'), ('Orange')) v(alt)
      where t.food = 'Fruit'
     ) a;
"
23757,40588,"Difference between row dates, in days, from the first entry to the current row entry","SELECT date - first_value(date) OVER (ORDER BY date) + 1;
"
36460,23822,How to deal with single quote in Word VBA SQL query?,"customerName = Replace(customerName, ""'"", ""''"")
"
23485,65439,Get the average with quantity,"select coalesce(sum(quantity * unit_price) /sum(quantity), 0) from
(select 
   sum(case when action='unit_price' then data else 0 end) as unit_price,
   sum(case when action='quantity' then data else 0 end) as quantity 
 from test
group by user) as a
"
33035,42680,sql query not giving expected results in sql server,";WITH IntervalCTE AS
(
  SELECT [start] AS Value, [end], [interval]
  FROM T
  UNION ALL
  SELECT [Value] + [interval], [end], [interval]
  FROM IntervalCTE
  WHERE [Value] < [end]
)
SELECT Value FROM IntervalCTE ORDER BY Value
"
14819,20068,how can I group by elements from one table and group by it by 2 columns?,"SELECT  * 
FROM 
(
    SELECT  DATEDIFF(now(), start_time) AS days_ago, 
            number_id, 
            COUNT(table_id)             AS num_texts 
    FROM    TABLE 
    GROUP BY DATE(start_time), number_id 
) 
WHERE 
    days_ago <= 7 
AND days_ago > 0
"
35518,49296,Sorting '£' (pound symbol) in sql,"with tmp_tab as (
    select '&!@#' as value from dual
    union all select '££$$' from dual
    union all select 'abcd' from dual
    union all select '&#$%' from dual
)
select * from tmp_tab
order by nlssort(value, 'NLS_SORT = WEST_EUROPEAN')

VALUE
------
&!@#
&#$%
££$$
abcd

4 rows selected.
"
5166,74007,Removing duplicated subquery in pl/sql procedure,"WITH VIEW_A AS
(
    [very long select statements]
)
OPEN p_cursor FOR

SELECT COL_A, COL_B, SUM(COL_C), SUM(COL_D), NULL AS COL_1, NULL AS COL_2, NULL AS COL_3, NULL AS COL_4
FROM VIEW_A
GROUP BY COL_A, COL_B
WHERE p_YN = 'Y'

UNION ALL

SELECT NULL AS COL_A, NULL AS COL_B, NULL AS COL_C, NULL AS COL_D, COL_1, COL_2, SUM(COL_3), SUM(COL_4) 
FROM VIEW_A
GROUP BY COL_1, COL_2
WHERE p_YN <> 'Y';   
"
10655,56219,Return rows for IN query with failed look-ups returning NULL,"select x.a, c.b
from (
  select 'v1' as a union all
  select 'v2' as a union all
  select 'v3' as a
) x
left outer join c on c.a = x.a
"
15493,12633,Oracle ranking with condition,"with x as (
    select 1 col1, 1 col2, 2 col3 from dual union all
    select 1, 3, 33 from dual union all
    select 2, 4, 5 from dual union all
    select 3, 6, 40 from dual union all
    select 1, 2, 5 from dual union all
    select 3, 5, 10 from dual
 )
 select col1, col2, col3,
        sum( case when col3 > 30 then 1 else 0 end ) 
          over( partition by col1
                order by col2 ) + 1 rnk
   from x
"
33763,60517,how to get certain numbers,"SELECT
    SUBSTRING(col, CHARINDEX('(', col) + 1, CHARINDEX(')', col) - CHARINDEX('(', col) - 1)
FROM
    Some_Table
"
36559,54075,Adding Constraints to Attributes,"create table Children
(
  child_id int not null primary key,
  fname varchar(24),
  lname varchar(24),
  phone int,
  grade varchar(24),
  CONSTRAINT chk_Grade check grade IN ('Beginner' ,'Novice' ,'Skilled' ,'Expert')
)
GO
"
9117,26485,MySQL Join Query confuse,"select A.product_desc,
       (select sum(B.qty) from product_sales_branch_a B where B.product_id = A.product_id),
       (select sum(C.qty) from product_sales_branch_b C where C.product_id = A.product_id) 
from product A 
where A.product_id = 'ABC'
"
6643,2357,How to select a newest row from table?,"outer apply (
   select top 1
          Intensity.NumAll
        , Intensity.AverageDailyIntens
        , Intensity.AverageDailyIntensCar
        , Intensity.Loading   
   from Intensity 
   where  Segment_ID.Segment_ID = Intensity.Segment_ID
   ORDER BY Intensity.your_date_field DESC
   ) a
"
16706,40167,Microsoft SQL between statement for characters is not inclusive?,"select * from tblprofile where firstname >= 'a' and firstname < 'e'
"
17105,68738,Hierarchical Data Join of parent/child relationship in same table,"CREATE TABLE `tree_for_my_table` (
`rootID` INT(11) NOT NULL, // root node id
`parentID` INT(11) NOT NULL, // current parent id
`childID` INT(11) NOT NULL, // child id (direct child of the parent)
`level` INT(11) NOT NULL, // how far child is from root
PRIMARY KEY (`rootID`, `parentID`, `childID`),
UNIQUE INDEX `childID` (`childID`, `level`)  
 )
"
18950,34329,How to JOIN ON when both tables contain NULL,"SELECT    t1.column1, t1.column2, t2.column1, t2.column2 
FROM      table1 t1
LEFT JOIN table2 t2 
       ON t1.column1 = t2.column1 AND t1.column2 <=> t2.column2
"
33921,50676,To update data in a column based up on data from 2 other tables,"UPDATE ccdocs d
SET location_id = loc.loc_id
FROM doc_location loc
JOIN cclvig c ON c.location = loc.lctn
WHERE d.index = c.index;
"
7594,14859,hive-drop-import-delims not removing newline while using HCatalog in Sqoop,"sqoop import --connect jdbc:oracle:thin:@ORA_IP:ORA_PORT:ORA_SID \
--username user123 --password passwd123 -table SCHEMA.TBL_2 \ 
--hcatalog-table tbl2 --hcatalog-database testdb --num-mappers 1 \ 
--split-by SOME_ID --columns col1,col2,col3,col4 --hive-drop-import-delims \
--outdir /tmp/temp_table_loc --class-name ""SqoopWithHCAT"" \
--null-string """" --map-column-java col4=String
"
19566,63542,Replacing All Column and Table Names in MySQL Database,"select concat('rename table ', table_name, ' to ', substring_index(table_name, 'car', 1), 'vehicle',  substring_index(table_name, 'car', -1), ';')
from information_schema.tables
where table_schema = 'your_schema'
  and table_name like '%car%';
"
20164,19954,How to remove hex characters from DB?,"UPDATE tbl
SET col = REPLACE(col, '%20', UNHEX('20'))
WHERE col LIKE '%\%20%';
"
18605,33874,Fetch only N rows at a time (MySQL),"SELECT * FROM table LIMIT 0,20
"
35393,9806,SQL reference to current row,"SELECT MONTH(Date) as Date, COUNT(Id) as Bets,
       SUM(CASE WHEN Status = 1 THEN 1 ELSE 0 END) as Won
FROM Bets
GROUP BY MONTH(Date);
"
7692,74510,SQL strict enforce of order by a date column,"select A, C from TableA where A >=0 order by C asc, A asc, B asc, D asc
"
19325,63292,SQL query that will generate child_id recursively,"SELECT organization_id, name
FROM t
CONNECT BY PRIOR organization_id = parent_id
START WITH organization_id = 2
"
4675,69615,MySQL Query: Get new customers in the month,"select customer_id , min(date) as min_date
from theTable
group by customer_id 
having min_date>=<the desired date>
"
8215,74552,Why do the NULL values disappear from my SELECT/JOIN Result when add a filter criteria?,"where u.regcode != 9999 or u.regcode is null
"
25943,34082,Multiple case merge sql,"Select *     from a 
inner join   b on a.cusip=b.cusip 
or           a.ticket = b.ticket;
"
33702,51172,JPA and 2 simple tables,"@Entity class A...{ 
@OneToMany(fetch=FetchType.EAGER)     
Collection getB(){...} }
"
9330,29146,Finding rows matching positive and negative,"SELECT x1.<cols>, x2.<cols> 
FROM dbo.YourTable AS x1
INNER JOIN dbo.YourTable AS x2
  ON x1.Vendor_Code    = x2.Vendor_Code
 AND x1.Invoice_Number = x2.Invoice_Number
 AND x1.Check_Number   = x2.Check_Number
 AND x1.Payment_Amount = -x2.Payment_Amount;
"
29186,52356,Compare 3 tables in SQLite,"SELECT course.* FROM course INNER JOIN jobscourse ON jobscourse.cID = course.cID WHERE jobscourse.jID = ?
"
9076,54684,how to use tns entries with macromedia drivers for Oracle,"jdbc:macromedia:oracle:TNSNamesFile=C:\\Oracle\\product\\11.2.0\\client_1\\network\\admin\\tnsnames.ora; TNSServerName=tnsentry
"
17175,11975,"User emails with whitespaces, fix with MySQL?","update users set email = TRIM(email);
"
22346,66239,insert new values without overwriting previous values sql,"insert into table_name (order, firstname, lastname, email, contacttypeid) 
values (1284480, 'joe'...);
"
26543,11724,SQL INNER JOIN ON LIKE,"SELECT  DISTINCT tableA.group
FROM    tableB
INNER JOIN
        tableA
ON      tableA.group LIKE CONCAT(tableB.groups, '%')
"
31572,36064,returning partially distinct/unique rows,"SELECT a.*
FROM Table as a
JOIN (
   SELECT ProductCode, SerialNumber, MAX(DatePurchased) as MaxDate 
   FROM Table
   GROUP BY ProductCode, SerialNumber
) as b ON
   a.ProductCode = b.ProductCode
   AND a.SerialNumber = b.SerialNumber
   AND a.DatePurchased = b.MaxDate
WHERE
   a.CustomerID = 'xxx'
"
27408,36897,Collapse SQL rows,"select demotable.*
from demotable
left join demotable as prev on prev.id = demotable.id - 1
where demotable.name != prev.name
"
17967,1232,Opening csv-File via ADO-connection - Column Limitation to 255 / or just use another file type?,"Dim FileNum As Integer
Dim DataLine As String
Dim SplitData()


FileNum = FreeFile()
Open ""Filename"" For Input As #FileNum

While Not EOF(FileNum)
    Line Input #Filename, DataLine ' read in data 1 record at a time
    SplitData = Split(DataLine, "","")
    'Process big array
Wend
"
28102,45410,get friend list in mysql,"select UserID from Friends
where FriendID = 1001
Union All
select FriendID from Friends
where UserID = 1001
"
25161,21562,Selecting non-duplicates based on date column - SQL Server,"WITH records AS
(
    SELECT  ID,cID,DateSaved,Address ,[Phone Number],
            ROW_NUMBER() OVER (PARTITION BY cid ORDER BY DateSaved DESC) rn
    FROM    ClientRecordEntries
)
SELECT  a.*, DateSaved,Address ,[Phone Number]
FROM    Clients a
        INNER JOIN records b
            ON a.ID = b.cid
WHERE   b.rn = 1
"
36408,39980,Best way to subtract SUM and COUNT with 2 table select?,"   SELECT s.release_id,
          (SUM(s.Shipments) -
           (SELECT COUNT(*) 
            FROM shipments sh
            WHERE sh.release_id = s.release_id
           )
          ) AS shipments_left
   FROM subscriptions s
   WHERE is_paid = 1 AND shipments > 1
   GROUP BY s.release_id;
"
25350,12434,SQL Query help: Getting counts based on combination of columns,"SELECT  m2.variable, m2.attr, m2.state, COUNT(*)
FROM    mytable m1
JOIN    mytable m2
ON      m2.date = m1.date
WHERE   (m1.variable, m1.attr, m1.state) = ('V2', 'A3', 2)
GROUP BY
        m2.variable, m2.attr, m2.state
"
33384,20394,Joining two tables on different database servers,"SELECT 
    [column_list]
FROM companies
    JOIN [server_name].[database_name].[schema_name].[table_name]
WHERE ...
"
33638,62757,How to substract cummulative in SQL from column to column,"SELECT
    Contact
,   Customers
,   (SELECT SUM(Customers) FROM myTable t2 WHERE t2.Contact >= t1.Contact) as CummCustomers
FROM myTable t1
"
3494,20356,How do you order by negative and positive numbers DB2 Sql Syntax,"order by OIPRI * 1 ASC
"
24015,4265,Calculate the time after converting into a new datatype,"SELECT ROUND(CAST( Mins AS FLOAT)/60,2) AS [hour]
FROM (
SELECT DATEDIFF(minute, CAST(StartTime AS TIME),CAST(EndTime AS TIME)) AS Mins 
    FROM  Data
) A
"
28321,7815,SQL join: selecting the last records in a one-to-many relationship,"SELECT c.*, p1.*
FROM customer c
JOIN purchase p1 ON (c.id = p1.customer_id)
LEFT OUTER JOIN purchase p2 ON (c.id = p2.customer_id AND 
    (p1.date < p2.date OR p1.date = p2.date AND p1.id < p2.id))
WHERE p2.id IS NULL;
"
7054,49667,how to find SP Reference,"SELECT OBJECT_NAME(m.object_id), m.*
  FROM SYS.SQL_MODULES m
 WHERE m.definition LIKE N'%my_sp_name%'
"
35065,28012,SQL merge columns with specific criteria,"select id, startcity, endcity
from (select c.id, c.startcity, c.endcity, 1 as ordering
      from customer c
      where c.username = USERNAME
      union all
      select  cl.id, cl.startcity, cl.endcity, 2 as ordering
      from client cl join
           customer c
           on cl.startcity = c.startcity or cl.endcity = c.endcity
     ) c
order by ordering;
"
26234,34751,Signal from Database,"USE AdventureWorks2012;
GO
IF OBJECT_ID ('Sales.reminder2','TR') IS NOT NULL
    DROP TRIGGER Sales.reminder2;
GO
CREATE TRIGGER reminder2
ON Sales.Customer
AFTER INSERT, UPDATE, DELETE 
AS
   EXEC msdb.dbo.sp_send_dbmail
        @profile_name = 'AdventureWorks2012 Administrator',
        @recipients = 'danw@Adventure-Works.com',
        @body = 'Don''t forget to print a report for the sales force.',
        @subject = 'Reminder';
GO
"
10214,21304,"SQL queries: how to add ""sum"" along with the corresponding data","select 
  p.name,
  p.price,
  op.order_id,
  op.product_id,
  Totals.theSum
from products p
  inner join orders_products op on op.product_id = p.id
  inner join
  (select sum(p.price) as theSum,
    op.order_id
   from products p 
     inner join orders_products op on op.product_id = p.id 
   where op.order_id in (1, 2)
   group by op.order_id) AS Totals
on Totals.order_id = op.order_id;
"
2063,60594,How to delete from select in MySQL?,"DELETE FROM posts WHERE id IN (
    SELECT * FROM (
        SELECT id FROM posts GROUP BY id HAVING ( COUNT(id) > 1 )
    ) AS p
)
"
25121,9405,SQL Issue with my query,"SELECT E1.ID, AVG(E2.SALARY) 
FROM EMP E1
JOIN EMP E2 
   ON E1.ID <> E2.ID AND 
      E1.DEPARTMENT = E2.DEPARTMENT AND
      ABS(E1.SALARY - E2.SALARY) <= 100 
GROUP BY E1.ID
"
4810,20481,"SQLite, sliding to get results based on value and date","SELECT *
FROM Data
WHERE company IN (SELECT company
                  FROM Data
                  GROUP BY company
                  HAVING max(value) <= 20)
"
25989,20519,MySQL Like function only works on some tables,"SELECT name FROM table WHERE name LIKE '%'
"
4254,39243,Limiting the Number of Rows Deletes in SQLITE DB,"String sql = ""DELETE FROM strategyTotal WHERE _id IN (SELECT _id FROM strategyTotal WHERE strategy_prices = (?) LIMIT 1);"" ;
db.execSQL(sql, new Double[] {subtractedStrategyPrice });
"
31617,75410,In SQL How can I describe the structure of a result set?,"SELECT * INTO ##newtable 
FROM (SELECT DISTINCT 
             t3.ID,
             t4.ID
       FROM 
       t2 INNER JOIN
       t3 on t3.ID = t2.t3ID INNER JOIN 
       t4 on t4.ID = t3.t4ID 
      ) as b

SELECT * FROM ##newtable
"
16631,71990,selecting partially matching data,"SELECT *
FROM
(
SELECT name AS 'Asset' FROM Table1 WHERE name NOT LIKE '%.%'
) AS A 
JOIN 
(
SELECT name AS 'Files' FROM Table1 WHERE name LIKE '%.%'
) AS B 
ON A.Asset = SUBSTRING(B.Files, 1, INSTR(B.Files, '.') - 1)
"
10549,39063,Sql inner query issue,"select top 100 * from tbl_test 
"
29248,68312,What does this code do: `dbo.sp_set_sqlagent_properties @local_host_server`,"EXEC msdb.dbo.sp_set_sqlagent_properties @email_save_in_sent_folder=1, 
        @databasemail_profile=N'(myservername)', 
        @use_databasemail=1
GO
"
14167,58123,SQL query for post and replies,"select *from post where post_id=1 or post_id in (select post_id from post_reply where parent_id=1);
"
34263,33871,"tag=""value"" and <tag>value</tag>"," SELECT Tbl.Col.value('userId[1]','int'),
 Tbl.Col.value('userName[1]', 'NVARCHAR(50)'),
 Tbl.Col.value('password[1]', 'NVARCHAR(50)')
 FROM @xml.nodes('//row') Tbl(Col)
"
29757,41061,Select query filtering by datediff,"SELECT *
FROM myTable
WHERE birthdate >= 'date1' AND death <= 'date2' AND age > 17 AND age < 55;
"
6829,19221,Query - Sum with Conditions in Partition Clause?,"Sum(case when ColB = 1 and ColC > 0 then ColC else 0 end) over(partition by ColA)
"
26725,55411,Alternative for exists query,"UPDATE tab1
INNER JOIN tab2 ON --some join condition
SET sbd = --something
AND abc = --other something
WHERE --some conditions
"
6182,7505,How to merge db rows together?,"SELECT q.QuestionId,
       q.QuestionContent,
       GROUP_CONCAT(an.Answer, SEPARATOR ' ')
FROM Answer an
INNER JOIN Question q ON q.AnswerId = an.AnswerId
GROUP BY q.QuestionId,
       q.QuestionContent 
"
36520,56380,How to get records that exist in one MySql table and not another,"SELECT wafer_log.wafer, wafer_log.id AS wlid 
FROM wafer_log
WHERE wafer_log.id NOT IN (SELECT id FROM bt_log);
"
36190,32732,How to make SQL-injection proof calls to custom table I have created in my Wordpress Database?,"SELECT ... LIMIT  0,9;  -- get 9 records starting from record 0
SELECT ... LIMIT  9,9;  -- get 9 records starting from record 9
SELECT ... LIMIT 18,9;  -- get 9 records starting from record 18
-- etc
"
15178,65590,How can I assign inserted output value to a variable in sql server?,"DECLARE @id int
DECLARE @table table (id int)
INSERT INTO MyTable(name)
OUTPUT inserted.id into @table
VALUES('XYZ')

SELECT @id = id from @table
"
23026,60745,SORT BY in SELECT,"SORT it_abs3 BY request_id [ASCENDING] version_no DESCENDING.
DELETE ADJACENT DUPLICATES FROM it_abs3 COMPARE request_id.
"
2773,47394,How to do a pivot - group by - pivot,"select * from
(
  select DISTINCT Person_Id, name, Year, Month From DatasetMonthYear
) Src
Pivot
(
  Count(Month) For Year In ([2007],[2008])
) Pvt
"
34952,56672,vb.net sql last inserted ID,"sql = ""INSERT INTO...;SELECT @@IDENTITY..."" 
Dim id = sqlCommand.ExecuteScalar(sql)
"
35227,61242,Limiting SQL Results Based on Date,"WHERE (trunc(sysdate) - trunc(\""DATE\""))<=365;
"
31212,47814,hierarchical sum in PostgreSQL,"WITH RECURSIVE children AS (
    -- select leaf nodes
    SELECT id, value, parent
        FROM t
        WHERE value IS NOT NULL
    UNION ALL
    -- propagate values of leaf nodes up, adding rows 
    SELECT t.id, children.value, t.parent
        FROM children JOIN t ON children.parent = t.id
)
SELECT id, sum(value) 
    FROM children 
    GROUP BY id   -- sum up appropriate rows
    ORDER BY id;
"
31166,65127,mysql formatting a date,"SELECT 
   ACCESSSTARTS, 
   date_format(str_to_date(ACCESSSTARTS, '%d.%m.%Y %k:%i:%s'), '%d %m %Y' ) AS shortDate
FROM AUCTIONS 
WHERE upper( ARTICLE_NAME ) LIKE '%hardy%' 
LIMIT 0 , 10;
"
21518,13274,MySQL Comparison in two tables,"select p.*
from products p
left join span_products s on s.part_no = p.part_no
where s.part_no is null
"
7390,53109,MySQL member of several teams,"select au.userId
from active_users au
where au.teamId in (1, 2, 4)
group by au.userId
having count(*) = 3;
"
27012,31083,Subquery optimization in PostgreSQL,"with query as (
select avg(price) as ave from product)

select price, name
from product p2, query
where p2.price > query.ave
"
12993,73116,SQL Query for adding missing values for a field between two dates?,"SELECT    
        (SELECT TOP (1) Weight
         FROM BioUser AS b
         WHERE (CAST(DateTested AS Date) <= k.Date) AND (UserId= @UserId)
         ORDER BY DateTested DESC) AS Weight, Date AS DateTested
FROM     DimDate AS k
WHERE     (Date BETWEEN @StartDate AND @EndDate)
"
256,10315,Speed up Postgres Update on Large Table,"UPDATE listings a
SET master_ext_id = c.id
FROM listing_to_external_id b
JOIN external_ids c on b.external_id = c.id
WHERE a.id = b.listing_id
 AND a.master_ext_id is null
 AND c.provider_id = 0
"
1443,48163,Convert column into rows with same data SQL,"select a,b, c, null d, null e, f from t1 where c is not null
union
select a,b, null c, d, null e, f from t1 where d is not null
union
select a,b, null c, null d, e, f from t1 where e is not null
"
3328,64108,Get records that have 2 or more entries in a joining table matching a condition,"select c.*
from customers_details cd
inner join customers c
    on c.id = cd.customer_id
where cd.detail_id in (2,10)
group by cd.customer_id
having     
    sum(cd.detail_id = 2 and cd.value = 1) = 1
    and sum(cd.detail_id = 10) = 1
"
18850,15780,How to select last 6 months from news table using MySQL," .... where yourdate_column > DATE_SUB(now(), INTERVAL 6 MONTH)
"
39262,73637,Aggregate randomly?,"WITH withTable(id, fk, val, rownum) AS 
(
    SELECT
        id, fk, val, ROW_NUMBER() OVER (PARTITION BY fk ORDER BY NEWID())
    FROM
        exampleTable
)
SELECT
    *
FROM
    withTable
WHERE
    rownum = 1
"
20525,15808,"SQL - Update to table, no index","UPDATE t
SET t.[e-mail] = t2.[e-mail]
from [vdb].[dbo].[FACT_Sales] t
inner join DIM_Staff t2
on t.Name = t2.Name
"
18184,4243,SQL Query to show multiple entries and its count,"select col1, col2, count(*)
from yourTable
group by col1, col2
having count(*) > 1
"
3907,36442,MS Access SQL: Adding two COUNT statements returns multiple copies of the sum instead of one,"SELECT 
    SUM(IIF(qryAttainment.[Attainment Samples Received]=""On Time"", 1, 0)) 
    +
    SUM(IIF(qryAttainment.[Attainment CofA Issued]=""On Time"", 1,  0))
 FROM qryAttainment
"
3294,15677,When using SELECT can you modify the value of a returned field based on other fields?,"SELECT city,state,
CASE 
 WHEN (city IS NULL OR city='') AND (state IS NULL or state='') THEN ''
 ELSE country
END as country_1
 FROM `table`
"
34958,24959,Mysql composite key order relevance,"mysql> create trigger insert_check_associations before insert on associations
-> for each row
-> begin
-> if new.email1>new.email2 then
-> set @a = new.email2;
-> set new.email2 = new.email1;
-> set new.email1 = @a;
-> end if;
-> end;//
"
29531,52529,Difference between a column of two constitutive rows in SQL,"SELECT Name 
FROM
(  SELECT T.*,
       @prev as previousAge,
       @prev:=Age
   FROM T,(SELECT @prev:=NULL) as t1
   ORDER BY ID
) as T3
WHERE Age-previousAge>10
"
4068,13440,Updating one SQL table based on data in another table,"update tablea 
set sales = (select count(*) 
             from tableb 
             where tableb.leadNo = tablea.leadNo)
"
19603,34442,SQL EXISTS vs. Aggregate IS NOT NULL,"select max(1)
from (select 1 as i)t
where i = 2
"
1917,46582,How to get distinct results in one row from two column of same table?,"SELECT GROUP_CONCAT((case when senderid = 1 then recid else senderid end) SEPARATOR ', '
                   ) AS trans 
FROM test 
WHERE senderid = 1 or recid = 1 ;
"
14188,17936,How to optimize django query filter?,"from django.db import Q    
search_content = kwargs.get('search_content', '')
myfilter = Q()

for term in search_content.split('+'):
    myfilter |= Q(content__icontains=term)

result = BlogPage.objects.filter(myfilter).select_related('ImageMedia')
"
27329,59236,Max Date Based on Different Input Parameters,"DECLARE @userinput1 int = 1
DECLARE @userinput2 char = 'a' 
DECLARE @userinput3 char = 'A'

SELECT MAX(DATE)
FROM Table1 
WHERE 
    fld1 = CASE WHEN @userinput1 IS NULL THEN fld1 ELSE @userinput1 END
    AND
    fld2 = CASE WHEN @userinput2 IS NULL THEN fld2 ELSE @userinput2 END
    AND
    fld3 = CASE WHEN @userinput3 IS NULL THEN fld3 ELSE @userinput3 END
"
25969,37977,Query on Sql Joins,"SELECT
    L.LinkName, G.GroupName, 
    ISNULL(SG.SubGroupName, 'NotExist') AS SubGroupName
FROM
    Link L
....
"
3504,69484,Procedure Not Updating DB When Executing,"Exec CA66_Staff_Role_Change 700,294,'02/19/2015'
"
20848,68019,Apply window function logic on an interval,"SELECT *
FROM tab
WHERE ""Had Meeting?"" = 'Y' -- no need for rows without meeting
QUALIFY 
   COALESCE(MAX(""Month"") -- previous row's date (i.e. LAG syntax)
            OVER (PARTITION BY Customer 
                  ORDER BY ""Month""
                  ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING)
            ,DATE '0001-01-01') -- otherwise 1st row will return NULL
   < ADD_MONTHS(""Month"", -3)  -- three month before the current row's date
"
29091,45592,Format Oracle Date to work with MS Access,"SELECT TO_DATE(TO_CHAR(table.date, 'DD-MON-YYYY HH24:MI:SS'),'DD-MON-YYYY HH24:MI:SS')
FROM table.date;
"
36953,36649,SQL query to return one single record for each unique value in a column,"SELECT t.Name, t.Street, t.City, t.State
FROM table t 
INNER JOIN (
     SELECT m.Name, MIN(m.Street + ';' + m.City  + ';' + m.State) AS comb
     FROM table m
     GROUP BY m.Name
) x
   ON  x.Name = t.Name
   AND x.comb = t.Street + ';' + t.City  + ';' + t.State
"
34014,41824,How to extract Polygons from a SQL Server geometry value," SELECT @Result = @USA.STIntersection(@Bounding)   
"
22619,62873,how to select most recent data in my table?,"SELECT * 
FROM AM_HISTORY 
ORDER BY ID DESC 
LIMIT 10;
"
38798,44426,SQL 3 table join,"SELECT
  orders.order_id
FROM 
  orders
INNER JOIN
  orders_items
    ON orders.order_id = orders_items.order_id
INNER JOIN
  items
    ON orders_items.item_id = items.id
WHERE
  items.vendor = '3'
GROUP BY
  orders.order_id
"
24478,39166,Updating each row with some values of another row,"UPDATE A
SET A.PARENT_ID = B.mx
FROM MY_TABLE A
INNER JOIN (SELECT C.PARENT_ID mx, MAX(C.ID) OVER (PARTITION BY C.NAME)
            FROM MY_TABLE C
)B 
ON A.PARENT_ID=B.PARENT_ID
"
21388,14707,SQL Check if a text contains a word,"DECLARE @table_name table (
   column_name varchar(50)
);

INSERT INTO @table_name (column_name)
  VALUES ('Me and you against the world')
       , ('Can i have an email address')
       , ('This is an')
;

SELECT column_name
FROM   @table_name
WHERE  ' ' + column_name + ' ' LIKE '% an %'
;
"
9512,67759,"What is better, dynamic SQL or where case?","...
WHERE
    TD1.columnTest1 = COALESCE(NULLIF(@var1, 0), TD1.columnTest1)
    AND   
    TD2.columnTest2 = COALESCE(NULLIF(@var2, 0), TD2.columnTest2)
    AND   
    TD1.columnTest3 = COALESCE(NULLIF(@var3, 0), TD1.columnTest3)
"
28528,30483,Checking if a textbox is empty?,"If me.text13.value = 0 then
"
37777,44951,Number of decimal digits in Oracle SQL Developer query result sheet,"select to_char(salary,'999999.000'), employee_id from employees;
"
37466,39635,Transform SQL Table,"SELECT
  TN.FieldValue AS ValueName
, TV.FieldValue AS ValueAge
FROM dbo.Table1 TN
INNER JOIN dbo.Table1 TV ON TN.RecordID = TV.RecordID
  AND TN.FieldName = 'Name'
  AND TV.FieldName = 'Age'
"
3645,42937,Combine SQL Count Results,"select OSType, count(*) as TotalMachines
from (
    SELECT 'Linux' as OSType FROM Machines WHERE OperatingSystem LIKE '%Linux%'
    UNION ALL
    SELECT 'Windows' as OSType FROM Machines WHERE OperatingSystem LIKE '%Windows%'
) as subquery
GROUP BY OSType
"
36336,51363,How to control order of assignment for new identity column in SQL Server?,"SELECT
    ID, CreateDate
INTO
    MyNewTable
FROM
    (
    SELECT
        CreateDate,
        ROW_NUMBER() OVER (ORDER BY CreateDate ASC) AS ID
    FROM
        MyTable
    ) foo
"
32601,70799,Calling a column in relation to it's MAX attribute,"select *
from (
  SELECT country.name as country_name,
         city.population as city_population,
         city.name  as city_name,
         rank() over (partition by country.name order by city.population desc ) as population_rank
  FROM lab6.city
    JOIN lab6.country ON city.country_code = country.country_code
) t
where population_rank = 1;
"
33936,72136,SQL Joins - Identify the missing lines,"SELECT t.year,t.week,t.brand.....t.tag,sum(t.qty?)
FROM YourTable t
GROUP BY t.year,t.week,t.brand.....
HAVING count(CASE WHEN t.tag = 'OF' then 1 end) > 0
   AND count(CASE WHEN t.tag = 'CF' then 1 end) = 0
"
6146,46220,How to do an IN with a subquery returning 2 columns?,"SELECT *
FROM GUITARS.FENDER
WHERE EXISTS (SELECT 1
              FROM GUITARS.GUITAR_TYPE
              WHERE GuitarColor = 'RED' AND
                    FENDER.GUITARTYPE = GUITARTYPE.GUITARTYPE AND
                    FENDER.GUITARSUBTYPE = GUITARTYPE.GUITARSUBTYPE
             );
"
31877,55835,How can I specify the order of results within groups when querying Derby?,"Select o.date_created, o.buyer_name,
       (select max(date_created) from orders where buyer_name = o.buyer_name) as most_recent_date
From ORDERS o
Order By most_recent_date, o.buyer_name, o.date_created Desc
"
34259,11079,SQL Query get all values from left table and uncommon values from right table,"select id, value
from table1 t1
union all
select id, value
from table2 t2
where not exists (select 1 from table1 t1 where t1.id = t2.id);
"
3477,20501,Need Union kind of behavior without using Union of queries/resultset,"SELECT Emp.EmptId, Emp.Name,
       CASE WHEN CEmp.EmpId IS NULL THEN Emp.Class ELSE 'CAN''T DISCLOSE' END AS Class,
       CASE WHEN CEmp.EmpId IS NULL THEN Emp.Region ELSE 'CAN''T DISCLOSE' END AS Region 
FROM Employee AS Emp
LEFT JOIN ConfidentialEmployee CEmp ON Emp.EmpId = CEmp.EmpId
"
11661,23317,Convert Column from Date to Datetime Sql Server,"ALTER TABLE Tab ALTER COLUMN LastModified datetime2 not null
"
20074,32406,get records for the date in between dates,"WHERE Yourdatefield >= Cast(('08/15/2013' (Date,Format 'mm/dd/yyyy')) As Date)
"
23741,11175,Getting 4 decimal places in Postgres,"SELECT questionid,
       to_char(SUM(CASE WHEN correct = FALSE THEN 1 ELSE 0 END)::float / COUNT(*)::float,'99D9999') AS PercentWrong,
       COUNT(questionid) AS Questions
FROM asmt.testscores
WHERE testscoreid IN (SELECT DISTINCT test_score_id
                      FROM ads.fbs_assessment_adaptive_pause_staging)
AND   answered = TRUE
AND   memberid IS NOT NULL
GROUP BY questionid
ORDER BY PercentWrong
"
21319,3173,SQL - Add Column With Count(),"select
    lag(possession,1) over (order by id) as last_possession,
    possession,
    clock,
    count(*) over (partition by possession) cnt
from plays
where
    game_id in (583615)
    and league = 3
    and period in (0,1)
"
36050,8512,SQL Statement that excludes the same records in a relational database,"  SELECT ID, Nome FROM Jobs WHERE ID NOT IN (SELECT Jobs_ID FROM JobsManagement)
"
38563,75386,Selecting most recent date per ID for every day,"SELECT Serial, MAX(Date_Time) AS Date_Time
FROM [Table]
GROUP BY Serial, CAST(Date_Time AS DATE)
"
28828,49741,SQL: How do i convert period per column to period per row,"SELECT [Project Name], '2015' AS [Period], [2015] AS [Value]
FROM your spreadsheet

UNION ALL

SELECT [Project Name], '2016' AS [Period], [2016] AS [Value]
From your spreadsheet

Order By Project Name, Period
"
13625,22301,How to return first few characters in a string by trimming last 8? (SQL Server 2008),"select substring(column_name, 1, len(column_name)-8)
from table_name
"
21818,51439,Convert Access Left & Mid to SQL,"SELECT 
    name, 
    entnum,
    CASE 
        WHEN SUBSTRING(entnum,4,1) = '0' THEN SUBSTRING(entnum,5,2)
        ELSE SUBSTRING(entnum,4,3) 
    END agencycode
FROM CUSTFILE 
"
14758,64003,SQL Include 0 with Decimals,"SELECT o.id,
       (TO_CHAR(o.price, '0.00') || ' * ' || o.quantity) AS formula
FROM orders o;
"
10810,27301,Match SQL Tables and find if entry exist in each group,"select t1.Group_Id
from table1 t1 inner join
     table2
     on t2.GroupValues = t1.GroupValues
group by t1.Group_id
having count(distinct t1.GroupValues) = (select count(distinct GroupValues) from table2);
"
31288,42344,join clause not showing all results,"select  DATE_FORMAT(l.created_on,""%d/%m/%y"") as date
from logs l
left join logs_rewards lr on l.id = lr.related_log_id 
left join agents a on a.id = l.agent_id 
where l.log_status = ""1"" 
and DATE_FORMAT(l.created_on,""%m/%y"") = '12/12'
AND l.agent_id = '18' 
group by YEAR(l.created_on), MONTH(l.created_on), DAY(l.created_on) desc
"
2434,53674,Insert dynamic query results into un-defined temp table?,"SET @query = 'SELECT * INTO ##T1 FROM (
                SELECT
                   --a bunch of stuff involving joins and pivots and such
                )';

EXECUTE(@query);

SELECT *    -- reasign to local temp table to avoid reserving global ##T1 name
INTO #T1    -- if needed you can skip this part and work only on global table
FROM ##T1;

DROP TABLE ##T1;

SELECT *
FROM #T1;
"
34103,3411,Update nothing on duplicate key update,"INSERT INTO CART (ProductID, Quantity)
VALUES (1, 100)
ON DUPLICATE KEY UPDATE ProductID = ProductID;
"
23167,58575,Get the string before substring using sql?,"DECLARE @str VARCHAR(100) = '025-121-3453'

SELECT  LEFT(@str, CHARINDEX('121', @str) - 1) ,
        RIGHT(@str, CHARINDEX('121', REVERSE(@str)) - 1)
"
3690,75217,Count max number of overlapping timeranges in a timerange,"SELECT *
FROM   (
  SELECT dt AS date_from,
         LEAD( dt ) OVER ( ORDER BY dt ) AS date_to
         SUM( startend ) OVER ( ORDER BY dt ) AS num_events
  FROM   (
    SELECT date_from AS dt, 1 AS startend FROM event
    UNION ALL
    SELECT date_to, -1 FROM event
  )
)
WHERE date_from < date_to;
"
36036,12896,mysql - deleting from two tables in one query,"DELETE FROM Table1, Table2
USING Table1, Table2
WHERE Table1.month NOT IN (1,2)
  AND Table1.year NOT IN (1, 2)
  AND Table1.userId = 1
  AND Table2.userId = Table1.userId
"
36917,32274,SQL Mangement Studio/SQL: Seeing the GroupBy / Sum aggregate functions,"SELECT
    RowNum ,
    ClientName ,
    SUM(Amount) AS Amount
FROM #TempItems
GROUP BY RowNum, ClientName
"
5835,23978,select query to display Date format as DAY MMM DD YYYY in SQL server 2008,"SELECT LEFT(DATENAME(DW,GETDATE()),3) + ' ' + CONVERT(VARCHAR(12), SYSDATETIME(), 107) 
FROM yourtable
"
33771,74606,PostgreSQL Extracting DOW and Changing timezone,"select created_at at time zone 'PST'
from zendesk_tickets;
"
27141,8344,SQLite - Index of record,"select count(*) as position
from town t
where t.name <= (select t2.name from t2 where t2.idtown = 9961)
"
33374,44755,SQL select statement conditional join,"SELECT * FROM items 
WHERE bool = true
 OR ID  IN 
  (Select linked_item_id_fk 
      From items  where bool = true)
"
12486,23320,How to give a unique constraint to a combination of columns in Oracle?,"ALTER TABLE YourTable
  add CONSTRAINT YourTable_unique UNIQUE (B, C, D);
"
39234,43238,How do I compare values in two tables in TSQL Where statement?,"WHERE EXISTS (select ID 
                 from dbo.Split(@inputstring) t1 
                      inner join dbo.Split(view.ViewString) t2 on (t1.id=t2.id))
"
21852,39926,iPhone sqlite desc vs asc?,"ORDER BY score ASC
"
32023,72678,Select prepared-statement row count,"Dim dt As DataTable = New DataTable()
dt.Load(cmd.ExecuteReader())
"
9595,50719,MySql order by related with today's date,"SELECT *, DATEDIFF(`date`, CURDATE()) AS diff  FROM `post`
order by CASE WHEN diff < 0 THEN 1 ELSE 0 END, diff
"
2594,7375,Query for Current_Timestamp between Start- and End-Time (w/o Date!) Oracle PL/SQL,"SELECT * FROM tab1 
WHERE (current_timestamp - TRUNC(current_date)) BETWEEN starttime AND endtime
"
39519,36702,sql joining for query,"SELECT provider_food_joints.*, 
       menu_item.* 
FROM   provider_food_joints 
       INNER JOIN menu_item 
               ON menu_item.foodjoint_id = provider_food_joints.foodjoint_id 
WHERE  provider_food_joints.foodjoint_name = '"".$foodjoint_name.""' 
"
19288,34976,Calculating an average number from three columns,"SELECT m.title, m.imdbrating, m.metacritic,
       t.rating,
       ((case when imdbrating > 0 then imdbrating else 0 end) +
        (case when metacritic > 0 then metacritic else 0 end) +
        (case when t.rating > 0 then t.rating else 0 end) +
       ) / nullif(coalesce((imdbrating > 0), 0) + coalesce((metacritic > 0), 0) + coalesce((t.rating > 0), 0)), 0)
FROM movie m JOIN
     tomato t
     ON m.imdbid = t.imdbid;
"
8954,63795,MVC model and SQL table name are the same,"class Application_Model_DbTable_Poll extends Zend_Db_Table_Abstract
{
    protected $_name = 'Poll';
}
"
32817,7184,Trying to create a trigger that prevents updates based on value from another table,"CREATE OR REPLACE TRIGGER trigger_name
  AFTER UPDATE ON a
  FOR EACH ROW
DECLARE
  l_dt_b b.dt_col%type;
BEGIN
  SELECT dt_col
    INTO l_dt_b
    FROM b
   WHERE b.b_key = :new.b_key;

  IF( l_dt_b < sysdate )
  THEN
    RAISE_APPLICATION_ERROR( -20001, 'Too late' );
  END IF;
END;
"
22080,15425,Are LEFT JOIN subquery table arguments evaluated more than once?,"SELECT  *
FROM    timereports t
WHERE   t.employee_id = e.id
        AND date = '2009-05-04'
"
13785,45030,Retrieve records falling within a daily time range across a given month,"SELECT SUM(Price) Total_Morning_Sales
FROM TableName 
WHERE CAST(Sale AS TIME) > '07:59:59'
 AND  CAST(Sale AS TIME) < '12:00:01'
 AND  MONTH(Sale) = 5   --<-- Month Number here
"
37376,24646,.NET .ToList function is WAY WAY too slow,"list = (From c In _entities.XXXXXXXXSet.Include(""XXXXXX"").Include(""XXXXXX"") _
            Where Not (c.XXXXXX Is Nothing AndAlso c.XXXXXX = String.Empty) _
            And c.XXXXXX = codeClient _
            And c.XXXXXX > dateLimite _
            Order By c.XXXXXX Descending _
            Select c).Skip(pageSize * pageIndex).Take(pageSize).ToList();
"
32450,30952,GROUP BY First_Name but show COUNT of the corresponding Last_Name SQL,"SELECT a.Last_Name, a.First_Name,
SUM(CASE WHEN b.ITM = 'P_10' THEN 1 ELSE 0 END) AS P_10_COUNT,
COUNT(c.Name_Count)
FROM CUST_PROFILE
INNER JOIN ORDER b
ON a.ID = b.ID
LEFT JOIN (select Last_Name, count(DISTINCT First_Name) Name_Count
from CUST_PROFILE
GROUP BY Last_Name) c ON c.Last_Name = a.Last_Name
GROUP BY a.First_Name, a.Last_Name; 
"
9462,1149,Truncate (not round) decimal places in SQL Server,"select round(123.456, 2, 1)
"
16729,12555,SQL statement to find Min Date,"SELECT MIN(entered), generalist, item
FROM dataTable
WHERE item = @itemParm
AND entered BETWEEN @enteredStart AND @enteredEnd
GROUP BY generalist, item
"
26205,26342,"SQL Server: select value, split on a delimiter, then update two columns","UPDATE table SET 
  Col2 = SUBSTRING(Col1, 1, CHARINDEX(' ', Col1)-1), 
  Col3 = SUBSTRING(Col1, CHARINDEX(' ', Col1)+1, 8000)
WHERE Col1 LIKE '% %';
"
10952,45018,How can I remove partial duplicates in my MS SQL Database?,"WITH CTE AS
(
   SELECT EID, TID, StartDate, EndDate,
      RN = ROW_NUMBER() OVER (PARTITION BY  EID, TID ORDER BY StartDate, EndDate)
   FROM Table1 
)
DELETE FROM CTE WHERE RN > 1
"
4086,42087,how to get specific set of records in sql server,"select *
from yourTable
where yourIdColumn between 10 and 30
"
28104,66640,Counting records in a table given corresponding ID,"select 
  productid, productgroup, shelflvl, Count(distinct Shelfaisle) AS totalaisles
from productlocation
Where productgroup = 'canned'
Group By productid, productgroup, shelflvl
"
37809,33679,SQLite Indexing,"CREATE INDEX UseABetterIndexNameHere
    ON RDF_NAV_LINK(ISO_COUNTRY_CODE, FUNCTIONAL_CLASS);
"
20207,71427,Select and join from to tables in mysql,"  (select t.*, u.Name from thread_message t left join users u on FromUserId=u.Id where ToUserId=1) 
union 
  (select t.*, u.Name from thread_message t left join users u on ToUserId=u.Id where FromUserId=1)
"
15545,61750,Are you able to pass the 'TOP' number as a parameter to a stored procedure?,"DECLARE @QQ INT = 10

SELECT  TOP (@QQ)
        *

FROM    Your_Table
"
33289,47061,A kind of sorting which i couldn't resolve,"WITH CTE AS
(
   SELECT  MaxJob = MAX(ANALYSISJOBID) OVER (PARTITION BY PACKAGEID), t.*
   FROM dbo.TableName t
)
SELECT PACKAGENAME, PACKAGEID, ANALYSISJOBID
FROM CTE 
ORDER BY MaxJob DESC, ANALYSISJOBID DESC
"
10923,27386,SQL Server efficiently filter rows where times are not near another table's times,"SELECT t1.id,
       t1.value
  FROM temp1 t1
 WHERE NOT EXISTS(SELECT NULL
                    FROM temp2 t2
                   WHERE t2.value BETWEEN DATEADD(MINUTE, -1, t1.value)  
                                      AND DATEADD(MINUTE, 1, t1.value))
"
23422,13670,Query for active records between date range or most recent before date range,"SELECT * 
FROM individual i
INNER JOIN app_indiv ai
    ON ai.indiv_id = i.indiv_id
OUTER APPLY
(
    SELECT TOP 1 * FROM app_note an
    WHERE an.app_indiv_id = ai.app_indiv_id
        AND an.when_mod < @date_to
    ORDER BY an.when_mod DESC
) d
WHERE d.status = 'active'
"
30167,56846,COUNT results from SQL Query with a HAVING clause,"SELECT COUNT(*) FROM 
 (SELECT col_appid, min(col_payment_issued_date) as PayDate  
  FROM tbl_ui_paymentstubs  
  WHERE isnull(col_payment_amount,0) > 0  
  GROUP BY col_appid  
  HAVING
     min(col_payment_issued_date) >= '09/01/2010'
     and min(col_payment_issued_date) <= '09/30/2010') Claims
"
6876,16752,short sql challenge with multiple next row on a resultset with group by and having count,"select input.*
from 
    (select min(in_id) as idmin, to_id  
            from input 
            where us_id=1 group by to_id
    ) mintable, 
    input 
where 
   (input.to_id = mintable.to_id and input.in_id > mintable.idmin) 
   and us_id <> 1;
"
32285,74367,Dynamic SQl throwing conversion issue with datetime,"DECLARE @TODELETEDATE DATETIME
  BEGIN
    SET @TODELETEDATE =GETDATE()-5

    PRINT '<' +  CONVERT(VARCHAR(19),@TODELETEDATE ,120)
 END
"
3278,69507,MySQL update is running slow,"UPDATE 
`zydushr`.`performance`  AS a1 
JOIN `zydusquiz`.`performance` AS a2 
ON a1.`EmpNo` = a2.`EmpNo` 
 AND a1.`Month` = a2.`Month` 
 AND a1.`Year` = a2.`Year` 
SET a1.`Sales` = a2.`AchievementHQ` 
"
15755,59058,Select query with IN clause: filling the blanks,"SELECT 
  helper.SomeColumn,
  SomeTable.Id 
FROM  
  (
   SELECT 'foo' AS SomeColumn
   UNION SELECT 'bar'
   UNION SELECT 'baz'
  ) AS helper
  LEFT JOIN SomeTable ON SomeTable.SomeColumn = helper.SomeColumn 
"
24193,57653,sql left outer join order by column in left table but preserve all rows,"SELECT 
  t1.id
FROM table1 AS t1
LEFT OUTER JOIN
(
   SELECT table1_id, SUM(column1) sum1, SUM(column2) sum2
   FROM table2 
   GROUP BY table1_id
) AS t2  ON t2.table1_id = t.id
        AND t1.entry_id  = 2 
        AND t1.parent_id = 0 
ORDER BY t2.sum1 - t2.sum2;
"
5268,52415,Add \ to in a select query,"Select REPLACE(IdentityName, '\','\\') AS  IdentityName
from [Users]
"
10903,1432,How to write a SQL join to retrieve results from second table?,"SELECT * FROM TABLE2
WHERE ID IN (SELECT ID FROM TABLE1 WHERE color = 'green');
"
15397,21359,MS Office Word 2007/2010 - how to view edit an existing built in mail merge SELECT?,"query w:val=""SELECT * FROM &quot;Customer&quot; ""
"
24629,75274,General MySQL query compostion,"SELECT `citidinanza`, SUM(`1987`) as `1987`, SUM( `1988`) AS `1988` FROM `table`  GROUP BY `citidinanza`
"
16247,68974,How can I select a value from a database using Ruby and SQLite3?,"name.each do |row|
    puts row['firstname']
end
"
20488,62781,Select count from particular foreign key in SQLite,"select 
    a.author_id,
    a.author_name,
    count(*) as number_of_books
from
    authors a inner join
    books b on b.author_id = a.author_id
group by
    a.author_id,
    a.author_name
order by 
    number_of_books
"
3326,69249,T-SQL : Access to any element of a table,"CREATE TABLE [dbo].[#storeTable] (
[path] varchar(1000) not null,
    [nbdays] int,
    [offset] int
) ON [PRIMARY]
"
5767,73375,Oracle Update table to set specific attribute value in semicolon separated values,"update table
   set column = replace(column,'New_eMail+Y','New_eMail+N')
where column like '%New_eMail+Y%'
"
3718,13114,Put blank in sql server column with integer datatype,"SELECT
    CASE WHEN position < 0 THEN '' ELSE CAST(column1 as VARCHAR(10)) END as position
,   column2
FROM myTable
"
15077,63552,Is unique foreign keys across multiple tables via normalization and without null columns possible?,"create table Vehicles (
    Vehicle int primary key,
    Registration varchar(255),
    Type varchar(255),
    constraint chk_type check (type in ('car', 'truck')),
    constraint unq_type_Vehicle unique (type, vehicle), -- this is redundant, but necessary
    . . .
);

create table car (
    VehicleId int,
    Type varchar(255), -- always 'car' in this table
    constraint fk_car_vehicle foreign key (VehicleId) references Vehicles(VehicleId),
    constraint fk_car_vehicle_type foreign key (Type, VehicleId) references Vehicles(Type, VehicleId)
);
"
786,5312,Batch Delete from tableA based on data on tableB,"DELETE tableA
FROM tableB 
WHERE tableA.ID = tableB.ID
"
32097,14014,Reverse comma separated column values in SQL Server," SELECT Split.T.value('.', 'VARCHAR(50)') AS column1  
 FROM  (SELECT  CAST ('<M>' + 
 REPLACE(column1, ',', '</M><M>') + '</M>' AS XML) AS String  
 FROM  @TBL) AS T CROSS APPLY String.nodes ('/M') AS Split(T); 
"
25013,68110,How does one detect a non-contiguous number column in a MySQL query?,"SELECT t1.checkno,t1.id,
       IF(@lastCheckNo IS NULL OR @lastCheckNo = t1.checkno - 1,'','*') as outoforder,
       @lastCheckNo := t1.checkno
FROM (SELECT * FROM `table` ORDER BY checkno) t1,(SELECT @lastCheckNo := NULL)variable
"
18456,48410,SQL - Sum two columns group by ID,"select ident,result=(case when sum(Immo)>0 and sum(Conso)>0 then 'yes' 
               else 'no' end)
from tabname (NOLOCK)
group by id
"
6020,21278,Oracle query to display prior 5 years from current year,"where curryear >= add_months(trunc(sysdate       ),5 * 12)

where curryear >= add_months(trunc(sysdate,'YYYY'),5 * 12)

where curryear >= add_months(trunc(sysdate,'YYYY'),5 * 12) and
      curryear <             trunc(sysdate,'YYYY')
"
38809,36130,SQL insert multiple rows from single field in another table,"INSERT INTO alerts (feed_type_id,priority,label,feed_output_id)
SELECT 1,1,'Label2',id
  FROM feed_outputs
 WHERE feed_id = 5;
"
29920,9149,How to do conditional right join in SQL Server 2012?,"SELECT *
FROM Menu_Table
LEFT JOIN Menu_Access_Table ON Menu_Table.menu_id = Menu_Access_Table.menu_id
    AND Menu_Access_Table.user_id = 11
"
3239,63823,"GROUP BY, show MIN","SELECT title, MIN(date)
FROM financials
GROUP BY title
ORDER BY title
"
18683,68,mysql group by confusion,"select
  players_id,
  weapons_id,
  max(acc)
from (
  select
    weapons_id,
    players_id,
    avg (acc) as acc
  from
    player_weapon_stats
  group by
    players_id,
    weapons_id
  order by 
    weapons_id asc, 
    avg(acc) desc) as t1
group by 
  weapons_id
"
15469,504,friends table best approach,"0: pending, A asked to B
1: pending, B asked to A
2: friends
"
6421,51023,What database schema should I use?,"Card
--------------------------------------------
CardNumber     CardType_id    field1     etc

CardType
--------------------------------------------
ID     Description


SELECT
     Card.*,
     CardType.Description
FROM Card
          INNER JOIN CardType
                ON Card.CardType_id = CardType.ID
WHERE CardType.Description = 'your description value'
"
10352,15965,How to write this SQL in a Rails way,"@notifications = current_user.notifications.
  joins(""INNER JOIN activities ON notifications.activity_id = activities.id"").
  joins(""INNER JOIN comments ON activities.trackable_id = comments.id"")
"
23533,4035,Non-trivial geolocation query db caching,"CREATE INDEX ix_mytable_lat_lon ON mytable (lat, lon)
CREATE INDEX ix_mytable_lon_lat ON mytable (lon, lat)
"
35188,26619,Retrieving data from two tables.,"Select u.*,w.* from users u inner join warnings w on u.uid == w.id 
 where u.rank=2 and u.language='en' and w.warn_active='yes'
"
4437,13351,Extrapolate running total from .LAST value of a BY GROUP,"proc sql;
    create table filled(rename=(sales_filled=sales)) as
    select REGION_ID, STORE_ID, YEAR, max(SALES)/(max(YEAR)-min(YEAR)+1)*(YEAR-min(YEAR)+1) as sales_filled
    from sales_data
    group by REGION_ID, STORE_ID
    order by REGION_ID, STORE_ID, Year;
quit;
"
16314,23362,Conditional Unique Contraints On Multiple Columns,"  create unique index products_name_ui 
    on products (case when prod_type = 'LOCAL' then prod_name else null end);
"
25441,59024,How to get an item from string in postgresql?,"select split_part('10,244,566', ',', 2);
"
3609,22908,Detecting cycles in a recursive query,"with recursive ""nodes"" (""node"", ""depth"", ""path"", ""cycle"") as (
  select 10, 0, ARRAY[10], false
union all
  select ""to"", ""depth"" + 1, path || ""to"", ""to"" = ANY(path)
  from ""edges"", ""nodes""
  where ""from"" = ""node"" and not ""cycle""
) select * from (select ""node"", min(""depth""), ""path"", ""cycle""
                from ""nodes"" group by ""node"", ""path"", ""cycle"") as n 
                where not ""cycle"";
"
33280,72713,"regex , select sentence in database exept","WHERE semi_sentence NOT RLIKE '[[:<:]](to|a)[[:>:]]'
"
4994,30946,How to handle space in condition in SQL Loader?,"LOAD DATA
INFILE 'ABC.DAT'
APPEND
INTO TABLE RECORDS WHEN (1) = 'F'
(
COL1 POSITION(1:1),
 COL2 POSITION(2:6),
 ...
)
INTO TABLE RECORDS WHEN (1) = ' '
(

COL1 POSITION(1:1),
COL3 POSITION(2:6),
 ...
)
"
9952,63826,How to structure a database with multiple join tables,"SELECT ingredient_id
FROM Recipe r
JOIN Step_ingredient si on si.step_recipe_id = r.recipe_id
JOIN Ingredient i on si.ingredient_id = i.ingredient_id
"
17397,32057,Divide all values but one in sql table,"UPDATE tablename SET columName = columnName / 42 WHERE rowId !=42;
"
29818,22644,Resolving foreign key before inserting new rows,"INSERT INTO parent_table (id, name)
SELECT id.nextval, r2.name
FROM (SELECT DISTINCT r.name FROM raw)
WHERE r2.name NOT IN (SELECT name FROM parent_table)
"
18730,12567,How to group correctly when trying to select max value?,"ROW_NUMBER() OVER (PARTITION BY [Description]
                   ORDER BY [SampleNumber] DESC, [InspectionDate] DESC
                  ) rn
"
12471,14107,"How can I convert a date to format ""dd/mm"" in oracle?","select to_char(date_open, 'dd/mm') from ...
"
6782,17304,How to replace a whole observation working on a SAS file through IML,"/* get column names ONE TIME */
use (db);
   read next var _ALL_ into temp[colname=varNames]; /* get names of cols */
close (db);

/* read index checkObs and write to temp*/
edit (db);
read point (checkObs) into temp; /* Read an entire row*/
temp[nVarToUpdate] = 1; /* I would like to update some values*/
do i = 1 to ncol(temp);
   call valset(varNames[i], temp[i]); /* update scalar variables */
end;
replace point (checkObs) var _all_;
close (db);
"
22708,70989,SQL concatenating strings?,"OR f_name + ' ' + l_name = user-input
"
18957,45334,Acces sql query for sorting non duplicate column among two other duplicate columns,"select t.*
from t inner join
     (select accno, cpno
      from t
      group by accno, cpno
      having min(echeckid) <> max(echeckid)
     ) as ac
     on t.accno = ac.accno and t.cpno = ac.cpno
order by t.accno, t.cpno;
"
21592,72695,What is the best way to enforce constraints across tables?,"CREATE TABLE customer (
  id   SERIAL PRIMARY KEY,
  type TEXT,
  -- other columns...
  constraint unique_cust_type unique (id, type) -- this makes the combination id/type ""referencable""
);


CREATE TABLE product_order 
(
  id          SERIAL PRIMARY KEY,
  customer_id INTEGER,
  type        TEXT default 'business',
  CHECK (type = 'business'),
  foreign key (customer_id, type) references customer (id, type)
);
"
3830,61474,Ensure validity of multiple hierarchies in Oracle table,"create table XXX (
    key number primary key,
    parent number
)
/

alter table XXX add constraint XXX_FK foreign key (parent) references XXX
/
"
7748,13266,SQL - Get Count of users with average age in range,"select count(*) as SiteCount
from (
      select avg(datediff(year, U.BirthDate, UV.Visit_Date)) as AvgAge
      from Users as U
        inner join User_Visits as UV
         on U.ID = UV.User_ID
      group by UV.Site_ID   
     ) as T
where AvgAge >= 40 and
      AvgAge < 50 
"
26372,74385,Disable and later enable all table indexes in Oracle,"DECLARE
  CURSOR  usr_idxs IS select * from user_indexes;
  cur_idx  usr_idxs% ROWTYPE;
  v_sql  VARCHAR2(1024);

BEGIN
  OPEN usr_idxs;
  LOOP
    FETCH usr_idxs INTO cur_idx;
    EXIT WHEN NOT usr_idxs%FOUND;

    v_sql:= 'ALTER INDEX ' || cur_idx.index_name || ' UNUSABLE';
    EXECUTE IMMEDIATE v_sql;
  END LOOP;
  CLOSE usr_idxs;
END;
"
9082,55699,Count Unique Results in T-SQL,"SELECT IncidentStatus.IncidentStatusName, COUNT(Incident.IncidentID) AS Bob  
  FROM Incident 
INNER JOIN IncidentMember ON Incident.IncidentID = IncidentMember.IncidentId 
INNER JOIN IncidentStatus ON Incident.IncidentStatusID = IncidentStatus.IncidentStatusID 
WHERE (IncidentMember.MemberId = 6)
GROUP BY IncidentStatus.IncidentStatusName
"
14336,42166,MySQL Fulltext search but using LIKE,"SELECT id, str
FROM item_strings
WHERE str LIKE '%term%'
   AND str LIKE '%another_term%'
   AND str LIKE '%a_much_deeper_term%'
"
15275,41048,Query on all the people who has watched the same movies as I did,"select name
  from tbl
 where movid in (select movid from tbl where name = 'me')
   and name <> 'me'
 group by name
having count(*) = (select count(*) from tbl where name = 'me')
"
4936,68823,Two tables having same composite key,"select  t1.No
,       t1.Date
,       t1.S_hour - t2.L_hour
from    Table1 t1
join    Table2 t2
on      t1.No = t2.No
        and t1.Date = t2.Date
"
15034,67016,Remove inner white spaces in text data with SQL,"   WITH CTE(FieldName) AS
    (SELECT 'TB7 TCH' AS FieldName)
    SELECT SUBSTRING(FieldName FROM 1 FOR (POSITION(' ' IN FieldName) - 1)) 
            || SUBSTRING(FieldName FROM (POSITION(' ' IN FieldName) + 1))
    FROM CTE;
"
4736,30774,How can I change row information in a Query?,"SELECT 
  CASE WHEN Numbers <> 5 THEN 1 ELSE Numbers END
FROM table
"
18960,22110,How to get only the most recent record on a group of data?,"SELECT *
FROM mytable a
WHERE Date = (select max(Date) from mytable b
              where a.customer = b.customer)
"
24102,61513,How can I delete record from table in Oracle?,"delete from supplier_parts_shipment
where sno in (select sno from supplier where city='jeddah')
and pno in (select pno from parts where color='red');
"
32618,31465,Oracle query to get book-name?,"SELECT id.owner-name, b1.name ""book1-name"", b2.name ""book2-name""
FROM id
LEFT JOIN book-name ""b1"" ON b1.id = id.book-id1
LEFT JOIN book-name ""b2"" ON b2.id = id.book-id2
"
4928,35190,MySQL query concatenating more than 1 related table,"SELECT t.*, GROUP_CONCAT(distinct p1.value), GROUP_CONCAT(distinct p2.value) 
FROM table1 t 
    LEFT JOIN property_1 p1 ON p1.table1=t.id 
    LEFT JOIN property_2 p2 ON p2.table1=t.id 
WHERE t.id IN (1,4) 
GROUP BY t.id;
"
1640,1128,Write a Postgres Get or Create SQL Query,"insert into mytable (color, brightness, size, age)
where not exists (
    select 1 from 
    from mytable
    where color = 'X' and brightness = 'Y'
);
SELECT (color, brightness, size, age) 
FROM mytable 
WHERE color = 'X' AND brightness= 'Y';
"
7679,65823,SQL where field in vs. where field = with multiple ors?,"SELECT *
FROM Wherever
WHERE Greeting in ('hello', 'hi', 'hey')
"
4833,24151,PSQL query with join query from a db newbie,"SELECT 
  u.id AS ID,
  u.email AS Email,
  e.event_name AS Event
FROM
  users u JOIN events e ON u.id = e.event_id
"
29224,12157,How do I count the similar entries in a table?,"SELECT companyid, count(companyid) as TotalEntries
FROM YourTable
GROUP BY companyid
"
1180,24659,Ranking without an order by,"select level as rnk,
  regexp_substr(',A-B,B-C,C-D', '[^,]+', 1, level) as legs
from dual
connect by regexp_substr(',A-B,B-C,C-D', '[^,]+', 1, level) is not null;

       RNK LEGS       
---------- ------------
         1 A-B         
         2 B-C         
         3 C-D         
"
1185,16331,Getting columns of multiple SQL tables in a single query,"with a1 as (
   select
     row_number() over (partition by DocId order by Value) as r,
     DocId,
     value
   from
     ATTRIBUTE_1
), a2 as (
   select
     row_number() over (partition by DocId order by Value) as r,
     DocId,
     value
   from
     ATTRIBUTE_2
)
select a1.Value as Attr1, a2.Value as Attr2
from a1 full outer join a2 using (DocId, r) join DOCUMENT on (DocId = Id);
"
32515,14723,A better way to do this query in PL/pgSQL,"select val1, val2 into v_val1, v_val2 
from mytable 
where val3 = v_val3
"
2499,71800,WordPress Database Query,"SELECT u.user_email, m.meta_value FROM wp_users u 
INNER JOIN wp_usermeta m ON m.user_id = u.ID && 
           m.meta_key = 'agent_name' && 
           m.meta_value IS NOT NULL
"
21668,74437,about sql select not working,"SELECT id_towaru, nazwa_tow, 'it''s work' AS result
FROM TOWAR
WHERE ID_KATEGORIA = '00001'
"
23438,69726,How to update a column via Row_Number with a different value for each row?,";WITH T
     AS (SELECT IdDatoLegal,
                Row_number() OVER (ORDER BY IdCliente ) AS RN
         FROM   dbo.DatosLegales)
UPDATE T
SET    IdDatoLegal = RN 
"
7176,12814,SQL Server Group by sum function,"SELECT
    Code,
    SUM(ItemCount) ItemCount,
    Type,
    (SELECT SUM(Amount) FROM YourTable) Amount
FROM
    YourTable
GROUP BY Code, Type
"
37489,5758,Mysql Query to remove unwanted letters from the rows,"UPDATE table SET city=SUBSTRING_INDEX(city, '(', 1)
"
19081,55853,MSSQL: find records that has each value of column,"select
    value1
from 
    table as t1 inner join
    (select distinct year from table) as t2
    on t1.year=t2.year
group by
    val1 
having count(distinct t1.year)=(count(distinct t2.year) )
"
10680,25129,How to group by week of the year dates or day dates that start on Sundays in oracle 10?,"select TRUNC(day_date)-TO_NUMBER(TO_CHAR(day_date,'D'))+1 week_start_date,
       MAX(column2), MAX(column3)
from yourtable
group by TRUNC(day_date)-TO_NUMBER(TO_CHAR(day_date,'D'))+1;
"
308,61290,Count of matching fields (columns),"SELECT ip, isp, infection, COUNT(*)
FROM 
(
SELECT ip, isp, infection FROM tbl_1
UNION ALL
SELECT ip, isp, infection FROM tbl_2
UNION ALL
SELECT  ip, isp, infection FROM tbl_3
) x
GROUP BY ip, isp, infection
"
31922,18370,SQL query multiple tables in database," select PropertyName, ClientsInProp_VisitDate, ClientName 
 from Property
   left join ClientsInProp on ClientsInProp_Propertyid = Property_PropertyID
   left join Client on Client_Clientid = ClientsInProp_ClientId 
 where Proprty_Name = 'House 1' and ClientsInProp_VisitDate > '01.10.2013'
"
37866,45399,mysql - between two times in one day,"SELECT *
FROM yourtable
WHERE STR_TO_DATE(CURTIME(),'%h:%i') BETWEEN STR_TO_DATE(work_time_from,'%h:%i') AND STR_TO_DATE(work_time_to,'%h:%i')
"
10759,17746,Linq 2 SQL Syntax Help,"var DuplicatePages = 
    from a in DBContext.Pages
    join b in DBContext.Pages on a.MetaDescription equals b.MetaDescription
    where (a.PageID <> b.PageID) && (a.DomainID == ReportID) && 
    (b.DomainID == ReportID) && (a.MetaDescription.Trim().Length > 0) && 
    (a.URL < b.URL)
    orderby a.URL
    select new { Url = a.URL, DuplicateUrl = b.URL };
"
9827,16369,How to get minimum date by each records from multiple records,"SELECT
  CaseNo,
  Entry_date,
  (SELECT MIN(Entry_date) FROM Cases subc WHERE subc.CaseNo=c.CaseNo GROUP BY CaseNo) AS MinEntryDate
FROM Cases c
"
13149,20065,get all rows from table that have both variables in a same column,"SELECT
        `lcd1`.`company_id` AS id 
   FROM `logistics_companies_destinations` AS lcd1
   INNER JOIN `logistics_companies_destinations` AS lcd2
   WHERE `lcd1`.`city_id`= 7333 AND `lcd2`.`city_id` = 10906
"
22615,41250,SQL - Ordering by pairs of rows,"SELECT t.Timestamp, t.Views,
  IF(t.Timestamp % 2, t.Views + tPair.Views, NULL) As Sum
FROM tableName t JOIN tableName tPair
  ON IF(t.Timestamp % 2, t.Timestamp + 1, t.Timestamp - 1)  = tPair.Timestamp
ORDER BY t.Views + tPair.Views, t.Timestamp
"
34719,37788,SSRS 2008/2012 - ADDING AGGREGATION FIELDS,"SELECT 
      CASE WHEN Count(Account)=0 THEN (Sum(Amount))/(Count(Account)) END AS New_field
FROM TableName
"
13233,43098,how to write the following in LINQ syntax,"db.UserDetails.Where(ud => ud.AppearOnReport).Select(ud =>
    new {
        ud.Id,
        ud.FirstName,
        ud.Surname,
        Count = db.COESDetails.Count(c => c.InspectorId == ud.Id)
    });
"
26148,51014,Make subquery usage more efficient?,"SELECT
    a.Name, 
    a.Number, 
    Count(Distinct CASE WHEN b.type='Villa' AND b.value in (5,1,9) THEN b.street END) as NumberOfStreetsForVillas
    Count(Distinct CASE WHEN b.type='Small' AND b.value in (1,2,3) THEN b.Street END) as NumberOfCitiesForSmallHouses
FROM dbo.tableA a
    LEFT OUTER JOIN dbo.tableb b
        ON a.Name = b.Name AND a.Number = b.Number
GROUP BY a.Name, a.Number;
"
21704,5660,I am trying to add a new column in Access called Reduced Price that reduces the ProductUnitPrice column by 10%,"SELECT ProductID, ProductDescription, ProductUnitsOnHand,
       ProductUnitPrice, (ProductUnitPrice * .9) as [Reduced Price]
FROM tblProduct
"
66,60611,SQL join help for friend list,"SELECT f.username,
       up.*
  FROM USERS f
  JOIN USER_PROFILES up ON up.user_id = f.id
  JOIN FRIENDS fr ON fr.userb_id = f.id
  JOIN USERS u ON u.id = fr.usera_id
 WHERE u.username = ?
"
17907,11810,How to delete records in mysql between databases,"delete uat.users
from uat.users 
inner join rent.accounts 
on uat.users.fname=rent.accounts.account 
where rent.accounts.expires < '2015-07-03'
"
33144,45,Migrating SQL data from Access," INSERT INTO tblMake (Make) SELECT DISTINCT Make FROM tblMakeModel

 INSERT INTO tblModel (MakeID, Model) 
    SELECT DISTINCT M.MakeID, MM.Model 
    FROM tblMakeModel MM INNER JOIN tblMake M ON MM.Make = M.Make

 DROP TABLE tblMakeModel
"
10846,21230,Mysql customise order by with group by,"ORDER BY FIELD(color, 49, 2) DESC
"
4439,39883,SQL Query filtering advice,"SELECT * FROM `form_data`
WHERE `clientid` IN (
  SELECT DISTINCT `clientid` FROM `form_data`
  WHERE `data` RLIKE '[[:<:]]motor oil[[:>:]]'
);
"
22334,77,Comparing dates in postgresql,"select string_agg(to_char(birthday, 'DD Mon YYYY'), ',')
from users 
where userid > 10;
"
3377,20749,Bulk insert to SQL Server using a text qualifer in a format file,"10.0
3
1   SQLCHAR   0  50    "",\""""      1     Name         SQL_Latin1_General_CP1_CI_AS
2   SQLCHAR   0  50    ""\"",""      2     Address      SQL_Latin1_General_CP1_CI_AS
3   SQLCHAR   0  50    ""\r\n""     3     Email2       SQL_Latin1_General_CP1_CI_AS
"
32743,70055,displaying records that could not be updated mysql,"SELECT * 
FROM results, testcases
WHERE results.TestCase = testcases.TestCase
  AND resutls.testset <> testcases.TestSet
"
28467,41685,Sql Server 2008 Query to put null for non existing values,"SELECT 
    Name, 
    (SELECT Contact 
     From Contacts c 
     WHERE c.Type = 'p' And c.PersonId = p.PersonID) 
    As Contact
FROM 
    PERSONS p 
"
7856,13609,Select row that has max total value SQL Server,"SELECT Top 1 WITH TIES c.CustomerName, SUM(s.SUM) AS TotalSum
FROM Customer c JOIN Sales s ON s.CustomerId = c.CustomerId
GROUP BY c.CustomerId, c.CustomerName
ORDER BY SUM(s.SUM) DESC
"
23491,17191,Convert string to XML illegal characters,"select convert(xml, 
    REPLACE('<root>
        <stuff>
            <test>something & this will error</test>
        </stuff>
    </root>','&','&amp;'))
"
8269,17562,Materialized Views - Identifying the last refresh,"SELECT owner, mview_name, last_refresh_date
  FROM all_mviews
 WHERE owner = <<user that owns the materialized view>>
   AND mview_name = <<name of the materialized view>>
"
33308,13622,SQL Group By question - choosing which row gets grouped,"select p.id, c.id as priorid, p.numusers-c.numusers AS dif, p.date, c.date as priordate    
from licenses p
join licenses c on c.serial=p.serial
  and c.date=(select max(date) from licenses ref where ref.serial=p.serial
    and ref.date<p.date)
order by p.serial
"
5477,28166,Beginner SQL question: arithmetic with multiple COUNT(*) results,"WITH c1 AS (
    SELECT COUNT(*) AS cnt
    FROM Users
    WHERE Users.Reputation >= 10000
), c2 AS (
    SELECT COUNT(*) AS cnt
    FROM Users
)
SELECT c1.cnt, c2.cnt, CAST(c1.cnt AS FLOAT) / c2.cnt
FROM c1, c2
"
26243,31299,Ascending and Descending according to the column value,"...
ORDER BY CASE WHEN DEPARTMENT_ID  % 2 = 0
         THEN -DEPARTMENT_ID   
         ELSE  DEPARTMENT_ID END ASC;
"
26210,6660,Mysql update from a join query,"UPDATE USER 
JOIN   USER_SETTINGS 
ON     USER_SETTINGS.USER_ID = USER.ID 
SET    setting=settings.value
"
8297,61100,Date in sql database,"select MONTH('10/15/1981') --10
select DAY('10/15/1981') --15
select YEAR('10/15/1981') --1981

Select Dates
from tablename
Where MONTH(Dates) = 10
"
19581,61734,SQL Server 2012 Trigger,"CREATE TRIGGER maximum_books_per_user ON Loan
FOR INSERT
AS
-- Fail if there are any customers that will have more than the maximum number of loans
IF EXISTS (
    SELECT i.userID, COUNT(*)
    FROM inserted i
    JOIN Loan l
        ON i.userID = l.userID
    GROUP BY i.userID
    HAVING COUNT(*) >= 5
)
BEGIN
    ROLLBACK TRANSACTION
    RAISERROR('You have reached maximum allowed loans.', 16, 1)
END
"
7467,7968,calculate value based on 2 fields in SQL database,"SELECT 
    CAST((CASE
            WHEN tableAValue < tableB.maxRange and tableAValue > tableB.minRange 
              THEN 1
            ELSE 
              0 
          END) AS BIT) 
FROM TableA
  INNER JOIN TableB
    ON TableA.ID = TableB.TableAID
WHERE TableA.ID = @yourID
"
35999,36912,SQL ALTER TABLE with default,"ALTER TABLE Stock_Qty
MODIFY Qty DEFAULT 1
"
5644,70261,DoCmd.RunSQL SELECT STATEMENT,"SQL = ""select g.mailbox "" & _
    ""from ((voorwerp v inner join bod b "" & _
    ""ON v.voorwerpnummer = b.voorwerp) "" & _
    ""inner join gebruiker g "" & _
    ""ON g.gebruikersnaam = b.gebruiker) "" & _
    ""where v.verkoper = '"" & Me.gebruikersnaam & ""' "" & _
    ""AND v.veiling_gesloten = 'false'""
"
5256,30927,Incorrect Count Using Self Join,"SELECT sd.SurveyYear, sd.BookId, 
       sum(case when sd.Grade = '3' then 1 else 0 end) as Grade3,
       sum(case when sd.Grade = '4' then 1 else 0 end) as Grade4
FROM SurveyDatas sd
GROUP BY sd.SurveyYear, sd.BookId;
"
36882,36472,String split in MySQL using REPLACE and SUBSTRING_INDEX,"SUBSTRING_INDEX(SUBSTRING_INDEX(address,';',-4),';',1)
"
19963,63215,Convert Check box boolean value to string in BIRT 4.1?,"params[""myBooleanCheckbox""].value==null || !params[""myBooleanCheckbox""].value?""0"":""1"";
"
1007,21873,"Transforming a 2 column SQL table into 3 columns, column 3 lagged on 2","select a.id, a.i, coalesce(min(b.i),'0') from
test a
left join test b on b.id=a.id and a.i<b.i
group by a.id,a.i
order by a.id, a.i
"
13509,36206,SQL server Query Count() Optimization,"select 
    side,
    uid,
    cside,
    cside/3 as pairs,
    cside/3*15 as commisonPrice 
from
(
    select
    p.side ,
    p.uid as uid , 
    count (p.side) as cside
    from tempComm as p 
    group by p.side , p.uid
) t
order by uid; 
"
3434,45879,Find a string within an array column in PostgreSQL,"select ... 
  from ... 
 where ... 
       and array_to_string(authors, ', ') like '%123456789%';`
"
30433,15135,SQL MAX function and strings,"SELECT nr
FROM table WHERE (nr LIKE '12345-%')
ORDER BY regexp_replace(nr, '^\d+-', '')::integer DESC
LIMIT 1
"
14549,4607,Select count(*) from multiple tables to create view,"CREATE VIEW PLACE
AS 
SELECT  d.Loc CITY, 
        count(DISTINCT d.Deptno) N_DEPT, 
        count(e.Empno) N_EMP
FROM    Dept d 
        INNER JOIN Emp e
           ON d.Deptno = e.Deptno
GROUP BY d.Loc
"
12788,21068,INTERSECTing tables with multiple return values,"select empid from HASSKILL, JOB
where jobid = 1 and skillid = needskill
group by empid
having count(0) = (select count(0) from JOB where jobid = 1)
"
19958,29958,How to select from GROUP BY?,"SELECT DATEPART(mm, S.DateProcessStatus) as MonthNumber,
 --S.DeviceId, 
 SUM(A.Users) as Users,
 SUM(A.UsersHits) as UserHits,
 MIN(A.Coefficient) as Coefficient
FROM dbo.ReportAudienceOverviews A 
 LEFT JOIN dbo.ReportProcessStatuses S
 ON S.StatusId = A.StatusId
 AND S.DateProcessStatus >= '2014' AND S.DateProcessStatus < '2015'
--WHERE S.DeviceId = 1 AND A.Coefficient = 20
GROUP BY
 DATEPART(mm, S.DateProcessStatus), S.DeviceId
 ORDER BY MonthNumber ASC, S.DeviceId ASC
"
14849,16083,SQL set attending to yes if userid = x and eventid = x,"insert into user_has_event(user_user_id, event_event_id, attendance)
    values (1, 1, 'yes')
    on duplicate key update attendance = 'yes';
"
34306,19680,"Select row which has all five under it in the ""tree""","select p.article_id
from Article a
inner join Structure s on s.article_above_id = article_id
inner join Article p on p.article_id = s.article_id
where a.article_number in (3,7,45,186,203)
group by p.article_id
having count(*) = 5
"
23364,4155,how to know if between 2 date's it past 5 days - Oracle 10g?,"select case when
    abs(to_date('01/05/2009','DD/MM/YYYY') - to_date('06/05/2009','DD/MM/YYYY')) = 5
  then 'YES'
  else 'NO'
  end as ARE_DATES_5_DAYS_APART
from
  dual;
"
16396,71237,Django low-level many-to-many update without query,"field = A._meta.get_field_by_name('b')[0]
tablename = field.m2m_db_table()
column_a_name = field.m2m_column_name()
column_b_name = field.m2m_reverse_name()

from django.db import connection, transaction
cursor = connection.cursor()
for (id, related_ids) in related_map.iteritems():
    for related_id in related_ids:
        cursor.execute(""insert into %s (%s, %s) values (%s, %s)"", (tablename, column_a_name, column_b_name, id, related_id))
transaction.commit_unless_managed()
"
36138,73583,inserting if in a select query,"Select 
  CASE WHEN SUM(Costo) > 0 THEN SUM(Costo) 
  ELSE 0 
  END 'Expr1'
FROM
  TDP_NotaSpeseSezB
"
480,29873,"Oracle SQL help: after using group by, count types","select
  personid,
  count(case when type = 5 then 1 end) type5cnt,
  count(case when type = 12 then 12 end) type12cnt,
  count(case when type = 71 then 71 end) type71cnt
from table_name
group by personid
"
32329,64488,Creating SQL queries and algebraic expression from text,"SELECT LoanAccs.name
, Department.depAdress
, book.author
, book.title
LEFT OUTER JOIN LoanedBooks 
  ON loanAccs.loanAcc = loanedBooks.loanAcc
LEFT OUTER JOIN Department 
  ON loanAccs.depCode = department.DepCode
LEFT OUTER JOIN Book 
  ON loanedBooks.ISBN = books.ISBN
WHERE DATEDIFF(dd, CURRENT_DATE, loanedbooks.returndate) <= 28
ORDER BY depAdress, depCode, name desc
"
30029,33623,Retrieving multiple xml child node values,"select (
       select ' '+X.N.value('text()[1]', 'varchar(max)')
       from (select cast(T.XMLCol as xml)) as T1(XMLCol)
         cross apply T1.XMLCol.nodes('//*') as X(N)
       for xml path(''), type
       ).value('substring(text()[1], 2)', 'varchar(max)')
from T
"
30764,65896,SQL update query for each row,"update mytable set keywords = concat('free ',mytable.name,'how to ',mytable.name,', download free ',mytable.name);
"
35070,10630,Complex insert statements,"Insert Into Test (Test_Date, Testno, Examno, Serialno, Type, Hours) 
Select S.Test_Date, E.Testno, S.Examno, S.Serialno, 'Non-Flight', (F.STARTED- F.ENDED) as Hours 
From Semester S, TIME F, TESTPAPERS e 
Where S.Testno = F.Testno And E.Testno = 1
"
599,56416,"SQL Using sum command with ""in"" clause","Select CustomerID,ProductId,SUM(Quantity) Quantity,SUM(TotalPrice) TotalPrice from tblOrderDetails where OrderID in (Select OrderID from tblOrders where CustomerID = 523456)
GROUP BY CustomerID,ProductId
"
15279,16760,mysql a column into multiple columns based on the value,"SELECT
  SUBSTRING_INDEX(description, ':', 1) status,
  SUBSTRING_INDEX(SUBSTRING_INDEX(description, '''', 2), '''', -1) description,
  SUBSTRING_INDEX(SUBSTRING_INDEX(description, '''', 4), '''', -1) device,
  SUBSTRING_INDEX(SUBSTRING_INDEX(description, '''', 6), '''', -1) system,
  SUBSTRING_INDEX(SUBSTRING_INDEX(description, '''', 8), '''', -1) code
FROM
  devices
WHERE
  id = 172;
"
37113,54079,Copy columns and its data from a table in one database to another table in a different server,"INSERT INTO [server2].[database1].[table1] ( col1, col3, col5 )
SELECT col1, col3, col5 FROM [server1].[database1].[table1]
"
30190,52587,"MySQL Syntax for linking two rows from different tables, where they both have a common field","SELECT table2.* from 
table2 INNER JOIN table1
ON( table2.itemid = table1.id )
WHERE table2.textbool1 = 'true' && table2.textbool2 = 'false' 
&& table1.name LIKE '%test%' && table1.rating >= '10' && table1.country = 'gb' 
ORDER BY table1.rating DESC LIMIT 20
"
16752,43348,Create row in table A for each distinct value in table B,"insert into A(id, proposal)
    select uuid(), proposal
    from (select distinct proposal
          from b
         ) b;
"
27863,17328,(T-SQL): How do I use result set A to calculate result set B?,"
DECLARE @empid int;
DECLARE vend_cursor CURSOR
    FOR select employee_id from employee where employee_team = 1 and employee_role = 1
OPEN vend_cursor
FETCH NEXT FROM vend_cursor into @empid;
WHILE @@FETCH_STATUS = 0    
BEGIN  
// your query with @mpid 
FETCH NEXT FROM db_cursor INTO @name   
END   
CLOSE vend_cursor
DEALLOCATE vend_cursor
"
20147,17958,SQL Query: how to create a 'sessions' column,"select  yt.ID
,       yt.Name
,       yt.VisitCounter
,       count(prev.ID) as Session
from    YourTable yt
join    YourTable prev
on      prev.ID <= yt.ID and
        prev.VisitCounter = 1
group by
        yt.ID
,       yt.Name
,       yt.VisitCounter
order by 
        yt.ID
"
2645,8073,Set boolean to true if select returns something,"declare
    n number;
    isExist boolean;    
begin
    select count(1) into n from MYTABLE where ID = 1;

    isExist := (n>0);
end;
"
564,57701,Importance of WHERE in LEFT join,"SELECT Pracas.Zona,
 SUM(CASE WHEN Motoristas_Praca.PracaID IS NULL THEN 0 ELSE 1 END) AS 'Ocupantes' 
FROM Pracas
LEFT JOIN Motoristas_Praca ON Motoristas_Praca.PracaID=Pracas.PracaID
GROUP BY Pracas.Zona
"
5749,34843,misunderstanding in formating a phone number using oracle pl/sql,"p_phone_number := '(' || SUBSTR(p_phone_number,1,3) ||  ')' ||
                  SUBSTR(p_phone_number, 4, 7);
"
9393,67353,SQL Server: How to get current date time in YYYYMMDDHHMISSMSS,"select replace(
       replace(
       replace(
       replace(convert(varchar(23), getdate(), 121),
       '-',''),
       '.',''),
       ' ',''),
       ':','')
"
28760,27907,"Select 5 previous records, middle and 5 next records in 1 query","(select i.*
 from items i
 where price <= (select price from items i2 where name = @input_name)
 order by price desc
 limit 6
) union all
(select i.*
 from items i
 where price > (select price from items i2 where name = @input_name)
 order by price asc
 limit 5
)
"
27485,42913,Oracle 11g View resultset of table from Stored procedure in Toad,"DECLARE
 v_err_no number;
 v_err_msg VARCHAR2(200);
BEGIN
get_data(
   p_start_dt    =>  SYSDATE,      --depend on you
   p_end_dt      => SYSDATE+10,    --depend on you
   p_results     =>   :ret_cursor,
   p_err_no      =>   v_err_no,
   p_err_msg     =>   v_err_msg
   );
--print error message   
END;   
"
38235,3873,How can I retrieve SQL field names of a temp table using Perl?,"my $sth = $dbh->prepare($STMT);
$sth->execute;
my $columns = $sth->{NAME_uc};

while (my $row = $sth->fetch) {
  for my $i (0 .. $#$row) {
    print ""$columns->[$i]: $row->[$i]\n"";
  }
  print ""\n"";
}
"
29746,30630,Spring inject xml values to properties-config.xml then to a bean,"<property name=""insertSql"" value=""${sql.accountdao.insert}"" />
<property name=""selectSql"" value=""${sql.accountdao.select}"" />
"
7540,54135,mysql. sql query. selecting,"select * from `table` group by title,artist;
"
32489,9113,SQL left join: selecting the last records,"SELECT projects.id FROM projects
  LEFT JOIN
    (SELECT comments.projectID 
       FROM comments
      GROUP BY comments.projectID
      HAVING DATEDIFF(Now(), MAX(comments.postedOn)) < 30) AS C
  ON projects.id = C.projectID
  WHERE C.projectID IS NULL;
"
17897,4547,Why is this HQL join fetch not returning expecting rows,"from publication p left join fetch p.translations pt where (pt.language = :language or pt.language is null) and p.application.id = :applicationId and state = :state and active = true and spsUpload = false

query.setParameter(""state"", PublicationState.DONE);
"
8160,49864,SQL: Looking up the same field in one table for multiple values in another table?,"SELECT F.bar_id1, 
    (SELECT bar_desc FROM Bar B WHERE (F.bar_id1 = B.bar_id)),
    F.bar_id2, 
    (SELECT bar_desc FROM Bar B WHERE (F.bar_id2 = B.bar_id)),
    F.other_val
FROM FOO F;
"
28571,72703,Best way to get blog post titles along with blog name,"select B.Name,
       (
         select ', '+BP.Title
         from BlogPosts as BP
         where B.BlogId = BP.BlogId
         for xml path(''), type
       ).value('substring((./text())[1], 3)', 'varchar(max)') as BlogPosts
from Blog as B
"
13933,24896,Oracle RegExp For Counting Words Occuring After a Character,"REGEXP_COUNT(fieldname, '[^ ]+', (INSTR(fieldname, ',')+1))
"
12290,49509,SQL database - when to use a separate table vs a column of an existing one?,"Table Student:

[PK] Id
[FK] IdClass
Name
Surname
"
13129,53644,sql returning no rows selected,"select ur.uno, count(q.eno)*5
  from userresponse ur
       left outer join question q
         on(    ur.eno = q.eno 
            and q.correctanswer = ur.response 
            and q.qno = ur.qno 
            and q.eno = '1')
where ur.uno = '1' 
group by ur.uno
"
27089,24277,Getting the data out of one-many relation ship from same table,"SELECT Hospital, Doctor, MAX(Patient)
FROM table
GROUP BY Hospital, Doctor
ORDER BY Hospital, Doctor
"
12553,60529,Duplicate all data in the same table MYSQL,"INSERT INTO your_table_name(parent_id,priority,text,shortname,weighting,g_or_a,
     dept,ksf,day_start,day_end,date_start,date_end,depends_on,is_question,budget,
     ccode,responsible,accountable,consulted,informed)
(SELECT parent_id,priority,text,shortname,weighting,g_or_a,dept,ksf,
    day_start,day_end,date_start,date_end,depends_on,is_question,budget,ccode,
    responsible,accountable,consulted,informed FROM your_table_name);
"
19318,26806,date time range,"NOT (
       `date` < 20120102
    OR `date` > 20120204
    OR ( `date` = 20120102 AND `time` < 1000 )
    OR ( `date` = 20120204 AND `time` >  930 )
)
"
38269,23860,show and mark some records on top,"SELECT
  users.*
  , hr_orders.position_label
  , hr_orders.is_boss
  , deps.label AS dep_label        
  , users.id  AS show_on_top 
 FROM
  -- some joins here
 WHERE
  -- some filters
  AND users.id IN (?,?,?)
"
25081,42574,How do I count MySQL entries with a HAVING criterion,"SELECT COUNT(*) FROM (
    SELECT field.id * 10 AS foo FROM table HAVING foo > 100
)
"
39863,38463,Sub query for column name,"Select T1.Col1,T1.Col2,T2.Id,T2.Title
From Table1 T1
    cross apply  (Select top 1 Id, Title
                   From Table2
                   Where Ref=T1.Id
                   Order By Date Desc) AS T2
"
5755,24269,Replace first few characters of field in an update statement,"UPDATE my_table
SET    col1 = CONCAT('xxx-xxx-' , SUBSTR(col1, 9))
WHERE  col1 LIKE '%abc%'
"
9197,37089,Oracle SQL MINUS on 3 tables,"SELECT c.clientid, c.clientname
  FROM booking b JOIN client c
    ON b.clientid = c.clientid JOIN motel m
    ON b.motelid = m.motelid
 WHERE m.motelname = 'MotelOne'
MINUS
SELECT c.clientid, c.clientname
  FROM booking b JOIN client c
    ON b.clientid = c.clientid JOIN motel m
    ON b.motelid = m.motelid
 WHERE m.motelname = 'MotelTwo'
"
34067,67470,"SQL Assign ""co-efficients"" to query conditions and use them to sort result","SELECT t.*, (condition1 = 'value1') as s1, 
       (condition2 = 'value2') as s2,  (condition3 = 'value3') as s3
FROM table t
ORDER BY (s1*3 + s2*2 + s3*1);
"
15086,53731,Write a Query to Arrange Product and Category of DB table,"SELECT p.`id` AS ""id"" , p.`name`AS ""Product Name"",c.`category`AS ""Category"" 
FROM `product` p
INNER JOIN `category`c ON (p.`cat_id`=c.`cat_id`)  
ORDER BY p.`id` ASC
"
29262,28021,sqlite sorting SUM column values,"SELECT SUM(bytes) AS total_bytes, stamp_updated 
FROM acct 
WHERE stamp_updated BETWEEN datetime('now', 'localtime','-7 hours') AND datetime('now', 'localtime') 
GROUP BY ip_src 
ORDER BY total_bytes DESC limit 10;
"
30882,26204,Convert MSSQL to Informix,"WHERE timestamp1 > NVL(timestamp2, '1900-11-11 00:00:00');
"
1830,35485,sql : fusion of lines from one table,"SELECT * FROM mytable t1 
INNER JOIN  mytable t2 ON t1.idA = t2.idB AND t1.idB = t2.ida AND t1.ida<t1.idb
"
5708,39579,Categorize select with multiple DATE BETWEEN,"SELECT
    col1, col2, ..., coln,
    date BETWEEN ""date[0][start]"" AND ""date[0][end]"" AS first,
    date BETWEEN ""date[1][start]"" AND ""date[1][end]"" AS second
FROM tbl
WHERE date BETWEEN ""date[0][start]"" AND ""date[0][end]""
OR date BETWEEN ""date[1][start]"" AND ""date[1][end]""
ORDER BY first 
"
10815,75027,telling if key exists in mysql table is taking too long,"select datediff(date,now()) from minute_data  
where EXISTS(SELECT * FROM minute_data WHERE symbol = ""CSCO"") 
AND symbol = ""CSCO"" order by date desc limit 1;
"
9015,16476,Convert int to date in SQL server,"SELECT DATEADD(DAY,duration_stay,movedate) AS toDate FROM Table_name;
"
4560,21024,Adding days to a date in a table - SQL,"Select TO_CHAR(DateQualified + 15,'Month fmDD, YYYY') as ""Reminder Date""
  FROM Qualified;
"
3087,73438,SQL -- create column in SELECT to test equality,"SELECT  StaffID
        , StartTime
        , EndTime
        , Case
          When StartTime = EndTime Then 1
          else  0
        End as AreEqual
FROM    tblSchedule
Where   StaffID = xxx
"
16572,45501,taking common things out in the where condition in sql query,"WHERE
   ( 
       ([status] IN (3,4))
       OR 
       ([status] = 5 AND DATEDIFF(n, CAST(DelDate AS DATETIME), GETDATE()) <= 3)
   )
   AND locid = 6 AND dtime >= getdate()-50
"
16762,31265,how to backup all DB info using mysqldump?,"mysqldump --opt dbname | gzip - > dump
"
15691,54122,SQL Server 2008 - Go From Select to Edit Quickly,"SELECT TOP(200) .....
"
17108,18277,Select from a sub select using the same table optimization,"select i.ip, u.setting, u.version
from (select count(id_update) as counter, ip
      from vas_updates
      where date between '2016-05-09 14:00:00' and '2016-05-09 23:00:00'
      group by ip
      having counter = 2
     ) i join
     vas_updates u
     on u.ip = i.ip
 order by ip;
"
4931,21756,How do I combine two tables with inner join and count some of the columns,"select g.gangid, 
       count(p.username) as total_members, 
       sum(cash+bank) as total_wealth
from gang g
left join players p on p.gang = g.gangid
group by g.gangid
"
24840,67872,How to manipulate ntext type data in stored procedure of SQL Server 2008,"declare @txt nvarchar(max)
select @txt = NTextField from YourTable where id = @ID

... process @txt ...

update YourTable set NTextField = @txt where id = @ID
"
31541,6015,Maximizing performance of SQL indexes for VARCHAR columns with homogeneous prefixes,"SELECT * FROM Products WHERE ProductID LIKE 'FrobBar%'
"
37186,64388,Assign a variable to the output of a stored procedure,"CREATE PROC myProc @in INT, @out INT OUTPUT
AS 
    SELECT @out = @in+20

GO

DECLARE @in INT, @out INT 

SET @in = 1

EXEC myProc @in= @in, @out=@out OUTPUT

SELECT @out

DROP PROC myProc
"
22005,63708,How can I get a list showing the subtraction result between current Row ID and Previous Row's ID?,"SELECT
  ID,
  ID - coalesce(
                 (select max(ID) from foo foo2 where foo2.id<foo.id)
                , 0) as Diff
FROM foo
ORDER BY foo.ID DESC
"
1869,22591,Concatenate fields of rows with the same ID in MySQL,"SELECT m.id, GROUP_CONCAT(distinct(g.loc)) 
FROM mutations m JOIN
    genes g
    ON m.id = g.id
GROUP BY m.id;
"
10427,68180,Different Group By Clause on same Query (Select/Where),"WITH basequery AS (Select * From [Big where clause with many tables])
SELECT X, COUNT(*) FROM basequery GROUP BY X
UNION ALL
SELECT Y, COUNT(*) FROM basequery GROUP BY Y;
"
33029,48406,Generating dates between two dates,"select 
  A.ID, 
  A.START_DATE+delta dt
from 
  t_dates A, 
  (
     select level-1 as delta 
     from dual 
     connect by level-1 <= (
       select max(end_date - start_date) from t_dates
     )
  )
where A.START_DATE+delta <= A.end_date
order by 1, 2
"
36978,75325,"select x posts, regardless of number of inner joined category rows"," select s.*,c.* 
 from story s 
 left outer join categories c 
      on c.story_id=s.story_id 
 where story_id in (select story_id from story order by pub_date desc limit 10)
"
27228,38466,Group and count returned SQL,"select student_id, COUNT(distinct ac.ident) as active_idents
from abb_click ac
join abb on abb.ident = ac.ident
where abb.active = 1
--and student_id = 945
group by student_id
"
10064,72344,Where to filter 'Deleted' rows in a query,"SELECT *
FROM TableA a
   JOIN TableB b 
      ON b.id = a.pkid
         AND a.deleted IS NULL
         AND b.deleted IS NULL
   JOIN TableC c
      ON c.id = b.pkid
         AND c.deleted IS NULL
"
31359,41990,Help with sql query,"SELECT city.name, citizen.name, citizen.age 
FROM citizen
JOIN city ON city.id_city = citizen.id_city
ORDER BY citizen.name <> 'some_name', citizen.age
"
14962,33089,Retrieving multiple rows in SQL Server but distinct filtering only on one,"SELECT        Product.Name
            , max(Product.ProductID) as ProductID
            , max(Product.GroupID) as GroupID
            , max(Product.GradeID) as GradeID,
            , AVG(tblReview.Grade) AS Grade
FROM            Product left Join tblReview ON Product.GroupID = tblReview.GroupID

WHERE        (Product.CategoryID = @CategoryID)

GROUP BY Product.Name

HAVING COUNT(distinct Product.Name) = 1
"
29203,72687,query the lastest SMS messages group by contact,"Cursor cur = this.getContentResolver().query(Uri.parse( ""content://mms-sms/conversations?simple=true""), null, null, null, ""normalized_date desc"" );
"
38810,41361,Open up a sql file and running it in PostgreSQL is having an issue with the path because of space in the folder name,"""C:\Progra~1\pgAdmin III\1.16\psql"" -d [tablename] ...
"
28465,41534,How to set priority for search value,"SELECT `course`.`id`, `course`.`name` 
 FROM `course` 
 WHERE `name` LIKE 'TEB lorem ipsum' or 
       `name` LIKE '%TEB%' or 
       `name` LIKE '%lorem%' or 
       `name` LIKE '%ipsum%'
ORDER BY CASE WHEN `name`='TEB lorem ipsum' THEN 1 ELSE 2 END ASC
"
21170,49003,Oracle Stored Procedure Name,"create or replace procedure ""!@#$%^&*();:<>?,./\|{}[]""( ""@#$%;<>^^@@&"" number )
is 
begin
  dbms_output.put_line( 'Output is ' || ""@#$%;<>^^@@&"" );
end;
/

exec ""!@#$%^&*();:<>?,./\|{}[]""( 2 );

run -------
Output is 2
"
8342,32025,How to generate values in dataset," INSERT INTO newTable
 SELECT tb1.userID, tb1.SongID, tb1.Rating, tb2.GenreID
 FROM tab1
 LEFT JOIN tab2
 ON tab1.SongID = tab2.SongID
"
3432,33942,Insert Data Into Temp Table with Query,"SELECT *
INTO #Temp
FROM

  (SELECT
     Received,
     Total,
     Answer,
     (CASE WHEN application LIKE '%STUFF%' THEN 'MORESTUFF' END) AS application
   FROM
     FirstTable
   WHERE
     Recieved = 1 AND
     application = 'MORESTUFF'
   GROUP BY
     CASE WHEN application LIKE '%STUFF%' THEN 'MORESTUFF' END) data
WHERE
  application LIKE
    isNull(
      '%MORESTUFF%',
      '%')
"
26821,51524,SQL - Retrieve records based on parameters where either parameter can be null,"SELECT *
  FROM table_name
 WHERE groupID    = coalesce(@groupIDParameter, groupID)
   AND deliveryID = coalesce(@deliveryIDParameter, deliveryID)
"
33036,37752,How do I write this query in SQL?,"SELECT A.Artist
    FROM 
    Album A
    INNER JOIN Album B ON A.Artist=B.Artist AND A.Year=B.Year
    WHERE A.Type='LIVE' AND B.Type='STUDIO'
"
31666,35071,Removing specific value from SQL database,"UPDATE
    S
SET
    Column1 = CASE WHEN CHARINDEX('(', REVERSE(S.Column1)) > 0
        THEN REVERSE(RIGHT(REVERSE(S.Column1), LEN(S.Column1) - CHARINDEX('(', REVERSE(S.Column1))))
        ELSE S.Column1
    END 
FROM
    dbo.Source AS S;
"
23261,52737,SQL intersect get all matching rows,"with cte as
(select t2.*,
        count(t1.field1) over (partition by t1.field2) t1c,
        count(t2.field1) over (partition by t2.field2) t2c
 from table1 t1
 full join table2 t2 on t1.field2 = t2.field2)
select distinct field1 from cte where t1c=t2c
"
32215,71904,Sqlite SQL query to include empty groups,"SELECT participiants.name, MAX(outcomes.score)
FROM participiants
LEFT JOIN outcomes
ON participiants.name = outcomes.participiant
GROUP BY participiants.name
"
5780,66278,"join just last record in second table, but include records don't have match in second table","select cs.*, o.* from customers cs
left outer join (
  select customerid, max(orderid) as orderid from orders
  group by customerid
) lnk on cs.customerid = lnk.customerid
left outer join orders o on lnk.orderid = o.orderid
order by cs.customerid
"
23352,27375,Selecting the newest records for 6 unique columns,"with x as 
(select row_number() over(partition by from_currency_id order by record_created desc) rn, * from shared_currency_exchange)
select from_currency_id, xchg_rate from x 
where rn = 1
"
34319,23994,Getting associated/corresponding row without duplicates?,"SELECT giver,*(...except taker column )   FROM conversations WHERE giver = '%d' 
union 
SELECT taker,* (...except giver column)  FROM conversations WHERE taker = '%d' 
"
6379,10030,concatenating multiple fields in one record sql,"SELECT user, month, GROUP_CONCAT(event), SUM(gross)
FROM xyz
GROUP BY month
"
7325,13413,Where statement where the user's average minutes is greater than or equal to the overall average minutes?,"  select user_firstname + ' ' + user_lastname as technician_name, 
    avg(ticket_request_date - ticket_closeddate) as average_minutes_per_ticket
  from hd_users
    join hd_tickets on ticket_requestor_id=user_id
  where user_is_technician = ‘Yes’ 
  having
    avg(ticket_request_date - ticket_closeddate) >= (
         select avg(ticket_request_date - ticket_closeddate) from hd_users)
"
38057,36233,MySQL query with two joins,"SELECT areas.name AS aname, COUNT(consultants.id) AS cct 
FROM areas
    LEFT JOIN consAreas ON consAreas.area = areas.id 
    LEFT JOIN consultants ON consultants.id = consAreas.cons AND consultants.active = 1
WHERE 
    areas.areaID = $area 
GROUP BY areas.id 
ORDER BY areas.name
"
5091,52004,oracle string manipulation,"select substr('abc-123-xyz-456',1,instr('abc-123-xyz-456','-',1,n)-1) 
  from dual;
"
26806,75075,GROUP BY based on String value,"SELECT left(locale, 2), count(id) FROM table group by left(locale, 2)
"
21436,47101,insert data in sql server from other table,"INSERT INTO TABLE_2(Id,NAME)
 SELECT MAX(NUMBER) + ROW_NUMBER() OVER (ORDER BY name),name
 FROM TABLE_3
 group by name
"
16293,48415,Oracle SQL -Retrieving Master and Child's data,"SELECT t.master_job_id,r.Lang_Id,sum(a.amount)
FROM Master_Child t
INNER JOIN amount a
 ON(a.job_id in(t.master_job_id,t.child_job_id))
INNER JOIN Rate r
 ON(a.rate_id = r.rate_id)
GROUP BY t.master_job_id,r.lang_id
"
17719,12318,MySQL: make query to copy everything from one table to another one ORDERING BY,"create table table2 as
    select @rn := @rn + 1 as id, name, frequency
    from table1 cross join (select @rn := 0) const
    order by frequency desc
"
21087,22292,OrientDB - Result from 2 different tables,"SELECT in.*,out.*,Day 
FROM (SELECT expand(both('Friend').outE('isGoing')[Day = 29]) 
      FROM #12:0)
"
14398,12930,Why aren't nulls counted in COUNT(columnname),"SELECT COUNT(ID) as NotNull, SUM(CASE WHEN ID IS NULL then 1 else 0 end) as NullCount
"
17110,7249,What's the simple expression to get bigger number from two with T-SQL?,"DECLARE
    @n1 INT = 2,
    @n2 INT = 3

SELECT MAX(n) FROM (VALUES(@n1), (@n2)) t(n)
"
12978,2847,MySQL vertices & edges intersection,"SELECT * FROM edges e 
JOIN users u1 ON e.name1 = u1.name 
JOIN users u2 ON e.name2 = u2.name
"
28161,28895,How to join a table with multiple foreign keys from the same table?,"SELECT 
    m1.ModeName,
    m2.ModeName,
    m3.ModeName,
    m4.ModeName,
    m5.ModeName
FROM Modes m
LEFT JOIN Ref m1 on m1.ModeID = m.Mode1
LEFT JOIN Ref m2 on m2.ModeID = m.Mode2
LEFT JOIN Ref m3 on m3.ModeID = m.Mode3
LEFT JOIN Ref m4 on m4.ModeID = m.Mode4
LEFT JOIN Ref m5 on m5.ModeID = m.Mode5
"
9403,15396,How to assign correlative numbers to rows only using SQL?,"ROW_NUMBER() OVER (PARTITION BY InvoiceDate ORDER BY InvoiceNumber)
"
17777,8176,SQL trigger to show salary change,"CREATE OR REPLACE TRIGGER salary_changes
AFTER DELETE OR INSERT OR UPDATE ON FACULTY
FOR EACH ROW

DECLARE
  sal_diff  NUMBER;
BEGIN
 If (INSERTING or UPDATING) then 
     sal_diff  :=  :NEW.F_SALARY  - :OLD.F_SALARY;
     DBMS_OUTPUT.PUT_LINE('Difference: ' || sal_diff);
  END IF;

 IF DELETING THEN 
    DBMS_OUTPUT.PUT_LINE('The deleted value is:' || :OLD.F_SALARY);
 END IF;   
END;
"
5879,58323,SQL: Get all records from one table AND a count of records from a second table?,"SELECT tableA.*
    ,(SELECT count(commentID) FROM tableB WHERE tableA.messageID = tableB.messageID) as commentcount 
FROM tableA
"
37302,12247,Having Column as Column Sum or Difference others with Hibernate,"public int getProperty3()
{
    return getProperty1() + getProperty2();
}
"
3414,43719,read a tag from a string in XML format,"val xmltype; 
host VARCHAR2;

val := xmltype(varchar2_val); 
host := val.extract('/host/text()').getStringVal()
"
24374,3148,How to find names with special characters like 'José' on MS SQL-Server,"SELECT * 
FROM Venue 
WHERE Name COLLATE SQL_Latin1_General_CP1_CI_AI Like '%cafe%' 
"
36548,48927,Improve subselect query,"SELECT 
    b.*
FROM 
    messaging_messagethread a
INNER JOIN 
    messaging_message b ON a.id = b.thread_id
WHERE 
    b.timestamp =
    (
        SELECT MAX(timestamp)
        FROM messaging_message
        WHERE thread_id = a.id
    )
    AND b.status = 'unread'
    AND b.recipient_id = 4
"
8790,54899,MySQL Nested Sets adding node above selected node,"LOCK TABLE `categories` WRITE;

SELECT @myLeft := `lft` FROM `categories`
WHERE `id` = '. $where .';

UPDATE `categories` SET `rght` = `rght` + 2 WHERE `rght` > @myLeft;
UPDATE `categories` SET `lft` = `lft` + 2 WHERE `lft` > @myLeft OR `lft` = @myLeft;

INSERT INTO `categories`(`name`, `lft`, `rght`) VALUES(""'. $name .'"", @myLeft, @myLeft + 1);

UNLOCK TABLES;
"
26364,41514,How can this stored procedure be more elegant using unpivot,"select 
    Category,
    CAST(1.00*sum(case when Gender='M' then 1 else 0 end)/COUNT(Category) AS NUMERIC(18,1)) [Male %], 
    CAST(1.00*sum(case when Gender='F' then 1 else 0 end)/COUNT(Category) AS NUMERIC(18,1)) [Female %],  
    AVG(Cost) [Avg. Cost]
from tbl 
group by Category
"
4062,56028,pl sql. 0 rows merged,"MERGE INTO regions r
   USING regions_temp t
   ON (r.id_region = t.id_region)
    WHEN MATCHED THEN update  set r.region_name =  t.region_name
"
24985,7647,Trigger for after large upload,"$db = new mysqli('host', 'username', 'password', 'database');

$sql = 'LOAD DATA LOCAL...';
$db->query($sql);

$sql = 'UPDATE tempdirtysi SET ...';
$db->query($sql);


$sql = 'INSERT INTO temploadsi SELECT * FROM tempdirtysi';
$db->query($sql);


$sql = 'TRUNCATE  tempdirtysi';
$db->query($sql);
"
6483,42935,DB2 SQL Query not considering spaces in field's data,"WHERE VAR_DATA = 'I' AND LENGTH(VAR_DATA) = 2
"
4991,54177,Postgres 9.4: fast way to convert color from hex to rgb representation,"with colors (hex_code) as (
  values ('#112233'), ('#203040')
)
select 'rgb('||
       ('x'||substr(hex_code,2,2))::bit(8)::int||','||
       ('x'||substr(hex_code,4,2))::bit(8)::int||','||
       ('x'||substr(hex_code,6,2))::bit(8)::int||')'
from colors
;
"
29775,679,Regex Search in phpMyAdmin,"[[:<:]]files/
"
25133,52162,Outer join does not display wanted (null) rows,"SELECT b.User, p.Period, a.Qty
FROM (SELECT User FROM table WHERE Period = 11203) b
CROSS JOIN (SELECT DISTINCT Period FROM table 
            WHERE Period BETWEEN 11201 AND 11202) p
LEFT JOIN table a
ON a.User = b.User
AND a.Period = p.Period
"
23627,1479,SQL Query: Get rows (all columns) from table basied on one distinct column,"DECLARE @Data TABLE (ID INTEGER, NameField VARCHAR(10))
INSERT @Data VALUES (1, 'A')
INSERT @Data VALUES (1, 'B')
INSERT @Data VALUES (1, 'C')
INSERT @Data VALUES (2, 'A')
INSERT @Data VALUES (3, 'C')
INSERT @Data VALUES (3, 'B')

SELECT ID, NameField FROM
(
SELECT ROW_NUMBER() OVER (PARTITION BY ID ORDER BY ID) AS RowNo, *
FROM @Data
) x
WHERE RowNo = 1
"
1889,59553,Multiple column to single column with column header?,";with cte as
 (select 
  ID,
  value,
  row_number() over (partition by id order by value) rn
  from dbo.Staging
  unpivot
  (
   value
   for col in (I1, I2,I3 )     
  ) un
 )

 select 
 id, 
 value, 
 case when rn = 1 then 'I1' when rn = 2 then 'I2' else 'I3' end as 'Column header name'
 from cte
"
32797,13436,how to split values in SQL,"declare @var nvarchar(100)='612831408762037_617540318291146';

select 
    LEFT(@var, charindex('_',@var)-1), 
    RIGHT(@var, charindex('_',REVERSE(@var))-1)
"
14517,61312,MySQL insert and unicode characters,"INSERT INTO simple_table VALUES ('l\\u2019agave');
"
14798,69926,SQL Statement with CASE when there are no values,"select nvl(max(is_expired), 'N')
  from test
 where product_no = '12DF';
"
5160,28159,Insert duplicate rows for a new id based on result of another query,"insert into user_records (userId, column1)
select u.userId, ur.column1
from user_records ur
  cross join users u 
where ur.userId = 1
  and u.active = 1
  and u.userId not in (select userId from user_records);
"
704,3032,Select query in row_to_json function,"select row_to_json(t)
from (
   select productid, product from gtab04
) t
"
807,66831,inner join same table,"select user.user_fname
      ,user.user_lname
      ,parent.user_fname
      ,parent.user_lname
  from users as user
  join users as parent on parent.user_id = user.user_parent_id
 where user.user_id = $_GET[id]
"
31409,20883,Oracle job scheduler create program to create/drop materialized view,"CREATE OR REPLACE PROCEDURE refresh_mv(p_mv_name VARCHAR2) AS
BEGIN
   EXECUTE IMMEDIATE '
      CREATE MATERIALIZED VIEW ' || dbms_assert.simple_sql_name(p_mv_name) || '
      PARALLEL
      NOLOGGING
      NEVER REFRESH
      AS
      SELECT * FROM <biq_query>';
   EXECUTE IMMEDIATE 
      'CREATE OR REPLACE VIEW outside_view AS SELECT * FROM '||p_mv_name;
   -- DROP old mv?
END;
"
1163,34297,Get the last update time for each employee using oracle query,"SELECT Employee_name, Employee_status, update_time  
FROM
(
    SELECT Employee_name, Employee_status, update_time,
           RANK() OVER (PARTITION BY Employee_name ORDER BY update_time DESC) as Rank
    FROM Employee
)
WHERE Rank = 1
"
8631,17398,Update a column based on the primary id in this order,"update student2
set city_id =
    (select min(id) from student2 s where s.city_name = student2.city_name)
"
10084,46971,Extract data in Oracle DB,"`SET echo OFF`

`SET feedback OFF`

`SET pagesize 0`

`SET term OFF`

`SET trims ON`

`SET timing OFF`

`SET verify OFF`

`SPOOL D:\result.txt`

`select a.id || '|' || a.name || '|' || a.Country From Customer a, list b`

`where a.id = b.id;`

`SPOOL OFF`

`quit`
"
7837,21312,SQL - run query against different table (dynamic table) based on parameter,"IF @date = CAST(getdate() as date)
BEGIN 
SELECT * FROM server1.db1..MyTable
ELSE
SELECT * FROM server2.db2..MyTable_history WHERE date = @date
END
"
35278,67149,SQL check if more than one field in range is >0,"Select RowId, Case when NewField > 1 then 1 else 0 end as 'Status' from 
(
    Select *,
        case when Football > 0 then 1 else 0 end +
        case when Cricket > 0 then 1 else 0 end +
        case when Tennis > 0 then 1 else 0 end +
        case when Athletics > 0 then 1 else 0 end as 'NewField'
    from TableName
)
"
14291,3199,PIVOT not performing as expected,"select *
from
(
    select entityid, [name], stringvalue as stringvalue
    from mytable
) as d
pivot
(
    min(stringvalue)
    for [name] in ([ShortDescription],[LongDescription])
)
as p
"
29400,7154,Data Matching with SQL and assigning Identity ID's,"with temp as
(
select 1 as id,'John' as name
union
select 2,'John'
union
select 3,'Smith'
union
select 4,'Smith'
union
select 5,'Smith'
union
select 6,'Carl'
)

SELECT *, DENSE_RANK() OVER
(ORDER BY Name) as NewId
FROM TEMP
Order by id
"
30231,36017,Select from dynamic table into Datatable Oracle,"CREATE OR REPLACE PROCEDURE GET_TABLEINFO(o_rc OUT sys_refcursor, inTableName IN varchar2) AS       
    sqlquery VARCHAR2(32000);
BEGIN
    sqlquery := 'SELECT * FROM ' || inTableName;
    OPEN o_rc FOR sqlquery;
END;
"
5632,7659,insert values from one table to another talbe,"INSERT INTO Tbl2(UserId, TimesTamp)
SELECT u.Id,'2016-01-31 23:59:59'
FROM tbl1 AS u;
"
12087,57736,Integer comparison as string,"SELECT * FROM Table WHERE CheckVar LIKE '''' + to_char(<num>,'999') + '%'
"
28311,34174,MySQL first free number between exists values,"SELECT data.sPort
FROM 
  ((SELECT (s.server_port + 1) sPort
  FROM pro_servers s
  LEFT JOIN pro_servers sp1 ON sp1.server_port = s.server_port + 1
  WHERE (sp1.server_port IS NULL)
  ORDER BY sPort)

  UNION ALL

  (SELECT s.server_port sPost
  FROM pro_servers s
   GROUP BY s.server_port
   HAVING COUNT(s.server_port) = SUM(s.server_deleted)
  ORDER BY sPort)) AS data
ORDER BY data.sPort
LIMIT 1
"
14247,10464,where is the Oracle Event Log located?,"select value from v$parameter where name = 'background_dump_dest'
"
14142,28645,Update datetime field randomly according known datetime,"UPDATE training SET finalized = complete_date + INTERVAL FLOOR(1 + (RAND() * 3)) DAY
"
19199,30879,How to Split total hours to regular and OT hours SQL,"CASE WHEN SUM(Payroll_Hours_Tb.Hours_Worked) > 40.0
    THEN 40.0
    ELSE SUM(Payroll_Hours_Tb.Hours_Worked)
    END AS RegularHours,
CASE WHEN SUM(Payroll_Hours_Tb.Hours_Worked) > 40.0
    THEN SUM(Payroll_Hours_Tb.Hours_Worked) - 40.0
    ELSE 0.0
    END AS Overtime
"
11062,23778,Postgresql Contains in where clause,"WHERE col1 ilike '%' || col2 || '%';
"
10372,480,"Avoiding insertion of duplicate rows where ""duplicate"" is non-trivial","insert into perm (a,b,c,d,e,f)
select
t.*
from
temp t left outer join
(
select
p.*
from
perm p inner join
(
select a, b, max(c) as max_c
from perm
group by a,b) mx on
p.a = mx.a and
p.b = mx.b and
p.c = max_c
  ) p on
t.a = p.a and
t.b = p.b and
t.c > p.c and
t.d = p.d and
t.e = p.e and
t.f = p.f
where
    p.a is null
"
8438,16952,Possible to return records and count from a CTE?,"with temp as
(
    SELECT ROW_NUMBER() OVER( ORDER BY o.createDate) as rowNum,
           o.orderId
    FROM Orders as o
)
SELECT * FROM temp where rowNum BETWEEEN 10 and 20
SELECT @Count = COUNT(*) FROM Orders
"
18428,45192,Get count per year of data with begin and end dates,"select
    <city_id>, c.y, count(t.city_id)
from generate_series(1990, 2005) as c(y)
    left outer join Table1 as t on
          c.y between extract(year from t.start_date) and extract(year from t.end_date) and
          t.city_id = <city_id>
group by c.y
order by c.y
"
21726,9387,Separating column into two separate columns,"select 
    case when charindex(',',name) > 0 
            then left(name, charindex(',',name)-1 ) 
            else name end,
    case when charindex(',',name) > 0 
            then ltrim(substring(name, charindex(',',name)+1, len(name) )) 
            else null end   
from yourtable
"
39241,54630,How do I list all context namespaces in Oracle DB?,"SELECT namespace,
       schema,
       package,
       type
  FROM dba_context
"
492,31503,MySQL - SELECTing based on an IF-statement,"SELECT t.one,
       t.two,
       t.three,
       CASE WHEN 1 = 1 THEN t.four ELSE NULL END AS four
  FROM TABLE t
"
31791,19077,Retrieving the last filtered record in each group,"SELECT m.*, t1.* FROM mood m 
LEFT JOIN temper t1 ON ( m._id = t1.mood_id AND t1.status_id !=1) 
LEFT JOIN temper t2 ON ( t1.mood_id = t2.mood_id AND t1._id < t2._id AND t2.status_id !=1 ) 
WHERE t2._id IS NULL 
AND m.grantee_username = ""username"" 
AND m.status_id != 1; // NOT INTERESTED IN THIS FILTER
"
38585,12037,How to count from a table based on another table,"SELECT QO.Question_ID, QO.Option_Label as Choice, COUNT(*) as VotesMale
FROM Question_Options QO 
LEFT JOIN Session_Answers SA ON QO.ID = SA.Option_ID
JOIN [Session] S ON S.ID = SA.Session_ID AND S.Gender = 'M'
WHERE QO.Question_ID = 10114<---the Question ID
GROUP BY QO.Question_ID, QO.Option_label
"
27204,35775,Insert into table which has only one column,"insert into mytable default values
"
1035,18169,"SQL query: Simulating an ""AND"" over several rows instead of sub-querying","SELECT contentID
FROM tags
WHERE tagID in (334, 338, 342)
GROUP BY contentID
HAVING COUNT(DISTINCT tagID) = 3


--In general
SELECT contentID
FROM tags
WHERE tagID in (...) --taglist
GROUP BY contentID
HAVING COUNT(DISTINCT tagID) = ... --tagcount
"
3737,68548,Join Two Queries/Select Statement,"SELECT j.id, pc.name, ps.name
FROM j
INNER JOIN p pc ON j.customer_id = pc.id
INNER JOIN jl ON j.id = jl.job_id
INNER JOIN p ps ON jl.supplier_id = ps.id
"
35534,70949,How can i get all column data with group by?,"select *
from (
  select al.*, count(*) over (partition by status_code, url, method) as cnt
  from access_log al
) t
order by cnt desc
limit 20
"
19620,15781,How can I perform an AND on an unknown number of booleans in postgresql?,"select bool_and(someBool)
  from myTable
  where someKey = $1
  group by someKey;
"
14805,27371,Mysql min/max optimization,"SELECT id, MIN(dateA), MAX(dateB)
  FROM TableA
 GROUP BY id;
"
1400,3778,SQL in vs intersection,"SELECT user
  FROM user_hobby
 WHERE hobby IN ('piano', 'sport')
 GROUP BY user
HAVING COUNT(*) = 2
"
35204,1235,SQL nested queries,"select 
PremiumYTDPrevious=Sum(CASE WHEN AASI.Inv_Acctcur>='200901'
    AND AASI.Inv_Acctcur<= '200904'
THEN (AASI.Inv_Premium)*R.[Percent]
ELSE 0 END),
PremiumYTDCurrent=Sum(CASE WHEN AASI.Inv_Acctcur>='201001'
    AND AASI.Inv_Acctcur<= '201004' 
THEN (AASI.Inv_Premium)*R.[Percent]
ELSE 0 END),
[... the rest of your query ...]
"
10487,27034,Why are self joins faster than or?,"select 1 as color id 
union all
select 2
"
30950,7470,Regular expression for removing Postgres SQL data insert (COPY) statements.,"pg_dump -s mydatabase > dump.sql
pg_dump -a -t table_i_want1 -t table_i_want2 -t table_i_want3 >> dump.sql
"
37625,44894,SQL Multi-table update syntax,"UPDATE 
    t
SET
    t.FormulaID = t1.formulaID
FROM
   tblWOSampleTest t
   INNER JOIN tblTest t1 ON t1.TestID = t.TestID;
"
10265,72557,VBA not recognizing Value of Unbound Textbox for Query,"whereString = ""LabDate Between #"" & myStartDate & ""# AND #"" & myEndDate & ""#""
"
16648,73560,SQL Statement - Excluding certain data,"SELECT Job.Job
FROM   Job LEFT JOIN Jobs ON Job.ID = Jobs.JobID
WHERE  Jobs.DepartmentID IS NULL;
"
23869,24746,Using IN with a sub query,"CREATE TABLE TableB (
  TableBID INT,
  TableAID INT
)

INSERT INTO TableB
      SELECT 1, 1
UNION SELECT 1, 2
UNION SELECT 1, 3
UNION SELECT 1, 4
UNION SELECT 2, 3
UNION SELECT 2, 4
UNION SELECT 2, 5
UNION SELECT 2, 6
"
33275,70391,WPF Bind a ListView to Oracle Data Source,"Dim Context as New myOracleEntityModel

myTable = Context.myCustomers.ToList

myItemSource = From i In myTable
               Select i.ID, i.status, i.date

lsvCustomerDetails.ItemSource = myItemSource
"
23237,44686,Sysdate minus 2 different days,"SELECT
    VERSION_NAME AS VERSION,
    MIN(RECONCILE_START_DT) AS DATES
FROM
   SDE.GDBM_RECONCILE_HISTORY
WHERE
    RECONCILE_RESULT = 'Conflicts'
AND
    RECONCILE_START_DT > SYSDATE -
        CASE TO_CHAR(SYSDATE, 'D')
            WHEN '2' THEN 2
            ELSE 1 END

GROUP BY VERSION_NAME
ORDER BY 2 ASC NULLS LAST
"
26046,35324,SQL: How to enforce functional dependency using constraints?,"CREATE VIEW V 
WITH SCHEMABINDING 
AS 
  SELECT AssignedUser, 
         Zone, 
         COUNT_BIG(*) AS C 
  FROM   dbo.Jobs 
  GROUP  BY AssignedUser, 
            Zone 

GO 

CREATE UNIQUE CLUSTERED INDEX IX 
  ON V(AssignedUser) 
"
38096,23131,iOS simple SQL bug,"DELETE FROM ITEMS WHERE CATEGORY = 'category'
"
9193,25528,How to optimize this sql delete statement,"where not exists ( select top 1 1 from... where... )
"
27297,58448,Subquery returning number rows,"SELECT b.bank_id, COUNT(*)
FROM 
    bank b
        LEFT JOIN branches br ON br.bank_ID = b.bank_ID
GROUP BY b.bank_id
ORDER BY COUNT(*) DESC
LIMIT 1
"
23754,58327,auto_increment with varchar in oracle,"create or replace trigger some_trig_name
before insert on WishList
for each row
begin
:new.idWishList := to_char(your_sequence.nextval);
end some_trig_name;
"
8026,60110,search in sql with 2 input parameter,"CREATE PROC dbo.Answers
@Username nvarchar(20),
@Name nvarchar(20)
AS

declare  @Name2 nvarchar(20)
set @Name2 = ISNULL(@Name, '00')

SELECT *  
FROM dbo.tbl_answer
WHERE an_del = 1 AND ( u_username LIKE ISNULL('%' + @Username + '%', u_username)
  AND  
ISNULL(u_name,'00') LIKE  '%' + @Name2 + '%' )
"
6458,26670,Fast search of nearest values in SQL,"select * from pos order by ((lat-48.00333)*(lat-48.00333)+(long-11.0)*(long-11.0)+(alt-652)*(alt-652));
"
7115,38073,Can I remove transients in the wp_options table of my WordPress install?,"DELETE FROM `wp_options` WHERE `option_name` LIKE ('%\_transient\_%')
"
20139,70129,Need help on my SQL logic (combining columns and Distincts),"SELECT PO_NUMBER, MIN(PO_QUANTITY) AS PO_QUANTITY, SUM(COALESCE(SHIPPED_WT, 0)) AS SHIPPED_WT
FROM VW_TRAFFIC_PO_SIDE
WHERE SYSDATE > PO_SHIPMENT_TO
GROUP BY PO_NUMBER
HAVING MIN(PO_QUANTITY) > SUM(COALESCE(SHIPPED_WT, 0))
"
23025,17135,SQL - Counting references in multiple tables,"SELECT SUM(cnt) FROM (
 SELECT COUNT(*) as cnt FROM `images` WHERE mid = 'abcd1234'
 UNION ALL
 SELECT COUNT(*) FROM `sets` WHERE mid = 'abcd1234'
 UNION ALL
 SELECT COUNT(*) FROM `scripts` WHERE mid = 'abcd1234'
) a
"
928,32511,"Best way to deal with csv , for preparation for mySql","INSERT INTO suburbs (`Locality`,`Pcode`,'State`) VALUES ('STANLEY','7331','TAS');
"
17020,57779,Search and Replace a a partial string / substring in mssql tables,"update MyTable 
    set MyColmun = cast(replace(cast(MyColumn as nvarchar(max)), N'/oldserver.com/foo/', N'/newserver.org/bar/') as ntext)
    where cast(MyColumn as nvarchar(max)) LIKE N'%/oldserver.com/foo/%'
"
14056,8504,SQL Delete with Subquery,"DELETE t1
FROM Table1 t1
inner join 
(
   select col1, col2 
   from other_table 
   where ...
) t2 on  t2.col1 = t1.col1 
     and t2.col2 = t1.col2
"
25552,70332,inserting records using a transaction,"$user = new User();
$user->fill(Input::all());
try {
    DB::beginTransaction();
    $user->save();
    $profile = new Profile();
    $user->profile()->save($profile);
    DB::commit();
    return Response::json(array('message' => 'Your account has been created.'));
}
catch (QueryException $e) {
    DB::rollBack();
    return Redirect::to('url')->withInput()
            ->with('error', 'Error occurred. Try again or contact administrator');
}
"
38763,4999,SQL Server - Update a column if row is the first record in group,"with cte as (
 select row_number() over (partition by Brand, Category order by Date) as rn
, FirstValue
from Table)
update cte
set FirstValue = case when rn = 1 then 1 else 0 end;
"
18838,32160,Selecting a grouped condition in an Aggregate query,"create view myview as
select
    avg(old_foo.stuff),
    foo.person_id,
    foo.date_ as this_date,
    offset
from
    generate_series(1, 100) as offset,
    foo,
    join ( select stuff, person_id, date_ from foo) as old_foo
        on old_foo.date_ < foo.date_
        and old_foo.date_ > foo.date_ - offset

group by person_id, this_date, offset
;


select * from myview where offset = 10;
"
27532,64545,SELECT 2 entries from a JOIN into 1 row,"select  m.ManualId
,       mlFr.Description as DescriptionFr
,       mlEn.Description as DescriptionEn
from    Manual m
left
outer
join    ManualLang mlFr
on      m.ManualId = mlFr.ManualId
and     mlFr.LangId = 'FR-CA'
left
outer
join    ManualLang mlEn
and     mlEn.LangId = 'EN-CA'
on      m.ManualId = mlEn.ManualId
where   m.ManualId = 180
"
14251,43390,"How to model a relationship ""A included in B or A=B"" in SQL?","CHECK (
    (COUNTRY_ID IS NULL AND REGION_ID IS NOT NULL)
    OR (COUNTRY_ID IS NOT NULL AND REGION_ID IS NULL)
)
"
38211,74361,How to delete records that match a condition and leave one?,";WITH CTE AS(
    SELECT *,
        rn = ROW_NUMBER() OVER(PARTITION BY code ORDER BY (SELECT NULL))
    FROM #TEMP_RESULTS  
    WHERE result LIKE '<%'
)
DELETE FROM CTE WHERE rn > 1
"
14872,45948,Counting records with a specific date value,"ALTER PROCEDURE [dbo].[SP_GET_QUEUESINFO_BY_DATE]
AS
BEGIN
declare @date2 datetime
set @date2= '2012-09-21'
select COUNT(QueueID) ,
sum(case when QueueNumIn != 0 THEN 1 else 0 end) as 'InQueue',
sum(case when QueueNumOut != 0 THEN 1 else 0 end) as  'OutQueue'
from Queue where QueueDate >= @date2
END
"
4580,33852,Change only one column of one row in SQL,"UPDATE mytable
SET    col7 = 'newvalue'
WHERE  id = '156'
"
1484,33791,Comparing values from two different tables in SQL Plus Oracle,"SELECT FirstName, SecondName
FROM Doctor, Job, Hospital
WHERE Hospital.Name = 'HospitalName' 
AND Job.hospital_id = Hospital.hospital_id
AND job.Doctor_id = Doctor.doctor_id;
"
32988,7666,Is it possible to name SQL result columns from rows in another table? (Postgres),"SELECT u.id, a_city.value AS city, a_region.value AS region
 FROM users u
 INNER JOIN user_attribute_values a_city ON a_city.client_id = u.id AND a_city.attribute_id = 8
 INNER JOIN user_attribute_values a_region ON a_region.client_id = u.id AND a_region.attribute_id = 9
 WHERE LENGTH(a_city.value) > 0
   AND LENGTH(a_region.value) > 0
"
18020,44817,RAND not different for every row in T-SQL UPDATE,"CHECKSUM(NEWID()) % 365
"
7649,73424,SQL Query for Group by with two sorting values and count the equal values,"SELECT year(date), month(date),
       substring_index(group_concat(branch order by date desc), ',', 1) as last_branch,
       SUM(sale) as sale, SUM(profit) as profit,
       count(distinct branch) as NumBranches
FROM sales_report
GROUP BY year(date), month(date)
ORDER BY min(date);
"
15447,35002,SQL Distinct Count with an exception,"SELECT COUNT(DISTINCT FLOOR) as NB_FLOORS FROM TABLE_ID WHERE FLOOR <> 'B'
"
13025,68231,How can you create a MySQL database?,"CREATE DATABASE database_name
"
39774,19906,group by query challenge,"select c.id, count(o.order_id),sum(if(o.discount,1,0))
from customer c 
left join order as o using c.customer_id = o.customer_id
group by c.id
"
3146,67191,"How to select all values, not just those in where clause","Select id, type from 
(SELECT id, GROUP_CONCAT(type SEPARATOR ',') AS type FROM rock_types 
        GROUP BY id) a
WHERE INSTR(type,""DWS"")>0 OR INSTR(type,""Top rope"")>0
"
15405,30431,Order by NULL values with mysql,"SELECT id, description, status, login FROM dev
ORDER BY status IS NULL, status DESC, login IS NULL, login DESC
"
36997,20289,Transaction with One SQL Statement,"CREATE TRIGGER myPostsTrigger AFTER INSERT
ON posts
FOR EACH ROW
BEGIN
    UPDATE categories SET count = count + 1 WHERE id = NEW.category_id
END
"
2741,11366,"SQL, select sum of values by group","select id, sum(stock) as stock, avg(rate) as rate
from product
group by rollup(id);
"
26469,35327,Sqlite query to select similar unknown rows,"sqlite> create table t(item,price,quantity);
sqlite> insert into t select 'xyz',20,10;
sqlite> insert into t select 'xyz',20,10;
sqlite> insert into t select 'abc',10,40;
sqlite> insert into t select 'def',60,110;
sqlite> select *,count(*) from t group by item,price,quantity having count(*) > 1;
xyz|20|10|2
sqlite> 
"
9879,59176,MySQL Query to find customers who have ordered two specific products,"SELECT COUNT(DISTINCT t1.userid) AS user_count
  FROM TRANSACTIONS t1
  JOIN TRANSACTIONS t2 USING (userid)
 WHERE t1.product_id = 'prod1' 
   AND t2.product_id = 'prod2';
"
7796,22863,Rankings using SQL,"SELECT Standings.Teams, Standings.W,
       (SELECT Count(*)+1
        FROM Standings AS Temp 
        WHERE Temp.W > Standings.W
       ) AS Wins_Rank
FROM Standings
ORDER BY Standings.W;
"
31215,52398,"Return one value if true, return another value if not true","Select 
    ID, Type, Price, Code, Date 
from 
    tblPRODUCT tbpr
where 
    (Code = '1234' AND Date IN (Select MAX(Date) from tblPRODUCT where type= tbpr.type   
and code = '1234'))
OR Date IN (Select MAX(Date) from tblPRODUCT where type= tbpr.type 
         and not exists(select code from tblPRODUCT where type= tbpr.type  and code is 
not null) ) 
"
36774,32955,SQL COUNT users with MIN date of login?,"select count(*)
from (SELECT user
      FROM table
      GROUP BY user
      HAVING MIN(login_date) = '10/3'
     ) t
"
8263,61192,Include an extra column from an original table that has an Inner Join that is listing values that only occur in a lookup table,"CREATE VIEW MissedPoints AS
SELECT Routes.[Route id]
     ,[Data Import].[Patrol id]
     ,Routes.[Tag Name]
     ,[Data Import].[Occurrence Date]  --Added
FROM Routes 
LEFT JOIN (SELECT DISTINCT [Route Id]
                ,[Patrol ID] 
                ,[Occurrence Date]  --Added
            from [Data Import]) as [Data Import] 
    on [Data Import].[Route Id] = Routes.[Route Id]
WHERE [Data Import].[Occurrence Date] is NULL
"
7905,55782,Suggest appropriate mysql date function,"SELECT DATE('2013-01-10 05:10:50') <= CURDATE() FROM DUAL;

SELECT '2013-01-10 05:10:50' <= DATE_FORMAT(NOW(), '%Y-%m-%d 23:59:59') FROM DUAL;
"
359,59986,Execute sql prepared statement with slice,"......
values := make([]interface{}, 0, len(data))
......
//adding ... expands the values, think of it like func.apply(this, array-of-values) in 
// javascript, in a way.
_, err = stmtIns.Exec(values...) 
"
14640,67476,SQL SELECT WHERE string ends with Column,"SELECT * FROM TABLE1
WHERE 'value' LIKE '%' + DomainName
"
12105,42480,"MySQL, passing a AUTO_INCREMENT to another table","INSERT INTO languages (LAST_INSERT_ID(), 'en', 'best of XX');
"
12851,3934,Update datetime timestamp minute value,"Dateadd(minute, -DATEPART(MINUTE, @ttest) % 10, @ttest)
"
5007,32108,Left and Inner Join difference... once forever,"FROM category
LEFT JOIN web_page ON web_page.category_id = category 
   and web_page.active = ""Y""
"
20978,11510,SQL Padding with zeros(LPAD) in a Database independent way,"RIGHT(CONCAT('00000', code), 5)
"
844,10070,Select data that exists in A but not in B,"SELECT a.*
FROM A as a
LEFT JOIN B AS b ON b.column = a.column
WHERE B.column IS NULL
"
1525,32159,Oracle: unable to fetch the record based on latest record inserted and join with multiple tables,"with logs as
       (select l.*
          from audit_log l join audit_item i on l.ai_id = i.ai_id
         where l.packaging_id = 100 and i.ai_name = 'AAA')
select u.email
  from users u join logs l on u.userid = l.userid
 where l.insert_date = (select max(insert_date) from logs);
"
36501,64904,DELETE MySQL subquery,"DELETE FROM uren WHERE uren.urenDossierID IN (SELECT dossierID FROM dossier WHERE dossierKlantID NOT IN (SELECT klantID from klant))
"
12333,14011,Join on same table in sql server,"SELECT yt1.id, yt1.type, yt1.account_id, yt1.start_date, yt1.end_date,
       yt2.type AS other_types
FROM product yt1 JOIN
     product yt2
     ON yt1.account_id = yt2.account_id AND
        yt1.end_date = yt2.end_date
WHERE yt1.type = 'MANGO' AND yt2.type <> 'MANGO';
"
3707,23908,Sql get top row for each type,"WITH T AS
(
SELECT *,
       ROW_NUMBER() OVER (PARTITION BY personId ORDER BY doneOn DESC) RN
FROM WorkLog
)
SELECT personId , actionType , doneOn 
FROM T
WHERE RN=1
"
12418,48634,Postgres Join with LIKE,"select tbl2.name, tbl1.rcode, tbl2.ccode, tbl1.country
from tbl1 
  join tbl2 on substring(tbl1.rcode, 1, 2) = tbl2.ccode
"
31378,14729,Converting string to currency value,"select cast(translate(col, ', %', '.') as float)
"
11845,37239,Database Years Data as script,"declare @year int
@year = 1910

while @year <= 2014
begin
    insert into years (year) values (@year)
    @year = @year + 1
end
"
29345,3184,Multiple SQL counts into single result set,"Select
(SELECT count(id) from ProductA_T where created between '<date>' and '<date>' and productstatus = ""<successful>"") as CountA
(SELECT count(id) from ProductB_T where created between '<date>' and '<date>' and productstatus = ""<successful>"") as CountB
(SELECT count(id) from ProductC_T where created between '<date>' and '<date>' and productstatus = ""<successful>"") as CountC
"
8131,5994,Top 2 Salary Grouped By Department,"SELECT *
FROM (
   SELECT *, DENSE_RANK() OVER (PARTITION BY Dept ORDER BY Salary DESC) AS rn
   FROM MyTable ) t
WHERE t.rn <= 2
"
24254,14009,Get records NOT IN local DB but in remote DB,"select r.*
from remote_table r
left join local_table l
  on l.id = r.id
where l.id is null
"
3098,65725,My SQL SELECT statement is not picking up any records when dates are the same,"string sql  = ""SELECT * FROM EDI10000 WHERE Tp_Id = '"" + tp + ""' and Rec_Date >= '"" + fromDt.ToString(""yyyy-MM-dd"") + ""' and Rec_Date <= '"" + toDt.ToString(""yyyy-MM-dd"") + ""'"";
"
10645,24545,sql server query: how to select customers with more than 1 order,"select  customerid
,       count(*) as order_count
from    orders
group by
        customerid
having  count(*) > 1
"
5948,14530,"SQL query help - Join on second table, possible?","SELECT *
FROM user
INNER JOIN report re
  ON re.id = (SELECT id 
              FROM report 
              WHERE user_id=user.id 
              ORDER BY report.date DESC
              LIMIT 1)
WHERE user.id='4'
"
19343,53451,"In Oracle, how do I select rows which contain a character within a certain numeric range?","with codes as (select rownum code from dual connect by level <= 160)
select distinct t.id, t.description
from mytable t, codes c
where t.description like '%' || chr(c.code) || '%'
and c.code >= 128;
"
24251,75294,calculate the sum of two columns category,"SELECT  a.vehicle,
        a.vehicle_color,
        COUNT(b.vehicle) Number
FROM    master a
        LEFT JOIN data b
            ON a.vehicle = b.vehicle AND
                a.vehicle_color = b.vehicle_color
GROUP   BY a.vehicle,
           a.vehicle_color
"
14406,3867,Select rows without nested associated records,"select id 
from employees E 
where not exists (
                select * 
                from assignments A 
                     join contracts C on A.ID = C.assignment_id
                     join tasks T on C.ID = T.contract_id
                where A.employee_id = E.id)
"
25867,20150,Find the closest timestamp SQL?,"SELECT c.FromIDNumber, m.Timestamp, m.X, m.Y
FROM Communication c
JOIN Movement m ON c.FromIDNumber = m.IDNumber
WHERE m.TimeStamp = (SELECT mm.Timestamp
                     FROM Movement mm
                     ORDER BY abs(mm.TimeStamp - c.TimeStamp)
                     LIMIT 1
                    );
"
36541,24045,querying the RESTRICT_REFERENCES pragma,"select text from all_source
where UPPER(text) like '%PRAGMA RESTRICT_REFERENCES%'
and owner = :owner
and name = :package_name
and type = 'PACKAGE';
"
3330,24,"SQL query against ""bad word"" filter list","select count(*) from BadWords
where @userName like '%'+theBadWord+'%'
"
18039,16917,oracle select & update or select & insert in multithreaded env,"IF (select count(1) from modify_checker where flag = 1) > 0 THEN
  -- Another thread is already working, so just raise exception
  RAISE <<exception>>
ELSE
  -- No other thread working on this, so go ahead
  UPDATE modify_checker SET flag = 1;
  COMMIT;
  <<actual code to update or insert actual table>>
  UPDATE modify_checker SET flag = 0;
  COMMIT;
END IF;
"
152,75533,"MySQL query, finding from one table and insert into second table","UPDATE
  table2
SET
  avgin=ifnull(
    (
      SELECT
        Specified
      FROM
        table1
      WHERE
        table1.Device=table2.Device
        AND substring(table1.Interface,1,3)=substring(table2.Interface,1,3)
      LIMIT 1
    ),
    'default value'
  )
"
11413,58455,"How can I get the Design mode of a table without going through ""Object explorer""?","C:> sqlcmd -U bobby -P foo
"
11548,21890,Taking IF clauses from MySQL to SQL Server 2005,"SELECT id, first, last, 
  CASE WHEN first IN (q1,q2) THEN 1 ELSE 0 END
  + CASE WHEN last IN (q1,q2) THEN 1 ELSE 0 END AS points
FROM dbo.users
ORDER BY points DESC;
"
31862,29949,How Sum value of multiple datetime?,"SELECT cs.EmployeeRun, min(cs.Date) as MinDate, max(cs.Date) as MaxDate,
       SUM(cs.Total) as SumTotal
FROM CusSalaryDay cs
WHERE cs.Date Between '2012-12-03' and '2012-12-05'
GROUP BY cs.EmployeeRun
Order By EmployeeRun
"
24711,22818,how to get duplicate rows of a single column including other columns in sql server,"SELECT CityID, cityname, CountryID
FROM tab
WHERE CityID IN (SELECT CityID FROM tab
                 GROUP BY CityID
                 HAVING COUNT(CityID) > 1);
"
15928,12929,Using the data from a for loop as a table in the From in a Select,"with example(idx, number1, number2) as (
  -- Anchor Section
  select 1
       , 1 -- initial value
       , 2 -- initial value
    from dual

  union all

  -- Recursive Section
  select prev.idx + 1
       , prev.number1 + 7
       , (prev.number2 + 8) / prev.number1
    from example prev
   where prev.idx < 100  -- The Guard
)
select * from example;
"
22413,58116,How to aggregate sum across three tables?,"select p.PatientID, p.PatientName,
       sum(case when MedicineId = 'ME001' then Quantity else 0
           end) as Total_Medicine_Bought
from MsPatient p join
     TransactionHeader th
     on p.PatientID= th.PatientID join
     TransactionDetail td
     on td.TransactionID =th.TransactionID
where PatientName like '% %'
group by p.PatientID, p.PatientName;
"
19918,41891,query behaves differently on greater than equal and less than equal,"startdate:<""2015-04-01""
startdate:<=""2015-03-31 23:59:59""
"
2537,69554,Find IDs where values are only in array,"SELECT id
FROM table
WHERE value IN ('green', 'orange', 'black')
      AND id NOT IN (
          SELECT id
          FROM table
          WHERE value NOT IN ('green', 'orange', 'black'))
"
23508,2548,PL/SQL Oracle condition equals,"WHERE col1 = col2 or col1 is null and col2 is null
"
23312,29824,How do I get the number of rows returned while using database/sql?,"count := 0
for orders.Next() {
    count++
}

log.Printf(""Successfully queried and receive %d orders"", count)
"
38913,24378,SQL SP_WHO insert statement,"DECLARE @tmpUsers table ( spid INT, ecid INT, STATUS VARCHAR(MAX), loginame VARCHAR(50), hostname VARCHAR(50), blk BIT, 
dbname VARCHAR(MAX), cmd VARCHAR(MAX), request_id INT ) 

INSERT INTO @tmpUsers
EXEC sp_who @loginame  = 'sa'

SELECT * FROM @tmpUsers 
"
23647,27550,return size of table as MB not KB,"SELECT pg_table_size('zlimitreacjed_1') / 1024 /1024 || 'MB'; 
"
21480,5691,how to include several count functions and group byes in one line,"select cg.idCustomerGroup, 
       sum(case when c.type = 'Type1' then 1 else 0 end) as num_type1,
       sum(case when c.type = 'Type2' then 1 else 0 end) as num_type2,
       sum(case when c.type = 'Type3' then 1 else 0 end) as num_type3
from CustomersGroups cg inner Join
     CustomersInGroup cig
     on cg.idCustomerGroup = cig.idCustomerGroup inner Join
     Customers c
     on c.idCustomer = cig.idCustomer
Group by cg.idCustomerGroup;
"
28992,38115,sql where clause issue with date older than 5 years,"dateadd(year,-5, getdate()) >= birthdate
"
15263,26120,Escaping correctly QUOTE characters in SQL query,"\'
"
36468,70291,Can't add a string to the end of a string,"p2.NAME like '%TFrom%' || substr(p1.name,-1)
"
21937,3933,mysql unknown column in selct query as,"SELECT u.firstname, u.lastname, u.email,
       CONCAT(u.preference, ',') AS pref
FROM users u
WHERE u.status = 1 AND u.active = 1;
"
28579,3232,How do I generate ADD FOREIGN KEY statements for a group of tables?,"SELECT CONCAT('ALTER TABLE ', table_name,
              ' ADD FOREIGN KEY (', constraint_name, ')',
              ' REFERENCES ', referenced_table_name,
              '(', referenced_column_name, ');') AS alter_cmd
FROM information_schema.key_column_usage
WHERE referenced_table_name IS NOT NULL;
"
39223,16948,How to change OPTIMIZER_MODE setting in oracle?,"alter session set OPTIMIZER_MODE = RULE;
alter session set OPTIMIZER_MODE = choose;
"
37942,18053,"SQL: Count each record, starting with the oldest to newest appointment","SELECT id
      ,[date]
      ,type
      ,ROW_NUMBER() OVER (PARTITION BY ID ORDER BY [date] ) AS seq
FROM  Appointment
WHERE Type = 'Post-op'
"
37891,31730,Remove entry from comma separated list in a column,"update #test
set value=  replace(','+value+',',',A,',',')

update #test
set value= case when len(value)=0 then '' else STUFF(value, 1, 1, '')  end 

update #test
set value=  case when len(value)=0 then '' else  STUFF(value, len(value),1, '') end  
"
38703,69967,a comma between SELECT statements,"SELECT *
FROM TableA, TableB

SELECT *
FROM TableA
CROSS JOIN TableB
"
20030,58316,How to using PostgresSQL to select between with values condition in two sets of data?,"select *
from t1
where exists
(
  select *
  from t2
  where t1.my_value between t2.value1 and t2.value2
);
"
24543,68440,Split a txt file into two files to insert in a DB,"for /f ""tokens=1,2,3 delims= "" %%i in (input.txt) do (
    echo %%i >> long.txt
    echo %%j >> lat.txt
)
"
27001,53127,Stored procedure duplicated ? in DB2,"SELECT 
    name,
    alteredts  
FROM 
    SYSIBM.SYSROUTINES 
WHERE 
    NAME = 'myproc'
AND SCHEMA = 'myschema'
"
13812,40262,Entity Framework: Detect DBSchema for licensing,"SELECT
    SERVERPROPERTY('LicenseType'),
    SERVERPROPERTY('NumLicenses'),
    SERVERPROPERTY('EngineEdition'),
    SERVERPROPERTY('Edition')
"
28362,46355,How do I select a single row for each unique combination of multiple columns?,"SELECT l.*
FROM (SELECT l.*, ROW_NUMBER() OVER (PARTITION BY name, p1, p2 ORDER BY o1) as seqnum
      FROM LOCS l
     ) l
WHERE seqnum = 1
ORDER BY name asc;
"
15942,62492,Selecting the the last row in a partition in HIVE,"select t1.*
from (select t1.*, row_number() over (partition by c1, c2 order by c3 desc) as rank
      from t1 
     ) t1
where rank = 1;
"
10700,75554,Substring in SQL query," WHERE theme LIKE '%math%'  // math appears anywhere in the string
 WHERE theme LIKE 'math%'   // math appears at the START of the string
 WHERE theme LIKE '%math'   // math appears at the END of the string
"
29320,7700,Oracle SQL Developer accessing SYS packages with a different schema,"Connections > MyConnection > Other Users > SYS > Packages
"
6284,53622,LEFT JOIN help MySQL,"select table_two.tid, 
       table_one.id, 
       table_one.email 
 from  table_two 
       left join table_one on table_one.id = table_two.tid
"
9473,5910,Why does Oracle round up a number with less than 38 significant digits?,"dev> create table dctest (x number);

Table created.

dev> insert into dctest VALUES (0.98692326671601283);

1 row created.

dev> select * from dctest;

         X
----------
.986923267

dev> column x format 0.000000000000000000000000000
dev> /

                             X
------------------------------
 0.986923266716012830000000000
"
27484,14167,how to get distinct result in sql?,"Select id, name, max(created_on) as created_on from table group by id
"
27729,17194,how do I aggregate one column for 2 tests into two columns on one row,"select      codename
            , codedesc
            , sum(case when passfail = 1 then 1 else 0 end) as pass_values
            , sum(case when passfail = 0 then 1 else 0 end) as fail_values
from        passfailmaster
group by    codename
            , codedesc
"
2,57737,SQL MAX() funct,"SELECT top (1) with ties Name, Salary
FROM Workers
ORDER BY Salary DESC
"
8220,34641,Define Variable type dynamically in stored procedures in DB2,"DECLARE myVar ANCHOR DATA TYPE TO mytable.mycolumn;
"
30161,32719,"Searching text, returning multiple word matches","SELECT id, 'word1' FROM message_table WHERE Filter IS NOT NULL AND message like '%word1%'
  UNION
SELECT id, 'word2' FROM message_table WHERE Filter IS NOT NULL AND message like '%word2%'
  UNION
SELECT id, 'word3' FROM message_table WHERE Filter IS NOT NULL AND message like '%word3%';
"
28110,38380,How can I compare tuples using MySQL?,"select
    i.Name_1, i.Name_2
from
    association a
inner join
    identical_with i
    on i.Name_1 = a.Name
inner join
    association a2
    on i.Name_2 = a2.Name
where
    a2.Fachname <> a1.Fachname 
"
35199,66003,Using SQL SMS How do I return a list of numbers using low and high columns,"SELECT id,low,high,number as Num_List
FROM SUB_Inst , NUMBERS
where low<=number and high>=number 
"
33734,53707,code works on emulator but not on Phone,"DatabaseHelper dbh = new DatabaseHelper(context);
        dbh.getWritableDatabase().delete(table, whereClause, whereArgs);
"
11893,33257,SQL Server : insert customer id into unrelated table,";WITH Cust AS
(
 SELECT row_number() over(order by (select 1)) rn,* FROM Customer
),Resp AS
(
  SELECT row_number() over(order by (select 1)) rn,* FROM #Responses
)
SELECT C.id,c.CustomerID,C.ResponseId 
FROM Cust C 
JOIN Resp R 
ON C.rn = R.rn
"
34426,27909,Merge statement help in oracle,"MERGE INTO table_A a
   USING table_b b
      ON(a.b = b.m)
   WHEN MATCHED THEN 
      UPDATE SET a.c = 1
   WHEN NOT MATCHED THEN 
      INSERT (a, b, c)
      VALUES ('P', b.m, 1)
"
19442,69159,Querying data from SQL table basing on other rows values,"SELECT 
    * 
FROM
(
    SELECT p.id AS p_id FROM photo p
    JOIN tag t ON t.photo_id = p.id
    JOIN tag_name tn ON tn.id = t.name_id
    WHERE tn.name = 'Date'
) AS ti
JOIN tag t1 ON t1.photo_id = p_id
JOIN tag_name tn1 ON tn1.id = t1.name_id
WHERE tn1.name = 'Time'
"
35039,55091,How can I add a row between two rows in SQL Server Management Studio?,"SELECT column1,column12,column3 FROM dbo.MyTableName ORDER BY column1
"
23550,31648,is there any `backspace` character in mssql for string?,"select Name+isnull(','+Address1,'')+isnull(','+Address2,'') as compDeatils 
from tableCompany where ID = 4
"
33394,5383,SQL Join for retrieving record for a single user,"SELECT 
    cur_doctor_names.First_Name, 
    cur_doctor_Names.Last_Name, 
    w.Website 
FROM 
    cur_doctor_names 
        LEFT JOIN cur_website AS w 
        ON cur_doctor_names.UserId = w.Userid 
WHERE     
    cur_doctor_names.UserId = 69
"
14761,40003,Performance with NOT EXISTS - t-sql query,"select LogDate,UserId from (
    select
       LogDate, 
       UserId
       row_number() over (partition by UserId order by LogDate) as rown
    from
        UserLoginHistory ul
)
where rown = 1
"
28225,26457,SQL - Need to duplicate rows but with a unique primary key,"-- Retrieve maximum value of CustomerId
DECLARE @maxid int = 0
SELECT @maxid = MAX(CustomerId) FROM Company.Customer

-- When inserting data for column CustomerId add maximum id value and row number
-- This should ensure that the key values do not clash
INSERT INTO Company.Customer (CustomerId, FirstName, LastName)
SELECT ROW_NUMBER() OVER (ORDER BY CustomerId ASC) + @maxid, FirstName, LastName 
FROM Company.Customer    
WHERE LastName LIKE '%JONES%';
"
12288,65450,How to Group Data of a My SQL Table on the Basis of Four Columns,"select date, invoice_no, permit_no,
       sum(case when item_name in ('A', 'B') then quantity else 0 end) as A_B,
       sum(case when item_name in ('C') then quantity else 0 end) as C
from inventory_store
group by date, invoice_no, permit_no
order by date, invoice_no, permit_no;
"
34139,17303,Select count of two columns while grouped by,"select player, max(count_winner), max(count_loser) 
from (

  SELECT winner as player, count(winner) as count_winner, null as count_loser 
  FROM multiplayergamestbl 
  GROUP BY winner

  union all

  SELECT loser as player, null as count_winner, count(loser) as count_loser
  FROM multiplayergamestbl 
  GROUP BY loser

  ) t
group by player;
"
26909,28758,"Add milliseconds to date in SQL, not seconds","SELECT ADD_SECONDS (TO_TIMESTAMP('2014-04-10 09:11:45'), 0.1) FROM DUMMY  
"
2953,22571,Output parameter with Openquery,"Insert  Into OpenQuery([Servername],'Select colToPopulate From [Server].[Schema].[Table];')
Select  'ValToAdd'

Select  *
From    OpenQuery([Servername],'Select Ident_Current(''[Server].[Schema].[Table]'')')
"
18594,53559,I want to return only and integer from an Android Database,"SQLiteDatabase db;
// initialize the db
SQLiteStatement statement = null;
try {
    db.compileStatement(""select max(_id) from table"");
    int max = statement.simpleQueryForLong();
} catch (SQLException e) {
    // handle
} finally {
    if (statement != null) {
        statement.close();
    }
}
"
36164,25627,How to check whether an element is present in the database table or not?,"SELECT DISTINCT 1 FROM product_meta WHERE categorie_heading=""material"";
"
13480,63219,Partition setup in oracle,"select * from USER_PART_TABLES;
select * from USER_PART_KEY_COLUMNS;
"
932,41156,How to count items in comma separated list MySQL,"LENGTH(fooCommaDelimColumn) - LENGTH(REPLACE(fooCommaDelimColumn, ',', ''))
"
26090,21115,Mysql replace function returns null,"...,COALESCE(c.client_name, ''),
"
21446,56719,Problem with Oracle/SQL ORDER BY Statement,"SELECT col
  FROM table
 ORDER BY 
(regexp_substr(col, '[^.]+', 1, 1) * 256  * 256  * 256 ) + (regexp_substr(col, '[^.]+', 1, 2) * 256 * 256) + (regexp_substr(col, '[^.]+', 1, 3) * 256 )+ regexp_substr(col, '[^.]+', 1, 4)
"
3037,15039,"MySQL, Select field depending on multiple other rows in table","select conversation_id
from your_table
where user_id in (2, 28)
group by conversation_id
having count(distinct user_id) = 2
"
31696,58209,Order BY one table in MySQL,"SELECT   p.* 
FROM     People p
JOIN     Companies c ON c.ID = p.CompaniyID
WHERE    --(Some where clause) 
ORDER BY c.Name ASC
"
1217,50325,sql server update field if condition is met,"UPDATE dbo.Documentos SET IDEstadoDocumento = 3 WHERE Anulado = 1
"
16477,50652,Inline SQL function which sometimes must update database,"CREATE PROCEDURE LookupOrCreateProduct 
   @BarCode    VARCHAR(100),
   @ProductID  BIGINT OUTPUT
AS
BEGIN
   SET NOCOUNT ON;


       SELECT TOP 1 @ProductID = ProductID
       FROM dbo.Products 
       WHERE BarCode = @BarCode

   IF(@ProductID IS NULL)
    BEGIN
      INSERT INTO dbo.Products(Barcode)
      VALUES (@BarCode)

      SET @ProductID = SCOPE_IDENTITY();
    END   

END
"
34143,9181,Time difference between two times in the same table,"SELECT  date AS current_date, next_date - date AS difference
FROM    mytable mo
CROSS APPLY
        (
        SELECT  TOP 1 date AS next_date
        FROM    mytable mi
        WHERE   mi.date > mo.date
        ORDER BY
                date
        ) q
"
29908,39624,update MYsql with YYmmdd format,"update table_name set Birthday=STR_TO_DATE('19470330', '%Y%m%d') where ID=1;
"
29693,17511,MYSQL Sub Query with two columns,"SELECT u.*
FROM
    userprofile u
    JOIN connect c ON (u.user_id = c.user_id OR u.user_id = c.connect_to_id)
WHERE
    (c.user_id = '1' OR c.connect_to_id = '1') AND
    c.is_connected = '1'
"
3342,15950,How to execute mathematical expression stored in a varchar variable,"declare @expression nvarchar(max)
set @expression = '2*3*100'

declare @sql nvarchar(max)
set @sql = 'select @result = ' + @expression

declare @result int
exec sp_executesql @sql, N'@result int output', @result = @result out

select @result
"
11581,71479,How to INSERT INTO table from SELECT without specifying columns?,"select 
 t.* 
into #beep
from ThisOrThatTable as t"
29989,67384,SQLite join command 4 tables,"SELECT Restaurant.Name, Food.Name, Food.Type
FROM Restaurant
  JOIN Menu ON Restaurant.menuID = Menu.MenuID
  JOIN Food ON Menu.MenuID = Food.MenuID
  JOIN Food_Incl_ingredient ON Food.FoodID = Food_Incl_ingredient.FoodIncIngredientID
  JOIN Ingredient ON Food_Incl_ingredient.FoodIncIngredientID = Ingredient.Ingredient.ID
WHERE Ingredient.Name != 'meat'
"
30365,47304,how to remove only comma in the sentence have full of commas,"DECLARE @str VARcHAR(100) = 'Attachements,A,B,C,D'

SELECT STUFF(@str, CHARINDEX(',', @str), 1, ':')
"
36583,32990,How to get the recors with count zero if there are no records,"SELECT VM.vacation_id,
       VM.vacation_desc,
       isnull(sum(VR.total_hours_applied),0) AS totalCount
FROM EMPTYPE_VACATIONCONFIG VC
LEFT JOIN HR_Vacation_Master VM ON VC.VACATIONID=VM.vacation_id
LEFT JOIN HR_Employee_Vacation_Request VR 
    ON VR.vacation_id=VM.vacation_id AND VR.employee_id=156
WHERE VC.BRANCHID=20
GROUP BY VM.vacation_desc,
         VM.vacation_id
"
9324,2593,How To Slow Down A SQL Query?,"SELECT T1.*
FROM SomeTable T1,  
     SomeTable T2,  
     SomeTable T3,  
     SomeTable T4
"
11643,30565,SQL Server : Rollback without BEGIN TRANSACTION,"SET IMPLICIT_TRANSACTIONS ON

INSERT INTO my_table (item_type, start_date_time)
VALUES ('TEST', CURRENT_TIMESTAMP)

ROLLBACK

-- Shouldn't return the 'TEST' value inserted above.
SELECT * FROM my_table ORDER BY start_date_time DESC 
"
6046,16854,tsql: alternative to select subquery in join,"Select *
FROM Table1 a
INNER JOIN 
   (
    SELECT pID, Max(Date) FROM Table2
    GROUP BY pID
   ) b
ON a.pID = b.pID
"
34774,62489,Join two tables to get common data based on a column,"select Table1.colA,Table1.colB,Table1.colC from Table1 
WHERE EXISTS (SELECT 1 FROM Table2 WHERE Table1.colC = Table2.colZ)
"
20595,47145,TSQL - Count specific values within Multistatement table UDF and pass them to additional column,"INSERT    @Players (Number, Name, Goals, FuzzyLevel)
SELECT   Number, Name, Goals,

    dbo.MembershipLevel(Goals)

FROM     FuzzyFootballTeam ft
WHERE    Goals > 2 
ORDER BY Number
"
29286,71997,Please explain the syntax the SQLServer uses to create a check constraint,"ALTER TABLE [dbo].[tblEventTurnJudgeStartValues] WITH CHECK CHECK CONSTRAINT [tblEventTurnJudgeStartValues_ExecutionToggle]
"
4975,26918,MySQL Merge multiple colums into one 'temporary' column,"SELECT Domains.*, CONCAT('{',GROUP_CONCAT(languagetodomain_lang),'}') AS TemporaryColumn
FROM Domains
JOIN LanguageToDomain ON LanguageToDomain.languagetodomain_domain = Domains.domain_id
GROUP BY domain_id
"
29004,35268,Conditional value replacement in SQL Server,"SELECT CASE YourCol
         WHEN 0 THEN 'Hello'
         WHEN 1 THEN 'Bye'
       END AS SomeAlias
FROM   YourTable  
"
13850,2945,"How to select distinct rows from table without using functions(min,max etc)?","select t.*
from (select t.*,
             row_number() over (partition by <columns that should be different>
                                order by NULL) as seqnum
      from t
     ) t
where seqnum = 1;
"
15038,21678,Rails - Big vs Distributed Tables,"user = User.first

puts user.profile.first_name
puts user.profile.age
"
7699,27923,How can I import a mysql dump?,"mysql -uroot -p database_name < backup.sql
"
35395,27203,SQL : select distinct of one column while ignoring other columns,"select id, min(keyid) from tbl group by id
"
11579,16038,How do I solve this SQL Query?,"select *
from CUSTOMER c
where not exists (
        select BRANCH-NAME
        from BRANCH
        where BRANCH-CITY = 'Noida'
        minus
        select BRANCH-NAME
        from ACCOUNT 
            join DEPOSITOR d using (ACCOUNT-NUMBER)
        where d.CUSTOMER-NAME = c.CUSTOMER-NAME
    )
"
27764,6702,SQL: delete all the data from all available tables,"select 'truncate table ' || table_name || ';' from user_tables
"
26977,8395,Get Unique data from table,"SELECT EMPNAME,
       DEPTID,
       MIN(EMPID) AS EMPID
       FROM  dbo.Sample
 GROUP BY EMPNAME, DEPTID
"
23405,67794,"How do I create a ""filter by price"" type of query?","select  sum(case when Price >= 50 and Price < 100 then 1 else 0 end) as 50to100,
        sum(case when Price >= 100 and Price < 500 then 1 else 0 end) as 100to500,
        sum(case when Price >= 500 and Price < 1000 then 1 else 0 end) as 500to1000
from    Products
"
5200,8273,Make result display SQL commands with table data: 'select with 'insert into table_name select value1 value2' ',"INSERT INTO table1 
output inserted.data1, inserted.data2, inserted.data3
SELECT DATA1, DATA2. DATA3 From Table2 WHERE Table2.ID=1
"
19104,29163,Help with SQL join combined with lots of subqueries,"SELECT s.*, es.*
  FROM students s
JOIN sections_students ss on s.id          = ss.student_id
JOIN sections_exams    se on se.section_id = ss.section_id
JOIN exam_schedules    es on es.exam_id    = se.exam_id and date = DATE('$date')
JOIN exams             e  on e.id          = es.exam_id and isAutoSignup = 1
"
31953,73507,Simple SQL Select Query between 2 tables,"SELECT u.userID, u.userName, COUNT(*) AS ratingCount
    FROM userTable u
        INNER JOIN ratingTable r
            ON u.userID = r.userID
                AND r.ratingValue = 5
    GROUP BY u.userID, u.userName
    ORDER BY ratingCount
"
9780,53613,query for balance due and due date for entity,"SELECT r.id, 
       CONCAT(g.fname, ' ', g.lname) guest_name, 
       r.arrival date_due,
       r.total_price - COALESCE(p.payment_amt, 0) balance_due
  FROM reservations r JOIN guests g
    ON r.guest = g.id LEFT JOIN
(
  SELECT reservation, SUM(payment_amt) payment_amt
    FROM payments
   GROUP BY reservation
) p
    ON r.id = p.reservation
HAVING balance_due > 0
"
12997,66451,What is the proper syntax for stored procedures in SQLPlus?,"CREATE PROCEDURE addtuple1(i IN NUMBER) AS
BEGIN
    INSERT INTO T2 VALUES(i, 'xxx');
END addtuple1;
"
2329,28801,Extra columns in sql select query or view,"SELECT l.Naam, l.Adres, l.Email, 
(SELECT Bedrag FROM Tarief WHERE Soort = 'contributie' LIMIT 1) AS 'Contributie',
(SELECT Bedrag FROM Tarief WHERE Soort = 'liggeld' LIMIT 1)*IFNULL(s.length,0) AS 'Liggeld',
(SELECT Bedrag FROM Tarief WHERE Soort = 'contributie' LIMIT 1)+
(SELECT Bedrag FROM Tarief WHERE Soort = 'liggeld' LIMIT 1)*IFNULL(s.length,0)  AS 'Totaal'
FROM Lid l
LEFT JOIN Schip s ON l.Schip=s.Naam
WHERE l.ContributieBetaald <> 'ja';
"
33527,67579,Android: How to embed one viewflipper as a child into another Viewflipper,"ViewGroup parent = (ViewGroup)(viewflipper.findViewById(R.id.dyna_view));

MjpegView mv = (MjpegView)inflater.inflate(R.layout.CustomViewSample, parent);
mv.setVisibility(MjpegView.VISIBLE); //may use or not
parent.addView(mv);
"
4018,5813,Show most repeated columns first in sql server,"WITH temp AS (
  SELECT col1, count(col2) nb_occurences
  FROM tab
  GROUP BY
    col1)


SELECT
  tab.col1, tab.col2, nb_occurences
FROM tab
INNER JOIN
  temp
    ON temp.col1 = tab.col1
ORDER BY nb_occurences DESC
"
35448,10942,Get best offers from the database query,"SELECT p.id, p.descricao, p_s.preco as antigo, pr.preco as novo
FROM produtos_supermercados p_s JOIN
     produtos p
     ON(p_s.id_produto = p.id) JOIN
     promocoes pr
     ON(pr.id_produto = p.id)
ORDER BY pr.preco / p_s.preco desc;
"
35903,31243,Microsoft Access DB - Where field not equal,"SELECT Users.FirstName, Users.LastName, Users.UserEmail 
FROM Users 
WHERE
(
   Users.FirstName LIKE '%1%' OR 
      Users.LastName  LIKE '%1%' OR 
      Users.UserEmail LIKE '%a%'
)
 AND 
      Users.UserEmail <> 'a@a.a';
"
214,30662,select all rows that have more than two matching composite keys in a table,"SELECT t1.pk1
FROM t1
WHERE pk2 IN (1, 2)
GROUP by t1.pk1
HAVING COUNT(*) = 2;
"
13844,1414,Now date time minus a date time column in a table,"DATEDIFF(hour, Time_In, GETDATE())
"
557,51852,Count of group for null is always 0 (zero),"Select Group, Count(*) 
From [Data] 
Group by [Group]
"
12963,55723,SQL: Add counters in select,"SELECT Name, ROW_NUMBER() OVER(Partition BY Name ORDER BY Name) as [Rank]
FROM MyTable
"
2752,59329,How to get the row with max timestamp in postgres?,"SELECT usr, event_dt FROM mytable ORDER BY event_dt DESC LIMIT 1
"
38104,16063,SQL: Delete records based on values in another column,"delete from example
    where not exists (select 1
                      from example e2
                      where e2.vendor = example.vendor and
                            e2.migrate = 'Y'
                     );
"
9680,73387,How to select values around .(dot) using sql,"SELECT REGEXP_SUBSTR(requesttext, '(?<= )(\w+\.\w+)(?=[,$]?)', 1, 1) 
FROM dbc.tables
WHERE tablename='old_employee_table'
"
18151,63032,MySQL function which takes a set of strings?,"SELECT * FROM myTbl WHERE name IN ('bob', 'jane', 'sally')
"
31644,22952,Monitor SQL Server for new row,"var query = (from r in ctx.table select r).AsCached(
 ""table"", new CachedQueryOptions() {
    OnInvalidated = (sender, args) {
      // the query was invalidated, a new row was added!
      // refresh display or notify user
    }
 });
DisplayRows(query);
"
18204,55531,PostgreSQL How to add WHERE where is count() and GROUP,"SELECT count(*), date_trunc('year', ""createdAt"") AS txn_year 
FROM tables
WHERE active = '1'
GROUP BY txn_year;
"
14995,4611,Show a colum of the last row of table?,"SELECT TOP 1 id FROM $table ORDER BY id DESC LIMIT 1
"
1859,30491,Get max timestamp of particular id,"SELECT taxi_id, driverloc_lat, driverloc_long, driverloc_time
FROM  driverloc 
WHERE taxi_id = 3
ORDER BY driverloc_time desc
LIMIT 1;
"
37074,22595,SQL Query: Retrieve rows that have an entry for every unique value of a column,"select item, group_concat(price order by time) as prices
from tablename
group by item
having count(price) = (select count(distinct time) from tablename)
"
23452,7965,SQLite: Autoincrementing an Id to increase by 2,"INSERT INTO MyTable(ID, Name, Number)
VALUES((SELECT MAX(ID) + 2 FROM MyTable),
       'me', 42);
"
30972,71278,How to include a row number but show a tie?,"  SELECT *,   
      RANK() OVER (ORDER BY value)   
  FROM TEMP
"
31936,56287,SQL Server Generate Script to Alter Data Type,"ALTER TABLE table_name ALTER COLUMN column_name new_datatype nullability
"
21454,12266,"In Perl, how do I properly quote string fragments I am using to build an SQL query?","my $sql_str = join ',' => map { $_ = qq|'$_'|; } @tab;
"
24081,11097,Select results from the middle of a sorted list?,"SELECT * 
FROM table
ORDER BY somecolumn
LIMIT 10,40 
"
8023,15893,Sql return last order details for each customer,"select *
from (
  select o.*, 
         row_number() over (partition by o.ClientID order by o.OrderDateTime desc) as rn
  from t_orders o
) t
where rn = 1
order by ClientId;
"
23825,25990,If row exist in a table then use another tables value in SQL,"select SUM(coalesce(dp.price, d.price)), o.* 
from orders o JOIN deals d ON d.ID = o.deal_id
              LEFT JOIN order_products op on op.order_id = o.id
              LEFT JOIN deal_products dp on op.product_id = dp.product_id
where o.user_id = 2002 and o.cancelled = 1
group by ...;
"
36046,19076,Select where field in values (if field in value not exist return as null),"SELECT n.id
     , IF(a.id IS NULL,'Never',a.date) AS `date`
  FROM ( SELECT 1 AS id
         UNION ALL SELECT 2
         UNION ALL SELECT 3
         UNION ALL SELECT 4
       ) n
  LEFT
  JOIN another_table a
    ON a.id = n.id
 ORDER BY n.id
"
30258,73742,Removing milliseconds in timestamp oracle,"select to_char(current_timestamp, 'DD-MM-YY HH24:MI:SS')
  from dual;
"
28590,17984,Query showing exchange rates by date,"SELECT
   F.FOREDATE,
   F.FOREKEY,
   F.FORERATE
FROM FORERATE F
WHERE F.FOREDATE = (SELECT MAX(FOREDATE) 
                    FROM FORERATE FMD 
                    WHERE F.FOREKEY=FMD.FOREKEY)
"
36921,47069,joomla database methods,"$db    = JFactory::getDbo();
$query = $db->getQuery(true);
$query->select('...')->where('...');

$query->bind(':s', $like);

$db->setQuery($query);

$records = $db->loadObjectList();
"
19353,57808,"GROUP BY only primary key, but select other values","SELECT myPrimaryKey, MAX(otherThing)
FROM myTable
GROUP BY myPrimaryKey
"
25673,53417,Oracle Convert Seconds to Hours:Minutes:Seconds,"SELECT 
    TO_CHAR(TRUNC(x/3600),'FM9900') || ':' ||
    TO_CHAR(TRUNC(MOD(x,3600)/60),'FM00') || ':' ||
    TO_CHAR(MOD(x,60),'FM00')
FROM DUAL
"
36979,16699,Postgres text search on multiple rows,"hstore @> hstore
"
3550,31698,Query multiple dates NOT greater than the current date,"SELECT e.id,
       e.picture,
       e.name,
       e.venue,
       e.city
  FROM EVENTS e
 WHERE NOT EXISTS(SELECT NULL
                    FROM EVENT_DATES ed
                   WHERE ed.event_id = e.id
                     AND ed.start_date >= CURRENT_DATE())
"
39036,4811,How to search data from oracle database which contains single quote,"select * from my_table
where name like '%''%'
or address1 like '%''%'
or address2 like '%''%';
"
10658,52493,Designing a database of Sets,"SELECT * FROM ELEMENT WHERE SET_ID = <whatever>
"
11693,48116,Find efficient way of joining tables," SELECT title.*, film.*,songs.* 
 FROM title t JOIN film f
    ON t.title_name = f.title_name
 JOIN songs s
    ON t.title_name = s.title_name
"
25744,47068,CakePHP iterate through all rows in the DB and update?,"$this->Model->updateAll(array('sum' => 'column1 + column2 + column3'));
"
17218,36924,Get list of records from mysql database having following conditions:," select * from target join employee on target.target_employee_id = employee.employee_id
     join location on target.target_location_name = location.location_name
     where target_exec_end_time between <start_date> and <end_date>
        and target_exec_end_time = (select max(target_exec_end_time) from location loc2
        where loc2.location_name = target.location_name)
     group by target.location_name;
"
39738,26379,How to get greatest time when there is an aggregate function?,"SELECT type, SUM(score), max(unix_time)
FROM mytable
GROUP BY type
"
9721,11581,MySql looping inside a stored procedure,"UPDATE Table t1
JOIN Table t2
ON FIND_IN_SET(t1.id, t2.vals)
SET t1.total = t1.total  + 1
WHERE t2.id = 4
"
24112,2302,Do UPDATE in SQL using a JOIN,"UPDATE Table1 
SET Table1.SomeValue = T2.SomeValue
FROM Table2 AS T2 
WHERE Table1.ID = T2.ID
"
23937,64996,SQLPlus settings to generate tab-separated data file,"select chr(9) from dual;
"
25071,75337,SQL GROUPING on 2 fields to get the min value,";with cte as
(
  select id, type_id, value, sort_order,
    rn = row_number() over(partition by id order by type_id, sort_order)
  from yourtable
)
select id, type_id, value, sort_order
from cte
where rn = 1
"
26541,13861,MySQL Re-use Subquery,"select t.*,
       (@v := if(@y = y, @v,
                 if(@y := y, v, v)
                )
       )
from temp t cross join
     (select @y := 0, @v := -1) params
order by year, (m = 0) desc;
"
16807,43449,Group by a column without including in Select list,"INSERT INTO tbl (fld1, fld2, fld3, fld4)
SELECT fld1, fld2, fld3, fld4
GROUP BY fld1, fld2, fld3, fld4, fld5
"
19970,23202,Issue in making appear all database table field names,"Select Columns.Name
  From Sys.Columns
 Where Object_Name(Columns.Object_id) = 'forma'
 Order By Columns.Column_Id;
"
7938,65385,Oracle. Memory usage of object instances,"SELECT
    PROGRAM,
    SPID,
    ROUND(ALLOCATED / 1048576, 1) ALLOCATED,
    ROUND(USED / 1048576, 1) USED,
    ROUND(MAX_ALLOCATED / 1048576, 1) MAX_ALLOCATED
FROM
    V$PROCESS P,
    V$PROCESS_MEMORY PM
WHERE
    P.PID = PM.PID
    AND BACKGROUND IS NULL
    AND CATEGORY = 'PL/SQL'
    AND ADDR = (SELECT PADDR FROM V$SESSION WHERE SID = :SID)
"
14697,39394,SQL ORDER BY route information,"This works in oracle
select a.*
from route  a
start with a.rowid = (select min(rowid) from route )
connect by prior a.t = a.f; 
"
31391,2601,How can i select the distinct values from one col with their latest value from another,"SELECT name, mark
FROM table t1
WHERE date=(
  SELECT MAX(date)
  FROM table t2
  WHERE t2.name=t1.name
)
"
12498,40377,INSERT INTO multiple tables from SELECT statement,"insert into GoodsIn (CustomerAccount, CustomerName)
select CustomerAccount, CustomerName
from GoodsInOld 


insert into GoodsInProduct(ItemId, GoodsInId)
select o.ItemId, i.id
from GoodsInOld o
inner join GoodsIn i on o.CustomerAccount = i.CustomerAccount
                     and o.CustomerName = i.CustomerName
"
5380,22639,"SQL select query, multiple tables","SELECT * FROM Posts WHERE ID NOT IN ( SELECT post_assoc FROM Images )
"
18806,48997,"Oracle SQL help counting the same thing two different ways, but with common grouping","SELECT t1.closure_date, COUNT(t1.incident_id)
     , ( SELECT COUNT(t2.incident_id) FROM incident_table t2
          WHERE t2.status = 'open'
            AND t2.raised_date < t1.closure_date )
  FROM incident_table t1
 WHERE t1.closure_date IS NOT NULL
   AND t1.status = 'closed'
 GROUP BY t1.closure_date
"
29769,40189,combining 2 sas dataset,"proc sql;
  select t1.*,t2.*
  from t1 ,t2
  ;
quit;
"
19295,38779,Return first character SQL Derby,"select substr(table.column,1,1) 
from table
order by table.column
"
36924,27603,Force a query timeout in Oracle,"BEGIN
    dbms_lock.sleep(5);
END;
"
10399,61673,How can I add row of components to a GUI when a button has been pressed?,"tbl.addComponent(cmp1);
tbl.addComponent(cmp2);
tbl.animateLayout(300);
"
27947,41252,Oracle - SQL Join 3 columns,"SELECT
  EmpPerson.Name,
  SupPerson.Name,
  BossPerson.Name
FROM Task T
INNER JOIN Employee EmpEmp ON T.ID_Employee = EmpEmp.ID_Employee)
INNER JOIN Person EmpPerson ON EmpEmp.ID_Person = EmpPerson.ID_Person
INNER JOIN Employee SupEmp ON T.ID_Supervisor = SupEmp.ID_Employee
INNER JOIN Person SupPerson ON SupEmp.ID_Person = SupPerson.ID_Person
INNER JOIN Employee BossEmp ON T.ID_Supervisor_Boss = BossEmp.ID_Employee
INNER JOIN Person BossPerson ON BossEmp.ID_Person = BossPerson.ID_Person
"
26842,60035,"In SQL how can I have two fields that can't both be identical, only one is a primary key","create table ProductTasks
 ( ProductID ...
 , TaskId ...
 , TaskOrder ...
 , primary key (ProductId, TaskId)
 , unique (ProductId, TaskOrder)
 );
"
15956,50284,SQL: insert only new records,"INSERT INTO Table2
SELECT t1.*
FROM Table1 t1
WHERE NOT EXISTS 
(
      SELECT 1 
      FROM table2 t2 WHERE 
      t2.col1 = t1.col1 AND 
      t2.col2 = t1.col2
) 
"
36801,5373,"SQL INSERT INTO SELECT, combine varchar columns","SELECT LTRIM(RTRIM(ISNULL(firstName, '') + ' ' + ISNULL(lastName, ''))) FROM oldTable
"
36265,56530,How to write complex query with mysql join with tables,"SELECT tasks.id, tasks.name, 
    IF(EXISTS(SELECT id 
              FROM userTasks 
              WHERE userTasks.task_id = tasks.id 
              AND userTasks.user_id = @that_user_id)
       ,1,0) AS STATUS
FROM tasks
"
33918,51805,Inner Join: Mysql prints more lines than available (same multiple rows),"    select h.auto_inc,h.query_prot_id,h.taxon_schema, h.domain_name 
    from hmmscan1 as h 
    inner join arath_scan on h.domain_name=arath_scan.domain_name
    GROUP BY h.domain_name;
"
17209,37219,Get top ranked values across multiple fields,"SELECT DISTINCT
    FIRST_VALUE(age) OVER (ORDER BY count1 DESC) AS top1,
    FIRST_VALUE(sex) OVER (ORDER BY count2 DESC) AS top2
    FROM (
        SELECT age,
               sex,
               COUNT(age) OVER (PARTITION BY age) AS count1,
               COUNT(sex) OVER (PARTITION BY sex) AS count2
               FROM some_table
    ) some_table
"
37794,41457,R loop to query all tables within a database,"doCountQuery <- function(con, table) {
    query <- paste(""SELECT COUNT(message_id) FROM "", table, sep = """")
    t     <- dbGetQuery(con, query)

    return(t)
}

list <- dbListTables(con)
counts <- numeric(0)       # this will store the counts for all tables

for (i in 1:length(list)) {
    count <- doCountQuery(con, list[i])
    counts[i] <- count[[1]]
}
"
24205,49554,Access/SQL: Multiple conditions on same column,"SELECT 
   p1.nr_pickl,
   sum(IIF(LEFT(p1.platz_von, 2) = ""03"", 1, 0) as Gang_03,
   sum(IIF(LEFT(p1.platz_von, 2) = ""04"", 1, 0) as Gang_04,
   sum(IIF(LEFT(p1.platz_von, 2) = ""05"", 1, 0) as Gang_05
FROM
   Pickauf_0110 as p1
GROUP BY p1.nr_pickl
"
27422,72717,Custom Postgres function for term dates and times,"select *
from
    t
    left join
    holiday on date_trunc('day', t.ts) = holiday.day
where
    extract(dow from ts) in (0, 6) -- Weekend
    or
    (extract(hour from ts) >= 18 and extract(hour from ts) <= 8)
    or
    holiday.day is not null -- Holiday
"
11887,52482,SQL Server group by clause and display all coulmns,"SELECT 
    t1.ID
    ,t1.NAME
    ,t1.Grade
    ,t1.Marks
FROM t1
INNER JOIN (
    SELECT Grade
        ,max(Marks) AS highest_marks
    FROM t1
    GROUP BY Grade
    ) AS TEMP ON t1.Marks = TEMP.highest_marks
    AND t1.Grade = TEMP.Grade
"
30709,69978,trying to test that a field <> value with null values in mysql,"WHERE field <> 'deactivated' OR field IS NULL
"
28451,43920,Optimize query to count total from two different column and different rows of one table,"SELECT  currency, SUM(price) totalPrice
FROM    tableName
GROUP   BY currency
"
37925,19923,SQLite NOT IN query is slow,"select k.id
from keytemp as k left outer join keys as kk on (k.hash=kk.hash and kk.sourceid=10)
where kk.hash is null;
"
4797,62901,Return only first row with particular value in a column,"select id, qid
  from
(
  select id, qID, ROW_NUMBER() over(partition by qID order by qID) as zxy
    from t1 
) q  
 where zxy = 1
"
33117,30229,MAX Column Value for Distinct Value on Different column SQL Server 2008 R2,"SELECT  *
FROM (
    SELECT EPISODE_NO
        , ORD_NO
        , [DATE TIME COLUMN]
        , ROW_NUMBER() OVER(PARTITION BY EPISODE_NO ORDER BY ORD_NO) AS RowNum
    FROM    SMSMIR.SR_ORD
    WHERE   SVC_DESC = 'DISCHARGE TO'
    AND     EPISODE_NO < '20000000'
) src
WHERE src.RowNum = 1
"
3900,61780,How to merge two tables in a mysql query,"SELECT  *
FROM    `games` g
INNER JOIN
        `videos` v
ON      v.game = g.gameId
WHERE   g.gameId = 1
"
12059,4714,Returning TimeStamp multiple times in single T-SQL Statement,"SET NOCOUNT ON 
DECLARE @Var INTEGER = 1 
WHILE @Var = 1 
BEGIN 
  SELECT @Var = COUNT(*) 
  WHERE  dbo.GetMyDate() BETWEEN dbo.GetMyDate() AND dbo.GetMyDate()   

  SELECT @Var 
END
"
24047,3230,Inserting values into a third table by CROSS JOINing two tables,"INSERT INTO Table_C (SELECT null, Table_A.item, Table_B.color, null FROM 
Table_A CROSS JOIN Table_B);
"
21138,9588,MySQL: Calculating Percentage of COUNT with GROUP BY,"SELECT 
    m.m_id AS ""Mailing Type"",
    COUNT(mr.u_id) AS ""Mailings Received"",
    COUNT(mr.u_id) / (SELECT COUNT(*) FROM mailing_received) AS ""PERC REC""
FROM mailing m 
Left join mailing_received mr
       ON mr.m_id = m.m_id
GROUP BY m.m_id
"
25574,41909,SQL query to return a grouped result as a single row,"SELECT created_at, count(status) AS total,
       sum(case when status = 'error' then 1 end) as errors,
       sum(case when status = 'complete' then 1 end) as completed,
       sum(case when status = 'on hold' then 1 end) as on_hold
FROM jobs 
GROUP BY created_at;
"
30324,56756,substr function for substract the column value basis of another column in oracle,"with sd as (select '01-CEDAPR' a, 'AB_52MM_01-CEDAPR' b from dual) -- assumed O1 in column b was a typo
select a,
       b,
       regexp_replace(b, '_'||a),
       substr(b, 1, instr(b, '_', -1) -1) 
from   sd;
"
35026,23006,count flagged rows on SQLite,"SELECT  Table1.ID as ID, SUM(case when (Table1.[flag])=True then 1 else 0 end) AS No
FROM Table1
GROUP BY ID;
"
11044,5412,Get distinct records with counts,"SELECT personid, COUNT(msg) 
FROM mytable 
GROUP BY personid
ORDER BY personid;
"
16129,55671,Auto Increment userdefined id,"DECLARE @ED TABLE (
  ID INTEGER PRIMARY KEY IDENTITY(1, 1)
  , UserID AS 'ED' + CAST(ID AS VARCHAR(32))
  , I INTEGER
)

DECLARE @I INTEGER
SET @I = 0
WHILE @I < 100
BEGIN
  SET @I = @I + 1
  INSERT INTO @ED VALUES (@I)
END

SELECT * FROM @ED
"
10727,23630,SQL calculation on number of tuples involving a composite primary key,"| a | b |
+---+---+
| 1 | 1 |
| 2 | 1 |
| 3 | 1 |
| 4 | 1 |
| 1 | 2 |
"
38953,30672,SQL get first matching results,"    select * from (
select id , substr(id,0,3),rank() over ( partition by substr(id,0,3) order by id) rank 
from mytable
WHERE ID LIKE 'R43%' OR ID LIKE 'D32%' OR ID LIKE 'F22%')
where rank = 1
"
19502,45534,Adding an Column Populated by an Arbitrary Value in SQL,"SELECT 234 AS CONSUMER_ID, ACTION_LOG_ID, COMMUNICATIONS_ID 
  FROM consumer_action_log 
 WHERE COMM_TYPE_ID=4 
"
36771,37019,Insert string with comma into varchar?,"Dim cmd as new sqlcommand(""INSERT INTO TableA (ColA) VALUES (@ColA)"", Conn)
cmd.parameters.add(""@ColA"",sqldbtype.nvarchar).value = ""X,Y""
cmd.executenonquery()
"
25723,30694,SQL query where Mydate should be less than 2 years from the current date,"MYDATECOLUMN < CURRENT DATE - 2 YEAR
"
29013,34157,Showing or hiding a button based on contents of a field in a database,"// Get the row with execute, returns a resultSet
var row = db.execute('SELECT * FROM genrules WHERE title=""'+client+'""');
// Make sure its a valid row
if (row.isValidRow()){ 
  // Now get the field from the current row
  if(row.fieldByName('arref1') != '0') {
       // Add your button here
  }
}
row.close(); // Close the result set since were done with it
"
7469,61905,Using timestampdiff in a Derby WHERE clause,"SELECT * FROM t WHERE {fn TIMESTAMPDIFF( SQL_TSI_DAY, CURRENT_DAY, promisedDate)} <= 1
"
28294,2843,SQL & Linq To SQL Help,"var a = from myObj in db.MyObjs
        group myObj by myObj.Date.ToString(""yyyy-mm"")
            into ymGroup
            select new { Date = ymGroup.Key, Start = ymGroup.Min(c => c.ID), End = ymGroup.Max(c => c.ID) };
"
22664,52226,SQL to return rows that which contain same data for one field but different data for others,"select TeacherName
from (
    select TeacherName, CourseN
    from Teacher
    group by TeacherName, CourseN
    ) t1
group by TeacherName
having count(*) >=2
"
17945,61477,Merge 2 sql queries,"SELECT 
    SUM(CASE WHEN field_id_207 != '' then 1 else 0 end) as total_1,
    COUNT(exp_channel_data.entry_id) AS total_2 
FROM exp_channel_data 
JOIN exp_channel_titles 
ON exp_channel_titles.entry_id = exp_channel_data.entry_id 
AND status = 'open' 
AND exp_channel_data.channel_id = '18' 
AND author_id = ""CURRENT_USER""
"
16518,32964,select from table where both id exist,"select * from customer_appdata c1
where appdata_id in (11,12)
and exists (
    select 1 from customer_appdata c2
    where c2.appdata_id in (11,12)
    and c2.appdata_id <> c1.appdata_id
    and c2.customer_id = c1.customer_id
)
"
24934,64733,Filter by value in last row of LEFT OUTER JOIN table,"SELECT c.client_id, c.client_name
  FROM clients c LEFT JOIN
(
  SELECT *, ROW_NUMBER() OVER (PARTITION BY client_id ORDER BY created_at DESC) rnum
    FROM orders
) o 
    ON c.client_id = o.client_id
   AND o.rnum = 1
 WHERE o.fulfill_by_date < CURRENT_DATE
    OR o.order_id IS NULL
"
7737,70976,How to merge results of two queries in OrientDB,"select expand($c) 
let $a = ( SELECT EXPAND(out('E1').out('E3')) FROM V1 WHERE id = <someIdThatV1Has>), 
$b = ( SELECT EXPAND(out('E1').out('E2').out('E3')) FROM V1 WHERE id = <someIdThatV1Has>),
$c = unionAll( $a, $b )
"
25455,62220,SQL Script for Counting Records based on specific criteria and returning the Counts,"select t.bed_type_description, COUNT(t.bed_type_description) as 'Total Number Of Beds' 
from import As I inner join Beds as b on i.bed_Id = b.bed_Id 
inner join Unit as u on i.unit_Id = u.unit_Id 
inner join Bed_Type as t on b.bed_type_Id = t.bed_type_Id 
where u.unit_Id = 'KA2MED'
group by t.bed_type_description 
"
16851,25034,Perfect Update query not working in VB.net with Access,"Update Login SET [Password] = '....' WHERE UserName = '....'
"
29429,26849,SQL Query to LINQ Lambda expression,"var members = new List<Member>
{
    new Member {MemberId = 1, MemberExternalPk = 100},
    new Member {MemberId = 2, MemberExternalPk = 200}
};

var accounts = new List<Account>
{
    new Account {AccountId = 1, MemberId = 1}
};

var query =
    from m in members
    join a in accounts on m.MemberId equals a.MemberId into ma
    from ma2 in ma.DefaultIfEmpty()
    where ma2 == null
    group ma2 by m.MemberExternalPk into grouped
    select  new {grouped.Key};
"
17196,37701,Calculating information by using values from previous line,";
with CTEtest AS
    (SELECT ROW_NUMBER() OVER (PARTITION BY memberid order by effective year, effective month desc) AS Sequence, *
    FROM txn_by_month)

,test
as (select * , balance - netamt as running_sum from CTEtest where sequence = 1

union all

select t.*, t1.running_sum - t.netamt from CTEtest t inner join test t1

on t.memberid = t1.memberid and t.sequence = t1.Sequence+1 where t.sequence > 1)

select * from test
order by memberid, Sequence
"
34323,58321,Select from where as,"SELECT Identifier,
        SUM(CASE WHEN TYPE = 'aa' THEN VALUE ELSE 0 END) AS typeAASum,
        SUM(CASE WHEN TYPE = 'bb' THEN VALUE ELSE 0 END) AS typeBBSum,
        SUM(CASE WHEN TYPE = 'cc' THEN VALUE ELSE 0 END) AS typeCCSum
FROM YourTable
GROUP BY Identifier
"
2981,64141,add single record on top of sql query,"select ID, Name
from 
(
  select null as ID, 'Select' as Name
  union all
  select ID, Name
  from prototype
) as T  
order by case when ID is null then 0 else 1 end, Name
"
36885,46241,Select Records With Only One Value In A Column Where Multiple Are Possible,"select *
from customer c
join ( select customer_id
       from customer
       group by customer_id
       having count(program_name) = 1
     ) t on t.customer_id = c.customer_id
where ... -- any further winnowing of the result set occurs here
"
11264,2528,How to make request with left join if binding field is null | MYSQL,"LEFT JOIN category AS cat
       ON cat.id = t.category_id
          OR (cat.id IS NULL AND t.category_id IS NULL)
"
2617,33251,CakePHP user session not updating but database yes,"[User] => array(
    [field] => value,
    [field2] => value2,
    ...
)
"
31682,68246,"Return all for where IN (1,2,3,3,3,1) clause with duplicates in the IN condition","SELECT t.*
FROM Table_1 t
JOIN ( -- This is your ""IN"" list
          SELECT 1 AS ID
UNION ALL SELECT 2 AS ID
UNION ALL SELECT 3 AS ID
UNION ALL SELECT 3 AS ID
UNION ALL SELECT 3 AS ID
UNION ALL SELECT 1 AS ID
) x ON x.ID = t.ID
"
6671,1094,"Getting around not being able to nest aggregators, sql server","select top(1) with ties InstructorNo, COUNT(InstCourses.CourseNo) as NoTeachableCourses
from
...
group by InstructorNo
order by NoTeachableCourses desc;
"
11384,54725,select most recent from non-normalized data in mysql,"SELECT
  yourTable.*
FROM 
  yourTable
INNER JOIN
(
  SELECT
    callername,
    MAX(callerdate) AS callerdate
  FROM
    yourTable
  GROUP BY
    calledname
)
  AS mostRecent
    ON  mostRecent.callername = yourTable.callername
    AND mostRecent.callerdate = yourTable.callerdate
WHERE
  yourTable.status='NotAnswered'
"
21656,69510,SQL: selective subqueries,"SELECT  P.name, 
        CASE WHEN wantssport = 1 THEN (select count(*) from cars C where C.type = 'sports') ELSE NULL END AS sportscars,
        CASE WHEN wantsfamily = 1 THEN (select count(*) from cars C where C.type = 'family') ELSE NULL END AS familycars,
        CASE WHEN wantsbusiness = 1 THEN (select count(*) from cars C where C.type = 'business') ELSE NULL END AS businesscars
FROM    people P
WHERE   P.id = 1
"
26664,19456,SQL Server stored procedure to insert in multiple tables,"create procedure NameOfYourProcedureHere
as
begin

    insert into custlogin(custusename, custpassword) 
        values ('','') -- put values here (from parameters?)

    insert into custinfo(custid, custfirstname, custlastname, custaddress)
        values (SCOPE_IDENTITY(), '', '', '')  -- put other values here (from parameters?)

end
"
2573,19772,Enforcing unique and multiple NULLS for a column in a table,"CREATE UNIQUE NONCLUSTERED INDEX idx_yourcolumn_notnull
ON YourTable(yourcolumn)
WHERE yourcolumn IS NOT NULL;
"
7241,61028,Query to get all CREATE statements of MySql Tables,"mysqldump -h localhost -u root -p --no-data --compact  some_db


mysqldump -d --compact --compatible=mysql323 ${dbname}|egrep -v ""(^SET|^/\*\!)""
"
7522,66488,"MySQL Query, Join, and Myself, or how I always take the hard way through","SELECT Posts.id, Comments.id FROM Posts
LEFT OUTER JOIN Comments on (Posts.id = Comments.refId)
WHERE Comments.create IS NULL OR (
      Comments.create = (SELECT create FROM Comments
                         WHERE refID = Posts.id
                         ORDER BY create DESC
                         LIMIT 1)
) /* add ORDER BY &c to taste;-) */
"
37031,18707,Updating unique instance of a group of rows,"UPDATE tblHashtags SET ""instudy"" = 1 WHERE UID IN (
    SELECT UID FROM tblHashtags GROUP BY ""text.original"" ORDER BY min(UID)
);
"
24481,60158,How do I write an sql statement with both update and with keywords?,"WITH cte AS (SELECT field FROM tbl)
UPDATE t1 
SET t1.field = t2.field
FROM cte t1
INNER JOIN othertable t2 ON t1.field = t2.otherfield
"
31579,67777,"Dangling ""else"" Resolution in T-SQL","DECLARE @testvar INT;
DECLARE @testvar2 INT;
SET @testvar = 1;
SET @testvar2 = 1;

IF @testvar = 1
    IF @testvar2 = 1
        SELECT 'Got to 1';
    ELSE 
        SELECT 'Got to 2';
"
34996,56793,Why oracle is saying missing right parenthesis,"SELECT to_number('12.5678', '99D9999', 'NLS_NUMERIC_CHARACTERS ='', ''')
FROM dual;
"
30956,70488,What kinds of data queries are too hard to do on CouchDB (as opposed to SQL)? Seeking concrete examples,"SELECT * FROM the_table 
WHERE {filter_col} = {filter_value} [ AND ... ]
ORDER BY {order_col}
LIMIT {n} OFFSET {m}
"
9119,27854,Pass a Crystal Report Command parameter to an Oracle function,"SELECT F_SMART_DATE('{?AS_OF}') SMART_DATE FROM DUAL;
"
32156,12688,"Remove values that net each other out to zero, leaving only one positive 2472320 in this case","--If the number part is always 6 digits
Select left(yourColumn,6) Col1, right(yourColumn,2) Col2
From yourTable

--For any number of front digits (bit more generic)
Select left(yourCol, charIndex('B',yourCol)-1) Col1, 
       right(yourCol, len(yourCol) - charIndex('B',yourCol)+ 1) Col2
From yourTable
"
25470,75396,How to change the db name dynamically using one db  storedprocedures to another db storedprocedures?,"-- assume @dbname has the name of the database where getdetails was created
declare @sql nvarchar(4000), @params nvarchar(4000), @dbname sysname
set @dbname = 'test'
set @sql = @dbname + '..getdetails'
set @params = ''
exec sp_executesql @sql, @params
"
16433,4126,mysql binary comparison doesnt use index,"ALTER TABLE YourTable MODIFY
   YourColumn VARCHAR(4)
   CHARACTER SET latin1
   COLLATE latin1_bin;
"
37273,45724,SQL join different tables depending on row information,"(
SELECT MyField1, MyField2 FROM A
INNER JOIN B ON A.Id = B.Id
AND A.MyField = 1
)
UNION
(
SELECT MyField1, MyField2 FROM A
INNER JOIN C ON A.Id = C.Id
AND A.MyField = 2
)
"
20246,37330,finding children of excluding in a parent-child relationship,"SELECT 
    *
FROM
    x AS t1
WHERE
    t1.type = 'a'
        AND 0 = (SELECT 
            COUNT(*)
        FROM
            x AS t2
        WHERE
            t2.id_parent = t1.id AND t2.type = 'b')
"
21274,64105,How do I build this complex sql?,"SELECT  a.*,
        b.Image as ID1IMAGE, -- alias is needed to avoid ambiguous columns
        c.Image as ID2Image
FROM    T2 a
        INNER JOIN T1 b
            ON a.ID1 = b.ID
        INNER JOIN T1 c
            ON a.ID2 = c.ID
WHERE   2 IN (a.ID1, a.ID2)   -- the condition can be done like this.
"
10193,60014,Is an iOS In-App Purchase transaction ID always a long integer?,"@property(nonatomic, readonly) NSString *transactionIdentifier
"
36268,6873,SQL Riddle on relations,"CREATE TABLE a (
    id int,
    other_id int REFERENCES b(id)
);
CREATE TABLE b (
    id int,
    other_id int REFERENCES a(id)
);
INSERT INTO a VALUES (1,1);
INSERT INTO b VALUES (1,1);
"
38745,50600,How can I change Column Headers title from SQL query datagrid in vb.net,"Select roomnumber As Room_Number, etc
"
35695,63505,Need very simple 'sequence' for GetNextOrderNumber for SQL Server,"USE [ShoppingCart]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Sequence_CompletedOrderID]
([val] [int] NOT NULL IDENTITY(520000, 1)
) ON [PRIMARY]



CREATE PROC dbo.GetNextCompletedOrderId 
  @nextval AS INT OUTPUT
AS
   INSERT INTO dbo.Sequence_CompletedOrderID DEFAULT VALUES

   SELECT @nextval = SCOPE_IDENTITY()
GO
"
5781,55769,SQL JOIN + GROUPBY select data from row with MAX(Date),"SELECT i.*, outerT.EntryDateTime, outerT.varchar, outerT.int
FROM Item i
     LEFT JOIN
     (SELECT ItemId AS outerItemId, EntryDateTime, varchar, int
      FROM (SELECT ROW_NUMBER() OVER (PARTITION BY lt.ItemId ORDER BY t.EntryDateTime) AS RowNumber, lt.ItemId, t.EntryDateTime, t.varchar, t.int
            FROM Tranaction t INNER JOIN LinkingTable lt ON lt.TransactionId = t.ID) innerT
      WHERE RowNumber = 1) outerT ON outerT.outerItemId = Item.ID
"
7188,8574,MySQL JOIN Complexity,"SELECT
  t1.id,
  t1.name,
  IFNULL(t2.Marks, 0) AS Marks
FROM T1 
LEFT JOIN T2 ON t1.ID = t2.ID;
"
38390,74512,How to select columns that are similar values and calculate quantity and sum of prices,"select Ducumentnumber,Count(quantity) as Quatity,sum(price)
from table1
group by Ducumentnumber
"
22504,49760,LINQ getting Distinct values,"class AssemblyComparer : EqualityComparer<AssemblyPrograms> {
    public override bool Equals(AssemblyPrograms x, AssemblyPrograms y) {
        return x.ProgramID == y.ProgramID && x.AssemblyID == y.AssemblyID;
    }

    public override int GetHashCode(AssemblyPrograms obj) {
        return obj.ProgramID.GetHashCode() ^ obj.AssemblyID.GetHashCode();
    }
}
"
1894,49169,"Group by week, how to get empty weeks?","SELECT DATE_FORMAT(date, 'Y:%X - Week:%V') AS regweek, COUNT(date) as number 
    FROM YourTable RIGHT OUTER JOIN Weeks ON WEEK(YourTable.date) = Weeks.WeekNo
"
37686,9209,Is there a function that exists that will let me cycle through a set of variables?,"WHERE DATEPART(yyyy, ESCDATE) IN (2011, 2012, 2013)
GROUP BY DATEPART(yyyy, ESCDATE)
"
23125,39025,Oracle SQL return count(*) column along side of regular column?,"SELECT username,count(*) from TABLE WHERE username='USERNAME' GROUP BY username
"
8823,60539,Need help returning unique results in mySQL,"  SELECT firstname, lastname, date_of_birth 
    FROM `data`
   WHERE diagnosis_location IN ('Mayo', 'Lahey')
GROUP BY firstname, lastname, date_of_birth 
  HAVING COUNT(DISTINCT diagnosis_location) = 2
"
28573,13658,Search alike in EF database,"using (var ctx = new DbContext())
{
    var parameter1 = new SqlParameter(""@UserName"", ""FindMe""));
    var parameter1 = new SqlParameter(""@Password"", ""f452""));

    var user = ctx.Users.SqlQuery(""Select * from Users where UserName = @UserName and Password = @Password"", parameter1, parameter2)
                        .FirstOrDefault<Users>();
}
"
36867,9992,How to select all non-distinct rows from a DB?,"SELECT origin, destination 
FROM mytable
GROUP BY origin, destination
HAVING COUNT(*) > 1
"
3681,44198,Wordpress user_login field on new table field,"insert into new_table (user_login)
select user_login from UsersTableNameHere
"
28688,34668,jdbc using sqlnet.ora,"jdbc:oracle:oci:@<<TNS alias>>
"
39843,8894,Optimizing joined SQL CTEs -- Server 2008,"SELECT  Z.GM
    ,   Z.IG AS IG1
    ,   Y.IG AS IG2
FROM FN_qryFYQI(@pYQ1) Y
JOIN (
    SELECT Z.GM, Z.IG
    FROM FN_qryFYQI(@pYQ2) Z
) Z ON Y.GM = Z.GM
"
35558,8004,Find difference between two consecutive rows of same column in mysql,"select orderid
from orders
group by orderid
having sum(case when `type` = 'Order' then productsales else 0 end) +
       sum(case when `type` = 'Refund' then productsales else 0 end) > 0
"
20093,75182,Get CLOB data in a text/xml file,"use DBI;
my $db = DBI->connect('dbi:Oracle:tnsname','user','password',{RaiseError=>1});
my $txt = ($db->selectrow_array('select my_clob_col from my table where ...'))[0];
$db->close;
open my $fh, '>out.txt' or die $!;
print $fh $txt;
close $fh;
"
24387,16119,Sybase DB SQL Anywhere - push notifications on database changes,"SET tmp = (SELECT C2 From proc_http_post(adr.AdrId) with (C1 long varchar,C2 long varchar) WHERE C1 = 'Body');
"
17432,10455,Reference column in mysql where clause by its index,"ORDER BY 2, 1
"
13258,10531,SQL average from multiple columns,"select (125Hz+250Hz+500Hz+750Hz+1000Hz+1500Hz+2000Hz+3000Hz+4000Hz+6000Hz+8000Hz)/11 as aveHz from table_name
"
10056,25568,Compare 2 times ignoring the seconds,"WHERE QUANTIZE(TO_TIMESTAMP(date, time), 60) = TIMESTAMP('2014-02-12 22:51:00')
"
32039,69521,Pivot Table in Oracle 11g,"SELECT *
FROM table1
unpivot
(
  ""Values"" FOR ""Number"" IN (""1"",""2"",""3"",""4"",""5"")
 );
"
14637,74541,How to get numbers from a string,"select regexp_replace('my_4name - 7203', '.*?([[:digit:]]+)[)]?$','\1')  from dual;
"
10013,38571,SQL Find maximum then find occurances thereof,"SELECT e.employeeID,
    SUM(e.vacationhours + e.sickleavehours) AS totalHours
FROM humanresources.employee e 
GROUP BY e.employeeID
HAVING SUM(e.vacationhours + e.sickleavehours) >= all
  (SELECT SUM(e.vacationhours + e.sickleavehours) FROM humanresources
   GROUP BY employeeID)
"
14691,1162,Multi join query returns to many results and improperly matched,"select *
from source
    inner join cats on source.catid = cats.id
    left join status on source.sourceid = status.catsource
         and statusid=1
"
13030,30164,Getting a column of table using another table,"select t1.column2
from table1 t1
left join table2 t2
   on t1.id = t2.id
"
9229,63396,How to exclude entries with specific value/strings in phpmyadmin SQL?,"SELECT * FROM mytable WHERE path NOT LIKE '%coffee%' AND path NOT LIKE '%Beans%'
"
18753,54952,WordPress DB Query to count number of users registered per day,"select 
count(*) as total_users ,
date(user_registered) as reg_date 
from wp_users 
group by reg_date 
having total_users > 0 
"
15852,74397,SQL getting max id field on a LEFT JOIN,"SELECT messages.*, T2.photo
FROM messages
LEFT JOIN (SELECT userid, MAX(id) AS maxid
           FROM tblimages
           GROUP BY userid) AS T1
ON messages.user_id = T1.userid
LEFT JOIN tblimages AS T2
ON T2.id = T1.maxid
ORDER BY messages.msg_id DESC
"
8162,1663,Check two fields access parameter query,"PARAMETERS [Enter the last date checked for:] DateTime;
SELECT PatientSurvey.PatientID
FROM PatientSurvey
WHERE
       (([PatientSurvey].[6MonthSurveyReturn]) Between [Enter the last date checked for:] And Date())
    OR (([PatientSurvey].[12MonthSurveyReturn]) Between [Enter the last date checked for:] And Date());
"
38897,64425,"What's the best way to have a ""repeating field"" in SQL?","ALTER TABLE t ADD CONSTRAINT CH_ITEM1_LESSTHAN_ITEM2 CHECK (item_id_1 < item_id_2)
"
30115,42070,How do I count the number of times each keyword from a table appears in a table of phrases?,"MERGE INTO KEYWORDS masterList
USING (
    SELECT COUNT(*) AS OCCURRENCE,KEYWORDS.KEYWORD AS KEYWORD FROM
    KEYWORDS AS keywordList
    CROSS JOIN PHRASES AS phraseList 
    WHERE (dbo.RegExIsMatch('.*' + keywordList.KEYWORD + '.*',phraseList.PHRASE,1) = 1)
    GROUP BY KEYWORD
) frequencyList
ON (masterList.KEYWORD = frequencyList.KEYWORD)
WHEN MATCHED THEN 
    UPDATE SET masterList.OCCURRENCE = frequencyList.OCCURRENCE;
"
681,73880,Adding rows automatically based on previous rows,"SELECT TOP (100) PERCENT Room,
    Subject,
    COUNT(Subject) AS Expr1
FROM dbo.Timetable
GROUP BY Room,
    Subject

UNION ALL

SELECT TOP (100) PERCENT Room, 
    'Not Used',
    60 - COUNT(Subject) AS Expr1
FROM dbo.Timetable
GROUP BY Room

ORDER BY t.Room
"
39222,55640,T-SQL: Looking up results based on the result of the table prior to it,"select c.*, p.*
from claims c outer apply
     (select top 1 p.*
      from policies p
      where p.policy_no = c.policy_no and p.limit_date <= c.claim_date
      order by p.limit_date desc
     ) p;
"
4411,2981,MySQL: How to implement history of product price and units,"SELECT * FROM product
  JOIN product_state ps on product.id = ps.product_id
WHERE ps.id = (select max(ps2.id) 
                 from product_state ps2 
                where ps2.product_id = ps.product_id) 
ORDER BY ps.id DESC;
"
13724,67354,How to ignore a part of a string on a column value,"SELECT user_data.alternative_mail
FROM user_data
RIGHT OUTER JOIN users_map
ON users_map.user_id = user_data.user_id
WHERE users_map.service_id = 1 AND 
    users_map.service_user_id = 0 AND
    user_data.alternative_mail NOT LIKE '%@info.com'
"
18835,73315,SQL - get highest value from a string fragment,"Declare @maxval  int =
( select 
max(cast ( right(col, 4) as int)) from TableA )
Select * from TableA where cast ( right(col, 4) as int) = @maxval
"
24337,22588,possible to join a table on only one row,"SELECT
   u.firstname, u.lastname, t.*
FROM
   #users AS u
   CROSS APPLY
   (SELECT TOP 1 * 
    FROM OtherTable AS ot 
    WHERE u.userid = ot.userid
   ORDER BY something) t
"
39485,74989,MySQL how to return concatenated name and lastname of a user,"SELECT id                                    AS value, 
       Concat(LEFT(name, 1), '. ', lastname) AS label 
FROM   table; 
"
16383,65836,Date conversion in postgress,"select to_char(the_date_column, 'mm/yy') from the_table;
"
22780,31655,"create a table named ""select"" in SQL databases","CREATE TABLE ""SELECT"" ...
"
27914,39538,Mimic table in MySQL (view or stored function),"CREATE VIEW UserParams  (user_id, param, value)
AS SELECT  id,  ""Address""  , address 
FROM New_User
UNION 
SELECT id, ""Phone"", phone
FROM New_User
"
7824,25399,Create Password Verification Function Oracle 10g,"FOR i IN 1..LENGTH(PWD_STR)-2 LOOP
IF INSTR(LOWER(USER_NAME),SUBSTR(LOWER(PWD_STR),i,3)) > 0 THEN
RETURN FALSE;
END IF;
END LOOP;
"
30105,28150,Excluding insert of specific rows when copying data in same table,"INSERT INTO table (product_id, value, branch_id)
SELECT t1.product_id, t1.value, '71'
FROM table AS t1
LEFT JOIN table AS t2 ON t1.product_id = t2.product_id AND t2.branch_id = '71'
WHERE t1.branch_id = '53' AND t2.product_id IS NULL
"
27378,3716,How to convert string to integer - weird format,"SELECT CAST((columnName * 100) as INTEGER) NewValue
FROM TableName;
"
12558,14237,Is there a BEFORE SELECT trigger in pl/sql?,"CREATE OR REPLACE VIEW customer_v AS
SELECT c.*, 
       CASE WHEN SYSDATE > add_months(c.start_date, 12) 
          THEN 'FALSE' 
          ELSE 'TRUE' 
       END is_member
  FROM customer c
"
11712,43060,SQL Derby return middle of table,"SELECT t.*
FROM mytab t
INNER JOIN (SELECT MIN(COL1) AS VAL2
            FROM mytab
            WHERE COL1 NOT IN (SELECT MIN(COL1) FROM mytab)) x
ON t.COL1 > x.VAL2
"
7567,61592,Count characters after given symbol in oracle varchar column value,"select length('abcd@efgh.123.4567') - instr('abcd@efgh.123.4567', '.', -1) from dual
"
25281,55980,Query for most frequent value or neither,"WITH
RECOUNTS AS
(    
  SELECT
    NVL(COUNT(CASE TYPE WHEN 0 THEN TYPE END), 0) AS HEROES,
    NVL(COUNT(CASE TYPE WHEN 1 THEN TYPE END), 0) AS VILLAINS
  FROM MUTANTS
)
SELECT
  CASE WHEN HEROES > VILLAINS THEN 'heroes'
       WHEN HEROES < VILLAINS THEN 'villains'
       ELSE 'neither'
  END AS MOSTFREQUENT
FROM RECOUNTS
"
29904,66409,sql how to extract the most common of values from a windowing function,"select id, channel
from (select id, channel, count(*) as cnt,
             row_number() over (partition by id order by count(*) desc) as seqnum
      from table t
      group by id, channel
     ) ic
where seqnum = 1;
"
24836,9153,Issue with Sql query: count distinct row values relative to other row value,"Select e.name, e.category, e.posts from exampletable e
where e.name not in
(select e1.name from exampletable e1 where e.name = e1.name and e.category <> e1.category) 
and e.category = '01'
"
5898,65302,PL SQL trigger to insert history record when a column is updated,"CREATE OR REPLACE TRIGGER trigger_name
  AFTER UPDATE ON table_name
  FOR EACH ROW
BEGIN
  IF( UPDATING( 'COLUMN1' ) )
  THEN
    INSERT INTO log_table( column_name, column_value )
      VALUES( 'COLUMN1', :new.column1 );
  END IF;

  IF( UPDATING( 'COLUMN2' ) )
  THEN
    INSERT INTO log_table( column_name, column_value )
      VALUES( 'COLUMN2', :new.column2 );
  END IF;

  <<repeat for all columns>>
END;
"
18265,46955,How can I change my INNER JOIN to an OUTER JOIN?,"create table users
(
  userid int
)

create table documents
(
  documentid int,
  userid int,
  documentname varchar(10)
)

insert into users values (1)
insert into users values (2)
insert into users values (3)
insert into users values (4)

insert into documents values (1, 1, 'test')
insert into documents values (2, 1, 'test 1')
insert into documents values (3, 2, 'test 2')
insert into documents values (3, 3, 'test 3')

select *
from users u
left join documents d
on u.userid = d.userid
"
10447,30185,Android SharedPreferences limitations?,"SharedPreferences settings = getSharedPreferences(PREFS_FILE_NAME, 0);
SharedPreferences.Editor editor = settings.edit();
editor.putInt(""firstValue"", mFirst);
editor.putInt(""secondValue"", mSecond);
editor.putInt(""thirdValue"", mThird);

// Commit the edits! (As infrequently as possible)
editor.commit();
"
4328,48723,Lookup table for oracle decodes?,"select nvl((select state_desc from lookup where state_num=state),to_char(state)) from states_table
"
21746,523,how to select @domain from email and match from another table with mysql,"select 
    f.fo_name, f.fo_email, d.user_id, d.substr_email
from
    foundation f
        inner join
    (select 
        d_users.user_id,
        RIGHT(user_email, (LENGTH(user_email) - LOCATE('@', user_email) + 1)) as substr_email
    FROM
        d_users
    where
        d_users.user_id = '1') d ON f.fo_email = d.substr_email;
"
31507,26971,Selecting only rows containing at least the given elements in SQL,"SELECT parent FROM table WHERE child IN(10,20)
GROUP BY parent 
HAVING COUNT(DISTINCT child)>=2
"
11369,56203,How to Get Count of the Particular records in Oracle?,"SELECT case when Status in ('A','B') 
            then 'A&B'
            else Status
       end AS Status,
       COUNT(Status) AS StatusCount
FROM EMPLOYEE
GROUP BY case when Status in ('A','B') 
              then 'A&B'
              else Status
         end
"
5511,7524,Eliminate mysql file sort in update query,"SET @update_id := -1;
SELECT (SELECT @update_id := id)
FROM queue
WHERE acquired IS NULL AND queue_name = ""q1""
ORDER BY priority, id LIMIT 1;
FOR UPDATE;
UPDATE queue SET acquired = ""test"" WHERE id = @update_id;
"
2907,70254,Sqlite Check if Table is Empty," SQLiteDatabase db = table.getWritableDatabase();
String count = ""SELECT count(*) FROM table"";
Cursor mcursor = db.rawQuery(count, null);
mcursor.moveToFirst();
int icount = mcursor.getInt(0);
if(icount>0)
//leave 
else
//populate table
"
17797,31887,Postgis ST_Contains polygon one table,"SELECT st_contains(a.way, b.way)
FROM yourtable AS a, yourtable AS b
WHERE 
    a.gid = yourfirstid
    AND b.gid = yoursecondid
"
7661,34004,Intersect two intervals,"SELECT *
FROM MyIntervals
WHERE LEAST(b, u) >= GREATEST(a, l)
"
36447,19064,Selecting records with single quotes escaped by double backslashes only,"SELECT * FROM my_table WHERE my_column RLIKE '[\\]{2}';
"
38508,68611,Using 'LIKE' operator with a subquery that returns multiple results,"SELECT p.pattern, count(a.comment)
FROM (subquery here that returns ""pattern""
     ) p left outer join
     TableA a
     on a.comment like '%'||p.pattern||'%'
group by p.pattern;
"
25199,45805,SQL MySQL query joining two tables,"SELECT 
    Contact.Name, Contact.Email, Contact.PrimaryPhone, Company.Name, 
    Company.Email, Contact.Description. Company.Description, Contact.CompanyName
FROM Contact
RIGHT JOIN Company ON Company.Id = Contact.CompanyId
WHERE Contact.Name LIKE '%x%' OR Company.Name LIKE '%x%'
"
25158,50643,"""Double Group By"" in Oracle SQL?","SELECT d.dname
FROM emp e  INNER JOIN dept d ON(e.deptno = d.deptno)
            INNER JOIN salgrade s ON(e.sal BETWEEN s.losal AND s.hisal)
GROUP BY d.dname
HAVING COUNT(DISTINCT s.grade) = (SELECT COUNT(*) FROM salgrade);
"
10588,48487,How to select only distinct values for two columns in mysql,"select min(id) as id, region
from region_details
group by region
"
35557,72151,Converting bytes to integers,"create table HoldSpaceUsed
(
    database_name sysname,
    database_size varchar(100),
    [unallocated space] varchar(100)
)

insert HoldSpaceUsed
exec sp_spacesused
"
6621,49449,Selecting LDF file using sys.master_files,"cmd.CommandText = (""select physical_name from sys.master_files where type = 1 and database_id = DB_ID('"" + ""mydatabasename"" + ""')"");
"
23993,66216,Select records from a SQL Server database using geography and distance,"DECLARE @location AS geography = geography::Point(@latitude, @longitude, 4326)
DECLARE @distance AS INT = 10000
DECLARE @range AS geography = @location.STBuffer(@distance)

SELECT * 
FROM records
WHERE records.location.STIntersects(@Range) = 1
"
13951,44856,Get all siblings in SQL tree,"WITH RECURSIVE tree(product_id, name, parentlist) AS (
  SELECT product_id, name, ARRAY[ row_number() OVER (ORDER BY product_id) ]
  FROM tree_products
  WHERE parent_id IS NULL
  UNION
  SELECT tp.product_id, tp.name, array_append(parentlist, row_number() OVER (ORDER BY tp.product_id))
  FROM tree_products tp
  INNER JOIN tree t
  ON (tp.parent_id = t.product_id)
)
SELECT *
FROM tree
ORDER BY parentlist;
"
14059,34900,Selecting external data source in DMX,"OPENQUERY (relDatabaseServer, 'SELECT name FROM example.titles WHERE name = ''NewTitle''');
"
12580,53918,Convert tricky linq expression to SQL,"SELECT firstDigit as Key, COUNT(*) as theCount
FROM
(
  SELECT convert(int, LEFT(convert(varchar(30), f), 1)) as firstDigit
  FROM Source as f
) as sub
GROUP BY firstDigit
"
4268,19533,TSQL Return Guid that occurs the most in a column,"SELECT TOP 1 ID, COUNT(*) AS CountOfRows
FROM UnknownTable
GROUP BY ID
ORDER BY CountOfRows DESC
"
7510,17655,"Given text file path, how to Fetch and Store TextFile Contents into DataTable","CREATE TABLE #tempfile (line varchar(8000))
EXEC ('bulk INSERT #tempfile FROM ''D:\New Text Document.txt'' ')
SELECT * FROM #tempfile
DROP TABLE #tempfile
"
2209,51194,search entire oracle database for part of string,"EXECUTE IMMEDIATE
  'SELECT COUNT(*) FROM ' || t.owner || '.' || t.table_name ||
  ' WHERE '||t.column_name||' like :1'
  INTO match_count
  USING '%ALERT%';
"
8781,53708,Assign values from a column to another column in the correspondent row,"update your_table
set column1 = column1 || column2
"
20381,38842,Does MySQL binary log support logging Uid's?,"111130 13:46:50   130 Connect   myusername@localhost on
                  130 Init DB   mydatabase
                  130 Query     SELECT somefields FROM sometable
                  130 Query     SELECT somefields FROM sometable
                  130 Quit
"
21389,33758,Oracle date / order by question,"select monthyear,yr,month,count(req_id)
from
(
SELECT (to_char(req_date,'MM/YYYY')) as monthYear, to_char(req_date,'YYYY') yr, to_char(req_date,'mm') month, req_id
FROM   REQUISITION_CURRENT t
) x
GROUP BY monthyear,yr,month
order by yr, month
"
32827,60053,"How do I select records by comparing values in columns B, C among records with same value in column A?","SELECT orders.user, orders.item, orders.date
FROM orders, (SELECT * FROM orders WHERE item = 'ball') ball_table
WHERE orders.user = ball_table.user AND orders.date > ball_table.date;
"
38435,30844,How to merge multiple tables in MYSQl which have two columns in common,"SELECT table_1.*, table_2.*, table_3.*, table_4.* FROM table_1  
  INNER JOIN table_2 ON table_1.age_grp = table_2.age_grp  
    AND table_1.gender = table_2.gender
  INNER JOIN table_3 ON table_2.age_grp = table_3.age_grp  
    AND table_2.gender = table_3.gender
  INNER JOIN table_4 ON table_3.age_grp = table_4.age_grp  
    AND table_3.gender = table_4.gender
"
9205,68373,SQL Proc parameter to insert WHERE clause?,"create proc myProc (checkForBadData bit)
begin
    SELECT myId, data
    FROM myTable
    WHERE checkForBadData = 0 or theirId IS NULL
end
"
39691,53783,SQL Server : Subquery returned more than 1 value,"Select friend.UserID2 from User
left join Friend on friend.userid1 = user.userid
Where user.username like '%A' and friend.UserID1 ='1001'
"
12805,33446,DATEADD() function to find values in this business day,"-- cache current date to avoid multiple calls
DECLARE @startOfADay INT
DECLARE @dayLength INT
DECLARE @currentDate DATETIME
SET @currentDate = DATEADD(dd, 0, DATEDIFF(dd, 0, GETDATE()))
SET @startOfADay = 9
SET @dayLength = 8

SELECT 
   ...
FROM
   ...
WHERE ...
BETWEEN 
      DATEADD(hh, @startOfADay, @currentDate) 
      AND 
      DATEADD(hh, @startOfADay + @dayLength, @currentDate)
"
14954,19382,database functional dependency decomposition,"Person {ID, Name, Age, Line1, Zip} (key= {ID})
Address {City, State, Zip} (keys = {City, State} and {Zip])
"
33019,16550,how to calculate profit in the select query,"SELECT sum(dr) exp,
       sum(cr) inc,
       sum(cr)-sum(dr) profit 
FROM   vMonthlyExpenses
"
34437,28558,Firebird SQL: wildcard % with null values,"SELECT
  *
FROM
  my_table
WHERE
  COALESCE(my_field, -1) = some_value
"
3649,50098,What's the most efficient way to match values between 2 tables based on most recent prior date?,"SELECT  d.Val,
        p.Val,
        NewVal = d.Val + ISNULL(p.Val, 0)
FROM    Dailyt AS d
        OUTER APPLY
        (   SELECT  TOP 1 Val
            FROM    Periodt p
            WHERE   p.Date <= d.Date
            ORDER BY p.Date DESC
        ) AS p;
"
38783,38439,Order by date a select query on UNION ALL,"SELECT id, date, text
FROM (SELECT id, date, text, 1 AS priority
      FROM timeline
      UNION ALL
      SELECT *, 2 AS priority
      FROM reps) u
ORDER BY priority, date DESC
"
28338,47784,Update SQL by joining 3 tables,"UPDATE t1.Approved
SET t1.Groupid = t2.ID
FROM dbo.Approved t1
INNER JOIN dbo.Locations t2 ON t1.Location = t2.Location_Name
"
27918,29500,Combining multiple rows into a comma delimited list in SQL,"SELECT   id, GROUP_CONCAT(name ORDER BY name ASC SEPARATOR ', ')
FROM     my_table
GROUP BY id
"
25229,38289,Grouping in SQL Server 2008 R2 by min value of the group,"    WITH mycte
    (id, createdate, createdby, rownum)
    AS
    (
     SELECT id, createdate,createdby,  ROW_NUMBER() OVER (PARTITION BY id ORDER BY createdate  ASC) AS ROWNUM
     FROM johnresults
    )

    SELECT j.id, j.task, mycte.createdby, mycte.createdate 
    FROM
    johnresults j
    inner join mycte ON j.id = mycte.id and mycte.rownum = 1
    GROUP BY j.id, j.task, mycte.createdby, mycte.createdate
"
1587,74369,how to display the most recent record in a database mysql,"SELECT * from DVD
WHERE Genre = 'Action'
ORDER BY YOR DESC LIMIT 1;
"
34111,7428,Update column by parsing another column with T-SQL,"UPDATE tblPhotos
SET Title = RTRIM(LTRIM(
            SUBSTRING(Description,
                      CHARINDEX('-', Description) + 1,
                      LEN(Description) - CHARINDEX('-', REVERSE(Description))
                                       - CHARINDEX('-', Description))))
WHERE Title IS NULL
"
5777,11386,Oracle: insert without columns specification,"INSERT INTO table (column1) VALUES (default);
"
13970,668,How can i merge duplicate rows in SQL with an special condition,"SELECT
    ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS Id,
    *
FROM (
    SELECT DISTINCT Word,
        STUFF((SELECT ',' + description
               FROM Your_Table
               WHERE Word = T.Word
               FOR XML PATH('')), 1, 1, '') AS description
    FROM Your_Table T) AS A
"
1631,2957,How to find missing alpha values in sets of data within same table in SQL,"SELECT DISTINCT M1.WONumber
FROM Mytable M1
WHERE
    NOT EXISTS (SELECT 1/0 --or NULL, 1, *, 'bob'. All the same
                  FROM Mytable M2
                  WHERE M2.ResourceID = 'RW' AND M1.WONumber = M2.WONumber)
"
14360,15032,to find the duplication of values,"SELECT colValue, count(colValue) as cnt  
FROM table1
where colValue in (1,2,3)
group by colValue 
having cnt>1
"
8971,71431,Add columns to an Access (Jet) table from .NET,"Dim conn as New AdoConnection(someConnStr)
Dim cmd as New AdoCommand
cmd.Connection = conn
cmd.CommandText = ""ALTER TABLE X ADD COLUMN y COLUMNTYPE""
cmd.ComandType = CommandType.Text
cmd.ExecuteNonQuery()
"
34448,23150,SQL foreach loop,"insert SiteCrawl
(
    Site_ID
)
select
 s.Site_ID
from Site as s
where s.Site_ID not in (select Site_ID from SiteCrawl)
"
29845,9637,How to know which part of query is executed,"SELECT status,
    CASE 
    WHEN (userid=1 and friend=2) THEN 'opt1'
    WHEN (friend=2 and userid=1) THEN 'opt2'
END AS 'var'
FROM friends 
WHERE userid IN (1, 2) 
    OR friend IN (1, 2)
"
18913,47137,Simple SQL question about getting rows and associated counts,"SELECT 
  a.ID, 
  a.Title, 
  COUNT(DISTINCT c.ID) AS NumComments, 
  COUNT(DISTINCT v.id) AS NumVotes
FROM 
  Articles           a
  LEFT JOIN Comments c ON c.ParentID = a.ID
  LEFT JOIN Votes    v ON v.ParentID = a.ID
GROUP BY 
  a.ID, 
  a.Title
"
22625,71633,Select from table given day,"  select * from dbo.tblMessages
  WHERE

  MyDateTimeCol >= DATEADD(day, DATEDIFF(day, 0, @Mydatetimeparameter), 0)
  AND
  MyDateTimeCol < DATEADD(day, DATEDIFF(day, 0, @Mydatetimeparameter), 1)
"
4029,47402,Return rows where no match is found in another table,"SELECT t.*
FROM   teams t
WHERE  NOT EXISTS (SELECT 1
                   FROM   userteams ut
                   WHERE  t.teamname = ut.teamname
                          AND ut.name = 'Gary') 
"
18508,4031,"What is hive's equivalent of ""select ... into outfile""?","INSERT OVERWRITE LOCAL DIRECTORY 'someDir' SELECT ...
"
5375,41749,How do I show the latest content from my SQL Database (mulitple tables) on my website?,"if($_GET['mode'] == """"){ 
  $get_content = mysql_fetch_array(""
     (SELECT * FROM Pictures
       ORDER BY Dato DESC LIMIT 0,1) 
     union all (SELECT * FROM Videos 
       ORDER BY Dato DESC LIMIT 0,1)
     order by Dato DESC LIMIT 0, 1"");
   while($content = mysql_fetch_array($get_content)){...}
}
"
5588,7465,Decode text from a FOR XML Sql Query,"SELECT STUFF((SELECT ', ' + '<' + NAME + '>'
          FROM   [sys].[login_token]
          ORDER  BY NAME
          FOR XML PATH(''), type).value('.','NVARCHAR(MAX)')
          , 1, 2, '') AS Logins; 
"
30021,38869,converting Epoch timestamp to sql server(human readable format),"update tbl set
    datetimecol1 = dateadd(s, epochcol1, '19700101'),
    datetimecol2 = dateadd(s, epochcol2, '19700101'),
    datetimecol3 = dateadd(s, epochcol3, '19700101')
"
6388,66231,Get all userid friends give unnexpected result,"SELECT  id, fid, name
FROM users,friends where users.id=friends.fid
WHERE users.id = 33456
"
36634,3061,Losing SQL results when moving a filter outside of a subquery,"SELECT purchase_id, rn
FROM 
(
   SELECT vrd.purchase_id, 
          af.date as affiliation_date,
          row_number() over (partition by af.customer_id order by af.date desc) as rn

   FROM v_details vrd
   LEFT OUTER JOIN affiliates af
     ON vrd.customer_id = af.customer_id AND af.date <= vrd.purchase_date

   WHERE vrd.date >= DATE'2012-12-01'
) T
WHERE rn = 1
  AND purchase_id = 1122996729
"
26888,41908,SQL Server 2008 R2: Show the dates day into comma separated column,"select t1.cola, stuff((SELECT ',' + right(convert(varchar(5),t2.coldate,3),2)  from
test_t t2 where t2.cola = t1.cola FOR XML PATH('')),1,1,'') AS Dates_Day 
from test_t  t1
group by t1.cola
"
4760,20251,When are SQL Server Index Usage Stats Updated?,"USE your_db;
SELECT t.name AS Table_Name
      ,i.name AS Index_Name
      ,i.type_desc AS Index_Type
      ,STATS_DATE(i.object_id,i.index_id) AS Date_Updated
FROM sys.indexes i
JOIN sys.tables t
  ON t.object_id = i.object_id
WHERE i.type > 0 
ORDER BY t.name ASC
    ,i.type_desc ASC
    ,i.name ASC;
"
1679,73364,Update a column using a value from the same row in Oracle,"UPDATE LOAD_SETTINGS 
SET 
  LOADDATE = UPDATEDATE 

WHERE
  MODEL = 'A001'
  AND OBJECT = 'A';
"
37467,42992,How do I include records lacking one half of a join?,"SELECT 
    s.staffID as staffID, 
    CONCAT_WS("", "", lname, fname) AS name, 
    GROUP_CONCAT(unit SEPARATOR "", "") AS units 
FROM 
    staff s
    LEFT OUTER JOIN staff_units r ON s.staffID = r.staffID     
    LEFT OUTER JOIN units u ON u.unitID = r.unitID 
GROUP BY s.staffID 
ORDER BY lname
"
29367,34954,How to put Flag on a column?,"select case when isnull(price, 0) <= 0 then 0 else 1 end as validprice
"
35179,73267,Sorting (or usage of ORDER BY clause) in T-SQL / SQL SERVER without considering some words,"select * from #test
order by
case when test like 'The %' then substring(test, 5, 8000) else test end
"
22291,40904,iPhone SQLite question,"if(appDelegate.easymediumhard == 2 && gameVarLevel == 5){

       globalScore = timeSeconds;
       scoreValid = YES;

} else {

      scoreValid = NO;

}
"
31404,13264,Oracle Analytic Preceding Returns wrong/unanticipated results,"(ORDER BY WEEK RANGE BETWEEN INTERVAL '91' DAY PRECEDING AND INTERVAL '1' DAY PRECEDING)
"
17284,53183,Compare values from 2 tables based on Dates from one of the 2 tables?,"Select p.ProfileName, p.AggregationDate,
p.TotalSalesAmount as ProfileAmount, a.DataValue as AggregationAmount,
Case When p.SalesAmount <> a.DataValue Then 1
else 0
end as Equal
From Aggregation a 
Inner Join ProfileReconcilation p On Convert(Date,p.AggregationDate) = a.DataDate
"
32256,49988,Select view only showing some results,"SELECT
    items.ShipmentID,
    items.FNSKU,
    items.ASIN,
    items.Merchant,
    shipments.ShipmentName,
    shipments.Prep_Type,
    items.Quantity
FROM dbo.FBAShipmentItems AS items
LEFT JOIN dbo.FBAShipments AS shipments
ON items.ShipmentID = shipments.ShipmentID
"
27569,29857,MySQL: Query in a Query?,"INSERT INTO shared (type, account, id)
SELECT 'twitter' type, 'my-twitter-account' account, MIN(a.id) ID
FROM    items a
        LEFT JOIN shared b
            ON a.id = b.id
WHERE   b.id IS NULL
"
36355,33011,SQL query to add a value x in a column if a column has Y value,"SELECT [Machine ID], Hostname, [IP Address], 
CASE WHEN [IP Address] LIKE '10.216%' THEN 'Chennai'
     WHEN [IP Address] LIKE '10.218%' THEN 'Mumbai'
     WHEN [IP Address] LIKE '172.21%' THEN 'NOIDA'
     WHEN [IP Address] LIKE '192.25%' THEN 'Delhi'
     ELSE 'UNKNOWN' END
FROM MyTable
"
12272,46290,Can't fetch database objects when extending to another twig template in Symfony2,"{% render 'SomeBundle:Menu:menu' %}
"
9884,68981,Using the results of an aggregate function in a calculation,"SELECT MAX(Col1) OVER(PARTITION BY ID) MaxValue, 
       Col2 + MAX(Col1) OVER(PARTITION BY ID)
FROM TableA
"
8912,41544,MySQL: update field with Group By,"$sql = ""UPDATE table SET salary = salary  + 5 WHERE name = 'david' 
        ORDER BY id LIMIT 1"";
"
31251,68249,select maximum value of common column for multiple data set,"data max_date/view=max_date;
   set table: indsname=source;
   dset=source;
   keep date dset;
run;

proc sql;
  create table maximum_date as
  select max(date) as Latest_Date 
  from max_date
  group by dset;
 quit;
"
5212,31665,MS SQL Get Table Row With Data,"insert into b.dbo.articles(id, heading, detail, date)
    select id, heading, detail, date
    from a.dbo.articles a
    where not exists (select 1 from  b.dbo.articles b where b.id = a.id);
"
32659,65437,Correct way to remove entry from a SQL table along with the relations,"ALTER TABLE `TableAB` DROP FOREIGN KEY FK_KEY_Test;
ALTER TABLE `TableAB` ADD CONSTRAINT FK_KEY_Test FOREIGN KEY ('some_column') 
REFERENCES `TableA` ('Test_column1') ON UPDATE CASCADE ON DELETE CASCADE;
"
17077,31937,T-SQL using how to use PIVOT function,";with cte as(select initials, v, col from main
unpivot(v for col in([01_amount], [02_amount])) u)
select * from cte
pivot(max(v) for initials in([rw],[nb]))p
"
26301,41991,Oracle SQL Syntax to Find Distinct Data over 24 Hour Time Period,"select distinct trunc(date_created), user_name
from login_history
order by trunc(date_created);
"
10604,38639,Ordering left outer join using right table with fallback,"SELECT * FROM table1 AS t1 
LEFT OUTER JOIN table2 AS t2 ON (
    t2.t1_id = t1.id
    AND 
    t2.id = (SELECT tt2.id FROM table2 tt2 WHERE tt2.t1_id = t1.id ORDER BY created_at DESC LIMIT 1)
) ORDER BY COALESCE(f2.created_at, f1.created_at) DESC;
"
32837,11681,How do Join and Get back results in sql sever,"SELECT t1.ID, 
       COALESCE(t2.Name, t1.Name)AS Name 
FROM   table1 t1 
       LEFT OUTER JOIN table2 t2 
               ON t1.ID = t2.ID
"
25243,72512,Combine a SELECT and a UNION ALL,"SELECT A.idA, A.idB, COALESCE(B1.Value, B2.Value)
FROM tableA A
WHERE idA = 1;
LEFT JOIN TableB1 B1 ON B1.idB = A.idB
LEFT JOIN TableB2 B2 on B2.idB = A.idB
"
36617,74359,What's the mysql syntax to pull data on the fly,"SELECT 
  t.order_id, 
  s.StatusName
FROM tablename1 AS t
INNER JOIN the statusesTable AS s ON t.order_status = s.status_id;
"
34127,73421,Group by SQL with count,"SELECT a.ID as ID, a.Name as Name, a.Product as Product, ISNULL(b.cnt,0) as Cnt
FROM MyTable a
LEFT JOIN (SELECT Name, COUNT(*) as Cnt FROM MyTable GROUP BY Name) b
ON a.Name = b.Name
"
35646,8830,One `Select` query to generate 12 result sets,"SELECT 
   SUM(case when current_time_stamp BETWEEN '2014-01-01' AND '2014-01-31' then Amount else 0 end) AS `January` ,
   SUM(case when current_time_stamp BETWEEN '2014-02-01' AND '2014-02-29' then Amount else 0 end) AS `Febuary` ,
   .
   .
   .
   SUM(case when current_time_stamp BETWEEN '2014-12-01' AND '2014-12-31' then Amount else 0 end) AS `December` 
 FROM VAT
"
6910,62491,MSSQL Substring and keep the last word intact,"DECLARE @S VARCHAR(500)= 'This string is very large, it has more then 160 characters. 
    We can cut it with substring so it just has 160 characters but then it cuts 
    of the last word that looks kind of stupid.'

SELECT CASE
         WHEN charindex(' ', @S, 160) > 0 THEN SUBSTRING(@S, 0, charindex(' ', @S, 160))
         ELSE @S
       END 
"
21423,41094,Left Join to most recent record,"SELECT
  g.*, s.*
FROM
  GAMES g
LEFT JOIN
(
    SCORES s
  INNER JOIN
  (
    SELECT
      n.game_id,  MAX(n.created_on) AS max_score_date
    FROM
      SCORES n
    GROUP BY
      n.game_id
  )
    y
      ON  y.game_id        = s.game_id
      AND y.max_score_date = s.created_on
)
    ON s.game_id = g.id
"
24520,73068,subquery in oracle 10g,"select t.*
from (select t.*, row_number() over (partition by sid order by sdate) as seqnum
      from table t
     ) t
where seqnum = 1 and event <> 'A';
"
3236,68986,SQL getting a Row with MIN(col A) if 2 row exist then MIN(colB),"select top 1 cola, colb
from table1
order by cola, colb
"
11504,19732,"How do I use a join to query two tables and get all rows from one, and related rows from the other?","SELECT
    i.`id`,
    i.`title`,
    g.`id` as 'groupId',
    g.`groupTitle`,
    g.`externalURL`
FROM
    items i RIGHT OUTER JOIN groups g ON (i.`groupId` = g.`id`)
WHERE i.`id` IS NOT NULL OR g.`externalURL` IS NOT NULL;
"
28680,31903,Complicated select statement with SQL (mysql),"SELECT e.id AS entryid, us2.subunit_id AS subunitid,
    FROM unit_subunits AS us1 
        JOIN unit AS u1 ON (us1.unit_id = u1.id) 
        JOIN entry AS e ON (u1.entry_id = e.id)
        JOIN unit AS u2 ON (e.id = u2.entry_id)
        JOIN unit_subunits AS us2 ON (u2.id = us1.unit_id)
    WHERE us1.subunit_id = 5;
"
36018,7283,Calculate average for Top n combined with SQL Group By,"SELECT SalesPersonID, AVG(Value) As AvgOfValue FROM (
  SELECT Orders.SalesPersonID, Orders.Value
  FROM Orders 
  INNER JOIN OrdHist ON Orders.OrderID = OrdHist.OrderID
  INNER JOIN Orders o2 on o2.SalesPersonId = Orders.SalesPersonId
  INNER JOIN OrderHist oh2 on oh2.OrderID = o2.OrderID and oh2.Date <= Orders.Date
  GROUP BY Orders.SalesPersonID, Orders.OrderID, Orders.Value
  HAVING COUNT(*) <= 2
) t1 GROUP BY SalesPersonID
"
38236,56844,SQL Query for records with ONLY one condition,"select ISISProductCode 
from dbo.Product
join dbo.Item on dbo.Item.ISISStyleId = dbo.Product.ISISStyleId
group by ISISProductCode 
having sum(case when ISISMediaId <> '10' then 1 else 0 end) = 0
order by ISISProductCode
"
34883,60971,Complicated SQL Server SELECT query,"SELECT w.name,
       w.hours,
       w.shop,
       avg.average
  FROM Workers AS w,
       (SELECT shop,
               AVG(hours) AS average
          FROM Workers
        GROUP BY shop) AS avg
 WHERE w.shop = avg.shop
   AND w.hours < avg.average
"
38053,23486,Running SQL file from VBA,"Dim strSQL As String
strSQL = """"

Dim hnd As Integer
hnd = FreeFile

Open ""C:\Temp\yourScript.sql"" For Input As hnd

Dim row As String
Do Until EOF(hnd)
    Line Input #hnd, row
    strSQL = strSQL & row & vbNewLine
Loop

Close #hnd
"
3987,5086,MSSQL 2012 - Returning multiple columns in a subquery,"SELECT a.name, b.score, ...
FROM (select id, name, ... from table1 where ???) a
LEFT JOIN (select id, score, ... from table2 where ???) b on (a.id = b.id)
WHERE clause
"
27984,25333,Selecting distinct rows on all but one column,"SELECT min(id), date_f, date_t, num_n, num_d, mn, is 
FROM t
GROUP BY date_f, date_t, num_n, num_d, mn, is
"
3161,31293,Dump the body of a function or procedure in sqlplus,"select
    text
from
    user_source
where
    type = 'PROCEDURE'
and
    name='YOURPROCEDURENAME'
order by
    line;
"
22948,15586,RowNumber on join?,"WITH TableBoxesRanked AS (
  SELECT
    *,
    BoxNumber = ROW_NUMBER() OVER (ORDER BY BoxCode)
  FROM TableBoxes
)
SELECT
  b.BoxNumber,
  ItemNumber = ROW_NUMBER() OVER (ORDER BY i.ItemNo),
  i.ItemDesc
FROM TableItems i
  INNER JOIN TableBoxesRanked b ON i.BoxCode = b.BoxCode
WHERE a.BoxCode = 'X1'
"
14644,39275,SQL Server join results as comma separated list,"select co.CompanyID, AllIndustries = 
       (select (cast(industry as varchar(200))+',') as [text()]
       FROM company c, 
       company_industry_map m 
       WHERE c.company_id = m.company_id and c.company_id = co.company_id 
       order by industry_id for XML PATH(''))
from Companies co
"
15825,7823,sql SELECT return values matching NULL OR Another Value,"SELECT *
FROM have AS h
WHERE h.flag IS NULL
   OR h.flag IN (1, 11);
"
37496,24105,Command DELETE dont work in vba,"Set dbs = CurrentDb
dbs.Execute ""DELETE * FROM TMP WHERE diaMes = "" & _
            Format(tmp7, ""\#mm\/dd\/yyyy\#"")
"
20533,65951,How to take weekdays using sql query?,"SELECT DATENAME(dw, GETDATE())
"
19526,56658,SQL count on multiple columns?,"select firstname, lastname, count(*) as `Name Count`
from table
group by firstname, lastname
"
23737,28969,LEFT JOIN two tables through a third table,"SELECT * FROM TABLE Base base
LEFT JOIN A a ON a.a = base.a
LEFT JOIN C c ON c.c = a.c
LEFT JOIN B b ON b.b = c.b
"
37726,47065,"TempTable and filled with selected from Table, then display","insert into #address (addressid, addressline1)
select addressid, addressline1 
from   Address 
where  AddressLine1 LIKE '%Drive%' AND AddressID BETWEEN 400 and 1000
"
37319,32005,gridview column - only display first 20 characters of field,"       SELECT LEFT('ColumnName', 20) 
"
12958,61411,Update table from large select query,"update extradata set line4 = 'TEST'
from extradata inner join @tmp T
on extradata.number = T.number
where extracode = 'L3'
"
32791,28291,How to get column difference between 2 rows in DB in SQL,"select p.id, 
       c.time  - p.time as time_difference
from the_table p
  join the_table c on c.id = p.child_id
where p.child_id is not null;
"
37469,20857,T-SQL Create User/Login not allowing connection,"exec master.sys.xp_loginconfig 'login mode'
"
20055,10142,left join for on col to multi col,"select t.date,
       a.acc_name acc_name1,
       b.acc_name acc_name2,
       c.acc_name acc_name3,
       d.acc_name acc_name4
from d002 t
left join d001 a on a.acc_id = t.acc_id_1
left join d001 b on b.acc_id = t.acc_id_2
left join d001 c on c.acc_id = t.acc_id_3
left join d001 d on d.acc_id = t.acc_id_4
"
36667,32197,Dividing 2 numbers in Sql Server,"SUM(sl.LINES_CONFIRMED) * 1.0 / SUM(sl.LINES_ORDERED)
"
18278,17759,SQL Trigger in phpmyadmin,"CREATE TRIGGER my_first_trigger BEFORE INSERT employees
FOR EACH ROW
BEGIN
IF NEW.id_employee = 55 THEN
INSERT INTO special_employees VALUES (NEW.id_employee, NEW.name);
END IF;
END $$
"
9881,45617,How to order a a content in ascending order in a database field (SQL),"  SELECT q.QuestionId,GROUP_CONCAT(DISTINCT Answer
                                   ORDER BY Answer
                                   SEPARATOR '') AS Answer
    FROM Question q
    JOIN Answer an ON q.QuestionId = an.QuestionId
GROUP BY an.QuestionId
"
30532,65235,SQLite SUM() between several rows,"select sum(quantity)
from (select ft.*,
             (select count(*)
              from fuel_table ft2
              where ft2.note = 'Yes' and ft2.id >= ft.id
             ) as numNotesAhead
      from fuel_table ft
     ) ft
where numNotesAhead = 1;
"
14136,38978,How to list columns name from any sql query,"sql = ""SELECT * FROM users;""
res_proxy = session.execute(sql)
column_names = res_proxy.keys()
"
31833,57025,SQLite queries much slower using JDBC than in Firefox SqliteManager plugin,"... JOIN Leagues l1 INDEXED BY MyThreeColumnIndex ON ...
"
641,59328,SQL SUM on 'generated' column,"SELECT   name,
         surname,
         SUM(absentdays) AS total_absent_days
FROM     (SELECT name, 
                 surname,
                 DATEDIFF(""d"", fromdate, todate) AS absentdays
          FROM   DiseaseReport D, Employees E
          WHERE  E.number = D.empnumber
         )
GROUP BY name, surname
"
16972,35040,Translate SQL query to LINQ,"var albums = dataContext.PhotoAlbums.Select(album => new {
    AlbumId = album.AlbumId,
    Title = album.Title
    Date = album.Date,
    PhotoId = album.Photos.Select(photo => photo.PhotoId).FirstOrDefault()
});
"
14661,73492,where column.a is not null unless column.b = value,"where p.invc_dt  BETWEEN 1150101 AND 1160131    
and ( o.Tracking_num is not null OR `ORDER_CD` = 'REFUND' )
"
35446,32561,Changing from static date to changing date in Query & issue with Aggregate Function - MYSQL,"   SELECT SUM(date_format(purchasedate, '%m-%Y') = CONCAT('07-',YEAR(CURDATE()))
         / SUM(date_format(purchasedate, '%m-%Y') = 
                         CONCAT('07-',YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) 
   FROM Sales
"
31121,66585,SQL query to compare rows of table comparing a column values,"(select  `table l`.*  from `table l`, `table r` 
where `table l`. `sensitivity*10` > 10 and `table l`.`sensitivity*10`>`table r`.`sensitivity*10`) 

union 

(select  `table r`.* from `table r`, `table l` 
where `table r`. `sensitivity*10` > 10 and `table r`.`sensitivity*10`>`table l`.`sensitivity*10`)
"
5338,46281,SQL Delete Duplicates with greater difference between two columns,"with todelete as (
      select t.*,
             row_number() over (partition by id order by value2 - value1) as diff_seqnum
      from table t
     )
delete from todelete
    where diff_seqnum > 1;
"
10697,30335,sqlite order by random groups,"WITH albums AS (SELECT DISTINCT album FROM songs ORDER BY RANDOM()) 
SELECT songs.* FROM albums
LEFT JOIN songs
ON songs.album = albums.album
ORDER BY albums.rowid, songs.track
"
26787,41761,Round up the DateTime to next Day in T-SQL?,"SELECT DATEADD(Day, DATEDIFF(Day, 0, SYSDATETIME()), 1)
"
7746,13069,Create database and add to Visual Studio solution,"AttachDbFileName=|DataDirectory|\YourDB.mdf;Initial Catalog=YourDB;Integrated Security=SSPI
"
5042,10970,Finding a Identity Specification using SQL,"select o.name, c.name, c.is_identity
from sys.objects o
inner join sys.columns c on o.object_id = c.object_id
where o.type='U'
--and o.name='MyTable'
and c.is_identity = 1
"
5374,7863,How to write the select query to calculating difference of 2 timestamp fields in oracle 10g based on condition," select nvl(date_of_notification, systimestamp) - date_of_loss from the_table;
"
28434,56728,SELECT statement that only shows rows where there is a NULL in a specific column,"SELECT 
    CareTakerName, ArtName, ArtType
FROM 
    CareTakers 
LEFT JOIN 
    Donations ON CareTakers.CareTakerID = Donations.CareTakerID
WHERE 
    NULLIF(Donations.CareTakerID,'') IS NULL
UNION    -- Returns a stacked result set
SELECT 
    CareTakerName, ArtName, ArtType
FROM 
    CareTakers 
RIGHT JOIN 
    Donations ON CareTakers.CareTakerID = Donations.CareTakerID
WHERE 
    NULLIF(CareTakers.CareTakerID,'') IS NULL
"
14988,1979,How to select SQL Server row values as columns (Dynamic Pivot),"CREATE TABLE #VALS (
    VALS NVARCHAR(4000)
)

INSERT INTO #VALS
SELECT DISTINCT RGUID
FROM [TABLE]

DECLARE @SQL NVARCHAR(MAX)
DECLARE @VALS NVARCHAR(4000)

SELECT @VALS = COALESCE(@VALS+', ','') + '[' + VALS + ']' FROM #VALS

SET @SQL = '
SELECT SGUID, '+@VALS+'
FROM [TABLE]
PIVOT(MAX(VAL) FOR RGUID IN ('+@VALS+')) PIV'
PRINT @SQL
EXEC (@SQL)
"
13754,19563,Associating Records Together,"select 
  datecreated, 
  servername,
  (
    select min(running.datecreated)
    from mytable running
    where running.heading = 'SQL Server running'
    and running.servername = notrunning.servername
    and running.datecreated > notrunning.datecreated
  ) as connected
from mytable notrunning
where heading = 'SQL Server status: Unable To Connect';
"
28242,39185,Merging two rows into one,"SELECT LEAST(user1, user2), GREATEST(user1, user2), SUM(count) AS count
FROM yourtable
GROUP BY LEAST(user1, user2), GREATEST(user1, user2)
"
19927,7940,Querying multiple tables and displaying the outcome wtih SQL and Access,"SELECT CustomerAccountDetails.custFullName, CustomerAccountDetails.custAddress, StockDescription.stockName
FROM StockDescription 
    INNER JOIN ((CustomerAccountDetails 
    INNER JOIN CustomerTransaction ON CustomerAccountDetails.ID = CustomerTransaction.custID) 
    INNER JOIN TransactionDetails ON CustomerTransaction.ID = TransactionDetails.custTransID) ON StockDescription.ID = TransactionDetails.StockID
WHERE StockDescription.stockName=""something""
"
32374,43354,Multiple Many-to-many bi-directional self-inner-joins without repeating whole query,"CREATE VIEW bidirec_item_assoc AS
(
SELECT item_id, other_item_id, assoc_type, 1 as direction FROM item_assoc
UNION
SELECT other_item_id, item_id, assoc_type, 2 as direction FROM item_assoc
)
"
29049,782,Cross records between tables,"select pa.id,pa.name 
from patients pa 
where NOT EXISTS
(
   select 1 FROM doctors do
   where NOT EXISTS
   (
      SELECT 1 FROM consults co
      WHERE co.doctorID=do.id
      AND pa.id=co.patientID
   )
)
"
11497,5661,fetch Single column from two table,"SELECT  a.Price
FROM    SalesReturnDetails a
        INNER JOIN 
        (
            SELECT  DISTINCT Bill_number
            FROM    SalesReturn
            WHERE   Session='12-13'
        ) b ON a.Bill_number = b.Bill_number
"
2956,49456,Converting number to date in oracle,"select to_date('1800/12/28','yyyy/mm/dd') + 77650 from dual
"
26339,43501,Inserting a BLOB data into object type - Oracle,"declare
  i infos;
  b blob;
begin
  insert 
    into client 
    values(1, INFOS('John', EMPTY_BLOB()))
    returning informations into i;
  b := i.picture;
  -- You can use b here
end;
"
26950,46386,How do I efficiently inverse a many-to-many SQL query?,"SELECT M.* FROM M  
WHERE NOT EXISTS
 (SELECT * FROM ManyToManyTable MMT
           WHERE MMT.M = M.Id AND N=@Id )
"
27681,33952,Looking for SQL request,"select data from tableName  where id in (select MAX(id) from tableName group by key)
"
2292,57611,Limit results per column value,"select category, subcategory, `count`
from (
    select *, 
         ( 
            case category 
            when @curCategory 
            then @curRow := @curRow + 1 
            else @curRow := 1 AND @curCategory := category end
          ) + 1 AS rank
    from yourtable cross join (select @curRow:=0, @curCategory:='') c
    order by category, `count` desc
) t
where rank <= 100
"
33979,20772,"Joining sales, product and referrer data using sql","Select 
    sum(purchases.price) as totalAmount, 
    count(purchases.id) as totalCount,
    referrer.url
from Purchases
join Referrer 
    on referrer.url = purchases.url
Group by referrer.url
"
28312,32253,"Oracle query select statement - count, sum, order by, group by","SELECT gla.account_description, count(*), sum(ili.line_item_amount)
FROM   general_ledger_accounts gla
INNER JOIN invoice_line_items ili ON ili.account_number = gla.account_number
GROUP BY gla.account_description
HAVING count(*) > 1
ORDER BY SUM(ili.line_item_amount) DESC
"
25453,17349,Find duplicate records in exist database table,"select col1. col2
from your_table
group by col1, col2
having count(*) > 1
"
32131,19924,Informix prevent duplicate result,"SELECT DISTINCT col1, col2, col3, col4, col5 FROM table
"
28581,66445,Calculating distances between two tables full of GEOGRAPHY points,"select
  t1.*,
  t2.*,
  t1.GeoLoc.STDistance(t2.GeoLoc) as DistanceApart
from table1 t1
join table2 t2
on (t1.GeoLoc.STDistance(t2.GeoLoc) <= @distanceX)
"
31845,42941,MySQL: Incorrect query or bad structuring of the database?,"select 
  m.nom_movie 
FROM 
  movies 
inner join
  movie_genre mg
on
  m.id_movie=mg.id_movie 
inner join 
  genres g 
on 
  mg.id_genre=g.id_genre 
where 
  g.nom_genre = 'action';
"
34214,34496,SQL Transpose/Pivot/Unpivot,"SELECT [key], [tag]
FROM tblName
UNPIVOT ([tag] FOR [vals] IN ([tag1], [tag2], [tag3], [tag4])) A
"
19009,44942,get 2 days ago query in mysql,"WHERE timestamp BETWEEN 
        DATE_SUB(DATE(NOW()), INTERVAL 2 DAY)
         AND DATE_SUB(DATE(NOW()), INTERVAL 1 DAY) 
"
33819,49438,"MySQL SELECT DISTINCT multiple columns, with the first result on some cols","SELECT a,b FROM my_table GROUP BY a
"
24642,69762,SQL Multiple CASE statements return 0 instead of NULL,"SELECT     

     ISNULL(SUM(CASE WHEN Type = 1 THEN Amount ELSE Amount * - 1 END),0) AS Balance
FROM         dbo.MemberFinancials AS MF INNER JOIN
                      dbo.Members AS M ON MF.MemberID = M.MemberID AND DATEPART(yyyy, MF.Date) = M.MemberCurrentYear INNER JOIN
                      dbo.FinancialTypes AS FT ON MF.FinancialTypeID = FT.FinancialTypeID
"
25106,4054,How do you force mysql LIKE to be case sensitive?,"mysql> SELECT 'abc' LIKE 'ABC';
    -> 1
mysql> SELECT 'abc' LIKE BINARY 'ABC';
    -> 0
"
22313,4260,array to Zend_Db_Table_Row zend framework,"$data = array(
        'table'   => $yourDbTableModel,
        'data'     => $yourArray,
        'readOnly' => $iGuessShouldBeZero,
        'stored'  => true
    );
$row = new Zend_Db_Table_Row($data);
"
23105,54916,How do I Alter an attribute to change its datatype in Object type?,"ALTER TYPE MY_TYPE
  MODIFY ATTRIBUTE SOME_ATTRIBUTE NUMBER;
"
32032,25895,How to Optimize a Query With GROUP BY and ORDER BY,"  SELECT u.*, p1.* FROM
  users u 
  INNER JOIN 
  (
      SELECT p.user_id, p.created_at, p.id FROM posts p 
      WHERE  p.type IN ('post', 'page', 'file')  GROUP by p.user_id 
      ORDER BY p.created_at DESC LIMIT 30
  )xxx ON xxx.user_id = u.id
   INNER JOIN posts p1 ON (p1.id = xxx.id)
"
22054,51018,SQL STR() function equality,"select 1 from tblMessage where '210' = STR(210,3)
"
5287,50790,sql join two tables with same header,"INSERT INTO table1
SELECT * FROM table2
"
30191,39927,"How to compare a double value to a decimal from database and if they are alike, then return true","SELECT ROUND(myValue, 5) 
FROM myTable
"
36431,34041,Query for rows with specific string or null,"select t.*
from t2 t
where (t.value = 'apple' or t.value is null)
  and not exists (select 1 
                  from t2 x
                  where x.t1_id = t.t1_id
                    and x.value <> 'apple')
order by t.id;
"
17605,3445,Make SQL query from four table,"SELECT u.username as user, i.image as user_image, count(*) as comments
FROM users u              
INNER JOIN user_follow f ON u.id = f.follow_id
INNER JOIN images p ON p.user_id = u.id
INNER JOIN commentaries c ON c.image_id = p.id
WHERE u.user_id = 3
GROUP BY u.username, i.image;
"
22149,23120,How can I combine a union query with a max query?,"SELECT A.*, B.MaxOfSubDate, B.MaxOfOurRev, B.MaxOfClientRev
FROM A
LEFT OUTER JOIN B On A.[0/DocID] = B.DocID
"
20779,71799,Why won't this simple SQL statement work?,"WHERE dateposted BETWEEN DATE_ADD(NOW(), INTERVAL -7 DAY) AND NOW()
"
22434,64897,How do I join multiple records into a single record in SQL?,"SELECT ID,
       MAX(CASE WHEN Position = 1 THEN Email ELSE '' END) AS primary_email,
       MAX(CASE WHEN Position = 2 THEN Email ELSE '' END) AS Secondary_email
FROM YourTable
GROUP BY ID;
"
28085,13630,Complex MYSQL select,"SELECT tags.tag_name, news_tags.tag_id, COUNT(*) as count 
FROM    news_tags 
        LEFT JOIN tags 
            ON tags.tag_id = news_tags.tag_id 
        LEFT JOIN news
            ON news.id = news_tags.news_id
WHERE   news.status = 1
GROUP BY news_tags.tag_id 
ORDER BY count DESC
"
11679,42391,Eliminating duplicate values based on only one column of the table,"SELECT s.siteName, s.siteIP, h.date
FROM sites s INNER JOIN
     (select h.*, row_number() over (partition by siteName order by date desc) as seqnum
      from history h
     ) h
    ON s.siteName = h.siteName and seqnum = 1
ORDER BY s.siteName, h.date
"
28332,9948,How do I search two columns?,"SELECT first_name, last_name, number
FROM your_phone_book
WHERE first_name LIKE '%kar%'
   OR last_name LIKE  '%kar%'
"
30585,46538,how to compare two table in same database in mysql?,"    select t1.* from table1 t1
    left join table2 t2 on 
        substring_index(t2.path, '/', -1) =  substring_index(t1.path, '/', -1) 
        and t2.frn = t1.frn 
        and t2.byte = t1.byte
    where t2.path is null or t2.frn is null or t2.byte is null
"
10886,39034,SQL advanced filtering,"SELECT *
FROM route_location AS rl
WHERE EXISTS
 ( SELECT * 
   FROM route_location AS rl2
   WHERE rl.routeID = rl2.routeID -- on the same route
     AND rl.orderID < rl2.orderID -- any previous order
     AND rl2.locationID = 11      -- had a locationID of 11
 )
"
35251,54475,Select all and give random output (Random sorted output),"ORDER BY
    CASE WHEN City <> '0' THEN 1 ELSE 2 END,
    NEWID()
"
4124,66345,"SELECT with LIMIT, OFFSET and WHERE conditions","select *
from item i
inner join item_type itp on itp.tp_item = i.tp_item
order by id_item
offset 0
limit 10;
"
12719,68715,SQL Count with a Join,"  select product_name,
         count(product_order.product_id)
    From product left join product_order
      on product.product_id = product_order.product_id
group by product_name
"
16833,5953,Assign ID to each row in Microsoft sql server view,"create view myview as 
   select rank() OVER (ORDER BY Myname) as ID, MyTable.Myname 
   from MyTable ;
"
39046,12493,"How To SUM, GROUP and SPLIT data in MYSQL Database Based on Dates","select date_format(date_paid, '%Y-%m') date_paid,
  sum(case when category_type = 'Income' then amount_paid end) IncomePaid,
  sum(case when category_type = 'Expense' then amount_paid end) ExpensePaid
from accounting 
group by date_format(date_paid, '%Y-%m')
"
9972,25768,SQL n:m relation,"SELECT 
    s.id  AS studio_id, 
    e.id  AS equipment_id, 
    se.id AS studio_equipment_id
FROM 
     studios AS s
  CROSS JOIN 
     equipment AS e
  LEFT JOIN 
     studio_equipment AS se 
       ON  se.studio_id = s.id
       AND se.equipment_id = e.id ;
"
31204,15387,How to create a stored procedure within another stored procedure in SQL Server 2008,"CREATE procedure parentSP
as 
exec('CREATE procedure childSP1 @inputArg varchar(50)
as 
--do something.')

--call child sp within parentSP
execute childSP1 '10'
Go
"
28800,58037,SQL - just view the description for explanation,"SELECT Marks FROM Report WHERE Marks LIKE '%009%' OR '%090%' OR '%900%'
"
33376,8470,how to get sum of column value with inner join in one query?,"SELECT
    m.medianame,
    COUNT(as.advId) as Total
FROM    a_mediatype as m
INNER JOIN a_advertise as a ON a.mediaTypeId = m.mediaTypeId
INNER JOIN  a_ad_display as ad ON ad.advId = a.advertiseId
GROUP BY m.mediaTypeId
"
25894,14810,SQL: group employees inside a row,"SELECT p.project_name, 
       group_concat(concat(e.first_name, "" "", e.last_name)) as employee_name
FROM project p
INNER JOIN employee e on e.project_id = p.id
GROUP BY p.project_name
ORDER by p.project_name
"
15370,40110,removing duplicates record from a populated field,"-- create temp table with numbers
    ;WITH r AS (
        SELECT 1 AS n
        UNION ALL
        SELECT n+1 FROM r WHERE n+1<=10000
    )
    SELECT n, ROW_NUMBER() OVER( ORDER BY NEWID()) random INTO #tempnums FROM r
    OPTION (Maxrecursion 0)

-- update 

    UPDATE x SET ALTATH=t.random
    FROM (SELECT *, ROW_NUMBER() OVER(ORDER BY ALTATH) rown FROM APRFIL) x 
    JOIN #tempnums t ON t.n=x.rown
"
10400,36603,Summary of a day or run a query and sum the results?,"select EmpId, sum(Amount) as Amount, DateOfProduction 
from ProductionTable
group by EmpId, DateOfProduction.
"
24190,54788,Select Single field multiple times with multiple criteria,"SELECT Project
    ,sum(CASE WHEN Activity = 'Shearing' THEN [Surface Area] ELSE 0 END) AS TotalShearing 
    ,sum(CASE WHEN Activity = 'Bending' THEN [Surface Area] ELSE 0 END) AS TotalBending
    ,sum(CASE WHEN Activity = 'Assembly' THEN [Surface Area] ELSE 0 END) AS TotalAssembly
    ,sum(CASE WHEN Activity = 'PC' THEN [Surface Area] ELSE 0 END) AS TotalPC
    ,sum(CASE WHEN Activity = 'Infill' THEN [Surface Area] ELSE 0 END) AS TotalInfill
WHERE ([Posting Date] BETWEEN @StartDate AND @EndDate)
FROM PLE
GROUP BY Project
"
36744,7603,How to group different columns and return only the first that was found,"WITH CTE AS
(
    SELECT Email,   IP,   Country
         , RN = ROW_NUMBER() OVER (PARTITION BY Email ORDER BY Email)
    FROM dbo.Emails
)
SELECT Email,   IP,   Country
FROM CTE
WHERE RN = 1
"
9993,69794,Oracle Object Type Constructor Called Multiple Times,"create or replace type FooTable as table of Foo;  

SELECT x.bar1 AS bar1, x.bar2 AS bar2, x.bar3 AS bar3, value(x) f   
    FROM table(FooTable(   
      foo(p_Bar1 => 1, p_Bar2 => 2, p_Bar3 => 3)   
    )) x   
    WHERE x.bar1 = x.bar1 AND x.bar2 = x.bar2  
;  

BAR1 BAR2 BAR2 F  
1    2    3    (1, 2, 3)  

Foo Constructor Called 
"
6824,59869,Checking if date if formatted properly and ignoring if there are spaces before or after date,"create or replace function String2Date(str in vahrchar2) as integer is
   d DATE;
begin
   if REGEXP_LIKE(TRIM(str), '^\d{2}/\d{2}/\d{4}$') then
      d := TO_DATE(str, 'DD/MM/YYYY');
      return 1;
   else
      return 0;
   end if;
exception
   when others then
       return 0;
end;
"
39804,2242,Postgres select all columns but group by one column,"select unit_id, time, diag
from (
    select unit_id, time, diag,
           rank() over (partition by unit_id order by time desc) as rank
    from diagnostics.unit_diag_history
) as dt
where rank = 1
"
11513,22919,Join 2 tables SQL query,"select t2.*
from Table_2 t2 join Table_1 t1 on t2.table_1_id = t1.id
where t1.status = 1
and date(t2.`time`) = date(now() - interval 1 day);
"
28262,60989,Select top 5 biggest values - Oracle,"SELECT * FROM
    (SELECT ADDITIONAL_INFO FROM your_table
     ORDER BY to_number(ADDITIONAL_INFO) DESC) r
WHERE rownum <= 5
"
13484,48069,SQL get differences in one column by ID,"SELECT id  
FROM mytable
GROUP BY id
HAVING MIN(name) <> MAX(name)
"
1213,51348,SQL how to update left joined tables?," UPDATE alldistros SET name=""CatMan"" WHERE name = ""Absolute Linux""
"
14596,37341,How to fill `[Order]` column by order number in SQL Server?,"WITH CTE AS
(
   SELECT Id, Title, [Order] 
   , OrderNumber = ROW_NUMBER() OVER (ORDER BY Date)
   FROM Tbl 
)
UPDATE CTE SET [Order] = CTE.OrderNumber;
"
3501,6429,Import sparse matrix from .csv directly into graph using neo4j and cypher,"LOAD CSV FROM 'file:///dummy.csv' AS line
MERGE (a:node {name:line[0]})
MERGE (b:node {name:line[1]})
MERGE (a)-[:connects]->(b);
"
6752,73541,"Instead of independently joining multiple tables, use separate queries?","SELECT
  collections.collectionid as collectionid,
  photos.name as photo_name,
  'photo' as document_type
FROM collections
  LEFT JOIN photos on collections.collectionid = photos.collectionid
WHERE collections.collectionid = 14
UNION ALL
SELECT
  collections.collectionid as collectionid,
  song.name as photo_name
  'song' as document_type
FROM collections
  LEFT JOIN songs on collections.collectionid = songs.collectionid
WHERE collections.collectionid = 14
"
24319,5719,Find most recent distinct records and sort by created_at in Postgresql,"select *
from (
    select distinct on (conversation_id) *
    from messages
    order by conversation_id, id desc
) t
order by id desc
"
11785,46162,recreating whole SQL Server Database with relations,"SELECT 'alter table '+s.name+'.'+t.name+
' alter column '+c.name+' nvarchar('+convert(varchar(11),c.max_length/2)+') go'
FROM    sys.tables as T
inner join sys.schemas as s
on T.[schema_id]=s.[schema_id]
inner join sys.columns as C
on T.[object_id]=C.[object_id]
and c.system_type_id=239--nchar type
"
38155,32603,Use max column value in order by,"SELECT addr
  FROM servers
  ORDER BY (0.3 * uptime) +
           (0.7 * (votes / (SELECT MAX(votes) FROM servers))) DESC
"
1008,27208,SQL find similar rows without having all combination,"select distinct 
  t1.code, t1.id, t1.description, t2.id, t2.description
from 
  data t1, data t2  
where 
  t1.code = t2.code and t1.id < t2.id
order by t1.code
"
36679,1790,Searching for records based on time range using SQL,"where cast(ORDERDATE as time) between '16:30' and '17:00'
"
31635,74709,Use a formula on SQL Server column values and store it in new column,"    select 
    Count(*) as ResponseCount,
    PropertyValue As Answer ,
 convert ( dec(28,2) ,Count(*))*100/(sum(count(*)) over ()) as ResponsePercentage
from 
    table 
where 
    Questionid = 42 and formid = 1 
group by 
    propertyvalue
"
17660,26451,Can queries on views be fully tested?,"select
  c.STRING,
  a.STRING,
  b.STRING,
  b.STRING3,
  a.STRING2
from TABLE_A a,
  (select 'blah' string, 123 INT from dual) b,
  TABLE_C c
where b.STRING2 = a.STRING2
  and a.INT = #value#
  and c.INT = a.INT
  and c.STRING IN ('string1', 'string2')
"
14022,46037,Write Reserved Keywords into a file in Windows batch file,"echo.If @intA ^<^> @intB> ""C:\output_file.txt""
"
6510,47983,generic Mysql stored procedure,"CREATE PROCEDURE `get`(IN tb VARCHAR(50), IN id INTEGER)
BEGIN
    PREPARE stmt1 FROM CONCAT('SELECT * FROM ', tb, ' WHERE Indx = id');
    EXECUTE stmt1;
    DEALLOCATE PREPARE stmt1;
END//
"
33779,15014,Using prepared statement without ROW_NUMBER() and OVER() functions in Db2,"select id, version, creator, created_date 
from (
    select id, version, creator, created_date 
        from T_SWA
        where id = 35
        order by created_date desc
        fetch first 3 rows only
)
order by created_date
fetch first 1 row only;
"
28168,18680,Scalar Valued function - output table,"select name1, name2, similarity
from (select p1.name as name1, p2.name as name2,
             mdq.Similarity(p1.name, p2.name, 0, 0.0, 0.0) as similarity
      from #person p1 cross join
           #person p2
     ) pp
where similarity > @SimilarityLimit  -- perhaps 0
order by similarity;
"
31940,69034,Pivot the results of a stored procedure?,"CREATE TABLE #t (ID int, Name varchar(100), Address varchar(100))

INSERT INTO #t
EXEC stored_proc

SELECT ID = 'Name', [1] = Name
FROM #t
UNION ALL
SELECT ID = 'Address', [1] = Address
FROM #t

DROP TABLE #t
"
19824,189,Return first of each ID in query,"select  *
from    players p1
where   p1.id =
        (
        select  id
        from    players p2
        where   p2.playerId = p1.playerId
        order by
                date desc
        limit   1
        )
"
7684,19807,Does DBIx::Class do unions?,"my $rs1 = $rs->search({ foo => 'bar' });  
my $rs2 = $rs->search({ baz => 'biff' });  
for ($rs1->union($rs2)->all) { ... }
"
232,63342,How to use login info from one site to log in to another on a different server,"action=""Enter site name here.com""
"
22903,50501,Assign var for SQL-Statement with smarty (Prestashop),"{$sql = 'SELECT value FROM ps_feature_value_lang WHERE id_feature_value = 29 AND id_lang = '|cat:$id_lang}
"
19311,3567,MySQL multi-table query,"EXPLAIN SELECT
    dp.disp_id AS dispId, dp.name AS dispName, dp.address1 AS dispAddress1, dp.zip AS dispZip, zc.state AS zipState, zc.county AS zipCounty, zc.city AS zipCity, zc.zip_code AS zipCode
FROM
    disp_profile dp
INNER JOIN
    zipcodes zc
ON
    dp.zip = zc.zip_code
WHERE
    dp.state = 'CA'
"
202,29766,Two foreign keys in parent table reference same child table. How to structure INNER JOIN?,"select  a.pk_fight_num,
        b.fighter_name firstFighter, -- <<== needed also
        c.fighter_name secondFighter -- <<== needed also
from    matches a
        inner join fighters b 
            on a.fk_fighter_id1 = b.pk_fighter_id
        inner join fighters c 
            on a.fk_fighter_id2 = c.pk_fighter_id;
"
26642,14668,Hoax LIMIT value,"LIMIT 0, 18446744073709551615
"
13491,64846,Problems using GROUP BY and ORDER BY in SQL Oracle,"SELECT manager_id AS ""Manager ID"",
MIN(salary) AS ""Lowest Paid Salary""
FROM employees
WHERE manager_id IS NOT NULL
AND salary > 6000 
GROUP BY manager_id
ORDER BY min(salary) DESC;
"
17643,45027,What is the prefered way to query multiple tables in android,"select module_title, module_credit from modules m, module_tutor mt 
where mt.module_id=m.id and mt.tutori_id=?
"
33828,5601,How to set lower bound for random values in SQL,"Insert into Tax  (id, amount) 
VALUES (i+1, ROUND(RAND() * 980,2) + 20 );
"
23371,41750,SQL help to insert into daily sale table from slaes table plus associated dimensions,"INSERT INTO DAILYSALE
(RECEIPTNO, TERMINALID, MERCHANTID, BANKACC, PHONE)
SELECT s.RECEIPTNO, s.TERMINALID, p.MERCHANTID, m.BANKACC, m.PHONE
FROM SALE s
INNER JOIN POSID p ON s.TERMINALID = p.TERMINALID
INNER JOIN MERCHANT m ON p.MERCHANTID = m.MERCHANTID   
"
29680,35443,Rows to columns SQL Server query,"SELECT 
    SN,
    MAX(CASE WHEN Mindex=1 THEN MA END) AS mi1,
    MAX(CASE WHEN Mindex=2 THEN MA END) AS mi2,
    MAX(CASE WHEN Mindex=3 THEN MA END) AS mi3
FROM MAS
GROUP BY SN     
"
28022,7979,Show record value as a column,"SELECT y as Date,
SUM(CASE WHEN Z='A' THEN X ELSE 0 END) as A,
SUM(CASE WHEN Z='B' THEN X ELSE 0 END) as B,
SUM(CASE WHEN Z='C' THEN X ELSE 0 END) as C,
SUM(CASE WHEN Z='D' THEN X ELSE 0 END) as D
FROM table
GROUP BY y
"
24766,20468,T-SQL | Counts and ranks,"SELECT *
      ,RowNum = DENSE_RANK() OVER(ORDER BY KC1,KC2,KC3)
      ,OnCNT = SUM(CASE WHEN IsON = 1 THEN 1 END) OVER(PARTITION BY KC1,KC2,KC3)
      ,OffCNT = COALESCE(SUM(CASE WHEN IsON = 0 THEN 1 END) OVER(PARTITION BY KC1,KC2,KC3),0)
FROM  #TempTBL
"
6900,43140,How to call the second row in an Active record table,"@auth_token, @auth2_token, @auth3_token = Session.limit(3).map(&:token)
"
10343,38786,Oracle Apex get first part of Postcode,"with t as (
  select 'L10 1TY' as postcode from dual
  union all select 'WF2 5TG' from dual
  union all select 'W7 5RR' from dual
)
select postcode, regexp_substr(postcode, '^[[:alpha:]]+', 1, 1) as region
from t;

POSTCODE REGION 
-------- -------
L10 1TY  L       
WF2 5TG  WF      
W7 5RR   W       
"
28197,63083,How to insert a record and make sure the entire row is unique,"INSERT INTO myCities (UserID,CityID) 
SELECT @UserID,@CityID
        WHERE NOT EXISTS ( 
                   SELECT UserID FROM myCities 
                   WHERE 
                   UserID = @UserID and 
                   CityID = @CityID
                 )
"
9046,11535,NHibernate LINQ BIGINT casting,"protected HqlTreeNode VisitNhMax(NhMaxExpression expression)
{
    return _hqlTreeBuilder.Cast(
        _hqlTreeBuilder.Max(
            VisitExpression(expression.Expression).AsExpression()), 
            expression.Type);
}
"
24820,62001,SQL Server: How do I maintain data integrity using aggregate functions with group by?,"WITH A AS (
    SELECT Customer_Summary, customer_name, customer_address, customer_postal_code,
        ROW_NUMBER() OVER (PARTITION BY Customer_Summary ORDER BY customer_name, customer_address) AS rn
    FROM Order
)
SELECT Customer_Summary, customer_name, customer_address, customer_postal_code
FROM A
WHERE rn = 1
"
34556,68423,Delete data from Access on DGV,"If dgvMarkers.SelectedRows.Count > 0 Then
    Dim ids As New List(Of String)
    For Each r As DataGridViewRow In dgvMarkers.SelectedRows
        ids.Add(r.Cells(""ID"").Value.ToString)
    Next
    'can use ids directly instead of ids.ToArray() in .NET 4 or above
    Dim query = ""DELETE FROM tblMarkers WHERE ID IN ("" & String.Join("","", ids.ToArray()) & "")""
End If
"
20693,21370,MySQL - SUM of rows excluding duplicates in descending order,"select user_id, sum(amount)
from (select user_id, ip_address, amount
      from  tab 
      group by  ip_address, amount ) A
group by  user_id
order by  user_id desc
"
1752,3848,SQL SELECT with a Yes/No column to state whether Customer has associated Orders,"SELECT  a.ID, a.FirstName, a.Lastname,
        CASE WHEN COUNT(b.CustID) > 0 THEN 'YES' ELSE 'NO' END AS HasOrders
FROM    Customer a
        LEFT JOIN Orders b
            ON a.ID = b.CustID        -- <<== the linking column on both tables
GROUP   BY a.ID, a.FirstName, a.Lastname
"
21604,75295,SQL Update Statement," UPDATE Products p
 INNER JOIN [Shopping Cart] s
 ON p.[Product Name] = s.[Product Name]
 SET p.ProductQty = p.ProductQty - s.ProductQty
"
21044,16606,Mysql query deducting 2 counts result less 0,"GREATEST((countresult1-countresult2), 0) AS restresult
"
4441,39628,Split row into Multiple Rows in stored procedure in sql server 2008,"select 1 as hrs, 4 as end , name, 1 as class from theTable WHERE class=3
UNION
select 4  as hrs, 8 as end, name, 2 as class from theTable WHERE class=3
"
32728,54161,JOIN and LEFT JOIN equivalent in LINQ,"var query = (from a in context.Appointment
join b in context.AppointmentFormula on a.AppointmentId equals b.AppointmentId into temp
from c in temp.DefaultIfEmpty()
join d in context.AppointmentForm on a.AppointmentID equals e.AppointmentID into temp2
from e in temp2.DefaultIfEmpty()
where a.RowStatus == 1 && c.RowStatus == 1 && a.Type == 1
select new {a.AppointmentId, a.Status, a.Type, a.Title, c.Days ?? 0, a.Type.Description, e.FormID ?? 0}).OrderBy(a.Type);
"
16179,21699,Oracle insert script with condition,"WHENEVER SQLERROR EXIT SQL.SQLCODE
"
30786,65852,how to get the difference between to columns in sql,"select sum(case when trancode = 'sales' then -prodqty else prodqty end)
from stock
where barcode = ?
"
12695,31340,Derby's handling of NULL values,"insert into T_AUTHOR (
  ID, FIRST_NAME, LAST_NAME, 
  DATE_OF_BIRTH, YEAR_OF_BIRTH, ADDRESS) 
VALUES ( 
  1000, 'Lukas', 'Eder', 
  '1981-07-10', null, null 
);
"
35779,49173,SQL Add column to normalize time of different Oil Wells,"Select 
    *,
    (Select Count(*) From YourTable As T 
    Where T.well_name = W.well_name And T.rpt_date <= W.rpt_date) As [Normalized Time]
From
    YourTable As W
Order By
    well_name,
    rpt_date
"
3128,35702,convert row to column using Pivot without any clause,"select UserId, max(starttime) as starttime, max(endtime) as endtime
from (
  select UserId,
    case when StartOrEnd = 'S' then time end as starttime,
    case when StartOrEnd = 'E' then time end as endtime,
    row_number() over (partition by UserID order by time asc) 
      + case when StartOrEnd = 'S' then 1 else 0 end as GRP
  from table1
) X
group by UserId, GRP
order by starttime
"
3403,50610,Getting average from 3 columns in SQL Server,"SELECT (ratin1 + ratin2 + ratin3) / 
((CASE WHEN ratin1 = 0 THEN 0 ELSE 1 END) + 
(CASE WHEN ratin2 = 0 THEN 0 ELSE 1 END) + 
(CASE WHEN ratin3 = 0 THEN 0 ELSE 1 END) +
(CASE WHEN ratin1 = 0 AND ratin2 = 0 AND ratin3 = 0 THEN 1 ELSE 0 END) AS Average
"
36723,11752,How to optimize an SQL query with many thousands of WHERE clauses,"SELECT doc_text.doc_id, doc_text.language, doc_text.author, doc_text.title, doc_ref.ref_id, ref_master.location_id, location.location_display_name, doc_index.doc_id, doc_index.display_heading
FROM DOC_TEXT, DOC_REF, REF_MASTER, LOCATION, DOC_INDEX
WHERE
    doc_text.language='fr' OR doc_text.language='es'
AND
    doc_text.doc_id=doc_ref.doc_id
AND
    doc_ref.doc_id=ref_master.ref_id
AND
    ref_master.location_id=location.location_id
AND
    doc_text.doc_id=doc_index.doc_id
"
14301,18813,TSQL - Cast string to integer or return default value,"DECLARE @text AS NVARCHAR(10)

SET @text = '100'
SELECT CASE WHEN ISNUMERIC(@text) = 1 THEN CAST(@text AS INT) ELSE NULL END
-- returns 100

SET @text = 'XXX'
SELECT CASE WHEN ISNUMERIC(@text) = 1 THEN CAST(@text AS INT) ELSE NULL END
-- returns NULL
"
33139,20797,SQL query count elements in other table,"SELECT 
       P.*
     , cnt = ISNULL(M.cnt, 0)
FROM dbo.Projects P
LEFT JOIN (
     SELECT ProID, cnt = COUNT(1) 
     FROM dbo.Milestones
     GROUP BY ProID
) M ON M.ProID = P.ProID
"
36834,69019,SQL cast a string value,"Select LEFT(ColumnName,CHARINDEX('h',ColumnName) - 1)
"
26868,22689,Django Query or SQL,"import json
from django.core.serializers.json import DjangoJSONEncoder
json_data = json.dumps(list(Post.objects.values('author__user__username', 'text')[:10]), cls=DjangoJSONEncoder)
"
12440,57551,Controlling schema created by Database.Persist,"share [mkPersist sqlSettings, mkMigrate ""migrateAll""] [persistLowerCase|
    Something
        b           ByteString
        t           Text         maxlen=30
|]
"
37707,69374,oracle How do I remove blank characters in column names? (or limit them?),"column order_id format a8 
column customer_address format a15 
"
23994,5761,how to do a retrieve user posts from this database design?,"SELECT 
      u.userName, 
      p.Text
FROM 
      UserPosts up 
INNER JOIN
      Users u 
ON  
      u.userID = up.userID
INNER JOIN 
      Posts p ON p.postID = up.postID
"
31790,21327,Mysql: How do I subtract a percentage from a number,"SELECT amount - (amount * discount_percentage / 100)
FROM tableA;
"
9850,39774,How to delete duplicate rows in SQL Server with condition?,";WITH ToDelete AS (
  SELECT Id, GroupId, StdId, Active,
         ROW_NUMBER() OVER (PARTITION BY GroupId, StdId
                            ORDER BY Active Desc, Id) AS rn
  FROM mytable 
)
DELETE FROM ToDelete
WHERE (rn > 1) OR (rn =1 AND Active = 0)
"
39641,4401,check missing values across two tables,"select i.*
from items as i
where
    not exists
    (
         select * 
         from categories as c
         where c.item_id = i.item_id and c.cat_id <> 0
    )
"
30225,53630,Zero Fill Data for Missing Dates,"select c.cust, w.week, coalesce(t.sales, 0) as sales
from weeks w cross join
     (select distinct cust from t) c left join
     t
     on t.cust = c.cust and t.week = w.week;
"
4318,9986,Return New DateTime From SQL Server SELECT DateTime,"Select CAST( CONVERT(VARCHAR(10), GETDATE(), 120) + ' ' +
          CONVERT(VARCHAR(8), TargetDate, 108) AS DATETIME) AS [SomeCalculatedField]
from TableName
"
23225,62768,query last value,"select top 1 
       l.klantId, bh.rechten, kg.voornaam, kg.achternaam, kg.woonplaats, kg.telefoonnr, og.klantbericht, s.klantstatus 
from login l 
inner join klantGegevens kg on l.klantId=kg.klantid 
inner join bevoegdheden bh on l.rechten=bh.id 
inner join orderGegevens og on og.loginNr=l.klantid 
inner join status s on s.id=og.klantstatus 
where l.klantid=1 
order by ordernr desc
"
13,44030,Join 3 tables with query sql,"SELECT      D.Id,C.Country,COUNT(CU.Id) [number of creation]
FROM        Country C CROSS JOIN [Date] D
LEFT JOIN   customer CU on D.Dates.Id = CU.Date_Creation_Id And C.Country.Id = CU.Country_Id 
GROUP BY    D.Id,C.Country
ORDER BY    D.Id,C.Id
"
39541,74040,Group and values from table,"select distinct 
    Col1,
    (
     select STUFF((select ',' + col2 
     from yourtable b 
     where b.col1 = a.col1 for xml path('')),1,1,'')
     ) as Col2
from yourtable a
"
24501,66991,Is it possible to run stored procedure to set value in update statement - TSQL,"UPDATE [TelephoneNumberManagement].[dbo].[Number]
SET [CategoryID] = goldennumbers2([Number]);
"
25752,63363,SQL query - dealing with Null Value,"SELECT Name,  ISNULL(Amount,0), ISNULL(Paid,0) as Paid
FROM   Table_1  
WHERE  ISNULL(Paid,0)  <> ISNULL(Amount,0)
"
5660,45490,Deleting duplicates with a where clause,"delete t
    from table t join
         (select product, count(*) as cnt
          from table
          group by product
         ) tt
         on tt.product = t.product
    where tt.cnt > 1 and t.product_type = 'house';
"
21940,6371,UPDATE before INSERT (Oracle),"INSERT INTO S2
SELECT 03, DATA1, DATA2 FROM S1 WHERE ID=01
"
30426,30947,SQL Subtract first row from all selected rows,"SELECT  v - FIRST_VALUE(v) OVER (ORDER BY t)
FROM    mytable
ORDER BY
        t
"
20218,51414,How to count using LEFT JOIN?,"SELECT
    e.Company,
    COUNT(l.LeadId) AS Actions
FROM
    Exhibitors AS e 
    LEFT JOIN Leads AS l
        ON l.ExhibitorID = e.ExhibitorID
        AND l.ContractorID = 100
        AND l.ShowID = ""20120228AB""
GROUP BY e.Company
ORDER BY Actions DESC
LIMIT 20;
"
1010,56238,select most recent records with unique user id,"select distinct p.* from 
picks_recorded p
inner join
(select userid, max(date_submitted) as maxdate from picks_recorded
WHERE date_submitted > '"" . $week_start . ""'
AND date_submitted < '"" . $week_end . ""'
group by userid) s on p.userid = s.userid and p.date_submitted = s.maxdate
"
26767,45322,MySQL query with table that may or may not have data,"SELECT *
    FROM transactions t
        LEFT JOIN bill b
            ON t.userId = b.userId
    WHERE MONTH(date) = '09'
        AND YEAR(date) = 2011
    (...)
    ORDER BY t.id_transaction
"
18579,65478,Sql: Selecting from other tables,"SELECT * FROM Player INNER JOIN Stats ON Player.SSN = Stats.SSN WHERE Player.DOB >= '1994-01-01'
"
24567,32487,auto increment by specific column's data,"SELECT @row_number:=CASE WHEN @category=category 
THEN @row_number+1 ELSE 1 END AS feeds,@category:=category AS category, content
FROM table1, (SELECT @row_number:=0,@category:='') AS t
ORDER BY category;
"
29130,62003,SQL Sum in Multiple join query,"select 
  inquiry.inquiry_id,
  SUM(logmins),
  catname,
  proddesc
from
   timelog
    inner join inquiry on timelog.inquiry_id=inquiry.inquiry_id
    inner join category on inquiry.category_id = category.category_id
    inner join prod on inquiry.prod_id = prod.prod_id
group by
  inquiry.inquiry_id,
  catname,
  proddesc
"
3324,26099,Copy Field from a Table to Be used In a Query For Another Table,"$sql = ""update qu_g_users set rstatus = 'D' where accountuserid in (select accountuserid from qu_pap_users where userid='b793bca3' )"" ;
"
19284,19783,Filteration of Rows based on a column value,"SELECT
   ab.AssetId
  ,MIN(ab.BookId) as BookID
  ,abt.CuurentOperationsTax
FROM
 AssetBook ab
JOIN AssetTable at ON at.AssetId = ab.AssetId
JOIN AssetBookTable abt ON abt.BookId = ab.BookId
GROUP BY 
   ab.AssetId
  ,abt.CuurentOperationsTax
"
2407,23182,grouping by non-database field,"SELECT some_fields, end - start AS duration FROM table ORDER BY duration
"
3970,10705,creating multi dimensional varchar/text arrays in plpgsql (postgres),"CREATE OR REPLACE FUNCTION my_function (my_arg integer) RETURNS text[][] AS
$$
DECLARE
   my_arr varchar[][];
   r_row RECORD;
   counter integer:= 1;
BEGIN
   FOR r_row IN SELECT my_stuff1, my_stuff2 FROM my_table WHERE my_val = my_arg LOOP
       my_arr[counter] := array[r_row.my_stuff1,r_row.my_stuff2,'my_string'];
       counter :=counter+1;
   END LOOP;
   return my_arr;
END;
$$
LANGUAGE plpgsql;
"
10315,58451,DB table creation -- breaking down age groups,"ID     Min_Age   Max_Age   Description
1      0         4         ""Less than 4""
2      5         9         ""5 to 9""
3      10        14        ""10 to 14""
4      15        19        ""15 to 19""
5      20        1000      ""Adults""
"
25311,28741,"SQL SELECT: ""Give me all documents where all of the documents procedures are 'work in progress'""","SELECT document_id, document_name, ...
FROM documents AS d
WHERE NOT EXISTS (SELECT document_id
                  FROM procedures
                  WHERE document_id = d.document_id
                      AND status != 'wip');
"
26665,53718,Replace into Sql (Not all line just special letter inside it),"update _Items SET CodeName = REPLACE(CodeName,'_08_','_07_') 
where CodeName LIKE '%_08_%'
"
35510,59455,Insert inside of a case statement,"INSERT INTO {table}
(ItemID, VendorId, Function)
(
SELECT ItemID, VendorId, other_functions
FROM {table}
WHERE other_functions IS NOT NULL
)
"
1098,49357,Locating a schema that owns a role,"select grantee from dba_role_privs where granted_role='LANDING_R'
"
15037,75516,Updating parent table from referencing child,"DELIMITER $$
CREATE TRIGGER update_time_taskdata 
AFTER UPDATE ON Sub_task_data FOR EACH ROW 
BEGIN 
    UPDATE Task_data
       SET updated_on = NOW()
     WHERE id = NEW.task_data_id;
END;
$$
DELIMITER ;
"
33600,12102,How to select the biggest value from a list of duplicate entries,"select * from foo where status = 3 order by id desc limit 1;
"
12228,20865,sql server get min time?,"SELECT [USERNAME], [DATE]
, min(case when [action] = 'Clock In' then [time]  end) as 'First in'
, min(case when [action] = 'Clock Out' then [time] end )as 'First out'
, max(case when [action] = 'Clock In' then [time] end) as 'Last in'
, max(case when [action] = 'Clock Out' then [time] end )as 'Last out'
FROM attendance
WHERE [USERNAME] = 'User1' AND [DATE] = '01/12/2012'
group by [username],[date]
"
19261,27632,How to get rank in MySQL from 2 tables?,"SELECT sort, points
FROM
(
    SELECT @sort:=@sort + 1 AS sort, points, userid
    FROM
    (
        SELECT rank.points, rank.userid
        FROM rank
        INNER JOIN settings
        ON rank.userid = settings.userid
        WHERE settings.active = 1
        ORDER BY points DESC
    ) sub0
    CROSS JOIN (SELECT @sort:=0) sub2
) sub1
WHERE sub1.userid = 8
"
24917,12255,Need help understanding this TSQL join behavior,"First Join
T1    T2    
NULL  Data

Second Join
T1    T3
NULL  Data
"
38505,14718,MySQL query with and without WHERE condition at once,"SELECT l.id, 
       l.value * SUM(if(c.id = <SOME_CLIENT>,clientStudents,0)) / SUM(totalStudents) as total 
FROM Lesson l 
JOIN lesson_student ls ON l.id = ls.lesson_id 
JOIN Student s ON ls.student_id = s.id 
JOIN Client c ON s.client_id = c.id
GROUP BY l.id, l.value
"
7175,28808,How could this query be improved?,"select distinct controlid, 
  max (case when a=3 and b=13 and c=0 and d= 0 then OrderNo end) as colA,
  max (case when a=2                           then OrderNo end) as colB,
  max (case when a=1 and b=14 and e=1          then OrderNo end) as colC,
  max (case when a=3 and b=13 and e=1 and c=0 and d=0 then OrderNo end) as colD,
  max (case when OrderNo=#param2# then a end) as colE
from my_table
where controlid = #param1#
group by controlid
"
35389,39126,Aggregation of unique rows in SQL,"SELECT t.name, t.change, t.number_of_sales
FROM your_table t
INNER JOIN (
        SELECT tt.name, MAX(tt.number_of_sales) AS max_number_of_sales 
        FROM your_table tt 
        GROUP BY tt.name
    ) tm ON t.name = tm.name AND t.number_of_sales = tm.max_number_of_sales
"
26995,32618,Storing pictures into a database,"<img src=""/content/u/10234/abcde.img"" width=""300"" height=""200"">
"
1138,16569,Trigger Before Insert MySql,"CREATE PROCEDURE insert_user_search(new_id_user INT, ......other variable to inert)
BEGIN
  DECLARE @minId INT;

  //INSERT using parameter

  SET @minId = SELECT MIN(id) FROM user_search WHERE id_user = new_id_user;
  IF ((SELECT COUNT(id) FROM user_search  WHERE id_user = new_id_user) > 4) THEN
        BEGIN
            DELETE FROM user_search WHERE id_user = @minId;
        END; 
  END IF;
END;
"
23862,18541,SQL select only rows which have same column value,"SELECT fruit 
FROM fruits 
GROUP BY fruit
HAVING sum(case when delicious = 0 then 1 else 0 end) = 0
"
8657,45296,SQL Query joins,"SELECT
  it.TicketID,    
  ep.Firstname + ' ' + ep.EmployeeLastName AS TicketRequestorFullName,    
  mp.Firstname + ' ' + mp.EmployeeLastName AS ApprovalManagerFullName,    
  it.RequestDate, 
  it.ApprovalDate, 
  it.TicketStatus
FROM    
  tblIssueTicket it
  INNER JOIN  tblEmployeeProfile ep ON ep.EmployeeID = it.TicketRequesterID
  INNER JOIN  tblEmployeeProfile mp ON mp.EmployeeID = it.ApprovalManagerID
"
33196,45314,Distinguishing Tag and Category names in SQL query replace,"UPDATE
      WP_TERMS
SET
      NAME      =
          REPLACE ( NAME,
                  'pattern',
                  'motif' )
WHERE
      TERM_GROUP LIKE '0'
      AND NAME = SLUG;
"
22622,27017,Ordering SQL results by attributes in another table,"SELECT buses.*
FROM buses
ORDER BY (
  SELECT MIN(stops.time) FROM stops WHERE stops.bus_id = buses.id
)
"
18959,45893,Update a constraint in postgresql 9.1 database,"ALTER TABLE T1 DROP CONSTRAINT fk_T1;

ALTER TABLE T1 ADD CONSTRAINT fk_T1 FOREIGN KEY (id1)
REFERENCES T2 (id1) MATCH SIMPLE
ON UPDATE CASCADE ON DELETE CASCADE;
"
11147,35013,Run MySql query on all ids in another table,"select a.PmsId, a.FirstName, a.LastName, b.LastTransactionDate
from (select PmsId, FirstName, LastName
    from Clients
    group by PmsId) a
left join (select a.ClientPmsId, max(b.LastTransactionDate) LastTransactionDate
    from ClientPatientRelationships a
    join Patients b on a.PatientPmsId = b.PmsId
    group by a.ClientPmsId) b on a.PmsId = b.ClientPmsId;
"
11606,10487,"sql - selecting, counting and Updating","$short    = $_POST['short'];
$opponent = $_POST['opponent'];

safe_query(""UPDATE "".PREFIX.""teams_members SET win=win+1 WHERE teamID='$opponent'"");
safe_query(""UPDATE "".PREFIX.""teams_members SET lost=lost+1 WHERE teamID='$short'"");
"
13471,959,Does my trigger updates all the records,"UPDATE dbo.SubSections  
SET  SubSections.Priority = SubSections.Id 
FROM INSERTED
WHERE INSERTED.Id = dbo.SubSections.Id
"
11405,53392,SQL: replacing a value with corresponding values in differet table after join,"select survey.worker_id,
   (Select Value from Code where ID = survey.code_number_of_days_id) as No_of_Days,
   (Select Value from Code where ID = survey.code_gender) as Gender,
   Info.Name, 
   (Select Value from Code where ID = Info.code_category_id) as Category,
   (Select Value from Code where ID = Info.code_confirmed_status_id) as Confirmed,
from Survey 
full outer join Info 
on Survey.worker_id = Info.id 
"
9390,17899,Split values into separate rows,"SELECT Split.a.value('.', 'VARCHAR(100)') splt_num
FROM   (SELECT Cast ('<M>'
                     + Replace(ProductNumber, ',', '</M><M>')
                     + '</M>' AS XML) AS Data
        FROM   yourtable) AS A
       CROSS APPLY Data.nodes ('/M') AS Split(a) 
"
16148,17664,SQL Query for aggregation/concatenation,"SELECT t1.id, 
       STUFF((SELECT '/' + t2.name
                FROM YourTable t2
                WHERE t1.id = t2.id
                ORDER BY t2.name
                FOR XML PATH('')),1,1,'') AS Name
    FROM YourTable t1
    GROUP BY t1.id
"
32320,26684,sql sequence start with value taken from another sequencer,"DECLARE
    NxtVal INTEGER;

BEGIN
    SELECT  (SEQ1.NEXTVAL)+10
        into NxtVal
        From Dual;


    execute immediate  'Create sequence SEQ2 '
        'minvalue 1 '
        'maxvalue 99999 '
        'start with ' || NxtVal || -- missing ' 
        ' increment by 1';
END;
/
"
37603,22458,"ms access 2007 SQL ""not like"" is ignoring blank cells","SELECT username, ID, Text1 
FROM user_info 
WHERE (username Is Null OR username NOT LIKE 'red*')
  AND (text1 Is Null OR text1 NOT LIKE 'sd*')
"
38196,17630,Combining two column's data into one column in SQL?,"  COALESCE([Last_Name], '') + ',' + COALESCE([First_Name], '') + ' ' + 
  COALESCE( 
          [Middle_Name], '') AS SORT_NAME
"
4049,55173,How to display column name as data in another column,"DECLARE @SUBJECT_SPLIT VARCHAR(10)
SET @SUBJECT_SPLIT = SUBSTRING(@subject,1,2)
EXEC('SELECT FirstName, LastName,' + @Subject + ', ''' + @SUBJECT_SPLIT + '''
FROM Student')
"
23457,15012,How to give a call to stored procedure added in .edmx file?,"using(var context = new SimplePmEntities())
{
    var data = context.Test_EF(""yasser"", 0);
}
"
4101,37441,Mysql self join produces duplicate entries,"SELECT p1.last_name, p1.first_name, p1.city, p1.state
FROM president AS p1 INNER JOIN president AS p2
ON p1.city = p2.city AND p1.state = p2.state
WHERE (p1.last_name <> p2.last_name OR p1.first_name <> p2.first_name)
GROUP BY p1.last_name, p1.first_name, p1.city, p1.state
ORDER BY state, city, last_name
"
23616,4830,How do I remove an email domain value and add a new one in a column - mysql," UPDATE mytable
    set myfield = replace (myfield, '@test.comXYZ', 'domain.com')
"
24583,3392,Retrieve Exclusive records from two tables in SQL Server 2008,"SELECT  a.*
FROM    Table1 a
        LEFT JOIN Table2 b
            ON a.EmployeeID = b.EmployeeID
WHERE   b.EmployeeID IS NULL
"
36919,35872,Determine DATEPART by int value in SQL,"SELECT * FROM tblDBS_Details 
WHERE 
    CASE @ExpiryType
    WHEN 0 THEN DATEADD(D, @ExpiryValue, @DateOfIssue)
    WHEN 1 THEN DATEADD(W, @ExpiryValue, @DateOfIssue)
    WHEN 2 THEN DATEADD(M, @ExpiryValue, @DateOfIssue)
    WHEN 3 THEN DATEADD(Y, @ExpiryValue, @DateOfIssue)
    END <= GETDATE()
"
34768,65888,SQL Query to retrieve highest item up to a point in a group,"select p.*
from person p
inner join (
    select surname, max(age) as maxage
    from person 
    where age < 30
    group by surname
) pm on p.surname = pm.surname and p.age = pm.maxage
"
9839,21209,Select X random users per item,"SELECT Items.[ItemID],
       UserID
FROM   Items
       OUTER APPLY (SELECT TOP ([Num_Users]) *
                    FROM   Users
                    ORDER  BY Newid()) A 
"
33708,47948,Get count against each distinct value in SQL Server,"select a.aliasname, count(d.aliasname) as quest_count, ic.is_correct
from (select distinct aliasname from tbl_demo
     ) a cross join
     (select distinct is_correct from tbl_demo
     ) ic left outer join
     tbl_demo d
     on d.aliasname = a.aliasname and d.is_correct = ic.is_correct
group by a.aliasname, ic.is_correct;
"
34594,12273,How to format the SQL PRINT messages -- a kind of C printf()?,"declare @test int
set @test = 333333333
select STR(@test)
"
27405,73947,Need help in SQL query Group function,"SET @num := 0, @state:= '';

SELECT t.email, t.`office state`, 
      @num := if(@state = t.`office state`, @num + 1, 1) AS row_number,
      @state := t.`office state` AS dummy
FROM (
  SELECT email, `office state` 
  FROM zim_new_usa 
  WHERE 
  (email LIKE '%@aol%' OR email LIKE '%@gmail%') 
 AND length(`office state`) = 2 
 ORDER BY `office state`
) as t
GROUP BY t.`office state`,t.email
HAVING row_number <= 5;
"
21767,46489,How to show all results except the first one?,"select * from table limit 10000000 offset 1
"
13718,55194,How to modify values while extracting them from XML data in SQL Server,"SELECT  a.value('(ID)[1]','int') as ID,
case 
  when a.value('(Show/@Pointer)[1]', 'varchar(5)') = 'yes' then '1'
  else '0'
End case as 'ShowItem',
a.value('Display[1]/@Pointer[1]=""Display""', 'varchar(10)') as DisplayDetails, -- Set to 'true' or 'false'
a.value('DisplayDetails[1][@Pointer[1]=""Display""]/Detail1[1]', 'varchar(max)') as Detail1
FROM    @XMLNODE t
cross apply
t.doc.nodes('//OldItem') x(a)
"
19614,15724,What must be escaped in SQL?,"$name = sql_get_query(""SELECT lastname FROM sometable"");
sql_query(""INSERT INTO othertable (badguy) VALUES ('$name')"");
"
2729,18303,Cast/Covert Substring Number to Specific Letter,"SELECT CASE WHEN Substring(Group_Name, 1, 1) IN ('1','3') THEN 'I' ELSE 'T' END as Lttr
"
10551,42459,Where should I do the rowcount when checking for existence: sql or php?,"SELECT 1 
  FROM (SELECT 1) t 
 WHERE EXISTS( SELECT * FROM foo WHERE id = 42 )
"
28340,24797,Is storing an encrypted cipher key in another table a good idea?,"Key rootKey = new SecretKeySpec(keyBytes, ""AES"");
KeyGenerator generator = KeyGenerator.getInstance(""AES"");
generator.init(128);
Key keyToWrap = generator.generateKey();

Cipher cipher = Cipher.getInstance(""AESWRAP"");
cipher.init(Cipher.WRAP_MODE, rootKey);
byte[] wrappedKey = cipher.wrap(keyToWrap);

Cipher uncipher = Cipher.getInstance(""AESWRAP"");
uncipher.init(Cipher.UNWRAP_MODE, rootKey);
Key unwrappedKey = uncipher.unwrap(wrappedKey, ""AES"", Cipher.SECRET_KEY);
"
29835,13438,about SQL Row filter,"SELECT a.id, a.state, a.msg, a.userid, a.time 
FROM tableA a 
INNER JOIN (SELECT a.userid, MAX(a.id) id 
            FROM tableA a 
            WHERE a.state = 'unread'
            GROUP BY a.userid
           ) AS b ON a.userid = b.userid AND a.id = b.id;
"
9489,68830,MySQL counting the returned count of a result set,"SELECT numUID, COUNT(*)
FROM (
    SELECT member, count(UID) AS numUID
    FROM memberdata
    GROUP BY Member
) T1
GROUP BY numUID
"
26419,51150,Create constant string for entire database,"CREATE OR REPLACE FUNCTION f_my_constant()
  RETURNS text AS
$$SELECT 'XXX'::text$$ LANGUAGE sql IMMUTABLE;
"
24095,72799,Output a table row as XML with Groupby another Column,"DECLARE @TABLE TABLE(
        Dept INT,
        Skills INT
)

INSERT INTO @TABLE VALUES ( 1,200),( 1,250),( 2,150),( 2,200),( 2,250)

SELECT  Dept,
        (
            SELECT  Skills xcol
            FROM    @TABLE
            WHERE   Dept = t.Dept
            FOR XML RAW(''), ELEMENTS
        )
FROM    @TABLE t
GROUP BY    Dept
"
3221,68716,SQL SERVER count distinct using Offset,"SELECT q.Make, Count(q.ID)
FROM
(
SELECT ID,Make,Model 
FROM cars 
WHERE active='true'  
ORDER BY make ASC, model ASC 
OFFSET 0 ROWS FETCH NEXT 5 ROWS ONLY
) AS q
GROUP BY q.make
ORDER BY q.make ASC;
"
33899,48067,find matching row based on multiple columns (sequence of columns doesn't matter),"   SELECT id,name,  case WHEN itemid1 IS NOT NULL THEN  CONVERT(varchar(10), itemid1) + ','
 else '' end  +  case WHEN itemid2 IS NOT NULL THEN  CONVERT(varchar(10), itemid2) + ',' else
 ''  end  +  case WHEN itemid3 IS NOT NULL THEN  CONVERT(varchar(10), itemid3) + ','  else '' 
end +  case WHEN itemid4 IS NOT NULL THEN  CONVERT(varchar(10), itemid4) + ','  else '' end  
 as itemid FROM emp
"
32144,56667,Add Cascade to exist table in SQL Server,"ALTER TABLE someTable DROP FOREIGN KEY someID;
ALTER TABLE someTable ADD FOREIGN KEY (someID) REFERENCES someOtherTable (ID) ON DELETE CASCADE;
"
6578,69694,How should I optimize my MySQL Query or Table?,"CREATE INDEX ix_data_c_name ON data (c_name);
"
34351,52741,mySQL trigger cannot update table already in use by the statement that invoked the trigger,"CREATE TRIGGER updateRating
BEFORE UPDATE
ON gallery
FOR EACH ROW
BEGIN
  SET NEW.rating= NEW.weight * NEW.modifier; -- You may update a NEW value.
END
"
16505,4522,Iterative SQL queries,"SELECT po.[PO Number], fg.[Component Number],
       SUM([Quantity]*[QTY Per FG]) Quantity
FROM PurchaseOrder po
JOIN CustomerProduct cp 
  ON po.[Customer Product Number]=cp.[Customer Product Number]
JOIN FinishedGoods fg 
  ON cp.[Finished Goods Number] = fg.[Finished Goods Number]
GROUP BY po.[PO Number], fg.[Component Number]
"
963,62581,"Linq version of SQL ""IN"" statement","var TagIds = new int[] {12, 32, 42};

var q = from map in Context.TagMaps 
        where TagIds.Contains(map.TagId)
        select map.Items;
"
28932,48820,Delete trigger not inserting record,"CREATE TRIGGER [EXERCISE].[delete_trigger]
ON [EXERCISE].[Fact_Sales]
AFTER DELETE
AS
    INSERT INTO [EXERCISE].[Fact_Sales_Audit](City_ID,Product_ID,Time_ID,Created_Date,Updated_Date)
    SELECT D.City_ID,
           D.Product_ID,
           D.Time_ID,
           D.Created_Date,
           D.Updated_Date
    FROM   deleted D
"
3201,39196,Picking first instance in grouped rows- PostgreSQL,"SELECT * FROM
(SELECT accountid,
    procdate, 
        type, 
        value, 
        LAG(type) OVER (ORDER BY procdate ASC) AS previousType
   FROM transaction) w WHERE previousType = 'RECOVERY';
"
18165,62709,Restrict Update Statement from actually updating the records,"BEGIN TRANSACTION

SELECT  SomeField 
FROM    FINAL TABLE (   UPDATE YourTable
                        SET     SomeField = SomeValue
                        WHERE   SomeOtherField = SomeOtherValue)

ROLLBACK
"
899,60550,How to retrieve random records from Oracle with dbms_random,"with t as (
      <your query here>
     )
select x.*
from (select t.*
      from t
      order by dbms.random
     ) x
where rownum < 10;
"
12221,62479,Search column in SQL database ignoring special characters,"SELECT
    Artist,
    Title
FROM
    Songs
WHERE
    REPLACE(REPLACE(REPLACE(Artist, '#',''), '*', ''), '""', '') LIKE '%Keywords%'
"
37285,5343,add constraint using different table,"CREATE FUNCTION ufn_check_customerwatchhistory (
    @watch_date DATE
)
RETURNS VARCHAR(10)
AS
BEGIN
    IF EXISTS (SELECT 1 FROM Customer WHERE @watch_date > Customer.subscription_start AND @watch_date < Customer.subscription_end)
        return 'True'
    return 'False'
END

ALTER TABLE WatchHistory
ADD CONSTRAINT ck_watch_date
  CHECK (ufn_check_customerwatchhistory(watch_date) = 'True')
"
31055,5634,Saving SQL files into specific folders in Oracle,"edit c:\users\dibya\projects\erp\logindetails.sql
"
37060,60235,How to insert data into two tables with t-sql,"INSERT INTO client VALUES ('Peter', 'Griffin')

SET @clientKey = @@IDENTITY

INSERT INTO address VALUES (@clientKey, '123 Elm')
"
30879,62085,Adventure Works Database Query producing empty output,"SELECT dd.DateKey, dd.EnglishMonthName, fis.TotalProductCost
FROM DimDate AS dd INNER JOIN FactInternetSales AS fis 
ON dd.DateKey = fis.OrderDateKey 
"
9008,62798,Mysql fetching data from multiple tables,"SELECT u.*,p.*,f.*
FROM USER u
LEFT JOIN picture p ON p.user_id = id
INNER JOIN friends f ON f.friends_of = u.id
WHERE f.friends_id = 1
"
18480,41583,MySQL return the nearest higher value,"SELECT MIN(temp) 
FROM foo 
WHERE temp > &userinput;`
"
20293,36419,Simple SQL Query for date ranges,"select t.*,
       datediff(day, t.date, coalesce(n.date, getdate())
from table t outer apply
     (select top 1 t2.date
      from table t2
      where t2.id = t.id and t2.date > t.date
      order by t2.date
     ) n;
"
14036,44300,how to get a year and day of the year by using sql server,"SELECT RIGHT(YEAR(GETDATE()),2), DATEPART (DAYOFYEAR,GETDATE())
"
21277,43350,Select rows not in another table by comparing two table,"    SELECT TableA.Id
    FROM TableA
    WHERE NOT EXISTS (
      SELECT 1
      FROM TableB
      WHERE TableB.Month_Id = TableA.Month_Id
      AND TableB.Customer_Id = TableA.Customer_Id
      AND TableB.Total_Amount = TableA.Total_Amount
   )
"
17825,24214,How to get First and Last record from a sql query?,"SELECT <some columns>
FROM mytable
<maybe some joins here>
WHERE <various conditions>
ORDER BY date DESC
LIMIT 1

UNION ALL

SELECT <some columns>
FROM mytable
<maybe some joins here>
WHERE <various conditions>
ORDER BY date ASC    
LIMIT 1
"
38945,46132,Insert default value in column,"Insert into tableA(clientid,no_of_users)
select clientid, 3
from tableB
"
16963,35159,Query to extract highest value for each ID submitted,"SELECT *
FROM (  SELECT *, ROW_NUMBER() OVER(PARTITION BY peh_pmt_id ORDER BY eh_id DESC) Corr
        FROM employer_history 
        WHERE eh_pmt_id in (131,3725)) t1
WHERE Corr = 1
"
194,30822,Calculate sum of column for selected Ids in SQL,"UPDATE [Member]
SET [Points]=
(
   SELECT SUM([CR].[Point]) AS [AllPoints]
   FROM  [CartRegister] AS [CR] 
   WHERE [CR].[Member_Id] = [Member].[Id]

)
WHERE [Members].[Member].[Id] IN  ( SELECT Member_Id From SelectedMembers  )
"
18711,47701,Get records with more than one value and at least one of them is zero,"select Keyword,COUNT(distinct id) from #Tbl
group by Keyword
having COUNT(distinct id)>1 and MIN(id) = 0
"
17894,23347,Convert Sql to Dql,"$qb = $this->getEntityManager()->createQueryBuilder();

    return $qb->select('a')
            ->from('Your Bundle Agent', 'a')$criteria['company']))
            ->join('a. maison', 'm', 'WITH', 'a.id=m.id_maison')
            ->where('maison.id = 2')
            ->getQuery()
            ->getResult();
"
6407,71890,Using different order by with union,"SELECT * 
FROM (SELECT TOP 10 A.*, 0 AS Ordinal
      FROM A
      ORDER BY [Price]) AS A1

UNION ALL

SELECT * 
FROM (SELECT TOP 3 A.*, 1 AS Ordinal
      FROM A
      ORDER BY [Name]) AS A2

ORDER BY Ordinal
"
20481,67874,MySQL How to order by last name on a full name field?,"SELECT * FROM some_table ORDER BY SUBSTR(Name, INSTR(Name, ' '))
"
23633,59460,Joining the same table twice,"SELECT * FROM cases c
LEFT JOIN users u1 ON c.fk_supporter = u1.user_id
LEFT JOIN users u2 ON c.fk_creator = u2.user_id
"
37303,19753,Show name of source table(s) in SELECT result,"SELECT *, 'Schemes_Discoveries' FROM [arachnode.net].[dbo].[Schemes_Discoveries]
"
12428,72657,Outer joining on two columns and skipping Null in T-SQL,"SELECT mt.MoreInfo, rt.Id
    FROM MainTable mt
    LEFT OUTER JOIN ReferenceTable rt 
    ON (mt.Mobile = rt.Mobile AND coalesce(rt.Mobile, '')<>'') 
       OR (mt.Email = rt.Email AND coalesce(rt.Email, '')<>'')
"
23222,73293,looped count query(oracle),"select trunc(dt) as dt, count(*) as cnt
from stat.jurnal 
group by trunc(dt);
"
31530,72028,Select values in SQL that have a colum value in one row and not a specific other column value in another,"SELECT DISTINCT book FROM TOPICS WHERE topic = 3 
EXCEPT
SELECT DISTINCT book FROM TOPICS WHERE topic = 4
"
27823,36534,Using GROUP BY for an non-uniqueness-warning column,"select 
  key, 
  min(value1) as ""a value1"", 
  min(value2) as ""a value2"", 
  max(value2) as ""another value2"", 
  count(distinct value2) ""number of value2""
FROM tbl
group by key
having count(distinct value2) > 1
"
35630,28335,Is it possible to determine the table linked to by a foreign key?,"select references_table_name
  from referential_constraints
 where table_name = 'your_table';
"
721,74984,"decompose source data into new, many-to-many schema","SELECT DISTINCT rxcui, [name] INTO drugwordsConsoJunction FROM words
"
17666,13384,Query IN that matches all,"select distinct Report_id 
   from Template T
   where Template_id in ('d','e')
   and NOT EXISTS 
      (select T1.Report_id 
        from Template T1
        where Template_id not in ('d','e')
        and T.Report_id=T1.Report_id)
"
38732,38534,SQL update based on value from other table,"Update TableB
Set IsValid = 0
From TableA as A INNER JOIN TableB as B
                      ON A.TableBNo = B.TableBNo And IsGood = 1
                 INNER JOIN TableBChild as BC
                       ON B.TableBID = BC.TableBID
AND BC.MEMBERID NOT IN ( SELECT MemberID from Member Where MemberNo = A.MemberNo )
"
14627,34115,Select Mysql commutative sum of each row,"mysql> set @my_var=0;
mysql> select frq, @my_var:=@my_var+frq as commutative_sum from `mytable`
"
11079,22497,sql many to many select with join,"SELECT 
   p.name AS ""place"", 
   t.name AS ""firstTag"" 
FROM 
   places p 
   LEFT JOIN
   places_tags pt1 
      ON pt1.place_id = p.id
   LEFT JOIN
   places_tags pt2 
      ON pt2.place_id = p.id AND pt2.tag_id < pt1.tag_id
   LEFT JOIN 
   tags t 
      ON t.id = pt1.tag_id
WHERE
   pt2.tag_id IS NULL
"
9239,34483,How to storing Sub query in variable. MySql,"update vars join
       table2
       on vars.id = table2.id
    set unq = 1;
"
35146,63289,Cypher returning Boolean after checking whether relationship exist between two nodes,"MATCH (n:Node {id: {parameter1}})-[r:someType]-(m:Node {id: {parameter2}})
RETURN SIGN(COUNT(r))
"
11877,61631,Average balance query in Oracle SQL,"select custcity, avg(custbal) as AvgBal
from rchamart.customer
where custstate = 'WA'
group by custcity;
"
20339,46798,How do I add seconds to a timestamp of a start date so that I can get an estimated end date?,"my_date_time + INTERVAL xx SECOND
"
27516,54670,SQL Insert to Temp Table Without Specifying Values?,";WITH MY_OTHER_CTE AS
(
    // Logic here uses SELECT * from same table as first CTE.
)
INSERT INTO #Tasks
    SELECT *
    FROM MY_OTHER_CTE
"
23624,30745,another left join query,"SELECT *
FROM LS_CLIENT_TRANS
LEFT JOIN CLIENT ON LS_CLIENT_TRANS.OTHER_CLIENT = CLIENT.CODE_CLIENT
"
27213,53214,Regex to match everything between a string and a caret (^) excluding occurrence of caret (^),"(?<=\[StupidHtml\]\:)(.*?)(?=\^)
"
27347,41527,How to extract custom tokens in SQL Server NVarChar/VarChar field by using RegEx?,"var s = ""Welcome [CT Name=\""UserName\"" /], We hope that you will enjoy our services and your subscription will be expired on [CT Name=\""ExpiredDate\"" /]."";
var pattern = ""\\[CT\\s\\w+=\""\\w+\""\\s/\\]"";
var matches = Regex.Matches(s, pattern);
foreach (var match in matches)
{
    Console.WriteLine(match.ToString());
}
Console.ReadLine();
"
539,22521,sql ORDER BY multiple values in specific order?,"...
WHERE
   x_field IN ('f', 'p', 'i', 'a') ...
ORDER BY
   CASE x_field
      WHEN 'f' THEN 1
      WHEN 'p' THEN 2
      WHEN 'i' THEN 3
      WHEN 'a' THEN 4
      ELSE 5 --needed only is no IN clause above. eg when = 'b'
   END, id
"
25773,49379,"Checking conditions (date, time) with MySQL","WHERE timestamp(start_date, start_time) <= timestamp(currdate, currtime)
  AND timestamp(end_date, end_time) >= timestamp(currdate, currtime)
"
284,15838,Oracle Date Format Conversion Issue,"SELECT username, TO_CHAR(action_date, 'DD/MM/YYYY') AS action_date
  FROM adminview;
"
37340,36623,SQL DELETE using DATE,"delete from customer
where not exists (select 1 
                  from sale
                  where sale.custId = customer.CustNo
                    and sale.saledate >= date '2009-01-01')
"
13698,6711,Oracle: Update with join not working as expected,"update d_dim 
    set FLAG = case when id in (select id from t_temp) then 'Y' else 'N' end;
"
17097,33008,updating a column in one table with value extracted from other table,"SET    val2 = t1.val1
FROM   table1 t1
WHERE  t2.table2_id = t1.table2_id
AND    t2.val2 IS DISTINCT FROM t1.val1  -- to avoid empty updates
"
38015,49339,Getting all rows excluding a SQL resultset,"select *
from the_table
except
select *
from the_table
where robot_id = 'ABC1234E' 
  and sequence_no = 1;
"
10642,46344,How does this SQL TO_CHAR function work?,"select TO_CHAR('01-JAN-99', 'mm/dd/yyyy') from dual; --should return the string '01/01/1999'
select TO_CHAR('20-APR-15', 'dd/mm') from dual; --should return '04/20'
"
13643,35792,Why is this stored procedure only inserting one item?,"select
    x.TRANS.value('(value/text())[1]','varchar(255)') as DATA,
    x.TRANS.value('@name', 'varchar(255)') as NAME
from @XmlFile.nodes('/root/data') as x(TRANS)
"
23038,32365,Using MAX for date but adding column to group on 'breaks' the query - sub query?,"select * from
(
     SELECT Location,Date, Type, Notes, Row_Number() Over (Partition By Location, Type order by date desc) RN 
     FROM
          NotesTable a
           INNER JOIN Location b on a.LocationID = b.LocationID
           INNER JOIN Type c on a.typeid = c.typeid
      WHERE typeid <> 8
) v
WHERE rn = 1 
"
21572,28189,Can I update New in before insert trigger in sqlite?,"CREATE TRIGGER test_in
AFTER INSERT ON test
FOR EACH ROW
WHEN (NEW.t IS NULL)
BEGIN
   UPDATE test SET t = now() WHERE id = NEW.id;
END;
"
11297,25726,Select only rows that have unique fields,"  SELECT Col1, Col2, Col3, Col4 FROM MyTable WHERE
  Col1 NOT IN (Col2,Col3,Col4) AND
  Col2 NOT IN (Col3,Col4) AND
  Col3 <> Col4
"
25780,26780,SQL statement to get values that have one property but not another property,"SELECT *
FROM OrderActivityTable t1
LEFT JOIN OrderActivityTable t2
ON t1.OrderID = t2.OrderID AND t2.ActivityID = 2
WHERE t1.ActivityID = 1
AND t2.OrderID IS NULL
"
673,14831,How to display Date in DD/MM/YYYY H:MM AM/PM format in SQL Server,"print convert(nvarchar(10), getdate(), 103) + right(convert(nvarchar(30), getdate(), 0), 8)
"
38610,40281,Change sql parameter based on a public variable from an if statement,"Dim MachineEnd As String
    'declare machine end string
If Combobox.SelectedValue = 5 Then
    MachineEnd = ""StringA""
ElseIf Combobox.SelectedValue = 6 Then
    MachineEnd = ""StringB""
ElseIf Combobox.SelectedValue = 7 Then
    MachineEnd = ""StringC""
...
    End if
...
"
36233,64219,How to get sum of multiple records in a column,"select TC.F_Exhibition_Name, T.F_Exhibitor_Name, TC.F_CreditNoteNo, 
       TC.F_Description, TC.F_Price,TC.F_Qty, TC.F_CNqty, TC.F_Totalamt,
       sum(TC.F_Totalamt) OVER () AS SumOfTotalamt
from T_CreditNote TC 
LEFT JOIN T_Exhibitor T on T.F_Exhibitor_Name=TC.F_Exhibitor_Name 
where TC.F_CreditNoteNo='CNINV100002'
"
361,32175,How do I find which tables have foreign keys on my table?,"SELECT dc.constraint_name, dc.constraint_type, dc.owner, dc.table_name
FROM dba_cons_columns dcc 
JOIN dba_constraints dc ON (dcc.constraint_name = dc.r_constraint_name and dc.owner = dcc.owner)
WHERE dcc.owner = 'OWNER_NAME' and dcc.table_name = 'TABLE_NAME';
"
9035,58409,SQL (SQLite) count for null-fields over all columns,"SELECT (N * COUNT(*)) - (
    COUNT(COLUMN_1) 
  + COUNT(COLUMN_2) 
  + ... 
  + COUNT(COLUMN_N)
)
FROM DATAPOINTS;
"
18164,22665,Efficient way to replace HTML codes with special characters in oracle sql,"select
   'UPDATE ' || table_name || ' SET ' || col_name || ' = UTL_I18N.unescape_reference(' || col_name || ');'
from
   all_tab_cols
where
   owner = <MY_NAME>
and 
   table_name in ('....') -- you can use this clause too: table_name like '%my_table%'
"
16668,44333,How do I replace the values of one column with the values of another column in the same table,"UPDATE MyTable Set Column1 = Column2
"
2354,50305,Deleting a table in Oracle with WHERE condition in other tables,"delete from A
where ROWID in 
    (select A.ROWID
     from A,B
     where A.A1 = B.B1
     and A.A2 = concat(B.B2, B.B3, B.B4)
    )
"
32294,14273,"SQL Partial primary key, composite key","CREATE TABLE ""Author/Title"" (
    author_name VARCHAR(50),
    isbn VARCHAR(13) REFERENCES ""Item Details"",
    PRIMARY KEY (author_name, isbn)
)
"
14317,32528,Select distinct name with random id,"SELECT name, MIN(id)
    FROM YourTable
    GROUP BY name
"
20281,21841,Entity Framework Query for Complex Sql,"from p in Profiles
join spa in SeucrityProfileAssignments
    on p.ProfileId equals spa.ProfileId
join spu in SecurityProfileUsers
    on spa.SecurityProfileId equals spu.SecurityProfileId
where spu.UserId = userId
select new //optional object type
{
    //values to select
}
"
23592,46958,SQLBulk Copy with trigger which fire Update query,"MERGE INTO dbo.Table1 AS t
USING dbo.inserted AS i
        ON t.id= i.id
WHEN MATCHED THEN
    UPDATE SET
      t.col1= i.col1,
      t.col2= i.col2
WHEN NOT MATCHED THEN 
      INSERT (col1, col2)
      VALUES (i.col1, i.col2)
"
16474,11826,how to write this mysql join,"SELECT i.id, i.name, i.code, i.price, 
       ig1.name AS igName1,ig2.name AS igName2,ig3.name as igName3
FROM items i 
INNER JOIN ingredients ig1 ON ig1.id=i.ingredient_id
INNER JOIN ingredients ig2 ON ig2.id=i.ingredient_id2
INNER JOIN ingredients ig3 ON ig3.id=i.ingredient_id3
"
29843,459,SQL string manipulation,"SELECT RIGHT(REPLICATE('0', 9) + '123456789', 9)    -- Result: 123456789
SELECT RIGHT(REPLICATE('0', 9) + '255', 9)          -- Result: 000000255
SELECT RIGHT(REPLICATE('0', 9) + '12', 9)           -- Result: 000000012
SELECT RIGHT(REPLICATE('0', 9) + '1', 9)            -- Result: 000000001
"
16282,56163,MySQL querying with a dynamic range?,"select * from (
 SELECT * FROM (select * from ppl_table where age>30 and age<40 order by rand() limit 10) as Momo1
 union
 SELECT * FROM (select * from ppl_table where age>25 and age<40 order by rand() limit 20) as Momo2
) as FinalMomo
limit 10
"
19956,61173,How to delete an attribute from an XML variable in sql server 2008?,";WITH XMLNAMESPACES (DEFAULT 'http://cp.com/rules/client' )
SELECT
    XmlDocument.value('(/clue_personal_auto/admin/report_usage)[1]', 'varchar(25)')
FROM XML
WHERE ID = 357
"
8902,12021,How to write search query in sql server,"SELECT e.EventsID, e.EventDesc AS 'Event Description' 
  FROM dEvents e 
 WHERE EndEvent >= @FromDate
   AND StartEvent <= @ToDate
"
32573,34902,European format time - Convert string to Datetime in SQL,"select convert(datetime, '21-04-2010 11:06', 105) 
"
1664,12279,Conditional sql query to fetch substring,"SELECT * FROM
(
    select OCCURTIME,ID,
    case 
    when OBJECTNAME like 'Installmx_CHX sd:21%' then substr(OBJECTNAME,1,13) 
    when OBJECTNAME like 'Installmx_F sd:23%' then substr(OBJECTNAME,1,11) 
    when OBJECTNAME like 'Installmx_TPONS sd:993%' then substr(OBJECTNAME,1,15)
    end as ONAME
    from anx_m1 
) T where ONAME is not null
"
22033,39566,Limit the number of rows being processed in this query,"SELECT (columns)
FROM (.......) as temp 
WHERE rownum BETWEEN 0 AND 20 
"
23738,27578,Get table name of an entity for a query in TYPO3 Flow,"/**
 * @Flow\Inject
 * @var \Doctrine\Common\Persistence\ObjectManager
 */
protected $entityManager;

[...]

$dql = 'SELECT COUNT(e) FROM Vendor\Package\Domain\Model\Entity e WHERE e.property = :property';

$query = $this->entityManager->createQuery($dql);
$query->setParameters(array('property' => $property));
$result = $query->execute();
"
36523,28880,"MySQL: Fetch conditional rows only, from a query dataset","SELECT
  id,
  assigned_to,
  foreign_id,
  purchase_date
FROM
  atable
WHERE
  foreign_id = @foreign_id
ORDER BY
  assigned_to = @assigned_to DESC,
  purchase_date              DESC
LIMIT 1
;
"
37286,64838,Displaying Certain Row of Query Results,"with cte as
(
    Select TOP 5 Title, Title_Row = ROW_NUMBER() OVER (ORDER BY Title asc)
    From products.features
    Where productid = '172'
)
Select *
From cte
Where Title_Row = 2
Order by Title
"
34328,6785,SQL query for checking entries in two consecutive weeks,"select t.name, t.date
from table t
where exists (select 1
              from table t2
              where t2.name = t.name and
                    t.date between t2.date + 7 and t2.date + 14 
             );
"
18210,20685,How can i SUM records from a table to another after multiplying two columns,"UPDATE OrderGroupNew
SET SavedTotal = (
    SELECT SUM(UnitPrice * Quantity)
    FROM OrderItemNew
    WHERE OrderNumber = OrderGroupNew.OrderNumber
) 
"
19733,22691,How to use like and NOT like for same field in SQL server,"SELECT NAME,ACCOUNTTYPENAME
WHERE TRANSACTIONTYPENAME LIKE 'CREDIT%' OR
(TRANSACTIONTYPENAME LIKE 'CREDIT%' and (TRANSACTIONTYPENAME LIKE 'DEBIT%' and DateOfTransaction ='2014/12/01'))
 GROUP BY NAME,ACCOUNTTYPENAME
"
36567,59427,Create an ENUM type from query result,"ALTER TYPE name ADD VALUE 'value';
"
21761,53832,select query on mysql to select value from a single table according to a condition,"select  item_id
from    engine4_user_fields_values
group by
        item_id
having  max(case when field_id ='17' and value in (5,8,7) then 1 end) = 1
        and max(case when field_id ='20' and value in (73,76) then 1 end) = 1
"
23441,13170,How to select count(distinct) with condition inside groups,"SELECT week_no, type, COUNT(DISTINCT CASE WHEN pts > 0 THEN user_id END)
FROM base_table
GROUP BY week_no, type;
"
12222,49701,How to retrieve the published post in wordpress database?,"select * from wp_posts
where post_status = 'publish'
and post_type = 'post'
"
10169,42446,Oracle SQL - Problem displaying using the foreign key,"SELECT p.prod_id, p.product_name, s.date_of_sale
FROM  products p
   ,  sales    s
WHERE s.prod_id(+) = p.prod_id  
;
"
29910,46041,Mysql advanced statement,"SELECT * FROM dbcasino_db22.tb_content
WHERE content_real_folder = 'foldername/' AND content_no < 5099
ORDER BY content_no DESC
LIMIT 1
"
19296,23159,SQL query to find duplicates,"select * 
from File 
where hash in (select 
               hash 
               from File
               group by hash
               having count(*) > 1)
"
30773,5764,Conditional join to two different tables based on 2 columns in 1 table,"Select Col1,Col2
From  dbo.Box B
Join dbo.Source S On S.Id = b.SourceID
Where B.OverrideQueueID  is Null
Union
Select Col1,Col2
From  dbo.Box B
Join  dbo.Queue Q On Q.Id = b.SourceID
Where B.OverrideQueueID  is Not Null
"
24984,23402,SQL - update table1 with table2 data if match found,"UPDATE table1  
SET col2 = B.col2 
FROM table1 AS A INNER JOIN table2 AS B ON A.col1 = B.col1
"
3805,56215,UPDATE record in one database with values from another in SQL Server 2008?,"BEGIN TRANSACTION

UPDATE t1
SET    Description = t2.Description
FROM   db1.dbo.foo t1
       JOIN db2.dbo.foo t2
         ON t1.ItemID = t2.ItemID

SELECT * FROM db1.dbo.foo
--prevents changes from being committed
ROLLBACK
"
36241,36700,How to skip the last records using sql-loader?,"    LOAD DATA
    INFILE 'file.dat' BADFILE 'file.bad' DISCARDFILE 'file.dis'
    APPEND
    INTO TABLE tablename
-- This will skip the tail record
    WHEN (01) <> 'T'
    (
    column names);
"
20408,42581,Checking for missing account numbers from one of the tables,"SELECT *
FROM [DS_PROD].[dbo].[Q04_ImportDetails] q04
WHERE Q04.ImportId = 680 AND q04.AccountNumber NOT IN 
    (SELECT AccountNumber 
    FROM [DS_PROD].[dbo].[T01_TransactionMaster] t01 
    WHERE t01.BatchNumber = '270864')
"
15600,74111,MySQL return first row related to a given id,"SELECT total.department, total_count, IFNULL(done, 0) as done_count, ROUND((IFNULL(done, 0) / total_count)*100, 2) as percent 
FROM (SELECT department, COUNT(*) total_count FROM agents GROUP BY department) total 
LEFT JOIN (SELECT a.department as department, COUNT(distinct a.id) as done FROM agents a, tasks p WHERE p.task_responses_id IS NOT NULL AND (p.agent1_id = a.id OR p.agent2_id = a.id) 
GROUP BY a.department) done ON done.department = total.department;
"
27287,67206,Retrieving data from many tables with simple output,"  SELECT * FROM Weapon where Name=""Boo"" 
  union  
  SELECT * FROM Armor where Name=""Boo""         
  union 
  SELECT * FROM Helm where Name=""Boo""       
  union  
  SELECT * FROM Bomb where Name=""Boo""       
  union  
  SELECT * FROM Potion  where Name=""Boo"" ;     
"
32175,30678,Showing year over year results in SQL,"select location,
  sum(case when year = 2012 and month = 4 then sales end) Sales_042012,
  sum(case when year = 2013 and month = 4 then sales end) Sales_042013
from yt
group by location;
"
30067,9230,T-SQL - Check if view is SCHEMABINDING,"select objectproperty(object_id('viewname'), 'IsSchemaBound')
"
25777,33562,how to get table name and a particular column ordinal position in entire database,"SELECT table_name,column_name,ordinal_position 
FROM   information_schema.columns  
WHERE  table_catalog = 'dbSales' and column_name = 'product'
"
16427,49652,PostgresQL SQL: Converting results to array,"SELECT  i_adgroup_id, array_agg(i_category_id)
FROM adgroupcategories_br
WHERE i_adgroup_id IN
(
    SELECT i_adgroup_id
    FROM adgroupusers_br
    WHERE i_user_id = 103713
)
GROUP BY i_adgroup_id;
"
27944,66241,How to constraint no empty strings on an NVARCHAR column,"CREATE TABLE [dbo].[Foo](
    [bar] [nvarchar](50) NOT NULL
)

ALTER TABLE [dbo].[Foo] WITH CHECK 
ADD  CONSTRAINT [CK_Foo] CHECK  (([bar]<>N''))
"
21968,22133,Change the execution plan of query in postgresql manually?,"CREATE OR REPLACE FUNCTION public.test()
 RETURNS integer
 LANGUAGE plpgsql
 IMMUTABLE COST 1000 -- very expensive function
AS $function$
declare i int;
declare j int;
begin
  i := 1;
  while i < 10000 loop
    j := 1;
    while j < 1000 loop
      j := j + 1;
    end loop;
    i := i + 1;
  end loop;
  return i;
end;
$function$
"
34227,55711,"Is it possible to have ""null rows"" in SQL?","SELECT a.id AS A, b.id AS B, NULL AS C
FROM tableA a
INNER JOIN tableB ON a.id = b.fid
UNION
SELECT a.id AS A, NULL AS B, c.id AS C
FROM tableA a
INNER JOIN tableC ON a.id = c.fid
ORDER BY 1
"
29782,19450,Detect unset $VARIABLE in query for trac report,"SELECT status, 
id AS ticket, summary, priority, keywords,  
datetime(changetime/1000000, 'unixepoch') AS last_updated, 
milestone AS __group__,
reporter, owner
FROM ticket t
WHERE status NOT IN ('closed', 'resolved') 
AND (CASE WHEN '$MILESTONE' != '' THEN (milestone='$MILESTONE') 
     ELSE (milestone in ('project1', 'project2', 'project3')) END)
ORDER by t.milestone ASC, p.value
"
13276,47584,Where/How are Oracle Column Aliases Declared?,"CREATE VIEW myView (alias1, alias2) as select ixtbm, ixkit from f3002_wh;
"
17247,7139,the correct order of reference when deleting tables,"DROP C;
DROP B;
DROP A;
"
16365,23470,How to add last second into date?,"update the_table
   set the_date_column = to_date(to_char(the_date_column, 'yyyy-mm-dd')||' 23:59:59', 'yyyy-mm-dd hh24:mi:ss');
"
18985,6122,"PostgreSQL - Deleting data that are older than an hour, and then inserting new data to the same table","DELETE FROM tempoffset WHERE ts_insert < now()-'1 hour'::interval;
"
39400,39987,Db Date Partition Change,"alter table orders enable row movement;
"
3526,33971,"Oracle SQL - What is faster than 3 ""and exists()"" in the where space?","SELECT id_no
FROM   revenue_table
WHERE  revenue_type IN ( 'Tape', 'Shipping', 'Reproduction' )
GROUP  BY id_no
HAVING COUNT(DISTINCT revenue_type) = 3  
"
39766,37968,Find patients with multiple gender,"select distinct p1.[hospital number]
FROM patients AS p1
INNER JOIN patients AS p2
  ON  p1.[hospital number] = p2.[hospital number]
  AND p1.[Sex code] <> p2.[Sex code]
"
15123,41540,SQL Query Help - LIKE Statement,"SELECT  Name
FROM    Names n
WHERE   EXISTS (SELECT NameIDs FROM NameList nl WHERE n.nameID LIKE '%'+nl.nameIDs+'%');
"
15203,73843,Looping Rows in SQL Server,"DECLARE   @temp      YOURTYPE 
DECLARE   c          CURSOR
FOR       SELECT     CodeDesc 
          FROM       authors
OPEN      c
FETCH     NEXT FROM c 
INTO      @temp
WHILE     @@FETCH_STATUS = 0
BEGIN
         -do something with temp
         FETCH NEXT INTO @temp
END
CLOSE      c
DEALLOCATE c
"
19569,16473,Create a report of user's privileges,"select idUser
     , max(case when idModule=1 then 1 else 0 end) as Module1
     , max(case when idModule=2 then 1 else 0 end) as Module2
     , max(case when idModule=3 then 1 else 0 end) as Module3
     , max(case when idModule=4 then 1 else 0 end) as Module4
from   your_table
group by 1
"
32303,55257,Count distinct with repeating entries over time,"select year, count(*)
from
(
  select customerid, min(transactiondate) as year
  from transactions
  where transactiontype = 'Presell'
  group by customerid
) first_presells
group by year
order by year;
"
34906,24215,SELECT from One Table an Element that Occurs Multiple Times in Another Table,"SELECT Student.FirstName AS ""First Name"",
  Student.LastName AS ""Last Name"",
  Enrols.CourseID AS ""Course ID"",
  COUNT(Student.FirstName) AS ""Number of Names"" 
  FROM Student
  INNER JOIN Enrols
    ON Student.StudentID = Enrols.StudentID  
  GROUP BY Student.FirstName
  HAVING COUNT(Student.FirstName) >= 2;
"
25075,43701,Find unique values from records that contain duplicate values in a different field,"SELECT a.the_id
FROM   ""MYTABLE"" A, ""MYTABLE"" B
WHERE  (a.the_name = b.the_name)
       AND 
       (a.""received"" < date('now','-8 days') 
        AND b.""received"" < date('now','-8 days')
       )
Group by a.the_id 
having count(*)>1   
"
8988,59269,SQL(DB2) WHERE clause optimization,"WHERE 
  FOO = 'Y'
  AND iline = CASE iitem
                WHEN ? THEN ?
                WHEN ? THEN ?
                ...
              END
"
8063,41224,SQL JOIN: Select Records from Another Table With Matching IDs,"SELECT p.ID, p.Name, 
       c1.CategoryName as CatID1, 
       c2.CategoryName as CatID2 
from product AS p 
LEFT JOIN categories AS c1 ON p.CatID1 = c1.CatID
LEFT JOIN categories AS c2 ON p.CatID2 = c2.CatID
"
1015,5916,PostgreSQL unique index for a specific set of values,"CREATE UNIQUE INDEX avatars_userid_state_0_idx ON avatars(user_id,(state<>0));
"
514,31377,Comparing Rows Returned by a Query,"select DISTINCT e.Name from #Employee e
inner join #Booking b on e.EmpID = b.EmpID
where e.EmpID not in (
    select b.EmpID from #Booking b
    inner join #Cars c on b.CID = c.CID
    where [type] = 'red'
)
"
9923,66262,insert into for all users who are in another table,"INSERT INTO notifications(from_id, to_id, type, checked, page_id) 
    select f.follower_id, :to_id, :type, :checked, f.page_id
    from following f
    where f.page_id = :page_id;
"
22417,6563,Join Tables SQL Server with duplicates,"WITH CTE AS
(   SELECT  Col1,
            Col2,
            Col3, 
            [RowNumber] = ROW_NUMBER() OVER(PARTITION BY Col1 ORDER BY NEWID())
    FROM    Table2
)
SELECT  *
FROM    Table1
        INNER JOIN CTE
            ON CTE.Col1 = table1.Col1
            AND CTE.RowNumber = 1 -- ONLY GET ONE ROW FOR EACH VALUE
"
16567,51411,Return number of users for each month by type,"SELECT   DATE_FORMAT(TIMESTAMP, '%b %Y') AS `month`,
         COUNT(CASE UserType WHEN 'Administrator' THEN 1 END) AS Administrator,
         COUNT(CASE UserType WHEN 'No Role' THEN 1 END) AS NoRole,
         COUNT(CASE UserType WHEN 'Super User' THEN 1 END) AS SuperUser,
         COUNT(CASE UserType WHEN 'User' THEN 1 END) AS `User`
FROM     `user`
GROUP BY DATE_FORMAT(TIMESTAMP, '%b %Y')
"
8726,63818,Update sequence to next available in PostgresQL,"BEGIN;
LOCK TABLE users IN EXCLUSIVE MODE;
INSERT INTO users (user_id, blah, blah)
VALUES (
   coalesce(
       requested_id_or_null_if_none_supplied,
       (SELECT coalesce(max(user_id),0) FROM users)+1
   ),
   'blah',
   'blah'
);
COMMIT;
"
15366,6157,Mysql results from multiple tables where ids match don't appear,"...
FROM drives 
LEFT OUTER JOIN clients ON drives.client = clients.id
LEFT OUTER JOIN drivers  ON drives.driver = drivers.id
LEFT OUTER JOIN vehicles ON drives.vehicle = vehicles.id
WHERE
.... 
"
20335,61832,Conditional Count on a field,"select 
    jobID, JobName,
    sum(case when Priority = 1 then 1 else 0 end) as priority1,
    sum(case when Priority = 2 then 1 else 0 end) as priority2,
    sum(case when Priority = 3 then 1 else 0 end) as priority3,
    sum(case when Priority = 4 then 1 else 0 end) as priority4,
    sum(case when Priority = 5 then 1 else 0 end) as priority5
from
    Jobs
group by 
    jobID, JobName
"
13160,73402,How do you implement parameter aliases in an SQL databroker operation?,"<workflow>
  <if test=""not-equal"" value1=""{$parameters.claims_id}"" value2="""">
    <then>
      <set-field field=""parameters.claim_id"" value=""{$parameters.claims_id}""/>
    </then>
  </if>
</workflow>
"
1593,35543,Qualified Oracle Function Name,"Select Text from User_Source where Name Like UPPER('Inventory_Part_Config_API');
"
7509,36624,SQL return n rows per row value,"SELECT  *
FROM    (
        SELECT  p.*,
                ROW_NUMBER() OVER (PARTITION BY birthCountry ORDER BY birthDate DESC) rn
        FROM    persons p
        )
WHERE   rn <= 10
"
7192,35072,Selecting a distinct row for a group,"select c1, c2, c3
from (select t.*,
             row_number() over (partition by c1
                                order by c3 asc, (case when c2 = 'x' then 1 else 0 end) desc
                               ) as seqnum
      from tst t
     ) t
where seqnum = 1;
"
23957,14294,How to join 3 tables and get sum from result of individual joins?,"select users.user_id,l.login,p.points from users
inner join (select user_id, count(1) login from login
       group by login) as l on users.user_id=login.user_id
inner join (select user_id, sum(point) as point 
        from point group by user_id ) as p on users.user_id=point.user_id
"
39600,58856,Pull from Oracle sequence with Hibernate,"  <sql-query name=""sequenceValue"">  
     <return alias=""mySeq"" class=""MySequences""/>  
       select my_schema.seq_myid.nextval as mySeq from dual  
  </sql-query> 
"
20951,51468,Select that finds IF multiple,"SELECT 
  MainTable.Name 
FROM MainTable m
INNER JOIN ASSN_Main a ON m.AppID = a.AppID 
WHERE 
  EXISTS (SELECT AppID
          FROM ASSN_Main
          WHERE AppID = m.AppID
          GROUP BY AppID 
          HAVING COUNT(*)>1);
"
31247,67207,Advanced partitions query,"SELECT infopath_form_id
     , DATEDIFF(Minutes,MIN(event_timestamp),MAX(event_timestamp))/CAST(COUNT(*)-1 AS FLOAT)
FROM Table
GROUP BY infopath_form_id
"
15605,2295,SQL- Referencing the primary key of the current relation (homework),"create table Student
    StudentId int primary key
    MendtorId int foreign key references Student.StudentId
"
32742,69913,MySQL query using unixtime,"SELECT 
  (AVG(`Tm_disc` - `Tm_init`)) AS AVARAGE_CALLS_SECONDS,
  (SUM(`Tm_disc` - `Tm_init`)) AS TOTAL_SECONDS_CALLS,
  COUNT(`Callid`) AS TOTAL_NUMBER_CALLS
FROM
  calls
WHERE 
  Qid=24710
AND
  MONTH(FROM_UNIXTIME(Tm_init))=2
AND
  YEAR(FROM_UNIXTIME(Tm_init))=2015
GROUP BY DATE(FROM_UNIXTIME(Tm_init))
"
27150,34688,SQL: How to check if an area is within a latitude / longitude position?,"BEGIN
FOR a IN (SELECT * FROM clean.households)
LOOP
UPDATE clean.households set geom=ST_GeomFromText('POINT(' || a.x_coord || ' ' || a.y_coord || ')',2285) where hhid ='a.hhid';
UPDATE clean.households set wkt = ST_AsText(ST_Transform(ST_GeomFromText('POINT(' || a.x_coord || ' ' || a.y_coord || ')',2285),4269))where hhid='a.hhid';
RETURN NEXT a;
END LOOP;
"
6123,31530,Is it possible to reference a different column in the same table?,"CREATE TABLE categories
(
  id INTEGER PRIMARY KEY AUTO_INCREMENT,
  parent_id INTEGER NULL,
  name VARCHAR(30) NOT NULL,
  description TEXT,
  count INTEGER NOT NULL DEFAULT 0,
  FOREIGN KEY (parent_id) REFERENCES categories(id)
);
"
22123,12250,Android OAUTH tokens storage,"SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
final Editor edit = prefs.edit();
edit.putString(OAuth.OAUTH_TOKEN, consumer.getToken());
edit.putString(OAuth.OAUTH_TOKEN_SECRET,consumer.getTokenSecret());
edit.commit();
"
28286,4903,How do you get a sum() twice from one table with different where clause?,"SELECT 
    sum(CASE WHEN pf = TRUE THEN qty ELSE 0 END) as accept,
    sum(CASE WHEN pf = FALSE THEN qty ELSE 0 END) as reject
FROM pile;
"
1485,17801,SQL Output to get only last 7 days output while using convert on date,"SELECT 
    * 
FROM   
    emp 
WHERE   
    convert(datetime, date, 101)  BETWEEN (Getdate() - 6) AND Getdate() 
ORDER BY 
    date 
"
24493,42266,How to join two tables and replace null in second table with zero,"select A.orderNo, coalesce(B.Price, 0) as Price
from A left join
     B
     on A.ProdID = B.ProdID;
"
35511,47033,PostgreSQL complex update operation on column,"update Event e set e.placeListingName = 
    (select substr(coalesce(epc.shortTitle, epc.title),1,100) 
    from Event ev join ev.place p join p.publicContent epc 
    where ev.id = e.id) 
where e.place is not null
"
1489,54927,SQL GROUP BY multiple fields,"SELECT *
FROM (yourquery)
GROUP BY producer
"
21983,61345,Restoring SQL table into new table with more columns,"Insert into taggings (id,tag_id,taggable_id,taggable_type,created_at) values (...your values...)
"
1932,48629,MS access query aggregation,"SELECT sales.item_id, items.item_name, SUM(sales.item_quantity), 
       SUM(sales.item_price), SUM(sales.net) 
FROM sales INNER JOIN items ON sales.item_id = items.ID 
WHERE sales.action_date=[Forms]![rep_frm]![Text13].[value] 
GROUP BY sales.item_id, items.item_name;
"
29115,12816,SQL Average Group By,"SELECT NBAGameLog.Opp, AVG(NBAGameLog.Points)
FROM Players INNER JOIN
     NBAGameLog
     ON Players.Player_ID = NBAGameLog.Player_ID
WHERE (NBAGameLog.Date_Played Between Date()-15 And Date() AND
      Players.Position = ""C""
GROUP BY NBAGameLog.Opp;
"
11111,3724,How to format the Available Value label field in Reporting Services,"=DATEADD(""d"", 1 - DATEPART(DateInterval.WeekDay, Today(),FirstDayOfWeek.Monday), Today())
"
8939,65634,SQL search for string containing characters,"Select * from TABLE where NAME REGEXP ""[abc]"";
"
35863,40223,ALL IF Null logic in SQL Server,"declare @sql varchar(500)
DECLARE @ParmDefinition nvarchar(500);

SET @sql='select * from a where 1=1 '
 if @Locationid  is null
set @sql=@sql +' and @LocationId is null'
 else
 set @sql=@sql +' and LocationID= @LocationId'

  EXECUTE sp_executesql @sql, N'@LocationId int',
              @LocationID ;
"
14700,24802,postgresql json aggregate,"select
  pid,
  json_agg(json_build_object('code',code,'name',name))
from
  ...
group by
  pid
"
36229,54797,Django - Filter a queryset by Max(date) year,"max_year = Expo.objects.latest('date').date.year
expos = Expo.objects.filter(date__year=max_year)
"
4683,23856,using union all in ordered query,"WITH ranked AS (
  SELECT
    name, ID, Date, Time, Cust_ID,
    rnk = ROW_NUMBER() OVER (PARTITION BY ID ORDER BY Time DESC)
  FROM Table1
  JOIN Table2 ON ID = Cust_ID
  JOIN Table3 ON c = d
  WHERE ID = 'ID0001'
)
SELECT name, ID, Date, Time, Cust_ID
FROM ranked
WHERE ID IN ('ID0001', 'ID0002', 'ID0003')
  AND rnk = 1
"
39,74909,SQL query to make a list from multiple tables,"SELECT i.code,
       i.description,
       it.description,
       sc.description,
       um.description
FROM items AS i
INNER JOIN itemtype AS it
    ON i.item_type_id = it.id
INNER JOIN subcategory AS sc
    ON i.subcateg_id = sc.id
INNER JOIN uom AS um
    ON i.uom_id = um.id
"
30817,50662,Is it possible to assign select values to variables in sql?,"select count(user_id), name_alias
from (
  select user_id, substr(name, 0, 5) as name_alias
  from users
)
group by name_alias;
"
4944,48197,Mysql query for selecting friends,"SELECT  actors.first_name,
        actors.last_name
FROM    actors
WHERE   actors.login IN
(
    SELECT  friendslist.loginf
    FROM    friendslist
    WHERE   friendslist.logina = 'xstad'
)
"
3627,1830,Sorting within groups,"SELECT t1.* 
FROM tbl t1
JOIN ( SELECT SubjectID
            , MAX(lastUpdatedDate) AS lastUpdatedDate
       FROM tbl 
       GROUP BY SubjectID ) t2 ON t1.SubjectID =  t2.SubjectID
                              AND t1.lastUpdatedDate =  t2.lastUpdatedDate
"
34520,9968,MySQL aggregation by strings,"SELECT data, event, logged_on AS latest_log_date
from activites a1
where not exists (select 1 from activites a2
                  where a1.data = a2.data
                    and a1.event = a2.event
                    and a2.logged_on > a1.logged_on)
"
22995,36366,SQL composite key syntax,"CREATE TABLE order_line (
order_id int NOT NULL,
car_id int NOT NULL);

ALTER TABLE order_line ADD CONSTRAINT order_line_PK PRIMARY KEY (order_id, car_id);
ALTER TABLE order_line ADD CONSTRAINT order_line_FK FOREIGN KEY (order_id) REFERENCES orders (order_id);
ALTER TABLE order_line ADD CONSTRAINT order_line_FK2 FOREIGN KEY (car_id) REFERENCES car (car_id);
"
8703,23328,get value between [ ] and value outside of [ ]through regular expression,"SELECT NVL(SUBSTR(var, 1, INSTR(var, ',') - 1), var)
FROM dual;
"
34628,56703,select * from table where datetime in month (without breaking index),"select *
from your_table 
where date_field >= '2010-01-01'
    and date_field < '2010-02-01'
"
2101,61756,selecting specific rows from database in sql,"SELECT * FROM (
  SELECT
    ROW_NUMBER() OVER (ORDER BY DayRangeId ASC) AS rownumber,
    DayRangeId
  FROM DayRangeTable
)  as temptablename
WHERE rownumber = 4
"
35958,36732,Zend_Db order by field Value,"$name = 'John';
$order = new Zend_Db_Expr($this->getAdapter()->quoteInto(""name = ?"", $name) ."" DESC, `name`"");
$select = $this->select();
$select->order($order);
return $this->fetchAll($select);
"
9157,65366,Three way join in SQL Server,"SELECT sp.EmployeeName,
       COALESCE(AVG(s.Qty * (sp.CommRate / 100.0) * a.Price), 0) as AvgCommRate
FROM SalesPeople sp LEFT JOIN
     Sales s
     ON s.EmployeeID = sp.EmployeeID LEFT JOIN
     Appliances a
     ON s.AppID = a.ID AND a.AppType <> 'Refrigerator'
GROUP BY sp.EmployeeName
ORDER BY AvgCommRate DESC;
"
38627,18718,"Pivot table to make all values appear in same row, multiple columns","SELECT
    Unit,
    SUM(CASE Month WHEN 'Jan' THEN CAST(Num AS DECIMAL(10, 2))/Denom ELSE 0 END),
    SUM(CASE Month WHEN 'Feb' THEN CAST(Num AS DECIMAL(10, 2))/Denom ELSE 0 END),
    ...
FROM
    Unit U
INNER JOIN UnitTest UT ON
    U.Id = UT.UnitId
GROUP BY
    Unit
"
21162,36382,Compare two tables in HIVE,"SELECT nt.c1,
       CASE WHEN ct.c2 <> nt.c2 THEN '--' ELSE  nt.c2 END,
       CASE WHEN ct.c3 <> nt.c2 THEN '--' ELSE  nt.c3 END
FROM 
New_table nt
JOIN Control_table ct ON nt.c1 = ct.c1
WHERE
ct.c2 <> nt.c2 OR ct.c3 <> nt.c3
"
33290,14300,about full text query in SQL,"SELECT Name, Color FROM Production.Product
WHERE CONTAINS((Name, Color), 'Red');
"
3487,14261,How to convert Minutes to Hours Minutes and Seconds in SQL?,"select extract (hour from numtodsinterval(timee, 'MINUTE')) || ' hours, '
  || extract (minute from numtodsinterval(timee, 'MINUTE')) || ' minutes, '
  || extract (second from numtodsinterval(timee, 'MINUTE')) || ' seconds' as xyme
from (select 125.58 as timee from dual);

XYME                                   
----------------------------------------
2 hours, 5 minutes, 34.8 seconds         
"
22523,70238,"SQL union same number of columns, same data types, different data","select * 
from
(
    SELECT 'S1' as dataset, Id, Name, COUNT(*) as resultcount FROM Customers where X
    union
    SELECT 'S2',Id, Name, COUNT(*) FROM Customers where Y
) s
pivot
(sum(resultcount) for dataset in (s1,s2)) p
"
20661,40621,getting second to last record per group in SQL,"SELECT * 
FROM (
select job AS qjob
      , id AS qid
      ,ROW_NUMBER() OVER (PARTITION BY JOB ORDER BY ID DESC) AS RN
from sqbclog
)Sub
WHERE rn <= 2
"
22530,7899,Array parameter for TADOQuery in Delphi 2010,"SELECT * FROM MyTable WHERE Id IN (:id1, :id2, :id3)
"
37869,653,Combine two tables by column,"UPDATE 
   t1 
SET
  t1.NEWID = t2.ID
FROM
  table1 t1
  INNER JOIN table2 AS t2 ON t1.NAME = t2.NAME;
"
7348,17211,SQL Left Join Conditions,"Select a.ID,
a.AssociateName,
a.FormTypeID,
coalesce(b.Segment1, c.Segment1),
coalesce(b.Segment2, c.Segment2)
From NinjaTable a
Left Join ShinobiTable b On b.AssociateName = a.AssociateName and b.AssignmentStatus = 'Active'
Left Join ShinobiTable c On c.AssociateName = a.AssociateName and c.AssignmentStatus = 'Inactive'
"
35410,68826,OrientDB Traverse SQL query efficiency,"SELECT FROM (
   TRAVERSE out('belongsTo', 'hasPermission') FROM #23:0 WHILE $depth <=2
) WHERE @class='Role'
"
10012,23451,How to do a group by clause with a max,"SELECT max(insert_date) AS insert_date, creative_id, creative_object
from rtb_creatives 
where adgroup_id='agid1608844879' and is_delete in (0)
group by creative_id, creative_object
"
36808,9901,SQL Select the similar products,"select p.* 
from manager m1
join manager m2 on m1.fk_category = m2.fk_category
Join product p on m2.fk_product = p.id
where m1.fk_product = 1 and m2.fk_product <> m1.fk_product
"
22759,12393,Insert rows autoincrement on multiple columns,"declare @StartValue int
SELECT @StartValue = MAX(UserFile) FROM tbl_Users 

INSERT INTO tbl_Users (UserFile,Name)   
    SELECT 
        (@StartValue + ROW_NUMBER() over (order by (select 1))) as IncrementNumber, 
        Name  
    FROM 
        tbl_ContactPerson  
    WHERE 
        (ContactType = 'U') 
"
705,33244,Getting the definition of the tables and columns via a sql statement,"SELECT obj.name, cols.name as columnname
from dbname.sys.objects as obj
inner join dbname.sys.columns as cols
on obj.object_id = cols.object_id
where obj.type='U'
"
1793,2596,Contacts with items and attributes.. 1 column or many?,"Contacts
id, name, etc...

Items
id, name, ...

ItemAttributes
id, item_id, attribute_name, value, etc...

ContactItems
contact_id, item_id
"
32507,22407,Splitting a string in a stored procedure,"SELECT @len=LEN(@str)

WHILE(@i <=@len)

    BEGIN

        if (SUBSTRING(@str1,@i,1)=@str2)

            BEGIN

                SELECT @laststr = SUBSTRING(@str1,@i+1,@len) 
                break
            END
        SELECT @i = @i + 1
    END
"
31459,23428,Calling Oracle Stored proc with user define type array,"declare
  v_pk   my_pk_arr;
  v_cur  t_cursor;
begin

  v_pk := MY_PK_ARR(MY_PK(1, 'a'), MY_PK(2, 'b')); -- or build in a loop etc.
  get_data(v_pk, v_cur);

end;
/
"
23047,27272,Finding and Deleting duplicate rows in table where multiple occurances of records is allowed,"SELECT count(bookNumber), booknumber, customerID FROM TableName GROUP BY booknumber, customerID having count(booknumber)> 1
"
13988,75486,"T-SQL, Cursors, FETCH INTO. How to use SELECT *","INTO @variable_name[ ,...n]
"
32566,68851,"How to add a third piece to a ""Case"" statement","CASE
  WHEN t1.Register_Transaction_Type = 'Quick' THEN 'QuickSale'
  WHEN t2.Vehicle_Tag IS NULL THEN 'NO'
  ELSE 'YES'
  END AS [Re-tendered?]
"
9829,12292,Concatenate a selected column in a single query?,"DECLARE @Names varchar(1000)
SELECT @Names = COALESCE(@Names + ', ', '') + Name
FROM Employees
"
14127,51238,Compound mysql Select After outer join,"SELECT
  SUM(A.a + IFNULL(B.c, <default_value>))
FROM A 
LEFT OUTER JOIN B ON A.b = B.b;
"
17398,1958,Query not working as expected in stored procedure,"Select *  From callforwarding 
Where  Mastercode in (select SRFID from @SRFTable)
    and ApproverNo = @empID
    and ForwardDate in 
               (Select max(ForwardDate) from CallForwarding
                where Mastercode in (select SRFID from @SRFTable)
                and ApproverNo = @empID
                group by Mastercode)
"
9100,52759,Aggregating 2 Tables in tSQL,"SELECT USER, SUM(HITS) HITS
FROM
(SELECT USER, HITS
FROM Tbl1 UNION ALL
SELECT USER, HITS
FROM Tbl2) A
GROUP BY USER
"
9790,54683,How to get substring from given character?,"print substring(@s, charindex('\', @s) + 1, len(@s));
"
39779,67338,MySQL - order by string date,"SELECT p.*, s.meta_value
FROM posts p 
LEFT JOIN storage_varchars s ON p.id = s.post_id 
WHERE parent_id = 20 AND STR_TO_DATE(s.meta_value, '%d-%m-%Y') >= CURRENT_DATE() 
ORDER BY STR_TO_DATE(s.meta_value, '%d-%m-%Y') ASC;
"
28671,59590,How to retrieve all values from xml in SQL,"DECLARE @XML XML
SET @XML='<XML>
    <Id>1</Id>
    <Age>1</Age>
    <Address>Test</Address>
    <Days>
      <long>1</long>
      <long>2</long>
      <long>3</long>
      <long>7</long>
    </Days>
  </XML>'

SELECT 
    x.y.value('text()[1]', 'int') as xx
FROM @xml.nodes('XML/Days/long') x(y)
"
5678,4765,Can mongorestore take a single url argument instead of separate arguments?,"CMD=`meteor mongo -U autocomplete.meteor.com | tail -1 | sed 's_mongodb://\([a-z0-9\-]*\):\([a-f0-9\-]*\)@\(.*\)/\(.*\)_mongorestore -u \1 -p \2 -h \3 -d \4_'`
$CMD /path/to/dump
"
18146,47442,Complex SQL Query - nested query,"SELECT jf.job_id,
       jf.name, 
       MIN(ij.date) AS first_job_date, 
       MAX(ij.date) as last_job_date, 
       COUNT(*) as count_of_jobs
FROM job_form jf
  INNER JOIN individual_job ij
    ON jf.job_num = ij.job_num
GROUP BY jf.job_id, jf.name -- i.e. non-aggregated select fields here
"
13073,8788,SQL query to pull unique records,"SELECT DISTINCT  Cateogory, Subcategory 1, Subcategory 2
FROM your_table
"
1817,73290,ElasticSearch map two sql tables with a foreign key,"{
    ""ID"": 1,
    ""Name"": ""Episode 2"",
    ""TVSeriesID"": 4,
    ""TVSeriesName"": ""Friends""
}
"
4874,65153,Sorted data in groups,"SELECT
    a.id, b.uid, a.uid_list, a.groupcount, a.activity, a.postid
FROM (
    SELECT
        MAX(id) as id,
        GROUP_CONCAT(DISTINCT uid ORDER BY id DESC) as uid_list,
        COUNT(*) as groupCount,
        activity,
        postid
    FROM user_activities a
    GROUP BY
        activity, postid
    ) a
    INNER JOIN user_activities b ON a.id = b.id
"
9181,72245,"How to delete duplicate (repetitive) records, rows from table without id",";with cte as (
    select
        name,
        row_number() over (partition by name order by name) row
    from
        dublicateTable
)
delete from cte where row > 1
"
8483,48459,First day Of this week and last week,"Select dateadd(wk, datediff(wk, 0, getdate()) - 1, 0) as LastWeekStart
Select dateadd(wk, datediff(wk, 0, getdate()), 0) as ThisWeekStart
Select dateadd(wk, datediff(wk, 0, getdate()) + 1, 0) as NextWeekStart
"
19251,60946,Select a non dateformat value from a table,"SELECT * FROM TABLEANME WHERE CHARINDEX('/',Date)=0
"
7739,8060,Split string on embedded character,"INSERT dbo.mastertable (id, length, width, height)
SELECT 
  ID, 
  L, 
  W = SUBSTRING(R, 1, CHARINDEX('x', r)-1),
  H = SUBSTRING(R, LEN(R)-CHARINDEX('x', REVERSE(r))+2, 255)
FROM
(
  SELECT ID, LWH, 
    L = SUBSTRING(LWH, 1, CHARINDEX('x', LWH)-1),
    r = SUBSTRING(LWH, CHARINDEX('x', LWH)+1, 255)
  FROM dbo.importtable
) AS x;
"
12691,11485,Reverse engineer an ORM,"$ python manage.py inspectdb > models.py
"
31329,60824,SQL Server LEFT JOIN and WHERE clause,"SELECT ID, Name, Phone 
FROM Table1 
LEFT JOIN Table2 
ON Table1.ID = Table2.ID AND Table2.IsDefault = 1
WHERE Table1.ID = 12
"
31973,34869,SQL VB.net insert using select AND values,"Insert into [MyTable] (Max,Value1,Value2,Value3) values((select Max(Number) from Table1),@p1,@p2,@p3)
"
8100,3903,Determining which tables have GRANT SELECT to a specific custom role,"USE yourDB;
GO
EXEC sp_table_privileges 
   @table_name = '%';
"
10263,69195,How to find current transaction level?,"SELECT CASE transaction_isolation_level 
WHEN 0 THEN 'Unspecified' 
WHEN 1 THEN 'ReadUncommitted' 
WHEN 2 THEN 'ReadCommitted' 
WHEN 3 THEN 'Repeatable' 
WHEN 4 THEN 'Serializable' 
WHEN 5 THEN 'Snapshot' END AS TRANSACTION_ISOLATION_LEVEL 
FROM sys.dm_exec_sessions 
where session_id = @@SPID
"
32112,7796,first duplicate and then change ID of duplicated data in mysql," INSERT INTO anag_competenze_medico (id_global_key, ...)
    (SELECT 'newID',....
    FROM anag_competenze_medico 
    WHERE id_global_key= 'oldID')
"
9400,54663,Setting a default date format on PostgreSQL,"CREATE OR REPLACE FUNCTION to_char(timestamptz) RETURNS text AS
$$
    SELECT to_char($1,'YYYY/MM/DD~HH24:Mi:SS'); -- here your default setting
$$
LANGUAGE SQL;
"
23783,22336,SQL Join on tables with from to entries,"SELECT          *
FROM            table1
INNER JOIN      table2 ON  table2.Entry >= table1.[From entry] 
                       AND table2.Entry <= table1.[To entry]
"
10155,20720,SELECT specific columns from EXEC stored procedure,"if OBJECT_ID('SomeProc') is null
    exec ('create procedure dbo.SomeProc as select 1 as SomeValue union all select 2 as SomeValue;')

exec dbo.SomeProc

Select @@ROWCOUNT as RowsAffected
"
30388,35219,How to Update with a Self join?,"update results as r set
    status = 'W'
from (
    select t.seats, max(t.votes) as max_votes
    from results as t
    group by t.seats
) as a
where a.seats = r.seats and a.max_votes = r.votes; 
"
2648,26898,Displaying count of item in one table and all it's columns in another,"select p.p_inv,
       p.p_name,
       p.p_price,
       s.s_num,
       s.s_in_stock,
       count(select * from product p,stock s where p.p_inv=s.s_inv) 
as rows_count 
from product p 
join stock s on p.p_inv=s.s_inv 
order by p.s_inv;
"
28605,68989,How do you reduce a long query running up mysql resources that requires you to run multiple searches?,"Select news.*
From news n
    Join subscriptions s
       On s.subscribed_id = n.user_id
Where subscriber_id = <user id of john>
"
26439,43550,Correct way to use SQL Intersect,"select indid, indname
from indData
group by indid, indname
having SUM(case when pid = 1 then 1 else 0 end) > 0 and
       SUM(case when pid = 2 then 1 else 0 end) > 0 and
       SUM(case when pid = 3 then 1 else 0 end) > 0;
"
28202,63163,select query based on priority,"SELECT
    id, 
    P.createdonutc,  
    Dense_Rank() OVER (ORDER BY cast(p.[CreatedOnUtc] AS DATE) desc) as num
FROM
    news p
ORDER BY num
"
12889,52717,Problem with joining to select statements,"SELECT (
    SELECT COUNT( WiningComment)
    FROM Threads
    WHERE WiningComment IN (SELECT CommentsID
    FROM Comments
    WHERE  UsersID=@UserID)
) as 'WinningAnswers',
(
    SELECT COUNT(CommentsID)
    FROM  Comments
    WHERE  UsersID=@UserID
) as 'TotalAnswers'
"
9318,5484,use group by clause and count() in subquery,"SELECT        Class.class_id, Class.ClassName, COUNT(*) AS count
FROM            Class INNER JOIN
                         Groups ON Class.class_id = Groups.class_id
GROUP BY Class.class_id, Class.ClassName
"
1913,28745,Oracle Apex - Dynamically check checkbox item that is not within a report,"SELECT
  at.name AS TITLE,
  CASE WHEN at.name IN (SELECT atp.name FROM preferences p) THEN
    '<input type=""checkbox"" value=""'||at.value||'"" checked=""checked"" />'
  ELSE
    '<input type=""checkbox"" value=""'||at.value||'"" />'
  END AS CHECKBOX
FROM
  [...]
"
18733,62460,SQL Server store multiple values in sql variable,"declare @caroptions table
(
    car varchar(1000)
)

insert into @caroptions values ('BMW')
insert into @caroptions values ('Toyota')
insert into @caroptions values ('Nissan')

select * from cars where make in (select car from @caroptions)
"
32159,13066,Assign null if subquery retrieves multiple records. How can it be done?,"SELECT tm.LocID  = (SELECT CASE COUNT(*) WHEN 1 THEN MAX(LocID) END
                     FROM   tblLoc tl
                     WHERE  tl.LocID = tm.LodID )
FROM   tblMain tm
"
31130,30071,Filesystem like permissions in DBMS,"CREATE TABLE user_entity_permissions(
    UserID bigint not null,
    EntityID bigint not null,
    EntityType int not null,
    Permissions int not null,
    constraint ""PK_usp"" primary key (""UserID"", ""EntityID""),
    constraint ""FK_usp_users"" foreign key (""UserID"") references ""users""
    --- Third FK constraint ---
    );
"
29478,64563,Merge data from two cells from the same column in different rows in MySQL/MariaDB,"SELECT pkm.pkm_code, pkm.pkm_name, group_concat(type.type_name) as typename FROM poketype
    JOIN pkm ON pkm.pkm_code=poketype.pkm_code
    JOIN type ON poketype.type_code=type.type_code
    WHERE pkm.pkm_code<=151
    GROUP BY pkm.pkm_code, pkm.pkm_name;
"
20470,17064,How to check if one row in one table is in the other table using mysql?,"SELECT  a.col1, a.col2, COUNT(b.col1)
FROM table1 a LEFT JOIN table2 b
ON (a.col1 = b.col1 OR a.col1 = b.col2) 
AND (a.col2 = b.col1 OR a.col2 = b.col2)
GROUP BY a.col1, a.col2
"
18059,11817,"Return null value as '0' in group by clause, postgresql","SELECT  s.created_at, COUNT(o.subsription_id)
FROM    subscriptions s
LEFT JOIN
        orders o
ON      o.subcription_id = s.id
GROUP BY
        s.created_at
"
34546,35882,CSV of IDs to CSV of Values,"SELECT ID, things = STUFF(
(
  SELECT ',' + t2.thing 
     FROM Table2 AS t2
    INNER JOIN Table1 AS ti
    ON ',' + ti.ids + ',' LIKE '%,' + CONVERT(VARCHAR(12), t2.id) + ',%'
    WHERE ti.ID = tout.ID
    FOR XML PATH, TYPE
).value('.[1]', 'nvarchar(max)'), 1, 1, '')
FROM Table1 AS tout
ORDER BY ID
"
37964,15308,Joining tables with a historical timeline,"select a.id, a.timestmp, b.value
from A left outer join
     (select b.*,
             lead(timesmtp) over (partition by id order by timesmtp) as nextTS
      from B
    ) b
    on a.id = b.id and
       a.timestmp >= b.timesmtp and
       a.timestmp < coalesce(nextTS, a.timestmp)
"
30037,5786,SQLite - how to get average value?,"select avg( columnname) from table;
"
13005,1875,Retrieve List of all SPs with some condition,"select OBJECT_NAME(object_id) 
from sys.sql_modules
where  OBJECTPROPERTY(object_id,'IsProcedure') = 1 and 
    definition like '%StudentId%' 
"
22742,42645,Oracle INSERT INTO table of type collection,"INSERT INTO 
  COLLECTION_TABLE 
    values (2, COLLECTION_01(
      dept_typ_01(
          (PERSON_TYP ('name1','ssn1', 'addr2')),
          (PERSON_TYP ('name2','ssn2', 'addr2'))
        )
      )
    );
"
34809,53889,Is there a way to drop a User Defined Table type that is already bound to a stored procedure?,"if object_id(N'dbo.<tablename>') is null
begin <create table chunk> end
"
34593,7427,last_insert_rowid in sqlite - two tables,"INSERT INTO films (name) values ('Shark!');
INSERT INTO reviews (filmId,review) values (last_insert_rowid(), 'Good!');
"
20382,35958,Sqlite: Get Modal/Mode from two related columns,"SELECT usr, sum(cnt)
FROM
 (
   SELECT wuser as usr, count(*) as cnt
   FROM game 
   GROUP BY wuser

   UNION ALL

   SELECT buser, count(*) 
   FROM game 
   GROUP BY buser
 ) AS dt
 GROUP BY usr
 ORDER BY sum(cnt) DESC;
"
35099,14361,"Sql if one column returns null, the whole resultset is null","SELECT CASE WHEN (coalesce(sum(volume),0)) IS NULL
            THEN NULL
            ELSE 'False' 
       END AS COL_1, 
       coalesce(sum(volume),0) AS COL_2 
FROM table1 
WHERE eligible LIKE 'False%' AND Month = :month
"
4410,28010,MySQL - Total count & rate of change in a single SQL query,"select 
  t1.HitDate,
  t1.City,
  t1.Client,
  SUM(t1.NumVisits)  -   IFNULL((SELECT SUM(t2.NumVisits) FROM PAGE_HITS t2 WHERE t2.HitDate = t1.HitDate-1 AND t2.City = t1.City AND t2.Client = t1.Client), 0)  as rate_of_change
from
  PAGE_HITS t1
WHERE
t1.Client='C'
 group by
   HitDate,
   City
   ORDER BY HitDate;
"
22947,42570,simple mysql query with a condition,"SELECT * FROM RestaurantName ORDER BY RestaurantTime ASC;
"
10505,31349,SQL select rows where field contains word from another table's fields,"SELECT l.* 
FROM leads l
JOIN keywords k on instr(leads.name, word) > 0 
"
27221,57664,Oracle single query with multiple lookups to same table,"select ...
  ,(select c1.catdesc from category c1
    where c1.catcode=activity.productcode)  as product
  ,(select c2.catdesc from category c2
    where c2.catcode=activity.calldrivercode)  as calldriver
...
"
19472,60276,date condition to retrieve data in a 24 hour time window mysql,"WHERE DATE(insert_date) = CURDATE() - INTERVAL 1 DAY
"
5670,45404,OnDemand arsdoc query against the system log,"
         -1              -1
"
16418,27668,Compare two table in sqlite,"SELECT DISTINCT Field1
FROM Table1 
WHERE Field1 Not IN 
    (SELECT DISTINCT Field1 FROM Table2)
"
24014,31195,Get between ages from date of birth in sql,"select * from users where datediff(year, dob, getdate()) between 10 and 20;
"
10619,72621,select records in a table that are repeated twice using MYSQL,"select list_id
from yourtable
group by list_id
having count(*) = 2
"
12999,50447,SQLite query select all records that does not exist in another table,"SELECT * FROM exercise WHERE exerciseID not in (SELECT exerciseID FROM bookedExercise)
"
11212,68766,MySQL Ignoring Specific Rows?,"SELECT DISTINCT
    p.position_ID,
    Title,
    EmployerName,
    Industry
FROM position p
JOIN application a
    ON p.position_id = a.position_id
JOIN employer e
    ON p.employer_id = e.employer_id
WHERE
    applicationstatus != 'S'
    AND NOT EXISTS(
        SELECT 1
        FROM application
        WHERE
            position_id = a.position_id
            AND applicationstatus = 'S'
    )
"
2225,14315,Calculate Sum() but excluding JOIN,"SELECT
  S.submit.date,
  ,sum(s.point)
  ,COUNT(s.sales_id) as TotalSales
  ,SUM(SL.SalesLines) as TotalLines
FROM
 sales S
INNER JOIN 
(Select
  sales_id
  ,count(distinct id) as SalesLines
 FROM
   sales_lines
 GROUP BY
  sales_id) SL
ON S.sales_id = SL.sales_id3
GROUP BY
 s.submit_date
"
30570,23000,How to get number from String sql,"WITH SampleData(string) AS(
    SELECT 'mn21' UNION ALL
    SELECT 'mnp100'
)
SELECT
    string, 
    Number = CAST(RIGHT(string, LEN(string) - PATINDEX('%[0-9]%', string) + 1) AS INT)
FROM SampleData
ORDER BY Number
"
6279,61848,JOIN across two tables,"SELECT a.vehicle, a.dev_name, dev_model, dev_serial, mac
FROM assets a
LEFT JOIN macs m ON m.vehicle = a.vehicle 
                 AND m.dev_name = a.dev_name
WHERE interface = 'E0'
ORDER BY a.vehicle, a.dev_name
"
30911,70250,SubSonic 2.1 SqlQuery multiple Where()s?,"new Select().From().Where(""1"").IsEqualTo(""1"");
"
32449,13472,alter data type of existing column from bigint to varchar in Apache derby,"UPDATE Country SET LawID_NEW = TRIM(CHAR(LawID));
"
7639,65456,PostgreSQL performing an OR merge of two similar tables,"select year, 
       coalesce(a.r001, b.r001) as r001,
       coalesce(a.r002, b.r002) as r002
from table_a a
  full outer join table_b b using (year)
order by year;
"
11745,35412,sql query to count tagged posts,"SELECT tag, (SELECT COUNT(1) 
             FROM tag_newPosts t2
             WHERE t2.tag LIKE CONCAT('%',t1.tag,'%')) AS tag_count
FROM tags t1;
"
32654,24634,join and select operation on two tables,"SELECT
  t1.*
FROM
  table1 t1
  inner join table2 t2 on (t1.sku = t2.sku)
WHERE
     t1.sku = 'TERM'
  or t2.alt_sku = 'TERM'
"
18143,14628,Pull column twice from same table without subquery,"select a.*, b.head as nullhead
from pages a, pages b
where a.id in ( '$id1', '$id2' )
and b.id = '0'
"
24526,42816,Postgres sql select result based on a ranking derived from a text column,"select distinct on (date) *
from t
order by date, run desc
"
36850,22068,update multiple column in table using same table data in postgres?,"update 
    fk_pay_cal 
set 
    marketplace_fee = 
        (totalprice * commission/100 + shippingcharge + fixed_fee) * (service_tax /100+ 1),
    settlment_value = 
        totalprice 
        - (totalprice * commission/100 + shippingcharge + fixed_fee) * (service_tax /100+ 1);
"
34633,45062,Sql query percentate change of two data,"select name,
       ((max(case when number = 1 then price end) - 
         max(case when number = maxn then price)
        ) /
         max(case when number = maxn then price end)
       )
from (select t.*,
             max(number) over (partition by name) as maxn
      from t
     ) t
group by name;
"
6052,44097,Serial Number in the form of week number in query,"Select 
  'Week ' + cast(ROW_NUMBER() OVER (ORDER BY Date) as varchar(10)) As SlNo, 
  count(distinct(RepID))
from Reptable   
where Month(Date) = @Month
group by Datepart(week, Date)
"
12154,52815,SQL QUERY TO SHOW 2 COLUMN WITH DIFFERENT CONDITION,"select witel,
       sum(case when KATEGORI = 'S' AND MONTH = 3 then 1 else 0 end) as count1,
       sum(case when KATEGORI = 'S' then 1 else 0 end) as count2
from table t
group by witel;
"
35057,15187,I have a excel file and want to delete some data before the first <br /> tag,"Sub sample()

    Dim str_Val As String
    Dim start As Long
    str_Val = ""Donkeys are <a href=""""#"""">also</a> humans <br /> hello hello hello <br /> hey hey hey""
    start = InStr(1, str_Val, ""<br />"", vbTextCompare) + Len(""<br />"")
    MsgBox Right(str_Val, Len(str_Val) - start)
End Sub
"
39042,63028,Stored Procedure to grab most recent database entry with one parameter?,"SELECT TOP 1 *
FROM dbo.Document 
WHERE Description = @yourparameter
ORDER BY CreatedDate desc
"
28734,70413,Is there any optimizations I can do with this statement to get the count of used rows?,"SELECT @TotalUsed = COUNT(DISTINCT i.ProductInfoId) 
FROM ProductInfo i WITH (NOLOCK) 
JOIN ProductOrderInfo oi WITH (NOLOCK) 
    ON io.ProductInfoId = i.ProductInfoId
"
7944,25425,Escape for comments in SQL files with liquibase,"INSERT INTO user (id,firstname,lastname,mystring) VALUES
(11,'Wendy','Salinas','this is my string-'  '-and it continues'),
(12,'Kirsten','Parker','this is the string of Kirsten')
"
5815,75400,Inner join two tables with OR conditions,"SELECT COUNT(*) FROM contestant_flags
LEFT JOIN contestants ON contestants.id = contestant_flags.contestant_id
LEFT JOIN teams ON teams.id = contestant_flags.team_id
WHERE contestant_flags.flag_id = 1
AND contestant_flags.call_id IS NULL
AND COALESCE(contestants.instance_id, teams.instance_id) = 13;
"
30655,48651,SQL Server equivalent to MySQL enum data type?,"mycol VARCHAR(10) NOT NULL CHECK (mycol IN('Useful', 'Useless', 'Unknown'))
"
7316,73442,How to do row-wise comparison between SQL (Oracle) fields?,"select *
from tablename
where time < start_time
"
32511,56092,Debug Insert and temporal tables in SQL 2012,"INSERT INTO #temporaltable 
OUTPUT inserted.*
SELECT *
FROM ...
"
4054,50304,SELECT rows from a table that don't have related entries in a second table,"SELECT City, Name
FROM DOCTOR d, VISIT v
WHERE d.Specialty = 'family and comunity' 
          AND not exists(SELECT *
          FROM visit v WHERE v.doc_number = d.doc_number
          AND v.visit_date BETWEEN '2012-01-01' AND '2013-12-31')      
GROUP BY name, city
ORDER BY d.Name;
"
12845,31892,use variable in FROM statement,"declare @numrows int = (select count(*) from sys.servers)
declare @i int = 1
declare @Sql(1000)
declare @servername varchar(max)

while @i <= @numrows
BEGIN
select @servername = servernaam 
from #servers where rij = @i

set @Sql = 'select * from '+@servername+'.DATABASE.DBO.TABLE'
exec(@Sql)

set @i = @i+1

END
"
21861,33524,Skip first row in SQL Server 2005?,"DECLARE @MyTable TABLE 
(
    ID INT,
    Name VARCHAR(15)
)
INSERT INTO @MyTable VALUES (1, 'Alice')
INSERT INTO @MyTable VALUES (2, 'Bob')
INSERT INTO @MyTable VALUES (3, 'Chris')
INSERT INTO @MyTable VALUES (4, 'David')
INSERT INTO @MyTable VALUES (5, 'Edgar')

;WITH people AS 
(
    SELECT ID, Name, ROW_NUMBER() OVER (ORDER BY ID) RN
    FROM @MyTable
)
SELECT ID, Name
FROM people 
WHERE RN > 1
"
28279,38159,How to define a pl sql function with dynamic return types in Oracle?,"CREATE OR REPLACE PROCEDURE retrieve_info(field_id in integer, p_cursor in out sys_refcursor)
AS
BEGIN
  open p_cursor for 'select * from emp';
END;
"
5758,55095,Can I do a not in except for in my SQL query?,"SELECT * FROM table WHERE flag = 0 OR status <> 'Complete'
"
10276,75053,How do I grab a column from table B if it that column may or may not be there?,"SELECT  a.*, b.city
FROM    tableA a
        LEFT JOIN tableB  b
            ON a.ID = b.ID
"
29632,28386,"Iterating through rows where rows could be ""missing""","order by (case when t1.ordering > t2.number then 1 else 2 end),
         t1.ordering
"
1589,28773,Update duplicate rows except for one,"update 
wt_simple_data w1 
join ( 
  select 
   min(SIMPLEID) as SIMPLEID,
   CAMPID,
   MSISDN 
   from wt_simple_data 
   group by CAMPID,MSISDN 
)w2 
on w1.SIMPLEID > w2.SIMPLEID 
and w1.CAMPID = w2.CAMPID 
and w1.MSISDN = w2.MSISDN 
set w1.FLAG = '2' 
"
30559,72356,SQL Server - only join if condition is met,"INSERT INTO GroupToItem(GroupID, ItemID)
SELECT  g.ID,
        i.ID,
FROM    Group g
JOIN    Item i ON i.Val IN g.Range
WHERE   g.ID = @GroupID
and (g.ID in (3) or exists (select top 1 1 from GroupToItem gti where g.Parent = gti.GroupID AND i.ID = gti.ItemID))
"
15800,55293,MySQL query that checks if two user ids are friends,"SELECT a.userid1, a.userid2
FROM friendship a
INNER JOIN friendship b
ON a.userId1 = b.userId2 AND b.userId1 = a.userId2
"
13860,23546,"SQL Query, Selecting 5 most recent in each group","SELECT c1.*
FROM codes c1
LEFT OUTER JOIN codes c2
  ON (c1.language_id = c2.language_id AND c1.time_posted < c2.time_posted)
GROUP BY c1.id
HAVING COUNT(*) < 5;
"
8590,47095,MySQL finding duplicate items in a row,"select col
from (select a as col from table_a union all
      select b from table_a union all
      select c from table_a union all
      select d from table_a union all
      select a from table_b union all
      select b from table_b union all
      select c from table_b union all
      select d from table_b
     ) t
group by col
having count(*) > 1;
"
29208,23966,How do I select a date that is 4 days ago at this time?,"SELECT * FROM mytable WHERE created_at > sysdate - 4
"
19770,39698,sql - Update Trigger to populate a ModifyDate field,"CREATE TRIGGER dbo.TR_iu_MyTable__LastUpdated
 on dbo.MyTable
 after insert, update

AS

    SET NOCOUNT on

    UPDATE dbo.MyTable
     set LastUpdated = getdate()
     where MyTableId in (select MyTableId from inserted)
"
33854,40946,SQL join on values not in table primary keys,"SELECT b.id
FROM batch b
LEFT JOIN user u ON u.batch_id = b.id
WHERE u.id IS NULL
  AND b.submitted = 0
  AND b.project_id = ?
"
25806,68031,Trying SQL table update matching on string field,"UPDATE     tblJP
SET        tblJP.LangString = tblMaster.Long_Text
FROM       tblJP
INNER JOIN tblMaster ON tblMaster.alt_text = tblJP.short_text
WHERE      tblMaster.Lang = 'jp'
"
814,63402,how to use group_concat for some data like this?,"select concat(substring_index(list, ', ', cnt - 1), ' & ',
              substring_index(list, ', ', -1)  
             )               
from (select group_concat(color separator ', ') as list, count(*) as cnt
      from table t
     ) t;
"
18546,68649,DISTINCT WITH SUM,"SELECT ID, Name, SUM(Score), SomeID
FROM tableA 
GROUP BY ID, Name, SomeID;
"
12517,67490,Cypher accessing space separated relationship property neo4j,"START r=rel(0) RETURN r.`Some Property`;
"
22044,73217,Deleting records using different tables from different databases,"DELETE from db1.table1 WHERE 
db1.table1.Timestamp IN( SELECT Timestamp FROM db2.table2) ;
"
25037,40674,get tablename where the variable in a column matches,"SELECT * FROM (
    SELECT 
        'tblC1' as tbl, tblC1.*
     FROM   tblC1 
      UNION SELECT 'tblC2', tblC2.* FROM tblC2  
      UNION SELECT 'tblC3', tblC3.* FROM tblC3 
) t
where t.nname = ""new5""
"
35478,19666,SQL Query to fetch information based on one or more condition. Getting combinations instead of exact number,"select distinct
    a.ssn,b.[UID]
from [Analysis].[dbo].[Table1] a
cross apply
    ( select top 1 [uid] from [Proteus_8_2].[dbo].[Table2] where ssn = a.ssn ) b
where b.[UID] is not null
"
14231,9173,Microsoft t sql how to declare temporary variable within user defined function?,"create function someFunction(@someParam varchar(100))
returns @table (field1 type, field2 type, ...)
as 
begin
    declare @tempvar varchar(100)
    set @tempvar = ''--Set the var to something useful
    insert @table
    select * from sometable where somecolumn = (
        select top 1 someColumn
        from sometable
        where somecolumn = @tempvar
    )
    return
end
"
18695,27763,Like statement with quotes in sqlite database query?,"Cursor c = myDB.query(MY_DATABASE_TABLE, ""songname"",""songname like ?"" , new String[]{""%""+MATCH_STRING+""%""}, null,""SongHit"", null);
"
18937,39908,mysql + update top n,"UPDATE  table
SET     status = 1
WHERE   status = 2
ORDER BY id
LIMIT 400
"
14568,62847,SQL selecting a single record by comparing the different fields,"SELECT DISTINCT prp_hist_id
FROM tbl_proposal_workload
WHERE prp_hist_id NOT IN ( SELECT prp_hist_id FROM tbl_proposal_workload WHERE prp_response = 1 )
"
18405,40701,MySQL ROW_NUMBER for multiple columns,"select s.*
from (select t.*
      from t
      order by salary desc
      limit 10
     ) s join
     (select t.*
      from t
      order by grievances asc
      limit 5
     ) g
     on s.employeeid = g.employeeid;
"
8695,43477,Finding multiple (different) values under same ID SQL,"select distinct MisID, networkname
FROM dbo.CompiledStudentData as t1
inner join
(
    Select MisID FROM dbo.CompiledStudentData
    GROUP BY MisID
    HAVING COUNT(distinct networkname) >= 2
) as t2
on (t1.MisID = t2.MisID)
order by 1, 2
"
481,64352,mysql order by query issue,"SELECT name 
FROM site 
WHERE id >= ( SELECT id
              FROM site
              ORDER BY id
              LIMIT 50000, 1
            )
ORDER BY id
LIMIT 10 ;  
"
6257,30978,Access 2010 SELECT string,"""SELECT * FROM Agents WHERE TID LIKE '*"" & searchTID & ""*'""
"
10175,4369,Display a list of students where both students like each other in sql,"select A.name || ' likes ' || B.name
from   Highschooler A
join   likes          on A.id = Likes.ID1
join   Highschooler B on B.id = Likes.ID2
"
29233,51078,Avoiding a MySql Loop With Query,"select title
from packages p
inner join pack_to_tag pt on p.index = pt.pIndex
inner join keyworks w on w.index = pt.kindex
where word in ('keyword','array','returns','all','results')
group by title
having count(*) = 5
"
6247,67285,Include rows even if count is zero,"DECLARE @now DATETIME = GETDATE()

SELECT PERSON, SUM(CASE
            WHEN CASEDATE > CONVERT(DATE, DATEADD(dd, -(DATEPART(dw, @now)-1), @now))
                 THEN 1 ELSE 0 END)
FROM TASKS
GROUP BY PERSON
ORDER BY PERSON
"
770,72434,MySql: Grouping a grouped statement possible?,"select employeeid, sum(short)
from (
   <your sql here>
) sub
group by employeeid
"
24762,11420,I need to use DATEDIFF to get the difference in minutes between the start and finish of a route patrol,"SELECT PatrolID,
       DATEDIFF(minute,
                MIN(CASE WHEN ACTION = 'PATROL_STARTED' THEN [Occurrence Date] END),
                MAX(CASE WHEN ACTION = 'PATROL_FINISHED' THEN [Occurrence Date] END)
               ) AS Duration 
FROM [Data Import] AS t 
GROUP BY PatrolID;
"
6133,67371,Get active rows between from and to date range inclusive of boundary,"SELECT * FROM testTable tt
WHERE (tt.started >= fromDate AND tt.started < DATEADD(DAY, 1, toDate)
   AND tt.ended >= fromDate AND tt.ended < DATEADD(DAY, 1, toDate))
   OR SessionIsRunning = true
ORDER BY tt.sessionid
"
5959,35146,How to union two rows in one by connecting it on some cell in SQL?,"select
  a, b, c, listagg(col_with_VA_Values, ', ') within group (order by ...)
from
  table
group by
  a, b, c;
"
10371,37111,selecting rows which contain certain characters,"SELECT * FROM products 
WHERE prod_id LIKE '__hp%'
AND price > 150;
"
39315,48338,"How to UNION ALL multiple SELECT queries in VBA, without typing SQL in VBA?","dim i as integer

for i = 1 to 7
    docmd.runsql ""insert into temp table select * from qry_Input_"" + CStr(i)
next i
"
20540,63346,I need to dynamically set the date in a where statement to only pull results from a table to occur in County's fiscal year,"declare @fiscalStart = select cast('07/01/' + 
        Cast((datepart(year, getdate())-1) as varchar(4)) as datetime)

declare @fiscalEnd = select dateadd(second, -1, cast('07/01/' + 
        Cast(datepart(year, getdate()) as varchar(4)) as datetime))


SELECT     nature, inci_id, calltime, agency, gp
FROM         inmain AS inmain
WHERE calltime between @fiscalStart and @fiscalEnd
ORDER BY nature, calltime
"
31769,49196,Inverting columns to row header in sql,"DECLARE @result VARCHAR(MAX) = 'IPHONE '

SELECT @result += AttName + ' ' + Attval + ' '
FROM TempInve
WHERE productCode = 'IPHONE'

SELECT @result
"
26779,14666,Conditions with And Or statements,"$this->Model->find('all', array('conditions' => array('OR' => array(

              array('UserEntityVarchar.entity_id' => 1, 
              'EavAttribute.attribute_code' => 'firstname'),

              array('UserEntityVarchar.entity_id' => 1, 
              'EavAttribute.attribute_code' => 'lastname')))));
"
9990,1879,Helping to Understand Web Services and REST,"namespace MyApplication 
{ 
    public class myWebService : System.Web.Services.WebService 
    { 
        private classEmployee _emp = new classEmployee(); 

        [HttpGet]
        public string GetEmployees() 
        { 
            string EmployeeData = string.Empty; 
            EmployeeData = _emp.GetEmployees(); 
            return EmployeeData; 
        } 
    } 
}
"
21100,24507,"How do I connect to the default instance of SQL if a ""named instance"" parameter is required?","SELECT @@SERVERNAME + '\' + @@SERVICENAME AS InstanceName
"
35066,40767,"Make MySQL ignore ""The"" from the start of a LIKE condition?","SELECT  *
FROM    company
WHERE   (name LIKE '?%' AND NOT name LIKE 'The %')
        OR name LIKE 'The ?%'
"
18837,46514,How to store only time; not date and time?,"create table t1 (time_of_day interval day (0) to second(0));

insert into t1 values (TO_DSINTERVAL('0 23:59:59'));

select date '2009-05-13'+time_of_day
from   t1;
"
15926,43349,Compare first row to other rows,"WITH complex_query AS
    ( ... complex query here ... ) 
SELECT 
  FROM complex_query cq1
 WHERE cq1.english_grade = ( SELECT english_grade FROM cq1
                              WHERE rownum = 1 )
"
16783,7758,query for roww returning the first element of a group in db2,"SELECT * FROM Table1 
WHERE ID IN (SELECT MIN(ID) FROM Table1 GROUP BY FLD_A)
"
36235,42125,Select last ten items from a specific row in a table,"SELECT TOP 10 Line_ID, Run_Date, Product_ID, Pallet_Cd, Run_Qty
FROM YourTable
WHERE Pallet_Cd >= '00801004718000000007'
ORDER BY Pallet_Cd
"
35823,24200,DateDiff returns negative value in sql,"Declare @ActualTime Numeric(10,2)=677.00

SELECT CASE WHEN ClosedOn > VendorTicketRaisedOn 
            THEN 0
       ELSE Convert(Numeric(10,2),(100*((@ActualTime-(Convert(Numeric(10,2),CONVERT(VARCHAR(10),SUM(DATEDIFF(MINUTE,VendorTicketRaisedOn ,ClosedOn)) / 60)+'.'+ Right('00'+CONVERT(VARCHAR(2),SUM(DATEDIFF(MINUTE, VendorTicketRaisedOn , ClosedOn)) % 60),2))))/@ActualTime*1)))
      END AS [AGS Uptime %]
FROM Ticket
"
32610,32510,SQL Developer define a substitution variable using functions and concatenation,"define startdate='01-JAN-14'

var bind_sdt varchar2(3);
exec :bind_sdt := SUBSTR('&&startdate',4,3);
column sub_sdt new_value sdt;
select :bind_sdt as sub_sdt from dual;

SPOOL &&sdt._File.csv
"
18536,70403,Querying MySQL to get price from 4 tables,"SELECT 
    features_services.idService AS cid,
    SUM(features.price * features_services.units * (1 - features_services.discount / 100)) + 
    (SELECT 0.6 * SUM(dates.kilometers) FROM dates WHERE dates.idService = cid) +
    (SELECT SUM(CASE when dates.mounting = 1 THEN 0 else -100 END) FROM dates WHERE dates.idService = cid) AS importeTotal
FROM features_services
JOIN features ON features_services.idFeature = features.idFeature
WHERE features_services.idService = XXXXXXXX
"
5867,67099,New Line while inserting into VARCHAR2 column,"SQL> conn rc/rc@orcl102
Connected.
SQL> set serveroutput on;
SQL> begin
  2    dbms_output.put_line('Hello..' || chr(10) || 'how are you...');
  3  end;
  4  /
Hello..
how are you...
"
30891,68918,Complicated MySQL Select query,"SELECT s.SongID, 
       COALESCE(v.allVotes, 0) allVotes, 
       COALESCE(v.userVotes, 0) userVotes
  FROM songs s LEFT JOIN 
(
  SELECT SongId, 
         COUNT(*) allVotes,
         SUM(CASE WHEN UserID = 71 THEN 1 ELSE 0 END) userVotes
    FROM votes
   WHERE RoomID = 178 
   GROUP BY SongID
) v 
    ON s.songID = v.songID 
 WHERE s.RoomID = 178 
"
13823,70321,"I have an image metadata database. For simplicity's sake, there are three tables: image, imageperson, and person","SELECT i.id
FROM image i
  JOIN imageperson ip ON i.id = ip.imageid
  JOIN person p ON ip.personid = p.id
GROUP BY i.id
HAVING COUNT(CASE WHEN p.id IN (5,6) THEN 1 END) = 2
"
23012,32201,"EF code first, polymorphism cast","using AutoMapper;

//Create Map from Person to RegisteredPerson
Mapper.CreateMap<Person, RegisteredPerson>();

//Load person from Database
Person p = context.Persons.SingleOrDefault(predicate);
//Map Person to RegisteredPerson
RegisteredPerson r = Mapper.Map<Person, RegisteredPerson>(p);
//Assign values to RegisteredPerson
r.ProxyId = SomeValue;
using (var context = new YourContext())
{
    context.Persons.Attach(r);
    context.SaveChanges();
}
//Load new RegisteredPerson
using (var context = new YourContext())
{
    RegisteredPerson rp = context.Persons.OfType<RegisteredPerson>().SingleOrDefault(predicate);
}
"
34997,14349,How to select field from a row using MAX on another column?,"select ...
from a join
     (select max(A_DATE) keep (dense_rank first order by seq_no desc) as max_a_date
      from b
     ) bmax
     on a.a_date = b.max_a_date;
"
35973,45968,Alternate way to get last and first record from database table,"SELECT c.* 
FROM customer c
INNER JOIN ( SELECT MIN(customer_id) AS minCustomerId, 
                    MAX(customer_id) AS maxCustomerId 
             FROM customer
           ) AS b ON c.customer_id IN (minCustomerId, maxCustomerId);
"
21915,11449,SQL query to count two columns,"SELECT COUNT(*)
FROM asterisk_cdr
WHERE calldate LIKE '%2014-10-11%'
     AND channel LIKE '%SIP/4546975289%'
"
28067,2785,Select Users with more Items,"Select * From Users
Left Join Photos On (Photos.user_id = Users.id)
Left Join Comments On (Comments.user_id = Users.id)
Group By UserId
Order By (Count(Photos.id) + Count(Comments.id))
"
27874,58372,SQL Server - get list of dates between two dates from a table,"declare @TblHoliday table (StrDate date, EndDate date)
insert @TblHoliday values ('2016-03-26', '2016-03-26'), ('2016-04-07', '2016-04-09')

-- Build a tally table using date range from the data
;with cte as
(
    select min(StrDate) as value, max(EndDate) as maxvalue from @TblHoliday
    union all select dateadd(day, 1, value), maxvalue from cte where dateadd(day, 1, value) <= maxvalue
)
select value from cte 
-- filter out the dates
where exists(select * from @TblHoliday where value between StrDate and EndDate)
option(maxrecursion 0)
"
8635,59341,SQL Query selecting from two separate tables using a order clause,"SELECT t.*
FROM tickets AS t
JOIN ticket_updates AS tu ON t.ticketnumber = tu.ticketnumber
WHERE status = 'Completed'
ORDER BY tu.datetime DESC LIMIT 50
"
24662,62926,SQL datetime format to date only,"select Subject, 
       CONVERT(varchar,DeliveryDate,101) as DeliveryDate
from Email_Administration 
where MerchantId =@MerchantID 
"
20928,41126,Getting table rows where multiple foreign table criteria need to be satisfied,"SELECT u.UserName 
FROM Users u 
     INNER JOIN Options o 
        ON o.User_ID = u.ID
WHERE o.Flag in (1, 2)
GROUP BY u.UserName 
HAVING COUNT(o.Flag) = 2
"
13014,19029,"Oracle SQL - Find the MIN value of a dataset, but exclude a value in the MIN calculation","010
009
1
"
13041,67325,Assistance with simple JOIN,"SELECT  con.EmpName AS consigneeName,
        ho.EmpName AS handOverName
FROM    consignation a
        INNER JOIN employee con
            ON a.ConSignee = con.empID
        INNER JOIN employee ho
            ON a.handoverby = ho.empID
"
14472,15840,How to get all parent names,"WITH C AS
(
  SELECT T.id, 
         T.name, 
         T.pid
  FROM @tblPagePath AS T
  WHERE T.id = 3
  UNION ALL
  SELECT T.id, 
         T.name, 
         T.pid
  FROM @tblPagePath AS T
    INNER JOIN C
      ON C.pid = T.id

)
SELECT *
FROM C
--WHERE C.id <> 3
"
24747,6049,Using the value of an alias inside the same sql statement,"select @t:=now() as t, concat('Hello: ', username, @t) from t;
"
1052,10036,SQL query to transpose data in below case,"SELECT
  Heading, 
  A Package_A,
  B Package_B,
  C Package_C,
  D Package_D
FROM (
      SELECT * FROM YourTable
) up 
PIVOT (sum(Limit) FOR Package IN (A, B, C, D)) AS pvt
"
16742,2794,Postgresql: In-Row vs Out-of-Row for text/varchar,"ALTER TABLE YourTable
  ALTER COLUMN YourColumn SET STORAGE (PLAIN | EXTENDED | EXTERNAL | MAIN)
"
18375,26708,SELECT WHERE ON an advanced way,"select conversation
from conversation_users cu
group by conversation
having SUM(user = 1) > 0 and
       sum(user = 2) > 0 and
       sum(user = 3) > 0 and
       sum(user = 4) > 0 and
       sum(user not in (1, 2, 3, 4)) = 0
"
17695,58348,Converting 1 record with a start and end date into multiple records for each day," SELECT A.data,
    DT.startDate,
    DT.endDate
 FROM
 DateTable DT
 JOIN A
 ON A.StartDate >= DT.startDate
 And A.EndDate <= DT.endDate
"
20568,64065,Return result of SELECT to another procedure,"CREATE TABLE #TempResults
( 
  -- put definition of columns returned from your Procedure1 SP here
)

INSERT INTO #TempResults
EXEC Procedure1

-- now you have your result from Procedure1 in #TempResults
-- use it whatever way you want
SELECT * FROM #TempResults

-- finally drop the temp table when no longer needed
DROP TABLE #TempResults
"
37588,58201,"mysql query, selecting from 3 tables","SELECT Ids.leadId
FROM
    Ids JOIN
    rlds ON rlds.leadId = Ids.LeadId AND recID = 999 AND rdate > '03-20-2012'
WHERE Ids.Status = 'ok'

UNION

SELECT leadId
FROM pIds
WHERE recID = 999 AND change IS NOT NULL AND pdate > '03-20-2012'
"
38601,2405,SQL Query for multiple tables/records,"SELECT m.LastName, m.FirstName, o.[Date] AS [off ice date]
FROM tblMembers AS m
LEFT JOIN 
(
  SELECT UserID, MAX([Date]) as [Date] FROM Off_Ice_Testing
  GROUP BY UserID
)o ON (o.UserID = m.UserID)
WHERE     (m.LastName LIKE '%player%')   
"
14070,16926,Simplify this code,"update table1.dbo.totals
    set @FEE = COALESCE((g.SGROUPS^1)&1,0) * @GROUPPRICE * 
          case
             when CHARINDEX('JMCG', g.GROUPS) > 0 then (g.SGROUPS - 2)
             else (g.SGROUPS - 1)
          end
from @GROUPMEM as g

if @FEE < 0
begin
    set @GROUPFEE = 0
end
"
27334,54704,substituting values with a sql join,"select b.*
from setB b
union all
select a.*
from setA a
where not exists (select 1 from setB b where b.col = a.col);
"
3663,47331,MySQL COUNT query in join,"SELECT
    M.ID,
    M.NAME,
    (SELECT  COUNT(F.notified) FROM FRIENDS AS F WHERE F.member_id = M.id AND F.notified = 1) AS NUMFRIENDS
FROM
    MEMBER AS M 
GROUP BY
    M.id
"
14037,43080,how i can do this SQL Query?,"SELECT * FROM EMPLOYEES WHERE EID=...
"
6295,14317,SQL: Remove rows if it contains a date in the past,"delete t from t
    where (case when text glob '[0-9][0-9]/[0-9][0-9]/[0-9][0-9]'
                then replace(text, '/', '-')
                when text glob '[0-9][0-9]/[0-9][0-9]'
                then strftime(date('now'), '%Y') || '-' || substr(text, 1, 2) || '-' || substr(text, 4, 2)
           end) < strftime(date('now'), '%Y-%m-%d')
"
23113,25631,How do records get ordered in a mysql group by?,"SELECT * FROM table t GROUP BY t.id, t.foo, t.bar
"
36604,36931,Apply SELECT LEFT() on the total characters from multiple columns combined,"SELECT id,
  LEFT(heading, 100) AS heading,
  IF(LENGTH(heading)>=100, '', LEFT(article, 100-LENGTH(heading))) AS article
FROM news
ORDER BY stamp DESC
LIMIT 5;
"
15777,48373,How to convert horizontal row into vertical SQL Server,"select 'Permitted' action, COUNT(aciklama) as result
from Uyari 
where Aciklama like '%Permitted%'
union all
select 'Blocked' action, COUNT(aciklama)   
from Uyari 
where Aciklama like '%Blocked%'
"
18637,53491,Finding and dealing with duplicate users,"SELECT 
    GROUP_CONCAT(id) AS ""ids"",
    CONCAT(UPPER(first_name), UPPER(last_name)) AS ""name"",
    COUNT(*) AS ""duplicate_count"",
    SUM(is_not_duplicate) AS ""real_count""
FROM 
    users 
GROUP BY 
    name 
HAVING 
    duplicate_count > 1
AND
    duplicate_count - real_count > 0
"
26460,48481,SQL Force one column to be unique for every row that shares the same foreign key,"ALTER TABLE myTableName 
      ADD CONSTRAINT tb_UQ UNIQUE (FKColumn, OtherColumn)
"
7958,48587,Select 2 columns from 3 tables,"SELECT  c.c1, b.c2
FROM    t1 a
            INNER JOIN t2 b
                on a.i2 = b.i2
            INNER JOIN t3 c
                on a.i1 = c.i1
"
34864,4060,Write INSERT statements with values next to column names?,"insert into myTable
    ([col1], [col2], [col3])
    select 'xxx' as [col1], 'yyy' as [col2], 42 as [col3]
"
3232,1855,how to select a row where one of several columns equals a certain value?,"SELECT * FROM MYTABLE WHERE COLUMNA=MyValue OR COLUMNB=MyValue OR COLUMNC=MyValue
"
12510,30945,Constraints / Foreign keys information in Oracle,"a.constraint_name = b.constraint_name
"
31561,9984,SQL Query Accross Three Tables Requiring Different Joins,"
SELECT
  *
FROM
  Packages p
WHERE
  NOT EXISTS (
    SELECT 1 
      FROM Applications a 
           INNER JOIN AppPackages ap ON ap.PackageId = p.PackageId
     WHERE ap.AppId = <Your App ID>
  )
"
36026,13804,Sql many to many relation with the same table,"|UserID1|UserID2|
|      1|      2|
|      2|      3|
"
23808,3749,How can I interface an Android app with SQL Server?,"AsyncHttpClient client = new AsyncHttpClient();

client.get(""http://yourwebservice.aspx"", new AsyncHttpResponseHandler() {
    @Override
    public void onSuccess(String response) {
        JSONArray jarr = new JSONArray(response);
        for(int i = 0; i < jarr.length(); ++i) {
            JSONObject jobj = jarr.getJSONObject(i);
            // Do your things...
        }
    }
});
"
27711,25316,Oracle Stored Procedure Search,"SELECT owner, name, type
  FROM dba_dependencies
 WHERE referenced_name = 'SEND_MAIL'
   AND referenced_owner = <<owner of procedure>>
"
15960,9321,Oracle - View function body from a package,"  SELECT *
    FROM all_source
   WHERE TYPE = 'PACKAGE BODY' AND name = '<your package name>'
ORDER BY line;
"
11823,21965,Gridview display multiple tables?,"<asp:GridView runat=""server"" ID=""gridViewTest"" AutoGenerateColumns=""true"" >
</asp:GridView>
"
14489,60221,How to know the alive time for a explicit cursor?,"SQL> show parameter undo_retention

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------
undo_retention                       integer     900
"
4776,11916,Referencing a calculated column in the where clause SQL,";with cte_FreeDaysRemaining as
    (
        select
            frdFreedays - DateDiff(dd,conReceiptToStock,GetDate()) As FreeDaysRemaining
            --, more columns
        from yourtable
    )
    select
        FreeDaysRemaining
        --, more columns
    from cte_FreeDaysRemaining
    where FreeDaysRemaining <= @intFreeDays
"
18015,26389,"Of people who took at least one ride, what's the average number of metro lines they rode?","select avg(ln) as avg_lines
from (
    select user_id, count(distinct line_id) as ln
    from rides r join locations l on (r.location_id = l.location_id)
    group by user_id
)
"
18993,10262,Display all parent records except those having 4 child records,"SELECT   employee.*
FROM     employee LEFT JOIN donation USING (employee_id)
GROUP BY employee_id
HAVING   COUNT(*) < 4
"
2358,64448,Trying to sum and group two sets of results from three SQL tables,"SELECT w.name AS name1, sum(h.atk) as atk, a.name AS name2
 FROM H 
JOIN W ON w.Wid=h.Wid
JOIN A ON a.Aid=h.Aid
GROUP BY w.name, a.name
"
6693,65045,Oracle 10g Range Partition Query,"create table LAB6_ZL
(
  ID        number not null
 ,TITLE     varchar2(40)
 ,PUBID     char(3)
 ,PUBDATE   date
 ,constraint LAB6_PK primary key(ID)
)
partition by range (PUBDATE)
  (partition TWO
     values less than (date '2000-01-01')
  ,partition ONE
     values less than (date '2010-01-01')
  ,partition THREE
     values less than (MAXVALUE));
"
22090,59710,Modify FindAll function to a DoesExist function in SQL Server,"WHILE @Id IS NOT NULL AND @Id <> @AncestorId
BEGIN
 SET @Id = (
  SELECT ManagerId FROM dbo.Users WHERE UserId = @Id
 )
END

RETURN CASE WHEN @Id IS NOT NULL THEN 1 ELSE 0 END
"
26227,3345,How to get the last 3 group created at the same time?,"SELECT t1.`coupon name`, t1.`Created at`
FROM mytable AS t1
INNER JOIN (
  SELECT `Created at`
  FROM mytable
  GROUP BY `Created at`
  ORDER BY `Created at` DESC LIMIT 3
) AS t2 ON t1.`Created at` = t2.`Created at`
"
37623,52907,how do you issue select statment against the oracle table without double quotes around the column names,"ALTER TABLE DW.KPX_PHYSICAL_MEMORY_DV
  RENAME COLUMN ""Node"" TO Node;
"
32298,7284,Convert date period to display a date format," FORMAT(Fields!Date.Value, ""MMM-yy"") 
"
13644,46563,Sub totals on aggregated fields,"(select str(sum(secwgtpcsMyLength),12,3) from NYS2RandomReport t2 where (t2.section = t.section) and (t2.grade=t.grade)) as SectionGradelbs
"
18521,10444,Having issues joing a table with a recursive function in Sqlite,"WITH RECURSIVE dates(d)
AS (VALUES('2014-05-01')
    UNION ALL
    SELECT date(d, '+1 day')
    FROM dates
    WHERE d < '2014-05-5')
SELECT 
    dates.d AS date 
    ,table.column1
    ,table.column2
FROM dates
    left join table
        ON strftime(""%Y-%m-%d"", table.date_column) = dates.date
"
13068,54181,Update using MIN,"update B
set B.starttime = A.starttime
from table2 as B
INNER JOIN (
select A.UserId, convert(varchar, A.Date, 102) as adate, Min(A.Starttime) as starttime
  from table as A
  WHERE  (A.Reason = 'loggedin')
  GROUP BY A.UserId, convert(varchar, A.Date, 102)
) A on B.Nordia_ID = A.UserId and A.adate = convert(varchar, B.StatusDateTime, 102)
"
15813,11300,How exlude some database records by checking another table,"SELECT
    *
FROM
    orders o
JOIN customers c ON o.CustomerNumber = c.CustomerNumber
WHERE
    STATUS = 'QUOTE'
AND NOT EXISTS (
    SELECT * FROM comments 
    WHERE CommentText = 'Do not contact' 
    AND OrderNumber = o.OrderNumber 
)
ORDER BY
    o.OrderNumber DESC
LIMIT 0, 100
"
24654,73027,Replace row value with empty string if duplicate,"select (case when row_number() over (partition by ProductCode order by (select NULL)) = 1
             then ProductCode
        end) as ProductCode
       Color
from Product
order by ProductCode;
"
33206,40053,SQL Server convert select a column and convert it to a string,"declare @results varchar(500)

select @results = coalesce(@results + ',', '') +  convert(varchar(12),col)
from t
order by col

select @results as results

| RESULTS |
-----------
| 1,3,5,9 |
"
23716,7061,How can i join pairs of records in a single table sorted chronologically (using MySQL),"SELECT T.ID,T.Type,T.Time,T2.ID,T2.Type,T2.Time FROM Table T LEFT JOIN Table T2 
ON (T.Type = 'A' AND T2.Type = 'B' AND T.Time < T2.Time) 
WHERE T2.ID IS NOT NULL
GROUP BY T.ID
"
7382,14020,Oracle packages in version control?,"SELECT TEXT FROM ALL_SOURCE
WHERE TYPE='PACKAGE BODY'
  AND NAME='MYPACKAGE' 
  AND OWNER='MYPACKAGEOWNER'
ORDER BY LINE
"
26266,15374,Copy table from one database to another,"select  *
into    DbName.dbo.NewTable
from    LinkedServer.DbName.dbo.OldTable
"
28475,5740,How to select the lowest value from selection,"select users.id, users.exp, current_level.id, current_level.min_exp
from levels current_level
join levels next_level on next_level.id = current_level.id + 1
join users on users.exp >= current_level.min_exp
    and users.exp < next_level.min_exp
"
