,NL,Code
21079,MYSQL query for summing occurence of some column,"SELECT COUNT(*) AS 'login_times', name 
FROM logins 
GROUP BY name 
ORDER BY login_times DESC
"
38811,SQL Average of grouping,"SELECT avg(Cast(gradingscores.score AS decimal) as averages 
FROM gradingscores 
WHERE    isnumeric(gradingscores.score) = 1
         AND task LIKE %responsibility% 
"
30096,Can I concatenate certain fields of a table in a multitable SELECT in MYSQL?,"SELECT 
    users.*,
    jobs.id, 
    jobs.name,
    GROUP_CONCAT(user_experiences.the_field_you_want_to_concatenate) AS concatenated_field
FROM users
LEFT JOIN users.id = users_jobs.userId
LEFT JOIN jobs.id = users_jobs.jobId
LEFT JOIN users.id = user_experiences.userId
GROUP BY 
     users.*,
     jobs.id,
     jobs.name;
"
21997,SQL query: help needed,";WITH CTE
AS
(
    SELECT [id], [name] FROM  Parents WHERE [name] = 'parent3'
    UNION ALL
    SELECT T1.[id], T1.[name] FROM CTE c 
    INNER JOIN  Parents T1 ON c.[id] = T1.[parent_id]
)

SELECT * FROM Relatives 
WHERE [parent_id] IN (SELECT [id] FROM CTE)
"
36621,Rpostgresql: Properly escaping strings for input,"postgresqlExecStatement(con, ""DELETE FROM foos WHERE id = $1 AND baz = $2"", list(1, ""bar""))
"
2531,SQL Server 2008 - Select disjunct rows,"update m
set process_status = 1
OUTPUT Inserted.member_id
from
  (
  SELECT top 10
      process_status, member_id
    from member WITH (ROWLOCK, READPAST, UPDLOCK)
    where status = 0
    order by member_id
  ) m
"
14929,Select XML nodes as XML in T-SQL,"SELECT
    pref.query('.') as XmlExtract
FROM  
    @xml.nodes('/*/*') AS extract(pref)
WHERE
    pref.value('./*[1]', 'nvarchar(10)') IS NOT NULL
"
21951,complex mysql query DISTINCT,"select count(*)
from
(
    SELECT team
    FROM players
    group by team
    having sum(paid=1) >= 5
) tmp
"
26209,Rolling 30 day uniques in sql,"SELECT DISTINCT `activity_date` as `day`, (
SELECT count(DISTINCT `user_id`) FROM `user_activity` WHERE `activity_date` = `day`
) as `num_uniques`
FROM `user_activity` 
WHERE `activity_date` > NOW() - INTERVAL 30 day;
"
11939,Writing SQL statement to select from multiple rows,"SELECT COUNT(*) as reciprocal_values_no
FROM table_name tbl1
WHERE 
  username = @username
  AND friend_username = @friendusername
  AND status = 0
  AND EXISTS (
    SELECT 1 FROM table_name tbl2 WHERE tbl1.username = tbl2.friend_username AND tbl1.friend_username = tbl2.username )
"
15395,Table name in Firebird has a lot of extra space,"RDB$RELATION_NAME is CHAR(31)
"
5832,"Create list of dates, a month apart, starting from current date","SELECT GETDATE() 'Date'
UNION
SELECT DATEADD(month, 1, GETDATE()) 'Date'
UNION
SELECT DATEADD(month, 2, GETDATE()) 'Date'
UNION
SELECT DATEADD(month, 3, GETDATE()) 'Date'
UNION
SELECT DATEADD(month, 4, GETDATE()) 'Date'
"
25462,Get users which have orders in one row but doesn't have in another SQL Server 2012,"select * 
from [My_Table] t
where [Order] > 0
  and ([Date] between '20150201' and '20150228')
  and not exists ( select *
                   from [My_Table]
                   where [Order] > 0
                     and [User] = t.[User]
                     and [Date] between '20150301' and '20150331')
"
26283,Select up to x rows of each group,"SELECT  id, name, job, rank
FROM    TableName a
WHERE 
        (
           SELECT   COUNT(*) 
           FROM     TableName as f
           WHERE    f.job = a.job AND 
                    f.rank <= a.rank
        ) <= 2;
"
17481,Evaluate query as a string in row,"DECLARE @Query varchar(50);  

DECLARE query_cursor CURSOR FOR
SELECT QueryString FROM TableName;

OPEN query_cursor;

FETCH NEXT FROM query_cursor
INTO @Query;

WHILE @@FETCH_STATUS = 0
BEGIN
   EXEC (@Query);
   FETCH NEXT FROM query_cursor
   INTO @Query;
END

CLOSE query_cursor;
DEALLOCATE query_cursor;
"
759,Count column where value is equal row id,"select 
t.id,t.parent,coalesce(x.cnt,0) as cnt
from t left join
(select parent,count(*) as cnt
 from t
 group by parent) x
on x.parent = t.id
"
17584,Puzzle: Alternate SQL Syntax,"Update c
Set pid =   Case
                When course_name = ? Then ?
                Else pid
                End
"
28185,SQL filetype commands not working in vim (filetype detected correctly),":filetype plugin indent on
"
23912,UPDATE table with LEFT JOIN result,"UPDATE authors PA 
INNER JOIN (SELECT p.author_id, COUNT( p.author_id ) AS AuthorCount
FROM phrases p
GROUP BY p.author_id) tblA
ON tblA.author_id = PA.id
SET phrases_qt = AuthorCount
"
27256,"SQL , count equivalent values in each column","SELECT country, count (*) FROM <TABLE_NAME> WHERE url_id = 3404 GROUP BY Country
"
31897,Repeat a result row multiple times by value in row,"select Item , ItemName ,  Quantity
from yourtable A
cross join (select num from numbers) b
where a.Quantity <= b.num
"
4581,i need to get dabase values in to my textbox using join,"$this->db->select('*');
                $this->db->from('tbl_user');
                $this->db->join('tbl_userinfo', 'tbl_user.user_id = tbl_userinfo.user_id');
                $this->db->where('tbl_user.user_id', $data);
                $query = $this->db->get();
                $result = $query->result();
                return $result;
"
26612,right join table status with number of member count with where / having condition,"SELECT      MS.name, 
            count(M.id) as totalNum           
FROM        member_status MS
LEFT JOIN   (SELECT * FROM member WHERE created_at between '2014-06-01 00:00:00' and '2014-07-31 23:59:59') M ON M.[status]  = MS.id
GROUP BY    MS.name
"
5864,Add missing month into query result,"select count(1) as count, months.month, year(published_at) as year
from months left join articles on months.month = month(published_at)
where published_at >= (now() - interval 1 year) and published_at <= now()
group by month(published_at)
order by year asc, month asc
"
30720,"between getdate() and DATEADD(m, -1, getdate())) on where clause","where  SomeDate between   DATEADD(m, -1, getdate()) and getdate() 
"
22505,Needing an if/else statement in SQL Update Case,"UPDATE yourtable
SET refundNumber = ISNULL(CONCAT(NULLIF(refundNumber, ''), ', 88'), '88')
WHERE InvNo = '1'
AND itemNo in ('250', '7095')
"
22816,sql remove duplicate record while using join,"select p.ProductId,p.ProductName,x.Details 
from Products p
cross apply
(SELECT top 1 inv.Details FROM Inventory inv WHERE p.ProductId = inv.ProductId) x
"
39236,MySql query for complicated select,"SELECT DISTINCT d.Name
FROM Users u1
JOIN Users_Friend_Relation f ON u1.ID = f.User1ID
JOIN Users_Dogs_Relations udr ON udr.UserID = f.User2ID
JOIN Dogs d ON udr.DogID = d.ID
WHERE u1.Name = Steve
AND d.Last_Changed_At < '11:23:00'
"
10953,MySQL Index: 1 keyname multiple columns OR 1 keyname per column?,"SELECT * FROM users WHERE (age > 18 AND name = ""Johnnie Walker"")
"
4340,How to label INNER JOIN column result,"SELECT dbo.FindIntersectingZone(location) AS 'Zone', count(*) AS No_of_Stations
FROM londonStations
INNER JOIN [planning_districts_2008_updated]
  ON [planning_districts_2008_updated].geom.STIntersects(stations.location) = 1
GROUP BY dbo.FindIntersectingZone(location)
"
35645,Get the closest record for every date,"select the first record
from skucompetition
where creationdate is before (input date + one day)
order by creationdate so most recent record comes first
"
38344,SQL SELECT FREETEXT order by Rank,"SELECT TOP 1000 Q.*, QI.*
FROM Quotes Q
INNER JOIN QuoteImages QI
    ON Q.Id = QI.QuoteId 
INNER JOIN FREETEXTTABLE(Quotes,QuoteText,'some text') FT
    ON Q.Id = FT.[Key]
ORDER BY RANK DESC
"
20266,Using combined indexes in MySQL,"(lang_target, word(10), lang_original)
"
13125,"How can I join two SQL tables, putting a value from the 2nd table into a column in the 1st?","select User,callcost,callclass,date from 1sttable
union all
select User,LineRental,'Line Rental',billdate from 2ndtable
"
33925,MVC 4 Retreive db id from newly created entry,"var id = casefile.CasefileId;
"
4001,LINQ to SQL Left Outer Join,"var query = from c in db.Customers
            join o in db.Orders
               on c.CustomerID equals o.CustomerID into sr
            from x in sr.DefaultIfEmpty()
            select new {
               CustomerID= c.CustomerID, ContactName=c.ContactName,
               OrderID = x.OrderID == null ? -1 : x.OrderID};   
"
29076,Creating a SQL lookup,"UPDATE MyTable
SET MyTable.TransportMode = mlt.TransportMode 
FROM MyTable mt 
INNER JOIN MyLookupTable mlt ON mt.Name = mlt.Name
"
30605,Comparing a variable to a column's default value in oracle procedure,"SELECT TABLE_NAME||'.'||COLUMN_NAME, DATA_DEFAULT
INTO tableVariable, defaultVariable
FROM ALL_TAB_COLUMNS
WHERE TABLE_NAME=:myTable
AND COLUMN_NAME=:myColumn
AND DATA_DEFAULT IS NOT NULL
"
17293,Mysql pagination without offset,"SELECT id, createdAt 
  FROM post 
 WHERE createdAt >= '2014-11-16 09:11:03' 
   AND (id > '15' OR createdAt > '2014-11-16 09:11:03') ORDER BY createdAt ASC, id ASC
LIMIT 2
"
18637,Finding and dealing with duplicate users,"SELECT 
    GROUP_CONCAT(id) AS ""ids"",
    CONCAT(UPPER(first_name), UPPER(last_name)) AS ""name"",
    COUNT(*) AS ""duplicate_count"",
    SUM(is_not_duplicate) AS ""real_count""
FROM 
    users 
GROUP BY 
    name 
HAVING 
    duplicate_count > 1
AND
    duplicate_count - real_count > 0
"
23651,How to get the first N rows where the sum is ≥ X?,"select top 10 * from -- top N goes here
 (
 SELECT *,SUM(weight) OVER (partition BY expired ORDER BY Id asc) as cumulativesum
 FROM 
 Products
 WHERE expired = 0
  )T 
  where cumulativesum>=5
"
29138,How to check if the USER is already created in the database or not in SQL?,"USE (your database you want to check the user's existence in)

SELECT * 
FROM sys.database_principals
WHERE name = '(your user name to check here)'
"
8546,SQL ORDER BY (sequence),"SELECT * 
FROM UserDB 
ORDER BY
  CASE Role WHEN 'Admin' THEN 0 
            WHEN 'User' THEN 1
            WHEN 'Guest' THEN 2
  END
"
31502,"Mysql, ""insert into“","Insert Into mytable(column1,column2,column3,column4)
Select 'value1',filed1, filed2,filed3 from anothertable where filed4=a_varible
"
12559,"Select one row per id, with condition in nonid field | Magento select Shipping Address","SELECT * FROM Table t 
WHERE t.address_type = 'shipping'

UNION aLL

SELECT * FROM Table t 
WHERE t.address_type = 'billing' 
    AND NOT EXISTS (SELECT 1 FROM Table t1 
                    WHERE t.id = t1.id AND t1.address_type = 'shipping')
"
27047,How to get specific texts from the URL put on MS Excel cell?,"
WEB
1
http://www.imdb.com/title/[""Movie ID""]/

Selection=3
Formatting=None
PreFormattedTextToColumns=True
ConsecutiveDelimitersAsOne=True
SingleBlockTextImport=False
DisableDateRecognition=False
DisableRedirections=False
"
38754,SQL left joining tables with ambiguous column names,"SELECT L.Title Listing_Title, LC.Title ListingCategory_Title,
       ... all your other columns ...
FROM ListingCategory_Listings LCL
LEFT JOIN Listing L ON LCL.ListingID = L.ID 
LEFT JOIN SiteTree_Live STL ON L.ID = STL.ID 
LEFT JOIN ListingCategory LC ON LCL.ListingCategoryID = LC.ID 
LEFT JOIN File F ON LC.IconID = F.ID
"
2126,How to write a function with Oracle regexp to test a domaine name?,"function isSyntaxeDomaineOk(pStr varchar2, pChar4Space varchar2 default null) return boolean is
begin
    return regexp_like(pStr, '^[a-z0-9][-a-z.0-9]*[a-z0-9]$') 
                              and not regexp_like(pStr, '\.\.');
end isSyntaxeDomaineOk;
"
1190,Don't know how to select ID of a row with maximal negative date difference,"SELECT TOP 1
    ID,
    DateDiff('d', Now(), myDate) AS [test]
FROM myTable
WHERE Now() > myDate
ORDER BY 2 DESC;
"
31107,Postgres create timestamp ( current date + specific time ) format,"CURRENT_DATE + TIME '23:59:59'
"
10088,Query Fine Tune,"CREATE NONCLUSTERED INDEX NC_MyCoveringIndex 
   ON Table(UpdateDateTime)
      INCLUDE (Col1, Col2, ..., ColN)
"
39578,Why are SQL import statements a lot faster when run with multiple MySQL clients,"echo ""begin;"" >/tmp/begin
echo ""commit;"">/tmp/commit

cat /tmp/begin test.sql /tmp/commit |mysql -u username -ppassword db_name 
"
25501,Select Join table with table self,"select t1.*, t2.avg_trans
from table t1
inner join (select id, merchant_id, avg(transaction) avg_trans
            from table
            group by id, merchant_id) t2 on t1.id=t2.id and t1.merchant_id=t2.merchant_id
"
32982,SQL Server date/time overlapping check for event scheduling,"declare @apptDate DATETIME

SET @apptDate = '12/22/2011 4:30PM'
select COUNT(*) 
from t1
where @apptDate Between
CAST( StartDate+StartTime as DateTime) and CAST( EndDate+EndTime as DateTime)  

SET @apptDate = '12/22/2011 6:30PM'
select COUNT(*) 
from t1
where @apptDate Between
CAST( StartDate+StartTime as DateTime) and CAST( EndDate+EndTime as DateTime)  
"
30645,How to get info from three tables with a MIN (MySQL),"SELECT i.id, name, category, null as size, min(prices.price) from items i
JOIN prices on prices.id = i.id
GROUP BY i.id, i.name, i.category, size
UNION ALL
SELECT i2.id, name, category, size, min(prices2.price) from items2 i2
JOIN prices2 on prices2.id = i2.id
GROUP BY i2.id, i2.name, i2.category, i2.size
"
19226,MySQL update a column by selecting from 2 other columns every second time,"UPDATE game
SET active = IF (active = user1,user2,user1)
WHERE id = '$idSql';
"
6599,How to perform logic in sql statements,"select ((col_1 is not null) +
        (col_1 is not null and col2 is not null) +
        (col_1 is not null and col2 is not null and col3 is not null) +
        (col_1 is not null and col2 is not null and col3 is not null and col4 is not null) +
        (col_1 is not null and col2 is not null and col3 is not null and col4 is not null and col5 is not null)
       ) as IndexOfCompletion
. . .
"
15062,PL/SQL Reg Exp found digit in string,"SELECT
    case WHEN REGEXP_Instr(c1, '[[:digit:]]')=0 THEN c1 end result1
    ,c1
FROM
(
    select 'asdf' c1 from dual union all
    select '1234' c1 from dual union all
    select 'as1234df' c1 from dual
) test_data;
"
13668,Update a single column on multiple rows with one SQL query,"insert into [table](ID,DATA) 
values(23,'FOO'),(47,'ASD'),(54,'DSF')..,
on duplicate key update DATA=values(DATA)
"
7399,"How to define the stored procedure input data types , to be based on other columns data types","CREATE TYPE [dbo].[serialNumber] FROM [varchar](50)

ALTER PROCEDURE [dbo].[AdvanceSearch]
        -- Add the parameters for the stored procedure here
        @SearchType nvarchar(10) = null,
        @SerialNumber [serialNumber] = null,
//code goes here
"
35511,PostgreSQL complex update operation on column,"update Event e set e.placeListingName = 
    (select substr(coalesce(epc.shortTitle, epc.title),1,100) 
    from Event ev join ev.place p join p.publicContent epc 
    where ev.id = e.id) 
where e.place is not null
"
3904,How to write a SQL query for user selected date range?,"SELECT reps, completion_date
FROM dbo
WHERE completion_date < DATEADD(DAY, DATEDIFF(DAY, 0, @DateSelectedByUser), -1)
"
22653,Can We Create Index in Table Valued Function,"CREATE FUNCTION F()
RETURNS @X TABLE
(
A INT PRIMARY KEY /*<-- Implicit clustered index*/
)
AS
BEGIN
INSERT INTO @X 
    VALUES(1),(2)
RETURN;
END

GO

SELECT *
FROM F()
WHERE A = 12
"
29888,"SQL Select, sometime need 'Where' +/- 'And' sometimes need neither","strSQL = 'Select * from tableA where 1=1'
"
24154,Android database taking so much time,"db.beginTransaction();
try{        
    // your 3000 insert loop here 
    db.setTransactionSuccessful();
} finally {
    db.endTranscation();
}
"
38265,SQL join to grab data from same table via intermediate table,"SELECT  sc.*, sp.*
FROM    Sites sc
JOIN    Site_H h
ON      h.parentOf = sc.page_id
JOIN    Sites sp
ON      sp.page_id = h.page_id
WHERE   sc.page_id = @mypage
"
39853,How can I get the sum of one group of data,"with data as (
    select Code, substring(Code, 1, len(Code) - 1) as Prefix, Name, Total from T
)
select
    case when grouping(Name) = 1 then Prefix else min(Code) end as Code,
    case when grouping(Name) = 1 then '-' else Name end as Name,
    sum(Total) as Total
from data
group by grouping sets ( (Prefix, Name), (Prefix) )
order by Prefix, grouping(Name), Code
"
28860,SQL - Where Field has Changed Over Time,"SELECT AccountID
FROM (SELECT DISTINCT AccountID, Rep
      FROM YourTable
      WHERE Rep NOT IN ('Support Specialist','Friendly Account Manager')
     )sub
GROUP BY AccountID
HAVING COUNT(*) > 1
"
1673,For the same value it should be incremented by 1 and different it should be reset and gives result,"SELECT BPIN, Name, @value:=IF(@bpin=BPIN, @value + 1, 1) AS value, @bpin:=BPIN
FROM 
(
    SELECT BPIN, Name
    FROM some_table
    ORDER BY BPIN, Name
) sub0
CROSS JOIN (SELECT @value:=0, @bpin:=0) sub1
"
27868,How to get the month from a string in sql?,"select datepart(mm, cast('feb2008' as datetime))
"
19635,T-SQL How to get SUM() from a subquery,"select sum(time) as sumtime from table
"
14237,SQLite Order By Date,"SELECT * FROM Table ORDER BY date(dateColumn) DESC Limit 1
"
8187,How are these two SQL statements different?,"$query = mysql_query(""
SELECT table_one.row 
FROM table_one 
INNER JOIN table_two 
ON table_one.id = table_two.id
WHERE table_two.row = $id"");
"
3722,Normalizing a table with different structures,"INSERT INTO NormalizedFamily(studentID, parentName)
SELECT studentID, parentName1
FROM FlatFamily
UNION
SELECT studentID, parentName2
FROM FlatFamily
WHERE parentName2 IS NOT NULL
UNION
SELECT studentID, parentName3
FROM FlatFamily
WHERE parentName3 IS NOT NULL
UNION
SELECT studentID, parentName4
FROM FlatFamily
WHERE parentName4 IS NOT NULL
"
7138,Calculate differences between rows while grouping with SQL,"SELECT     
 CASE WHEN source < target THEN source ELSE target END AS source,
 CASE WHEN source < target THEN target ELSE source END AS target,
 SUM(CASE WHEN source < target THEN units ELSE -units END) AS Diff, 
    model
FROM  movements
GROUP BY
 CASE WHEN source < target THEN source ELSE target END,
 CASE WHEN source < target THEN target ELSE source END,
    model
"
38178,String as all records in column in Posgresql,"  CREATE OR REPLACE VIEW 
    some_view
  AS
    SELECT
      'first_type' as type,
      t1.id,
      t1.author_id,
      t1.content,
    FROM t1
  UNION ALL
    SELECT
      'second_type' as type,
      t2.id,
      t2.author_id,
      t2.content,
    FROM t2
"
23000,greater than a certain number sql,"select count(*) from accountstable at where at.date > (select dateadd(day, -90,date) from currentdatetable)
"
18958,"rails 3 - SQL pass variable to ""order""","[code].order(""SUM((prices.price * #{params[:prod_id].to_i}) + profiles.shippingCost)"").all
"
30325,How to calculate database column statistics given the table and column name?,"
CREATE PROCEDURE my_proc @tablename sysname AS
   SELECT * FROM @tablename
"
34549,add list of tables and columns from database to database,"select dbms_metadata.get_ddl ( 'TABLE', table_name ) from user_tables;
"
38051,How to get key of the maximal record in group?,"SELECT name, t2.score
FROM Table1 t1
LEFT OUTER JOIN Table2 t2 ON t2.file_id = t1.id
LEFT OUTER JOIN Table2 t2copy ON t2copy.file_id = t2.file_id
                             AND t2.score < t2copy.score
WHERE name LIKE :pattern
  AND t2copy.score IS NULL
"
2874,SQL query with specialized ordering of results,"select * from routes
where route = 'Red'
order by case when stop_order >= 3 then 0 else 1 end, stop_order
;
"
18551,sql sp_sqlexec dealing with single quotes in statement,"declare @id int = 1
declare @sql nvarchar(2000)

declare @col2 varchar(10) = 'problem'

set @sql = 'insert into mytable (col1, col2) values (1, @col2)'

exec sp_executesql @sql, N'@Col2 varchar(10)', @col2 = @col2
"
15702,MySQL join two tables which have same rows and replace specific column,"UPDATE phpbbf_topics t1 
JOIN vb_thread t2 ON t1.topic_id = t2.threadId
SET t1.topic_title = t2.title
"
35221,"I'm using mybb, how can I find the top 5 threads that has the most readers currently?","SELECT COUNT(*) as count, subject as title
FROM `mybb_sessions`,`mybb_threads`
WHERE location1 = tid
GROUP BY `location1`
ORDER BY COUNT(*) DESC
LIMIT 10
"
16576,Database update SQL,"update MemberTable
set id = concat('00-',
                case Type
                    when 'A' then '00'
                    when 'B' then '01'
                    when 'C' then '02'
                end,
                substr(id, 2))
"
34837,Create trigger to affect specific rows,"CREATE TRIGGER tg_loan_records_insert
AFTER INSERT ON loan_records
FOR EACH ROW
  UPDATE temp_card 
     SET last_seen = NOW()
   WHERE card_no = NEW.card_no;

CREATE TRIGGER tg_loan_records_update
AFTER UPDATE ON loan_records
FOR EACH ROW
  UPDATE temp_card 
     SET last_seen = NOW()
   WHERE card_no = NEW.card_no;
"
1794,How to compare rows in 2 different tables: mySQL - what's different,"SELECT  a.pid, a.product_ID
FROM    products a
        INNER JOIN catalog b
            ON  a.cid = b.cid AND
                b.level = 2
WHERE   a.thickness <> b.thickess
"
34852,Selecting Stored Procedure Value in Query in MySQL,"drop procedure if exists sp_test;

delimiter #

create procedure sp_test(
in p_facility_id int unsigned, -- p prefix = parameter
in p_start_date date,
in p_end_date date
)
begin

declare v_facility_name varchar(255) default null; -- v prefix = variable

select f.facility_name into v_facility_name from facilities f where
 f.facility_id = p_facility_id limit 1;

select f.*, upper(v_facility_name) as facility_name from facilities f;

end#

delimiter ;

call sp_test (1, curdate() - interval 1 month, curdate());
"
17973,Does the order of index_together matter in a Django model?,"    index_together = ('name', 'address', 'favorite_color')
"
7200,need to assign values from sql query in single instance,"DECLARE @T1 TABLE (
    FLD9 bigint
, FLD295 nVARCHAR(max)
)

insert into @T1(,FLD295,FLD9) 
select top(@rCount) FLD295,FLD9 from tableName (nolock)
 ORDER BY NEWID()

select * from @T1
select @IDs=CAST(isnull(@IDs ,'')as varchar)+CAST(COALESCE(fld9,',')as varchar) from @T1 
"
5424,Sql simple beginner operation,"select users.user_name
from users
join users_act on users.user_id = users_act.user_act_user_id
"
8131,Top 2 Salary Grouped By Department,"SELECT *
FROM (
   SELECT *, DENSE_RANK() OVER (PARTITION BY Dept ORDER BY Salary DESC) AS rn
   FROM MyTable ) t
WHERE t.rn <= 2
"
6709,Updating a column with random values between specific range?,"UPDATE MyTable
SET MyColumn = 1 + FLOOR(3150 * RAND(CONVERT(varbinary, NEWID())))
WHERE ...
"
27406,find comma in oracle sql string,"    select
      substr( COLNAME, 1, instr( COLNAME, ',') - 1 ) as p_1 ,
      substr( COLNAME, instr( COLNAME, ',', - 1 ) + 1 ) as p_2
    from YOURTABLE
"
17444,SQL: Selecting rows contained in a group,"SELECT B.ClaimID, B.ClaimDate, B.ClientName, G.ClaimCount
FROM
(
    SELECT ClientName, COUNT(ClaimID) ClaimCount
    FROM Billings
    WHERE ClaimDate > '2010'
    Group By ClientName
    Having COUNT(ClaimID) > 1
) G
INNER JOIN Billings B on B.ClientName = G.ClientName
WHERE B.ClaimDate > '2010'
"
5194,How to select first 10 elements from database using SQL?,"SELECT * FROM clients ORDER BY id LIMIT 10;
"
38225,How to convert one row into multiple rows in SQL like this,"SELECT name, cpp, 0 as java, 0 as python, age
FROM {table}
WHERE cpp = 1
UNION ALL 
SELECT name, 0 as cpp, java, 0 as python, age
FROM {table}
WHERE java = 1
UNION ALL
SELECT name, 0 as cpp, 0 as java, python, age
FROM {table}
WHERE python = 1
"
19104,Help with SQL join combined with lots of subqueries,"SELECT s.*, es.*
  FROM students s
JOIN sections_students ss on s.id          = ss.student_id
JOIN sections_exams    se on se.section_id = ss.section_id
JOIN exam_schedules    es on es.exam_id    = se.exam_id and date = DATE('$date')
JOIN exams             e  on e.id          = es.exam_id and isAutoSignup = 1
"
34843,re-ordering rows of a table in sql,"select *
from the_table
order by case 
            when the_column = 'new' then 1
            when the_column = 'change' then 2
            when the_column = 'profile' then 3
            else 4
         end;
"
19740,How to select all records but order by a related table's column?,"SELECT k.*
  FROM keywords k
  JOIN keyword_groups kg ON k.k_id=kg.k_id
  JOIN groups g ON kg.g_id=g.g_id
 ORDER BY CASE WHEN g.class='Top' THEN 0 ELSE 1 END, g.name, k.name;
"
14541,SQL - How to select records with value A but not B? (A and B belongs to different rows),"SELECT record_id FROM table_A WHERE tag_id = 2
EXCEPT
SELECT record_id FROM table_A WHERE tag_id = 3;
"
26963,How to overwrite values during a select query in sql?,"SELECT name, newValue as age
from yourTable
"
20271,How to populate a column with random date in a table which falls between 2 dates from another table,"update Surgery_Record
set Surgery_Date =  DATEADD(DAY, 85 + ABS(CHECKSUM(NEWID()) % 11), patient_record.Beg_Date)
from patient_record
where patient_record.PatID=Surgery_Record.PatID
"
30736,unwanted entry on saveAll,"'application_id' => 123,
"
20173,Locking and concurrency with MySQL,"select . . . for update
select . . . lock in share mode
"
14838,Can deadlock on database tables allows other queries to execute,"Q1
begin transaction;

select * from Y where some_col = 'goats' with (updlock, holdlock);

update X set other_col = 'alpacas' where animal = 'best'; -- deadlock occurs here

commit transaction;
"
9240,Identify Smallest Number of Combinations Between 2 Users in a SQL Server Conversation Table," SELECT
        CASE WHEN User_1_Id > User_2_Id THEN User_1_Id ELSE User_2_Id END
      , CASE WHEN User_2_Id > User_1_Id THEN User_1_Id ELSE User_2_Id END
   FROM
        Messages
"
20636,How to check that group has a value in Oracle?,"SELECT
    MIN(created_timestamp),
    MAX(resource_id),
    MAX(price),
    MIN(CASE WHEN event_type IN (1704, 1701, 1703) 
                 THEN found_value 
             WHEN event_type = 1707 
                 THEN 1707 
                 ELSE NULL 
        END)
FROM subscriptions
GROUP BY guid ;
"
19671,What table should I host data linking two objects from seperate tables?,"Users Table:
    UserId
    UserName
    ...Etc

Groups Table:
    GroupId
    Name
    ...Etc

User_Groups Table:
    UserId
    GroupId
"
12484,SQL: Update table where column = Multiple Values,"Update Products 
Set ProductName = 'Shoes' 
WHERE ProductID IN (1,2,3,4,5,6,7,8) 
"
22534,MS Access Small Equivalent,"TRANSFORM First(Sales.Fruit) AS FirstOfFruit
SELECT Sales.Seller
FROM Sales
GROUP BY Sales.Seller
PIVOT DCount([id],""sales"",""seller='"" & [seller] & ""' and id<="" & [id]);
"
12405,Xquery SQL contains,"with xmlnamespaces(default 'http://schemas.xxx.xxx.xxx')
select *
from Table
where [XML].exist('/Node/SubNode/SubSubNode [contains(ContentNode[1],"","")]')=1
"
24765,Oracle: If-else function for non-nulls,"DECODE(IS_BOOK, 'Y', 'BOOK', 'SHOW')
"
1754,Docmd.TransferText to update data,"sSQL=""UPDATE table3 INNER JOIN MyLinkedTable "" _
    & ""ON table3.ID=MyLinkedTable.ID "" _
    & ""SET table3.SomeField=MyLinkedTable.SomeField ""
CurrentDB.Execute sSQL, dbFailOnError

sSQL=""INSERT INTO table3 (ID,SomeField ) "" _
    =""SELECT ID, SomeField FROM MyLinkedTable "" _
    & ""LEFT JOIN table3 "" _
    & ""ON table3.ID=MyLinkedTable.ID "" _
    & ""WHERE table3.ID Is Null ""
CurrentDB.Execute sSQL, dbFailOnError
"
36581,What would be a sql query to remove \n\r from the text?,"CREATE TABLE table1(column1 TEXT);
INSERT INTO table1 VALUES ('text1\r\ntext2
text3');

SELECT * FROM table1;
--------
text1
text2
text3

UPDATE table1 SET column1 = REPLACE(column1, '\r\n', '');
SELECT * FROM table1;
--------
text1text2text3
"
20670,MySQL Query - Check if data row contains a user_id,"WHERE data LIKE '%:4;%'
"
36220,How to get min value of a column which is present in three different table for a particular record,"SELECT MemberId, MIN(Date) AS ""Min_Date""
FROM (
    SELECT MemberId, Cov_End_Date  AS ""Date"" FROM Cov_End
    UNION ALL
    SELECT MemberId, Opt_out_date  AS ""Date"" FROM Opt_Out
    UNION ALL
    SELECT MemberId, Deceased_Date AS ""Date"" FROM Decsd_Date
) src
GROUP BY MemberId
"
12736,Select the newest entry based on other entries with the same values?,"SELECT DISTINCT
       x.id,
       x.text,
       x.otherid
  FROM TABLE x
  JOIN (SELECT t.otherid,
               MAX(t.id) 'max_id'
          FROM TABLE t
      GROUP BY t.otherid) y ON y.otherid = x.otherid
                           AND y.max_id = x.id
"
8263,Include an extra column from an original table that has an Inner Join that is listing values that only occur in a lookup table,"CREATE VIEW MissedPoints AS
SELECT Routes.[Route id]
     ,[Data Import].[Patrol id]
     ,Routes.[Tag Name]
     ,[Data Import].[Occurrence Date]  --Added
FROM Routes 
LEFT JOIN (SELECT DISTINCT [Route Id]
                ,[Patrol ID] 
                ,[Occurrence Date]  --Added
            from [Data Import]) as [Data Import] 
    on [Data Import].[Route Id] = Routes.[Route Id]
WHERE [Data Import].[Occurrence Date] is NULL
"
23586,"Postgres ""group by"" on aggregate function(s)","with cte as (
  select
      array_length(members,1) as plen,
      members[1] as first,
      members
  from (select array_sort(path) as members from table) as a
)
select distinct on (first)
    members
from cte
order by first, plen desc
"
13861,How to write this SQL Order By Clause,"ORDER BY CASE WHEN severity = 0 THEN 999 ELSE Severity END, date 
"
15094,Combine results of two unrelated queries into single view,"SELECT t2.total_session,
       t1.watch_count
FROM
  (SELECT 1 AS common_key,
          count(*) AS watch_count
   FROM video
   WHERE monthname(views) = 'May') AS t1
JOIN
  (SELECT 1 AS common_key,
               sum(sessions) AS total_session
   FROM USER
   WHERE user_id = 6) AS t2 ON t1.common_key = t2.common_key;
"
1300,SQL query based on multiple criteria,"SELECT * FROM orders ord1, orders ord2, conditions con 
WHERE ord1.trans = ord2.trans 
AND ord1.item = con.Product1 AND ord2.item = con.Product2
"
16556,Using SQL EXCEPT just by primary key,"SELECT ckA1, ckA2, ... ckA9, columnA1, columnA2, ... columnAN
FROM A
WHERE NOT EXISTS (
  SELECT 1 FROM B
  WHERE ckA1 = ckB1, ckA2 = ckB2, ... ckA9 = ckB9
)
"
37919,CASE ... ELSE *ignore* in Oracle SQL,"CASE WHEN grade = 0 THEN 'R2'
WHEN grade = -1 THEN 'R1'
ELSE to_char(grade)
END AS ""Grade level""
"
15825,sql SELECT return values matching NULL OR Another Value,"SELECT *
FROM have AS h
WHERE h.flag IS NULL
   OR h.flag IN (1, 11);
"
7587,Query by a LONG column,"select 
   dbms_lob.instr(clob_contents,'TLP')
from 
   (select 
        dbms_metadata.get_ddl('VIEW','LOCKED_DOCUMENTS_V', 'SCHEMA') clob_contents 
    from 
        dual) get_clob
"
2568,HOW do i filter out the latests runs in and crosstab the rowns into columns?,"select product, max(ad) ad, max(ss) ss, max(td) td
from (
  select Product,
      MAX(case tests when 'AD' then results ELSE 0 END) AS AD,
      MAX(case tests when 'SS' then results ELSE 0 END) AS SS,
      MAX(case tests when 'TD' then results ELSE 0 END) AS TD
  FROM product
  GROUP BY product, tests
) test_reports
group by product
ORDER BY product;
"
22735,T-SQL: logical unique table rows in table,"SELECT DISTINCT
   CASE WHEN link_side_a_element_id < link_side_b_element_id THEN link_side_a_element_id
        ELSE link_side_b_element_id END as a,
   CASE WHEN link_side_a_element_id < link_side_b_element_id THEN link_side_b_element_id
        ELSE link_side_a_element_id END as b
FROM
    table
"
31119,Need to generate XML from SQL in this following format,"SELECT OrderNumber AS @Id, CustomerID, ITEM
FROM OrderHeader
FOR XML PATH('Order'), ELEMENTS, ROOT('Orders')
"
25001,Using output of one query as WHERE clause of another -- SQL Server 2008,"SELECT * FROM tblFilms 
WHERE tblFilms.Filename IN (SELECT DISTINCT fileNames FROM tblFiles);
"
9528,Get number of values that only appear once in a column,"SELECT COUNT(F)
FROM (
    SELECT F
    FROM T
    GROUP BY F
    HAVING COUNT(*) = 1
) AS ONLY_ONCE
"
36151,MySQL: create a sequence by order of appearance,"SELECT id, D, (SELECT COUNT(*) + 1
               FROM mytable AS t2
               WHERE t1.D = t2.D AND t2.id < t1.id) AS S
FROM mytable AS t1               
"
30345,Oracle query on time (and not date),"select * from mytable 
where 
to_char( date_column, 'HH24:MI:SS' ) < '05:30:00'
"
2042,Perl DBI - Use of uninitialized value,"next unless defined $hash{$key};
"
17649,SQL join query help - data validation,"select c.city, a.area
from (select distinct city from cityarea) c cross join
     (select distinct area from cityarea) a left outer join
     cityarea ca
     on ca.city = c.city and
        ca.area = a.area
where ca.city is null;
"
12029,Mutual Friends Mysql Query,"SELECT *
FROM friend_list AS f
INNER JOIN friend_list AS mf ON f.friend_id = mf.friend_id
WHERE f.uid = 7
   AND f.status = 1
   AND mf.uid = 3
   AND mf.status = 1
"
25981,Using parameter from form in IN statement,"Sub MakeTheQuery()
    Dim db As DAO.Database
    Dim strSQL As String
    Dim strElements As String

    Set db = CurrentDb()

    strSQL = ""SELECT Sum(id) AS numobs "" & _
        ""FROM ErrorKey WHERE ErrorKey.ID In ({0});""

    ' Example: ""3,5""
    strElements = Forms!YourForm!YourControl.Caption

    ' Assign SQL to query
    db.QueryDefs!YourQuery.SQL = Replace(strSQL, ""{0}"", strElements)

End Sub
"
12640,Oracle cartesian product vs. join,"SELECT *
FROM orders o
JOIN products p ON o.productid = p.id
"
18106,MySQL query to sort upcoming birthdays based on current date,"SELECT
    name,
    birthday,
    birthday + INTERVAL(YEAR(CURRENT_TIMESTAMP) - YEAR(birthday)) + 0 YEAR AS currbirthday,
    birthday + INTERVAL(YEAR(CURRENT_TIMESTAMP) - YEAR(birthday)) + 1 YEAR AS nextbirthday
FROM bd
ORDER BY CASE
    WHEN currbirthday >= CURRENT_TIMESTAMP THEN currbirthday
    ELSE nextbirthday
END
"
37898,Start row number with custom number in sql server 2008,";WITH CTE
AS
(
    SELECT
        ROW_NUMBER() OVER(ORDER BY tblUser.ID DESC)+1 AS rowNbr,
        tblUser.*
    FROM
        tblUser
    WHERE NOT tblUser.Id=1
)
UPDATE CTE 
SET Birthday = rowNbr
"
8168,PL/SQL - Pre actions if cursor is found,"OPEN emp_cur;
FECTH emp_cur INTO emp_rec;

IF emp_cur%FOUND
THEN
  -- pre actions
END IF;

LOOP
  EXIT WHEN emp_cur%NOTFOUND;
  -- do something in the loop
  FECTH emp_cur INTO emp_rec; -- First fetch was done before the if
END LOOP;

CLOSE emp_cur;
"
11319,Finding Non Matching ID,"select count(*) from one a where not exists (select * from two b where a.bene=b.bene)
"
24027,TSQL: string operations to match a pattern or wildcard for one character,"LIKE '___ ___'
"
7973,Using SQL to get values from another table given a table with two columns of key,"select l1.name as src, l2.name as dest
from Mapping m 
inner join Locales l1 on m.src = l1.id
inner join Locales l2 on m.destination = l2.id
"
35223,SQL related wonky error if there is no HTTP in the URL,"CASE WHEN UPPER(wuu.URL) LIKE 'HTTP://%'
THEN wuu.UR
ELSE 'HTTP://' || wuu.URL
END
"
35211,How do I expand comma separated values into separate rows using SQL Server 2005?,"select pv.productid, colortable.items as color
from product p 
	cross apply split(p.color, ',') as colortable
"
21694,How to alias in rethinkdb?,"r.table(""table_name"").map({
    alias_name: r.row(""column_name"")
})
"
7097,Finding the lone occurence of a value in a table,"select Count(*)
from
  (select l_id From M group by l_id having count(*)=1) m
"
17921,sqlplus gets ORA-12504 when using EZCONNECT syntax,"C:\>sqlplus sys@\""localhost:1521/orcl12\"" as sysdba

SQL*Plus: Release 12.1.0.2.0 Production on Fri Sep 18 13:10:19 2015

Copyright (c) 1982, 2014, Oracle.  All rights reserved.

Enter password:

Connected to:
Oracle Database 12c Enterprise Edition Release 12.1.0.2.0 - 64bit Production
With the Partitioning, OLAP, Advanced Analytics and Real Application Testing options

SQL>
"
3586,Add opening balance to the first closing balance row in MySQL,"set @depos=0;
set @total=5000;
select 
  entry_date, 
  entry_item, 
  entry_amount, 
  if( entry_amount>0, @depos:=entry_amount, @depos:=@depos+entry_amount ) as depos_bal,
  @total:=@total+entry_amount as net_bal from chequebook
order by entry_date; 
"
34350,Tsql union of sub queries that each require an ORDER BY clause,"SELECT * 
  FROM (SELECT TOP 5 * 
          FROM [geo].[Areas] 
         WHERE CountryID = @CountryID 
           AND (TypeID = 'City')
      ORDER BY [ShapeArea] DESC) as BiggestCities
UNION ALL
SELECT * 
  FROM (SELECT TOP 5 * 
          FROM [geo].[Areas] 
         WHERE CountryID =  @CountryID 
           AND (TypeID = 'National park')
      ORDER BY [ShapeArea] DESC) as BiggestParks
"
15016,insert SET STATISTICS TIME into a table,"declare @StartTime datetime = getdate();
Select * from myTable;
declare @Dur datetime = getdate() - @StartTime;
"
6073,Is it possible to pass a value to an order by clause using SQL?,"select b.KeyValue,
       a.rqstId,
       a.orchiveId,
       case when c.KeyTypeName = 'key2' then 0 else 1 end as KeyTypeNameForOrder
  from rqst a, key b, keyType c
 where a.statusId = 102
   and a.requestType = 4
   and a.processTypeId = 5
   and b.rqstId = a.rqstId     
   and c.KeyTypeId = b.keyTypeId
 order by 4
"
12457,FIND_IN_SET for part of string in Mysql,"SELECT *
FROM table1
WHERE col1 RLIKE 'twitter'
"
34834,Inserting rows into table with only one column left and with out using column names," INSERT INTO b SELECT *,NULL FROM a;
"
10996,Special sorting for MySQL result,"SELECT * FROM `pctable`order by colName=6 desc, colName 
"
11684,Aliasing a linked server?,"EXEC master.dbo.sp_addlinkedserver @server = N'ALIAS', @srvproduct=N'ACTUALSERVER', @provider=N'SQLOLEDB', @datasrc=N'ACTUALSERVER'
"
31042,"MySQL help, updating fields based on a calculation","Update table set size = 'Large' where ID in (select TOP 33 PERCENT ID from table order by length*width Desc)

Update table set size = 'Small' where ID in (select TOP 33 PERCENT ID from table order by length*width Asc)

Update table set size = 'Medium' where size = null
"
28241,How to get count values for multiple values in one column,"SELECT [Name], 
       SUM ( CASE WHEN [Values]='VAL1' THEN 1 ELSE 0 END ) AS Val1Count,
       SUM ( CASE WHEN [Values]='VAL2' THEN 1 ELSE 0 END ) AS Val2Count
  FROM [table1]
GROUP BY [Name]
"
9163,SQL query with ORDER BY inside two different groups,"select id, player, mp, ppg
from 
    playerTable
order by if (mp>=30, 1, 0) desc, ppg desc, mp desc`
"
34011,Left join with different queries from same table where identifier has incremented suffix,"from (select * from [table] 
       where (id LIKE '1234%' OR [Id] LIKE '2341%')
         AND Counter = 'counter_1') t1
"
4597,ladder-like record selection without looping,";WITH RCTE AS 
(
    SELECT * FROM Table1 WHERE A = 3
    UNION ALL
    SELECT t.* FROM RCTE r
    INNER JOIN Table1 t ON r.B = t.A
)
SELECT * FROM RCTE
"
12609,UTF 8 from Oracle tables,"select value from nls_database_parameters 
where parameter='NLS_CHARACTERSET'
"
27096,Oracle 11g SQL to get unique values in one column of a multi-column query,"SELECT * FROM TableA
WHERE ROWID IN ( SELECT MAX(ROWID) FROM TableA GROUP BY Language )
"
12017,"TSQL: select the latest N rows, if not specified select all","CREATE PROCEDURE [dbo].[spProducts]
    (@Rows int =null)
AS
     SELECT TOP(ISNULL(@Rows,0)) *
     FROM tblProduct
        UNION SELECT *
    FROM tblProduct
        WHERE @Rows is null
"
32374,Multiple Many-to-many bi-directional self-inner-joins without repeating whole query,"CREATE VIEW bidirec_item_assoc AS
(
SELECT item_id, other_item_id, assoc_type, 1 as direction FROM item_assoc
UNION
SELECT other_item_id, item_id, assoc_type, 2 as direction FROM item_assoc
)
"
32661,How to join a table with array(set?) in sql?,"select * from history where entry_id in (45,234,435)
"
1203,Merging two tables without any join key,"select t1.*, t2.*
from table_1 t1 cross join
     table_2 t2;
"
36950,Select random sampling from sqlserver quickly,"USE AdventureWorks2008; 
GO 


SELECT FirstName, LastName
FROM Person.Person 
TABLESAMPLE (100 ROWS)
WHERE EmailPromotion = 2;
"
11411,SQL Cast/Convert Issue,"DECLARE @Year int = 2013
DECLARE @fiscalstart datetime = cast(@Year as varchar(4)) + '0701'
"
38139,How to ignore left padding in a LIKE statement?,"where id like '123%'
or id like '% 123%'
"
10974,Oracle select top N rows based on Values,"SELECT Marks FROM (
  SELECT Marks, DENSE_RANK() OVER (ORDER BY Marks DESC) AS MarksRank
  FROM yourtable
) WHERE MarksRank <= 4
"
10495,Write XML with SQL Command,"SELECT c.[id_Cust]
      ,[Name]
      ,[Omset]
      ,[Colour]
      ,[seq]
      ,(SELECT a.[Address],a.[no1],a.[no2] FROM address_BSM a
      WHERE a.id_cust = c.id_cust
  FOR XML PATH ('address_bsm'), TYPE)
  FROM [dbo].[Customer_BSM] c
  FOR XML PATH ('customer_bsm')
"
13992,DISTINCT in a simple SQL query,"SELECT DISTINCT AL.name
FROM albums AL
"
31638,complex sql query to get data from four tables,"SELECT  P.PR_NAME,
        DC.DEFAULT_OA,
        PA.ADDRESS 
FROM    PDB_PROFILE P
JOIN    MDB_PERMITTED_ADDRESS PA ON P.PR_ID = PA.SERVICE_ID
JOIN    MDB_SERVICE_CONN_PR SC ON P.PR_ID = SC.EXC_SERVICE_ID
JOIN    MDB_DRIVER_CONN_PR DC ON SC.DRIVER_CONN_ID = DC.PR_ID
"
22590,How to Group same field under one field using sql query,"select * from t
order by CASE WHEN HOD_CODE='P00212' THEN EMP_NO ELSE HOD_CODE END,
         CASE WHEN HOD_CODE='P00212' THEN 0 ELSE 1 END
"
32130,After updating a field some columns are blank,"update GCCC_ATCOM_CLOSING_REASON_I18N a 
set a.DESCRIPTION = 
    (select b.CLOSING_REASON_DESCRIPTION from GCCC_ATCOM_CLOSING_REASON b where b.ID_CLOSING_REASON = a.ID_PARENT)
WHERE a.DESCRIPTION ='I HAVE A CAR'
"
19956,How to delete an attribute from an XML variable in sql server 2008?,";WITH XMLNAMESPACES (DEFAULT 'http://cp.com/rules/client' )
SELECT
    XmlDocument.value('(/clue_personal_auto/admin/report_usage)[1]', 'varchar(25)')
FROM XML
WHERE ID = 357
"
36331,Using a WITH inside of a RECURSIVE WITH in PostgreSQL,"WITH RECURSIVE
   num  AS (VALUES (50))
,  num2 AS (SELECT column1 * 2 AS value FROM num)
,  t(n) AS (
      VALUES (1)
      UNION ALL
      SELECT n+1 FROM t WHERE n < (SELECT * FROM num2)
   )
SELECT sum(n) FROM t;
"
5366,How to treat NULL values as 0 from MySQL,"     SELECT tb1.id
        FROM table_one tb1 
   LEFT JOIN table_two tb2 ON tb2.user_id = tb1.user_id
       WHERE tb1.min_val <= IFNULL(tb2.act_val,0)
         AND tb1.max_val >= IFNULL(tb2.act_val,0)
    GROUP BY tb1.id;
"
13702,"Two tables with linking column ""id"" that return only unique ""id"" lines for the parent table","SELECT T.*, P.* 
FROM Threads 
INNER JOIN POSTS P ON T.id = P.id 
WHERE ((T.subject LIKE '%blue%') OR (P.post LIKE '%blue%')) 
AND P.Timestamp = (Select min(P2.timestamp) from posts P2 where ID = T.ID) 
ORDER BY P.timestamp
"
17988,Update portions of Data in Oracle,"update IPDATA 
set info=replace(info, '1:', '1,' )  
where info like('%ZZZ Gateway gen1:gen2%')
"
2691,"SQL Injection Based on """"=""""","SELECT 
    * 
FROM 
    Users 
WHERE 
    (Name = '' OR '' = '') 
    AND 
    (Pass = '' OR '' = '')
"
3007,SQL Server query + joining results,"select a.ID,Received,Sent
from(
  SELECT recipientid AS ID,
  COUNT(*) AS Recieved FROM Inbox
  GROUP BY recipientid
)a
full outer join(
  SELECT SenderId as ID,
  COUNT(*) AS [Sent] FROM Inbox
  GROUP BY SenderId
)b
on (a.ID = b.ID)
order by a.ID;
"
29096,SQL query - db2/400 iseries,"select Price, Date,
       sum(case when code = 'B' then Qty when code = 'S' then -QTY end) as diff
from Table
where Type = 'A' and Acct = 'CLOSED'
group by Price, Date
order by Price, Date;
"
7666,Select first record found,"UPDATE mytable SET col1 = '789' WHERE col2='245' LIMIT 1;
"
7462,Join condition in mysql need to ignore null field,"SELECT 
  post.*, 
  post_image.name AS img 
FROM post
LEFT JOIN post_image ON post_image.postId = post.id 
LIMIT 10;
"
37614,How to order the ngrams in Google's database (or the one hosted on AWS) by frequency,"raw = LOAD '/foo/input' USING PigStorage('\t') AS (ngram:chararray, year:int, count:int, pages:int, books:int);
filtered = FILTER raw BY year >= 1980;
grouped = GROUP filtered BY ngram;
counts = FOREACH grouped GENERATE group AS ngram, SUM(filtered.count) AS count;
sorted = ORDER counts BY count DESC;
limited = LIMIT sorted 10000;
STORED limited INTO '/foo/output' USING PigStorage('\t');
"
10794,Conditional join from different tables,"Select id,index,T.description from items
join (select 1 as id, index, description from Table_A 
UNION select 2 as id, index, description from Table_B) as T
ON items.id=T.id and items.index=T.index
"
4266,Selection of rows related to a set of other rows,"select entity.*
     , count(*) as relevance 
  from entities
     , tags
     , entity_tags
 where entities.id=entity_tags.entity_id 
   and tags.id=entity_tags.tag_id
   and tags.name in ('fruit', 'organic', 'item')
group by entity.id  having count(entities.id) > 1
order by relevance
"
14927,SQL Oracle - Count of repeat call within a relative data range,"select CustomerId, CallDate, 
       (select count(*)
        from table t2
        where t2.CusomerId = t.CustomerId and
              t2.CallDate >= t.CallDate - 5 and t2.CallDate < t.CallDate
       ) as Repeat
from table t;
"
3199,SQL. Perfomance of count on many columns,"select count(distinct col1),
       count(distinct col2),
       ...
from   table;
"
2870,SQL Select with multiple IDs,"select t1.empid,
  t1.addrid,
  t1.address
from table1 t1
inner join
(
  select max(addrid) addrid, empid
  from table1
  group by empid
) t2
  on t1.empid = t2.empid
  and t1.addrid = t2.addrid
"
36520,How to get records that exist in one MySql table and not another,"SELECT wafer_log.wafer, wafer_log.id AS wlid 
FROM wafer_log
WHERE wafer_log.id NOT IN (SELECT id FROM bt_log);
"
27408,Collapse SQL rows,"select demotable.*
from demotable
left join demotable as prev on prev.id = demotable.id - 1
where demotable.name != prev.name
"
10666,MySQL - Recursive UPDATE with variable incrementation,"UPDATE Table1 t
INNER JOIN (
  SELECT
  id, /*your primary key I assume*/
  @new_ob:=if(@prev != dimension, 1, @new_ob + 1) as new_ob,
  @prev := dimension /*In this line, the value of the current row is assigned. In the previous line, the variable still holds the value of the previous row*/
  FROM
  Table1
  , (SELECT @prev := null, @new_ob := 0) var_init_subquery
  ORDER BY dimension, order_by
) st ON t.id = st.id
SET t.order_by = st.new_ob;
"
30903,Match the elements of array in query,"  SELECT post_id_post
    FROM posts
   WHERE tags_id_tags IN (""16"", ""17"", ""36"", ""543"")
GROUP BY post_id_post
  HAVING COUNT(*) = 4
"
24983,Dateadd without using function,"SELECT  ( yr * 12 + mnt + @Diff - 1) / 12 * 10000 + 
       (( yr * 12 + mnt + @Diff - 1) % 12 + 1) * 100 + 1 
FROM   (SELECT @EffectiveDate / 100%100 Mnt, 
               @EffectiveDate / 10000   Yr)T 
"
18602,"How to format ""time with time zone"" in Postgres?","SELECT TO_CHAR(date '2001-09-28' +time, 'HH24:MI:SS')
"
4752,"MySQL - Finding mismatches between sets of ""batched"" data","SELECT * 
FROM order_addresses o1
  INNER JOIN order_addresses o2 
  ON o1.parent_id = o2.parent_id 
  AND o1.entity_id <> o2.entity_id
WHERE o1.last_name <> o2.last_name
  OR o1.zip_code <> o2.zip_code
"
13559,sql selecting from different tables based on boolean,"  SELECT  products.*  
          , CASE WHEN isMainUser=1 
            THEN MainUser.emailAddress 
            ELSE SubUser.emailAddress 
            END
  FROM    tblProducts as products  
          LEFT OUTER JOIN MainUser mu ON mu.UserProductID = products.UserProductID
          LEFT OUTER JOIN SubUser su ON su.UserProductID = products.UserProductID      
  WHERE   product.intID = @id   
"
27163,How to efficiently check if a database contains an identical record to a pending insert?,"UPDATE thetable
   SET valueCol1 = @newValue1
     , valueCol2 = @newValue2
     , ...
WHERE idCol = @newId
  AND (valueCol1 <> @newValue1
      OR valueCol2 <> @newValue2
      OR ...
      );

IF (ROWCOUNT > 0) RETURN;

INSERT INTO thetable (idCol, valueCol1, valueCol2, ...)
VALUES (@newId, @newValue1,  @newValue2, ... )
WHERE NOT EXISTS ( SELECT * FROM thetable nx
    WHERE nx.idCol = @newId
    );
"
8227,How to create SQL Database from Linq2Sql Model,"YourDataContext db = new YourDataContext (""C:\\YourDB.mdf"");
db.CreateDatabase();
"
4352,How to get AS two separate selectors with UNION?,"select * from
(select count(*) as customer_count from Customers) x,
(select count(*) as supplier_count from Suppliers) y
"
11671,How can a SQL query have two from clauses?,"delete from [GearsDev].[dbo].[Products]
where ItemNumber in
(
  select item from #common
)
"
12717,how to convert the datetime value to hour,"SELECT RIGHT(CONVERT(varchar(7), Myvalue, 100), 7)
"
2995,Is there a better way of creating this case query,"select 
    case
        when bllgrp_desc like '30%' then billgrp_desc
     end
from tbm.billgrp
union 
    select 
           isNull(gp.billgrp_desc,mt.matter_code)
    from hbm.matter mt
    left join billgrp gp on billgrp_desc not like '30%'
"
32820,SQL code to find the top 6,";WITH top_cte AS
(
  SELECT *, ROW_NUMBER() OVER(PARTITION BY Company ORDER BY Revenue DESC) AS [Rank]
  FROM table
)
SELECT *
FROM top_cte
WHERE [Rank] <= 6
"
7395,SQL Server: How to format time interval?,"select CAST(datediff(dd, '02-21-2012 00:00', '02-22-2012 01:01') AS VARCHAR(12))+'d '+
CAST(datediff(hh, '02-21-2012 00:00', '02-22-2012 01:01')%24 AS VARCHAR(2))+'h '+
CAST(datediff(n, '02-21-2012 00:00', '02-22-2012 01:01')%60 AS VARCHAR(2))+'m'
"
23807,How can I use two SEDE (SQL) queries as the inputs for a third query?,"SELECT
  PostId as [Post Link],
  COUNT(CASE VoteTypeId WHEN 2 THEN v.PostId END) AS 'Upvote count',
  COUNT(CASE VoteTypeId WHEN 3 THEN v.PostId END) AS 'Downvote count'
FROM Votes v
INNER JOIN Posts p
ON p.Id=v.PostId
WHERE PostTypeId = 1
  AND VoteTypeId IN (2, 3)
GROUP BY v.PostId
HAVING COUNT(CASE VoteTypeId WHEN 2 THEN v.PostId END) > 150
   AND COUNT(CASE VoteTypeId WHEN 3 THEN v.PostId END) > 10
"
36501,DELETE MySQL subquery,"DELETE FROM uren WHERE uren.urenDossierID IN (SELECT dossierID FROM dossier WHERE dossierKlantID NOT IN (SELECT klantID from klant))
"
12784,Readonly access to stored procedures,"SELECT owner, name, text
FROM all_source
WHERE owner = '<your schema name>'
ORDER BY owner, name, text, type, line;
"
30956,What kinds of data queries are too hard to do on CouchDB (as opposed to SQL)? Seeking concrete examples,"SELECT * FROM the_table 
WHERE {filter_col} = {filter_value} [ AND ... ]
ORDER BY {order_col}
LIMIT {n} OFFSET {m}
"
21732,Is there an elegant way to Invert a Bit value in an SQL insert Statement?,"INSERT INTO MYTABLE (AllowEdit) 
(SELECT ~PreventEdit FROM SourceTable)
"
39939,SQL Select statement split into groupings / chunks,"select ROW_NUMBER() over (ORDER BY id) RowNum,
       id,
       ((ROW_NUMBER() over (ORDER BY id) - 1)  / 5) +1 as ChunkNo  
from t
"
26772,MySql and Mybatis select distinct rows where value <= ##,"SELECT u.username, u.firstName, u.lastName, min(r.roleLevel) minroleLevel
  FROM AUTHORITIES a, ROLES r, USERS u
 WHERE r.role =  a.authority
   AND a.username = u.username 
   AND r.roleLevel <= #{roleLevel}
 GROUP BY u.username, u.firstName, u.lastName 
 ORDER BY u.lastName, u.firstName
"
6228,Prevent deleting or updating the parent if child exists in SQL Server 2008,"CREATE TABLE parent
(
    [SEARCHID] [int] NOT NULL,
    [COMPID] [int] NOT NULL,
    [COMPPNO] [varchar](35) NOT NULL,
    [PACKSIZE] [varchar](100) NOT NULL
);

CREATE TABLE CHILD
(
    [SEARCHID] [int] NOT NULL CONSTRAINT FK_Child_SearchId FOREIGN KEY REFERENCES parent(SEARCHID),
    [COMP_ID] [int] NULL,
    [PROD_LINK] [varchar](500) NULL,
    [SRPNO] [varchar](24) NULL
)
"
14452,Creating a view that consist column with static info,"CREATE VIEW TEST AS 
(
    SELECT a.ID, a.E_ID, b.CAT1 as C1, c.CAT1 as C2, 'NL' AS add1, 'RS' AS add2
    FROM RECP a
    JOIN ART  b on (a.ID=b.SKU)
    JOIN ART  c on (E_ID=c.SKU)
)
"
34464,SQL: return a list of the latest actions of users,"SELECT t.user_id, max(t.modified) as modified, t.status
FROM table t
JOIN
(   SELECT user_id
    FROM table
    WHERE action_id <> 1 and status = whatever 
)t1 ON t1.user_id = t.user_id
GROUP BY t.user_id
"
14002,Erlang : Mnesia : Updating a single field value in a row,"update_a(Tab, Key, Value) ->
  fun() ->
    [P] = mnesia:wread({Tab, Key}),
    mnesia:write(P#pixel{a=Value})
  end.
"
7789,SQL Server: Find Values that don't exist in a table,"SELECT * FROM
(
SELECT -1 AS N
UNION 
SELECT 2 AS N
) demo 
EXCEPT 
SELECT     number
FROM         spt_values
"
22741,How to ignore nulls in an Oracle analytic function,"select
  FIRST_VALUE(BILL_ID) OVER(PARTITION BY ACCOUNT_ID ORDER BY BILL_DT DESC NULLS LAST) bill_id,
  FIRST_VALUE(BILL_DATE) OVER(PARTITION BY ACCOUNT_ID ORDER BY BILL_DT DESC NULLS LAST) bill_date
...
"
1921,Is there a better way to select a boolean from a table?,"SELECT fldid AS ""id"",
       TRIM(fldlabel) AS ""name"",
       (case when fldid in (53, 54, 7) then 'true' else 'false' end) as visible
FROM fieldTable
WHERE fldActive = 1;
"
22603,SQL: Are we able to combine multiple conditions into one result column?,"SELECT TOP 1 name, email, phone, is_user = CASE
   WHEN ( isuser = 1 
      OR is_user = 1
      OR cust_type LIKE 'USER%'
      OR cust_type = 'DIRECT USER')
   THEN 1 ELSE 0 END,
 is_reseller = CASE 
   WHEN (...any condition that makes a customer a reseller...)
   THEN 1 ELSE 0 END
FROM dbo.customer
...WHERE...
"
1576,how to store a *sorted* SELECT result in another table?,"SET @counter := 0;

INSERT INTO resultsetdata
  SELECT *, @counter := @counter + 1
  FROM (
      SELECT ""12345"", a.ID
      FROM sometable a
      JOIN bigtable  b
      WHERE a.foo = b.bar
      ORDER BY a.whatever DESC
  ) AS tmp
"
10653,SQL group by subselect,"select distinct t1.title_id, t1.shared_task_id
from mytable t1 join mytable t2 on t1.shared_task_id = t2.shared_task_id 
and t1.title_id <> t2.title_id
"
32830,IF statements on SQL queries,"SELECT id,
       case status when 'open' then 'In Progress'
                   when 'matched' then 'Approved'
                   when 'completed' then 'Realized'
       end as status
from applications
"
27061,nested SQL statements but reusing out variable in the inner statement?,"SELECT surveyquestions.priority, surveyquestions.id, surveyquestions.question,       surveyquestions.html FROM surveyquestions
    LEFT JOIN surveyanswers oa ON surveyquestions.id = oa.id AND oa.uuid = 22946252362612764
    WHERE (surveyanswers.id IS null OR 
    (SELECT datestamp FROM surveyanswers ia WHERE ia.id = oa.id ORDER BY datestamp DESC LIMIT 1) < 
    DATE_SUB(NOW(),INTERVAL 1 HOUR))
    AND surveyquestions.priority != 999 
    AND surveyquestions.brid = 'testprod2'
    ORDER BY surveyquestions.priority LIMIT 1;
"
10450,SQL (Oracle) : how to improve a select ordered by x desc,"select * from log_table 
where log_date >= trunc(sysdate)  --current_day
order by log_id desc, log_date desc
"
8637,Single SQL query to check if either table contains a row with column=x,"
Select c.*, a.*, b.*
From c.id
    Left Outer Join a On a.id  = c.id
    Left Outer Join b On b.id = c.id
Where c.id = @somevalue and (a.id Is Not Null or b.id Is Not Null)
"
11938,how do i combine and sum two results in sql?,"    select IIF(MyColumn<>'CCC', 'AAA+BBB', 'CCC'), 
     100*count(MyColumn='CCC')/(select count(*) from MyTable) from MyTable
     group by MyColumn='CCC'
"
13721,Dropping SQL Server database: handling concurrent connections,"ALTER LOGIN MyAppUser DISABLE
ALTER DATABASE TestXyz SET SINGLE_USER WITH ROLLBACK IMMEDIATE
DROP DATABASE TestXyz
ALTER LOGIN MyAppUser ENABLE
"
6407,Using different order by with union,"SELECT * 
FROM (SELECT TOP 10 A.*, 0 AS Ordinal
      FROM A
      ORDER BY [Price]) AS A1

UNION ALL

SELECT * 
FROM (SELECT TOP 3 A.*, 1 AS Ordinal
      FROM A
      ORDER BY [Name]) AS A2

ORDER BY Ordinal
"
34439,Performance issue with ORDER BY + AND in sqlite,"SELECT * from table1
WHERE md5sum LIKE '00%' AND status = 'Ok'
ORDER BY md5sum, status
;
"
6218,Inserting a null value into the database,"Insert INTO tblTest (fieldOne,FieldTwo) VALUES ('valueOne','valueTwo').
"
3677,Combine multiple count statements into single select statement,"SELECT COUNT(*) as total_attempts,
  COUNT(CASE WHEN correct = true THEN 1 ELSE NULL END) as score
FROM assessment
WHERE student_id = 1
GROUP BY lesson_id
"
5800,SQL Server query search putting a certain value match at top,"select Product.TblProducts.Product_ID, Product.TblProducts.Product_Name,
       Product.TblProducts.Country 
from Product.TblProducts
WHERE  (Product.TblProducts.Domain = 'mysite.co.uk')
order by (case when Country = 'United Kingdom' then 1 else 2 end)
"
25807,Create a new db user in SQL Server 2005,"CREATE LOGIN [user] WITH PASSWORD='password', 
       DEFAULT_DATABASE=[your_db], CHECK_POLICY=OFF
GO

CREATE USER [user] FOR LOGIN [user]
EXEC sp_addrolemember N'db_datareader', N'your_db'
EXEC sp_addrolemember N'db_datawriter', N'your_db'
GO
"
27731,Match a column from a column with concatenated values in sqlite,"SELECT ChildId,MainValues FROM CHILD INNER JOIN MASTER WHERE ','||[Values]||',' like '%,'||MainValues||',%'
"
20519,Make only 1 column distinct in SQL?,"SELECT TableA.n AS ColumnA, TableB.n AS ColumnB, (TableA.n + TableB.n) as [Sum]
FROM MyTable AS TableA CROSS JOIN
      MyTable AS TableB
WHERE TableA.n < TableB.n AND
      TableA.n <= 3 AND TableB.n <= 3 ;
"
31467,Counting the number of appearances of each id in a table sql db2,"select 
    PID, 
    count(*) as PIDCount
from 
    sales 
group by 
    PID;
"
16915,Efficient SQL for selecting for values and NOT values in a join table,"SELECT tableA.*
FROM tableA
WHERE
  EXISTS(
    SELECT NULL
    FROM TableB 
    WHERE tableA.ID = TableB.FK_ID AND TableB.Code = 'C1')
  AND NOT EXISTS(
    SELECT NULL
    FROM TableB 
    WHERE tableA.ID = TableB.FK_ID AND TableB.Code = 'N1')
"
17,Checking whether conditions are met by all rows with dynamic SQL,"EXEC sp_executesql N'SELECT @passed = 0 WHERE EXISTS (' +
                       N'SELECT 1 FROM ' +  @StagingTableName +
                       N'WHERE NOT(' + @CustomValidationExpr + N')) ' +
                  ,N'@passed BIT OUTPUT'
                  ,@passed = @PassedcustomValidation OUTPUT
"
4669,Need to know if between and like can be used together or something better in sql,"select count(*) from table_testcase_execution
where campaign_session_id = any(
    SELECT campaign_session_id
    FROM table_campaign_session
    WHERE campaign_session_name = 'sitename')
AND timestamp >= ""1288929643000"" AND timestamp <= ""1289010305999""
"
5523,How to capture return value of sproc?,"CREATE TABLE #MyTemp 
  (UserId INT, 
  SomeVar VARCHAR(50))

INSERT #MyTemp
  EXEC MySproc
"
17263,Display Parent-Children in single line in Crystal Reports,"// {@a}
If {Table B.Foo}='A' Then {Table B.Bar}
Else 0

// {@b}
If {Table B.Foo}='B' Then {Table B.Bar}
Else 0

// {@c}
If {Table B.Foo}='C' Then {Table B.Bar}
Else 0
"
3479,"How to do ""select current_timestamp"" in hsqldb?","select current_timestamp from tablename
"
9782,Select max record of each group on a group by,"SELECT DISTINCT ON (3)
       sum(d.cantidad) AS suma
     , d.producto_id AS producto
     , to_char(o.fecha AT TIME ZONE 'MST', 'DY') AS dia
FROM   detalle_orden d
LEFT   JOIN orden o ON o.id = d.order_id
GROUP  BY o.fecha, d.producto_id 
ORDER  BY 3, 1 DESC NULLS LAST, d.producto_id;
"
23477,sql select rows that match an evaluated condition,"SELECT t1.customer_name, t1.total, t2.customer_name, t2.total,
       (t1.total - t2.total) as var_1
FROM topuserslcy t1 CROSS JOIN
     topuserslcy t2
WHERE t1.report_date = '2015-12-22' AND
      t2.report_date = '2015-12-23' 
HAVING var_1 > 0;
"
38245,how to order 2 SQL Fields in asc and desc dynamically,"DECLARE @asc_desc VARCHAR(4);

SET @asc_desc = 'DESC';

DECLARE @sql NVARCHAR(1000);

SET @sql = 'Select * from Customer Order By Date ' + @asc_desc + ', Name';

EXEC sp_executesql @sql
"
39848,SELECT records MySQL: between date + 1,"  (select * from t where date < start_date order by date desc limit 1)
  union (select * FROM t WHERE date between start_date and end_date)
  union (select * from t where date > end_date order by date asc limit 1)
"
28048,Oracle SQL check correlative ranges,"with v_data as (
  select 'Range1' name, 1 low, 3.99 high from dual union all
  select 'Range2' name, 4 low, 6.99 high from dual union all
  select 'Range3' name, 7 low, 10 high from dual 
) 
select 
  v1.*,
  lag(high) over (partition by 1 order by high) as prev_high ,
  low - lag(high) over (partition by 1 order by high) as diff 
from v_data v1
"
38400,Convert output of MySQL query to utf8,"SELECT column1, CONVERT(column2 USING utf8)
FROM my_table 
WHERE my_condition;
"
9753,Is it possible in SQL to match a LIKE from a list of records in a subquery?,"select distinct RC.* from RegisteredCodes RC, CodeVariations CV
where RC.CODE LIKE CV.CODE;
"
35132,database select,"select
  film.filmname
from
  film
  join film_category
  on film.film_id = film_category.film_id
where
  film_category.category_id = 3
"
24092,SQL server datetimeoffset data aggregation,"with MyCTE as (
    select case 
            when datepart(hh,date ) between 0 and 6 then 1
            when datepart(hh,date ) between 6 and 12 then 2
            when datepart(hh,date ) between 13 and 18 then 3
            else 4
            end
          as myDatebucket 
    , *
    from session
) 
select myDatebucket, count(*)
from MyCTE
group by myDatebucket
order by myDatebucket
"
16603,Is it possible to standardise data in SQL Queries,"...
SELECT 
  SUM(CASE survived WHEN 'Y' THEN 1 ELSE 0 END) / 
  COUNT(r.call_date) AS NormalisedEvents,
....
"
23823,Converting a boolean field to 'yes' or 'no' statement on select,"select iif(bool_field_name, 'yes', 'no')
"
6175,Oracle Apex-Character limitation in text item field,"($v('P_ITEM').length >= 14 && $v('P_ITEM').substring(0,1) == '1') ||
($v('P_ITEM').length >= 11 && $v('P_ITEM').substring(0,1) == '2')
"
10358,Getting row sum of the Table,"select Date,
       col1 + col2 + col3 as Total,
       col1, col2, col3
  from your_table;
"
999,Limit length of longtext field in SELECT results,"SELECT SUBSTRING(`text`, 1, 100) FROM blog_entry;
"
37870,mySQL count table efficiently,"Select Name,
       sum(case when Class = 1 then 1 else 0 end),
       sum(case when Class = 2 then 1 else 0 end),
       sum(case when Class = 3 then 1 else 0 end)
from myTable
group by Name
"
24311,SQL query returning results based off values in an array PostgreSQL,"SELECT * FROM Table2 WHERE table1id IN (SELECT ...)
"
37398,"SQL: Ignore some returned rows, deleting others","DELETE FROM tbl t
USING (
    SELECT id, row_number() OVER (PARTITION BY recipient_id
                                  ORDER BY updated_at DESC) as rn
    FROM   tbl
    WHERE  is_read
  ) x
WHERE  x.rn > 5
AND    x.id = t.id;
"
36421,Creating a Database to a messenger application,"user_id | frienduser_id
1       | 4
1       | 8
1       | 9
8       | 5
8       | 6
...
"
35298,distinct condition in case statement,"SELECT Event_ID,   
SUM(CASE 
   WHEN POSA IN ('SX', 'DX')  THEN 1
   WHEN DISTINCT(""S"") THEN something 
    ELSE 0   END)   AS cnt1, 
SUM (CASE  
    WHEN POSA IN ('SP', 'DP')  THEN 1
    WHEN DISTINCT(""S"") THEN something 
    ELSE 0   END) AS cnt2    
FROM Station_Processed_Info GROUP BY EVENT_ID;
"
27176,access - reset all comboboxes to itemdata(1) in form,"Private Sub Command1_Click()
     Me.Combo1.Value = Nothing
     Me.Combo2.Value = Nothing
     Me.Combo3.Value = Nothing
     Me.Combo4.Value = Nothing
     Me.Combo5.Value = Nothing
     Me.Combo6.Value = Nothing
     Me.Combo7.Value = Nothing
     Me.Combo8.Value = Nothing
End Sub
"
18505,Convert text to date format,"SELECT CAST(
     SUBSTRING('Thursday, 1 January 2009', 
       CHARINDEX(',', 'Thursday, 1 January 2009')+1, LEN('Thursday, 1 January 2009')) 
     AS DATETIME)
"
24705,"Postgres: Insert if not exists, otherwise return the row","WITH d(t, e) AS ( VALUES ('abcdefg', '2014-05-14 20:25:12.279667')),
  t AS (SELECT token FROM session, d WHERE token=t),
  i AS (INSERT INTO session (token, expiry) 
           SELECT t, e FROM d WHERE t NOT IN (SELECT token FROM t))
SELECT t,e FROM d WHERE t IN (SELECT token FROM t);
"
11158,SQL Union without duplicate values for one specific field,"SELECT COALESCE(m.id, d.id) AS id -- m comes first!
     , lastname                   -- lastname consolidated by USING
     , CASE WHEN m.id IS NOT NULL THEN TRUE ELSE FALSE END AS is_manager
FROM   developer d
FULL   OUTER JOIN manager m USING (lastname, project_id)
WHERE  project_id = 314;
"
23140,Left Join with multiple tables question,"SELECT user.name, profile.bio, rate.rate
FROM user
LEFT JOIN profile ON user.id = profile.user_id
LEFT JOIN rate ON user.id = rate.user_id
WHERE status = 'active'
"
7952,SQL Adding the same char into multiple fields,"SELECT SUBSTRING('06037-11' FROM 1 FOR (POSITION('-' IN '06037-11') -1))
    || '0-'
    || SUBSTRING('06037-11' FROM (POSITION('-' IN '06037-11') + 1))
"
3746,Repeating Running Numbers along side MySQL Results,"SELECT MOD(i,3)+1
     , result 
  FROM 
     ( SELECT @i:=@i+1 i
            , result 
         FROM results
            , ( SELECT @i:=2 ) vals 
        ORDER 
           BY result
     ) x;
"
34307,Converting current_date to relative day and static time,"between  trunc(sysdate) - 2 + 6/24  and trunc(sysdate) - 1 + 6/24 
"
27488,"SQL LIMIT, but from the end","SELECT * FROM (
SELECT *
FROM PEOPLE
ORDER BY AGE DESC
LIMIT 3 ) X
ORDER BY AGE ASC
"
30343,Duplicate Rows of Data Except 2 columns,"SELECT CheckSheet_No,
       MAX(CASE WHEN rn=1 THEN Fault END) As Fault1,
       MAX(CASE WHEN rn=2 THEN Fault END) As Fault2,
       MAX(CASE WHEN rn=3 THEN Fault END) As Fault3
FROM
   (
   SELECT CheckSheet_No,Fault,
       Row_Number() Over(Partition By CheckSheet_No Order By Fault) as rn
   FROM CheckSheet_fault 
   ) Z
GROUP BY Z.CheckSheet_No
"
32068,iterating over a temporary table and for each row update another tables row in sql,"UPDATE M 
SET M.Column1 = T.gid 
FROM #Temp1 T INNER JOIN MyTable M
ON T.id = M.id
"
31564,counting rows while displaying the data in mySQL,"select TC,COUNT(TC) as ee from results 
where results.li = ""not_applicable"" and results.cpirt = ""uu_X1""
GROUP BY TC
"
242,"SQL Access, Sum one column's values only when ALL values in another column in are in specified range","SELECT Person, Sum(GiftAmount)
FROM tblGifts 
WHERE Person NOT IN (
    SELECT Person FROM tblGifts
        WHERE GiftDate >  [Forms]![InputForm]![EndDate] 
            OR  GiftDate <  [Forms]![InputForm]![StartDate]
) 
GROUP BY Person
"
35956,help with sql query a query,"update [trade_tools].[dbo].[user]
set parent_id = businessid  
from business b, [trade_tools].[dbo].[user] u
where pcode = u.pword AND u.parent_id is null AND u.usertype_id = 5 AND u.display = 1 AND b.display = 1 
"
29578,Selecting records from a particular letter onwards,"WHER username >= 'C'
"
6468,SQL Statement with the actual week,"SELECT * FROM your_table
WHERE YEARWEEK(`date`, 1) = YEARWEEK(CURRENT_DATE, 1)
"
644,Theres a better way of do this kind of query?,"SELECT S.*, F.id AS Fid
FROM messages AS S
LEFT JOIN Friends AS F
ON s.id = F.UserId
"
14891,Complex SQL query for ShoppingCart,"SELECT 
  c.OrderID,
  SUM(c.Quantity) AS tangible_products_number,
  SUM(s.QuantityInShipment) as shipped_items_number
FROM
( 
  Inventory i,
  ShoppingCart c
)
LEFT JOIN
  ShippedItems s
ON
  c.OrderID = s.OrderID
WHERE
  i.ProductID = c.ItemID AND
  i.IsDOwnloadable = 0 AND
  c.OrderID = t.OrderID AND
  s.CartID = c.ID
GROUP BY
  c.OrderID
HAVING
  SUM(c.Quantity) > SUM(s.QuantityInShipment)
"
14945,Combine multiple rows into one row and into table MySQL,"select u1.email as emailPayer, u2.email as emailPayee, amount
from users u1 join scores s1 on u1.id = s1.idUser
join payment on s1.id = payment.idScorePayer
join scores s2 on payment.idScorePayee = s2.idUser
join users u2 on u2.id = s2.idUser
"
14860,SQL match on letter and number arrangement without using regular expressions,"SELECT myCol 
FROM myTable 
WHERE SUBSTRING(myCol, 1 , 1) >= 'A' 
AND SUBSTRING(myCol, 1 , 1) <= 'Z' 
AND SUBSTRING(myCol, 2 , 1) >= 'A' 
AND SUBSTRING(myCol, 2 , 1) <= 'Z' 
AND SUBSTRING(myCol, 3 , 1) >= '0' 
AND SUBSTRING(myCol, 3 , 1) <= '9'
"
13222,Implementing a Blacklist of keywords in SQL,"SELECT keyword FROM words JOIN blacklist 
               WHERE keyword LIKE CONCAT(CONCAT('%', word), '%')
"
26360,how to combine two numeric fields?,"SELECT name, CAST(ADRESS1 AS VARCHAR(20)) + CAST(ADRESS2 AS VARCHAR(20)) AS columnz from table1
"
25475,Use blob variables in mysql,"SET @category = '37,44,46';
SET @sql = CONCAT('SELECT * FROM products WHERE category_id IN (',@category,')');
PREPARE stmt FROM @sql;
EXECUTE stmt;
DROP PREPARE stmt; 
"
38627,"Pivot table to make all values appear in same row, multiple columns","SELECT
    Unit,
    SUM(CASE Month WHEN 'Jan' THEN CAST(Num AS DECIMAL(10, 2))/Denom ELSE 0 END),
    SUM(CASE Month WHEN 'Feb' THEN CAST(Num AS DECIMAL(10, 2))/Denom ELSE 0 END),
    ...
FROM
    Unit U
INNER JOIN UnitTest UT ON
    U.Id = UT.UnitId
GROUP BY
    Unit
"
11621,SQL - find all instances where two columns are the same,"  SELECT a.*
  FROM table_name a
  JOIN (SELECT user, post_id
        FROM table_name
        GROUP BY user, post_id
        HAVING COUNT(id) > 1
        ) b
  ON a.user = b.user
  AND a.post_id = b.post_id
"
17152,Many-to-many relationship between tables - how to model in SQL,"Unit     UnitUpgrade     
Id   --- UnitId          Upgrade
Name     UpgradeId   --- Id
                         Name
                         Description
"
5460,With IN Clause when Passing Collection as Parameter In Sql Server,"select 
    ItemSizeNm 
from 
    MstItemSize 
where SizeTypeNm ='Ring' 
and ItemSizeNm  in (select ringSize from @tblRingSize)
"
15810,How to get the sum of from this table?,"select sum(result) as sumresult from 
    (select Qty * Price as result from res_transactions where order_no='16104' and tranid='506060'
     union all
     select Qty * Price as result from TRANS_ADD  where FTRN='506060'
     )t
"
36683,using mysql what will be the fastest way to join tables,"SELECT u.*, us.someSettings
FROM User u INNER JOIN
     UserSettings us
     ON us.user_id = u.id
WHERE us.somesettings = somevalue 
AND u.someProperty = someOtherValue
AND u.someProperty1 = someOtherValue1
AND u.someProperty2 = someOtherValue2
AND u.someProperty3 = someOtherValue3
AND u.someProperty4 = someOtherValue4
AND us.someUSProperty  = someUSvalue;
"
31967,How to execute MySQL queries in node.js views?,"var mysql = require('mysql');
var db = null;
module.exports = function () {
    if(!db) {
        db = mysql.createClient({
            host:       HOST,
            port:       PORT,
            user:       MYSQL_USER,
            password:   MYSQL_PASS
        });
    };
    return db;
};
"
29505,Insert VALUES from query multi row,"INSERT INTO RESULT (""USERID"", ""POIN"", ""DATE"", ""DESC"")
SELECT ""USERID"", SUM(""POIN""), '2015-09-01', 'FREE'
FROM RESULT GROUP BY ""USERID"";
"
14195,"SQL SUM, COUNT for only unique id","SELECT COUNT(o.id) no_of_orders, 
       SUM(o.total) total, 
       SUM(o.shipping) shipping 
  FROM orders o JOIN 
(
    SELECT DISTINCT order_id
      FROM designer_orders
     WHERE state IN('pending', 'dispatched', 'completed')
) d 
    ON o.id = d.order_id
"
20041,Get all the rows which are not have leading zero,"select * from tablename
where substring(column1 from 1 for 1) <> '0'
"
34084,SQL: Select the same column twice in one query?,"SELECT i.ItemName, i.CreateDate,
       (uc.LastName + ', ' + uc.FirstName) as [Created By Name], 
       i.CreatedBy, i.LastChanged,
       (ucb.LastName + ', ' + ucb.FirstName) as [Last Changed By Name],
       i.LastChangedBy
FROM Items i LEFT JOIN
     Users uc
     ON i.CreatedBy = uc.UserID LEFT JOIN
     Users ucb
     ON i.LastChangedBy = ucb.UserId
WHERE i.LastChangedBy = 0001;
"
29752,"How to do ""Insert into Non-key Column on Duplicate Update"" in Mysql?","insert into Tb1 (c1,c2) select 1, if(max(c2) is null,1, max(c2)+1) from Tb1 where c1=1
"
35998,How to ignore certain similar rows when select,"select  *
from    (
        select  row_number() over (partition by id order by col1, col2, col3) rn
        from    YourTable
        ) as SubQueryAlias
where   rn = 1
"
14265,Multiple conditions on SQL JOIN,"SELECT p.id
FROM products p 
JOIN features f ON p.id = f.pid
GROUP BY p.id
HAVING SUM(CASE WHEN f.feature = 1 THEN 1 ELSE 0 END) > 0 AND
       SUM(CASE WHEN f.feature = 2 THEN 1 ELSE 0 END) > 0
"
35671,Select and summarize data from three tables,"    SELECT 
orders.id, orders.date, 
SUM(order_details.qty * order_details.cost) AS amount, 
SUM(order_details.qty) AS qty
FROM  orders  
LEFT JOIN order_details ON  order_details.order_id=orders.id 
AND orders.customer_id = 1 
GROUP BY orders.date
HAVING amount is not null AND qty is not null
"
1286,How to return count from table as 0 if row does not exist?,"SELECT   fruit.name, COUNT(baskets.fruit)
FROM     fruit LEFT JOIN baskets ON baskets.fruit = fruit.id
WHERE    baskets.basket = 'x'
GROUP BY fruit.id
"
22040,MySQL join on record that might not exist,"SELECT <columns> FROM table1 
INNER JOIN table2 ON table1.id = table2.table1_id
LEFT JOIN table3 ON table1.id = table3.table1_id
WHERE COALESCE(table3.column1, '') != 'foo' AND <other_conditions>
LIMIT 1
"
4284,Need help numbering rows,"SELECT dense_rank() OVER (ORDER BY Col1) AS OrderBy, Col1 FROM DeleteMe
ORDER BY Col1
"
35872,Add time stamp to date in SQLserver," SELECT cast (DATEADD(HH,6,DATEADD(wk, DATEDIFF(wk, 6, GETDATE()), 0)) as datetime)
"
25526,JOIN; only one record please!,"SELECT bl.`blog_id`, count(DISTINCT CONCANT(bc.`blog_id`,bc.`author`,bc.`timestamp`) AS 'comment_count',...
"
20370,How to get records randomly from the oracle database?,"SELECT *
FROM   (
    SELECT *
    FROM   table
    ORDER BY DBMS_RANDOM.RANDOM)
WHERE  rownum < 21;
"
39433,Regular Expression - SPECIFICWORD_ANYWORD_ANYWORD_SPECIFICLETTER,"^APEX_[A-Z0-9]+_[A-Z0-9]+_[DPE]$
"
26422,Different ORDER BY based on criteria matched?,"SELECT firstName, lastName, zip
From Users
WHERE (FirstName LIKE 'search' OR LastName LIKE 'search' OR Zip LIKE 'search')
ORDER BY 
    CASE WHEN FirstName LIKE 'search' THEN FirstName ELSE NULL END
,   CASE WHEN LastName LIKE 'search' THEN LastName ELSE NULL END
,   CASE WHEN Zip LIKE 'search' THEN Zip ELSE NULL END
"
21442,How to bind a form to database when the user has only INSERT privileges,"create or replace function GetTable(the_table in varchar2) return sys_refcursor is
res sys_refcursor;
begin
open res for 'select * from '||the_table;
return res;
end;
"
29571,SQL String Troubles with Multiple Functions,"SELECT
  YEAR(RebateMailedDate) AS MailedDate,
  SUM(RebateValue) as MoneyReceived
FROM
  RebateInfoStorage
WHERE
  RebateReceived = 'Received'
GROUP BY
  YEAR(RebateMailedDate);
"
22094,SQL Query to count by time for particular column,"SELECT [Radio],
    SUM(CASE WHEN [Time] < 12 THEN 1 ELSE 0 END) AS Window1,
    SUM(CASE WHEN [Time] >= 12 AND [TIME] < 15 THEN 1 ELSE 0 END) AS Window2,
    SUM(CASE WHEN [Time] >= 16 THEN 1 ELSE 0 END) AS Window3
FROM [Table]
GROUP BY [Radio]
"
39264,SQL Join and union All,"SELECT      
A.CustomerID,
A.Firstname,
A.Lastname,
A.Address,
A.EmailAddress,
B.CustomerID,
B.Date,
B.memberID,
C.CustomerID,
C.LengthofStay

FROM TABLE1 as A
LEFT JOIN Table2 as B on ( A.CustomerID = B.CustomerID)
LEFT JOIN TABLE3 as C on ( A.CustomerId = C.CustomerID)
"
12856,MySQL - math queries,"select sum((qty-mean)*square(qty-mean)
       /(N*sigma*square(sigma))) as skew,
       sum(square(square(qty-mean))
       /(N*square(square(sigma))))-3 as ExcessKurtosis
from pubs..sales,
(
  select
    avg(qty) as mean,
    stdev(qty) as sigma,
    count(qty) as N
  from pubs..sales
) S
"
22247,What is the correct way to structure a high volume log record,"CREATE TABLE [dbo].[EventLog]
(
  [EventLogId] INT IDENTITY(1,1),
  [ProcessId] INT NOT NULL,
  [ApplicationId] INT NOT NULL,
  [Created] DateTime NOT NULL,
  CONSTRAINT [PK_EventLog] PRIMARY KEY CLUSTERED ([EventLogId])
)
"
24301,SQL: how to select single record for multiple id's on the basis of max datetime?,"SELECT        a.Id, a.WindSpeed, a.DateTime
FROM          YourTable AS a
INNER JOIN     
(
    SELECT    ID, Max(DateTime) AS DateTime
    FROM      YourTable
    GROUP BY  ID
) AS b
ON            a.ID = b.ID
AND           a.DateTime = b.DateTime
"
24988,Setting A Date to End the Use of a Section of a SQL Script,"IF GETDATE() < '20110101'
BEGIN
--Deletez
END
"
13389,How can i assign value when creating a column of a mysql table?,"alter table tablename add column mark tinyint default 1 NOT NULL;
"
27067,PostgreSQL: Combine Select and Insert with returning ID,"insert into temp123(description) values('TESTING') returning 23,*;
"
26983,MySQL gett rows from last week with their day name,"SELECT DAYNAME(DATE_SUB(CURDATE(), INTERVAL Days.n DAY)) AS `day`,
       COUNT(r.list_date) AS `total`
FROM (SELECT 1 as n UNION ALL SELECT 2 as n UNION ALL 
      SELECT 3 as n UNION ALL SELECT 4 as n UNION ALL
      SELECT 5 as n UNION ALL SELECT 6 as n UNION ALL
      SELECT 7 as n
     ) Days LEFT JOIN
     returns r
     ON r.list_date = DATE_SUB(CURDATE(), INTERVAL Days.n DAY))
GROUP BY Days.n
ORDER BY Days.n;
"
28572,query left join or data insert?,"select w.week,t.teamid,t.teamname,t.eliminated,t.team,t.NFLname 
from nfl-schedule w
left join ( 
select a.teamid, a.teamname, a.eliminated, b.team, b.week, c.NFLname
from `tbl_1` a
left join `tbl_2` b on a.teamid = b.teamid
left join `tbl_3` c on c.`team` = b.team
where a.userid =  XXX
) t on w.week = t.week
"
8037,T-SQL Query to identify varchar fields that consist of a single repeating char/digit?,"where phone = replicate(left(phone,1), len(phone))
    and phone is not null
"
20101,PHP PDO insert multiple (10000+) same rows using bindParam. Good practice?,"$cloneCount = (int) $cloneCount;

... 9 other bindParam
$insertG->bindParam(':v1', $v1, PDO::PARAM_STR);
$insertG->bindParam(':v2', $v2, PDO::PARAM_INT);

for ($i=0; $i < $cloneCount; $i++) 
{
  $v1 = /* something */
  $v2 = /* something */
  $insertG->execute();
}
"
38744,Can't drop procedure if object_id is not null,"IF OBJECT_ID(N'dbo.CreateBlogUser', N'P') IS NOT NULL
  DROP PROCEDURE CreateBlogUser;
PRINT 'IS NOT NULL'
GO
"
13128,"Can this query be rewritten without UNION, and is it scaleable?","select product.name, user.first_name
from
(
select 
group_product.product_id
from  
group_product
inner join group on group.group_id = group_product.group_id
inner join group_member on group_member.group_id = group.group_id
where group_member.user_id = 1
union
select product_id product.name,
from user_product
where user_product.user_id = 1
) as d
inner join product on product.product_id = d.product_id
inner join user on user.user_id = 1
"
16529,What is an efficient SQL query to join to a double maximum in a sub query?,"With Data As
    (
    Select WidgetId, TransitionTypeId
        , Row_Number() Over ( Partition By WidgetId 
                                Order By Cost Desc, WidgetId Desc ) As Rnk
    From WidgetTransition
    )
Select ...
From Widget As W
    Join Data As D
        On D.WidgetId = W.WidgetId
Where D.Rnk = 1
"
24981,Query many-to-many relationship tables,"SELECT
  t.*, n.*
FROM
  tag t
  LEFT JOIN new_has_tag nt ON t.id_tag = nt.id_tag
  LEFT JOIN `new` n ON nt.new_id = n.id_new
WHERE
  t.name_tag = 'football'
"
2741,"SQL, select sum of values by group","select id, sum(stock) as stock, avg(rate) as rate
from product
group by rollup(id);
"
30971,Updating table in SQL Server,"UPDATE EXPENESE
SET SDOC=ISNULL(SDOC,0)+200
WHERE DATE='2016-03-26'
"
14659,Finding unlinked data in a many to many relationship,"SELECT p.PersonKey, pf.Description as 'MissingFieldDescription' 
 FROM Person p, PersonField pf
  WHERE pf.PersonFieldKey NOT IN 
  (select PersonFieldKey FROM PersonFieldValue WHERE PersonKey = p.PersonKey)
  AND (pf.IsRequired = 1 or pf.IsLateRequirement = 1)
"
25909,How can I create a folder via Oracle form builder?,"HOST('md c:\somefolder\newfolder');
"
38798,SQL 3 table join,"SELECT
  orders.order_id
FROM 
  orders
INNER JOIN
  orders_items
    ON orders.order_id = orders_items.order_id
INNER JOIN
  items
    ON orders_items.item_id = items.id
WHERE
  items.vendor = '3'
GROUP BY
  orders.order_id
"
24896,How to count the number of active days in a dataset with SQL Server 2008,"select sum(amount) / count(distinct date) as your_average
from your_table
"
13134,"Display salary, Avg(salary), Name for those who earns more than company Avg(salary)","select last_name, salary, avg_salary
from employees
join (select avg(salary) avg_salary from employees) x
  on salary > avg_salary
"
11012,SQL count number of results for a specific record,"SELECT
   t1.ID
,  t1.NAme
,  t2.Account AS Expr1
,  (SELECT count(*) FROM Table1 tt WHERE tt.ID=t2.ID) AS NumOfByAcc 
FROM  Table2 t2
INNER JOIN Table1 t1 ON t2.ID= t1.ID
"
15453,Get the latest row inserted with the help of CreatedDate field,"SELECT top 1 *
FROM   TestTable
order by CreatedDate desc
"
19872,Sql Server Joining Result sets from stored procedures,"CREATE PROC someproc @parameter AS

CREATE TABLE #scratch1 (columns)...
CREATE TABLE #scratch2 (columns)...

IF @parameter = 1
BEGIN 
INSERT INTO #scratch1 
exec oldproc @parameter
END

IF @parameter = 2
BEGIN 
INSERT INTO #scratch1 
exec oldproc @parameter
END


SELECT *
FROM view v
LEFT JOIN #scratch1 s1 ON v.ID =s1.ID
...etc
"
2843,SQL: Best way to write a condition that checks the value of a variable when the variable could be null,"SELECT * FROM table WHERE column IS NOT DISTINCT FROM var
"
63,sql practice query issue,"SELECT winner
FROM nobel
GROUP BY winner
HAVING COUNT(DISTINCT subject) > 1
"
39690,Combining results of SQL queries in adjacent columns,"select Max(iif(Column2 = 1 AND Column3 = 1 AND Column4 =1, column5, 0)) as column1,
       Max(iif(Column2 = 1 AND Column3 = 1 AND Column4 =2, column5, 0)) as column2,
       ...
       Max(iif(Column2 = 7 AND Column3 = 3 AND Column4 =4, column5, 0)) as column42
  from table
"
13757,Oracle Query to retrieve records when one of the conditions is true but not when both are true,"select stud_id from your_view
where subject in ('ENGLISH', 'SCIENCE')
group by stud_id
having count(subject) = 1
"
14125,Accessing DB Without Domain Classes With Grails,"class SomeService {
    def dataSource;

    def nativeAccessMethod = {
        def sql = new Sql(dataSource);
        def rows = sql.rows(""select * from myTable"");
        /* processing continues ...*/
    }
}
"
9408,Copy column of table to another table SQL,"INSERT INTO 
Table2(figures)
SELECT numbers from Table1
"
36637,Oracle SQL order by in subquery problems!,"select
    ps.id, ps.created_date, pst.last_updated, pst.from_state, pst.to_state,
    (   select min(last_updated)
        from mwcrm.process_state_transition subpst
        where subpst.last_updated > pst.last_updated
          and subpst.process_state = ps.id) as next_response
from <the rest>
"
38950,SQL User Defined Function question,"SELECT UserName 
FROM BillingTransactions
GROUP BY UserName
HAVING 0 = SUM(
  CASE RecordType 
  WHEN 1 THEN AMOUNT 
  WHEN 0 THEN -AMOUNT 
  ELSE 0
  END);
"
13451,Creating a date range using today's date,"SELECT * FROM Your_Table
WHERE app_receipt_date > SYSDATE - (6 * 7);
"
2362,Add a . every 3rd digit/pad with 0 in SELECT,"SELECT switch(
    len(SomeTable.SomeCol) < 3,
        format(SomeTable.SomeCol, '000'),
    len(SomeTable.SomeCol) = 6,
        format(SomeTable.SomeCol, '000\.000'),
    len(SomeTable.SomeCol) = 9,
        format(SomeTable.SomeCol, '000\.000\.000'),
    true,
        SomeTable.SomeCol
) as SomeCol
FROM SomeTable;
"
8620,Oracle Query TermDates Unique results,"select * from
(select t.*, rank() over (partition by RecordID order by TermDate desc) rn
 from MyTable T)
where TermDate is NULL or rn = 1
"
2041,How can I use where with two condition,"WHERE CategoryID <> 1 OR
      (CategoryID = 1 AND Name IS NOT NULL)
"
31418,Parent child with different status,"SELECT t1.id, t1,parent_id
FROM t1
LEFT JOIN t1 t11 ON t1.id = t11.parent_id
WHERE t1.status = 'off' OR t11.status='off'
ORDER BY t1.parent_id, t1.id
"
1378,Excel Postgresql Database Connection Use Cell as Date,"SELECT usda_cattle_auctions.weight_average, usda_cattle_auctions.average_price
FROM public.usda_cattle_auctions usda_cattle_auctions
WHERE (usda_cattle_auctions.report_date>= ? And usda_cattle_auctions.report_date<={d '2014-10-25'}) AND (usda_cattle_auctions.state='CO') AND (usda_cattle_auctions.gender='Steers') AND (usda_cattle_auctions.class_type='Feeder')
ORDER BY usda_cattle_auctions.report_date DESC
"
4723,Split on colons in SQL Server,";with yourtable as
(
select 'College: Queenstown College' as col UNION ALL
select 'University: University of Queensland'
)
select 
     left(col,charindex(': ',col)-1) AS InstitutionType,
     substring(col, charindex(': ',col)+2, len(col)) AS InstitutionName
from yourtable
"
21774,Printing out list of attribute descriptions based on boolean columns in SQL,"SELECT
    SUBSTRING (
       CASE WHEN IsProductionWorker = 1 THEN ', Production Worker' ELSE '' END +
       CASE WHEN IsMaterialHandler= 1 THEN ', Material Handler' ELSE '' END +
       CASE WHEN IsShopSupervisor= 1 THEN ', Shop Supervisor' ELSE '' END +
       ... ,
       3, 8000)
FROM
    MyTable
WHERE
     ...
"
33881,SQL statement to find a key that doesn't contain a row with a value,"SELECT [Employee #] as Employee, count(*) AS cnt
FROM sourcetable
WHERE skill IN ('Speaking', 'Project Management')
GROUP BY [Employee #]
HAVING cnt > 1
"
19654,How to find MIN and MAX of two columns from TWO different tables?,"select T1.AGENT, T1.FIRSTCALL, T1.LASTCALL, T2.LOGIN, T2.LOGOUT
from Table1 T1
    inner join Table2 T2 on
        T2.AGENT = T1.AGENT and
        to_char(T1.FIRSTCALL, 'YYYYMMDD') = to_char(T2.LOGIN, 'YYYYMMDD')
"
3742,query to read child table rows for each parent table id,"select a.aid,
  a.aname,
  a.acode,
  b.bname,
  b.bcode
from tableA a
inner join tableB b
  on a.aid = b.aid
"
27870,Scope of Oracle transactions when used from ADO.NET and involving triggers?,"SQL> create trigger this_wont_work
  2  after insert on emp
  3  begin
  4    commit;
  5  end;
  6  /

Trigger created.

SQL> insert into emp (empno) values (123)
  2  /
insert into emp (empno) values (123)
            *
ERROR at line 1:
ORA-04092: cannot COMMIT in a trigger
ORA-06512: at ""TONY.THIS_WONT_WORK"", line 2
ORA-04088: error during execution of trigger 'TONY.THIS_WONT_WORK'
"
28211,Execute mathematical expression and set the value to variable in SQL,"DECLARE @val1 VARCHAR(20)= '500';
DECLARE @val2 VARCHAR(20)= '300';
DECLARE @Oper VARCHAR(20)= '>';

DECLARE @query NVARCHAR(MAX);

DECLARE @Flag INT= 0;

SET @query = 'if ' + @val1 + @Oper + @val2 + ' set @Flag=1';

DECLARE @ParamDefs NVARCHAR(MAX) = N'@Flag int output'

EXEC sp_executesql @query, @ParamDefs, @Flag OUTPUT

PRINT @Flag;
"
21034,Transaction/Database Locking Scheme,"em.lock(employee, LockModeType.PESSIMISTIC_WRITE);
"
13098,SQL: How to implement generic categories?,";with cte as (
    select group_id
    from GROUP_TABLE
    where group_id = 1
    union all
    select child_group_id
    from GROUP_RELATIONS_TABLE
    inner join cte on cte.group_id = GROUP_RELATIONS_TABLE.parent_group_id
)
select t.*
from cte
inner join TEST_IN_GROUP_TABLE tg on tg.group_id = cte.group_id
inner join TEST_TABLE t on t.test_id = tg.test_id
"
31409,Oracle job scheduler create program to create/drop materialized view,"CREATE OR REPLACE PROCEDURE refresh_mv(p_mv_name VARCHAR2) AS
BEGIN
   EXECUTE IMMEDIATE '
      CREATE MATERIALIZED VIEW ' || dbms_assert.simple_sql_name(p_mv_name) || '
      PARALLEL
      NOLOGGING
      NEVER REFRESH
      AS
      SELECT * FROM <biq_query>';
   EXECUTE IMMEDIATE 
      'CREATE OR REPLACE VIEW outside_view AS SELECT * FROM '||p_mv_name;
   -- DROP old mv?
END;
"
7294,SQL insert value in friendship table based on,"INSERT INTO friend
(ID1, ID2)
SELECT DISTINCT f1.ID1, f2.ID2
FROM friend f1
  INNER JOIN f2
    ON f1.ID2 = f2.ID1
      AND f1.ID1 <> f2.ID1
      AND f1.ID2 <> f2.ID2
WHERE f1.ID1 <> f2.ID2
"
23116,create columns from values in sql query,"SELECT
    employee_id,
    punch_in_time   = MIN(CASE WHEN activity = 'Punch In' THEN [date-time] END),
    punch_out_time  = MAX(CASE WHEN activity = 'Punch Out' THEN [date-time] END)
FROM tbl
GROUP BY employee_id, CAST([date-time] AS DATE)
ORDER BY employee_id, punch_in_time
"
19316,What order to join multiple (over 3) tables and where to put conditions?,"SELECT Block.name, Container.name, adminrole.name from 
Block
    LEFT JOIN container_block ON container_block.containerid = Block.id
    LEFT JOIN Container ON Container.id = container_block.containerid
    LEFT JOIN AdminACL ON AdminACL.objectid = Container.id
    RIGHT JOIN adminrole_admin ON adminrole_admin.adminid #there could be multiple roles
    LEFT JOIN adminrole ON adminrole.id = adminrole_admin.adminroleID
WHERE 
    AdminACL.ObjectType = ""Container""
    AND adminrole.name  not like 'hidden_%'; 
# shouldn't you have a `hidden` column on the table, instead of prefixing the name?
"
960,Create a scheduled job using MSSQL Agent,"Update TableName Set ExpectedProgress = datediff(dd,startDate,todaydate)*(100/daediff(dd,StartDate,duedate))
Update TableName set status=(case when progress>= ExpectedProgress then 'true' else 'false' end.
"
15679,Sql query to find difference between date,"SELECT DATEDIFF(SELECT DATE_ADD(start_date,INTERVAL 1 DAY),end_date);
"
1052,SQL query to transpose data in below case,"SELECT
  Heading, 
  A Package_A,
  B Package_B,
  C Package_C,
  D Package_D
FROM (
      SELECT * FROM YourTable
) up 
PIVOT (sum(Limit) FOR Package IN (A, B, C, D)) AS pvt
"
15049,How do I get the return value from a function in Oracle using Toad,"begin
    dbms_output.put_line(packagename.functionname(paraname));
end;
"
20281,Entity Framework Query for Complex Sql,"from p in Profiles
join spa in SeucrityProfileAssignments
    on p.ProfileId equals spa.ProfileId
join spu in SecurityProfileUsers
    on spa.SecurityProfileId equals spu.SecurityProfileId
where spu.UserId = userId
select new //optional object type
{
    //values to select
}
"
19988,Oracle: allow some JOBS to be controlled by every schema," grant alter bjob1 to A;
 grant alter bjob2 to A;
"
22335,how to fetch max rating MovieId voted by max number of users,"select movieId, rating, count(distinct userId) as NumUsers
from rating
group by movieId, rating
order by rating desc, NumUsers desc
limit 1;
"
5560,returning select query with row count,"select  row_number() over (order by FLD_A,FLD_B) as POS,
        FLD_A,
        FLD_B 
    from My_Tbl 
    where FLD_C='p'
"
12499,help me generate sample data using sql script,"INSERT INTO table (COL1, COL2, COL3) VALUES
(SELECT COL1 from sample order by RAND() LIMIT 1),
(SELECT COL2 from sample order by RAND() LIMIT 1),
(SELECT COL3 from sample order by RAND() LIMIT 1)
"
28385,Delete Every Alternate Row in SQL,"delete T
from (
       select row_number() over(order by [Timestamp]) as rn
       from YourTable
       where SomeColumn = @SomeValue
     ) T
where T.rn % 2 = 0
"
31592,Is is possible to simplify this SQL UNION query?,"SELECT DISTINCT table2.id
FROM table1
INNER JOIN table2
ON ( table1.t_id = table2.id OR table1.t2_id = table2.id )
WHERE table1.id = 1
;
"
22819,Relationship with two table,"CREATE TABLE `member_images` (
  `image_id` BIGINT(20) UNSIGNED NOT NULL auto_increment,
  `member_id` BIGINT(20) UNSIGNED NOT NULL DEFAULT 0,
  `image_path` VARCHAR(255) NOT NULL DEFAULT '',
  PRIMARY KEY(`image_id`),
  KEY (`member_id`)
);
"
20279,Counting Distinct Managers Per Country,"select distinct t1.manager
from user_data t1
left join (
    select country
    from user_data 
    group by country
    having count(distinct manager) = 1) t2 on t1.country = t2.country
where t2.country is not null
"
13368,SQL to get user's first picture and most common item,"select
    u.id_user,
    u.name,
    (select p.filename from user_picture as p where p.id_user=u.id_user and ord=1) as userpicture,
    (select max(s.id_sticker) from user_sticker as s where s.id_user_to=u.id_user) as userstickerid
from user as u
where u.id_user = $$$$
"
59,"Insert results of query 2 into query 1, but query 2 has no key","Select tt.TransactionDate, tt.LoanNumber,
       max(tt.TransactionDate) over () as DataDate
From TransactionsTable tt;
"
31177,T-SQL recursive query - how to do it?,";with cte as 
(
    select * from yourtable where id=1
    union all
    select t.* from cte 
        inner join yourtable t on cte.id = t.parentid
)
    update yourtable
    set userid = 101
    where id in (select id from cte)    
"
1091,How to properly group SQL results set?,"SELECT c.x, c.y, GROUP_CONCAT(s.signal) AS signal_list
FROM Signals s
JOIN Coordinates ON s.coordinate_id = c.id
GROUP BY s.coordinate_id, s.group
"
279,select distinct and join?,"Select y.text from y inner join 
  (Select x.id from x
   group by x.id) x
on x.id = y.id
"
21576,Regular Expressions Query,"^[A-Za-z]?(\d+)$
"
26547,Getting all records based on parent's parent,"SELECT *
FROM CUSTOMERS
WHERE STORE(ID) IN
    (SELECT STOREID
     FROM STORES
     WHERE AREA = DOWNTOWN)
"
16887,Simplify nested case when statement,"SELECT CASE 
WHEN edition = 'STAN' THEN 
     CASE 
          WHEN has9 = 1 THEN '9'
          WHEN has8 = 1 THEN '8'
          WHEN has7 = 1 THEN '7'
          WHEN hasOLD = 1 THEN 'OLD'
     END
WHEN edition = 'SUI' THEN
     CASE 
          WHEN has9 = 1 THEN 'S9'
          WHEN has8 = 1 THEN 'S8'
     END
ELSE 'S7' END AS version
"
8455,"SQL CASE [Column] WHEN IN ('case1', 'case2') THEN 'oops' END?","SELECT CASE WHEN [Option] IN (1, 3, 99) THEN 'Wrong option' ELSE 'You go' END
"
15682,insert made instead of update resulting in duplicate rows. how to fix?," where iv.ano=2013 and iv.municipio_fk IS NOT DISTINCT FROM carga.municipio_fk 
      and iv.indicador_fk IS NOT DISTINCT FROM carga.indicador_fk
      etc...
"
39111,TSQL XML Parsing / Insert,"INSERT INTO dbo.SampleTable_Audit 
(LastInsertedID, .....)    
SELECT ID, ....
FROM INSERTED;
"
14508,SQL SubQuery merge,"SELECT count(A),B,C,D,E,DATEDIFF(NOW(),E) AS Days
FROM table
GROUP BY B,C,D,E;
"
562,SQL-query to find articles with at least one of the listed tags,"select articles.article_id, count(tags.tag_id) as num_tags, group_concat(distinct tag_name separator ',') as tags
from articles, article_tag, tags
where articles.tag_id = article_tag.tag_id
  and article_tag.tag_id = tags.tag_id
  and tags.tag_name in ( 'jazz', 'funk', 'soul', 'Britney Spears' )
group by articles.article_id
order by count(tags.tag_id) desc
"
2372,Without using conjunctions in conditions of selection operators,"SELECT name FROM ITEM i WHERE
    EXISTS ITEM u
        AND u.name != i.name
        AND u.price=i.price
        AND u.id = i.id
"
24433,Get part of string in mysql,"SELECT SUBSTRING(field, INSTR(field, 'PR') + 2, 100)
FROM dual
"
29236,Join two data tables from different source databases in .NET?,"  var combinedRows = 
         from t in dt_t.AsEnumerable()
         join sap in dt_sap.AsEnumerable() on t.Field<System.Int32>(""line_no"").ToString() equals sap.Field<System.String>(""PO_Item"")                           
         orderby t[""line_no""]
         select new { t, sap };
"
34438,Determine returned columns from stored procedure data type SQL," ResultSet rs = ...
 ResultSetMetaData rsmd = rs.getMetaData();
 int numberOfColumns = rsmd.getColumnCount();
 String columnLabel = rsmd.getColumnLabel(1);
 String columnName = rsmd.getColumnName(1);
 int columnType = rsmd.getColumnType(1);
 String columnTypeName = getColumnTypeName(1);

 etc
"
19626,Oracle identify if a delete will cascade,"SELECT constraint_name, delete_rule
  FROM dba_constraints
 WHERE r_constraint_name = <<name of the primary key constraint>>
   AND r_owner = <<owner of the primary key constraint>>
   AND delete_rule = 'CASCADE'
"
2814,[SOLVED]Get record with a field egal to a specific value else with null,"SELECT TOP 1 COL1, COL2, COL3
FROM TABLE1
WHERE (COL2 = MY_SPECIFIC_VALUE or COL2 IS NULL) AND
      COL3 = '42' AND COL1 = 3
ORDER BY (CASE WHEN COL2 = MY_SPECIFIC_VALUE THEN 1 ELSE 2 END);
"
22181,How to use a subquery inside another subquery with three tables in mysql?,"   SELECT 
        u.uid, u.fname, u.date_joined , 
        (SELECT COUNT(*) FROM questions WHERE questions.uid = u.uid) AS question_count,
        (SELECT COUNT(*) FROM followers WHERE followers.qid IN ( 
            SELECT qid FROM questions WHERE questions.uid = u.uid 
            ) 
        ) AS follow_count
    FROM users AS u
    ORDER BY follow_count DESC, question_count DESC, date_joined DESC
"
22305,Mysql: Latest items grouped by a string,"SELECT a, GROUP_CONCAT(id) FROM
   ( SELECT * FROM table_name ORDER BY b )
GROUP BY a
LIMIT 1
"
29641,query search url match,"select replace(replace(URL,'http://',''),'www.','')
"
24050,comparing a column with itself in WHERE clause of oracle SELECT,"  AND t1.col1 IS NOT NULL
  AND t2.col1 IS NOT NULL
"
33869,SELECT inside a CASE clause with an IN,"SELECT
   CASE WHEN t1.var IS NOT NULL THEN 'var1' ELSE 'var2' END AS myvar
FROM t1 LEFT JOIN var_table AS t2
ON t1.var = t2.var
"
29712,mySQL DATETIME select in between dates,"SELECT * FROM Events
  -- Exclude items known to be outside the range
WHERE NOT ((event_end_date < @Start) OR (event_start_date > @End))
"
12806,best way to optimise 3 queries to a single one,"SELECT info, count(*) as info_cnt 
FROM T
WHERE uid = 1 and info IN ('a', 'b','c')
GROUP BY info
"
13623,Select last 30 days with a sql query,";WITH CTE AS
(
    SELECT convert(date,GETDATE()) sDate, DATENAME(DW, GETDATE()) sDayofWeek
    UNION ALL
    SELECT DATEADD(DAY,-1,sDate), DATENAME(DW, DATEADD(DAY,-1,sDate))
    FROM CTE
    WHERE sDate > GETDATE()-29
)
SELECT * FROM CTE
"
5096,Return rows with more than one comma separated value in a string,"select * from your_table
where instr(contact_type, ',') > 0
"
22852,Can I rollback after calling oracle procedure?,"Create or Replace procedure Main

   SAVEPOINT sp_1;
   Call procedure_1();       
   Call procedure_2();

   IF X = true THEN
      ROLLBACK TO sp_1;
   END IF;

END Procedure Main;
"
36376,SQL-92 (Filemaker): How can I UPDATE a list of sequential numbers?,"
CREATE TABLE sorting (sid numeric(10,10), rn int);

INSERT INTO sorting (sid, rn)
SELECT SortID, RecordNumber FROM Beleg
WHERE Year ( Valuta ) = 2016
AND Ursprungskonto = 1210
ORDER BY SortID;

UPDATE Beleg SET SortID = (SELECT rn FROM sorting WHERE sid=Beleg.SortID)
WHERE Year ( Valuta ) = 2016
AND Ursprungskonto = 1210;

DROP TABLE sorting;
"
20860,SQL Query needed to get information from TWO separate tables,"SELECT b.AUTHORID, b.BKTITLE, a.AUTHFNAME, a.AUTHLNAME
FROM BOOK b
  INNER JOIN AUTHOR a
    ON b.AUTHORID = a.AUTHORID
AND b.AUTHORID IN
(
  SELECT AUTHORID
  FROM BOOK
  GROUP BY AUTHORID
  HAVING COUNT(AUTHORID) > 1
)
ORDER BY a.AUTHLNAME, a.AUTHFNAME
"
39424,SQL - Select only one value from multiple fields,"SELECT LTRIM(RTRIM(col1 + col2 + col3 + col4))
"
11511,"How does CONVERT (DATETIME, FLOAT) work?","Decimal value    Time Value    Calculation 
=============    ==========    ===========
0.00094444444    12:01:00 AM   1.0 / 24 / 60 (1 day/24 hours/60 minutes per hour)
0.01041666666    12:15:00 AM   1.0 / 24 / 60 * 15
0.02083333333    12:30:00 AM   1.0 / 24 / 60 * 30
0.04166666666    01:00:00 AM   1.0 / 24
"
27199,SQL - Finding minimum value among table fields and joined fields,"select id, min(thedate) as mindate
from (select id, stage1_date as thedate from a union all
      select id, stage2_date from a union all
      select a_id, date from b1 union all
      select a_id, date from b2
     ) t
group by id;
"
5330,PostgreSQL: Aggregate by more than one column,"select id, date_trunc('day', eventtime) as eventday, sum(use)
from table
group by id, eventday
order by id, eventday;
"
9869,Getting Sum of MasterTable's amount which joins to DetailTable,"SELECT SUM(Amount) 
FROM Master M 
WHERE M.ID IN (
  SELECT DISTINCT MasterID
  FROM DETAIL
  WHERE PID IN (1,2,3) )
"
22209,How to delete old data?,"DELETE FROM myTable WHERE [columndate]< DATE_SUB(NOW(), INTERVAL 1 MONTH);
"
798,How to change update execution plan in Oracle?,"merge /*+ leading(sm) full(lg) use_hash(lg) parallel(lg 2) */
  into foo_small sm
using foo_large lg
  on (lg.id = sm.id)
when matched then
  update set sm.col_y = lg.col_x
"
13290,Improving performance of updating large table with join,"KEY `m_m1` (`m1`)
"
28749,SQL Server select duplicated rows,"select NationalIDNumber 
from Ben_VEmployee 
group by NationalIDNumber
having min(DepartmentID) <> max(DepartmentID);
"
36186,Merge row values from separate tables into one column. [SQL],"SELECT Package, SUM(Licences) as TotalLicences
  FROM (
        SELECT Package, Licences FROM Table1
         UNION ALL
        SELECT Package, Licences FROM Table2
         UNION ALL
        SELECT Package, Licences FROM Table3
       ) AS AllLicences
 GROUP BY Package
"
32171,MySQL: Update a value if an another value for this line is equals to a value from a 'list' of 10 000 values,"CREATE INDEX idx ON compagnie (emails); 
LOCK TABLES compagnie WRITE;
UPDATE compagnie SET newsletter='NO' WHERE email IN( ... );
UNLOCK TABLES compagnie WRITE;
"
25752,SQL query - dealing with Null Value,"SELECT Name,  ISNULL(Amount,0), ISNULL(Paid,0) as Paid
FROM   Table_1  
WHERE  ISNULL(Paid,0)  <> ISNULL(Amount,0)
"
25876,Query for rows that share a set of associations,"SELECT ID
FROM C
WHERE (
  SELECT COUNT(*)
  FROM B_C
  WHERE C_ID = C.ID
) <= (
  SELECT COUNT(*)
  FROM B_C INNER JOIN A_B ON B_C.B_ID = A_B.B_ID 
  WHERE C_ID = C.ID AND A_ID = ?
);
"
5029,SQL substring from a string,"select right(FileName, len(FileName) - 
   charindex('_', FileName, 
      charindex('_', FileName, 
         charindex('_', FileName) 
      + 1) 
   + 1))
"
31549,select multiple column from one table and insert into another as rows,"INSERT INTO email (userid,email_address)
SELECT id, email  FROM user
UNION SELECT id, email2  FROM user
UNION SELECT id, email3 FROM user
"
24975,SQL Percentage Complete with COUNT and Remaining Percentage,"select FinanceID, CustomerID max(PercentageComplete) 
from Finances
group by FinanceID, CustomerID ;
"
24360,How do I select from a table and delete all other non-selected entries?,"DELETE FROM mytable WHERE mytable_key NOT IN 
  (SELECT mytable_key FROM mytable WHERE some_or_another_condition);
"
13970,How can i merge duplicate rows in SQL with an special condition,"SELECT
    ROW_NUMBER() OVER(ORDER BY (SELECT NULL)) AS Id,
    *
FROM (
    SELECT DISTINCT Word,
        STUFF((SELECT ',' + description
               FROM Your_Table
               WHERE Word = T.Word
               FOR XML PATH('')), 1, 1, '') AS description
    FROM Your_Table T) AS A
"
22035,How to run a subquery to split a table into two groups?,"SELECT product, SUM(spend),
       SUM(CASE WHEN proportion_overseas = 0 THEN spend ELSE 0 END) as not_overseas,
       SUM(CASE WHEN proportion_overseas > 0 THEN spend ELSE 0 END) as overseas
FROM spending 
WHERE to_include='Yes'
GROUP BY product;
"
18914,Calculate yearly expiry in MySQL from static date,"WHERE
  expiry_date <= CURDATE()
"
293,How to check attribute in SQL Server 2012 using regular expressions?,"CREATE TABLE dbo.PEOPLE (
name VARCHAR(25) NOT NULL
, emailaddress VARCHAR(255) NOT NULL
, CONSTRAINT PEOPLE_ck_validemailaddress CHECK ( dbo.RegExValidate( emailaddress, N'^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$' ) = 1 )
) 
"
30525,How to SELECT multiple columns with MySQL based on multiple records?,"SELECT p.id, s1.iso AS country, s2.pts AS points
FROM points p
INNER JOIN sample s1 ON p.country = s1.id
INNER JOIN sample s2 ON p.points = s2.id  
"
39519,sql joining for query,"SELECT provider_food_joints.*, 
       menu_item.* 
FROM   provider_food_joints 
       INNER JOIN menu_item 
               ON menu_item.foodjoint_id = provider_food_joints.foodjoint_id 
WHERE  provider_food_joints.foodjoint_name = '"".$foodjoint_name.""' 
"
38519,Determining whether a month contains entries,"SELECT DISTINCT
    CASE
        WHEN EXTRACT(MONTH FROM logdate) IS  NULL THEN false
        ELSE true
    END,
    y AS month
FROM
    mytable 
        RIGHT JOIN 
        (SELECT generate_series(1,12)) AS x(y) ON ((EXTRACT(MONTH FROM logdate)) = y AND EXTRACT(YEAR FROM logdate) = '2009')
ORDER BY 
    month ASC;
"
8361,mySql equivalent Sqlserver statement with COUNT,"SELECT (select COUNT(*) from MzMesDb.SysLog) as CN, 
       Id,
       DateTime
FROM   MzMesDb.SysLog
WHERE  Deleted='F' 
order by id asc 
LIMIT 0,3;
"
31392,Order By date Desc issue,"SELECT *
FROM product
WHERE var IS NOT NULL
ORDER BY CASE WHEN var = '0' THEN 2 ELSE 1 END, date DESC
"
23629,How to find the similar column names from a database table?,"SHOW COLUMNS FROM tbl_name FROM db_name
LIKE '1%'
"
7365,Is it possible to use a WITH clause in multiple updates without copying it to each one?,"SELECT a,b,c
INTO #TemporaryTable
WHERE a<>b

(do something)

DROP TABLE #TemporaryTable
"
28331,If Exist or Exists?,"IF EXISTS (SELECT *
           FROM   tblOne
           WHERE  field1 = @parm1
                  AND field2 = @parm2)
    OR EXISTS (SELECT *
               FROM   tblTwo
               WHERE  field1 = @parm5
                      AND field2 = @parm3)
  PRINT 'YES' 
"
3635,INSERT To command in SQL Server Management Studio,"INSERT INTO DbnameTarget.[dbo].[company$Customer]
SELECT
Colum1,Colum2
FROM DbnameSource.[dbo].[company$Customer]
"
27619,Can I alias multiple columns? How?,"SELECT  d.id
,       d.c1
,       d.c2
,       d1.value as a3
,       d2.value as a6
FROM    data as d
LEFT JOIN
        dictionary as d1
ON      data.id = d1.id
        and d1.key = 'k1'
LEFT JOIN
        dictionary as d2
ON      data.id = d2.id
        and d2.key = 'k2'
"
10934,How to change the value of a global variable in a PL/SQL package dynamically?,"alter directory temp_data as '/home/oracle/tmp';
"
14446,db2 sql pattern matching,"SELECT
    *
FROM
    MyTable Z
WHERE
    LEFT(myid, LOCATE('.', myid)) = myname + '.'
"
27722,Fast way to generate concatenated strings in Oracle,"SELECT LISTAGG(column, separator) WITHIN GROUP (ORDER BY field)
  FROM dataSource
 GROUP BY grouping columns
"
10334,Extending SQL query to include records beyond a given date,"select * 
from mytable
where id in (select id from mytable where 
              COMPLETIONDATE >= TO_DATE('29/06/08','DD/MM/YY')    
              COMPLETIONDATE <= TO_DATE('29/06/09','DD/MM/YY')
)
"
21914,mysql: get all rows into 1 column,"  SELECT p.id_post
         GROUP_CONCAT(DISTINCT t.name SEPARATOR ' ')
    FROM POST p
    JOIN POST_TAG pt ON pt.id_post = p.id_post
    JOIN TAG t ON t.id_tag = pt.id_post_tag
GROUP BY p.id_post
"
22602,How to retrieve data from two tables whose column names are the same,"SELECT Col1, Col2, Col3 FROM Table1
UNION ALL
SELECT Col1, Col2, Col3 FROM Table2
"
17375,Many-To-Many + WHERE field <> value,"SELECT p FROM BlogRegionBundle:Post p LEFT JOIN p.tags t WHERE t.id = :blogId AND p.state = :state AND p.deleted = 0 AND :user NOT MEMBER OF p.views
"
102,SELECT items from a databasefield divided by a comma,"WHERE  (',' + tbl1.Numberfield + ',' LIKE '%,' + @Numberfield + ',%')
"
21310,Access query for deleting repeats in next months,"DELETE  yt1
FROM    YourTable yt1
WHERE   EXISTS
        (
        SELECT  *
        FROM    YourTable yt2
        WHERE   yt1.ID = yt2.ID AND
                    mid(yt2.TheMonth, 3, 2) + mid(yt2.TheMonth, 1, 2) <
                    mid(yt1.TheMonth, 3, 2) + mid(yt1.TheMonth, 1, 2)
        )
"
20615,ACCESS SQL: TOP 1 of a subcategory (or MAX()),"SELECT ac, max(hours), max(cycles)
FROM flights
WHERE flight_date <= cdate(asked_date)
GROUP BY ac
"
13293,Select all items from column SQL,"function getData($condition){
     if($condition ==null){
           $condition = '1';
     }else{
           $condition = ""`name`={$condition}"";
     }
     sql = ""select * from table where $condition"";
}
"
12690,Comma-separated values (CSV) parameter filtering,"Declare @IDs Varchar(100)
SET @IDs = '2,4,6'

Select IsNull(STUFF((Select ', '+ CAST([Name] As Varchar(100)) From [TableName]
Where CharIndex(','+Convert(Varchar,[ID])+',', ','+@IDs+',')> 0
For XML Path('')),1,1,''),'') As [ColumnName]
"
26680,mysql - If 2 or more members picked the same team return the member which guessed closest to the score,"select * from picks where pick = '$winner' and
    abs(score-$winScore) = (select min(abs(score-$winScore)) from picks 
    where pick = '$winner');
"
11705,"How to select data from 1 database, insert into another and insert also new data","INSERT INTO db2.users (steamid, name,`group`) SELECT steamid, nickname FROM db1.ttt_stats WHERE steamid NOT IN (SELECT steamid FROM db2.users)
"
4591,"SQL: Select ""until""","SELECT d.id, d.size, d.date_created
FROM documents d
INNER JOIN documents d2 ON d2.tag_id=d.tag_id AND d2.date_created >= d.date_created
WHERE d.tag_id=26
GROUP BY d.id, d.size, d.date_created
HAVING sum(d2.size) <= 600
ORDER BY d.date_created DESC
"
19964,Remove columns in sql-file,"insert  into `films_genres_temp`
    (`id`,`film_id`,`genre_id`,`num`) 
    values 
    (1,1,1,1),
    (2,1,17,2),
    (3,2,1,1),
    ...

insert into `films_genres`
    (`film_id`,`genre_id`)
    select `film_id`,`genre_id`
        from `films_genres_temp`
"
16269,SQL Count(*) on multiple tables,"SELECT `Horse Number`, Count(*) AS `Total Winners`
FROM (
  SELECT * FROM `races`.`2009`
  UNION ALL
  SELECT * FROM `races`.`2010`
) all_races
WHERE `Win $`>0 
GROUP BY `Horse Number`
ORDER BY Count(*) DESC;
"
10548,how to update database from query,"UPDATE VZWBuildingNumber 
SET VZWBuildingNumber = CONCAT('0',SUBSTRING(VendorSiteID, 8, 7))
WHERE Vendor = 'ADO.NET'
"
37032,Select nearest but not greater-than row,"SELECT *
FROM  (
    SELECT length 
    FROM   action
    WHERE  type = Y 
    AND    start < X
    ORDER  BY start DESC
    )
WHERE rownum = 1;
"
1820,sql join distinct php,"select p.*,
       (select ph.url_little
        from "".Constants::$PHOTOS_PRODUCTS_TABLE."" ph
        where p.id = ph.id_product
        order by ph.id asc
        limit 1
       ) as url_little
from  "".Constants::$PRODUCTS_TABLE."" as p 
where p.id_client = ?;
"
4026,How can an Oracle NUMBER have a Scale larger than the Precision?,"select cast(0.0001 as number(2,5)) num, 
       to_char(cast(0.0001 as number(2,5))) cnum,
       dump(cast(0.0001 as number(2,5))) dmp
  from dual
"
35468,Getting the items belonging to specified keywords and categories,"SELECT articles.name
FROM articles
inner JOIN ckw ON ckw.article_id = articles.id
inner join ccat on ccat.article_id = articles.id
WHERE ckw.key_id IN (5, 7) 
and ccat.category_id in (12,18)
GROUP BY articles.article_id , articles.name 
HAVING COUNT(distinct ckw.key_id) = 2 
and count(distinct ccat.category_id) = 2 
"
15425,How to generate script of a stored procedure based on modified date?,"   SELECT name , create_date, modify_date ,sm.definition FROM sys.procedures sp
   Inner join sys.sql_modules sm  ON sp.object_id = sm.object_id 
   WHERE CONVERT(DATE,sp.modify_date)    = CONVERT(DATE, '02/19/2013')
"
37786,"Looks simple, but I'm stumped!","SELECT article_id
FROM article_tag_pvt pvt
INNER JOIN tag t ON t.tag_id = pvt.tag_id
WHERE t.name = 'events' OR t.name = 'news' 
GROUP BY article_id HAVING count(*) = 2
"
11498,How to compute Data,"SELECT 
[User],
[Add] = SUM(CASE [Operation] WHEN 'Add' THEN 1 ELSE 0 END),
[Modify] = SUM(CASE [Operation] WHEN 'Modify' THEN 1 ELSE 0 END),
[Update] = SUM(CASE [Operation] WHEN 'Update' THEN 1 ELSE 0 END),
[Delete] = SUM(CASE [Operation] WHEN 'Delete' THEN 1 ELSE 0 END) 
FROM [tablename]
GROUP BY [User]
ORDER BY [User] ASC
"
35247,How do I select the latest rows for all users?,"SELECT DISTINCT ON (id)
       id, timestamp, field1
FROM   tbl
ORDER  BY id, timestamp DESC;
"
37700,SQL - Subtraction of values based on IDs and group after,"select sum(case when type = 1 then value else - value end) as value
from table t
group by year;
"
25219,SQL - Creating A Conditional Where Clause For This Simple Query,"WHERE casCaseType='m'
  AND casCurrentWorkflowID=990
  AND cmsDateCreated between @FromDate and @ToDate

  AND eveworkflowID < 
      CASE @WFStatus
        WHEN 1 THEN 100
        WHEN 2 THEN 200
        WHEN 3 THEN 300
        WHEN 4 THEN 400
        ELSE 0
      END
"
11908,Efficient SQL query with subquery and multiple joins,"SELECT a.id, cgso.sf_guard_user_id as cgso, cgal.sf_guard_user_id as cgal
FROM table_a a
INNER JOIN table_c g2 ON g1.group_id = 2
INNER JOIN table_b cgso ON g2.user_id = cgso.sf_guard_user_id  AND cgso.specialty_id = a.specialty_id
INNER JOIN table_c g1 ON g1.user_id = 1
INNER JOIN table_b cgal ON g1.user_id = cgal.sf_guard_user_id AND cgal.specialty_id = a.specialty_id
"
9544,Summing up MySQL calculated field where column value is the same,"SELECT COMMUNICATIONS_ID, SUM(fieldName) 
FROM consumer_action_log
WHERE COMM_TYPE_ID = 4
GROUP BY COMMUNICATIONS_ID
"
25100,Opposite of IN operator in SQL,"WHERE lastname NOT IN ('Hansen', 'Pettersen')
"
14174,Derived Column FindString Error,"FINDSTRING(Column_A,""Sewage"",1) > 0 ? 
    SUBSTRING(Column_A, 1, FINDSTRING(Column_A,""Sewage"",1) - 1) + ""SD"" : 
    Column_A
"
18617,Custom Fields DB Design for Membership Application,"CREATE TABLE Member
( MemberID 
, Org_Type
, Name
, ...
, Role
, PRIMARY KEY (MemberID)
, UNIQUE KEY (Org_Type, MemberID)
, CHECK Org_Type IN (1, 2, 3)
) ;

CREATE TABLE Member_Type_1
( MemberID 
, Org_Type
, Location
, PRIMARY KEY (MemberID)
, FOREIGN KEY (Org_Type, MemberID)
    REFERENCES Member(Org_Type, MemberID) 
, CHECK Org_Type = 1
) ;
"
29763,Find duplicate rows with PostgreSQL,"select * from (
  SELECT id,
  ROW_NUMBER() OVER(PARTITION BY merchant_Id, url ORDER BY id asc) AS Row
  FROM Photos
) dups
where 
dups.Row > 1
"
36813,"If one value is null get previous value in that quarter, in sql select query","select 
  date_display_name, 
  active
from
(
  select
    date_display_name, 
    active,
    row_number() over 
    (
      partition by date_display_name 
      order by 
        case when active is null then 2 else 1 end,
        defaultdate desc
    ) as rn
  from mytable
) ranked
where rn = 1;
"
19050,SAP HANA alternative for cross apply,"select T.*, someFunction(T.Value)
from T cross join F
"
7807,MySQL stored procedure: variable in WHERE clause?,"DROP PROCEDURE IF EXISTS `test`;
DELIMITER //

CREATE PROCEDURE TEST (IN_TEAM_ID varchar(30))
BEGIN

    SELECT t.* 
      FROM TEAMS t
     WHERE t.team_id = IN_TEAM_ID;

END //

DELIMITER ;
"
17787,Return an INT from a Case statement,"select
  *
from table1
outer apply (
  select CASE WHEN Value > 2 THEN  1 ELSE 0 END AS Flag
) X
outer apply (
  select CASE WHEN X.Flag = 1 THEN 1 ELSE 0 END AS FollowedUpCorrectly
) Y
"
4515,MySQL select lowest timedate for each id,"select id_event, min(event_date_time) as lowest_date
from event_showtime
where event_date_time > now()
group by id_event
"
5122,SQL Server 2000 Integer truncating,"Select 30 * (220/cast (30 as float))
"
21232,Joining another table WHILST using ALTER PROC in SQL,"USE [ShopDatabase]
GO
/****** Object:  StoredProcedure [dbo].[stpGet_StockUnitDetails]    Script Date:    09/17/2013     12:03:05 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROC [dbo].[stpGet_StockUnitDetails]
@strStockUnitCode nvarchar(250)
As
SELECT 
     * -- change this to be the columns your code needs
 from VIEWSTOCKUNIT a
inner join STOCK_DESCRIPTORS b on a.strStockUnitCode = b.strStockUnitCode
 Where a.strStockUnitCode = @strStockUnitCode
"
21163,Create table query,"CREATE TABLE `comment` ( 
  `comment_id` INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY,
  `comment_text` VARCHAR(400) NOT NULL,
  `aid_id` INTEGER NOT NULL REFERENCES `aid`(`aid_id`),
  `comment_time` DATETIME NOT NULL,
  `user_id` INTEGER NOT NULL REFERENCES `user`(`user_id`)
);
"
11517,How to get the serial number of the record after executing a query?,"CREATE PROCEDURE [dbo].[getmyRankinContest] @UserID int 
AS
BEGIN
    ;WITH CTE AS
    (
        SELECT userId, RANK() OVER(ORDER BY Points DESC) Ranking
        FROM (  SELECT userid, SUM(points) Points
                FROM invitecount
                GROUP BY userid) A
    )
    SELECT *
    FROM CTE 
    WHERE UserId = @UserID
END
"
4932,Use COUNT and add the the value of two collumns together,"SELECT   person, COUNT(*) AS votes
FROM     (SELECT vote1 AS person
          FROM   mytable
          UNION ALL
          SELECT vote2 AS person
          FROM   mytable) t
GROUP BY person
"
9079,SQL SERVER Join 2 tables with COUNT(*),"SELECT news.id_news, COUNT(*)
FROM news INNER JOIN
     comment
     ON comment.id_news = news.id_news
GROUP BY news.id_news;
"
29596,Select only integers from char column using SQL Server,"SELECT * FROM POWDER WHERE IsNumeric(Name) = 1
"
5995,delete rows based in the value of the previous row in the same table,"DELETE FROM mytable WHERE line IN (
  SELECT CASE WHEN content = LAG(content) OVER (ORDER BY line) THEN line END r
  FROM mytable
); 
"
35585,How to sum multiple Product Prices for a unique order,"select o.order_id, o.item_id, o.price, o.quantity, q.total, o.seller_id from (
  select order_id, seller_id, sum(price) total
  from   orders
  where seller_id = 1
  group by order_id, seller_id
) q
join orders o on (o.order_id = q.order_id and q.seller_id = o.seller_id);
"
19450,Why is SQL's grammar inside-out?,"MULTIPLY PRICE BY QUANTITY GIVING COST.
"
22509,unable to create 2 tables with same mapping in hibernate due to possible table name collision,"@JoinTable(name= ""ticket_to_collectors"")
@ManyToMany
private List<Person> collectors;
"
4912,Mysql Select Statement with respect to another table field,"SELECT newPassengers.id 
FROM newBus
    INNER JOIN newPassengers ON newPassengers.s_city = newBus.startCity
WHERE newPassengers.s_city = 'tCity' 
    AND newPassengers.e_city = 'MCity' 
    AND newBus.id = 5
"
10729,Is there a name for this database type?,"CREATE TABLE TEAM (
    TEAM_ID INT PRIMARY KEY
    -- Other fields...
);

CREATE TABLE SCORE (
    TEAM1_ID INT,
    TEAM2_ID INT,
    -- Other field(s) that descibe the score...
    PRIMARY KEY (TEAM1_ID, TEAM2_ID),
    FOREIGN KEY (TEAM1_ID) REFERENCES TEAM (TEAM_ID),
    FOREIGN KEY (TEAM2_ID) REFERENCES TEAM (TEAM_ID)
);
"
482,Select data from another table during insert,"insert into table2 
    select null, 12, max(odate), 0
    from table1;
"
38184,MySQL creating view which is union of two tables with one tables values prefixed,"SELECT CONCAT('AUTH_',blog.authors.id)
FROM db.authors
UNION 
SELECT authority 
FROM db.authorities_real
"
27511,MS Sql query to Hibernate HQL,"select max(mt.id) from mytable mt where mt.id in 
   (select mt2.id from mytable mt2 where mt2.mycolumn-value = 1234 order by mt2.id)
"
27054,MySQL using BETWEEN clause with AND clause & OR clause,"select *
from   reservation 
where  date(bdate) between '2013-2-4' and '2013-2-8' and 
       status IN ('Reserved','Confirmed')
order  by status
"
27606,How to mention schema name in dbms_metadata.get_ddl,"select dbms_metadata.get_ddl('PROCEDURE', 'PROCEDURE_NAME', schema => 'SCHEMA_NAME') from dual
"
15163,Update a row based on a value in another row,"UPDATE dbo.Subject_Choices SC
SET Required = 'Y'
WHERE Subject = 'Physics'
    AND EXISTS (SELECT 1 FROM dbo.Subject_Choices WHERE Subject = 'Maths' and ""student #"" = SC.""student #"" AND Required = 'N');
"
20097,Select - Order By word in MySQL?,"SELECT *  
FROM `table` 
WHERE `batch` = 'something' 
       AND outcome in ('Business','Professional', 'Consumer')
ORDER BY 
   CASE WHEN outcome  = 'Business'     THEN 1
        WHEN outcome  = 'Professional' THEN 2
        WHEN outcome  = 'Consumer'     THEN 3
        ELSE 4
   END
"
10377,Report Parameter validation in ssrs report,"Function CheckDateParameters(StartDate as Date, EndDate as Date) as Integer
Dim msg as String
     msg = """"
     If (StartDate > EndDate)  Then
 msg=""Start Date should not be later than End Date""
     End If
     If msg <> """" Then 
 MsgBox(msg, 16, ""Report Validation"")
 Err.Raise(6,Report)                    'Raise an overflow
     End If
End Function
"
13850,"How to select distinct rows from table without using functions(min,max etc)?","select t.*
from (select t.*,
             row_number() over (partition by <columns that should be different>
                                order by NULL) as seqnum
      from t
     ) t
where seqnum = 1;
"
11113,DateTime on Where Clause Oracle,"Select
....
From
...
Where create_date = trunc( (TO_DATE('06/30/14 21:41:11', 'MM/DD/YY HH24:MI:SS') 
                          - TO_DATE('01/01/1970 00:00:00', 'MM/DD/YYYY HH24:MI:SS')
                           ) * 24 * 60 * 60
                         );
"
22849,"OLAP And Stored Procedures, Performance Differences and Facts","create proc SellProduct (@productID int, @price money)
as
begin
    insert ProductSales (ProductID, SalePrice) values (@productID, @price)
    update Products set TotalSales = TotalSales + @price WHERE productid = @productID
end
"
25201,Count using like in SQL - how to?,"DECLARE @SiteId int
DECLARE @url varchar(100)
SET @url = 'http://stackoverflow.com%'
SET @SiteId = 10

SELECT g.url, COUNT(u.url) AS C
FROM tblGoals g
LEFT OUTER JOIN tblUrlCollection u
ON g.siteID = u.siteID AND g.url = u.url
WHERE g.url LIKE @url and g.Site=@SiteId
GROUP BY g.url
"
6807,WHERE conditions in subquery while using ANSI joins,"SQL> SELECT a.*
  2  FROM dual a
  3       JOIN (SELECT * FROM dual WHERE 1=1) b
  4       ON (1=1);

D
-
X

SQL> quit
Disconnected from Oracle9i Enterprise Edition Release 9.2.0.8.0 - Production
With the OLAP and Oracle Data Mining options
JServer Release 9.2.0.8.0 - Production
"
6272,How to Return One DB Row from Two That Have The Same Values In Opposite Columns Using the MAX Function?,"  SELECT z.id,
         MAX(z.col)
    FROM (SELECT x.id,
                 x.column1 AS col
            FROM TABLE x
          UNION 
          SELECT y.id,
                 y.column2
            FROM TABLE y) z
GROUP BY z.id
"
7253,Find entities with multiple relations,"SELECT 
    p.id 
FROM Photo p
JOIN PhotoConnect pc on pc.photo_id = p.id
JOIN PhotoConnect pc1 on pc1.photo_id = p.id
WHERE pc.outside_name = 'country' and pc.outside_key = 6 
  AND pc1.outside_name = 'region' and pc1.outside_key = 13
GROUP BY photo_id
"
10158,Using a parameter to set the value of another parameter (Report Builder 3.0),"@h_Startdate = IIf(@year=Empty, @Startdate, convert(datetime, @year+'-01-01', 120))
@h_Enddate = IIf(@year=Empty, @Enddate, convert(datetime, @year+'-12-31', 120))
"
4577,Using 2 WHERE clauses," SELECT *
 FROM   users
 LEFT
 JOIN   table2
 on     users.user = table2.total
 AND    table2.date = CURDATE()
 WHERE  users.value = '$value'
 AND    users.user in ( 'marketing', 'sales' )
"
14072,"What does the column flag ""G"" in MySQL Workbench mean","model->model().append_check_column(MySQLTableColumnsListBE::IsGenerated, ""G"", EDITABLE);
"
1942,Input redirection for script in SQL*Plus,"> sqlplus user/pwd@db @foo < input_file
"
24198,Oracle SQL grouping set returning more than one row,"select '1700' as ""LOCATION"", round(avg(e.salary),2) AS ""AVG SALARY"", count(d.LOCATION_ID) as ""COUNT""
from departments d
join employees e on e.DEPARTMENT_ID = d.DEPARTMENT_ID
where d.location_id = 1700

union

select '<>1700' as ""LOCATION"", round(avg(e.salary),2) AS ""AVG SALARY"", count(d.LOCATION_ID) as ""COUNT""
from departments d
join employees e on e.DEPARTMENT_ID = d.DEPARTMENT_ID
where d.location_id <> 1700
"
19075,Spring xml JNDI add sql script,"<jdbc:initialize-database data-source=""dataSource"" enabled=""true"">
    <jdbc:script location=""data.sql""/>
</jdbc:initialize-database>
"
8754,SQL: Automated column selection,"select current.*
from some_table current
   join other_table prev on prev.fid = current.id
   join third_table nxt on nxt.oid = prev.id
"
38343,"SQL Help (Join, transpose?)","select m.month,
       sum(case when c.regionid = 1 then 1 else 0 end) as north,
       sum(case when c.regionid = 2 then 1 else 0 end) as south,
       sum(case when c.regionid = 3 then 1 else 0 end) as east,
       sum(case when c.regionid = 4 then 1 else 0 end) as west
from region r
cross join month m
left join customer c on c.regionid = r.regionid and c.monthid = m.monthid
group by m.monthid, m.month
"
32672,MySQL How to convert second group by parameter results as a column?,"select MerchantID, 
       SUM(CASE WHEN Category = 'gold' THEN Total ELSE 0 END) AS gold,
       SUM(CASE WHEN Category = 'silver' THEN Total ELSE 0 END) AS silver,
       SUM(CASE WHEN Category = 'bronze' THEN Total ELSE 0 END) AS bronze 
from merchants
group by MerchantID 
"
19561,Update query based on date range,"Update T1
Set 
t1.id= T2.id,
t1.col2 = case when t1.dob < '1986-12-31' then t1.col2 else t2.col2 end,
t1.col3 = case when t1.dob > '1986-12-31' then t1.col3 else t2.col3 end
--More columns in the same way
from Table1 T1
Inner Join Table2 T2
ON T1.Cid = T2.cid
and T1.Name = T2.Name
and T1.DOB = T2.DOB
"
35426,adding +1 day to the next date on a join on an incomplete sequence of dates,"SELECT a.date, MIN(b.date)
FROM dates a
INNER JOIN dates b ON b.date > a.date
GROUP BY a.date;
"
19359,SQL get offline website by threshold,"SELECT `sourcewebsiteid`, `name`
FROM `sourcewebsite_updatelog`
JOIN `sourcewebsite`
ON `sourcewebsite_updatelog`.`sourcewebsiteid` = `sourcewebsite`.`id`
WHERE HOUR(TIMEDIFF(NOW(), `sourcewebsite_updatelog`.`datetime_start`)) < `sourcewebsite`.`offlinethreshold`
GROUP BY `sourcewebsiteid`
HAVING MAX(`episodestotal`) = 0
"
21472,A SELECT statement as subquery with two conditions,"WITH rownums(TIMESTAMP, ECGVALUE, RN) AS (
    SELECT TIMESTAMP, ECGVALUE, ROW_NUMBER() OVER(ORDER BY TIMESTAMP) AS RN
    FROM EKLUND.DEV_RAWECG
)
SELECT allrows.TIMESTAMP, allrows.ECGVALUE, allrows.RN
FROM rownums allrows
     CROSS JOIN rownums rown
WHERE rown.RN = n
      AND allrows.RN >= n
      AND rown.TIMESTAMP + offset >= allrows.TIMESTAMP;
"
26038,SQL Server: INSERT INTO SELECT MAX,"INSERT INTO Purchase_Deliveries_Items (
    ID,
    Item_ID
)
SELECT  
    ROW_NUMBER() OVER (
        ORDER BY
            Item_ID
    ) + (SELECT MAX(ID)
            FROM Purchase_Deliveries_Items) newID,
    Item_ID,
FROM Purchase_Orders_Items
WHERE 
    PurchaseOrder_ID = 1
"
16604,Find how many days from begining of the month to current day (Oracle),"SELECT TRUNC(SYSDATE) - TRUNC(SYSDATE,'MONTH') + 1 FROM DUAL
"
22878,How to separate this field into two columns,"Declare @Data Table ( Data Varchar(max) )
Insert @Data(Data) Values('30/07/2010 11:39:55: Booking status change from On Option to Cancelled')
Insert @Data(Data) Values('5/5/2010 10:1:8 : New')

Set DateFormat DMY

Select Cast(Reverse(Substring(Reverse(Data), CharIndex(':', Reverse(Data)) + 1, Len(Data))) As DateTime)
    , LTrim(Reverse(Substring(Reverse(Data), 1, CharIndex(':', Reverse(Data)) - 1)))
From @Data
"
26599,Expose ready-only data from Oracle DB to another Oracle DB," INSERT into outter_table@outter_db
 SELECT * from inner_view
"
33266,SQL Oracle Currency view,"select TO_char(fine,'FML9999.00',
'NLS_CURRENCY  = RM') from fine_table;
"
13362,"Getting last records by date, but for 2 different ID's","SELECT yt.*
FROM 
  (SELECT
    Team
  , MAX(GameDate) AS GameDate
  FROM
    (SELECT AwayTeam AS Team, GameDate
    FROM YourTable
    UNION ALL
    SELECT HomeTeam AS Team, GameDate
    FROM YourTable) a
  WHERE GameDate < NOW()
  GROUP BY
    Team) MaxDates
JOIN YourTable yt ON (MaxDates.Team = yt.AwayTeam OR MaxDates.Team = yt.HomeTeam) 
  AND yt.GameDate = MaxDates.GameDate 
WHERE MaxDates.team in (1,5)
"
16047,Oracle database: getting time from total amount of minutes from the beginning of a day,"select to_date('1.1.2015','dd.mm.yyyy')+480/1440 from dual;
"
34063,MySql - Find values that occur EXACTLY two times without using aggregate function,"select distinct c1.city_name
from city c1
  join city c2 
    on c2.city_name = c1.city_name 
   and c1.state_name <> c2.state_name
where not exists (select 1
                from city c3
                where c3.city_name = c1.city_name 
                  and c3.state_name not in (c1.state_name, c2.state_name));   
"
27486,How to avoid launching a trigger for every row of a prepared statement?,"UPDATE table1 t
SET    field1 = u.field1
FROM (
   VALUES
    ('abc'::text, 1)   -- cast string literal in row 1 to make type unambiguous
   ,('def', 2)
   ,('ghi', 3)
   ) u (field1, filed5)
WHERE  t.field5 = u.field5;
"
22649,Counting in Many to Many Relations in SQL,"select  count(distinct A.id) as DistinctA
,       count(distinct case 
                       when AB.bId is not null then A.id
                       end) as DistinctAHavingNotNullB
from    A 
left join
        AB 
on      A.id = AB.aId
"
30403,Selecting null columns for script output in SQL Developer,"SELECT
  c.CID, 
  c.CName,
  CAST(null AS VARCHAR2(1)) AS Continent, 
  null AS hemisphere, 
  null AS something, 
  r.RegionID, 
  r.RegionName
FROM
  Regions r 
  INNER JOIN Branch b ON b.RegionID = r.RegionID
  INNER JOIN Countries c ON c.CID = b.CID;
"
20302,Replace NULL with string if another cell isn't NULL,"select (case when T.Name is null then NULL
             when P.[Name]+' - '+P.[Description] is NULL then 'KanBan'
             else P.[Name]+' - '+P.[Description]
        end) AS Sprint
"
22525,Select limit percent,"SELECT *
FROM    (
    SELECT tablename.*, @counter := @counter +1 AS counter
    FROM (select @counter:=0) AS initvar, tablename
    ORDER BY value DESC   
) AS X
where counter <= (10/100 * @counter);
ORDER BY value DESC
"
15566,SQL Query Joins,"SELECT *
FROM (
    SELECT 
        week,name,effort 
    FROM [Group$]
) as s
PIVOT
(
    SUM(effort)
    FOR [name] IN ('quentin','joe','tracy')
)AS pvt
"
28195,how to use 'select' for this job,"SELECT id, 
    SUM(CASE WHEN status = 0 THEN 1 ELSE 0 END) AS SUM_STATUS_0, 
    SUM(CASE WHEN status = 1 THEN 1 ELSE 0 END) AS SUM_STATUS_1,
    SUM(status) AS SUM_STATUS
FROM TABLE
GROUP BY id
"
9610,SQL query to pivot table on column value,"select 
  max(case when teamid = 1 then playername else '' end) Team1,
  max(case when teamid = 2 then playername else '' end) Team2
from
(
  select TeamId,
    PlayerName,
    (select count(*)
     from yourtable d
     where t.teamId = d.TeamId
       and t.playername <= d.PlayerName) rn
  from yourtable t
) d
group by rn;
"
332,How Can I Retrieve the DB settings on Joomla?,"$info =& JFactory::getApplication();

$info->getCfg('host'); 
$info->getCfg('user'); 
$info->getCfg('db'); 


// defined in libraries/joomla/application/application.php (380)
function getCfg( $varname ) {
    $config =& JFactory::getConfig();
    return $config->getValue('config.' . $varname);
}
"
144,MS Access Max and Select top n query issue with duplicate values,"SELECT StudentID, TestID, TestScore
  FROM MyTable t
 WHERE TestID IN
(
  SELECT TOP 3 TestID 
    FROM MyTable
   WHERE StudentID = t.StudentID 
   ORDER BY TestScore DESC, TestID
)
 ORDER BY StudentID, TestScore DESC, TestID;
"
29110,Find latest value earlier than specified date,"SELECT TOP 1
  Rate
FROM
  MyTable
WHERE
  DateColumn <= '20120520'
ORDER BY
  DateColumn DESC
"
7483,case statement in where clause depending on variable value,"SELECT *
FROM SomeTable ST
WHERE (@CustID <> 0 AND ST.SomeColumn = @BillID)
    OR (@CustID = 0 AND ST.SomeColumn IN (@BillID, 0))
"
5918,"When joining a query using separate databases, how can I select an identifying field that lets me know which database the row came from?","SELECT DISTINCT Field1, [DB]
FROM (
    SELECT Field1, 'MainDB' as [DB] 
    FROM [MainDB].[dbo].[TestTable]
    where Field2 = 'company1' AND Field1 NOT IN (SELECT Field1 FROM [OtherDB].[dbo].[TestTable] where Field2 = 'company1')

    UNION ALL

    SELECT Field1, 'OtherDB' as [DB] 
    FROM [OtherDB].[dbo].[TestTable]
    where Field2 = 'company1' AND Field1 NOT IN (SELECT Field1 FROM [MainDB].[dbo].[TestTable] where Field2 = 'company1')
    ) as Results
"
25798,Regex to extract info from SQL query,"$input =~s/--.*?\n//g; # delete the comments.
$input =~s/\s+/ /g; # replace multiple white space with single space.
while($input=~m/((?:insert into)|(?:delete from)) (\w+)/ig) { 
        print ""$1 : $2\n"";    
}
"
39491,finding out redundancy,"select foriegn_column_name,COUNT(foriegn_column_name) from table_name
group by foriegn_column_name
having COUNT(foriegn_column_name) > 1
"
6919,How to handle recursion in a flat table?,";WITH t AS (
SELECT 1 AS iteration, p.Permission_ID AS PermissionID, p.Permission_ID, CAST(N'/' + p.Permission AS NVARCHAR(MAX)) AS Permission
FROM #TempPermissions AS p
UNION ALL
SELECT iteration + 1, t.PermissionID, p.Parent_ID, COALESCE(N'/' + (SELECT s.Permission FROM #TempPermissions AS s WHERE s.Permission_ID = p.Parent_ID), N'') +  t.Permission
FROM t INNER JOIN #TempAppPermissions AS p ON t.Permission_ID = p.Permission_ID
)
SELECT PermissionID, Permission FROM t
WHERE Permission_ID = -1
ORDER BY PermissionID, Iteration
"
39521,datepart some months from 2 years,"SELECT Jmeno, COUNT(Ucast)
  FROM Hraci
 INNER JOIN Ucast_Zapas ON Ucast_Zapas.ID_Hrace_zapas=Hraci.IDHrace
 INNER JOIN Zapas ON Zapas.ID_zapas=Ucast_Zapas.ID_zapasu_ucast
 INNER JOIN Kategorie ON Kategorie.IDkategorie=Zapas.Kategorie_zapas
 WHERE (Ucast=1)
   AND (Kategorie.IDkategorie=1)
   AND Zapas_Datum >= '8/1/2013' 
   AND Zapas_Datum < '9/1/2014' 
GROUP BY Jmeno;
"
38407,fetch data from two tables with single query,"SELECT id FROM ABC
UNION ALL
SELECT id FROM XYZ
"
27011,Insert of data in a query in SQL Server,"INSERT INTO [Product]
SELECT  DISTINCT PT.[Name],PT.[Description]
FROM    [Producttemp] AS PT
LEFT OUTER JOIN [Product] AS P ON P.[Name] = PT.[Name] AND P.[Description] = PT.[Description]
WHERE   P.[Name] IS NULL
"
7817,SQL Having Statement with a 'CASE columnx IN (select statement)',"HAVING u.urlid in (
  SELECT URLCat.URLID 
  FROM urlcat inner join URL ON URLCat.URLID = URL.URLID 
  WHERE CatID in (SELECT * FROM dbo.bigintlist_to_tbl(@IDList))
  GROUP BY urlcat.urlid 
  HAVING COUNT(DISTINCT catid)=@Count) and @IDList <> '0'
  UNION ALL
  SELECT u.urlid WHERE @IDList = '0'
)
"
8333,need absent and present count with month name,"SELECT   MONTHNAME(attendance_date) AS `Month_Name`, 
         COUNT(CASE WHEN STATUS ='A' THEN 1 END) AS absent_count,
         COUNT(CASE WHEN STATUS ='P' THEN 1 END) AS present_count,
FROM     attendance
WHERE    sid = '2' AND campus_id = 2
GROUP BY MONTHNAME(attendance_date);
"
19362,Fetch or get null rows from second table which contains repeated id - SQL Server,"select d.*, a.accounts
from (select d.*, row_number() over (partition by ticketid order by (select NULL)) as seqnum
      from devices d
     ) d left join
     (select a.*, row_number() over (partition by ticketid order by (select NULL)) as seqnum
      from accounts a
     ) a
     on d.ticketid = a.ticketid and d.seqnum = a.seqnum;
"
9500,Query with multiple subqueries required in Mysql,"select Name, 
       sum(Runs) as total, 
       count(case when Runs>100 then 1 end) `>100`,
       count(case when Runs>50 and Runs<100 then 1 end) `>50&<100`,
       count(*) as totalTimes,
       count(case when Status='not out' then 1 end) `Not Out`
from tempTable 
where classID IN (Select classID from upcoming_Clases where classes_id=175) 
group by Name order by total desc
"
15612,Got Questionmarks during updating into SQL,"UPDATE yourTable SET yourcolumn = N'newtext';
"
4674,SQL Server: how to set return format?,"DECLARE @Today DATETIME
    SET @Today = '12/5/2007'

    SET LANGUAGE Italian
    SELECT DATENAME(month, @Today) AS 'Month Name'

    SET LANGUAGE us_english
    SELECT DATENAME(month, @Today) AS 'Month Name' 
    GO
"
38954,Can i get a SUM(Qte) in incremental manner,"select t.*,
       (select sum(t2.qte) from table as t2 where t2.id <= t.id) as QteLevel
from table as t;
"
9762,mysql select row based on count of another table,"SELECT * 
FROM BlogPosts 
WHERE ID IN 
    (SELECT PostID FROM photos GROUP BY PostID HAVING count(*) >= 5)
"
9361,How to use the same function like Oracle Rownum in MS ACCESS,"SELECT
    DCount('*', 'YourTable', 'ID <= ' & y.ID) AS NID,
    y.ID,
    y.value
FROM YourTable AS y;
"
30280,How to count the occurence of a column which is the result of a concatenation of a string and integer,"SELECT b.*,
      (b.AUDTORG + CAST(b.SEQUENCENO AS varchar(255)) )as NewID,
      count(*) over (partition by b.AUDTORG + CAST(b.SEQUENCENO AS varchar(255)) ) as Occurence
FROM ADXDAT.dbo.BKENTD b;
"
34917,SQL UPPER only specific word,"update table
set field = replace(field, 'cheese', 'CHEESE')
"
125,MySQL query: merge rows in three tables and output as one,"SELECT 
  t1.USER, 
  t1.PID, 
  COUNT(T3.SPEC) AS CountRound
FROM Table1 t1
  LEFT JOIN Table2 t2 ON t1.PID = t2.PID 
  LEFT JOIN Table3 t3 ON t2.LID = t3.LID AND t3.SPEC = 'ROUND'
GROUP BY
  t1.USER,
  t1.PID
"
18042,Set a column value at a specified row,"UPDATE table_name 
SET column1 = value, column2 = value2 
WHERE some_column = some_value
"
37196,"delete from table1,table2,table3 where?","DELETE t1, t2, t3
  FROM TABLE_1 t1
  JOIN TABLE_2 t2 ON t2.gamer_id = t1.gamer_id
  JOIN TABLE_3 t3 ON t3.gamer_id = t1.gamer_id
 WHERE t1.gamer_id = 123
"
19333,Add 0's in sql server,"DECLARE @MilestoneName VARCHAR( 50 )
SELECT @MilestoneName = 'Milestone' + RIGHT('000'+ CONVERT(VARCHAR,001),3)
"
36780,Meanings of values of approved_flag values in oracle payables (PO_RELEASES_ALL),"Approved - Y
Requires Reapproval - R
Rejected - F
In-Process - NULL or N
"
36272,SQL Inserting Data into table,"update TableA
    set Col1 = (select Col1 from TableB)
    where Col1 is null
"
34064,Many to Many relation with join table,"SELECT * FROM event
INNER JOIN event_categories_join ON event.id = event_categories_join.event_id
INNER JOIN category ON category.id = event_categories_join.category_id
WHERE category.name = 'my_category';
"
10630,zend 2: Using Paginator with TableGateway,"$select = new Select($this->tableGateway->getTable());

$paginatorAdapter = new DbSelect(
    $select,
    $this->tableGateway->getAdapter(),
    $this->tableGateway->getResultSetPrototype()
);
$paginator = new Paginator($paginatorAdapter);

return $paginator;
"
21591,Composite Primary Key + Foreign Key,"CREATE TABLE [dbo].[VariableMappings](
    [ParentSurvey_ID] [nvarchar](4) NOT NULL,
    [ReportingMonth] [nvarchar](6) NOT NULL,
    [VariableName] [nvarchar](400) NOT NULL,
    [Value] [int] NOT NULL,
  PRIMARY KEY (ParentSurvey_ID, ReportingMonth, VariableName),
  FOREIGN KEY (ParentSurvey_ID)
    REFERENCES dbo.SurveyMaster (ID)
) ;
"
34802,UPDATE JOIN statement for DB2,"UPDATE table2
SET table2.PageID = 
    (SELECT t1.PageID
    FROM table1 t1
   WHERE t1.id = table2.SCRID)
WHERE EXISTS(
    SELECT 'TABLE1PAGE'
    FROM table1 t1
    WHERE t1.id = table2.SCRID)
"
32012,MySQL - Second ORDER BY Parameter in a Query," $q = ""SELECT * FROM football_1314_beacha_standings ORDER BY pct DESC, win DESC"";
"
26450,sql select info per day per team,"SELECT 
  Date,
  SUM(CASE WHEN team = 'team1' THEN 1 ELSE 0 END) 'team1',
  SUM(CASE WHEN team = 'team2' THEN 1 ELSE 0 END) 'team2',
  SUM(CASE WHEN team = 'team3' THEN 1 ELSE 0 END) 'team3'
FROM Tablename
GROUP BY date;
"
19702,SQL query SUM() AND GROUP BY,"SELECT 
    accommodation_id, 
    SUM(amount * persons) as max_persons_available 
FROM 
    availabilities 
WHERE 
    available = 1 and arrival >= '2015-12-19' and arrival < '2015-10-26'
GROUP BY 
    accommodation_id
"
2783,TSQL: union results from two selects (procedures?),"create table #sometable (table definition here)

if @Param = 1 or @Param = 3 begin
    insert #sometable exec PROCEDURE1
end

if @Param = 2 or @Param = 3 begin
    insert #sometable exec PROCEDURE2
end

select * from #sometable
"
3087,SQL -- create column in SELECT to test equality,"SELECT  StaffID
        , StartTime
        , EndTime
        , Case
          When StartTime = EndTime Then 1
          else  0
        End as AreEqual
FROM    tblSchedule
Where   StaffID = xxx
"
11421,How to use a column from joined table in a join with a subquery,"SELECT *
FROM MainTable m
INNER JOIN JoinedTable j on j.ForeignID = m.ID
CROSS APPLY (SELECT TOP 1 *
            FROM SubQueryTable sq
            WHERE  sq.ForeignID = j.ID
            ORDER BY VersionColumn DESC) sj
"
18471,Natural Sort in NHibernate,"ORDER BY Name COLLATE Latin1_General_BIN ASC
"
8763,Multiple value parameter ssrs,"WHERE GroupId IN (@group) OR GroupId = @group
"
15972,SQL Calculations based by field type and group by the type,"SELECT t.`Type 1`, t.`Type 2`, t.`Type 3`,
    (t.`Type 1` + t.`Type 2` + 2*t.`Type 3`) AS Total
FROM
(
    SELECT FamID AS Family,
        SUM(CASE WHEN TicketType = 1 THEN Amt ELSE 0 END) AS `Type 1`,
        SUM(CASE WHEN TicketType = 2 THEN Amt ELSE 0 END) AS `Type 2`,
        SUM(CASE WHEN TicketType = 3 THEN Amt ELSE 0 END) AS `Type 3`,
    FROM Tickets
    GROUP BY FamID
) t
ORDER BY t.Total DESC
"
10286,Find which SQL queries take a lot of CPU,"$sql='...';
$start=microtime(true);
$mysql_query($sql);
$end=microtime(true)-$start;
echo $end.' seconds'; // in seconds
echo ($end*1000).' milliseconds';
"
35829,postgres: upgrade a user to be a superuser?,"ALTER USER myuser WITH SUPERUSER;
"
18890,MySQL query to get the top 50 names appearing the most in the last 7 days,"select count(id), name
from tablename
where DATE_SUB(NOW(), INTERVAL 7 DAY) < create_time 
group by name
order by count(id) desc
limit 50;
"
35918,How to sort by text first and then text containing numbers,"SELECT * 
  FROM Table1
 ORDER BY CAST(column1 AS INTEGER), column1
"
14820,join two columns with same title but in different table,"SELECT t2.CUST_ID
     , COALESCE(SUM(t1.AMOUNT), 0) AS TOTAL
FROM cus t2 LEFT JOIN pur t1 ON t1.CUST_ID = t2.CUST_ID
GROUP BY  t2.CUST_ID
ORDER BY TOTAL
"
35106,Sum the different date total,"SELECT
    CAST(DATEADD(hour, -5, TRAN_DATE) AS DATE) AS sDate,
    SUM(Amount)
FROM TRAN_TABLE
GROUP BY CAST(DATEADD(hour, -5, TRAN_DATE) AS DATE)
"
14523,Setting up a CakePHP test database by using app/Config/Schema/schema.php,"echo -e ""--- Installing plugins via composer""
buildbox-run ""composer install""

echo -e ""--- Setting up database""
buildbox-run ""cp ./app/Config/database.buildbox.php ./app/Config/database.php""

# create the default database, so that we can use $import as a means of generating fixture data on the test database.
# say yes at all prompts: http://askubuntu.com/questions/338857/automatically-enter-input-in-command-line
buildbox-run ""yes | ./app/Console/cake schema create""
"
28406,How to get minimum value from the SQL table?,"SELECT 
CASE WHEN MIN(COALESCE(Date, '19001231')) = '19001231' THEN NULL ELSE MIN(Date) END AS Date,
Id 
FROM X 
group by ID
"
3377,Bulk insert to SQL Server using a text qualifer in a format file,"10.0
3
1   SQLCHAR   0  50    "",\""""      1     Name         SQL_Latin1_General_CP1_CI_AS
2   SQLCHAR   0  50    ""\"",""      2     Address      SQL_Latin1_General_CP1_CI_AS
3   SQLCHAR   0  50    ""\r\n""     3     Email2       SQL_Latin1_General_CP1_CI_AS
"
24612,"How to optimize this ""Time apart"" SQL query?","SELECT
  a.eventID,
  b.eventID,
  COUNT(*)
FROM
  table a
INNER JOIN
  table b
    ON a.eventID <> b.eventID
WHERE
      b.thetimeanddate >= date_trunc('day', a.thetimeanddate) - INTERVAL '5 days'
  AND b.thetimeanddate <  date_trunc('day', a.thetimeanddate) + INTERVAL '6 days'
GROUP BY
  a.eventID,
  b.eventID
ORDER BY
  COUNT(*) DESC
LIMIT
  1000
;
"
36843,Summarize MySQL table entries by Day,"SELECT DAYNAME(date) AS Day, 
group_concat(completedtasks separator ',') as completedtasks, 
group_concat(duration separator ',') as duration, 
group_concat(educationDepartment separator ',') as educationdepartment 
FROM programm_completedtask
group by dayname(date);
"
1000,SQL query for Top 5 of every category,"SELECT t1.category, t1.timestamp, t1.value, COUNT(*) as latest
FROM foo t1
JOIN foo t2 ON t1.id = t2.id AND t1.timestamp <= t2.timestamp
GROUP BY t1.category, t1.timestamp
HAVING latest <= 5;
"
36604,Apply SELECT LEFT() on the total characters from multiple columns combined,"SELECT id,
  LEFT(heading, 100) AS heading,
  IF(LENGTH(heading)>=100, '', LEFT(article, 100-LENGTH(heading))) AS article
FROM news
ORDER BY stamp DESC
LIMIT 5;
"
33289,A kind of sorting which i couldn't resolve,"WITH CTE AS
(
   SELECT  MaxJob = MAX(ANALYSISJOBID) OVER (PARTITION BY PACKAGEID), t.*
   FROM dbo.TableName t
)
SELECT PACKAGENAME, PACKAGEID, ANALYSISJOBID
FROM CTE 
ORDER BY MaxJob DESC, ANALYSISJOBID DESC
"
15454,T-sql script to replace first 2 numbers in a string,"UPDATE mytable
SET field = '88' + SUBSTRING(field, 3)
WHERE SUBSTRING(field, 1, 2) = '99'
"
22310,SQL: how to get more information from a GROUP BY statement,"SELECT  
invoice.customer_name,  
invoice.customer_id,  
sum(invoice.cost) 
FROM invoice 
GROUP BY 
invoice.customer_name, invoice.customer_id
"
14327,"MYSQL - Select statement, if condition fail return empty string","SELECT agent.name,agency.title FROM agent
LEFT JOIN agency ON agent.titleid = agency.titleid
WHERE agent.id = ""1""
"
23669,How to return maxvalue or nullvalue in SQL?,"SELECT MAX(NVL(END_DATE,SYSDATE + 1) ...
"
18868,SUM time values in related table,"SELECT e.name, ap.event_id,
sum((TIME_TO_SEC(end_time) - TIME_TO_SEC(start_time))/60) AS dif
FROM events e LEFT JOIN appointment ap ON e.id = ap.event_id
GROUP BY e.name, ap.event_id
ORDER BY 2;
"
27051,Query to select a record with highest value,"SELECT *
FROM   (SELECT *, RANK() OVER (ORDER BY yyear DESC, mmonth DESC) AS rk
        FROM   some_table) t
WHERE  t.rk <= <number of records you want>
"
15904,Search Multiple Columns if parameters aren't null?,"WHERE   (coalesce(@Name, '') = '' or [Name] = @Name)
  AND   (coalesce(@User_ID, 0) = 0 or [User_ID] = @User_ID)
"
6613,"SQLite for Android custom table view (SQL VIEW, not Android view) discrepancy?","""create view if not exists item_view as select "" +
    ""item._id as _id, item.status as item_status, item.name as item_name, item.position as item_position, "" +
    ""item.parent_item_id as item_parent_item_id, item.note_id as item_note_id, item.other_id as item_other_id, "" + 
    ""note.contents as note_contents, other.priority as other_priority "" +
""from item, note, other where item.note_id = note._id and item.other_id = other._id""
"
29540,SQL Server: How to extract comments from stored procedures for deployment,"CREATE PROCEDURE dbo.foo 
WITH ENCRYPTION 
AS 
BEGIN 
    SELECT 'foo' 
--Try this just to make sure
END
"
5073,How to make a return type for a result set in LINQ,"var typed = from row in cxt.SomeFunction(123)
            select new MyType {Id = row.Id, Name = row.Name, ...}
"
34603,SQL Server 2008 WHERE clause with CASE / WHEN and NULL value,"select *
from MyTable m
where @Category is null or m.Category = @Category
"
26648,Count rows in own type such as type as table or type as object,"select id, chain, cardinality(chain) 
from (
   select 
           x.id, 
           cast(multiset(select parent_id from x) as chain_t) as chain
    from x
)
/
"
3806,Create SQL Query for Name/Value Pair Data,"SELECT t.id,t.source
       max(CASE WHEN t.fieldname = 'From' then t.FieldValue end) as From_col,
       max(CASE WHEN t.fieldname = 'To' then t.FieldValue end) as To_col,
       max(CASE WHEN t.fieldname = 'Subject' then t.FieldValue end) as Subject_col
FROM YourTable t
GROUP BY t.id,t.source
"
26893,How to speed up this group by with CSV column?,"SELECT  parent_id ,
        (   SELECT    CAST(bt2.child_id AS VARCHAR(5)) + ','
            FROM      dbo.breakTypes bt2
            WHERE     bt2.parent_id = bt1.parent_id
            FOR XML PATH('')
        ) AS child_id_csv 
FROM  (select distinct parent_id
       from breaktypes
      ) bt1;
"
39494,Join to get row matching minimum value of function,"select [Date],Latitude,Longitude,StopName,StopLat,StopLon, dbo.Haversine(Latitude,Longitude,StopLat,StopLon) as distance 
INTO #Distances 
from GPS,STOPS;

select * from #Distances d
join 
(
select [Date],min(distance) minDist from #Distances group by [Date]
) B on (d.[date]=B.[date]) and (d.distance=b.minDist);
"
23754,auto_increment with varchar in oracle,"create or replace trigger some_trig_name
before insert on WishList
for each row
begin
:new.idWishList := to_char(your_sequence.nextval);
end some_trig_name;
"
29404,Custom SQL GROUP BY Clause,"SELECT Partnumber, MAX(PO)
FROM MyTable t1
WHERE NOT EXISTS (SELECT 1
                  FROM MyTable
                  WHERE (Receipt <> '0'
                         OR Receipt <> '')
                  AND Partnumber = t1.partnumber)
GROUP BY PartNumber
"
3814,Improve delete with IN performance,"DELETE FROM polozkyTransakci 
WHERE typPolozky = 'odpocetZalohy'
     AND NOT EXISTS (SELECT 1
                     FROM transakce_tmp r
                     WHERE r.puvodFaktury = 'FAKTURA VO CZ'
                          AND r.idTransakce = polozkyTransakci.idTransakce );
"
13733,SQL View how to Group By and Sum,"CREATE VIEW [dbo].[Members_View] AS
  SELECT Members.ID, Members.Name, Members.Email, 
         COUNT(*) as ECount
  From Members JOIN
       dbo.Entries
       ON Members.[Name] = Entries.[AssignedTo]
  Group By
    Name,
    Members.ID,
    Members.Email;
"
35814,Using a variable in MySQL Select Statment in a Where Clause,"SELECT col1 WHERE col1 > (SELECT MAX(col2) - COUNT(DISTINCT col3)) 
"
6562,Hibernate Criteria API Equivalent to Oracle's Decode,"<property name=""name"" formula=""coalesce(first_name, last_name)""/>
"
3505,How to 'add' a column to a query result while the query contains aggregate function?,"SELECT
    T2.course_id,
    T2.attendance_time
    T2.id
FROM (
    SELECT
        course_id,
        MAX(attendance_time) AS attendance_time
    FROM attendance
    GROUP BY course_id
) T1
JOIN attendance T2
ON T1.course_id = T2.course_id
AND T1.attendance_time = T2.attendance_time
"
16513,Script for getting posts with unique role,"SELECT DT.DiscussionThreadID, DT.Message
FROM DiscussionThread DT
INNER JOIN Users U on U.UserID = DT.CreatedBy
INNER JOIN UserRoles UR on UR.RoleID = U.RoleID
group by DT.DiscussionThreadID, DT.Message
having count(Distinct roleID) = 1
and max(roleID)=4
"
17818,"regex to split name=value,* into csv of name,* and value,*","echo $input | sed 's/[^,]*=//g'
"
25469,Ratio of flagged employees to total employees for each department,"select
   department,
   sum(case when flag = 1 then employees else 0 end) -- flagged employees only
     / cast(sum(employees) as float)      -- all employees
       as ratio
from tab
group by department;
"
16136,How do I programmatically change value of a field in an Access database?,"UPDATE MyTable SET MyTable.Found = True WHERE MyTable.NameField LIKE ""*abc*"";
"
9152,SQL Display info with Max(count(*)),"SELECT g.firstname, g.lastname, count(*) AS hella
FROM   guest    g
JOIN   timeslot t USING (timeslotnum)
JOIN   shows    s USING (shownumber)
WHERE  s.showname = 'Fitness'
GROUP  BY 1,2
ORDER  BY 3 DESC
LIMIT  1;
"
10737,Update several columns in several rows from 1 row in same table,"Update table1 set
    MonVal1    = origin.MonVal1, 
    /* the orher fields here */
    SunVal53   = origin.SunVal53
from table1
inner join table1 as origin on origin.storenum = 1
where table1.storenum in (3, 4,...284,285)
"
34537,How to Split Sql Int Value into Multiple Rows,"create table #splitme (Id int, description varchar(255), quantity int) 
insert #splitme values (1    ,'my desc',          3)
insert #splitme values (2    ,'desc 2',           2)

create table #numbers (num int identity primary key) 
declare @i int 
select @i = max(quantity) from #splitme
while @i > 0
begin   
    insert #numbers default values 
    set @i = @i - 1 
end

select Id, description, 1 from #splitme 
join #numbers on num <= quantity
"
11664,SELECT with calculated column that is dependent upon a correlation,"WITH Matches AS
(
    SELECT ID, CASE WHEN Col1 = 'a' THEN 1 ELSE 0 END + 
    			CASE WHEN Col2 = 'c' THEN 1 ELSE 0 END +
    			CASE WHEN Col3 = 1  THEN 1 ELSE 0 END +
    			CASE WHEN Col4 = 5  THEN 1 ELSE 0 END AS Result
    FROM Table1
    WHERE Col1 = 'a' OR Col2 = 'c' OR Col3 = 1 OR Col4 = 5 
)
SELECT ID, Result
FROM Matches
WHERE Result > 1
"
32714,Paradox DB SQL Multiple JOINS,"FROM 
    (
        ""CHECK"" C
        INNER JOIN 
        ""RCHECK"" R
            ON C.Cnum = R.Cnum 
    )
    INNER JOIN 
    ""PCHECK"" P
        ON P.Cnum = C.Cnum 
"
32492,"In SQL in a ""group by"" expression: how to get the string that occurs most often in a group?","select A, B
from (
  select A, B, ROW_NUMBER() OVER (PARTITION BY A ORDER BY C_B DESC) as rn
  from (
     select A, COUNT (B) as C_B, B
     from table
     group by A, B
  ) count_table
) order_table
where rn = 1;
"
27685,Group results by days in a date range,"SELECT * FROM test WHERE 
timepacket BETWEEN '2014-02-16 00:00:00' AND '2014-02-19 00:00:00' 
AND shift = 1 
GROUP BY timepacket;
"
22488,insert data from 3 tables with the same fields into 1 table,"INSERT INTO dummy  (code, jno, ven, date)
  SELECT code, jno, ven, date FROM accnt jno > '40000'
  UNION ALL
  SELECT code, jno, ven, date FROM jobcost jno > '40000'
  UNION ALL
  SELECT code, jno, ven, date FROM servic15 jno > '40000';
"
1075,need to solve this sql query,"SELECT
 employee_name
FROM
 Works
GROUP BY
 employee_name
HAVING
 COUNT(*) > 2
"
21312,Replace a column value in a table using regex in mysql,"CREATE FUNCTION SPLIT_STRING(str VARCHAR(255), delim VARCHAR(12), pos INT)
RETURNS VARCHAR(255)
RETURN REPLACE(SUBSTRING(SUBSTRING_INDEX(str, delim, pos),
   LENGTH(SUBSTRING_INDEX(str, delim, pos-1)) + 1),
   delim, '');

SPLIT_STRING('first:10:second:18:third:31', ':', 4)
"
15201,Replacing subselects with rank,"SELECT d1.timestamp as badreading
    ,  max(case when d2.timestamp < d1.timestamp then d2.timestamp end) as x
    ,  min(case when d2.timestamp > d1.timestamp then d2.timestamp end) as y  
FROM dailyreading d1, dailyreading d2
WHERE d1.result = 'Bad'
  AND d2.result = 'Good'
GROUP BY d1.timestamp
ORDER BY d1.timestamp;
"
11241,"SQL Problem - Duplicate Names, listing all fields","SELECT * FROM [Employee]
WHERE lname + ', ' + fname in 
(SELECT lname + ', ' + fname as fullname FROM [Employee]
WHERE lname != ' ' AND fname != ' '
GROUP BY lname + ', ' + fname
HAVING COUNT(*) > 1)
"
39314,Query to get user info and list of roles in a single row,"SELECT u.id, u.firstname, u.lastname, array_agg(r.name)
FROM user u 
LEFT OUTER JOIN user_role ur ON (u.id = ur.user_id)
LEFT OUTER JOIN role r ON (ur.role_id = r.id)
GROUP BY u.id;
"
13783,sql select all but nulls,"SELECT t1.Id, t1.Name, t2.Color 
from TableA t1 left outer join TableB t2 
on t1.Id_TableB = t2.Id;
"
39203,Simple constraint to limit an Oracle table to a single row,"> create unique index table_uk on one_row_table ('1');
"
22237,Copy rows from the same table and update the ID column,"INSERT INTO ProuctDefinition (ProdID, Definition, Desc)
SELECT
  xxx, Definition, Desc
FROM
  ProductDefinition
WHERE
  ProdID = yyy
"
36685,Wrong time on SQLite timestamp on the iPhone,"gmtFormatter.timeZone = [NSTimeZone timeZoneWithAbbreviation:@""GMT""];
[gmtFormatter setDateFormat:@""yyyy-MM-dd HH:mm:ss""]
"
1068,Adding values from lines to columns (transport costs),"update t
set revcost= t2.cost 
from t t1 left join t t2
on t1.src=t2.tgt and t1.tgt=t2.src
where t.src=t1.src and t.tgt=t1.tgt;

select * from t order by id;
"
13660,Access query with multiple criteria + allowing null values not working properly,"field1 = Not Like ""*x*,*y*,*z*,*w*"" or field1 is null
field2 = Not Like ""*a*,*b*,*c*"" or field2 is null
"
39271,Use ORDER BY clause on foreign language field,"SELECT * 
FROM countries 
ORDER BY `name_czech`
"
33846,union of two table - intersection of two table,"SELECT
  A, B
FROM
  (SELECT A, B FROM TABLE1
   UNION ALL
   SELECT A, B FROM TABLE2)
  AS COMBINED
GROUP BY
  A, B
HAVING
    COUNT(*) = 1
ORDER BY A;
"
31788,two queries returning different data,"DECLARE @myF NVARCHAR(4), @FromDate DATE
SET @myF = 'abc4'
"
26706,Running a nested SQL query to subtract the result of the latter SELECT query,"SELECT MAX(result, 0)
"
8937,Loop through references in SELECT statement,";with cte as (
    select cast(a.ID as varchar(20)) as [Source], a.ID, a.ID_REF
    from accounts a where ID = 'REF3'
    union all
    select cte.Source, a.ID, a.ID_REF
    from accounts a
    inner join cte on cte.ID_REF = a.ID
)
select [Source] ID, ID ID_REF
from cte
where ID_REF is null
"
10958,How can I update the value of a specific field of my table for all rows?,"update PROJECT_INFO_STATUS 
set ID = ID +1
"
3890,Efficient way to get DISTINCT rows of Table A when JOINing with Table B,"select a.*
from tablea a
where exists (select 1 from tableb b where b.a_id = a.id and b.type = 'x');
"
19552,Doctrine2 column type integer of length 255 doesn't apply to DB,"/** @Column(type=""bigint"") */
protected $number; 
"
23064,"transfering managers commands into employees, using SQL commands groupby and having","select Lname
  from Employee e
where e.ssn in (
                  select  w.essn
                   from   works_on w, Project p
                  where w.pno = p.pnumber
                  group by w.essn
                  having count(*) >= 3
                 )
"
27236,Update left join rows that didn't match,"update mytable1 t1 inner join mytable2 t2 on (t1.a=t2.a or t1.b=t2.b or t2.c=t1.c) set t1.state=5,t2.state=5 where((cast(t1.a=t2.a as unsigned integer) + (cast(t1.b=t2.b as unsigned integer) + (cast(t1.c=t2.c as unsigned integer)) <3) and t1.state=0;
"
19716,SQL generate score column from multi-condition test on a notes cell,"SELECT
    case when notes like '%Tuna%' THEN 1 ELSE 0 END +
    case when notes like '%apple%' THEN 1 ELSE 0 END +
    case when notes like '%burrito' THEN 1 ELSE 0 END as score
    ,Name
    ,Date
    ,Notes
FROM food_jrnl
"
3008,SQL IN - Variable inside of table column?,"where d = <cfqueryparam cfsqltype=""cf_sql_varchar"" value=""#c#""> 
--- c is only element
or d like <cfqueryparam cfsqltype=""cf_sql_varchar"" value=""#c#,%""> 
--- c is first element
or d like <cfqueryparam cfsqltype=""cf_sql_varchar"" value=""%,#c#,%""> 
--- c is in the middle somewere
or d like <cfqueryparam cfsqltype=""cf_sql_varchar"" value=""%,#c#""> 
--- c is last element
"
23376,Join table and applying filter?,"select p.ServiceID, i.InsuraneID, i.Name, p.Amount, p.Month, p.Type
from Pymt p
inner join Ins i on p.InsuranceID = i.InsuranceID
where p.Month='Jun15' and p.Type=1
"
24875,MySQL DB with multiple numbers show as rows,"select
    concat(""Type: "", roomtype,
    "" - RoomNo: "", roomno,
    "" - Features: "", group_concat(feature order by feature separator ', '))
    as result
from t1
group by roomtype, roomno
"
24719,Select records from master table based on condition from 4th detail table,"Select DISTINCT table1.* 
from table1 
    INNER JOIN table2 ON table1.PK1 = table2.PK1 
    INNER JOIN table3 ON table2.PK2 = table3.PK2 
    INNER JOIN table4 ON table3.PK3 = table4.PK3
WHERE table4.PK4 = 3 
"
33805,catching created IDs in cursor loop,"DECLARE

  v_bid B.b_id%TYPE;

BEGIN
   FOR rec IN (SELECT id
                 FROM A
                WHERE group_id = 7)
   LOOP
     INSERT INTO B (b_id, thing2, ...stuff...) RETURNING b_id INTO v_bid;

     INSERT INTO C (rec.id, /* new ID generated by previous insert statement */
     COMMIT;
   END LOOP;
END;
"
26935,Double join on a table on the same field,"SELECT 
  fly.codeAirport1, 
  a1.value as valueAirport1,
  fly.codeAiport2,
  a2.value as valueAirport2
FROM
  fly
LEFT JOIN 
  airports a1 ON a1.code = fly.codeAirport1
LEFT JOIN 
  airports a2 ON a2.code = fly.codeAirport2
"
14347,MySQL Performance,"table    field    condition    row_count
----------------------------------------
table1   field1   cond_x       10
table1   field1   cond_y       20

select sum(row_count) as count_cond_xy 
from totals where field = field1 and `table` = table1 
and condition like 'cond_%';
//just a silly example you can come up with more efficient code, but I hope
//you get the gist of it.
"
2971,SQL count distinct,"SELECT COUNT(DISTINCT employeeid) FROM ....
"
11131,MySQL nested join with references to unnested table fields,"...
LEFT JOIN  parent  -- removed opening bracket
LEFT JOIN   child ON child.id = parent.childid
                 AND child.abc = first.abc 
                 AND parent.childid = in (0, child.Id) -- removed closing bracket and used 'IN'
...   
"
32624,Second SELECT query if first SELECT returns 0 rows,"SELECT * 
FROM proxies 
WHERE A='B'
UNION ALL
SELECT * 
FROM proxies 
WHERE A='C' AND NOT EXISTS (
    SELECT 1
    FROM proxies 
    WHERE A='B'
)
"
12587,get list of unavailable values from table using sql,";WITH CTE AS
(
    SELECT *
    FROM (  SELECT DISTINCT HID
            FROM YourTable) A
    CROSS JOIN (SELECT DISTINCT DEPT
                FROM YourTable) B
)
SELECT *
FROM CTE A
WHERE NOT EXISTS(SELECT 1 FROM YourTable
                 WHERE HID = A.HID AND DEPT = A.DEPT)
"
24785,sql How to get sum of a distinct values according to set of distincted condition query,"SELECT c1 as group1, SUM(c2) as group2 FROM table 
WHERE c3=""yes""
GROUP BY c1
"
25272,SQL select where matching record exists and no matching record,"SELECT 
  tb1.booking_ref, tb1.investor, tb2.cost 
FROM 
  tb1
      left join tb2 
          on tb1.booking_ref = tb2.booking_ref
              and tb1.investor = tb2.investor 
WHERE tb1.investor = ''12345''
"
5688,sql query to divide a value over different records," Select col1,( 
(Select sum(col2 )
   from tab
  where col1 =1000)
  /
  (Select count(*) 
   from tab
   where col1 =500))+Col2 as new_value 
 From tab
 Where col1=500
"
25692,SQL View: Comparing an initial table with a profiling table to return values not present in initial table,"SELECT r.RouteId,di.PatrolID,r.TagId
    FROM Routes r
    INNER JOIN (SELECT DISTINCT RouteId, PatrolID from DataImport) as di on di.RouteId = r.RouteId
EXCEPT
SELECT RouteId,PatrolID,TagId
FROM DataImport
"
34778,MySQL insert into table with a set of values,"INSERT IGNORE INTO customer_feature(customer_id, feature)
    select c.id, f.feature
    from customer c cross join
         (select 'NDA' as feature union all select 'SDM' union all select 'APM'
         ) f
    where c.edition = 'FREE_TRIAL';
"
8121,Can you store tables for reuse in a T-SQL statement?,"SELECT yourcols, ...
INTO #table
FROM yourtables...
"
530,Select All Columns From Table With 1 Distinct Column and a Where Condition,"SELECT b.* 
FROM yourTable b
INNER JOIN
  (SELECT MIN(VEH_ID) as minV,  GLASS_ID as g
   FROM yourTable
   GROUP BY GLASS_ID) as d
  ON b.Glass_ID = d.g and b.VEH_ID = d.minV
WHERE b.GLASS_ID LIKE  '%DB00%'
"
14673,SQL nested INNER JOIN Freezing PHPmyadmin panel,"SELECT pd.SoldierName, ks.Kills
FROM tbl_playerdata pd INNER JOIN (
    SELECT sp.PlayerId, SUM(ws.Kills) as Kills
    FROM tbl_weapons w 
    JOIN tbl_weapons_stats ws ON w.WeaponID = ws.WeaponID 
    JOIN tbl_server_player sp ON sp.StatsID = ws.StatsID
    WHERE w.Damagetype = ""sniperrifle""
    GROUP BY sp.PlayerID) ks
ON pd.PlayerID = ks.PlayerID
ORDER BY Kills DESC, SoldierName;
"
31128,SYS_CONNECT_BY_PATH and START WITH/CONNECT BY PostgreSQL Equivalent,"with recursive tree as (
  select wtn, 
         resp_tcsi as tcsi_codes
   from data
   where rn = 1 -- this is the ""start with"" part

   union all

   select ch.wtn, 
          p.tcsi_codes||','||ch.resp_tcsi 
   from data as ch
    join tree p 
      on ch.rn -1 = p.rn -- this is the ""connect by"" part
     and ch.wtn = p.wtn
)
select *
from tree;
"
39162,SQL - need a query to search messages by recipient,"    SELECT MT.ThreadId, U.userID, U.userFullName
      FROM MessageThreads MT 

INNER JOIN MessageThreadUsers MTCU on (MTCU.threadFK = MT.threadID)
INNER JOIN Users CU on (MTCU.userFK = CU.userID and CU.userID = 'usr_developer')

INNER JOIN MessageThreadUsers MTU on (MTU.threadFK = MT.threadID)
INNER JOIN Users U on (MTU.userFK = U.userID and U.userID <> 'usr_developer') 

     WHERE U.UserFullName like '%John%' -- Do your filters here
"
38419,character range including closing square bracket in PATINDEX,"SELECT CASE WHEN PATINDEX('%[([<{]%', column1) = 0
           THEN column1
       ELSE LEFT(column1, PATINDEX('%[([<{]%', column1))
             + 'XXXXX'
             + SUBSTRING(column1, ISNULL(NULLIF(PATINDEX('%[)>}]%', column1), 0), CHARINDEX(']', column1)), 1)
       END
FROM myTable
"
39563,How to merge 2 or more rows by ignore null values in sql,"SELECT MAX(col1), MAX(Col2), MAX(col3)
FROM mytable
"
9969,making trigger to prevent insert data,"<?php
$currentDate = '2016-2-12'; //date('Y-m-d');
$sql = 'SELECT * FROM booking WHERE date_IN >= '$currentDate' AND date_OUT <= '$currentDate' ';
?>
"
8008,Updating a friend list in my database,"$initial_list = array (1,2,3,4,5);
$list_after_edit = array (1,2,5,6);

$all_new_items = array_diff($list_after_edit,$initial_list);
foreach ($all_new_items as $item) {
    // Add to database this item
}

$all_deleted_items = array_diff($initial_list,$list_after_edit);
// Execute this query:
$query = 'DELETE FROM table WHERE `User Id` = <some ID> AND `Friend Id` in (' . implode(',',$all_deleted_items) . ')';
"
38609,MYSQL query involving 'not exists',"select *
from Student s1 
where not exists 
         (select 1 
          from Module 
          where Module_Code not in
                      (select Module_Code 
                       from Take_Exam 
                       where Student_No = s1.Student_No)
"
36694,Is it possible to update data inside a CLOB using SQL?,"SQL> select * from t42
  2  /

TXT
--------------------------------------------------------------------------------
<ABC> ABCD
  </ABC>


SQL>  update t42 set txt=replace(txt,'ABCD'||chr(10)||chr(13), 'APC woz here')
  2  /

1 row updated.

SQL> select * from t42
  2  /

TXT
--------------------------------------------------------------------------------
<ABC> APC woz here </ABC>

SQL>
"
19652,Setting the 'Order By' Clause from plsql procedure parameters,"select  *
from    YourTable
order by
        case when par_name = '1' then col1
             when par_name = '2' then col2
        end
,       case when par_name = '3' then col3
        end desc
"
2091,How to create a nested select query in sql,"SELECT `c`.`comment`, `c`.`user`, `m`.`avatar`
FROM `comments` `c`
LEFT JOIN `users` `u` ON `c`.`email` = `u`.`email`
LEFT JOIN `misc` `m` ON `m`.`userid` = `u`.`userid`;
"
30230,Total Sum of two columns and show in the third Column,"CREATE TABLE [dbo].[Test](
    [a] [INT] NULL,
    [b] [INT] NULL,
    [c]  AS ([a]+[b])
) ON [PRIMARY]

GO

INSERT INTO dbo.Test
        ( a, b )
VALUES  ( 1, -- a - int
          2  -- b - int
          )


SELECT * FROM dbo.Test 

Results:
a   b   c
1   2   3
"
2170,mysql find number of inner join whiteout relationship,"select count(*) from tableA left join tableB on idpoints = tableB.id where tableB.id is null
"
4667,phpMyAdmin - Replace every comma in a column with a dot,"update t
    set myColumn = replace(myColumn, ',', '.')
    where myColumn like '%,%'
"
5040,Oracle 11g rename. Guaranteed to be atomic?,"SQL>  rename old_table to something_else;
SQL>  rename new_table to old_table;
SQL>  drop table something_else;
"
27948,Retrieving newest item when using group by and where,"select *
from messages 
where to_id='9876'
  and date = (select max(date) from messages where to_id='9876')
"
33827,SQL join on multiple Rows to Single row,"with myphones
AS
(
    SELECT CustomerId, Phone1 As Phone FROM ContactDetails
    UNION
    SELECT CustomerId, Phone2 As Phone FROM ContactDetails
    UNION
    SELECT CustomerId, Phone3 As Phone FROM ContactDetails
    UNION
    SELECT CustomerId, Phone4 As Phone FROM ContactDetails
)
SELECT p.CustomerId, p.Phone, oc.*
FROM myphones p 
    INNER JOIN outboundcalls oc ON p.Phone = oc.Phone
"
14681,SQL many to many query returns false,"$query = ""
SELECT p.name AS project_name
, role.name AS role_name
FROM projects AS p
JOIN projects_users_roles AS a
   ON a.project_id = p.id
JOIN users_roles AS role
   ON role.id = a.role_id WHERE a.user_id = 23
"";
$result = mysql_query($query);
var_dump($result);
"
14732,select max(column) from table (column is varchar),"select max(cast(substring(my_id, 1, 6) as int)) from my_table
"
33817,Get MAX value based on specific field,"SELECT city, MAX(age)
FROM people
GROUP BY city
"
18952,SQL Server 2012 data conversion,"select 
    case yourfield
        when 'Operational' then 1
        when 'needs Repair' then 2
        .... and so on....
    end AS yourfield
from yourtable   
"
5364,MySQL LIKE x || y || z || etc. stops working after first ||,"SELECT username, email FROM users WHERE (username LIKE '%bla%' or username like '%bla2%' or username like '%bla3%') AND last_visit > '2013-05-15 00:00:00'"";
"
15399,How do I import a CSV file into SQL PLUS?,"declare
  procedure change_data(your_data_in_parameters) is
  begin
     set_of_our_commands_to_handle_one_record;
  end;
begin
    change_data(your_data_from_CSV_row1);
    change_data(your_data_from_CSV_row2);
    ...
    commit;
end;
"
27326,Create multi column view from single column data,"select EventID 
, min(P_Num) as P_Num1, min(PN_NameCount1)  PNC1, min(PN_Name) as PN_Name1
, max(P_Num) as P_Num2, max(PN_NameCount1)  PNC2, max(PN_Name) as PN_Name2 
from table 
group by EventID  
"
32142,SQL code does not work,"select c.name,a.adress,a.postcode_id from customer c left join Adress a on c.customer_id=a.customer_id where c.customer_id>11
"
9194,sorting a table according to the result of a stored procedure,"CREATE FUNCTION dbo.fnEmployee_score (@employeeId INT)
RETURNS INT
AS
BEGIN
    -- Your logic
    RETURN @score;
END
"
17664,Select max date that the value needs reference field in another table,"SELECT
 t_cluster.id,
 t_cluster.name,
 t_cluster.desc,
 t_logging_max.xd1
FROM
 t_cluster
 LEFT OUTER JOIN
 (
  SELECT id, MAX(xd1) AS xd1
  FROM t_logging
  GROUP BY id
 ) t_logging_max ON t_cluster.id = t_logging_max.id
WHERE 
 t_cluster.id LIKE '%73%';
"
347,SAS Dynamic SQL join,"proc sql;
create table want as select
*
from 
    a
  natural left join 
    b
  natural left join 
    c
;
quit;
"
33162,Return Max Dates from Multible Table Join,"SELECT
    c.cid,
    c.name,
    cv.service,
    max_date = CONVERT(VARCHAR(10), MAX(va.approved_on), 101)
FROM Client c
LEFT JOIN ClientVisit cv
    ON c.cid = cv.cid
    AND cv.service = 'Eval'
LEFT JOIN VisitApproval va
    ON va.vid = cv.vid
GROUP BY
    c.cid, c.name, cv.service
"
15975,Convert select query result to XML format in SQL Server,"select K.KeyWord as Result 
from ... as k
where ...
for xml path(''), root('Root'), binary base64
"
30006,"MySQL GROUP BY YEAR(), MONTH() returns dates sometimes at start of month, sometimes at end","SELECT MIN(datefield) first_day_of_month
FROM Calendar
GROUP BY YEAR(datefield), MONTH(datefield)
"
12014,SQL return the row ONLY with the later date,"SELECT *
FROM (
  SELECT user_id,
         school_id,
         row_number() over (partition by user_id order by graduation_date desc) position
  FROM user_school
) us,
[user] u
WHERE us.user_id = u.user_id
  AND position = 1 /* limits to highest graduation date */
"
16860,Mysql: WHERE statement that depends of the COUNT() of a column?,"SELECT DISTINCT cat_sub.*, COUNT(job.job_id) AS num_properties_which_meet_criteria
FROM cat_sub
LEFT JOIN job_cat USING (sc_id)
LEFT JOIN job USING (job_id)
WHERE job.village_id=2 
GROUP BY sc_id
HAVING COUNT(job.job_id) > 0
"
10152,Run SQL query with mimimum match criteria in sql server 2008,"Select * from TableName 
where ColumnName Like ('%'+Replace(@texttosearch,' ','%')+'%')
"
37968,Get values of one field on the basis of filter,"SELECT Name, SUM(Pay), SUM(CASE WHEN Status = 1 THEN Pay END)
FROM Table
GROUP BY Name
"
13338,Referencing to output table with specific fields,"SELECT O.OrderID, U.Name, O.Day 
FROM ORDERS as O
INNER JOIN Users as U
  ON O.UserID = U.ID
WHERE ORDER_ID = 123458
"
29970,Oracle Database SQL - Embedded selects,"select edit_mnemonic, claim_eid
from claim_line_edits cle join claim_line cl on cle.claim_line_iid = cl.claim_line_iid 
                          join claims c on cl.claim_iid = c.claim_iid
where last_analysis_date >= trunc(sysdate)
"
2497,multiple query with sqlite 2nd query gives only first result,"    SELECT tm.quantity, tm.materialTypeId , t.typeName
      FROM invTypeMaterials tm
INNER JOIN invTypes t ON t.TypeID = tm.materialTypeId
     WHERE tm.TypeID=12743 
"
15412,Writing string into table within procedure in DB2,"-- You can perform these 2 statements early in your procedure, no 
-- need to put this right at the time you're going to execute the
-- INSERT statement     
SET SQLCMDINS = 'INSERT INTO RESULTTBL(SQLC, RET) VALUES (?, ?)';
PREPARE myStmt FROM SQLCMDINS; 

<...other SP code...>
SET SQLC = 'SELECT COUNT(*) FROM SYSCAT.TABLES';
<...other SP code...>

SET retcode = SQLCODE;

EXECUTE myStmt USING SQLC, SQLCODE;
"
9918,Reading the number of rows inserted from another ongoing transaction,"SELECT COUNT(*) FROM Table2 WITH (NOLOCK);
"
31994,MySQL - Getting age and numbers of days between two dates,"SELECT a.user_id, b.last_name, b.first_name, c.birth_date, 
       FLOOR(DATEDIFF(CURRENT_DATE(), c.birth_date) / 365) age, 
       DATEDIFF(b.left_date, b.join_date) workDays
FROM users a
INNER JOIN users_signup b ON a.user_id a = b.user_id
INNER JOIN users_personal c ON a.user_id a = c.user_id
WHERE b.join_date >= '2013-01-01' AND b.join_date < '2014-01-01'
GROUP BY a.user_id
"
18448,Matching criteria for the below scenario,"    isnull(dx.DiagnosisCode,' ') = (
    CASE 
        WHEN rtrim(ltrim(ps.DiagnosisCode)) = ''
            THEN isnull(dx.DiagnosisCode,' ')
        ELSE ps.DiagnosisCode
        END
    ) 
"
22899,Creating a Table B which has only a subset of Table A attributes,"CREATE VIEW B AS (SELECT a,b,c FROM X)
"
17034,SQL to transpose row pairs to columns in MS ACCESS database,"TRANSFORM First([Text]) AS LangText
SELECT ID, First([Text])
FROM Table 
GROUP BY ID
PIVOT lang
"
39221,JOIN the same statement without WHERE clause,"Select 

(SELECT MAX(id) AS max from posts),

(SELECT 
MAX(id) AS old_max 

FROM posts WHERE time < 
    DATE_SUB(NOW(), INTERVAL 1 HOUR));
"
8210,Import multiple Excel files/sheets into SQL Table,"EXEC sp_addlinkedserver
    @server = 'ExcelServer1',
    @srvproduct = 'Excel',
    @provider = 'Microsoft.Jet.OLEDB.4.0',
    @datasrc = 'C:\Test\excel-sql-server.xls',
    @provstr = 'Excel 8.0;IMEX=1;HDR=YES;'

EXEC sp_dropserver
    @server = N'ExcelServer1',
    @droplogins='droplogins'
"
31199,How to combine two tables in Sql Server which contains different column names but holds similar information,"SELECT p_latitude latitude, p_longitude longitude, year
FROM T1
UNION ALL
SELECT latitude, longitude, p_year year
FROM T2
"
32473,Row not changes after I execute update command,"UPDATE EventsCnfig
SET InspectionId=33, Event=33
WHERE id=2; 
commit;
"
10182,Foreign keys in MySQL?,"CREATE TABLE `posts` (
`pID` bigint(20) NOT NULL auto_increment,
`content` text NOT NULL,
`time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
`uID` bigint(20) NOT NULL,
`wikiptr` bigint(20) default NULL,
`cID` bigint(20) NOT NULL,
PRIMARY KEY  (`pID`),
Foreign Key(`cID`) references categories(`cID`),
Foreign Key(`uID`) references users(`uID`)
) ENGINE=InnoDB;
"
14298,How do you do many to many table outer joins?,"SELECT * FROM foo
  LEFT OUTER JOIN (foo2bar JOIN bar ON (foo2bar.bid = bar.bid AND zid = 30))
  USING (fid);
"
14605,"""SELECT DISTINCT"" ignores different cases","Select distinct col1 COLLATE sql_latin1_general_cp1_cs_as
From dbo.myTable
"
10734,SQL query to get default values if translations are not found,"SELECT p.ID, p.Price,
      COALESCE(pt.Name, p.Name) Name, 
      COALESCE(pt.Description, p.Description) Description
FROM Product p
INNER JOIN User u on u.ID = @MyUserID
LEFT JOIN Product_Translations pt ON pt.PID = p.ID AND pt.LANG = u.LANG
"
37535,How query on some subdocument mongodb,"db.test.find({Items:{$elemMatch:{name:'Total'}}});
"
5819,I need help re-writing a SQL query into LINQ format,"var query = from g in db.Galleries
            join m in db.Media on g.GalleryID equals m.GalleryID
            where g.GalleryID == 150
            orderby m.MediaDate descending, m.MediaID descending
            select new { g.GalleryTitle, Media = m };
"
16695,Categories datatype,"UserID      FirstName       
1           Bob
2           John

HobbyID     HobbyName       
1           Golf
2           Photography     

UserHobbyID UserID  HobbyID 
1           1       1   
2           1       2
3           2       2
"
17226,How to insert blob using camel SQL component with Oracle Database,"Resource r = contex.getResource(""classpath:file/ciao.jpg"");
InputStream inputStream = r.getInputStream();
SqlLobValue blobVal = new SqlLobValue(inputStream, (int) r.getFile().length() );
SqlParameterValue blob = new SqlParameterValue(Types.BLOB,""BLOB"", blobVal );
aProducerTemplate.sendBody(new Object[] {""Mario"", ""Rossi"",blob} );
"
30341,How to insert a record in a table so that the string field with id?,"INSERT INTO GLOBAL_CONTACTS (Name,Title,Sector)
SELECT e.Name,e.Title,s.SectorID
FROM ExcelTable e
INNER JOIN Sectors s
ON e.Sector = s.SectorName
"
5416,DB2 to Oracle Conversion For Basic Date Time Column Between Clause,"SELECT *
FROM TABLE
WHERE DATE_TIME_COLUMN
BETWEEN
    TIMESTAMPADD(SQL_TSI_DAY, DayOfWeek(Current_Date)*(-1) + 1, Current_Date)
AND
    TIMESTAMPADD(SQL_TSI_DAY, 7 - DayOfWeek(Current_Date), Current_Date)
"
12679,Insert and update simultaneously,"insert into table (ColumnA, ColumnB)
select ColumnA, 'c'
from table
where columnA = 'a' and columnB = 'b'
"
9624,How to get maximum size used by a string in Hive?,"select max(length(mycolumn)) from mytable;
"
4382,Query for N most recent records by ChangeDate,"SELECT TOP 1000
    *
FROM 
    TABLE_NAME
ORDER BY 
    ChangeDate DESC
"
28251,Convert rfc3339 string to timestamp with timezone,"SELECT '2015-01-28T17:41:52Z'::timestamptz
"
31822,Make sql query run faster,"select MAX(CASE WHEN [Weight] > 0 THEN CurrentPrice ELSE NULL END) AS MaxExactPrice
,MIN(CASE WHEN [Weight] > 0 THEN CurrentPrice ELSE NULL END) AS MinExactPrice
,MAX(CASE WHEN [Weight] = 0 THEN CurrentPrice ELSE NULL END) AS MaxSimilarPrice
,MIN(CASE WHEN [Weight] = 0 THEN CurrentPrice ELSE NULL END) AS MinSimilarPrice
,COUNT(CASE WHEN [Weight] > 0 THEN 1 ELSE NULL END ) AS ExactCount
,COUNT(CASE WHEN [Weight] = 0 THEN 1 ELSE NULL END ) AS SimilarCount
,COUNT(*)AS TotalCount
from SomeTable where GroupingId = SomeBigIntId 
"
23930,Condition in WHERE clause,"WHERE suc.catID = @k1_catID
AND selectChildren = 1
AND (
(includeNullType = 0   
AND @k4_type IN (SELECT typeID FROM server_updates_types sut WHERE sut.sucID = suc.sucID))
OR
(includeNullType = 1 
    AND (@k4_type IN (SELECT typeID FROM server_updates_types sut WHERE sut.sucID = suc.sucID) OR @k4_type IS NULL))
)
"
975,Redis: Database Size to Memory Ratio?,"$ redis-cli info | grep used_memory_human
used_memory_human:1.36G

$ du -sh /mnt/data/redis/dump.rdb 
950M /mnt/data/redis/dump.rdb
"
14351,MySQL Join two lists to check if a record exist,"SELECT
  p.FullName,
  p.Email,
  IF(u.userid IS NULL, 'False', 'True') RegisteredInSystem,
  IF(r.registrationid IS NULL, 'False', 'True') RegisteredInEvent
FROM potentialusers p
LEFT JOIN users ON p.Email = u.useremail
LEFT JOIN registrations r ON r.userid = u.id AND r.eventid = 7
WHERE p.FullName LIKE '%jazerix%'
"
38227,Generating a Unique String  by UDFunction,"ALTER  TABLE TBL_iBATCH
   ADD BatchNumber AS CAST('B' + RIGHT('000000' + CAST(MyIDCol AS varchar(6)), 6) AS char(7)) PERSISTED;

ALTER  TABLE TBL_iBATCHWITH CHECK 
   ADD CONSTRAINT PK_TBL_iBATCH PRIMARY KEY (BatchNumber);
"
20770,SQL group by with multiple conditions,"SELECT yourtable.*
FROM
  yourtable INNER JOIN (
    SELECT   ip_address,
             MAX(CASE WHEN type='purchase' THEN id END) max_purchase,
             MAX(CASE WHEN type='visit' THEN id END) max_visit
    FROM     yourtable
    GROUP BY ip_address) m
  ON yourtable.id = COALESCE(max_purchase, max_visit)
"
14577,"""CASE WHEN"" operator in ""IN"" statement","where (T.[IS_PHYSICAL] = 1 and [client] in (2421, 2431)) or
      (T.[IS_PHYSICAL] = 0 and [client] in (2422, 2432))
"
10259,ANSI SQL question,"SELECT t.id
       , t.name
       , t.created_at
       , CASE WHEN t.parent_id > 0 THEN p.created_at ELSE NULL END AS parent_created_at 
FROM   Table t
JOIN   Table p
ON     t.id = p.parent_id
"
15323,dbcontext.savechanges always saves default Value,"[DatabaseGenerated(DatabaseGeneratedOption.Computed)] 
"
19577,MySQL - Interesting search I'm having issues with,"select email
from table t
group by email
having sum(type = 1) = 0 and
       sum(eventdate <> '0000-00-00') > 0;
"
22241,How do I get the month and day with leading 0's in SQL? (e.g. 9 => 09),"DECLARE @day CHAR(2)

SET @day = RIGHT('00' + CONVERT(NVARCHAR(2), DATEPART(DAY, GETDATE())), 2)

print @day
"
25015,Select entries filtering rows with same field by lowest second_field,"SELECT id, flag, price
FROM tbl t
WHERE NOT EXISTS (
  SELECT 1
  FROM tbl tt
  WHERE t.flag = tt.flag
    AND (tt.price < t.price 
         OR (tt.price = t.price AND t.id < tt.id)));
"
24657,Count minutes between first and last tuple and group by username,"with t as
(
   select username, ""date"", to_date(""date""||time, 'YYYY-MM-DDHH24:MI:SS') dt
   from your_table 
)
select username, ""date"",  (max(dt)- min(dt)) * 1440
from t
group by username, ""date""
"
15027,SQL Server + 'Merging results',"   SELECT userid, vehicleId, SUM(SearchCount) As SearchCount
FROM
(SELECT userid, vehicleId, count(vehicleId) As SearchCount FROM MemberSearches 
GROUP BY userid, vehicleId 
UNION ALL
SELECT f.UserId, v.AutoId AS VehicleId, count(v.AutoId) AS SearchCount FROM Favorites f
LEFT JOIN [SellPost] sp
ON (f.PostId = sp.AutoId)
LEFT JOIN [Vehicle] v
ON (sp.CarId = v.AutoId)
GROUP BY f.UserId, v.AutoId
) t
GROUP BY userid, vehicleId
"
10767,How to treat MAX() of empty table as 0 instead of NULL,"SELECT COALESCE(MAX(cid), 0)
FROM   itemconfiguration
"
21357,MySQL search algorithm for best match,"select *  from department  where Name like ""%Samsung"" or (Name like ""%Tv%"" and Name like ""%Samsung%"") UNION select  from department  where Name like ""%tv"" or (Name like ""%Samsung%"" and Name like ""%TV%"")
"
2290,Why doesn't this query run?,"SELECT fOpen.*, fClose.*
FROM (
  SELECT MIN(id) AS min_id, MAX(id) AS max_id
  FROM fixtures
  GROUP BY matchId, period, type
) ids
JOIN fixtures fOpen  ON ( fOpen.id  = ids.min_id )
JOIN fixtures fClose ON ( fClose.id = ids.max_id );
"
10721,"SQL case when using IN clause, clean way?","where 
(@PartStockID = '' OR PartStockID in (SELECT ID FROM dbo.Split_List_Int(@PartStockID)) OR PMS_PartStock.PartStockID = PMS_PartStock.PartStockID )
"
10089,conditional ordering by two fields,"SELECT *
FROM PENDIENTESCOBRO
ORDER BY
  CASE WHEN NPENDIENTE>0 THEN 1 ELSE NPENDIENTE END ASC,
  DFECHA
"
28450,User-specific database records,"WHERE User_ID = @User_ID 
"
6278,SQL Server: how to return 1 row as default if condition not met,"SELECT
    ISNULL(fr.message, en.message) AS message
FROM message_table en
LEFT JOIN message_table fr ON
    fr.message_id = en.message_id
    AND fr.language = 'French'
WHERE 
    en.message_id = 17
    AND en.language = 'English'
"
13499,SQL time stamp to millisecond,"Dim milliseconds As Double
milliseconds = (end - start).TotalMilliseconds
"
1619,Update mysql id column according to timestamp column,"UPDATE table_name a,(SELECT id,(@newid:=@newid+1) AS d FROM table_name,(SELECT @newid:=0) AS f ORDER BY stamp) AS g SET a.id = g.d WHERE a.id = g.id;
"
31582,JOIN SQL function results with multiple WHERE from one table,"SELECT A, B, SUM(C),
       avg(case when C = 1 then D end)
FROM Table
GROUP BY A, B
"
31285,Joining two relations with default values,"SELECT v1.obj, NVL(v2.attribute, 0)
FROM view1 v1
LEFT JOIN view2 v2 on v1.obj = v2.obj
"
1411,Merb & DataMapper - accessing database connection info?,"desc ""outputs database connection parameters""
task :db_conn => :merb_env do |t|
  puts ""Username: #{DataMapper.repository.adapter.uri.user}""
  puts ""Password: #{DataMapper.repository.adapter.uri.password}""
  puts ""Database: #{DataMapper.repository.adapter.uri.path.split('/').last}""
end
"
8781,Assign values from a column to another column in the correspondent row,"update your_table
set column1 = column1 || column2
"
539,sql ORDER BY multiple values in specific order?,"...
WHERE
   x_field IN ('f', 'p', 'i', 'a') ...
ORDER BY
   CASE x_field
      WHEN 'f' THEN 1
      WHEN 'p' THEN 2
      WHEN 'i' THEN 3
      WHEN 'a' THEN 4
      ELSE 5 --needed only is no IN clause above. eg when = 'b'
   END, id
"
6031,Select * from table where id = ? and order by priority,"SELECT id,name,priority from table_name WHERE id=13 ORDER BY priority ASC;
"
3523,How to count results when using inner joins,"SELECT branch.bid, branch.bAddress.street as Street, 
branch.bAddress.city as City, branch.bAddress.postcode as Postcode,   
count(account.*) as savings_count
FROM Account
INNER JOIN branch
ON Account.bID=branch.bID where accType='savings'
group by branch.bid, branch.bAddress.street, 
branch.bAddress.city, branch.bAddress.postcode;
"
8593,oracle sql to group specific coulmn based on some other coulmn,"insert into FINAL_TABLE   (EVENT_ID,  OID,  LINE_NUMBER)
  (
    select EVENT_ID,OID,
       ROW_NUMBER() OVER(PARTITION BY EVENT_ID ORDER BY OID) as LINE_NUMBER
    from source_table
  );
"
36569,SQL best way to subtract a value of the previous row in the query?,"SELECT SUM(a.StartTime - a.LagEnd) as LostTime 
FROM (SELECT [PlantID], [StartTime], [EndTime], 
             LAG([PlantID]) OVER (ORDER BY PlantID, StartTime) LagPlantID,
             LAG([EndTime]) OVER (ORDER BY PlantID, StartTime) LagEnd 
      FROM MachineRecords) a 
WHERE a.PlantID = a.LagPlantID
"
28176,MySQL producer consumer with multiple select threads,"BEGIN 
SELECT * FROM Jobs WHERE JobID = (SELECT * FROM Jobs WHERE completed = 0 LIMIT 1) LOCK IN SHARE MODE;
UPDATE Jobs SET completed = 1 WHERE JobID = (PREVIOUS ID); 
COMMIT;
"
14852,PostgreSQL: How to group similar data into one column,"WITH cte AS (
  SELECT id_order,ppu_cur curr,amount*ppu price FROM orderitems  -- amount*ppu
  UNION ALL
  SELECT id_order,""costsA_cur"",""costsA"" FROM orderitems          -- costsA
  UNION ALL
  SELECT id_order,""costsB_cur"",""costsB"" FROM orderitems          -- costsB
)
SELECT id_order,curr,SUM(price)
FROM cte
WHERE curr IS NOT NULL AND price<>0
GROUP BY id_order,curr
"
35300,SQL how to replace all (Varied) texts in a text column with a single default text?,"Update statement
Update `table_name`
Set `field_name` = '{""notifyEmailSystem"":1,""privacyProfileView"":0,""privacyPhotoView"":0,""privacyFriendsView"":0,""privacyGroupsView"":"""",""privacyVideoView"":0,""notifyEmailMessage"":1,""notifyEmailApps"":1,""notifyWallComment"":0}'
"
39058,"How to writer the condition A or B is zero , but not both is zero in MYSQL?","SELECT * FROM TABLE WHERE A = 0 XOR B = 0
"
18967,Left join that is not showing all left table values,"SELECT places.placeId,
       placeName,
       COUNT(orderId) AS orderCount
FROM   places
       LEFT JOIN orders
         ON places.placeId = orders.placeId
       AND orders.stateId = 1
       AND orders.orderstateId = 1
       AND orders.orderName NOT LIKE 'Delivery%'
WHERE  places.companyId = 1
GROUP  BY places.placeId,
          places.placeName
ORDER  BY orderCount DESC,
          placeName ASC 
"
1866,"Sub Query - Return NULL, if it does not match the highest","declare @name varchar(50)

select @name = name
from   (
       select  row_number() over (order by CBALANCE desc) rn
       ,       name
       from    acct_mstr
       ) as SubQueryAlias
where  rn = 15

-- Return a rowset of one row, even if no row matched
-- the where clause above
select  @name as name
"
9744,More than one join MYSQL?,"SELECT *
FROM sub_menu
LEFT JOIN root_sub ON sub_menu.id = root_sub.sub_id
LEFT JOIN root_menu ON root_sub.root_id = root_menu.id   
"
30275,SQL server 2005 showing unique values and not showing anything duplicating,"SELECT SerialNumber, ModelNumber, Date, CustomerName
FROM (SELECT pft.*,
             count(*) over (partition by SerialNumber) as cnt
      FROM PreQcFormTable pft
      WHERE Date BETWEEN '2014-02-14' AND '2014-03-05' AND
            ProductOrigin = 'P'
     ) t
WHERE cnt = 1 AND
      FailCodes = '';
"
12205,PLSQL: Possible to use BOOLEAN datatype in SQLPLUS?,"DECLARE
  l_some_bool BOOLEAN := true;
BEGIN
  IF( l_some_bool )
  THEN
    dbms_output.put_line( 'true' );
  END IF;
END;
"
23299,Limiting variable names in sql scripts,"define user=&1
spool /some/directory/&user._script.log
"
28793,Select First Row of every MRN,"SELECT MRN, VISIT_NUMBER, EVENT_TIME
FROM (SELECT OH.MRN, OH.VISIT_NUMBER, OH.EVENT_TIME,
             ROW_NUMBER() OVER (PARTITION BY OH.MRN ORDER BY OH.EVENT_TIME) AS SEQNUM
      FROM ONCOLOGY_HISTROY_MV OH
      WHERE OH.PROC = 'BC - Heamatology-Oncology Appt'
     ) OH
WHERE SEQNUM = 1
ORDER BY EVENT_TIME ASC;
"
14113,Distinct SQL selection with percentage condition,"SELECT DISTINCT partner, portal from (
    SELECT partner, portal, sum(case when location_quality > 50 then 1 else null end) as cnt_greater_50, CAST(count(*) AS FLOAT) as total_cnt
    FROM tb
    GROUP BY partner, portal
) WHERE cnt_greater_50/total_cnt > 0.9
"
19830,maintain history in a database,"* DateCreated – the actual date on which the given row was inserted.
* DateEffective – the date on which the given row became effective.
* DateEnd – the date on which the given row ceased to be effective.
* DateReplaced – the date on which the given row was replaced by another row.
* OperatorCode – the unique identifier of the person (or system) that created the row.
"
33377,SQL Triggers in Oracle,"create or replace trigger audit_a_trg 
    before insert or update or delete on A
    for each row
begin
    insert into b values (user);
end;
/
"
29796,COUNT(*) returning false results when no applicable rows,"SELECT *, COUNT(iup.user_id) AS user_plans_count
FROM #__iop_user_plans iup
INNER JOIN #__iop_plan ip ON iup.iop_id = ip.id
WHERE `iup`.`state` = 1 AND `iup`.`user_id` IS NOT NULL 
AND `iup`.`accepted` = 0 
HAVING user_plans_count>0
"
27765,Convert SQL to LINQ to Entities WHERE IN clause,"(from d in db.Departments
 join e in db.Employees
     on d.DepartmentID equals e.DepartmentID
 where e.FirstName.Contains(""FirstName"") ||
       e.LastName.Contains(""LastName"")
 select t).Distinct()
"
10199,"Join two tables using a condition on time, sql","...
ON addtime(retailer.time, '0:0:4')<imovo.time
AND retailer.time >imovo.time
"
16940,Extracting MySQL backup file,"-- MySQL dump 10.13  Distrib 5.5.14, for osx10.6 (i386)
--
-- Host: huey    Database: test
-- ------------------------------------------------------
-- Server version   5.5.31-30.3-log
"
21677,database design for dictionary application,"ENGLISH
ID | WORD
1  | 'dictionary'

GERMAN
ID | WORD
1  | 'lexikon'
2  | 'wörterbuch'

TRANSLATION_EN_DE
ID_EN | ID_DE
1     | 1
1     | 2
"
23405,"How do I create a ""filter by price"" type of query?","select  sum(case when Price >= 50 and Price < 100 then 1 else 0 end) as 50to100,
        sum(case when Price >= 100 and Price < 500 then 1 else 0 end) as 100to500,
        sum(case when Price >= 500 and Price < 1000 then 1 else 0 end) as 500to1000
from    Products
"
3414,read a tag from a string in XML format,"val xmltype; 
host VARCHAR2;

val := xmltype(varchar2_val); 
host := val.extract('/host/text()').getStringVal()
"
15686,Codeigniter - get related entries,"SELECT
    table1.*,
    GROUP_CONCAT(table2.image_name SEPARATOR ', ') as image_name
FROM table1
LEFT JOIN table2
ON table1.id = table2.user_id
GROUP BY table1.id;
"
6049,SQL update column twice,"UPDATE Tab1 
    SET Tab1.Col1 =  REPLACE(REPLACE( Tab1.Col1, '&', ''), '%', '') 
    FROM Table1 Tab1 
    WHERE Tab1.Col1 like '%[&]%' OR Tab1.Col1 like '%[%]%'
"
15881,Need sql query,"select s.title, s.serial, e.count
from shows s, (select showId, count(*) as count 
                from episodes 
                where airDate <= current_timestamp
                group by showId) e
where s.showId == e.showId
"
11575,How to substract some hours from a date with MM/DD/YYYY HH:MM format?,"=DateAdd(""h"", -6, [minuen date])
"
31705,database design issue when adding new columns to table from application,"CREATE TABLE ClientCharges
(
    ClientChargeId          INT IDENTITY(1,1)
    , ClientId              INT 
    , ChargeId              INT
)


INSERT INTO ClientCharges
(ClientId, ChargeId)
VALUES
(1, 1),
(1,2),
(1,3),
(1,4),
(2,1),
(3,1),
(3,2),
(4,3),
(4,4)
"
14574,Microsoft access Query design,"SELECT *
FROM item i
INNER JOIN
  (SELECT itemno,
          Sum(qtyordered)
   FROM delivereditem
   GROUP BY itemno) d ON d.itemno = i.itemno
INNER JOIN
  (SELECT itemno,
          Sum(qtyissued)
   FROM itemissued
   GROUP BY itemno) iss ON iss.itemno = i.itemno
"
23937,SQLPlus settings to generate tab-separated data file,"select chr(9) from dual;
"
36745,Help with a WHERE on a LEFT JOIN SQL Query,"SELECT Documents.name, HasDownloaded.id FROM Documents
LEFT JOIN HasDownloaded ON HasDownloaded.documentID = Documents.id 
  AND HasDownloaded.memberID = @memberID
"
36591,How can I create a new temp table for each day given in a range?,"DECLARE @From DATE = '2015-06-08' 
DECLARE @To   DATE = '2015-06-29'

SELECT Dates 
FROM 
  (
    SELECT TOP  (DATEDIFF(DAY,@From , @To))
      DATEADD(DAY , 
                  ROW_NUMBER() OVER (ORDER BY (SELECT NULL))
                ,@To) AS Dates
   FROM master..spt_values
  )Dates_Table
"
16650,SQL Grouping by Ranges,"select group, sum(value)
from (select t.*,
             (row_number() over (order by timestamp) -
              row_number() over (partition by group order by timestamp)
             ) as grp
      from my_table t
     ) t
group by group, grp
order by min(timestamp);
"
16507,SQL: Verify if date is between two dates,"SELECT Row WHERE MONTH(Orderdate) BETWEEN 1 AND 8
"
36860,mysql query confusion using in and natural join quantity,"SELECT *
FROM   person
  JOIN invited   USING (pid)
  JOIN event     USING (pid, eid)
  JOIN friend_of   ON  friend_of.sharer = invited.pid
WHERE  friend_of.viewer = 'AA'
"
6570,SQL create query based on data from multiple tables,"SELECT s.ID, u.NickName1 As UserID, c.NickName1 As ClientID, t.NickName1 As TimeID
FROM Slips s
LEFT JOIN Username u ON u.ID = s.UserID
LEFT JOIN ClientNames c ON c.ID = s.ClientID
LEFT JOIN TimeactNames t on t.ID = s.TimeID
"
24177,How to sort a table using order by clause in desc order using difference in value of two other columns,"select *, like-unlike as customOrder from table order by customOrder desc;
"
24062,How can I tell Oracle that if the output is a single digit then put a space before it?,"lpad (to_char(myArray(i).myValue), 2, ' ')
"
16074,Query for a non existing key in a big scale mongoDB database,"db.foo.find()._addSpecial( ""$maxScan"" , 50 )
"
3222,ON DUPLICATE KEY UPDATE every column except,"INSERT INTO the_table (col1,col2,...,datetime_inserted) VALUES(value1,value2,...,NOW())
ON DUPLICATE KEY UPDATE SET col1=VALUES(col1), col2=VALUES(col2), ... #skip the datetime_inserted for the updates
"
37205,"PHP mysql update multiple row by single query SET='101' where id =1,2,3,7,9","update table_name SET field_name='101'
where id IN(1,2,7,9) 
"
30747,PowerBuilder 12.5 tutorials,"// Profile CINEMA3
SQLCA.DBMS = ""ODBC""
SQLCA.AutoCommit = False
SQLCA.DBParm = ""ConnectString='DSN=cinema;UID=UserName;PWD=SuperSecurePassword'""
"
33747,SQL SERVER MAX Date in SUM of Values,"SELECT MAX(Date), SUM(Value)
FROM MyTable
WHERE Date BETWEEN '2014-01-01' AND '2014-08-15';
"
18718,MS Access: run a query in a subform,"Private Sub button_click()
    Me.PUT_SUBFORM_NAME_HERE.Form.Requery
End sub
"
18288,Simple DB design question -- sets of measurements,"create table Measurement(
    int  MeasurementId  not null  auto_increment,
    primary key(id)
);

create table MeasurementData(
    int  MeasurementId  not null,
    int  MeasurementDataEntry  not null,
    double  value  not null,
    primary key(MeasurementId, MeasurementDataEntry),
    constraint fk_data foreign key(MeasurementId) references Measurement(MeasurementId)
)
"
29435,Truncating timestamps,"SQL> select to_timestamp_tz(to_char(timestamp '2011-02-24 08:30:42 +06:00', 'YYYY-MM-DD HH24 TZH:TZM'), 'YYYY-MM-DD HH24 TZH:TZM') from dual;

TO_TIMESTAMP_TZ(TO_CHAR(TIMESTAMP'2011-02-2408:30:42+06:00','YYYY-MM-DDTZH:
---------------------------------------------------------------------------
24.02.2011 8:00:00,000000000 +06:00
"
9939,How to extract a particular number from a long string of data using Oracle SQL?,"SELECT TO_NUMBER(
         REGEXP_SUBSTR(
           column_name,
           '<strong>Identification Number</strong>:.*?(\d+).*?<br />',
           1,
           1,
           NULL,
           1
         )
       ) AS id_number
FROM   table_name;
"
29032,sp_MSForEachDB doesn't seem to like GO,"exec sp_MSForEachDB
'
    IF ''?'' LIKE ''MYDBNames%''
    BEGIN
    Use [?]
    EXEC(''
        CREATE USER [MYDOMAIN\Analysts] FOR LOGIN [MYDOMAIN\Analysts]
        '')
    EXEC('' EXEC sp_addrolemember N''''db_owner'''', N''''MYDOMAIN\Analysts'''' '')
    END
'
"
1944,Return all null values between two dates,"select cust_first_name
from customers
WHERE customers.customer_id NOT IN (
  SELECT orders.customer_id from orders
  where order_date between (to_date('01-01-2007','DD-MM-YYYY'))
                       and (to_date('31-12-2008','DD-MM-YYYY'))
)
"
23191,Select records newer than a specified date,"SELECT *
FROM human
WHERE bornOnUtc >= '2013-01-01 00:00:00'
"
37299,Convert Decimal values(hours) to Appropriate Hours in sql server 2008,"select 
time_decimal
,cast(cast(cast(time_decimal as int) as varchar)+
':'+cast(cast((time_decimal - cast(time_decimal as int)) * 60 as int) as varchar)+
':'+cast(cast(((time_decimal - cast(time_decimal as int)) * 60-
    cast((time_decimal - cast(time_decimal as int)) * 60 as int)) * 60 as int) as varchar) as time) as real_time
from time1
"
18399,How to get time from db depending upon conditions,"select case 
        when TIMESTAMPDIFF(SECOND, `date`,current_timestamp) <= 60 
        then concat(TIMESTAMPDIFF(SECOND, `date`,current_timestamp), ' seconds')
        when TIMESTAMPDIFF(DAY, `date`,current_timestamp) <= 3 
        and TIMESTAMPDIFF(DAY, `date`,current_timestamp) >= 1 
        ...
       end as time_diff 
from Table_hello
where TIMESTAMPDIFF(DAY, `time`,current_timestamp) >= 3 
"
38043,Coordinates conversion,"ST_Transform(the_geom,4326)
"
5224,Implementing database search through query using like,"CREATE TABLE OriginalTable (
  original_id SERIAL PRIMARY KEY,
  author_id INT,
  author_date DATETIME,
  summary TEXT,
  body TEXT
) ENGINE=InnoDB;

CREATE TABLE SearchTable (
  original_id BIGINT UNSIGNED PRIMARY KEY, -- not auto-increment
  -- author_id INT,
  -- author_date DATETIME,
  summary TEXT,
  body TEXT,
  FULLTEXT KEY (summary, body)
) ENGINE=MyISAM;
"
16568,Get timeslots from database,"DECLARE @Start DATETIME = DATEADD(Hour, DATEDIFF(Hour, 0, GETDATE()), 0)
DECLARE @End DATETIME = DATEADD(Hour, 2, @Start)

SELECT dbo.Computer.ComputerName, dbo.Planned.DatePlanned
FROM dbo.Computer 
    INNER JOIN dbo.Planned ON 
        dbo.Computer.ComputerID = dbo.Planned.ComputerID
WHERE dbo.Planned.DatePlanned 
BETWEEN @Start AND @End
"
19444,Getting the website fill-in form data to spreadsheat or database,"<?php
   $fp = fopen('data.txt', 'a'); //append, instead of override
   fwrite($fp, 'formData');
   fclose($fp);
?>
"
23087,Populating SQLiteDB with initial values,"INSERT INTO mytable (column_a, column_b)
VALUES (val_1, val2), (val_3, val_4), etc
"
16946,Optional Reporting Parameters (is there a better way?),"WHERE 
  col1 = isnull(@col1, col1) 
  and col2 = isnull(@col2, col2)
  ...etc
"
23494,Insert when does not exist but update on a condition if it does,"insert into mytable(EmpId, EmpName, Salary, Version)
    values ($EmpId, $EmpName, $Salary, $Version)
    on duplicate key update
        EmpName = (case when Version > 20 then Values(EmpName) else EmpName end),
        Salary = (case when Version > 20 then Values(Salary) else Salary end);
"
38463,How to Build Dynamic SQl for this?,"select
'UPDATE  mt
SET ' + ID_F + ' = ac.' + ID_F + '
FROM Ms.AT.AT_CRAW t
INNER JOIN ' + M_Type + ' ac ON t.' + SF1 + '=SV1
AND ac.ID = 1
INNER JOIN Ms.AT.AT_CRAW_Dmtemp mt 
ON mt.[SRID] = t.[RID]' as SQL
from Col.TMap.T_Mp
"
21958,Declare scalar variable SQL,"DECLARE @sql varchar(MAX);

SET @sql = '
UPDATE dbo.ex_in
SET    int_action = CASE WHEN int_action = 120 THEN 110 
                         WHEN int_action = 220 THEN 210 
                         ELSE int_action 
                    END;
WHERE  int_action IN (120,220)
       AND int_guid IN (' + @listStr + ')
';

EXEC @sql;
"
20130,Counting distinct undirected edges in a directed graph in SQL,"select count(*) from (
  select to_there from edges where from_here = 1
  union
  select from_here from edges where to_there = 1
) as whatever
"
12045,Get month name from php timestamp,"MONTHNAME(FROM_UNIXTIME(comp_date)) = '$month'
"
14159,Select mysql rows where there exist 2 different values for same condition,"SELECT first_value
from Table1
where second_value in (1,2)
group by first_value
having count(*) =2
"
9236,Mysql join order by,"SELECT u.*
FROM user_prefs u
   JOIN categories cat ON u.category_id = cat.category_id
WHERE p.user_id = 10 /* Put user id here*/
ORDER BY cat.name
"
37463,Add key/value metas to sql query as columns,"SELECT c.*,
       MAX(CASE WHEN m.meta_name = 'email' THEN m.metavalue END) as email,
       MAX(CASE WHEN m.meta_name = 'origin' THEN m.metavalue END) as email,
       MAX(CASE WHEN m.meta_name = 'recommendation' THEN m.metavalue END) as recommendation,
       MAX(CASE WHEN m.meta_name = 'avatar' THEN m.metavalue END) as avatar
FROM molly_contents c left join
     molly_content_meta m
     ON c.content_id = m.meta_content_id
GROUP BY c.content_id;
"
4987,MySQL multi table join query,"SELECT first_name, last_name, car_rego
FROM   staff
JOIN   carallocation ON (carallocation.staff_id = staff.staff_id)
JOIN   car ON (car.car_id = carallocation.car_id)
WHERE  staff.office = 'Glasgow' OR staff.office = 'Bearsden';
"
23307,Join two tables with not exactly matching dates in sql,"select endOfMonth.*, begOfMonth.* 
from endOfMonth join begOfMonth 
on DATEADD (dd , 1 , endOfMonth.date ) = begOfMonth.Date
"
17962,returning multiple rows from a subquery?,"WHERE 
    posts.station_id IN 
        ( SELECT station_id FROM upd8r_stations WHERE owner_id =  '12' ) 
"
2712,Calculating the average of 2 columns and writing the result in an existing column,"SELECT GemetenDe1, GemetenDe2, (GemetenDe1+GemetenDe2)/2 AS GementenDeAvg
FROM MyTableName
"
37981,Is my solution to this SQL query correct?,"SELECT S.SNumber, S.Surame,
       COUNT(E.Student) AS NumberOfExamsPassed,
       COUNT(DISTINCT E.Grade) AS NumberOfDifferentPassGrades,
       MIN(E.Grade) AS MinimumGrade,
       MAX(E.Grade) AS MaximumGrade,
       AVG(E.Grade) AS AverageGrade
FROM Students S
INNER JOIN EXAMS E ON S.SNumber = E.Student
GROUP BY E.Student;
"
38387,How to query items with identical set of values,"select c_1
from t
where c_1 != 'A'
group by c_1
having collect(c_2) = (select collect(c_2) from t where c_1 = 'A' group by c_1)
/
"
16777,Return distinct on a table,"    SELECT p.ProductID, p.Title, MAX(pi.FileName) as FileName
      FROM [Ordering].[Products] p
INNER JOIN [Ordering].[ProductImages] pi ON p.ProductID =pi.FK_ProductID 
     WHERE p.Title like '%' + @Title +'%'
  GROUP BY p.ProductID, p.Title
  ORDER BY p.Title ASC
"
25855,Where not equal to substrings array,"select g.*
from cmdr_group g
where not exists (select 1
                  from groupuser gu
                  where gu.userID = 90792652 and
                        gu.groupId = g.Id
                 );
"
29440,Display only rows that do not match the control table,"select t1.*
from table1 t1
where NOT EXISTS (select 1 from ControlTable ct
                  where t1.Source_DB = ct.DB_NM
                    and t1.Source_TBL = ct.Source_TBL
                    ...
                    and ct.INCLUDE_FLAG = 'N')
"
5702,transform sql rows to column,"Select DateDiff(minute,StartWork.datacreated,EndWork.datacreated)
from 
(Select datacreated,LineNb=row_number() over(Order by datacreated) from Table where eventdata.value('(/data/status/text())[1]','varchar(15)')='StartWork') StartWork
INNER JOIN 
(Select datacreated,LineNb=row_number() over(Order by datacreated) from Table where eventdata.value('(/data/status/text())[1]','varchar(15)')='EndWork') EndWork
ON StartWork.LineNb=EndWork.LineNb
"
11730,Hive date format handling," select unix_timestamp(REGEXP_REPLACE('MON 2014-01-03 13:00:00 +GMT0000','GMT',''),
                      ""EEE yyyy-MM-dd HH:mm:ss Z"") as unixtime from reqtable;
"
35879,how to fetch and delete old duplicate records from table in sql,"DELETE FROM tmp_dib A WHERE ROWID <
(SELECT max(ROWID) FROM tmp_dib b WHERE A.ID=b.ID);
"
232,How to use login info from one site to log in to another on a different server,"action=""Enter site name here.com""
"
33101,How to group by week?,"select  datepart(wk, DateCreated)
,       sum(UserHits)
from    UserData
group by
        datepart(wk, DateCreated)
"
18050,LIKE in dynamic queries,"DECLARE @query nvarchar(2000),
        @paramList nvarchar(2000)

SET @query = 'SELECT * FROM dbo.Orders WHERE custLastName LIKE ''%'' + @custLastName + ''%'''
SET @paramList = '@custLastName varchar(30)'

EXEC SP_EXECUTESQL @query, @paramList, @custLastName
"
27815,SQL: Determine the record count for 2 separate filter conditions in the execution of only 1 query,"select (case when sum(case when AUTHOR = 'John Snow' then 1 else 0 end) > 0
             then 1
             else 0
        end) as AuthoredByJohnSnow,
       (case when sum(case when AUTHOR = 'John Snow' and Name like 'T%' then 1 else 0 end) > 0
             then 1
             else 0
        end) as AuthoredByJohnSnowBookT
from Book
"
9270,Oracle object types & object tables,"select ot.table_name, tt.type_name
  from (
select t.type_name,
       connect_by_root t.supertype_name rkey
  from user_types t
connect by prior t.type_name = t.supertype_name ) tt,
       user_object_tables ot
       where ot.table_type = tt.type_name or ot.table_type = rkey
"
18843,SQL Left Outer Join with a One to Many Row,"select ac.*, lasttrans.*
from Account ac 
left join (select acc_id, max(id) as id from Transaction group by acc_id) transmax 
     on ac.id = transmax.acc_id
left join Transaction lasttrans on lasttrans.id = transmax.id
"
15336,Set default value of an integer column SQLite,"db.execSQL(""CREATE TABLE "" + DATABASE_TABLE + "" ("" 
    + KEY_ROWID + "" INTEGER PRIMARY KEY AUTOINCREMENT, ""
    + KEY_NAME + "" TEXT NOT NULL, ""
    + KEY_WORKED + "" INTEGER, ""
    + KEY_NOTE + "" INTEGER DEFAULT 0);"");
"
16999,SQLite Format Seconds,"> SELECT time(120, 'unixepoch');
00:02:00
"
28181,sas conditional sum into new field,"proc sort data = orig_data(drop = Other_field);
by salesman_id day_id;
run;

data test (drop = total);
  retain salesman_id day_id;
    set orig_data ;
  by salesman_id day_id notsorted;

  if first.day_id then sum = total;
  else sum + total;

  if last.day_id then output;

run;

proc transpose data = test out = t(drop=_:) prefix = day_id_;
by salesman_id;
id day_id;
var sum;
run;
"
28593,Quickblox API group_by query on CustomObject,"NSMutableDictionary *getRequest = [NSMutableDictionary dictionary];
[getRequest setObject:@""user_id"" forKey:@""group_by""];
[getRequest setObject:@""max"" forKey:@""created_at[calc]""];

[QBCustomObjects objectsWithClassName:@""MyClass"" extendedRequest:getRequest delegate:self];
"
7704,Select random record from mnesia,"random_value(Table) ->
    Keys = mnesia:dirty_all_keys(Table),
    Key = lists:nth(random:uniform(length(Keys)), Keys),
    [#record{x = X}] = mnesia:dirty_read({Table, Key}),
    X.
"
3137,Replace id with string in SQL view,"SELECT t1.groupid, t1.membership_list, t2.username
FROM table1 t1
INNER JOIN table2 t2 ON t1.managerid = t2.userid
"
7335,Select data from 2 Field and use only 1 values,"select nvl(col1,col2) from table1
"
16745,What is the best way to store simple spatial data,"x BETWEEN a AND b AND y BETWEEN c AND d
"
21150,Sql query a word inside field,"select *
from table
where willingness like '%shopping%'
"
21227,Creating an HTML table string in SQL from a result with gap values,"select 
    rownumber
,   col0 = max(case when columnindex = 0 then StartTime end)
,   col1 = max(case when columnindex = 1 then StartTime end)
,   col2 = max(case when columnindex = 2 then StartTime end)
from (
   -- your previous query with the rownumber and columnindex
) x
group by rownumber
"
37907,Design dababase where every user has a list of favorites,"user_id
comment_id
"
30782,using SQL case statement to find all the values that have a 'B' then keep all the numbers in front of the 'B',"select t1.ShipmentNumber, max(t1.COST) + coalesce(sum(t2.COST)), t1.trackingnumber
from t t1 left join
     t t2
     on t2.trackingnumber like t1.ShipmentNumber + 'B%'
where t1.trackingnumber not like '%B%'
group by t1.ShipmentNumber, t1.trackingnumber;
"
25114,How to Add two time fields to equal an integer in an SQL Stored Procedure?,"CREATE TABLE #Test (
     TimeCol1 TIME(0)
    ,Timecol2 TIME(0))

INSERT INTO #Test (TimeCol1, TimeCol2) VALUES ('07:30:00', '06:45:53')
INSERT INTO #Test (TimeCol1, TimeCol2) VALUES ('06:45:53','07:30:00')

select *, CONVERT(time, CONVERT(datetime, TimeCol2) + CONVERT(datetime, TimeCol1))  FROM #Test
"
29949,"Coldfusion, outputting SQL results grouped by Date Grouping, Today, Yesterday, This Week, etc","<h1>Today:</h1>
<cfquery name=""todayRecords"" dbtype=""query"">
    select *
    from originalQuery
    where DateAdded = #createODBCDate(year(now()), month(now()), day(now()))#
</CFQUERY>
<cfdump var=""#todayRecords#"">
"
15343,Select query for the percentage of rows that have a given value?,"select type
from t
group by t
having avg(case when value = 1 then 1.0 else 0.0 end) > 0.5;
"
19982,Redundant DB column for indexing,"SELECT *
FROM MailMessage
WHERE PersonId = ?
ORDER BY ReceivedTime
"
9972,SQL n:m relation,"SELECT 
    s.id  AS studio_id, 
    e.id  AS equipment_id, 
    se.id AS studio_equipment_id
FROM 
     studios AS s
  CROSS JOIN 
     equipment AS e
  LEFT JOIN 
     studio_equipment AS se 
       ON  se.studio_id = s.id
       AND se.equipment_id = e.id ;
"
23888,COUNT QUERY IN DB2,"select t1.AP_NBR, count(distinct t1.LOC_NBR), count(distinct t2.ITM_ID)
from TAB1 t1 join TAB2 t2 on t1.LOC_NBR = t2.LOC_NBR
group by t1.AP_NBR
"
24569,SQL How can i exclude an entire group of data when only one member of the group meets criteria,"SELECT * 
FROM #YourTable
WHERE Batch IN (SELECT DISTINCT BATCH 
                FROM #YourTable 
                WHERE MajorCode >= 4000)
"
25812,How to find which version of Oracle is installed on a Linux server (In terminal),"$ORACLE_HOME/OPatch/opatch lsinventory | awk '/^Oracle Database/ {print $NF}'
"
28983,"Set # of attempts according to Completed Date - Postgres SQL, Database","select u.*, 
row_number() over(partition by userid,course order by enrollmentdate,completeddate) as attempts
from ""User_Result"" u
"
21103,Get IST date from Oracle,"systimestamp AT TIME ZONE 'IST'
"
23401,Oracle SQL - Generate and update a column with different random number in every row,"update mytable r set r.generated_num = TRUNC(dbms_random.value(1,9999999))
"
29834,Delete duplicate records keeping original,";WITH cte AS 
(
  SELECT ROW_NUMBER() OVER (PARTITION BY Col1, Col2, Col3  ORDER BY (SELECT 0)) RN
  FROM  yourtable
)
DELETE FROM cte
WHERE RN > 1
"
37627,SQL query to retrieve conversations records,"SELECT   Conversations.*
FROM     Conversations JOIN Conversations_users USING (conversation_id)
WHERE    Conversations_users.user_id IN (1,2,3)
GROUP BY conversation_id
HAVING   COUNT(DISTINCT Conversations_users.user_id) = 3
"
21267,SQL Server database storing 'ć' as 'c',"UPDATE dbo.User_Data
SET name = N'Kramarić'
WHERE User_PKID= 3047
"
21107,Loop not working in package,"begin
for x in (
  select person_id
  from   person
  where  exists (
           select null -- see comment below *
           from   bank_details
           where  bank_details.person_id=person.person_id and
                  bank_form in ('Sal','Reimb')
           having count(*) = 2)
loop
  fnd_output(""This is it!)
end loop
end
"
36720,How do I execute a stored procedure whenever an item is added to a service broker queue?,"CREATE QUEUE ExpenseQueue
    WITH STATUS=ON,
    ACTIVATION (
        PROCEDURE_NAME = expense_procedure,
        MAX_QUEUE_READERS = 5,
        EXECUTE AS 'ExpenseUser' ) ;
"
19546,Import first 1000 records into sql server from a csv file,"USE MyDB
BULK INSERT MyTable
FROM 'C:\Users\jasons\Desktop\Documents\MyFile.csv'
WITH(
FIRSTROW = 2,
FIELDTERMINATOR = ',',
ROWTERMINATOR = '\n',
LASTROW = 1001
)
"
20975,compare dates in mssql,"SELECT * FROM table WHERE theDate < convert(date, GetDate())
"
19526,SQL count on multiple columns?,"select firstname, lastname, count(*) as `Name Count`
from table
group by firstname, lastname
"
6139,SQL LIKE command doesn't work with strings containing dots,"SELECT *
FROM `releases`
WHERE version REGEXP '^12\.[0-9]+$'
"
20345,"Find all stored procedures that reference a column in table ""someTable""","-- Search in All Objects
SELECT OBJECT_NAME(OBJECT_ID),
definition
FROM sys.sql_modules
WHERE definition LIKE '%' + 'CreatedDate' + '%'
GO

-- Search in Stored Procedure Only
SELECT DISTINCT OBJECT_NAME(OBJECT_ID),
object_definition(OBJECT_ID)
FROM sys.Procedures
WHERE object_definition(OBJECT_ID) LIKE '%' + 'CreatedDate' + '%'
GO
"
7280,How to get enum element from index,"CREATE TABLE ranks
SELECT DISTINCT rank+0 as id, CONCAT('',rank) as rank
FROM soldiers
"
39293,SQL Server Select With Loop on second table,"select users.email
from users
join roles on roles.id = users.roleid
where roles.emailEnabled = 1
"
24081,Select results from the middle of a sorted list?,"SELECT * 
FROM table
ORDER BY somecolumn
LIMIT 10,40 
"
39614,SQL Stored Procedure to return results with multiple parameters,"CREATE PROCEDURE [dbo].[viewSimilarRecords]
 @recordType varchar(25),
 @recordSource varchar(25)

 AS 
SELECT * FROM myTableName 
WHERE
(recordtype  =@recordType   OR @recordType IS NULL) AND --<<change to OR??
(recordsource=@recordSource OR @recordSource IS NULL)
                          --^^^^^^^^^^^^^^^^^^^^^^^^
 GO
"
5180,Adding together two column sums in SQL Server2005,"Select ID, Sum(ColumnA),
Sum(ColumnB)
ISNULL(Sum(ColumnA),0) + ISNULL(Sum(ColumnB),0) AS ColumnC
From View1
Group by ID
"
11352,Query to select the amount of rows in the databse for today's date?,"SELECT * FROM `orders` WHERE DATE(`order_date`) = CURDATE()
"
5758,Can I do a not in except for in my SQL query?,"SELECT * FROM table WHERE flag = 0 OR status <> 'Complete'
"
15828,Oracle Documentation NOT NVL,"NVL2(loves_marmite, 'Nope', something_else)
"
1836,open recordset without cursors,"CursorType = adOpenForwardOnly
LockType = adLockReadOnly
"
30022,Getting data from 2 tables when they dont have any primary-foregin key relationship,"SELECT COALESCE(A.col1,B.col1)
        , COALESCE(A.col2,B.col2)
        , COALESCE(A.col3,B.col3)
        , COALESCE(A.col4,B.col4)
FROM B
LEFT OUTER JOIN A
    ON A.id = B.id
"
5601,MySQL or Laravel Eloquent - order by,"SELECT *
FROM your_tab
ORDER BY RIGHT(year, 4) DESC, year DESC   -- LEFT(year, 1) DESC
"
26303,all columns values are getting deleted,"UPDATE (SELECT @a:=0) A, Mydb.Mytable B SET B.TableId_int = (@a:=@a+1);
"
10501,How do I get rid of an orphaned default constraint in T-SQL?,"CREATE TABLE Table (
    col DATETIMEOFFSET  DEFAULT GETUTCDATE()
)
GO
"
24445,copy a table into a new table and add a new column on SQL server 2008,"SELECT          table1.col1, col2, col3, 
                CASE WHEN table2.col1 IS NULL THEN 0 ELSE 1 END AS col4
INTO            table1_new
FROM            table1
LEFT OUTER JOIN table2 ON table1.col1 = table2.col1
"
31815,Is there a way to know what are all the tables changed,"SHOW TABLE STATUS FROM db_name WHERE Update_time BETWEEN (<date1> AND <date2>)
"
39633,Determine table referenced in a view in SQL Server,"select
  cols.*
from
  sys.sql_expression_dependencies objs
  outer apply sys.dm_sql_referenced_entities ( OBJECT_SCHEMA_NAME(objs.referencing_id) + N'.' + object_name(objs.referencing_id), N'OBJECT' ) as cols
where
  objs.referencing_id = object_id('view_name_here')
"
31837,Query returns unwanted results,"select d.*
  from Dispatch d
 where d.Invoice = 50007
   and not exists (select *
                    from SalesLed s
                   where s.Invoice = d.Invoice
                     and s.spiff > 0)
"
10385,how to make query show the an other column of the primary key?,"select t1.name, t2.date
from table_1 t1 inner join table_2 t2 on t1.id = t2.user_id
"
21583,Better ways to write this SQL Query,"select yourfields  -- or delete
from userroles 
where userid in 
(select userid 
from userroles join etc
where system.name = the one you want
except
select userid 
from userroles join etc
where system.name <> the one you want
)
"
2785,SQL Join: Tables of the same kind,"SELECT title, painterID artistID
FROM Paintings
UNION ALL
SELECT title, sculptorID artistID
FROM Sculptures
"
28965,Trouble with logic on how to query for all possible 5 number combinations of numbers 1 - 69 into SQL table,"SELECT r1.c, r2.c, r3.c, r4.c, r5.c
FROM range r1, range r2, range r3, range r4, range r5
WHERE r1.c<r2.c AND r2.c<r3.c AND r3.c<r4.c AND r4.c<r5.c
"
3103,Moving standard deviation with SQL Server,"select t.*, t2.stdev10 
from table t outer apply
     (select stdev(t2.avgnet) as stdev10
      from (select top 10 avgnet
            from table t2
            where t2.date <= t.date
            order by t2.date desc
           ) t2
      ) t2;
"
23682,Scripting FileTables,"CREATE TABLE DocumentStore AS FileTable
    WITH ( 
          FileTable_Directory = '$(FileTableDirectoryVariable)',
          FileTable_Collate_Filename = database_default
         );
GO
"
13630,Copy data from one column into another column,"UPDATE [DB2].[Table7]
SET [Table7].[Col555] = [Table1].[Col11]
FROM [Table1] JOIN [Table7] ON -- add the base for the join here...
WHERE [Table1].[Coll] = 'Important'
"
20971,SQL - get the values between the curly brackets from a string,"declare @myString varchar(100) = 'my value {Year}{Month}{Day} sample';

select T2.X.value('.', 'varchar(50)')
from (select cast(replace(replace((select @myString for xml path('')), '{', '<X>'), '}', '</X>') as xml).query('.')) as T1(X)
  cross apply T1.X.nodes('/X/text()') as T2(X);
"
21820,oracle sql: selectng from all_tab_columns does not find exisintg column,"select count(*) from all_tab_columns
        where column_name = upper('foo')
        and table_name = 'VIEW0';
"
33586,Get all from one table and COUNT from another,"SELECT categories.id, max(categories.slug), count(categories_questions.id) AS numberOfQuestions
FROM categories
LEFT JOIN categories_questions
ON categories.id = categories_questions.category_id
group by categories.id
"
36269,MySQL select using group and count for join tables,"SELECT school.NAME, 
       count(student.id) AS Total_Student 
FROM   school 
       LEFT JOIN student 
              ON school.id = student.school_id 
GROUP BY school.id
ORDER BY Total_Student
"
28495,Save 2-dimensional spreadsheet data to database,"CREATE TABLE ProductWeightPrice
 (Product VARCHAR(20) NOT NULL,
  Weight INT NOT NULL,
  Price INT NOT NULL,
  PRIMARY KEY (Product,Weight));
"
14821,BCP Parameter issues,"    DECLARE @bcpCommand varchar(2000)
    SET @bcpCommand = 'bcp ' + DB_NAME() + '..vw_TempAllItems out c:\FEPData.csv -c -t, -U User -P Pwd  -S' + @@SERVERNAME
    EXEC master..xp_cmdshell @bcpCommand
    GO
"
16401,Query how often an event occurred at a given time,"select 
user,
date,
purchase_count
from (
  select *, 
  @rn:= if(@prev_user=user,@rn+1,1) as purchase_count,
  @prev_user:=user
  from test,(select @rn:=0,@prev_user:=null)x
  order by user,date
)x
order by date;
"
37169,How to delete records in a table which are created between a particular time window?,"DELETE * FROM mytable WHERE entry_date BETWEEN trunc(SYSDATE)+9/24 and trunc(SYSDATE)+23/24
"
388,Select if exists else select 0 Does it query twice?,"SELECT  ISNULL
        (
        (
        SELECT  userId
        FROM    users
        WHERE   userName = @userName
                AND password = @password
        ),
        0
        )
"
31808,join condition depends on the parameter,"CASE @CATEGORY_LEVEL  
     WHEN 'L' THEN CAS.LCATEGORY
     WHEN 'M' THEN CAS.MCATEGORY
     WHEN 'S' THEN CAS.SCATEGORY
END
"
28674,MySQL calculate distance between all geo locations in result,"SELECT SUM(SQRT(POW(A.LAT - B.LAT, 2)+POW(A.LON - B.LON, 2)))
FROM LOCATIONS A
JOIN LOCATIONS B ON (A.ID = B.ID - 1)
"
2009,Result set in column not row,"WITH t AS (
  SELECT row, scan, col, val
  FROM MyTable
  UNPIVOT(val FOR col IN ([1],[2],[3],[4],...<snip>...,[2570],[2571]))p
)
SELECT
  row, scan, col AS range_start, col + 15 AS range_end, min_val
FROM t t1
CROSS APPLY (
  SELECT
    MIN(t2.val) AS min_val
  FROM t
  WHERE
    row = t1.row AND
    scan = t1.scan AND
    col BETWEEN t1.col AND t1.col + 15
) t2
"
31266,"Removing a column of data (string) by using LIKE query, there must be a better way","DELETE FROM @Containers
    WHERE (','+Dept+',' LIKE '%,1,%' OR
           ','+Dept+','  LIKE '%,11,%' OR
           ','+Dept+','  LIKE '%,23,%' OR
           ','+Dept+','  LIKE '%,31,%')
"
12756,Why does this SQL code returns true when both operands operated by operator OR are False?,"false OR false => false
false OR true => true
true OR false => true
true OR true => true
"
23539,How to hide/lock linked PostgreSQL tables when MS Access is used as a front end and PostgreSQL as backend?,"REVOKE ALL ON accounts FROM joe;
GRANT SELECT ON accounts TO joe;
"
33589,SQL Server 2008: how to give a value of a field in a column and return the column identity,"update tbl_duty
set Name = @DName,
    Necessity = @DNecessity,
    Payment = @DPayment,
    [Estimation Time] = @DEstimationTime,
    Term = @DTerm,
    [Description] = @DDescription
where id = (select max(id) from tbl_duty);
"
7917,More efficient left join of big table,"PeopleExtra (PeopleID) INCLUDE (DataNumber, ElementID)
FormElements (FormComponentID, FormElementID)
"
4961,Get min price id without inner select,"SELECT t.id, t.parent_id, t.price
FROM table t
LEFT JOIN table t2
  ON (t.parent_id = t2.parent_id AND t.price > t2.price)
GROUP BY t.id, t.parent_id, t.price
HAVING COUNT(*) = 1 AND max(t2.price) is null
ORDER BY t.parent_id, t.price desc;
"
25729,How to escape underscore in the string query in hibernate and SQL?,"SELECT * FROM employee WHERE NAME LIKE '%k\_p%';
"
25690,"How to write a postgresql query for getting only the date part of timestamp field, from a table","select DATE(my_field) from my_table;
"
22800,SQL Group By Percentage Increments,"select t.pcbracket as [% Bracket], count(*) as [NumWithMark]
from (
  select case  
    when mark between 0 and 9 then ' 0- 9'
    when mark between 10 and 19 then '10-19'
    when mark between 20 and 29 then '20-29'
    when mark between 30 and 39 then '30-39'
    else '40-100' end as pcbracket
  from testresults) t
group by t.pcbracket
"
31517,Query to retrieve data based on many composite keys,"CREATE TEMP TABLE tmp1 ( col2 varchar(20), col3 varchar(20) );
INSERT INTO tmp1 (col2, col3) VALUES ('Scottish Terrier', 'black')
                                   , ('Golden Retriever', 'brown');
SELECT * 
FROM dog_manners x
JOIN tmp1
    ON tmp1.col2 = x.col2
   AND tmp1.col3 = x.col3;
"
18730,How to group correctly when trying to select max value?,"ROW_NUMBER() OVER (PARTITION BY [Description]
                   ORDER BY [SampleNumber] DESC, [InspectionDate] DESC
                  ) rn
"
23009,WebSQL Select Rows from two Tables,"select ref, sum(Qtt)
  from (SELECT Ref, Qtt
          from OrderMovesWhere CompanyID = ?
        UNION ALL
        SELECT Ref, Qtt From CurrentMobileOrderMoves Where CompanyID = ?) as t_1
 group by ref;
"
34218,TSQL Counting Nulls - where all grouped items have NULL field,"SELECT 
    ClientID
    FROM ClientEmails
    GROUP BY ClientID
    HAVING MAX(LEN(ISNULL(EmailAddress, ''))) = 0;
"
21228,Set value to variable and modify based on condition SQL,"select @variable = case
                        when max(max_val) > @variable then @variable
                        else max(max_val)
                    end
from dataset
where account_id = 'abc'
and product = 'xyz'
"
7572,Join sql results,"SELECT t1.name,
       t1.value,
       t2.value
FROM table1 t1
INNER JOIN table3 t3 ON t1.idfoo1 = t3._id
INNER JOIN table2 t2 ON t2.idfoo2 = t3._id_2
WHERE t3.id=1 AND t2.name = 'fooname'
"
23898,Convert From Bigint to datetime value,"select dateadd(s, convert(bigint, 1283174502729) / 1000, convert(datetime, '1-1-1970 00:00:00'))
"
36989,How to convert yyyymmddMilliseconds to datetime in SQL Server?,"declare @x varchar(50)
set @x='20100218000051234'
Select DateAdd(ms, Cast(Substring(@x, 9, 9) As int), Cast(Substring(@x, 1, 8) As datetime))
Select DateAdd(ms, Cast(Substring(@x, 9, 9) As int), Cast(Substring(@x, 1, 8) As datetime2))

Results:
2010-02-18 00:00:51.233 
2010-02-18 00:00:51.2340000
"
35405,Can't store Data URI to database without stripping + characters,"class CustomURLField(forms.URLField):
    def to_python(self, value):
        return value
"
8935,"Daily Sum, Month To Date, MTD Avg, Prev Month Avg","select
sum(case when timestamp = '12-OCT-2014' then meter + oilVolume else 0 end),
sum(case when timestamp between '01-OCT-2014' and '12-OCT-2014' then meter + volume else 0 end),
sum(case when timestamp between  '01-OCT-2014' and '12-OCT-2014' then meter + volume else 0 end) / datediff(""dd"",'01-OCT-2014' , '12-OCT-2014'),
sum(case when timestamp between '01-SEP-2014' and '30-SEP-2014' then meter + volume  else 0 end ) / datediff(""dd"",'01-SEP-2014' , '30-SEP-2014')
from ...
"
31141,SQL Update based on aggregate record set,"UPDATE po SET confirmed = 'confirmed'
FROM po T
WHERE 
NOT T.po_num   IN 
(
SELECT po_num FROM po_line
WHERE po_date IS NULL
)
"
19970,Issue in making appear all database table field names,"Select Columns.Name
  From Sys.Columns
 Where Object_Name(Columns.Object_id) = 'forma'
 Order By Columns.Column_Id;
"
35429,How to check if there exist only one record for a certain Id,"SELECT comp.companyid, count(distinct emp.employee_id), 
FROM Tbl_Company comp
           , Tbl_Employee emp
WHERE 
           emp.company_id = comp.company_id 
           AND emp.company_id = 1234
GROUP BY comp.companyid
"
12064,How do you match multiple column in a table with SQLite FTS3?,"SELECT * FROM table WHERE table MATCH 'A:cat OR C:cat'
"
33553,Application crash when selecting many rows of a SQLite table,"foreach (var myrow in (from x in that_table select x))
{
    var myChartObject = new ChartObject();
    // populate myChartObject fields from myrow
    // add myChartObject to the actual chart
}
"
11676,Inserting multiple rows into some table using values from select statement,"INSERT INTO SomeTable (UserID, ModuleID, ModuleRights)
    SELECT u.UserId, v.ModuleID, v.ModuleRights
    FROM Users u CROSS JOIN
         (VALUES (1, 15), 
                 (2, 1), 
                 (4, 3), 
                 (8, 7)
         ) v(ModuleID, ModuleRights);
"
2147,Use LISTAGG to select multiple rows on joined table,"select u.id, u.name, listagg(price, ', ') within group (order by price) as prices
from user u left outer join
     values v
     on u.id = v.id and v.tag in ('start', 'end')
group by u.id, u.name;
"
26877,"Why won't my ""WHERE"" statements work in sql?","SELECT * FROM (
    SELECT [Customer name],[$ Amount], [Quote Completed]
    FROM 1081
    UNION
    SELECT [Customer name],[$ Amount], [Quote Completed]
    FROM 1145
    UNION
    SELECT [Customer name],[$ Amount], [Quote Completed]
    FROM 1149
    UNION 
    SELECT [Customer name],[$ Amount], [Quote Completed]
    FROM 1228
    UNION
    SELECT [Customer name],[$ Amount], [Quote Completed]
    FROM 1353) U
WHERE [Quote Completed] = date()-1
"
37911,return multiple data from stored procedure from the same table,"        SELECT @UserId = UserId ,
               @IsVerify = IsVerify ,
               @UserType = UserType ,
              @IsPremium = IsPremium 
        FROM Users WHERE Email = @Email AND Password = @Password
"
38753,Can you have if-then-else logic in SQL?,"IF ((SELECT COUNT(*) FROM table1 WHERE project = 1) > 0) 
    SELECT product, price FROM table1 WHERE project = 1
ELSE IF ((SELECT COUNT(*) FROM table1 WHERE project = 2) > 0) 
    SELECT product, price FROM table1 WHERE project = 2
ELSE IF ((SELECT COUNT(*) FROM table1 WHERE project = 3) > 0)
    SELECT product, price FROM table1 WHERE project = 3
"
26543,SQL INNER JOIN ON LIKE,"SELECT  DISTINCT tableA.group
FROM    tableB
INNER JOIN
        tableA
ON      tableA.group LIKE CONCAT(tableB.groups, '%')
"
29371,How to take the top 10 results of a UNION in sql?,"SELECT TOP 10 *
FROM
(
SELECT a_object_ID as [id], 
    a_object_name as [name],
    'A_object' as [Type]
FROM [database].[dbo].[table_a]
WHERE a_object_name LIKE @Search + '%'
UNION ALL
SELECT b_object_ID as [id], 
    b_object_name as [name],
    'B_object' as [Type]
FROM [database].[dbo].[table_b]
WHERE b_object_name LIKE @Search + '%'
) x
ORDER BY [name]
"
11784,Give group of rows unique identifier TSQL,"with    anonymousId as (
        select  distinct CustRef,
                newid() as newId
        from    t_health)
update  dbo.t_health
set     code = ai.newId
from    dbo.t_health h join anonymousId ai on h.custref = ai.custref
"
32115,MySQL JOIN when inserting data,"INSERT INTO images
(name, uploaded, views, server_id)
SELECT 'imagename', CURTIME(), 0, id
FROM servers
WHERE name = 'servername'
"
27941,SQL statement returns only rows that exist also in the joined table,"SELECT *
FROM products
WHERE NOT EXISTS
(
  SELECT *
  FROM orders
  WHERE product_id = products.product_id 
  AND order_date < somedate 
);
"
34578,"Counting with skipping some dates, with Ms Access","SELECT t.Name, t.Costs, t.Quantity, t.Date, DateDiff(""m"", s.FirstDate, t.Date) + 1 AS MonthLive
FROM ProductCosts t
    INNER JOIN (
        SELECT m.Name, MIN(m.Date) AS FirstDate
        FROM ProductCosts m
        GROUP BY m.Name) s
    ON t.Name = s.Name
ORDER BY t.Name, t.Date
"
5589,SQL Server : get hour from datetime and then change it,"UPDATE [MyTable]
SET DueDate = DATEADD(dd, 1, DueDate) -- add one day (set to midnight)
WHERE DATEPART(hh, DueDate) = 0 -- do this for dates where hour is zero (midnight)
"
34628,select * from table where datetime in month (without breaking index),"select *
from your_table 
where date_field >= '2010-01-01'
    and date_field < '2010-02-01'
"
9473,Why does Oracle round up a number with less than 38 significant digits?,"dev> create table dctest (x number);

Table created.

dev> insert into dctest VALUES (0.98692326671601283);

1 row created.

dev> select * from dctest;

         X
----------
.986923267

dev> column x format 0.000000000000000000000000000
dev> /

                             X
------------------------------
 0.986923266716012830000000000
"
3652,Both sides of a many to many relationship also relate to the same 3rd party,"1. Make TableA.CId and TableB.CId both FKs to Table C.ID.
2. Add a unique index in TableA on columns AId and CId.
3. Add a unique index in TableB on columns BId and CId.
4.  Add a CId column to TableM.
5.  Then Add two FKs in Table M,
   a. One using columns (AId, CId) pointing to Unique composite Index in Table A, and
   b. the other using columns (BId, CId) pointing to Unique composite Index in Table B.
"
12332,SQL Query Join Issue,"with userCTE as (
    select
        u.userId ,
            c.columnId
    from tblUsers as u
        cross join tblColumns as c
)

select 
    u.* ,
    Coalesce(cd.ColumnDatacontent, 'N/A') AS columnDataContent
from userCTE as u
    left join tblColumnData as cd
        on u.columnId = cd.columnId and u.userID = cd.userId
"
25002,using datepart() with the group by command,"select SUM(totalsellingprice) from dbo.tblServiceOrders
group by datepart(MONTH,dbo.tblServiceOrders.datereceived)
order by datepart(MONTH,dbo.tblServiceOrders.datereceived)
"
4132,How to create a result set of n*n in SQL (Oracle)?,"select
  trunc((level - 1) / N) + 1 as ROWNR,
  mod(level - 1 + trunc((level - 1) / N), N) + 1 as VALUE
from
  (select 5 /* Here goes your number N */ as N from dual) d
connect by
  level <= N*N
"
24244,help with query that should only return most recent record,";WITH MostRecentBookings AS
(
   SELECT 
      (some columns),
      ROW_NUMBER() OVER(PARTITION BY b.BOOK_NO ORDER BY d.ADDED DESC) AS 'RowNum'
   FROM
      dbo.Booking b
   INNER JOIN
      dbo.Diary d ON ..........
)
SELECT
   (some columns)
FROM
   MostRecentBookings
WHERE
   RowNum = 1
"
7619,Getting data from the end,"select * 
from MOVIE_COMMENT 
where USER_ID = 102 
order by column_name desc
LIMIT 10
"
12478,Update with self join in sybase,"UPDATE TAB
   SET
       AGNCY_NM = BB.AGNCY_NM
      ,UPDT_NBR = 3
    FROM
       TAB BB
   WHERE
      TAB.COAR_ID=BB.COAR_ID
      AND TAB.COCI_TYPE='P'
      AND BB.AGNCY_NM <> ''
      AND TAB.UPDT_NBR <> 3
      AND BB.COCE_ID=(SELECT MAX(CC.COCE_ID) FROM TAB CC WHERE CC.COAR_ID=BB.COAR_ID )
"
17431,Multiple conditions in where (pl/sql),"Delete From table_1 
  Where COALESCE(A,B,C,D,E,F,....,Z,AA,AB,.....,BA) is null;
"
39618,List the contents of Oracle export dump file,"IMP SCOTT/TIGER SHOW=Y FILE=import_file.dmp
"
11959,MS Access Table with Multiple foreign keys to same table,"CREATE TABLE StudentsSupervisors 
( StudentId NUMBER 
  SupervisorId Number )
"
19097,mysql - How can I get the first result from a subquery?,"SELECT pa.albumId, pa.title, p.src
FROM Album pa
LEFT JOIN Photo p 
  ON p.photoId = (SELECT MIN(photoId) FROM Photo WHERE albumId = pa.albumId)
WHERE pa.userId = 1
"
38146,Adding Offset to Time Interval,"declare @T table (interval varchar(4), offset int)

insert @T values
('730', 60),
('830', 60),
('1000', 60);

select
  interval,
  offset,
  replace(convert(char(5), dateadd(mi, convert(int, interval) % 100 + offset, dateadd(hour, convert(int, interval) / 100, 0)), 8),':','')
from @T
"
9975,selecting max values grouped by two column,"SELECT   firstname, lastname , SUM(nb_payments) 
FROM     account 
GROUP BY firstname, lastname
ORDER BY 3 DESC LIMIT 3
"
16867,MySQL $i++ equivalent,"  SELECT @i := @i + 1 AS i, COUNT(*), ...
    FROM affiliates_earnings
    JOIN (SELECT @i := 0) dummy
   WHERE ...
GROUP BY ...;
"
33147,How do I write a subquery using a JOIN in SQL,"SELECT Writers.WRT_LastName AS LastName, Writers.WRT_FirstName AS FirstName
FROM Writers 
WHERE EXISTS (SELECT 1 FROM Editors WHERE Editors.ED_ID = Writers.WRT_ID);
"
34014,How to extract Polygons from a SQL Server geometry value," SELECT @Result = @USA.STIntersection(@Bounding)   
"
24560,Access SQL Query Returning Wrong Value for Count Field,"SELECT 
Customers.[Customer ID], 
Customers.[First Name], 
Customers.[Last Name], 
SUM(Iif(r.[Valid Referral] = True, 1, 0)) AS c, 
Sum(Iif(r.[Used Our Service] = True, 1, 0)) AS c2
FROM Customers 
INNER JOIN Referrals r ON Customers.[Customer ID] = r.[Referred From] 
WHERE (r.[Valid Referral])=True
GROUP BY Customers.[Customer ID], Customers.[First Name], Customers.[Last Name]
"
13963,SQL-query order by multiple columns having null values,"street|zip
-----------
'a'   |0
'b'   |0
'c'   |null
null  |0
null  |null
'f'   |1
"
15374,How to get the sum of foreign key table as a value in the primary table row in a select statement,"select 
  t.*, 
  ( select 
      sum(tt.value) 
    from table2 tt 
    where tt.id = t.id) sum_value
from table1 
"
12146,How to re-update a date to a different format?,"Convert a DD/MM/YYYY string to a datetime: convert(datetime, value, 103)
Convert a datetime to a DD/MM/YYYY string: convert(varchar(10), value, 103)
Convert a MM/DD/YYYY string to a datetime: convert(datetime, value, 101)
Convert a datetime to a MM/DD/YYYY string: convert(varchar(10), value,  101)
"
20,Days of last month inPL/SQL,"SELECT  LAST_DAY(ADD_MONTHS(SYSDATE, -2)) + level
FROM    dual
CONNECT BY
        level <= LAST_DAY(ADD_MONTHS(SYSDATE, -1)) - LAST_DAY(ADD_MONTHS(SYSDATE, -2))
"
8203,How to use GETDATE() Function with LIKE in SQL Server?,"where Txndate like '%' +   CONVERT(VARCHAR(12), GETDATE(), 107) + '%'
"
36808,SQL Select the similar products,"select p.* 
from manager m1
join manager m2 on m1.fk_category = m2.fk_category
Join product p on m2.fk_product = p.id
where m1.fk_product = 1 and m2.fk_product <> m1.fk_product
"
34056,Improving performance of adding a column with a single value,"WITH B AS (SELECT 'Value' as NewColumn)
SELECT *
FROM Table1 A CROSS JOIN
     B;
"
38137,pull Drupal field values with db_query() or db_select(),"debug($node);
"
31469,Is it possible to write a query that categorize sum(amount) in 2 columns?,"SELECT
    SUM(CASE WHEN type = 1 THEN amount ELSE 0 END) amount1,
    SUM(CASE WHEN type = 2 THEN amount ELSE 0 END) amount2
FROM MyTbl
"
11500,"SQL CASE when using ""AS""","SELECT     warehouse, product, description, 
physical_qty - allocated_qty AS stock,
CASE WHEN (physical_qty - allocated_qty) < 1 THEN 'OUT'
ELSE 'IN' END AS Stock_Status
FROM         scheme.stockm
WHERE     (warehouse = '01') AND (product IN ('A', 'B', 'C'))
"
31805,Add a column that increments when another column changes,"with cte as (
    select
        *,
        row_number() over(order by id) as rn1,
        row_number() over(partition by status order by id) as rn2
    from Table1
)
select
    id, status,
    dense_rank() over(order by rn1 - rn2) as status_index
from cte
order by id
"
449,How to use a select command to find all the records that has the maximum date value for a specific item?,"select tbl_test.*
from tbl_test
join (select songid, max(theDate) maxDate
      from tbl_test
      where actionId = 100
      group by songid) t on t.songId = tbl_test.songId and theDate = maxDate
where actionid = 100
"
6787,Limit LIKE query in MS Access to search initial number of characters for a specific group of characters,"SELECT* FROM EarnedHours WHERE LEFT(MatlDesc, 8) LIKE '*EPC*'
"
9449,Postgres - Filtering out words but excluding another pattern," WHERE label ilike '%asian%' and label not ilike '%caucasian%' ? 
"
29567,Update a Row from another row of same table?,"UPDATE DP
SET 
   DP.[Description] = SP.[Description]
   ................................
   ................................
   ................................
    ,[LastModificationDateUtc] = GETUTCDATE()
FROM    
    [dbo].[BaseProducts] DP
CROSS JOIN 
    [dbo].[BaseProducts] SP
WHERE   
    SP.Id = @SourceBaseProductId
    AND DP.Id = @DestinationBaseProductId;
"
18441,Sql script to eliminate data duplication,"select v = col1 from table1
union select col2 from table1
union select col3 from table1
union select col4 from table2
"
16140,sorting in sql based on a part of a column(number),"order by to_number(substr(column, 1, instr(column, ' ')))
"
31932,Index number for records within a pipe-delimited field inside a csv,"SELECT ROW_NUMBER() OVER (PARTITION BY CrimeRecords.CaseNum ORDER BY CrimeRecords.CaseNum) As Idx, CrimeRecords.CaseNum, CrimeRecords.Offense, PrimaryCrime.PrimaryCrime
FROM (SELECT CaseNum ,x.i.value('.','varchar(20)') AS Offense 
            FROM (SELECT CaseNum, CONVERT(XML,'<i>'+REPLACE(CrimeType, '|', '</i><i>') + '</i>') AS d 
                        FROM CrimeView.dbo.tblCrimeData)x1 CROSS APPLY d.nodes('i') AS x(i)) AS CrimeRecords
"
13557,DATEDIFF function in Oracle,"SELECT TO_DATE('2000-01-02', 'YYYY-MM-DD') -  
       TO_DATE('2000-01-01', 'YYYY-MM-DD') AS DateDiff
FROM   dual
"
28204,Query tables ordered by having most number of records,"SELECT o.name, t.rowcnt
  FROM sysobjects o, systabstats t
WHERE o.id = t.id
  AND t.rowcnt > 0            --ignore 0 row entries
  AND o.name not like ""sys%""  --exclude system tables
ORDER BY t.rowcnt DESC
"
8107,Multi Table Query Access Comparing Data,"select p.*
from persons as p
where p.ssn not in (select ssn from owner) and
      p.ssn not in (select ssn from tenant);
"
6568,How do you put literals into the result a sql result set based on which table was joined to create the row?,"CASE IF S1.ID IS NULL THEN 'SUBTYPE_1' ELSE 'SUBTYPE_2' END AS DISCRIMINATOR,
"
20215,Sql - Simple query with count,"select a.id, (select count(1) from b where id=a.id) cnt from a;
"
1090,SQL update multiple rows with same value,"UPDATE ibf_members
SET points = points + 500
WHERE mgroup = 15
AND id IN (5, 7, 10, 11, 16, 25);
"
31590,How to get data from 2 tables without joining them?,"from a in DBContext.tableA
from b in DBContext.tableB
select new {Field1=a.Field1, Field2=b.Field2};
"
22835,Create a date from Credit Card expire in MMYY format,"WHERE CCExpire = (RIGHT('00' + CAST(MONTH(DATEADD(mm, 1, GETDATE())) AS VARCHAR), 2) 
+ RIGHT(CAST(YEAR(DATEADD(mm, 1, GETDATE())) AS VARCHAR), 2))
"
9422,SQL : File Name,"SELECT *
    FROM SYS.sysfiles
    WHERE NAME LIKE'[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]%'
"
20030,How to using PostgresSQL to select between with values condition in two sets of data?,"select *
from t1
where exists
(
  select *
  from t2
  where t1.my_value between t2.value1 and t2.value2
);
"
24803,"Impala regex to find ""2"", but not ""255"", in pipe-delimited list","    clin_sig     REGEXP '^[[:<:]](4|5)[[:>:]]$'
AND clin_sig NOT REGEXP '^[[:<:]](2|3)[[:>:]]$'
"
12044,Compare two last rows values,"SELECT SUM(CASE WHEN rnum = 2 THEN -1 * value ELSE value END) diff_value,
       ROUND(SUM(CASE WHEN rnum = 2 THEN -1 * value ELSE value END) /
             SUM(CASE WHEN rnum = 1 THEN 0 ELSE value END) * 100) diff_percent
  FROM
(
  SELECT quarter, value, @n := @n + 1 rnum
    FROM table1 CROSS JOIN (SELECT @n := 0) i
   ORDER BY quarter DESC
   LIMIT 2
) q
"
8023,Sql return last order details for each customer,"select *
from (
  select o.*, 
         row_number() over (partition by o.ClientID order by o.OrderDateTime desc) as rn
  from t_orders o
) t
where rn = 1
order by ClientId;
"
20449,Change A Database's Table's Name (SQL Server 2008),"sp_rename 'old_table_name', 'new_table_name'
"
10505,SQL select rows where field contains word from another table's fields,"SELECT l.* 
FROM leads l
JOIN keywords k on instr(leads.name, word) > 0 
"
24270,SELECT * FROM WHERE does not find all records,"UPDATE saleslog SET status = 'Pending' WHERE status LIKE '%Pending%'  
"
5706,replace rows in table,"UPDATE table_A
SET id = CASE
    WHEN id = 123 THEN 999
    WHEN id = 456 THEN 888
    WHEN id = 789 THEN 777
END
"
22907,Sampling SQL timeseries,"SELECT
  t.*  /* you might want to be more specific here */
FROM atable t
  INNER JOIN (
    SELECT
      MAX(timestamp) AS timestamp
    FROM atable
    GROUP BY UNIX_TIMESTAMP(timestamp) DIV 60
  ) m ON t.timestamp = m.timestamp
"
20299,Postgres array as function input for where clause,"CREATE OR REPLACE FUNCTION get_info(_ids varchar[])
 RETURNS SETOF tbl AS
$BODY$
    SELECT *
    FROM   tbl
    JOIN  (SELECT unnest(_ids)) x(id) USING (id)
    ORDER  BY id_date DESC;
$BODY$
LANGUAGE sql STABLE;
"
10833,group table in terms of 2 column,"SELECT * FROM table GROUP BY hotelID, hotelName
"
34060,Basic UNION or JOIN,"select * from (
    your first query here
) t1 inner join (
    your second query here
) t2 on t2.MarketIdentifier = t1.MarketIdentifier
and t2.CurveType = t1.CurveType
and t2.VintageYear = t1.VintageYear
"
39867,filter data with entity framework,"int[] ids = sResources.Split(',').Select(s => int.Parse(s)).ToArray();

rooms = from r in context.Rooms
    where r.Area.Office.Id == officeId
    && r.MaximumPeople >= numberOfPeople
    && ids.All(i => r.RoomResources.Any(s => s.ResourceId == i)) // try this here
    select r;
"
18291,SQL like query not returning correct result,"select *
from t
where company like '%ABC%'
"
34096,SQL table - semi-unique row?,"CONSTRAINT my_contraint_name UNIQUE ([userID], [data])
"
24418,Is it possible to get all the parent of a particular role in SQL?,";WITH RCTE AS 
(
  SELECT ROLE_ID, PARENT_ROLE_ID FROM Table1
  WHERE ROLE_ID = 8

  UNION ALL

  SELECT t.ROLE_ID, t.PARENT_ROLE_ID FROM RCTE r
  INNER JOIN Table1 t on r.PARENT_ROLE_ID = t.ROLE_ID
)
SELECT * FROM RCTE
"
8805,SQL Server: Secondary query on empty rowset from first query,"IF EXISTS(...insert your first query here...)
    BEGIN
       --a record exists process first query
    END
ELSE
    BEGIN
         --do other query
    END
"
8079,Write sql query to search using wildcard,"declare @Search varchar(20);
set @Search = '3011';

select * 
from TableName
where FieldName like '%' + @Search + '%';
"
35738,sql server store the result of a select in a variable?,"DECLARE @Varname int
SELECT @Varname = SUM(table_name.col1) FROM etc
SELECT @Varname
"
20233,SQL statement to get a total for a given date range,"select
   cast(BookingDateTime as date) [Date],
   count(*) [Bookings],
   sum(BookingFare) [Value]
from t
group by cast(BookingDateTime as date)
"
25468,Sql export for select result,"SELECT email
FROM   users
WHERE  userid IN (SELECT userid
                  FROM   users,
                         profiles
                  WHERE  users.id = profiles.user_id
                         AND profiles.country_id = 1)  
"
11513,Join 2 tables SQL query,"select t2.*
from Table_2 t2 join Table_1 t1 on t2.table_1_id = t1.id
where t1.status = 1
and date(t2.`time`) = date(now() - interval 1 day);
"
12288,How to Group Data of a My SQL Table on the Basis of Four Columns,"select date, invoice_no, permit_no,
       sum(case when item_name in ('A', 'B') then quantity else 0 end) as A_B,
       sum(case when item_name in ('C') then quantity else 0 end) as C
from inventory_store
group by date, invoice_no, permit_no
order by date, invoice_no, permit_no;
"
33220,SQL Search for substring date,"WHERE  YEAR(dtColumn) between 2003 and 2005
"
37081,Outer Join Based On Concatenated SELECT,"select ...
from t1 left outer join t2 on t1.key = t2.pt1 || t2.pt2
where ...
"
26377,Group by with count(),"SELECT
  aid.id,
  COUNT(yourDataTable.aid) AS data_count
FROM
  aid
LEFT JOIN
  yourDataTable
    ON aid.id = yourDataTable.aid
WHERE
  aid.id IN (1,2,3,4)
GROUP BY
  aid.id
"
11917,Filter a table with column values represented as rows,"select *
from yourtable
where isnumeric(value) = 1
  and id in (select id from yourtable where value = 'mf')
"
30695,Select unique entries of column and filter these by unique entries of another one,"SELECT   GROUP_CONCAT(DISTINCT col_1) AS col_1, col_2
FROM     (SElECT   col_1, GROUP_CONCAT(DISTINCT col2) AS col_2
          FROM     my_table
          GROUP BY col_1) t
GROUP BY col2
"
39830,"TSQL, counting pairs of values in a table","SELECT Forename, Surname, COUNT(*) FROM YourTable GROUP BY Forename, Surname
"
675,How to select last modified date for set of observed fields for each unique objects of some type?,"select  max(created_date), object_class, object_id
  from    AuditLog
  where   object_class = 'ProjectA'
  and     created_date >= sysdate-30 ---- This is just so we have more results
  and     field in ('text3', 'listValue5', 'largeText6', 'largeText7', 'largeText8', 'listValue9')
group by object_id, object_class
order by created_date desc
"
31824,Pick One Row per Unique ID from duplicate records,"SELECT sub.ID, sub.NAME, Min(sub.FAVCOLOR)
FROM
    (
        SELECT ID, [NAME], FAVCOLOR
        FROM TABLE1
        UNION ALL
        SELECT ID, [NAME], FAVCOLOR
        FROM TABLE2
    ) AS sub
GROUP BY sub.ID, sub.NAME;
"
14483,SQL Server DETACH databases older than 6 months,"declare cur cursor for
select name
from sys.sysdatabases
where crdate <= DATEADD(month, -6, GETDATE())
and name not in ('master','model','msdb','tempdb','distribution')

declare @name nvarchar(200)

open cur

fetch next from cur into @name

while @@FETCH_STATUS = 0
begin
    EXEC master.dbo.sp_detach_db @dbname = @name, @keepfulltextindexfile = N'true'
    fetch next from cur into @name
end

close cur
deallocate cur      
"
31550,SQL How to remove duplicates within select query?," SELECT MAX(owner_name), 
        --floored to the second
        dateadd(second,datediff(second,'2000-01-01',start_date),'2000-01-01') AS StartDate
 From   MyTable
 GROUP BY dateadd(second,datediff(second,'2000-01-01',start_date),'2000-01-01')
"
19116,How do I pull a substring of various sides?,"substring(articletext, 
          patindex('/images/imgs/', articletext) + length('/images/imgs/'), 
          patindex('"" alt') - (patindex('/images/imgs/', articletext) + length('/images/imgs/')))
"
11035,T-SQL to find length of time a particular value is in-range,"select a.t, b.t  --- and what other columns you need
from tbl a -- implicitly each row of table
cross apply (
    select top(1) * -- the first, going upwards along b.t
    from tbl b
    where a.t < b.t -- look for records with later t than the source row
      and <here's your function between a row and b row>
    order by b.t asc
) x
"
27704,how to put condition check each group by value in mysql,"SELECT mt.emp_id
FROM my_table mt
LEFT JOIN my_table mtx ON (mtx.emp_id = mt.emp_id AND (mtx.isapproved = 0 OR mtx.isvalid = 0))
WHERE mt.isapproved = 1 AND mt.isvalid = 1 AND mtx.id IS NULL
GROUP BY mt.emp_id
"
34673,SQLite: Return the most recent 'n' rows per unique value of column 'y',"select  *
from    YourTable yt1
where   5 <
        (
        select  count(*)
        from    YourTable yt2
        where   yt2.thread_id = yt1.thread_id
                and yt2.msg_id < yt1.thread_id
        )
"
37825,Alphabet Series Generation in SQL Server,"DECLARE @Funding TABLE (FundingDetailID INT,FundingID INT, DetailDescription VARCHAR(50))
INSERT INTO @Funding VALUES (1,107,'Desc 1')
INSERT INTO @Funding VALUES (1,107,'Desc 2')
INSERT INTO @Funding VALUES (1,107,'Desc 3')

SELECT CHAR (CAST (96+ROW_NUMBER() OVER (Order BY FundingDetailID) AS VARCHAR)) + ') ' + DetailDescription
FROM @Funding



-----------------------------------------------------
a) Desc 1
b) Desc 2
c) Desc 3
"
7271,Oracle to_date function usage,"trunc(sysdate) + 17/24
"
18777,"Grouping with SQL using Max, Min, Avg and dates","SELECT cast([dateTime] as date) as Your_Date,ChannelID,
       max(reading) as max_reading,
       min(reading) as min_reading,
       avg(reading) as avg_reading
FROM YourTable
GROUP BY cast([dateTime] as date) ,ChannelID
"
15331,"How to use parameters ""@"" in an SQL command in VB","MyCommand = New SqlCommand(""UPDATE SeansMessage SET Message = @TicBoxText WHERE Number = 1"", dbConn)
MyCommand.Parameters.AddWithValue(""@TicBoxText"", TicBoxText.Text)
"
3216,how to generate consecutive records with a given number?,"select level 
from dual 
connect by level <= 100
"
11114,build a varchar using the first four characters of a uniqueidentifier,"Select
    left(x.id, 1) + '\' +
    left(right(x.Id, 3), 1) + '\' +
    left(right(x.Id, 2), 1) + '\' +
    right(x.Id, 1)
From
    (
        Select Left(cast(idField as varchar(38)), 4)  as Id
        From myTable
    ) x
"
11571,Joining a sql table rows with all other rows of same table,"select a.reqstatusid, a.reqstatus, b.reqstatusid as childreqstatusid,
b.reqstatus as childreqstatus
from table a, table b
where a.reqstatusid <> b.reqstatusid
"
1974,Restore SQL Server database from .sql files,"import os, subprocess
processDir = 'C:\\Database-master\\'
files = os.listdir(processDir)
for f in files:
    db = processDir + f
    #potentially drop corrupt db and create new ones with f
    scripts = os.listdir(db)
    for script in scripts:
        path = db + '\\' + script
        proc = subprocess.Popen('sqlcmd -S 127.0.0.1 -i ""' + path +'""', shell=True)
        proc.wait()     
"
19920,Joining 2 tables while getting the 90th percentile of one table's values,"select distinct sttr.operation, tss.val1, tss.val2, tss.val3,
    percentile_disc(0.9) within group (order by sttr.val asc) 
      over (partition by sttr.operation) as ""90th Percentile""
  from sttr 
    join exe on exe.tstart < sttr.time and sttr.time < exe.tend
    join tss on sttr.operation = tss.step
  where exe.id = 1001 
  order by operation
"
19266,Primary key composed of two foreign keys? Oracle,"CONSTRAINT tb_PK PRIMARY KEY (Ono, Pno)
"
1136,Adding Many (UDFs) Validation Functions to Oracle - Which Method Run Fastest,"create or replace function isValid2(v in varchar2, format in varchar2)
return valObj
deterministic --<< Hit the turbo button!
is
  test number;
begin
if format = 'number' then
    begin
        test := to_number(v);
        return valObj(1,null);
        exception when VALUE_ERROR then return valObj(0,'Invalid number. Valid formats are: 12345, 12345.67, -12345, etc...');
    end;
end if;
end;
/
"
38329,PostgreSQL: Enumerate SQL query result,"SELECT row_number() OVER (ORDER BY name) sid, <-- magic enumeration!
       name 
  FROM dreams 
  WHERE type='nice' 
  ORDER BY name;
"
39133,select query with priority based on column values,"SELECT term, arr, org, sta, ata, arr_pax, asrc, dep, dep_pax, dsrc, std, atd,
       Max(dep_pax) KEEP (Dense_Rank first ORDER BY apriority)
FROM (select t.*,
             sum(case when dpriority = 'USR' then 1 else 0 end) over (partition by . . . ) as NumUSR,
             sum(case when dpriority = 'LDM' then 1 else 0 end) over (partition by . . . ) as NumLDM
      from t
     ) t
WHERE dpriority = 'USR' or NumUSR = 0;
"
25360,Increase precision on money field for huge table,"ALTER TABLE CashTable ADD COLUMN Cash2 decimal(23,8) null
"
11374,Select By Time And Date,"SELECT * FROM test
WHERE date_time <= TIMESTAMP('2015-12-15 12:00') - INTERVAL 28 HOUR
"
35753,How to return rows where the ID is in all of the list?,"SELECT employeeID
FROM transactions
WHERE productID IN (1023, 3941, 2012)
GROUP BY employeeID
HAVING COUNT(distinct productID) = 3
"
10899,SQL: Get parent and grandparent (CTE or Derived Table)?,"SELECT a.f_assetname, p.f_locationname as parent, gp.f_locationname as grandparent
FROM tb_assets a
LEFT JOIN tb_locations p on a.f_assetlocationID = p.f_locationID
left join tb_locations gp on gp.f_locationID = p.f_locationparentID
"
23724,Select limited amount of rows with at most n rows of type A,"select t.*
from (select id, row_number() over (partition by type order by dms_random.value()) as seqnum
      from t
     ) t
where (type = 'A' and seqnum <= 100) and
      rownum < 1000;
"
20968,How to update a field based on its current value in MySQL?,"UPDATE table1
SET result = CurrentID + 1
WHERE ID = ""1""
"
12730,Which of these data models is the most correct?,"Joe Celko.     
Joe Celko's Trees and Hierarchies in SQL for Smarties, 
(The Morgan Kaufmann Series in Data Management Systems)
ISBN 1-55860-920-2
"
10219,"Filter rows on the basis of ""First Name"" + ""Last Name"" in SQL","SELECT * FROM @Test WHERE (FName like '%' + @SEARCHKEYWORD + '%') OR (LName like '%' + @SEARCHKEYWORD + '%') OR (FName + ' ' + LName like '%' + @SEARCHKEYWORD + '%')
"
4808,Using LIKE in a stored procedure and escaping injection at same time,"DROP PROCEDURE IF EXISTS mysearch;

CREATE PROCEDURE mysearch (IN term varchar(255), IN brands varchar(512), IN categories varchar(512), IN priceRange varchar(32))
BEGIN
  DECLARE fullterm varchar(255);
  SET fullterm = CONCAT('%',term,'%');

  SELECT name, price, image FROM (... join some tables here ... ) WHERE (... prod.category = some number ...)
  AND (term IS NULL OR (prod.name LIKE fullterm OR prod.number LIKE fullterm));
END
"
35418,Access - SQL Query -> find most recent record and save it to a table,"SELECT TOP 1 * 
FROM tblHistory a
INNER JOIN 
   (SELECT Unit Number, Max([Date]) as MaxDate 
    FROM tblHistory
    GROUP BY Unit Number) b
on a.[Unit Number] = b.[Unit Number]
and a.[Date] = b.MaxDate
"
38197,Compare elements by Linked Server rules for values (MSSQL+ Linked MySQL),"select t.student,
     t.grade,
     t.expected,
     case 
        when m.val > m1.val then 'Above Target'
        when m.val < m1.val then 'Below target'
        else 'on target'
        end as achievements
     from students t
left join (select * from openquery(mysql, 'select * from Grade')) m on t.grade = m.grade
left join (select * from openquery(mysql, 'select * from Grade')) m1 on t.expected = m1.grade
"
20894,Find XML Elements Name in SQL,"select
    T.C.value('local-name(.)', 'nvarchar(max)') as Name
from @xml.nodes('D/*') as T(C)
"
27296,SQL for loop using IDs returned in Select statement,"declare @importFileID int
declare @cur cursor

set @cur = cursor fast_forward for 
select importfileid from import.importfiles where importfilestatusid < 7

open @cur
fetch next from @cur into @importFileID
while(@@fetch_status = 0)
begin
  exec [import].[spDeleteFromAllImportRelatedTables] @fileID = @importFileID
  fetch next from @cur into @importFileID
end
close @cur
deallocate @cur
"
10742,Query to return 2 random and one specific result,"order by (fruit = 'Melon') desc,
         rand()
limit 3;
"
6369,SQL Get all records older than 30 days,"SELECT * from profiles WHERE to_timestamp(last_login) < NOW() - INTERVAL '30 days' 
"
31696,Order BY one table in MySQL,"SELECT   p.* 
FROM     People p
JOIN     Companies c ON c.ID = p.CompaniyID
WHERE    --(Some where clause) 
ORDER BY c.Name ASC
"
36757,How to pass a bash variable into an sql file,"#!/bin/bash
dbase_connect=""psql -h server -U username dbase""
file=""/tmp/$fname.csv""
sql=""/home/user/sql_files/query.sql""
tmp=""home/user/sql_files/query.sql.tmp""
s=""s/\$1/$1/g""
cat $sql | sed $s > $tmp

sudo bash -c ""$dbase_connect -c -q -A -F , -f $tmp -o $file""
rm -f $tmp
"
8330,SQL select query help required,"SELECT  t.*
FROM    (
    SELECT  @lim := 2,
            @cg := ''
    ) vars,
    (select * from Table1 order by product,amount, make)  t
WHERE   CASE WHEN @cg <> product THEN @r := @lim ELSE 1 END > 0
    AND (@r := @r - 1) >= 0
    AND (@cg := product) IS NOT NULL
ORDER BY
    product,amount, make
"
15414,Update XML in Oracle using UPDATEXML,"UPDATE MY_TABLE SET XML_COLUMN =
   UPDATEXML(XML_COLUMN,
   '/dok/dataSet[field = ""START_DATE""]/label/text()','The date of start');
"
33513,SQL Syntax select something from a table and insert the result into a new table if it doesn't exist,"INSERT INTO dbo.table2 (UserID)
SELECT UserID
FROM dbo.table1
WHERE NOT EXISTS (SELECT UserID
FROM dbo.table2)
"
22135,Zenoss MySQL Query - Events per hour,"SELECT SUM(c) total
FROM (SELECT COUNT(*) c FROM events.history WHERE firstTime > UNIX_TIMESTAMP(DATE_SUB(NOW(), INTERVAL 1 HOUR)) AND (severity='5' OR severity='3')
      UNION
      SELECT COUNT(*) c FROM events.status WHERE firstTime > UNIX_TIMESTAMP(DATE_SUB(NOW(), INTERVAL 1 HOUR)) AND (severity='5' OR severity='3')
     ) u
"
25653,Separate string csv in oracle,"with s as (select ';' || 'aa;bb;cc' || ';' str from dual)
select 
substr(s.str,instr(s.str, ';',1,1)+1, instr(s.str, ';',1,2)-instr(s.str, ';',1,1)-1), 
substr(s.str,instr(s.str, ';',1,2)+1, instr(s.str, ';',1,3)-instr(s.str, ';',1,2)-1), 
substr(s.str,instr(s.str, ';',1,3)+1, instr(s.str, ';',1,4)-instr(s.str, ';',1,3)-1)
from s
"
8279,running object created by DBMS_SCHEDULER.create_program,"exec dbms_scheduler.create_job(
job_name=>'JOB_RUN_MY_PROGRAM',
program_name=>'PROG_RUN_MY_PROCEDURE',
schedule_name=>'INTERVAL_EVERY_DAY',
enabled=>true,
auto_drop=>false,
comments=>'This will run my scheduler program');
"
20967,converting integer to date and getting records based on this date,"SELECT *
FROM webFormsInstances 
WHERE formStage <> 'Complete' 
      AND formActionDate < CONVERT(int, CONVERT(varchar(8), dateAdd(day,-14, getdate()), 112))
ORDER BY formActionDateTime DESC
"
10178,SQL: How to perform this query over each group,"SELECT t1.ID AS t1ID, t2.ID AS t2ID, 
       SUM(t1.count*t2.count) AS s
FROM mytable AS t1
INNER JOIN mytable AS t2 
  ON t1.ID < t2.ID AND t1.k = t2.k
GROUP BY t1.ID, t2.ID 
"
31685,Trying to figure out top 5 land areas of the 50 states in the U.S,"SELECT m.state, m.landArea
FROM Map m
LEFT JOIN Map m2 on m2.landArea > m.landArea
GROUP BY m.state, m.landArea
HAVING count(*) < 5
ORDER BY m.landArea DESC
"
33212,How do I backup a local SQL Server database in XP?,"BACKUP DATABASE [YourDB] TO  DISK = N'C:\Backup.bak' WITH NOFORMAT, NOINIT,  
NAME = N'YourDB-Full Database Backup', SKIP, NOREWIND, NOUNLOAD,  STATS = 10
"
33750,Get exact match from a string in Netezza,"select regexp_extract('abc abcd','\babc\b');

 REGEXP_EXTRACT
----------------
 abc
(1 row)
"
31158,"MySQL: Count total ""value"" for each occurrence","SELECT Color,SUM(amount) as count FROM tablename
GROUP BY Color ORDER BY count DESC;
"
13990,Atomic read and conditional create or update,"update games set dst_user_id=? where id=? and dst_user_id is null;
"
35098,"Expecting a null returned from XML.value() in SQL, but getting 0","SELECT @SearchFilter.value('(/KeywordSearch/SelfEmployed/text())[1]', 'varchar(100)')
"
20351,Select from two tables with different order column,"select * from 
( select id, title, reg_time as time from tbl_music 
  union all
  select id, title, time_log as time from tbl_movie
) results
order by time
"
22631,To calculate sum() two alias named columns - in sql,";WITH sums AS 
(
   SELECT
      m1, m2, 
      SUM(m1) + SUM(m2) as Total,
      SUM(m1) + SUM(m2) as Total1 
   FROM
      dbo.stud 
   GROUP BY
      m1, m2
)
SELECT 
   m1, m2, 
   total, total1, 
   total+total1 AS 'GrandTotal' 
FROM 
   sums
"
4971,SQL JOIN inside LEFT JOIN,"SELECT * FROM T1
    LEFT JOIN T1_T2 
     ON T1.T1_T2 = T1_T2.T1_T2_id
    LEFT JOIN T1_T2_T3 
     ON T1_T2.T1_T2_T3 = T1_T2_T3.T1_T2_T3_id
"
36270,"Grant permission for creating stored procedure, view and using Select query","GRANT CREATE PROCEDURE TO [login];
GRANT CREATE VIEW TO [login];
GRANT SELECT TO [login];
"
2079,How to use distinct and count for multiple columns in SQL query,"WITH CTE_Testtable AS (
 SELECT 
  Cust_Name,
  Contract,
  Status 
 FROM
  TESTTable
 WHERE
 Status = 'Active'
 GROUP BY 
 Cust_Name, Contract, Status
)
SELECT
 Cust_Name,
 COUNT(Cust_Name) Active_Count,
 STUFF((SELECT ', ' + Contract
  FROM 
   TESTTable B
  WHERE 
   B.Cust_Name = A.Cust_Name 
   AND Status = 'Active'
  GROUP BY Contract
  FOR XML PATH('')), 1, 2, '') 
FROM
 CTE_Testtable A
WHERE
 Status = 'Active'
GROUP BY 
 Cust_Name
"
3706,efficient analysis for large data set by SQL or R?,"CREATE CLUSTERED INDEX index_name
ON [myDB].[dbo].[myTable] (value, cardID, locationID)
"
22245,Cursor to find word Count,"Select @wcount = COUNT(*) from Table where engtitle like concat('%', @Engword, '%')
"
31062,SQL - extract time and offset from it,"SELECT (
  CASE
    WHEN TO_CHAR(datetimefield,'HH24') BETWEEN 12 AND 23
    THEN -1 * (60 * (12 - TO_CHAR(datetimefield,'HH')) - TO_CHAR(datetimefield,'MI'))
    WHEN TO_CHAR(datetimefield,'HH24') BETWEEN 0 AND 11
    THEN 60 * (TO_CHAR(datetimefield,'HH')) + TO_CHAR(datetimefield,'MI')
  END) diff
FROM (select systimestamp datetimefield from dual);
"
25277,database questions in sql,"String query = ""SELECT r.reservation_no, f.flight_no, r.departure_date, f.departure_time, f.duration FROM flights f, reservations r WHERE f.flight_no=r.flight_no AND r.customer_ssn=""?"" "";

PreparedStatement ps = connection.prepareStatement(query);
ps.setString(1, customer_ssn);
result = ps.executeQuery();
"
38429,Find 3 item association rules in SQL Server,"select
    T1.PRODUCTID AS PRODUCTID1,
    T2.PRODUCTID AS PRODUCTID2,
    T3.PRODUCTID AS PRODUCTID3,
    COUNT(DISTINCT T1.ORDERID) AS SUPPORT
FROM transactions T1
JOIN transactions T2 ON T2.PRODUCTID > T1.PRODUCTID AND T2.ORDERID = T1.ORDERID
JOIN transactions T3 ON T3.PRODUCTID > T1.PRODUCTID AND T3.PRODUCTID > T2.PRODUCTID AND T3.ORDERID = T1.ORDERID
GROUP BY T1.PRODUCTID, T2.PRODUCTID, T3.PRODUCTID
"
18428,Get count per year of data with begin and end dates,"select
    <city_id>, c.y, count(t.city_id)
from generate_series(1990, 2005) as c(y)
    left outer join Table1 as t on
          c.y between extract(year from t.start_date) and extract(year from t.end_date) and
          t.city_id = <city_id>
group by c.y
order by c.y
"
9928,something like NOT LIKE (select statement from other table),"SELECT * FROM VALID_LIST WHERE NOT EXISTS 
  (SELECT * FROM PREFIX_LIST WHERE VALID_LIST.Part1 LIKE '%' || Item || '%')
  AND NOT EXISTS
  (SELECT * FROM SUFFIX_LIST WHERE VALID_LIST.Part2 LIKE '%' || Item || '%')
"
8854,"Select count of max items, get rank and percentile","select
    person_id,
    count(*) over() as total_person,
    rank() over(order by score desc) as score_rank
from (
    select distinct on (person_id) *
    from score
    where category_id = 7
    order by person_id, created desc
) s
"
3989,Date comparison in PIVOT table,"SELECT *
FROM 
(
  SELECT ID, ID, Cast(yourDateValue as Date) newdate  -- perform the conversion here
  FROM Table1 
) AS P 
PIVOT 
(   
  COUNT (P.ID)
  FOR newdate in ([08/17/2006], [08/18/2006])  -- [MM/DD/YYYY] - Format
) as pvt
"
34989,How to select a date and ignor the time,"select datepart(dw, CONVERT(DATE,[Order].PerformDate)) 
GROUP BY CONVERT(DATE,[Order].PerformDate)
"
39857,sort query result without selecting that column but sort by that column?,"SELECT empname, salary, status
  FROM (SELECT   *
            FROM emp
        ORDER BY empno)
 WHERE salary > 5000
"
25810,Integer fields appearing as #### in crystal report,"1234567   <---- big number
|...|     <---- field length on report too small
"
22030,How to match keywords with SQL query?,"SELECT * FROM items 
  WHERE 
  MATCH (category,keyword1,keyword2,keyword3,keyword4,keyword5) 
  AGAINST ('pizza') 
  AND 
  MATCH (category,keyword1,keyword2,keyword3,keyword4,keyword5) 
  AGAINST ('restaurant');
"
14285,add a specific column to all tables that exist in an oracle database,"select 'alter table ' || table_name || ' add (newcol varchar2(20));'
from user_tables
"
29057,SQL Duplicate Entries (Having Blackout),"; WITH cte AS (
    SELECT RelationID, ROW_NUMBER() OVER (PARTITION BY ConID, ProID ORDER BY [INT]) AS rnum
    FROM YourTable
)
DELETE FROM YourTable 
WHERE RelationID in (SELECT RelationId FROM cte WHERE cte.rnum > 1)
"
38415,Is it possible to report on 2 tables without using a subquery?,"SELECT *
FROM building
LEFT JOIN (SELECT building, etc. FROM men GROUP BY etc.) AS men_summary
    ON building.name = men_summary.building_name
LEFT JOIN (SELECT building, etc. FROM women GROUP BY etc.) AS women_summary
    ON building.name = women_summary.building_name
"
35279,SQL Update (simple??),"--Do this select first for safety
select c.CustomerName, m.CorrectedName
from TableCustomers c join TableCustomerMapping m on c.CustomerName = m.WrongName

--Update if okay
update c
set c.CustomerName = m.CorrectedName
from TableCustomers c join TableCustomerMapping m on c.CustomerName = m.WrongName
"
9527,SQL query with 2 foreign keys from one table,"SELECT  p.Id,
        u1.Name OwnerName,
        u2.Name ClientName
FROM    Projects p
        LEFT JOIN
                Users u1
                ON p.Owner = u1.Id
        LEFT JOIN
                Users u2
                ON p.Client = u2.Id
"
21402,How to use the result of a built-in SQL function twice in a single query?,"select case 
        when substr1 is null
            then '????'
        when substr1 in ('000', '010', '018')
            then '100L'
        when substr1 = '123'
            and substring(A, 8, 3) = 'abc'
            then 'xxx'
        end
from (
    select substring(A, 4, 3) as substr1 from MyTable
    ) a
"
3986,MySQL query returns duplicate rows,"select distinct group_concat(lot order by lot)
from `mytable`
group by product
having group_concat(tag order by tag) = '101,102';
"
27049,"Simple task: Connect to database, execute a stored procedure, disconnect","Dim sServer, sConn, oConn, sDatabaseName, sUser, sPassword
sDatabaseName=""test""
sServer=""localhost""
sUser=""sa""
sPassword=""yourpassword""
sConn=""provider=sqloledb;data source="" & sServer & "";initial catalog="" & sDatabaseName

Set oConn = CreateObject(""ADODB.Connection"")
oConn.Open sConn, sUser, sPassword
oConn.Execute ""exec sp_help""

WScript.Echo ""executed""
oConn.Close
Set oConn = Nothing
"
32683,Efficiently find mapping,"select T.item1, concat(T.item2, "", "") from T group by T.item1
"
26970,Oracle Get two variables returned from select query inside of a package,"SELECT myPrev, myNext INTO prevContentID, nextContentID
from myTable
where contentID = theContentID;
"
7444,SQL All Possible Round Robin Combinations between two Tables,"select P1.NAME PERSON1, P2.NAME PERSON2
  from (select rownum RNUM, NAME
        from PERSON) P1,
       (select rownum RNUM, NAME
          from PERSON) P2
 where P1.RNUM < P2.RNUM
"
12117,Max over multiply columns,"SELECT * FROM 
(SELECT ID, Date, Histroy
 FROM PersHist
 WHERE ID = 1
 ORDER BY Date DESC, Histroy DESC)
WHERE ROWNUM = 1
"
30296,Adding a unique ID number to a difference of tables,"with cte as (
select * 
from sys.tables
), maxid as (
    select MAX(OBJECT_ID) maxid from sys.tables
)
select 
    rn = maxid + ROW_NUMBER() over (order by name), *
from cte
cross join maxid
"
14450,"Remove rows from SQL when ""CASE ELSE"" happens","with TempResult (id, status)
as
(
    select primary_key_column,
           case when table.field1 = 1 then 1
                when table.field2 = 3 then 3
                when table.field2 = 4 then 4
                when table.field3 = 1 then 5
                else 0
    from table
)

select id
from TempResult
where status > 0
"
17469,Sql case with case Order by," select id, username, email, 
             case when username = email 
                  then 'true'
                  else 'false' 
             end as usr_is_email
 from users
 order by usr_is_email
"
15913,How to get Max of ID without use of MAX(),"SELECT id
FROM table
ORDER BY id DESC
LIMIT 1
"
18798,SQL Server - Conditional OUTER APPLY,"SELECT t1.*, t2.*
FROM   t1 cross join
       (SELECT *
        FROM (SELECT top 1 tb10.*, 0 as bCcond src FROM tb10 
              UNION ALL
              SELECT top 1 tb11.*, 1 as bCcond src FROM tb11
             ) t
        WHERE @bCond = bCcond
       ) t2
"
33204,sql issue with having clause,"with x as 
(select model,ram,count(ram) as config
from pc 
group by model,ram)
, y as 
(select model, max(config) as mxconfig from x group by model)
select x.model, x.ram --choose max(x.ram) or min(x.ram) in case of a tie and group by x.model
from x join y on x.model = y.model and x.config = y.mxconfig
"
10631,What query returns the list of columns that are text indexed in Oracle?,"SELECT * FROM CTXSYS.CTX_INDEXES;
"
24626,Access SQL - Select only the last sequence,"select t.*
from t join
     (select id, MAX(sequence) as maxs
      from t
      group by id
     ) tmax
     on t.id = tmax.id and
        t.sequence = tmax.maxs
"
2444,Outer join with conditions?,"  select v.text_value as volume_value, i.text_value as issue_value
      from ( select item_id, text_value
               from metadatavalue
              where metadata_field_id = 90) v
           full join
           ( select item_id, text_value
               from metadatavalue
              where metadata_field_id = 91) i
           using (item_id)
"
13904,Summing amount attribute according to some entry in other attribute,"SELECT 
   Amount
  ,Currency
  ,(SELECT SUM(Amount) FROM TableName WHERE Currency = 'USD' GroupBy Currency) as USD_SUM
  ,(SELECT COUNT(*) FROM TableName WHERE Currency = 'USD) as USD_Count
..... Repeat for other currencies

FROM TableName
"
18361,Create an SQL query that checks the column name for a select string of words,"select company, hc_version, max(av_version) as av_version
from 
(
    select company, av_version, '8.5.0' as hc_version
    from avcom
    where av_version like '8.5.0%'
)
group by company, hc_version
"
9916,Is there a opposite function to ISNULL in sql server? To do Is not null?,"SELECT CASE WHEN Field IS NOT NULL
    THEN 'something'
    ELSE 'something else'
END
"
26297,How to use only one matching row of association table to join parents,"select
   A.col1,
   B.col1
from A
join (select 
        FK_A,
        FK_B, 
        row_number() OVER (partition by FK_A ORDER BY FK_B) as rn
      from AB 
     ) jtable ON A.PK_A = jtalbe.FK_A AND rn = 1
join B ON B.PK_B = jtable.FK_B
"
10349,SQL store rate changing in time and SELECT rate valid for particular time instant,"with scd_table (
    select  a.*  , 
            lead(from_date,1,to_date('31/12/9999','dd/mm/yyyy')) over (partition by a order by from_date asc) as to_date
    from    YOUR_TABLE a
)
select  * 
from    scd_table
where   :d >= from_date
and     :d < to_date
"
8866,Figuring out a join between two users excluding where column does not exist for one," SELECT * FROM user_answers t1
 where t1.uid=1 and t1.quid in 
 (select t2.quid from user_answers t2 where t2.uid=2);
"
8768,SQL count largest per category 3 tables,"Select top 5 c.name, count (fc.film_id)
From film_category as fc
Inner join category as c 
    on c.category_id = fc.Category_id
Group by c.name
Order by count (fc.film_id) desc
"
2257,How to arrange a daily time log entry form in Microsoft Access 2007 with Weekdays & Dates in the column headings,"DETable

EmployeeID
WeekStarting
ProjectID
Workcode
Mon
Tue
<...>
Sat
"
37243,sql query: multiple rows append to show in one row,"SELECT 
   STUFF((SELECT ' ' + EmployeeName
          FROM dbo.Employee
          FOR XML PATH('')), 1, 1, '')
"
39760,select a max for all records,"select t.*, tmax.date as highpricedate, tmax.price as highprice
from tblstock t outer apply
     (select top 1 t2.*
      from tblstock t2
      where t2.symbol = t.symbol
      order by t2.price desc
     ) tmax;
"
11305,MYSQL: LIKE with Except Condition,"select schema_name 
  from information_schema.schemata
 where schema_name like '%sample%'
   and schema_name not like '%fallback%'
"
18753,WordPress DB Query to count number of users registered per day,"select 
count(*) as total_users ,
date(user_registered) as reg_date 
from wp_users 
group by reg_date 
having total_users > 0 
"
28433,"Solr, multiple indexes","concat('product-',cast(ProductId as char)) as id,
'product' as type,
"
13078,Find duplicates in a one to many relationship in SQL,"SELECT words, count(*), group_concat(idtag) as tags
FROM (SELECT idTag, GROUP_CONCAT(idWord order by position ASC SEPARATOR ' ') AS words
      FROM tTagWord
      GROUP BY idTag
     ) t
GROUP BY words
HAVING count(*) > 1;
"
2900,SQL get the value above(larger) and below(smaller) of an inbetween value in a select statement,"select 'max', max(thickness) value from thicknesses where thickness < requirement 
union
select 'min', min(thickness) value from thicknesses where thickness > requirement 
"
23760,file conversion- .mwb to .sql file,"mysql -u yourUser -p yourDatabase < yourFile.sql
"
6135,"Good database design, variable number of attributes","INVENTORY( id*, model, manufacturer, serial )
ATTRIBUTE( id*, name, type, description )
INVENTORY_FACT_STRING( inv_id*, attr_id*, value )
INVENTORY_FACT_NUMBER( inv_id*, attr_id*, value )
INVENTORY_FACT_LIST_STRING( inv_id*, attr_id*, ordinal*, value )
"
9405,DELETE ... FROM ... WHERE ... IN,"DELETE
  FROM table1
 WHERE exists(
           SELECT 1
             FROM table2
            WHERE table2.stn = table1.stn
              and table2.jaar = year(table1.datum)
       )
"
30177,how to get count(*) value in local temp variable in dynamic sql (ORACLE PLSQL),"function count_rows(p_table_name varchar2)
  return number
is
  l_count number;
begin
  execute immediate 'select count(*) from ' || p_table_name returning into l_count;
  return l_count;
end count_rows;
"
17965,Swap columns from two sql server tables,"update table1 t1
set    t1.col1 = (select t2.col2
                  from   table2 t2
                  where  t2.id = t1.id
                  and    t1.col1 < t1.col2)
"
22967,How do I return random numbers as a column in SQL Server 2005?,"select column1, column2, 
  ABS(CAST(CAST(NEWID() AS VARBINARY) AS int)) % 10000 as column3 
from table1
"
37940,How to Convert text values to integer values,"UPDATE adresse 
SET postcode_int = CAST(postcode AS INT)
"
39585,oracle sql to get all possible combinations in a table,"SELECT * 
FROM test01
WHERE '100000' LIKE REPLACE(REPLACE(fund, 'x', '_'), 'X', '_')
  AND  '67130' LIKE REPLACE(REPLACE(org,  'x', '_'), 'X', '_') ;
"
20148,How to pick a value that exists only between range of data entries?,"SELECT Event 
FROM MyTable
WHERE date(`Date`) <= '1980-01-14'
ORDER BY `Date` DESC
LIMIT 1;
"
6757,Dynamically create tables based on comma delimited string in SQL stored proceedure,"BEGIN
       v_sql:='Create table empx (id int)';
       execute immediate v_sql; 
END;
"
38997,Pivot with Join in SQL Server 2008,"select c.CountyID ,c.CountyName,
   count(case when T.WorkTypeID=1 and M.ISFlagEnabled=0 then 1 end ) as Research,
     count(case when T.WorkTypeID=2 and M.ISFlagEnabled=0 then 1 end) as Quality
from  TblCOuntyWorkTypeMapping M
join  TblCOunty C
on    M.CountyID=C.CountyID
join  TBLWorkType T
on    M.WorkTypeID=T.WorkTypeID
group by c.CountyID ,c.CountyName
"
8899,"help need for sql query, select latest 5 lists of each category","(select * from items where category_id=1 order by add_date desc limit 5)
union
(select * from items where category_id=2 order by add_date desc limit 5)
union
(select * from items where category_id=3 order by add_date desc limit 5)
union
(select * from items where category_id=4 order by add_date desc limit 5)
union
(select * from items where category_id=5 order by add_date desc limit 5);
"
24490,Updating duplicate column with value,"with NT as  (
select 
  ID,
  Row_Number() over (PARTITION BY RedirectLink ORDER BY ID)-1 as Nr
from Table1
)
update T  
  set T.RedirectLink = T.RedirectLink + '_' + cast(NT.Nr as varchar)
FROM Table1 T
JOIN NT ON (NT.ID = T.ID)
where Nr>0
"
39726,Filter Table Before Applying Left Join,"SELECT c.Customer, c.State, e.Entry
FROM Customer c
LEFT JOIN Entry e
   ON c.Customer=e.Customer
   AND e.Category='D'
"
6332,Updating all tables with null dates,"Update table1
SET CreationDate = ISNULL(CreationDate,GETDATE())
  , LastModifiedDate = GETDATE()
WHERE CreationDate is null or LastModifiedDate is null

Update table2
SET CreationDate = ISNULL(CreationDate,GETDATE())
  , LastModifiedDate = GETDATE()
WHERE CreationDate is null or LastModifiedDate is null

Update table3
SET CreationDate = ISNULL(CreationDate,GETDATE())
  , LastModifiedDate = GETDATE()
WHERE CreationDate is null or LastModifiedDate is null
"
30640,SQL Sum of last X Sum of records,"with bydays as (<your query here>)
select bd.*,
       (select sum(NumMeasured) from (select top 100 * from bydays bd2 where bd2.date <= bd.date order by date desc) t
       ) as Measured100,
       (select sum(NumPassingd) from (select top 100 * from bydays bd2 where bd2.date <= bd.date order by date desc) t
       ) as Measured100
from bydays
"
32771,Caching database data,"Rails.cache.write(:records, @records)
"
10085,Why do I keep getting 0 when dividing,"CAST(SUM(weight_score * (45.0/100.0)) as decimal(10,2)) As avg_score
"
10502,Choose different column on SELECT if one is empty,"
select coalesce(update_date,pub_date),update_date,pub_date
from yourtable 
"
12069,Left outer join is not working on column with repeated id,"SELECT t.title
     , s.value
  FROM table1 t
  LEFT
  JOIN table2 s 
    ON s.id = t.id 
   AND s.category = ""good""
"
30778,Ordering SQL query by specific field values,"Order By Case Edition
    When 'NE' Then 1
    When 'OE' Then 2
    When 'OP' Then 3
    Else 4 End
"
35113,SQL Exclude and Move columns on Left outer Join,"SELECT t1.Name as Emp, 
       coalesce(t2.name,t3.name) as Mg1, coalesce(t2.title,t3.title) As Title1, 
       case when t2.name is not null then coalesce(t3.name,'') else '' end as Mg2, 
       case when t2.title is not null then coalesce(t3.title,'') else '' end as Title2
FROM @table1 t1
LEFT OUTER JOIN @table2 t2 ON t1.id = t2.fid AND t2.etype = 123
LEFT OUTER JOIN @table2 t3 ON t1.id = t3.fid AND t3.etype = 234
"
11988,how to delete duplicates from a database table based on a certain field,"delete from tbl
where id NOT in
(
select  min(id)
from tbl
group by sourceid
)
"
17892,Oracle : Search between two Timestamps is not working,"select * 
from event_detl 
where START_DT 
 between to_timestamp('02-07-2014 14:24:03', 'dd-mm-yyyy hh24:mi:ss') 
  and to_timestamp('02-07-2014 14:24:05', 'dd-mm-yyyy hh24:mi:ss'
"
24860,Select one (highest) score per userid OR nickname column,"SELECT   nickname, userid, MAX(score)
FROM     my_table
GROUP BY nickname, userid
"
29654,Alter auto-generated sequence,"TRUNCATE table RESTART IDENTITY;
"
14448,infinite trigger loop....by design(!). How to work-around?,"USE DatabaseName
GO
EXEC sp_configure 'show advanced options', 1
GO
RECONFIGURE
GO
EXEC sp_configure 'nested triggers', 0
GO
RECONFIGURE
GO
"
7412,SQL Full Text Index Contains,"SELECT TOP 100 *
FROM OMG_PRODUCTFEEDS.DBO.TBL_PRODUCTS
WHERE CONTAINS(PRODUCTNAME,'""APPLE IPHONE 6""')
AND product_category_id = 1;
"
8996,Select all rows where a varchar column converts to a decimal,"select * from YourTable where ISNUMERIC(col1) = 1
"
2610,CASE WHEN 'All',"WHERE [dbo].[ID] = CASE  @var
  WHEN 'a' THEN 0
  WHEN 'b' THEN 1
  WHEN 'c' THEN 2
  WHEN 'd' THEN 3
  WHEN 'e' THEN 4
  WHEN 'all' THEN [dbo].[ID] 
END
"
26646,SQL DataRetrival in VB.net Datatypes Error,"connection = New System.Data.OleDb.OleDbConnection(""Provider = Microsoft.Jet.OLEDB.4.0 ;Data Source="" & Filepath & "" ;Extended Properties='Excel 8.0;HDR=Yes;IMEX=1;'"")
"
8534,update query result not reflecting in table,"UPDATE test2 t2 
 SET t2.name = (SELECT t1.name 
                 FROM test1 t1 
                WHERE t1.id = t2.mob)
"
39774,group by query challenge,"select c.id, count(o.order_id),sum(if(o.discount,1,0))
from customer c 
left join order as o using c.customer_id = o.customer_id
group by c.id
"
19990,How to make logics for field with GROUP BY / Can I use text field as SQL logic?,"USE AdventureWorks2008R2;
GO
SELECT JobTitle, MAX(ph1.Rate)AS MaximumRate
FROM HumanResources.Employee AS e
JOIN HumanResources.EmployeePayHistory AS ph1 ON e.BusinessEntityID = ph1.BusinessEntityID
GROUP BY JobTitle
HAVING (MAX(CASE WHEN Gender = 'M' 
        THEN ph1.Rate 
        ELSE NULL END) > 40.00
     OR MAX(CASE WHEN Gender  = 'F' 
        THEN ph1.Rate  
        ELSE NULL END) > 42.00)
ORDER BY MaximumRate DESC;
"
2647,duplicate answers when predicate in more than one field SQL,"SELECT 
    a.*

FROM 
    addresses a
        JOIN
    individuals i
    ON a.AddressID = i.AddressID

GROUP BY
    a.StreetName, i.FirstName, i.Surname

HAVING
    COUNT(1) > 1
"
2355,How to login to MySQL and execute a select from command line,"mysql -u root -e""use mysql; select * FROM user;""
"
25348,Dynamic/Conditional SQL Join?,"SELECT [dbo].tableB.theColumnINeed
FROM   [dbo].tableA 
LEFT OUTER JOIN [dbo].tableB
ON [dbo].tableA.myColumn = 
   CASE
    WHEN [dbo].tableA.myDateColumn <= '1/1/2009' THEN FormatColumnOneWay([dbo].tableB.myColumn)
    ELSE FormatColumnAnotherWay([dbo].tableB.myColumn)
   END
"
13048,Comparing two records from different tables and deleting those that match,"strSQL_count = ""SELECT COUNT(email) AS 'count' FROM emails INNER JOIN CustRecords ON CustRecords.Email = emails.email""
Set rs = conn.Execute(strSQL_count)

count = rs(""count"")

strSQL = ""DELETE emails FROM emails INNER JOIN CustRecords ON CustRecords.Email = emails.email""
Set rs = conn.Execute(strSQL)
"
390,SQL Query - Distinct results,"select  People.ID
,       count(distinct Species)
from    People
join    Pet
on      Pet.OwnerID = People.ID
group by
        People.ID
"
36688,SQL Conditional / Case Joining / Polymorphic Associations?,"select e.id, coalesce(u.name, o.name) owner_name
from events e
left join users u on e.owner_id = u.id and e.owner_type = 'user'
left join organisations o on e.owner_id = o.id and e.owner_type = 'org'
"
20195,i am trying to use an input from the user as part of a connection string to a SQL database,"Dim str As String = ""Data Source=DESKTOP; uid="" & ID & ""; pwd="" & PASS & "";database=DB"" 
"
38464,Combine like primary keys in MySQL JOIN result,"SELECT u.id, sum(p.amt) as payment
FROM units u inner JOIN payments p ON u.id = p.unit
group by u.id
"
25699,mysql count group by having,"SELECT count(*)
FROM (
   SELECT COUNT(Genre) AS count
   FROM movies
   GROUP BY ID
   HAVING (count = 4)
) AS x
"
32196,getting specific index from sql,"SELECT *, ROW_NUMBER() OVER(ORDER BY [youordercolumns]) AS [RowNum]
FROM [youtable]    
WHERE [RowNum] BETWEEN @index AND @index + 4
"
9946,"SQL query to find EmployeeName, Manager Name from a table","SELECT one.EmployeeName AS ""Employee"", two.EmployeeName AS ""Manager""
FROM Employee AS one
INNER JOIN Employee_Manager AS temp ON one.EmployeeId = temp.EmployeeId
INNER JOIN Employee AS two ON temp.ManagerId = two.EmployeeId
"
27110,Get record between two time,"SELECT * FROM TBL 
WHERE  
('09:00' between [StartTime] AND [EndTime]) or ('11:00' between [StartTime] AND [EndTime])
"
14230,ORACLE SQL: only show specific value if appears more than once,"select
  min(LN) as first,
  SRCREF 
from
  YourTable t
group by
  SRCREF 
order by
  min(LN)
"
18700,Jquery flowplayer a href needs two clicks?,"<a href=""-previous page-""> Back </a> 
"
22992,MySQL DISTINCT ignored in SELECT displays duplicate,"SELECT FirstName, LastName, r.Email, min(ListingID) as ListingID, ListingFirmID
    FROM sancap_Residential_Property e 
    JOIN sancap_Agent r ON e.ListingAgentID = r.AgentID
    JOIN sancap_Office d ON e.ListingFirmID = d.firmID
    WHERE ListingFirmID != 'BrokerC'
GROUP BY FirstName, LastName, r.Email, ListingFirmID
"
16969,get posts that I have commented on with new comments?,"SELECT DISTINCT p.*
FROM posts p
INNER JOIN comments c
ON c.post_id = p.id
WHERE c.comment_timestamp > (
   SELECT MAX(c2.comment_timestamp)
   FROM comments c2
   WHERE c2.post_id = c.post_id
   AND c2.user_id = $current_user_id
) 
"
31291,Refresh the Database Table,"DELETE MyTable 
FROM MyTable
LEFT OUTER JOIN (
   SELECT MIN(RowId) as RowId, Col1, Col2, Col3 
   FROM MyTable 
   GROUP BY Col1, Col2, Col3
) as KeepRows ON
   MyTable.RowId = KeepRows.RowId
WHERE
   KeepRows.RowId IS NULL
"
34745,MSSQL: Select rows with more than 2 occurances in another table,"SELECT campaigntitle, StaffNo, COUNT (CAMPAIGNTITLE) As [count]
  FROM WORKSON
 WHERE StaffNo IN
       (SELECT STAFFNO
          FROM STAFFONGRADE
         WHERE GRADE > 2)
 GROUP BY CAMPAIGNTITLE
HAVING COUNT(CAMPAIGNTITLE) >2
"
10516,Setting a variable,"SET @MinOrder = SELECT MIN(UnitPrice)
                  FROM [Order Details]
                 WHERE CustomerNumber = 'ALFKI'
"
19447,Script to disable an oracle trigger,"DECLARE
CURSOR cur_trigger IS
SELECT 'ALTER TRIGGER ' ||
       table_owner ||
       '.' ||
       trigger_name ||
       ' DISABLE' SQLStatement
FROM all_triggers
WHERE trigger_name like '%TEST%';
sqlText cur_trigger%ROWTYPE;

BEGIN
  OPEN cur_trigger;
  LOOP
    FETCH cur_trigger INTO sqlText;
    EXIT WHEN cur_trigger%NOTFOUND;

    EXECUTE IMMEDIATE sqlText.SQLStatement;
  END LOOP;
  CLOSE cur_trigger;
END;
"
35710,"SQL: Count number of columns in all tables, excluding views","SELECT 
    t.name,
    count(c.name)
FROM 

    sys.tables t 
    inner join sys.columns c
    ON t.object_id = c.object_id


group by t.name
"
26108,Calling Jasperreports from Oracle forms,"v_url := '<your url to the report>';
host ('cmd /c start '||v_url); 
"
31017,how to add specific time to current time using DateAdd?,"dateadd(MINUTE, 30, dateadd(HOUR, 2, @dateyouaddto))
"
25470,How to change the db name dynamically using one db  storedprocedures to another db storedprocedures?,"-- assume @dbname has the name of the database where getdetails was created
declare @sql nvarchar(4000), @params nvarchar(4000), @dbname sysname
set @dbname = 'test'
set @sql = @dbname + '..getdetails'
set @params = ''
exec sp_executesql @sql, @params
"
1987,Get previous / next record in sqlite,"SELECT DISTINCT name FROM items
WHERE something = 'foo'
AND name < (SELECT name FROM items WHERE name = ...)
ORDER BY name DESC
LIMIT 1
"
5357,Randomly Assign Records From One Table to Another,"select *
from
 (
   select dt.*, row_number() over (order by t1.r) as rn
   from
    ( 
      select t1.*, RANDOM(1,1000000) as r from t1
    ) as dt
 ) as a
join
 (
   select dt.*, row_number() over (order by t1.r) as rn
   from
    ( 
      select t2.*, RANDOM(1,1000000) as r from t2
    ) as dt
 ) as b   
  on a.rn = b.rn
"
20290,CREATE TABLE AS select * from partitioned table,"select dbms_metadata.get_ddl('TABLE', 'NAME_OF_EXISTING_TABLE')
from dual;
"
19582,How to count distinct elements from different tables in mysql?,"select id, count(id)
from(
  select id from d1
  union all
  select id from d2
  union all
  select id from d3
) t
group by id
"
15969,SQLite: query excluding rows depending on combinations of values from other columns,"WITH
excluded_positions(position_x, position_y, position_z) AS (
  VALUES (10, 30, 500),
         (45, 0, 75),
         ...),
excluded_rowids AS (
  SELECT mytable.rowid
  FROM mytable
  JOIN excluded_positions USING (position_x, position_y, position_z))
SELECT ValuesA, ValuesB, ValuesC
FROM mytable
WHERE ...
  AND rowid NOT IN excluded_rowids
"
28691,SQL: Help with a nested queries,"SELECT s.*
  FROM SUPPLIER s
  JOIN (SELECT c.sid,
               COUNT(c.pid) AS num_parts
          FROM CATALOG c
      GROUP BY c.sid) x ON x.sid = s.sid
  JOIN (SELECT COUNT(*) AS total_parts
          FROM PARTS) y ON y.total_parts = x.num_parts
"
33299,Database Paging by stored procedure,"DECLARE @PageNumber INT, @PageSize INT
SET @PageNumber = 3
SET @PageSize = 5;

WITH CTE AS
(
    SELECT *, ROW_NUMBER() OVER(ORDER BY RateID) Corr
    FROM Rate
    WHERE Hourly = 0
)
SELECT *
FROM CTE
WHERE Corr BETWEEN @PageNumber*@PageSize AND @PageNumber*@PageSize+@PageSize-1
"
34250,Oracle 12c Identity column with Fluent Nhibernate,"Id(x => x.Id).Column(""ID"").GeneratedBy.SequenceIdentity(""Your_Sequence_Name"")
"
15095,SQL Server - Most Efficient Way to Replace Multiple String Patterns,"select t.*, t_r12.col_r
from t outer apply
     (select replace(t.col, 'in1', 'out1') as col_r) t_r01 outer apply
     (select replace(t_r01.col_r, 'in2', 'out2') as col_r) t_r02 outer apply
     (select replace(t_r02.col_r, 'in3', 'out3') as col_r) t_r03 outer apply
     . . .;
"
18007,Join tables with values depending on column value,"SELECT L.*, s.numericVal 
  FROM LongTable l 
  JOIN sortTable s
    ON l.GL = s.GL
"
26017,Display vertica records vertically in vsql,"dbadmin=> select 1,2;
 ?column? | ?column?
----------+----------
        1 |        2
(1 row)

dbadmin=> \x
Expanded display is on.
dbadmin=> select 1,2;
-[ RECORD 1 ]
?column? | 1
?column? | 2

dbadmin=> select 1,2;
 ?column? | ?column?
----------+----------
        1 |        2
(1 row)

dbadmin=> \x
Expanded display is on.
dbadmin=> select 1,2;
-[ RECORD 1 ]
?column? | 1
?column? | 2
"
34878,Select where another table is equal to,"SELECT *      
  FROM queue      JOIN link 
    ON queue.pid = link.id  
 WHERE EXISTS(SELECT 1 FROM settings WHERE process = 1)
 ORDER BY timestamp DESC 
"
24465,How to query a table and display NULL on the joined table if it does not meet the filter?,"select v.organizer, (cases i.vacation_id is null then i.value else null end)
from Vacation as v
left join itinerary as i
   on v.vacation_id = i.vacation_id
"
12399,Need SQL to Get Max of row based on my specific column while joining,"select *
from (
    select t1.account, t1.ID, t2.NAME, t2.CHILDAC, 
           row_number() over (partition by t2.Childac order by t1.id desc) rn
    from t1 
        join t2 on t1.ID = t2.ID
) t
where rn = 1
"
18714,Get Last Record of same ColumnID,"WITH CTE AS
(
    SELECT TableID,EntityID,InvoiceAmount,Date,
        RN = ROW_NUMBER() OVER (PARTITION BY EntityID ORDER BY Date DESC)
    FROM dbo.TableName
)
SELECT InvoiceAmount FROM CTE 
WHERE RN = 1 
-- AND EntityID = 46
"
8612,How to search for a string in multiple Stored Procedure Queries,"SELECT OBJECT_NAME(M.object_id), M.*
FROM sys.sql_modules M
JOIN sys.procedures P
ON M.object_id = P.object_id
WHERE M.definition LIKE '%YourTable%'
"
36933,How exact match string in sql,"select * 
from TransDetail TD
where TD.ModUserId ='PC'
"
26595,UPDATE command SET @return = [int_a] = [int_a] + auto_increment WHERE <clause>,"...

UPDATE dbo.system_numbers
SET @return_value = current_number = current_number + auto_increment,
    last_updated_on = GETDATE()
WHERE [type] = @parmtype
  AND auto_increment = 1
;
IF @@ROWCOUNT = 0
  SELECT @return_value = current_number
  FROM dbo.system_numbers
  WHERE [type] = @parmtype
;
"
26217,Optimizing SQL SERVER 2005 query,"SELECT Calendar.dt AS Fecha, Calendar.Y, Calendar.M, Calendar.D, Calendar.H, Energia AS HidroConv
FROM Calendar 
    LEFT OUTER JOIN OMP_PDBC_STOTA O 
        ON Calendar.Y = O.Anyo AND Calendar.M = O.Mes 
        AND Calendar.D = O.Dia AND Calendar.H = O.Hora 
WHERE  
    Calendar.dt BETWEEN '12/31/2013' AND '01/01/2014' 
    AND Codigo = 1
ORDER by dt, h
"
14258,alter stored procedure to use snapshot isolation level,"USE [myDB]
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
ALTER PROCEDURE [dbo].[myStoredProcedure]

AS
BEGIN
    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

    SELECT *
    FROM someTable
END
"
33240,Returning SQL LIKE & GROUP BY results,"SELECT SUBSTRING_INDEX(`notes`, ',', 1), COUNT( `user` ) AS Count
FROM `people`
WHERE `notes` LIKE ""%hair%""
GROUP BY SUBSTRING_INDEX(`notes`, ',', 1)
"
24685,UPDATE with select query adding NULL rows,"update blanko b1
join jml_virtuemart_products v1 on v1.product_sku = b1.product_sku
set b1.virtuemart_product_id = v1.virtuemart_product_id
"
20121,How to write correct query to find students not currently in a course,"SELECT s.studentId, s.Forename
FROM Student s
WHERE s.studentId NOT IN (SELECT studentId 
FROM  Student_Course c WHERE c.courseId = 1) AND s.Active = 1
"
21494,Detecting Data Transitions in SQL Data using View and Lag(),"create view alarming_data as
   select id, data1, data1high, data1.low
   from (select sd.*, lag(data1) over (order by id) as prevvalue
         from SensorData sd
        ) sd
   where data1 <> prevvalue;
"
5196,How to get the six week sunday's weekno in SQL server 2008 r2?,"SELECT DATEPART(week,'18-nov-2012')
"
7347,SQL order by numeric and string attributes,"SELECT [Task], [Start Date] AS Start_Date, [End Date] AS End_Date, [Priority], [Time     Allowance] AS Time_Allowance, [Details] FROM [schedulerData0]
ORDER BY (CASE Priority
  WHEN 'Very High' Then 1  
  WHEN 'High' Then 2 
  WHEN 'Medium' Then 3 
  WHEN 'Low' Then 4 
  WHEN 'Very Low' Then 5
END), [Start Date] ASC, [End Date] DESC
"
12421,SQL - Select rows that contain a NULL value in a non-nullable column,"SELECT group_concat(`COLUMN_NAME`) as myList 
FROM `INFORMATION_SCHEMA`.`COLUMNS` 
WHERE `TABLE_SCHEMA`='yourdatabasename' 
    AND `TABLE_NAME`='yourtablename'
--  AND `IS_NULLABLE`='NO'
into @colname;
SET @query = CONCAT('SELECT ',@colname,' FROM yourtablename');
PREPARE stmt FROM @query;
EXECUTE stmt;
"
35682,How can I use an oracle keyword as an alias?,"SELECT DATA.EXT_ID AS ""NUMBER"" FROM DATA;
"
4057,SQL - Finding maximum date in set of rows along with all other data,"SELECT 
   (SELECT Max(StartDate) FROM myTable WHERE phName = ""Name"") as MaxDate, 
   id, name , phName , startDate, endDate
FROM myTable
WHERE phName = ""Name""
"
7385,Add grouping column to ordered table,";with q as (
    select *,
           row_number() over (order by id)
         - row_number() over (order by zoneid, id) as grp
      from thetable
)
select id, sog, zoneid,
       min (id) over(partition by zoneid, grp) as grp
  from q
 order by id
"
5755,Replace first few characters of field in an update statement,"UPDATE my_table
SET    col1 = CONCAT('xxx-xxx-' , SUBSTR(col1, 9))
WHERE  col1 LIKE '%abc%'
"
38364,How to add a calculated column to Access via SQL,"-- create a module and let's assume that
-- your table has Field1 integer and Field2 integer
-- we will add field3

Public Sub CreateField()

    Dim DB As DAO.Database
    Dim TableDef As DAO.TableDef
    Dim Fld As DAO.Field2

    Set DB = CurrentDb()
    Set TableDef = DB.TableDefs(""Table1"")

    Set Fld = TableDef.CreateField(""field3"", dbDouble)
    Fld.Expression = ""[field1] * [field2]""
    TableDef.Fields.Append Fld

    MsgBox ""Added""

End Sub
"
38279,How to alter triggers on multiple tables in oracle?,"declare
  stmt_ varchar2(4000);
begin
  for rec_ in (select TRIGGER_NAME from USER_TRIGGERS
               where trigger_name LIKE 'SOMETHINGCONSTANT%') loop

    stmt_ := 'ALTER TRIGGER ' || rec_.TRIGGER_NAME || ' ENABLE';

    EXECUTE IMMEDIATE stmt_;

  end loop;
end;
"
5635,PLSQL: Query star schema time-dimension without stored date,"(H.IN_YEAR||H-IN_MONTH||H.ON_DAY||H.ON_HOUR,'YYYMMDDHH24')
"
20700,Make criteria.add(Restrictions.sqlRestriction()) sql injection proof,"criteria
    .add(
         Restrictions.sqlRestriction(
            ""to_char(createDate,'mm/dd/yyyy') like ?"", 
            ""%"" + dateString + ""%"", StandardBasicTypes.STRING));
"
14202,Select latest entry using date field (no repeats),"SELECT asset_id, entered_date, max(modified_date)
FROM price_data
GROUP BY asset_id, entered_date
"
4953,"Search function, SQL Server","declare @temp nvarchar(50)
set @temp = 'France actors'

SELECT DISTINCT 
  a.ArticleID 
FROM 
  Article a
  JOIN SearchWords sw ON a.ArticleID = sw.ArticleID
WHERE
  exists (
    select 
      1 
    from 
      iter_charlist_to_tbl(@temp, ' ') s 
    where
      s.nstr = sw.SearchWord
  )
"
29520,Oracle 10g - optimize WHERE IS NOT NULL,"SELECT  /*+ INDEX (t index_name_on_col1) */
        *
FROM    mytable t
WHERE   col1 IS NOT NULL
"
36845,Getting Follower and FollwedBy Users from Table in one list,"SELECT UserId,
       (CASE WHEN COUNT(DISTINCT which) = 1 THEN MIN(which)
             ELSE 'B'
        END)
FROM (Select FollowerUserId as UserId, 'FD' as which From Table Where FollowingUserId = 1
      Union ALL
      Select FollowingUserId, 'FG' From Table Where FollowerUserId = 1
     ) f
GROUP BY UserId;
"
5036,How to use IF Else in store procedure?,"IF (@CustId IS NULL)
"
21074,sql to get listing from paging,"SELECT SKIP n LIMIT m ...
"
22787,MySQL left join with right table having order and limit,"SELECT i.*, 
SUBSTRING_INDEX(GROUP_CONCAT( ii.image_src ORDER BY ii.id DESC ),',',1) image_src ,
SUBSTRING_INDEX(GROUP_CONCAT( ii.caption  ORDER BY ii.id DESC ),',',1)  caption     
FROM itineraries AS i 
LEFT OUTER JOIN itineraries_images AS ii ON i.id=ii.itineraries_id AND ii.is_live=1 
WHERE i.is_live=1 
GROUP BY i.id
ORDER BY i.id, ii.sort
"
26761,Oracle SQL - Joins Syntax/Keywords,"SELECT e.name, e.employeeid, d.sales, d.task, sum(d.hours)
FROM employee e
JOIN timecard d on e.employeeid = d.employeeid
WHERE ...
GROUP BY ...
ORDER BY ...
"
19396,Sorting by Votes,"COALESCE(SUM(vote.vote_value), 0) AS score
"
29914,Return all columns with distinct on multiple columns in SQL table,"select col1, col2, col3, max(col4), min(col5) 
from tbl 
group by col1, col2, col3
"
959,SQL: Do you need an auto-incremental primary key for Many-Many tables?,"ArtistFans
    ArtistID (PK)
    UserID (PK)
"
8774,Compatibility Query for inserting null values in datefield,"INSERT INTO TABLENAME(DATEFIELD) VALUES(NULL);
"
35384,How to get data from two different tables with different field names,"SELECT user_id, user_grp_id, NULL AS cust_id, NULL AS cust_grp_id FROM table1
UNION ALL
SELECT NULL AS user_id, NULL AS user_grp_id, cust_id, cust_grp_id FROM table2
"
16079,Please criticize my proposed database design,"HOUSEHOLD_ATTRIBUTE_RELATIONSHIP 
HouseholdID  | AttributeID 
0            |       0     
3            |       2
etc ... 
"
31626,How to return Multiple outputs from a database as different columns in SQL,"Select 
sum(if(ReleaseYear < 1970, 1, 0)) as before1970, 
sum(if(ReleaseYear >= 1970 AND ReleaseYear <= 1980, 1, 0)) as before1980 
from Songs where classification = 'Pop' 
"
18392,multiply and sum column on condition," SELECT SUM(CASE WHEN MultiOnQry = 0 
        then CAST(Target AS Integer)
         else CAST(Target AS Integer)*X end) AS TargetSum
 FROM table WHERE ID = 1078
"
21798,SQL Joint 2 table without dublicate rows,"SELECT c.id, c.pagetitle as title, c.introtext, c.pub_date as publishdate,
       group_concat(cv.value) as sphotos
FROM `modx_site_content` c JOIN
     `modx_site_tmplvar_contentvalues` cv
     ON cv.`contentid`= c.id
WHERE c.parent IN (1153, 3271) AND c.pub_date > 0 AND
      `tmplvarid` IN (10, 15, 19) 
GROUP BY c.id, c.pagetitle, c.introtext, c.pub_date
Order by c.`pub_date` DESC
LIMIT 20;
"
6830,SQL Server 2012 Counting Semicolon separated values,"SELECT Id, REPLACE(FullName, ',', ';') AS FullName, 
       LEN(FullName) - LEN(REPLACE(FullName, ',', '')) + 1 AS [COUNT]
FROM MyTable;
"
26727,Checking if integer exists in a variable geometric sequence,"with anchor as (
  select @y as num
),
progression as (
  select num from anchor

  union all

  select num * @z from progression where num * @z <= @x
)
select case when exists (select 0 from progression where num = @x) then 1 else 0 end
"
1885,"Relational Algebra union, join and intersect","SELECT DEPTID, CRSNAME
FROM COURSE A
INNER JOIN LECTURERS B on A.DEPTID=B.DEPTID
WHERE B.DEPTID='eENG' or B.DEPTID='CS'
"
36021,SQL Server 2008 R2 Database Isolation Change,"SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
"
36422,How to update tables with in date range,"UPDATE ValueTable SET IncRange=DRT.IncRange
FROM ValueTable VT INNER JOIN DaatRangeTable DRT ON VT.BillDate >= DRT.StartDate AND VT.BillDate <=DRT.EndDate
"
14403,joining 3 tables & inserting in a 4th table in sql server,"from items
left join sales on ITEMS.ITEM_CD =sales.ITEM_CD
left join purchase on items.ITEM_CD =purchase.ITEM_CD
"
5353,SQL Server 2012 - Sales Summary with best day marker,"case when DailyNet = max(DailyNet) over(partition by TillID) then 'Yes' else 'No'
"
33126,MySQL - referring back to previous row to add calculated column,"select r.*,
       (select r2.race_id
        from runners_table r2
        where r2.race_id < r.race_id and r2.runner_id = r.runner_id
        order by r2.race_id desc
        limit 1
       ) as prev_race_id
from runners_table r;
"
12867,How to determine if sql table is Temporal?,"
SELECT temporal_type
FROM   sys.tables
WHERE  object_id = OBJECT_ID('dbo.MyTable', 'u') 
"
16457,SQL display data which is not mapped in another table,"SELECT a.userid, b.providerid FROM table1 a, table2 b
WHERE a.providerid IS NOT NULL
MINUS
SELECT userid, providerid FROM table1 a
WHERE a.providerid IS NOT NULL;
"
14223,MySQL query for dates range. What is wrong?,"WHERE creation_date BETWEEN '2011-08-01'  AND '2011-08-30'
"
38497,Cyclical information request in MySQL stored proc or query,"SELECT day,ROUND(total/1048576)
FROM (
    SELECT DATE(time_stamp) day,sum(bytes) total
    FROM logdata
    WHERE status=200
    GROUP BY 1
) t;
"
28471,"I know how it looks in SQL, but I need it in HQL and am stuck","select t1 from Table1 as t1 left outer join t1.table2 as t2
where t1.value = :value or t2.value = :value
"
21146,List of Stored Procedure from Table,"select
  so.name,
  sc.text
from
  sysobjects so inner join syscomments sc on so.id = sc.id
where
  sc.text like '%INSERT INTO xyz%'
  or sc.text like '%UPDATE xyz%'
"
13231,Sum between 3 linked tables SQL Server,"SELECT o.OrderID As [Order Number], l.Name As Location
    , o.OrderDate As [Date Ordered], SUM(i.Cost) As [Order Total]
FROM [Order] o
INNER JOIN Office_Locations l on l.id = o.LocationID
INNER JOIN OrderedItems oi on oi.OrderID = o.OrderID
INNER JOIN OrderItem i ON i.ItemID = oi.ItemID
GROUP BY o.OrderID, l.Name, o.OrderDate
"
32441,How to seperate last name and first names into two new columns in mysql?,"SELECT REPLACE('John & Anna Smith', SUBSTRING_INDEX('John & Anna Smith', ' ', -1),'') AS first_name, SUBSTRING_INDEX('John & Anna Smith', ' ', -1) AS last_name;
"
17049,Lazy-add DataMapper results in a loop,"result = nil
[ :first_name, :last_name ].each do |prop|
  cur = MyModel.all(prop.like => '%john%')
  next unless cur
  result ? result.nil? cur : result + cur
end
"
14792,Copying only the Filename of Excel files from folder with the help of sas,"%macro list_excel(location);
filename _dir_ ""%bquote(&location.)"";
data _null_;
  handle=dopen( '_dir_' );
  if handle > 0 then do;
    count=dnum(handle);
    do i=1 to count;
      memname=dread(handle,i);
      if index(memname,'.xls') then  put memname;
    end;
  end;
  rc=dclose(handle);
run;
filename _dir_ clear;
%mend;

/* example usage */
%list_excel(C:\temp\); 
"
3680,Java.sql.Date to Oracle database Date and Timestamp," bean.setStartTime(new java.sql.Timestamp(...))
"
8445,How to filter an XML field on multiple conditions,"select *
from MyTable as T
where T.XmlField.exist('/dictionary[item[key/int/text() = 1 and value/string/text() = ""Web""] and   
                                    item[key/int/text() = 2 and value/string/text() = ""Email""]]') = 1
"
38663,Selections do not tally with the number of records moved -- Access 2010,"IF Me.Dirty=True Then Me.Dirty =False
"
30209,MAX statement in SQL query,"Select Contract, product, MAX(endDate) FROM table1 
INNER JOIN table2 ON table1.contract = table2.contract 
group by contract, product
"
2465,SQl Server 2005: How to create a TSQL as per my business logic?,"Select * from Table_01 
Join
    (Select MAX(TransDate) as LatestDate, TestID, status from Table_02
            where TestID not in
                  (Select TestID from Table_02 where status = 0)
        group by TestID, status) as latestTrans 
on latestTrans.TestID = Table_01.TestID
order by latestTrans.LatestDate DESC
"
17529,Priorities for each clause of a query,"SELECT * FROM ZipCodes  z
WHERE Zip LIKE @zip OR (City LIKE @cityState+'%' and State LIKE @cityState+'%' ) 
ORDER BY 
CASE
    WHEN z.Zip LIKE @zip THEN 1
    WHEN City LIKE @cityState+'%' and State LIKE @cityState+'%' THEN 2
    WHEN State LIKE @cityState+'%' THEN 3
    ELSE 4
END,
z.Zip,
City,
State
"
12100,Postgresql trigger run non stop?,"CREATE TRIGGER updateTotalsalary 
AFTER INSERT OR UPDATE 
ON salary 
FOR EACH ROW
WHEN (pg_trigger_depth() = 0)
EXECUTE PROCEDURE reCount();
"
26625,SQL Server - Is it possible to return an existing column value before a row update?,"declare @previous table(newscore int, Oldscore int, postFK int, userFK int)

UPDATE ForumVotes 
SET score = @newVote 
OUTPUT inserted.score,deleted.score, deleted.postFK, deleted.userFK into @previous
WHERE postFK = @postID
AND userFK = @userID

select * from @previous
"
4389,Oracle SQL Query to get exact last 30/31/28 days from sysdate,"select ADD_MONTHS(TRUNC(SYSDATE), -1)
from dual;
"
9002,Coalesce usage confusion,"SELECT max(user_id) FROM users WHERE name='Bob'
"
26014,How to store articles or other large texts in a database,"  select.. where FULLTEXTFIELD like '%cookies%'.
"
25844,Join And Sum On Secondary Table?,"SELECT a.QuestionId, SUM(CASE WHEN(b.Lookup = a.Response) THEN 1 ELSE 0 END) AS [Count]
FROM Questions a
INNER JOIN QuestionLookup b ON a.QuestionId = b.QuestionId
GROUP BY a.QuestionId
"
33112,How to order by certain part of a string?,"order by SUBSTRING(codes, 4) asc
"
20633,SQL: Insert columns from another table with matching object names,"select t1.vm_name, 
       t2.object_id as vm_id,
       t1.host_name,
       t3.object_id as host_id
from table1 t1
       join table2 t2 on t1.vm_name = t2.object_name
       join table2 t3 on t1.host_name = t3.object_name
order by t1.vm_name
"
38766,Join two SQL queries where the second only returns one row and column,"SELECT JobName, Weight, Current_Job
FROM (yourfirstquery) q1, (yoursecondquery) q2
"
15812,SQL Query to get empty categories too,"SELECT *, COUNT(`item_id`) 
FROM `menu_categories`
  LEFT JOIN `menu_items` ON `item_category` = `cat_id`
GROUP BY `item_category`
"
25835,SQL - Average across multiple vehicles and speeds,"select sum(count*speed)/sum(count) as overall_average from T1;
"
21179,Get value inserted in RowGuid?,"DECLARE @MyTable TABLE 
(
id UNIQUEIDENTIFIER DEFAULT NEWID()
)

INSERT INTO @MyTable
OUTPUT inserted.id
DEFAULT VALUES
"
26466,How to return all data with duplicate columns using table aliases,"SELECT Alias1.id `Alias1.id`, 
       Alias1.city `Alias1.city`, 
       Alias1.state `Alias1.state`, 
       Alias2.id `Alias2.id`,
       Alias2.city `Alias2.city`, 
       Alias2.baseball_team `Alias2.baseball_team`
  FROM table1 AS Alias1  LEFT JOIN table2 AS Alias2 
    ON Alias1.id = Alias2.id
"
32606,How to run two Oracle stored procedure one by one from Unix batch file,"#!/bin/bash

sqlplus -s my_scheme@database/pass<<END
execute first_procedure();
commit;

execute second_procedure(); 
commit;
exit;
END
"
39065,SQL Query to display unique records,"select email, lname, fname
  from table1
  group by email, lname, fname
  having count(*) > 1  --only records with duplicates, 
                       --group by will return only one occurance
"
27328,Get MySQL Unique Key Combos,"select
constraint_name,
group_concat(column_name order by ordinal_position) as cols
from information_schema.key_column_usage
where table_schema = 'db_name' and table_name = 'table_name'
group by constraint_name
"
12229,How do I increase 1 value over multiple rows?,"UPDATE ItemTax
SET ID = ID + 1
WHERE ID > 37
"
12614,Select only the most recent value for each identifier in a table,"SELECT DISTINCT ON (identifier) *
FROM   tbl
ORDER  BY identifier, tstamp DESC;
"
2806,select multiple columns with max from one column and distinct on another,"SELECT
    username
    ,contractNo
    ,MAX(versionNo) AS versionNo
FROM contracts
WHERE username = 'lucian'
GROUP BY
    username
    ,contractNo
ORDER BY contractNo ASC
"
16500,Format string inside sql query when use stored procedure in Sql Server 2005,"SELECT sql = 'BACKUP DATABASE MyDatabase TO DISK='''+@file+'''';
"
9229,How to exclude entries with specific value/strings in phpmyadmin SQL?,"SELECT * FROM mytable WHERE path NOT LIKE '%coffee%' AND path NOT LIKE '%Beans%'
"
13645,MYSQL select * from table where owner_id equals one id from array,"select * from `table`
where `owner_id` in (12,321,14,2)
"
9480,"In SQL Server, how can I lock a single row in a way similar to Oracle's ""SELECT FOR UPDATE WAIT""?","SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;

BEGIN TRANSACTION;

    select * from ...

    update ...

COMMIT TRANSACTION;
"
3884,Performing string concatenation from rows of data in a TSQL view (pivot?),"SELECT  id,
        (
        SELECT  text AS [text()]
        FROM    mytable mi
        WHERE   mi.id = md.id
        ORDER BY
                mi.col
        FOR XML PATH(''), TYPE
        ).value('/', 'NVARCHAR(MAX)')
FROM    (
        SELECT  DISTINCT id
        FROM    mytable
        ) md
"
23194,Using SELECT DISTINCT or alternative with a 3 table query,"SELECT DISTINCT WEEKLY_TIMECARD.WEEK_NUMBER
FROM 
  WEEKLY_TIMECARD, 
  DAILY_CALCULATIONS, 
  EMPLOYEE_PROFILES 
WHERE EMPLOYEE_PROFILES.EMPLOYEE_NUMBER = WEEKLY_TIMECARD.EMPLOYEE_NUMBER
  AND EMPLOYEE_PROFILES.EMPLOYEE_NUMBER = DAILY_CALCULATIONS.EMPLOYEE_NUMBER
  AND WEEKLY_TIMECARD.WEEK_NUMBER = DAILY_CALCULATIONS.WEEK_NUMBER
"
6203,SQL 2005 Combine multiple record into one,"SELECT t.Time, LEFT(Names , LEN(Names )-1) as Names
FROM yourtable t
CROSS APPLY
(
    SELECT t1.Name + ','
    FROM yourtable t1
    WHERE t.Time= t1.Time
    FOR XML PATH('')
) pre_trimmed (Names)
GROUP BY Time, Names;
"
15096,SQL Looping,"SELECT  
  SUM(CASE WHEN 
   (StartDate IS NULL OR StartDate <= '2009-01-05 00:00:00')  
      AND (FinishDate IS NULL OR FinishDate >= '2009-01-05 00:00:00')
    THEN 1
    ELSE 0 END)) Week1Count,
  SUM(CASE WHEN 
   (StartDate IS NULL OR StartDate <= '2009-01-12 00:00:00')  
      AND (FinishDate IS NULL OR FinishDate >= '2009-01-12 00:00:00')
    THEN 1
    ELSE 0 END)) Week2Count
FROM  
  tBillboards
"
18502,How to shrink/purge ibdata1 file in MySQL,"[mysqld]
innodb_file_per_table=1
"
6500,Delete Parent record if child is not present,"DELETE T 
FROM MyTable T 
WHERE NOT EXISTS(SELECT * FROM MyTable WHERE ParentID = T.MenuID)
    AND T.ParentID IS NULL
"
16716,How to write a sum and count for example below?,"SELECT  s.SessionId, 
        SUM(pm.PenaltyMarks) TotalPenaltyMarks
FROM    Session s
        INNER JOIN Question q ON s.SessionId = q.SessionId
        INNER JOIN Penalty_Marks pm ON q.QuestionId = pm.QuestionId
WHERE   s.SessionId = 30
GROUP   BY s.SessionId
"
3019,Why doesn't mysql optimize this simple query,"SELECT *
FROM (SELECT * FROM T) t
WHERE pkey = 10;
"
13771,How to delete all records in an access table except most recent,"Delete from [TableName] as T1
Where Exists(
SELECT [log],[name],Max([date]) FROM [TableName] 
Where [log] = T1.[log]
And [name] = T1.[name]
Group By [log],[name]
Having T1.[date] < Max([date]))
"
26849,How do I add a unique key to a column in MYSQL?,"ALTER TABLE xx ADD UNIQUE KEY keyname (column1,column2);
"
17109,Use join with a table and SQL Statement,"select a.column, b.column
from
    table1 a
join (select statement) b 
    on b.column = a.column
"
8505,How to add one column to another column on all rows in a table?,"Update TABLENAME
     Set Balance1 = Balance1 + Escrow1,
         Balance2 = Balance2 + Escrow2,
         Escrow1 = 0, Escrow2 = 0
"
15603,Can SQL query do this?,"select n.id as new_id
      ,a.id as archive_id
      ,record_id
      ,n.record_date as new_date
      ,a.record_date as archive_date
      ,DateDiff(a.record_date, n.record_date) as days_between
  from audit n
  join audit a using(record_id)
 where n.description = 'New Sub'
   and a.description = 'Archieved';
"
31738,Select DISTINCT field when using PATINDEX,"SELECT i.IssueID
FROM Issues i
OUTER APPLY(
  SELECT TOP 1 ia.IssueActivityID
  FROM IssueActivities ia
  WHERE ia.IssueID = i.IssueID
    AND (PATINDEX('%Pending DR%', ia.Notes) > 0
      OR PATINDEX('%Pending E%', ia.Notes) > 0)
) pending
WHERE i.IssueStatusID = 2
  AND pending.IssueActivityID IS NULL
"
38980,SQL(ite) JOIN with regex within JOIN,"SELECT *, upper(substr(t1.name, 1, 1) || lower(t1.name, 2) as NameWithCapAtFront
FROM table1 as t1 LEFT JOIN
     table2 as t2
     ON lower(t1.Name) = lower(t2.Name);
"
13750,Select from 3 joined tables with condition?,"    select r.id, rc.id, c.name, r.serial, rc.requestcondition
    from request r
    inner join customer c on c.id=r.custid
    inner join requestcondition rc on rc.requestid=r.id
    inner join (
       select max(id) as rcid
        from requestcondition
        group by requestid
    ) latest on latest.rcid=rc.id
"
33770,Oracle Insert with mutli-valued column,"insert into onTeam(date, player, teamName) 
select 'newDate','Matt Holliday', teamName 
from onTeam where player = 'Matt Holliday'
"
5680,PostgreSQL No Auto Increment function?,"CREATE TABLE user (
userid SERIAL PRIMARY KEY,
username VARCHAR(16) UNIQUE NOT NULL
)
"
34080,Group by id dependent less time at postgres sql,"select * from
(
select row_number()over(partition by id order by time desc) Rn,
       lag(item) over(partition by id order by time) prev_item,*
from yourtable
) A
Where Rn = 1
"
22736,"How to identify high-load SQL in Oracle, using oracle views?","select a.sql_id, a.ratio, a.executions
from  
(
  select sql_id, buffer_gets / executions ratio, executions
  from v$sql
  where executions > 10
  order by 2 desc
) a
where rownum <= 10
"
26815,group date range with specific range,"CASE
  WHEN month([Date]) BETWEEN 2 AND 7 THEN 2
  ELSE 1
END
"
1900,Proper Use of TO_DATE FUNCTION,"SELECT TO_DATE('MAR 2012', 'MON YYYY') dt FROM dual;
"
15486,Include the table name in a select statement,"select 'table1' as tableName, col1, col2 from anyTable;
"
13461,Oracle regexp_like negating special char,"WITH example
     AS (SELECT 'AAAA-1' n FROM DUAL
         UNION
         SELECT 'AAAAA_1' FROM DUAL
         UNION
         SELECT 'AAAA' FROM DUAL
         UNION
         SELECT 'AAAA\1' FROM DUAL
         )
SELECT *
  FROM example
 WHERE REGEXP_LIKE (n, '^[^_-]*$')
"
36016,Converting datetime to month-year only - T-SQL,"SELECT replace(right(convert(varchar, getdate(), 106), 8), ' ', '-')
"
8402,SQL Sum of orders by date,"Select cast(CreatedAt as date) as CreatedDay, SUM(RoundedPriceSum)
from StarOrder so
where SiteID = 1 and OrderType <> 2 and
      CreatedAt >= '2015-01-01' and
      CreatedAt < '2015/08/20'
group by cast(CreatedAt as date)
order by CreatedDay;
"
659,Is there a way to set a variable in a PostgreSQL statment that can be used in a file path name,"create function copyin( _tablename name, _filename text )
returns void
language plpgsql as $this$
declare sql text;
begin
  sql := 'COPY ' || quote_ident(_tablename) || ' FROM ' || quote_literal(_filename);
  execute sql;
  return;
end;
$this$;

SELECT copyin( 'froobles', '/tmp/froobles.csv' );
"
34981,How to select rows with a certain number in one of its columns?,"SELECT *
FROM bar
WHERE ', ' + foo + ', ' LIKE '%, 6, %'
"
21712,"SQL Query, SELECT Top 2 by Foreign Key Order By Date","SELECT PlanId, ClientId, PlanDate FROM (
    SELECT ROW_NUMBER() OVER (PARTITION BY ClientId ORDER BY PlanDate DESC) rn, *
    FROM [dbo].[tblPlan]
) AS T1
WHERE rn <=2
"
12930,Need to do tthis in 1 SQL,"    SELECT T1.OrderNumber 
    FROM TRA99 T1
    WHERE T1.OrderNumber in (
                 SELECT OrderNumber
                 FROM TRA99
                 WHERE TCode IN ('QEE','QNE')
                 ) 
    AND T1.TCode='@23'
GROUP BY T1.OrderNumber 
"
33066,oracle improve query performance,"DECLARE
  l NUMBER := 0;
BEGIN
  FOR cc IN (SELECT C_ID, A_ID FROM M_TABLE) LOOP
    l := l + 1;
    EXIT WHEN l >= 100000;
  END LOOP;
END;
"
22864,Selecting all rows where one field contains the same value,"SELECT * 
  FROM MyTable
 WHERE SomeID IN (
                   SELECT SomeID
                     FROM MyTable
                    WHERE Salesman IN ('Ashley','Barney')
                 GROUP BY SomeID
                   HAVING count(distinct Salesman) = 2
                 )
"
34932,SQL implicit Join to explicit join,"SELECT THDR.filename, 
       THDR.txn_header_id, 
       THDR.txn_header_ext_id, 
       THDR.txn_header_dttm, 
       THDR.upload_dttm, 
       Nvl(Sum(TDTL.txn_vol), 0) TOTAL_VOLUME, 
FROM   ci_txn_header THDR 
LEFT JOIN ci_txn_detail TDTL 
ON THDR.txn_header_id = TDTL.txn_header_id 
"
11343,selecting rows in sql in sequence fashion of column,"select t.id, t.col, t.filter
from (select t.*,
             @rn := if(@f = filter, @rn + 1, if(@f := filter, 1, 1)) as rn
      from table t cross join
           (select @f := '', @rn := 0) vars
      order by filter, id
     ) t
order by rn, field(filter, 'type1', 'type2', 'type3');
"
31323,SQL query for displaying related values on same column as separate columns,"SELECT
  mt1.Text AS Issues,
  mt2.Text AS Comment
FROM MyTable mt1
JOIN Mytable mt2
  ON mt1.ID = mt2.ID
  AND mt1.LANID = 101
  AND mt2.LANID = 102
"
12715,How do I add select parameters when reading data for the View?,"var messages = db.Messages.Where( m => m.SentById == id || m.SentToId == id ).ToList();
"
12080,For Loop in SQL Server 2005 Express?,"SELECT ii.ItemNum, ii.ItemName, ii.OzOnHand, ii.OzOnHand - coalesce(il.cnt, 0)
FROM dbo.InventoryItems ii LEFT JOIN
     (select il.InvItemNum, sum(OzRemoved) as cnt
      from dbo.InventoryLog il
      group by il.InvItemNum
     ) il
     ON ii.ItemNum = il.InvItemNum
WHERE ii.active = 1;
"
18494,MySQL nested SELECTs,"SELECT *, CONCAT(WEEK(`Date`)) AS Week, SUM(`Weight`) AS TotalWeight,
       SUM(CASE WHEN Weight < 3 THEN Weight ELSE 0 END) AS SumSmall,
       SUM(CASE WHEN Weight >= 3 AND Weight <= 7 THEN Weight ELSE 0 END) AS SumMedium,
       SUM(CASE WHEN Weight > 7 THEN Weight ELSE 0 END) AS SumLarge
FROM tbl_fangster
WHERE `Date` >= '2012-04-01 00:00:00'
AND `Date` <= '2012-04-30 00:00:00'
AND `Species` = 'Salmon'
GROUP BY CONCAT(WEEK(`Date`))
"
3725,Combining rows by key and expression,"SELECT email, bool_or(day_1) AS day_1, bool_or(day_2) AS day_2 FROM your_table GROUP BY email
"
8374,Inserting values into a table based on column values of another table,"INSERT INTO Table1 
   SELECT 'Ausser', 20, t2.Courses 
   FROM Table2 t2; 
"
4129,Select a column using a variable?,"DECLARE @Column varchar(25)
SET @Column = 'Name' -- This can be another column also
SET @sqlText = N'SELECT ' + @Column + ' FROM MyTable'
EXEC (@sqlText)
"
12059,Returning TimeStamp multiple times in single T-SQL Statement,"SET NOCOUNT ON 
DECLARE @Var INTEGER = 1 
WHILE @Var = 1 
BEGIN 
  SELECT @Var = COUNT(*) 
  WHERE  dbo.GetMyDate() BETWEEN dbo.GetMyDate() AND dbo.GetMyDate()   

  SELECT @Var 
END
"
30279,Selecting of specific rows based on the column that used GROUP BY in mysql," HAVING count(qty) = 2
"
36148,SQL: How to find the sum of values where all the records has the same value in a column?,"select student, sum(value)
from payments
group by student
having sum(case when Payment_type is not null then 1 else 0 end) = 0
"
2495,"How can I select multiple rows, all having a same id (or any variable) within a database using MySQL?","SELECT * 
FROM YourTable
WHERE [user] = 'john'
"
17645,SQL absolute value sum and iterate,"SELECT cusip_nbr, SUM(ABS(cns_amt)) 'total_amt'
FROM Table
GROUP BY cusip_nbr
"
31212,hierarchical sum in PostgreSQL,"WITH RECURSIVE children AS (
    -- select leaf nodes
    SELECT id, value, parent
        FROM t
        WHERE value IS NOT NULL
    UNION ALL
    -- propagate values of leaf nodes up, adding rows 
    SELECT t.id, children.value, t.parent
        FROM children JOIN t ON children.parent = t.id
)
SELECT id, sum(value) 
    FROM children 
    GROUP BY id   -- sum up appropriate rows
    ORDER BY id;
"
12222,How to retrieve the published post in wordpress database?,"select * from wp_posts
where post_status = 'publish'
and post_type = 'post'
"
10769,sql query to count records by filter,"SELECT [ScheduleId],[EventId], s.[SkillId], [ADEmployeeId], sk.[Description],
       COUNT(*) OVER (PARTITION BY sk.Description) as col1,
       COUNT(ADEmployeeId) OVER (PARTITION BY sk.Description) as col2
FROM [Schedule] s INNER JOIN
     [Skills] sk
     ON s.SkillId = sk.SkillId
WHERE EventId = 1;
"
22732,Connecting to .sql file from terminal on a Mac,"mysql -h hostname -u user --password=password databasename < file_name.sql
"
17353,Select distinct columns sql server,"SELECT * FROM (
    SELECT *, ROW_NUMBER() OVER (PARTITION BY CNum, CUID ORDER BY Id) AS ROWNUM 
    FROM Con
) x WHERE x.ROWNUM = 1
"
28912,How to generate numbering per-group?,"select ROW_NUMBER() OVER (Partition By name Order by unit) as sl,
name,Unit
from tablename
"
6722,Wrong index is chosen by Oracle,"SELECT T1.B, T2.B FROM TABLE1 T1,TABLE2 T2
WHERE T1.A=T2.A
"
7810,SQL Server Query with case,"select dpt,
       (case when sum(case when status = 'NOK' then 1 else 0 end) then 'NOK'
             when sum(case when status = 'Average' then 1 else 0 end) then 'Average'
             else 'OK'
        end) as Status
from myview v
group by dpt;
"
23278,Group by and sorting before a where clause?,"select *
from YourTable
where _record_status <> 'deleted'
and ticket = @yourTicketId
"
19371,How to return back in SQL statement,"--start the transaction only execute the first three lines,  this leaves the transaction open
BEGIN TRANSACTION
UPDATE TABLEA
SET COL1 = ""newValue""

--examine data and based on the results run one of these two lines
ROLLBACK TRANSACTION

COMMIT TRANSACTION
"
32004,MySQL query to return a list of months,"SELECT DATE_FORMAT(date, '%Y-%m-01') as Months from Table GROUP BY Months;
"
27039,Postgresql function returns composite - how do I access composite values as separate columns?,"SELECT * 
  FROM myfunc()
"
32236,Why this left outer join produces wrong results?,"select d.deptno as d_deptno, e.deptno as e_deptno  
from dept d left outer join  emp e  
on d.deptno = e.deptno 
where e.deptno is null
"
28456,"SQL: How to select a count of multiple records from one table, based on records in a different table?","SELECT message, count(commentID) 
FROM tableA LEFT JOIN tableB ON tableA.messageID = tableB.messageID 
GROUP BY message
"
34090,Convert hex string to bigint in postgres," select ('x'||lpad(the_hex_value,16,'0'))::bit(64)::bigint;
"
2308,How to obtain trend from a table for the same column values in multiple row that needs group by,"SELECT A.Name, A.LastCount, (((A.FirstCount-A.LastCount)/A.FirstCount)*100) Trend
FROM (SELECT A.Name, MAX(IF(A.Interval = 'Last', A.Count, 0)) LastCount, 
             MAX(IF(A.Interval = 'First', A.Count, 0)) FirstCount
      FROM tableA A
      GROUP BY A.Name
     ) AS A
"
28886,SQL:HOW TO TAKE SUBSTRING FOR QUERY,"SELECT RIGHT(INC_DATE, 4);
"
31560,Design a set of attributes,"Objects 
-------
id (PRIMARY_KEY)
name

Keys
----
id (PRIMARY_KEY)
value

KeyValuePairs
-------------
id (PRIMARY_KEY)
keyId (FOREIGN_KEY(Keys))
value

Objects_KeyValuePairs
---------------------
objectId (PRIMARY_KEY, FOREIGN KEY (Objects))
kvpId (PRIMARY_KEY, FOREIGN KEY (KeyValuePairs))
"
2881,SQL Statement - Create a Report with three totals,"SELECT
    COUNT(u.userid) 'Total Users',
    SUM(CASE WHEN device = 'android' THEN 1 END) Android,
    SUM(CASE WHEN device = 'iOs' THEN 1 END) iOs,
    SUM(CASE WHEN device = 'Windows' THEN 1 END) Windows,
    date(u.datecreated) 'Day'
FROM Users
GROUP BY date(u.datecreated)
ORDER BY date(u.datecreated) DESC
"
21299,Access SQL query using iff statement,"SELECT sno, 
iif(Len([Code])<=5,[Code],iif(ASCII([Code])>57,Right([Code],Len([Code])-1),Mid([Code],3)))
AS Codeno FROM table1
"
22460,database structure for letting users place tags on their profile?,"tags (id, userid, tag)
"
34948,Update and select in a single query in oracle 11g,"UPDATE <table> SET (c1) = (v1) WHERE <condition> RETURNING <expression> INTO <variables>
"
7986,IF/CASE in an outer join,"SELECT Alert.*, Comments.Comment FROM
Alert
LEFT OUTER JOIN Comments ON Comments.ObjectId = Alert.ObjectId AND
Comments.ObjectType = 
CASE Alert.ObjectType
WHEN 'U' THEN 'USER'
WHEN 'E' THEN 'EVENT'
END
"
8653,MySQL select statement involving join,"SELECT a.id, a.item, b.price 
FROM a 
LEFT OUTER JOIN b ON a.id = b.item_id AND b.user_id = 32;
"
28993,Question regarding many-many relationships,"SELECT u.username, r.rolename
FROM user u
INNER JOIN
user_role ur
ON 
u.userid = ur.userid
INNER JOIN
role r
ON
ur.roleid = r.roleid
"
34173,Retrieving list of values in a clob,"SELECT EXTRACTVALUE( v.COLUMN_VALUE, '/asCurrent' )
FROM   table_name t,
       TABLE(
         XMLSequence(
           EXTRACT(
             XMLType( t.clob_column ),
             '/bank/bankDetails/bankDetailsList/accountName/asCurrent'
           )
         )
       ) v
"
6521,"SELECT * FROM table, replace FK's with their name","SELECT pd.name, pc.price
    FROM product AS pd
        INNER JOIN price AS pc
            ON pd.id = pc.productid
"
38053,Running SQL file from VBA,"Dim strSQL As String
strSQL = """"

Dim hnd As Integer
hnd = FreeFile

Open ""C:\Temp\yourScript.sql"" For Input As hnd

Dim row As String
Do Until EOF(hnd)
    Line Input #hnd, row
    strSQL = strSQL & row & vbNewLine
Loop

Close #hnd
"
9458,Inserting data into a temporary table,"INSERT INTO #TempTable (ID, Date, Name) 
SELECT id, date, name 
FROM physical_table
"
16479,how to write a query for a complex report with (sub)totals?,"SELECT P.id, P.flavor, P.kind, P.price, R.purchasedate, count(R.id) as numSold
FROM Product P join LineItem L on P.id = L.productID join Receipt R on L.receiptID = R.id 
GROUP BY R.purchasedate, P.id, P.flavor, P.kind, P.price
ORDER BY P.id, DATE(R.purchasedate);
"
9123,Creating multiple query statement in MYSQL,"SELECT a.plane_Size, b.STABBR,i.airport_name FROM airport i
JOIN planes a ON i.plane_ID = a.plane_ID
JOIN locations b ON b.Location_ID = i.Location_ID
WHERE STABBR = 'WV'
ORDER BY a.CITY;  
"
205,Can anyone help me with this INSERT SQL statement?,"INSERT INTO TABLE (owner, Pet)
SELECT 'Nick', Pet FROM Table WHERE owner = 'Bob'
"
20289,MS Access Group By number of distinct items in column,"SELECT AgentCode
    ,SUM(IFF(Status='Registered',1,0)) as Registered
    ,SUM(IFF(Status='Rejected',1,0)) as Rejected
    ,Count(Status) as Total
FROM table
GROUP BY AgentCode
"
26149,How to query the latest item in a feed table,"Id   Label
1    APPLICATION_SUBMITTED
2    APPLICATION_RECEIVED
3    BANK_APPROVED 
"
25512,In mysql can I return deleted rows after a deletion?,"CREATE TABLE TheDeletedIds as
    SELECT t1.id
    FROM t1 LEFT JOIN
         t2 
         ON t1.t2_id = t2.id
    WHERE t2.id IS NULL OR t2.is_valid = false;

DELETE t1
    FROM t1
    WHERE t1.id IN (SELECT id FROM TheDeletedIds);
"
14502,List the last two records for each id,"SELECT *
FROM (
    SELECT row_number() OVER (
            PARTITION BY idmicro ORDER BY idhist
            ) AS ind
        ,*
    FROM data
    ) AS initialResultSet
WHERE initialResultSet.ind < 3
"
34153,"""!=""/NOT perhaps not working properly in SQLite","SELECT * FROM yourTable WHERE is_gallery IS NOT 1
"
20305,SQL left join and manual null addition," x <> value1 AND x <> value2 AND ...
"
7770,How to multiple join the same table?,"SELECT isNull(l1.LocationName,'') AS LocationFrom, isNull(l2.LocationName,'') AS LocationTo, c.Duration 
FROM Connection c 
left outer JOIN Location l1 ON l1.LocationID= c.LocationIDFrom
left outer JOIN Location l2 ON l2.LocationID= c.LocationIDTo
"
3467,Removing spaces and returning multiple rows in sql,"SELECT RESOURCE_NAME, REPLACE(EMAIL_ADDRESS, ' ', '')
FROM [RESOURCE]
WHERE 
    (@Name IS NULL OR (RESOURCE_NAME LIKE @Name))
"
25634,Can I use SQL to model my data?,"create table usertable (
    userID integer unsigned not null auto_increment primary key,
    userName varchar(64) );
create table jobtable (
    jobID integer unsigned not null auto_increment primary key,
    jobDesc text,
    posterUserRef integer not null );
create table bidtable (
    bidID integer unsigned not null auto_increment primary key,
    bidAmount integer,
    bidDesc text,
    bidTime datetime,
    bidderUserRef integer not null references usertable(userID),
    biddingOnJobRef integer not null reference jobtable(jobID) );
"
34890,Select latest date from 2 tables and between specified dates,"SELECT 
    SUM(
    CASE WHEN x = 'yes'
    THEN 1 ELSE 0
    END) AS SUM_NUMBER, --terminated_count_Q1_2013 for example
    MAX(
    CASE WHEN x = 'yes'
    THEN yourdatecolumn
    ELSE NULL END) AS MAX_DATE --last_payout_date_Q1_2013 for example
FROM yourtable
"
2525,why use beforereadingrecords / whilereadingrecords / whileprintingrecords in crystal reports?,"numbervar subtotal;
subtotal := subtotal + {table.numericvalue}"
11635,How to create crosstab queries in PostgreSQL,"SELECT sampling_point, time_sampling,
       CASE WHEN sampling_point = 'floor' THEN entero ELSE NULL END AS entero_floor,   
       CASE WHEN sampling_point = 'wall' THEN entero ELSE NULL END AS entero_wall
FROM SourceTable
ORDER BY sampling_point DESC;
"
31475,MySQL Filter results,"SELECT * FROM actions inner join users
on actions.user_id = users.id 
WHERE users.username != ""admin"";
"
9663,Merge record values into a record that contains multiple values with comma separated,"SELECT p1.product_id,
       substring(
          ( SELECT ',' + engine_id
              FROM ProductEngine p2
              WHERE p2.product_id = p1.product_id
              FOR XML PATH('') ), 2, 4000)
       AS engine_id
      FROM Products p1;
"
7679,SQL where field in vs. where field = with multiple ors?,"SELECT *
FROM Wherever
WHERE Greeting in ('hello', 'hi', 'hey')
"
14416,How to get rid of double quote from column's value?,"...
SET Name = REPLACE(Name,'""', '')
...
"
2886,Mysql `AND` operator,"SELECT *
FROM
  test
WHERE
  id=(SELECT max(id) FROM test WHERE name LIKE ""somename"")
"
36681,how to count number of unique (by 3rd field in a whole set) ids by type,"SELECT   type, COUNT(*)
FROM     (SELECT acc_fk, type FROM t1 GROUP BY acc_fk) t
GROUP BY type
"
13580,Insert values into XML column child node Sql Server,"update T2
set XMLColumn.modify('insert sql:column(""T1.Skills"") as last into Skills[1]')
from Table2 as T2
  cross apply (
              select T1.Skills
              from Table1 as T1
              where T2.Deptno = T1.Deptno
              for xml path(''), type
              ) as T1(Skills)
where T2.Deptno = 1
"
20450,How to count the number of occurrence of column values but without GROUP BY (not distinct values) mysql,"select  id
,       title
,       (
        select  count(*)
        from    Table1 t2
        where   t1.title = t2.title
                and t2.id <= t1.id
        ) as numbers
from    Table1 t1
"
20210,SQL Query to filter record for perticular record count,";with a as
(
select Id,RecordId,Type,Reading,IsDeleted, count(*) over (partition by RecordId, Reading) cnt, 
row_number() over (partition by RecordId, Reading order by Type, RecordId) rn
from table
)
select Id,RecordId,Type,Reading,IsDeleted
from a where cnt <> 2 or rn = 1
"
19518,Get user friendly MSSQL server's product name,"SELECT LEFT(@@version, CHARINDEX(' - ', @@version)) ProductName;
"
34910,Is it possible to sum distinct rows without a sub select?,"Select 
  sum(distinct outstanding) as outstanding,
  Sum(distinct total) as total
From
 packagetotals
Where
  package in ('xyz', 'ABC',  'LMN')
  And responsible = 'zz'
"
14849,SQL set attending to yes if userid = x and eventid = x,"insert into user_has_event(user_user_id, event_event_id, attendance)
    values (1, 1, 'yes')
    on duplicate key update attendance = 'yes';
"
15722,How can I optimize this query?,"SELECT user_id, correct_words, incorrect_words
FROM
( SELECT user_id, correct_words, incorrect_words
  FROM score
  WHERE user_id>0
  AND DATE(date_tested)=DATE(NOW())
  ORDER BY correct_words DESC,incorrect_words ASC
)
GROUP BY user_id
LIMIT 0,7
"
19397,Add a zero record when count is 0,"SELECT branch.br, branch.branchname, COUNT(employee.br) AS Number
FROM branch
LEFT JOIN employee
  ON branch.br = employee.br
GROUP BY branch.br, branch.branchname
"
39218,Conditional UPDATE in MySql,"UPDATE relation 
   SET name1 = CASE WHEN userid1 = 3 THEN 'jack' ELSE name1 END,
       name2 = CASE WHEN userid2 = 3 THEN 'jack' ELSE name2 END
WHERE (userid1 = 3 AND userid2 = 4) 
   OR (userid1 = 4 AND userid2 = 3);
"
16367,SQL Command - Advanced selecting,"SELECT * from Table2 a inner join 
(SELECT * FROM Table1 WHERE Manager = 'ManagerX') b ON a.User = b.Username
"
8419,Dynamic SQL Select,"SELECT (
        case id
             WHEN 1 
                  THEN id + ' (Auto)' 
             ELSE id END) as id 
FROM example
"
37460,SELECT query with LIMIT from database column on MySQL,"select user.*, messages.*
from user inner join messages
     on user.id=messages.user_id
where (select count(*) from messages m
       where m.user_id=user.id
       and m.id<messages.id)<user.credit
"
14431,Getting total value from each field?,"SELECT Username,
  SUM(CASE WHEN type = 'Yes' THEN 1 ELSE 0 END) as Yes,
  SUM(CASE WHEN type = 'No' THEN 1 ELSE 0 END) as No,
  SUM(CASE WHEN type = '' THEN 1 ELSE 0 END) as Other,  
  COUNT(*) as TOTAL
  FROM table 
WHERE source = 'CompanyName'
group by Username
order by TOTAL desc;
"
21175,Efficiently fetching 25 rows with highest sum of two columns (MySQL),"select ur1.*
from (select u.*
      from users u
      order by rank1 desc
      limit 1000
     ) ur1 join
     (select u.*
      from users u
      order by rank2 desc
      limit 1000
     ) ur2
     on ur1.username = ur2.username
order by ur1.rank1 + ur1.rank2 desc
limit 25;
"
9318,use group by clause and count() in subquery,"SELECT        Class.class_id, Class.ClassName, COUNT(*) AS count
FROM            Class INNER JOIN
                         Groups ON Class.class_id = Groups.class_id
GROUP BY Class.class_id, Class.ClassName
"
9221,Delete records depending on field when compared to another table,"delete from table2
    where not exists (select 1
                      from table1
                      where table1.id = table2.id and
                            table2.date between table1.""begin"" and table1.""end""
                     );
"
34841,Will Delete SQL locks the table which prevents new data insert into SQL Server 2005?,"WHILE 1 = 1
  BEGIN
        DELETE  TOP 10000 FROM  myTable WHERE CreationDate < GetDate()

        IF @@ROWCOUNT = 0
            BREAK
  END
"
33216,SQL Server: need to add a primary key,"ALTER TABLE myTable ADD id INT IDENTITY
CONSTRAINT id _pk PRIMARY KEY;
"
420,"Subtract rows from a table, using subquery which may be empty","SELECT A.* 
FROM A
LEFT JOIN B
ON A.value = B.value
WHERE b.value IS NULL
"
19906,How do I append zeroes at the end of two combined fields?,"SELECT LEFT(SBSNBR+SEQNBR+'00000000000000000000000000000000000000000000000000',50)
FROM Table
"
31481,Issue with formating a date using 'FMMonth' in Oracle and displaying the time correctly,"SQL> ed
Wrote file afiedt.buf

  1  SELECT TO_CHAR (TRUNC (SYSDATE), 'FMMonth dd, yyyy fmhh:MI AM') result_two
  2*   FROM DUAL
SQL> /

RESULT_TWO
------------------------------------------------------
December 4, 2012 12:00 AM
"
24804,Multiple LIKE in sqlite,"SELECT p.* 
FROM p_extra_fields x
JOIN products p ON p.id = x.product
WHERE x.key IN ('model', 'color', 'make')
AND x.type = '1'
AND x.value MATCH 'foo OR bar'
GROUP BY x.product LIMIT 0, 50;
"
26667,sql query change dimensional table,"select `month-year`, 
       sum(case when user = 'admin' then count_login else 0 end) as admin,
       sum(case when user = 'user1' then count_login else 0 end) as user1
From yourtable
Group by `month-year`
"
19417,How to handle a single quote in Oracle SQL with long text,"create table t_clob ( a clob)

insert into t_clob values (q'[START aa'a''aa aa 'a'' aa'a'  a'a' a END]')
"
38233,How to exclude rows that have matching fields in other rows,"Select p.Status, Count(*) as new_CountofHeaderID
From (select distinct p.status, p.Date, p.Number, pEffectiveDate
      from tbl_Progression as p
     ) as p
Group By p.Status;
"
26062,Can I avoid doing this Row by Row,"SELECT 
    us.UsersShiftsId,
    us.UserId,
    us.ShiftStart,
    us.ShiftEnd,
    MIN(fs.ScannedTime) ActualStart,
    MAX(fs.ScannedTime) ActualEnd
FROM UsersShifts us
LEFT JOIN FingerprintScan fs
    ON us.UserId = fs.UserId
    AND fs.ScannedTime BETWEEN us.ShiftStart AND us.ShiftEnd 
GROUP BY
    us.UsersShiftsId,
    us.UserId,
    us.ShiftStart,
    us.ShiftEnd
"
25600,SQL creating column for each distinct value,"SELECT ""date"",
       SUM(CASE WHEN title = 'foo' THEN ""count"" END) AS foo,
       SUM(CASE WHEN title = 'bar' THEN ""count"" END) AS bar
FROM yourTable
GROUP BY ""date""
ORDER BY ""date""
"
22788,SQL - Getting more data with a GROUP BY,"SELECT 
    i.serial_number, i.counter, i.selected_color
FROM
   (
   SELECT      serial_number, MAX(counter) AS maxc
   FROM            incoming_data 
   GROUP BY    serial number
   ) max
   JOIN
   incoming_data i ON max.serial_number = i.serial_number AND max.maxc = i.counter
"
7326,How to select number of days from history table?,"select t.*, datediff(day, minid, getdate()) as days_since
from tickets t outer apply
     (select min(insert_date) as minid
      from history h
      where h.ticket_id = t.ticket_id and h.ticket_status = t.status
     ) h;
"
29339,Calculate COUNT in GROUP BY SQL query,"SELECT 
  p.[Id],
  SUM(CASE WHEN o.[OwnerId] IS NOT NULL THEN 1 ELSE 0 END) +
  SUM(CASE WHEN o.[Id]      IS NULL     THEN 1 ELSE 0 END) AS Total
FROM [dbo].[Order] o
INNER JOIN [dbo].[Product] p ON p.[Id] = o.[ProductId]
GROUP BY p.[Id]
"
7763,How to find the minimum values of a query's column,"SELECT userId, COUNT( id ) AS count
FROM X
GROUP BY userId
HAVING COUNT(id) = (SELECT MIN(cnt)
                    FROM (SELECT COUNT(id) as cnt
                          FROM X
                          GROUP BY userId
                         ) xx
                   );
"
21375,how to execute procedure with timer in oracle,"delete from <table_name>
where StartTime < (sysdate-1/24);
commit;
"
2096,Query to merge multiple rows into into distinct rows with multiple columns,"SELECT Name,[1] as Animal, [2] as Color
FROM
(SELECT Name,Id,Value
    FROM Table) AS SourceTable
PIVOT
(
MIN(Value)
FOR Id IN ([1], [2])
) AS PivotTable;
"
17853,One common comments app vs. individual comment models in each Django app,"from django.db import models

class BaseComment(models.Model):
    author = ...
    title = ...
    body = ...

    class Meta:
        abstract = True

class VideoComment(BaseComment):
    video = models.ForeignKey(...)
"
11290,Xpath SQL Server query,";WITH XMLNAMESPACES ('http://something.com/' AS xn)
SELECT
    XmlType = XmlColumn.value('(Something/xn:Filters/xn:Data/xn:Type)[1]', 'varchar(50)') 
FROM 
    dbo.YourTable
"
37938,sql where clause in select statement issue," SELECT * 
FROM Books
WHERE (
   ((Author LIKE '%' + @p_author + '%' OR @p_author = '') OR 
   (Country LIKE '%' + @p_country + '%' OR @p_country = ''))
   AND (@p_author <> '' OR @p_country <> '')
) AND 
(Domain LIKE '%' + @p_domain + '%' OR '%' @p_domain = '')
"
13926,Help with SQL totals and sums,"select
  a.acct_no, m.cmcl_forecast_cleared, b.name,
  count(*) as TotalChecks,
  Sum(m.check_amount) as TotalAmount
from ap_master m   
join accounts a on a.acct_id=m.account_tag  
join banks b on b.bank_id=a.bank_id  
where m.cmcl_bank_cleared is null 
group by a.acct_no, m.cmcl_forecast_cleared, b.name
order by a.acct_no, m.cmcl_forecast_cleared, b.name
"
4785,how to search for an id from a group of id using mysql?,"select * from FRIENDSLIST where find_in_set( $ID, USERS_ID ) <> 0
"
27132,SQL query for JIRA database to find linked issues,"SELECT
  ILT.OUTWARD,
  LI.* -- linked
FROM
  JIRAISSUE I -- parent
INNER JOIN ISSUELINK IL
ON
  IL.SOURCE = I.ID
INNER JOIN ISSUELINKTYPE ILT
ON
  ILT.ID = IL.LINKTYPE
INNER JOIN JIRAISSUE LI -- linked
ON
  LI.ID = IL.DESTINATION
WHERE
  I.PROJECT  = 10500 AND
  I.ISSUENUM = 1247;
"
39725,How to count the number of people who choose a particular location?,"SELECT l.locations, l.telephone, l.address, COUNT (u.userID) as `location_count`
FROM location AS l
LEFT OUTER JOIN users AS u on l.locations = u.location_chosen
GROUP BY l.locations
ORDER BY `location_count` DESC
"
4905,How can I move a dot 6 spaces to the left on all values of a column in MySQL?,"SELECT weight/1000000 as Weight
FROM yourtable
"
11704,how to diff and show only exact differences for 2 long string,"$ wdiff a b

# 1,""abc"",""( @docid =""""00123"""" or @docid =""""00456"""") AND [-a_number-] {+@a_number+} is not NULL""
"
32642,how to get hours from subtracting two date time values in SQL Server 2005,"SELECT  DATEDIFF(hour, '2009-08-06 00:00:00', '2009-10-06 23:59:59')

---
 71
"
19632,How to call Oracle's regexp_like function with Nhibernate QueryOver?,"// this is inlined string, but could be concatenated from some params
var sql = @"" regexp_like(ENTRY_TEXT, '(\WPlaced\W)') "" +
           "" AS isLike"";
var sqlString = new SqlString(sql);

// the ICriterion
var criterion = new NHibernate.Criterion.SQLCriterion(sqlString
    , new string[] {}
    , new IType[] {}
    );

// the query
var query = session.QueryOver<LogEntry>()
    .Where(criterion)
    ...
"
11992,(MySql) select query returns empty row in WHERE and AND condition,"SELECT date_created 
FROM collections
WHERE 
  -- Truncate the datetime to a date only
  DATE(date_created) = '2014-03-12'
  AND loan_id = 3942
"
4522,Oracle query for getting list of countries,"select *
from Test_Table
where (:v_countries = 'ALL' or ','||:v_countries||',' like '%,'||country||',%') and
      (:v_regions = 'ALL' or ','||:v_regions||',' like '%,'||region||',%');
"
28074,Can't import database through phpmyadmin file size too large,"php_value upload_max_filesize 120M //file size
php_value post_max_size 120M
php_value max_execution_time 200
php_value max_input_time 200
"
36915,SQL - remove duplicates from left join,"SELECT     
    OBJECTID
    , PKID
    , t2.SUBDIVISIO,
    , t2.ASBUILT1

FROM        dbo.table1 AS t1
OUTER APPLY (
    SELECT  TOP 1 *
    FROM    dbo.table2 AS t2
    WHERE   t1.PKID = t2.FKID
    ) AS t2
"
11434,check either startdate or end date is in last week," SELECT A.commRunStart, A.commRunEnd FROM  `commRuns` AS A
 WHERE (A.commRunStart >= CURDATE( ) - INTERVAL DAYOFWEEK( CURDATE( ) ) +6 DAY
    AND A.commRunStart < CURDATE( ) - INTERVAL DAYOFWEEK( CURDATE( ) ) -1 DAY )
    OR (A.commRunEnd >= CURDATE( ) - INTERVAL DAYOFWEEK( CURDATE( ) ) +6 DAY
    AND A.commRunEnd < CURDATE( ) - INTERVAL DAYOFWEEK( CURDATE( ) ) -1 DAY )
"
706,Convert Comma Separated column value to rows," SELECT A.[id],  
     Split.a.value('.', 'VARCHAR(100)') AS String  
 FROM  (SELECT [id],  
         CAST ('<M>' + REPLACE([string], ',', '</M><M>') + '</M>' AS XML) AS String  
     FROM  TableA) AS A CROSS APPLY String.nodes ('/M') AS Split(a); 
"
36448,What is the fail safe way to query Date Period in MySQL?,"SELECT FROM_UNIXTIME(1234567890, '%d / %m / %Y, %k : %i');
"
12034,"Mysql subtracting values using row selected from min timestamp, grouping by id","select t.user_id, max(t.overall_exp - tprev.overall_exp)
from tracker t join
     tracker tprev
     on tprev.user_id = t.user_id and
        date(tprev.timestamp) = date(SUBDATE(t.timestamp, INTERVAL 1 DAY))
group by t.user_id
"
11342,Sql return one row from right table every left table result,"select t1.ip, t1.count, t2.name
from table1 t1 
    join table2 t2 on t1.ip = t2.ip
group by t1.ip
"
16037,Can stored procedure of one schema access the tables of other schema,"CREATE SCHEMA cdbo AUTHORIZATION dbo;
"
20675,How to use <= inside an XML element?,"<Query><![CDATA[
Select * FROM Info WHERE EffectiveDate <= GETDATE()   
]]></Query>
"
21905,Replacing / with - in SQL Server using Select Command,"SELECT REPLACE(my_column, '/', '-')
FROM   my_table
"
3163,MySQL match records with like operator,"UPDATE n2jm0_cronjob_run SET state=0 WHERE DATE_FORMAT(crondate ,'%Y-%m-%d %H:%i')=
DATE_FORMAT('2013-08-11 16:18:00','%Y-%m-%d %H:%i');
"
13352,Selecting all the similar MAX values derived from COUNT(),"SELECT Country, COUNT(Name) as People
FROM Citizen 
GROUP BY Country
HAVING COUNT(Name) = (select max(cnt)
                      from (select COUNT(Name) as cnt
                            from Citizen
                            group by Country
                           ) c
                     );
"
38198,Export mysql schema (data only) except for one table,"#/bin/bash

now=$(date +%Y-%m-%d-%H:%M:%S)
output_file=""mydb_prod-$now.sql""

mysqldump -u root -p[pass] -h localhost mydb_prod --add-drop-table --no-data > ""$output_file""
mysqldump -u root -p[pass] -h localhost mydb_prod migration_table --add-drop-table >> ""$output_file""
"
38835,SQL: Find closest number to given value with ties,"SELECT * 
FROM CARS 
WHERE ABS(price - $price) = ( SELECT MIN(ABS(price - $price)) FROM CARS )
"
29460,Sliding certain records to the end of a run of the same date,"select thedate, theid, thetype
from
(
  select 
    thedate, theid, thetype,
    sum(new_group) over (order by theid) as group_key
  from
  (
    select
      thedate, theid, thetype,
      case when lag(thedate) over (order by theid) = thedate then 0 else 1 as new_group
    from mytable
  ) marked
) grouped
order by 
  group_key,
  case when thetype = 101 then 1 else 0 end,
  theid;
"
2198,How to create sequence when importing data using Toad for Oracle,"create sequence seq_my_pk;

create table my_table (pk number not null primary key, value varchar2(30));

create or replace trigger tr_my_table_pk
  before insert on my_table
  for each row 
begin
  if :new.pk is null then
    :new.pk := seq_my_pk.nextval;
  end if;
end;
"
1191,Multiple Foreign keys between two tables,"CREATE UNIQUE INDEX ON EventStaff (EventID) WHERE IsSupervisor = 1
"
36838,Select from table with optional values,"SELECT *
    FROM Person p
        LEFT JOIN Address a
            ON p.Address_ID = a.Address_ID
"
37931,Is it possible to have a dynamic select clause columns defined by a subselect?,"declare @TableName sysname = quotename('Test')

declare @ColumnList varchar(max)

select @ColumnList = isnull(@ColumnList + ', ', '') + quotename(name)
from sys.columns
where object_name(object_id) = @TableName

declare @SqlCommand varchar(max) = 'select ' + @ColumnList + ' from ' + @TableName 
execute(@SqlCommand)
"
29484,"""Explode"" table returned by SQL function into columns","SELECT name, (symbol_scan(id)).* 
FROM symbols
"
25274,Retrieve all tables selectable by a user (in Oracle),"select table_name from TABLE_PRIVILEGES where grantee='USER' and select_priv='Y'
union
select table_name from  user_tables
"
29789,Fetching the max record for an employee for each month,"select * from (
 select 
  *, 
  rn = ROW_NUMBER() over (partition by empnumber, year(createddate), month(createddate) order by createddate desc) 
  from t 
) x where rn = 1
"
38083,Default Schema in Oracle Connection URL,"ALTER SESSION SET CURRENT_SCHEMA=animals
"
21435,"Sql Select top 2 , bottom 2 and 6 random records","with cte
as
(
    select 
        row_number() over (order by name) RowNumber, 
        row_number() over (order by newid()) RandomOrder,
        count(*) over() Total,
        *
    from sys.tables
)
select *
from cte
where RowNumber <= 2 or Total - RowNumber + 1 <= 2
union all
select *
from
(
    select top 6 *
    from cte 
    where RowNumber > 2 and Total - RowNumber > 2
    order by RandomOrder
) tt
"
2544,Copy from one table to another table,"INSERT INTO original_table
  (id, state, city, address)
SELECT t.id, s.id, c.id, t.address
FROM   temp_table t
  JOIN states     s ON s.state_name = t.state
  JOIN cities     c ON c.city_name  = t.city
"
34345,Count() with multiple conditions in SQL,"select players.name,
       SUM(case when players.team <> matches.winner then 1 else 0 end) as Losses
from players join
     favstadiums
     on favstadiums.player = players.name join
     matches
     on favstadiums.stadium = matches.stadium and
        players.team in (matches.home, matches.away)
group by players.name;
"
29581,Sum() different columns according to row values,"SELECT Month,
    YEAR,
    SUM(3R00) one,
    SUM(3R01) two,
    SUM(3R02) three,
    SUM(3R03) four
FROM TABLE
GROUP BY Month,
    YEAR
"
24627,SQL query over two column,"SELECT
    COUNT(p.booking_ref_id) AS payment_count,
    YEAR(b.date_created) AS payment_year
FROM booking b
INNER JOIN Payment_transaction p
    ON p.booking_ref_id = b.booking_ref_id
GROUP BY YEAR(b.date_created)
"
19753,SQL Server Table Transformation Query / Combine Column Names With Values,"SELECT
   x.*
FROM tbl t
CROSS APPLY( VALUES
    ('q1', q1),
    ('q2', q2),
    ('q3', q3)
) x(cg, sg)
"
6934,Join table in Stored Procedure using variable input,"DECLARE @SQL varchar(max)
SET @SQL = 'select * from tableA INNER JOIN tableB on tableA.'+@Input1+' = table B.'
@input2

EXEC (@SQL)
"
38993,MySQL selecting data from 2 tables,"SELECT *
FROM members a
WHERE NOT EXISTS (
  SELECT 1
  FROM team_members b
  WHERE b.member_id = a.member_id
  )
"
8138,MySQL query table to get data between start and end date,"SELECT *
FROM   run
WHERE  run_id NOT IN (SELECT runID 
                      FROM   booking
                      WHERE  startDate >= '10/07/2015' AND
                             endDate <= '15/07/2015');
"
3033,fetch best seller of a category for a particular month,"SELECT  io.item_name, COUNT(io.item_name) AS number_sold  
FROM item_out_tbl io JOIN
     category_tbl c   
     ON io.category_id = c.category_id AND c.category_id = '$category_id' JOIN
     sales_tbl sa
     ON io.item_id = sa.item_id AND                            
        $current_month' = MONTH(date_sold) 
GROUP BY io.item_name 
ORDER BY number_sold DESC 
LIMIT 3
"
24916,NHibernate - Mixing subquery and an eager left join,"<property name=""Description"" type=""Type,Namespace"" formula=""(select inf.Description from Info inf 
where inf.ProductId = product.Id where inf.Year = 2010 limit 1)""/>
"
29016,How to select NOT using SQL JOIN,"SELECT name 
FROM Aircraft 
LEFT JOIN AircraftType 
ON Aircraft.AircraftType = AircraftType.id
LEFT JOIN Pilot
ON AircraftType.id = Pilot.forAircraftType
LEFT JOIN Person
ON Pilot.person = Person.id
WHERE NOT EXISTS (SELECT 1 FROM Flight WHERE Flight.aircraft = Aircraft.id)
"
27052,@ oracle equivalent in postgres,"\i path/to/child.sql
"
35984,sql query to calculate percentage," select state ,100 * sum( IF(gender = 'male',1,0) ) / count(*) 
    from table where state = 'nyc' 
    group by state 
"
28016,SET XACT_ABORT ON not Worked in Create Procedure," CREATE PROCEDURE [Members].[MyProc](
 ........

 )
 AS
 SET XACT_ABORT ON
BEGIN
BEGIN TRANSACTION [MyProcCHK]
....
COMMIT TRANSACTION [MyProcCHK]
END
GO
"
38571,Add clients with same name and add it to a different table,"INSERT INTO Table2
   SELECT CUSIP, [DESC], SUM(QUANTITY) AS QUANTITY
   FROM Table1
   GROUP BY CUSIP, [DESC]
"
12672,Mysql Union in different columns,"SELECT 
        MAX(c1.start_time) as start_1, (SELECT MAX(cc1.created_at) FROM cc1) as ccmax

FROM c1
"
10212,howto realise a query which makes a second query to count the sum?,"SELECT first.name, (
 SELECT COUNT(*) 
 FROM second
 WHERE second.first_id=first.id
) as entries
FROM first
"
23740,how to access multiple users' database via JDBC,"select * from some_other_user.their_table;
"
37493,How to perform grouped ranking in MySQL,"SELECT id_student, id_class, grade,
   @student:=CASE WHEN @class <> id_class THEN 0 ELSE @student+1 END AS rn,
   @class:=id_class AS clset
FROM
  (SELECT @student:= -1) s,
  (SELECT @class:= -1) c,
  (SELECT *
   FROM mytable
   ORDER BY id_class, id_student
  ) t
"
7830,SQL Server 2005 How Create a Unique Constraint?,"ALTER TABLE <tablename> ADD CONSTRAINT
            <constraintname> UNIQUE NONCLUSTERED
    (
                <columnname>
    )
"
19166,join on several conditions,"SELECT C.Name
     , COALESCE(A.Date, B.Date)
     , COALESCE(A.Amount, 0) 
     , COALESCE(B.Amount, 0)
  FROM C
  JOIN (A FULL OUTER JOIN B ON B.FruitID = A.FruitID AND B.Date = A.Date)
    ON COALESCE(A.FruitID, B.FruitID) = C.FruitID 
 ORDER BY 1, 2
"
35698,Rebuilding a test database into a production one,"mysqldump --host=host --user=user --password=password --no-data db_name > structure.sql
"
28989,mysql select query get data from row based,"select sdd.source_data_id, 
       max(case when f.name = 'record_id' then sdd.value end) as record_id,
       max(case when f.name = 'firstname' then sdd.value end) as firstname,
       max(case when f.name = 'surname' then sdd.value end) as surname
from source_data_details sdd join
     field f
     on sdd.field_id = f.id
group by sdd.source_data_id;
"
12401,modify int to float (mysql),"ALTER TABLE `user` CHANGE rate intrate INTEGER;
ALTER TABLE `user` ADD rate float(5) NOT NULL DEFAULT 100;
UPDATE `user` SET rate=intrate;
ALTER TABLE `user` DROP intrate;
"
2266,Replace some of string in SQL Server,"UPDATE TheTable
SET Ville = REPLACE(Ville, 'Saint ', 'St ')
WHERE Ville LIKE 'Saint %'
"
30521,How to set only one value of column as true and rest false,"create PROCEDURE [dbo].[USP_SetAcademicYear]
    @AcademicID INT
AS
BEGIN
    IF(@AcademicID != 0)
    BEGIN 
        UPDATE dbo.Academic_Master 
        SET presentYear = CASE
             WHEN AcademicId = @AcademicID THEN 'y'
             ELSE 'N' END
        WHERE AcademicId = @AcademicID or presentYear = 'y'
    END
END
"
19922,How to write a query which fetches data from a table without the quotes and double quotes in the data stored,"select EmpID,
         replace(replace(EmpName,'""', ''),'''','') Empname, 
          replace(replace(CompName,'""', ''),'''','') CompName 
from table 
"
1564,Convert output number format with a single query,"SELECT to_char(X)
  FROM TABLEX
 WHERE NAME LIKE 'Blablabla';
"
2561,Find and replace character from the string,"UPDATE MyTable SET mycolumn = REPLACE ( mycolumn , '?' , '-' )
"
7122,sql check that all rows have only certain values," SELECT COUNT(*)
 FROM   Invoices
 WHERE  InvoiceDraftNumber = '12345'
 AND    Status <> 'Rejection'
"
8255,Returning the 4 most recent orders for each customer,"SELECT CustomerId, OrderDate
FROM Orders as ExtOrders
WHERE OrderId IN (
     SELECT TOP 4 OrderId
     FROM Orders
     WHERE CustomerId LIKE ExtOrders.CustomerId
     ORDER BY OrderDate DESC)
ORDER BY CustomerId; -- Might not work in SQLFiddle if CustomerId is text
"
2255,getting unique records using sql,"SELECT 'Number of unique Profile views'                AS Data, 
       4                                               AS Action, 
       Count(DISTINCT Cast(REGISTRANTID AS VARCHAR(5)) + '-' 
                      + Cast(COMPNAYID AS VARCHAR(5))) AS Counts 
FROM   DBO.HR_ACTIONLOG 
"
21397,"SQL Query - group by more than one column, but distinct","SELECT b.cusID, b2.LatestBidTime, b.Amount 
FROM Bid b
    JOIN (
        SELECT cusID, MAX(BidTime) AS LatestBidTime
        FROM Bid
        WHERE SellID = 10
        GROUP BY cusID) b2 ON b.cusID = b2.cusID AND b.BidTime = b2.LatestBidTime
WHERE b.SellID = 10
"
7878,SQL Create Field based on Other Field in Record,"select FirstName, LastName, Hometown, State 
    from Person left join CityToState on Hometown=City;
"
23753,MySQL Query Two Table Join,"SELECT rSameCompany.ResId, rSameCompany.FirstName, rSameCompany.LastName
FROM resource r
    INNER JOIN resource rSameCompany
        ON r.CompanyID = rSameCompany.CompanyID 
    INNER JOIN account a
        ON r.ResourceID = a.ResourceID 
        AND a.AccId='7' 
"
5023,ORACLE TRIGGER update table if another one is updated,"CREATE OR REPLACE TRIGGER name
  BEFORE UPDATE OF nation_id ON referee
  FOR EACH ROW
DECLARE
    l_nationname VARCHAR2(150);
BEGIN
    SELECT name
      INTO l_nationname 
      FROM nation
     WHERE nation_id = :new.nation_id;

    UPDATE game
       SET referee_nation_name = l_nationname
     WHERE referee_id = :new.referee_id;
END;
"
26196,mysql select child from parent and use it in another query,"select * from TABLE_2 where category_id in (select category_id from TABLE_1 where parent_id = 1) 
"
38942,SQL joins with tables that contain dimensions,"SELECT 
    T1.ID
    ,S.DimensionValue AS Sex
    ,E.DimensionValue AS Eyes
    ,WT.DimensionValue AS [Worker Type]
FROM #Table1 AS T1

LEFT JOIN #Table2 AS S  -- new alias here for dimension table
ON T1.ID=S.ID AND S.Dimension='sex'
LEFT JOIN #Table2 AS E  -- new alias here for dimension table
ON T1.ID=E.ID AND E.Dimension='eyes'
LEFT JOIN #Table2 AS WT -- new alias here for dimension table
ON T1.ID=WT.ID AND WT.Dimension='worker type'
"
21058,Firebird multiple statements,"Update stuff; Delete stuff; Update stuff;
"
4478,Adding minutes to datetime on insert - mysql,"INSERT INTO products 
  (product_id, product_type, created_dt, end_dt) 
VALUES 
  (11, 
   '1', 
   '2010-10-08 00:11:10', 
    DATE_ADD(STR_TO_DATE('2010-10-08 00:11:10', '%Y-%m-%d %H:%i:%s'), INTERVAL 59 MINUTE)
  )
"
36619,How to distinguish date at midnight from date w/o time in Oracle?,"  User supplied value       Inserted value

  12/05/2010                12/05/2010 BC
  12/05/2010 09:23          12/05/2010 09:23
  2/05/2010 00:00           2/05/2010 00:00
"
2789,Rank by groups sql server,"select cksum, id, dense_rank() over (order by minid)
from (select t.*, min(id) over (partition by cksum, grp) as minid
      from (select t.*,
                   (row_number() over (order by id) -
                    row_number() over (partition by cksum order by id)
                   ) as grp
            from table t
           ) t
     ) t;
"
1475,"""[columnname] is not contained in either an aggregate function or the GROUP BY clause.""","SELECT t.name, COUNT(d.data)
FROM   types AS t
       LEFT JOIN data AS d ON d.typeId = t.id
GROUP  BY d.typeId, t.name;
"
17312,Sql Query help needed for product relation,"SELECT s.ID, s.ProductId, s.Name, 
  OtherData = COALESCE(s.OtherData, r.OtherData)
FROM dbo.Products AS s
LEFT OUTER JOIN dbo.Products AS r
ON s.ProductId = r.ID;
"
25308,Update specific rows from one table to another,"UPDATE GeneralTable g
JOIN   ClientTable c ON g.invoice_number = c.invoice_number
SET    g.date = c.date, g.accno = c.accno
"
13821,Multiple Delete Statements Inside of Cursor DB2,"OPEN C1
FETCH NEXT FROM C1 INTO @Variable1,@Variable2,....( as many as fields in the table )
WHILE @@FETCH_STATUS = 0
BEGIN

FETCH NEXT FROM C1 INTO @Variable1,@Variable2,....( as many as fields in the table )
END

CLOSE CURSOR
DEALLOCATE CURSOS
"
18139,PostgreSQL v9.5+ UPSERT,"INSERT INTO myScheme.myTable(id, a, b, c) VALUES ($1, $2, $3, $4)
ON CONFLICT (id) DO
UPDATE SET a=$2, b=$3, c=$4;
"
2993,sp_executesql with 'IN' statement,"SET @Code = '''X101'',''B202'''
SET @Cmd = 'SELECT * FROM Table WHERE RegionCode IN (' + @Code + ')'
EXECUTE (@Cmd)
"
24285,Using CASE for an optional predicate,"SELECT email, u.user_id, first_name, last_name, rights
FROM users u
     LEFT JOIN manager_depts d ON d.company_id = u.company_id and d.dept_id = 2
WHERE company_id = 2141 AND receives_emails = 'y'
  AND (u.rights != 'manager' OR d.user_id IS NOT NULL)
"
24304,Generate range of strings,"select 'SN' || lpad(lvl, length('100')+1, '0') from (select level lvl from dual connect by level <= 100);
"
34183,SQL Running Percentage,"SELECT x.*
     , SUM(y.choice)/COUNT(*) * 100 pct 
  FROM film_choice x 
  JOIN film_choice y 
    ON y.film <= x.film 
 GROUP 
    BY x.film;
"
4892,"Query effeciency, 3 child tables to 1 parent","SELECT T_ID_FK  FROM  TRANSACTION_CH_A WHERE T_ID_FK  IS NOT NULL
UNION ALL 
SELECT  T_ID_FK   FROM TRANSACTION_CH_B WHERE T_ID_FK  IS NOT NULL
UNION ALL 
SELECT   T_ID_FK  FROM TRANSACTION_CH_C WHERE T_ID_FK  IS NOT NULL
"
23297,SELECT TOP record for each year,"select top (1) with ties
  C.CompanyName,
  Year(O.OrderDate) as Yr,
  sum(OD.Quantity) as Total
from Orders as O
join Customers as C on C.CustomerID = O.CustomerID
join ""Order Details"" as OD on OD.OrderID = O.OrderID
group by C.CompanyName, Year(O.OrderDate)
order by 
  row_number() over (
    partition by Year(O.OrderDate)
    order by sum(OD.Quantity) desc
  );
"
23158,Unable to match square bracket [ character in SQL," where Message like 'Dear \[User Name\]' escape '\';
"
28926,Include ROWID in Dataset when Exporting from Toad,"select rowid, t.*
from my_table t;
"
2498,How to use two aggregations from one table to calculate a metric in oracle SQL,"SELECT ITEM, STORE,
    SUM(CASE WHEN REASON = 183 THEN QUANTITY ELSE 0 END)-
    SUM(CASE WHEN REASON = 182 THEN QUANTITY ELSE 0 END)
FROM TRANSACTION
GROUP BY ITEM, STORE
"
39723,Mysql - How to quit/exit from stored procedure,"CREATE PROCEDURE SP_Reporting(IN tablename VARCHAR(20))
proc_label:BEGIN
     IF tablename IS NULL THEN
          LEAVE proc_label;
     END IF;

     #proceed the code
END;
"
7748,SQL - Get Count of users with average age in range,"select count(*) as SiteCount
from (
      select avg(datediff(year, U.BirthDate, UV.Visit_Date)) as AvgAge
      from Users as U
        inner join User_Visits as UV
         on U.ID = UV.User_ID
      group by UV.Site_ID   
     ) as T
where AvgAge >= 40 and
      AvgAge < 50 
"
28119,SQL Filter condition with value or Null,"WHERE P.PatientId=@PatientId AND P.TenantId=@TenantId AND
      (@Type is null or P.[Type]=@Type)
"
6524,Is there a way to alter many tables to add default values to a common column name?,"DECLARE
    cnt NUMBER;
BEGIN
    FOR x IN (
        SELECT DISTINCT t.table_name 
        FROM user_tables t
            INNER JOIN user_tab_columns c ON c.table_name = t.table_name
    ) LOOP
        EXECUTE IMMEDIATE 'ALTER TABLE (SCHEMA.' || x.table_name || ') MODIFY(VARIETY DEFAULT ''COMEDY'')';
    END LOOP;
END;
"
27608,"MySQL join query on post with categories, only return one result per post","SELECT P.id AS pid, MIN(P.Time) as first_post_time, MAX(PC.Category) as Category FROM Posts P
LEFT OUTER JOIN PostCategories PC ON PC.pid = P.id
WHERE PC.Category IN('value1','value2') OR PC.Category IS NULL
GROUP BY P.id
ORDER BY P.Time DESC
"
5074,Joining a table on itself,"SELECT
  *, columnB
FROM
  mytable
WHERE
  columnA = 'apple'
"
37104,MYSQL auto fill column values from another table,"**Sellers**
1. Seller_id
2. Seller_name
3. Seller_logo

**Details**
1. Details_id
2. Seller_id (foreign key)
3. Product
4. Price
"
3731,How to find all the tables in database Teradata with specific column names in them?,"SELECT tablename
FROM dbc.columnsV
WHERE ColumnName in ('col1', 'col2')
"
8716,using Object_id() function with #tables,"OBJECT_ID('tempdb..#foo')
"
37290,How to select rows where given data appear in more than one row in a table?,"SELECT *
FROM transaction t1
WHERE client_id in ( SELECT client_id 
                     FROM transaction t2
                     GROUP BY client_id 
                     HAVING count(*) > 1 )
"
10661,SQL Delete rows based on query from same table?,"DELETE cur FROM `current` AS cur
LEFT OUTER JOIN (
    SELECT MAX(EndDay_id.id) as id, EndDay_id.server_id
    FROM current as EndDay_id
    GROUP BY server_id, gameday
    ) AS EndDay
ON cur.id = EndDay.id
WHERE EndDay.id IS null
"
25945,How to hidden / delete data in row if same from the top,"select transaction.id,t.noskom,t.sum_nonpbm,t.sum_noskop,t.sum_npbp
from transaction
left join 
(
   select noskom, min(id) min_id, 
               sum(nonpbm) sum_nonpbm,
               sum(noskop) sum_noskop,
               sum(npbp) sum_npbp 
   from transaction 
   group by noskom
) t on (transaction.id=t.min_id)
order by transaction.id
"
7549,Update the values in the database directly or delete - add them again,"BEGIN TRAN T1

-- This update is part of T1
UPDATE Table1 SET Col1='New Value' WHERE Col2 = @Id;

-- Time to commit your changes. 
-- If for any reason something fails, 
-- everything gets rolled back
COMMIT TRAN T1
"
36299,Database Normalization and User Defined Data Storage,"Product(id, active, allow_new)

pVariable_type(id, name) 

pVariable_data(id, product_fk, pvariable_fk, non_typed_value, bool, int, etc)
"
13234,Cannot save structure into mongodb with golang (only empty records created),"type Result struct {
    Nid         string
    Timestamp   int64
    Hexhash     string
    Addr        string
}
"
35451,Not using Where statement in a context,"CREATE FUNCTION dbo.testt ( 
    @data int
)
RETURNS TABLE
AS
RETURN 
(
    SELECT 
        a.[id],
        a.[value],
        a.[category],
        b.[id_type]
    FROM [dbo].[testing] a 
    LEFT JOIN [dbo].[testing2] b on a.id = b.[id]
    WHERE b.[id_type] = @data OR @data = -10
)
"
4184,SQL help with omitting records,"SELECT id, year
FROM table t
WHERE NOT EXISTS (SELECT * FROM table t2 
                  WHERE ThirdColumn = 'A'
                  AND t2.id = t.id
                  AND t2.year = t.year)
"
16276,Can I execute several WHERE LIMIT statements in one query?,"SELECT *
FROM  (
   SELECT *, row_number() OVER (PARTITION BY year ORDER BY total DESC) AS rn
   FROM   tbl
   ) sub
WHERE rn < 4
"
38625,This query run in 30s. How can I optimize it?,"SELECT a.id, X.chapterno, X.mid, X.hitcount
FROM 
(select chapterno,  max(hitcount) as hitcount 
from chapter    
WHERE mid = 2524
group by chapterno)X
INNER JOIN chapter a ON (a.chapterno = X.chapterno AND a.mid=X.mid)
ORDER BY X.chapterno DESC
"
2566,Get Items with smallest vote count including 0 in postgresql,"SELECT id,
coalesce((SELECT count(*) FROM ""Votes"" WHERE ""ItemId"" = ""Items"".id), 0) as total
FROM ""Items""
WHERE date(""Items"".""createdAt"") = date('2015-05-26 18:30:00.565+00')
AND ""Items"".""region"" = 'west'
ORDER BY total LIMIT 2
"
10366,Cumulative totals being doubled,"and t1.id < t2.id
"
1918,Select all records don't meet certain conditions in a joined table,"SELECT *
FROM posts p
WHERE NOT EXISTS(
    SELECT 1
    FROM comments c
    WHERE c.comment_date >= 'deadline'
    AND p.post_id = c.post_id
)
"
7844,SQL Query that ignores symbols,"REPLACE(REPLACE(REPLACE(LOWER(CONCAT(TRIM(ttitle),TRIM(tsub))), ' ',''),'\'',''),'""','')
"
37595,"With multiple sql order by clause, is all order bys run even if earlier order by has proved that the rows are not equal?","create index my_index on my_table (field5, field3, field2);
"
30553,"Filter One Field to Exactly Match Multple Criteria (no ""OR"")","select A.person
from (SELECT DISTINCT person,product FROM yourtable) A
where A.product in ('phone','suitcase','wallet','chair')  
group by A.person 
having count(*) = 4
"
33188,MySQL Database Schema - General Questions,"id             int   auto_increment & primary key
title          varchar(*)
content        text or big varchar according to your needs
posted_on      datetime or timestamp
posted_by      int key representing the authors id
"
31267,ActiveRecord query an associated entity,"class Orders < ActiveRecord::Base
  scope :some_date_range, -> { where(""#{table_name}.date_from BETWEEN :date_from AND :date_to"", date_from: Date.today, date_to: Date.today + 1.day) }
end

Customer.find(1).orders.some_date_range
"
25125,How to run a block of MSSQL code with multiple int variable values?,"DECLARE @Sectors TABLE ( Sector INT );

INSERT INTO @Sectors VALUES (40), (41), (42);

DECLARE @Sector INT;
DECLARE Sectors CURSOR FOR
    SELECT
        Sector
    FROM @Sectors;

OPEN Sectors;
FETCH Sectors INTO @Sector;

WHILE (@@FETCH_STATUS = 0)
BEGIN
    -- Do something here that cannot be batched
    PRINT @Sector;

    FETCH Sectors INTO @Sector;
END

CLOSE Sectors;
DEALLOCATE Sectors;
"
2099,Using Sum function,"SELECT t.ID, t.LoanID, t.Amount,
       [Sum] = (SELECT SUM(AMOUNT)
                FROM TestTable t2
                WHERE t.LoanID=t2.LoanID
                AND t2.ID <= t.ID)
FROM TestTable t
"
4287,how do you do a mysql WHERE something = 'something' OR ... (PHP),"pR.projectRelationId IN ('$id[ 0 ]', '$id[ 1 ]', '$id[ 2 ]')
"
34497,SQL sum with group by,"SELECT
    GROUPNUMBER,
    SUM(CASE WHEN COUNTRY = 'US' THEN [COUNT] ELSE 0 END) AS US_COUNT,
    SUM(CASE WHEN COUNTRY = 'US' THEN AMOUNT ELSE 0 END) AS US_AMOUNT,
    SUM(CASE WHEN COUNTRY != 'US' THEN [COUNT] ELSE 0 END) AS NON_US_COUNT,
    SUM(CASE WHEN COUNTRY != 'US' THEN AMOUNT ELSE 0 END) AS NON_US_AMOUNT
FROM theTable
GROUP BY GROUPNUMBER
"
14674,Query 3 Tables one table has 3 rows I need to combine into 1 in some joint way,"select t1.RID, t1.AllOtherData, t2.Description,
       max(case when t3.item = 1 then t3.code end) as item1code,
       max(case when t3.item = 2 then t3.code end) as item2code,
       max(case when t3.item = 3 then t3.code end) as item3code
from table1 t1 join
     table2 t2 on 
     t1.RID = t2.RID join
     table3 t3 on
     t1.RID = t3.RID
group by t1.RID, t1.AllOtherData, t2.Description
"
20534,How do I work out the average of two columns? Microsoft Access,"AverageMarks: (CourseworkMarks+ExaminationMarks)/2
"
19972,"How to identify(DEV,QA,PROD) environment in oracle","select global_name from global_name
"
9090,Import CSV into MySQL on duplicate key update,"load data local infile '/Users/myuserID/Desktop/test1.csv' 
replace 
into table test.test1 
columns terminated by ',' 
enclosed by '""' 
lines terminated by '\n';
"
4523,Not able to change value of Database Cell Based on Select Join,"UPDATE B
SET B.cpid = 250
FROM A 
WHERE A.id = B.a_id AND A.cgid LIKE '0002' 
     AND B.cpid = 312
"
5004,SQL query to return a value based on holding a number of values in other corresponding columns,"select groupId
from t
where nodeId in (595, 644, 659)
group by groupId
having count(distinct nodeId) = 3;
"
35352,subtract two dates from a table in sql,"SELECT     FLOOR(ABS((d1 - d2) / 365)) AS age_diff
FROM       (SELECT dob AS d1
            FROM   employee
            WHERE  empId = 'some_id') t1
CROSS JOIN (SELECT dob AS d2
            FROM   employee
            WHERE  empId = 'some_other_id') t2
"
26930,Access database outside of vagrant box as user,"CREATE USER 'testuser'@'10.0.2.2' IDENTIFIED BY 'testpassword';
GRANT ALL PRIVILEGES ON testdb.* TO 'testuser'@'10.0.2.2';
"
27057,MySQL Query: Write max(Date) from whole table to each row,"SELECT  n.*
FROM    news n
        INNER JOIN
        (
            SELECT  ID, Max(LastEdited) lastEdit
            FROM news
            GROUP BY ID
        ) x ON n.ID = x.ID AND 
               n.LastEdited = x.LastEdit
-- WHERE ...
-- ORDER BY ...
-- LIMIT ...
"
24289,Rails 3 Joins Active Record query,"<% @bees.each do |b| %>
  <%= b.a.name %>, <%= b.a.date %>
<% end %>
"
1583,SQL parse string,"rtrim(substring(FormName, charindex(', ', FormName, 0) + 2, 20))
                                               ^^^^^^
"
34293,Find value of the last NOT NULL column in each row of a table in SQL,"SELECT COALESCE(col6, col5, col4, col3)
FROM AddressTable
WHERE rowId = :input
"
18131,SQL Where Only In,"select contract
from list
group by contract
having sum(case when ProductLine not in ('Cable', 'Telephone') then 1 else 0 end) = 0
"
33554,how to get similar objects based on tags,"SELECT movie.*, count(DISTINCT similar.tag) as shared_tags FROM movie INNER JOIN 
    ( tagged AS this_movie INNER JOIN tagged AS similar USING (tag) )
    ON similar.movie = movie.id
WHERE this_movie.movie=<current_movie_id>
AND   movie.id != this_movie.movie
GROUP BY movie.id
ORDER BY shared_tags DESC
"
15232,Synchronizing against unknown database schema in Android,"db_version=12345
"
15531,"mysql :: insert into table, data from another table?","INSERT INTO action_2_members (campaign_id, mobile, vote, vote_date)  
SELECT campaign_id, from_number, received_msg, date_received
  FROM `received_txts`
 WHERE `campaign_id` = '8'
"
22120,Random sorting query Access,"Rs.Source = ""SELECT pk FROM TABLE ORDER BY Rnd(-Timer() * [pk]) Asc""
"
8712,Sql server update multiple columns from another table,"UPDATE table1 
SET a = t2.a,
    b = t2.b,
    (...)
FROM 
(
SELECT ..... with join ... WHERE .... 
) t2
WHERE table1.id = table2.id
"
23522,SQL Query - Displaying the same column twice under different conditions,"SELECT 
   NAME, 
   MIN(ID) as ID1,
   MAX(ID) as ID2
FROM Table t
GROUP BY NAME
"
7742,"SQL Group By Statement, Max Values For Grouped Data","SELECT
Sheet1.ProductId, Sheet1.ReportingDate, Sheet1.Quantity
FROM Sheet1 INNER JOIN
(SELECT Sheet1.ProductId, MAX(Sheet1.ReportingDate) AS MaxOfReportingDate
FROM Sheet1
WHERE ReportingDate < #2012/03/15#
GROUP BY ProductId) AS a 
ON Sheet1.ProductId = a.ProductId AND Sheet1.ReportingDate = a.MaxOfReportingDate
ORDER BY Sheet1.ReportingDate DESC
"
13036,MySql User Defined Variable,"SELECT  @r := 1

---
  1

SELECT  @r := @r + 1

---
  2
"
29749,mysql: sub-query makes global query much slower than just using the sub-query's actual results,"select AC.category_id, count(*) as num_articles
from categories C
join articles_categories AC on C.id = AC.category_id
join (
  select id from articles where match(name, teaser, plaintext_contents) against ('some text' in boolean mode)
) A_IDS ON A_IDS.id=AC.article_id

group by AC.category_id;
"
16197,Show me the index on the table in Oracle,"SELECT index_name
  FROM all_ind_columns
 WHERE table_name = 'THE_TABLE'
   AND column_name = 'THE_COLUMN'
   AND index_owner = 'THE_OWNER';
"
22692,sql complex select statement,"select index_name from <table> where column_name='b' and index_name in 
(select index_name from <table> group by index_name having COUNT(index_name) = 1)
"
36837,SSIS expression similar to case statement,"FINDSTRING(Status,""Open"",1) > 0 ? 0 : (FINDSTRING(Status,""Won"",1) > 0 ? 1 : (FINDSTRING(Status,""Lost"",1) > 0 ? 2 : 3))
"
13833,SQL - having VS where,"SELECT  L.LectID, Fname, Lname
FROM Lecturers L
JOIN Lecturers_Specialization S ON L.LectID=S.LectID
GROUP BY L.LectID, Fname, Lname
HAVING COUNT(S.Expertise)>=ALL
(SELECT COUNT(Expertise) FROM Lecturers_Specialization GROUP BY LectID)
"
19771,Create column corresponding to entry rank position in SQL,"select t.*,
       (@rn := @rn + 1) as rank
from table t cross join
     (select @rn := 0) params
order by intcol;
"
18156,Trigger to Add Newly Inserted Rows in Another Table,"CREATE OR REPLACE TRIGGER ESURUSAGE
AFTER INSERT
ON X
FOR EACH ROW 
BEGIN 
  INSERT INTO Y VALUES
  ('DSS', SYSDATE, upper(:new.user_name) , null , null, upper(:new.user_name), upper(:new.user_name), SYSDATE, SYSDATE); 
END;
"
34426,Merge statement help in oracle,"MERGE INTO table_A a
   USING table_b b
      ON(a.b = b.m)
   WHEN MATCHED THEN 
      UPDATE SET a.c = 1
   WHEN NOT MATCHED THEN 
      INSERT (a, b, c)
      VALUES ('P', b.m, 1)
"
10688,SQL Server 2008 Array Query,"SELECT n
FROM (VALUES(1),(2),(3),(4),(5),(6)) AS Nums(n)
EXCEPT
SELECT RecoveryID from table1 
"
7508,Apply rank using RowNumber based on multiple conditions,"WITH Cte AS(
    SELECT *,
        ZeroRatio = SUM(CASE WHEN Ratio = 0 THEN 1 ELSE 0 END) OVER()
    FROM TestData
),
CteRN AS(
    SELECT *,
        RN = ROW_NUMBER() OVER(ORDER BY 
            CASE WHEN ZeroRatio >= 5 AND Ratio = 0 THEN NumContracts END DESC,
            Ratio
        )
    FROM Cte
)
SELECT
    RN, Vehicle, NumContracts, SaleAmount, Ratio
FROM CteRN
ORDER BY RN
"
34575,SQL Grouping: Most recent record between users,"SELECT Message.*
FROM Message
WHERE Message.MessageID IN
(SELECT MAX(MessageID) FROM Message 
    GROUP BY 
        CASE WHEN ReceivingUserID > SendingUserID 
            THEN ReceivingUserID ELSE SendingUserID END,
        CASE WHEN ReceivingUserID > SendingUserID
            THEN SendingUserID ELSE ReceivingUserID END
)
"
1713,JSON output in Postgresql,"SELECT array_to_json(array_agg(row_to_json(t))) FROM 
    (SELECT col1, col2, col3 FROM example_table) t
"
34622,How to find if a list/set is contained within another list,"SELECT order_id
FROM orders
WHERE product_id in (222,555) 
GROUP BY order_id
HAVING COUNT(DISTINCT product_id) = 2
"
26988,SQL - Multiple owned items,"CREATE TABLE person_printer
(
   person  int not null,
   printer int not null,
   PRIMARY KEY (person, printer)
)
"
23429,trying to use partitioning instead of sub querys,"select UserEmails.Email as OldEmail,GAB.Email as NewEamil
from   UserEmailsfromAddressBook  
inner join UserEmails on UserEmails.Email=UserEmailsfromAddressBook.Email
      and isprimary =0
inner join UserEmailsfromAddressBook  GAB on GAB.memberId=UserEmailsfromAddressBook.memberID
     and GAB.isprimary=1
"
35825,Order by highest number of records in a field in mysql,"select
  t.*
from
  table1 t
  inner join (select 
                name, 
                count(*) as cnt 
              from table1 
              group by name
              order by count(*) desc
              limit 2) as c on t.name = c.name
order by c.cnt desc
"
22166,"Group on ID, and sum from different table (3 table total)","select top 10 s.SALESID,
    SUM(sp.LINEAMOUNT) as 'TotalLineamount'
from AX_CUSTPACKINGSLIPJOUR as s
right outer join AX_SALESLINE as sp on s.SALESID=sp.SALESID 
left outer join AX_INVENTTRANS as p on sp.ITEMID=p.ITEMID
where s.SALESID is not null
group by s.SALESID
"
32816,Executing SQL files using Groovy in Gradle,"def sqlDir = file 'src/main/resources/' 

task testSql << {
    fileTree(dir: sqlDir, include: ""**.sql"", exclude: [""somefilename.sql"", ""otherfilename.sql""]).each {
        sql.execute(it.text)
    }
}
"
33693,Update table using inner join on several fields,"update B
set B.NBR_OF_BACKUP=I.NBR_OF_BACKUP - 1
FROM BACKUP_TABLE B
INNER JOIN (SELECT id_backup, count(*) as nbr_of_backup FROM tbl GROUP BY id_backup) I 
ON B.ID_BACKUP=i.id_backup 
"
24489,SQL Server : selecting TOP Records and updating results in another table,"Select
   U.User, Max(L.LogOnDate)
   From Users U
   Join Login L On L.User = U.User
"
34626,Searching a table in several databases,"EXECUTE sp_msforeachDB 'IF EXISTS(
    Select 1 From [?].INFORMATION_SCHEMA.Tables where TABLE_NAME = ''tbl_mytable'') 
    PRINT ''?'''
"
27911,Left outer joins that don't return all the rows from T1,"LEFT JOIN support s on s.candidate_id=c.id and s.user_id = 2
"
28328,Updating records based on the largest value on its related table,"UPDATE  tableA a
        INNER JOIN
        (
            SELECT  ID, MAX(Value) max_val
            FROM    tableB
            WHERE   SUB_GROUP IN ('Category 2','Category 3')
            GROUP   BY ID
        ) b ON a.ID = b.ID
SET a.VALUE = b.Max_Val
"
39405,Database creation script - external parameters/settings,":setvar filename somefile.ext
:setvar version 1
:on error exit

print 'This is version $(version) on $(filename)'
-- the rest of the actual script
"
5417,Stored Procedure Update a Cursor then Return the Result,"declare

   NAME     VARCHAR2 (10);
   SALARY   VARCHAR2 (10);

begin

FOR cid IN ( select FNAME,SALARY FROM STAFF) LOOP

      NAME := cid.NAME;
      SALARY := cid.SALARY;

      DBMS_OUTPUT.
       put_line (
            NAME
         || ' | '
         || SALARY);
END LOOP;

END;
"
1952,How to camelcase a string like with Initcap but with exception of letters followed by dot?,"select 
   regexp_replace(
      initcap(
         regexp_replace('ABC&EFG d.d.', '(\w+\.)', chr(1)||'a\1')
      ), 
   chr(1)||'.') 
from dual;
"
27448,insert COUNT n1 and n2 column in SELECT query,"SELECT item_name, 'ALL', COUNT(*)  as Quantity
FROM tbl
GROUP BY item_name
UNION ALL 
SELECT item_name, item_color, COUNT(*) as Quantity
FROM tbl
GROUP BY item_name, item_color
"
31037,Mysql PREPARE statement is taking much times at the time of record insertion,"IF 0 = (SELECT COUNT(*) 
          FROM user_friend_list 
         WHERE user_id = @USERREGID
           AND friend_user_id = FID) THEN
    INSERT INTO user_friend_list(user_id, friend_user_id) 
    VALUES (@USERREGID,FID), (FID,@USERREGID);
END IF; 
"
3628,SQL getting the output from a stored procedure?,"DECLARE @retval As DATETIME

EXEC dt_char_sp 20130416, 024356, @datetime=@retval OUTPUT

PRINT @retval
go
"
10396,SQL DateTime convert to Time String,"SELECT DISTINCT DATENAME(hour, RunDate) + ':' + DATENAME(minute, RunDate) AS Output...
"
29169,Oracle MONTHS_BETWEEN to return a whole number,"ROUND(MONTHS_BETWEEN(CON.F_CON_END_DATE, TRUNC(SYSDATE)), 0) MONTHSTOEXPIRE
"
5035,How would you implement a one-to-many relationship?,"**Owner**
ID

**Car** 
ID
OwnerID
"
31910,Converting from integer to binary and back in SQL Server,"select CONVERT(BIGINT, CONVERT(BINARY(30), CONVERT(BIGINT, 2691485888)))
"
23635,Calculating Conversion Rate In MySQL,"(100 * SUM(click1) / SUM(`unique`))
"
1729,ORACLE find some previous and next words in a NCLOB,"REGEXP_SUBSTR(dbms_lob.substr(MC.content_txt,80,dbms_lob.instr(UPPER(MC.content_txt),UPPER(:key))-40),' .+[ \/,\\]',1,1,'n')
"
16928,Cast uniqueidentifier to binary,"DECLARE @program_guid uniqueidentifier, @program_binary binary(16)
--
SELECT @program_guid = '327EBEA7-3D4E-473A-8D72-7CB68AB51F73'
SELECT @program_binary = CAST(@program_guid AS binary(16)) 
"
20175,Updating a column using values from a Lookup table,"merge into products
using product_type
   on products.prod_code = product_type.prod_code
  and product_type.prod_region is null   
when matched then update
set prod_type = product_type.prod_type;

merge into products
using product_type
   on products.prod_code = product_type.prod_code
  and products.prod_region = product_type.prod_region
when matched then update
set prod_type = product_type.prod_type;
"
11265,SELECT subquery within IN statement hanging SQL Server,"DECLARE @MaxAsOfDate datetime;
SET @MaxAsOfDate = (SELECT MAX(AsOfDate) FROM dbo.v_View1)

SELECT *
FROM dbo.v_View1 View1 FULL OUTER JOIN
    dbo.v_View2 View2 ON View1.Portfolio = View2.Portfolio AND 
    View1.AsOfDate = View2.AsOfDate
where (View1.AsOfDate IN (NULL, @MaxAsOfDate))
"
3519,Function format number,"to_char( n1, 'fm999,999,999.99' )
"
26225,SQL results to string with wildcard,"DECLARE @sql NVARCHAR(max)='SELECT '
DECLARE @TableName NVARCHAR(max) = 'Table_Name' -- <-- Set the target table name here

SELECT @sql=@sql+N'ISNULL(CAST(' + name +' as NVARCHAR(max)), '''')+'',''+'
FROM sys.columns
WHERE object_id=OBJECT_ID(@TableName)

SELECT @sql=SUBSTRING(@sql,1,LEN(@sql)-5)+N' FROM ' + @TableName
--SELECT @sql -- uncomment to see the query string

EXEC sp_executesql @sql
"
21693,calculate elapsed time in oracle between entries from one particular condition to whatever condition is next,"SELECT to_char((EVENT_DURATION) + trunc(sysdate), 'HH24:MI:SS') 
FROM (SELECT (DATE_DT - LEAD(DATE_DT) OVER (ORDER BY DATE_DT DESC)) AS EVENT_DURATION
      FROM TEST_CHRIS
     ) tc
WHERE ASSET_ID = 4380 AND EVENTTYPE = 1 AND
      trunc(DATE_DT) = trunc(SYSDATE);
"
39458,Oracle : Generate rows with slightly different values in a column,"with n as (
      select level as m
      from dual
      connect by level <= 18
     )
select t.id, add_months(t.summary_date, n.m, keywork_id, data
from table t cross join
     n;
"
39695,How to update multiple rows with multiple values?,"update ce set valor=valor/@total from #table1 ce inner join table2 m
on ce.t2id=m.id 
where codigo in (10, 11)
"
15413,Group records by users MySQL/PHP,"SELECT  a.*
FROM    messages a
        INNER JOIN
        (
            SELECT  sender, MAX(ID) MAX_ID
            FROM    messages
            GROUP   BY sender
        ) b ON a.sender = b.sender AND
                a.id = b.MAX_ID
// WHERE clause...
// ORDER BY ....
// LIMIT  .....
"
39476,SQL Selecting from a value from two tables,"SELECT * FROM `table` WHERE `code` = 15510642
UNION [ALL]
SELECT * FROM `table2` WHERE `code` = 15510642
"
16104,mySQL: Updating multiple values in a record with a SELECT from another table,"UPDATE `foo`, `bar`
SET `foo`.`x` = `bar`.`x`, 
    `foo`.`y` = `bar`.`y`, 
    `foo`.`z` = `bar`.`z`
WHERE `id` = 'baz';
"
10592,How to Query 2 SQL databases and compare results,"Select * 
From Customers b
Where bactive = 'True'
and exists
(Select 'x' from 
database1.dbo.Customers A
where a.dtcreated > @startdate
and a.key = b.key)
"
10806,Atomically mark and return a group of rows in database,"WITH cte AS (
  SELECT TOP(20) status, id, ...
  FROM table WITH (ROWLOCK, READPAST, UPDLOCK)
  WHERE status = 'new'
  ORDER BY enqueue_time)
UPDATE cte
  SET status = 'processing'
OUTPUT
  INSERTED.id, ...
"
22163,How to filter SQL by time (greater and less than)?,"SELECT * FROM data 
WHERE DATETIME(
  substr(time,1,4)||'-'||
  substr(time,6,2)||'-'||
  substr(time,9,2)||' '||
  substr(time,12,8)
) 
BETWEEN DATETIME('2014-04-25 18:00:00') AND DATETIME('2014-04-25 19:00:00');
"
16418,Compare two table in sqlite,"SELECT DISTINCT Field1
FROM Table1 
WHERE Field1 Not IN 
    (SELECT DISTINCT Field1 FROM Table2)
"
29018,cross referencing records across tables,"SELECT   email, COUNT(*) AS num_tables
FROM     (SELECT DISTINCT email FROM table1
          UNION ALL
          SELECT DISTINCT email FROM table2
          UNION ALL
          -- All the other tables
         ) t
GROUP BY email
HAVING   COUNT(*) > 1
"
24400,Error in create database postgresql,"       ResultSet res = st.executeQuery(""select count(*) from pg_catalog.pg_database where datname = 'sample'"") ;
       res.next();
       int count = res.getInt(""count"");
       System.out.println(""Count : "" + count);
       if(count == 0) {
         st.executeUpdate(""CREATE DATABASE sample"");
       }
"
7589,Guaranteeing sequential order in Oracle SQL query,"Select
  *
From (
  Select
    * 
  From
    Person
  Where 
    ID >= '101'
  Order By
    ID Desc
  ) a
Where
  rownum <= 5
"
33631,SQL Query to select row in db who's publish time and end time should not overlap,"SELECT question_id FROM questions
where '"".$publish_date.""' BETWEEN publish_date AND end_date
AND '"".$publish_time."" BETWEEN publish_time AND end_time
"
36083,Wired sql query,"select sid from Am where year = 2014 
and amount = (select max(amount) from Am where year = 2014)
"
18724,Datediff with dates in one column but only showing datediff compared to the next invoice,"select 
  id, type1, amount, date,
  datediff(day, 
    (select top 1 date 
     from table1 
     where date <= t.date 
     and type1= 'Invoice'
     and t.type1='Payment' 
     order by date desc), 
    date) as diff
from table1 t;
"
35241,how to select convert list varchar for WHERE IN() SQL Query,"SELECT *
FROM   table2
WHERE  code IN (SELECT code FROM table1)
"
27737,Speed Performance In Recursive SQL Requests,"WITH CatCTE(OID, Name, ParentID) 
AS 
( 
   SELECT OID, Name, ParentID FROM Work.dbo.eaCategory
   WHERE OID = 0   
       UNION ALL 
   SELECT C.OID, C.Name, C.ParentID FROM Work.dbo.eaCategory  C JOIN CatCTE as CTE ON C.ParentID= CTE.OID
) 
SELECT * FROM CatCTE
"
9217,Optimize Select in Select,"SELECT items.* FROM items 
INNER JOIN tags_relationships r1 ON (r1.post_id = items.id)
INNER JOIN tags_relationships r2 ON (r2.post_id = items.id)
INNER JOIN tags t1 ON (t1.tag_id = r1.tag_id)
INNER JOIN tags t2 ON (t2.tag_id = r2.tag_id)
WHERE 
    t1.name = 'white'
AND t2.name = 'bike'
AND items.status = 'publish' 
ORDER BY ID DESC
"
22234,Select sum of items based on their monthly entry date,"SELECT EntryDate, Items
FROM (SELECT YEAR(EntryDate)'Year_',MONTH(EntryDate)'Month_',CAST(EntryDate AS VARCHAR(12))'EntryDate',Items,1 'sort'
      FROM Inventory
      UNION ALL
      SELECT YEAR(EntryDate)'Year_',MONTH(EntryDate)'Month_','Total',SUM(Items)'Items',2 'sort'
      FROM Inventory
      GROUP BY YEAR(EntryDate),MONTH(EntryDate)
      )sub
ORDER BY Year_,Month_,sort
"
1036,"Equivalent query using joins, instead of not exists","with x as (select Ext_ID, Tb1_ID, Sum(Primary) as sum_primary 
from Table2 group by Ext_ID,Tb1_ID)

SELECT TB1.ID 
FROM Table1 TB1 JOIN x
ON Table1.EXT_ID = x.EXT_ID
where x.sum_primary = 0
"
24998,MySQL join on data where right side has prepended string,"SELECT whatever
FROM table1 AS t1
JOIN table2 AS t2 ON CONCAT('node/', t1.id) = t2.id
"
37739,copy table and drop it,"IF (EXISTS (SELECT * 
         FROM INFORMATION_SCHEMA.TABLES 
         WHERE TABLE_NAME = 'tbl2'))
BEGIN
    -- tbl2 exists, so just copy rows
    INSERT INTO tbl2 SELECT * FROM tbl1;
END
ELSE BEGIN
    -- tbl2 doesn't exist, so create new table tbl2 and copy rows 
    SELECT * INTO tbl2 FROM tbl1;
    DROP tbl1;
END
"
29886,"""SET FOREIGN_KEY_CHECKS = 0;"" Oracle Equivalent","SQL> CREATE TABLE t1 (ID NUMBER PRIMARY KEY);

Table created

SQL> CREATE TABLE t2 (ID NUMBER REFERENCES t1);

Table created

SQL> INSERT INTO t1 VALUES (1);

1 row inserted

SQL> INSERT INTO t2 VALUES (1);

1 row inserted

SQL> -- this fails because of the foreign key
SQL> DROP TABLE t1;

ORA-02449: unique/primary keys in table referenced by foreign keys

SQL> DROP TABLE t1 CASCADE CONSTRAINTS;

Table dropped
"
5837,Oracle - Understanding the 'Using' Keyword...?,"OPEN myREF 
     FOR SELECT * 
         FROM MYTABLE 
         WHERE MYID IN (select * from table(:Values)) 
     USING myPassedInValList;
"
14274,Is there a standard way to duplicate a row in a database table?,"INSERT INTO `<table>` (column1, column2, ...) -- Not IDENTITY columns
SELECT column1, column2, ... FROM ...
"
18018,SQL Column compare in the same table (self-join),"SELECT
*
FROM
tbl
WHERE
category = 'b'
AND value NOT IN (SELECT value FROM tbl WHERE category = 'a')
"
16108,SQL query that returns value based on lookup of id in another table,"SELECT
  Events.EventName AS EventName,
  EventsLocation.LocationName AS LocationName
FROM
  Events
  INNER JOIN EventsLocation ON Events.Location=EventsLocation.Location
(WHERE ...)
;
"
34377,How to find who deleted a view from DB with SIMPLE recovery model,"DECLARE @path NVARCHAR(260);

SELECT 
   @path = REVERSE(SUBSTRING(REVERSE([path]), 
   CHARINDEX(CHAR(92), REVERSE([path])), 260)) + N'log.trc'
FROM    sys.traces
WHERE   is_default = 1;

SELECT 
   LoginName,
   HostName,
   StartTime,
   ObjectName
FROM sys.fn_trace_gettable(@path, DEFAULT)
WHERE EventClass = 47
AND ObjectName = N'MyView';
"
10274,"Query table and compare with another query (if exist, show in result)","Select distinct substring(order_no,1,7) 
from test t
where process='EX' 
and EXISTS ( Select 1 from test 
where process='SL' 
and substring(t.order_no,1,7) = substring(order_no,1,7));
"
5155,Cannot getting Correct query,"select  1.0 * data / sum(data) over ()
from    tableName
"
17325,Get distinct result,"SELECT
   P.ProductID,
   CASE WHEN COUNT(R.FirstProductID) > 0
        THEN 'Linked'
        ELSE 'Not Linked'
   END Relation
FROM Product P
   LEFT JOIN ProductRelation R
      ON P.ProductID = R.FirstProductID
        OR P.ProductID = R.SecondProductID
GROUP BY P.ProductID
"
36441,Save SQL query to variable,"DECLARE 
    _query : text;
    r : record;
BEGIN
    _query := 'SELECT * FROM posts';

    FOR r IN EXECUTE _query LOOP
       -- do stuff
    END LOOP;

    RETURN new;
END;
"
6366,How do I view my stored procedures in phpMyAdmin?,"SELECT routine_definition
FROM information_schema.routines
WHERE 
routine_name = 'procedure_name' AND routine_schema = 'databasename';
"
2716,SQL server join vs subquery performance question,"select 
   usertable.userid,
   (select name from nametable where userid = usertable.userid) as name 
from usertable 
where active = 1
"
20757,PL/SQL Sum by hour,"SELECT TRUNC(stoptime,'HH'), sum(eventcapacity) 
  FROM yourtable
 GROUP BY TRUNC(stoptime,'HH');
"
20512,"SELECT SQL, a number multiple of N","SELECT MULTI, N
FROM TAB
WHERE MOD(MULTI,N) = 0;
"
6179,Delete Using Multiple Tables and repeat table in the subquery,"DELETE e1
FROM Employee AS e1
JOIN (SELECT deptID
      FROM Employee AS e
      JOIN Sales AS s ON e.ID = s.ID
      GROUP BY deptID
      HAVING SUM(Sales) <= 400) AS d
ON e1.deptID = d.deptID
"
14342,How to copy rows with SQL and get new and old IDs as result?,"DECLARE @t TABLE (oID int, nID int);

MERGE T s
USING (
        SELECT TID, name, address
        FROM T [s]
      ) d on 0 = 1
WHEN NOT MATCHED
THEN INSERT (name, address)
    VALUES (name, address)
OUTPUT d.TID as oID, Inserted.TID as nID
INTO @t;
"
28528,Checking if a textbox is empty?,"If me.text13.value = 0 then
"
1491,"SQL SUM, Group by and Having query","SELECT * FROM Products WHERE
PrimaryPLU IN 
(select SKU FROM Stock 
WHERE BranchID IN (2,12,1,11,0,96,31,32,13,14,15) 
AND ApplicationID = @site 
GROUP BY SKU HAVING(SUM(CASE WHEN Stock < 0 AND BranchID = 31 
              THEN Stock ELSE 0 END)) > 0))
"
10331,SQL Select for each Age Group and COUNT Members,"SELECT AgeGroups.GroupID, AgeGroups.GroupTitle, COUNT(1) AS MemberCount
FROM AgeGroups
JOIN Events ON EventID = 1
JOIN Members 
ON DATEDIFF(year, Members.DOB, Events.EventStart) >= AgeGroups.MinAge
AND DATEDIFF(year, Members.DOB, Events.EventStart) <= AgeGroups.MaxAge
ORDER BY AgeGroups.GroupID
"
987,Math within a SQL query - Adding 'results' to display new 'results',"SELECT  [agtName]
,       count(*)
FROM    fnDynamicCSCAgtFctByMth('09/24/2012','11/07/2012') 
WHERE   acct_mo_n = 'October' 
group by 
        agtName
order by 
        agtName desc
"
11100,SQL: if cannot convert to_number set as null,"SELECT 
  CASE
     WHEN TRIM(TRANSLATE(COLUMN_NAME, '1234567890', ' ')) IS NULL THEN NULL
     ELSE COLUMN_NAME
  END AS ""NUMERIC_COLUMN""
FROM
  TABLE_NAME;
"
28806,Unique combination of columns MySQL,"CREATE PROCEDURE InsertOrUpdateSimilarity (
    pu1 INT, pu2 INT, ps FLOAT -- user1, user2, similarity
)
BEGIN
    -- try to update either (pu1, pu2) or (pu2, pu1)
    UPDATE similarities SET similarity = ps
    WHERE (user1 = pu1 AND user2 = pu2) OR (user1 = pu2 AND user2 = pu1) ;

    IF ROW_COUNT() = 0
    THEN -- no row has been updated, record must be created
        INSERT INTO similarities VALUE (pu1, pu2, ps) ;
    END IF ;
END ;
"
24035,Add date to SQL database backup filename,"DECLARE @MyFileName varchar(1000)

SELECT @MyFileName = (SELECT '\\ServerToSave\Path\MyDB_' + convert(varchar(500),GetDate(),112) + '.bak') 

BACKUP DATABASE [myDB] TO DISK=@MyFileName ...
"
38908,countif type function in SQL where total count could be retrieved in other column,"select ID, Name, Ref, (select count(ID) from [table] where Ref = A.Ref)
from [table] A
"
27393,Performing a prefix computation using SQL without defined procedures,"select value,
(select sum(t2.value) from table t2 where t2.id <= t1.id ) as accumulated
from table t1
"
34254,"Oracle regexp_replace: Don't replace the first character, replace others","SELECT REGEXP_REPLACE(phone,'[\|\]','-') 
FROM phone_tbl 
WHERE emplid = employee;
"
19082,Getting friends update query,"SELECT
    U.member_id,
    U.update_action,
FROM members M
    JOIN member_friends F
        ON M.id = F.logged_user_id
    JOIN member_updates U
        ON U.member_id = F.friend_id
WHERE M.id = :id
    AND U.update_hidden <> 1
ORDER BY U.update_id DESC
"
13553,Count distinct records in one column with multiple values in another column,"select e.col1, count(e2.col2)
from example e left join
     example e2
     on charindex(e.col1, e2.col2) > 0
group by e.col1;
"
31465,Querying multiple mySQL tables simultaneously,"SELECT *
FROM one
JOIN two ON one.uid = two.uid
JOIN three ON one.uid = three.uid
WHERE one.uid='1234567'
"
39204,Why ths works in anonymous but not in a procedure?,"create procedure tests authid CURRENT_USER is
  l_foo clob;
begin
select
regexp_replace(
  dbms_metadata.get_ddl('USER', 'SCOTT', null) ||
  dbms_metadata.GET_GRANTED_DDL ('SYSTEM_GRANT', 'SCOTT') ||
  dbms_metadata.GET_GRANTED_DDL ('OBJECT_GRANT', 'SCOTT') ||
  dbms_metadata.GET_GRANTED_DDL ('ROLE_GRANT', 'SCOTT')
,'""' || chr(10), '"";' || chr(10)) 
into l_foo 
from dual;
end;
/

SQL> EXEC tests 

PL/SQL procedure successfully completed
"
36896,Get articles and comments with only one SQL query ? (one to many relation),"SELECT * FROM Articles as a
INNER JOIN comments as c
ON a.articleId = c.ArticleId
"
15747,SQL query where clause filter based on another column value,"SELECT   MAX(created_date) AS maxtime ,team_id, ticket_id 
FROM     ri_ticket_status_history 
WHERE    (status_id<>7 AND team_id > 1) OR team_id = 1
GROUP BY team_id, ticket_id
"
32943,Search for “whole word match” with SQL Server LIKE pattern,"'.' + column + '.' LIKE '%[^a-z]pit[^a-z]%'
"
4589,MYSQL - Joining three tables,"SELECT p.Name, a.Name, CASE WHEN (pa.Value IS NOT NULL) THEN pa.Value ELSE 0 END
FROM Person p
CROSS JOIN Activity a 
LEFT JOIN Person_Activity pa ON p.ID = pa.PersonId AND a.ID = pa.ActivityId
WHERE p.Dept = 1 and a.Dept = 1
ORDER BY 1, 2
"
27417,Update all field values by concatenate from two tables,"UPDATE items i
INNER JOIN buffer b ON i.id = b.id
SET i.keywords = CONCAT(i.keywords, ', ', b.value);
"
2906,"Taking records from a column, and inserting them into one row in Access","TRANSFORM SUM(Amount)
SELECT CustomerID, Type, Amount 
FROM CurrentData 
GROUP BY customerID
PIVOT Type; 
"
927,How to calculate an SQL MAX() for any N-second duration within a certain timeframe,"SELECT
  s.timestamp,
  v.user_id,
  (
   SELECT COUNT(*) FROM user_item_views 
    WHERE timestamp BETWEEN s.timestamp AND ADDTIME(s.timestamp, '00:00:59')
          AND user_id = v.user_id
  ) item_count
FROM
  every_second s
  LEFT JOIN user_item_views v ON v.timestamp = s.timestamp
GROUP BY
  s.timestamp, 
  v.user_id
"
692,"Oracle PL/SQL Program Not Working, program involves Records and Composite Data","hr_myrecord.hr_longevity := 
    TRUNC(MONTHS_BETWEEN(SYSDATE, hr_myrecord.hr_rec_row.hire_date), 1);
"
7581,Show only first row within a group for Microsoft SQL Server,"WITH CTE AS
(
    SELECT ID1, ID2,  Name, Phone,
           RN = ROW_NUMBER() OVER (PARTITION BY ID1 ORDER BY ID2 ASC)
    FROM dbo.TableName
)
SELECT ID1, ID2,  Name, Phone 
FROM CTE WHERE RN = 1
"
39477,Select based on table name w/ SQL for time series tables?,"select userid, count(*) as NumActions
from ActionTable
where ActionDate bewteen @date1 and @date2;
"
14939,SQL Query - Left Join or Union?,"select o2.id, o2.name
from options o1
inner join options o2 on o2.option_group_id = o1.option_group_id
where o1.id = 14122
"
33025,SQL JOIN and ORDER two tables by one column,"select id, createdAt, media, userId, Null as text from Activity 
union all
select id, createdAt, Null as media, userId, text from Notifications 
order by createdAt
limit 100
"
18732,Select Count Query Giving Inaccurate Results,"SELECT COUNT(*) 
FROM    (
     SELECT ACTION_TYPE
     FROM CANCELLATION_DEFINITION WHERE ACTION_TYPE != '-'
     )AS distinctified  
"
21437,Slow copying of virtual table rtree,"BEGIN;
DELETE FROM mCoordinates_node;
INSERT INTO mCoordinates_node   SELECT * FROM fs.coordinates_node;
INSERT INTO mCoordinates_parent SELECT * FROM fs.coordinates_parent;
INSERT INTO mCoordinates_rowid  SELECT * FROM fs.coordinates_rowid;
COMMIT;
"
29381,How to do an mySQL query that return unique values from different tables,"SELECT G.name,
   GROUP_CONCAT(P.name)
 FROM  auth_group_permission GP
 INNER JOIN auth_group G ON G.id = GP.group_id
 INNER JOIN auth_permission P ON P.id = GP.permission_id
 WHERE G.name LIKE 'BIG_RA_%'
 GROUP BY G.name
"
36336,How to control order of assignment for new identity column in SQL Server?,"SELECT
    ID, CreateDate
INTO
    MyNewTable
FROM
    (
    SELECT
        CreateDate,
        ROW_NUMBER() OVER (ORDER BY CreateDate ASC) AS ID
    FROM
        MyTable
    ) foo
"
27958,Is there a workaround to Vertica's limitation of one database at a time?,"DB1 on node1, node2, node3
DB2 on node4, node5, node6
"
36634,Losing SQL results when moving a filter outside of a subquery,"SELECT purchase_id, rn
FROM 
(
   SELECT vrd.purchase_id, 
          af.date as affiliation_date,
          row_number() over (partition by af.customer_id order by af.date desc) as rn

   FROM v_details vrd
   LEFT OUTER JOIN affiliates af
     ON vrd.customer_id = af.customer_id AND af.date <= vrd.purchase_date

   WHERE vrd.date >= DATE'2012-12-01'
) T
WHERE rn = 1
  AND purchase_id = 1122996729
"
15330,mysql daily count grouped by one column,"SELECT  DAYNAME(sip_Date) AS DAY,
        COUNT(DISTINCT sip_callid)
FROM    request_line
WHERE DAYNAME(sip_Date) = 'Saturday' 
GROUP BY DAYNAME(sip_Date)
"
13243,select value from second table which ID is in my first table,"select
s.FIRST_NAME,
s.LAST_NAME,
c.name as status    
from STUDENTS s
left join PAYER_STATUS c on s.Status = c.ID
where c.name like N'%'||'active'||'%';!
"
12321,How to write query with like in Doctrine2,"public function findForMonthAndCat($user, $month, $category)
{
    $q = $this
        ->createQueryBuilder('e')
        ->where('e.date LIKE :month')
        ->andWhere('e.user = :user')
        ->andWhere('e.category = :category')
        ->setParameter('month', ""%$month"")
        ->setParameter('user', $user)
        ->setParameter('category', $category)
         ->getQuery();

    return $q->getResult();
}
"
13781,Oracle - grant privileges to all users,"grant select on table to public;
"
28198,Confused about the role of a query language,"select columname from tablename where columnname=1
"
18699,How to apply a single query that sum column for individual values,"select u.category, coalesce(sum(s.cal), 0) as cal
from users u left join
     statistics s
     on u.id = s.idUser
group by u.category;
"
13700,Return multiple columns with a select max on only one,"select func_status_code, name
from (Select func_status_code, name,
             max(from_date) over () as maxdate
      from table 
      where from_date <= current date
     ) t
where from_date = maxdate
"
36830,Conditional condition in where clause,"select * 
from   table1 
where  id > 20 and 
       marks1 < 40 and 
       (
           (marks3 >40 and marks2 <30) or 
           mark3 <= 40
       )
"
26483,"pl/sql dbms_scheduler hanging, how to debug further?","select elapsed_time/1000000 seconds, gv$sql.*
from gv$sql
where users_executing > 0
order by 1 desc;
"
16163,Selecting order by matches in second table,"SELECT `IdOfPhotoVotedOn`, COUNT(`IdOfPhotoVotedOn`) 'Votes' 
FROM `CompetitionVotes` 
WHERE 1
GROUP BY `IdOfPhotoVotedOn`
ORDER BY COUNT(`IdOfPhotoVotedOn`) DESC, `IdOfPhotoVotedOn`
"
19419,Avoid duplicate rows in SQL query,"SELECT distinct 
  products.idProduct, sku, description, listPrice, smallImageUrl, 
  isBundleMain, rental, visits 
FROM products, categories_products 
WHERE products.idProduct=categories_products.idProduct 
  AND categories_products.idCategory=""& pIdCategory&"" 
  AND listHidden=0 AND active=-1 
  AND idStore="" &pIdStore& ""  
ORDER BY description
"
30621,Trigger that delete row if currentdatetime > datetime+5,"create view v_table as
    select t.*
    from table t
    where requesttime >= now() - interval 5 minute;
"
28037,Allow max 10 items with same GUID,"with todelete as (
      select id, row_number() over (partition by GUID order by timestamp) as seqnum
      from mytable
      where GUID = 'xxx'
     )
delete from mytable
    where id in (select id from todelete where seqnum > 10);
"
20629,Insert many values in SQL Server table,"INSERT into YourTable
Values(val1, val2,...val3) /*Needs to be in order as per table definition*/
"
8628,How to query multiple COUNT(*) with good performance,"select schedule_id,
       sum(case state when 0 then 1 else 0 end) as state0,
       sum(case state when 1 then 1 else 0 end) as state1,
       sum(case state when 2 then 1 else 0 end) as state2,
       count(*) as total
from schedule_user
group by schedule_id;
"
30552,How to select a column with a number name in a table with SQL,"create table test_0(`0` INT );

INSERT INTO test_0 VALUES(1);

SELECT `0` FROM test_0;
+------+
| 0    |
+------+
|    1 |
+------+
1 row in set (0.00 sec)
"
3136,"SQL Access 2010 How to DELETE rows with duplicate values for all fields but one, based on the value of the distinct field","SELECT A.ChartNumber, A.CreatedAt, A.Field_Name
FROM [Full Patient Database] A
INNER JOIN (
    SELECT DISTINCT ChartNumber, CreatedAt, Field_Name
    FROM [Full Patient Database]
    GROUP BY ChartNumber, CreatedAt, Field_Name
    HAVING COUNT (*) > 1 AND COUNT(Field_Value) < 2
) B
on A.ChartNumber = B.ChartNumber
   and A.CreatedAt = B.CreatedAt
   and A.Field_Name = B.Field_Name
WHERE A.FIELD_VALUE = 1
"
30594,Is there an automatic modification time stamp type for Oracle columns?,"INSERT INTO TABLE (...CREATED_DATE, UPDATED_DATE) VALUES (...,SYSDATE, SYSDATE);

UPDATE TABLE
   SET ...,
       UPDATED_DATE = SYSDATE
"
3062,Compare Values Between Two Tables," select
      isnull(a.item_id,b.item_id) as item_id, isnull(b.qty, 0) - isnull(a.qty, 0) as qty
    from
      table_a a
      full outer join table_b b on a.item_id = b.item_id
"
20129,Automatically sort data-bound pivot table in two dimensions in Excel 2007 using VBA,"Dim pt As PivotTable
Set pt = Worksheets(""myWorksheet"").PivotTables(""myPivotTable"")
pt.PivotFields(""DATE"").AutoSort xlAscending, ""DATE""
"
21737,web2py - programmatically insert on one-to-many db,"person = db.person.insert(name=..., dob=..., ...)
opslist = db.opslist.insert(opid=..., dop=..., ...)
db.cardlist.insert(opid=opslist, name=person, ...)
"
6732,Known issue?: SQL Server 2005 stored procedure fails to complete with a parameter,"ALTER PROCEDURE [usp_debug_mightwork]
    @DATA_DT_ID AS int = 20081130
AS
BEGIN
    DECLARE @IDATA_DT_ID AS int
    SET @IDATA_DT_ID = @DATA_DT_ID
    -- Stuff here that depends on IDATA_DT_ID
END
"
38317,Partially failed insertion to related data,"START TRANSACTION;
SELECT @A:=SUM(salary) FROM table1 WHERE type=1;
UPDATE table2 SET summary=@A WHERE type=1;
COMMIT;
"
8029,Summing multiple columns without specifying column names,"ALTER TABLE MY_TABLE 
ADD QTY_TOTAL AS QTY_1 + QTY_1 + QTY_1 + ...
"
23372,Uniqueness constraint on cross between two rows,"create unique index idx_workers_account_id on workers(account_id)
    where deleted_at is null;
"
23855,MS SQL: Convert Datetime column to nvarchar," SELECT CONVERT(nvarchar(10), getdate(), 103)
"
31237,Query involving multiple tables: INNER JOIN excludes some rows,"SELECT a.x, b.y FROM BigTable a
LEFT JOIN SmallTable1 b ON b.id = a.id
WHERE b.id IS NULL
"
26631,Only select one record if there are more than one of only certain same value of record,"select max(CONO) as CONO,max(CLNO) as CLNO,max(posi) as posi,MCCU,
sum(gamntMisc) as totalgamntMisc,sum(gttlMisc) as totalgttlMisc from Oclaimc
where cono='NP' and CLNO='7150000032'
group by mccu
"
16879,ACCESS 2010 - Autopopulating text fields based off of two comboboxes,"Dim db as Database
Dim rec1 as Recordset
Dim rec2 as Recordset

Set db = CurrentDB
set rec1 = db.OpenRecordset(""SELECT * FROM Workstations WHERE ID = "" & Me.cboWorkstationName.Column(0) & """")
set rec2 = db.OpenRecordset(""SELECT * FROM Machines WHERE ID = "" & Me.cboAssetTags.Column(0) & """")

Me.txtWorkstationName.Value = rec1(""WorkstationName"")
Me.txtSerialNumber.Value = rec2(""Serial Number"")
Me.txtMAC.Value = rec2(""MAC"")
etc...

Set rec1 = Nothing
Set rec2 = Nothing
Set db = Nothing
"
7193,How to best use SQL to find common IDs that match multiple WHERE clauses,"SELECT T1.ID
FROM PropertyTable T1
JOIN PropertyTable T2 ON T1.ID = T2.ID
WHERE
        T1.PropertyName = 'Color' AND T1.PropertyValue = 'Blue'
    AND
        T2.PropertyName = 'Size' AND T2.PropertyValue = 'Large'
"
38161,Why is my Percentage 0 when run on SQL Server?,"ROUND( (100.0*count(fpp.ID)) / ...
"
25558,How to retrieve the records that matches a part of the search?,"select * 
from my table 
where EventsAttended like ('77,%') 
   or EventsAttended like ('%,77,%') 
   or EventsAttended like (',77%') ;
"
39691,SQL Server : Subquery returned more than 1 value,"Select friend.UserID2 from User
left join Friend on friend.userid1 = user.userid
Where user.username like '%A' and friend.UserID1 ='1001'
"
19717,MySql SELECT Query performance issues in huge database,"SELECT s.idsample
FROM samples AS s 
LEFT JOIN results AS r ON s.idsample = r.idsample AND r.idtool = 1
WHERE r.idsample IS NULL
LIMIT 100
;
"
30216,SQL query to update rows,";WITH UpdateData AS
(
    SELECT 
       ID, DocNumber,
       ROW_NUMBER() OVER(PARTITION BY DocNumber ORDER BY ID DESC) AS 'RowNum' 
    FROM dbo.YourTable
)
UPDATE dbo.YourTable
SET RevOrder = RowNum
FROM dbo.YourTable t
INNER JOIN UpdateData ud ON t.ID = ud.ID
"
14536,Aggregate SQL query grouping by month,"SELECT YEAR(TransactionDate), MONTH(TransactionDate), SUM(Usage)
FROM YourTable
WHERE (TransactionDate Between [Some Start Date] AND[Some End Date])
GROUP BY YEAR(TransactionDate), MONTH(TransactionDate)
ORDER BY YEAR(Created), MONTH(Created)
"
1702,Counting multiple columns with the same criteria,"select t1.name, 
count(case when t1.alpha ='T' then 1 end),
count(case when t1.bravo='T' then 1 end),
count(case when t1.charlie='T' then 1 end)
from t1
group by name
order by name asc;
"
2194,Delete from table A joining on table A in Redshift,"DELETE FROM mytablet1
WHERE t1.field > 0
   -- don't need this self-join if {field,field2}
   -- are a candidate key for mytable
   -- (in that case, the exists-subquery would detect _exactly_ the
   -- same tuples as the ones to be deleted, which always succeeds)
-- AND EXISTS (
--     SELECT *
--     FROM mytable t2 
--     WHERE t1.field = t2.field
--     AND t1.field2  = t2.field2
--    )
    ;
"
11157,Combine Data of 2 Tables into 1 DataTable in Memory in WinForms,"select *
from PermanentBanks
union 
select *
from TemporaryBanks
"
19766,while min value of supplier table not able to give name to subquery,"FROM [dbname].[dbo].[ebay_item] I JOIN
     [dbname].[dbo].[tartikel] A
     ON A.[kArtikel] = I.[kArtikel] left JOIN
     (Select min(fEKNetto) as fEKNetto, [tArtikel_kArtikel]  
      FROM [dbname].[dbo].[tliefartikel] L
      Group by [tArtikel_kArtikel])
     ) L
     ON L.[tArtikel_kArtikel] = I.[kArtikel]
"
13767,SQL Select Count Values negativ positiv and zero values,"SELECT
Date,
SUM(CASE WHEN Value > 0 THEN 1 ELSE 0 END) AS pos,
SUM(CASE WHEN Value < 0 THEN 1 ELSE 0 END) AS neg,
SUM(CASE WHEN Value = 0 THEN 1 ELSE 0 END) AS zero
FROM yourTable
GROUP BY Date
"
12369,Prior Month for Prior Year,"DECLARE @FirstDayofPrevMonthPriorYear datetime  
DECLARE @LastDayofPrevMonthPriorYear datetime  
SET @FirstDayofPrevMonthPriorYear = DATEADD(year,-1,@FirstDayofPrevMonth)
SET @LastDayofPrevMonthPriorYear = DATEADD(year,-1,@LastDayofPrevMonth)
"
11095,SQL on IBM i - Selecting data based on combined fields from DB,"Where digits(year) || digits(month) || digits(day)  BETWEEN ? and ?
"
38206,Update newly added column according to foreign key in another column,"UPDATE CS
Set PistonMotion = C.PistonMotion
from CarSales CS inner join Cars C on C.CarID=CS.CarID
"
35021,"Delete subtable from a table, SQL","DELETE FROM table1
WHERE EXISTS (
    SELECT 1
    FROM (<your long query>) AS dt
    WHERE table1.id1 = dt.id1
      AND table1.id2 = dt.id2);
"
21731,How to select difference using sql?,"SELECT MAX(filledqty) - MAX(CASE WHEN price < 1000 THEN filledqty ELSE NULL END)
  FROM clientordermas
  WHERE clordid='w9110126';
"
7150,How do I get multiple values from a table in SQLite?,"SELECT musicals.title
FROM musicals 
JOIN authors_musicals ON (musicals.id = authors_musicals.musical_id)
JOIN authors ON (authors.id = authors_musicals.author_id)
WHERE authors.name = ""Albert""
"
17917,How can multiply two value in sql in row and put the result in the another cell in the same row?,"CREATE TRIGGER T_task on task
instead of insert
as
    insert into task (id,x,y,[x*y] /* Really need to rename this */)
    select id,x,y,x*y from inserted
"
9879,MySQL Query to find customers who have ordered two specific products,"SELECT COUNT(DISTINCT t1.userid) AS user_count
  FROM TRANSACTIONS t1
  JOIN TRANSACTIONS t2 USING (userid)
 WHERE t1.product_id = 'prod1' 
   AND t2.product_id = 'prod2';
"
22704,Using multiple CTEs in one statement,"WITH tbl1 AS
    (SELECT *
    FROM tblStuff),

tbl2 AS
    (SELECT tbl1.fldStuff1, tbl1.fldStuff2, tblStuff2.fldStuff1, tblStuff2.fldStuff2
     FROM tbl1, tblStuff2)

    SELECT *
    FROM tbl2
"
12714,UPDATE table with information from 2 other tables,"UPDATE (PB 
INNER JOIN Noeuds ON PB.NOEUD = Noeuds.NOEUD) 
INNER JOIN ColInfo ON Noeuds.NUM_COL = ColInfo.NUM_COL 
SET PB.FORFAIT = ""E""
WHERE (((ColInfo.INTEREXTER)=2));
"
13419,TSQL - Query XML,"select *
from table
where XmlField.value('count(/DynamicResults/RegQuery[@REGSubKey=""SOFTWARE\Microsoft\Windows\BlaBla""]/*)','int')>0
"
39973,How would you optimize this MySQL query,"SELECT DISTINCT
    A.X1,      
    A.X2   
FROM TABLEAA A
   JOIN TABLEBB B ON A.Y = B.Y AND B.Z='SELECTED'
   JOIN TABLECC C ON A.Y = C.Y AND C.Z='SELECTED'
"
4533,Double LEFT JOIN,"SELECT 
  `property`.`property_name`,
  COUNT(distinct unit_id) AS `units_count`,
  COUNT(distinct special_id) AS `specials_count` 
FROM `property`
  LEFT JOIN `property_unit` ON unit_property_id = property_id
  LEFT JOIN `property_special` ON special_property_id = property_id
WHERE (property_id = '1')
GROUP BY `property_id`
ORDER BY `property_name` ASC
"
6444,Complex mysql ORDER BY,"SELECT title 
FROM table 
ORDER BY TRIM(BOTH '""' FROM title);
"
12729,"from each partition, select rows with N distinct values","select t.*
from (select t.*, dense_rank() over (partition by x order by y) as seqnum
      from atable t
     ) t
where seqnum <= 2;
"
16908,Merging multiple queries preferentially,"select distinct Word
from
(
  select Word, 1 as WordOrder from table1
  union
  select Word, 2 as WordOrder from table2
) X
order by WordOrder
"
8105,oracle - run stored procedure from script,"SQL>create or replace procedure procedurename(p_num number) 
as 
begin 
null; 
end;
/

Procedure created.

SQL>execute procedurename(1);

PL/SQL procedure successfully completed.
"
26993,Find out the Employees who were absent for 3 consecutive days,"SELECT DISTINCT A.EMPLOYEENAME
FROM Attendance AS A
JOIN Attendance AS B ON B.LEAVE_DATE = A.LEAVE_DATE + 1 AND B.EMPLOYEENAME = A.EMPLOYEENAME
JOIN Attendance AS C ON C.LEAVE_DATE = B.LEAVE_DATE + 1 AND C.EMPLOYEENAME = B.EMPLOYEENAME
"
20545,SQL nested select statement;,"select ColA, ColB, ColC, ColD, (select ColE from table where colA=120) ColE
from table
where colA = 122
"
4042,how to prevent duplicates with inner join query (Postgres),"SELECT distinct ""formulation_batch"".* 
FROM ""formulation_batch"" 
INNER JOIN ""formulation_batch_component"" 
ON ""formulation_batch"".""id"" = ""formulation_batch_component"".""formulationBatch_id"" 
WHERE ""formulation_batch"".""project_id"" = 1 
    AND ((""formulation_batch_component"".""component_id"" = 2 
        OR ""formulation_batch_component"".""component_id"" = 1 ))
"
3895,Need to convert date_part from postgres to oracle,"select to_char(current_date,'IW') from dual
"
24826,How to create composite key?,"CREATE TABLE TASKS
(
TEST_ID NUMBER(6),
TASK_ID NUMBER(3),
MAX_POINTS NUMBER,
PRIMARY_KEY(TASK_ID) -- OR PRIMARY_KEY(TASK_ID, TEST_ID) for the composite key
);
"
34891,Oracle SQL: selecting date field without day (Only Month and Year),"TO_CHAR(ak.date, 'YYYY.MM') as Datum
"
4386,Create a trigger that inserts old values into other table when a row is updated,"CREATE TRIGGER triggername
ON table1
FOR UPDATE
AS
Begin
  INSERT INTO table2(name) 
     SELECT d.name 
     FROM Deleted d
End
"
34289,Codeigniter URI Not Working - 404 Error,"public function specificMarkup($id)

    {
    $query = $this->db->get_where('pages', array('id' => $id));
    $row = $query->row();
    return $row->markup;
    }
"
1169,Simple MySQL select taking too much time,"alter table Product add index cat_title_idx(CatID,Title);
"
4853,Unique over multiple columns doesn't get checked,"CREATE TRIGGER very_unique
BEFORE INSERT ON test
WHEN NEW.foo IN (SELECT foo FROM test)
  OR NEW.foo IN (SELECT bar FROM test)
  OR NEW.bar IN (SELECT foo FROM test)
  OR NEW.bar IN (SELECT bar FROM test)
  OR NEW.foo = NEW.bar
BEGIN
    SELECT RAISE(FAIL, 'foo or bar not unique');
END;
"
39062,Oracle 10g SQL like using REGEXP_LIKE,"REGEXP_LIKE(Mycolumn, '^[xf]')
"
10719,get info from XML with CodeIgniter,"<?php
$xml=simplexml_load_file(""yourxml.xml"");
echo $xml->name . ""<br>"";
echo $xml->surname . ""<br>"";
echo $xml->image1 . ""<br>"";
echo $xml->image2;
?>
"
10009,Max number in a sql table column which starts with specific number,"SELECT MAX(column_name) FROM table_name where column_name => 901000000
"
5303,Using a Parameter As An IDENTITY starting number,"CREATE TABLE #TempAccount (AccountNumber INT IDENTITY(1, 1))

Declare @StartingAccountNumber int
SET @StartingAccountNumber = 1000

DBCC CHECKIDENT
(
    #TempAccount, RESEED, @StartingAccountNumber

)
"
36790,check at least a record exists,"SELECT
  *,
  CASE WHEN EXISTS (SELECT *
                      FROM attachments
                     WHERE cust_id = customers.cust_id)
       THEN 1
       ELSE 0 END  AS has_attach
FROM
  customers
"
5471,MySQL join over three tables,"select p.name, 
      count(r.name) as count_requests, 
      sum(r.failed) as count_failed,
      count(r.name) - sum(r.failed) as count_bookings
  from products p
  left join requests r on (p.name = r.name)
 group by p.name;
"
1656,Verify string presence in encrypted database,">>> words = [""secret"", ""hidden""]
>>> db = set([hashlib.sha256(word).hexdigest() for word in words])
>>> db
set(['2bb80d537b1da3e38bd30361aa855686bde0eacd7162fef6a25fe97bf527a25b', 'e564b4081d7a9ea4b00dada53bdae70c99b87b6fce869f0c3dd4d2bfa1e53e1c'])
>>> def word_exists(word):
...     return hashlib.sha256(word).hexdigest() in db
...
>>> word_exists(""hello"")
False
>>> word_exists(""hidden"")
True
"
30134,What's a good way to filter data based on values that match the right of the decimal place?,"id - cast(id as int)
"
20187,How do I need to change my sql to get what I want in this case?,"select * from (
    select t2.id2, t1.date, t2.data, 
        row_number() over (partition by t2.data order by t1.date desc) rn
    from table1 t1
    join table2 t2 on t1.id = t2.id2
) t where rn = 1
"
36898,Grouped LIMIT in PostgreSQL: show the first N rows for each group?,"SELECT
  * 
FROM (
  SELECT
    ROW_NUMBER() OVER (PARTITION BY session_id ORDER BY name) AS r,
    t.*
  FROM
    xxx t) x
WHERE
  x.r <= 2;
"
11363,How to take data from rows and put it into single field?,"select paperid, string_agg(name, ' ') as authors 
FROM newpaperauthor 
GROUP BY paperid 
ORDER BY paperid;
"
35016,How to calculate aggregate property of has_many relation in SQL?,"SELECT
  person.name,
  case when 't' = ANY (SELECT items.stolen 
                       FROM items 
                       WHERE items.person_id = person.id) then TRUE else FALSE end as owns_stolen_items
FROM
  persons
"
14649,"If this month has 28 days, find all customers with a bill date of 29, 30, or 31","SELECT customer_name
  FROM customer_billing
 WHERE   LEAST(bill_day, EXTRACT(DAY FROM LAST_DAY(SYSDATE)))
       = EXTRACT(DAY FROM SYSDATE);
"
3262,database design to store user comments and their ratings,"table comments:
#Comment_id(int)(pk)
*Users_id(int)(fk)
*Comment_content (varchar(500))
*Comment_rating(int)
*Comment_date(date)

table replies:
#Reply_id(int)(pk)
*Comment_id(int)(fk)
*Users_id(int)(fk)
*Reply_rating(int)
*Reply_content(varchar(500))

pk-> primary key
fk-> foreign key
#-> unique identifier
*->mandatory
"
35172,How to update a column value in one database table using another database table as a reference with SQL,"update  c
set     countryId = lc.Id
from    SQLVersion.dbo.Contact c
join    AccessDBVersion.dbo.tblContact ac
on      ac.Name = c.Name
join    SQLVersion.dbo.Country lc
on      lc.Name = ac.Country
"
38653,SQL Query make columns results into rows,"select c01 from table
union all
select c02 from table
union all
select c03 from table
union all
select c04 from table
"
33771,PostgreSQL Extracting DOW and Changing timezone,"select created_at at time zone 'PST'
from zendesk_tickets;
"
32363,Is there a quick way to re-format all values in a ColdFusion query column?,"SELECT VARCHAR_FORMAT(TIMESTAMP_FORMAT(CAST(20121119 AS CHAR(8)), 'YYYYMMDD'), 'MM/DD/YYYY')
FROM SYSIBM.SYSDUMMY1
"
3787,Obtain average no-NULL fields in query,"select
   100.0 * 
   (
      COUNT(name) + COUNT(surname) + COUNT(email)
   )
   /
   (
       3 * COUNT(*)
   )
from
   table where id = 1
"
6068,PL SQL - Resembling (!a?0:a) functionality,"SELECT NVL(SUM(some_field),0)
  from some_table table_1 
 where table_1.TYPE =1                                                 
   AND TO_CHAR(table_1.date,'YYYYMMDD') = '20090905'
   AND table_1.f2 = 962
   AND table_1.f3 = 41813;
"
10307,Is there a way to create a primary key and have it cascade into other tables without re-entering data into the new tables?,"DELIMITER $$
CREATE TRIGGER init_cross AFTER INSERT ON item
  FOR EACH ROW
  BEGIN
    INSERT INTO `cross`(item,equip) VALUES( NEW.item, NEW.equip );
  END;
$$
DELIMITER ;
"
5192,How to find the query sent through ODAC to Oracle Database when using Entity Framework (EF),"cshay Dec 3, 2011 9:58 AM (in response to 900653)
You can turn on ODP.NET tracing. See the ODP.NET doc for more details:

1) Close VS
2) In windows registry, change registry value 
    \\HKEY_LOCAL_MACHINE\SOFTWARE\ORACLE\ODP.NET\4..........\TraceLevel
    to 1
3) Relaunch VS
4) Reproduce the problem
5) Close VS2010
6) Look for the odpnet trace file in the root of C I believe.
7) Undo the registry value (set it back to 0) so you don't impact performance
"
39182,SQL: how do I speed up this query,"...
where store_num is not null
and table_oid = 1234;
"
24508,SaaS architecture PHP login form,"$database = $_SESSION['username'];
$mysqli = new mysqli(""localhost"", ""db_user"", ""db_pass"", $database);
"
17986,mysql query that has IF condition to replace values,"SELECT Home, 
       Home_Score, 
       Away, 
       coalesce(Away_Score, '') as Away_Score 
FROM `NFL_Games` 
"
25287,Getting a count of each distinct row in SQL Server ,"SELECT Name, COUNT(Name) AS DistinctCount
FROM tableName
GROUP BY Name
"
35002,Roulette Wheel selection with a SQL query,"Filter, A  ,   B,   C
  1   , 1/3, 1/3, 1/3
  2   , 0  , 1/2, 1/2
  3   , 0  , 0  , 1
"
20282,CASE WHEN - What am I doing wrong?,"AND lp.lease_current_stop_date BETWEEN getdate() AND dateadd(MONTH, @lease_expiry_period, getdate())
"
9196,COPY data from column to another column on the same table,"UPDATE table SET columnB = columnA
"
32295,T-SQL: can I use a variable as a database reference,"EXECUTE sp_executesql 
          N'SELECT * FROM AdventureWorks2008R2.HumanResources.Employee 
          WHERE BusinessEntityID = @level',
          N'@level tinyint',
          @level = 109;
"
7311,SQL join get results that have no join aswell,"SELECT 
    *,
    (
       SELECT COUNT(project.project_id) from project
       WHERE
       project.customer_id = customer.customer_id
    ) AS totalProjects 
FROM
    customer
ORDER BY customer.date_created DESC
"
10684,Get count of items and their values in one column,"select 
   Items.itemId,
   count(MyTbl.itemId) as count
from Items
   left join MyTbl on (MyTbl.ItemID = Items.ItemID)
group by Items.itemId
order by Items.itemId
"
22448,Using aggregate functions without including them in SELECT,"Select ClassId 
From Students
Join 
    ( Select Classes.Grade, Min(StudentId) as StudentId
        From Classes 
        Join Students ON Classes.ClassID = Students.ClassID
        Where Classes.Grade  in (1, 3, 5)
        Group By Classes.Grade 
        ) LowestStudentIdPerGrade
    On Students.StudentId = LowestStudentIdPerGrade.StudentId
"
32517,VB.NET and MySQL query,"select tf.displayname from table_users tu
join table_friends tf on tu.id = tf.friend_id
and tu.email = '"" & EmailAddress & ""';
"
11018,creating columns based on column values,"SELECT
    monthly_course_capacities.month,
    max(case when course_capacities.course_kind ='math' then capacity end ) as math,
    max(case when course_capacities.course_kind ='english' then capacity end ) as english,
FROM course_capacities
INNER JOIN monthly_course_capacities ON course_capacities.id = monthly_course_capacities.course_capacity_id
GROUP BY monthly_course_capacities.month
"
18451,How to SET CONVERT date and time formats with MS SQL,"[Date Order Finished] = 
      CONVERT (VARCHAR(16), GETDATE(),111) +' '+ CONVERT (VARCHAR(16), GETDATE(),108)
"
31551,SQL to retrieve only if there is no FK reference,"SELECT 
m.match_id
FROM match m
WHERE 
m.match_id NOT IN
(
    SELECT
    ml.match_id 
    FROM message_log ml
)
"
10045,Combining IF with AVG in mySQL,"SELECT AVG(IF(CAST(value AS SIGNED) < 550, 100, value)) AS output...
"
23765,Return records even if they don't exist in the joined tables,"select g.GroupID,
       g.GroupTitle,
       m.MemberID,
       m.MemberName,
       case when mg.MembersGroupID is null then 'No' else 'Yes' end as IsPartOfGroup
from GROUPS g
cross join MEMBERS m
left join MEMBER_GROUPS mg on g.GroupID = mg.GroupID and m.MemberID = mg.MemberID
"
8985,looping for every row in a table in t-sql,"UPDATE WorkOrder 
SET name2=name1+' '+name2
"
13953,Is there an alternative to TOP in MySQL?,"SELECT field1, field2
FROM myTable
ORDER BY field1 ASC
LIMIT 10
"
34310,SQL Statements Display More Rows Than Table Has,"SELECT  t1.*
FROM    table1 t1
CROSS JOIN
        table2 t2
"
18812,How should this query be writen?,"SELECT ap.AuthorId,
       SUBSTRING_INDEX(GROUP_CONCAT(ap.ID ORDER BY ap.PublishedDate DESC
                                   ), ',', 3) AS latest_articles
FROM ArticlePage ap
GROUP BY ap.AuthorId
ORDER BY MAX(ap.PublishedDate) DESC
LIMIT 2;
"
29650,Trying to move the decimal place in an output,"SELECT ROUND(0.1428571428571428571428571428571428571429 * 10, 1)
"
22702,Substract 1 month to update table SQL Server,"UPDATE invoices SET invoices.issuedat = dateadd(MM,-1,paidat)
"
2827,How do I Query an Adjacency relation (in SQL) to get a Leaf by providing a Path?,"WITH CategoriesWithPath (id, parentid, name, path) AS
(
    SELECT  c.*, cast(c.name AS VARCHAR(1024)) AS ""path""
    FROM    @Categories c
    WHERE   parentid is null
    UNION ALL
    SELECT  c.*, cast(p.""path"" + '/' + c.name AS VARCHAR(1024)) AS ""path""
    FROM    @Categories c
    INNER JOIN CategoriesWithPath p ON c.parentid = p.id
)
SELECT  id, parentid, name 
FROM    CategoriesWithPath
WHERE   ""path"" = 'a/b/c/d'
"
15355,sql server: passing the parameter to the view,"CREATE FUNCTION [dbo].[TblFunc_AAA]
(
@ID BIGINT
)
RETURNS TABLE
AS
RETURN
(
SELECT *
FROM MyTable 
where aaa = @ID
)
"
30253,Is there any way to combine IN with LIKE in an SQL statement?,"select p.*
from
  (select code_wildcard
   from second
   where id = 1) s
  join parent p
      on p.office_code like s.code_wildcard
"
10493,"Laravel 5.1, Eloquent, ManyToMany with comment","return $this->belongsToMany('App\Role')->withPivot('column1', 'column2');
"
14379,aggregate function help in sql?,"Select policy_number, sum(amount) as amount
from table_name
group by policy_number
order by 1
"
25520,NHibernate sorting (SQL as a second option)," IN SQL ORDER BY will be

  ORDER by case UrgencyId when 4 then 4 else 0 end, CreateDate desc
"
16056,Updating timestamp column with new value - value of existing column in oracle,"update test 
   set col1 = TO_TIMESTAMP('""+newDate+"" 00.00.00.000000000','DD-MM-YYYY HH24: MI:SS:FF') - col2
 where objid IN (1,2);
"
27242,MySql Doing two counts with two different wheres from the same table,"SELECT * FROM 
  (SELECT COUNT(id) AS count_one FROM table WHERE id = 1) a,
  (SELECT COUNT(id) AS count_two FROM table WHERE id = 2) b
"
33926,Always select a row sql,"SELECT ISNULL((
    SELECT 
        CASE 
            WHEN COUNT(*) > 10 THEN 1
            ELSE 0
        END
    FROM 
    fldt_QueryDSLAM lastDay
    WHERE AccountID = @acc
        AND lastDay.DSL = @dsl
    GROUP BY lastDay.DSL
), -99 /*no match*/)
"
39285,MySql retrieve products and prices,"SElECT p.*, q2.*
  FROM 
(
  SElECT Product_id
    FROM Price
   WHERE `start` >= '2013-05-01' AND `end` <= '2013-05-15'
   GROUP BY Product_id
  LIMIT 0,10
) q1 JOIN 
(
    SELECT *
      FROM Price
     WHERE `start` >= '2013-05-01' AND `end` <= '2013-05-15'
) q2 ON q1.Product_id = q2.Product_id JOIN product p
     ON q1.Product_id = p.Id
"
3353,"If count(values) > 1, combine all values into a single cell",";With Cte(city,concat) as
(
    select city, (select a.Zoo+','
    from Sample a
    where a.city=b.city
    for XML PATH ('') )  concat
    from Sample b
    group by city
 )
Select city,left(concat, len(concat) -1) from cte
"
7476,fetching last 3 rows in ascending order with t-sql?,"With CTE as
( select row_number() over ( partition by CommentID order by OrderID desc) as rownum,
         CommentID,
         Name,
         Replies,
         OrderID
  From reptab
 ) 
 select  CommentID,
         Name,
         Replies,
         OrderID
 from CTE 
 where rownum <=3
 and CommentID = 313
 order by OrderID asc
"
11518,How to format the XML results from an SQL query,"SELECT 
    p.*, 
    s.sCol1 as 's/sCol1', 
    o.oCol1 as 'o/oCol1'
FROM p 
     LEFT OUTER JOIN s on s.UID = p.UID
     LEFT OUTER JOIN o on o.UID = p.UID
FOR XML PATH
"
12820,How to generate array from multiple mysql rows with a common value,"SELECT `group_id`, group_concat(`element_value`) as value, date FROM `table_name` group by `form_id`
"
10651,"How to replace part of string in a column, in oracle","UPDATE Mytable t
   SET column = REPLACE(t.U_MSG, ', CALL HELPDESK', ' CALL HELPDESK')
"
31352,Auth::attempt changing default password to default field like in DB,"public function getAuthPassword()
{
     return $this->attributes['passwordFieldinYourTable'];//change the 'passwordFieldinYourTable' with the name of your field in the table
}
"
26177,Converting two string fields into datetime,"SELECT
DateSerial(Val(Mid(EventD,7,4)), Val(Mid(EventD,4,2)), Val(Mid(EventD,1,2))) + TimeSerail(Val(Mid(EventT,1,2)), Val(Mid(EventT,4,2)), Val(Mid(EventT,7,2))) As DateTimeValue
FROM Table1
"
21450,more efficient way of using sql OR?,"SELECT * FROM tableA WHERE colour in ('red','greed','yellow');
"
25208,SQL: Why am i suddenly getting 2 million more rows from this statement?,"SELECT A.a, B.b, C.d
FROM A
JOIN B on A.c = B.c
JOIN C on A.c = C.c
"
20557,How to select a list of 100 next sequence values from a database,"SELECT  l
FROM    generate_series(1, $n) l
"
23964,SQL for calculated column that chooses from value in own row,"select c.*,
       coalesce([DL-No], [SS-No], [State-ID-No]) as calculated
from citizens c
"
22632,BASIC SQL How To Select Greater than 100000 and less than 200000,"SELECT id FROM Item WHERE Price >=100000 AND Price <=200000;
"
38879,INNER JOIN Using IF logic,"SELECT * FROM Table1  
INNER JOIN Table2 
ON Table1.Team = Table2.Team AND Table1.Color = Table2.Color
"
35050,for f/ tokens in sql,"  SUBSTRING(pkey, 1, CHARINDEX('-', pkey, 1) - 1)
"
18419,How to query multiple rows involving a MAX?,"SELECT A, B, (SELECT MAX(B) FROM TABLE) AS MaxB
FROM TABLE
"
11463,PL/pgSQL: finding all groups person belongs to (also indirectly),"WITH RECURSIVE group_ancestry AS (
SELECT group_id, username
FROM group_members
UNION
SELECT groups_inheritance.parent_group_id, username
FROM group_ancestry
     JOIN groups_inheritance ON groups_inheritance.group_id = group_ancestry.group_id
)
SELECT username, group_id
FROM group_ancestry
"
13907,Retrieve values from configuration table in query where clause,"SELECT *
FROM product
WHERE TRIM(product.types) in (select TRIM(product_nr) from configuration_table)
"
406,How to execute select row(*) in postgres,"select row(s.*)
from some_table s
"
3344,Insert data from to a table,"INSERT INTO CommentTable (Date, Site, Comments, Total)
SELECT '2010-04-01 00:00:00.000', Site, 0, 0
FROM SiteTable
WHERE Site NOT IN
    (SELECT DISTINCT Site FROM CommmentTable
     WHERE [Date] = DATEADD(mm, DATEDIFF(mm, 0, GetDate()) -1,0))
"
19241,Recreate table with data and relations,"ALTER TABLE <your child table> DROP CONSTRAINT <your constraint>;
"
9502,SQL: How to get the original sorting when joining two tables,"order by Table1.Name, Table2.Money
"
16809,Inserting Record in oracle forms,"Go_Block('Block_B1');
Last_Record;
L_num_records := :system.cursor_record;
FOR i in 1..L_num_records
LOOP    
     Go_Block('Block_B1');
     Go_Record(i);
     --update the fields in the row
     :Block_B1.item1 := 'Set your value';
     :Block_B1.item2 := 'Set your value';
     ...
     ...
     Next_Record;
END LOOP;
First_Record;
"
26609,Select record based on status if it exists,"SELECT a.id, a.shipmentNo, a.status, a.date 
FROM (SELECT a.id, a.shipmentNo, a.status, a.date 
      FROM shipment a ORDER BY a.shipmentNo, FIELD(a.status, 'S', 'I')
      WHERE a.date = '2013-12-12'
      ) A
GROUP BY a.shipmentNo
"
33910,How to insert result of stored procedure into a table with extra nullable columns,"INSERT #Table (Column1, Column2, Column3)
EXEC SP1;
"
34829,Combining results before grouping in SQL,"SELECT 
  [Gender] = CASE [Title] WHEN 'Mr' THEN 'M' ELSE 'F' END, 
  COUNT(*) as Count
FROM
   Customers c
GROUP BY 
  CASE [Title] WHEN 'Mr' THEN 'M' ELSE 'F' END
ORDER By 
  [Count] DESC
"
30086,SQL SELECT MIN(time) where time is a string,"SELECT max(time) from t;

SELECT min(time) from t;
"
4483,Group Between Keywords TSQL,"select
    f3.FruitName, f3.FruitCost, f.FruitName
from
    @Fruit f
        inner join
    (
        SELECT  *,
        (Select max(productid) from @Fruit f2 where FruitCost is null and ProductID<=f.ProductID) as fgroup
        FROM    @Fruit f
    ) f3
        on f.ProductID = f3.fgroup
where f3.FruitCost is not null  
"
31786,Return parent ID in a nested table in sql,"    $id = 5;$parent_id = 5; /* set default to values you want*/

    while($parent_id != 0)
    {

       $sql = 'SELECT id,parent_id from sub_table where id = $parent_id ';
       $rs= $mysqli->query($sql);  /* fetch details */
       $old_id = $id; /* this will save the last id in current iteration */
       $parent_id = $rs['parent_id'];
       $id = $rs['id'];

    }
"
25425,SQL Pricing Tiers,"select t.*,
       (select p.price 
        from pricing p
        where p.product = t.product and p.quantity >= t.quantity
        order by p.quantity
        limit 1
       ) as price
from transaction t;
"
39231,MySQL - two dependent weighted averages in a single query,"SELECT sum(hours_transit * load_transit) / sum(hours_transit),
       sum(hours_standby * load_standby) / sum(hours_standby),
       (sum(hours_transit * load_transit + hours_standby * load_standby)) / sum(hours_transit + hours_standby)
FROM table1
"
9777,Group By the position of the fieldname(column) in SQL Server,"SELECT Table_A.Po_no, Table_A.rmcode, SUM(Table_A.weight) as recvqty,
    LTRIM(RTRIM(Table_A.po_no)) + LTRIM(RTRIM(MBStran.rmcode)) as po_noRM
FROM Table_A
GROUP BY Table_A.Po_no, Table_A.rmcode, LTRIM(RTRIM(Table_A.po_no)) + LTRIM(RTRIM(MBStran.rmcode))
ORDER BY Table_A.Po_no
"
21301,SQL script to create insert script,"Select COALESCE(Name, '') from...
"
10545,SSRS/T-SQL sum if another condition is met,"SELECT TransactionId
    , Value
    , SUM(Value) OVER(PARTITION BY TransactionId) AS Total
FROM SomeTable
"
39460,Problem making 1 big query from lots of small ones,"select something
from topic
left join friendship on friendship.user_id = topic.user_id && friendship.friend_id == watch_id
left join access on access.topic_id = topic.id && access.user_id == watch_id
where
  watch_id == topic.user_id or
  topic.visibility == 3 or
  (topic.visiblity == 2 and friendship.user_id is not null) or
  (visibility == 1 && access.topic_id is not null)
"
32560,Copy one column from one database to another,"UPDATE table1 t1 
JOIN database1.table1 as t2 ON
   t1.id = t2.id
SET
   t1.columnA = t2.columnA
"
27933,How to check column value null or having value,"SELECT ProductName,UnitPrice*(UnitsInStock+IFNULL(UnitsOnOrder,0))
FROM Products
"
29352,mysql counting duplicates - grouping by two columns,"select item, count(userid) as multi_clickers
from
  (select item, userid, count(userid) as total_clicks_for_user
   from clicks 
   group by item, userid
   having total_clicks_for_user > 1) a
group by item
"
15080,SQL Query to Add Values from Column X for Every Entry That Has Y,"SELECT x, SUM(z) total_z
FROM table
WHERE y = 123
GROUP BY x
"
6268,Modelling database for a small soccer league,"select o1.team_id team_id_1,
       o2.team_id team_id_2,
       o1.score score_1,
       o2.score score_2,
       o1.match_id match_id
from outcome o1
inner join outcome o2 on o1.match_id = o2.match_id and o1.team_id < o2.team_id
"
19648,LEFT JOIN FIlter,"select *
from (
  select a.*, 
         b.*
         count(*) over (partition by a.MyCol) as cnt
  from Table_A a
     left join Table_B b ON a.MyCol = b.MyCol 
  where ... -- Conditions
) t
where cnt > 1
"
30787,"How can I explore the data in a SQL database, including foreign tables?"," select * from finaltable where ID in 
    (select id2 for table2 where anotheridcolumn in 
    (select id3 from yetanothertable where yet anotheridcolumn in (input_id_you're_looking_for)
"
7333,Linq to SQL Case WHEN in VB.NET?,"var data = from d in db.tb select new {

 CaseResult = (

 d.Col1 == “Case1” ? ""Case 1 Rised"" :

 d.Col1 == “Case2” ? ""Case 2 Rised"" :

 ""Unknown Case"")

 };
"
4797,Return only first row with particular value in a column,"select id, qid
  from
(
  select id, qID, ROW_NUMBER() over(partition by qID order by qID) as zxy
    from t1 
) q  
 where zxy = 1
"
4646,Sybase use parameter as where clause,"declare @where_clause varchar(100)
declare @sql_statement varchar(500)
select @where_clause = 'date in (''2011-01-01'',''2012-01-01'',''2012-05-24'') AND doc = ''1'''
select @sql_statement = 'select * from my_table where ' + @where_clause
exec (@sql_statement)
"
28810,Oracle arrangements,"SELECT COUNT(1) FROM (SELECT t1.name as name1, t2.name as name2 
FROM Locations t1, Locations t2
WHERE t1.name <> t2.name)
"
29222,List ALL or specified value - SSRS Parameter,"select ...
from mytable
where @param = col or @param = 'all';
"
36235,Select last ten items from a specific row in a table,"SELECT TOP 10 Line_ID, Run_Date, Product_ID, Pallet_Cd, Run_Qty
FROM YourTable
WHERE Pallet_Cd >= '00801004718000000007'
ORDER BY Pallet_Cd
"
15168,SQL Match City Name Inside Full Address?," select Cust_id from customers 
 where address NOT LIKE '% London%';
"
4855,How do a MySQL REPLACE INTO command in SQL Server?,"UPDATE products
  SET date = new_value_1,
      hour = new_value_2,
      ...
      ...
WHERE (where_clause)
"
27350,How can sum values from the previous month?,"SET @month := 09;
SET @year := 2014;

SELECT sum(amount)FROM tester 
WHERE month(date_amount)= @month-1 AND day(date_amount) = day(last_day(date_amount))
"
18317,Difference between the AND statement in an Inner Join or in a WHERE clause,"SELECT * FROM Table1 t1 INNER JOIN Table2 t2 WHERE t1.id = t2.id AND t2.id = 0

SELECT * FROM Table1 t1, Table2 t2 WHERE t1.id = t2.id AND t2.id = 0
"
7700,Teradata group by time interval,"SELECT HOUR(timecolumn) AS h, MINUTE(timecolumn)-(MINUTE(timecolumn) MOD 5) AS m, COUNT(*)
FROM table
WHERE column=something
GROUP BY h, m
"
1667,Distinct returning duplicates with multiple columns,"SELECT NAME, MIN(DISTANCE) FROM
(
SELECT NAME, 
((19.171150  - COORDINATES.LAT) * (19.171184 - COORDINATES.LAT) + 
 (-96.173990 - COORDINATES.LON) * (-96.173990 - COORDINATES.LON)) AS DISTANCE  
FROM COORDINATES
INNER JOIN INFORMATION
ON COORDINATES.INFORMATION_ID=INFORMATION.ID 
WHERE DISTANCE < 0.000023544
) 
GROUP BY NAME
"
19108,MS Access SQL statement,"SELECT Mastery.masteryID, Mastery.stuID, Mastery.score, Mastery.skillID, Skills.asstID
FROM Mastery 
    INNER JOIN Skills 
        ON Mastery.skillID = Skills.skillID;
"
14094,Firebird Trigger Deadlock,".IsolationLevel = IsolationLevel.ReadUncommitted;
"
32317,How to you WEIGHT returned values by a Group By value,"SELECT SUM(CategoryScore * PercentOfTotal) as RawScore
  FROM ( .....subquery here..... )
"
24043,Django South: Creating schemamigration for more than one app,"APPS_TO_WATCH = ['myapp','myotherapp','toomanyapps']
def migration():
    for app in APPS_TO_WATCH:
        local('python manage.py schemamigration %s --auto' % app)
"
34980,Subquery necessary for comparison?,"SELECT channels.* 
FROM channels
LEFT JOIN items_channels
  ON channels.id = items_channels.channel
LEFT JOIN items
  ON items_channels.item = items.id AND items.active = 1
WHERE channels.active = 1
GROUP BY channels.id
HAVING COUNT(items.id) = 0
"
23832,Get rows with single values using SQlite,"SELECT *
FROM mytable
WHERE B IN (SELECT B FROM mytable GROUP BY B HAVING COUNT(DISTINCT A)=1)
"
36667,Dividing 2 numbers in Sql Server,"SUM(sl.LINES_CONFIRMED) * 1.0 / SUM(sl.LINES_ORDERED)
"
37367,Inserting multiple child elements from XML into SQL Server database,"SELECT
    ReserveringNummer = XReservering.value('@reserveringsnummer', 'int'),
    Opties = XOpties.value('(.)', 'varchar(50)')
FROM
    @XML.nodes('/reservering') AS XTbl1(XReservering)
CROSS APPLY
    XReservering.nodes('opties/optie') AS XTbl2(XOpties)
"
3872,Query for returning if more than 3 related rows,"SELECT SALESPERSONID
FROM SALES
GROUP BY SALESPERSONID
HAVING COUNT(*) >= 3
"
28482,SQL: Assigning sequence numbers,"CREATE TEMP TABLE New_Playlist (Seq INTEGER PRIMARY KEY AUTOINCREMENT, TuneID INTEGER);

INSERT INTO New_Playlist (TuneID)
SELECT TuneID FROM Tunes
WHERE ArtistID=2
ORDER BY AlbumID, Track;

INSERT INTO Playlist (TuneID, Name, Seq)
SELECT t.TuneID, t.Name, np.Seq
FROM New_Playlist np JOIN Tunes t ON t.TuneID = np.TuneID;

DROP TABLE New_Playlist;
"
19899,incompatible SQL trigger,"CREATE TRIGGER dfTree_InsertTrigger 
after insert ON dfTree 
for each row
begin
  UPDATE dftree SET   
    depth = (select coalesce(depth + 1, 1) from (select depth from dftree parent where parent.id = new.parentid union all select null depth)),
    lineage = (select coalesce(lineage,'/') || dftree.id || '/' from (select lineage from dftree parent where parent.id = new.parentid union all select null lineage))
  where new.id = id;
end;
"
14489,How to know the alive time for a explicit cursor?,"SQL> show parameter undo_retention

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------
undo_retention                       integer     900
"
29797,Find count occurrences ,"SELECT  SUM(CASE WHEN SUBSTRING(name,1,1) = 'B' Then 1 ELSE 0 END),
        SUM(CASE WHEN SUBSTRING(name,1,1) = 'M' Then 1 ELSE 0 END)
FROM TAbleName
"
24369,Oracle SQL - Group by one column and list results in another,"WITH t(wk, COST) AS
(
SELECT 17,  446 FROM dual
UNION 
SELECT 18,  446 FROM dual
UNION 
SELECT 19,  446 FROM dual
UNION 
SELECT 26,  588 FROM dual
UNION 
SELECT 27,  588 FROM dual
UNION 
SELECT 28,  588 FROM dual
)
SELECT listagg(wk,',') WITHIN GROUP(ORDER BY wk) AS wks, COST 
FROM   t
GROUP BY COST;
"
30958,Creating a table with PSQL as clone of another table but excluding a column,"create table foo like bar;
alter table foo drop column baz;
-- and now full the thing
"
37094,Multiple SUM 's in one statement with IN,"SELECT SUM(LIPQOH) as x, IBLITM 
FROM CPJDDTA81.F4101JD 
WHERE IBLITM IN('123456','1254484')
GROUP BY IBLITM
"
17766,Call User defined function as System Function in SQL server,"select dbo.TIME_TO_SEC('01:00:00') from TimeTable
"
9646,Update entire table based on parameter of another table in a matching field,"UPDATE Geo_location AS g 
JOIN users_data AS u ON u.member_num = g.member_num 
SET g.public = ud.acceptinClients
"
23656,Query data depends on data from other table,"SELECT
    Table1.dataA,
    Table3.dataD
FROM
    Table1
    LEFT OUTER JOIN Table2 ON Table1.dataB = Table2.dataB
    LEFT OUTER JOIN Table3 ON Table2.dataC = Table3.dataC
"
11958,How to change the string using convert in ms sql?,"CONVERT(NVARCHAR, MAX([DateTime]) - MIN(DateTime]), 108) AS [Hours Works]
"
19731,"SQL - Group By a Column, then Sort By the 'count' Results","SELECT COUNT(a.review_id) as total, a.review_id
FROM vote a
INNER JOIN reviews b
ON a.review_id = b.review_id
GROUP BY a.review_id
ORDER BY total ASC
"
26474,How to select the 3 most recent rows using the date field,"SELECT TOP 3 id, first_name, last_name, url, date
FROM tbl_paystubs
ORDER BY date desc
"
3282,Query on last modified time without a last modified column,"SELECT PID 
  FROM PRODUCT 
 WHERE SCN_TO_TIMESTAMP( ORA_ROWSCN ) > '${dih.last_index_time}'
"
950,How to select a random row with a group by clause?,"select object_id, name, image_path
from
  (SELECT images.image_path AS image_path, objects.id AS object_id, objects.name
  FROM objects LEFT JOIN images ON images.object_id = objects.id
  ORDER BY RAND()) as z
group by z.object_id, z.name
"
27914,Mimic table in MySQL (view or stored function),"CREATE VIEW UserParams  (user_id, param, value)
AS SELECT  id,  ""Address""  , address 
FROM New_User
UNION 
SELECT id, ""Phone"", phone
FROM New_User
"
15335,Empty IN sql statement,"SELECT A
FROM B
WHERE C IN (SELECT D FROM E);
"
24022,Oracle : how to order hexadecimal field,"select str
from t
order by to_number(str,'XXXXXXXXXXXX');
"
18092,Trim numbers after decimal in SQL in my equation,"select c.claimnumber, 
       to_char(c.RECEIPTDATE,'mm/dd/yyyy') as receiptdate,
       trunc(sysdate - c.RECEIPTDATE) as daysbetween
from claim c
where c.RECEIPTDATE > sysdate -10 
"
26965,Refining a query by Edge metadata,"SELECT outE('VersionSetToVersion')[status = 'latest'].inV() FROM #14:1
"
37851,"SQL SELECT with GROUP BY, referring back to the group","SELECT  household_id,
        COUNT(uid) AS members, 
        MAX(CASE WHEN head = 1 THEN uid ELSE NULL END) headID
FROM    population 
GROUP   BY household_id;
"
4349,"Android/SQLite - why can't I put ""+"" character in a database column?","SQLiteDatabase db = this.getWritableDatabase();
db.execSQL(""INSERT OR IGNORE INTO version3 (number) VALUES(""'+""+""+phoneNumber+"")'"");
"
18340,SQL Query does not fetch the required data in iphone application,"SELECT * FROM ContentMaster
LEFT JOIN  Category ON ContentMaster.CategoryID=Category.CategoryID
LEFT JOIN Topic ON ContentMaster.TopicID=Topic.TopicID
WHERE (ContentMaster.ContentTagText='%@' OR ContentMaster.ContentTitle='%@')
  AND Category.CategoryName='%@'
  AND Topic.TopicName='%@'
"
7059,SQL outer join which omits common records,"WHERE TableA.id IS null 
OR TableB.id IS null
"
25655,Get Parent Child records sql server 2008,"with cte as (
    select C.CompanyID, 0 as Level
    from COMPANY as C
    where C.CompanyID not in (select T.ChildCompanyID from COMPANYMAPPING as T)

    union all

    select C.ChildCompanyID as CompanyID, A.Level + 1 as Level
    from cte as A
        inner join COMPANYMAPPING as C on C.ParentCompanyID = A.CompanyID
)
select
    C.CompanyID, C.CompanyName, A.Level
from cte as A
    inner join COMPANY as C on C.CompanyID = A.CompanyID
"
2127,copy tables with data to another database in SQL Server 2008,"USE TheOtherDB;

SELECT *
INTO NewTable
FROM TheFirstDB.Schemaname.OldTable
"
35058,Combining data in sql,"select min(Id) as Id,max(job) as Job,max(FNAME) as FNAME,max(LName) as LNAME
from yourtable
"
15278,Oracle composite primary key with CLOB data point,"create table log_table
( message_key VARCHAR2( 2048 ),
  message CLOB,
  id number,
 CONSTRAINT f PRIMARY KEY (message_key, id)
)
"
10674,"how to sort book titles in order without a, an, the using oracle pl sql function","select *
from   books
order by case when Book_title like 'A %'
                   then LTrim( book_title, 'A ' )
              when Book_title like 'An %'
                   then LTrim( book_title, 'An ' )
              when Book_title like 'The %'
                   then LTrim( book_title, 'The ' )
              else Book_title end;
"
21600,SELECT DISTINCT only first four numbers,"SELECT LEFT(code, 4) AS code, ticker FROM tbl ORDER BY code;
"
35206,Defining tablespace for local index in Oracle,"CREATE INDEX
  ""SCHEMA"".""INDEX_NAME""
ON
  ""SCHEMA"".""TABLE_NAME"" (
    ""COLUMN_NAME"")
TABLESPACE
  MY_INDEX_TABLESPACE
LOCAL;
"
11709,"how to add days to a date column from an Integer column, by SQL","CREATE TABLE #test(DateColumn DATETIME, IntColumn INT);
INSERT INTO #test VALUES
 ({ts'2016-01-01 00:00:00'},1)
,({ts'2016-01-10 11:30:00'},-2)
,(GETDATE(),3);

SELECT DateColumn AS A
      ,IntColumn AS B
      ,DATEADD(DAY,IntColumn,DateColumn) AS C
FROM #test;

DROP TABLE #test;
"
12498,INSERT INTO multiple tables from SELECT statement,"insert into GoodsIn (CustomerAccount, CustomerName)
select CustomerAccount, CustomerName
from GoodsInOld 


insert into GoodsInProduct(ItemId, GoodsInId)
select o.ItemId, i.id
from GoodsInOld o
inner join GoodsIn i on o.CustomerAccount = i.CustomerAccount
                     and o.CustomerName = i.CustomerName
"
39175,Match first element of a tilde separated values string,"SELECT REGEXP_SUBSTR('~a,c~d2f~@hi~~~j(l~e~~~~~~~~', '[^~]+')  FROM dual;
"
7676,Select row values that are in repeated rows that have a colum with at least 3 different values,"SELECT Ma,
       COUNT(DISTINCT Mi) AS Num
FROM ATableLikeThis
GROUP BY Ma
HAVING COUNT(DISTINCT Mi) >= 3
"
22160,Sequence / Identity support in python webframeworks,"class Foo(Base):
    id = Column(Integer, Sequence('foo_seq', optional=True), primary_key=True)
    ...
"
30802,How to make a group with multiple column,"SELECT Id, Title, (SELECT TOP 1 Id FROm Table ORDER BY ID) AS [Group]  FROM Table
"
17136,Duplicates Query,"select name
from yourtable
group by name
having count(policy)=1 and max(policy)='SSS'
"
31506,sql INNER JOIN on update query,"Update  lm_Artikel A 
        INNER JOIN  lm_Schwellwert S 
            ON A.Typ = S.Typ  
SET     A.Status = 'NOK'
WHERE   A.Bestand < S.Schwellwert 
"
21765,protect database from accidental update,"BEGIN TRAN

UPDATE Customer SET Customer_ID = 100

SELECT * FROM Customer

ROLLBACK
--If results look OK comment out ROLLBACK and comment in the line below
--COMMIT
"
4977,sqlite return as day of week,"select _id, busnum, 
  case cast (strftime('%w', servdate) as integer)
  when 0 then 'Sunday'
  when 1 then 'Monday'
  when 2 then 'Tuesday'
  when 3 then 'Wednesday'
  when 4 then 'Thursday'
  when 5 then 'Friday'
  else 'Saturday' end as servdayofweek
from tb1
where ...
"
15900,"Count how many records there are for each foreign key, with LIKE clause","SELECT COUNT(DISTINCT l.identifier) AS regCount
FROM list AS l LEFT OUTER JOIN person AS p ON l.identifier = p.list_identifier
WHERE l.Name LIKE '%a%'
"
36496,mySQL circular query,"SELECT * FROM Member
WHERE ID NOT IN (
  SELECT IF(A = '001', B, A) 
  FROM Info WHERE A = '001' OR B = '001'
  UNION
  SELECT '001'
)
"
33156,SQL function to get count of how many times string appears in column?,"(LENGTH(`my_column`) - LENGTH(REPLACE(`my_column`, 'my word', '')))/LENGTH('my word')
"
28694,MySQL Query: add values from db1.table1 to db2.table1,"update db2.table1 new, db1.table1 base, db1.table2 cat
set
new.category=cat.name,
new.value1=base.value1,
new.value2=base.value2
where 
new.name=base.name
and
base.category_id=cat.id
"
33040,How to call update query in procedure of oracle,"CREATE OR REPLACE PROCEDURE my_update_proc (w number, y number, u number) IS
BEGIN
   UPDATE t1
   SET    week = w,
          year = y
   WHERE  userid = u;
   COMMIT;
END my_update_proc;
/
"
20945,Is it possible in sql to group by fields matching some pattern?,"Select 'B*' as Mask, Name
from Table
WHERE Name like 'B%'
UNION ALL
Select '*l*' as Mask, Name
from Table
WHERE Name like '%l%'
UNION ALL
Select 'Mike' as Mask, Name
from Table
WHERE Name like 'Mike'
"
1186,i need to print numbers in pl sql in the given format?,"begin
  for i in 1 .. 10
  loop
    for j in 1 .. i
    loop
      dbms_output.put(to_char(j) || ' ');
    end loop;
    dbms_output.new_line;
  end loop;
end;
"
26214,Right join with no main table needed (mysql),"SELECT t.last_date_chckin, COUNT(DISTINCT t.emp_id) AS CountEmp
FROM (
   SELECT emp_id, MAX(checkin_date) AS last_date_checkin
   FROM empcheckin
   GROUP BY emp_id
) AS t
GROUP BY t.last_date_chckin
"
33468,Issues with Date Format() Function,"DATE_FORMAT(b.fecha, '%m-%d-%Y') as fecha
"
765,Case insensitive search in database with an index?,"CREATE UNIQUE INDEX ix_test1 on articles (lower(url));
"
24131,Why does ISNUMERIC('.') return 1?,"SELECT CAST('.' AS MONEY) 
"
38664,SQL using aggregate functions as filter criterias,"select something, count(*)
from somewhere
group by something
having count(*) > 5
"
39246,OpenShift add cartridge MySQL 5.5 engine InnoDB,"$ rhc env add OPENSHIFT_MYSQL_DEFAULT_STORAGE_ENGINE=InnoDB -a NameApp
$ rhc app-restart NameApp
"
11196,SQL Server Race Condition Question,"begin tran
declare @x int
select @x= nextcode, nextcode += 1 FROM  def
waitfor delay '00:00:15'
select @x
commit tran
"
20630,How to show rows with zero counts in mySQL group by query?,"SELECT COUNT(t.longname) as cnt, l.location 
FROM locations l 
  LEFT JOIN topics t
    ON  t.longname = l.longname
    AND t.tag = 'atag'      
WHERE l.location IN ('Japan', 'France', 'Italy') 
GROUP BY l.location 
ORDER BY FIELD(l.location, 'Japan', 'France', 'Italy')
"
19750,How to create a third table based on two other tables,"create table color
(
id_color int not null,
ds_color varchar(50) null,
primary key (id_color)
)

create table color_tops
(
id_color int not null,
id_colortop int not null,
ds_colortop varchar(50) null,
primary key (id_colortop),
foreign key (id_color) references color(id_color)
)

select color.ds_color,
       color_tops.ds_colortops
from   color
       inner join color on (color.id_color = color_tops.ds_colortops)
"
30710,How can I setup my environment to use h2 for tests and mysql for development?,"@Transactional
@TransactionConfiguration(defaultRollback = true)
"
26351,Show users that were modified at least 2 times,"select u.name
from user u
inner join userchanges c on c.userid = u.id
group by u.name
having count(c.id) > 1
and sum(case when ChangeDate >= '2013-12-15' then 1 else 0 end) > 0
"
36291,Why is nothing selected in this select query?,"SELECT DISTINCT CompanyID FROM  Device WHERE CompanyID IS NOT NULL
"
336,Add 1 to datediff result if time pass 14:30 or 2:30 PM,"SELECT 
    reservations.customerid,
    DateDiff(""d"",reservations.checkin_date, Date()) 
        + Abs(DateDiff(""s"", #14:30#, Time()) > 0)AS Due_nights
FROM 
    reservations
"
36375,How to write this query in SQL with category and date sum,"SELECT
    DATE_FORMAT(DATE, '%Y %b') AS MONTH,
    SUM(AMOUNT) AS TOTAL,
    SUM(IF(CATEGORY='A', AMOUNT, 0)) AS `Category-A`,
    SUM(IF(CATEGORY='B', AMOUNT, 0)) AS `Category-B`,
    SUM(IF(CATEGORY='C', AMOUNT, 0)) AS `Category-C`
FROM your_table
GROUP BY MONTH;
"
29077,How to do a count on a union query,"SELECT COUNT(*)
FROM
(
    select distinct profile_id 
    from userprofile_...

    union all

    select distinct profile_id 
    from productions_...
) x
"
37147,Oracle DB Programmer: How to identify double byte character data in a table?,"UPDATE table_name
   SET first_name = 'NA'
 WHERE length( first_name ) != lengthb( first_name )
"
26357,SAS proc sql concatenation and join like,"LIKE compress(X.ID || '%')
"
36464,How to check whether a user has permission WITH GRANT OPTION?,"select state from sys.database_permissions
where class_desc='DATABASE' and
      permission_name='ALTER ANY USER' and
      grantee_principal_id = DATABASE_PRINCIPAL_ID()
"
36424,SQL join and multiply,"SELECT SERV.PART_NO, SUM(SERV.QUANTITY) AS QUANTITY, SUM(SERV.QUANTITY * PART.COST) AS COST
FROM dbo.SERVICE SERV
INNER JOIN (SELECT PART_NO, MIN(COST) AS COST 
            FROM dbo.PART 
            GROUP BY PART_NO) AS PART
ON PART.PART_NO = SERV.PART_NO
WHERE SERV.CREATED_DT >= '01/01/2012'  AND SERV.CREATED_DT < '02/01/2012'
GROUP BY SERV.PART_NO
ORDER BY QUANTITY DESC
"
28238,Join data from two tables without unique key,"SELECT
  t1.ProductId, t1.year, t1.sales, t2.category
FROM table1 AS t1
INNER JOIN table2 AS t2 ON t1.productId = t2.productId;
"
37072,How do I recreate a VIEW as a local table in SQL Server?,"SELECT * INTO NewTableName FROM LinkedServer.DBName.SchemaName.View
"
17118,Table update based on match/nomatch,"MERGE INTO driver_table
USING other_table
ON
(
    driver_table.column1 = other_table.column1
AND driver_table.column2 = other_table.column2
AND ...
)
WHEN MATCHED THEN UPDATE
    SET
        driver_table.some_column = other_table.some_value,
        driver_table.some_flag = 'Y',
        ...
;
"
17117,How to write a SQL Server procedure to execute more than one query?,"create procedure dbo.usp_3Queries
(
    @Variable1 int,
    @Variable2 int,
    @Variable3 int
)
as
begin
    update dbo.Table1 set Column1 = @Variable1 where Column2 = @Variable2

    update dbo.Table3 set Column3 = @Variable3 where Column2 = @Variable2

    update dbo.Table4 set Column3 = @Variable3 where Column2 = @Variable2
end
"
17067,Oracle Query Optimization,"select distinct
       a.id,
       first_value(t.type_id)
       over (partition by a.id order by t.create_date desc)
       as max_create_date_type_id,
       first_value(a.assign_id)
       over (partition by a.id order by t.create_date desc)
       as assign_id
from assignment a, type t
where a.type_id = t.type_id
"
11918,Can I Assign a variable in a SQL Stored Procedure?,"DECLARE @PersonID INT

INSERT INTO dbo.Person (Name, Address)
VALUES (@Name, @Address)

SET @PersonID = SCOPE_IDENTITY()

INSERT INTO dbo.Product_Data (PersonID, Product, Quantity, DueDate)
VALUES (@PersonID, @Product, @Quantity, @DueDate)
"
11422,Slow MySQL SELECT on large table,"SELECT buy_price, sell_price, created_at
FROM price_archive
WHERE item_id = X;
"
6416,taking max element(s),"Select X,Y from table where Y=(Select max(y) from table)
"
18991,SQL query across multiple tables,"select t.* from title t
inner join artist ar on ar.artist_id = t.artist_id
inner join album al on al.album_id = t.album_id
where (t.desc like '%direction%' or ar.desc like '%direction%' or al.desc like '%direction%')
"
24732,SQL select statement with a quotename removing the last character on the last row,"SELECT QUOTENAME(field1,'''')+
   case when row_number() over(order by (select 1))= 
   count(*) over () then '' else ',' end AS [1]
FROM <table>
"
18964,Conditional column choosing sql server stored procedure,"SELECT CASE
         WHEN @ParameterID = 33 THEN (SELECT 33Value
                                      FROM   [Values Table])
         WHEN @ParameterID = 34 THEN (SELECT 34Value
                                      FROM   [Values Table])
         ELSE (SELECT 35Value
               FROM   [Values Table])
       END 
"
22331,"Joining, CASE and operations","SELECT 
case
when (TableA.Col1-TableA.Col2-TableA.Col3)-(TableB.Col1*TableB.Col2)<(TableB.Col1*0.1‌​0) 
then TableA.Col4-30 
else TableA.Col4 
end
FROM TableA 
JOIN TableB ON TableA.pk=TableB.pk
"
32576,Braces inside the array - postgresql,"INSERT INTO ""temp"" VALUES (1, '{""1{c}1"",a}'); 
"
34586,How do I get the highest sum per day for last X days?,"WITH ranked AS
(
  SELECT ROW_NUMBER() OVER (ORDER BY SUM(Amount), Date, User) as 'rank', SUM(Amount) AS Amount, User, Date FROM MyTable GROUP BY Date, User
)
SELECT Date, User, Amount
FROM ranked
WHERE rank IN ( select MAX(rank) from ranked group by Date)
ORDER BY Date DESC
"
2273,How do I get the name of a user from its ID (SQL Joins),"SELECT u.FirstName, u.LastName,
m.FirstName AS RegManagerFirstName, m.LastName AS RegManagerLastName, r.RegionDesc AS [Desc],
SUM(ut.Sales) AS Sales, SUM(ut.Hours) AS Hours
FROM dbo.[UserTime] AS ut
INNER JOIN dbo.[User] AS u ON ut.UserRowid = u.UserRowId
INNER JOIN dbo.[Region] AS r ON u.RegionRowId = r.RegionRowId
INNER JOIN dbo.[User] AS m ON r.UserRowid = m.UserRowId
WHERE u.Active = 1
GROUP BY u.FirstName, u.LastName, m.FirstName, m.LastName, r.RegionDesc
"
6038,Using values from one table to be column names in a view,"SELECT 
  dept.id as dept_id
  dept.name as dept_name
  , group_concat(cat.CategoryName) as cat_names
FROM table1 as dept
INNER JOIN table2 as cat ON (dept.category = cat.category_id)
GROUP BY dept.id
"
26308,SQL: How to order a union alphabetically?,"select name 
from Reviewer
union
select model
from Car
order by name;
"
12444,Sort table by difference of datetimes of rows with same name,"SELECT username,HOUR(TIMEDIFF(MAX(AccessTime),MIN(AccessTime))) timedifference FROM table
GROUP BY username ORDER BY timedifference
"
20073,Create a new Oracle Application Express (APEX),"update mt_table set username = nvl(v('APP_USER'), user);
"
35628,Avoid SQL Cursor in this scenario,"SELECT FirstName
  FROM Attendees
  join Boys on id = SourceTableId
 WHERE SourceTable = 'Boys'
union all
SELECT FirstName
  FROM Attendees
  join Girls on id = SourceTableId
 WHERE SourceTable = 'Girls'
"
35246,Insert 4 equal values with 1 being distinct,"DELIMITER $$
DROP PROCEDURE IF EXISTS LoopProc$$
CREATE PROCEDURE LoopProc()
  BEGIN
    DECLARE x  INT;
    SET x = 1;
    WHILE x  <= 100 DO
      INSERT INTO table (col1, col2) VALUES ('John', x);
      SET  x = x + 1;
    END WHILE;
    SET  x = x + 1;
    INSERT INTO table (col1, col2) VALUES ('Sam', x);
  END$$
DELIMITER ;
"
20969,force number of rows to return in date range from SQL query," SELECT dates.TheDate, count(recordID) 
 FROM 
 ( select 
      convert(date,dateadd(d,number,'2013-08-12')) as theDate 
   from master..spt_values 
   where type='p' and number < 9
 ) dates
 left join yourtable on dates.thedate = convert(date,yourtable.thedate)
 GROUP BY dates.TheDate 
"
3618,filter search a database set VB,"Angle_MatDataGridView.DataSource = Me.Raw_Material_DatabaseDataSet1.Angle_Mat.Select(""cattext like'"" & CatSearch1.Text & ""' OR cattext like'"" & CatSearch2.Text & ""'"")
"
19979,Update column from inner join,"UPDATE i
    SET ImageUrl = p.guid
    FROM Item i JOIN
         posts p
         ON i.old_id = p.parent_post
    WHERE p.PostType = 'image';
"
11297,Select only rows that have unique fields,"  SELECT Col1, Col2, Col3, Col4 FROM MyTable WHERE
  Col1 NOT IN (Col2,Col3,Col4) AND
  Col2 NOT IN (Col3,Col4) AND
  Col3 <> Col4
"
15373,Difference between dates when grouping in SQL,"select distinct user_id 
from MyTable t1
inner join MyTable t2 on t1.user_id = t2.user_id 
where t1.date_of_purchase - t2.date_of_purchase <= 365
"
32371,CASE IN statement with multiple values,"SELECT CASE
         WHEN c.Number IN ( '1121231', '31242323' ) THEN 1
         WHEN c.Number IN ( '234523', '2342423' ) THEN 2
       END AS Test
FROM   tblClient c  
"
32688,Rotate one row with column names,"SELECT ColNames,Data 
FROM   YourTable 
       CROSS APPLY ( VALUES ('a', a), 
                            ('b', b), 
                            ('c', c), 
                            ('d', d)) V(ColNames, Data) 
"
34092,Firebird SQL optimization,"SELECT
    s.event_id as ""id"",
    s.event_start as ""start"",
    p.treatment_id as ""treatment_id"",
    s.status_id as ""status_id""
FROM
    PATIENT_HAS_EVENT p 
    JOIN SCHEDULEREVENT s ON p.event_id = s.event_id
WHERE
    p.patient_id = 50
"
2393,SQL Group sort by date,"select T1.* from table t1 LEFT JOIN table t2 
ON t1.type = t2.type and t1.created < t2.created
where t2.id is null
"
24609,Hibernate inner join and group by difficulty,"SELECT a.*
FROM   Article AS a
JOIN  (
    SELECT article_id
    FROM   Comment
    GROUP  BY article_id
    ORDER  BY count(*) DESC
    LIMIT  10
    ) AS c ON c.article_id = a.id;
"
15129,"Optimize SQL query, TSQL","CREATE NONCLUSTERED INDEX [ix_History_XXXXX] ON [History] 
(
    [INNO] ASC,
    [Locked] ASC,
    [PDate] ASC,
    [PMode] ASC
)
INCLUDE ( PStatus, PAmount, Fee)
"
18997,How to select multiple results for a single row - MySQL,"   SELECT g.id, g.name, g.desc, GROUP_CONCAT(P.name) AS platforms
    from game g
    JOIN game_platform gp ON gp.game_id = g.id
    JOIN platform P ON gp.platform_id = p.id
    GROUP BY g.id, g.name, g.desc
"
17659,MySQL select comments for friends then other comments while chronological order,"SELECT
    posting.id,
    IF(a.friend_id = b.criteria, 1, 0) AS is_friend
...
ORDER BY is_friend DESC, posting.id DESC
"
26302,"Getting the max(price) for each item ordered, given multiple different prices for any ordered item","select item, max(price) from items_ordered group by item;
"
35944,prevent calling function twice in an IF statement,"SELECT
  CASE WHEN (@check:=CheckTest(node.id, 1)) = 0 THEN NULL ELSE @check END as val
"
37983,Getting multiple counts across joined tables,"   SELECT b.id,
          COUNT(i.id) AS num_inspections,
          COUNT(v.id) AS num_violations
     FROM BUSINESS b
LEFT JOIN INSPECTION i ON i.business_id = b.id
LEFT JOIN VIOLATION v ON v.inspection_id = i.id
 GROUP BY b.id
"
39987,sql distinct selection avg aggregate,"select URLID,avg (Relevancy) from ccc 
group by URLID
"
28139,How to change the datatype of the Dummy Column in a View?,"create or replace view ABC_VIEW
(VEHICLEID,BRAND,MODEL,VEHICLE_TYPE,FUEL_TYPE,TRANSMISSION_TYPE,GEARBOX,DRIVE_TYPE,VEHICLE_NUMBER,PRICE,**""TEST Column""**) 
as select  VEHICLEID,BRAND,MODEL,VEHICLE_TYPE,FUEL_TYPE,
TRANSMISSION_TYPE,GEARBOX, DRIVE_TYPE,VEHICLE_NUMBER,PRICE,TO_NUMBER('') 
 from ABC;
"
33028,SQL - Query MAX value given MAX value of different column,"select id, year, males
from (select t.*,
             row_number() over (partition by id
                                order by years desc, males desc
                               ) as seqnum
      from t
     ) t
where seqnum = 1;
"
29912,merging two queries,"SELECT recipes.id, votes.date, votes.perc FROM recipes
RIGHT JOIN
(select weekly.id_rec, d.date, perc from 
    (SELECT weekly.id_rec, date FROM weekly where YEAR(date) = 2014 group by date) as d left join weekly on d.date = weekly.date) as votes 
ON votes.id_rec = recipes.id
"
38708,how to doing group with two cels in a single sql,"select g_size, sum(g_num),m_size, sum(m_num) 
from mytable 
group by g_size,by m_size;
"
28183,Table has one record per employee per year. How do I select the record for each employee for the latest year for that employee?,"SELECT employee_ref, firstname, lastname
FROM table
WHERE employment_year = (
    SELECT MAX(employment_year)
    FROM table b
    WHERE b.employee_ref = table.employee_ref)
"
6334,mysql extra columns with same name from two tables,"SELECT
  t1.user_id as t1_user_id
  ,t2.user_id as t2_user_id
FROM table1 as t1
INNER JOIN table2 as t2
  ON t1.entry_id=t2.entry_id
WHERE t1.user_id='%s'
"
32098,How to achieve this in Oracle query (Appending values),"SELECT 'Factor1 (' || var1 || ')' new_factor,
       'Factor2 (' || var2 || ')' another_factor
  FROM SomeTable
"
27916,Programmatically get all tables of a database owned by a user,"select is_tables.table_schema,
       is_tables.table_name 
from information_schema.tables is_tables 
inner join pg_tables 
        on is_tables.table_name = pg_tables.tablename 
       and is_tables.table_schema = pg_tables.schemaname
where is_tables.table_catalog = '<mydatabase>' 
  and is_tables.table_schema <> 'information_schema' 
  and is_tables.table_schema <> 'pg_catalog' 
  and pg_tables.tableowner = '<myuser>';
"
30717,combining two sql queries into one?,"create temporary table tmp1
Select flatpos from archdetails
where version='1.3' AND compname IN (
    select distinct compname from svn3 where revno='r270294'
)

create temporary table tmp2
select count(distinct compname) as c,
    sum(CASE WHEN inFlat=1 THEN 1 ELSE 0 END) as s,
    min(flatLoopIndex) as m
from archdetails
where version='1.3'
AND compname IN (
    select distinct compname from svn3 where revno='r270294'
)

select * from tmp1

select tmp2.c, tmp2.s, tmp2.m from tmp1, tmp2
"
28706,How can you query a SQL database for malicious or suspicious data?,"SELECT *
FROM MyTable
WHERE MyField LIKE '%[^a-z0-9]%'
"
1633,SQL query select and ordering all from same table with key/value pairs,"SELECT a.RESOURCE_NO, a.value webcategory, b.value location 
FROM      resources a
LEFT JOIN resources b ON a.RESOURCE_NO=b.RESOURCE_NO AND b.key='location'
LEFT JOIN resources c ON a.RESOURCE_NO=c.RESOURCE_NO AND c.key='order'
WHERE a.key = 'webcategory' AND a.value='dog'
GROUP BY RESOURCE_NO
ORDER BY c.value 
"
33435,pl/sql code for nearest neighbor query without index for a table with point data in oracle,"select id from points
order by sqrt(sqr(Data_x - target_x) + sqr(Data_y - target_y)) 
"
7921,mysql GROUP_CONCAT duplicates,"GROUP_CONCAT(DISTINCT animal)
"
5426,MySQL update if record does not exists in other table,"update table_to_update 
set some_column = 123
where id = 1
and id not in (select id from table_b)
"
28255,Querying a hierarchical table,"SELECT s.class, rec.class
FROM SchoolClass s
INNER JOIN SchoolClass req on s.id_class=req.id_class_req
WHERE SchoolClass.id_cours_prerequis Is Not Null;
"
12869,SELECT - values to columns in query,"select 
 tablea.workplace, 
 tablea.date, 
 tablea.shift, 
 sum(downtimemins),
 tableb.code1,
 tableb.code3, 
 tableb.code4, 
 tableb.code6 
from tablea 
left join downtime on 
 tablea.workplace=tableb.workplace and 
 tablea.date=tableb.date and 
 tablea.shift=tableb.shift 
group by tablea.workplace, tablea.date, tablea.shift
"
17069,Select tables that do not contain a certain column in MySQL,"select
t.*
from INFORMATION_SCHEMA.TABLES as t
    left join INFORMATION_SCHEMA.COLUMNS as c
    on c.TABLE_NAME = t.TABLE_NAME
    and c.TABLE_SCHEMA = t.TABLE_SCHEMA
    and c.COLUMN_NAME = 'unique'
where c.COLUMN_NAME is null
and t.TABLE_SCHEMA = 'database'
"
6502,"how to add Number of document in new column , trouh SQL (Oracle data )","    try 

 `select dbms_random.value(1,5) from dual`

    it will generate a random number
"
13594,Excluding a Participating Field from the GROUP BY Clause,"select field_a, field_b
  from (select field_a,
               field_b,
               max(field_b) over (partition by primary_key_id) as max_b
          from table_a)
 where primary_key_id=123
   and field_b = max_b;
"
31968,oracle duplicate columns to comma seperated string,"SELECT username 
  ,LISTAGG(colour , ',') WITHIN GROUP (ORDER BY colour ) AS colour 
  ,age
  FROM   t
  GROUP  BY
  username,age ;
"
12098,XMLElementnot returning data in Oracle 10g,"    SELECT XMLElement(""Emp"", 
                   XMLElement(""ID"", e.emp_id),
                   XMLElement(""Name"", e.emp_name))**.getClobVal()** AS ""RESULT"" 
     FROM emp_metadata e;
"
1690,Beginner - Query a value in a column that's labeled as text,"SELECT `id`, `keyword_netword_id`, `text`, `match_type`, `create_date` FROM `keywords` WHERE `text` LIKE '%medicare supplemental insurance%';
"
1802,Should I create a new DB column or not?," CREATE VIEW calculated_data_ex (id, date, the_value, status, the_filtered_value)
   AS SELECT id, date, the_value, status, IF(status IS FALSE, 0, the_value)
      FROM calculated_data
"
5583,Oracle SQL: Importing datestamp in UTC format,"TO_TIMESTAMP_TZ('2014-01-01 08:16:02 (+00:00)', 'YYYY-MM-DD HH24:MI:SS (TZH:TZM)')
"
2411,How to retreive Max Date from a left outer join?,"SELECT client_headquarter.id, max(clients.tscreated)
FROM client_headquarter 
LEFT OUTER JOIN clients ON clients.headquarterid = client_headquarter.id
GROUP BY client_headquarter.id
ORDER BY MAX(clients.tscreated) ASC
"
34418,"Select MAX value from other table, if any","SELECT u.Name AS Name, c.Comment AS Comment, c.Posted AS Posted
FROM User u LEFT JOIN
     (SELECT UserID, MAX(Posted) AS Posted
      FROM Comments c2
      GROUP BY UserID
     ) c2
     ON u.ID = c2.UserID LEFT JOIN
     Comments c
     ON c2.Posted = c.Posted
ORDER BY Posted DESC;
"
21599,Count records for every month in a year,"SELECT    COUNT(*) 
FROM      table_emp 
WHERE     YEAR(ARR_DATE) = '2012' 
GROUP BY  MONTH(ARR_DATE)
"
29893,Insert into with conditional constant,"insert into Table(a, b, c)
select a, 
       b, 
       CASE WHEN a = b THEN 'Enum1' ELSE 'Enum2' END
from OtherTable, YetAnotherTable
where a > 0
"
31134,T-SQL Delete half of duplicates with no primary key,"with todelete as (
      select t.*,
             row_number() over (partition by col1, col2, col3, . . . order by newid()) as seqnum
      from table t
     )
delete from todelete
    where seqnum % 2 = 0;
"
29237,Simple update query is taking too long,"UPDATE STATISTICS StatusMaster 
"
24216,sql get specific time in date,"select * from tbl
where datecol between dateadd(hour,21,DATEDIFF(d,0,getdate()-1))
  and getdate()
"
30082,SQL Server stored procedure : create increment ID in each occurrence of value,"WITH CTE AS(
    SELECT n.*, 
           NameOcc = ROW_NUMBER() OVER (PARTITION BY Name, City ORDER BY Name, City, Day)
    FROM dbo.Names n
)
SELECT * FROM CTE
"
34821,SQL Server 2008 - boolean variable change query,"DECLARE @IsStocked bit

SELECT * FROM Products p
WHERE  @IsStocked = 0 OR (p.LastSeen > GETDATE() - 30);
"
2889,Error conversion varchar datetime,"UPDATE dbo.table 
SET initTime = '2012-08-20T09:30:00.000' 
WHERE id = '0124'
"
27556,t-sql - delete second value only,"DELETE a FROM table1 
FROM table1 a 
JOIN (
        select ROW_NUMBER() over (ORDER BY <myKey> asc) as AutoNumber, <myKey> from table1
) b on a.<myKey> = b.<myKey>
WHERE condition1
AND b.AutoNumber = 2
"
25674,SQL Query for inserting multi column values in to single column,"INSERT INTO SingleCol(IDS)
   SELECT LibraryID FROM MultiCol WHERE Name = 'Rahul'
   UNION
   SELECT RegisterID FROM MultiCol WHERE Name = 'Rahul'
   UNION
   SELECT EngineerID FROM MultiCol WHERE Name = 'Rahul'
"
33392,"Same value is shown only one, how make it?","select
  case r when 1 then p.id end as id,
  case r when 1 then name end as name,
  case r when 1 then surname end as surname,
  description,
  contact
from
  person p, (
    select
      id,
      row_number() over (partition by id) as r,
      description,
      contact
    from
      contact
  ) c
where p.id = c.id;
"
26287,Is there a paging solution for ASP.NET MVC that does paging in the database?,"var upcomingDinners = dinnerRepository.FindUpcomingDinners();  
var paginatedDinners = upcomingDinners.Skip(10).Take(20).ToList(); 
"
26939,mysql multiple update,"REPLACE INTO `rank` (`user_id`,`week`,`change`) VALUES (364709193,'201042','new),(291179703,'201042','new'), ... etc.
"
23942,Using a String Array in an IN statement,"exec('select * from your_table where columnID in (' + @varsArray + ')')
"
33315,Dynamic AND clause,"AND (ep.pId IN (SELECT DISTINCT pId FROM #tempProj) 
                OR (SELECT COUNT(*) FROM #tempProj) = 0))
"
9660,Persisting a report snapshot in database automatically,"        Dim warnings As Warning() = Nothing
        Dim streamids As String() = Nothing
        Dim mimeType As String = Nothing
        Dim encoding As String = Nothing
        Dim extension As String = Nothing
        Dim bytes As Byte()

        'This reads the report as a binary stream of data, could be Excel, PDF, etc
        bytes = ExportReportViewer.ServerReport.Render(""Excel"", _
          Nothing, mimeType, _
            encoding, extension, streamids, warnings)
"
35767,Select particular result randomly from a table for a certain partition,"select i.*
from info i
where type = 'B'
union all
select i.*
from info i
where not exists (select 1 from info i2 where i2.name = i.name and i2.type = 'B');
"
32550,Need to select 5 latest records order by category?,"SELECT p.*
FROM product p1
LEFT OUTER JOIN product p2
  ON (p1.brand_id = p2.brand_id AND p1.product_id < p2.product_id)
GROUP BY p1.item_id
HAVING COUNT(*) <= 5
ORDER BY brand_id, product_publish_date;
"
29280,Select maximum value for each row and its column index,"SELECT id , GREATEST(field1, field2) max_val ,
CASE WHEN field1 >= field2  THEN 2 ELSE 3 END col_idx
FROM my_table
"
14968,MySQL Query - Get total of sum from three different tables,"select t.sRecordID,sum(t1.Fees)+sum(t2.Fees)+sum(t3.Fees) `Sum Fees`
from sRecords t
left join cFees t1 on t1.feeid=t.sRecordID
left join oFees t2 on t2.feeid=t.sRecordID
left join iFees t3 on t3.feeid=t.sRecordID
group by t.sRecordID
"
1301,sql joining three tables using inner joins,"select a.name,b.manufacturer_id,c.id,c.item_desc 
from manufacturers as a
inner join 
item_manufacturers as b
on b.manufacturer_id=a.id 
inner join item as c 
on c.id=b.item_id
"
39006,How do I create a table constraint to prevent duplicate values across two columns?,"CREATE VIEW dbo.VIEW_EntityAttributeRelship WITH SCHEMABINDING AS
SELECT EntityIdNmb 
FROM dbo.EntityAttributeRelship
WHERE IsActive = 1
GO

CREATE UNIQUE CLUSTERED INDEX UIX_VIEW_ENTITYATTRIBUTERELSHIP 
  ON dbo.VIEW_EntityAttributeRelship (EntityIdNmb)
"
30524,concat more rows in one with SQL,"select team_id, max(case when seqnum = 1 then result end) as result1,
       max(case when seqnum = 2 then result end) as result2,
       max(case when seqnum = 3 then result end) as result3
from (select t.*,
             row_number() over (partition by team_id order by team_id) as seqnum
      from t
     ) t
group by team_id;
"
11497,fetch Single column from two table,"SELECT  a.Price
FROM    SalesReturnDetails a
        INNER JOIN 
        (
            SELECT  DISTINCT Bill_number
            FROM    SalesReturn
            WHERE   Session='12-13'
        ) b ON a.Bill_number = b.Bill_number
"
28115,How to delete certain rows from MySQL table?,"DELETE FROM map_table where mapid LIKE 'h%';
"
13620,UPDATE script that runs with SQL-Server as well with PostgreSQL,"UPDATE address a
SET countrycode = (
      SELECT s.isocode
      FROM country s
      WHERE a.idcountry = s.id
);
"
23965,How to generate a hibernate ID with auto generate with a starting value,"@GenericGenerator(name=""generator"", strategy=""increment"")
@GeneratedValue(generator=""generator"")
"
31311,Filter duplicate rows based on a field,"SELECT * FROM (
   SELECT b.*,
   ROW_NUMBER() OVER (PARTITION BY BillID ORDER BY Lang) as num
   FROM Bills b
   WHERE Account = 'abcd'
) tbl
WHERE num = 1
"
4177,Count number of cases,"SELECT COUNT(*), leavetype 
FROM (
  SELECT leavetype
  FROM Leaves
  GROUP BY employee_id, leavetype
)
GROUP BY leavetype;
"
33172,MYSQL database select issue,"SELECT *
FROM
(
    Select column_name*other_column_name as sqr
    from table 
) X
where x.sqr < 25 
order by x.sqr;
"
35003,SQL query for difference between two tables,"SELECT
    COALESCE(b1.ToyId, b2.ToyId)  AS ToyId,
    b1.Price                      AS PriceTab1,
    b2.Price                      AS PriceTab2,
    (b2.Price-b1.Price)           AS Diff
FROM
    Bucket1 AS b1
  FULL JOIN
    Bucket2 AS b2
      ON b1.ToyId = b2.ToyId ;
"
19185,Sqlite. How to create an index in attached DB?,"sqlite> attach database "":memory:"" as m;
sqlite> .databases
seq  name             file
---  ---------------  ----------------------------------------------
0    main
2    m
sqlite> create table m.users (id int, name TEXT);
sqlite> create unique index m.qwe on users (name);
sqlite> insert into m.users VALUES(2,'asd');
sqlite> insert into m.users VALUES(3,'asd');
Error: column name is not unique
"
9837,delete a comment in a post with FOREIGN KEY,"CREATE TABLE IF NOT EXISTS `comments` (
  `id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,
  `postid` int(11) UNSIGNED NOT NULL,
  `user` varchar(40) NOT NULL,
  `texto` varchar(3000) NOT NULL,
  PRIMARY KEY (`id`),
  FOREIGN KEY (`postid`) REFERENCES posts (`id`)
     ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 AUTO_INCREMENT=1 ;
"
5970,SQL join both ways to one result,"select mother.id as connectedToId,
       mother.item as connectedToItem, 
       'Mother' as role
from TestItem ti
     join Connector c on c.child = ti.id
     join TestItem mother on c.mother = mother.id
where ti.item = 'John Doe'
union all
select child.id as connectedToId,
       child.item as connectedToItem, 
       'Child' as role
from TestItem ti
     join Connector c on c.mother = ti.id
     join TestItem child on c.child = child.id
where ti.item = 'John Doe'
"
11978,Remove subquery from JOIN?,"SELECT
   Previous.NAV as PreviousNAV,
   Todays.NAV as TodaysNav,
   ISNULL((Todays.NAV-Previous.NAV),0) NetChange,
   ISNULL((Todays.NAV-Previous.NAV) / Todays.NAV,0) BAMLIndex
FROM
    Fireball..NAV as Previous
JOIN
    Fireball..NAV as Todays
    ON Previous.portfolioID = Todays.PortfolioID
WHERE Previous.Date BETWEEN @StartDate AND @EndDate 
    AND Previous.PortfolioId = @PortfolioId
    AND Todays.Date = @EndDate
"
27452,How to fetch the column names from Type(object)?,"SELECT *
FROM ALL_TYPE_ATTRS;
"
32961,Forcing certain rows to end of results but maintaining sort order,"order by (case when column1 = 'xyz' then 1 else 0 end),
         column2, column3, column1
"
13435,How To Sign Up A New User To My Website Using Facebook,"FB.getLoginStatus(function (response) {
    if (response.status === 'connected') {
        //user is authorized
        console.log(response.authResponse.userID);
    } else {
        //user is not authorized or not logged in on facebook
    }
});
"
31476,Need Help on .... Select Where Date NOT BETWEEN,"select *
from A
where Id not in (
  select A.Id
  from A
  inner join E on A.Date between E.Start_date and E.End_date
)
"
28732,finding last record in a day,"select *
from
 (
   select t.*,
      row_number()
      over (partition by FK_SALES_REP_ID 
            order by INVOICE_DATE desc) as rn
   from tab as t
   where cast(INVOICE_DATE as date) = '12/31/13'
 ) as dt
where rn = 1
"
7386,"convert a SQL query to LINQ (DateDiff, DateAdd)","from u in Utilisateurs
where (DateTime.Now.Date - u.DateNaissance).TotalDays <=30
select u
"
10537,Rewrite SQL subquery to JOIN?,"SELECT b.shortDesc,
       b.img,
       sm.uri,
       match(`bodyCopy`, `shortDesc`) against ('Storage' IN NATURAL LANGUAGE MODE WITH QUERY EXPANSION) AS score
FROM `blog` b
JOIN `sitemap` sm ON sm.id = b.pageId
WHERE 'Active' IN (b.status, sm.status)
HAVING score > 0
ORDER BY score DESC
"
36459,Help with MySQL UPDATE with Subquery,"UPDATE
  database1.stadium AS s
INNER JOIN (
  SELECT DISTINCT teamID, stateID, cityID FROM database2.player
) AS p
USING (teamID, stateID)
SET
  s.cityID = p.cityID
WHERE
  s.cityID = 0
"
4800,How to search for multiple values on inner join,"select 
   p1.gameId 
from 
   participants as p1, participants as p2 
where
   p1.name = 'Team1' and p2.name='Team2' and p1.gameId = p2.gameId
"
31222,PLSQL CLOBS into variables,"DECLARE
  clob_rec CLOB;
  n_rec NUMBER:=100;
  x XMLType;
BEGIN
  SELECT LOB INTO clob_rec FROM table1 WHERE ID = 1234;
  x := XMLType(clob_rec);
  n_rec := x.EXTRACT('//XPTO/text()', 'xmlns:XPTO').getNumVal();
END;
"
9950,"How do I update if exists, insert if not (AKA ""upsert"" or ""merge"") in MySQL?","INSERT INTO `usage`
(`thing_id`, `times_used`, `first_time_used`)
VALUES
(4815162342, 1, NOW())
ON DUPLICATE KEY UPDATE
`times_used` = `times_used` + 1
"
18095,Count Multiple Fields same Row - SQL,"SELECT COUNT(*) AS Reports, q.writer
    FROM (SELECT writer1 AS writer
              FROM YourTable
              WHERE loc1 = 1
          UNION ALL
          SELECT writer2 AS writer
              FROM YourTable
              WHERE loc2 = 1) q
   GROUP BY q.writer
"
19927,Querying multiple tables and displaying the outcome wtih SQL and Access,"SELECT CustomerAccountDetails.custFullName, CustomerAccountDetails.custAddress, StockDescription.stockName
FROM StockDescription 
    INNER JOIN ((CustomerAccountDetails 
    INNER JOIN CustomerTransaction ON CustomerAccountDetails.ID = CustomerTransaction.custID) 
    INNER JOIN TransactionDetails ON CustomerTransaction.ID = TransactionDetails.custTransID) ON StockDescription.ID = TransactionDetails.StockID
WHERE StockDescription.stockName=""something""
"
8545,selecting subsequent records arbitrarily with limit,"select *
from mytable
where datecolumn > (select datecolumn from mytable where id = @id)
order by datecolumn
limit 1
"
17413,mysql select value of column2 where MIN(column1),"SELECT  r.courseid, r.username, r.`day`,r.score
FROM    result r
JOIN (SELECT username, MIN(score) score 
      FROM result 
      where courseid = '2'
      GROUP BY username) r1
ON(r.username = r1.username and r.score = r1.score)
order by r.score
limit 10
"
19986,Removing rows from table with specific distinct values,"DELETE t
FROM YourTable t
Group By KeyAccountNumber,GList,StartDate,EndDate
HAVING COUNT(*) > 1
"
17003,SQL Server : rank data based on minimum distance,"select t1.*, t2.*
from table1 t1 cross apply
     (select top 1 t2.*
      from table2 t2
      order by distance(t1, t2)  -- put your appropriate function here
     ) t2;
"
32755,Event/Time and criteria based SQL,"SELECT a.* 
FROM user a 
LEFT JOIN event b ON (b.user = a.id AND b.event = 'userjoined') 
WHERE a.joineddt < '1 week ago date' 
AND b.id IS NULL
"
9795,Select split values with their matching ids,"SELECT *
FROM idval i
CROSS APPLY dbo.fnSplitString(i.val, ',') f
"
9482,User COUNT() in SQL Server query to be independent on the where clause,"select ou.*
from (select u.FullName, u.Id, o.FullAddress,
             Price, Payment, o.Created, StartDelivery as Delivering, 
             [Status], o.Id,
             COUNT(*) OVER (PARTITION BY o.CustomerId) AS CountOfOrders
      from orders o full outer join
           users u
           on o.CustomerId = u.Id
     ) ou
where [Status] = 2
"
34397,LINQ to SQL: Issue with concurrency,"    try
    { 
       Begin netTransaction();
        If (IsEnoughIngredients())
        {
           1. Build your sandwich
           2. Add sandwich to data context with a timestamp (or whatever you chose for concurrency checking)
           3. SubmitChangesToDataContext()
           4. CommitNetTransaction() 
        }
    } catch (Exception e)
    {
       Rollback netTransaction();
       InformUser();
    }
"
35042,ORDER BY specific value then rotate through the rest,"SELECT * FROM Users ORDER BY id<3,id
"
8157,Rank based on two columns," SELECT player, wins, diff,rank from
 (
 SELECT player, wins, diff, @winrank := @winrank + 1 AS rank
 from tmpPoradi,(SELECT @winrank := 0) r 
 ORDER BY wins DESC,diff DESC
 )  rt
ORDER BY player
"
1053,"MySQL: UPDATE column WHERE column STARTS WITH "" "" (Blankspace)","UPDATE table SET column = LTRIM(column)
"
29543,SQL conditionally update based on 2 different values,"UPDATE 
  TABLE
SET 
  COLUMN1 = CASE WHEN COLUMN2 IN (1,2,3) THEN X ELSE Y END
"
22295,Which is the best approach to translates the results of a sql query directly to the X and Y axis of a chart,"SELECT CONCAT(city , ', ', country) AS x_axis, COUNT(*) as y_axis
FROM beer
GROUP BY city, country
HAVING COUNT(*) > 100
ORDER BY country, city;
"
19631,Find a database with a particular table OR Find a table in every database of SQL Server,"create table #t (
    DBName sysname not null
)
go
exec sp_msforeachdb 'use [?]; if OBJECT_ID(''dbo.mytable'') is not null insert into #t (DBName) select ''?'''
go
select * from #t
go
drop table #t
"
25959,T-SQL Trigger After Specific Insertion,"create trigger MaxIdInsert
on YourTable
after insert

as

    if exists
    (
        select *
        from inserted
        where ColumnX = 'MAX ID'
    )
    begin
        -- do what you want here if ColumnX has value of 'MAX ID'
    end

go
"
29682,sql query for the following statement?,"select 
    county,
    sum(invoiceTotal)
from customer 
where email like '%yahoo%'
group by Country
having Count(Country)>2
"
22496,Arithmetic operation on null,"coalesce(sum(Debit), 0) - coalesce(sum(Credit), 0)
"
32670,Tagging system design issues,"id  name          parent_tag_id
-------------------------------
1   language      null
2   english       1
3   french        1
4   newscategory  null
5   economy       4
6   politics      4
"
16644,SQL Hurdle - SQL Server 2008,"WITH MyCte AS    
    (SELECT	MyWeek = 1     
    UNION ALL     
    SELECT	MyWeek + 1     
    FROM	MyCte     
    WHERE	MyWeek < 53)
SELECT  MyWeek, 
    	DATEPART(year, DATEADD(wk, -MyWeek, GETDATE())),
    	DATEPART(month, DATEADD(wk, -MyWeek, GETDATE())),
    	DATEPART(wk, DATEADD(wk, -MyWeek, GETDATE()))
FROM    MyCte
"
15114,SQL specify the date in Select statement,"SELECT FIRST, LAST, HIRE_DATE, 
  TO_CHAR(LAST_DAY(HIRE_DATE),'""[""Month ddTH"" of ""YYYY""]""') as D
FROM EMPLOYEES
WHERE  EXTRACT(MONTH FROM HIRE_DATE) IN (5,11)
  AND EXTRACT(YEAR FROM HIRE_DATE) NOT IN (1994, 1995)
ORDER BY HIRE_DATE DESC
"
27473,Querying a database with any subset of a list of conditions,"WHERE (CASE WHEN column0 < value0 THEN 1 ELSE 0 END + 
      CASE WHEN column1 < value1 THEN 1 ELSE 0 END + 
      ... + 
      CASE WHEN column19 < value19 THEN 1 ELSE 0 END) >= 15
"
16952,How to view the amount of active connections in Oracle?,"select COUNT(*), PROGRAM
from v$session
where status = 'ACTIVE'
  GROUP BY PROGRAM
"
9929,Oracle - select rows with minimal value in a subset,"select a.dateID, a.personID, a.date, a.max_date, a.starttime
  from (select t.*, 
               max(t.date) over (partition by t.personID) max_date,
               row_number() over (partition by t.personID 
                                  order by t.date, t.starttime) rn
          from table t) a
 where a.rn = 1;
"
13486,How to get values alternate for ROW_NUMBER()?,"SELECT MAX(CASE WHEN t.innings = 1 THEN t.name END) as 1stInn,
       MAX(CASE WHEN t.innings = 2 THEN t.name END) as 2sndInn,
       t.Order
FROM YourTable t
GROUP BY t.order
"
23718,Ordering MySQL results by IN sequence?,"SELECT x.y, x.z FROM x WHERE x.id IN (23, 55, 44, 12)
ORDER BY FIELD (x.id, 23, 55, 44, 12)
"
23436,SQL: Select distinct sum of column with max(column),"select sum(s.pay)
from (select person_id, max(start_date) as maxstartdate
      from salary
      where person_id in ( . . . ) and
            start_date < <first day of month of interest>
      group by person_id
   ) p join
   salary s
   on s.person_id = p.person_id and
      s.maxstartdate = p.start_date
"
12256,Calculating the total elements unique to each data,"select
    subject_code + academic_period_code as [Type],
    sum(duration) as duration
from view2
group by
    subject_code + academic_period_code;
"
25107,datatype supplied by user for SQL field,"ID       Type      StringValue       DateValue      NumberValue
1001     String    Foo
1002     Date                        10/12/2008
1003     Number                                     123.46
"
31912,How do you read XML Data in SQL Server 2005,"SELECT
    YourXMlColumn.value('(/Root/SomeItems/Item/FirstName)[1]', 'varchar(50)') as 'FirstName',
    YourXMlColumn.value('(/Root/SomeItems/Item/Age)[1]', 'int') as 'Age'
FROM
    dbo.YourTable
WHERE
    (some condition)
"
32261,"MySQL most recent n entries, ascending?","Select * from
(SELECT owner_id,message,time 
FROM messages
WHERE thread_id = ? 
ORDER BY time DESC
LIMIT ?) test
Order by time ASC
"
15615,update records of multiple tables using same id,"""UPDATE "".TBL_AGENT."" 
JOIN  "".TBL_SUBSCRIPTION."" ON "".TBL_AGENT."".agent_id = "".TBL_SUBSCRIPTION."".agent_id
SET "".TBL_AGENT."".agent_name = '$_POST[agent_name]' , "".TBL_AGENT."".company_name = '$_POST[company_name]' , "".TBL_AGENT."".email = '$_POST[email]',  "".TBL_SUBSCRIPTION."".renewal_date = ( UNIX_TIMESTAMP() + ( '$_POST[subscription_renewal]' * 86400 ) ) 
WHERE "".TBL_AGENT."".agent_id = '{$_GET['id']}';""
"
20664,SQL Script to find Foreign keys to a specific table?,"SELECT 
    f.name AS ForeignKey,
    OBJECT_NAME(f.parent_object_id) AS TableName,
    COL_NAME(fc.parent_object_id,
    fc.parent_column_id) AS ColumnName,
    OBJECT_NAME (f.referenced_object_id) AS ReferenceTableName,
    COL_NAME(fc.referenced_object_id,
    fc.referenced_column_id) AS ReferenceColumnName
FROM 
    sys.foreign_keys AS f
    INNER JOIN sys.foreign_key_columns AS fc ON f.OBJECT_ID = fc.constraint_object_id
"
25115,Condition WHERE clauses inside stored procedure,"IF(@ildPais =0 AND @ildRegion =0)
SELECT <THE DATASET> FROM THE TABLE
WHERE 
   t.iDdPais = @iIdPais
   AND t.iIdRegion = @iIdRegion
   AND t.dtFecha BETWEEN @dtStart AND @dtEnd

ELSE 
SELECT <THE DATASET> FROM THE TABLE
--no where clause
"
10436,How to add commas to a value?,"insert into dbo.SAPID (TEST2)
Values (char(39) + '110' + char(39)) 
"
28910,Check if a time is between two times (time DataType),"select *
from MyTable
where CAST(Created as time) >= '23:00:00' 
   or CAST(Created as time) < '07:00:00'
"
4972,Sql to select row from each day of a month,"WITH T AS (
    SELECT ric_date
    FROM yourTable
    WHERE rice_date BETWEEN @start_date AND @end_date -- thanks Aaron Bertrand
    GROUP BY ric_date
)

SELECT CA.*
FROM T
CROSS APPLY (
    SELECT TOP 500 * -- 'a fews'
    FROM yourTable AS YT
    WHERE YT.ric_date = T.ric_date
    ORDER BY someAttribute -- not required, but useful
) AS CA
"
20333,How do I detect Oracle XE?,"select * from v$version 

select * from product_component_version
"
21507,how to see spaces in data when selecting with mysql command line client,"-- to add another tricky example
mysql> insert into foo values("" \"" ' ""), (""''"");
Query OK, 1 row affected (0.06 sec)

mysql> select bar, quote(bar) from foo;
+-------+------------+
| bar   | quote(bar) |
+-------+------------+
|       | ' '        |
|       | '  '       |
|       | '   '      |
|  "" '  | ' "" \' '   |
| ''    | '\'\''     |
+-------+------------+
4 rows in set (0.00 sec)
"
3278,MySQL update is running slow,"UPDATE 
`zydushr`.`performance`  AS a1 
JOIN `zydusquiz`.`performance` AS a2 
ON a1.`EmpNo` = a2.`EmpNo` 
 AND a1.`Month` = a2.`Month` 
 AND a1.`Year` = a2.`Year` 
SET a1.`Sales` = a2.`AchievementHQ` 
"
33072,SQL Query - Return rows from table A matching any row in table B,"SELECT
 b.location,
 (other fields of interest)
FROM
 tableB b
JOIN
 (SELECT a.location, min(a.workdate) as min_workdate
   FROM tableA a   
   GROUP BY a.location) c
ON b.location = c.location
WHERE c.min_workdate > '201201'
"
10339,SELECT all rows for given start_datetime and end_datetime,"SELECT id, start_datetime, end_datetime, arena_surface_id 
FROM gce_arena_surface_booking 
WHERE ('2012-11-23 6:00' > start_datetime)
AND ('2012-11-23 2:00' < end_datetime)
AND arena_surface_id = 2
"
9265,split a column's value into 2 different columns,"UPDATE T1
SET
  A1 = SUBSTRING(A1, 1, CHARINDEX('%', A1) - 1),
  A2 = STUFF(A1, 1, CHARINDEX('%', A1), '')
WHERE CHARINDEX('%', A1) > 0
"
3657,Can Oracle allow Permanent Alias for a table?,"create materialized view M_Parts            
tablespace USERS
refresh fast
as select * from Parts
"
3670,"I want to group by hour,min,day. how to do this?","select to_char(""time"" - 7.5/24, 'YYYY-MM-DD') as thedate, count(*)
from ""data""
group by to_char(""time"" - 7.5/24, 'YYYY-MM-DD')
order by 1
"
37415,How much time will my SQL query take?,"SELECT COUNT(*)
FROM A,B,C
"
10627,How to select two airport names based on two airport codes in one table?,"SELECT
  flightNumber, 
  timeOfDeparture, 
  DA.name AS 'Departure Airport',
  AA.name AS 'Arrival Airport'
FROM
  Flight As F
  INNER JOIN Airport As DA
  ON F.departureAirport_IATA = DA.airportIATA
  INNER JOIN Airport As AA
  ON F.arrivalAirport_IATA = AA.airportIATA
WHERE 
  F.stopOverAirport_IATA IS NULL
;
"
37405,SQL join two tables with different number of rows and copy the results,"SELECT 
  l.LanguageId,
  l.Name,
  p.ProductId,
  p.Name AS ProductName
FROM Language l
CROSS JOIN Product p
"
18940,MySQL query missing IDs,"SELECT 
    ut.idu as IDU,
    ut.fname || ut.lname as Name,
    (SELECT COUNT(*) FROM events_table) - SUM(CASE WHEN at.idu is null then 0 else 1 end) as TimesAbsent
FROM attendance_table at
RIGHT JOIN user_table ut
ON at.idu = ut.idu
GROUP BY ut.idu, ut.fname, ut.lname
"
25231,a little tricky mysql query,"SELECT auctions.seller, auctions.transaction_date, SUM(comments.rating) AS seller_rating, COUNT(comments.comment_date) AS num_of_comments
  FROM auctions
  LEFT OUTER JOIN comments 
    ON auctions.seller = comments.seller
  WHERE auctions.transaction_date > comments.comment_date
GROUP BY auctions.seller, auctions.transaction_date
"
25136,Compare one column values for the table in sql,"create table #temp
(
    textfield varchar(50)
)

insert into #temp
select '13-46187(IC)'
UNION
select '13-46186(IC)'
UNION
select '13-46189'
UNION
select '13-46185'
UNION
select '13-46184'


select Max(Convert(int,substring(SUBSTRING(textfield, 6, LEN(textfield)), 1, 3)))
from #temp
"
30146,Any way to prevent AUTOINCREASE on failed 'INSERT OR IGNORE'?,"INSERT INTO t1 (x,y,z) 
SELECT * FROM t2 main
where not exists (
    select * from t1 test
    where main.y = test.y);
"
23910,SQL nested sums with multiple joins and group by,"WITH b2 AS
(SELECT b.*, sum(b.b_qty) over (partition BY b.a_id, b.b_name) b_qty_s
             FROM b)
SELECT a.a_id, a.a_name, b2.b_name, b2.b_qty_s, sum(c.c_qty) c_qty_s
FROM a JOIN b2 ON a.a_id = b2.a_id
JOIN c ON b2.b_id = c.b_id
GROUP BY a.a_id,a.a_name, b2.b_name, b2.b_qty_s
"
4585,How to create “cell blocks” in SQL Server 2012,"select replicate('-',20)
"
37605,Android: parse.com query,"ParseQuery<ParseObject> query = ParseQuery.getQuery(""Data_db"");                 
query.whereEqualTo(""username"", edittext_user.getText().toString());
query.getFirstInBackground(...);
"
7327,Comma separated value search in mysql,"SELECT * FROM table WHERE FIND_IN_SET('1',meta_val) AND FIND_IN_SET('2', meta_val);
"
21062,Perl - DBI - How to process array rather than single value?,"my $sql = 'select rec_data from foo where id in (';
$sql .= join ',', (""?"") x @queryIDs;
$sql .= ') order by id';

my $sth = $dbh->prepare($sql);

$sth-> execute(@queryIDs);

# rest of code will be the same as you have now
"
14005,Compare two rows in two columns,"WITH Cte AS(
    SELECT *,
        rn = ROW_NUMBER() OVER(ORDER BY (SELECT NULL))
    FROM tbl
)
SELECT
    t1.*,
    difference = ISNULL(t2.column2 - t1.column1, 0)
FROM cte t1
LEFT JOIN Cte t2
    ON t1.rn = t2.rn + 1
"
5099,How to add new user to sql database,"INSERT INTO [dbo].[Users]
(
  [Name]
  ,[Surname]
  ,[Email]
  ,[Password]
  ,[Status]
  ,[DepartmentId]
  ,[Guid]
)
VALUES
(
  'david'
  ,'van staden'
  ,'ds@ik.io'
  ,123123  
  ,0
  ,8
  ,newid()
)
"
33274,SQL Conditional Date COALESCE,"CASE 
  WHEN COALESCE(j.offer_date, j.accepted_date, j.reported_date, j.start_date) < '1999-01-01' THEN '1999-01-01'
  ELSE COALESCE(j.offer_date, j.accepted_date, j.reported_date, j.start_date)
END
"
1507,mysql optimize data content: multi column or simple column hash data,"SELECT
  package.id,
  user_id,
  package_name,
  date,
  package_content.*
FROM package
INNER JOIN package_content on package.id = package_content.id
WHERE whatever
ORDER BY whatever
"
18022,SQL: Compare Version string (W.X.Y.Z) in MySQL,"SELECT Version
FROM foo
order by 
SUBSTRING_INDEX( `version` , '.', 1 )*1,
SUBSTRING_INDEX(SUBSTRING_INDEX( `version` , '.', 2 ),'.',-1)*1, 
SUBSTRING_INDEX(SUBSTRING_INDEX( `version` , '.', -2 ),'.',1)*1,
SUBSTRING_INDEX( `version` , '.', -1 )*1
"
29930,Optimize mysql query to select the values,"SELECT  audit_name,
        SUM(audit_choice = 'Passed') AS passed,
        SUM(audit_choice = 'Failed') AS failed
FROM    audit
GROUP BY
        audit_name
"
12720,Is it possibile to write a query that returns multiple fields from an object obtained by calling a function in Oracle?,"select t.obj.col1,t.obj.col2,t.obj.col3 
from (
  select get_t1('1') obj
  from dual
  where rownum = 1
) t;

OBJ.COL1   OBJ.COL2   OBJ.COL3 
---------- ---------- ----------
11IQGCV    21IQGCV    31IQGCV   
"
5787,SQL - Comparing tables that do not have same number of rows but same number of columns,"Delete from A where id in 
             (
                Select id from ((select id from A) minus (select id from B))
             );
"
32424,SQL Combine Columns into a string,"DECLARE @theString varchar(100)

SELECT @theString = case t1 when 1 then 't1 ' else '' end
                  + case t2 when 1 then 't2 ' else '' end
                  + case t3 when 1 then 't3 ' else '' end
                  + case t4 when 1 then 't4 ' else '' end
 from t
 where id = 1
"
32282,"SQL Update using ""where"" value from another table?","UPDATE table_b
SET score=1
WHERE id = (select id from table_a where user_id =""Ken"")
"
16542,Can row_number() ignore null in oracle,"select (case when code is not null
             then row_number() over (partition by (case when code is not null then 1 else 0 end)
                                     order by . . .
                                    )
        end) as id
"
36785,Storing multiple date ranges,"  id  userid startDate  EndDate
 ---- ------ ---------- ----------
    1     1  2014-04-01 2014-04-06
    2     1  2014-04-06 2014-04-09
    3     1  2014-04-09 2014-04-11
    4     1  2014-04-11 null
"
12016,Fastest way to insert data to database for one to many relationship,"INSERT INTO ""User_Detail"" (""Usr_Name"", ""Property"", ""Value"")
SELECT ""Name"", 'Uni', '0000'
FROM   ""User"";
"
8053,Show First instance of records with duplicate values in colum,"SELECT  a.*
FROM    gallery_images a
    INNER JOIN
    (
        SELECT gallery_ID, MIN(id) id
        FROM gallery_images 
        GROUP BY gallery_ID
    ) b
        ON a.gallery_ID = b.gallery_ID AND
            a.id = b.id
"
16010,SQL: SELECT if entry in one column corresponds to another column of a different table,"SELECT DISTINCT n.node_name, n.data
    FROM nodes n
        INNER JOIN nodeActivity na
            ON n.node_name = na.node_name
                AND na.time = '00:00:00'
"
22012,Updating a column based on its position in the results,"SET @prev_value = NULL;
SET @rank_count = 0;

UPDATE users SET rank_level = CASE
  WHEN @prev_value = level THEN @rank_count
  WHEN @prev_value := level THEN @rank_count := @rank_count + 1
END
ORDER BY level DESC;
"
22599,Getting records between 2 values in datediff function in SQL Server,"declare @today smalldatetime = getdate()
select 
   due_date
from 
   some_table
where
   datediff(day, due_date, @today) > 60 and
   datediff(day, due_date, @today) < 90
"
34900,How to create optimizer hints based on explain plan output?,"select * from table(dbms_xplan.display(null, null, 'OUTLINE'));
"
37148,why we cannot use condition rownum=5 in oracle,"select * from (
  select
    emp.*,
    row_number() over (order by fieldname) as rnum
  from emp
) tmp
where
  rnum between 5 and 10;
"
38003,Counting null values as unique value,"select  count(distinct col1) + count(distinct case when col1 is null then 1 end)
from    YourTable
"
8784,How to implement a do-while loop in tsql,"WHILE (1=1)
  BEGIN

  -- Do stuff...

  IF (some_condition is true)
     BREAK;

  END
"
32987,Table constraint for data pair regardless of order,"create unique index unq_friends_user_friend
    on (least(user_id, friend_id), greatest(user_id, friend_id));
"
27880,hibernate.hbm2ddl.auto + custom sql-type in Oracle,"@Column(name=""BOOLEAN_COLUMN"", columnDefinition = ""varchar2(1)"")
@Type(type = ""yes_no"")
private Boolean booCol;
"
28201,SQLite: Update a Null Value to Data in Prior Row,"UPDATE stage
SET title = (
  SELECT title
  FROM stage AS prev
  WHERE title IS NOT NULL AND prev.rowid < stage.rowid
  ORDER BY prev.rowid DESC
  LIMIT 1
)
WHERE title IS NULL
"
20753,Can you cherry pick a column value from a table returned by a function?,"DECLARE @IntegerOne Integer; 
DECLARE @IntegerTwo Integer;
DECLARE @IntegerThree Integer;

SELECT TOP 1                    --<-- To make sure only one row is returned
        @IntegerOne   = Column1
       ,@IntegerTwo   = Column2
       ,@IntegerThree = Column3
FROM dbo.GetTable(@myInteger)
--WHERE Clause if required  
"
39764,Convert Columns of Data to Rows of data in SQL Server,"SELECT * FROM 
(SELECT Header, Data FROM CSVTest_Match) AS T
PIVOT (Min(Data) FOR Header IN ([Home Team], [Away Team], [Kick Off Time], 
                [Kick Off Date], [Home Goals], [Away Goals])) AS T2
"
9627,Find common data between groups,"with temp as
(
    SELECT Date, Remark
    From MyTable
    GROUP BY Date, Remark
)
SELECT Date
FROM temp
GROUP BY Date
Having COUNT(*) > 1
"
28003,How do I create an SQL query that groups by value ranges,"SELECT B.Description, Total = COUNT(*) / CONVERT(money, (SELECT COUNT(*) FROM Target T2))
FROM Target T
JOIN (
    SELECT 	Description = '0 to 10', LBound = 0, UBound = 10 
    UNION ALL 
    SELECT Description = '10 to 20', LBound = 10, UBound = 20
) B ON T.Value >= LBound AND T.Value < B.UBound
GROUP BY B.Description
"
7301,"Select distinct after ""removing"" trailing spaces","SELECT DISTINCT trimmed
FROM (
    SELECT RTRIM(LTRIM(MyID)) as trimmed
    FROM dbo.SourceTbl
) A
"
26725,Alternative for exists query,"UPDATE tab1
INNER JOIN tab2 ON --some join condition
SET sbd = --something
AND abc = --other something
WHERE --some conditions
"
17073,SQL Server Query Performance Issue: Need Replacement of NOT EXISTS,"SELECT
  fn.column1
INTO
  #temp  
FROM
  dbo.function1(input1) AS fn

CREATE NONCLUSTERED INDEX [temp_index] ON #temp 
(
    column1 ASC
)

SELECT
  column1
FROM
  #temp AS t
EXCEPT
(
  SELECT
    column1
  FROM
    dbo.table1
  UNION
  SELECT
    column1
  FROM
    dbo.table2
)
"
31925,Variable inclause is not working for the PL/SQL,"UPDATE THIRD_PARTY_LOOKUP 
    SET ADDRESS_ID = firstSequenceNumber 
    WHERE ','||ADDRESS_ID||',' LIKE '%,' || RESTALLSEQUENCENUMBERLIST  || '%,';
"
9496,get values based on foreign key,"select a.account_id, coalesce(sum(t.income),0) as total_income,
       coalesce(sum(t.expenses),0) as total_expenses
from accounts a left join
     transactions t
     on a.account_id = t.account_id
group by a.account_id;
"
26822,"open ""shape"" attribute in mysql database","-- show the WKT representation of the geometry
SELECT ST_AsText(SHAPE) FROM table;
-- show the coordinates of start and end point of the lines
SELECT ST_AsText(ST_StartPoint(SHAPE)), ST_AsText(ST_EndPoint(SHAPE)) FROM table;
-- show how many points build the line
SELECT ST_NumPoints(SHAPE)) FROM table;
-- length of the lines
SELECT ST_Length(SHAPE)) FROM table;
"
8387,SQL Query to join Two tables,"SELECT `date`, `time`, sum(`amt1`) as `table1-amt`, sum(`amt2`) as `table2-amt` 
FROM
(SELECT `date`, `time`, amount as amt1, null as amt2
 FROM Table1
 UNION ALL
 SELECT  `date`, `time`, null as am1, amount as amt2
 FROM Table2) v
GROUP BY `date`, `time`
"
16435,Join More Than 2 Tables,"SELECT Data.*, Limits.Lim1, Limits.Lim2
FROM (SELECT * FROM Files WHERE SubType IS NOT NULL) DataFiles
JOIN (SELECT * FROM Files WHERE SubType IS NULL) LimitFiles
  ON LimitFiles.Type = DataFiles.Type
JOIN Data 
  ON DataFiles.ID = Data.File_ID
JOIN Limits
  ON LimitFiles.ID = Limits.File_ID
  AND DataFiles.SubType = Limits.SubType
ORDER BY Data.File_ID
"
8689,How do I get the string directly after 'me' in the string 'Help me Please' in Oracle 11G,"select regexp_replace(STRING_NAME, '^.*? me ','') from STRING_HELP
"
6702,Storing the previous month as a char with a leading 0 for single digit months,"SELECT COUNT(*)
FROM jwemaildb.LogFileRecords
WHERE
    date > = DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0) AND
    date <  DATEADD(month, DATEDIFF(month, 0, GETDATE()), 0) AND
    CAST(RIGHT(eAlertSentDate, 4) + LEFT(eAlertSentDate, 4) AS date) BETWEEN       
    DATEADD(dd , 1 - DAY(GETDATE()), DATEADD(mm, -1 ,GETDATE())) AND
    DATEADD(dd , 1 - DAY(GETDATE()), GETDATE())
"
23885,In SQL can I return a tables with a varying number of columns,"Create Table ClientAttributes
(
    ClientId ....
    , Sex Char(1)...
    , Age int...
    , Income...
)
"
1419,Show products from database that are egal or smaller dotay date,"SELECT * FROM products
WHERE date_available > CURDATE()
"
2007,Jsp & stored procedures,"execute
boolean execute()
  Executes the SQL statement in this PreparedStatement object, which may be any kind of SQL  
  statement. Some prepared statements return multiple results; the execute method handles these 
  complex statements as well as the simpler form of statements handled by the methods 
  executeQuery and executeUpdate. 

The execute method returns a boolean to indicate the form of the first result. You must call 
either the method getResultSet or getUpdateCount to retrieve the result; you must call 
getMoreResults to move to any subsequent result(s). 
"
30380,Issue with join and sum in mysql query: invalid use of group function,"UPDATE account INNER JOIN
       (SELECT c1.user, sum(c1.total_1) as sumc
        FROM c1
        GROUP BY c1.user
       ) c1
       ON c1.user = account.u_id
    SET account.amount = account.amount + sumc
    WHERE account.t_ype = 8 ;
"
39991,How can I retrieve all 3rd level child nodes for all records in my table using SQL?,"SELECT
    L3.id,
    L3.parent_id,
    L3.data
FROM
    Item L1
INNER JOIN Item L2 ON L2.parent_id = L1.id
INNER JOIN Item L3 ON L3.parent_id = L2.id
WHERE
    L1.parent_id = -1
"
21233,SQL Query to select Common Values,"SELECT t1.username 
FROM ip_table AS t1 
    JOIN ip_table AS t2 
    ON  t1.`username` = t2.`username`
AND t1.ip = <ip1> AND t2.ip = <ip2> ... etc
"
5475,Using phpmyadmin to manage duplicates,"select t1.id, t2.id, t1.value
from table t1
inner join table t2 on t1.value=t2.value
where t1.id < t2.id
"
32931,Selecting most recent answers efficiently,"SELECT T.EventId, T.MemberId, T.TimeStamp, T.Answer
FROM TableName T
 JOIN (
   SELECT EventId, MemberId, Max(Timestamp) MaxTimeStamp
   FROM TableName
   GROUP BY EventId, MemberId ) T2 ON T.EventId = T2.EventId 
    AND T.MemberId = T2.MemberId 
    AND T.TimeStamp = T2.MaxTimeStamp
"
35392,Auto increment a field without sequence in ORACLE,"insert into Test values ( (select max(seq_fld) from Test) + 1)
"
33414,Need an SQL to create a View,"select *
from
(
    SELECT id, name, value FROM table A)
    pivot
    (
        max(value) for name in ('dog name', 'cat name', 'childs')
    )
order by id
"
19235,Lua mySQL update statements and where clauses,"status, err = assert(
  conn:execute[[UPDATE Users SET count=count+1 WHERE userID='user#id50589297']]))
"
16295,MySQL Order By with Limit to MS SQL Order By,"SELECT TOP 1 @thesttax = stax
FROM transfers 
WHERE masterkey = @skey and effdate <= CURRENT_DATE() 
ORDER BY effdate DESC;
"
6992,SQL concatenate rows query,"SELECT status, GROUP_CONCAT(title)
FROM posts
GROUP BY status
"
13298,How do I count how many times strings from a list appear each in a query?,"SELECT Name, COUNT(*) AS totalCount
FROM   tableName
GROUP  BY Name
"
25538,Cross-table UPDATE in SQLITE3,"UPDATE tbl1 SET col2 = (SELECT col2 FROM tbl2 WHERE tbl2.col1 = tbl1.col1)
"
35742,MySQL query to determine records that are related to category A and B,"SELECT p.*
FROM products p
     inner join 
(
    select product_ID
    from category_product
    where category_id in (1,2)
    group by product_id
    having count(distinct category_id)=2
) pc
    on p.id = pc.product_id
"
21245,Connecting spread tables to one - schema,"create table employees (
  employee_id integer primary key,
  employee_full_name varchar(35) not null,
  employee_ssan char(11) not null unique
);
"
2481,Union of two tables with the same columns and same where clause,"select sku, catalogname, getdate()
from
(
select sku, catalogname, categoryname, parentOID
from uswebdb.commerce.catalogproducts
union all
select sku, catalogname, categoryname, parentOID
from ukwebdb.commerce.catalogproducts
) F
where (F.CategoryName is not null or F.ParentOID = 113)
and (F.sku not like '%[a-z]%')
"
4064,CONSTRAINT based on field value,"[CONSTRAINT [symbol]] FOREIGN KEY
      [index_name] (index_col_name,...)
    REFERENCES tbl_name (index_col_name,...)
      [MATCH FULL | MATCH PARTIAL | MATCH SIMPLE]
      [ON DELETE {RESTRICT | CASCADE | SET NULL | NO ACTION}]
      [ON UPDATE {RESTRICT | CASCADE | SET NULL | NO ACTION}]
"
14998,Compute dates and durations in mysql query,"SELECT z.task_id, COALESCE(DATEDIFF(b.log_date, a.log_date), 0) as step1_days
"
1512,Count of one of the columns,"SELECT *,
    COUNT(*) OVER(PARTITION BY col1)
FROM tab1
"
21652,Removing duplicate rows from table in Oracle,"DELETE FROM your_table
WHERE rowid not in
(SELECT MIN(rowid)
FROM your_table
GROUP BY column1, column2, column3);
"
15306,Sql select order by other table,"SELECT c.* 
  FROM contacts c 
  JOIN reply x 
    ON x.contactid = c.id 
  JOIN 
     ( SELECT MAX(id) max_id FROM reply GROUP BY contactid ) y 
    ON y.max_id = x.id 
 ORDER 
    BY x.id;
+----+--------+----------+----------+
| ID | userid | subject  | content  |
+----+--------+----------+----------+
|  2 |      1 | subject2 | subject2 |
|  1 |      1 | subject  | subject  |
+----+--------+----------+----------+
"
17563,Oracle create table using with clause,"CREATE TABLE t
AS 
WITH some_data AS ( 
   SELECT 1 as some_value 
   FROM dual

   UNION ALL 

   SELECT 2 
   FROM dual
) 
SELECT * 
FROM some_data
"
26888,SQL Server 2008 R2: Show the dates day into comma separated column,"select t1.cola, stuff((SELECT ',' + right(convert(varchar(5),t2.coldate,3),2)  from
test_t t2 where t2.cola = t1.cola FOR XML PATH('')),1,1,'') AS Dates_Day 
from test_t  t1
group by t1.cola
"
14843,SQL Result Set Merge,"select  

[AGENT],

[TRANSDATE], 

[RECIPT NO],

[CUSTOMER NAME],

[ORDER NO] ,

[TRANS NO] ,

QUANTITY, 

[AMOUNT COST],

Sum ( QUANTITY ) over () as [SUM OF QUANTITY] , 

Sum ( [AMOUNT COST] ) over () AS [SUM OF AMOUNT COST]


From [Customer] C 
"
10351,Using multiple subqueries in oracle 10g,"select *
from (select ticket_number, route_id 
      from ticket_header
      union 
      select ticket_number, route_id
      from ticket_detail
     ) t
where route_id > (select route_id from ticket_detail where id = 4)
"
12555,Advantages of explicitly writing an index,"SELECT * FROM msdb.dbo.sysjobs with (index = nc1)

SELECT * FROM msdb.dbo.sysjobs with (index = clust)

SELECT * FROM msdb.dbo.sysjobs 
"
21444,Getting Person having interests in more number of subjects - Sql Server,"select top 1 with ties p.Id, p.Name
from Subjects s
join Person p on s.PId = p.Id
group by p.Id, p.Name, 
order by count(*) desc
"
18040,SQL Server stored procedure: set with into variable," WITH CTE AS
 (
        SELECT [Val]...
 ) 
 SELECT @YourVar = SUM([Val]) 
 FROM CTE
"
25445,SQL rows to column,"SELECT      name, 
            SUM(CASE WHEN walk_to = 'Cafe' THEN 1 ELSE 0 END) Cafe,
            SUM(CASE WHEN walk_to = 'Arena' THEN 1 ELSE 0 END) Arena, 
            SUM(CASE WHEN walk_to = 'Outside' THEN 1 ELSE 0 END) Outside
FROM        walk
GROUP BY    name
"
22325,mysql can you run queries between databases,"<?php
$hostname = 'localhost';  //server       
$dbname   = 'myphp';   //database
$username = 'root';             //username
$password = '';                 //password
mysql_connect($hostname, $username, $password) or DIE('Connection to host is failed, perhaps the service is down!');
mysql_select_db($dbname) or DIE('Database name is not available!');
?>  
"
14575,Two simple COUNT columns without subqueries,"select d2f.id,
       sum(case when ft.name = 'PDF' then 1 else 0 end) as PDF_count,
       sum(case when ft.name = 'XML' then 1 else 0 end) as XML_count
from document2file d2f join
     file f
     on d2f.file_id = f.id join
     filetype ft
     on f.filetype_id = ft.id
group by d2f.id;
"
25971,Laravel 5.1 Filter query,"public function performSearch(Request $req) {

   //create a new query builder (true to ignore deleted)
   $query = Project::query();

   if($req->has('filterName')) {
      $query = $query->where('filterName','like','%'.$req->input('filterName').'%');
   }

   if($req->has('selectValue')) {
      $query = $query->where('project_status ','=',$req->input('selectValue'));
   }

   //execute
   $results = $query->get();
}
"
5041,Aggregate continuous ranges of dates,"SELECT min(reserved_date) AS start_date
     , max(reserved_date) AS end_date
FROM  (
   SELECT reserved_date
        , reserved_date - row_number() OVER (ORDER BY reserved_date)::int AS grp
   FROM   reserved_dates
   ) sub 
GROUP  BY grp
ORDER  BY grp;
"
2237,Sort by different columns,"SELECT * FROM (SELECT * FROM 
               categories ORDER BY 
               post_count DESC LIMIT 4) AS A
ORDER BY name 
"
33547,MYSQL INSERT INTO WITH SELECT not working?,"INSERT INTO `employer_data` 
(`employer_id`, `data`, `datetime`)  
( SELECT employer_id, employer_id AS data, NOW() AS `datetime` FROM employer ); 
"
14376,MAke New Table in SQL with same Schema,"create table W_UK as 
select *
  from W_US
 where 1 = 2;
"
36417,"Performing INNER JOIN, GROUP BY, and COUNT on Django models","from django.db.models import Count
User.objects.all().annotate(bids=Count('auctionbids')).order_by('bids')
"
35128,left join query does not return left table records if right table does not have records,"SELECT u.name, u.division,
       SUM(r.wins) as wins, SUM(r.losses) as losses
FROM users u LEFT JOIN
     results r
     ON u.user_id = r.user_id AND r.date BETWEEN {$startDate} AND {$endDate}
WHERE u.user_id = {$user_id}
GROUP BY u.user_id;
---------^
"
18517,How to print table columns to use in an INSERT query,"DECLARE @ColNames VARCHAR(1000) 
SELECT @ColNames = COALESCE(@ColNames+', ', '') + QUOTENAME('tableName.'+NAME,'[')
FROM SYS.COLUMNS
WHERE OBJECT_id = OBJECT_id('tableName')
SELECT @ColNames
"
2913,Extending tables in SQL,"ALTER TABLE table1 ADD field2 text;
UPDATE table1 SET field2='value';
"
31952,Update/Increment multiple MySQL columns in one query,"UPDATE `contacts` 
       SET `calls_to` = `calls_to`+1, 
             `cost_to` = `cost_to`+0.25 
  WHERE `contact_no`='0412345678' AND
          calls_to is not null AND
          cost_to is not null;
"
24994,SQLite date sorting problem,"SELECT Type, form_date FROM Table1
UNION SELECT Type, form_date FROM Table2
"
36908,select from table where has same value but group by their difference,"select * from table where ""IP"" in (select ""IP"" from table group by ""IP"" having max(starttime)-min(starttime)>2);
"
15352,Check a lot of colums for at least one 'true',"DECLARE  @T TABLE (
b1 bit
,b2 bit
,b3 bit
);

DECLARE @T2 TABLE (
b1 bit
,b2 bit
,b3 bit
,b4 bit
,b5 bit
);

INSERT INTO @T VALUES (0,0,0),(1,1,1);
INSERT INTO @T2 VALUES (0,0,0,0,0),(1,1,1,1,1);

SELECT CHECKSUM(*) FROM @T;
SELECT CHECKSUM(*) FROM @T2;
"
22115,PL\SQL select first row from column 1 where column 2 is unique,"SELECT MIN(d.ename) as ename
  FROM emp d
  GROUP BY d.deptno
  ORDER BY ename asc
"
1919,Evaluate sequential pairs of rows in SQLite,"SELECT user_id, MAX(event_date - prior_event_date)
  FROM (SELECT t.user_id, t.event_date, MAX(prior.event_date) AS prior_event_date
          FROM your_table AS t
               JOIN your_table AS prior ON (t.user_id=prior.user_id
                                            AND prior.event_date < t.event_date)
         GROUP BY t.user_id, t.event_date) AS events
 GROUP BY user_id;
"
3624,Update statement with self join in sybase,"Get the results you're after in a select.
SELECT EMP_ID, max(name), max(Dept), max(cat)
FROM tableName
GROUP BY EMPI_ID
"
6559,How to zero out all negative numbers in a group-by T-SQL statement,"SUM(CASE WHEN i.Quantity < 0 THEN 0 ELSE i.Quantity END)
"
32141,Select Grouped Column Values Where Have Same Id In SQL Server,"SELECT id, code
FROM table1 t
WHERE EXISTS (
    SELECT 1
    FROM table1 t2
    WHERE t.id = t2.id
        AND t2.Code = 'N188'
)
"
26028,"Unexpected result when using ""exists"", ""extractvalue"" and ""is not null""","SELECT count(*)
FROM (select '<A>1</A>' as data from dual),xmltable('A' passing xmltype(data) columns result varchar2(1028) path '.')
WHERE 
result is not null;
"
31413,How to trace out values from three different tables sql JOIN?,"SELECT  
    t1.*,  
    t2.Mainprice  
FROM table_1 AS t1  
LEFT JOIN table_3 AS t3  
   ON t1.securityno = t3.securityno AND t1.name = t3.name  
INNER JOIN table_2 AS t2  
   ON t2.identifier = t3.identifier  
"
24754,Full text search on PostgreSQL,"SELECT title, body FROM messages
  WHERE tsv @@ to_tsquery('english', 'title & body')
"
39044,MYSQL Query for top 10 users per location,"SELECT * FROM User WHERE User.Id = Cost_Center.Id ORDER By total_prints DESC LIMIT 10;
"
28947,"SQL - SELECT from a table if a certain condition is met, else SELECT from another","select p.client, 
       p.payment_code,
       case 
          when payment_code = 1 then t1.address
          else t2.address
       end as address,
       case 
          when payment_code = 1 then t1.phone
          else t2.phone
       end as phon
from payments_table p
   left join table_1 t1 on p.some_column = t1.some_column
   left join table_2 t2 on p.some_column = t2.come_column
"
531,How to select numeric value from nvarchar column in sql server?,"select * from ProductTbl where sno not like '%[^0-9]%'
"
39806,Getting All Records where Particular Column is empty in Access,"SELECT *
FROM TABLE
WHERE Nz(PARTICULARFIELD,'') = ''
"
35993,Get extension of a file using SQL?,"declare @str varchar(20)='MyDoc.doc';
select reverse(left(reverse(@str),charindex('.',reverse(@str))-1))
"
3969,Is there anyway to perform a Count() when using Min()?,"SELECT COUNT(*)
FROM
(
    select min(product_id) from products 
    where market_code = 'germany'
    group by product_code
) AS t;
"
7309,Update a single column based on multiple conditions in an expression,"UPDATE  outer, inner
SET    outer.ANSWER_DURATION = inner.ANSWER_DURATION
WHERE   inner.TEST_ITEM_EXT_ID=outer.TEST_ITEM_EXT_ID AND 
       inner.STUDENT_EXT_ID=outer.STUDENT_EXT_ID;
"
33690,sql query to get result with exclude selected id,"select * 
from wp_products 
where product_id <>'1' AND 
  (price<=200 OR wheel_size='6'  OR  studs='$studs') 
order by product_id DESC 
"
272,mysql grouping distinct query,"SELECT city,
  SUM(IF(subject='english',1,0)) AS English,
  SUM(IF(subject='math',1,0)) AS Math
FROM foo
GROUP BY city;
"
7664,"MySql Replace method with ""/"" in input string","SET whrClause =REPLACE(REPLACE(productType, "","" ,"" ',' ""),""/"" ,"" ',' "");
"
1823,Mysql - joins - too many rows are being returned - one for each of the joined table but dont want that,"select 
tbl_users.*, 
tbl_photos.filename 

from tbl_users 

left join tbl_photos on tbl_photos.user_id = tbl_users.id 

where tbl_users = approved order by rand() LIMIT 1
"
18748,Populate SQL Data,"SELECT SR_NO, CASE WHEN [Attribute -X] = 'A' THEN A ELSE NULL END AS 'A',
              CASE WHEN [Attribute -X] = 'B' THEN B ELSE NULL END AS 'B',
              CASE WHEN [Attribute -X] = 'C' THEN C ELSE NULL END AS 'C',
      [Attribute -Z] AS 'ATTR-Z'
FROM yourtable
"
6632,Invalid use of group function MySql,"SELECT E.*
FROM employeeRevenue RV join
     Employee E
     ON E.EmployeeID = RV.ID 
ORDER BY RV.Total DESC
LIMIT 1;
"
4629,Conditional join of table based on existence of value,"SELECT 
...
CxA.SubscriptionNumber
FROM
    MyTables
CROSS APPLY
    (SELECT CASE 
        WHEN (House of person has subscription)
        THEN (return subscription number of house)
        ELSE (return subscription number of person)
    END) CxA(SubscriptionNumber)
"
21452,Select into not working for stored proceedure,"`player_login` (
p_username TEXT CHARACTER SET utf8,
p_txtPassword TEXT CHARACTER SET utf8,
OUT p_playerID INTEGER,
OUT p_result INTEGER
)
BEGIN
DECLARE p_password TEXT DEFAULT player_hash_password(p_txtPassword);
DECLARE num INTEGER DEFAULT 0;
   SELECT p_PlayerID = playerID
    FROM players p
    WHERE (LOWER(p.PlayerName)=LOWER(p_username) OR  LOWER(p.PlayerEmail)=LOWER(p_username))
    AND p.PlayerPassword = p_password
    LIMIT 1;
.
"
13659,How to find what foreign key references an index on table,"Select
    f.name,
    object_name(f.parent_object_id)
From
    sys.foreign_keys f
        inner join
    sys.indexes i
        on f.referenced_object_id = i.object_id and
           f.key_index_id = i.index_id
Where
    i.name = 'idx_duplicate' and
    i.object_id = object_id('[dbo].[MyTable]')
"
14164,JOIN after processing SELECT,"select players.name, trials.player, trials.timestamp, trials.score from
    (select player, score, timestamp from
    trials order by score desc, timestamp asc limit 10) trials, players
where players.id = trials.player
"
39425,mysql set value to empty if specific field is not empty,"SELECT 
case 
when 
  subscription_new_projects.banner_link <> '' then '' 
  else subscription_new_projects.banners 
end as banners,  
subscription_new_projects.banner_link
FROM subscription_new_projects
WHERE be_famous_id =32
AND now( ) < end_date
ORDER BY subscription_new_projects_id DESC
"
21543,Oracle: Get data for only the past half year,"SELECT ... From ... WHERE date > add_months(sysdate, -6)
"
5362,T-SQL Derived Column in SELECT,"SELECT
INT_VALUE = CAST(NULL AS int)
,STR_VALUE = CAST(NULL as VARCHAR(10)) 
"
31245,Need To Pull Most Recent Record By Timestamp Per Unique ID,"SELECT latitude, longitude, unique_id
FROM table INNER JOIN
(SELECT unique_id, MAX(timestamp) AS timestamp
FROM table
GROUP BY unique_id)t2 ON table.timestamp = t2.timestamp
AND table.unique_id = t2.unique_id;
"
3576,SQL get latest by date than order by int value,"SELECT v.*
FROM (SELECT v.*
      FROM videos v
      ORDER BY v.date DESC
      LIMIT 20
     ) v
ORDER BY v.viewCount DESC ;
"
32092,Is there any way to retrieve both aggregated and non-aggregated values without subquery?,"select 
     Stock_code
    ,[1st week] = sum(case when [date] >= getDate()-7 then amount else 0 end)
    ,remainder = sum(amount)
from data
group by Stock_code
"
20943,Is this a legal SQL query?,"SELECT r.EventName, e.TotalSeats - SUM( r.NumSeats )
FROM Reservation r JOIN
     Event e
     ON e.Name = r.EventName
GROUP BY r.EventName, e.TotalSeats;
"
7274,"Combining ""SUMs"" with a similar value","SELECT NAME,
  SUM(CASE WHEN OrderType = 'Purchase' THEN `ORDER` ELSE 0 END) AS PURCHASE,
  SUM(CASE WHEN OrderType = 'Return' THEN `ORDER` ELSE 0 END) AS `RETURN`,       
  SUM(`Order`) AS Net
FROM Orders
GROUP BY NAME
"
16324,MySql: variable row max min query?,"SELECT max(high_price), min(low_price) FROM mytable WHERE stock_symbol = 'GOOG'
"
19112,"Sequel format for constants, functions calls in select?","DB[:T___t].select('0'.lit.as(:a), :t__x___c){sin(t__x).as(b)}
"
30511,"How to write a SQL statement to return all children of each root, flattening their depths?","WITH
  children
AS
(
  SELECT id, ParentID, name FROM treeTable

  UNION ALL

  SELECT
    treeTable.id, children.ParentID, treeTable.Name
  FROM
    children
  INNER JOIN
    treeTable
      ON treeTable.ParentID = children.ID
)
SELECT
  children.name,
  treeTable.ID    AS rootID
FROM
  treeTable
INNER JOIN
  children
    ON children.ParentID = treeTable.ID
WHERE
  treeTable.ParentID = 0
"
34454,SQL query select max min value from resultset query,"SELECT ID, AmountInCurrency, ExtractionDate,
       min(ExtractionDate) over () as MinExtractionDate,
       max(ExtractionDate) over () as MaxExtractionDate
FROM Table;
"
22903,Assign var for SQL-Statement with smarty (Prestashop),"{$sql = 'SELECT value FROM ps_feature_value_lang WHERE id_feature_value = 29 AND id_lang = '|cat:$id_lang}
"
6891,ASP.net MVC 3 changing the default edit boxes generated by controllers to a date time picker,"<input id=""demo2"" name=""LessonDate"" type=""text"" size=""25"">
"
39842,Sql query for searching values in the same table,"insert into table(languageId, languageItem)
    select 3, languageitem
    from table t
    where languageid = 2 and
          not exists (select 1
                      from table t3
                      where t3.languageid = 3 and t3.languageitem = t.langaugeitem
                     );
"
39655,SUM time in varchar/nvarchar data type field,"select convert(decimal(18, 2), convert(decimal(18, 2), ppt.hour) + convert(decimal(18, 2), convert(decimal(18, 2), ppt.minute/ 60)) + convert(decimal(18, 2), convert(decimal(18, 2), ppt.second / 3600))) AS Hours, ppt.[column] from (select SUM(convert(decimal(2),left([column], 2))) AS hour, SUM(convert(decimal(2), left(right([column], 5), 2))) AS minute, SUM(convert(decimal(2), right([column], 2))) AS second, [column] FROM [table] GROUP BY [column]) AS ppt
"
36592,Oracle SQL query for Date format,"select * 
from table
where trunc(es_date) = TO_DATE('27-APR-12','dd-MON-yy')
"
24974,Constraint for bit value in TSQL,"CREATE VIEW dbo.DefaultBarcode
WITH SCHEMABINDING
AS
    SELECT StockID, Barcode
    FROM dbo.Barcode
    WHERE IsDefault = 1
GO
CREATE UNIQUE CLUSTERED INDEX UC_DefaultBarcode ON dbo.DefaultBarcode (StockID)
GO
"
4260,TSQL - Use a Derived Select Column in the Where Clause,"select a,b,c FROM(
select a,b,c,
case 
  when a=1 then 5
  when a=2 then 6
end as d
from some_table
) AS t
where d=6
"
24808,Most efficient way to perform an SQL-Statement containing a max-aggregate in the sub-query,"select *
from 
 (
   SELECT cur.name, log.price, log.valid_at,
       RANK()
       OVER (PARTITION BY cur.id
             order by valid_at DESC) as rnk
   FROM currency cur
   JOIN exchange_rate_log log on (cur.id = log.currency_id)
   WHERE log.exchange_currency = ?
     AND log.valid_at < ?
) dt
where rnk = 1; 
"
2720,"SQL, Select if or select case","SELECT 
  CASE WHEN i_userkey = 1 THEN ID ELSE NULL END AS ID 
  CASE WHEN i_userkey = 1 THEN Gender ELSE NULL END AS Gender
  CASE WHEN i_userkey = 1 THEN AGE ELSE NULL END AS Age
FROM TableA
"
17717,Converting INT to Time,"DECLARE @t TABLE
(i INT, t VARCHAR(5))
INSERT @t (i,t)
VALUES (4680001,'13:00'),
(4680001,'13:00'),
(4596001,'12:45'),
(3846001,'10:41'),
(4320001,'12:00')

SELECT DATEADD(s,i/100,'19000101'), t
FROM @t
"
39863,Sub query for column name,"Select T1.Col1,T1.Col2,T2.Id,T2.Title
From Table1 T1
    cross apply  (Select top 1 Id, Title
                   From Table2
                   Where Ref=T1.Id
                   Order By Date Desc) AS T2
"
3084,Counting unique entries in access,"SELECT Stad, COUNT(*) as NumBiorafer, SUM(Salonger) as SumSalonger
FROM (SELECT Stad, Biografer.BiograferID, COUNT(*) AS Salonger
      FROM Biograf INNER JOIN
           Salong
           ON Salong.BiografID = Biograf.BiografID
      GROUP BY Stad, Biografer.BiograferID
     ) as sb
GROUP BY Stad;
"
21404,Return null or zero when no value is found,"SELECT @t2.id, @t1.name from @t2 LEFT OUTER JOIN @t1 ON @t1.ID = @t2.ID
"
34403,"SQL counterpart for the ""IN"" clause","SELECT yourColumn
FROM   tableName
WHERE  otherColumn IN ('a','b','c')
GROUP  BY yourColumn
HAVING COUNT(*) = 3    -- <== the number of values in the WHERE clause
"
24348,SQL need advice with substring and charindex,"DECLARE @String VARCHAR(100) = 'Custom Code changed from (JA) to (JC)' 

SELECT SUBSTRING(@String, CHARINDEX('(', @String + '(') + 1,CHARINDEX(')', @String + '()') - CHARINDEX('(', @String + '(') - 1) as 'first',  
      REVERSE(SUBSTRING(REVERSE(@String), CHARINDEX(')', REVERSE(@String) + '(') + 1, CHARINDEX('(', REVERSE(@String) + ')(') - CHARINDEX(')', REVERSE(@String) + ')') - 1)) as 'Second'
"
20156,Aggregate Query returning multiple records,";with cte as
(
  select recordid,
    itemid,
    configid,
    status,
    statusdate,
    row_number() over(partition by itemid, configid
                        order by statusdate desc) rn
  from yourtable
)
select *
from cte
where rn = 1
order by recordid
"
38893,How to retrieve first line in a row?,"SELECT SUBSTRING_INDEX(MyData, '\n', 1) FROM MyTable
"
29310,How to filter rows from an ordered table?,"SELECT id, name, MAX(points)
FROM your_table
GROUP BY id, name
ORDER BY points desc
"
13966,select different Max ID's for different customer,"SELECT t.*
FROM (SELECT t.*, MAX(LOADID) OVER (PARTITION BY Customer) as maxLOADID
      FROM MyTable t
     ) t
WHERE LOADID = maxLOADID;
"
21856,SQL Query for amount of products sold within dates?,"SELECT op.op_products_name, op.op_products_id, SUM(op.op_products_qty) AS TotalSold
FROM orders_products op JOIN
     orders o
     ON op.op_order_id = o.orders_id
WHERE o.orders_date_purchased BETWEEN '2012-11-05 00:00:00' AND '2012-11-10 00:00:00'
GROUP BY op.op_products_id
ORDER BY TotalSold DESC;
"
30256,Insert Statement Based on Select Statement with Multiple Columns,"INSERT INTO dbo.StudentProject 
SELECT StudentID, ProjectID 
FROM dbo.StudentProjectSimulation
WHERE SimulationID = 1
"
13524,Add where clause to count and not entire query without using subquery,"select sum(case when o.opendate is not null and o.orderdate is not null and o.closedate is null and o.canceldate is null
             then 1 else 0
        end) as OrderCount
"
30066,Joining MANY to MANY with Junction Table,"select s.code, s.name, s.description, s.yrLevel
from subject s
inner join curriculumsubject cs on s.code = cs.subjectCode
inner join curriculum c on cs.curriculumId = c.ID
where c.name = p_CurcName and c.yearLevel = p_yrLevel
"
8371,Selecting columns as rows,"SELECT 'Nett' AS [Desc], SUM(PriceN) AS Value FROM Resources
UNION ALL
SELECT 'Gross' AS [Desc], SUM(PriceG) AS Value FROM Resources
"
33973,Delete equal data from two tables in SQL Server,"SELECT * INTO newA FROM a
EXCEPT
SELECT * FROM b
;

SELECT * INTO newB FROM b
EXCEPT
SELECT * FROM a
;
"
17846,how to Retrieve an Image from SQLite DB?,"ImageView myImage = (ImageView) findViewById(R.id.myImage);

byte[] bb = cursor.getBlob(cursor.getColumnIndex(MyBaseColumn.MyTable.ImageField));

myImage.setImageBitmap(BitmapFactory.decodeByteArray(bb, 0, bb.length));
"
33682,Strange window function behaviour,"select 
player
,avg(case when day BETWEEN '02-01-2014' AND '02-03-2014' then score else null end) as period_1_score
,avg(case when day BETWEEN '02-04-2014' AND '02-06-2014' then score else null end) as period_1_score
from <your data>
group by player
"
27307,Postgresql method for finding the slope of a line and forcing through origin,"SELECT 
  sum(y*x) / sum(x*x) as slope
FROM findslope INTO slope_variable
"
12894,Pick recent modified date in the table,"select B1.[ID], B1.[AppName], B2.[DepCode], B1.[DepName], B1.[Group], 
    B2.ModifiedDate, B2.YearlyAmount, B2.MonthlyAmount, 
    B1.[Funded], B1.[AppCategory], B1.[Research]
FROM Business B1
INNER JOIN
    (select [ID], DepCode, MAX(ModifiedDate) as ModifiedDate, SUM(YearlyAmount) as YearlyAmount,
        SUM(MonthlyAmount) as MonthlyAmount 
    from Business
    Group by ID, DepCode) B2
ON B1.ID = B2.ID AND B1.ModifiedDate = B2.ModifiedDate 
"
17871,SQL join including all rows from one table irrespective of how many are represented in the other table,"SELECT 
  TableA.BU, 
  TableB.count_invalid_date 
FROM 
  TableA 
  LEFT JOIN TableB ON TableA.BU = TableB.BU and TableB.Month = 8 
GROUP BY 
  TableA.BU, 
  TableB.count_invalid_date;
"
17018,Retrieving the latest record from a Table (Oracle SQLPlus),"select *
from (
  SELECT UserID, 
         ThreadId, 
         PostTime,
         ThreadType,
         Topic, 
         Detail,
         row_number() over (partition by userid order by posttime desc) as rn
  FROM Thread  
) t
where rn = 1
order by userid;
"
16910,REMAP_DATA functionality from DBMS_DATAPUMP,"DBMS_DATAPUMP.DATA_REMAP(
   handle          IN NUMBER,
   name            IN VARCHAR2,
   table_name      IN VARCHAR2,
   column          IN VARCHAR2,
   remap_function  IN VARCHAR2),
   schema          IN VARCHAR2 DEFAULT NULL);
"
8048,LIKEs and ORs and stuff in Linq,"var users = from a in dc.Users
        where a.PolicyNumber == PNum 
              || (a.FirstName.StartsWith(first) && a.LastName.StartsWith(last))
        orderby a.PolicyNumber, a.FirstName
        select a;
"
23565,How do I find similar names from database?,"CREATE TABLE company_names (
    company_name VARCHAR(35) PRIMARY KEY
);

INSERT INTO company_names VALUES ('Microsoft');
INSERT INTO company_names VALUES ('Microcode');
INSERT INTO company_names VALUES ('TrendMicro');
INSERT INTO company_names VALUES ('Microphones, Inc.');
INSERT INTO company_names VALUES ('Softonic');
INSERT INTO company_names VALUES ('Soft Touch Cleaning');
INSERT INTO company_names VALUES ('Software Systems');
INSERT INTO company_names VALUES ('SoftTouch Movers');
"
19800,Oracle: get part string from a string,"select col1
     , regexp_substr(col1, '^[^;]') as part1
     , replace(regexp_substr(col1, ';[^;]+;'), ';') as part2
     , replace(regext_substr(col1, ';[^;]+$'), ';') as part3
"
5474,"Exists, or Within","SELECT personTbl.*
  FROM personTbl
  LEFT
 OUTER
  JOIN ( SELECT DISTINCT filterValue
           FROM filterTable
          WHERE filterType = 'name'
       ) filter
    ON 1 = 1
 WHERE filter.filterValue = personTbl.name
    OR filter.filterValue IS NULL
;
"
26251,SQL - Multiple Group By statements with counts,"select t.A
from mytable as t
group by t.A
having min(t.B) = max(t.B);
"
6689,Insert into with two selects from the same table,"INSERT INTO table2
SELECT t1.id, t1.name, t1.description, t1.path, t2.id, t2.path, t1.country, t1.status
  FROM table1 t1 JOIN table1 t2
    ON t1.id = $currentId AND t2.id = $newId
"
21766,get the earliest date from several tables,"SELECT least(gps.time,
       cadence.added_on,
       `heart-rate`.added_on)
FROM   gps
       JOIN cadence
         ON cadence.rider_id = gps.rider_id
       JOIN `heart-rate`
         ON `heart-rate`.rider_id = gps.rider_id
ORDER  BY least(gps.time,
          cadence.added_on,
          `heart-rate`.added_on)
LIMIT 1
"
33187,ORDER BY # of rows with same option ID from different table,"SELECT
    options.optid as id,
    options.value as value,
    options.vid as voteid,
    (
        SELECT COUNT(*)
        FROM vote_votes votes
        WHERE votes.optid = options.optid
    ) as votes
FROM vote_options options
WHERE options.vid = {$vote['vid']}
ORDER BY votes DESC;
"
20365,Access VBA SQL string too long,"SELECT Ordre.Ordre, Sum(Ordre.Duree) AS SommeDeDuree 
FROM Ordre 
WHERE Ordre.Date >= #07/11/2011# 
  AND Ordre.Date <= #14/11/2011# 
  AND Ordre.Matricule In (257,516,591,...,2436,2471) 
  AND Ordre.Ordre Not In (10000477, 11146074, ... ,13101309,13212576)
GROUP BY Ordre.Ordre;
"
5115,Adding Year and Month to a group by sql query,"SELECT Year(yourDateColumn) AS 'Year', Month(yourDateColumn) AS 'Month', C.Name, COUNT(DISTINCT D.Id)  
from DriverLic D 
    INNER JOIN Clov C WITH (NOLOCK) ON D.CId = C.CId 
--WHERE your where conditions should go here...
GROUP BY 
    Year(yourDateColumn), Month(yourDateColumn), C.Name
"
6655,How to delete duplicate records from a table in oracle,"delete from ap
    where ap.id > (select min(ap2.id) from ap ap2 where ap2.name = ap.name)
"
2457,Get list of last record for each ID in SQL,"SELECT *
FROM MyTable t
WHERE NOT EXISTS (
    SELECT * FROM MyTable tt WHERE tt.id_foreign=t.id_foreign AND tt.id > t.id
)
"
39064,Combine two select,"SELECT type, COUNT(NumFact) AS Num
FROM test
WHERE type IN ('A','B')
GROUP BY type;
"
5033,Left outer join on two columns performance issue,"SELECT col1, col2
FROM table1, table2
WHERE table1.person_uid = table2.person_uid (+)
AND table1.period = table2.period (+)
"
30278,Can I set a 'conditional' default value in mysql?,"if (empty($img_path)) 
   $img_path = ($isActive)?'active.png':'solico.png';
"
34812,Ormlite inner join on three tables,"// start the order header query
QueryBuilder<OrderHeader, Integer> orderHeaderQb = orderHeaderDao.queryBuilder();
QueryBuilder<Customer, Integer> customerQb = customerDao.queryBuilder();
// join with the order query
orderHeaderQb.join(customerQb);
// start the order statement query
QueryBuilder<OrderStatement, Integer> orderStatementQb =
    orderStatementDao.queryBuilder();
orderStatementQb.where().gt(""mixedvalue"", 100);
// join with the order-header query
orderStatementQb.join(orderHeaderQb);
List<OrderStatement> orderStatementQb.query();
"
24373,Addressing ORACLE_HOME values diversity,"C:\oracle_python\instantclient_11_2
C:\oracle\32bit\product\11.2.0\client_1\bin
C:\oracle\product\11.2.0\client_1\bin
"
11387,rows to columns of multiple rows,"SELECT *
FROM
(
  SELECT Emp_id, Dept_id, 'Column' + CAST(RowNum AS VARCHAR(10)) AS ColumnName
  FROM
  (
      SELECT Emp_id, 
             Dept_id, 
             ROW_NUMBER() OVER(PARTITION BY Dept_id ORDER BY Emp_id) AS RowNum  
      FROM myTable
  ) AS mainTable
)d
PIVOT
(
  MAX(Emp_id)
  FOR ColumnName IN ([Column1],[Column2],[Column3])
) piv
"
1341,How to write a query using self join on a table with huge data?,"SELECT
  Customers.CustID,
  MAX(CASE WHEN CF.FieldID = 1 THEN CF.FieldValue ELSE NULL END) AS Field1,
  MAX(CASE WHEN CF.FieldID = 2 THEN CF.FieldValue ELSE NULL END) AS Field2,
  MAX(CASE WHEN CF.FieldID = 3 THEN CF.FieldValue ELSE NULL END) AS Field3,
  MAX(CASE WHEN CF.FieldID = 4 THEN CF.FieldValue ELSE NULL END) AS Field4
  -- Add more...

  FROM Customers 

  LEFT OUTER JOIN CustomFields CF
  ON CF.ID = Customers.CustID

  WHERE Customers.CustName like 'C%'

  GROUP BY Customers.CustID
"
24583,Retrieve Exclusive records from two tables in SQL Server 2008,"SELECT  a.*
FROM    Table1 a
        LEFT JOIN Table2 b
            ON a.EmployeeID = b.EmployeeID
WHERE   b.EmployeeID IS NULL
"
18328,Calculate the difference between results of two count(*) queries based on 2 tables in PostgreSQL,"select
(SELECT ""count""(*) as val1 from tab1) - (SELECT ""count""(*) as val2 from tab2)
"
21407,Finding an average SQL,"Select Company.company_id, company.Company_Name, avg(UserJobRating.Total_Rating)
from company
  inner join jobs on jobs.Company_id = company.company_id
  inner join UserJobRating on jobs.Job_id = UserJobRating.Job_ID
group by company.company_id
"
2323,Always Get 1 record from Table 2 based on some condition,"select * from Products p
join (select *, row_number()  
                 over(partition by ProductID order by ID) rn from ProductImages)pi 
      on p.ProductID = pi.ProductID and pi.rn = 1
"
26489,How to retrieve the student information from the table?,"select S.name, T.name, SS.name, P.fathername, P.mothername 
from student S, teacher T, sports SS, parents P,student_teacher ST, student_sports SSP 
where S.id = ST.stud_id and T.id = ST.teacher_id and
S.id = SSP.stud_id and SS.id = SSP.sports_id and
S.id = P.stud_id
"
30704,What is the best way to rewrite this query,"SELECT    [ProductType], 
          SUM(total) 
FROM      isss
GROUP BY  [ProductType]
"
26629,"Table(s) design for Stock Holding Adjustment table, 2 tables or 1?","IsLocate as (case when locates is not null then 'Y' else 'N' end),
IsAdjustment as (case when shares is not null then 'Y' else 'N' end),
"
36872,Oracle Create View issue,"GRANT SELECT ON user2.table TO user1
"
7608,"SmallInt vs Date in MySQL - Performance, Flexibility and Size","WHERE t.product_id = 195 AND t.week_id >= 27 AND t.week_id < 40
"
25787,select number of times result of one query occurs in another table,"SELECT     Customer, COUNT(*) AS Orders 
FROM         ORDERS  RIGHT OUTER JOIN
                      USERS ON USERS.User_Id = ORDERS.Customer
GROUP BY USERS.User_Id
ORDER BY COUNT(*) DESC
"
29925,Database Theory: Transaction serializability,"w1[x] w1[y] w1[z] c1   w2[x] w2[y] c2    w3[x] w3[y] c3
"
16638,mysql inner join to relate all tuples,"SELECT DISTINCT m.movie_id
FROM Copy m
WHERE NOT EXISTS
  (SELECT 1 FROM Copy c
  WHERE c.movie_id = m.movie_id
  AND NOT EXISTS
    (SELECT 1 FROM Rented r
    WHERE r.copy_id = c.copy_id
    AND returndate IS NULL)
"
16672,PSQL: sum doesn't work on fields,"SELECT
partnername,
rolename,
Num_verifications,
partner_price,
partner_price*Num_verifications
FROM
  (SELECT 
   partners.name as partnername, 
   roles.name as rolename, 
   (SELECT count(*) FROM partner_member_bindings WHERE roles.id = partner_member_bindings.role_id AND verify_status != 'pending') AS Num_verifications,
   CAST(roles.price_partner / 100 AS money) AS partner_price
   FROM partners
   JOIN roles ON roles.partner_id = partners.id) temp
ORDER BY partners.name, roles.name
"
9784,Having questions as field name in database design,"SELECT NOW() 'What time is it?',
       t.weatherNice 'Is the weather nice?'
  FROM table t
"
29221,How to avoid groups but require a minimum count?,"SELECT * from Table1 T1
JOIN
(
  SELECT date, project
  from table1
  group by date, project
  having count(*) >1
) t
on t1.date = t.date
and t1.project = t.project
"
13459,Table with multiple columns containing employee keys. How to link to employee master to get names?,"SELECT A.Col1
     , A.BOEmpID
     , BO.EmpName
     , A.AdminEmpID
     , AD.EmpName
     , <....>
FROM MyTable A
INNER JOIN Employees BO
        ON A.BOEmpID = BO.EmpID
INNER JOIN Employees AD
        ON A.AdminEmpID = AD.EmpID
"
220,Sql table where row may only be inserted if unique column,"CREATE TABLE family_house (
  house VARCHAR(128) NOT NULL UNIQUE,
  family VARCHAR(64) NOT NULL,
  PRIMARY KEY (house, family)
);

CREATE TABLE residents (
  person VARCHAR(64),
  house VARCHAR(128),
  family VARCHAR(64),
  UNIQUE (person, house, family),
  FOREIGN KEY (house, family) REFERENCES family_house
);
"
13983,Cakephp virtual field if this column empty use this column,"public $virtualFields = array(
'customer' => ""IF(Contact.company IS NULL OR Contact.company = '', CONCAT(Contact.first_name, ' ', Contact.last_name, ' ', Contact.company), Contact.company)""
);
"
21016,Getting Last Day of Previous Month in Oracle Function,"SELECT LAST_DAY(ADD_MONTHS(yourdate,-1))
"
8903,returning table name with columns when queried,"select u.id as ""u.id"", 
       u.name as ""u.name"",
       u.email as ""u.email"",
       f.id as ""f.id"",
       f.name as ""f.name""
FROM users u LEFT OUTER JOIN favorites f ON u.id = f.userID
"
38536,How to create multiple rows (as date column) into CTE? (out of thin air),";with dates(value) as
(
    select DATEADD(d, -548, cast(getdate() as DATE))
    union all
    select DATEADD(D, 1, value)
    from dates
    where DATEADD(D, 1, value) <= cast(getdate() as DATE)
)
select *
from dates
order by value desc
OPTION (MAXRECURSION 1000)
"
34315,UPDATE with SUM() in MySQL,"DELIMITER $$

CREATE FUNCTION `fn_get_sum`(_id INT) RETURNS int(11)
READS SQL DATA
BEGIN
      DECLARE r INT;
      SELECT  SUM(s_val)
      INTO    r
      FROM    table_name
      WHERE   id = _id;
      RETURN r;
END $$

DELIMITER ;

UPDATE  table_name
SET     par = fn_get_sum(id)
"
15152,MySQL DELETE query with conditions,"DELETE FROM people
WHERE EXISTS (
    SELECT *
    FROM people p2
    WHERE people.firstName = p2.firstName AND people.lastName = p2.lastName
    GROUP BY firstName, lastName
    HAVING COUNT(*)>1
)
AND deleted = 1 -- True
"
18202,"Can i set ""Any"" for bind param in perl (Oracle's SQL)","select * from cust where cust_no = nvl(?, cust_no);
"
7064,How to Display and Count multiple columns in SQL-2,"create table AppleGrape(A int, B int)

go
insert into AppleGrape values(1,1)
insert into AppleGrape values(1,1)
insert into AppleGrape values(1,NULL)

SELECT sum(A) as 'Apple',sum(isnull(B,0)) as 'Grape'
FROM AppleGrape
"
3627,Sorting within groups,"SELECT t1.* 
FROM tbl t1
JOIN ( SELECT SubjectID
            , MAX(lastUpdatedDate) AS lastUpdatedDate
       FROM tbl 
       GROUP BY SubjectID ) t2 ON t1.SubjectID =  t2.SubjectID
                              AND t1.lastUpdatedDate =  t2.lastUpdatedDate
"
17610,Can I create a view that will query a table from another sql server on another server but same domain,"SELECT * FROM ""linkedserver"".dbo.aTable
"
8334,SQL Joining two tables against multiple columns,"select t1.*, t2a.time. t2b.time, t2c.time, t2d.time
from t1 left join
     t2 t2a
     on t1.ab1 = t2a.type left join
     t2 t2b
     on t1.ab2 = t2b.type left join
     t2 t2c
     on t1.ab3 = t2c.type left join
     t2 t2d
     on t1.ab4 = t2d.type ;
"
13723,Consolidate 2 tables via a mapping table - Full Joins?,"select a.ID as A_ID, a.Desc as A_Desc, b.ID as B_ID, b.Desc as B_DESC
from Table_A as a left outer join Mapping_Table as m on a.ID = m.A_ID
full outer join Table_B as b on m.B_ID = b.ID
"
35939,Conditional insert in SqlServer Compact Edition,"INSERT INTO CUSTQUOTE (QTE_ID) 
SELECT 1
FROM JOB WHERE JOB_NUMBER = 'EW090800345'
"
19480,how to update hierarchical query with leaf node =1,"UPDATE CUSTOMER SET CLASS='SHIP-TO' 
WHERE cust_id in 
(SELECT cust_id 
FROM CUSTOMER
     CONNECT_BY_ISLEAF=1 
     START WITH id = 12660 CONNECT BY PRIOR cust_id = cust_cust_id)
"
39410,Is this table 4NF?,"POST   TAG
a       A
b       A
a       B
b       B
c       B
d       B


FILE   TAG
1       a
2       a
3       a
4       b
1       b
1       c
1       d
"
26726,SQL Naming Convention for ID that joins two tables,"create table Profiles (
    ProfileId int . . 
);

create table ProfileImages (
    ProfileImageId int . . .,
    ProfileId int references Profiles(ProfileId),
    ImageId int references Images(ImageId)
);

create table Images (
    ImageId int . . .,
    . . .
);
"
12667,Where Statement w/ Distinct,"select t.AccountId, t.BillingEmail
from (select t.*, count(*) over (partition by BillingEmail) as cnt
      from t
     ) t
where cnt = 1
"
6265,Row locks - manually using them,"BEGIN TRANSACTION

-- Find the next available record that's not already being processed.
-- The combination of UPDLOCK and READPAST hints makes sure 2 processes don't 
-- grab the same record, and that processes don't block each other.
SELECT TOP 1 @ID = ID
FROM YourTable WITH (UPDLOCK, READPAST)
WHERE BeingProcessed = 0

-- If we've found a record, set it's status to ""being processed""
IF (@ID IS NOT NULL)
    UPDATE YourTable SET BeingProcessed = 1 WHERE ID = @ID

COMMIT TRANSACTION

-- Finally return the record we've picked up
IF (@ID IS NOT NULL)
    SELECT * FROM YourTable WHERE ID = @ID
"
39440,Extracting year and month from one column and insert it into another,"UPDATE Act
   SET `year` = YEAR(`act_date`)
     , `month` = MONTH(`act_date`);
"
31792,SQL: Is there a way to get the average number of characters for a field?,"SELECT AVG(DATALENGTH(yourtextfield)) AS TEXTFieldSize
"
12548,Sql conditional insert or update in vb.net,"create procedure payAdmission
@admissionnumber int, 
@amountpaid money
as
if exists( select * from admissions where admissionnumber = @admissionnumber)
begin 
    update admissions set amount = amount + @amountpaid 
           where admissionnumber = @admissionnumber 
end 
else 
begin 
    insert into admissions( admissionnumber, amount ) 
         values (@admissionnumber, @amountpaid )
end
"
16871,"How to check, if a value is an integer with plpgsql?","SELECT  current_setting('myvar.user') ~ '^[0-9]+$'
"
35276,Use count of unrelated table in SQL query,"select skill.name, 
       IFNULL(Round(((SUM(ROUND((student_skills.value/skill.value)*100,0)))/(select COUNT(*) from user)),0),0) as successRate 
from skill 
left JOIN student_skills on skill.id = student_skills.skill_id 
group by skill.name
"
1251,Merging tables with duplicate data,"select a.id, b.id, ISNULL(a.fid,b.fid) fid, ISNULL(a.type,b.type) type
from
    (select *, ROW_NUMBER() over (partition by type order by id) rn from a ) a
        full outer join
    (select *, ROW_NUMBER() over (partition by type order by id) rn from b ) b
        on a.rn=b.rn
        and a.type = b.type
order by a.id       
"
19503,Generating Random Numbers for Rows without Them,"begin tran
update DestinationComparisons
set Password = cast(left(cast(ABS(checksum(newid())) as varchar),4) as int)
where Password = '' or Password is null
commit tran
"
1181,SQL Complex Search Query With Multiple Value,"DECLARE @style VARCHAR(MAX) = 'value1|value2|value3'
DECLARE @v XML 
SET @v = '<r><n>' + REPLACE(@style, '|', '</n><n>') + '</n></r>'

SELECT * FROM mytable
OUTER APPLY 
(
    SELECT c.value('text()[1]', 'varchar(50)') AS v FROM @v.nodes('//n') AS t(c)
) t
WHERE style LIKE '%' + t.v + '%'
"
19779,How to write select query for column with XML as Datatype in DB2?,"Select XMLSERIALIZE(tab.EXTENSION_XML  as BLOB(1M))  from TABLE tab;
"
36175,Add auto-incrementing column in temporary Common Table Expression,"select col, row_number() over ( order by col ) as id
  from temp
"
5993,MySQL - Most efficient way to select today's date with time as 00:00:00,"SELECT *
FROM   TableName
WHERE  dateColumn = CURDATE() 
"
22118,How to perform Oracle sql order by with captial case string,"select city_name
from city
order by (case when city_name=upper(city_name) then 2 else 1 end),
         city_name;
"
31833,SQLite queries much slower using JDBC than in Firefox SqliteManager plugin,"... JOIN Leagues l1 INDEXED BY MyThreeColumnIndex ON ...
"
34943,Reusing part of already selected SQL query result - aka do not repeat itself,"with cte as (
SELECT Product.ID, Product.No 
FROM Product WITH(NOLOCK)
WHERE Product.Type = 1
)
SELECT ID
FROM cte
WHERE No = '123456789'

UNION

SELECT Description.ID
FROM Description WITH(NOLOCK)
WHERE Description.Opis LIKE '%hello%'
  AND Description.ID IN (SELECT ID from cte)
"
28399,How to split a column into multiple values,"SELECT SUBSTRING([VALUE],1,3) AS val1,
       SUBSTRING([VALUE],5,3) AS val2, 
       SUBSTRING([VALUE],9,3) AS val3
  FROM TABLE1
"
15701,Help with simple SQL Query,"SELECT a.id, b.locale, b.name_in_lang, a.name
FROM TableA a
LEFT OUTER JOIN TableB b ON a.id = b.id
UNION
SELECT a.id, '' AS locale, '' AS name_in_lang, a.name
FROM Table a
"
29004,Conditional value replacement in SQL Server,"SELECT CASE YourCol
         WHEN 0 THEN 'Hello'
         WHEN 1 THEN 'Bye'
       END AS SomeAlias
FROM   YourTable  
"
30709,trying to test that a field <> value with null values in mysql,"WHERE field <> 'deactivated' OR field IS NULL
"
31552,Help with a SQL Query,"select ID, sum(Count)
from foo
where [DateTime] between @beginning and @end
group by ID;
"
23104,Combining two nested SELECT with DISTINCT?,"SELECT Kontonr , Name FROM Geldkonto
WHERE Kontonr in (SELECT DISTINCT Ursprungskonto FROM Beleg
WHERE YEAR ( Valuta ) = 2016)
"
25098,How can I select tags from MySQL sorted by creation_date and name but remove duplicate name?,"SELECT name, MAX(created_at) FROM yourTable GROUP BY name ORDER BY MAX(created_at) DESC
"
39556,sql: how to improve this statment,"1    #result = select max(DM_ID) from DEVICE_MONITOR where HARDWARE_ID=#value#

2    select * from  DEVICE_MONITOR DM where DM.DM_ID = #result
"
39659,Perl DBI one connection from different objects: problems,"sub DESTROY {
    my ($self) = @_;
    $self->{dbh}->disconnect;
}
"
35147,Update command fails. Can someone check my query?,"UPDATE custTab a INNER JOIN zipTab b ON
        a.cust_city = b.city AND
        a.cust_state = b.state
SET a.cust_zip = b.zip
WHERE a.cust_zip IS NULL
"
4707,How can I query a list of values into a column of rows using SQLite?,"SELECT 'john' AS name
UNION ALL SELECT 'mary' 
UNION ALL SELECT 'paul';
"
2162,Summerizing a table in SAS,"data temp(index=(comp=(card_number package_sk)));
set click_summ(where=(^missing(e_1st_click_dt)));
keep card_number package_sk e_1st_click_dt;
run;

data summary(drop=new_date) ;
set summary;
set temp(rename=(e_1st_click_dt= new_date) in=a) key=comp;
if a then do;
   e_1st_click_dt = min(e_1st_click_dt,new_date);
end;
else
   _ERROR_ = 0; /*No need for IORC errors*/
run;
"
35575,writing sql query,"SELECT * from room
WHERE (roomNo, hotelNo) not in
( select roomNo, hotelNo
  from booking
  where datefrom between '2012-05-01' and '2012-11-01'
  or dateto between '2012-05-01' and '2012-11-01'
)
"
9428,SQL: Make colors from color-table searchable,"select *
from cards_data where id in
(
  select cards_id
  from con_cards_colors
  group by cards_id
  having count(case when colors_id in (select id from colors where name in ('Red','Blue')) then 1 end) = 2 -- i.e. find all
  and count(*) = 2 -- i.e. find only those and no others
);
"
27378,How to convert string to integer - weird format,"SELECT CAST((columnName * 100) as INTEGER) NewValue
FROM TableName;
"
22962,oracle - getting 1 or 0 records based on the number of occurrences of a non-unique field,"select n_rec, my_field
from (select n_rec, my_field
        , count(*) over (partition by my_field) as Counter
    from myTable
    where my_field = ?)
where Counter = 1
"
34427,Is it possible to turn a float value into a datetime value?,"select cast(cast(year as varchar(255)) + '0101' as datetime)
"
30744,Concatentate all rows / alt. find using a regex across all rows,"SELECT GROUP_CONCAT( value  )
FROM   tableName
"
20930,How to select distinct pairs in MySQL join (same table) with transitivity?,"SELECT   MIN(a.ID) a, b.ID b
FROM     mytable a JOIN mytable b ON b.text = a.text AND b.ID > a.ID
GROUP BY b.ID
"
30925,Not sure if I should use a cursor in Microsoft SQL Server 2008 R2,";WITH cte AS (SELECT *,COUNT(MOID) OVER(PARTITION BY MOID) MOID_CT
              FROM MOSTEP)
SELECT MOID
      ,CASE WHEN MOID_CT = 1 THEN 'Something' ELSE 'SomethingElse' END
FROM cte
"
16937,MySQL: Update multiple columns if their value equals to,"UPDATE my_table
SET    v0 = CASE v0 WHEN 3 THEN 0 ELSE v0 END,
       v1 = CASE v1 WHEN 3 THEN 0 ELSE v1 END,
       v2 = CASE v2 WHEN 3 THEN 0 ELSE v2 END,
       v3 = CASE v3 WHEN 3 THEN 0 ELSE v3 END
WHERE  3 IN (v0, v1, v2, v3)
"
24366,MySql Join a View Table as a Boolean,"SELECT Users.User_ID,Name,Age, View_Table.User_ID IS NOT NULL AS In_View
FROM Users 
LEFT JOIN View_table USING (User_ID)
WHERE User_ID = 555
"
31485,Select two counts in one query,"select sum(case when user = 'x' then 1 end) UserCount, sum(case when email = 'x' then 1 end) EmailCount
from users
"
39714,Exec sproc from Powershell,"$conn = 'Data Source=.\SQLEXPRESS;Initial Catalog=pubs;Integrated Security=SSPI'
$ds = Invoke-AdoCommand -ProviderName SqlClient -ConnectionString $conn `
          -CommandText 'Select * from Authors' -AsDataSet
$ds.Tables


au_id    : 172-32-1176
au_lname : White
au_fname : Johnson
phone    : 408 496-7223
address  : 10932 Bigge Rd.
city     : Menlo Park
state    : CA
zip      : 94025
contract : True

...
"
24739,Update statement containing aggregate not working in SQL server,"UPDATE e
SET    ADMITTED = (SELECT max(IAR_ServiceDate)
                   FROM   ansicache..x_refClaim_table x
                   WHERE  e.ENCOUNTER = x.PatAcctNumber)
FROM   ansicache..ENCOUNTERS e 
"
11746,How to pick the 1 st and last element of each group in a table during group by operation in SQL,"select s.DateAdded, s.Souring, s.Inake, s.placement, s.PreviousSunday, CONCAT(s.DateAdded, ' => ', e.DateEnd) as DateStartEnd
from table_name as s 
inner join (select MAX(DateAdded) as DateEnd, PreviousSunday from table_name group by PreviousSunday) as e on s.PreviousSunday = e.PreviousSunday
group by e.DateEnd
order by s.DateAdded
"
16726,Getting non repeating values (Oracle),"SELECT 'Data'
||','||LTRIM(TO_CHAR(TRUNC(CREATE_TIME),'MM/dd/yyyy'))
||','||LTRIM(TO_CHAR(TRUNC(MAX(CLOSE_TIME)),'MM/dd/yyyy'))
||','||COUNT(TICKETS_CLOSED)
FROM APP_ACCOUNT.OTRS_TICKET
WHERE CREATE_TIME BETWEEN SYSDATE -7 AND SYSDATE
AND CLOSE_TIME BETWEEN SYSDATE -7 AND SYSDATE
GROUP BY TRUNC(CREATE_TIME)
ORDER BY TRUNC(CREATE_TIME)
"
26375,Join tables from multiple sources,"select c.id, c.name, c.cost, 'job assign' as assign_source
  from course c
  join job_assignment ja
    on ja.course_id = c.id
  join employee emp
    on emp.job_id = ja.id
 where emp.name = 'Bob'
union all
select c.id, c.name, c.cost, 'pers assign' as assign_source
  from course c
  join personal_assignment pa
    on pa.course_id = c.id
  join employee emp
    on emp.job_id = pa.id
 where emp.name = 'Bob'
"
10257,Storing multiple values for a single variable (PDO),"create table user_phonenumbers(
  id          auto_increment primary key.
  user_id     integer references user(id),
  phonenumber varchar(32)
);
"
13622,SQL single query issue,"select
  i.itemId,
  i.photo1,
  (select title from IMAGES_TBL where id = i.photo1) as photo1_title,
  i.photo2,
  (select title from IMAGES_TBL where id = i.photo2) as photo2_title,
  i.photo3,
  (select title from IMAGES_TBL where id = i.photo3) as photo3_title,
  i.photo4,
  (select title from IMAGES_TBL where id = i.photo4) as photo4_title,
  i.etc
from ITEMS_TBL i
"
7067,DELETE records without associated ones,"delete from invitations where invitationid 
not in (select invitationid from guests)
"
3871,Concatenate Main Group to Subgroup via FOR XML PATH,"select Location + ',' + aa as 'CSV' from 
(
SELECT t.Location, STUFF(
(SELECT ',' + convert(varchar(5), s.Degrees) as aa
FROM MonthlyTemps s
WHERE s.Location = t.Location
--FOR XML PATH('')),1,1,'') AS CSV
FOR XML PATH(''), TYPE).value('.', 'VARCHAR(MAX)'),1,1,'') AS CSV
FROM MonthlyTemps AS t
GROUP BY t.Location
) as temp
"
37249,select 2 different count in sql server,"select inner.color, count(*) from 
(select top 20000 [number], color from [profile]) inner
group by inner.color
"
37956,How to count records and display those counted records?,"SELECT CAST(CAST(COUNT([ASSIGNED TO]) as varchar(10)) + ' - ' +  [ASSIGNED TO] as varchar(50))  AS UserCount
FROM dbo.ECRSurvey
GROUP BY [ASSIGNED TO]
"
33076,Using @@IDENTITY in SQL on a specific table,"IDENT_CURRENT( 'table_name' )
"
37660,SELECT those not found in IN() list,"SELECT CustomerId
FROM   (VALUES(1),
              (79),
              (14),
              (100),
              (123)) V(CustomerId)
EXCEPT
SELECT CustomerId
FROM   Customers 
"
19037,"SQL: Given one record, how to find all its associated child records without knowing the number of levels in the hierarchy?","; with cte as (

  select ID, parentid, name from temp where parentid = '005'

  union all

  select t.ID, t.parentid, t.name from temp t
  join cte c on c.id=t.parentid
)

select * from cte
"
7674,GROUP_CONCAT and INNER JOIN with WHERE clause,"SELECT   course.id, course.name, GROUP_CONCAT(Flag.id) flags
FROM     course
    JOIN course_flags ON course_flags.course_id = course.id
    JOIN flag ON flag.id = course_flags.flag_id
GROUP BY Course.id
HAVING   SUM(flag.name = 'promocja')
"
13045,MySQL: Limit on certain field,"select t1.* from table1 as t1
inner join
(select distinct Parent_ID from table1 order by Parent_ID limit 3) as t2
on t1.Parent_ID = t2.Parent_ID
"
38913,SQL SP_WHO insert statement,"DECLARE @tmpUsers table ( spid INT, ecid INT, STATUS VARCHAR(MAX), loginame VARCHAR(50), hostname VARCHAR(50), blk BIT, 
dbname VARCHAR(MAX), cmd VARCHAR(MAX), request_id INT ) 

INSERT INTO @tmpUsers
EXEC sp_who @loginame  = 'sa'

SELECT * FROM @tmpUsers 
"
24028,How to write access query to find time interval in the same userid,"SELECT 
    LogTable.userid, 
    Count(LogTable.time) AS Over60
FROM 
    LogTable
WHERE 
    DateDiff(""s"", [time],
        Nz((Select Top 1 [time] 
            From LogTable As T 
            Where T.userid = LogTable.userid And T.time > LogTable.time
            Order By T.time Desc),[time])) > 60
GROUP BY 
    LogTable.userid;
"
38282,"SQL Query, is it possible to export the results on the fly?","INSERT INTO OPENROWSET 
('Microsoft.Jet.OLEDB.4.0', 
'Excel 8.0;Database=c:\Test.xls;HDR=YES','Select 
 sys.Netbios_Name0, 
 sys.User_Domain0, 
 sys.User_Name0, 
 sys.Operating_System_Name_and0, 
 arp.DisplayName0,
 ARP.Version0
FROM 
v_R_System sys
JOIN v_Add_Remove_Programs arp ON sys.ResourceID = arp.ResourceID WHERE 
Displayname0 like ''%Adobe Reader%''')
"
21708,Grouping by two fields on same line,"select a.QuestCode ,COUNT(distinct a.CustomerID)as UniqueCust,
count(distinct  (case when a.questcode = b.questcode and  a.customerid = b.customerid then  b.customerid else 0 end) )-2,
count(distinct  (case when a.questcode = b.questcode and  a.customerid = b.customerid then  b.customerid else 0 end) )-3,
count(distinct  (case when a.questcode = b.questcode and  a.customerid = b.customerid then  b.customerid else 0 end) )-4
from fborder a inner join
fborder b on a.customerid = b.customerid
group by a.QuestCode
"
1072,SQL Write Values from Multiple Rows to Single Result,"SELECT IDNum, MIN(Updatetime) DATETIME1,
              MAX(Updatetime) DATETIME2,
              MAX(Updatetime) - MIN(Updatetime) Difference
FROM AUDITHISTORY
GROUP BY IDNum
"
32965,Getting SQL view output as xml ( is it even possible ? ),"SELECT * FROM table_name FOR XML RAW;
"
25997,How to update a column of a table to a scaling value,"with RankedDocument as
(
  select *
    , rn = row_number() over (order by ID)
  from Documents
)
update RankedDocument
set Version = rn
"
6354,Public variable used for form opening not feeding through to from,"If e.ColumnIndex = 0 Then
    oform.ID = scid
    oform.Show()
End If
"
38201,How to get 2 records only if difference between them is more then 15 min,"SELECT
    time1.time,
    time2.time,
    time1.serial,
    (time2.time - time1.time) / 60 AS usage
FROM
    mytable time1,
    mytable time2
WHERE
    time1.id != time2.id
    AND time1.serial = time2.serial
    AND time2.time - time1.time > 60 * 15
"
18276,Iterating through date ranges,"Impression.where(:impressionable_id => document).where(""YEAR(created_at) = ? && MONTH(created_at) = ? && DAY(created_at) = ?"",date.year,date.month,date.day).count
"
16429,Script For every client with number of accounts SQL,"SELECT 
    a.ClienteId, 
    a.Apellidos,
    a.Nombre,
    a.RFC, 
    count(*) AS Temporal
FROM 
    [dbo].[Clientes] a
INNER JOIN 
    [dbo].[CuentasBancarias] b ON a.ClienteId = b.ClienteId
GROUP BY
    a.ClienteId, 
    a.Apellidos,
    a.Nombre,
    a.RFC
"
17131,Select related Elements Attributes as String,"select ti.id, ti.title, group_concat(t.title)
  from table_items ti
 inner join tag_to_items tti on (ti.id = tti.itemid)
 inner join tags t on (t.id = tti.tagid)
 group by ti.id, ti.title
"
7623,Mysql query return multiple columns,"SELECT BestLoc
 FROM Nutrients
 WHERE FoodId = ""$FoodId""
 AND CompId IN ('0000','0001','0003','0008','0130')
"
3545,Rewriting multiple near identical queries with different where clauses,"FOR r IN (
  select field1, field2 from table where field2 in (1,2,3,4)
) LOOP
  CASE r.field2
  WHEN 1 THEN a := r.field1;
  WHEN 2 THEN b := r.field1;
  WHEN 3 THEN c := r.field1;
  WHEN 4 THEN d := r.field1;
  END CASE;
END LOOP;
"
23497,Returning a 'calculated' column in an SQL Server query,"SELECT 
   MatchID,
   ScoreHome, 
   ScoreAway,
   (CASE WHEN (ScoreHome > ScoreAway) THEN 'Home Win'
         WHEN (ScoreHome < ScoreAway) THEN 'Away Win'            
         ELSE 'The Draw' END
   ) AS Result
FROM 
   Match
"
35563,select values with same id but different in other column,"SELECT distinct Pid 
FROM OWNS 
WHERE 
   Pid not in (select Pid from OWNS where Cid = 2) 
AND CID = 1;
"
4678,SQL stored proc: How to detect whether optional output argument was passed or not?,"CREATE PROCEDURE dbo.sp_get_info
    @Identifier nvarchar(50),
    @field nvarchar(50),
    @value nvarchar(50) output
"
17851,SELECT CASE with inner SELECT,"SELECT * 
FROM table2 
WHERE obj2.param1 IN (
    SELECT obj1.param1 
    FROM table1 
    WHERE... 
    GROUP BY obj1.param1
    HAVING COUNT(*) = 1
)
"
15356,"Get data from table, Using Rows as Columns","SELECT ProductId from myTable
 WHERE ProductId IN (SELECT ProductId FROM myTable WHERE FieldId = 50 AND FieldValue = '1.0')
   AND ProductId IN (SELECT ProductId FROM myTable WHERE FieldId = 55 AND FieldValue = 'Y') 
   AND ProductId IN (SELECT ProductId FROM myTable WHERE FieldId = 60 AND FieldValue = 'N')
"
18851,Run SQL pre-defined function stored in table,"DECLARE @x TABLE(sql NVARCHAR(255));

INSERT @x(sql) SELECT N'CONVERT(VARCHAR(10), ''2012-08-21 00:16:41.993'', 101)';

DECLARE @sql NVARCHAR(MAX);

SELECT @sql = N'SELECT ' + sql FROM @x;

EXEC sp_executesql @sql;
"
19848,PL/SQL set a link as default at the begining of the script,"SQL> var cur refcursor
SQL> DECLARE
  2    var_link varchar2(20);
  3  BEGIN
  4  var_link:='@your_db_link';
  5    OPEN :cur FOR 'SELECT * FROM dual'||var_link;
  6    END;
  7  /

PL/SQL procedure successfully completed.

SQL> print cur

D
-
X

SQL>
"
15385,Create unique constraint with nvl in Oracle," create unique index idx_t1 on t1 (nvl(C1, ' '));
"
36698,How to run a stored procedure when SQL Server Express Edition starts?,"exec sp_procoption 
        @ProcName    = 'procedureName',
        @OptionName  = 'startup', 
        @OptionValue = 'true'
"
30048,Appending a string before Count Function in Oracle,"select 'HDR' || count(quote_id)
from    T_CONV
"
801,Structuring up a database,"SELECT * 
FROM db.user u 
(LEFT) JOIN db.product p
ON u.user_id = p.user_id
"
2178,Query optimization possibilities?,"SELECT
  quote_id,
  MAX(created_at) AS max_created_at
FROM billing_pricequotestatus
GROUP BY quote_id
"
32449,alter data type of existing column from bigint to varchar in Apache derby,"UPDATE Country SET LawID_NEW = TRIM(CHAR(LawID));
"
11381,Number of days item present on a report,"SELECT fl.NodeId, DATEDIFF(day, fl.FirstDate, fl.LastDate) [Days On] FROM
(SELECT NodeId, MIN(DateAdded) [FirstDate], MAX(DateAdded) [LastDate]
FROM DailyRuns
GROUP BY NodeId
) fl
"
5125,Selecting a subset of records from a very large record set in Oracle runs out of memory,"where ora_hash(rowid, 1200) = 1
where ora_hash(rowid, 1200) = 2
...
"
23949,How to write this query in Linq2Sql,"var noSubs = from company in context.Companies
             where company.active_status == 1 &&
                 !(from subcontract in context.Subcontracts
                  where subcontract.active_status == 1
                  select subcontract.company_id).Contains(company.company_id)
             select company;
"
36721,How to recreate primary after dropping primary key column?,"--Approach 2: Closer to Hubert's Examples
--Advantage: Easy to read - intuitive, doesn't rely on a primary key
--Disadvantage: Creates temp junk in the db 
--      which means reusing in same session you must drop
--  and using in nested subquery results may be unpredictable

CREATE TEMP sequence temp_seq;
SELECT nextval('temp_seq') As row_number, oldtable.*
FROM (SELECT * FROM beta) As oldtable;
"
17374,BIRT SQL Null Case Scenario,"select PM17, WORKORDER.PMNUM, WORKORDER.ASSETNUM, ASSET.DESCRIPTION, ASSET.MANUFACTURER, EQASSETNUM, WORKORDER.LOCATION, LOCATIONS.DESCRIPTION, PM.ROUTE, TARGSTARTDATE, TARGCOMPDATE, PM.NEXTDATE
from WORKORDER 
LEFT JOIN ASSET ON WORKORDER.ASSETNUM = ASSET.ASSETNUM
JOIN PM ON WORKORDER.PMNUM = PM.PMNUM
JOIN LOCATIONS ON WORKORDER.LOCATION = LOCATIONS.LOCATION
WHERE WORKORDER.WONUM='1011';
"
13676,How to write IF THEN DO statement of SAS in SQL Server,"select (case when FLAG = 'Y' AND ACCT = ' ' then - orig_amt else orig_amt end) as orig_amt,
       (case when FLAG = 'Y' AND ACCT = ' ' then - bal else bal end) as bal,
       (case when FLAG = 'Y' AND ACCT = ' ' then - avail_bal else avail_bal end) as avail_bal,
       (case when FLAG = 'Y' AND ACCT = ' ' then - proc_amt else proc_amt end) as proc_amt
"
12378,Select multiple values from one table based on values in another,"SELECT t1.id
     , t1.p_id
     , t1.area
     , t1.jobs 
FROM plot t1 
JOIN watchlist t2 ON t1.p_id = t2.p_id 
"
30928,Coalesce/IsNull on stored proc output parameter,"DECLARE @v varchar(5)
EXEC checkCultureCode 'evil', @v OUTPUT
SELECT @v;
"
17145,Primary key requirement in raw SQL complicates the query in Django,"from django.db import connection

cursor = connection.cursor()
cursor.execute('SELECT max(value) FROM mytable')
max_value = cursor.fetchone()[0]
"
37318,Two ORDER BY clauses and a LIMIT,"SELECT *
FROM (
   SELECT id, names
   FROM items 
   ORDER BY ratings DESC
   LIMIT 10
   ) t
ORDER BY names
"
29425,Order by date from two tables using Union alternative,"SELECT IF(comment = 'view', 'view', 'comment') AS type, comment, fullname, created_at
FROM
(
  SELECT comment, fullname, comments.created_at
  FROM comments
  WHERE comments.photo_id = 14
  UNION
  SELECT 'view', user, views.created_at
  FROM views
  WHERE views.pid = 14
) tbl
ORDER BY created_at DESC
"
15456,Correlated vs Non-correlated subqueries in SQL,"SELECT *
FROM hr.bc_products p
WHERE p.sku NOT IN (SELECT ol.sku FROM hr.bc_orderlines ol WHERE ol.sku IS NOT NULL);
"
6338,How to divide two values from the same column in SQL,"SELECT t1.a, t1.b, t1.c,
    CASE WHEN t2.c IS NULL THEN 0 ELSE t1.c - t2.c END AS d,
    CASE WHEN t2.c IS NULL THEN 0 ELSE (1.0 * t1.c - t2.c) / t1.c * 100.0 END AS pct
FROM t t1
LEFT OUTER JOIN t t2 ON t1.a = t2.a
    AND t1.b = t2.b + 1
"
36506,"Single user mode ""missing behavior"" on SQL Server","USE [Your DB Name]

SELECT REQUEST_MODE, REQUEST_TYPE, REQUEST_SESSION_ID
FROM sys.dm_tran_locks
WHERE RESOURCE_TYPE = 'OBJECT'
AND RESOURCE_ASSOCIATED_ENTITY_ID =(SELECT OBJECT_ID('YourTableName'))
"
1092,SQL DB2 Conditional Select,"SELECT  A.GENRC_CD,
        A.DESC_30,
        A.DOL,
        A.DLU,
        A.LU_LID,
        B.EMAIL_ID_50
FROM    GENRCCD A LEFT JOIN
        MPPLNR B on A.DESC_30=B.MATL_PLNR_ID
WHERE A.GENRC_CD_TYPE = 'MDAA'
"
23123,Make Date dynamic but keep Time static,"DECLARE @Date DATE = '2014-12-11'  --<-- Date variable 

UPDATE tblData 
   SET Issued = CAST(@Date AS DATETIME) +  CAST('08:00:00.000' AS DATETIME)
where issued < CAST(@Date AS DATETIME) + CAST('08:00:00.000' AS DATETIME)
  and called > CAST(@Date AS DATETIME) + CAST('08:00:01.000' AS DATETIME)
  and tbldate = @Date
"
8119,Trying to solve date conditional in MySQL select query,"SELECT   *
FROM     delivery
WHERE    nextDate >= DATE(NOW() + INTERVAL 14 HOUR + INTERVAL leadTime DAY)
ORDER BY nextDate ASC, id ASC
"
30338,SQL Plus/Shell Script: Extra newline printed,"set newpage none
"
1076,LIMIT Display of a different table field,"SELECT tblusers.FirstName, tblstation.StationName, MAX(tblUserLogs.LastLog)
FROM (tblusers LEFT JOIN tblstation ON tblstation.StationNo = tblusers.StationNumber)
     LEFT JOIN tblUserLogs ON tblusers.UserNumber = tblUserLogs.UserID
WHERE tblusers.MemberType != 1
"
2956,Converting number to date in oracle,"select to_date('1800/12/28','yyyy/mm/dd') + 77650 from dual
"
5886,"SQl issue adding a char before id field , how?","update customer set id = 's' || cast(id as varchar(10)); 
"
806,MySQL Limit with Many to Many Relationship,"SELECT i.ItemContent, GROUP_CONCAT(t.TagName ORDER BY t.TagName) AS TagList
FROM item AS i 
  INNER JOIN ItemTag AS it ON i.id = it.ItemId 
  INNER JOIN tag AS t ON t.id = it.TagId
GROUP BY i.ItemId;
"
25010,Good way to get count of children?,"SELECT p.id,
       p.name,
       COUNT(c.id) AS children_count
FROM parent p
LEFT JOIN children c ON p.id = c.parent
GROUP BY p.id
"
15110,Whats the better way to write this query?,"WITH archive AS
(
    SELECT CASE WHEN EXISTS(SELECT 1 FROM dbo.tbl_Department d
                            WHERE d.DepartmentID = e.DepartmentID)
           THEN 'Department Found' 
           ELSE 'Department Not Found' END AS DepartmentStatus
    FROM   dbo.tbl_Employee WITH (NOLOCK) e
)
SELECT DepartmentStatus, Count(*) As Cnt 
FROM archive
GROUP BY DepartmentStatus
"
14507,MySQL Event Scheduler run 10 times per day,"CREATE EVENT event_name
  ON SCHEDULE
    EVERY 144 MINUTE
    STARTS (TIMESTAMP(CURRENT_DATE) + INTERVAL 1 DAY + INTERVAL 1 HOUR)
  DO
    # Your query
"
33422,Select top one record for each unique value of column,"SELECT x.* 
  FROM my_table x
  JOIN 
     ( SELECT request_id,MIN(price) min_price FROM my_table GROUP BY request_id )y
    ON y.request_id = x.request_id
   AND y.min_price = x.price;
"
37280,Oracle/SQL - Finding records with one value excluding nulls,"select person, type from table
where type = '1'
and person not in (select person from table where type is null)
"
27935,"Using SQL, select a single record from a table for each associated record in it's associated foreign key table","with cte as (
   select row_number() over (partition by DeptId, order by Submitted desc) as row,
   id,
   DeptId,
   RiskAssessment,
   Submitted,
   Approved
   from RiskAssesment where approved = 1
)

select
   id,
   deptid,
   RiskAssessment,
   Submitted,
   Approved
   from cte where row = 1
"
414,How to Select records of a certain format in MS SQL Server,"select ein.edl_EmployeeID, ein.edl_LogDate, ein.edl_LogTime as [Out], eout.edl_LogTime [Out]
from T_EmployeeDTRLogs ein
inner join T_EmployeeDTRLogs eout on ein.edl_EmployeeID = eout.edl_EmployeeID
and ein.edl_LogDate = eout.edl_LogDate
where ein.edl_LogType = 'IN'
and eout.edl_LogType = 'OUT'
"
14099,getting maximum from two columns of two tables,"select max(maxId) from
(
    select max(id) as maxId from delT1
    union all
    select max(id) as maxId from t1
) maxes;
"
30461,Mostly numeric range,"SELECT fileNumber
FROM File_Transfer
WHERE TO_NUMBER(REGEXP_SUBSTR(filenumber, '^(\d+)(\D*)$', 1, 1, 'x', 1)) >= 57
AND TO_NUMBER(REGEXP_SUBSTR(filenumber, '^(\d+)(\D*)$', 1, 1, 'x', 1)) < 60
"
38270,Get data whether the id is there or not,"SELECT sub.SubDivisionID, sub.SubDivisionName, csxref.SubDivisionID AS Assigned
FROM SubDivision AS sub
LEFT JOIN (
    SELECT t.SubDivision 
    FROM CustomerSubDivisionXREF AS t 
    WHERE t.CustomerID = 9
) AS csxref ON sub.SubDivisionID = cxsref.SubDivisionID
"
12150,delete employees whose manager location is usa,"delete from emplyoee where empid in(
select e.empid from emplyoee  e 
left outer join emplyoee   e1 on e.empid=e1.empid
left outer join department d on d.managerid=e1.empid
where e1.location='usa'
)
"
37887,"Mysql foreign key, must be matches in referenced table or key is deleted?","DELETE FROM `type` WHERE url NOT IN (
  SELECT DISTINCT `url` FROM `order`
)
"
36458,ORACLE SQL select distinct not removing duplicates,"SELECT vo.ZIP_CODE, TO_CHAR(ca.CALENDAR_WEEK),
       -- vo.REGION_ID
        COUNT(vo.ORDER_ID),
        SUM(vo.AMOUNT)
FROM VENDOR_ORDERS vo JOIN
     CALENDAR ca
     ON TRUNC(vo.ORDER_CREATION_DATETIME) = sd.CALENDAR_DATE
WHERE vo.REGION_ID = 1
GROUP BY vo.ZIP_CODE, TO_CHAR(ca.CALENDAR_WEEK)
"
22447,"Single query for ""INSERT INTO table if column value not found""","INSERT INTO friends 
            (memberid) 
SELECT 1 
FROM   dual 
WHERE  NOT EXISTS (SELECT memberid 
                   FROM   friends 
                   WHERE  memberid = 1)
"
24567,auto increment by specific column's data,"SELECT @row_number:=CASE WHEN @category=category 
THEN @row_number+1 ELSE 1 END AS feeds,@category:=category AS category, content
FROM table1, (SELECT @row_number:=0,@category:='') AS t
ORDER BY category;
"
28631,Select edge with both vertices from SQL db storing a graph structure,"SELECT v_from.x x1, 
       v_from.y y1,
       v_to.x   x2,
       v_to.y   y2
FROM edge AS e
JOIN vertex AS v_from
  ON e.from_id = v_from.id
JOIN vertex AS v_to
  ON e.to_id = v_to.id
"
26560,Inserting values in table from same table with one column modified,"INSERT [table] (col1, col2, col3, datecol, othercol)
SELECT col1, col2, col3, '20130104', othercol
  FROM [table]
 WHERE pk_id = 4;
"
16687,Oracle id contained in a view,"select OWNER, TABLE_NAME from dba_tab_cols where column_name = 'OUI_HOME_GUID';
OWNER   TABLE_NAME
-----   ----------
SYSMAN  MGMT_LL_HOME_INFO
SYSMAN  MGMT$OH_HOME_INFO
SYSMAN  CM$MGMT_LL_HOME_INFO
"
34193,select SQL query,"SELECT  CASE p1 WHEN 0 THEN t2.status ELSE t3.status END
FROM    t1
LEFT JOIN
        t2
ON      t2.p1 = p1
LEFT JOIN
        t3
ON      t1.p1 = 0
        AND t3.p2 = t1.p2
"
2599,SQL Server show non matching records,"select 
* 
from #test a
where exists
(
    select * 
    from 
    #test b
    where a.name = b.name and (a.tag <> b.tag or a.checkVAL <> b.checkVAL)
)
"
27117,Oracle Help on Selection of data,"SELECT *
FROM 
   SAL_INFO
WHERE
    (DEPTNO, SAL)
    IN
    (
        SELECT 
            DEPTNO, MAX(SAL) 
        FROM SAL_INFO
        GROUP BY DEPTNO
    )
"
38737,SQL query display min count rows only,"select s.model, s.VIN, s.cost
from stock s join
     (select category, count(*) as cnt, min(count(*)) over () as mincnt
      from stock s
      group by category
     ) c
     on s.category = c.category and cnt = mincnt
"
6531,MySQL: InnoDB Last Modified,"      SELECT MAX(`edited`) FROM `table1`
UNION SELECT MAX(`edited`) FROM `table2`
UNION SELECT MAX(`edited`) FROM `table3`
UNION SELECT MAX(`edited`) FROM `table4`
ORDER BY `edited` DESC
LIMIT 1
"
7944,Escape for comments in SQL files with liquibase,"INSERT INTO user (id,firstname,lastname,mystring) VALUES
(11,'Wendy','Salinas','this is my string-'  '-and it continues'),
(12,'Kirsten','Parker','this is the string of Kirsten')
"
12794,MySQL sum two tables fields and UPDATE,"UPDATE STOCKA a
JOIN STOCKB b
    ON a.P = b.P
SET a.U =  a.U - ABS(b.U)
"
30990,SQL Server : multiple rows with same column values except one,"SELECT name_text,c_num,d_type,unique_id,v_text,r_ticket_id
FROM
    (
        SELECT  name_text, c_num, d_type, unique_id, v_text, r_ticket_id,
                ROW_NUMBER() OVER (PARTITION BY unique_id 
                                   ORDER BY r_ticket_id DESC) rn
        FROM tableName
    ) x
WHERE x.rn = 1
"
8647,Removing rows in SQL that have a duplicate column value,"select min(id) as id, colB, colC
from tbl
group by colB, colC
order by id
"
21127,"SQL - Is there a query that will do ""foreach A in table, if !B, insert B""?","INSERT IGNORE INTO `table`
SELECT `alt1`.`nid`, `alt2`.`realm`
FROM `table` AS `alt1`, `table` AS `alt2`
"
8295,SQL: Duplicating data under a separate header,"SELECT ""A/B Shovels"" AS Example, Sum(Duration) AS Duration
FROM status_code
WHERE Example in (""ShovelA"", ""ShovelB"")
UNION
SELECT ""All Shovels"" AS Example, Sum(Duration) AS Duration
FROM status_code
"
31943,SQL DISTINCT query on Multiple Columns,"SELECT Artist, FIRST(Image) AS Image, FIRST(Title) AS Title
FROM table
GROUP BY Artist
"
38292,Large Neo4j graph not showing up,"MATCH (u)-[:VIEW]->(v)
RETURN u.username,v.title
"
12681,Why does SQL NOT EXISTS return 1 record of all NULL values,"SELECT SUM(col1) c1, SUM(col2) c2, SUM(col3) c3 FROM tbl WHERE 0
"
38633,How would you find the 'GOOD' ID when cancellation is involved?,"SELECT D.ID 
FROM Data D
WHERE  NOT EXISTS(SELECT 1 
                  FROM Data WHERE D.ID = CXL)
"
17126,Do some calculations of the values from two table and store it in one of the table,"UPDATE table1
JOIN table2 ON table1.email=table2.email
SET table1.value = (table2.result + table1.value) / 2
WHERE table1.email = ""abc@gmail.com""
"
31056,CONVERT various date-like strings (varchar) to one DATE field,"WITH x(ShipDate) AS
(
    SELECT '5/12/2011'
    UNION ALL SELECT '05/5/2012'
    UNION ALL SELECT '05/05/2012'
)
SELECT CONVERT (DATE, ShipDate) FROM x;
"
12900,SQL Server : join and append columns,"SELECT  a.ID, 
        SUBSTRING(d.NameList,1, LEN(d.NameList) - 1) Names
FROM    a
        CROSS APPLY
        (
            SELECT DISTINCT [NAME] + '; ' 
            FROM  B 
            WHERE A.ID = B.DupID 
            FOR XML PATH('')
        ) D (NameList) 
"
15022,SQL query for calculating Net Promoter Score over time,"SELECT date, SUM(answer-1) * 100 / COUNT(answer) as NPS
FROM yourTable
GROUP BY date
"
25171,"How to get ID for INSERT if name already used, else generate new one","INSERT INTO `cars` (`brand`, `model`, `B_ID`)
select 'Nissan', 'Note', coalesce(Max(B_ID),0)+1 FROM cars WHERE brand = 'Nissan'
"
38342,Select all records between two timestamps and then group by the number of occurrences of a value,"SELECT `email`, COUNT(*)
FROM `incidents`
WHERE `timestamp` BETWEEN '2015-12-01 00:00:00' AND '2015-12-30 23:59:59'
GROUP BY `email`
ORDER BY COUNT(*) DESC
"
3118,SQL Query Month Name Sort,"SELECT    MAX(DATENAME(Month, REQDATE)) AS Month, COUNT(WO_NUM) AS Tickets
FROM      dbo.TASKS
WHERE     (REQDATE >= '6/1/13')
GROUP BY  DATEPART(Month, REQDATE)  
ORDER BY  DATEPART(Month, REQDATE) ASC
"
11567,SQL permissions for roles,"GRANT ALL ON table1 TO doctor
"
30988,SQL multiple join query,"SELECT ... 
FROM users u 
    JOIN players p ON u.player = p.name
    LEFT JOIN teams t ON p.team = t.id
WHERE u.id = ? 
"
33257,Substitute column values in a table,"SELECT LessonCode, SubjectName, ClassName, hour, day
FROM lesson
JOIN class on lesson.ClassCode = class.ClassCode
JOIN subject on lesson.SubjectCode = subject.SubjectCode
"
36347,Retrieve value from the closest available date,"DECLARE @sdate DATE
SET @sdate = '2012-06-08'
SELECT SortCode, SUM(Balance)'Sum of Balances'
FROM (SELECT AccountNumber,SortCode, Balance,ROW_NUMBER() OVER (PARTITION BY AccountNumber ORDER BY StartDate DESC)'RowRank'
        FROM BalanceHistory
        WHERE StartDate <= @sdate AND SortCode <> 'ABC123456'
     )sub
WHERE RowRank = 1
GROUP BY SortCode
"
39788,Symfony2: Database and Entity settings: Neither property ... nor method ...nor method ... exists in class,"->add('place','entity',  array('class'=>'yourBundle:WorkPlace',
                               'property'=>'place'))
"
39220,Update multiple rows from group by SQL,"UPDATE t
   SET bdate = GETDATE()
  FROM table1 t LEFT JOIN 
(
  SELECT id, MAX(bdate) bdate
    FROM table1
   GROUP BY id
) e
    ON t.id = e.id
   AND t.bdate = e.bdate
 WHERE e.id IS NULL;
"
8356,SQL SERVER QUERY to select max value record per item,"select tenant, name, date, months
  from (select t.*,
               row_number() over (partition by t.tenant, t.name order by t.months desc, t.date desc) as rn
          from TableName t) x
 where rn = 1
"
7368,Change Value based on Dynamical Object,"select dateadd(hour, 9, cast(cast(@a as date) as datetime))
"
31200,MySQL count FKs on other table,"SELECT m.name, m.email, count(g.memberId )
FROM `MEMBER` m 
LEFT JOIN `GROUP` g ON g.memberId = m.memberId
GROUP BY m.memberId
"
36247,Inner join returning more rows then regular select,"select
    types.feed_type_id
from feed_id_types types
group by types.feed_type_id
having count(*) > 1
"
22606,How to join mysql query with multiple tables,"select a.*, b.*, c.* from 
    A a inner join B b on a.idB = b.id
        inner join C c on b.idC = c.id
"
9572,Find the time difference between rows,"SELECT
yt1.[timestamp] AS StartTime,
MIN(yt2.[timestamp]) AS EndTime,
DATEDIFF(s, yt1.[timestamp], MIN(yt2.[timestamp])) AS DifferenceInSeconds
FROM
yourTable yt1
LEFT JOIN yt2 ON yt1.[timestamp] < yt2.[timestamp]
WHERE
yt1.Col1 IS NULL
OR yt1.Col2 IS NULL
...
OR yt1.Col20 IS NULL
OR yt2.Col1 IS NULL
...
OR yt2.Col20 IS NULL 
GROUP BY yt1.[timestamp]
"
9328,Entity Relationship - Best way to handle relationship that expires after time,"class Booking
{
    public virtual Passenger Passenger { get; set; }
    public virtual Trip Trip { get; set; }
    public virtual Seat Seat { get; set; }
}
"
31269,Grails many to many sql,"def networks = Device.findByImei( 'whatever' ).nodes*.network?.unique( false )
"
38736,How to generate merit list from exam results in SQL Server,";with cte as
(
select *, dense_rank() over (order by ObtainedMarks desc) as Merit_List
from tstResult
)

select * from cte order by Merit_List desc
"
23077,vessel tracking database schema,"select a.`string_id`
from `string_ports` as a
inner join `string_ports` as c
on a.`string_id` = c.`string_id`
and a.`port_id` = 1 --whatever port_id A is
and c.`port_id` = 3 --whatever port_id C is
and a.`port_order` < c.`port_order`
"
38082,hsqldb count for each day,"select EXTRACT (DAY_OF_YEAR FROM date) as day, 
count(*) 
from table
group by EXTRACT (DAY_OF_YEAR FROM date)
"
26443,SQL get data from column(YYY0) with same number as different column(XXXX0) with the maximum date,"SELECT id,
CASE
WHEN YYYY0 > YYY1 AND YYY0 > YYY2 ... AND YYY0 > YYY9 THEN XXX0
WHEN YYY1 > YYY2 ... AND YYY0 > YYY9 THEN XXX1
...
ELSE XXX9 AS LabelX,
CASE
WHEN YYYY0 > YYY1 AND YYY0 > YYY2 ... AND YYY0 > YYY9 THEN YYY0
WHEN YYY1 > YYY2 ... AND YYY0 > YYY9 THEN YYY1
...
ELSE YYY9 AS LabelY,
...
"
21700,How to get the latest 2 items per category in one select (with mysql),"SET @counter = 0;
SET @category = '';

SELECT
    *
FROM
(
    SELECT
    	@counter := IF(data.category = @category, @counter+1, 0) AS counter,
    	@category := data.category,
    	data.*
    FROM
    (
    	SELECT
    		*
    	FROM test
    	ORDER BY category, date DESC
    ) data
) data
HAVING counter < 2
"
29607,SQL Server : split CSV," SELECT identifier, LTRIM(T2.my_Splits) AS my_values
 FROM
  (
   SELECT *,
   CAST('<X>'+replace(T.values,',','</X><X>')+'</X>' as XML) as my_Xml 
   FROM YOURTABLE T
  ) T1
  CROSS APPLY
  ( 
  SELECT my_Data.D.value('.','varchar(50)') as my_Splits
  FROM T1.my_Xml.nodes('X') as my_Data(D)
  ) T2
"
9450,Combining two different jTables and adding button into jTable,"select topic_title,topic_description,topic_by,
       reply_content,reply_by 
         from forumTopics join forumReplies 
           on (forumTopics.topic_id=forumReplies.topic_id)  WHERE topic_id = 1234
"
19579,SQL Query Multiple Tables,"SELECT * 
FROM 'veg_tech' v
LEFT JOIN table_2 t2 ON v.BOR_ID= t2.BOR_ID
LEFT JOIN table_3 t3 ON v.FERTILIZER_KG_ROP_ID = t.FERTILIZER_KG_ROP_ID 
LEFT JOIN table_4 t4 ON v.DOR_DISTANCE_ID = t4.DOR_DISTANCE_ID ;
"
31545,Changing a query from subqueries to joins,"SELECT acc.* 
FROM accounts acc 
JOIN addresses addr ON acc.id = addr.account_id
JOIN alternate_ids ids ON acc.id = ids.account_id
WHERE LOWER(acc.firstname) = LOWER('Sam') 
AND LOWER(addr.name) = LOWER('Street1') 
AND ids.alternate_id_glbl = '5';
"
3246,Is it possible to match all the fields in one table with other through third table?,"SELECT u.id, u.name, IF(ug.user_id IS NOT NULL, 1, 0)
FROM users AS u
CROSS JOIN groups AS g
LEFT JOIN user_groups AS ug ON u.id = ug.user_id AND g.id = ug.group_id
WHERE u.is_online = 1
"
17687,Get only one item from a subgroup values,"select tb2.id,tb1.b,tb1.c from 
(select t1.b,max(t1.c) c from table_name t1 group by tb1.b) tb1
join table_name tb2 on tb1.b=tb2.b and tb1.c=tb2.c 
"
36853,Disadvantages of using date_trunc,"SELECT col::date
"
20788,JPQL multiple left join with one class,"FROM message m                -- SELECT * is optional in JPQL
LEFT JOIN m.owner o           -- In JPQL, you put the path to the related object
LEFT JOIN m.from_user_id fu   -- and JPA does the rest using the mappings
LEFT JOIN m.to_user_id tu
WHERE o.name like '%foo%' OR fu.name like '%foo%' OR tu.name like '%foo%';
"
20087,SQL Table Valued Parameter - Default Value,"SELECT * 
FROM tableName
WHERE not exists(select * from @TVP)
    or RecordID IN (SELECT * FROM @TVP)
"
32634,Differentiate Oracle SQL resultset by which WHERE clause item was matched?,"select distinct a.claim_nbr ref_claim, b.claim_nbr, b.SERV_NBR, a.Member_Nbr, b.AFF_NBR,
b.YMDEFF, b.ymdend, b.Location
From (select distinct member_nbr, aff_nbr, ymdeff, ymdend, claim_nbr
From service_x
Where claim_nbr in (######)) a
join service_x   b
on substr(a.aff_nbr,1,6) =  substr(b.aff_nbr,1,6)
and a.member_nbr = b.member_nbr and (b.ymdeff between a.ymdeff and a.ymdend)
order by 2;
"
6819,SQL Server Inline CASE WHEN ISNULL and multiple checks,"COALESCE(YourColumn, CASE c WHEN 80 then 'planb' WHEN 90 THEN 'planc' END)
"
5451,mysql:choosing the most efficient query from the two,"create index t1_authorID_postType on t1(authorID, postType);
create index t1_websiteID_postType on t1(websiteID, postType);
"
13167,joining a table to itself which has no key,"select id, count(*) as numPurchases, count(distinct product) as numProducts
from table t
group by id;
"
22011,SQL Server: Insert Into new table with old table data and different column types,"INSERT INTO NewTable (PersonID, FileName, AttachTypeID)
SELECT o.PersonID, o.FileName, t.AttachTypeID
FROM OldTable o
JOIN tblAttachType t on o.AttachType = t.TypeName
"
12375,How to replace part of string in SQL,"update `table` set `column`= replace (`column`, 'http://example.com/','http://example.com/blog/') where `column`like 'http://example.com/blog/wp-content/uploads%'
"
18605,Fetch only N rows at a time (MySQL),"SELECT * FROM table LIMIT 0,20
"
2305,Create user -- MongoDB,"mongo -u siteUserAdmin -p password
"
21355,SQL Full outer join of similar tables,"SELECT * FROM CTP0002;
union all
SELECT * FROM CTP0003;
"
33020,Oracle select query with substr,"select * from mealdb where userid='mistu4u' and substr(daydate,4,3)='JUL';
"
25849,I want to figure out a sql statement for a complex data structure,"SELECT X.* 
FROM A 
LEFT JOIN B ON B.A_id = A.id 
LEFT JOIN C ON C.A_id = A.id 
LEFT JOIN X ON X.id = IF(A.path = 'B', B.X_id, C.X_id) 
WHERE A.id = <numeric_id>;
"
10731,Get the first line of the final sequence,"SELECT MIN(id), MIN(dt)
FROM
 (
   SELECT
      tab.*,
      ROW_NUMBER () OVER (ORDER BY dt DESC) AS rn,
      ROW_NUMBER () OVER (PARTITION BY id ORDER BY dt DESC) AS rn2
   FROM tab
 ) AS dt
WHERE RN = RN2
"
27977,SQL find the same column in different tables,"select name from syscolumns sc1 where id = object_id('table1') and exists(select 1 from syscolumns sc2 where sc2.name = sc1.name and sc2.id = object_id('table2'))
"
12892,EF Code first existing SQL Azure Database," public CijenolomciContext()
        : base(*database name*)
    {
        //additional logic
    }
"
14127,Compound mysql Select After outer join,"SELECT
  SUM(A.a + IFNULL(B.c, <default_value>))
FROM A 
LEFT OUTER JOIN B ON A.b = B.b;
"
31690,Many highly similar objects in the same database table,"Main_table ( PK, Product_Type, Field1, Field2, Field3 )
Geo_table  ( PK, county, longitute, latitude )
Value      ( PK, cost, sale_price, tax )
etc
"
27167,How do I convert this SQL Server Insert statment to be useable in Access,"INSERT INTO tblfeedbackjoin
            (feedbackid,
             productid,
             brokerid,
             vendorid)
VALUES      ( DMax(""feedbackid"",""tblfeedback""),
            NULL,
            Dlookup(""brokerid"", ""tblbroker"", ""bname = 'ABC Broker'""),
            NULL) 
"
28149,How to group by some fields and display the first value of another field in oracle?,"SELECT MIN(r.RN_EXECUTION_DATE), t.TESTSETNAME, r.RN_BUILD_VERSION, r.rn_status, 
 COUNT(r.rn_run_id) AS run_count
 FROM table t, table r, (.........) tlf
 WHERE (........)

GROUP BY t.TESTSETNAME,
  r.RN_BUILD_VERSION,
  r.rn_status

ORDER BY t.TESTSETNAME,
  r.RN_BUILD_VERSION  
;
"
19131,How to calculate the number of rows using a time based sliding window?,"SELECT
    ts, cnt
FROM Data d
CROSS APPLY(
    SELECT COUNT(*)
    FROM Data
    WHERE ts BETWEEN d.ts AND DATEADD(SECOND, 10, d.ts)
) AS x(cnt)
ORDER BY d.ts
"
9349,Converting a Hebrew month name to an English month name in Oracle,"with test_norwegian as (
  select 'januar' month
  from dual
)
select 
to_char(
  to_date('1 '||test_norwegian.month||' 2011', 'dd month yyyy', 'NLS_DATE_LANGUAGE=NORWEGIAN')
  , 'month', 'NLS_DATE_LANGUAGE=NORWEGIAN') norwegian_month
,to_char(
  to_date('1 '||test_norwegian.month||' 2011', 'dd month yyyy', 'NLS_DATE_LANGUAGE=NORWEGIAN')
  , 'month', 'NLS_DATE_LANGUAGE=AMERICAN') american_month
from test_norwegian
"
14165,specific mysql update based on group by data,"UPDATE Meters m
INNER JOIN
(
   SELECT meter_id, MIN(reading_time) lowesttime
   FROM readings 
   GROUP BY meter_id
) r ON m.id = r.meter_id
SET m.starttime = r.lowesttime;
"
39146,Help with query,"SELECT Student, Team, ref
FROM Table1
GROUP BY Student
HAVING COUNT(Student) = 1
"
35120,selecting the maximum bids overall,"select userid, uname from user1 
where userid in 
(select bidder from bid group by bidder having count(bidder) = 
(select max(c) from (select count(*) as c, bidder from bid group by bidder)));
"
17391,SELECT * FROM TABLE(pipelined function): can I be sure of the order of the rows in the result?,"SQL> begin
  2    for i in 1 .. 10000000 loop
  3      for j in ( SELECT a.*, rownum as rnum FROM table(temp_func()) a ) loop
  4
  5         if j.x <> j.rnum then
  6            raise_application_error(-20000,'It broke');
  7         end if;
  8      end loop;
  9    end loop;
 10  end;
 11  /

PL/SQL procedure successfully completed.
"
25083,Ordering Postgresql Table Results by Chronological Date,"order by min(""Date"")
"
35652,MySQL: Select multiple records with comma separated values,"SELECT o.id AS order_id, o.order_total, o.created_at, u.username, u.avatar,
       group_concat(sp.name )
FROM store_orders o JOIN
     store_orders_contents c
     ON o.id = c.oid JOIN
     store_products p
     ON p.id = c.pid JOIN
     users u
     ON u.id = o.consumer_uid JOIN
     store_products sp
     ON sp.id = c.pid
WHERE p.uid = 3
GROUP BY order_id;
"
35385,MySQL Insert values and some to be selected from other tables,"INSERT INTO works (name, date_started, type_id, employer_id)
SELECT name, curdate(), type_id, employer_id
FROM types t
JOIN employers e ON ...
WHERE ...
"
36624,Select single row from database table with one field different and all other being same,"SELECT MIN(a) a,b,c,d,e,f,g,h
FROM mytable
GROUP BY b,c,d,e,f,g,h
"
1230,Checking for certain data across servers in MySQL,"SELECT count(*) FROM Table1
WHERE userID = 'some_value' AND user_level = 3
"
16065,Using a sequence in IN(),"l.sub BETWEEN 10921 AND 12480
"
3482,Inserting all rows from subquery using asubselect with an alias and sequence,"INSERT INTO my_table
 (sequence_id,
 product_code,
 product_status)
 SELECT 
     sequence_id.NEXTVAL,
     alias_table.product_code,
     alias_table.product_status
 from (SELECT
           product_code, 
           product_status
       FROM products
       WHERE product_code = '123456') alias_table;
"
39697,Can't get all data from table with laravel raw query and group_concat,"        ->groupBy('classreports.teacherId','classreports.reportDate')
"
24450,SQL subquery in query,"select w.*,
sum(case when month(p.date) = 6 then p.amount else 0 end) `sum_june`,
sum(case when month(p.date) = 7 then p.amount else 0 end) `sum_july`,
sum(case when month(p.date) = 8 then p.amount else 0 end) `sum_august`,
sum(case when month(p.date) = 9 then p.amount else 0 end) `sum_september`
from workers w
left join payment p on(w.id = p.worker_id)
group by w.id
"
39339,How can I match a comma separated list against a value?,"SELECT * FROM article WHERE FIND_IN_SET('5', category) != 0;
"
8585,Generate number of related records based on a number,"select t.contractid, t.startdate, n.number as inspectionnum
from table t join
     master.spt_values n
     on n.number <= t.numinspections;
"
8632,Update field value based on file extension,"UPDATE MyTable
SET FileType = NULLIF(SUBSTRING(FileName, LEN(FileName) - 
CHARINDEX('.', REVERSE(FileName)) + 2, LEN(FileName)), '')
"
22142,Adding values based on certain Data in a Colimn,"SELECT Currency, SUM(Balance) AS total
FROM currencies
GROUP BY Currency
"
34779,"Make a ""LEFT UNION"" query","INNER JOIN (SELECT * FROM nobu.dbo.product UNION SELECT * FROM bu.dbo.product) AS product
ON [...] INNER JOIN (SELECT * FROM nobu.dbo.name UNION SELECT bu.dbo.name WHERE id NOT IN (SELECT id FROM nobu.dbo.name)) AS name
ON product.key = name.id
"
28962,SQL insert for key-key-value data,"INSERT INTO vals (i1, i2, v1, v2, v3, v4) VALUES
((SELECT index FROM points WHERE x = ? AND y = ? and z = ?),
 (SELECT index FROM points WHERE x = ? AND y = ? and z = ?),
 ?, ?, ?, ?)
"
15347,Auto Increment Value on SQL SELECT when duplicate,"SELECT
    FirstName + '.' + LastName
        + IsNull(cast(NullIf(ROW_NUMBER() OVER(PARTITION BY FirstName + '.'  + LastName ORDER BY ID) - 1, 0) as varchar(10)), '')
FROM
    TableName
"
7328,Is this SQL the most efficient way,"select k1.*
from keessattbl k1
where k1.sat = 1010
and k1.year = (select max(k2.year) 
               from keessattbl k2
               where k2.sat = k1.sat
                 and k2.year <= 2014)
"
18443,Calculate running sum over 4-quarter period in SQL,"SELECT [Bank Name], Quarter,
        SUM([Net Income 12M]) OVER(PARTITION BY [Bank Name]
                                   ORDER BY YEAR(Quarter), QTR(Quarter)
                                   ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS SumInc4Q
    FROM BankIncome
    ORDER BY [Bank Name], Quarter;
"
19744,Rewriting MySQL query with subquery for version 3.23.58,"SELECT * 
FROM abstracts 
LEFT OUTER JOIN reviewdata  
ON abstracts.id=reviewdata.abstractid  
AND reviewerid='$userid'
WHERE session='$session'
"
15625,SQL Query to return count of rows until certain criteria is met,"select count(*)
from table t
where specificcolumn < (select min(t2.specificcolumn)
                        from table t2
                        where t2.ratio <> 1)
"
31244,MS Access - Extract single value for calculation,"SELECT tbl_A.Security, Sum(([Collateral]/[RateToUSD])) AS CollateralUSD
FROM tbl_A, (SELECT RateToUSD
    FROM tblExchangeRates
    WHERE CurrencyCode = 'EUR')  AS MyAliasQ
GROUP BY tbl_A.Security
HAVING (((tbl_A.Typ)=""PR""));
"
10629,sql count of multiple tables possible inner join,"SELECT J.jobID, 
    count(Distinct P.Country) as CountOfPlaces, 
    Count(Distinct T.Time) as CountOfTimes
FROM Jobs J
LEFT JOIN Places P
 on J.JobID=P.JobID
LEFT JOIN Times T
 on T.JobID = J.JobID
GROUP BY J.JobID
"
16377,Inner join of 3 tables with row count,"    SELECT C.NAME, Tmp.Test_COUNT, A.START, A.END
    FROM C INNER JOIN A ON C.CUST_ID = A.CUST_ID
    INNER JOIN
    (
        SELECT CUST_ID, A_ID, COUNT(*) AS Test_COUNT
        FROM B
        GROUP BY CUST_ID, A_ID
    ) Tmp ON Tmp.CUST_ID = A.CUST_ID AND Tmp.A_ID = A.A_ID    
"
2861,Remove special char using select statement SQL," SELECT ID, REPLACE(CompanyName ,'''', """") as company_name FROM tblCompany
"
35005,Where Datetime NOT IN Between Select,"SELECT l.*
FROM LOG l
WHERE l.[date] >=  @startDate AND
      (l.[date] <=  @endDate OR @endDate IS NULL) AND
      NOT EXISTS (SELECT 1
                  FROM ADMINaction a
                  WHERE l.[date] >= a.Start AND
                        (l.[date] <= a.Ende OR a.Ende IS NULL)
                 );
"
22647,Select distinct values from multiple columns,"select min(A),B
  from table
 group by B
"
32256,Select view only showing some results,"SELECT
    items.ShipmentID,
    items.FNSKU,
    items.ASIN,
    items.Merchant,
    shipments.ShipmentName,
    shipments.Prep_Type,
    items.Quantity
FROM dbo.FBAShipmentItems AS items
LEFT JOIN dbo.FBAShipments AS shipments
ON items.ShipmentID = shipments.ShipmentID
"
23867,Is it possible to compare other tables within a trigger?,"create or replace trigger last_table_trig
before update on last_table
for each row
declare
  l_parentField varchar2(100);
begin
  if :new.self_ref_fk is null then
     select p.parent_field into l_parentField from parent_table p
     where p.pk = :new.parent_fk;
     if l_parentField = 'default' then
       :new.status := 'DELETED';
     end if;
  end if;
end;
"
6078,add specific multiple rows (SQL),"SELECT *
FROM (
    SELECT DISTINCT matchid, player1id, player2id FROM tbl
) AS t
CROSS APPLY(
    SELECT
        SUM(player1score), SUM(player2score)
    FROM tbl
    WHERE
        matchid = t.matchid
        AND player1id = t.player1id
        AND player2id = t.player2id
) AS x(player1score, player2score) 
"
7429,Join on matching records and create combinations when no match,"SELECT Day, Month, Random1, Random2, value1, 'value1' AS type
FROM tableA
UNION
SELECT tableB.Day, tableB.Month, r1.Random1, r1.Random2, tableB.value2, 'value2'
FROM tableB
JOIN (SELECT DISTINCT Random1
      FROM tableA) AS r1
JOIN (SELECT DISTINCT Random2
      FROM tableA) AS r2;
"
22944,Write raw SQL for PostGIS,"UPDATE my_table SET box = ST_GeomFromText('POLYGON ((1 1), (2 3), (3 3), (1 1))');
"
12879,adding values of two columns in different databases sql,"select coalesce(asum, 0) + coalesce(bsum, 0) 
from (select sum(qty) as asum from dba.Product) a cross join
     (select sum(quantity) as bsum from dbB.Stock) b
"
2313,transfer a table in the other?,"UPDATE players p
JOIN schliessfach s
    ON p.playerid = s.playerid
SET p.lockers= s.lockers
"
34016,How to insert more than 1000 record at a time without using BULK insert in ColdFusion?,"sp_configure 'show advanced options', 1;
RECONFIGURE;
sp_configure 'Ad Hoc Distributed Queries', 1;
RECONFIGURE;
GO   


 Insert into [TABLE]
        select * FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0',
        'Data Source=C:\test.xls;Extended Properties=Excel 8.0')...[Sheat1$]
"
32962,How to add more string data to an existing (filled) column,"UPDATE foo SET bar = CONCAT(bar, ' B') WHERE foobar = 'barfoo';
"
26920,Group by two columns,"SELECT players.player,
      -- Use correlated subselects to count goals / assists
      (SELECT COUNT(*) FROM actions WHERE goal = players.player) goals
      (SELECT COUNT(*) FROM actions WHERE assist = players.player) assists

-- Get all distinct players (UNION = DISTINCT, here). Of course, if you
-- have an actual players table, use that one instead!
FROM (
  SELECT goal player FROM actions UNION
  SELECT assist      FROM actions
) players
"
9076,how to use tns entries with macromedia drivers for Oracle,"jdbc:macromedia:oracle:TNSNamesFile=C:\\Oracle\\product\\11.2.0\\client_1\\network\\admin\\tnsnames.ora; TNSServerName=tnsentry
"
34419,"sql-server, IF statement within SQL Query","SELECT 
COALESCE(salesHeader.[Ship-to Name], poHeader.[Ship-to Name]) AS DeliveryName
"
29182,PSQL not updating uniquely but copying value onto all entries---Foreign Key update,"UPDATE members
SET pers_id=persons.pers_id
FROM persons
WHERE members.full_name = persons.full_name
"
39358,How to join two tables while removing repeated entries in one column of one table,"SELECT DISTINCT ON (vcsID) *
FROM   config c
JOIN   data   d ON d.configID = c.ID
ORDER  BY vcsID, ""timestamp"" DESC;
"
23438,How to update a column via Row_Number with a different value for each row?,";WITH T
     AS (SELECT IdDatoLegal,
                Row_number() OVER (ORDER BY IdCliente ) AS RN
         FROM   dbo.DatosLegales)
UPDATE T
SET    IdDatoLegal = RN 
"
23198,Multiple inserts with composite type,"INSERT INTO episodes (id, title, release_date)
VALUES 
((1, 1, 58811), 'Pilot', null),
((1, 2, 58811), 'Vector', null);
"
25319,Searching all columns with LIKE,"select * 
from tbl_fish 
where Name LIKE '%afr%vio%'
    OR Size LIKE '%afr%vio%'
    OR Color LIKE '%afr%vio%'
    OR Species LIKE '%afr%vio%'
    OR Description LIKE '%afr%vio%';
"
29231,converting SQL to ACCESS,"SELECT
    SUM(IIF([Column2] = 'Cylinder', 1, 0)) as 'Cylinder count',
    SUM(IIF([Column2] = 'Snap', 1, 0)) as 'Snap count',
    SUM(IIF([Column2] = 'Tip', 1, 0)) as 'Tip count',
    SUM(IIF([Column2] = 'Other', 1, 0)) as 'Other count'
FROM [TableName]
WHERE [Column1] = '1.9 QNS-Quantity Not Sufficient'
"
6535,Microsoft Enterprise Library Connection String,"var connectionStringBuilder = new SqlConnectionStringBuilder(_db.ConnectionString);
string databaseName = connectionStringBuilder.InitialCatalog;
"
34362,How to get last record from column if there is no any unique ID for this record?,"select * from table_name order by time_stamp desc limit 1
"
24159,How to order the query result by count() of field in postgresql without group by,"SELECT t1.* 
FROM   table1 t1 
       INNER JOIN (SELECT Count(name) counter, 
                          name 
                   FROM   table1 
                   GROUP  BY name)t2 
               ON t1.name = t2.name 
ORDER  BY counter; 
"
39875,Select with variable LIMIT value,"with recursive cte as (
    -- anchor of the query - last 10 threads
    select c.id, c.content 
    from comments as c
    where c.root is null -- top level threads
    order by c.date_added desc
    limit 10

    union all

    -- recursively get all children
    select c.id, c.content
    from comments as c
        inner join cte as cr on cr.id = c.root
)
select
    content
from cte
"
27611,How to chose all rows where there are at least two same values within the subset,"select 
    page_session_id, event_name
from tbl 
where event_name = 'started'
group by page_session_id, event_name
having count(*) >= 2
"
29009,Deciling by partitions in Teradata SQL,"QUALIFY
   PERCENT_RANK()
   OVER (PARTITION BY RegionID
         ORDER BY Sales DESC) <= 0.2
"
13655,Best way to tune NOT EXISTS in SQL queries,"SELECT ETL_PRCS_DT, COUNT (*) TOTAL_PRGM_HOLD_DUE_TO_STATION
FROM DEV_AM_EDS_1..AM_HOLD_TV_PROGRAM_INSTANCE D1
LEFT JOIN DEV_AM_EDS_1..AM_STATION TAB2 ON D1.STN_ID = TAB2.STN_ID
WHERE TAB2.STN_ID IS NULL
"
28418,use current date as default value for a column,"ALTER TABLE myTable 
  ADD CONSTRAINT CONSTRAINT_NAME
    DEFAULT GETDATE() FOR myColumn
"
32876,Sql query to find out sum against individual id,"SELECT id, SUM(money) 
FROM table_money
GROUP BY id
"
4056,Repeated use of an alias within a join,";WITH MyCTE AS
(
<Your complicate query here>
)
SELECT fields
FROM MyCTE
JOIN (subquery referencing MyCTE)
...
"
181,How to query for only email values?," SELECT *
  FROM TABLENAME
  WHERE email LIKE '%@%.%'
    AND email NOT LIKE '% %';
"
32316,distinct in sql,"SELECT  CASE WHEN state=18 THEN lga ELSE 'Others' END LGA
,       COUNT(CASE WHEN choice=21 THEN choice END) NDCH
FROM    bio
GROUP BY
        CASE WHEN state=18 THEN lga ELSE 'Others' END
"
3951,Track down the deleted the records in a database,"select * from restored_db.table
EXCEPT
select * from current_db.table
"
23838,Adding column to group by clause messes up counting,"SELECT v.SessionIdTime, v.CorrelationId, total
From VoipDetailsView v inner join
(SELECT CorrelationId, Count(CorrelationId) as total
FROM VoipDetailsView
WHERE ResponseCode = 200
GROUP BY CorrelationId) agg
on v.CorrelationId = agg.CorrelationId
"
1177,primary table joined to foreign table - select only one record from foreign table,"select d.*, dc.*
from deals d cross apply
     (select top 1 dc.*
      from deals_country dc
      where d.deal_id = dc.deal_id
     ) dc
order by d.deal_id;
"
25613,SQL - left join with OR operator (MySQL),"select 
    *
from
    tableA as a
    left join tableB as b1
        on a.id=b1.id1 
        and b1.col2='Red'
    left join tableB as b2
        on a.id=b2.id2 
        and b2.col2='Blue'
where 
    (b1.id1 is not null or b2.id2 is not null)
    or (b1.id1 is null and b2.id2 is null)
"
39532,Cast date to varchar2 lost time part,"SQL> alter session set nls_date_format = 'fmdd-mm-yyyy';

Session altered.

SQL> select cast(sysdate as varchar2(100)) from dual;

CAST(SYSDATEASVARCHAR2(100))
---------------------------------------------------------------------
14-1-2014

1 row selected.

SQL> alter session set nls_date_format = 'fmdd-mm-yyyy fmhh24:mi:ss';

Session altered.

SQL> select cast(sysdate as varchar2(100)) from dual;

CAST(SYSDATEASVARCHAR2(100))
---------------------------------------------------------------------
14-1-2014 14:17:43

1 row selected.
"
31398,Script to concatenate columns and remove leading/trailing delimiter,"SELECT STUFF(
     COALESCE(';'+R_NOT_CUR,'')
     + COALESCE(';'+R_NOT_CUR_2,'')
     + COALESCE(';'+R_NOT_CUR_3,'')
     + COALESCE(';'+R_NOT_CUR_4,''),1,1,'')
FROM YourTable
"
24435,Having two tables of users id and the link between them,"SELECT u2.name as id_name, u1.name as linked_id_name
FROM link_view_user l
join panel_user u1 on u1.id = l.linked_id
join panel_user u2 on u2.id = l.id
"
8590,MySQL finding duplicate items in a row,"select col
from (select a as col from table_a union all
      select b from table_a union all
      select c from table_a union all
      select d from table_a union all
      select a from table_b union all
      select b from table_b union all
      select c from table_b union all
      select d from table_b
     ) t
group by col
having count(*) > 1;
"
10294,Update data based on other column,"UPDATE TableName
SET JoinDate = CASE WHEN NextLevel = 'Hour' THEN DATEADD(HH,1,ISNULL(ModifiedDate,CreatedDate))
                    WHEN NextLevel = 'Day' THEN DATEADD(DD,1,ISNULL(ModifiedDate,CreatedDate))
                    WHEN NextLevel = 'Min' THEN DATEADD(MI,1,ISNULL(ModifiedDate,CreatedDate))
                END
"
4241,Turn query results from one query into columns of another,"Select k, owner, group_concat(carbrand)
FROM owners, cars
WHERE
owner.k = cars.k
GROUP BY car brand
"
7916,Deleting records that are not joined on in SQL,"DELETE Customers
FROM   Customers c
WHERE NOT EXISTS (
    SELECT 1
    FROM Orders o
    WHERE o.CustomerID = c.ID
)
"
12102,Aggregate values of grouped SQL results,"SELECT id,avg(value) 
    FROM people
    GROUP BY id
"
11891,How to pull previous month data for in January,"YEAR(CURRENT DATE) * 12 + MONTH(CURRENT DATE) - 1 = YEAR(TSTAMP) * 12 + MONTH(TSTAMP)
"
29823,Associate users and roles added to ASPNET SQL Database tables with existing user information,"select *
  from Users as U inner join
    aspnet_Users as aU on aU.UserId = U.UserKey inner join
    aspnet_Membership as aM on aM.UserId = aU.UserId
  where U.UserId = @UserId
"
16385,Using a Sub-Select as a Returned Column,"SELECT st.Id, st.Name, GROUP_CONCAT(ct.ClassId) AS ClassList
    FROM StudentTable st
        INNER JOIN ClassTable ct
            ON st.Id = ct.Id
    GROUP BY st.Id, st.Name
"
36090,selecting a row using MIN or ROWNUM,"SELECT  Lastname, FirstName, Age
FROM    
        (
            SELECT  Lastname, FirstName, Age,
                    DENSE_RANK() OVER (PARTITION BY LastName ORDER BY Age) rn
            FROM    tableName
        ) a
WHERE   a.rn = 1
"
38984,SQLite compare single value to multiple values,"DELETE from myTable where someNum in (select someNum from difTable);
"
39116,Finding dependencies on a given function in Oracle,"SELECT *
FROM DBA_DEPENDENCIES
WHERE REFERENCED_OWNER = 'YOUR_SCHEMA'
AND REFERENCED_NAME = 'A';
"
20076,SQL / MySQL: Sum all amounts for respective month,"SELECT
  customer_id,
  month(payment_date) as month,
  sum(amount) as total_amount
FROM
  tablename
GROUP BY
  customer_id,
  month(payment_date)
"
39352,JDBC update a single field from object,"UPDATE users 
SET firstName = ISNULL(@nameParam, firstName), 
    lastName = ISNULL(@lastNameParam, lastName), 
    email = ISNULL(@emailParam, email),
    ...
WHERE id = ?;
"
33572,Removing duplicates MySQL database,"ALTER IGNORE TABLE `table_name` ADD UNIQUE (`hash`)
"
139,SQLite not getting double data,"SELECT ID
FROM Ideas
WHERE NOT EXISTS (SELECT 1
                  FROM Ratings
                  WHERE userID = 1
                    AND ideaID = Ideas.ID)
"
3225,Multiple SQL SELECT,"SELECT *
FROM table1,
     table2
WHERE table1.date = 'somedate'
  AND table2.date = 'somedate'
"
3214,How to create query to select records which contain any of the defined values in any row?,"SELECT
    ...
FROM
    ...
WHERE
    column_1 in (string1, string2...string10)
    OR column_2 in (string1, string2...string10)
"
19938,SQL SELECT (beginner),"SELECT id_dep , name_dep
FROM department AS d
WHERE NOT EXISTS (SELECT 1 
                  FROM employee AS e
                  WHERE e.id_dep = d.id_dep AND e.salary >=  7000)
"
17641,"Crystal Reports Cross-Tab, Grouping by Database Field","CustomerName

Total


Red Products  Product Code1     3     24     72
              Product Code2     3     24     72

Blue Products Product Code3     3     24     72
"
7329,Convert month and year combination to date in SQL,"DECLARE @StartMonth INT = 3 
DECLARE @StartYear INT = 2010 
DECLARE @EndYear INT = 2013 
DECLARE @EndMonth INT = 6 

SELECT Dateadd(year, @StartYear - 2000,Dateadd(month, @StartMonth - 1, '20000101')) AS StartDate, 
       Dateadd(year, @EndYear - 2000, Dateadd(month, @EndMonth - 1, '20000101')) AS EndDate
"
8636,SELECT Name WHERE LevenshteinFunction ReturnValue > 80 AND also select the ReturnValue,"WITH Result ([Name], [No_], [Distance]) AS (
SELECT [Name], 
       [No_], 
       dbo.fn_Levenshtein('Mobel Meller', [Name]) 
  FROM [Table] 
)

SELECT * 
FROM Result
WHERE [Distance] > 80
"
20140,Set datefirst permanently,"SELECT
    *
FROM
    sys.syslanguages
"
16524,tsql breadcrumb query,";WITH cte AS (
    SELECT 0 AS lvl, id, catName, parent,
        CAST(CAST(id AS VARCHAR(128)) + ':' + catName AS VARCHAR(128)) AS Sort
    FROM CategoriesMap WHERE id =2
    UNION ALL
    SELECT p.lvl + 1, c.id, c.catName, c.parent,
        CAST(CAST(c.id AS VARCHAR) + ':' + c.catName + '_' + p.Sort AS VARCHAR(128))
    FROM CategoriesMap c
    INNER JOIN cte p ON p.parent = c.id
)
select * from cte
"
11930,Why is there a SELECT 1 from table?,"SELECT count(*) INTO miss
  FROM billing b
  LEFT JOIN vas NV ON NV.network = b.network
 WHERE b.network = network1
   AND NV.network IS NULL
"
15691,SQL Server 2008 - Go From Select to Edit Quickly,"SELECT TOP(200) .....
"
37472,How to count rows using group by,"select count(distinct block) as total_block from tablename
"
13016,Basic SQL Queries - retrieve set based on foreign key,"SELECT D.Dept_name
FROM DB.positions P INNER JOIN DB.dept D 
  ON P.DeptID = D.Dept_Id 
GROUP BY D.Dept_name
HAVING COUNT(*) > 1
ORDER BY D.Dept_name;
"
19971,TSQL Distinct does not work,"SELECT DISTINCT CD.GLOBAL_CONTENT_ID
FROM [CONTENT_DOWNLOAD] CD 
INNER JOIN PHYSICAL_ASSET AS PA ON CD.GLOBAL_CONTENT_ID = PA.GLOBAL_CONTENT_ID
WHERE CD.UPC = '00600753515501'
ORDER BY CD.GLOBAL_CONTENT_ID
"
7212,'WHERE' syntax equivalent of LEFT OUTER JOIN in PostgreSQL,"select *
from table t1
  left join table t2 on t1.id = t2.id;
"
30615,please help me to create multi insert query,"--INSERT t2 (cid, isnews)
SELECT t1.cid, t1.isnews
FROM t1
    LEFT JOIN t2 ON t1.cid = t2.cid
WHERE t2.cid IS NULL
"
29350,SQL - detecting loops in parent child relations,"with prev as (
    select RowId, 1 AS GenerationsRemoved
    from YourTable
    union all
    select RowId, prev.GenerationsRemoved + 1
    from prev
    inner join YourTable on prev.RowId = ParentRowId
    and prev.GenerationsRemoved < 55
)
select * 
from prev
where GenerationsRemoved > 50
"
1295,Using single query to retrieve multivalued attribute by joining two tables without causing duplication of fields in mysql,"select c.applicationNo, 
       max(c.name) name,
       max(p.phoneNo) phoneNo1,
       case 
           when max(p.phoneNo) = min(p.phoneNo) then NULL 
           else min(p.phoneNo) 
       end phoneNo2
from client c
left join phoneNo p on c.applicationNo = p.applicationNo
group by c.applicationNo
"
18523,Does anyone know a neat trick for reusing identity values?,"SELECT a.id
FROM table AS a
LEFT OUTER JOIN table AS b ON a.id = b.id+1
WHERE b.id IS NULL;
"
37128,mySQL query for association table where ID is blank,"SELECT  p.* 
FROM    posts p
        LEFT JOIN comments c
            ON p.id = c.post_id AND c.user_id = 124
WHERE   c.post_id IS NULL
"
4110,Cannot create SQL Encryption Key,"USE master;
GO
CREATE MASTER KEY ENCRYPTION BY PASSWORD = '5tr0ngP@ssW0rd'
GO

OPEN MASTER KEY DECRYPTION BY PASSWORD = '5tr0ngP@ssW0rd'

CREATE CERTIFICATE MyDBcert 
  WITH SUBJECT = 'The Cert For MyDB';
GO

USE MyDB;
GO

CREATE DATABASE ENCRYPTION KEY
  WITH ALGORITHM = AES_256 
  ENCRYPTION BY SERVER CERTIFICATE MyDBcert;
GO
"
27165,Selecting 5 Most Recent Records Of Each Group,"select values from
(select values ROW_NUMBER() over (PARTITION by <GroupColumn> order by <OrderColumn>) 
as rownum from YourTable) ut where ut.rownum<=5
"
9954,mysql Calculation of Time Difference for Unique User Listing,"select distinct(users) , avisitedDate from visitSearchEngine vs
WHERE vs.users!=' ' 
AND vs.status='0' 
AND hitType='googleIdentified'
AND avisitedDate>'2012-12-06' 
AND time_to_sec(timediff(now(),avisitedDate))>=10*60
AND time_to_sec(timediff(now(),avisitedDate))<11*60
"
37872,Why would you want a case sensitive database?,"SELECT * FROM t WHERE LOWER(name) = 'something';
"
15696,SQL get decimal with only 2 places with no round,"SELECT ROUND(3381.5786, 2, 1)
"
14413,Check if a list of items already exists in a SQL database,"Select GroupId
 From (
  Select GroupId
       , count(*) as GroupMemberCount
       , Sum(case when MyUserIDList.UserID is null then 0 else 1 End) as  GroupMemberCountInMyList
  from GroupUser 
     left outer join MyUserIDList on GroupUser.UserID=MyUserIDList.UserID
 group by GroupId
 ) As MySubQuery 
Where GroupMemberCount=GroupMemberCountInMyList
"
15873,Expressing age between two years,"where AcquiredDate >= dateadd(year, -5, GetDate()) and
      AcquiredDate < dateadd(year , -3, GetDate())
"
12890,how to convert result of an select sql query into a new table in ms access,"SELECT a,b,c INTO NewTable 
FROM (SELECT a,b,c
FROM TheTable
WHERE a Is Null)
"
26817,Joining four tables and concatenating results of one - MySQL,"select bid, title, users.name, group_concat(tags.tag)
from blogs inner join users on blogs.uid=users.uid
inner join blogtags on blogs.bid=blogtags.bid
inner join tags on tabs.tif=blogtags.bid
group by bid, title, users.name
"
29044,SQL: grouping by number of entries and entry date,"select event_date,
  sum(case when cnt between 0 and 2 then 1 else 0 end) as ""0-2"",
  sum(case when cnt = 3 then 1 else 0 end) as ""3"",
  sum(case when cnt between 4 and 99 then 1 else 0 end) as ""4-99""
from 
    (select cast(event_time as date) as event_date, 
      name,
      count(1) as cnt
    from log
    group by cast(event_time as date), name) baseCnt
group by event_date
order by event_date
"
19258,SQL want to avoid repeated rows,"select id, name, department, total
from
(
SELECT e.id, e.name, e.department, t.total,
rank() over(partition by e.department order by t.total desc) as rnk
FROM (
SELECT id, SUM(hours) AS total
FROM hours
GROUP BY id
) t JOIN employee e ON e.id = t.id
) t
where rnk = 1
order by total desc
"
16771,How to run an SQL Update string from bash script with parameter?,"#!/bin/bash

if [ $# -lt 1 ]
  then
    echo ""USAGE: ./update.sh [newvalue]""
    echo ""       [newvalue] represents the new value to insert into the DB.""
    exit
fi

NEWVAL=$(echo $1 | sed ""s/'/\\\'/g"")
SQL=""UPDATE modules_config_x_roomtypes SET value = '""$NEWVAL""' WHERE modules_config_id = (SELECT id FROM modules_config WHERE module_id = (SELECT id FROM modules WHERE name = 'system') AND name = 'theme');""
echo ""$SQL"" | mysql --user=user --password=password
"
20062,How to use the data dictionary,"SELECT * FROM user_ind_columns
"
7598,prompt user for table in oracle,"SELECT column_name ""Column Name"", data_type ""Data Type"", data_length ""Data Length"",
                   data_precision ""Data Precision"", nullable ""NULLS Allowed?""
FROM user_tab_columns
WHERE table_name = UPPER('&tabname')
/
"
15798,Filter by column alias (firebird sql),"SELECT dis FROM
  (SELECT DistanceMeters(""Latitude_C_"", ""Longitude_C_"", 44.894115, -123.031717) as dis 
   FROM CURR_LOCATION)
WHERE dis < 5000 ORDER BY dis
"
5347,Not getting the Join I want,"SELECT SUM(score_hours)
FROM A
JOIN (SELECT DISTINCT uid
      FROM B) AS B
ON A.uid = B.uid
"
16421,Filtering out null values in a linq search,"var result = myEntities.Books;

if(string.IsNullOrWhiteSpace(book.Author) == false)
{
  result = result.Where(x => x.Author == book.Author);
}

if(string.IsNullOrWhiteSpace(book.Name) == false)
{
  result = result.Where(x => x.Name == book.Name);
}

...And so on.

return result;
"
17504,Replace just start of string in sql,"update table t
    set cell = concat('/rr', substr(cell, 4))
    where cell like '/ta%';
"
3686,need to read data from oracle database with many conditions,"select  b.os
     , c.package_version
     , count(a.employee_name)
from B
  join A  on (b.id=a.id)
  join C  on (b.id=c.id)
group by b.os,c.package_version
"
16902,SQL Server: Join Three Tables and Return With Null Records,"SELECT Games.Title, Genres.Name
FROM Games
LEFT JOIN GameGenres ON Games.Id = GameGenres.GameId
LEFT JOIN Genres ON GameGenres.GenreId = Genres.Id
"
15481,INSERT ... ON DUPLICATE KEY -- how to do this on a non primary key?,"update track set
title = ?
where track_id = ?;

insert into track (nonkey_col_1, nonkey_col_2, ...)
select 'nonkey_col_1_value',  'nonkey_col_2_value', ...
from track
where not exists (select * from track where track_id = ?)
limit 1;
"
19823,Order By Clause Not working with GROUP BY,"SELECT  COUNT(id) total,
        DATEPART(HOUR, purchased_on) label,
        site
FROM    dhs.dbo.orders
WHERE   purchased_on >= '01/16/2013'
GROUP BY
        DATEPART(HOUR, purchased_on), site
ORDER BY
        label DESC
"
717,How to reuse selection result in SQL SERVER PROCEDURE,"WITH sample AS (
  SELECT TOP(@count)
         te.*
    FROM TABLE_ENTRIES te
   WHERE te.retrieved IS NULL)
UPDATE sample
   SET retrieved = CURRENT_TIMESTAMP
"
31427,Where am I going wrong? Selecting results that are not in a sub-query,"SELECT * 
FROM dbo.tbl_inspectors 
WHERE user_id NOT IN (Select user_id 
                      FROM dbo.vw_alerts 
                      WHERE alertID=1
                        AND user_id is not null)
"
25458,How to add a where clause to a column from a correlated subquery,"SELECT * FROM (
select *, [Status]=(select Max([Status]) from Data_121EmailLog o2 
where o2.Data_121Id = o1.Data_121Id) from Data_121 o1) a where a.[Status] = 2
"
30518,update date if it is one day late,"    update t1
    set t1.curr_value_datetime = t2.curr_value_datetime
    from #temp t1
       join #temp t2
          on t1.curr_value_datetime - 1 = t2.curr_value_datetime
"
20369,T-SQL average calculation,"SELECT  Product,
        Month,
        Year,
        Value,
        AVG_YTD = AVG(Value) OVER(PARTITION BY Year ORDER BY Month),
        AVG_Year = AVG(Value) OVER(PARTITION BY Product, Year),
        AVG_Overall = AVG(Value) OVER(PARTITION BY Product)
FROM    T;
"
37932,"SQL queries: expects more than one results, but only one returns","  SELECT g.genre_name, 
         count(distinct(d.director_id))
    FROM genre g, 
         director d, 
         movie m
   WHERE g.genre_id=m.genre_id 
         AND m.director_id=d.director_id
GROUP BY g.genre_name;   
"
3098,My SQL SELECT statement is not picking up any records when dates are the same,"string sql  = ""SELECT * FROM EDI10000 WHERE Tp_Id = '"" + tp + ""' and Rec_Date >= '"" + fromDt.ToString(""yyyy-MM-dd"") + ""' and Rec_Date <= '"" + toDt.ToString(""yyyy-MM-dd"") + ""'"";
"
39119,Find the tables affected by SQL injection,"SELECT TABLE_NAME, COLUMN_NAME
FROM sysindexes AS i 
INNER JOIN sysobjects AS o 
ON i.id=o.id 
INNER JOIN INFORMATION_SCHEMA.COLUMNS 
ON o.NAME=TABLE_NAME 
WHERE(indid=0 or indid=1) 
and DATA_TYPE like '%varchar' 
and(CHARACTER_MAXIMUM_LENGTH=-1 or CHARACTER_MAXIMUM_LENGTH=2147483647);
"
30528,What exactly is a database schema?,"SELECT * FROM [database].[schema].[table]
"
27654,MVC EntityFramework - How to create an SQL IN condition,"var yourIds=new List<int>{1,2,3,4};
var result= db.yourTable.Where (u => yourIds.Contains(u.IdToCompare));
"
17858,How to aggregate column on changing criteria in SQL (multiple SUMIFS),"select jt.PersonID, jt.JobTitle, jt.StartDate, jt.EndDate, coalesce(sum(amt), 0) as amt
from JobTitles jt left join
     Transactions t
     on jt.PersonId = t.PersonId and
        t.TransDate between jt.StartDate and jt.EndDate
group by jt.PersonID, jt.JobTitle, jt.StartDate, jt.EndDate;
"
27691,atomic compare and swap in a database,"update top (1) [<table>]
set status = z 
output DELETED.*
where  status = y;
"
33256,Call a Package from Apex passing two values,"create or replace PACKAGE ""PKG_MAIL_SEND"" as  
  -- let this procedure have 2 parameters:
  PROCEDURE proc_mail_send(p_address in varchar2, p_topic in varchar2);
  PROCEDURE proc_job_mail_send;
  PROCEDURE proc_kill_job_mail;
end PKG__MAIL_SEND;
"
23274,Finding next row in SQL query and deleting it only if previous row matches,"with C as
(
  select ID,
         row_number() over(order by DT) as rn
  from YourTable
)
delete C1
from C as C1
  inner join C as C2
    on C1.rn = C2.rn-1 and
       C1.ID = C2.ID
"
9453,SQL - Why pad spaces when comparing characters?,"SELECT * from SOME_TABLE where CUSTOMER_NAME = 'Popeye '
"
34727,Splitting long strings in SQL,"-- CREATE A STRING TO SPLIT WITH OVER 100 DELIMITERS
DECLARE @s VARCHAR(1000) = 'a'

SELECT  @s = @s + ',a'
FROM    master..spt_values
WHERE   type= 'p'
AND     number BETWEEN 1 AND 150

--SPLIT LONG STRING
SELECT  *
FROM    dbo.splitString(@s, ',')
OPTION (MAXRECURSION 0) -- NO LIMIT
"
20314,Is it possible to set up a sql view so that any joins are only performed when required?,"CREATE UNIQUE INDEX ix
  ON Person.EmailAddress(BusinessEntityID) 
"
12036,Problems deleting data from database,"String sql = ""delete from attribute where timestamp > to_date('""+parameter+""','YYYY-MM-DD')""
Query query = session.createSQLQuery(sql);
query.executeUpdate();
"
6758,Updating 2 tables Oracle,"MERGE INTO fgmulti FGM
USING
    (SELECT * FROM arinvt 
     WHERE class LIKE 'CP%'
     OR  class LIKE  'FG%'
     OR  class LIKE   'IN%' 
     OR  class LIKE   'LA%' 
     OR  class LIKE   'PK%') Classes
ON (fgm.arinvt_id = classes.id
    and fgm.in_date = sysdate)
WHEN MATCHED THEN
    UPDATE SET non_conform_id = '21'
"
33694,MySql query to order by existence in another table,"SELECT products.*, product_info.*
FROM products
INNER JOIN product_info ON product_info.product_id = products.id
LEFT JOIN specials ON specials.product_d = products.id
                  AND specials.from_date < NOW()
                  AND specials.to_date > NOW()
WHERE product_info.LANGUAGE = 'en'
  AND product_info.title LIKE ?
ORDER BY CASE 
    WHEN specials.product_id IS NOT NULL THEN 2
    ELSE 1
    END DESC,
  products.id DESC,
  products.created_at DESC
"
16570,How to get a list from comma seperated data in mysql,"SELECT  a.*
FROM    Product a
        INNER JOIN Product b
            ON FIND_IN_SET(a.productId, b.RelatedProductIds) > 0
WHERE   b.productID = 11        
"
36294,VB.NET Multiple Table search function with Mysql,"SQL= ""SELECT * from mydatabase 
       where id like '%"" & search.Text &""%""
          Or name like '%"" & search.Text &""%""
          Or lastname like '%"" & search.Text & ""%'""
"
23127,Connect 2 queries,"SELECT (SELECT Count(DISTINCT custpersonid) AS count1 
    FROM   my_precustperson 
    WHERE  rsv_no = 1510708 
           AND custpersonid IS NOT NULL) 
    + (SELECT Count(*) AS count2 
      FROM   my_precustperson 
      WHERE  rsv_no = 1510708 
             AND custpersonid IS NULL); 
"
25275,Where clause in count,"select
count (case when [column]>20 then 1 else null end) as [a],
count (case when [column]<20 and [column]>10 then 1 else null end) as [b]
from
table
"
1118,Getting Aggregate Values Grouped By Date from Four Tables Simultaneously,"select 
    myDate,
    count(case when n = 1 then 1 end) count1,
    count(case when n = 2 then 1 end) count2,
    count(case when n = 3 then 1 end) count3,
    count(case when n = 4 then 1 end) count4
from (
    select 1 n, cast(Datestamp as Date) myDate from table1
    union all select 2, cast(Datestamp as Date) myDate from table2
    union all select 3, cast(Datestamp as Date) myDate from table3
    union all select 4, cast(Datestamp as Date) myDate from table4
) t 
group by myDate
"
24944,SQL How to convert a decimal to a string,"SELECT TO_CHAR(123.45) FROM DUAL

SELECT CAST(123.45 AS VARCHAR2(10)) FROM DUAL
"
23060,mysql remove only specific text from rows,"UPDATE tableName SET
       StreetView=Replace(StreetView,SUBSTRING_INDEX(StreetView,'https://maps',1),'')
"
23399,Select records with 2 type of sort,"SELECT
    a.*,
    b.price
FROM table1 AS a
LEFT OUTER JOIN
(
    SELECT  
        table1_id,
        MAX(price) AS price
    FROM table2
    GROUP BY table1_id
) AS b
    ON b.table1_id = a.id
ORDER BY a.id ASC, b.price DESC
"
7133,SQL AND OR evaluating to different results,"WHERE sp.SupplierID=s.SupplierID
AND sp.ProductID=r.productID
AND (r.Reason LIKE  'Scratched CD'
OR r.Reason LIKE 'Unreadable disk')
"
7612,Select ID from GROUP BY group if the group satisfied criteria,"SELECT Lot_ID
  FROM Table1
 GROUP BY Lot_ID
HAVING SUM(IIF(Shipping_date IS NULL, 1, 0)) = 0
"
5229,Convert Unix Timestamp iinto YYYYMMDD,"SELECT CONVERT(VARCHAR(10), DATEADD(ss, msg.[timestamp]/1000, '01/01/1970'), 120)
FROM dbo.cp_messages msg
"
11324,Iterate backwards with offset in FQL request for comments,"SELECT id, fromid, text, time, likes, user_likes FROM comment
WHERE object_id = [FB_OBJ_ID] ORDER BY time DESC LIMIT 25 OFFSET 26
"
9350,Selecting Records in Joined Tables,"SELECT 
  Slot.SlotNumber, 
  Slot.SlotTime, 
  Appointment.TeacherID
FROM 
  Slot 
  LEFT JOIN Appointment 
    ON (Slot.SlotNumber = Appointment.SlotNumber
    AND Appointment.TeacherID=""CR"")
"
13263,Optimal key for MySQL / InnoDB table with multi-part WHERE,"UPDATE transactions
   SET STATUS_IND = 5
 WHERE COMPANY_ID = ?
   AND STATUS_IND IN (3, 7)
   AND CREATION_DT BETWEEN ? AND ?
"
36463,How to check if I can remove index from DB in SQL Server,"SELECT 'DROP INDEX ' + name + ' ON ' + object_name(object_id)
FROM sys.indexes
WHERE is_primary_key = 0 AND is_unique_constraint = 0
AND OBJECTPROPERTY(object_id, 'IsMSShipped') = 0     -- exclude system-level tables
AND name IS NOT NULL
"
22963,Check if table is empty in runtime,"CREATE OR REPLACE FUNCTION __table_is_empty(param character varying) 
RETURNS bool
AS $$
DECLARE
 v int;
BEGIN
      EXECUTE 'select 1 WHERE EXISTS( SELECT 1 FROM ' || quote_ident(param) || ' ) '
            INTO v;
      IF v THEN return false; ELSE return true; END IF;
END;
$$ LANGUAGE plpgsql;
/
"
5722,Query Optimisation - Collating result from one to many relationship table efficiently in SQL,"SELECT Item.item, 
       MAX(case when variant_order=1 then variant end) as variant1,
       MAX(case when variant_order=2 then variant end) as variant2,
       MAX(case when variant_order=3 then variant end) as variant3
from ItemVariant
LEFT JOIN Item ON Item.item_id = ItemVariant.item_id
GROUP BY Item.item;
"
15118,SQL optimise IF EXISTS,"SELECT *
INTO #SearchResults_2
FROM #SearchResults sr
WHERE sr.src_data_col1 = @SearchCriteria OR
      sr.src_data_col2 = @SearchCriteria OR
      sr.src_data_col3 = @SearchCriteria;

IF EXISTS (SELECT 1 FROM #SearchResults_2)
BEGIN
    SELECT *
    FROM #SearchResults_2;
END
ELSE BEGIN
    SELECT *
    FROM #SearchResults;
END;
"
6537,How to get output like SQLPLUS while Running SQL Query in shell script,"echo ""$RETVAL""
"
5481,"MySQL, select multiple rows as one based on foreign key","SELECT users.name, group_concat( fruit )
FROM users,fruits 
WHERE users.id=fruits.userid AND users.age<34
group by user.name
"
16976,How can I write a WHERE clause in SQL to filter a DATETIME column by the time of day (overnight)?,"WHERE datepart(hour, tbLogTimeValues.DateTimeStamp) < 07 or
      datepart(hour, tbLogTimeValues.DateTimeStamp) > 19
"
19105,Oracle 11g: LISTAGG ignores NULL values,"select replace(listagg(NVL(col1, '#'), '#') 
within group(order by rownum),'###','##') from table1
"
12745,Select from two tables return nulls,"SELECT r . * , ra.blg, ra.ben, ra.uid 
FROM rooms r 
LEFT JOIN
    room_access ra
ON
    r.id = ra.rid 
AND 
    ra.uid =1
"
3298,SQL Server check for data being updated,"select max_dt, theType from
datalog d inner join
(SELECT max(theDt) as max_dt FROM dataLog) m
on d.theDt = m.max_dt
"
30863,SQL to find missing linking table rows,"SELECT A.aId, B.bId
FROM A CROSS JOIN B
WHERE NOT EXISTS (SELECT 1
                  FROM A_B
                  WHERE aId = A.aID
                    AND bId = B.bID)
"
19244,How do I limit a query with distinct values in MariaDB,"select *
from Table1 as T1
join (
  select distinct num
  from Table1 
  order by num
  limit 2 ) as T2
on T1.num = T2.num  
  ;
"
21871,"If not exists in another table, set to NULL","SELECT rec.id, title.name
FROM Records rec
LEFT JOIN Titles title ON title.record_id = rec.id and title.language='de';

SELECT rec.id, title.name
FROM Records rec
LEFT JOIN Titles title ON title.record_id = rec.id and title.language='en';


ID  NAME
1   ACHTUNG
2   (null)

ID  NAME
1   Warning
2   Ambulance
"
7072,DB2 how to get the last insert id from a table,"select id from NEW TABLE (insert into (val1, val2, ...) values ('lorem', 'ipsum', ...))
"
35591,SQL Query to get first two highest column values from a table,"select salary from employee
order by salary desc
limit 2
"
12801,How to split a table in 4 groups?,"select max(case when seq % 4 = 1 then part_no end) as part_no_a,
       max(case when seq % 4 = 2 then part_no end) as part_no_b,
       max(case when seq % 4 = 3 then part_no end) as part_no_c,
       max(case when seq % 4 = 0 then part_no end) as part_no_d
from databasetable t
group by ((seq - 1) / 4);
"
168,How can I combine fixed month and day with sql year function?,"DECLARE @date datetime = DATEFROMPARTS( 2014, 12, 31 )
"
7601,SQL ORDER BY but also by MIN of different col (aka threading)?,"SELECT
    table.Type,
    table.value
FROM (
    SELECT 
        Type,
        min(value) AS minValue
    FROM table
    GROUP BY Type
) AS sub
INNER JOIN table
    ON table.Type = sub.Type
ORDER BY sub.minValue ASC, table.Type ASC, table.value ASC
"
29530,Checking if an update already took place in ACCESS,"INSERT INTO DB_TOTAL
SELECT  a.*
FROM    Tags_DI_DB a
        LEFT JOIN DB_TOTAL b
            ON a.colName = b.colName
WHERE   b.colName IS NULL
"
32901,Joining data from 2 tables,"select 
    t.employeeid as employee_id, 
    t.manager_id as manager_id, 
    t2.contact_id as manager_contact_id 
from mytable t left outer join mytable t2 on t.managerid = t2.employeeid
"
22593,DateTimeOffset Support in Compact Framework 3.5,"class MyDateTimeOffset
{
    public DateTime UTCTime { get; set; }
    public int BiasInMinutes { get; set; }

    public DateTime AsLocalTime()
    {
        var localBias = (DateTime.Now - DateTime.UtcNow).TotalMinutes;

        return UTCTime.AddMinutes(BiasInMinutes - localBias);
    }
}
"
14664,How can I concatenate columns in a INSERT SELECT,"...SELECT [PatientName] + ', ' + ....
"
9974,teradata sql pivot multiple occurrences into additional columns,"select id,
    max(case when seq =1 then result end) result1,
    max(case when seq =2 then result end) result2,
    max(case when seq =3 then result end) result3
from
(
    select id, res, row_number() over(partition by id order by result) seq
    from yourtable
) d
group by id
order by id;
"
34747,SQL count without wrapping query,"SELECT COUNT(DISTINCT site)
FROM (SELECT...) x LEFT JOIN
     foo.bars 
     ON foo.id = x.id;
"
21272,Getting the most recent data from a dataset based on a date field,"SELECT
  MAX(id)
FROM
  ds INNER JOIN (
    SELECT Sid, Max(AddDate) AS MaxAddDate
    FROM ds
    GROUP BY ds.Sid) mx
  ON ds.Sid = mx.Sid AND (ds.AddDate=mx.MaxAddDate or MaxAddDate IS NULL)
GROUP BY
  ds.Sid
"
17223,How to insert 1 million records into table database Oracle using cross join,"insert into apl2(id, data) select rownum ,s1.data from apl2 s1, apl2 s2, apl2 s3, apl2 s4, apl2 s5, apl2 s6 where rownum < 1000001;
"
1154,Using Spool in Oracle 11g,"spool all_queries.txt
select * from A;
select * from B;
select * from C;
spool off

spool only_d_query.txt
select * from D;
spool off

host cat only_d_query.txt >>all_queries.txt

spool all_queries.txt append
select * from E;
spool off
"
8587,MYSQL match csv keywords column,"SELECT  *
FROM    user
WHERE   FIND_IN_SET('10', keywords) > 0 OR
        FIND_IN_SET('20', keywords) > 0 
"
36583,How to get the recors with count zero if there are no records,"SELECT VM.vacation_id,
       VM.vacation_desc,
       isnull(sum(VR.total_hours_applied),0) AS totalCount
FROM EMPTYPE_VACATIONCONFIG VC
LEFT JOIN HR_Vacation_Master VM ON VC.VACATIONID=VM.vacation_id
LEFT JOIN HR_Employee_Vacation_Request VR 
    ON VR.vacation_id=VM.vacation_id AND VR.employee_id=156
WHERE VC.BRANCHID=20
GROUP BY VM.vacation_desc,
         VM.vacation_id
"
34514,Get the biggest number in database column,"SqlConnection sqlConnection1 = new SqlConnection(""Your Connection String"");
SqlCommand cmd = new SqlCommand();
SqlDataReader reader;
cmd.CommandText = ""SELECT (ISNULL(MAX(yourcolumn), 0) + 1) as BigNum FROM yourtable"";
cmd.CommandType = CommandType.Text;
cmd.Connection = sqlConnection1;
sqlConnection1.Open();
reader = cmd.ExecuteReader();
    if (reader.Read())
{
    int bingnum =Convert.ToInt32( reader[""BigNum""]);
}
sqlConnection1.Close();
"
8346,Load specific ID range on MySQL,"SELECT * FROM Test LIMIT 10, 15
"
1569,Why Select eliminating NULL records on a varchar comparison,"select * from people where PEOPLE_TYPE != 'BOARD' or PEOPLE_TYPE is null
"
25725,SQL query without aggregates,"select * from t
where age >= all (select age from t)
"
18705,Conditionally add a new column in conjunction with UNION ALL in PostgreSQL,"CREATE TABLE x AS 
SELECT 'y' src, * FROM y
UNION ALL
SELECT 'z' src, * FROM z;
"
6464,Rewrite UNION as JOIN,"select distinct on (grp) t.*
from temp t
order by grp,
         deleted::int asc,
         version desc;
"
6126,Adding the same month in sql,"SELECT [Purchased Product], sum(CONVERT(INT, [Purchased Quantity])) as [Purchased Quantity],
       datename(month, [Purchased Date])  AS [Purchased Date]
from StudentPurchasedHistoryTable
WHERE DATENAME(month, [Purchased Date]) = 'August'
group by [Purchased Product], datename(month, [Purchased Date]);
"
4765,Narrow down results with SQL joins?,"select ALBUMS.category_id
,      ALBUMS.album_id
,      ALBUMS.album_name
,      ALBUMS.artist_id
,      ARTISTS.artist_name
from   ALBUMS
       inner join ARTISTS on ALBUMS.artist_id = ARTISTS.artist_id
       inner join CATEGORIES on ALBUMS.category_id = CATEGORIES .category_id
where  CATEGORIES.category_name = 'Your category name'
"
27019,database query help wanted,"create view newest123 as ( -- this gets the newest review for member_id 123
  select * 
   from reviews 
   where member_id = 123 
   order by date desc limit 1
)

select * 
from (
  select * from newest123
  union
  select *                    -- all the reviews that aren't for member_id 123
    from reviews 
    where member_id != 123) filtered
order by date desc limit 10   -- sort 'em and take the top 10
"
1140,MySQL - Class name as 2 columns,"mysql> select * from f;
+------+
| c    |
+------+
| 10AB |
+------+
1 row in set (0.00 sec)

mysql> select substr(c from 1 for length(c*1)) as Class, substr(c from length(c*1)+1) as ClassId from f;
+-------+---------+
| Class | ClassId |
+-------+---------+
| 10    | AB      |
+-------+---------+
1 row in set (0.00 sec)
"
16446,Concatenate Two dates and their times in SQL Server 2008,"CONVERT(CHAR(16), s.StartTime, 120) + '-' +
CONVERT(CHAR(16), s.EndTime,   120) AS OccupiedTime
"
31401,want SELECT to return multiple values in a single row,"SELECT name, GROUP_CONCAT(start_time ORDER BY start_time) AS start_times
FROM your_table GROUP BY name
ORDER BY COUNT(start_time)
"
27423,Syntax for adding inverted commas in T-SQL using Visual Studio (SQL),"where ',' + @PostCode + ',' like '%,' + PCode + ',%'
"
22021,What is the best way to select multiple rows by ID in sql?,"SELECT *
FROM `table`
where ID in (5263, 5625, 5628, 5621) 
"
5945,SELECT DISTINCT `col` WHERE (`col` is not unique),"SELECT country FROM customers GROUP BY country HAVING Count(*)>1
"
12912,How to return the latest record to each person ID in SQL,"SELECT *
FROM TPER_VISA t1
WHERE per_visa_ed <= '20151101'
AND NOT EXISTS (select 1 from TPER_VISA t2
                where t2.personId = t1.personId
                  and t2.per_visa_ed <= '20151101'
                  and t2.per_visa_ed > t1.per_visa_ed)
ORDER BY per_visa_ed
"
30843,MySQL: Using NULL as wildcard in JOIN statement,"SELECT order_id, item_id
FROM orders
INNER JOIN items ON (orders.color IS NULL OR orders.color = items.color)
    AND (orders.size IS NULL OR orders.size = items.size)
"
4022,How to set the foreign key in sql server,"UserId as CAST('08U1'+right('0000'+cast(Id as varchar(5)), 5) AS char(9)) persisted
"
32185,case when null then empty in oracle insert statement,"IF Nvl(:old.track_name, 'NULL') <> Nvl(:new.track_name, 'NULL') THEN
"
16403,How to create multiple rows from a single row,"SELECT
    Name
  , Seat
  , CA1.Aaisle
  , CA1.Baisle
  , CA1.Caisle
FROM UnPivotMe
CROSS APPLY (
    VALUES 
                (FA1, FB1, FC1)
              , (FA2, FB2, FC2)
              , (FA3, FB3, Fc3)
            ) AS CA1 (Aaisle, Baisle, Caisle)
;
"
12493,Timestamp difference between rows in Postgresql,"SELECT EXTRACT(WEEK FROM o.data_crea) AS owned_week
     , iduser, idobject
     , EXTRACT('epoch' FROM (o.data_crea - f.data_crea)) AS diff_in_sek
FROM  (SELECT * FROM newnotification WHERE typology = 'owned_task') o
JOIN  (SELECT * FROM newnotification WHERE typology = 'fwd_task')   f
                                                         USING (iduser, idobject)
ORDER  BY 1,4
"
23702,I would like to make a field part of a many to many relationship,"store_id    zip
1           11111
1           12222
2           12222
2           22222
"
31162,How can I easily flatten this Sql Server hierarchy into an inherited inclusive list?,"WITH X (ProductId, CategoryId) AS (
    SELECT ProductId, CategoryId FROM #ProductCategory
    UNION ALL
    SELECT X.ProductId, C.ParentCategoryId FROM X
    INNER JOIN #Category C ON X.CategoryId = C.CategoryId
)
SELECT ProductId, CategoryId FROM X ORDER BY CategoryId, ProductId
"
26558,Modify codification on a database informix table,"DB_LOCALE=en_US.utf8 CLIENT_LOCALE=en_US.utf8 dbaccess - - <<EOF
CREATE DATABASE database_name WITH BUFFERED LOG;
EOF
"
25841,stored procedures that counts specific users,"SELECT PromouterId, SUM(FrendsCame)
FROM table
GROUP BY PromouterId;
"
9369,how to take the year using date stored in DataBase:,"IF YEAR(MyDateColumn) = @year ...
"
8167,SQL : select record from table 1 which are not in table 2,"SELECT d.*
FROM department d
LEFT JOIN employee e
  ON d.emp_id = e.id
WHERE e.id IS NULL;
"
10528,Updating specific rows in a table that is a list of lists,"  UPDATE listtable t1 
  SET t1.column3 = ';'
  WHERE t1.column2 < ( SELECT MAX(t2.column2) 
                       FROM listtable t2 
                       WHERE t1.column1 = t2.column1 )
"
2733,How to get the Hour between two Dates in SQL,"CAST(DATEDIFF(MINUTE, p.FechaInicio, p.FechaFin) / 60.0 AS DECIMAL(5,1)) as 'Duracion' from Programaciones
"
34077,Oracle SQL Group by self made column?,"SELECT CASE
          WHEN teile LIKE 'S%' THEN
           'vent'
          ELSE
           teile
       END AS teile,
       SUM(amount) 
...
 GROUP BY 
       CASE
          WHEN teile LIKE 'S%' THEN
           'vent'
          ELSE
           teile
       END;
"
30702,Select multiple values from two tables using horizontal relation with other table,"select name, id,
case when mid is not null then 1 else 0 +
case when meid is not null then 1 else 0 +
case when gid is not null then 1 else 0 +
case when wid is not null then 1 else 0 +
case when bid is not null then 1 else 0 
end as count
from BRAND
"
7040,MYSQL counting rows until last different row,"select e.user, count(*) as NumFailedAttempts
from events e
where e.event = 'Failed Log In' and
      e.eventdatetime > (select max(e2.eventdatetime)
                         from events e2
                         where e2.user = e.user and e2.event = 'Successful Log In'
                        );
"
10591,restore backup database with out sql server management studio,"SqlCmd -E -S MyServer –Q “RESTORE DATABASE [MyDB] 
       FROM DISK=’D:BackupsMyDB.bak(Your backup Databse file)’”
"
28263,Hive - split cell into multiple column,"select 
name, location,
substr(code, 1, instr(code,'-')-1) as id, 
substr(code, instr(code,'-')+1) as per
from orig_table;
"
27126,Translate SQL Query into LINQ Query,"db.Server
    .Where
    (
        x=>
            db.Gruppen
            .Where(g=>g.Id == 1)
            .Select(g=>g.Name)
            .Contains(x.GruppenName)
    );
"
29445,Is there a better way - Union All/Order By,"SELECT TOP 2 * FROM 
(
    SELECT Id, Name, DealDate FROM TestTable1
    UNION ALL 
    SELECT Id, Name, DealDate FROM TestTable2
) T1T2
ORDER BY DealDate DESC
"
16893,top 10 by category mysql,"SELECT person, category, amount
FROM (
  SELECT person, category, amount,
         @rn := IF(@cat = category, @rn+1,
                   IF(@cat := category, 1, 1)) AS rn
  FROM mytable
  CROSS JOIN (SELECT @rn := 0, @cat := '') AS vars
  ORDER BY category, amount DESC) AS t
WHERE t.rn <= 10
"
23139,Insert row only if it doesn't exist already in MySQL,"You can add a primary key! It just has to be over two columns and not just one.
ALTER TABLE your_table
ADD PRIMARY KEY(idA, idB)
"
21672,Only return rows that match all criteria,"SELECT image_id FROM image_tags
  WHERE tag_id in (?,?,...)
  GROUP BY image_id HAVING count(*)=?
"
31169,How to calculate yearly cumulative return,"select stock
from (select t.*, row_number() over (partition by stock order by date) as seqnum,
             count(*) over (order by date) as cnt
      from table t
      where date >= 19980101
     ) t
group by stock
having (sum(case when seqnum = cnt then price end) /
        sum(case when seqnum = 1 then price end)
       ) >= 2.53;
"
29690,UPDATE on INSERT duplicate primary key in Oracle?," MERGE INTO Movie_Ratings M
       USING (SELECT 1 AS mid, 3 AS aid, 8 AS rating FROM dual) N
          ON (M.mid = N.mid AND M.aid = N.aid)
       WHEN     MATCHED THEN UPDATE SET M.rating = N.rating
       WHEN NOT MATCHED THEN INSERT(  mid,   aid,   rating)
                             VALUES(N.mid, N.aid, N.rating);
"
17653,Dump list of full paths of parent/child type records in SQL Server 2008 R2,"WITH grouppaths (group_id, group_path) AS
(
    SELECT group_id, pathname
    FROM GroupPath
    WHERE parent_group_id IS NULL

    UNION ALL

    SELECT gp.group_id, gps.group_path + '/' + gp.pathname
    FROM GroupPath gp
    JOIN grouppaths gps ON gps.group_id = gp.parent_group_id
)

SELECT 
  group_id, group_path
FROM
  grouppaths
"
375,What are the consequences of not closing database connection after an error?,"using (SqlConnection conn = new SqlConnection())
{
  // SqlCode here 
}
"
20690,Convert SQL subquery in Linq,"from p in db.Product
where (from sp in db.SiteProducts
       join sku in db.ProductSKU on sp.ProductId equals sku.Id
       where sp.siteid == 2
       select sku.ProductId).Distinct().Contains(p.ID)
select p
"
22177,how to select values that sum up to 60% of the total,"--save the whole sum into a variable
summa = select sum(val) from sometable;

select * 
  from sometable o 
 where (
        select sum(val) 
          from sometable i 
         where i.val <= o.val
       ) >= 0.6*summa;
"
31098,The fastest SQL expression for complex searching in many-to-many relationships?,"SELECT DISTINCT t1.productId FROM product_tags t1
JOIN product_tags t2 ON t1.productId=t2.productId AND t2.tagId IN (tag4,tag5,tag6)
JOIN product_tags t3 ON t1.productId=t3.productId AND t3.tagId IN (tag7, tag8, tag9)
AND t1.tagId IN (tag1,tag2,tag3)
"
8421,"Get the ""OR"" result of all rows of a bit column","select 
cast(max(cast([read] as int)) as bit) as [overall_read],
cast(max(cast([edit] as int)) as bit) as [overall_edit],
cast(max(cast([delete] as int)) as bit) as [overall_delete]
from tbl
"
10842,Query in sql server to sort data which has both numbers and alphabets,"SELECT YearLevel FROM student
GROUP BY YearLevel 
ORDER BY 
    (CASE 
        WHEN YearLevel LIKE 'Year%'
        THEN 'Year' + CONVERT(varchar,LEN(YearLevel)) + YearLevel
        ELSE YearLevel
    END)
"
19808,SQL Server - Providing priority to where clause condtions,"declare @target_site as Int = 1
select distinct a.site, a.id, a.name, b.mark
  from @t1 as a inner join
    @t2 as b on a.site = @target_site and a.id = b.id and
      ( a.site = b.site or ( b.site = 0 and not exists ( select 42 from @t2 where site = @target_site and id = a.id ) ) )
"
38396,how to select column names for the values those are bold?,"select
   case
      when BJP between AAP and Cong then BJP 
      when AAP between BJP and Cong then AAP 
      else Cong
   end as AgainstVote,
   case
      when BJP between AAP and Cong then 'BJP' 
      when AAP between BJP and Cong then 'AAP' 
      else 'Cong'
   end as AgainstPartyName
from tab
"
25207,Shorthand IF statements in sql,"SELECT * FROM TABLE WHERE (@vari is null or col = @vari)
"
17318,SQL Server 2008 Paged Row Retrieval and Large Tables,"WITH PAGED_QRY (
                   SELECT *, ROW_NUMVER() OVER(ORDER BY Y) AS ROW_NO
                   FROM TABLE WHERE ....
               ) 
SELECT * FROM PAGED_QRY WHERE ROW_NO BETWEEN @CURRENT_INDEX and @ ROWS_TO_RETRIEVE
ORDER BY ROW_NO
"
31084,Linq to SQL equivalent of SUM GROUP BY SQL statement,"var result = from t1 in table1
             from t2 in table2
             where t1.key == t2.key && DateTime.Parse(""2010-02-01"") <= t1.trndate && t1.trndate <= DateTime.Parse(""2010-02-28"")
             group new {t1,t2} by t1.vat into g
             select new { vat = g.Key, sum = g.Sum(p => p.t1.QTY*p.t2.FLG01 + p.t1.QTY*p.t2.FLG04)};
"
5013,MySQL SELECT query string matching,"SELECT * FROM customers
WHERE 'Robert Bob Smith III, PhD.' LIKE CONCAT('%',name,'%')
"
2102,How to merge (combine) 2 columns into 1 in oracle?,"select col1 || ' ' || col2 from tablex
"
13147,Having some troubles finding a string for in MySQL,"select * from foo where Concat(foo) regexp '(bar).*(bar)';
"
28590,Query showing exchange rates by date,"SELECT
   F.FOREDATE,
   F.FOREKEY,
   F.FORERATE
FROM FORERATE F
WHERE F.FOREDATE = (SELECT MAX(FOREDATE) 
                    FROM FORERATE FMD 
                    WHERE F.FOREKEY=FMD.FOREKEY)
"
30355,Count number of bookings between a set of specified dates,"SELECT date, COUNT(*)
FROM bookings
WHERE checkin >= '2012-06-10' AND checkout <= '2012-06-14'
GROUP BY date
"
28024,Top 5 with most friends,"SELECT bandId, COUNT(*) as fans FROM bandfriends
ORDER BY fans DESC
GROUP BY bandId
LIMIT 5;
"
18655,Executing an Oracle Stored Proc as Another User,"ALTER SESSION SET CURRENT_SCHEMA = schema
"
23818,Issue with Oracle select query,"select A.id 
from A,B 
where A.id = B.id and B.key in ('x','y','z') and B.value = 'false'
group by A.id
having count(distinct B.key)=3
"
11458,How to specify ORDER BY when using DELETE FROM in combination with OUTPUT?,";WITH T
     AS (SELECT TOP(1) *
         FROM   Schedule WITH (ROWLOCK, READPAST)
         WHERE  intScheduleType = @intScheduleType
         ORDER  BY dtmLastRunDate)
DELETE FROM T
OUTPUT DELETED.intUserID,
       DELETED.dtmLastRunDate  
"
31254,listing the data from two table,"select  *
from    staffdetails sd
where   not exists
        (
        select  *
        from    worklog w
        where   sd.stafid = w.stfid
                and starttime is not null
                and finishtime is null
        )
"
345,ORDER BY syntax with an XML column in SQL 2005,"SELECT U.UserId, UP.Profile, UP.UserParentID
FROM aspnet_Users U
    LEFT OUTER JOIN UserProperties UP ON U.UserId = UP.UserId
    OUTER APPLY UP.Profile.nodes('/Properties/property') p(prof)

WHERE UP.Profile.exist('/Properties/property[contains(.,sql:variable(""@cLookup""))]') = 1
    AND p.prof.value('@id', 'nvarchar(20)') = 'BusinessName'

ORDER BY p.prof.value('@name', 'nvarchar(100)')
"
22641,Date calculation using Getdate() and patindex,"dateadd(DAY, cast(left(CalendarHeaders.Description, patindex('%[^0-9]%',  CalendarHeaders.Description+'.') - 1) as int), getdate()) AS DateExpires
"
7468,Oracle SQL help regarding fetching a distinct balance,"select max(pdate) as pdate,
       ac_no,
       bal
from your_table
group by ac_no, bal
"
16059,Prediction with a Nested Table and DMX,"select predict([TransactionsMiningModel].[Code]) from [TransactionsMiningModel]
    natural prediction join 
    (select (
             select 'foobar' as [Item]
            ) as [Item Decomposition] ) as t
"
37182,Does #temp table share data to multiple users?,"declare @tbl table (id int, col1 varchar(50))
"
31616,SQL joining three tables and split into columns,"SELECT t2.`particular_name`,t1.`inward`,t1.`outward`,t2.`particular_price`,t3.`voucher_date` from Mess_stock t1 JOIN Add_grocery t2 ON t1.`particular_name`=t2.`sno` JOIN Mess_voucher t3 ON t3.`voucher_id`=t1.`voucher_id` ORDER BY t3.`voucher_date` DESC 
"
38472,How can I combine these SQL queries to be more efficient for MySQL?,"INSERT IGNORE INTO collectors_users
(username, password, email, dateadded, subscribed)
SELECT user, password, email, NOW(), 'Y'
FROM users 
WHERE user = 'njp316' 
LIMIT 1;

INSERT IGNORE INTO collections_collections 
(username, barcode)
SELECT user, barcode 
FROM collections 
WHERE user = user;
"
29616,Super flexible Oracle stored procedures / Dynamic SQL?,"EXECUTE IMMEDIATE dynamic_string
"
28512,Database design - nullable fields,"create table notifications( 
    notification_id serial primary key, 
    date_created timestamp not null default now(), 
    title_id text not null, 
    message_id text not null, 
    icon text not null default 'logo' 
); 

create table usernotifications
(
    notification_id integer references notifications,
    user_id integer references users
);

create table groupnotifications
(
    notification_id integer references notifications,
    group_id integer references groups
);

create table companynotifications
(
    notification_id integer references notifications,
    company_id integer references companies
);
"
35428,MySQL: What is a reverse version of LIKE?,"SELECT name FROM user 
WHERE 'John Smith and Peter Johnson are best friends' LIKE
  CONCAT('%', name, '%')
"
28652,SQLite with inner select,"SELECT * FROM EventInfo 
    Where Name LIKE ""%search text%"" OR 
          Description LIKE ""%search text%"" OR 
          _id IN (SELECT ParentEventInfoID FROM EventInfo
                   Where (Name LIKE ""%search text%"" OR 
                          Description LIKE ""%search text%"") 
ORDER BY SortId
"
22322,SQL Server : count how many times one,"SELECT t1.id, COUNT(t2.v1)
FROM mytable AS t1
LEFT JOIN mytable AS t2 ON t1.id = t2.v1
GROUP BY t1.id
ORDER BY t1.id 
"
34793,Sum all values in column return highest,"select type, sum(val) as sumval
from table t
group by type
order by sumval desc
limit 1;
"
38384,Similar to rows-to-col(EAV to relational) - SQL query please,"SELECT
  EN_NO,
  PROD_KEY,
  CASE WHEN (EN_NO < 4) AND (LEFT(PROD_KEY, 6) = 'Prod_A') THEN PROD_KEY ELSE NULL END AS Prod_A,
  CASE WHEN (EN_NO < 4) AND (LEFT(PROD_KEY, 6) = 'Prod_B') THEN PROD_KEY ELSE NULL END AS Prod_B,
  CASE WHEN (EN_NO < 4) AND (LEFT(PROD_KEY, 6) = 'Prod_C') THEN PROD_KEY ELSE NULL END AS Prod_C,
  PROD_QTY
FROM
  yourTable
"
27922,Culture-conversion in C# with DateTime,"  string myDate = _DateRangeStart.ToString(""yyyy-MM-dd"");
"
4564,SQL Query with a subquery,"SELECT playerNo, name, street, town
FROM Players
WHERE (street, town) IN (SELECT street, town
                         FROM Players
                         WHERE playerNo IN (6,7));
"
24113,How can I create a new DataGridView control for each new row in another datagridview in vb.net?,"DataGridView dgv = new DataGridView();
dgv.Location = new Point(DataGridView6.Location.X,DataGridView6.Location.Y + <somevalue>);
"
28310,Specify order for query manually,"order by date, 
         case operation 
              when 'INCOMING' then 1
              when 'ACCEPT' then 2
              when 'WITHDRAW' then 3
              else 4 -- this is a fallback, anything else will be sorted at the end
         end 
"
2317,IOS DBAccess migration to new table structure,"+ (id)defaultValueForProperty:(NSString*)propertyName;
"
16100,Need to limit the number of rows in each order in following table?,"SELECT Col1, 
        Col2, 
        Col3 
FROM(
    SELECT 
        Col1, 
        Col2, 
        Col3, 
        ROW_NUMBER() OVER (PARTITION BY Col1 ORDER BY Col1, Col2, Col3) RNum
    FROM YourTable 
)X WHERE RNum<=5
"
13832,Aggregate function in inline view,"select x.""Number of orders placed"",count(x.CustomerName) as
       ""Number of customers that have purchased this many orders"" 
from 
(select count(OrderNumber) as ""Number of orders placed"", CustomerName 
 from PURCHASES 
 group by CustomerName
) x
group by x.""Number of orders placed"" 
"
12633,Query result organization,"SELECT Item_ID, SUM(Quantity), Sum(Sale)
FROM Item
JOIN Purchase ON Item.Item_ID=Purchase.Item_ID
JOIN Transaction ON Purchase.Transaction_ID=Transaction.Transaction_ID
WHERE Client_ID = $ClientId
AND Transaction.Timestamp>= $start
AND Transaction.Timestamp <= $end
GROUP BY Item_ID
ORDER BY SUM(Quantity), SUM(Sale) DESC
"
5555,Inner join and average in SQL,"Select Country.Continent, floor(Avg(city.population))
  From Country 
     Inner Join City
        On Country.Code = City.CountryCode
  Group By Country.Continent;
"
117,How to link a single row from a table to a whole separate table,"CREATE TABLE [dbo].[QuestionStudentAssociation] (
[QuestionStudentAssociationID] INT IDENTITY(1,1) NOT NULL,
[QuestionID] INT NOT NULL REFERENCES Questions(QuestionID),
[StudentID] INT NOT NULL REFERENCES StudentDetails(StudentID),
PRIMARY KEY CLUSTERED ([QuestionStudentAssociationID] ASC)
);
"
21192,Get the value from a default constraint,"SELECT 
    DefaultConstraintName = df.name,
    df.definition
FROM 
    sys.default_constraints df
INNER JOIN 
    sys.tables t ON df.parent_object_id = t.object_id
INNER JOIN 
    sys.columns c ON c.object_id = df.parent_object_id AND df.parent_column_id = c.column_id
WHERE 
    t.Name = N'YourTableNameHere'
    AND c.Name = N'YourColumnNameHere'
"
4933,Get the Start and End of the Day in timestamp in mysql,"SELECT 
  DATE_FORMAT(CONCAT(CURDATE(), ' 00:00:00'), '%m/%d/%Y %H:%i:%s') as morning,
  DATE_FORMAT(CONCAT(CURDATE(), ' 23:59:59'), '%m/%d/%Y %H:%i:%s') as evening
"
21553,SELECT all date interval from timestamp to timestamp,"SELECT a_date, count(days) FROM 
generate_series('2015-01-01'::timestamp, '2015-03-31', '1 day') a_date
  left outer join 
    my_table
  on my_table.days = a_date
group by a_date
"
19644,SQL query to return only one lowest price per location from result set,"select r.loc, r.total, r.code
from (select r.*,
             row_number() over (partition by loc order by total desc, code desc) as seqnum
      from @results r
     ) r
where seqnum = 1;
"
3478,Counting values in columns,"SELECT
  name,
  SUM( CASE type WHEN 1 THEN 1 ELSE 0 END) AS type1,
  SUM( CASE type WHEN 2 THEN 1 ELSE 0 END) AS type2
FROM
  myTable
GROUP BY
  name
"
22298,Can I combine local and remote dataset within SPARQL query?,"SELECT * WHERE {
  # the local part of the query
  ?s ?p ?id

  SERVICE <http://url/to/remote/data> {
    # The remote part of the query
    ?x ?y ?id
  }
}
"
26037,SQL max() over(partition) returning multiple results,"select *, max(mt.version) over (partition by mt.partitiongroup)
from mytable mt
where mt.id = 'some uuid';
"
10924,Listing preferences with oracle db,"SELECT p.name,
       LISTAGG( s.name, ',' ) WITHIN GROUP ( ORDER BY s.name ) AS preferences
FROM   Person p
       INNER JOIN School s
       ON ( p.preference_id = s.school_id )
GROUP BY p.name
"
21716,Update a column using values from another column that match a specific criteria,"UPDATE zen_customers 
SET customers_fax = customers_telephone
WHERE customers_telephone like '07%'
"
10011,(How) Can I place a with sql query in a table value function?,"create function test_func(@ID_ORG_UNIT int)
returns table
as
return (
  with org as (
     select ID
     from ORG_UNIT
     where id = @ID_ORG_UNIT
     union all
     select PARENT_ID
     from ORG_UNIT c
       join org p on p.ID = c.id
  ) 
  select * from org   
);
"
29884,Use query to query different table,"SELECT * FROM member_list ml join member_history mh
on ml.member_id=mh.member_id
where gender = 1 and spend < 250
"
15849,SQL -- Selecting only columns that have specific multiple values,"SELECT COUNT(*) As CountOfAs
    FROM (
          SELECT C.A
          FROM T
          WHERE C.B = 'F'
          OR C.B = 'G'
          GROUP BY C.A
          HAVING COUNT(DISTINCT(B)) > 1
         ) AS CNT
"
3313,Get the last row in MYSQL,"SELECT prices.id_ticker, MAX(prices.date) as last, prices.price 
FROM prices GROUP BY prices.id_ticker 
order by prices.id_ticker desc
"
39624,how to organise a list of messages by last sent,"SELECT * FROM messages GROUP BY who ORDER BY MAX(date) DESC;
"
30480,Include partial matches in SQLite FTS3 Search,"SELECT name
FROM (
      SELECT name, 1 as matched
      FROM nametable
      WHERE name MATCH 'fast'
    UNION ALL
      SELECT name, 1 as matched
      FROM nametable
      WHERE name MATCH 'food'
    UNION ALL
      SELECT name, 1 as matched
      FROM nametable
      WHERE name MATCH 'restaurant'
  )
GROUP BY name
ORDER BY SUM(matched) DESC, name
"
424,How to merge two different field values into one row?,"select `date`, uid,
       (case when source = 'source1a' then 'source1' else source end) as source,
       sum(pageviews) as pageviews
from trafficSourceMedium
group by `date`, uid,
          (case when source = 'source1a' then 'source1' else source end);
"
24961,creating a single column table with a certain number pattern,"CREATE SEQUENCE sequence_name
MINVALUE value
MAXVALUE value
START WITH value
INCREMENT BY value
CACHE value;
"
19623,Concatenate Two double precisions into a string in sql server 2008 function,"SET @VormFactorKlasseNaam = CAST(@LowerLimit as varchar(5)) + ' - ' + 
     cast(@UpperLimit as varchar(5))  
"
3004,Insert same row multiple times within SQL table based on unique value in field 1,"insert into table-name
(Column1, Column2, Column3)
select Column1, 'NEW', 'NEW*' from table-name group by Column1
"
33158,"In Sybase, Convert sql timestamp to unixtime","SELECT time1,
       Datediff(SECOND, '1970-01-01', time1) AS time1_to_unixtime
FROM   mytable
"
7908,select records between two dates,"SELECT  * 
FROM    TableName
WHERE   Class = '12' AND 
        Section = 'B' AND 
        '2013-03-07' BETWEEN DATE AND TODATE
"
17763,can we do a mySQL CASE with selecting tables after FROM?,"SELECT
    tale0.*,
    CASE WHEN tale0.id = 1 THEN class.Column1 ELSE hamburger.Column1 END as Column1,
    CASE WHEN tale0.id = 1 THEN class.Column2 ELSE hamburger.Column2 END as Column2,
    ...
FROM
    table0, class, hamburger
-- include join conditions
"
22922,Sql select with outer join in same table,"SELECT * FROM Table1 t1
WHERE subject = 'Eng.Maths'
AND NOT EXISTS (SELECT NULL FROM Table1 t2
                WHERE t1.Student = t2.Student
                AND t2.Subject <> t1.subject)
"
8799,FREETEXT queries in SQL Server 2008 not phrase matching,"SELECT Description  
FROM Projects   
WHERE CONTAINS(Description, '""City Hall""')
"
17342,"MySQL - Select statement, order by number of comments per article","SELECT 
    tbl_article.*, COUNT(tbl_comments.article_id) as total_comments
FROM 
    tbl_article
LEFT JOIN 
    tbl_comments ON tbl_comments.article_id = tbl_article.id
GROUP BY 
    tbl_article.id
ORDER BY 
    COUNT(tbl_comments.article_id)
"
27851,SQL Query without using sub queries,"select distinct t3.sID, t3.ResearchPaperID
from Table1 t1, Table2 t2, Table1 t3
where t1.sID = t2.sID and t2.Name = 'Person1'
  and t1.ResearchPaperID = t3.ResearchPaperID
  and t3.sID <> t2.sID       -- this restriction is the one that removes the 'Person1'
"
6817,Concatenate values in multiple rows in a table and write it to a cell in a new table,"SELECT tno, GROUP_CONCAT(CONCAT(t1,t2) SEPARATOR '') AS `text`
FROM `table1`
GROUP BY tno
"
12103,profit for products,"SELECT product_id, SUM(unit_price * quantity) AS revenue
FROM Order_Items
GROUP BY product_id
HAVING SUM(unit_price * quantity) > 150000
ORDER BY revenue DESC
"
38507,"What is the best way to design Seller, Category and Product tables?","Seller
----------
ID
etc.

Product
----------
ID
CategoryID
etc.

SellerProduct
----------
SellerID
ProductID

Category
----------
ID
etc.
"
6742,query explode multiple values in one column,"select cc.company_name,group_concat(c.name)
from company_classifications cc 
inner join classifications c 
on c.id = find_in_set(c.id,cc.classifications)
group by cc.company_name;
"
27008,Need query to find all records in Table1 that have multiple matches in Table2,"SELECT 
Action.request_id, 
Action.action_id, Action.username
FROM [Action] 
INNER JOIN Request ON Action.request_id = Request.request_id
WHERE Action.request_id In (
  SELECT request_id FROM action Group By Request_Id 
  HAVING Count(request_id)>1)
AND Request.group=""My Group Name""
"
12007,Removing complete duplicates in SQL,"create table replacement (cID ...., sID ....);
# Only insert unique rows, which may be long
insert into replacement select distinct cID, sID from origtable;
# remove constraints from linked tables to origtable
# add same constraints to replacement
# add unique compound index on (cID,sID) to replacement
drop table origtable;
alter table replacement rename to origtable;
"
39216,Building a WHERE clause based on whether a field is NULL,"WHERE (table.from_date IS NULL 
      OR table.from_date <= TO_DATE(input_date))
"
23809,Data Initialization in certain table at the time of publish,"if not exists (select * from DatabaseName.sys.tables where name = 'Roles')
begin
CREATE TABLE [dbo].[Roles]
(
    [Id] INT NOT NULL PRIMARY KEY,
    [Title] NVARCHAR(15) NOT NULL
)
end
go
if not exists(select * from Roles where id='1')
Begin
insert into Roles (id,title) values (1,'Admin')
end
go
if not exists(select * from Roles where id='2')
Begin
insert into Roles (id,title) values (2,'Management')
end
go
.
.
.
"
16247,How can I select a value from a database using Ruby and SQLite3?,"name.each do |row|
    puts row['firstname']
end
"
37060,How to insert data into two tables with t-sql,"INSERT INTO client VALUES ('Peter', 'Griffin')

SET @clientKey = @@IDENTITY

INSERT INTO address VALUES (@clientKey, '123 Elm')
"
26326,transpose column headers to rows in postgresql,"SELECT
   unnest(array['value1Count', 'value2Count', 'value3Count']) AS ""Values"",
   unnest(array[value1Count, value2Count, value3Count]) AS ""Count""
FROM view_name
ORDER BY ""Values""
"
6794,Mysql result set concatenation column wise,"SELECT *
FROM
(SELECT 1,2) t1 JOIN (SELECT 5,6) t2
UNION 
SELECT *
FROM
(SELECT 3,4) t1 JOIN (SELECT 7,8) t2
"
17896,"In SQL, how do I convert a date field into a string if null?","SELECT ISNULL(CONVERT(nVarChar(30), Date, 121), 'InsertRandomStringHere') 
"
13946,MySQL - Count() and multiply result by 400,"select count(somefield) * 400 as result
"
9860,SQL: Find records with matching values on a set of columns,"select m1.AccID, m1.AccName 
from   myTable m1
join   ( select AccID,AccName 
         from myTable  
         group by AccID,AccName
         having count(1) = 2 
        ) m2 on   m1.AccID   = m2.AccID
             and  m1.AccName =  m2.AccName
"
24598,SQL DATEADD with Variable," DECLARE @EndDate date;

 SELECT @EndDate = DATEADD(day, 1, atvcEndDate)
 FROM tbUserReport
 WHERE atvcUserId = @UserId;
"
10905,RegEx: Repeated identical vowels in a string - Oracle SQL,"WITH mydata AS (
  SELECT 'OtterBox' AS manuf_name FROM dual
   UNION ALL
  SELECT 'Apple' FROM dual
   UNION ALL
  SELECT 'Samsung' FROM dual
)
SELECT * FROM mydata
 WHERE REGEXP_LIKE(manuf_name, '([aeiou]).*\1', 'i');
"
10341,"SQL Loader, Trigger saturation?","insert into table_a
select ext.* 
from external_table ext
     left outer join table_b b
     on (ext.name = b.name and ext.last_name = b.last_name and ext.dept=b.dept)
where b.name is null
log errors into err_table_a ('load_fail') ;
"
21570,MS ACCESS - SELECT WHERE - Values with forward slash,"SELECT * FROM Products WHERE Type LIKE 'Lact*'
"
27514,How to check if a row in a table has muti-byte characters in it in a MySQL database?,"SELECT ...
FROM yourtable
WHERE CHAR_LENGTH(descr) <> LENGTH(descr)
"
26979,how to get all possible query for a same goal?,"SELECT t.City
FROM 
(SELECT City, COUNT(sup_id) as [totalSuppliers]
    FROM tb_supplier
    GROUP BY City 
    HAVING COUNT(sup_id) > 1) as t
"
39031,SQL: list users with their phone numbers and email addresses,"SELECT ""user"".id, name, array_agg(DISTINCT email) emails, array_agg(DISTINCT phone) phones
FROM ""user""
LEFT JOIN user_email ON user_email.user_id = ""user"".id
LEFT JOIN user_phone ON user_phone.user_id = ""user"".id
GROUP BY ""user"".id
ORDER BY ""user"".id;
"
16313,Search for string with conditions," SELECT name FROM table
     WHERE name LIKE '/home/%' AND name NOT LIKE '/home/%/%'
"
4957,How to subtract result of first query and second query,"select count(*)
from table1
where not exists
(select 1 
from #temp re
where re.order = order and status = 'Completed')
"
4821,How do I select Lat & Long coordinates back out of SQL Server Geography data type field,"Select convert(varchar(max),Coordinates) as Coordinates from SpatialZonePolygons ;
"
6685,MySQL query with two boolean conditions takes way longer than querying each condition separat,"SELECT * FROM table WHERE EXTRACT(HOUR FROM date) not between 3 and 18;
"
21112,Structure Database for Message Board,"select *
from replies
where tepicId = 1 -- my specific topic id example
"
8002,Database manipulation,"update contacts set title =@title, firstName=@firstName, middleName=@middleName, lastName=@lastName where contactID=@ContactID
"
21551,SQL How to set Permissions,"exec sp_addrolemember 'db_datareader',alcor8
"
24993,"RESTORE to new DB with same login, access, and role permissions","USE [Database Name]
GO
EXEC sp_addrolemember 'Database role', 'Username'
"
8507,equals Test into sql,"select @NAME_SURNAME = (CASE WHEN (PLP.NAME +' '+ PLP.SURNAME) !=  @NAME_SURNAME
                             THEN (PLP.NAME +' '+ PLP.SURNAME)
                             else @NAME_SURNAME
                        end)
"
30365,how to remove only comma in the sentence have full of commas,"DECLARE @str VARcHAR(100) = 'Attachements,A,B,C,D'

SELECT STUFF(@str, CHARINDEX(',', @str), 1, ':')
"
27599,SSIS & MS SQL Server: Parse Text From A File Name,"INSERT INTO Table VALUES (?)
"
22346,insert new values without overwriting previous values sql,"insert into table_name (order, firstname, lastname, email, contacttypeid) 
values (1284480, 'joe'...);
"
7020,Rectify miss formating of text in mysql column,"UPDATE SomeTable
SET
    VolumeNumber = REPLACE(VolumeNumber, 'Numbers ', ' Numbers ')
WHERE
    VolumeNumber NOT LIKE '% Numbers%'
;
"
36946,update column value alphabets to numeric,"UPDATE MyTable
SET [KeyCol] = RIGHT('000' + CONVERT(varchar(3), ASCII([keyCol]) - ASCII('A') + 1), 3)
"
38689,How to count GROUP BY rows in T-SQL,"COUNT (DISTINCT Game_id)
"
33543,How to write query in SQL Server to select everything,"select emp_name 
from employee 
where empid = (case when @parameter is null then empid else @parameter end)
"
14029,Retrieve random data,"SELECT TOP 2 StartTime, EndTime FROM Data
ORDER BY NEWID()
"
11794,Oracle: max value column alphanumeric,"select max(regexp_replace(dumb_key
               , '([A-Z][0-9]{2})\.([0-9]{4})\..([0-9]{3})'
               , '\2'))
from your_table
/
"
17277,Modifying a view to modify a base relation to which I don't have permissions,"create view v as select * from Student where major like '%Engineering%' with check option;
"
29150,Sql Server - Get first record from a group,";with cte as
(
  select
    ADID,
    PhotoName,
    PhotoPath,
    rank() over(partition by AdID order by ID) as rn
  from AdPhoto
)  
select ADID,
    PhotoName,
    PhotoPath
from cte
where rn = 1
"
27807,Similar Function to CONTAINS,"SELECT *
    FROM YourTable
    WHERE CHARINDEX(' DEF ', ' ' + YourColumn + ' ') <> 0;
"
30274,having count don´t work," select l.descripcion, count(r.cod_cliente) from reclamo r
        join cliente c on r.cod_cliente = c.cod_cliente 
        join localidad l on c.cod_localidad = l.cod_localidad
        group by l.descripcion
        having count(r.cod_cliente) >10;
"
23620,Find all stored procedures with particular starting name,"SELECT o.name
FROM sysobjects AS o
INNER JOIN sysprocedures AS p ON o.id = p.id
WHERE o.name LIKE ""ABC%""
"
14087,How do I create an Emacs SQL buffer?,"(defun sql-get-login (&rest what)
  (setq sql-user     ""me""
        sql-password ""secret""
        sql-server   ""localhost""
        sql-database ""MyDB""))
"
5258,Giving null values a label in SQL,"Select NVL(TableB.section, 'nice text')
from TableA left join TableB on TableA.fk = TableB.pk 
group by NVL(TableB.section, 'nice text')
"
36902,sql date for year start," select datepart(year, dateadd(MONTH,2,'2014-10-01')), -- 2014
 datepart(year, dateadd(MONTH,2,'2014-11-01')) -- 2015
"
35059,Select a value in multiple rows based on values in a specific field,"SELECT *
    FROM Table
    WHERE shelf = 'shelf1' AND object NOT IN 
    (SELECT object FROM Table WHERE shelf='shelf2')
"
26566,SQL query concerning the sum of occurrences for multiple rows,"select name
  from tbl
 group by name,
          location
having count(*) > 1
"
30363,How can I add an additional field to an SQL Group By clause,"select sm.NAME, sm.AverageScore, sm.best_score, s.SUBJECT
from (
    SELECT  NAME,  Avg(SCORE) AS AverageScore, MAX(SCORE) AS best_score 
    FROM Scoretable 
    GROUP BY NAME 
) sm
inner join Scoretable s on sm.NAME = s.NAME 
    and sm.best_score  = s.SCORE
"
22467,Query to know the average of data in each day,"SELECT  CAST(DataHora AS DATE) AS [Date],
        COUNT(Chave_ID) AS [Entries]
FROM    San_Chave
GROUP BY CAST(DataHora AS DATE)
ORDER BY [Date]
"
37625,SQL Multi-table update syntax,"UPDATE 
    t
SET
    t.FormulaID = t1.formulaID
FROM
   tblWOSampleTest t
   INNER JOIN tblTest t1 ON t1.TestID = t.TestID;
"
28841,SELECT query on mutiple table,"SELECT M.Name
FROM MembersTable M
LEFT JOIN CheckoutTable C On C.MemId = M.ID
WHERE C.MemId IS NULL
"
22129,Selecting each distinct duplicate with ID from a list of duplicates,"SELECT MIN(c.contact-id)... 
"
38319,How to create an empty anonymous table in Postgres?,"select null::text as a, null::int as b
limit 0
"
29854,mySQL inserting multiple records with a select,"DECLARE temp_status_id INT;
SELECT status_id 
   INTO temp_status_id 
   FROM car_status;
INSERT INTO cars (type, status_id) 
    VALUES ('GM',temp_status_id),
           ('Toyota',temp_status_id),
           ('Honda',temp_status_id);
"
29891,Is it possible to execute multiple inserts when one of the value parameters is dynamic?,"Insert into table(book_id,author_id)
(
    Select table.book_id,11 FROM table
    Where author_id=10
)
"
22578,SQL - ISNULL Record Value,"SELECT
 FirstName,
 LastName,
 CASE when R.BirthDate IS NULL THEN FALSE
 ELSE TRUE
END  as HasRecord
FROM
 Person p
left join BirthRecords R on p.SSN = R.SSN
"
29272,"""line fusion"" in oracle","select empno,  
       deptno,
       sal,
       max(sal) over (partition by deptno) as MAX_VAL_IN_DEPT
from emp 
"
39938,SQL Command for Querying the database?,"SELECT COUNT(Name) AS ""No of Peoples"" FROM TableName WHERE City = 'London';
"
16237,Update table with random record in update statment in SQL Server?,"UPDATE A
SET A.hostessid = B.hostessId
FROM member_info_test A
CROSS APPLY (SELECT TOP 1 hostessId
             FROM hostess_test 
             WHERE A.somecolumn = A.somecolumn
             ORDER BY NEWID()) B
"
516,where date between start of year and end of last day before one month?,"AND mhn.trh_masuk BETWEEN trunc(SYSDATE,'YEAR') AND last_day(add_months(TRUNC(SYSDATE), -1)) + .99999
"
25085,"How to transpose columns and rows in PostgreSQL (i.e., how do I switch rows and columns)?","select year,
  sum(case when place = 'U.S.' then price else 0 end) ""U.S."",
  sum(case when place = 'U.K.' then price else 0 end) ""U.K.""
from yourtable
group by year
"
34544,Update multiple rows following a pattern in mysql," UPDATE my_table 
    SET `name` = REPLACE(`name`, '_t_', '_c_') 
"
11863,"In one table Manger ID and Cashier ID is available and In another Table Cashier ID, Manager ID are available","SELECT t1.manager_id, t2a.employee_name AS manager_name
     , t1.cashier_id, t2b.employee_name AS cashier_name
  FROM table1 t1 INNER JOIN table2 t2a
    ON t1.manager_id = t2a.employee_id
 INNER JOIN table2 t2b
    ON t1.cashier_id = t2b.employee_id;
"
21226,Need help with a SQL join: Conditional Matching?,"SELECT a.account_number, a.region, a.product, ISNULL(p1.price, p2.price) AS Price
FROM Accounts a
    LEFT JOIN Products p1 ON a.product = p1.product AND a.region = p1.region
    LEFT JOIN Products p2 ON a.product = p2.product AND p2.region = 0
"
21927,sql sum previous rows based on value of current row,";WITH MyCTE AS
(
    SELECT
        RoomTypeID,
        DayNo,
        RoomNo,
        IsDormitory,
        AdultsNo,
        SUM(CASE WHEN IsDormitory = 1 THEN AdultsNo ELSE 0 END) OVER (PARTITION BY RoomTypeID, DayNo ORDER BY RoomNo ROWS UNBOUNDED PRECEDING) AS Tmp
    FROM
        #tbl
)
SELECT *
FROM MyCTE
"
18832,update first 10 rows with one value and next 10 with another,";WITH CTE1 AS
(
    SELECT  *,
            id2 = ROW_NUMBER() OVER(ORDER BY id) - 1
    FROM YourTable
), CTE2 AS
(
    SELECT  *, 
            id2/3%2 N
    FROM CTE1
)
UPDATE CTE2
SET data = CASE WHEN N = 0 THEN 'a' ELSE 'b' END;

SELECT *
FROM YourTable
"
14299,"How to write MySQL full-text query with MATCH(), ROUND() & Subquery?","SELECT 
  text,
  ROUND(MATCH(text) AGAINST('$keyword')) AS score,
  date
FROM 
  table_name 
WHERE 
  MATCH(text) AGAINST('$keyword')
ORDER BY 
  score DESC,
  date DESC 
LIMIT 20
OFFSET $s
"
32691,SELECT from table where a field does not exist in an item master table,"SELECT * 
FROM IP24_Import_Images B
LEFT JOIN sap.ItemMasterSkuColor IM
ON B.SKU = IM.Style AND B.Color = IM.Color
WHERE IM.Color IS NULL
"
38764,JOIN ON clause with CASE statement depending on if field is NULL?,"SELECT ...
FROM tablename a
LEFT JOIN tablename b
ON COALESCE(a.SUB_ID,a.ID) = COALESCE(b.SUB_ID,b.ID)
"
22803,FMDB Database Query IOS FIND_IN_SET(),"FMResultSet *rs = [db executeQuery:@""SELECT Title FROM yourTable WHERE ','+tags+',' LIKE ?"",
                  [NSString stringWithFormat:@""%%%@%%"", @"","" + search_text + @"",""]];
"
11466,SQL Server query assistance,"SELECT T1.ClientID, MAX(DeptID)
FROM TblClient T1
INNER JOIN TblClient T2 on T1.ClientID = T2.ClientID
GROUP BY T1.ClientID
"
19596,Creating a View from an Aggregated Self-Join,"create view xxx as
    with <blah blah blah>
    select <your query>
"
30360,Combine rows and put their values in seperate column in mysql,"SELECT a.regd, a.subjects, a.marks, b.activity
FROM   (SELECT regd, subjects, marks
        FROM   mytable
        WHERE  entry = 'FA1') a
JOIN   (SELECT regd, subjects, marks AS activity
        FROM   mytable
        WHERE  entry = 'SA1') b ON a.regd = b.regd AND a.subjects = b.subjects
"
13136,How to copy values from bit column to datetime column?,"update Person
set dateTime_Column = case when isnull(absent, 0) = 0 then null else getdate() end
"
15029,"In TSQL, how to evaluate an expression and assign it to a BIT field?","DECLARE @bitvar BIT 
DECLARE @search_term varchar(128)

set @search_term = 'abc'

SET @bitvar = CASE 
                 WHEN (@search_term = 'abc') THEN 1
                 ELSE 0
              END

select @bitvar
"
5136,"How can I select all rows from one table, calculating a field value based on another table","select m.*,
       iif(exists (select 1
                   from merchandise_groups_merchandise as mgm
                   where m.id = mgm.merchandise_id and
                         mgm.merchandise_group_id = [group_id]
                  )), 1, 0) as IsInGroupFlag
from merchandizes as m
"
25947,Oracle SELECT : Count of events per team and per year,"SELECT
 Team.team_id,
 Years.year,
 COALESCE(count(Event.event_id),0) events
FROM
 Team
   JOIN (SELECT DISTINCT EXTRACT(YEAR FROM start_date_time) year FROM Event) Years ON 1=1
   LEFT OUTER JOIN Event ON Event.team_id = Team.team_id AND EXTRACT(YEAR FROM Event.start_date_time) = Years.year
GROUP BY
 Years.year,
 team_id
ORDER BY
 year  ASC,
 team_id  ASC
;
"
31865,Return query results in same order as the values in my `IN(....)` statement,"ORDER BY FIELD(user_id, 20, 24, 23, 26, 27, 28, 25) ASC
"
24579,Searching and returning all occurences of keyword in a Postgres text column,"select bc.bodycontentid,
       left(rst.s, position('""' in rst.s) - 1) as domain
from bodycontent bc, lateral
     regexp_split_to_table(bc.body, E'srce=""') rst(s)
where rst.s like 'http://images.mydomain.com/allImages/%';
"
9213,sql table with primary key from another table,"   CREATE TABLE mynewtable
    (
      location varchar(255),
      color varchar(255),
      PRIMARY KEY (id),
      FOREIGN KEY (table_1_id) REFERENCES table_1(id),
      FOREIGN KEY (table_1_name) REFERENCES table_1(name),
    )
"
5447,Inner join returns same columns from two tables access sql,"SELECT table1.*, table2.EID
"
39275,Custom database scoring system,"Query
select user_id, sum(user_tags.weight) 
from user_tags join tags on tags.id == user_tags.tag_id
where tags.name in ('cooking', 'intelligence')
group by user_id
order by sum(user_tags.weight) desc
"
32783,Create Table DDL causes sql server to hang,"CREATE TABLE ClientPayerCrosswalkMapping
( 
  id INT IDENTITY(1, 1) NOT NULL,
  lbxid INT NOT NULL,
  ClientPayerID NVARCHAR(80),

  CONSTRAINT PK_ClientPayerCrosswalkMapping_ID PRIMARY KEY CLUSTERED (id),
  CONSTRAINT UN_lbxid UNIQUE(lbxid),

  CONSTRAINT FK_LockboxDocumentTracking FOREIGN KEY (lbxid)
  REFERENCES LockboxDocumentTracking(lbxid)
);
"
32568,Grab one for each id,"SELECT de.id, d.name, de.title 
FROM discos_events de INNER JOIN places d ON (de.dID = d.id) 
WHERE de.date = (SELECT MAX(t.date)
                 FROM disco_events t
                 WHERE t.dID = de.dID
                       AND unix_timestamp(now()) > t.date)
LIMIT 10;
"
27814,Joining on multiple possible tables,"CREATE TABLE foo (
  id serial primary key,
  name varchar(20),
  activitable_id int UNIQUE,
  FOREIGN KEY (activitable_id) REFERENCES activitables(id)
);
"
32119,Query to select the month and nos of weekend and public holiday in that month,"     SELECT year(holidaydate),month(holidaydate), 
            sum(case Weekend when true then 1 else 0 end) wkEnd, 
            sum(case PublicHoliday when true then 1 else 0 end) pubHol
      FROM Holiday 
      GROUP BY year(holidaydate),month(holidaydate)
"
22668,Oracle price calculation in Query,"Price.price - NVL(ccons.discountPrice, 0) - NVL(mcons.discountPrice, 0)
"
33293,Returning all values without duplicates in MySQL,"SELECT DISTINCT column FROM optional_hardware;
"
3963,declaring T-Sql parameter for comma delimited list of integers,"CREATE PROCEDURE IP_MAX_PERF_DATE 
@prod_no  nvarchar(500)
AS
BEGIN
SET NOCOUNT ON;
declare @statement nvarchar(1000)
set @statement = N'SELECT [prod_season_no], MAX([perf_dt]) As max_dt FROM [T_PERF] WHERE [prod_season_no] IN (' + @prod_no + ') GROUP By [prod_season_no]'
EXEC sp_executesql 
         @stmt = @statement
END
GO
"
35191,CTE after UNION ALL,";WITH a AS 
(SELECT 1 AS c1), 
b AS 
(SELECT 1 AS c1)
SELECT
    *
FROM
    a 
UNION ALL
SELECT
    *
FROM
    b
"
13872,Counting from many-to-many,"SELECT t.*
FROM   taggit_tag t
WHERE EXISTS (
   SELECT 1
   FROM   taggit_taggeditem ti
   WHERE  ti.tag_id = t.tag_id
   );
"
17023,Oracle CLOB to varchar2 over DBLINK,"CREATE GLOBAL TEMPORARY TABLE comments ON COMMIT PRESERVE ROWS 
    AS SELECT * FROM test@db;

SELECT INTO TEST(ID, NAME,DESCRIPTION, COMMENT)
SELECT ID, NAME, 
       dbms_lob.substr(description, 4000, 1), 
       dbms_lob.substr(description, 4000, 1)
  FROM comments;
"
308,Count of matching fields (columns),"SELECT ip, isp, infection, COUNT(*)
FROM 
(
SELECT ip, isp, infection FROM tbl_1
UNION ALL
SELECT ip, isp, infection FROM tbl_2
UNION ALL
SELECT  ip, isp, infection FROM tbl_3
) x
GROUP BY ip, isp, infection
"
547,Get last 12 months data from Db with year in Postgres,"SELECT to_char(revision_timestamp, 'YYYY-MM'),
       count(b.id)
FROM package a
JOIN package_revision b ON a.revision_id = b.revision_id
WHERE revision_timestamp >
      date_trunc('month', CURRENT_DATE) - INTERVAL '1 year'
GROUP BY 1
"
32963,"Correct way to write a SQL Query to combine two result sets with a condition, giving a distinct list back","select distinct r.risk_ID, r.title, ah.Approval_ID as Approver_ID  
from dbo.tbl_risk r left join
     dbo.tbl_Approval_History ah
     on ah.risk_ID = r.risk_ID and ah.Status_ID = 5 ;
"
36408,Best way to subtract SUM and COUNT with 2 table select?,"   SELECT s.release_id,
          (SUM(s.Shipments) -
           (SELECT COUNT(*) 
            FROM shipments sh
            WHERE sh.release_id = s.release_id
           )
          ) AS shipments_left
   FROM subscriptions s
   WHERE is_paid = 1 AND shipments > 1
   GROUP BY s.release_id;
"
2137,SQL: WHERE & the AND-statement problems,"
SELECT *
FROM Example e
INNER JOIN 
(
   select [customer name]
   from example
   group by [customer name]
   having count(*) = 2
) c on c.[customer name] = e.[customer name]
"
2981,add single record on top of sql query,"select ID, Name
from 
(
  select null as ID, 'Select' as Name
  union all
  select ID, Name
  from prototype
) as T  
order by case when ID is null then 0 else 1 end, Name
"
281,Get count of created entries for each day,"SELECT day, COALESCE(ct, 0) AS ct
FROM  (SELECT now::date - d AS day FROM generate_series (0, 6) d) d  -- 6, not 7
LEFT   JOIN (
   SELECT created_at::date AS day, count(*) AS ct 
   FROM   entries
   WHERE  created_at >= date_trunc('day', now()) - interval '6d'
   GROUP  BY 1
   ) e USING (day);
"
39541,Group and values from table,"select distinct 
    Col1,
    (
     select STUFF((select ',' + col2 
     from yourtable b 
     where b.col1 = a.col1 for xml path('')),1,1,'')
     ) as Col2
from yourtable a
"
10509,How to get number of users and blogs from Wordpress MU,"add_shortcode('SHORTTAG', 'FUNCTION NAME');
"
9842,query to bring columns in single row,"SELECT row
FROM
(
  SELECT fruit_id, fruit_id row FROM fruits
  UNION
  SELECT fruit_id, fruit_name row FROM fruits
) s
WHERE fruit_id = 101;
"
36517,Adding columns in MySQL - how to treat NULL as 0,"SELECT IFNULL(var1, 0) + IFNULL(var2, 0) FROM test
"
16004,Select Max(Date) and next highest Max(date) from table,"SELECT MAX(dates.BusinessDataDate) AS BusinessDataDate, 
       MIN(dates.BusinessDataDate) AS PreviousDataDate
FROM
(SELECT TOP 2
    'cb_account' AS TableName
    , BusinessDataDate
FROM cb_account
GROUP BY BusinessDataDate
ORDER BY BusinessDataDate DESC) dates
"
14941,How do I perform the following SQL sum?,"SELECT
  PointsFor.user_id, 
  sum(PointsFor.score) as pointsfor,
  sum(PointsAgainst.score) as pointsAgainst
FROM TABLE_NAME PointsFor
JOIN TABLE_NAME PointsAgainst
  on PointsFor.match_id = PointsAgainst.match_id
  and PointsFor.user_id <> PointsAgainst.user_id
GROUP BY PointsFor.user_id
"
18760,Using a CASE result in a LEFT JOIN statement (MySQL),"SELECT DISTINCT CASE WHEN $userid != senderid THEN senderid ELSE recipients END someid,   
                CASE WHEN $userid != senderid THEN senders.senderid ELSE receivers.recipients END somename
                messages.body, 
                messages.time 
FROM messages 
LEFT JOIN users AS senders ON messages.senderid = senders.id
LEFT JOIN users AS receivers ON messages.recipients = receivers.id
WHERE messages.recipients = $userid 
OR messages.senderid = $userid 
ORDER BY messages.time
"
5854,Can a SQL Case statment be used to test if a Join statement should be used?,"select *
from A 
  left outer join B 
    on A.a = B.d and A.a > 2
"
23393,Remove dots and hyphen on where clause MySQL,"WHERE
  REPLACE
    (
      REPLACE
       (
         some_column, ""-"", """"
       ), ""."", """"
    ) in ('10000000000', '1999999999')
"
12490,Conditional MySql Query ,"IF MyCondition = True THEN
  Select * from table1;
ELSE
  Select * from table2;
END IF;
"
16626,Deleting duplicate rows from a table,"DELETE FROM Table
WHERE ID NOT IN
(
SELECT MIN(ID)
FROM Table
GROUP BY Field1, Field2, Field3, ...
)
"
22724,Using an Int as the database selection Argument,"new String[]{String.valueOf(getIntent().getIntExtra(""goal"", 999999))}
"
13465,DENSE_RANK on Calculated Column,"SELECT 
  *, 
  DENSE_RANK() over (order by product)
FROM (
SELECT 
  CASE 
          WHEN [col1] = 's' THEN 8
          WHEN [col1] = 't' THEN 6 
          WHEN [col1] = 'u' THEN 9
          WHEN [col2] = 'v' THEN 1
 ...
END AS product
FROM dbo.TableA
) t
"
30821,mutating table when writing a trigger,"CREATE OR REPLACE TRIGGER tri_A 
  BEFORE UPDATE OF count ON A
  FOR EACH ROW
BEGIN
  :new.total := 1;
END;
"
8398,Get rows from the table using row no in sql server,"select * from
(select row_number() over (order by @column) as row,*  from  Table) as t
where row between 100 and 150
"
35720,How do I select a row with max count doing a group by,"select t.user_name, t.thread_id , count(*) as max_count
from tbl t
group by t.user_name, t.thread_id
having count(*) = ( select count(*) as ttl
                    from tbl
                    where thread_id = t.thread_id
                    group by user_name
                    order by ttl desc
                    limit 1 )
"
6413,Sorting alphanumeric data,"SELECT your_field FROM your_table ORDER BY (your_field + 0 <> 0 OR your_field = '0') ASC, your_field + 0, your_field
"
2567,how to get ID of field based on the Max of another field in same table,"select a.aetId, a.aetProposalType, a.aetDaysToWait
    from ae_types a
        inner join (select aetProposalType, max(aetDaysToWait) as MaxDays
                    from ae_types
                    group by aetProposalType) sq
            on a.aetProposalType = sq.aetProposalType
                and a.aetDaysToWait = sq.MaxDays
"
24694,How to get the AutoNumber generated by an SQL insert,"Dim db As DAO.Database
Dim strInsert As String

Set db = CurrentDb
strInsert = ""INSERT INTO [table1]([field 1], [field 2])"" & vbCrLf & _
    ""VALUES ('value 1', 'value 2')""
db.Execute strInsert, dbFailOnError

TempVars.Add ""itemNum"", db.OpenRecordset(""SELECT @@identity"")(0).Value
MsgBox ""TempVars!itemNum: "" & TempVars!itemNum
"
39501,SQL INNER JOIN Without Repeats,"SELECT earliestOrders.orderid, C1.customerid, O1.Orderid 
FROM orders AS O1 
INNER JOIN customers AS C1 ON O1.customerid = C1.customerid
INNER JOIN (
    select o.customerid, min(o.OrderId) as OrderId
    from orders o
    Group by o.customerid
    ) earliestOrders
ON earliestOrders.CustomerId = C1.CustomerId
AND earliestOrders.orderid <> O1.Orderid
"
39143,Combining the results of two seperate SQL queries with 'OR',"SELECT ""outbreaks"".* FROM ""outbreaks"" INNER JOIN ""bacterial_agents"" ON bacterial_agents.outbreak_id = outbreaks.id INNER JOIN ""bacteria"" ON ""bacteria"".id = ""bacterial_agents"".bacterium_id WHERE (bacteria.name ILIKE E'%VTEC O157%')
UNION
SELECT ""outbreaks"".* FROM ""outbreaks"" INNER JOIN ""viral_agents"" ON viral_agents.outbreak_id = outbreaks.id INNER JOIN ""virus"" ON ""virus"".id = ""viral_agents"".virus_id WHERE (virus.name ILIKE E'%NOROVIRUS%')
"
27109,join on timestamp range,"SELECT
  raw_commits.sha,
  raw_commits.author
  raw_commits.date,
  milestones.name
FROM
  raw_commits
LEFT OUTER JOIN
  milestones
ON
  raw_commits.date BETWEEN milestones.start AND milestones.end
"
20698,Dynamic field generation on database and generate dynamic fields for a form,"Form
-----
  FormID (PK)
  FormName
  UserId (FK to users)
 (other fields)

FormField
-------------
  FormFieldId (PK)
  FormID (FK to form)
  FieldTypeId (FK to FieldType)
  FieldName  (or Caption ...)
  (other fields)

FieldType
-------------
  id (PK)
  name

FilledForm
-------------------
  FilledFormId (PK)
   +IPAddress, data about who filled the form...


FilledFormField
-------------------
  FilledFormFieldId (PK)
  FilledFormId (FK)
  FormFieldId (FK)
  Value 
"
4005,How should I order a subset of a query returned and place it on the top of the result?,"SELECT name
FROM TableA
ORDER BY
    CASE WHEN name LIKE 'd%' THEN 0 ELSE 1 END,
    name
"
12762,How update column with 4 columns in sql,"update t
    set E = concat(a, b, c, d);

update t
    set E = a || b || c || d;

update t
    set E = a + b + c + d;
"
34817,Using subqueries with multiple results which depend on the main query,"SELECT p.id, 
       p.name, 
       p.last_name, 
       CASE p.id WHEN m.pid_1 THEN m.pid_2 ELSE m.pid_1 END AS partner_id
FROM tc_person p
JOIN tc_marriage m ON p.id IN (m.pid_1, m.pid_2)
"
12293,Specify foreign key on one column and the value of another column,"CREATE TABLE CURRENCIES (
   ...
   CONSTRAINT c_asset_from CHECK(exists(select 1 from ASSETS a where a.id = from and a.type = 'CURRENCY'))
);
"
20729,Change ondelete behavior on SQL table,"ALTER TABLE cms__model__file_taggable_tag
  DROP FOREIGN KEY cms__model__file_taggable_tag_id_cms__model__file_id
"
34492,MySQL INNER JOIN of 3 tables with count and totals,"SELECT companies.company AS ""Company"",
       IFNULL(COUNT(DISTINCT companies_customers.customer_id), 0) AS ""Total Customers"",
       IFNULL(SUM(orders.amount), 0) AS ""All Orders Total""
  FROM companies
  LEFT
  JOIN companies_customers
    ON companies_customers.company_id = companies.id
  LEFT
  JOIN orders
    ON orders.customer_id = companies_customers.customer_id
 GROUP
    BY companies.id
;
"
17822,Determining which columns to index in MySQL in CakePHP,"SELECT t1.name, t2.salary
    FROM employee AS t1 
    INNER JOIN info AS t2 ON t1.name = t2.name;
"
9757,I need to select the Max id from a table returning all the rows,"SELECT id.ItemId, MAX(id.DocId) AS LastVersion,
MONTH(d.docUploadDt) as MontUploaded, YEAR(d.docUploadDt) as YearUploaded
FROM dbo.ItemDocument id 
INNER JOIN dbo.Documents d on id.docId = d.docId
GROUP BY id.ItemId,YEAR(d.docUploadDt),MONTH(d.docUploadDt)
"
12630,SQL: Creating table with Enum-like attribute that is one of only several types,"CREATE TABLE Rental (
       status char(6),
       date datetime,
       id int PRIMARY KEY
);

alter table Rental 
  add constraint status_valid_value
  check (status is null or (status in ('open','closed')));
"
3191,sql many to many relationship with only 2 tables,"SELECT * FROM Table1 t1
LEFT JOIN Table2 t2
ON t1.COLOR = t2.COLOR
ORDER BY COLOR DESC;
"
18792,Add years and move to last day,"SELECT add_months(trunc(sysdate, 'YYYY'), 12*11) - (1/86400) from dual
"
9381,deduct price of sell on a new date,"SELECT
  id, name, sell, date_added,
  ROUND( sell / ( to_char( sysdate - date_added, '999999D99' ) + 1.0 ) ) AS avg_sales_till_today
FROM
  ex_item
"
21386,Sql query using database function,"select p.*, loc.id,loc.latitude,loc.longitude 
from location loc inner join person p on (p.Personid=loc.Personid)
where distance(123,456,loc.latitude,loc.longitude)<0.5
"
27432,select row n times with SQL,"select
    pg.showcount,
    p.name,
    g.groupname
from PersonGroup pg
inner join Person p on p.personid = pg.personid
inner join Groups g on g.groupid = pg.groupid
inner join dbo.NumbersTable(1,12,1) n on pg.showcount >= n.i
"
1468,SQL: nest SUM with MN,"SELECT SUM(lowest_price) FROM
(SELECT MIN(r1.price) AS lowest_price 
FROM rounds r1
INNER JOIN rounds r2 ON r1.market = r2.market
                    AND r1.round = r2.round 
                    AND r1.name = r2.name
WHERE r1.round ='1' 
GROUP BY r1.market) innerSElect
"
33593,SQL Syntax causes confusion (very basic!),"select * from table where salary > (select avg(salary)from table);
"
8560,How do I inspectdb 1 table from database which Contains 1000 tables,"from django.core.management.commands.inspectdb import Command
from django.conf import settings
from your_project_dir.settings import DATABASES  #  replace `your_project_dir`

settings.configure()
settings.DATABASES = DATABASES

Command().execute(table_name_filter=lambda table_name: table_name in ('table_what_you_need_1', 'table_what_you_need_2', ), database='default')
"
21350,How to pass different values of a certain column to an aggregate function conditionally?,"SELECT 
loan_id, 
SUM(case when paid = 1 then amount else 0 end) as payed, 
SUM(case when paid = 0 then amount else 0 end) as remaining
FROM Payment
GROUP BY loan_id
"
36144,"How to list 'AAA','AAB','AAC'.......'ZZZ' with a SQL Server query","with toupdate as (
      select t.*, row_number() over (order by id) - 1 as seqnum
      from t
     )
update toupdate
    set picking_order = (ascii(char('A') + seqnum / (26*26)) +
                         ascii(char('A') + (seqnum / 26) % 26) +
                         ascii(char('A') + seqnum % 26)
                        );
"
5397,Find previous and next from current record in SQL Server,"SELECT *,
    PreviousShiftProfileID  = LAG(ShiftProfileID) OVER(PARTITION BY EmployeeID ORDER BY CDate),
    NextShiftProfileID      = LEAD(ShiftProfileID) OVER(PARTITION BY EmployeeID ORDER BY CDate)
FROM yourTable
"
21942,Select Data from Table and compare Column in The Same Table,"SELECT io.CarID
FROM insurance AS io
WHERE DATEADD(DAY, 1, io.EndDate) IN
    (SELECT ii.StartDate
     FROM insurance AS ii
     WHERE ii.CarID = io.CarID);
"
433,How can I structure an IF statement inside of a SELECT statement?,"CASE WHEN ISNUMERIC(HHY_Qty) = 1 AND ISNUMERIC(PatPrice) = 1 THEN CAST(HHY_Qty AS INT) * CAST(PatPrice AS INT) ELSE 0 END AS ExtAmt
"
23928,Cross Join Query,"SELECT products.product_id, calendar.dt, products.total_sales
FROM Product_Ref
CROSS JOIN calendar 
LEFT JOIN products ON products.so_date = calendar.dt 
                    AND products.product_id = Product_Ref.product_id
WHERE calendar.dt < SYSDATE AND calendar.dt >= ADD_MONTHS(SYSDATE, -7)+1
ORDER BY calendar.dt ASC, products.product_id DESC;
"
24363,can i use column alias in many positions in the query?,"select *, x/total from (
    select id,name,score,total,CALCIT(total - score) as x from tblx; 
) as tblx
"
6850,Excluding Columns From SELECT Statement,"SELECT firstTable.Name, SecondTable.Tax, SecondTable.Total
    ...
"
16437,Oracle SQL - Find special non numeric characters in field,"SELECT *
  FROM <table>
 WHERE REGEXP_LIKE(<column>, '[^[:digit:]]');
"
12027,How to behave with GUID column in a self-reference table,"select family.* 
  from table as member 
  join table as familiy 
    on member.ParentID = family.ParentID 
 where member.ItemID = 'firstGUID'
"
30550,One-Shot Set-Logic-Only Evaluation (Improve This Query),"PrimaryAccount
--------------
CustomerId
AccountId
PRIMARY KEY (CustomerId)
FOREIGN KEY (CustomerId, AccountId) 
    REFERENCES Account(CustomerId, AccountId)
    ON DELETE CASCADE
"
33411,How to sum Accounts by account code length?,"SELECT
  f.TimeKey,
  s.AccountKey,
  SUM(f.Debit) AS Debit,
  SUM(f.Credit) AS Credit
FROM DimAccounts s
  INNER JOIN DimAccounts b ON b.AccountCode LIKE s.AccountCode + '%'
  /* alternatively: ON s.AccountCode = LEFT(b.AccountCode, LEN(s.AccountCode)) */
  INNER JOIN FactBudget  f ON f.AccountKey = b.AccountKey
WHERE s.AccountType = 'S'
  AND b.AccountType = 'B'
GROUP BY
  f.TimeKey,
  s.AccountKey
"
5972,How to return table from anonymous block?,"FOR indx IN 1 .. resultTable.COUNT 
LOOP
    DBMS_OUTPUT.PUT_LINE('Column 1 = ' || resultTable(indx).column1 || 
                         ', Column 2 = ' || resultTable(indx).column2);
END LOOP;
"
11189,Split unbalanced GEO string on comma,"substring(location, locate(',', location)+1)
"
1236,Create or replace global subtype,"CREATE OR REPLACE PACKAGE XY
AS
  SUBTYPE type_sdebug IS VARCHAR (200);
END;

CREATE OR REPLACE PACKAGE AB
AS
  PROCEDURE print_it(p_Debug in XY.type_sdebug);
END;

CREATE OR REPLACE PACKAGE BODY AB
AS
  PROCEDURE print_it(p_Debug in XY.type_sdebug) is
  begin
      dbms_output.put_line(p_Debug);
  end;
END;


declare
  v_Debug XY.type_sdebug default 'hello world';
begin
  ab.print_it(v_Debug);
end;
"
34076,Display values of column 2 after column 1,"order by (case when countryname = 'India' then 1 else 2 end),
         countryname
"
8169,"Summing values over multiple, non-related tables?","select u.user_id, sumvalue, sumscore
from users u left outer join
     (select user_id, sum(value) as sumvalue
      from sales
      group by user_id
     ) s
     on u.user_id = s.user_id left outer join
     (select user_id, sum(score) as sumscore
      from points
      group by user_id
     ) p
     on u.user_id = p.user_id;
"
17171,How to coalesce many items into single n/varchar variable without truncation,"DECLARE @docIds VARCHAR(MAX)

SELECT @docIds = STUFF((
    SELECT ',' + CONVERT(VARCHAR(50), docUid)
    FROM dbo.Document
    FOR XML PATH(''), TYPE).value('.', 'VARCHAR(MAX)'), 1, 1, '')

SELECT @docIds, LEN(@docIds)
"
27477,Avoiding a for loop in SQL,"SELECT base.packageID, servers.server, 
             (SELECT count(*) 
                FROM base AS b1
               WHERE b1.packageId = base.packageId
                 AND b1.server    = servers.server) deployed
  FROM base, servers
 WHERE base.server = 'baseline'
   AND deployed = 0;
"
28160,Find the Range from a Table," select max(LEVEL) from Table where Threshold< 6000;
"
36509,failed matching regex in mysql,"'^29[^0-9]+1[^0-9]+\\([a-zA-Z0-9/-]*\\)\\s*$'
"
3961,MDX query returns different values when executed using openrowset,"DECLARE @Server NVARCHAR(30) = 'ANALYTIC SERVER'
DECLARE @Database NVARCHAR(50) = 'CATALOG';

DECLARE @MDX NVARCHAR(MAX) = '--MDX query--'

EXEC ExecuteOLAP @Server, @Database, @MDX;
"
29739,Granting correct permissions to the UTL_FILE method,"chown oracle:osoper /data
"
20055,left join for on col to multi col,"select t.date,
       a.acc_name acc_name1,
       b.acc_name acc_name2,
       c.acc_name acc_name3,
       d.acc_name acc_name4
from d002 t
left join d001 a on a.acc_id = t.acc_id_1
left join d001 b on b.acc_id = t.acc_id_2
left join d001 c on c.acc_id = t.acc_id_3
left join d001 d on d.acc_id = t.acc_id_4
"
5959,How to union two rows in one by connecting it on some cell in SQL?,"select
  a, b, c, listagg(col_with_VA_Values, ', ') within group (order by ...)
from
  table
group by
  a, b, c;
"
14260,select user doesn't contain a record in other table sql query,"SELECT          u.firstname + ' ' + u.lastname AS name, u.dateofbirth, u.gender, LEFT(u.note, 200) AS note, c.name AS coursename
FROM            sarcuser AS u 
INNER JOIN      sarcallcourse AS c 
ON              c.id = u.courseid
WHERE           u.id NOT IN (
    SELECT      uc.user_id
    FROM        sarcusercommittee AS uc
)
ORDER BY name DESC
"
17083,Partitioning SQL query by arbitrary number of rows,"SET @seq = 0;

SELECT SUM(data), ts FROM (
    SELECT @seq := @seq + 1 AS seq, data, ts FROM table ORDER BY ts LIMIT 50
) AS tmp GROUP BY floor(tmp.seq / 3);
"
1248,Grouping rows and combining data,"SELECT AllocationBalance.SecondRef, 
       StockItem.Code, 
       MAX(dbo.BomRecord.Description) as Description
FROM [YOUR_TABLES] -- including joins
WHERE (AllocationBalance.RecipientName = 'BOM') AND (StockItem.Code LIKE '%ZW01008%')
GROUP BY AllocationBalance.SecondRef, StockItem.Code
"
10920,create database for android application," Bus_details:
   bus_id
   other_bus _details
   .....
 station_details:
    station_id
    station
    ....
 route_details:
   route_id 
   route (stationid1,stationid2,...,stationidn) //separated by character

 schedule_details:
   Bus_id
   route_id
   day
   month
   time
"
30291,Why does this parameterized sql query not return results?,"Dim strSQLUser As String = ""Select Name, CompanyID from Users where UserName =@UserName""
"
36963,Substring in Where clause,"        ...
        ProcessDate = (CONVERT(VARCHAR, GETDATE(), 112)-1)) AND
        (ISNUMERIC(SUBSTRING(loandescription,1,4)) = 1 AND 
        CAST(SUBSTRING(loandescription,1,4) AS INT) = (YEAR(GETDATE()) - 25))
"
2335,How can I iterate over a result set and execute each statement? (MySQL),"SELECT CONCAT('ALTER TABLE `',
              TABLE_SCHEMA,
              '``',
              TABLE_NAME,
              '` CONVERT TO CHARACTER SET utf8 COLLATE utf8_general_ci;') 
                     AS mySQL
  FROM INFORMATION_SCHEMA.TABLES
 WHERE TABLE_SCHEMA = DATABASE()
   AND TABLE_SCHEMA NOT IN ('INFORMATION_SCHEMA', 'PERFORMANCE_SCHEMA', 'MYSQL')
"
27718,SQL grouping,"with t1 as (
    select A, max(B) as B, C 
    	from YourTable
    	group by A, C
)
select count(A) as CountA, B, C
    from t1
    group by B, C
"
10367,Creating new date field dynamically from next row,"Update T1
Set T1.EndDate = T2.StartDate
From [Table] T1
Inner Join [Table] T2 on T1.Id = T2.Id - 1
"
23386,MySQL In clause not giving the right result,"SELECT *
FROM mytable
WHERE find_in_set(2316, myfield) > 0;
"
10691,Sanitize SQL with RegExp,"/^(?!.*\-\-)(?!.*\/\*)(?!.*\*\/)(?!.*;)(?!.*CREATE)(?!.*DROP)(?!.*ALTER)(?!.*UPDATE)(?!.*DELETE).*$/s
"
34383,Count number of records with specific values,"SELECT
   COUNT(DISTINCT CASE WHEN member_1 = 'Alice' THEN member_1 END) +
   COUNT(DISTINCT CASE WHEN member_2 = 'Alice' THEN member_2 END) +
   COUNT(DISTINCT CASE WHEN member_3 = 'Alice' THEN member_3 END)
FROM tablename
WHERE 'Alice' IN(member_1, member_2, member_3);
"
32758,Using Toad 9.5 for Oracle how to sort numeric field that has dash,"select * from yourtable
order by to_number(substring(ordernumber, 3));
"
21284,SQL query for top 5 results without the use of LIMIT/ROWNUM/TOP,"SELECT *
FROM ( 
    SELECT col1, 
           col2,
           row_number() over (order by some_col) as rn
    FROM the_table
) t
WHERE rn <= 5
"
17129,SQL Server Pivot Query add a total,"SELECT Semester, StudentDesc, [A],[B],[C],[D],
isnull([A],0)+isnull([B],0)+isnull([C],0)+isnull([D],0) as TotalSessions
FROM
--... rest of the query
"
8556,SQL Strings that begin and end with Vowels - Looking for Shortcut,"SELECT ColumnName
FROM Table
WHERE ColumnName REGEXP '^[aeiouAEIOU].*[aeiouAEIOU]$'
"
4491,"SQL Table linking... is it better to have a linking table, or a delimited column?","User:  UserId, Name, ....
Role:  RoleId, Name, ....
UserRole:  UserRoleId, UserId, RoleId
"
38309,PL/SQL: USING clause and dynamic variables,"CREATE OR REPLACE PROCEDURE test (my_seconds NUMBER)
IS    
my_date DATE;
BEGIN    
   select sysdate + my_seconds * interval '1' second into my_date from dual;
   DBMS_OUTPUT.PUT_LINE('DATE:' || my_date);  
END
"
17724,SQL divide two columns,"SELECT 
  idMovie, 
  AVG(score) AS AvgScore
FROM Critiques
GROUP BY idMovie
HAVING AVG(score) > 8
"
11749,Query to count the number record contain text,"select Notice_type, count(*) from [Table] 
where person_id=5
group by notice_type
"
7241,Query to get all CREATE statements of MySql Tables,"mysqldump -h localhost -u root -p --no-data --compact  some_db


mysqldump -d --compact --compatible=mysql323 ${dbname}|egrep -v ""(^SET|^/\*\!)""
"
19792,Selecting column based on a field value in MYSQL,"    SELECT p.id, p.name, 
           CASE WHEN p.team = 1 THEN e.team_1 ELSE e.team_2 END AS Team_Name 
      FROM Players p 
 LEFT JOIN Events e 
        ON e.id = p.event_id 
     WHERE p.id = 2
"
38703,a comma between SELECT statements,"SELECT *
FROM TableA, TableB

SELECT *
FROM TableA
CROSS JOIN TableB
"
17987,Is there such thing as a SELECT with an IF/ELSE statement in mySQL?,"SELECT name, IF(color2='brown', color2, color1) AS color FROM apples
"
26425,SQL: how to enforce that only a single column is set in a group of columns,"(cast(col1 is not null, int) +
 cast(col2 is not null, int) +
 cast(col3 is not null, int)) = 1
"
37082,"SQL Find next Date for each Customer, SQL For each?","select c.id, min(o.date)
from customer c 
    inner join deliveryordercustomer co o on co.customerId = c.id 
    inner join deliveryorder o on co.deliveryOrderId = o.id and o.date>getdate()
group by c.id
"
8004,SQL Setting MTD based on Ending Date,"=Now.AddDays(-Today().Day + 1).Date
"
32614,How to make 3 word inputs and search on these in 3 specific columns in SQL?," $sql = mysql_query(""select * from inboedelwaarde_adres where Postcode 
 = '$term' and Huisnummer ='$term2' and Toevoeging = '$term3'"");
"
13339,Using regular expression within a stored procedure,"'([^a-z])'
"
24260,Add all the columns of a consult in SQL,"SELECT a1, a2, a3, ... , an, (a1 + a2 + ... + an) AS S FROM yourColumn.
"
39265,Matching algorithm in SQL,"select x.name, max(x.rank) 
from matches x
join (
    select name from matches where prop = 1 AND rank > 5
    intersect
    select name from matches where prop = 3 AND rank >= 8
) y
    on x.name = y.name 
group by x.name
order by max(rank);
"
6142,How do I know if a table in Oracle is fragmented?,"select table_name, round((num_rows * avg_row_len) /(8*1024)), blocks 
from user_tables where ....
"
8663,Very slow DELETE query,"DECLARE @IdList1 TABLE(Id INT primary Key not null)
DECLARE @IdList2 TABLE(Id INT primary Key not null)
"
6576,How can I edit the data section of an Omindex produced database document by editing the omegaScript?,"$hitlist{
Sample: $field{sample}
Caption: $field{caption}
MIME type: $field{type}

}
"
21172,How can I make android application open activity depend on condition at application startup,"if(databasePresent()){
    Intent intent = new Intent(MainActivity.this, LoginActivity.class);
    startActivity(intent);
}else{
    Intent intent = new Intent(MainActivity.this, CreateProfileActivity.class);
    startActivity(intent);
}
"
17059,MySQL OR statement not searching for second term,"SELECT * FROM IC7400 WHERE de LIKE '%collector%' OR de LIKE '%open%';
"
18160,Excluding results of nested SQL query,"select previous.loser
from table1 previous
where previous.winner=CURRENTLOSER and (
   select count(*)
   from table1 ancient
   where (ancient.winner=CURRENTWINNER and ancient.loser=previous.loser) or
         (ancient.loser=CURRENTWINNER and ancient.winner=previous.loser)
   ) = 0
"
30073,JOIN tables with no direct relation,"SELECT
  cars.[Make], cars.[Year of production],
  services.[Service name],
  customers.[First Name], customers.[Last Name]
FROM
  (
    (
      services
      INNER JOIN repairs on repairs.[Service ID] = services.ID
    )
    INNER JOIN cars ON cars.[Car number] = repairs.[Car number]
  )
  INNER JOIN customers on customers.[ID] = cars.[Customer ID]
WHERE
  cars.[Color] = 'Red';
"
13297,use dynamic rs() to get column from query,"get_years(k) = rs(CStr(thisYear-k))
"
19541,Populating the primary ID column with a sequential number in an SQL Server table,"WHILE @DateVar <= @EndDate
BEGIN

  select @PL_ID = @PL_ID + 1

  INSERT INTO Logger_test2(PL_ID,Log_Date,In_Time,Out_Time)
  SELECT @PL_ID,@DateVar,
  etc etc

  Set @DateVar= DATEADD(d,1,@DateVar)
  -- NO Update statement
END
"
18712,"How to address column names with spaces in oracle, when the query is already inside double quotes?","result = db.Query(""SELECT ACTUAL_N_WELLS, TARGET_N_WELLS, \""YTD ACTUAL\"" AS YTD_ACTUAL...."");
"
31094,How to write a customized database adapter in Zend Framework e.g. Mysqli_Customized?,"class My_Db_Adapter_Mysqli extends Zend_Db_Adapter_Mysqli
{
    // customisations
}

$db = Zend_Db::factory('My_Db_Adapter_Mysqli', $config);
"
35020,MySQL GROUP BY with additional conditions,"SELECT * 
FROM jobs 
GROUP BY CASE WHEN jobType in ('1','2') THEN '1' ELSE jobType END, address1
"
27927,Add a mysql column to a table from calculations on other tables values,"ALTER TABLE user_shows 
ADD num_comments INT(4);

UPDATE user_shows SET num_comments = (SELECT count(id) FROM comments WHERE comments.id = user_shows.id);
"
17301,"Delete from where count greater than 1, but keep a row",";WITH CTE AS
(
    SELECT  *,
            RN = ROW_NUMBER() OVER( PARTITION BY url
                                    ORDER BY updated DESC)
    FROM [table]
)
DELETE FROM CTE
WHERE RN > 1
"
27558,SQL update rows in column using CASE statement,"UPDATE Users
SET Users.Active = CASE WHEN T.UserName is null THEN 0 ELSE 1 END 
FROM Users AS U
LEFT JOIN #TempTable AS T ON U.UserName = T.UserName
"
8437,Inserting Data with Identity_Insert is ON with Insert into Table1 Select * from Table2,"INSERT INTO TestTable (id, name)
Select * from  
( 
Select 55 as a,'data55' as b 
Union 
Select 56 as a,'data55' as b 
)n 
"
21738,How to sum the values of column on duplicate key?," select name, key, sum(value) as value 
 from mytable group by name,key
"
8178,Sql: SELECT rows with little time difference,"SELECT
  *
FROM
  event_table   AS first
INNER JOIN
  event_table   AS second
    ON  second.eventtypeid     = first.eventtypeid
    AND second.eventtimestamp >  first.eventtimestamp
    AND second.eventtimestamp <= first.eventtimestamp + INTERVAL '3 milliseconds'
"
10109,Mysql Load Data: SET IF for all or given subset of columns?,"col3 = NULLIF(@var3, '') -- etc
"
26636,Update a column with information from 3 other columns,"merge into PROPERTY t
using (select min (b) as min_b, a
       from CFG_DIM_PROPERTY b
       where b.pivot = 'T'
       group by a) t1
on (t.a = t1.a)
when matched then
    update set t.c = t1.min_b;
"
8141,Multiplying Subqueries in Postgres,"SELECT (to_number(g.grade, '9D99') * s.subjunits) AS product
  FROM grade g, registration r, subject s
  WHERE g.grade_id = r.grade_id 
    AND g.grade NOT IN ('INC', 'INP', 'W', 'DRP')
    AND s.subjcode = r.subjcode;
"
28295,display coloumn in database with 2 condition,"select min(case when bagian = 1 then lama end) as bagian_1,
       min(case when bagian = 2 then lama end) as bagian_2,
       min(case when bagian = 3 then lama end) as bagian_3,
       min(case when bagian = 4 then lama end) as bagian_4,
       min(case when bagian = 5 then lama end) as bagian_5
from cuti_tahun;
"
17788,SQL NOT EXISTS (Person hates everybody they know) EDITED,"SELECT * FROM Persons p
WHERE EXISTS
(
    SELECT 0 FROM Knows k
    WHERE k.personA_id = P.id
    AND NOT EXISTS
    (
        SELECT 0 FROM Hates h
        WHERE k.personA_id = h.personA_id
    )
)
"
25767,Insert two select queries in a single row,"SELECT  a.id ,a.[year],valA,valB
from(
SELECT id ,[year],SUM(Total_Volume)/ (count(distinct(month))*7) valA from TableA  
group by id,[year]) a INNER JOIN

(select id,[year],SUM(Total_volume)/(count(distinct(month))*5) valB
from TableA  
WHERE weekday NOT IN ('Friday','Saturday') 
group by station_id,[year]) b
on a.id=b.id and a.[year]=b.[year]
"
8359,Which Oracle table uses a sequence?,"select type, name, line, text
from all_source
where owner = 'MYSCHEMA'
and upper(text) like '%MYSEQ.NEXTVAL%';
"
16399,SQL select with multiple conditions on the same table,"select
  *
from
  table1 t1
  inner join table2 age on t1.id = age.id
  inner join table2 gender on t1.id = gender.id
where
  (age.`key` = 'age' and age.value = 20)
  and 
  (gender.`key` = 'gender' and gender.value = 'male')
"
18559,How fetch the first record after every record that has specific attribute set in PostgreSQL?,"select id, factor, created_at
  from (select id,
               factor,
               created_at,
               lag(factor, 1) over(order by created_at) as prev_factor
          from tbl
         order by created_at) x
 where factor is null
   and prev_factor is not null
"
36881,MySql get status of all records from associative table,"SELECT a.id, IF(i.current IS NULL, 0, current) AS status
FROM album a LEFT JOIN
(
    SELECT albumID, MIN(current) AS current
    FROM icon_album
    GROUP BY albumID
) i ON a.id = i.albumID
"
25459,How to export query results from Postgres to a CSV file,"FORMAT format_name
OIDS [ boolean ]
FREEZE [ boolean ]
DELIMITER 'delimiter_character'
NULL 'null_string'
HEADER [ boolean ]
QUOTE 'quote_character'
ESCAPE 'escape_character'
FORCE_QUOTE { ( column_name [, ...] ) | * }
FORCE_NOT_NULL ( column_name [, ...] )
ENCODING 'encoding_name'
"
27915,Is it possible to aggregate rows like this in MySQL?,"select model,
       max(case when id = 1 then total else 0 end) as id1,
       max(case when id = 2 then total else 0 end) as id2,
       max(case when id = 3 then total else 0 end) as id3
from carmodels t
group by model;
"
9205,SQL Proc parameter to insert WHERE clause?,"create proc myProc (checkForBadData bit)
begin
    SELECT myId, data
    FROM myTable
    WHERE checkForBadData = 0 or theirId IS NULL
end
"
31167,SQL - Finding largest period of activity by customer,"select t.*,
       (select sum(t2.amount)
        from table t2
        where t2.customer = t.customer and
              t2.date >= dateadd(day, -90, t.date) and t2.date <= t.date
       ) as amount90
from table t;
"
6514,unable to create proper sql,"SELECT  *
FROM    message m INNER JOIN
        member snd ON   m.sender = snd.memberid INNER JOIN
        member rcv ON   m.receiver = rcv.memberid
"
24371,In Db2 how to calculate difference of adjacent rows,"SELECT name, 
       age,
       (lag(age, 1, age) over (order by age desc)) - age as agediff
FROM your_table
ORDER BY age desc
"
10333,Enforce SQL Server to drop a database,"EXEC msdb.dbo.sp_delete_database_backuphistory @database_name = N'test'
GO
USE [master]
GO
ALTER DATABASE [test] SET  SINGLE_USER WITH ROLLBACK IMMEDIATE
GO
USE [master]
GO
/****** Object:  Database [test]    Script Date: 06/30/2010 09:12:29 ******/
DROP DATABASE [test]
GO
"
26397,SQL Server - Function call in WHERE condition,"declare @check int,
select @check = dbo.testFunction(@UserId)

SELECT C.AwardId, C.ProgramName, Count(ClientId) as Intakes FROM CDP C 
     LEFT JOIN UserRoleEntity URE ON C.AwardId = URE.EntityId 
     LEFT JOIN UserRole UR ON URE.UserRoleId = UR.Id AND UR.CDPUserId = @UserId
WHERE (1=1) -- here I've other filtering criteria for the results
 AND (   @check = 0
      OR (UR.ID IS NOT NULL AND UR.CDPUserId = @UserId))
GROUP BY C.AwardId, C.ProgramName
"
35800,Combining SQL Insert and Delete,"<input type=""text"" name=""name_117"" value=""Some value"">
<input type=""text"" name=""name_118"" value=""Some other value"">
<input type=""text"" name=""name_1243"" value=""Yet another value"">
"
32549,Is there a way to make an Oracle Job disable itself?,"declare
  Contador number;

begin
 ATUALIZAR_VAL_MAT_PENDENTES(Contador);

 if Contador = 0 then
   dbms_scheduler.set_attribute('JOB_ATUALIZAR_VAL_MAT_PEND', 'end_date', systimestamp + 1);
  end if;
end;
"
9617,display driver and number of shifts involved in that are over 1,"select dr_drvname, count(sh_drvnum)
from driver join shift on dr_drvnum = sh_drvnum
group by dr_drvname
having count(sh_drvnum) > 1;
"
23514,SQL Query - Select Value from T1 where second value fully met in T2,"Select      T1.WBS1 
From        BillingDirectiveNeeded  T1 
Where Exists
(
    Select  1
    From    BillingDirectives   T2
    Where   T2.PKey = T1.PKey
)
"
7422,MySQL ranking query,"select r.*, @row:=@row+1 rank 
  from 
    (SELECT u.user_id,r.totalVotes votes,r.totalPoints rating
       FROM mismatch_user u 
         LEFT JOIN ratingItems r ON u.user_id=r.uniqueName
    ) r
    join (SELECT @row:=0) pos 
ORDER BY r.votes DESC, r.rating DESC
"
1466,Variable of Varchar is always NULL in my UDF in sql server,"When you concatenate null values, either the concat null yields null setting of 
sp_dboption or SET CONCAT_NULL_YIELDS_NULL determines the behavior when one expression 
is NULL. With either concat null yields null or SET CONCAT_NULL_YIELDS_NULL enabled ON,
'string' + NULL returns NULL. If either concat null yields null or 
SET CONCAT_NULL_YIELDS_NULL is disabled, the result is 'string'.
"
33949,Creating a trigger that manipultes a field in SQL Server,"CREATE TRIGGER  trTriggerName  ON  tblNames   
 AFTER INSERT  AS  
UPDATE tblNames 
   SET UpFileName = replace(UpFileName,'%20','_') 
FROM tblNames t
JOIN INSERTED i ON t.ID = i.ID
"
3763,Type Conversion in Persisted Computed Column,"CREATE TABLE t_uuid (charid VARCHAR(50) NOT NULL, uuid AS CAST(charid AS UNIQUEIDENTIFIER))

CREATE INDEX IX_uuid_uuid ON t_uuid (uuid)

INSERT
INTO    t_uuid (charid)
VALUES  (NEWID())

SELECT  *
FROM    t_uuid
"
32679,SQL query looking up number of acquaintances,"select
  m.name,
  count (distinct m2.name)
from
  Membership m join 
  Membership m2 on m.clubName = m2.clubName 
group
  by m.name 
order by
  count (distinct m2.name) desc
"
20288,how to print a sum of column in all rows in sql,"SELECT 
    a.player_name, 
    a.number_of_goals, 
    (a.number_of_goals / b.goalsum)*100 AS percent_scored,
    b.goalsum
FROM   
    myPlayerInfo a
CROSS JOIN 
    (SELECT SUM(number_of_goals) AS goalsum FROM myPlayerInfo) b
"
17334,How to get a different number each month in sql?,"select @location
      ,sum(x.amount) as Tot_amount
      ,sum(case when date_part('month', x.date) = 1 and date_part('year', x.date) = 2014 then amount end) as January_Tot
      sum(case when date_part('month', x.date) = 2 and date_part('year', x.date) = 2014 then amount end) as February_Tot

left join this_table2 y
      on x.no = y.no
where y.desc = 'INCOME' and x.date between '1/1/14' and current_date
"
2093,"Creating MySQL tables question, why some people create two tables that relate to each other instead of one?","- table user
  - id
  - username
  - password
  - etc

- table groups
  - id
  - name
  - etc

- table usergroups
  - userid
  - groupid
"
23932,mysql get row number of a specific result,"SET @rowcount = 0;
SELECT @rowCount:=@rowcount+1 as rowcount, userId, amount FROM 
 (
    SELECT userId, sum(amount) as amount 
    FROM bids 
    WHERE product = xxxxx 
    GROUP BY userId 
    ORDER BY amount DESC
 ) t 
"
9389,SQL Multiple WHERE's assigns a new table column,"select sum(case when coord = 'alfa' then [TOTAL $] end) as T01,
       sum(case when coord = 'beta' then [TOTAL $] end) as T02,
       sum(case when coord = 'gamma' then [TOTAL $] end) as T03
from PFin_base
"
2960,SQL Max and Sum,"SELECT x.County, x.Code x.TotalPaid
    ,RANK() OVER 
    (PARTITION BY x.County ORDER BY x.TotalPaid DESC) AS 'RANK'
FROM

(SELECT 
   County,
   Code,
   Sum(PaidAmount) AS TotalPaid
FROM
   Counties
GROUP BY
   County,
   Code) x
WHERE Rank = 1
"
39839,Oracle output in sqlplus,"SET serververoutput ON;
"
12055,Doing an IF in SQL WHERE,"SELECT
        *

    FROM
        sales_order_header

    WHERE
        order_reference LIKE @order_reference + '%'         AND
        ((@booked_in IS NULL) OR ( booked_in = @booked_in)) AND
        ((@depot_assigned IS NULL) OR 
            ( @depot_assigned = 'Y' AND depot_code <> ' ' ) OR
            ( @depot_assigned <> 'Y' AND depot_code = ' ') )
"
37358,Hive query with efficient join,"SELECT *
FROM ( SELECT *
       FROM big_table
       WHERE eventdate = '2013-09-01') x
JOIN small_table y ON trim(x.ip_adress) = trim(y.ip_address) AND 
                      unix_timestamp(cast(x.date AS TIMESTAMP)) - 
                          unix_timestamp(cast(y.date AS TIMESTAMP)) < 100
LIMIT 5;
"
25532,"TSQL SELECT then UPDATE in one transaction, then return SELECT","with cte as (
 SELECT TOP 20 item_id, field2, field3 
 FROM Table1 WITH (ROWLOCK, UPDLOCK)
 WHERE subject_id = #subject_ID# 
 AND lock_field IS NULL 
 AND NOT EXISTS (
   SELECT * FROM Table2 
   WHERE Table2.user_ID = #user_ID# AND Table1.item_id = Table2.item_id))
update cte   
 SET lock_field = 1, locked_by = #user_ID# 
 output inserted.item_id;
"
36964,Getting the value upon match from the ref table,"SELECT   A.ID
       , A.ValueA
       , B.Place
       , GETDATE()   INTO #TempTable
FROM   Table1 A INNER JOIN Table2 B
ON     A.ValueA = B.ValueB 
"
21777,Group by with join (many to many),"SELECT 
  p.ProductName, 
  STUFF((
    SELECT ', ' + c2.ComponentName 
    FROM Component AS c2
    WHERE c2.idComponent = pc.idComponent 
    FOR XML PATH (''))
  ,1,2,'') AS ComponentsNames
FROM Product_Component AS pc
JOIN Component         AS c ON pc.idComponent = c.ComponentId 
JOIN Product           AS p ON pc.idProduct   = p.ProductId
WHERE p.ProductName = 'Bread'
GROUP BY p.ProductName;
"
38694,Filter out string column,"SELECT Tests.Release, Tests.Result
FROM Tests
WHERE Tests.TestCaseID = 104209 AND Tests.Release <='A1B2C2'
ORDER BY Tests.Release
"
35946,Join two columns in one table to a column in another reference table,"select t1.id, t2.result, t21.name as name1, t21.name as name2
from table1 t1 join
     table2 t21
     on t1.productid1 = t21.id join
     table2 t22
     on t1.productid2 = t22.id;
"
29544,AWS SimpleDB contains value,"select * from myDomain where email like '%@%'
"
17453,inserting into one field value with different conditions using mysql,"UPDATE visits
SET logout_datetime = NOW()
WHERE member_id = 1 AND visit_message = ""accept""
"
33974,Distinct elements in django model,"Foo.objects.values_list('item', flat=True)
"
25599,Design generic attachments SQL Table/Entity in EF Code-First,"Entities Table:
==============
EntityId
EntityName

Attachments Table:
=================
AttachmentId
EntityId
Attachment
"
3590,How to query rows with one matching and one non-matching field,"SELECT DISTINCT mk.*
FROM tblModkeys mk
JOIN tblAllkeys ak1 ON mk.fldcode = ak1.fldcode -- fldcode exists in tblAllkeys
LEFT JOIN tblAllkeys ak2 ON mk.fldkey = ak2.fldkey
WHERE ak2.fldkey IS NULL -- fldkey does not exist in tblAllkeys
"
32797,how to split values in SQL,"declare @var nvarchar(100)='612831408762037_617540318291146';

select 
    LEFT(@var, charindex('_',@var)-1), 
    RIGHT(@var, charindex('_',REVERSE(@var))-1)
"
747,SQL Fallback Row?,"select *
  from table1 
  where id=""a""
union all
select * 
  from table1
  where id=""b""
  and no exists (
    select * 
      from table1
      where id=""a"");
"
10557,Avg value using subquery,"select 
  min(avg_mark) as min_avg_mark,
  max(avg_mark) as max_avg_mark
from
(
  select avg(mark) as avg_mark
  from passed 
  group by student_id
) as avg_marks;
"
15989,How can I get the column names returned by a dbo function,"SELECT *
FROM INFORMATION_SCHEMA.ROUTINE_COLUMNS
"
21864,How can I order a selection by the results of a function (sum)?,"select bill_no, bill_month, ..., (consumption + consumption2 + consumption3) as tot_sum
  from ws_bill
 order by tot_sum desc
"
20697,conditional sql query,"SELECT t2.name,  IF(t1.type='R',t2.revolution,t2.nibs) as value 
FROM table1 t1 
LEFT JOIN table2 t2 ON t1.data2 = t2.name
WHERE t1.data1 = ?
"
1343,how do we order by and select top 20% records in an order in sql,"SELECT COUNT(*), col1
FROM (SELECT TOP 20 PERCENT col1 FROM myTable WHERE col3=2
ORDER BY col2) a
GROUP BY col1
"
9164,How do I add an MSAccess connection to CodeIgniter or CakePHP?,"$db['access']['hostname'] = ""<dsn name>"";
$db['access']['username'] = """";
$db['access']['password'] = """";
$db['access']['database'] = ""<dsn name>"";
"
18425,How to use the sum query for specific rows,"SELECT members.member_id, members.teamname, SUM(total_points)
FROM members, members_leagues, member_results
   WHERE members.member_id = members_leagues.member_id
     AND members_leagues.league_id = '45'
       AND member_results.track_id = '1'
          AND member_results.member_id = members_leagues.member_id
             AND members_leagues.start_race >= member_results.track_id 
GROUP BY members.memberID
"
17235,SELECT statement not returing the Result,"SELECT * FROM Customers
WHERE LEN(REPLACE(name, ' ', '?')) - LEN(name) > 0
"
31455,SQL insert auto increment value,"INSERT INTO actions(Action) VALUES ('Go to the pub');
SET @aid = LAST_INSERT_ID();

INSERT INTO statements(statement, Language) VALUES ('Have a pint', 'English');
SET @sid = LAST_INSERT_ID();

INSERT INTO Relationships(SID,AID) VALUES (@sid,@aid);
"
14800,MS SQL - CASE vs IF performance,"if @Classification < 5
    if @Classification < 3
        if @Classification = 1
        else . . .
    else if @Classification = 3 . . .
    else . . .
else . . .
"
25466,How to write an Excel function which returns a value from an ACCESS database?,"Public Function getData(whatDate As Date) As Variant

Dim DB As Database
Dim RS As Recordset

Set DB = DBEngine.OpenDatabase(""C:\temp\Desktop\Test.mdb"")
Set RS = DB.OpenRecordset(""SELECT USD FROM CB_EXCHANGE WHERE RDate = #"" & Format(whatDate, ""m\/d\/yyyy"") & ""#"", dbOpenDynaset) ' The date format must be like this

If RS.RecordCount > 0 Then
    RS.MoveFirst
    getData = RS!USD ' of course you must enter the correct column name
End If

End Function
"
13051,SQL dateformat while creating table,"select date_format(begin_datum, '%e-%b-%y')
"
39226,Query with rownum got slow,"SELECT T_PK
FROM (SELECT T_PK
      FROM table
      WHERE col1= 'text' AND col2 IS NULL
      ORDER BY T_PK DESC
     ) t
WHERE ROWNUM < 100;
"
30895,Oracle MERGE statement not 'sticking' using DevArt dotConnect for Oracle,"OracleConnection conn = new OracleConnection(""User Id=user;Password=pass;Server=dboracle;SID=sid;Direct=true"");
conn.Open();
OracleTransaction t = conn.BeginTransaction();
OracleCommand comm = new OracleCommand(@""MERGE INTO ..."");// place here your merge statement
comm.Transaction = t;
comm.Connection = conn;
comm.ExecuteNonQuery();
t.Commit();
"
39625,Select Distinct Values for 2 colums but Not the 3rd,"   $term =mysql_real_escape_string($_REQUEST['term']); 
   $rs = mysql_query(""
                      select StateInitials, City 
                      from locations 
                      where City like '$term%' 
                      GROUP BY StateInitials, City
                      limit 0,15"", $dblink);
"
2295,"Get records added last week, but exclude records added today","SELECT * FROM table where 
DATE(date_added) > DATE_SUB(CURDATE(), INTERVAL 7 DAY) 
AND 
DATE(date_added) < CURDATE()
"
27189,Insert trigger not inserting new rows in other table,"INSERT INTO [dbo].[IVRTestB] (IVRAID, IVRName, DayNumber, OpenFlag)  
   SELECT
      i.IVRAID, i.IVRName, i.DayNumber, i.OpenFlag    -- *NO* single quotes here!!!!
   FROM   
      inserted i
   -- change this WHERE clause to insert those rows that AREN'T alredy in IVRTestB !
   WHERE
      i.IVRAID NOT IN (SELECT DISTINCT IVRAID FROM dbo.IVRTestB)
"
14355,MySQL Selecting data from table2 where table1.field is equal (and add it on to the result),"SELECT p.*,
       case
         when w.license_number is not null then
          w.license_number
         when s.premises_license_number is not null then
          s.premises_license_number
         else
          null
       end as profilelicense_number
  FROM Profiles p
  LEFT JOIN Studios s
    on p.profile_id = s.profile_id
  LEFT JOIN Workers w
    on p.profile_id = w.profile_id
"
38883,update column in a table,"SET  [GrpId]         = RN2
    ,DisplayingOrder = RN1
"
22579,H2 Get row count for all tables,"drop alias count_rows;
create alias count_rows as 
'long countRows(Connection conn, String tableName) 
    throws SQLException {
ResultSet rs = conn.createStatement().
    executeQuery(""select count(*) from "" + tableName);
rs.next();
return rs.getLong(1); }';
select table_name, count_rows(table_name) count 
from INFORMATION_SCHEMA.TABLES 
where table_schema = 'PUBLIC';
"
31838,Updating Fields using Case Qquery,"Select a.channel_name, p.package_name
From TableA a left outer join
     (select 'bbc' as channel_name, 'entertainment_pack' as package union all
      select 'bbc' as channel_name, 'extra_pack' as package
     ) p
     on a.channel_name = p.channel_name;
"
6952,SQL Server function to a get particular date and month regardless year,"DECLARE @UserDate SMALLDATETIME
IF(DatePart(mm, @UserDate) = 2 AND DatePart(dd, @UserDate) = 14)
BEGIN
    /* some expression */
END
"
31013,How to perform a left outer join between two tables?," select s.Title, s.ShoppingListId, count(g.GroceryItemId) AS 'NoOfGroceryItems'        
FROM ShoppingLists s
        left outer join JOIN GroceryItems g ON s.ShoppingListId = g.ShoppingListId
         group by s.Title, s.ShoppingListId
"
10171,Specifying properties to be updated in linq query,"foreach (string propName in propertiesNames)
{
    PropertyInfo prop = this.GetType().GetProperty(propName);
    prop.SetValue(valueForProp);
}
"
840,FULLTEXT search SQL,"SELECT * FROM functions
     WHERE MATCH (function_description)
     AGAINST ('akram' IN BOOLEAN MODE)
"
19379,Change value of one result column if it is null,"select column1, column2, column3, column4, ISNULL(column5,0) as column5
 from mytable
"
14871,"How can I join 3 tables and calculate the correct sum of fields from 2 tables, without duplicate rows?","select * 
from A
join (select B.a_id, sum(B.cost) as cost 
  from B 
  group by B.a_id) B on A.id = B.a_id
left join (select C.keyword_id, sum(C.clicks) as clicks
  from C
  group by C.keyword_id) C on A.keyword_id = C.keyword_id
group by A.id
having sum(cost) > 10
"
10520,indexing expressions in sql,"CREATE INDEX notNullblob ON myTable (blobCol is not NULL);
"
4997,filter the data in grid view by using select query,"SELECT * 
FROM bUser 
WHERE (  (id+'' LIKE @id) and (name LIKE '%'+@name+'%') AND (email LIKE '%'+@email+'%') )
"
31888,Check if times are equal in sql server,"where 
  datediff(minute,DATEADD(MINUTE, @Duration, @NotificationTime),GETDATE()) = 0
"
30962,OrientDB SQL function parameter values are not accessible inside the function body,"insert into Feature (weight, title) values (:w, :t) return @rid
"
20372,"Update query on MySQL only when two conditions exist, otherwise Insert (","delimiter //
CREATE PROCEDURE smartInsert(given_id_user bigint(20),given_source varchar(50), given_content text) 
BEGIN 

IF (EXISTS(SELECT * FROM p_l_0215 WHERE `id_user`=given_id_user AND `source`=given_source))
THEN
    UPDATE p_l_0215 SET `content`=given_content WHERE `id_user`=given_id_user AND `source`=given_source;
ELSE
      INSERT INTO p_l_0215 VALUES (null, given_id_user, given_source, given_content);
END IF;
END//
delimiter ;
"
551,SQL string value spanning multiple lines in query,"UPDATE User
SET UserId = 12345
   , Name = 'J Doe'
   , Location = 'USA'
   , Bio='my bio
spans 
multiple
lines!'
WHERE UserId = 12345
"
35801,MySQL Query result explanation,"SELECT * FROM table WHERE 
(`FirstName` LIKE 'D%' OR `LastName` LIKE 'D%' OR `City` LIKE 'D%')
AND
(`FirstName` NOT LIKE 'D%' AND `LastName` NOT LIKE 'D%' AND `City` NOT LIKE 'D%')
"
34437,Firebird SQL: wildcard % with null values,"SELECT
  *
FROM
  my_table
WHERE
  COALESCE(my_field, -1) = some_value
"
39728,select distinct values of a replaced selected result,"SELECT DISTINCT LEFT(serviceName, LOCATE('-', serviceName) - 2) FROM tableName;
"
16775,sqlite equivalent of row_number() over ( partition by ...?,"DELETE FROM data
WHERE AnId IN (SELECT AnId
               FROM data AS d
               WHERE d.UserId = data.UserId
               ORDER BY SomeDate DESC
               LIMIT -1 OFFSET 10)
"
18865,SQL across two tables is showing duplicate records,"SELECT s.* 
FROM shop_products s
where s.sequence 
in(select distinct product_seq from shop_product_attributes where type = 'category' and value=1)
"
23969,Oracle Pl/sql return one cursor from multiple queries,"open rc for 
    select * from (
        select t.*
               , row_number() over (partition by id order by whatever ) rn 
        from table_name t 
        where t.id in (List of ID`s)
     )
     where rn <= 3;
"
13241,Can I clean up this XML query?,"SELECT
  auditId,
  T.N.value('.', 'nvarchar(256)') AS value,
  T.N.value('@entityId', 'nvarchar(256)') AS entityId,
  T.N.value('@entityType', 'bigint') AS entityType,
  T.N.value('@localizable', 'bit') AS localizable
FROM audit
  CROSS APPLY parameters.nodes('/params/param[sql:variable(""@Index"")]') AS T(N)
"
15362,Selecting the last instance of the record but returning the first instance of it,"SELECT callid, 
       (SELECT calling_pty 
        FROM Log l
        WHERE Log.callid = l.callid AND
              segment = (SELECT MIN(segment) 
                         FROM Log l2
                         WHERE l.callid = l2.callid) 
       )[calling_pty], 
       dialed_num, disposition, dispvdn, segment, ucid
FROM Log
WHERE disposition = 3
"
20618,Having a flat file system how to implement file collections?,"CREATE TABLE IF NOT EXISTS files (
    encoded_url varchar(300) UNIQUE NOT NULL primary key,
    file_name varchar(150) NOT NULL,
    user_name varchar(65) NOT NULL,
    is_public BOOLEAN NOT NULL,
    modified DATETIME NOT NULL default CURRENT_TIMESTAMP,
    type varchar(20),
    size INTEGER(8)
);

CREATE TABLE IF NOT EXISTS collections (
  .....
);

CREATE TABLE IF NOT EXISTS collection_relation (
      encoded_url ....,
      collections_key ....
);
"
37014,"Distinct, count and sort in one sql query","select fk_user from 
xxx
group by fk_user
order by count(*) desc
"
8594,Select Distinct Set Common to Subset From Join Table,"select booth_id from table1 where [user_id]
in (1,2,3) group by booth_id having count(booth_id) = 
(select count(distinct([user_id])) from table1 where [user_id] in (1,2,3))
"
22638,MySQL Select and Order by with a Limit that can change,"SELECT t.*
FROM table t JOIN (
    SELECT points
    FROM table r
    WHERE r.gameid = 2
    ORDER BY r.points DESC
    LIMIT 3
) tr ON t.points = tr.points
WHERE t.gameid = 2
"
12805,DATEADD() function to find values in this business day,"-- cache current date to avoid multiple calls
DECLARE @startOfADay INT
DECLARE @dayLength INT
DECLARE @currentDate DATETIME
SET @currentDate = DATEADD(dd, 0, DATEDIFF(dd, 0, GETDATE()))
SET @startOfADay = 9
SET @dayLength = 8

SELECT 
   ...
FROM
   ...
WHERE ...
BETWEEN 
      DATEADD(hh, @startOfADay, @currentDate) 
      AND 
      DATEADD(hh, @startOfADay + @dayLength, @currentDate)
"
10314,PostgreSQL display month in correct order,"SELECT TO_CHAR(dt,'Mon') 
FROM tb 
ORDER BY dt
"
24128,functional dependency for mysql,"CREATE VIEW MyGuestsView
SELECT id, firstname, lastname, CONCAT(firstname, lastname) AS fullname, email, reg_date
FROM MyGuests
"
34255,Drop all temporary tables for an instance,"declare @sql nvarchar(max)
select @sql = isnull(@sql+';', '') + 'drop table ' + quotename(name)
from tempdb..sysobjects
where name like '##%'
exec (@sql)
"
16017,Check if unique value exists before updating in MSSQL,"UPDATE [rs_DEVICES]
SET [device] = dbo.pad_zero(12,[device])
WHERE LEN([device]) < 12 AND NOT EXISTS (
    SELECT 1 FROM rs_DEVICES r1 WHERE r1.device = dbo.pad_zero(12,[device])
)
"
23421,how to update all rows of a specified data group in SQL server based on a condition?,"UPDATE MyTable
SET IsConsideredNewHire = 0
WHERE ControlGroupID IN (SELECT DISTINCT ControlGroupID 
                         FROM MyTable
                         WHERE IsConsideredNewHire=0)
"
18754,Save All Results to Excel,"SELECT distinct id, cast(text as varchar(255)) as text
FROM tableA, TableB
WHERE (various joins here...)
"
35208,Join query on Date Range,"SELECT
  p.StartDate,
  p.EndDate,
  h.PersonID
FROM Periods p
  LEFT JOIN History h
    ON h.[From] BETWEEN p.StartDate AND p.EndDate OR
       p.StartDate BETWEEN h.[From] AND ISNULL(h.[To], '30000101')
"
17536,Is there a way to change permissions for all the tables in SQL-server database at once?,"SELECT
    'GRANT SELECT ON ' + OBJECT_NAME(o.object_id) + ' TO myRole'
FROM
    sys.objects o
WHERE
    OBJECTPROPERTY(o.object_id, 'IsMSSHipped') = 0
    AND
    OBJECTPROPERTY(o.object_id, 'IsTable') = 1
ORDER BY
    OBJECT_NAME(o.object_id)
"
33494,Select distinct field along others query while statement is done,"SELECT * FROM mytable GROUP BY f2
"
17817,How do I fill empty fields based on the most common value of the same?,"UPDATE s
SET s.date_of_birth = (
  SELECT top 1 date_of_birth
  FROM student
  WHERE batch = s.batch
  GROUP BY date_of_birth
  ORDER BY count(*) desc
)
FROM student s
WHERE s.date_of_birth IS NULL
"
3413,SQL Server: LEFT OUTER JOIN with TOP 1 to Select at Most One Row,"select *
from CarePlan c
outer apply (
    select top 1 * --top N rows
    from Referral r
    where r.CarePlanId = c.CarePlanId --join condition
    order by /*fill this in!*/
) x
"
33568,MySQL Tables Arrangement,"select p.*
from people p
where not exists (select 1 from users u where p.personid = u.personid);
"
18032,How to show many same data in one table,"select cola from abc
union all
select cola from abc
union all
select cola from abc
"
11152,(Common Table Expressions) CTE as part of WHERE clause... possible?,"WITH recursive_cte AS (
   -- root selection (dynamic, generated in code)
   SELECT Bla FROM Table2
   -- recursive part
   UNION ALL
   SELECT …..)
SELECT t.*
  FROM TABLE1 t
  JOIN recursive_cte rc ON rc.key = t.pk
"
29330,how to show field name if it set to true,"select cast(FaName as varchar)+' - '+cast( 
case when IsSpecial = 1 then 'IsSpecial,' else '' as varchar)+cast(
case when IsPerishable = 1 then 'IsPerishable,' else '' as varchar)+cast(
case when IsDanger = 1 then 'IsDanger' else '' as varchar)
from your_table
"
4143,How to get a specified character of a string,"MID(col, 2,1)
"
25329,Multiple query event failing,"SET autocommit=0;
"
811,Avoid SQL WHERE NOT IN Clause,"SELECT * 
FROM  `article` 
LEFT JOIN `blog_article` ON CONCAT(`blog_article`.`article_id`) = `article`.`id`
                            AND  `blog_article`.`blog_id` = 1 -- example value
WHERE `blog_article`.`article_id` is null --replace the not in
"
23369,connecting to mirror database when principal downs,"
Data Source=myServerAddress;Failover Partner=myMirrorServerAddress;Initial Catalog=myDataBase;Integrated Security=True;
"
10079,Subquery between three tables using Northwind database with SQL Server,"  WITH CTE AS 
    (SELECT ProductID, 
           o.CustomerID,
           Discount,
           ROW_NUMBER() OVER(PARTITION BY o.CustomerID ORDER BY Discount DESC) Row_num
    FROM [Order Details] od INNER JOIN Orders o
         ON od.OrderID= o.OrderID
    )
    SELECT ProductID, 
           CustomerID,
         Discount
    FROM CTE
    WHERE Row_num = 1
"
25542,Group with independient columns in mysql query,"SELECT SUM(t.CA001) AS CA001,
       SUM(t.CA002) AS CA002,
       SUM(t.CA003) AS CA003
FROM
(
    SELECT CASE WHEN cat_id = 'CA001' THEN Total ELSE 0 END AS CA001,
           CASE WHEN cat_id = 'CA002' THEN Total ELSE 0 END AS CA002,
           CASE WHEN cat_id = 'CA003' THEN Total ELSE 0 END AS CA003
    FROM category_results
) t
"
32289,Assistance with creating an UPDATE statement please,"UPDATE t1
SET t1.Col1 = t2.Col1,
    t1.Col2 = t2.Col2
FROM DestTable t1
INNER JOIN StagingTable t2 ON (t1.Col1 = t2.Col1 AND t1.Col2 = t2.Col2)
"
240,Need help on MYSQL query returning common rows,"SELECT  t.Make
FROM   
    (SELECT DISTINCT c.YEAR, c.Make
    FROM cars c) t 
WHERE t.YEAR IN (1992,1993,1994)  -- all the years
GROUP BY t.make
HAVING COUNT(*) = 3 --total number of years
"
4649,SQL Server - Display the username in a column,"CREATE TABLE MyTable 
(
   ID int, 
   Value varchar(30), 
   User_Input varchar(200) DEFAULT SYSTEM_USER
)   
"
6792,Joining of Multiple table,"SELECT a.id,a.Name,a.Total_Members,c.Total_Amount
FROM committee_Group a
INNER JOIN (SELECT Name,sum(Contribution) as 'Sum_Con'
            FROM Group_Member
            GROUP BY Name)b on a.Id=b.Id
INNER JOIN comitees c on c.Total_Amount=b.Sum_Con
                     and b.Name=c.Name
"
39092,How to update datetime column from a row?,"UPDATE CSEReduxResponses 
SET approveddate = '2014-03-02'
WHERE response_id = 76
"
11876,Selec row between certain range of date,"SELECT * 
FROM `reservations`  `res` 
WHERE ('2012-05-03' 
   NOT BETWEEN res.expected_checkin_date AND res.expected_checkout_date) 
 AND COALESCE('2012-05-08' 
   NOT BETWEEN res.expected_checkin_date AND res.expected_checkout_date) 
"
7585,What would be the best join to accomplish my end data?,"SELECT
  ISNULL(c.CPTCode, p.CPTCode) as CPTCode,
  c.MTD,
  p.TotalCharges,
  p.TotalUnits
FROM
 #C c 
  FULL OUTER JOIN #Prod p
     ON c.grpType = p.grpType AND c.CPTCode = p.CPTCode
"
19324,"How Do I Query for ""Per Day"" results for a given date range in MS SQL?","select count(*),
       datepart(year,created) as [year],
       datepart(month,created) as [month],
       datepart(day,created) as [day]
from table
where created >= '8/1/2009'
      and created < '9/1/2009'
      and datepart(hour,created) >= 8
      and datepart(hour,created) <= 17
group by datepart(year,created), datepart(month,created), datepart(day,created)
"
29418,select 100 records in range,"SELECT a.* FROM (
     SELECT Row_Number() OVER(ORDER BY table.MySortCol) as RowNum,
     table.* -- columns you need
     FROM table
) a
WHERE a.RowNum between 1 and 100
"
26490,ms-access: check if font color is white,"If Me!SomeControl.Properties(""ForeColor"") = 16777215 Then
"
18977,Dividing column values based on other column values,"SELECT
   CUSTOMER_NAME,
   SUM(CASE WHEN TIMEFRAME = 'CURRENT'  THEN GROSS_SALES END)
   /
   SUM(CASE WHEN TIMEFRAME = 'PREVIOUS' THEN GROSS_SALES END)  AS SALES_FACTOR
FROM
   yourTable
GROUP BY
   CUSTOMER_NAME
"
34871,Count the number of occurences of a string in a VARCHAR field?,"SELECT 
    title,
    description,    
    ROUND (   
        (
            LENGTH(description)
            - LENGTH( REPLACE ( description, ""value"", """") ) 
        ) / LENGTH(""value"")        
    ) AS count    
FROM <table> 
"
32992,on CakePHP : How to use and connect alternative database config when it's failed to connect to DB for the first try,"            $Database = ConnectionManager::getInstance();
            $Database->config = new DATABASE_CONFIG();

            $dataSource = $Database->getDataSource('default');
            if (!$dataSource->isConnected()) { ... } else { ... }
"
38537,Limit on a MySql join,"select c.`name`, c.`retainer_value`, max(u.`date`)
from customer c left join
     updates u
     on c.id = u.`clientid`
WHERE c.`retainer_value` < 250 AND c.switchedoff = 'N' AND c.companyid <> 3 AND
      c.retainer_value > 20
group by c.id
order by max(u.`date`) DESC
"
13860,"SQL Query, Selecting 5 most recent in each group","SELECT c1.*
FROM codes c1
LEFT OUTER JOIN codes c2
  ON (c1.language_id = c2.language_id AND c1.time_posted < c2.time_posted)
GROUP BY c1.id
HAVING COUNT(*) < 5;
"
13145,MySQL: Unique constraint on multiple fields,"alter table Variable_Entries add unique (var_id, value);
"
30660,Get list of unique records,"SELECT employeeid  AS Employee
FROM tableA
UNION
SELECT managerid AS Employee
FROM tableA
"
4732,SUM of column that has been GROUPED BY,"SELECT SUM(mgap_growth) AS total_mgap_growth
FROM (SELECT mgap_growth 
      from mgap_orders 
      WHERE account_manager_id = '159795' 
      GROUP BY mgap_ska_report_category) AS x
"
839,Optimising search on primary key for large table,"SELECT films.film_name
FROM `films`
JOIN popular_films
  ON popular_films.film_id = films.film_id;
"
32516,Update comma-separated column in SQL Server 2008,"update yourtable
set col = substring(col, 1, charindex(',', col)-1)
where charindex(',', col) > 0  -- only update the rows with a comma
"
38638,Executing a command in SQL Server 2012 from VBScript,"dim dbconn, connect
connect = ""Driver={SQL Server};Server=XXX;database=XXX;uid=XXX;pwd=XXX""
Set dbconn = CreateObject(""ADODB.Connection"")
dbconn.Open connect
dbconn.Execute(SQL)
"
37138,"SQL Where clause does not filter out ""Zero"" values"," WHERE ((CASE WHEN installment IS NOT NULL THEN (amount-installment) 
               ELSE(amount) END)> 0 )
"
6295,SQL: Remove rows if it contains a date in the past,"delete t from t
    where (case when text glob '[0-9][0-9]/[0-9][0-9]/[0-9][0-9]'
                then replace(text, '/', '-')
                when text glob '[0-9][0-9]/[0-9][0-9]'
                then strftime(date('now'), '%Y') || '-' || substr(text, 1, 2) || '-' || substr(text, 4, 2)
           end) < strftime(date('now'), '%Y-%m-%d')
"
31785,is it possible to trim last three characters in string with selected row in selected column,"select case a.rownumber
          when 2 then substr (a.detail, 0, length (a.detail) - 3)
          else a.detail
       end, a.*
  from address a
 where a.detail_no = 1
"
12424,SQL (any) Request for insight on a query optimization,"select a.* from a where a.id in (select id from b where b.id = a.id)

select a.* from a where a.id in (select id from b)
"
3588,"Oracle SQL query count, group by with an innerjoin?","select
  g.GROUP_NAME,
  g.GROUP_ID,
  count(*) as CAR_COUNT
from
  GROUP g
  inner join DEALER d on d.GROUP_ID = g.GROUP_ID
  inner join CAR c on c.DEALER_ID = d.DEALERID
group by
  /* Also add here all field you want to select from GROUP */
  g.GROUP_NAME,
  g.GROUPID
"
36122,sql server count() function?,"SELECT     Projects.projectName AS [Project Name],
                  ISNULL(COUNT(Projects_tasks.taskID),0) AS #tasks, Projects.projectID AS [Project ID]

FROM       Projects LEFT JOIN
                  Projects_tasks ON Projects.projectID = Projects_tasks.projectID 

GROUP BY Projects.projectName,Projects.projectID
"
27232,How to assign rank with single query to multiple colums ? ,";with C as
(
  select priceRank,
         row_number() over(order by price desc) as rn
  from Table_1
)
update C
set priceRank = rn
"
25994,Inserting XML documents into SQL Server 2008 database,"CREATE PROCEDURE sp_XMLLoad
   @FileName
AS SET NOCOUNT ON
SELECT  X.article.query('id').value('.', 'INT'),
        X.article.query('article').value('.', 'VARCHAR(50)'),   
        X.article.query('/doc/text()').value('.', 'VARCHAR(MAX)')
FROM (
      SELECT CAST(x AS XML)
      FROM OPENROWSET(
            BULK @FileName,
            SINGLE_BLOB) AS T(x)
"
22567,"Sql Insert Error -""Subquery returned more than 1 value""","    INSERT INTO CustomerGroupLocationMap(LocationID, CustomerGroupID) 
        SELECT @i_LocationID, t.*
        FROM dbo.CSVToTable(@i_CustomerGroupID) t;
"
25652,Finding a matching value on two columns,"SELECT DISTINCT t.b
FROM your_table t
INNER JOIN your_table s
ON t.b = s.c
AND t.id <> s.id
"
25624,Create a 'timeline' with multiple tables (SQL),"SELECT Email, DateTime FROM
  (SELECT landing_email as Email, landing_date as DateTime FROM landing 
   UNION 
   SELECT tracker_email as Email, tracker_date as DateTime FROM tracker
   UNION
   SELECT links_email as Email, links_date as DateTime FROM links)
WHERE EMAIL='user@domain.com'
ORDER BY DateTime;
"
14418,Update only one record in SQL Server conditionally,";WITH CTE AS(
    SELECT TOP (1) *
    FROM #tempResult
    WHERE SourceTypeId = 658
    ORDER BY NEWID()
)
UPDATE CTE SET IsSelected = 1
"
27271,How to calculate total weight of all components in Oracle,"select componentid,
         (select sum(cs.weightkg)
            from component c2, componentstats cs
           where c2.componentstatsid = cs.componentstatsid
               start with c2.componentid = c1.componentid
         connect by prior c2.componentid = c2.fkcomponentid) sum_weightkg
from component c1
start with c1.fkcomponentid is null
connect by prior componentid = fkcomponentid;
"
32535,the last result of the rules,"SELECT ru.id, ru.description, re.result_of_the_rule, re.date
    FROM (SELECT rule_id, MAX(date) AS MaxDate
              FROM result
              GROUP BY rule_id) q
        INNER JOIN rules ru
            ON q.rule_id = ru.id
        INNER JOIN result re
            ON q.rule_id = re.rule_id
                AND q.MaxDate = re.date
"
19148,Looping through entries,"inner join SOME_OTHER_TABLE 
    on SOME_OTHER_TABLE.SOME_COL = DSR_SEGMENT_LIGNE.SEG_NOM 
"
14802,How to update table using foreign key in sql,"UPDATE employee  
SET E.image = '123.jpg' 
FROM employee,personal_data
where employee.emp_id = personal_data.emp_id
"
16785,Slick Plain Sql Generic Return Type,"ResultMap extends GetResult[Map[String, Any]] {
  def apply(pr: PositionedResult) = {
    val resultSet = pr.rs
    val metaData = resultSet.getMetaData();
    (1 to pr.numColumns).map { i =>
      metaData.getColumnName(i) -> resultSet.getObject(i)
    }.toMap
  }
"
30196,Using Merge in Oracle SQL,"MERGE INTO table1 t
USING (
  ... subquery joining TABLE2 and TABLE3 ...
) f
ON f.something = t.something
...
"
17030,How can I show values from two tables with one SELECT command in SQL?,"select orders.*, prices.price
from orders
join prices on prices.foodName = orders.foodName
"
11731,Access 2013 - Count Field Values While Adding Any New Fields,"Public Function fReturnFieldList(strTableName)
Dim rst As DAO.Recordset
Dim fld As Field
Dim strReturn As String

   On Error GoTo ProcError

   Set rst = CurrentDb.OpenRecordset(strTableName)
   For Each fld In rst.Fields
      strReturn = strReturn & "", "" & fld.Name
   Next fld

EXIT_Proc:
   fReturnFieldList = Mid(strReturn, 3)
   On Error GoTo 0
   Exit Function

ProcError:
   strReturn = "", Cannot process "" & strTableName
   Resume EXIT_Proc

End Function
"
22698,convert datetime to varchar(50),"SELECT convert(varchar, getdate(), 103) 
+' '+ CONVERT(varchar(15),CAST(getdate() AS TIME),100)
"
37010,How to only display results in a query where an ID column is displayed 3 times,"Select lcustomerid
from . . .
where dtcreated between @startdate and @enddate and result = 'Declined'
group by lcustomerid
having count(*) >= 3;
"
27716,Find the rating that given to a certian game by each member who rated it in SQL,"SELECT rating, name 
FROM ratings, members 
WHERE gameID = 2 and ratings.memberID = members.id;
"
27598,How to calculate a ratio and cater for division by zero in SQL,"Select Cast([Timestamp] As Date) As 'Day'
  , Sum(P) As Pas
  , Sum(U) As Ufr
  , Sum(D) As Des
  , Sum(F) As Fir
  , Sum(M) As Mol
  , IsNull( (Sum(M) / NullIf( Sum(P) * 1.0000 + Sum(U), 0 ) ) *100, 0) As [M%]
From Dataset
Group By Cast([Timestamp] As Date)
Order By [Day] Desc
"
25387,Non-logged table load without using SELECT INTO,"truncate table rptTable
insert into rptTable with (TABLOCK)
select fields 
from source
"
3637,Consecutive dates postgresql,"SELECT document, the_day, the_day - lag(the_day) OVER w AS gap
    FROM mytable
    where active=true and fault=false
    WINDOW w AS (PARTITION BY document ORDER BY document,the_day)
"
23756,"Tracking differences between two SQL tables (added, removed, changed)","Select code-id, 'added' result from a
Except
Select code-id, 'added' result from b
Union all
Select code-id, 'removed' result from b
Except
Select code-id, 'removed' result from a
Union all
Select code-id, 'changed' result 
from a join b on a.code-id = b.code-id 
Where a.code-name-1 != b.code-name-1 or a.code-name-2 != b.code-name-2
"
18206,How to get all children of parent item when all are in the same row and table,"DECLARE @pID VARCHAR(20) = 'A'

;WITH CTE AS (
   SELECT ChildPart
   FROM mytable
   WHERE Part = @pID

   UNION ALL

   SELECT t1.ChildPart
   FROM mytable AS t1
   INNER JOIN CTE AS t2 ON t1.Part = t2.ChildPart
)
SELECT ChildPart
FROM CTE
"
35542,SQL: Query integer column in specific format,"select right('000' + convert(varchar(3), intcolumn), 3) from yourtable
"
1976,Oracle Plsql Date Time Manipulation,"C = B + (A - trunc(A));
"
37402,"""There is already an object named XXXX in the database"" after creating New database","CREATE DATABASE PROJECT
GO

USE PROJECT
GO

CREATE TABLE Courses 
(
  CourseID INT NOT NULL PRIMARY KEY,
  Name VARCHAR(64) NOT NULL UNIQUE,
  Code CHAR(4) NOT NULL UNIQUE
)
GO
"
1480,View to show/hide row values based on another table in SQL,"SELECT c.cust_id,
    nvl2( q.tel_no, null, c.tel_no ) tel_no,
    nvl2( q.email, null, c.email ) email
FROM contact_data c
LEFT JOIN (
  SELECT cust_id,
      min(case channel when 'tel_no' then 1 end) tel_no,
      min(case channel when 'email' then 1 end) email
  FROM opt
  GROUP BY cust_id 
) q
ON c.cust_id = q.cust_id
ORDER BY c.cust_id
"
33390,"Combine two queries, one based upon the other, into one","SELECT a.ID, a.AreaName
FROM
    tblArea AS a
    LEFT JOIN
        (
            SELECT i.*
            FROM tblIssues AS i
            WHERE i.NewsletterLookup=5
        ) AS sub
    ON a.ID = sub.[AreaLookup]
WHERE
        a.Dormant=False
    AND sub.NewsletterLookup Is Null;
"
13395,MySQL - make ORDER BY sort by number embedded into a string field,"order by substring_index(col, '-', -1) + 0
"
22188,"Sql Server is not combining the results , it is becoming mutually exclusive","select * from @billingEdit
where (HCPC_CODE like '%LCS%' and ALLOWED_AMT > 0)
or (isnull(HCPC_CODE,'') not like '%LCS%');
"
3234,Fill null values with last non-null amount - Oracle SQL,"select item, year, month, amount, 
       last_value(amount ignore nulls) 
         over(partition by item 
              order by year, month 
              rows between unbounded preceding and 1 preceding) from tab;
"
10112,Making a table display records from multiple tables and as well as adding new records at the same time,"  SELECT Name + ', ' + Age + ', ' + Gender As Description ,
         DateCreated
    FROM Table1

  UNION

  SELECT CarMake + ', ' + Model + ', ' + Year As Description ,
         DateCreated
    FROM Table2

ORDER BY DateCreated
"
6764,SQL order by variable in inner statement,"select bs.*
from backstage bs
inner join
(
select backstage_id,count(distinct ip_address) as distIpCount
from visitor_counter
where backstage_id !=0
group by backstage_id
) vc on vc.backstage_id = bs.backstage_id
order by vc.distIpCount desc
limit 0,100;
"
29515,Concatenate dynamic columns in SQL Server 2008?,";with cte as
(
  select membername, hoursworked,
    projectcode +'-'+cast(hoursworked as varchar(10)) projectcode
  from yourtable
)
select c.membername,
  sum(c.hoursworked) hoursworked,
  STUFF(
         (SELECT ', ' + projectcode
          FROM cte c2
          where c.membername = c2.membername
          FOR XML PATH (''))
          , 1, 1, '')  AS details
from cte c
group by c.membername;
"
13625,How to return first few characters in a string by trimming last 8? (SQL Server 2008),"select substring(column_name, 1, len(column_name)-8)
from table_name
"
12551,Stored procedure that does not filter if a variable is null,"or t3.AcctCode is null
"
3641,Writing a SELECT query for the following table,"Select cars from (select cars, count(*) as nbr from theTable group by cars) 
where nbr > 1;
"
14069,Conditional ordering with priority to a column,"ORDER BY (IsSponsored = 1) DESC,
         (CASE WHEN IsSponsored = 1 THEN RANK END) ASC,
         PopularityScore DESC;
"
28957,How to display result and or any message in trigger body?,"CREATE TABLE table1 (
  column1 VARCHAR(255) DEFAULT NULL
);

CREATE TABLE messages (
  id INT(11) NOT NULL AUTO_INCREMENT,
  message VARCHAR(255) DEFAULT NULL,
  time TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (id)
);

DELIMITER $$

CREATE TRIGGER trigger1
    AFTER INSERT
    ON table1
    FOR EACH ROW
BEGIN
  INSERT INTO messages(message) VALUES ('new action');
END
$$

DELIMITER ;
"
22784,How can I concatenate multiple values in a single field or column? (MySQL),"SELECT bsb.ORDER_ID AS order_id, 
GROUP_CONCAT(CONCAT('product_id: ',bsb.PRODUCT_ID,' | ',bsb.PRICE) SEPARATOR ';') AS line_items
FROM bsb
INNER JOIN bso ON bso.ID = bsb. ORDER_ID
WHERE bsb.ORDER_ID in(255, 300)
GROUP BY bsb.ORDER_ID 
"
30806,What is this part,"<object> ::=
{ 
    [ server_name . database_name . schema_name . 
    | database_name .[ schema_name ] . 
    | schema_name .
    ]
    table_or_view_name}
"
22442,Oracle optimizing query involving date calculation,"create index myindex on table2(starttime, starttime + Duration / 24);
"
16097,Separated List with id's of related columns,"select a.*,
       (select group_concat(b.id)
        from mytable b
        where b.group = a.group and b.id <> a.id
       ) as OthersInGroup
from myTable a;
"
33902,max count together in an sql query 2,"SELECT t.id,
       t.description AS most_popular_description,
       COUNT(*) AS times_the_desc_appeared_for_an_id
FROM mytable t INNER JOIN (
  SELECT id, stats_mode(description) AS desc FROM mytable GROUP BY id
) a ON t.id = a.id AND t.description = a.desc
GROUP BY t.id, t.description;
"
38397,"SQL OVERLAPS operator problem, how to get rid of it","SELECT (TIMESTAMP '2011-01-28 00:00:00', TIMESTAMP '2011-02-01  23:59:59') OVERLAPS (TIMESTAMP '2011-02-01 00:00:00', TIMESTAMP '2011-02-01 23:59:59');
"
8033,odp.net SQL query retrieve set of rows from two input arrays,"select id1, id2 from t, (select rownum rn1, a1.* from table(:1) a1) a1, (select rownum rn2, a2.* from table(:2) t2) t2 where (id1, id2) in ((a1.column_value, a2.column_value)) and rn1 = rn2
"
39498,Rewrite self join to JPQL,"SELECT s.id, s.url, s.siteType, MAX(s.lastUpdateDate) as maxLastUpdateDate 
FROM Site s 
GROUP BY s.siteType 
HAVING (maxLastUpdateDate < ""2011-02-27 16:57:53"" OR maxLastUpdateDate IS NULL)
"
23919,UPPER() and LOWER() not required?,"SELECT * FROM Table WHERE UPPER(part) = 'SOMEPARTNAME' 
"
38451,How to compare date in string with sysdate in Oracle?,"SELECT CASE WHEN sysdate > to_date('30-Apr-2015','DD-MON-YYYY') THEN '1' ELSE '0' END
    FROM DUAL
"
28106,Oracle SQL left join with null values copied,"SELECT U.user, T2.dates date, T1.usage, T1.usage/T2.avg_use pct_of_avg  
FROM (SELECT DISTINCT user FROM tbl1) U
CROSS JOIN tbl2 T2
LEFT JOIN tbl1 T1
    ON T2.date = T1.date  AND U.user = T1.user
"
32388,MySQL query does count then display additional data,"SELECT Office, lastName, Phone FROM Active ORDER BY Office
"
4719,SQL - user-management --> export/import users via script,"SELECT 'drop user ' || username || ';' 
FROM   dba_users u
where  not exists (select null 
                   from   dba_objects o 
                   where  o.owner = u.username);
"
35495,Replace string in rows,"update dbo.Posts
set Content = REPLACE(Content,'stage.mydomain.com','blog.mydomain.com')
"
17537,Where value in column containing comma delimited values,"WHERE (',' + RTRIM(MyColumn) + ',') LIKE '%,' + @search + ',%'
"
8796,If select returns nothing then,"SELECT * 
FROM table1 a 
WHERE a.d > COALESCE((SELECT b.d FROM table2 b WHERE a.id = b.id and a.Something = 1), '0')
"
24709,Do we need to specify an alias in view if its definition has a column with unique constraint?,"CREATE VIEW emp_sal (emp_id, last_name, 
      email UNIQUE RELY DISABLE NOVALIDATE,
   CONSTRAINT id_pk PRIMARY KEY (emp_id) RELY DISABLE NOVALIDATE)
   AS SELECT employee_id, last_name, email FROM employees;
"
30654,performance difference in where statement,"... Where ID in (1,2,3)   

... where ID = 1 OR ID = 2 OR ID = 3
"
3055,Combining like minded entries in SQL,"select Item, sum(Quantity) as TotalQuantity
from {tablename}
group by Item;
"
34893,ASP classic db question,"For I=0 to oRS.Fields.Count - 1
   Response.Write(""<td><b>"" & oRS.Fields(I).Name  & ""</b></td>"")
Next
"
760,Getting Sum of an SQL table column until the sum reaches 5000,"WITH cte AS (
  SELECT id, date, SUM(amount) OVER (ORDER BY date,id) totalamount 
  FROM mytable
)
SELECT TOP 1 totalamount, date 
FROM cte 
WHERE totalamount >= 5000 
ORDER BY date, id;
"
6325,Oracle sql null value is not selected,"SELECT * FROM NAME WHERE FIRST IS NULL OR FIRST != '1'
"
32177,SQL Server equivalent of PostgreSQL distinct on (),";WITH CTE AS
(
    SELECT *, ROW_NUMBER() OVER(PARTITION BY a ORDER BY b) Corr
    FROM my_table
)
SELECT *
FROM CTE
WHERE Corr = 1
"
14239,Latest Data based on DateTime or CustMCId,"WITH cteCustomers AS (
    SELECT CustMCId, CustId, MCID, AssignDate,
           ROW_NUMBER() OVER(PARTITION BY CustId ORDER BY AssignDate DESC) AS RowNum
        FROM CustomerMC
)
SELECT CustMCId, CustId, MCID, AssignDate
    FROM cteCustomers
    WHERE RowNum = 1;
"
554,GROUP BY and aggregate sequential numeric values,"WITH MarkedForGrouping AS (
  SELECT
    company,
    profession,
    year,
    year - ROW_NUMBER() OVER (
      PARTITION BY company, profession
      ORDER BY year
    ) AS seqID
  FROM atable
)
SELECT
  company,
  profession,
  array_agg(year) AS years
FROM MarkedForGrouping
GROUP BY
  company,
  profession,
  seqID
"
15034,Remove inner white spaces in text data with SQL,"   WITH CTE(FieldName) AS
    (SELECT 'TB7 TCH' AS FieldName)
    SELECT SUBSTRING(FieldName FROM 1 FOR (POSITION(' ' IN FieldName) - 1)) 
            || SUBSTRING(FieldName FROM (POSITION(' ' IN FieldName) + 1))
    FROM CTE;
"
15233,sql select value with square bracket in Like clause?,"SELECT * 
FROM ABC
WHERE title LIKE N'%\[text] xxxxx%' ESCAPE '\'
"
30905,T SQL - Passing table variables through a stored procedure,"Declare @c_a varchar (10),
        @c_b varchar (10)

Declare cur Cursor For
(
    Select  A, B
    From    YourTable
)

Open cur
While (1 = 1)
Begin
    Fetch Next From cur Into @c_a, @c_b

    If (@@Fetch_Status <> 0) Break

    Execute my_sp @c_a, @c_b
End
Close cur
Deallocate cur
"
7426,How to set (combine) two primary keys in a table ,"ALTER TABLE dbo.YourTableNameHere
ADD CONSTRAINT PK_YourTableNameHere
PRIMARY KEY(Item_Id, Purchase_Id)
"
32071,"Latest date from date, month, year","select * from your_table
order by year, month, `date` desc
limit 1
"
32852,OUTPUT Clause in MySQL,"START TRANSACTION;

SELECT * FROM table WHERE id = 1 FOR UPDATE; -- lock rows
-- Or call this select to insert and lock rows
-- INSERT INTO table_output SELECT * FROM table WHERE id = 1 FOR UPDATE;

-- Make modifications
UPDATE table SET column1 = '111' WHERE id = 1;

COMMIT;
"
23365,Using update with an inner join SQL SERVER 2012,"UPDATE tblA_Add_CustomerID_Column  
SET CustomerID = x.cusomterID
FROM tblX x
WHERE custno = x.CustomerCode
"
6062,"Specifying SELECT, then joining with another table","SELECT * 
FROM Sales
INNER JOIN Customers ON Sales.userId = Customers.userId
WHERE price = 10;
"
35724,SQL What Value Repeat Most,"select MyColumn, count(*) as NumRepeats
from t
group by MyColumn
order by count(*) desc;
"
28382,SQL Coalesce with empty string,"SELECT COALESCE(NULLIF(Other,''),Industry) Ind FROM registration
"
13760,sql query into hibernate query," SELECT u.id, u.orderId, p.productName, u.key2, i.forced_matrix_sponsor_id
 FROM ubercart_reseller_orders u join
      productInfo p
      on p.productId=u.productId join
      ir i
      on u.key2=i.id
 where p.productName like '%OSS HOSTING FEE%' and
       u.createdDate > '2014-02-1' and
 ----------------------^
       forced_matrix_sponsor_id is null
 order by u.key2;
"
38062,"What kind of join, if any, is appropriate here?","select 
S.userName,
S.firstName,
S.lastName,
A.actionDetails,
A.actionDate
from Departments D 
join Staff S on d.departmentID=s.departmentID
join Actions A on s.staffID=A.staffID
WHERE D.departmentID = YourDeparmentID;
"
5487,what is the right way to reduce multiple update statement in oracle,"UPDATE TableA a 
SET a.x = (SELECT b.w FROM TableB b WHERE a.x = b.z)
  , a.x1 = (SELECT b.w FROM TableB b WHERE a.x1 = b.z)
  , a.x2 = (SELECT b.w FROM TableB b WHERE a.x2 = b.z)
  ...
WHERE a.j = 'somevalue';
"
36214,How to get size in bytes of a CLOB column in Oracle?," LENGTHB(TO_CHAR(SUBSTR(<CLOB-Column>,1,4000)))
"
23434,SQL If-Else logic based on value of one table,"select top 1 pt.serialNumber,pt.workOrderNumber,
       isNull(wt.ItemName,pt.ItemName) as NameToReturn
from prodTable pt
left join worktable wt on pt.WorkOrderNumber=wt.workOrderNumber and wt.itemType=1
where pt.serialNumber = <input>
order by p1.itemType
"
75,Summary report with help of SQL,"select 
      Emp,
      sum([T Amt]),
      stuff((select ','+ [Bill Id] from Account a where a.Emp = b.Emp for xml path('')),1,1, '')  bill_ids
from Account b
group by Emp,bill_ids
order by Emp desc;
"
9659,Update temp table number n+1 from another table,"UPDATE tp
SET
    NPlus1 = SQ.max_N + 1
FROM
    @temp_Person TP
INNER JOIN (SELECT Name, MAX(N) AS max_N FROM Person GROUP BY Name) SQ ON
    SQ.Name = TP.Name
"
32917,"Learning ExecuteSQL in FMP12, a few questions","ExecuteSQL (""

SELECT M::MovieName FROM Movies M INNER JOIN Genres G ON
M::GenreId=G::GenreId

WHERE M::Rating =

(SELECT MAX(M2::Rating) FROM Movies M2 WHERE M2::GenreId = M::GenreId)

""; """" ; """")
"
22729,User defined function returning null in sql server,"create function 
IsNameExist(@Name varchar(100)) 
returns int As 
Begin 
Declare @Id int 
Select @Id = ProductId from [Product] where ProductName = @Name 
return @Id 
End 
"
7467,calculate value based on 2 fields in SQL database,"SELECT 
    CAST((CASE
            WHEN tableAValue < tableB.maxRange and tableAValue > tableB.minRange 
              THEN 1
            ELSE 
              0 
          END) AS BIT) 
FROM TableA
  INNER JOIN TableB
    ON TableA.ID = TableB.TableAID
WHERE TableA.ID = @yourID
"
10698,Linq-To-Sql equivalent for this sql query,"var idsToDelete = ids.Split("","").Select(x => Convert.ToInt32(x));

var clientsToDelete = _DB.Clients.Where(x => idsToDelete.Contains(x.Id));

foreach(var client in clientsToDelete)
{
   client.IsDeleted = true;
}

_DB.SubmitChanges();
"
35854,Join Two Tables and filter records in sql,"select r1.room_no,
       r1.Type,
       r1.Date, 
case when r2.Descriprion is null then r1.Descriprion else r2.Descriprion end as description   
from RoomStatus r1 
left join RoomBooked r2 on r1.room_no=r2.room_no
order by r1.room_no;
"
8882,SQL Statement Inner Join + Others...So join within a join?,"SELECT tg.ItemID, tg.Title, tg.Inventory
FROM tblGames tg
LEFT JOIN (
    select ItemID, sum(inventory) as Inventory
    from tblSupplyOrders 
    group by ItemID) tso
ON tg.ItemID=tso.ItemID
where tg.Inventory+coalesce(tso.Inventory,0) < tg.ReorderPoint
"
12418,Postgres Join with LIKE,"select tbl2.name, tbl1.rcode, tbl2.ccode, tbl1.country
from tbl1 
  join tbl2 on substring(tbl1.rcode, 1, 2) = tbl2.ccode
"
18136,How to sum multiple columns with different grouping criteria,"SELECT currency, SUM(total1) AS total FROM
(
SELECT currency_a AS currency, SUM(a_amount)  AS total1 FROM table1
GROUP BY currency_a
UNION ALL
SELECT currency_b, SUM(b_amount) AS total2 FROM table1
GROUP BY currency_b
UNION ALL
SELECT currency_c, SUM(c_amount) AS total2 FROM table1
GROUP BY currency_c
) T
GROUP BY currency
"
30596,How Do I Select the Entire Record When Using MAX() With GROUP BY,"SELECT i1.*
FROM invoice_items i1
LEFT OUTER JOIN invoice_items i2
  ON (i1.invoice_id = i2.invoice_id AND i1.invoice_date < i2.invoice_date)
WHERE i2.invoice_id IS NULL;
"
21751,Create table using rows from another table as columns,"DECLARE @TableNo1 TABLE(Field varchar(128),DataType varchar(128))
DECLARE @s nvarchar(max)='CREATE TABLE dbo.TableNo2('
INSERT INTO @TableNo1
VALUES
('Field1','nvarchar(max)'),
('Field2','int')

SELECT  @s+=T.Field+' '+T.DataType+',' FROM   @TableNo1 T
SET @s=LEFT(@s,LEN(@s)-1)+')'
EXECUTE(@s)
"
27812,How to get recent data and previous data in SQL,"select applicationId,
       sum(case when someId = 8 then Amount else 0 end) as LastMonth,
       sum(case when someId = 10 then Amount else 0 end) as ThisMonth,
       sum(case when someId = 8 then -Amount 
                when someId = 10 then Amount
                else 0
           end) as Diff
from t
group by applicationId;
"
12951,Force identifier case sensitivity in oracle,"employees
EMPLOYEES
""EMPLOYEES""
"
32603,Combine two SQL queries or prevent exclusion of data rows in existing query,"SELECT 
AnalyticsHub_Requests.Id AS reqId, AnalyticsHub_Requests.*,
AnalyticsHub_StatusCodes.ShortDescription AS StatusText,
Users.FullName + ' (' + COALESCE(WorkPhone,'Phone empty') + ')' AS Value, 
Users.Id 
FROM 
AnalyticsHub_StatusCodes 
INNER JOIN 
(Users 
RIGHT JOIN 
AnalyticsHub_Requests ON Users.[Id] = AnalyticsHub_Requests.[AssigneeId])     
ON AnalyticsHub_StatusCodes.[Id] = AnalyticsHub_Requests.[StatusId]
WHERE  
AnalyticsHub_Requests.StatusId = 4 
OR AnalyticsHub_Requests.StatusId = 6;
"
6762,Use table metadata for select statement in SQL Server?,"select table_name 
from information_schema.columns 
where column_name = 'classtypeid'
"
4083,How to kill the currently executing query of a job in sql server 2008r2,"select * from sys.dm_exec_requests
"
3334,SQL Join Syntax with three tables with a left join,"FROM (invoice INNER JOIN ar ON invoice.trans_id = ar.ID) 
      RIGHT JOIN parts ON parts.id = invoice.parts_id
"
22363,Get a list of all functions and procedures in an Oracle database,"SELECT * FROM ALL_OBJECTS WHERE OBJECT_TYPE IN ('FUNCTION','PROCEDURE','PACKAGE')
"
6619,How can I set a column based on a condition in SQL Server?,"UPDATE  i
SET     i.Outstanding = i.Total - @Payments,
    i.Paid = @Payments ,
    i.Closed = CASE WHEN i.Total <= @Payments THEN 1 ELSE 0 END
FROM    Invoice i
JOIN    [Transaction] t ON t.Invoice_Id = i.Id
WHERE   i.Id = @InvoiceId
"
6861,Microsoft SQL Trigger: Will multiple join records pointing to the same record fail to update?,";with insert2 as (
  select id, week, sequence, name,
         row_number() over(partition by id order by week desc, sequence desc) as [descOrd]
  from inserted
)
update p
set p.name = i.name
from product p
  join insert2 i on p.id = i.id and p.week = 0 and p.sequence = 1
where i.descOrd=1
"
39597,Mulitply 2 values from 2 different tables,"SELECT Total_Amount * Exchange_Rate AS Value 
FROM Transactions, Rates 
WHERE Rates.Currency_Name = 'Sek' and Transaction_id = 001
"
36033,Calculate the credit amount the employee,"select (select Sum(money1) from T1 where Job_Id='8') - 
       (select Sum(money2) from T2 where Job_Id='8')
"
20326,Merge Defaut and User Adjusted Data,"WITH recordList
AS
(
    SELECT   YEAR, VALUE,
             ROW_NUMBER() OVER (PARTITION BY  YEAR
                                ORDER BY TYPE DESC) rn
    FROM    tableName
)
SELECT  YEAR, VALUE
FROM    recordList
WHERE   rn = 1
"
26773,Union 1 column and select additional,"Select P.post_Id
    , Max( Case When UR.unread_by Is Not Null Then 1 Else 0 End ) As unread
    , Max( Case When P2.pinned_by Is Not Null Then 1 Else 0 End ) As pinned
From Posts As P
    Left Join Unread As UR
        On UR.post_Id = P.post_Id
    Left Join Pinned As P2
        On P2.post_id = P.post_id
Group By P.post_id
"
7648,Using T-SQL 'Two Digit Year Cutoff' in script,"SELECT value
FROM sys.configurations 
WHERE name = 'two digit year cutoff'
"
4250,"MySQL Query - Trouble with joins, filtering results","$query = ""SELECT Name FROM judges LEFT JOIN $court
       ON ($court.JudgeID = judges.JudgeID)
       LEFT JOIN users
       ON ($court.userid = users.userid) and user.userType='user'
       where Month='$month' and Year='$year' order by Name asc;"";
"
1408,Finding first letter in a varchar2 Oracle sql,"select regexp_replace('259a', '[A-Za-z]') from dual;
select regexp_replace('259a', '[0-9]') from dual;
"
32429,How do a repeat a query for past 30 days without union 30 times?,"SELECT trunc(event_dt), sum(duration)/3600
  FROM IGN_OEE_EVENTS_D 
 where asset_id = 1978 
   and event_type = 1 
   and shift = 2 
   and trunc(event_dt) >= trunc(sysdate)-30
 group by trunc(event_dt)
 order by trunc(event_dt)
"
37234,Query to differentiate between stock and in saleorder,"SELECT
    Lots.Priority,
    COUNT(*) AS TotalLots,
    COUNT(CASE WHEN SalesOrderLine  > 0 THEN 1 ELSE NULL END) AS SalesOrder,
    COUNT(CASE WHEN SalesOrderLine <= 0 THEN 1 ELSE NULL END) AS InStock
FROM
    Lots
    INNER JOIN Priorities ON Priorities.Priority = Lots.Priority
   -- this JOIN doesn't do anything because the Priorities table does not contain any useful data at this point
GROUP BY
    Priority
ORDER BY
    Priority ASC
"
16130,(How) can I retrieve the SQL used to create a view in Oracle?,"create table t1(id number)
/
create view t1_vw as select * from t1
/
alter table t1 add val varchar2(20)
/
alter view t1_vw compile
/
select * from t1_vw
/
"
8869,Read a Sequence value after insert with a trigger?,"insert into your_table (col1, ...) values (:val1, ...)
returning id into :id;
"
14459,Multiple searches within a search result set (stored procedure),"SELECT UserId FROM User
 WHERE UserName LIKE 'cook%'
   AND UserAddress LIKE 'sesam%'
   AND UserCity = 'Hamburg';
"
31423,Oracle: Select using compound key from subquery,"select name,thedate,theaction,prev_action,prev_date from 
 (
 select name,thedate,theaction,
 lag(theaction) over (partition by name order by thedate,theaction) as prev_action,
lag(thedate) over (partition by name order by thedate,theaction) as prev_date
from table1 
order by name,thedate,theaction
)
where theaction = 'action1' and prev_action = 'action2'
;
"
24040,Order of WHERE conditions in SQL query makes difference,"SELECT studentName
FROM Student s INNER JOIN Class c
       ON s.classNo = c.classNo
WHERE  c.className = 'history';
"
39758,SQL - Count Records and insert results into another table,"UPDATE L
SET QtyAdd = i.QTY
FROM List L JOIN 
    (SELECT RefNum, COUNT(Column1) AS QTY 
     FROM DB2.dbo.Table2 
     WHERE Column1 LIKE 'A%'
     GROUP BY RefNum) i ON L.RefNum = i.RefNum JOIN 
    DB3.dbo.Ref r ON l.RefNum = r.RefNum 
"
19770,sql - Update Trigger to populate a ModifyDate field,"CREATE TRIGGER dbo.TR_iu_MyTable__LastUpdated
 on dbo.MyTable
 after insert, update

AS

    SET NOCOUNT on

    UPDATE dbo.MyTable
     set LastUpdated = getdate()
     where MyTableId in (select MyTableId from inserted)
"
5779,Fetch records of single id only not of any other,"SELECT * FROM `table`
WHERE id = 1 AND oid NOT IN (SELECT oid FROM `table` where id != 1)
"
12128,ComboBox Field of a DataGrid binded to an Entity database,"<ComboBox ItemsSource=""{Binding DataContext.Movies, RelativeSource={RelativeSource FindAncestor, AncestorType=DataGrid}"" SelectedItem=""{Binding WhateverPropertyReferencesTheMovieNavigationPropertyInYourEntities}"" DisplayMemberPath=""WhateverPropertyInTheMoviesYouWantToVisualizeInTheComboBox""/>
"
19673,Multiple insert/update statements inside trigger?,"
CREATE TRIGGER testref BEFORE INSERT ON test1
  FOR EACH ROW BEGIN
    INSERT INTO test2 SET a2 = NEW.a1;
    DELETE FROM test3 WHERE a3 = NEW.a1;
    UPDATE test4 SET b4 = b4 + 1 WHERE a4 = NEW.a1;
  END;
"
27970,Writing IF THEN statements in WHERE Clause of SQL,"Select *
From NLog
Where ([Forms]![Search]![Textbox1] <= 0 OR [Forms]![Search]![Textbox1] = Nlog.CoNo);
"
7595,sql - salesmen by territory query - combine multiple statements with WITH clause,"SELECT DISTINCT terr, salm, salesmen
FROM File -- I really hope that's not your file name - it's a reserved word
JOIN (SELECT terr territory, COUNT(DISTINCT salm) salesmen
      FROM File
      GROUP BY terr) Salesmen_Per_Territory
ON territory = terr
"
13986,Inner query to match 'LIKE' results from another table,"select *,
COUNT(*) from surnames join filters 
on SURNAMES.last_name LIKE CONCAT(filters.filter,'%') 
where filters.id > 4215 
group by last_name
"
33960,Preparing Items List Of Sql-Table,"select  name
,       case 
        when sum(amount1 - amount) < 0 then -sum(amount1 - amount) 
        end as amount
,       case 
        when sum(amount1 - amount) >= 0 then sum(amount1 - amount) 
        end as amount1
from    YourTable
group by
       name
"
6202,Selecting from two tables and counting a third,"SELECT questions.question_id,
       questions.username,
       questions.question,
       userlog.user_mail,
       COUNT(answers.answer) as answerCount
  FROM questions
  LEFT JOIN userlog ON questions.username = userlog.username
  LEFT JOIN answers ON answers.question_id = questions.question_id
 WHERE questions.topic_id = '0d3fb89c012b5af12e1e0'
 GROUP BY questions.question_id, questions.username, questions.question, userlog.user_mail
 ORDER BY questions.username, questions.question_id
"
6517,How to delete several values in SQL?,"DELETE FROM my_table WHERE id IN (23, 17, 64) AND year=2012 AND value=16
"
8200,SQL Sum and Count,"SELECT [Date Recorded], VoteID, COUNT(*) [Count]
FROM YourTable
GROUP BY [Date Recorded], VoteID
"
5412,how to get coulmns with DEFAULT value in table using GETDDL in ORACLE,"Select TABLE_NAME, COLUMN_NAME, DATA_DEFAULT
from DBA_TAB_COLUMNS
where DATA_DEFAULT is not null
"
23599,Minus/Sum a table with itself,"select product_id, product_property_id,
       sum(case when type = 1 then amount
                when type = 0 then - amount
                else 0
           end) as new_amount
from likethis
group by product_id, product_property_id;
"
11866,Find Date falls within Range,"select (case when count(*) > 0 then 1 else 0 end) as TrueIs1
from t
where empId = @empId and
      @date between StartDate and EndDate;
"
2608,How to Compare Column to Count in a Query,"SELECT GroupID
    ,GroupCount
    ,COUNT(*) AS A
FROM Table1    
GROUP BY GroupID
    ,GroupCount
HAVING COUNT(*) = GroupCount 
"
17885,SQL query for displaying record with maximum number of non-empty fields,"select  top 1 Record_ID
from    YourTable
order by
        case when isnull(col1,'') <> '' then 1 else 0 end +
        case when isnull(col2,'') <> '' then 1 else 0 end +
        case when isnull(col3,'') <> '' then 1 else 0 end +
        ...
        case when isnull(colN,'') <> '' then 1 else 0 end
"
37436,Filter and Merge inner table data,"select id, 
  max(field1) as field1, 
  max(field2) as field2, 
  max(field3) as field3, 
  max(field4) as field4, 
  max(field5) as field5
from yourtable
group by id;
"
37252,NVL in BETWEEN date AND,"AND (NVL(a.C_DATE, TO_DATE('1900-01-01','yyyy-mm-dd')) 
     BETWEEN TO_DATE (NVL('&C_DATE_FROM', '1900-01-01'), 'yyyy-mm-dd')
         AND TO_DATE (NVL('&C_DATE_TO',   '2099-12-31'), 'yyyy-mm-dd'))
"
11655,magento table that stores relation between cms_block and categories,"select cat.*, cms.* from `catalog_category_entity` as cat
    join `catalog_category_entity_int` as ci on cat.entity_id = ci.`entity_id`
    join `eav_attribute` as att on att.`attribute_id` = ci.`attribute_id`
    join `cms_block` as cms on cms.`block_id` = ci.`value`
    where att.`attribute_code` = 'landing_page'
"
4398,How to return default value from SQL query," SELECT 
    ISNULL(MAX(Name),'John Doe')
 FROM 
    Users 
 WHERE 
    Id = @UserId  
"
31133,Oracle SQL: How do I concatenate results into one column (with delimiters) and also rename the column?,"select column_1||', '||column_2 as ""Concatenated_Result""
     , column_3
from   table
"
11364,How to get unique result in mysql," SELECT name, MAX(marks) marks
 from table
 group by name
"
31602,Load SQL dump in PostgreSQL without the password dependancy,"export PGHOST=localhost             
export PGPORT=5432
export PGDATABASE=postgres
export PGPASSWORD=postgres
export PGUSER=postgres

psql -f file_with_sql_commands.sql
"
22547,Oracle Update Join based on a select,"UPDATE lib.client_address
SET allow_to_trade='N'
WHERE client IN
  (SELECT t.client
  FROM lib.trades t ,
    lib.client_address c
  WHERE t.client       = c.client
  AND c.allow_to_trade = 'Y'
  GROUP BY C.GCD_NUMBER,
    t.client,
    c.shortened_name,
    c.allow_to_trade
  HAVING MAX(trade_date) < '01-may-2012'
  );
"
28740,How do I refactor this SQL query?,"select ""Malaysia"",
    SUM(CASE WHEN activated_at is not null THEN 1 ELSE 0 END) as ""Activated"",
    SUM(CASE WHEN activated_at is null THEN 1 ELSE 0 END as ""Not Activated"",
    count(*) as ""Total""
from users 
where locale=""en"" and  date_format(created_at,'%m')=date_format(now(),'%m');
"
37881,Loop and assign non-unique GUID to sets of values?,"DECLARE @tmp TABLE
(
    Name    varchar(30),
    GUID    uniqueidentifier
)

INSERT @tmp
    SELECT  x.Name, NEWID()
    FROM    (SELECT DISTINCT Name FROM MyTable) x

UPDATE MyTable
    SET GUID = tmp.GUID
    FROM MyTable t
    INNER JOIN @tmp tmp ON t.Name = tmp.Name
"
28627,SELECT with ORs including table joins,"SELECT 
  * 
FROM 
  Books 
  LEFT OUTER JOIN KeywordsLink ON KeywordsLink.BookID = Books.CopyID 
  LEFT OUTER JOIN Keywords ON Keywords.ID = KeywordsLink.KeywordID 
WHERE Books.Title LIKE '%JOEL%' 
      OR Keywords.Name LIKE '%GOOD%'
"
19679,Mysql View of last version of some strings,"create view LastVersion as
    select s.*
    from strings s
    where s.chapter = (select max(chapter)
                       from strings s2
                       where s.String = s2.String
                      )
"
15506,Return rows as columns Microsoft Access SQL query,"TRANSFORM First([Value]) AS FirstOfValue
SELECT [Name]
FROM
    (
        SELECT o.Name, type.Property, type.Value
        FROM t_object as o
               INNER JOIN t_objectproperties as type
                 ON o.Object_ID = type.Object_ID
    )
GROUP BY [Name]
PIVOT [Property] IN ('Location','Size','Special','Cost')
"
3370,How to get current identity number of specific table in sql server compact,"SELECT AUTOINC_SEED 
FROM INFORMATION_SCHEMA.COLUMNS 
where TABLE_NAME='tablename' 
and COLUMN_NAME='columnName'
"
29592,table with multiple foreign keys joining 1 foriegn key in mysql,"SELECT u.displayname AS userName
   , po.displayName AS PrimaryItOwnerUsernName
   , so.displayName AS SecondaryIdOwnerUserName
FROM users AS u
INNER JOIN owners AS po on u.primaryitowner = po.username
INNER JOIN owners AS so ON u.secondaryitowner = so.username
...
WHERE u.UserName = 'Ryan J Morse'
"
26157,SQL Query to get the last set of distinct records with some conditions,"SELECT MAX(id) 
FROM mytable
WHERE status_id != '2' 
    AND expiry < '2012-12-26 19:00:00' 
    AND customer_id NOT IN (SELECT MAX(customer_id) FROM mytable WHERE status_id = '2' GROUP BY customer_id) 
GROUP BY customer_id
"
31958,Retrieving Last Invoice Price in SQL,"with cte as (
   select *, row_number() over (partition by Item order by date desc) as r
   from dbo.YourTable
)
select * from cte where r = 1
"
38214,SQL Count multiple columns,"SELECT clientId, serverId,
max(connectionCount) as ConnectionCount, LastDate
from
(
select clientId, ServerID, 
count(*) as ConnectionCount,
max(LastDate) as LastDate
from Table1
group by clientId, ServerID
  ) t
group by clientId
"
38404,SQL Update - Using Multiple Table Joins,"UPDATE TC
SET Price=(TA.Cost1+TA.Cost2+TA.Cost3) 
FROM TableA TA
INNER JOIN TableB TB ON TA.Code=TB.Code
INNER JOIN TableC TC ON TC.ID=TB.ID
"
20795,Simple query in sql through aggregate function and group by clause,"Select * from
(Select *,rn=row_number()over(partition by name order by date desc) from table) x
Where x.rn = 1;
"
30549,Select percentile rank from table based on score SQL,"select top 1 percentileRank
from tbl
where score <= @score
order by score desc;

select max(percentileRank)
from tbl
where score <= @score;
"
25944,MySQL. Auto-add in another table,"update table2 t2
  join table1 t1 on t2.product_id = t1.id
set t2.price = t1.price_per_unit * t2.quantity_sold;
"
25181,"SQL pull values from ""last month"" when dates have already been declared","select * 
from orders
where to_char(OrderDate,'MM') = to_char(add_months(sysdate,-1),'MM')
"
4638,Select row minimum col for each id,"select t.*
from (select t.*, row_number() over (partition by id order by uds) as seqnum
      from t
     ) t
where seqnum = 1;
"
32623,How to weekly group if you have daily data,"SET DATEFIRST 1

    SELECT CAST(MIN( [DATE]) AS VARCHAR(20))+' TO '+CAST (MAX([DATE]) AS VARCHAR(20)) AS DATE,
           SUM(C1) AS GRU,
           SUM(C2) AS C1
    FROM   YOUR_TABLE
    GROUP BY DATEPART(WEEK,[DATE])
    HAVING COUNT(DISTINCT[DATE])=7

SET DATEFIRST 7
"
14883,SQL statement with several joins,"SELECT * 
FROM `Post` AS `p` 
LEFT JOIN `CategoryBinding` AS `cb` ON p.ID = cb.postID 
LEFT JOIN `Category` AS `c` ON cb.categoryID = c.ID
INNER JOIN `Post` AS `p2` ON p.id = p2.id
WHERE p.id in
(
    SELECT p2.id
    FROM `Post` as `p2`
    LEFT JOIN `CategoryBinding` AS `cb` ON p2.ID = cb.postID 
    LEFT JOIN `Category` AS `c` ON cb.categoryID = c.ID
    WHERE c.id = @SomeCategory
)
"
9755,Concatenate XML variables in SQL Server,"DECLARE @x xml 
DECLARE @strXML varchar(MAX)
SET @x=N'<Employee><Name>Luftwaffe</Name></Employee>'
set @strXML = '<xml version=""1.0"" encoding=""ISO-8859-1""/>' + CONVERT(varchar(MAX),@x)
SELECT @strXML  
"
30862,data in a single record,"select 
Col1, 
Col2, 
Col3, 
Col4, 
Col5,
max(isnull(Col6,0)),
max(isnull(Col7,0)),
max(isnull(Col8,0)),
max(isnull(Col9,0))
from table1
group by Col1, Col2, Col3, Col4, Col5
"
31348,How execute a trigger SQL by condition?,"BEGIN
   IF NEW.SubscrubeToUsersType = 9 THEN
       INSERT INTO logsub (LogTime,LogIdNote,LogType) 
       VALUES (NEW.subscrubetousersTime, NEW.subscrubetousersId,NEW.SubscrubeToUsersType);
    END IF;
END
"
17774,Progress DB: Set Where Value based on current date,"WHERE
    (CURDATE() BETWEEN 1/1/2013 AND 3/1/2013 AND Staff.""Code"" IN (1,2,3)) OR
    (CURDATE() BETWEEN 3/1/2013 AND 5/1/2013 AND Staff.""Code"" IN (2,3,4))
"
6988,Create Manual Link in Oracle Apex,"'f?p=&APP_ID.:41:&SESSION.:SUBMIT:&DEBUG.::P41_FROM_STOCK_ID,P41_TO_STOCK_ID:'||s.from_id||','||s.to_id LINK
"
30189,How to get the occurrence frequency of SQL result?,"select cnt, count(*), min(publisher), max(publisher)
from (select publisher, count(*) as cnt
      from t
      group by publisher
     ) t
group by cnt
order by 1
"
23700,Multivalued key in erd?,"*Table2*

id, date, name

Index1: (id, date, name)

*Table2*

id, date, name, favorite_color

Index2: (id, date, name) references Table2.Index1
"
1654,Select the first row and merge into a data set with Proc Sql,"proc sql;
create table C as
select _A.date, _A.name, b.rate from (
    select date, name, max(b_date) as b_date from (
        select a.*, b.rate, b.date as b_date from a
        left join b
        on a.name = b.name
           and a.date gt b.date)
    group by name, date) _A 
    left join b
    on _A.name=b.name
    and _A.b_Date=b.date;
quit;
"
8338,Selecting Single XML from Multiple XMLs rows in a Table,"SELECT XMLdata AS '*' 
FROM ActivityTable 
FOR XML PATH(''), ROOT('RootNode')
"
2500,Select SQL statement on related tables,"SELECT t2.id, t2.t1_id, t2.data 
FROM T2 t2
WHERE t2.t1_id NOT IN (SELECT DISTINCT id
                       FROM T1)
"
38353,How to write the SQL for the following problem?,"select * from MyTable where col2 in
(
select col2
from MyTable
group by col2
having count(*) > 1
) x
"
21813,adding unique values to existing table in mySql,"Insert into NEW_TABLE
(select   @row := @row + 1 as generateId, col1, col2 
 from ORIGINAL_TABLE, (SELECT @row := 0)row)
"
23342,SQL max condition in double join,"select p.lastname, max(w.numberofpages)
from writes w
inner join person p on p.id = w.author
inner join books b on b.title = w.book
group by p.lastname, p.id
"
29394,Django: form that updates X amount of models,"qs = MyModel.objects.all()
qs.update(my_field=value) 
"
20566,MERGE is not working with Exec SP,"MERGE INTO DeviceCatalog DC
USING (SELECT @UniqueID AS UniqueID) T ON (DC.UniqueID = T.UniqueID)
WHEN MATCHED THEN
    UPDATE  SET col1='somevalue'

WHEN NOT MATCHED THEN
    INSERT INTO  article (UniqueID) VALUES 'somevalue'

WHEN NOT MATCHED BY SOURCE AND UniqueID = @OldUniqueID  THEN
    DELETE; 
"
3734,Is there a better way to apply isnull to all columns than what I'm doing?,"DECLARE @table_def varchar(max)
SET @table_def = 'CREATE VIEW <tname>_NoNull AS SELECT '

SELECT @table_def = REPLACE(@table_def, '<tname>', t.name) + 
    'ISNULL(' + c.name + ', 0) AS ' + c.name + ', '
FROM sys.tables t
    INNER JOIN sys.columns c ON t.object_id = c.object_id
WHERE t.name = <<table name>>

SELECT @table_def
"
30727,Oracle: list of schedules,"SELECT *
  FROM USER_SCHEDULER_SCHEDULES
"
2700,Calculating relay-race times via a recurrence (in dynamic-SQL),"select t.race, t.runner, t.time as starttime,
       coalesce(tnext.time, t.finishtime) as endtime,
       DATEDIFF(sec, t.time, coalesce(tnext.time, t.finishtime)) as Seconds
from t left outer join
     t tnext
     on t.race = tnext.race and
        t.runner = tnext.runner - 1
"
5205,SQL multiple COUNT,"select type,
       sum(case when name like '% Smith' then 1 else 0 end) as SmithCount,
       sum(case when name like '% Anderson' then 1 else 0 end) as AndersonCount
    from mates
    group by type
"
35930,How to Order a SQL Query with grouped rows,"SELECT t2.MinOfPriority, tn.Field2, Nz([tn.Field3],999) AS Priority, 
       tn.Field4, tn.Field5
FROM tn 
INNER JOIN (SELECT Min(Nz(tn.Field3,999)) AS MinOfPriority, tn.Field2
            FROM  tn GROUP BY tn.Field2) AS t2 ON tn.Field2 = t2.Field2
ORDER BY t2.MinOfPriority, tn.Field2, Nz([Field3],999);
"
26118,Two queries returned different result,"ORDER BY CONCAT(category_1, COALESCE(category_2, """"), COALESCE(category_3, """")) DESC, id
"
11288,Get all the entries alphabetically preceding a certain entry (postgres),"select c.*
from clients c
where c.name < (select c2.name from clients c2 where c2.id = 123)
order by c.name;
"
13423,How to update and order by using ms sql,"UPDATE  messages SET status=10 WHERE ID in (SELECT TOP (10) Id FROM Table WHERE status=0 ORDER BY priority DESC);
"
5339,Better way of writing this SQL WHERE Clause," AND ipdp.UserID != ISNULL(dbo.fn_userid(ipdp.ItemID), -1)
"
25245,SQL query using aggregate function,"SELECT Name
FROM Table
GROUP BY Name
HAVING COUNT(1) = COUNT(CASE FlagByList WHEN 'Y' THEN 1 END) --counts all rows with Y as Value
       OR COUNT(1) = COUNT(CASE WHEN FlagByList  IS NULL THEN 1 END);  --counts all rows with NULL as value
"
25073,Safe Codeigniter join query,"$this->db->join('cities as s', 's.id = users.city_id');
$this->db->where('s.state_id', $_GET['state']);
"
25454,convert int values to datetime in sql server,"select dateadd(month,(@YEAR-1900)* 12 + @MONTH - 1,0) + (@DAY-1)
"
7868,Find all INTs BETWEEN multiple ranges,"SELECT EI.StartingBatesNumber
FROM ExportedItems EI WITH (NOLOCK) JOIN
     #tempTable tt
     ON EI.StartingBatesNumber BETWEEN tt.BegAtt AND tt.EndAtt
ORDER BY EI.StartingBatesNumber;
"
10298,display one of two fields in every row,"SELECT ISNULL(nick, name) as result FROM table 
"
1769,Prevent duplicate values in LEFT JOIN,"SELECT p.id, p.person_name, d.department_name, c.phone_number
FROM   person p
LEFT   JOIN (
  SELECT person_id, min(department_name) AS department_name
  FROM   department
  GROUP  BY person_id
  ) d ON d.person_id = p.id
LEFT   JOIN (
  SELECT person_id, min(phone_number) AS phone_number
  FROM   contact
  GROUP  BY person_id
  ) c ON c.person_id = p.id;
"
37287,is there a way to show this SQL query on 1 line?,"SELECT co, [1] as checkDate1, [2] checkDate2, [3] checkDate3, [4] checkDate4, [5] checkDate5 FROM
(
SELECT CC.co, 
ROW_NUMBER() OVER (PARTITION BY CC.co ORDER BY CC.co) AS CheckDateNum, checkDate 
FROM CCalendar CC
    INNER JOIN CInfo CI on CC.co = CI.co 
WHERE checkDate BETWEEN '01/01/2014' AND '01/31/2014' 
    AND CI.endDate IS NULL AND CI.status IN ('LIVE', 'CONVERSION')
) AS T1

PIVOT (MAX(checkDate) for CheckDateNum in ([1],[2],[3],[4],[5])) as checkDate
"
28693,copy a column with identical function to another table," CREATE TABLE Dim_Route(RtID INT Identity(1,1) Primary Key, Itinerary varchar(50) NOT NULL, ) 
 CREATE TABLE Dim_FlightSchedule(FSID INT Identity(1,1) Primary Key, RTID INT, Constraint fk_Route Foreign KEY (RTID) REFERENCES Dim_Route(RtID), )

 insert Dim_Route (Itinerary)
 values 
 ('B'),
 ('C'),
 ('D'),
 ('E'),
 ('F')

insert Dim_FlightSchedule (RTID)
select RTID from Dim_Route
"
37832,SQL procedure select,"SELECT t.id, 
       t.info, 
       Cast (CASE 
               WHEN r.userid IS NOT NULL THEN 1 
               ELSE 0 
             END AS BIT) AS IsRegistered 
FROM   tournaments AS t 
       LEFT JOIN registrations AS r 
              ON t.id = r.tournamentid 
                 AND r.userid = @user 
"
7694,SQL - Removing Duplicate Rows but Keeping Null Rows,"FROM @TableVariable AS List
    LEFT JOIN dbo.Users AS U
        ON List.Id = U.Id
    OUTER APPLY  (
        SELECT top 1 *
        FROM dbo.Addresses AS JA
        WHERE U.Id = JA.User_Id
        order by Modified DESC
    ) AD
    LEFT  JOIN dbo.Countries AS CNT
        ON AD.Country_Id = CNT.Id
    ORDER BY AD.Modified DESC
"
18193,Changing SQL Query on the fly with function using RODBC,"T <- ""-CHIP TRAY""
T
#[1] ""-CHIP TRAY""

paste0(""SELECT partmadeperhour FROM Completions
      WHERE  PartNumber = '"",T,""' AND endtime > '2012-12-31 23:59:00'"")
#""SELECT partmadeperhour FROM Completions\n      WHERE  PartNumber = '-CHIP TRAY' AND endtime > '2012-12-31 23:59:00'""
"
37585,Populating a dataset from 2 tables (effective date logic) _simplified_,"SELECT A.THE_DATE, SUM(B.VALUE) AS VALUE_SUM
FROM A
    INNER JOIN B ON
        B.EFFECTIVE_DT_ST <= A.THE_DATE AND
        B.EFFECTIVE_DT_END >= A.THE_DATE

GROUP BY A.THE_DATE 
"
22127,Get a document in MongoDB without specifying collection,"db.test1.save({});
db.test2.save({});  
db.test3.save({});
db.test4.save({});
db.test5.save({}); 
db.test6.save({});

db.test2.findOne(); // gives: { ""_id"" : ObjectId(""4f62635623809b75e6b8853c"") }

db.getCollectionNames().forEach(function(collName) {
   var doc = db.getCollection(collName).findOne({""_id"" : ObjectId(""4f62635623809b75e6b8853c"")});
   if(doc != null) print(doc._id + "" was found in "" + collName); 
});  
"
18530,How can I do this with MySQL?,"select u.username
     , oA.value A
     , oB.value B
     , oC.value C
  from users u
left
  join objects oA
    on u.id = oA.user_id
   and oA.key = 'A'
left
  join objects oB
    on u.id = oB.user_id
   and oB.key = 'B'
left
  join objects oC
    on u.id = oC.user_id
   and oC.key = 'C'
"
7431,SQL Server - update on-the-fly added column,"SELECT id,
       (CASE WHEN id=1 THEN 200 ELSE 100 END) AS NewCol
...
FROM Table
"
27828,SQL grouping results by first date of the week,"SELECT DATEPART(WK,CAST(a.sale_date AS DATE)), 
max(DATEADD(dd, -(DATEPART(dw, a.sale_date) - 1), a.sale_date)) as WeekStart, sum(1) as Count 
from testdata a
where a.sale_date >= Dateadd(DAY, Datediff(Day, 0, DATEADD(WEEK, -52, current_timestamp)), 0)
group by DATEPART(WK,CAST(a.sale_date AS DATE));
"
8100,Determining which tables have GRANT SELECT to a specific custom role,"USE yourDB;
GO
EXEC sp_table_privileges 
   @table_name = '%';
"
17915,Reorder integer except for value 0 with sql,"SELECT *
FROM myTable
ORDER BY place>0 DESC, place
"
15031,How to concat values which retrieved from database,"SELECT CAST(DATEPART(dd,GETDATE()) as varchar(10))
  +CAST(DATEPART(mm,GETDATE()) as varchar(10))
  +RIGHT(CAST(DATEPART(YY,GETDATE()) as varchar(10)),2)
"
19445,Mysql str_to_date shows null instead of formatted date,"SELECT DATE_FORMAT(dateadded, '%y-%m-%d') 
FROM my_table
"
1499,how to set the value of the column in a select statement in oracle?,"select yourtable.*,
case when gender = 'Male' then 'Mr. ' || name else 'Ms. ' || name end as namePrefix
from yourtable
"
2547,Named variables in SQL using ADODB in vba,"cmd.CommandText = ""DECLARE @DateID integer;"" & _
""SET @DateID = ?DateID;"" & _
""SELECT TOP 10 * FROM dbo.SomeRecords "" & _
""WHERE DateID = @DateID"" 
.....
Set DateID = cmd.CreateParameter(""?DateID"", adInteger, adParamInput)
"
14410,Count total days between current day (SQL),"SELECT DATEDIFF(DAY, GETDATE() , DayConfirm) 
"
26013,How do i find the largest value in a column in postgres sql?,"select name
from tbl
where weight = (select max(weight) from tbl)
"
25999,SQL Multiple rows into one row,"select max(col1) as col1, max(col2) as col2, max(col3) as col3
from t;
"
29857,Is there a way to make NULL behave like 0 (zero) or like an empty string in SQL?,"COALESCE(col, 0)
"
15759,MySQL return set if values don't exist,"SELECT *
FROM TABLE
WHERE ID NOT IN
(SELECT ID FROM TABLE WHERE KEY = 'LATLNG')
"
11294,SQL One to Many Condition Issue,"    Select Product from Orders
Where Product <> 'MacBook Pro'  -- you don't want MacBook Pro in results
and UsersID in
(Select ID from Users
 where country = '1'   --get all Country 1 users that Purchased MacBooks
 and ID in
 (Select B.UsersID
  from Orders B  --- aliased for clarity
  where  Product = 'MacBook Pro'))
"
12089,How can I get the last inserted primary key?,"insert into T
output inserted.pk
values ('new item');
"
15182,Selecting a table and filtering by several values from one column as well as a value from another,"SELECT * FROM Table1 AS T
WHERE T.y IN(1,2)
          AND T.z NOT LIKE '%NA%'
"
39300,How to do a search function with two like parameters in sql,"WHERE  (@Lastname is NULL or customer.lastname LIKE '%' + @Lastname + '%' ) or
       (@Street is NULL or address.street LIKE '%' + @Street + '%' ) 
"
25265,Updating table based on zip code table,"UPDATE A
SET A.City = B.City
FROM Table2 AS A
INNER JOIN Table1 B
ON A.PostalCode = B.PostalCode
WHERE A.City IS NULL --Or Some Other Criteria
"
5356,How to get the last reading for each day,"WITH
  sequenced AS
(
  SELECT
    ROW_NUMBER() OVER (PARTITION BY sensor_id, Date_Reading ORDER BY DateTimeStamp DESC) AS daily_sequence_id,
    *
  FROM
    dbo.NewLogTable
)
SELECT
  *
FROM
  sequenced
WHERE
  sensor_id = '12345'
  AND Date_Reading BETWEEN '2012-08-01' AND '2012-08-31'
  AND daily_sequence_id = 1
"
7865,Count (*) not working with where clause,"select count (p_id) as mycustomer from person where date_active is null;
"
15315,Oracle Db Group By Two Columns,"SELECT DISTINCT u.* FROM USERS u INNER JOIN WORK w 
ON (u.id = w.bossid1 OR u.id = w.bossid2)
"
22191,passing combobox value into sql query MS ACCESS,"  [Forms]![Enter Data]![comboCup]
  [Forms]![Enter Data]![comboCup].Value
"
10654,How do I delete record through a Join,"DELETE a.*
FROM Aliases_Table a
WHERE a.Aliase_ID IN ( 
                       SELECT
                       c.Aliase_ID 
                       FROM CI_Aliases c
                       WHERE c.CI_Ref = 3
                      )
"
36047,Listing duplicated records using T SQL,"SELECT DISTINCT t1.* 
FROM Table AS t1 
    INNER JOIN Table AS t2
    ON t1.firstname = t2.firstname 
       AND t1.lastname = t2.lastname
       AND t1.id <> t2.id
"
34934,Slow SQL query when grouping by two columns with self join,"SELECT id1, id2, sum(count), sum(sum) 
FROM (SELECT rt1.product_id as id1, rt2.product_id as id2, 1 as count, rt1.rate - rt2.rate as sum 
        FROM rating as rt1 
        JOIN rating as rt2 ON rt1.user_id = rt2.user_id AND rt1.product_id != rt2.product_id) as temptab
GROUP BY id1, id2
"
22601,Make only one row action to insert and other update?,"WITH toUpdate AS
(
    SELECT Id, Action,
        rn = row_number() over (partition by t.id order by ID, Action)
    FROM MyDbTable t
    WHERE ACTION = 'Insert'
)
UPDATE d
SET ACTION = 'Update'
FROM toUpdate d
WHERE RN > 1;
"
37213,Mysql `using` syntax for multiple tables and one joining column,"
SELECT * FROM a
NATURAL JOIN b
NATURAL JOIN c;
"
432,SQL inline if statement type question,"SELECT Col1, Col2, 
    CASE WHEN Col1='AAA' THEN Col2 WHEN Col1='BBB' THEN Col2*2 ELSE NULL END AS Col3
FROM ...
"
29715,How do you Swap details in columns from one ID to another ID?,"update PersonOrganization
    set PersonId = (case when PersonId = 2 then 6 else 2 end)
    where (PersonId in (2, 6);
"
6181,How to use a LIKE statement inside an IF statement?,"declare @name varchar(45)

set @name = 'johnson'

IF( @name LIKE '%John%' )
BEGIN
    print 'like'
END
ELSE
BEGIN
    print 'dislike'
END
"
33508,Group by Month displaying duplicate months in SQL,"select 
    DISTINCT  tranl.Division, 
    DATENAME(month,tranl.trandate) as 'Month',
     COUNT(tranl.qty) as TRANSACTIONS,
     SUM(tranl.qty) as UNITS
    from translog (nolock) tranl 
    where tranl.location = 'stage' 
   and end_tran_date >= '2013-04-01 00:00:00.000' 
   GROUP BY DATENAME(month,tranl.trandate), tranl.Division
   ORDER BY  tranl.Division
"
9465,Date returned as Day of week Number 1-7,"weekday(date)
"
37541,Generating view and stored procedure scripts,"SELECT name, object_definition(object_id) AS script
FROM sys.objects
WHERE type_desc IN ('SQL_SCALAR_FUNCTION',
    'SQL_STORED_PROCEDURE',
    'SQL_TABLE_VALUED_FUNCTION',
    'SQL_TRIGGER',
    'VIEW')
"
9446,"SQL insert statement with ""NOT EXIST"" based on second column","INSERT INTO SL_PROD (NUMBER, DEPTCODE, DISP_SEQ, LU_BY, LU_ON)
SELECT ST_EXTRA.NUMBER, '725', '1', 'IN', getdate()
FROM ST_EXTRA
INNER JOIN STOCK ON STOCK.NUMBER = ST_EXTRA.NUMBER
WHERE UNITS > 0 
AND datename(m,colEMAILDATE) = datename(m, DATEADD(m, -1, getdate()))
AND NOT EXISTS (select 1 from sl_prod 
                where number = st_extra.number
                and deptcode = '725')
"
4566,SQL query to pivot columns,"SELECT st_index,
       MAX(case when subject='Maths' then marks end) as Maths,
       MAX(case when subject='Science' then marks end) as Science
FROM tbl_marks 
where term=1
group by st_index
"
39717,How to set the 'where' clause on a field with comma-seperated values?,"SELECT  *
FROM    tableName
WHERE   FIND_IN_SET('value3', 'comma separated value here') > 0
"
23027,"In T-SQL / SQL Server 2000, referencing a particular row of a result set","DECLARE @id int
DECLARE c cursor for select id from #temptable
begin
  open c
    fetch next from c into @id
    WHILE (@@FETCH_STATUS = 0)
    BEGIN
      --Do stuff here
      fetch next from c into @id
    END
  close c
  deallocate c
end
"
28539,Search for values apart from the letter case - ORACLE,"SELECT company_name 
FROM   companies 
WHERE  UPPER(companies) IN ('ABC', 'DEF', 'BDE', 'MNO'); 
"
510,two tables and trying to access info from another table,"SELECT u.firstName, u.lastName, t.*
FROM users u INNER JOIN tickets t
    ON u.id = t.user
WHERE u.firstName = ???
  AND u.lastName = ???
"
8284,how to remove certain amount of decimals in sql server,"SELECT ROUND(SUM(8.9177 + 7.1950 + 5.1246),1) AS total 
FROM table1
"
13043,For storing people in MySQL (or any DB) - multiple tables or just one?,"create person_type (
   person_id int unsigned,
   person_type_id int unsigned,
   date_started datetime,
   date_ended datetime,
   [ ... ]
)
"
8893,"SQl query, subquery formatting issue","select
  date
  ,sum(case pTypeCode when 'C' then 1 else null end) count_c
  ,sum(case pTypeCode when 'P' then 1 else null end) count_p
  ,sum(case pTypeCode when 'EB' then 1 else null end) count_eb
  ,sum(amt) sum_amt
from
  CommisionEntry
where date >=
  dateadd(day, 1, eomonth(GetDate(), -1))
    and date <= eomonth(GetDate())
group by
  date
"
23864,Not ordering all column values,"SELECT qm.sipara, 
       Prayed = COUNT(qp.Sipara) 
FROM QuranMaster qm LEFT JOIN 
     QuranPrayed qp ON (qp.sipara = qm.sipara AND qp.TimeStamp >= '2013-10-27 19:59:00.000' AND qp.TimeStamp <= '2013-10-28 20:00:00.000')
GROUP BY qm.sipara,qm.OrderID 
ORDER BY qm.OrderID
"
4303,GROUP BY with '+' expression,"  A  |  B  | A+B
-----+-----+-----
  1  |  0  |  1
  2  | NULL| NULL
  3  |  2  |  5
  1  | NULL| NULL
 NULL|  2  | NULL
"
25169,Subtracting from COALESCE,"SELECT COALESCE(field1, 0) AS field1, COALESCE(field2, 0) AS field2,
       COALESCE(field3, 0) - coalesce(field1, 0) - coalesce(field2, 0) AS field
FROM ...
"
27587,SQL: Get parent if and only if children have a certain property,"SELECT id 
FROM asset A 
INNER JOIN resource R ON A.id = R.asset_id 
WHERE NOT EXISTS (
     /* Only return results if the asset has resources of all status = '1'  */
     SELECT 1 
     FROM Resources R2
     WHERE A.asset_id = R2.asset_id
     AND R2.status <> '1'
)
"
10498,SELECT not working when using != in WHERE clause (using GROUP BY and HAVING COUNT),"SELECT tab1ID
FROM table2
GROUP BY tab1ID
HAVING sum(propertyID = 6) > 0
AND sum(propertyID = 3) = 0 
"
15435,Re-Assign SIP extension to other user,"Update User set SPI = null where UserID = 2
Update User set SPI = 1094 where UserID = 1
"
10699,Oracle equivalent of PostgreSQL's sub-select to array?,"select c.name, cursor(select order_id from ORDER o where o.customer_id = c.id)
from CUSTOMER c;
"
7495,Oracle replacing text between first and last spaces,"select regexp_replace(column_value,' .* ', 
          ' '||rpad('*',length(regexp_substr(column_value,' .* '))-2,'*')||' ')
from table(sys.dbms_debug_vc2coll(
       'Duke of north','Prince of Wales','Baltic','what if two spaces'));

Duke ** north
Prince ** Wales
Baltic
what ****** spaces
"
13496,MySQL query to Count Number of Users in Age Group,"SELECT Age,COUNT(user_id) AS ""Number of Users""

FROM
(
    SELECT userid,
           YEAR(CURDATE()) - 
           YEAR(STR_TO_DATE(birth_date, '%m/%d/%Y')) - 
           (RIGHT(CURDATE(), 5) < RIGHT(STR_TO_DATE(birth_date, '%m/%d/%Y'), 5)) 
             AS Age
    FROM user
) as Z 
GROUP BY Age
"
38361,MySQL select row and join to multiple records,"SELECT user_id,name,GROUP_CONCAT(value SEPARATOR ',')as field FROM users u JOIN fields f 
ON u.user_id=f.unser_id GROUP BY user_id
"
11493,Transfer data from table into XML object table,"INSERT INTO XMLTABLE
SELECT
    XMLELEMENT(
        ""column2"",
        XMLELEMENT(""column1"", COLUMN1), XMLELEMENT(""column2"", COLUMN2), XMLELEMENT(""column3"", COLUMN3)
    )
FROM
    thisTable;
"
23256,SQL COUNT get zero,"SELECT c.classId, COUNT(s.classId)
FROM classroom c LEFT JOIN
     student s
     ON c.classid = s.classid
GROUP BY c.classId;
"
12777,Difference between two tables with same primary key but different 2nd column,"INSERT INTO [tmp].[dbo].[Mat] 
SELECT v2m.* 
FROM [v2].[dbo].[Mat] v2m
JOIN [v1].[dbo].[cMat_Mat] v1m on v1m.myid = v2m.myid and v1m.[cMat_Mat] <> v2m.[cMat_Mat]
"
35856,Group_concat in old MySQL version,"SELECT @prev_item_id := NULL;

SELECT  MAX(@keyword_ids := IF(@prev_item_id = item_id, CONCAT_WS(',',     
    @keyword_ids, keyword_ids), keyword_ids)), 
         @prev_item_id := item_id
FROM mytable
GROUP BY item_id;
"
30410,SQL Query for : rows linked by one joint table link to another joint table,"SELECT s.* 
FROM students s
INNER JOIN joint_table_A a ON s.sid = a.sid
INNER JOIN joint_table_B b ON s.sid = b.sid
WHERE a.hid = 3
  AND b.uid = 1
"
26924,How do I use the SQL COUNT() function properly in this context?,"SELECT COUNT(DISTINCT `users`.`id`)
FROM `users`
INNER JOIN `products`
ON `users`.`id` = `products`.`creator_id`
"
9550,Grouping date of births in 2 month periods,"select
case 
when t.dob between date_sub(now(), interval 25 month) and date_sub(now(), interval 23 month) then 'between -25 and -23 month'
when t.dob between date_sub(now(), interval 22 month) and date_sub(now(), interval 20 month) then 'between -22 and -20 month'
when t.dob between date_sub(now(), interval 19 month) and date_sub(now(), interval 17 month) then 'between -19 and -17 month'
when t.dob between date_sub(now(), interval 16 month) and date_sub(now(), interval 14 month) then 'between -16 and -14 month'
end as my_ranges,
count(*)
from
t
group by my_ranges
"
30085,How to query Oracle tables using a subquery,"SELECT gm.managerID ""senior gardener""
       , mgr.gardenername
       , gar.gardenername ""Manages""
FROM MA_gardenermanager gm
     , MA_gardeners mgr
     , MA_gardeners gar
where mgr.gardenerID = gm.managerID 
and gar.gardenerID = gm.gardenerID
order by gm.managerID
       , gm.gardenerID
"
9179,Number of rows in which two or more specified values appear,"SELECT COUNT(*) FROM your_table
WHERE 1 IN (n1,n2,n3,n4,n5) AND 26 IN (n1,n2,n3,n4,n5)
"
26116,SQL server select distinct rows using most recent value only,"select t1.* from (select ForeignKeyId,AttributeName, max(Created) AS MaxCreated
from  YourTable
group by ForeignKeyId,AttributeName) t2
join YourTable t1 on t2.ForeignKeyId = t1.ForeignKeyId
and t2.AttributeName = t1.AttributeName
and t2.MaxCreated = t1.Created
"
33669,Count how many columns match conditions,"ORDER BY (CASE WHEN [Column1] LIKE '%q%' THEN 1 ELSE 0 END +
          CASE WHEN [Column2] LIKE '%q%' THEN 1 ELSE 0 END +
          CASE WHEN [Column3] LIKE '%q%' THEN 1 ELSE 0 END) DESC
"
14647,Order by on length of the string and then by single alphabet desc in pl sql,"SELECT column_name
FROM (select t.*,
             max(length(column_name)) over (partition by substr(column_name, 1, 1)) as fclen
      from table_name t
     ) t
ORDER BY LENGTH(column_name) desc,
         (case when fclen = 1 then 1 else 0 end) desc,
         column_name asc;
"
146,SQL server - groupping by correctly in a join,"SELECT t1.* FROM table1 t1
UNION ALL
SELECT t2.* FROM table2 t2
"
15499,PHPUnit - Asserting that a query return the good data from a database,"/**
 * @param PHPUnit_Extensions_Database_DataSet_IDataSet $expected_data_fixture
 * @param string|array $tables
 */
protected function assertDataFixturesEqual($expected_data_fixture, $tables){
    if(!is_array($tables)){
        $tables = array($tables);
    }
    PHPUnit_Extensions_Database_TestCase::assertDataSetsEqual($expected_data_fixture, $this->DbTester->getConnection()->createDataSet($tables));
}
"
12255,Find how many times it took to achieve a particular outcome in SQL Table,"select cid,
       min(case when Outcome = 'Sale' then seqnum end) - 1 as AttemptsBeforeSale
from (select t.*,
             row_number() over (partition by cid order by date) as seqnum
      from t
     ) t
group by cid;
"
1187,SQL Union/Join Query,"SELECT USER, Manager, Amount FROM employees CONNECT BY PRIOR USER = Manager;
"
33334,should I have 2 identical tables,"select a.*
from customer_addresses ca join
     address a 
     on ca.address_id = a.address_id
where ca.user_id = 1 and ca.address_type = 'Billing';
"
14387,How do I append / merge additional XML into an existing XML field in SQL Server 2005,"update yourTable
set (your XML column).modify('insert <processingData id=""guid"" someAttrib=""x"" /> as last into /someData[1]')
where .......
"
21409,Hashing string in Oracle,"SQL> select DBMS_CRYPTO.hash(utl_raw.cast_to_raw('Foo'), 3) FROM dual;

DBMS_CRYPTO.HASH(UTL_RAW.CAST_TO_RAW('FOO'),3)
--------------------------------------------------------------------------------
201A6B3053CC1422D2C3670B62616221D2290929
"
24789,Order table based on specific column count,"select p.project_name,
       (select count(*) from projects pr where pr.remix_of = p.id) as remixes
from projects p 
order by remixes desc;
"
9075,Amalgamate 2 select statements into 1,"begin
  select * into row_item where <very long operation>;
exception
  when too_many_rows then
    dbms_output.put_line('failure');
end;
"
23525,retrieving the data from firebase database and manipulate it in swift,"let title = snapshot.value.objectForKey(""title"")
let detail = snapshot.value.objectForKey(""detail"")

print(""Title : \(title), Detail : \(detail)"")
"
1719,"min and max value for a row, not column","SELECT GREATEST(`value1`, `value2`, `value3`, `value4`, `value5`) as `highest`
FROM `tablename` WHERE .....
"
35987,Select middle rows in sql,"dataContext.GetTable()
    .Skip(50000)
    .Take(10)
    .ToList();
"
15718,SQL SELF JOIN TO CONCATENATE COLUMNS,"SELECT ServiceEntryID, PartDescription = 
    STUFF((SELECT ' | ' + CAST(b.ID AS NVARCHAR) + ' ~ ' + PartDescription
           FROM Part b
            INNER JOIN ServiceEntryPart c
                ON c.PartId = b.ID
           WHERE c.ServiceEntryID = a.ServiceEntryID
           FOR XML PATH('')), 1, 3, '')
FROM ServiceEntryPart a
GROUP BY ServiceEntryID
"
36714,Joining multiple columns to one column,"SELECT A.fkUserIdOpenedBag, B.UserName As OpenedName, A.fkUserIdClosedBag, C.UserName AS ClosedName FROM TableA AS A
INNER JOIN TableB AS B ON A.fkUserIdOpenedBag = B.fkUserId
INNER JOIN TableB AS C ON A.fkUserIdClosedBag = C.fkUserId
"
3556,How to get matching pairs of columns in SQL,"SELECT *
  FROM [MyTable]
 WHERE (ColA = 'a1' AND ColB = 'b1')
    OR (ColA = 'a3' AND ColB = 'b3')
"
20321,selecting top record in ORACLE join statement between subqueries,"select  m.object, m.operation, m.time, 
  max(p.object) keep (dense_rank first order by p.time) cause,
  max(p.time) keep (dense_rank first order by p.time) cause_time
from a m
join a p on (p.time > m.time)
where m.operation = 'Move'
and p.operation = 'Pickup'
group by m.object, m.operation, m.time;
"
3977,Sql select query set html tags using for xml path,"select replace(replace(stuff(( select ','+'<span>'+@val1+'<span>'+@val2+'</span></span>'       
              for xml path('')),1,1,''), '&lt;','<'),'&gt;','>') as col1
"
14324,how to make postgresql result unique,"select
    md5(astext(way)) as md5,
    min(osm_id) osm_id,
    min(name) name,
    min(highway) highway,
    min(way) way
from planet_osm_roads
where highway is not null
group by 1
having count(osm_id) > 1
"
1442,How to insert XML to SQL,"select
  Name = XCol.value('../@Index','varchar(25)'),
  Cat = XCol.value('../@Name','varchar(25)'),
  [Index] = XCol.value('@Index','varchar(25)'),
  Slot = XCol.value('@Slot','varchar(25)')
from
  @input.nodes('/ItemList/Section/Item') AS test(XCol)
"
10047,SQL-SSIS. Find missing numbers in table,"DECLARE @t table(
 FileNumber int
 );

INSERT INTO @t(FileNumber) VALUES(110), (111), (112), (114), (115), (117);

SELECT t1.FileNumber + 1 AS sequance
FROM @t AS t1
LEFT OUTER JOIN @t AS t2 ON t1.FileNumber + 1 = t2.FileNumber
WHERE t2.FileNumber IS NULL
"
30142,"SQL Server 2008 XML input parameter to stored procedure to pass in ""IN"" clause values","SELECT * 
FROM SomeTable 
WHERE TranCode IN (
                  SELECT T.N.value('(./text())[1]', 'int')
                  FROM @ChargeCodesXML.nodes('/chargecode/refnum') AS T(N)
                  )
"
1059,How to convert mySQL code to Oracle SQL,"SELECT  boxid,
        LISTAGG(quantity || ' x ' || name, ',') 
            WITHIN GROUP (ORDER BY boxid) AS items
FROM    tableName
GROUP   BY boxid
"
1450,Using Multiple CASE Statements,"SELECT T.TrxNo, 
      MAX(CASE WHEN D.DocNo = 1 THEN D.DocNo ELSE 0 END) AS Doc1,
      MAX(CASE WHEN D.DocNo = 2 THEN D.DocNo ELSE 0 END) AS Doc2,
      MAX(CASE WHEN D.DocNo = 3 THEN D.DocNo ELSE 0 END) AS Doc3
FROM [dbo].[Transaction] T LEFT OUTER JOIN
     [dbo].[Document] D
     ON D.TrxNo = T.TrxNo
GROUP BY T.TrxNo;
"
27030,Join two sql result,"SELECT first.id, first.name, second.note
FROM first
LEFT JOIN second
ON first.id = second.id
ORDER BY first.id
"
1746,access form checkboxes populate sql in vba,"Private Sub CommandButton1_Click()
  Dim strSQL = ""select * from mytable where 1=1""
  Dim cCont As Control
  For Each cCont In Me.Controls
      If TypeName(cCont) = ""Checkbox"" And cCont.Checked Then
          strSQL = strSQL + "" or year="" + cCont.Text
      End If
  Next cCont
"
22329,Using text in a column of Date/Time type in access,"DateField   DateStatus
---------   ----------
2014-09-21
            n/a
2014-09-23
2014-09-25
            n/e
"
3412,selecting unique random values from different rows,"SELECT first_col,
  MAX(second_col) KEEP (DENSE_RANK FIRST ORDER BY num) as rand_second_col 
  FROM 
(SELECT first_col, second_col,dbms_random.value() as num
  FROM table)  tmp
  GROUP BY first_col
"
36582,PostgreSQL query that deletes all results that have two repeated columns,"DELETE FROM thetable dd
WHERE EXISTS (
    SELECT *
    FROM thetable xx
    WHERE xx.username = dd.username
    AND xx.age = dd.age
    AND xx.id <> dd.id   -- if you want to delete ALL duplicates
    -- AND xx.id < dd.id -- if you want to keep only ONE of the duplicates
    );
"
26662,Show id's that only contain one kind of name,"select id
from your_table
group by id
having count(distinct name) = 1
"
27272,Joining 2 tables in SQL using a common third,"SELECT
  c.CID, 
  c.CName, 
  r.RegionID, 
  r.RegionName
FROM
  Regions r 
  INNER JOIN Branch b ON b.RegionID = r.RegionID
  INNER JOIN Countries c ON c.CID = b.CID;
"
34136,How to get next SQL row when the PRIMARY KEY values are not continuous?,"SELECT TOP 1 s_id
FROM dbo.YourTable
WHERE s_id > 5
ORDER BY s_id 
"
22615,SQL - Ordering by pairs of rows,"SELECT t.Timestamp, t.Views,
  IF(t.Timestamp % 2, t.Views + tPair.Views, NULL) As Sum
FROM tableName t JOIN tableName tPair
  ON IF(t.Timestamp % 2, t.Timestamp + 1, t.Timestamp - 1)  = tPair.Timestamp
ORDER BY t.Views + tPair.Views, t.Timestamp
"
7054,how to find SP Reference,"SELECT OBJECT_NAME(m.object_id), m.*
  FROM SYS.SQL_MODULES m
 WHERE m.definition LIKE N'%my_sp_name%'
"
20498,SQL Query - join help (Getting lots of results),"SELECT student_id, student_fname, student_lname, company.company_id, company_name, industry
FROM  `student` 
INNER JOIN company ON student.company_id=company.company_id
ORDER BY industry
"
37933,How to set a filter for an estimated maximum price,avg(price) + 3*stddev(price)
16528,Can you union without overriding in mysql?,"SELECT Name, 'Person' FROM tablea
UNION
SELECT Workplace, 'Workplace' FROM tableb
"
39730,How to design a complex questionnarie database,"[Table]
Ranked_Answers

question_number = 1
answer_rank = 1
answer_wording = ""Love""

question_number = 1
answer_rank = 2
answer_wording = ""Like""

question_number = 1
answer_rank = 3
answer_wording = ""Indifferent""

question_number = 1
answer_rank = 4
answer_wording = ""Dislike""

question_number = 1
answer_rank = 5
answer_wording = ""Hate""
"
11382,Classic ASP - display records from databse in the table Week-wise or month-wise,"select
emp_number,
datepart(year, order_date),
datepart(month, order_date),
datepart(wk, order_date),
sum(grand_total)
from order_details
group by
emp_number,
datepart(year, order_date),
datepart(month, order_date),
datepart(wk, order_date)
order by 1, 2, 3, 4
"
38485,Create temporary table with fixed values,"WITH temp_table AS
(
  SELECT 'Zoom' AS AC UNION
  SELECT 'Inci' UNION
  SELECT 'Fend'
)
SELECT * FROM temp_table
"
12887,Rotate table DB2 SQL,"SELECT new_column_name
    FROM (
    SELECT col1 AS new_column_name
    FROM   table
    UNION
    SELECT col2
    FROM   table
    UNION
    SELECT col3
    FROM   table
) AS new_table
"
19184,Oracle SQL new Column with condition,"select ename as name, sal as salary,
       (case when sal = max(sal) over () then 'max'
             when sal = min(sal) over () then 'min'
        end) as MaxOrMin
from emp;
"
21028,Inserting a new indicator column to tell if a given row maximizes another column in SQL,"Select PRODUCT_ID_1, PRODUCT_ID_2 ,SCORE,
(Case when b.Score=
(Select Max(a.Score) from TableName a where  a.PRODUCT_ID_1=b. PRODUCT_ID_1) 
then 1 else 0 End) as IS_MAX_SCORE_FOR_ID_1 
 from TableName b
"
32664,"Select from the result of a union query, Oracle","SELECT tbl.name
FROM
(
    SELECT name FROM customer
    UNION
    SELECT name FROM vendor
) tbl
"
28900,Database Design Suggestion,"User    Product    Quantity
2       5          1
2       3          3
2       7          1
3       5          2
3       6          2
"
31763,Postgres Array Prefix Matching,"create table users (id serial primary key, tags text[]);

insert into users (tags)
values
  ('{""fun"", ""day""}'),
  ('{""fun"", ""sun""}'),
  ('{""test""}'),
  ('{""fin""}');

select *
from users
where exists (select * from unnest(tags) as arr where arr like 'f%')
"
16628,SQL select rows that have (partially) duplicated data,"SELECT
  ProductId,
  Component
FROM
  Table
GROUP BY
  ProductId,
  Component
HAVING
  COUNT(*) > 1
"
32975,Select unique lines from result table,"select distinct * 
from yourTable
"
13190,Compare 2 column in a same SQL table,"select t.*,
       (case when exists (select 1 from table t2 where t1.B like concat(t2.A, '%'))
             then 'Yes'
             else 'No'
        end) as C
from table t;
"
6636,sql date difference,"select to_char(DATE '2000-01-01' + (FRM_TIME-HOURS_IN),'HH24:MI') FROM Time_Test
"
17972,mysql: mysql locate everything left of,"UPDATE mytable
SET url = SUBSTRING_INDEX(url, '?', 1)
"
27602,SQL/sqlite query to union tables with matching columns and merged columns,"SELECT 
  ZonesOne.name
  , RatesOne.weight
  , RatesOne.rate as Table1Rate
  , RatesTwo.Rate AS Table2Rate

FROM ZonesOne, RatesOne, RatesTwo 

WHERE 
  RatesOne.zone = ZonesOne.zone
  AND RatesOne.Weight = RatesTwo.weight

UNION ALL

SELECT 
  ZonesTwo.name
  , RatesOne.weight
  , RatesOne.rate as Table1Rate
  , RatesTwo.Rate AS Table2Rate

FROM ZonesTwo, RatesOne, RatesTwo     

WHERE 
  RatesOne.zone = ZonesTwo.zone
  AND RatesOne.Weight = RatesTwo.weight
"
2527,Show null counts with a condition of <= 2,"select disease.name, count(diagnosed.diseaseid) as timesdiagnosed
from disease
left join diagnosed on disease.diseaseid = diagnosed.diseaseid
group by disease.name
having count(diagnosed.diseaseid) <= 2
order by disease.name
"
20494,Selecting data from three tables,"SELECT films.movie_title, films.rating, films.actor, reviewed.review, users.name
  FROM films
  LEFT JOIN reviewed ON films.movie_id=reviewed.movie_id
  LEFT JOIN users ON films.user_id=users.user_id
"
4431,Multiple NOT distinct,"Select B, C
From Table
Where B In
    (Select B From Table
     Group By B
     Having Count(*) > 1)
"
32495,rownum issue in oracle query,"SELECT * FROM (
  Select distinct a.id
  from  table1 a, table b
  where  ( a.id= b.id or a.id = b.secondid )
) WHERE ROWNUM < 200;
"
38755,I want to put db tables in same database. how? in ios by sqlite3,"$ sqlite3 A.sqlite3
sqlite> ATTACH 'B.sqlite3' AS dbB;
sqlite> SELECT a.*,dbB.b.* FROM a,dbB.b WHERE (a.id = dbB.b.id);
"
33405,SQL insert row with one change,"INSERT INTO Table1 (text)
SELECT text 
FROM Table1
WHERE id = 1
"
39902,right to left string in crystal report,"  SELECT N'Your Text'
"
34524,SQL Server 2005: Order with NULL values at the end,"select *
from tableName
order by case when ordernum is null then 1 else 0 end, ordernum
"
35741,Get consecutive numbers Range from SQL Server Table,"SELECT BookNo, ISNULL(LEAD(prev) OVER (ORDER BY BookNo) , (SELECT MAX(BookNo) FROM yourTable)) As toCon
FROM
    (
    SELECT *, LAG(BookNo) OVER (ORDER BY BookNo) prev, BookNo - LAG(BookNo) OVER (ORDER BY BookNo) diff
    FROM yourTable) dt
WHERE 
    (ISNULL(diff, 0) <> 1);
"
36163,"selecting max date in range, excluding multiple other date ranges","SELECT TOP 1 tDate.SeqDate
FROM dbo.fnSeqDates('6/1/2012', '6/30/2012') tDate
    LEFT JOIN bfShow tShow
        ON tDate.SeqDate BETWEEN tShow.DateStart AND tShow.DateEnd
WHERE tShow.ShowID IS NULL -- no matches found
ORDER BY tDate.SeqDate DESC -- to pull the most recent date
"
33744,how to combine results from 3 tables into one?,"select name,
       value
  from A 
 where value = 7

 union all

select name,
       value
  from B 
 where value = 7

 union all

select name,
       value
  from C 
 where value = 7
"
28786,How do I query one field from multiple search boxes that might be blank,"SELECT c.*
FROM dbo_Contact AS c
WHERE
   c.Expertise Like '*' & Nz(Forms!Data_Qry_Test_Page!Expertise1, 'BOGUS') & '*' 
OR c.Expertise Like '*' & Nz(Forms!Data_Qry_Test_Page!Expertise2, 'BOGUS') & '*' 
OR c.Expertise Like '*' & Nz(Forms!Data_Qry_Test_Page!Expertise3, 'BOGUS') & '*' 
OR c.Expertise Like '*' & Nz(Forms!Data_Qry_Test_Page!Expertise4, 'BOGUS') & '*'
"
4755,Convert this Query to Entity Framework LINQ,"var db = GetDbContextSomehow();
var query = from ua in db.UserActivities
            join lh in db.LoginHistories on ua.iLoginHistoryId equals lh.iLoginHistoryId
            where ua.iUserId == 15
            select ua;
"
36575,What is Sql query to know data base already exists or not in mysql,"CREATE DATABASE IF NOT EXISTS db_name
"
5259,Who triggered my trigger?,"GETVARIABLE(SYSIBM.SYSPLAN);
"
12995,Joining child results into parent (one to many query),"select ;
      P.Name as ParentName ;
      C.* ;
   from ;
      Parent P ;
         JOIN Child C ;
            on P.ID = C.ParentID ;
   order by ;
      P.ParentName, ;
      C.Name ;
   into ;
      cursor C_YourResultSet
"
10463,How to insert empty_clob() from java to Oracle,"INSERT INTO MY_TABLE VALUES(1,'Abraham',empty_clob());
"
29552,Weird SQL Group By query?,"select code, amount, client, type
from (select *, row_number() over (partition by code order by amount) as rowrank 
      from table
     ) sub
where rowrank = 1
"
18240,MSSQL: Only last entry in GROUP BY (with id),"SELECT t.*
FROM
(
    SELECT *, ROW_NUMBER() OVER
              (
                  PARTITION BY [business_key]
                  ORDER BY [date] DESC
              ) AS [RowNum]
    FROM yourTable
) AS t
WHERE t.[RowNum] = 1
"
24295,Query for finding the tuple with other corresponding elements of value x,"SELECT n1, n2, n3
FROM data
WHERE n4 = 0

EXCEPT

SELECT n1, n2, n3
FROM data
WHERE n4 <> 0
"
29817,SQL query to (group by ) by condition of column,"SELECT
    SUM(CASE WHEN Age >= 0 AND Age <= 18 THEN 1 ELSE 0 END) AS [0-18],
    SUM(CASE WHEN Age >= 19 AND Age <= 25 THEN 1 ELSE 0 END) AS [19-25]
FROM
    YourTable
"
11785,recreating whole SQL Server Database with relations,"SELECT 'alter table '+s.name+'.'+t.name+
' alter column '+c.name+' nvarchar('+convert(varchar(11),c.max_length/2)+') go'
FROM    sys.tables as T
inner join sys.schemas as s
on T.[schema_id]=s.[schema_id]
inner join sys.columns as C
on T.[object_id]=C.[object_id]
and c.system_type_id=239--nchar type
"
33029,Generating dates between two dates,"select 
  A.ID, 
  A.START_DATE+delta dt
from 
  t_dates A, 
  (
     select level-1 as delta 
     from dual 
     connect by level-1 <= (
       select max(end_date - start_date) from t_dates
     )
  )
where A.START_DATE+delta <= A.end_date
order by 1, 2
"
7778,update query date function,"select 'update organizations set createddate='''
                                             ^^ here
"
21884,Netezza SQL: Specify an offset in a window frame,"sum(sales) over (partition by household_id
                 order by week_id
                 rows between 34 preceding and 8 preceding
                ) as x34
"
33419,Oracle date difference to get number of years,"select floor(months_between(date '2012-10-10', date '2011-10-10') /12) from dual;

select floor(months_between(date '2012-10-9' , date '2011-10-10') /12) from dual;
"
21462,Firebird SQL: Check if notNULL constraint is set for a specific column?,"select rdb$null_flag
from rdb$relation_fields
where rdb$relation_name = 'MyTable' and rdb$field_name = 'MyField'
"
31744,Is there any overhead with LINQ or the Entity Framework when getting large columns as part of an entity?,"public static IQueryable<ArticleListItem> ToListItems(this IQueryable<Article> articles)
{
 return from a in articles select new ArticleListItem{ Title = a.Title, ...}
}
"
20484,SQL: Get count of rows w.r.t rows of another table,"select c.category, COUNT(n.category) as count
from Table2 c
left join Table1 n on c.category = n.category
group by c.category
"
11341,Selecting attributes as rows from xml datacolumn,"DECLARE @xml as xml
DECLARE @path as varchar(max)
DECLARE @index int, @count int

SET @xml = 
'<Data att1=""test1"" att123=""test123"" />'



SELECT @index = 1

SET @count = @xml.query('count(/Data/@*)').value('.','int')

WHILE @index <= @count 
BEGIN
    SELECT  @xml.value('local-name((/Data/@*[sql:variable(""@index"")])[1])',
            'varchar(max)')
    SET @index = @index + 1
END
"
27559,SQL Select all records where unique composite key,"SELECT
   foo, bar, baz, MIN(gif), MIN(xyz)
FROM
   MyTable
GROUP BY
   foo, bar, baz
"
1970,How to reduce scan count on table with a composite index?,"create index idx_t_id1 on t(id1) include id2
"
2417,How to return NULL in regex,"WITH t AS (SELECT 'first path**second path' text FROM DUAL
           UNION
           SELECT 'third pathfourth path' text FROM DUAL)
SELECT SUBSTR(REGEXP_SUBSTR(t.text,'(\*{2})(.+)'),3)
FROM t
"
26311,How to pass each value of the column from a table to a stored procedure and save the result in a table in SQL-Server,"CREATE TABLE #Results(ID INT, Username SYSNAME, Value INT);
DECLARE @sql AS NVARCHAR(MAX) = N'';
SELECT @sql = @sql + N'
INSERT #Results EXEC spCalculateSomeValuesForThePassedUsername N'''+Username+''';'
FROM <yourTable>;
EXEC(@sql);

Select * from #Results;
"
27620,Return only first item from a related group,"SELECT pk,
       a,
       b,
       c,
       d
  FROM( SELECT pk,
               a,
               b,
               c,
               d,
               row_number() over (partition by a order by pk asc) rnk
          FROM your_table )
 WHERE rnk = 1
"
18582,how do I figure out provisional throughput for AWS DynamoDB table?,"capacity = (X * Y) / Z
"
19350,How to create crosswalk table to match people with different id's?,"SELECT Table1.ID AS Table1ID, Table2.ID AS Table2ID
FROM Table1
INNER JOIN Table2 ON Table1.Name = Table2.Name 
  AND Table1.Address = Table2.Address 
  AND Table1.Zip = Table2.Zip 
  AND Table1.Phone = Table2.Phone
"
8003,SQL Combine Rows into Single Row,"SELECT catid, 
       SUM(CASE WHEN MONTH(expdate) = '1' then expamount END) AS 'january', 
       SUM(CASE WHEN MONTH(expdate) = '2' then expamount END) AS 'february', 
       SUM(CASE WHEN MONTH(expdate) = '4' then expamount END) AS 'april' 
FROM users 
LEFT JOIN (expcategories INNER JOIN expenses ON  catid = catid_fk) 
ON userid=userid_fk WHERE userid='1' 
GROUP BY catid
"
35081,"SQL Select/Join, LIMIT result to 1st entry per element in query list","SELECT
DISTINCT C.PK
,B.PK
,B.tableC_pk
,B.tableA_pk
,A.pk

FROM

tableC C
INNER JOIN
tableB B
ON C.PK = B.tableC_pk
INNER JOIN
tableA A
ON A.PK = B.tableA_pk

INNER JOIN ( SELECT tableC_pk,MAX(PK) AS PK FROM tableB
WHERE tableC_pk IN ('325','322','111')
GROUP BY 1) D
ON C.PK = B.tableC_pk
AND B.PK = D.PK
"
15999,How to show different dates data (from the same table) as columns in Oracle,"select condition, count(case when to_date(xdate) = to_date(sysdate) then 1 end) to_day,
       count(case when to_date(xdate) < to_date(sysdate) then 1 end) last_7_days
  from my_table
 where to_date(xdate) >= to_date(sysdate) - 7
 group by condition
"
29243,count and group by to get totals,"Code:
COUNT(examID) OVER(PARTITION BY examID) AS ExamCount
"
23475,How to do a subquery against multiple phrases with LIKE or REGEXP?,"WHERE hashtag REGEXP (select GROUP_CONCAT(name SEPARATOR '|') from hashtags where hid = 1)
"
38575,Group BY serial number and select latest (last) created date for that record,"SELECT  a.*
FROM    tableName a
        INNER JOIN
        (
            SELECT serial_no, MAX(created) max_date
            FROM    tableName
            GROUP BY serial_no
        ) b ON a.serial_no = b.serial_no AND
                a.created = b.max_date
"
11574,Why is POINT() being stored as ??*??E@z?3M??Q? in mysql table,"SELECT location_id, ST_AsText(coordinates) as coordinates, name
FROM locations
"
13506,SQL group by 1 column but include TOP 1 of other columns,"SELECT BoxNo, MAX(MuffinType) AS  MuffinType, MAX(FrostingType) AS FrostingType
FROM MuffinData 
WHERE FrostingTimeApplied >= CONVERT(date, GETDATE()) 
GROUP BY BoxNo
"
20018,SQLite select query summarizing values,"SELECT name || ' ' || surname AS PlayerName,
       age,
       (SELECT SUM(games_won) FROM team WHERE player1Id = playerId OR player2Id = playerId) AS Total
FROM player
;
"
8619,Can I change isolation level in Oracle?,"set transaction isolation level serializable;  
set transaction isolation level read committed;
"
18611,Calculate average days between events?,"select daybetweenevents as days_diff,
   count(daybetweenevents) as count
from (select t1.user_id,
    t1.event_time,
    datediff(day, t1.event_time, min(t2.event_time)) as daybetweenevents
    from yourtable t1
    inner join yourtable t2
       on t1.user_id = t2.user_id
    and t1.event_time < t2.event_time
    group by t1.user_id, t1.event_time) temp
group by daybetweenevents
"
2285,MySQL - displaying two inner joins in separate columns,"SELECT 
  MatchDate, 
  T1.RealName, 
  T2.RealName 
FROM 
  matches INNER JOIN club T1 ON (matches.HomeTeam = T1.TeamCode)
          INNER JOIN club T2 ON (matches.AwayTeam = T2.TeamCode)
WHERE 
  HST=FTHG OR AST=FTAG
"
30476,Return results of SQL query on one row,"select t.id, o.name, c.name
  from tickets t
  join users o on o.id = t.owner
  join users c on c.id = t.creator
 where t.id = 64;
"
19399,Insert into table from table variable?,"INSERT INTO testTable (Id, Id2)
SELECT ID, ID2 
from @t
"
35045,PL/SQL Trigger - Dynamically reference :NEW or :OLD,"declare
  l_deleting_ind varchar2(1) := case when DELETING then 'Y' end;
begin
  insert into audit_table (col1, col2)
  values
   ( CASE WHEN l_deleting_ind = 'Y' THEN :OLD.col1 ELSE :NEW.col1 END
   , CASE WHEN l_deleting_ind = 'Y' THEN :OLD.col2 ELSE :NEW.col2 END
   );
end;
"
2219,Search text in stored procedure in SQL Server,"...
WHERE m.definition Like '%\[ABD\]%' ESCAPE '\'
"
16445,Bigquery: Select a column with any value not in group by clause,"SELECT url, COUNT(*) AS popularity, GROUP_CONCAT(tweet) 
FROM Table GROUP BY url ORDER BY popularity
"
27362,RowGuide and UNIQUE KEY,"I dont think because GUID are unique. 
"
29479,how to select row from one of three tables based on fourth table that holds order of those entries from all three tables,"SELECT content_type, some_text, id as content_id
FROM (
               SELECT 'content1' as content_type, content1.Id, content1.some_text
     UNION ALL SELECT 'content2', content2.Id, content2.some_text
     UNION ALL SELECT 'content3', content3.Id, content3.some_text) contents
JOIN content_order
  ON content_order.content_type = contents.content_type
 AND content_order.content_Id = contents.Id
ORDER BY content_order.id
"
1170,Sum Union Mysql,"SELECT p, SUM(conta) AS conta 
FROM (
  SELECT s.proprietario_id as p, COUNT(*) as conta
  FROM sn_like_spotted s
  GROUP BY s.proprietario_id  
  UNION ALL
  SELECT s.proprietario_id as p, COUNT(*) as conta2
  FROM sn_like_risposta s
  GROUP BY s.proprietario_id  
) AS baseview
GROUP BY p
ORDER BY conta DESC, p ASC
"
19361,SQL Select excluding some ranges,"SELECT * 
FROM #stock_data sd
LEFT JOIN #exclude_ranges er
    ON sd.symbol=er.symbol and sd.asof BETWEEN er.asof_start AND er.asof_end
WHERE er.symbol IS NULL
"
15591,POSTGRESQL - Finding specific product when,"select *
from orders
where Order1 in (select Order1
                 from orders
                 where Product = 'A01')
"
28082,"How to grant ""grant create session"" privilege?","GRANT CREATE SESSION TO <<username>> WITH ADMIN OPTION
"
4150,Finding maxiumum in a group with a single select,"SELECT parent, 
       MAX(child) KEEP (DENSE_RANK FIRST ORDER BY date DESC) lastchild, 
       MAX(date) lastdate 
  FROM t
 GROUP BY parent
"
14533,Insert Statement in sql server,"insert into table (datecolumn) values ('2012-04-22 13:23:12')
"
29355,Can multiple rows within a window be referenced by an analytic function?,"select a.id, a.value, sum(( b.value - a.value ) * b.value )
from x a, x b
where a.id < b.id
group by a.id, a.value
"
36283,Can you have a partial Identity column in SQL Server?,"SELECT 
   TicketNUmber, 
   ROW_NUMBER() OVER (PARTITION BY TicketNumber ORDER BY TicketDate) AS StepNumber
FROM YourTable
"
18497,How to select unique values in MySQL and order by another field,"SELECT  CASE WHEN Sender = 1 THEN Receiver ELSE Sender END `sender/receiver`,
        MAX(timestamp) time_stamp
FROM    tableName
WHERE   1 IN (Sender, Receiver)
GROUP   BY CASE WHEN Sender = 1 THEN Receiver ELSE Sender END
ORDER   BY time_stamp DESC
"
30701,convert numeric to string with no decimal places,"case IsNull(RevenueAmount, 0)
    when 0 then QUOTENAME('0', '""')
    else QUOTENAME(RevenueAmount, '""')
end
"
20249,update incremental values into an SQL column,"WITH T AS
(
SELECT *,
       ROW_NUMBER() OVER (PARTITION BY Type ORDER BY Version) - 1 AS V
FROM YourTable       
)
UPDATE T 
SET Version = V
"
16502,How do you populate database in firebase?,"var ref = new Firebase(""https://YOUR_FIREBASE_URL.firebaseio.com/"");
ref.update({message:""Hello""});
"
8045,Circular buffer using SQL,"  select id
  from mytable
  order by !(id>3), id
  limit 5
"
17913,SQL Table Rows to Columns - Possible PIVOT?,"SELECT p.*
FROM (
  SELECT dnId, propertyName, propertyValue FROM myTable
) AS t
PIVOT(
  MAX(propertyValue)
  FOR propertyName IN (objectsid, _objectclass, cn, samaccountname, name)
) AS p;
"
33469,Order by dynamically within one query,"SELECT *
FROM values
ORDER BY
    displayOrder
,   CASE WHEN productType <> Z THEN actualValue ELSE 0.0 END
,   CASE WHEN productType <> Z THEN field(key, 'A', 'B', 'C') ELSE 0 END
,   CASE WHEN productType = Z THEN field(key, 'A', 'B', 'C') ELSE 0 END
,   CASE WHEN productType = Z THEN actualValue ELSE 0.0 END
"
29397,Connect saparate query into one,"select header, number1, sender
from ((select header, number1, sender, 1 as priority, NULL as rn
       from header
      ) union all
      (select phonenumber, clientid, NULL, 2, rownum as rn
       from table1
      ) union all
      (select NULL, productname, productid, 2, rownum as rn
       from table2
      )
     ) t
order by priority, rn, header nulls last;
"
12067,JOIN data from two many-to-many SQL structures,"SELECT *,
GROUP_CONCAT(DISTINCT ambienceName SEPARATOR ' ') AS ambiences, 
GROUP_CONCAT(DISTINCT specificName SEPARATOR ' ') AS specifics 
FROM Films AS f 
LEFT OUTER JOIN Films_Ambiences as fa ON f.id = fa.film_id          
LEFT OUTER JOIN Ambiences AS a ON a.id = fa.ambience_id
LEFT OUTER JOIN Films_Specifics as fs ON f.id = fs.film_id          
LEFT OUTER JOIN Specifics AS s ON s.id = fs.specific_id
GROUP BY Title
"
17882,Sql joining query,"SELECT * from menu_item where foodjoint_id IN (
    SELECT foodjoint_id FROM provider_food_joints WHERE foodjoint_name='"".$foodjoint_name.""'"");
"
35894,SQL to find the difference between two rows,"set now = select max(dtg) from table;
set then = select max(dtg) from table where dtg < now;

select locID, old.temp-new.temp from 
      table as old join
      table as new 
      on old.locId = new.locID
where
      old.dtg = then and
      new.dtg = now;
"
32401,SQL Server inner join after Count and GroupBy,"SELECT C.CompanyID, C.CompanyName, COUNT(*)
FROM Products P INNER JOIN Companies C ON P.CompanyId = C.CompanyID
GROUP BY C.CompanyID, C.CompanyName
"
27875,First() INNER JOIN,"select top 1  tblT.Tick, First(tblB.BDF) AS FirstOfBDF
 from FROM tblT INNER JOIN tblB ON tblT.Tick = tblB.Tick
    GROUP BY tblT.Tick
    Order by tblt.Tick ;
"
6151,How can I merge 2 rows in an innodb table,"ALTER TABLE `entities` NOCHECK CONSTRAINT ALL

-- commit query here

ALTER TABLE `entities` CHECK CONSTRAINT ALL
"
5950,SQL code to identify average daily totals,"SELECT
  *
FROM
  yourTable
WHERE
      (contact_start_date >= CAST('20120510' AS DATETIME) OR contact_start_date IS NULL)
  AND (contact_end_date   <= CAST('20120510' AS DATETIME) OR contact_end_date   IS NULL)
"
16929,"How to speed up a ""max()-searching"" SQL Subquery","select i.ItemNr, i.ItemId, x.maxprice
from itemlist i
inner join (
    select MAX(price) as maxprice, ItemId
    from pricelist
    group by ItemId
    ) x on i.ItemId = x.ItemId
where i.ItemNr = 4711
"
16936,How to group quantities in a period of time,"SELECT extract(year from DATE) as yr, extract(month from date) as mon, ITEM, SUM(QUANTITY) 
FROM SALES 
WHERE DATE BETWEEN ""DATE1"" AND ""DATE2""
group by extract(year from DATE), extract(month from date)
order by 1, 2
"
12248,"Any solution for Oracle TNS inefficiencies (many roundtrips, latency) from a Java app?","  ((OracleStatement)stmt).setRowPrefetch (100);
"
32120,Mysql - How to alias a whole table data in a left join,"SELECT CONCAT('[\n ""id"": ',POSTS.ID,', \n ""body"": ""'
  ,BODY,'"",\n  ""date"": ""' ,DATE,'""\n  ""user"": [\n   ""id"": '
  ,USERS.ID,',\n   ""name"": ""', NAME,'"",\n   ""gender"": ""'
  ,gender,'""\n  ]\n ]')
FROM USERS
LEFT JOIN POSTS ON users.id=posts.user_id
"
23082,Stored procedure return the primary key after insert?,"CREATE PROCEDURE DB2TBL.DO_STUFF (IN Param1 INT, IN Param2 CHAR(32),OUT Param3 INT) 
/* Param1 is primary key */
LANGUAGE SQL
P1: BEGIN
DECLARE OUTPARAM INT;
/* Do the stored procedure */
SET OUTPARAM = Param1; 
"
34753,Cartesian product as a result of inner join,"SELECT mo.date, mo.title, r.roleDescription
FROM movies mo, 
INNER JOIN role r
ON r.movieCode=mo.movieCode
WHERE r.actorid=2
"
1274,What is the proper way to get the last entry for each foreign key of a history table?,"SELECT
  *
FROM
  tHistory
WHERE
  timestamp = (
    SELECT
      MAX(timestamp)
    FROM
      tHistory latest
    WHERE
      FK_User = tHistory.FK_User
  )
"
34032,Mysql query to get posts of last 6 months grouped by month,"AND `Post_year` * 100 + `Post_month` >= $year_offset * 100 + $month_offset
"
19757,Oracle : Decode for more than one key field,"SELECT date_pkp,
       date_pkp_delete
       CASE WHEN ((date_pkp IS NULL AND date_pkp_delete IS NULL) OR
                  (date_pkp IS NOT NULL AND date_pkp_delete IS NOT NULL))
            THEN 'Non PKP'
            WHEN (date_pkp IS NOT NULL AND date_pkp_delete IS NULL)
            THEN 'PKP'
       END AS status
FROM   my_table
"
7442,SQL: Like '%' + NULL + '%' - what will match to this?,"(case when df.RuleType = 'Contains' then '%' + ISNULL(df.[Pattern A], object) + '%' end)
"
7004,How can I make change for existing date value in SQL Server into new value?,"DECLARE @DateTime2 DateTime; Set @DateTime2 = DATEADD(hh, 8, @StartDate)
"
25799,How to detect and remove a column that contains only null values?,"SELECT 1  -- no GROUP BY therefore use a literal
  FROM Locations
HAVING COUNT(a) = 0 
       AND COUNT(*) > 0;
"
33825,SQL Query: LIKE x%,"WHERE ColA LIKE '%2[%]%' 
"
15381,How to create a stored procedure with a combination of 3 columns as the parameter?,"SELECT * FROM Table WHERE Name+Surname+Number+Age = @ReportParam
"
109,SQL dates to time to minutes minus work days.....confused,"@AllMins - (integer portion of (@MinDays) * 780) - (fractional portion of (@MinDays) * 360)
"
20762,Complex SQL query assistance,"SELECT li.TimetableID, s.Name
FROM LinePaths li INNER JOIN
    (SELECT TimetableID, max(SN) as SN FROM LinePaths) as aux
ON aux.TimetableID = li.TimetableID AND aux.SN = li.SN
INNER JOIN Stations s
ON s.ID = li.StationID
"
38613,PostgreSQL: IN A SINGLE SQL SYNTAX order by numeric value computed from a text column,"SELECT id, number_value_in_string FROM table
 ORDER BY CASE WHEN substr(number_value_in_string,1,2) = '1/'
        THEN 1/substr(number_value_in_string,3)::numeric 
        ELSE number_value_in_string::numeric END, id;
"
2346,Get all the profiles a user has not voted on SQL query,"SELECT 
  profiles.name,
  profiles.surname
FROM profiles 
LEFT JOIN voted 
  ON profiles.id = voted.targetid
  AND voted.profileid = 1 /* <- your param here */
  AND voted.profileid != voted.targetid 
    /* has not voted for him/herself */
WHERE voted.profileid is null
"
30781,Simple SQL many-to-many query,"SELECT o.customer_id AS customer ,io.id AS item 
FROM orders o
INNER JOIN item_orders io ON io.order_id = o.order_id 
"
23163,update table by removing common word,"UPDATE table 
SET    col2 = REPLACE(col2, ' [proper n.]', '');
"
31486,How to avoid manually writing/managing SQL,"create table t as select * from raw_data; 

or 

insert into t (x,y,z) select x,y,z from raw_data;
"
10437,SQL to search for string matches and compute a percentage,"SELECT 100*AVG(CASE WHEN table_b.First_Name IS NULL THEN 0 ELSE 1 END) percent
FROM table_a 
LEFT JOIN table_b
  ON table_a.First_Name  = table_b.First_Name
 AND table_a.Family_Name = table_b.Family_Name
"
20415,Comparison between a date and a date converted in char,"select 
case 
  when to_date('01/01/1900','DD/MM/YYYY') >= 
  (to_date(to_char(to_date('01/01/1900','DD/MM/YYYY'),'DD/MM/YYYY'),'DD/MM/YYYY')) then 'TRUE'
  else 'FALSE'
end
from DUAL;
"
7474,Getting a Count of Users by Date,"SELECT logdate, Count(User) AS ReportUser
FROM table          
WHERE appname='abcd1234' AND logdate >=DATE-30
GROUP BY 1
"
38205,Bus Route DataBase Query Error,"SELECT bus_name
FROM buses
WHERE id in
(SELECT b.bid
FROM bus_route b
JOIN bus_route _b  
ON b.bid = _b.bid  
WHERE b.rid = 1 AND _b.rid = 2)
"
11396,Extensive String Manipulation - Cursor or While-Loop?,"UPDATE
    MT
SET
    description = REPLACE(description, old_value, new_value)
FROM
    dbo.My_Table MT
INNER JOIN dbo.Fix_Table FT ON MT.description LIKE '%' + FT.old_value + '%'
"
26189,converting mysql sub queries to join,"SELECT count(distinct mytable.*) as total 
FROM mytable 
JOIN maps
  ON mytable.pid = maps.pid
  AND maps.tid = mytable.tid
JOIN shop
  ON maps.node_id = shop.nid
  AND shop.value = 'selling' 
  AND shop.parent = '170' 
  AND shop.tid = mytable.tid
JOIN users_pro 
  ON mytable.pnumber = users_pro.pnumber
  AND users_pro.value = 'hulo' 
  AND users_pro.tid = mytable.tid
WHERE mytable.tid=1
"
18362,SQL - Insert into table data from another,"INSERT INTO categories (coname)
    SELECT DISTINCT coName
    FROM counties 
"
5273,String compare in SQL Server !,"update T1 set WorkerName = T2.WorkerId
from T1, T2
where T1.WorkerName like T2.WokerName + ',%'
"
300,"when foreign key points to something else, move other data as well","create function trigger_before_update_on_articles()
...
    if new.book_id <> old.book_id then
        update images set book_id = new.book_id
        where article_id = new.article_id
...
"
33947,How do I alter my existing table to create a range partition in Oracle,"CREATE TABLE tst
   (col_date DATE)
 PARTITION BY RANGE (col_date) INTERVAL (NUMTOYMINTERVAL(1, 'MONTH'))
(PARTITION col_date_min VALUES LESS THAN (TO_DATE('2010-01-01', 'YYYY-MM-DD')));
"
26142,mysql select multiple rows using GROUP CONCAT and JOIN,"SELECT p.* ,
   u.username,
   u.picture,
   GROUP_CONCAT(t.tag SEPARATOR ',') AS tags
FROM `posts` AS p
INNER JOIN `users` AS u ON u.blog_id = p.blog_id
LEFT JOIN `tags_relation` AS tr ON p.ID = tr.post_id
LEFT JOIN `tags` AS t ON t.ID = tr.tag_id
WHERE p.blog_id =1
  AND p.status = 'publish'
GROUP BY p.ID
ORDER BY p.timestamp DESC LIMIT 0,10;
"
427,Number of repeating customers in SQL Server,"SELECT  PaymentType,
        CustNum,
        COUNT(*) NumTransactions
FROM dbo.YourTable A
WHERE EXISTS(SELECT 1
             FROM dbo.YourTable
             WHERE CustNum = A.CustNum
             GROUP BY CustNum
             HAVING MIN(PaymentType) <> MAX(PaymentType))
GROUP BY PaymentType,
         CustNum
"
3548,SQL Server Group by each Day?,"SELECT  COUNT(*) AS [Count],
        DATENAME(DW, ErstelltAm) AS [Day]
FROM         Abfragen
WHERE     (DATEPART(week, ErstelltAm) = 21) AND (DATEPART(year, ErstelltAm) = 2014)
GROUP BY DATENAME(DW, ErstelltAm)
"
21337,Finding players that played with another player that has appeared twice,"select distinct p1.id1
from play p1
join (select id2
      from play
      group by id2
      having count(*) > 1) p2
on p1.id2 = p2.id2
"
2908,SQL: IN statement equivalent for logical AND,"select object_id
from tags_link
where tag_id in (31,35)
group by object_id
having count(distinct tag_id) = 2
"
19504,Average Hour of Day in Teradata,"AVG(CAST(opened_at AS TIME(0))            -- extract only the time portion
     - TIME '12:00:00' HOUR TO SECOND(0)) -- subtract 12 hours to center at midnight (returns an interval)
+ TIME '00:00:00'                         -- change it back to a time
"
13532,Ordering by Time part of DateTime,"ORDER BY to_char(TIMEOFISSUE, 'hh24miss')
"
26514,SQL CASE conditions always returning ELSE value,"SELECT total_amount,
    CASE 
        WHEN total_amount <= 30000 THEN 'low'
        WHEN total_amount > 30000 AND total_amount <= 40000 THEN 'medium'
        ELSE 'high'
    END AS GRP2
FROM gates_money
"
27225,complex sql which runs extremely slow when the query has order by clause,"select DISTINCT media.*
        , username 
from album as album
  inner join media as media on media.album_id = album.album_id
  inner join user as user on media.user_id = user.user_id
  left outer join album_permission as permission on album.album_id = permission.album_id
where ((album.private = 'yes' 
        and (permission.email = '' or permission.user_id = '') ) 
or album.private = 'no' 
or media.album_id = '0' ) 
and media.media_type = 'video'
order by media.id DESC 
LIMIT 0,20  
"
27013,Chaining orX in Doctrine2 query builder,"$orX = $builder->expr()->orX();
foreach($ORs as $or) {
    $orX->add($or);
}
$builder->andWhere($orX);
"
7717,t-sql append data to an existing dataset,"SELECT st.*
, dbo.ufn_usage_and_consumption(st.item_number, st.lot_number)
from some_table st
"
8900,SQL: Can I use CHARINDEX to return the best match not just the first match?,"UPDATE t1 
SET t1.codeA = t2_1.codeB
FROM table1 t1
JOIN table2 t2_1      
  ON CHARINDEX(t2_1.colB, t1.colA) > 0
LEFT JOIN table2 t2_2 
  ON CHARINDEX(t2_2.colB, t1.colA) > 0
 AND t2_1.codeB <> t2_2.codeB 
 AND LEN(t2_2.colB) > LEN(t2_1.colB)
WHERE t2_2.colB IS NULL;
"
29864,How do I get the last month using a query?,"... = MONTH(DATE_SUB(CURRENT_TIMESTAMP, INTERVAL 1 MONTH));
"
895,SQL stored procedure - Deleting each row that matches input list,"CREATE TYPE Categorylist AS TABLE (ID int);
GO

CREATE PROCEDURE DoStuff
   @userId int,
   @list Categorylist READONLY
AS
...
DELETE FROM HelpWith 
      WHERE categoryId IN (SELECT ID FROM @list)
      AND userId = @userId
...
"
24502,Validating date has expired with current system date,"select id from table1 where tabel1.date < CURDATE();
"
21056,Adding a new empty column to sql select query,"select column1,column2,1 as column3 from mytable
"
38508,Using 'LIKE' operator with a subquery that returns multiple results,"SELECT p.pattern, count(a.comment)
FROM (subquery here that returns ""pattern""
     ) p left outer join
     TableA a
     on a.comment like '%'||p.pattern||'%'
group by p.pattern;
"
22770,How to call Oracle function in Hibernate," Boolean valid = (Boolean)entityManager.createNativeQuery(""SELECT valid_user1(?1,?2) FROM DUAL"")
                          .setParameter(1, userName)
                          .setParameter(2, pwd)
                          .getSingleResult();
"
11623,Where do i place the 'Max' function in my SQL query to display the most recent 'LastCallBack'?,"WHERE [Last Call Back] = (SELECT MAX([Last Call Back]) 
                            FROM table_where_last_call_back_column_is)
"
5933,How do you divide the rows of one table with the rows of another table in SQL?,"select Distance.value / CAST(Time.value As float)
from Distance 
join Time on Distance.ID = Time.ID
"
37593,How can i do a query with SQLsave in R?,"con <- odbcConnect(""my_dsn"", uid = ""my_uid"", pwd = ""my_pwd"")

sqlSave(con, my_newdf, tablename = ""my_table"", 
        append = TRUE, rownames = FALSE, colnames = FALSE)
"
24071,SQL Delete When column a and column b does not exist,"DELETE FROM ClientEquipments WHERE EquipmentNumber =  
(SELECT E.equipmentNumber FROM ClientEquipments As E INNER JOIN ClientsPaymentTemp AS T 
 on E.equipmentNumber = T.equipmentNumber and e.SUB_ACCT_NO_SBB <> T.SUB_ACCT_NO_SBB)
"
32417,Oracle: INSERT on condition from other table,"INSERT INTO MyTable(ID, A, B)
SELECT ID,'YES','What' FROM TABLE_2 WHERE ID > 10
"
28594,Oracle: Select from table (1;2),"create type sk_pdf_type is object (sk number, pdf number);

create type sk_pdf_tab_type is table of sk_pdf_type;

select * from table
  ( sk_pdf_tab_type ( sk_pdf_type (1, 2)
                    , sk_pdf_type (3, 4)
                    )
  );
"
7909,Using result in the outer query in the inner query,"SELECT DISTRICTNAME, MIN(`ID`) AS 'MIN', MAX(`ID`) AS 'MAX'
FROM [DATABASE_NAME]
WHERE [CONDITION]
GROUP BY DISTRICTNAME
ORDER BY DISTRICTNAME;;
"
14643,How to count in Grails/Hibernate: Message.countBy,"Message.executeQuery('select count(m) from Message m where SIZE(m.body) < 25')
"
15732,Question about the merits of Pivot vs Case,"SELECT COUNT(CASE WHEN foo='bar' THEN foo END) AS bar_count,
         SUM(CASE WHEN foo='bar' THEN foo END)  AS bar_sum
FROM your_table     
"
32897,Oracle JOIN on 3 tables with 2-3 lookups,"SELECT
    people.lastname,
    people.firstname,
    people.title,
    people.phone,

    room.roomnumber,
    room.name AS roomname,

    department.name AS departmentname

FROM
    room JOIN peopleroom ON room.id = peopleroom.roomid
    JOIN people ON peopleroom.peopleid = people.id
    JOIN department ON people.departmentid = department.id

ORDER BY
    people.lastname
"
136,SQL - sum of column,"select  Item.No_, Entry.[Posting Date], Sum(Entry.Quantity) as TotalQuantity, MinMax.Maximum
FROM Item
join Entry
on Item.No_ = Entry.[Item No_]
join MinMax
on Item.No_ = MinMax.Item No_
Group By Item.No_, Entry.[Posting Date], MinMax.Maximum
"
23913,retriving all rows with maximum value,"select state as ls,count(*) as total ,max(sales) as ye from  table    
where sales = (select max(sales) from table)
group by state
"
25267,substitute one value with another from a different table in SELECT statement,"SELECT
  r.id, r.restype, r.host_id, r.source_file_id,
  SUBSTRING_INDEX(h.name, '.', 1)
FROM
  resources r LEFT JOIN hosts h
  ON r.host_id = h.id
WHERE
  r.title IN (SELECT title
            FROM resources
            WHERE export=1 
            GROUP BY title
            HAVING count(title) > 1)
ORDER BY
  r.title;
"
3151,SUM ADD Different Table same ID,"SELECT c.NIF,
  SUM(v.preu) preu
FROM CLIENTS c
INNER JOIN RESERVES_VIATGES r
ON c.NIF         = r.NIF_CLIENT
INNER JOIN VIATGES v
ON r.CODI_VIATGE = v.CODI
GROUP BY c.NIF;
"
15859,Filter rows based on condition sql server 2008,"select opid, manual, tt
from (
  select *, row_number() over (partition by opid order by manual, tt desc) rn
  from yourtable ) v
where rn = 1
"
28681,Dropping XMLIndex group and parameters,"    select index_name, parameters from user_xml_indexes;


    <parameters>
      <structured>
        <group name=""YYY"">
          <xmltab name=""TABLE_NAME""> &apos;&apos;/entity/year&apos;&apos; columns &quot;year&quot; integer  PATH &apos;&apos;text()&apos;&apos; </xmltab>
        </group>
     </structured>
    </parameters>
"
3684,How to LOAD DATA INFILE in mysql with first col being Auto Increment?,"LOAD DATA INFILE '/tmp/data.csv'
INTO TABLE your_table
FIELDS TERMINATED BY ','
(AField, BField)
SET ID = NULL;
"
29899,How can I recreate a table as index-organized?,"RENAME EXISTING_TABLE TO OLD_HEAP_TABLE;

CREATE TABLE NEW_IOT_TABLE AS
 ([COLUMNS FROM EXISTING TABLE]
  CONSTRAINT NEW_IOT_TABLE_PK PRIMARY KEY ([PK_COLUMNS FROM EXISTING TABLE]
 )
 ORGANIZATION INDEX;


INSERT INTO NEW_IOT_TABLE
SELECT * FROM OLD_HEAP_TABLE;

COMMIT;

RENAME NEW_IOT_TABLE TO EXISTING_TABLE;

-- DROP OLD_HEAP_TABLE when you're sure it all worked.
"
19485,Working with SQL Hierarchy Syntax,"with cte as(select *, OriginalDoc as Parent from Sample s1 
            where not exists(select * from Sample s2 where s2.ChildDoc = s1.OriginalDoc)

            union all

            select s.*, c.Parent from cte c
            join Sample s on c.ChildDoc = s.OriginalDoc
           )

select Parent, count(*)*0.4 as Fee from cte
group by Parent
"
19289,Copy column content PostgreSQL 7.4,"update x set new_column_value = old_column_value
"
10388,How do I check the existence of a table using a variable as tablename,"SELECT @Tabelexists = count(*) FROM sys.tables where name = ''' + @NewTabelname +''')
"
1503,Table1 Left Join Table2 Minus (join Data),"SELECT t.* FROM m_conservationsetting AS t
WHERE NOT EXISTS (
    SELECT cs.FacilityId,Cs.Unit,cs.CategoryId 
    FROM m_conservationsetting AS cs 
    LEFT JOIN l_maintelog ml on
       (cs.FacilityId=ml.FacilityId and cs.Unit=ml.Unit)
    WHERE ml.Status=0 
    group by cs.CategoryId
)
"
25153,oracle query to fetch the last 4 records from the table,"select * from ( select * from tableName order by id desc ) where ROWNUM <= 4;
"
38593,How to retrieve employees belonging to more than one Owner using Oracle SQL,"SELECT emp_no, owner_id
FROM (
SELECT  emp_no
       ,owner_id
       ,COUNT(DISTINCT owner_id) OVER (PARTITION BY emp_no) c
FROM    TableB b INNER JOIN 
        TableA a ON b.aid = a.aid 
)
WHERE c > 1;
"
23681,How to convert decimal values in tofixed format in postgresql,"SELECT to_char(1231.123, '9999999999.00');
"
36312,How to calculate Grand Totals when using OVER (partition by ...) using Oracle SQL,"SELECT JOB_GROUP,
       SUM(PEOPLE) AS CURRENT_PEOPLE
       SUM(PEOPLE) / '100' AS RATIO
FROM MY_VIEW
WHERE MONTH = '01-DEC-2013'
GROUP BY ROLLUP (OB_GROUP)
ORDER BY RATIO DESC;
"
2964,Select people from database in function of thier age,"(JulianDay('now') - JulianDay(birth)) / 365
"
26191,sql select query name -value pair,"SELECT
  ID
FROM Table
WHERE
  (Name = 'home' and Value = 'Montreal')
  OR
  (Name = 'visitor' and Value = 'Montreal')
"
8529,First Name and Last Name must be Unique Together in SQL,"CREATE TABLE people 
  ( first_name varchar2(32) , 
    last_name varchar2(32) ,
    UNIQUE ( first_name, last_name )
  ) ;
"
29298,Set column type with a select ... into statement,"SELECT DISTINCTROW 
    AR_Server_Pre.OrderID, 
    CCur(AR_Server_Pre.LineTotal) AS LineTotal, 
...
"
36944,Linux SQL Server query with dynamic data?,"echo ""SELECT * FROM $TABLE WHERE SessionID = $SESS_ID"" > tmp.sql
result=$(bsqldb -U $USER -S $SERV -P $PASS -i tmp.sql -q)
rm -f tmp.sql
"
37606,Create a Map in Golang from database Rows,"places := []Place{}
err := db.Select(&places, ""SELECT * FROM place ORDER BY telcode ASC"")
if err != nil {
    fmt.Printf(err)
    return
}
"
8804,Sqlite calculate difference in days between YYYYMMDD date formats in Query,"SELECT *,(julianday(substr(rdate`,1`,4)||""-""||substr(rdate`,5`,2)||""-""||substr(rdate`,7`,2))-julianday(substr(tdate`,1`,4)||""-""||substr(tdate`,5`,2)||""-""||substr(tdate`,7`,2)))'difference' FROM table WHERE difference <= 30.0
"
28091,SQL Count days till first of the month,"SELECT (DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 MONTH') - CURRENT_DATE
"
5371,using having in where clause,"SELECT name,count(*) as num FROM my_table GROUP BY name HAVING num > 3 OR name like '%xyz'
"
18796,Oracle text escaping with curly braces and wildcards,"select * from MY_TABLE where CONTAINS(MY_COL, regexp_replace('*abc*', '([^*])', '\\\1')) > 0
"
12839,GORM / HQL - LISTAGG,"class MyDomain {
    Long parentId
    String titleAgg

    static mapping = {
        titleAgg formula: '(SELECT LISTAGG(e.title) FROM Entity e WHERE e.parrent = parent_id)'
    }

}
"
10768,SELECT to return all items in one row,"SELECT
     [item_id],
     STUFF(
         (SELECT ',' + [item]
          FROM TableName
          WHERE [item_id] = a.[item_id] AND item_id = 82
          FOR XML PATH (''))
          , 1, 1, '')  AS NamesList
FROM TableName AS a
WHERE item_id = 82
GROUP BY [item_id]
"
1350,Any way to write this without using a join,"SELECT vendor_name
FROM vendors v
WHERE EXISTS (SELECT 1
              FROM invoices i
              WHERE v.vendor_id = i.vendor_id
             );
"
6450,SQL query help,"SELECT TableA.CID
FROM TableA
JOIN TableB ON TableA.AID = TableB.AID
WHERE TableB.status = 1
GROUP BY TableA.CID
HAVING COUNT(*) > 1
"
33495,"SQL, Find all entires that don't exist in another table","SELECT A.x
FROM A LEFT OUTER JOIN B ON A.x = B.x
WHERE B.x IS NULL
"
31438,Remove double space in phpmyadmin,"update items set description= replace(description,space(2),space(1))
"
24066,How to get totals per day,"SELECT CAST(E.CreatedDate AS DATE) DateCreated,
       COUNT(case when E.finalStatus = 'DELIVERED' then 1 end) as DELIVERED,
       COUNT(case when E.finalStatus = 'FAILED' then 1 end) as FAILED,
       COUNT(case when E.finalStatus = 'PENDING' then 1 end) as PENDING
FROM    TableName E
GROUP   BY CAST(E.CreatedDate AS DATE)
"
5142,Select with subquery avoid running more than once?,"Select 
     Col_A
    ,Col_B
    ,Col_C
    ,CASE 
        WHEN t.whatevercol IS NOT NULL THEN 1
        ELSE 0
     END CASE AS Col_D,
    t.whatevercol
FROM
    MyTable, (SELECT ...{a very complicated query}...) t
"
17052,"Drupal - Query to count all nodes of content_type ""A"" in which field_b is ""X""","$count = $query->count()->execute();
"
33641,SQL aggregation group by,"SELECT e.employee_number, e.nme, l.leavedate, la.days
FROM employee e
INNER JOIN
(
   SELECT Max(date) leavedate, employee_id
   FROM leave_allocation
   GROUP BY employee_id
) l
   ON e.employee_id = l.employee_id
INNER JOIN leave_allocation la
   ON l.employee_id = la.employee_id
   AND l.leavedate = la.date
"
35424,sql server sum aggregate functions,"SELECT SUM(net) FROM table GROUP BY [year],[month]
"
27341,Pattern matching on many columns from db in Play,"val results: List[(Int, Int, String)] = 
  SQL(""SELECT t.id, t.field1, t.field2 from table1 t WHERE t.field1 = {param1}"")
    .on(""param1"" -> param1)()
    .as(int(""t.id"") ~ int(""t.field1"") ~ get[Option[String]](""t.field2"") map(flatten) *)
    .toList 
"
3815,Count Columns Where Date +7 days,"SELECT id,
    (CASE WHEN thisdate BETWEEN getdate() AND DATEADD(day, 7, getdate()) THEN 1 ELSE 0 END +
    CASE WHEN thatdate BETWEEN getdate() AND DATEADD(day, 7, getdate()) THEN 1 ELSE 0 END +
    CASE WHEN otherdate BETWEEN getdate() AND DATEADD(day, 7, getdate()) THEN 1 ELSE 0 END) AS count
FROM <YOUR_TABLE>
"
30696,Select query optimisation,"With FirstFailDate AS
(
-- You start by selecting the first fail date
SELECT TOP 1 * FROM YOUR_TABLE WHERE /* DATE TEST FAILING */ ORDER BY ID DESC
)
SELECT *
FROM YOUR_TABLE t
-- Then, you join your table with the first fail date, and get all the records
-- that are before this date (by ID)
JOIN FirstFailDate f
  ON f.ID > t.ID
"
36367,Oracle SQL - Unwanted Spaces when concatenating fields and text strings,"SELECT replace(('EP.'||TO_CHAR(PWROTPR_TRANSX_NBR,'0000000')||'.'||TO_CHAR(PWROTPR_SUBMIT_COUNTER,'00')), ' ', '') as ATS_NBR
"
32189,Left Joining with a subselect - right table columns not showing,"SELECT tour.*, min(date) AS `startdate`, max(date) AS finaldate, ndtable.nextdate
  FROM tour, tour_date
  LEFT JOIN (
    SELECT tour_id, min(date) AS nextdate
      FROM tour_date 
      WHERE date>=CURDATE()
      GROUP BY tour_id
  ) AS ndtable
    ON ndtable.tour_id=tour_date.tour_id
  WHERE tour.id=tour_date.tour_id
  GROUP BY tour_date.tour_id, ndtable.nextdate
  ORDER BY nextdate
"
34539,query optimization with NOT IN,"select v.appid 
from visitors v 
where not exists
(select 1
 from application a
 where a.status = 'completed' and a.appid = v.appid)
"
19337,How to create a column of a specific type?,"Select  Company,	
    	City, 
    	Dues, 
    	CAST(0 AS BIT) As NewColumn1, 
    	CAST(123.12 AS REAL As NewColumn2 
FROM    @Table
"
24491,SQL query to select records from three Tables seperatly,"select 
   1 as seq,col1, col2, col3, cast(null as varchar (40)) as col4 
   FROM Table1 
   where ... 
UNION ALL 
select 
   2 as seq,'Unknown', col2, null, col4 
   FROM Table2 
   where ... 
UNION ALL 
select 
   3 as seq ,col1, col2, col3, cast(null as varchar (40)) as col4  
   FROM Table3 
   where ... 
ORDER BY seq
"
11122,Postgresql : how can i get desired output as described below,"SELECT t.item,sum(cast(coalese(b.quantity,'0') as integer)) as total_quantity FROM (
    SELECT 'pen' as item
    UNION
    SELECT 'pencil' as item
    UNION
    SELECT 'scale' as item
    UNION
    SELECT 'eraser' as item
    UNION
    SELECT 'sharpener' as item) t
LEFT OUTER JOIN box b
ON(t.item = b.item)
GROUP BY t.item
UNION
(SELECT 'total',sum(quantity)
FROM box)
"
24427,SELECT * INTO retains ORDER BY in SQL Server 2008 but not 2012,"CREATE TABLE MyTable(Name VARCHAR(50), SortOrder INT)
INSERT INTO MyTable SELECT 'b', 2 UNION ALL SELECT 'c', 3 UNION ALL SELECT 'a', 1 UNION ALL SELECT 'e', 5 UNION ALL SELECT 'd', 4


select top 0 * into result from MyTable;

alter table Result add id int identity(1, 1) primary key;

insert into Result(name, sortorder)
    SELECT * FROM MyTable
    ORDER BY SortOrder;
"
7281,TSQL How to update column from row in same table?,"UPDATE tablename SET Amount = (
    SELECT Amount FROM tablename WHERE ID = 2 )
WHERE AccNo = 1200
"
32866,Quick SQL question,"SELECT userid, COUNT(DISTINCT computerid) AS Computers, COUNT(DISTINCT cpuid) AS CPUs
FROM Computer
GROUP BY userid
"
6166,UPDATE-SQL value in table with another value in table,"sql6=""UPDATE project.wish_list join project.book on <condition> SET project.wish_lista.quantity= project.book.quantity"";
"
33507,MSSQL pattern to match all numbers between [1-999],"RIGHT('00' + myfield, 3) LIKE '[0-9][0-9][0-9]'
AND RIGHT('00' + myfield, 3) <> '000'
AND LEN(myfield) <= 3
"
33893,How to Display Right Result,"SELECT t.line, MIN(t.START), MAX(t.END), t.typ, t.color
FROM dbo.tablename t
GROUP BY t.line, t.typ,  t.color
"
7647,Select values from a table that are not in a list SQL,"select * from (
  select 'Test 1' thename union
  select 'Test 2' union 
  select 'Test 3'
)
where thename not in (select name from foo)
"
32493,MSQL Reject all queries except stored procedures,"REVOKE ALL PRIVILEGES, GRANT OPTION FROM user;
GRANT EXECUTE ON PROCEDURE mydb.myproc TO 'someuser'@'somehost';
"
14180,"In BASH, How do i connect to local system DB2 or MySQL to do a simple query?","mysql -e ""select * from mydb1.table1""
"
23862,SQL select only rows which have same column value,"SELECT fruit 
FROM fruits 
GROUP BY fruit
HAVING sum(case when delicious = 0 then 1 else 0 end) = 0
"
30888,Rails 3 ActiveRecord Query Syntax for Date Column Plus Integer Column Less Than Today's Date,"Event.where(status: 'Upcoming').select{|e| (e.date + e.duration.days) < Date.today}
"
28070,Stored Procedure with multiple parameters hangs,"cmd.Parameters(1) = x1
cmd.Parameters(2) = x2 
cmd.Parameters(3) = x3
cmd.Execute
"
25020,SQL Functions to turn inline,"with cte as (
    select *, 
        row_number() over (partition by name order by id) rn
    from product
)
select 
    c.name, 
    coalesce(c.image, pi.imageref)
from cte c
    left join plantimage pi on c.hls = pi.plantid and pi.imageNum = 1
where c.rn = 1
"
38542,Comparing two rows in a table,"select count(distinct professorID) as prof_count
from vorlesungen
where nameOfTheLecture in ('Logik','Erkenntnistheorie')
"
28364,Parallelizing SQL queries in R,"system.time(
  outputPar <- foreach(i = 1:2, .packages=""RODBC"")%dopar%{
#Connecting to database through RODBC
  ch=odbcConnect(dsn ,pwd = ""xxxxxx"", believeNRows=FALSE)
#Test connection
  odbcGetInfo(ch)
  result<-sqlQuery(ch,paste('SELECT * FROM ',databases[i]))   
  result
}
)
"
12317,SQL query with OR condition on 2 joined tables,"SELECT p.*
FROM  (
   SELECT project_id
   FROM   write_permissions
   WHERE  user_id = 1
   UNION
   SELECT project_id
   FROM   read_permissions 
   WHERE  user_id = 1
   ) sub
JOIN projects p USING (project_id);
"
32160,Trying to convert my relation into BCNF (3.5NF),"{ (Author, Date) (Author, URL) (Content) }
"
25066,Query to find districts with at least one value in assets table,"select count(*)
from district
where exists (
    select 1
    from assets
    where district_id = district.id
)
"
1691,SQLite: Joining two select statements,"Select * From (Select * From tbl1 Where Id < 4 Order By Id Desc Limit 1)
UNION Select * From tbl1 Where Id >= 4
Order By Id;
"
20554,How to run same day query for SQL Server,"SELECT CAST(GETDATE() AS DATE)
"
12286,SQL SELECT multi-columns INTO multi-variable,"SELECT @variable1 = col1, @variable2 = col2
FROM table1
"
29678,How To create correct Join between two tables?,"select t1.id,t2.name customer1 ,t3.name customer2
from customerdetail t1 
join customername t2 on t1.customer1=t2.id
join customername t3 on t1.customer2=t3.id
"
30064,Calculate percentage of revenue per month,"select p.[Order], 
       [Month], 
       Revenue, 
       [sqft produced], 
       CAST([sqft produced] / SUM([sqft produced]) OVER(PARTITION BY p.[Order]) AS DECIMAL(10,5)) * 100 as sqft_percentage, 
       Revenue * CAST([sqft produced] / SUM([sqft produced]) OVER(PARTITION BY p.[Order]) AS DECIMAL(10,5)) as revenue_produced
FROM [Orders] p
INNER JOIN Revenue r
ON r.[Order] = p.[Order]
"
18779,Stored procedure - Group By Id another value equals parameter,"SELECT GameId, TeamId
FROM yourTable
WHERE GameId IN (SELECT GameId FROM yourTable WHERE TeamId = 40);
"
7174,MySQL - Create MD5 out of 2 Values in row and save it as primary key,"DELIMITER $$

CREATE TRIGGER generate_md5  
BEFORE INSERT ON table1
FOR EACH ROW  
BEGIN  
  NEW.id = MD5(CONCAT(NEW.field1, NEW.field2))
END $$

DELIMITER ;
"
4992,Selecting data from two mysql tables in one query,"SELECT
    property.ID, property.address, property.postcode, property.lease, landlords.firstName, landlords.lastName
FROM
    property
INNER JOIN
    landlords
ON 
    landlords.ID = property.landlord
WHERE
    landlords.firstName LIKE '%spina%'
    OR
    landlords.lastName LIKE '%spina%'
"
12860,"SQL Group by, Having, and Ordering (MySQL)","select `code`, min(distance) as minimal_distance
from places
group by `code`
"
34794,How do I select the max value after a SUM() + Group By?,"SELECT T.X
 (SELECT C.NAME X, SUM(O.ORDER_TOTAL)
 FROM CLIENT C, ORDERS O
 WHERE C.CLIENT_ID = O.CLIENT_ID
   AND YEAR(O.DATE) = 2011
 GROUP BY O.CLIENT_ID
 ORDER BY 2 DESC
 LIMIT 1) T;
"
32590,"Get all dates with optional further data, if a condition is met (Android - SQLite)","SELECT *, MAX(Ordered) FROM MyTable GROUP BY ""Date""
"
17777,SQL trigger to show salary change,"CREATE OR REPLACE TRIGGER salary_changes
AFTER DELETE OR INSERT OR UPDATE ON FACULTY
FOR EACH ROW

DECLARE
  sal_diff  NUMBER;
BEGIN
 If (INSERTING or UPDATING) then 
     sal_diff  :=  :NEW.F_SALARY  - :OLD.F_SALARY;
     DBMS_OUTPUT.PUT_LINE('Difference: ' || sal_diff);
  END IF;

 IF DELETING THEN 
    DBMS_OUTPUT.PUT_LINE('The deleted value is:' || :OLD.F_SALARY);
 END IF;   
END;
"
32149,MYSQL add row and count from diffrent table,"select users.user, users.id, count (species.name)
from users left join species 
on users.id = species.user
group by users.user, users.id
order by count (species.name) desc
"
6417,Calculating average speed from columns that have both a distance and a time (NULL issues),"SELECT SUM(Distance)/SUM(Time) AS AvgSpeed
FROM yourtable
WHERE Distance IS NOT NULL
AND Time IS NOT NULL
"
37846,Simple HQL/sql query..need assistance?,"SELECT * 
FROM person 
LEFT JOIN (SELECT * 
           FROM vacations 
           WHERE startDate BETWEEN '2011-07-01' AND '2011-07-30')
"
34710,"Get the persons, who are in both sets","SELECT pc.person_id
  FROM person_club_data pc
  INNER JOIN group_clubs gc ON (gc.club_id = pc.club_id)
 WHERE gc.group_id = 2
 GROUP BY pc.person_id
 HAVING COUNT(pc.person_id) >= (
     SELECT COUNT(gc.club_id)
       FROM group_clubs gc2
      WHERE gc2.group_id = 2
 )
"
16587,Making an array of varchars constrained by a 'references' in SQL,"CREATE TABLE titles (
  bookTitle varchar(80)
);

CREATE TABLE borrowers (
  name varchar(80) --borrower's name
);

CREATE TABLE checkedout (
  name      varchar(80),
  bookTitle varchar(80)
);
"
32894,"SQL, where clause is not applied","SELECT COUNT( DISTINCT user.id ) AS user
FROM profile join user on user.id=profile.user_id
WHERE (
profile.age
BETWEEN 0 
AND 14
)
AND user.enabled =1
"
18023,how to merge two sqlite3 databases with same schema having primary key with auto increment,"INSERT INTO student(name, age)
SELECT name, age
FROM toMerge.student;
"
14905,"Group-by date, given a varchar (string)","SELECT  *
FROM    tableName
WHERE   STR_TO_DATE(datum,'%M %e, %Y, %h:%i %p') ....
"
18059,"Return null value as '0' in group by clause, postgresql","SELECT  s.created_at, COUNT(o.subsription_id)
FROM    subscriptions s
LEFT JOIN
        orders o
ON      o.subcription_id = s.id
GROUP BY
        s.created_at
"
5873,SQL Joins Excluding Data,"select f.name, a.price, b.price
from Fruit f
left join ProduceStoreA a on a.Name = f.Name
left join ProduceStoreB b on b.Name = f.Name
"
24093,SQL - Ugly combination of GROUP BY and COALESCE,"Select State, coalesce(max_created,max_updated) from (
  Select State, min(foo) as min_foo, max(foo) as max_foo, 
    max(DateCreated) as max_created,
    max(DateUpdated) as max_updated
  From Data
  Group by State)
 Where min_foo = max_foo
"
15656,Writing a SQL to calculate DATEDIFF,"SELECT *, DATEDIFF(year,NOW()) / -365 as Date_Value_Table FROM Hotel
"
31253,how to update syscolumns of a view after alter table - T-SQL?,"create table Test ( n1 decimal(12,4) )
go
create view VTest as Select * from Test;
go
sp_help VTest
go
alter table Test alter column n1 decimal(12,2)
EXEC sp_refreshview  VTest
go
sp_help VTest
"
24939,Find from database table based on field value of another table?,"SELECT
  pages.id,
  page_revisions.title,
  page_revisions.content
FROM
  pages
LEFT JOIN
  page_revisions
    ON page_revisions.id = (SELECT TOP 1 id FROM page_revisions WHERE page_id = pages.id ORDER BY created DESC)
WHERE
  <conditions>
"
39653,How to output data from iSQL to csv file _with_ headings?,"SELECT 'ID;LASTNAME;FIRSTNAME;DOB' FROM dummy;
OUTPUT TO 'C:\\temp\\sometable.csv' FORMAT ASCII DELIMITED BY ';' QUOTE '';
"
17800,Simple SQL statement to retrieve orders on a specific date,"SELECT OrderDate, COUNT(OrderID) AS OrderCount
FROM OrderT
WHERE OrderDate = #1998-07-15#
GROUP BY OrderDate;
"
37263,SQL - select all rows containing account number proceeding an earlier status,"SELECT * FROM YourTable t
WHERE date_time >= 
     (SELECT MIN(date_time) from YourTable p
     where t.account_number = p.account_number and p.status = 'B2') 
"
12492,How to make a SUM without group by,"(Sum(Auction) OVER ()) - actual AS Remaining
"
7156,How to make this sub-sub-query work?,"select hC.id as next_class_id, hL.id as next_lesson_id, hC.class as next_class, hL.term_num as term_num, hC.class_num as next_class_num, hL.lesson_num AS next_lesson_num
from hl_classes hC
left join hl_classes_lessons hL on hL.class_id = hC.id
where hL.term_num = $TERM_NUM
and hL.id not in (
    select hA.lesson_id
    from hl_classes_answers hA
    where student = $USER_ID
)
order by hC.class_num, hL.lesson_num
limit 1;
"
31933,Converting detailed Date column into grouped by month column format,"select CAST(MONTH(Creat_Dttm) AS VARCHAR(2)) + '/1/' + CAST(YEAR(Creat_Dttm) AS VARCHAR(4)) as month 
from TEMPSO_INV_DATA 
"
14726,PostgreSQL - combining two tables,"SELECT u.id, u.firstname || ' ' || u.lastname || ' ' || u.email, u.registrationdate AS DateVal
FROM user u
UNION ALL
SELECT g.id, g.name || ' ' || g.desc, g.createdate
FROM group g
ORDER BY 3
"
10831,How to alter the below table?,";with cte as
(
select id,value1,value2,row_number() over(partition by id order by id) as rn from #t
)

select id,value1,value2 from cte where rn=1
"
27932,sql trim and replace,"DECLARE @t TABLE(name NVARCHAR(10))

INSERT INTO @t VALUES
('AB_1X'),
('AXG_3X'),
('4G_12X')

SELECT name, 
       SUBSTRING(name, 1, CHARINDEX('_', name) - 1) nameL,
       SUBSTRING(name, CHARINDEX('_', name) + 1, LEN(name)) nameR
FROM @t
"
23806,row_nums without using row_number function?,"SELECT id, name, ROW_NUMBER() OVER (ORDER BY name)
  FROM dbo.color
  ORDER BY name;
"
5052,MySQL: Query that finds all states that does not contain a specific value,"SELECT DISTINCT state
 FROM mytable
 WHERE state NOT IN (
   SELECT DISTINCT state
   FROM mytable
   WHERE type = 'river'
)
"
5056,Get records with blank field value using LIKE statement,"where (Book_Author LIKE '*"" & TextBox.Text & ""*' or Book_Author = '')
"
11573,How can I delete all rows with duplicates in one column using MySQL?,"DELETE t1
FROM mytable t1
JOIN (SELECT Title, MAX(Created_at) AS max_date
      FROM mytable
      GROUP BY Title) t2
ON t1.Title = t2.Title AND t1.Created_at < t2.max_date   
"
1354,Top 2 distinct in sql,"select t1.* 
from table t1
join (select status, MAX(Date) as maxDate
      from table
      group by status) m
on m.status = t1.status and m.maxDate = t1.Date
"
4851,Latest Group By MYSQL + link Table,"SELECT s.*
FROM system_devices s LEFT JOIN system_devices s1
   ON (s.carId = s1.carId AND s.lastUsed < s1.lastUsed)
   INNER JOIN link_devices_user ld ON s.id = ld.deviceId
WHERE (s1.id IS NULL) AND (ld.shopId = 46)
ORDER BY carId
"
22884,How to manually move rows from one database to the next?,"INSERT INTO [NewDB].[dbo].[Aliases] 
SELECT columns
FROM [OldDB].[Terminal].[Alias]
"
23188,SQL Server Delete all rows more than 10 minutes old,"DELETE FROM Table_name
WHERE Date_column < DATEADD(mi,-10,GETDATE())
"
26228,Selecting a row only if the calculated count is greater than 0,"select p.[ref] as [ID], p.[first] as [First], f.[Total Calls Made]
from [person] p join
     (select f.[related], count(distinct f.[id]) as [Total Calls Made]
      from [field] f 
      where f.[field] = 'person_that_called'
      group by f.[related]
     ) f
     on f.related = p.id
where [Total Calls Made] > 0;
"
25432,Mysql query select non-members,"SELECT c.id, 
  c.name 
FROM customers c
WHERE not exists (select customer_id
                  from modulemembers m
                  where c.id = m.customer_id)
order by c.name
"
11775,What is the best way to write the date in mm-mm-yyyy in SQL," select convert(varchar(8), getdate(),120)
      + convert(varchar(3),datename(month,getdate()))
"
39317,SQL query problems transpose MySQL,"select (case when n = 1 then 'Quality' else 'Speed' end) as Assessment,
       (case when n = 1 then avg_quality else avg_speed end) as Value
from (select AVG(r.quality) as avg_quality, AVG(r.speed) as avg_speed
      from reading_assestment r join
           people p
           on r.person_id =p.person_id
      where person_id = 3
     ) t cross join
     (select 1 as n union all select 2) n
"
25953,Most efficient way to loop in SQL?,"select g.gameid, p.playerid, p.money
from (select g.gameid, p.playerid, p.money,
             max(p.money) over (partition by g.gameid) as MaxMoneyPerGame
      from games g join
           players p
           on g.playerid = p.playerid
     ) gp
where gp.money = gp.maxmoney;
"
5914,Are SQL ANY and SOME keywords synonyms in all SQL dialects?,"c) If the implied <comparison predicate> is true for at least
one row RT in T, then ""R <comp op> <some> T"" is true.

d) If T is empty or if the implied <comparison predicate> is
false for every row RT in T, then ""R <comp op> <some> T"" is
false.

e) If ""R <comp op> <quantifier> T"" is neither true nor false,
then it is unknown.
"
35733,retrieve contacts SQL query,"SELECT 
 u1.firstname || ' ' || u1.lastname as User,
 u2.firstname || ' ' || u2.lastname as Contact
FROM
 users u1
INNER JOIN contacts c
ON u1.user_id = c.user_id
INNER JOIN users u2
ON c.friend_id = u2.user_id;
"
34138,Fetch mysql data of timstamp depending on time given,"SELECT date_column
FROM yourTable
WHERE DATE(DATE_SUB(NOW(), INTERVAL 12 HOUR)) = DATE(date_column);
"
18055,Join query in Mysql of two tables,"SELECT COUNT(*) ads_total
  FROM ad a JOIN
       adcat c ON a.id = c.adid
 WHERE c.catid = 1 AND
       a.userid = 725
"
5028,PostgreSQL - how to return the last X values?,"SELECT * FROM table WHERE time_column =< '2013-03-02 22:00:00'
ORDER BY time_column DESC
LIMIT 3
"
27105,SQL Server: How to bound a data pull to a specific time Interval?,"Select TimeTaskCompleted, Task
From Task 
Where TimeTaskCompleted between ‘07/01/2015’ and ‘09/30/2015’
AND DATEPART(hh,TimeTaskCompleted) between 6 and 20 --24 hour time
"
35085,IF EXISTS in SQL Server Cursor Not Working,"DECLARE @tablename sysname 

SET @tablename = 'ps_vars' + @datasetid

IF (OBJECT_ID(@tablename, 'U') IS NOT NULL)
BEGIN
 SET @sql = ' UPDATE ' + QUOTENAME(@tablename) + '
     SET    programming_notes = replace(programming_notes, ''Some of the variables listed are source variables.'') ';
     EXEC sp_executesql @sql  
END
"
17873,What DBMS should I use to store openstreetmap as a graph?,"UPDATE nodes set tag1=edges.tags from edges where nodes.id=edges.from;
UPDATE nodes set tag2=edges.tags from edges where nodes.id=edges.to;
"
16178,Fetch Column names from a joined mysql table,"select top4.*, t1.team_name, t2.team_name, t3.team_name, t4.team_name
from top4 join
     teams t1
     on top4.first = t1.team_id join
     teams t2
     on top4.second = t2.team_id join
     teams t3
     on top4.third = t3.team_id join
     teams t4
     on top4.fourth = t4.team_id;
"
19292,Help creating a single SELECT statement for SQL Reports,"select Account, 
    sum(case when Type='D' then Amount * -1 else Amount end) as AmountSum
from Payment
group by Account
"
9144,How do I merge one SQL 2005 Table with another Table?,"WITH C1 AS(
    SELECT ROW_NUMBER() OVER (ORDER BY TABLE1.BIGNUMBER) AS Rn1
           ,BIGNUMBER
    FROM TABLE1
)
,C2 AS(
    SELECT ROW_NUMBER() OVER (ORDER BY TABLE2.SMALLNUMBER) AS Rn2
           ,SMALLNUMBER
    FROM TABLE2
)
INSERT INTO TABLE3
SELECT C1.BIGNUMBER
       ,C2.SMALLNUMBER
FROM C1
INNER JOIN C2 ON C1.Rn1 = C2.Rn2
"
14098,"Combine two different select statements, one distinct the other not","SELECT * FROM StevesTable t 
WHERE t.data1 = '%s' 
AND t.data2 = to_date('%s','DD/MM/YYYY')
AND t.data1 in (select distinct data1 FROM anothertable ftt
    join table1 tab on tab.somedata = ftt.somedata
    where tab.somedata = 0
    and tab.someotherdata = 1)
"
31618,my sql union + limit,"(SELECT a FROM t1 WHERE a=10 AND B=1 ORDER BY a LIMIT 10)
UNION
(SELECT a FROM t2 WHERE a=11 AND B=2 ORDER BY a LIMIT 10);
"
23664,Limit number of rows returned from sqlite,"SELECT col1, col2 FROM mytable WHERE foo = 'bar' LIMIT 42;
"
23573,2-step SQL Query..something seems wrong,"SELECT pc.*
FROM ProfileCharacteristics pc
    JOIN Users u ON pc.UserId = u.UserId
WHERE U.UserName = 'someuser'
"
1133,How to change datatype of parameter of SQL procedure without changing its body,"declare @alter nvarchar(max)

SELECT @alter = ROUTINE_DEFINITION
  FROM [INFORMATION_SCHEMA].[ROUTINES] as r
  WHERE r.ROUTINE_NAME = 'do_some_magic'
    AND r.ROUTINE_SCHEMA = 'dbo'

SET @alter = replace(replace(@alter,
               'CREATE PROCEDURE','ALTER PROCEDURE'),
               '@text nvarchar(100)','@text nvarchar(2000)')

exec (@alter)
"
3739,Left Joining Table with Sum - Causing Issues,"SELECT SUM(Table1.Value1) Table1Value1SUM,SUM(Table2.Value1) Table2Value1Sum 
From JoinTable 
Left Join Table1 On JoinTable.ID = Table1.ID
Left Join Table2 On JoinTable.ID = Table2.ID
"
21656,SQL: selective subqueries,"SELECT  P.name, 
        CASE WHEN wantssport = 1 THEN (select count(*) from cars C where C.type = 'sports') ELSE NULL END AS sportscars,
        CASE WHEN wantsfamily = 1 THEN (select count(*) from cars C where C.type = 'family') ELSE NULL END AS familycars,
        CASE WHEN wantsbusiness = 1 THEN (select count(*) from cars C where C.type = 'business') ELSE NULL END AS businesscars
FROM    people P
WHERE   P.id = 1
"
29604,SQL SELECT from XML field as multiple records,"SELECT
    OrderNumber,
    SkuColumn.value('.', 'varchar(20)') AS SKU
FROM Orders
    CROSS APPLY OrderItems.nodes('/items/item/sku') SkuTable(SkuColumn)
WHERE OrderDate = '2016-04-09'
"
2987,"constraining a table field -> not duplicate value, not a primary key","CREATE UNIQUE INDEX foo_idx1 ON foo (bar)
"
24506,Database covering a query,"CREATE INDEX [ix_MyTable] ON [MyTable] 
(
            [Col1] ASC,
            [Col2] ASC
)
INCLUDE ( [Col3]) 
"
8125,MYSQL syntax not evaluating not equal to in presence of null,"SELECT name 
from   products p
WHERE  backorder IS NULL OR backorder <> 2
"
20224,How to apply Joins in Oracle to require result,"SELECT pm.p_name ""P_NAME"",
       listagg(sm.s_number, ', ') WITHIN GROUP (ORDER BY pd.p_d_id) ""S_NUMBER""
  FROM pattern_master pm,
       pattern_details pd, 
       shift_master sm
 WHERE sm.s_id= pd.s_id 
   AND pm.p_id = pd.p_id
GROUP BY pm.p_name;
"
19013,ROW_NUMBER over column result,"SELECT *,
       cityCounter = ROW_NUMBER() OVER (PARTITION BY city ORDER BY personID)
FROM yourTable
ORDER BY personID
"
15213,How to delete all the records in a declared table inside a storedprocedure,"DELETE FROM @Temp
"
8604,SQL loop through a table and find the next part record,"WITH cte AS (
  -- Base condition, where do we start the search?
  SELECT t.* FROM tblPartTable t WHERE t.PartNumber = '100X'
  UNION ALL
  -- Continue condition, how do we find the next part from the current one?
  SELECT t.* FROM tblPartTable t JOIN cte ON t.PartNumber = cte.NextPartNumber
)
SELECT partnumber, active FROM cte;
"
22624,MySQL - query records above date and one below,"(SELECT * FROM mytable WHERE mydate >= xxx)
UNION
(SELECT * FROM mytable WHERE mydate < xxx ORDER BY mydate DESC LIMIT 1)
"
11325,SQL: Convert Date to Null when Date is certian range from Today,"update test_table
    set dte = (case when add_months(dte, -12) < sysdate then dte end);
"
17157,How to improve this transact-sql script for sql server 2005?,"SELECT TOP 1
        column_01, 
        COUNT(column_01) OVER(),
    SUM(CASE WHEN column_02=1 THEN 1 ELSE 0 END) OVER()
    FROM 
        table_01
    WHERE 
        status = 1
    ORDER BY column_02 desc, datetimestamp asc
"
22405,"HANA SQLScript ""Sleep"" Command","CREATE PROCEDURE PLEASE_SLEEP ( IN SLEEPING_TIME INTEGER, OUT WOKE_UP_AT TIME )
LANGUAGE SQLSCRIPT READS SQL DATA AS
  V_TIME TIME;
  V_TIME_TO_WAKE TIME;
BEGIN
  V_TIME := CURRENT_TIME;
  V_TIME_TO_WAKE < ADD_SECONDS ( TO_TIME( V_TIME ), SLEEPING_TIME );
  WHILE V_TIME != V_TIME_TO_WAKE DO
    V_TIME := CURRENT_TIME ;
  END WHILE;
  WOKE_UP_AT := V_TIME_TO_WAKE ;
END
"
20095,Aggregate keeping the row with the max value,"select user_id, max(score)
from user_scores
group by user_id
order by max(score)
"
33171,Generating the unique sets of attributes into a new table?,"CREATE TABLE TABLE_B (COLUMN_NAME, VALUE) AS
  SELECT DISTINCT 'COL_1', COL_1 FROM TABLE_A
  UNION ALL
  SELECT DISTINCT 'COL_2', COL_2 FROM TABLE_A
  UNION ALL
  SELECT DISTINCT 'COL_3', COL_3 FROM TABLE_A
  UNION ALL
  SELECT DISTINCT 'COL_4', COL_4 FROM TABLE_A
  UNION ALL
  SELECT DISTINCT 'COL_5', COL_5 FROM TABLE_A;
"
26639,"MYSQL Explain Giving an ""Impossible WHERE"" with SELECT Count(x) Query","UPDATE articles 
SET article_count = IF (
    (SELECT count(*) FROM posts WHERE post_id = 2343243 AND user_id = 3) = 1, article_count+1, article_count) 
WHERE id = 2343243;
"
4749,How do I Get a WPF DataGrid to Save Changes Back to the DataBase?,"public CustomerDataProvider()
{
    NorthwindDataSet dataset = new NorthwindDataSet();

    adapter = new CustomersTableAdapter();
    adapter.Fill(dataset.Customers);

    dataset.Customers.CustomersRowChanged +=
        new NorthwindDataSet.CustomersRowChangeEventHandler(CustomersRowModified);
    dataset.Customers.CustomersRowDeleted +=
        new NorthwindDataSet.CustomersRowChangeEventHandler(CustomersRowModified);
}

void CustomersRowModified(object sender, NorthwindDataSet.CustomersRowChangeEvent e)
{
    adapter.Update(dataset.Customers);
}
"
39552,Getting 2 different records rows in the same sql join,"SELECT u.name
     , u.picture_url
     , m.id_user_winner
     , m.id_user_loser
     , e.name
     , e.picture_url
     , m.date_match 
FROM matches m JOIN users u ON u.id_user = m.id_user_winner AND u.id_user = 3
               JOIN users e ON e.id_user = m.id_user_loser
"
11975,T-SQL - Convert/Transpose multiple XML node values to a column,"SELECT 
    [RowKey],
    x.y.value('(.)[1]', 'INT') AS ItemKey
FROM
    dbo.[tbl_MyDataTable] AS t
CROSS APPLY
    t.[Format].nodes('/MultiSelect/ItemKey') x(y)
"
3783,Help with writing a linq query,"int Total(int numberOfDays, DataItem[] items){
    var query =
        from item in items
        let daysInData = Math.Min(item.DayTo, numberOfDays) - item.DayFrom + 1
        where item.DayFrom >= numberOfDays
        select item.Price * daysInData;
    return query.Sum();
}
"
37755,Complex MySQL Query who can solve?,"SELECT product_id,product_name, min(c) Qty
FROM
(
  SELECT p.product_id, p.product_name, p.material_id, count(sd.product_id) c
  FROM product p
  LEFT JOIN scaledata sd
    ON p.product_id=sd.product_id
   AND p.material_id = sd.material_id
  GROUP BY product_id, p.product_name, p.material_id
) a
GROUP BY product_id
"
34988,Sequential scan in postgres is taking surprisingly long. How do I determine the hardware bottleneck?,"51sec * 120MB/sec ~ 6GB
"
39334,Proper database design for this task,"words (w_id int, w_word varchar(50))

categories (c_id int, c_category)

wordcategories (wc_wordid int, wc_catid int)
"
16632,SQL query join issue,"SELECT m.Name FROM Main m LEFT JOIN Net n ON n.AppID=m.AppID LEFT JOIN Env e ON e.AppID=m.AppID;
"
6939,Performing JOIN between two tables,"SELECT t1.user_id, t1.item_id, t1.item_number, COUNT(attribute) AS number
FROM table_1 t1
LEFT OUTER JOIN table_2 t2 ON t1.user_id = t2.user_id AND t1.item_id = t2.item_id
WHERE t1.user_id = '1'
GROUP BY t1.user_id, t1.item_id;
"
36999,MSSQL - Select distinct products that are found in two columns,"SELECT  ProductA AS Products
FROM    tablename
UNION
SELECT  ProductB
FROM    tablename;
"
20515,Use terms from text file in SQL WHERE ... IN clause,"LOAD DATA INFILE 'file.txt'
  INTO TABLE t1
  (column1, column2, column3);
"
25321,Join different tables based on condition,"select 
    f.id,
        case when userkey=0 then l.name else p.name end as username
from [feature] f
    left join [liteuser] l on l.user_id = f.user_id
    left join [premium user] p on p.user_id = f.user_id
"
10249,Filter Rows by highest version,"SELECT NAME,
       max(MYVALUE)
FROM TABLE t
GROUP BY NAME
"
10726,"PostgreSQL ""nested""? distincts and count ","select extract(hour from occurred) as hr, count(distinct name)
from table t
group by extract(hour from occurred)
order by 1
"
35406,Efficient incremental inserts in postgresql,"DELETE FROM files WHERE NOT EXISTS
  (SELECT 1 FROM newfiles WHERE newfiles.path=files.path);
"
36358,Hibernate column with list,"Table user:
ID (primary key), name, ...

Table hobby:
ID (foreign key referencing user.ID), userHobbies
"
18528,Order by asc Sql query,"ORDER BY CAST(sNO as INT)
"
27382,joining results in having clause from 2 different condtition,"having 
 qty>=0 
 AND ( X.Dt=@IssueDate2   OR  X.Dt=@IssueDate3_mjssun )
"
25713,Auto-increment field that resets after a change in another field,"select  row_number() over (partition by Meal order by Time)
,       *
from    YourTable
"
26757,Mysql union Priority,"(SELECT BRAND, AMOUNT
 FROM SALES1 
) UNION ALL
(SELECT BRAND, AMOUNT
 FROM SALES2 s2
 WHERE NOT EXISTS (SELECT 1 FROM SALES1 s1 WHERE s1.BRAND = s2.BRAND)
) UNION ALL
(SELECT BRAND, AMOUNT
 FROM SALES3 s3
 WHERE NOT EXISTS (SELECT 1 FROM SALES1 s1 WHERE s1.BRAND = s3.BRAND) AND
       NOT EXISTS (SELECT 1 FROM SALES2 s2 WHERE s2.BRAND = s3.BRAND)
)
"
19328,Return new query if rowcount = 0,"SELECT  PassengerNumber, FromTime, ToTime, Remarks 
FROM    tableA 
WHERE   DepartureDate = @DepartureDate
UNION   ALL
SELECT  '-' [PassengerNumber],
        '00:00' [FromTime],
        '00:00' [ToTime],
        'No Mismatch' [Remarks]
WHERE   0 = (SELECT COUNT(*) FROM tableA WHERE DepartureDate = @DepartureDate)
"
18366,Can't get unique values using a postgres query,"SELECT cNo
    ,max(numLogs)
    ,max(name)
    ,max(surname)
-- min would also work.
FROM details 
GROUP BY cNo
"
30850,sum some xml nodes values in sql server 2008,"select @xml.value('sum(/Parent[@ID = ""p""]/Child)', 'float') as Sum
"
20513,Automatically populate date in oracle table,"create table test (first number
                   , second timestamp default systimestamp
                   , third varchar2(12));
"
14612,T-SQL Case logic,"DELETE FROM dbo.table where AddenOn < DATEADD(year, '01/23/2012', -1)
"
33267,SQL Server Agent - sending emails with no content,"if (len(@xml) > 0)
    begin
       EXEC msdb.dbo.sp_send_dbmail
       @body = @body,
       @body_format ='HTML',
       @recipients = 'myemail@domain.com;',
       @subject = 'Jobs Due Today';
    end
"
19804,select a column in foreign key,"SELECT T1.NAME FROM TABLE2 T2
   INNER JOIN TABLE1 T1 ON (T1.ID=T2.EID)
    WHERE T2.HOUR=X
"
16783,query for roww returning the first element of a group in db2,"SELECT * FROM Table1 
WHERE ID IN (SELECT MIN(ID) FROM Table1 GROUP BY FLD_A)
"
31867,Append Table Name to Field Name with Select *,"SELECT 
    (case t.name when 'MyTable1' then 'ca' when 'MyTable2' then 'dcn' when 'MyTable3' then 'cdn' when 'MyTable4' then 'bb' end)
    + '.' + c.name
    + ' AS ""' + t.name + '.' + c.name + '"",'
FROM sys.tables AS t
INNER JOIN sys.columns c ON t.OBJECT_ID = c.OBJECT_ID
WHERE t.name in ('MyTable1', 'MyTable2', 'MyTable3', 'MyTable4')
ORDER BY t.name
"
12199,How to return empty cells for repeated values and keep only the cells which are different?,"WITH t AS (SELECT *, ROW_NUMBER() OVER (ORDER BY Field1) rownum FROM table1)
SELECT NULLIF(curr.Field1, prev.Field1) Field1,
       NULLIF(curr.Field2, prev.Field2) Field2,
       NULLIF(curr.Field3, prev.Field3) Field3
FROM t curr
LEFT OUTER JOIN t prev ON prev.rownum = curr.rownum - 1
"
20402,SQL:1999 Array Type Constructor Usage?,"WHERE QUALIFICATION(1) = 'BSC' 
   OR QUALIFICATION(2) = 'BSC'
   ... 
"
34977,MySQL closest equivalent of SyBase Update Set From syntax,"UPDATE my_table
JOIN OTHER_TABLE other
ON my_table.id = other.id
SET first_name = other.first_name,
    last_name = other.last_name
"
24354,Using different columns values twice in a single SQL query?,"  SELECT user.user_id,
       node.name user_name,
       user.birthday,
       (select node.name from node where node_id = vote.node_id) as movie_name
  FROM user
  JOIN node ON user.user_id = node.user_id
  JOIN vote ON vote.user_id = user.user_id
"
9112,Avoid duplicates rows which have one different column value in SQL Server,"SELECT   formId, name, MIN(mark) AS mark
FROM     my_table
GROUP BY formId, name
"
32127,Groovy GString in Sql.execute - text variables are not surrounded by ' and query fails,"firstName = ""yue""
lastName = ""wu""
sql.execute(""insert into people (firstName, lastName) ""+
  "" values (?,?)"", [firstName, lastName])
"
12275,MySQL - Pulling List depending on date and category,"SELECT DISTINCT PosterID
FROM table1 x
WHERE PostingDate BETWEEN '2012-05-01' AND '2012-06-30'
AND posterID NOT IN (SELECT PosterID
  FROM table1 y
  WHERE PostingDate > '2012-07-01' AND x.CategoryID = y.CategoryID);  
"
11036,Alternative to LIMIT 1 to extract a date range plus first entry before and after?,"SELECT DateTime, value FROM ReadingGlucoseBlood WHERE DateTime BETWEEN '2011-01-21 00:00:00' AND datetime('2011-01-21 00:00:00', '+24 hours') 
UNION ALL
SELECT * FROM (
SELECT DateTime, value FROM ReadingGlucoseBlood WHERE DateTime < '2011-01-21 00:00:00'
ORDER BY DateTime DESC LIMIT 1
) X
UNION ALL
SELECT * FROM (
SELECT DateTime, value FROM ReadingGlucoseBlood WHERE DateTime > datetime('2011-01-21 00:00:00', '+24 hours')
ORDER BY DateTime ASC LIMIT 1
) Y
ORDER BY DateTime ASC
"
4361,What makes count(*) query to run for 30 sec?,"SELECT OBJECT_NAME(OBJECT_ID) TableName, st.row_count
FROM sys.dm_db_partition_stats st
WHERE index_id < 2
ORDER BY st.row_count DESC
"
19829,SQL CTE and ORDER BY affecting result set,"WITH results AS
(
    SELECT TOP 10 ID, Date
    FROM dbo.items
    ORDER BY ID DESC 
)
SELECT ID
FROM results
ORDER BY Date
"
27782,Delete unattached data,"DELETE TargetTable  --<-- Table from where you deleting records
FROM TargetTable LEFT JOIN Table1    --<-- Checking records in Table1
ON TargetTable.ID = Table1.FK_ID
LEFT JOIN Table2                 --<-- Checking records in Table2
ON TargetTable.ID = Table2.FK_ID
WHERE Table1.FK_ID IS NULL 
AND Table2.FK_ID IS NULL
"
26515,How can I quickly solve this query?,"select a.name as name,b.name as represon from table1 a 
inner join table1 b on a.code=b.rperson
"
739,Trying to copy data from Impala Parquet table to a non-parquet table," CREATE TABLE <text_table> 
     AS 
 SELECT * 
   FROM <parquet_table>
"
21089,SQL Ordering a complex query,"SELECT items.*, item_modifiers.primary_value 
FROM items 
INNER JOIN item_modifiers ON item_modifiers.item_id = items.id AND item_modifiers.modifier_id = 1
WHERE EXISTS
(
  SELECT *
  FROM item_modifiers 
  WHERE item_modifiers.item_id = items.id AND item_modifiers.modifier_id = 2
)
ORDER BY item_modifiers.primary_value DESC;
"
25095,How to fix this stored procedure problem,"create SQLConnection

Create #temptable
Bulkcopy to #temptable

Call proc on same SQLConnection

proc:
   INSERT tableA (..)
   OUTPUT INSERTED.key, .. INTO TableB
   SELECT .. FROM #temptable

close connection
"
450,SQL 'where statement' without joining,"SELECT name, something
FROM table1 t1
JOIN table2 t2 ON t1.t1_id = t2.fk_t1_id
JOIN table3 t3 ON t2.t2_id = t3.fk_t2_id
WHERE t3.blah = 'somestring'
"
8733,Fetch the Max date record for each year or an item,"SELECT IT.*
FROM INV_TAB IT
INNER JOIN (SELECT I.ITEM_ID
                  ,MAX(I.END_DATE) AS [END_DATE]
           FROM INV_TAB I
           GROUP BY I.ITEM_ID, DATEPART(YEAR,I.END_DATE)) T ON T.ITEM_ID = IT.ITEM_ID
                                                    AND T.END_DATE = IT.END_DATE
"
15982,comparison of joins,"select sr.region, ic.category, sum(sale) sales

from sales s
inner join storeregion sr on s.storeid=sr.storeid
inner join itemcategory ic on s.itemid=ic.itemid
INNER JOIN 
(

    select region, sum(sale) sales

    from sales s
    inner join storeregion sr on s.storeid=sr.storeid

    where date between 'whatever' and 'whatever'

    group by region

) st ON sr.region = st.region
where date between 'whatever' and 'whatever'

group by sr.region,ic.category, st.sales
having sum(sale) > st.sales * 0.50
"
38841,MYSQL: Updating a column based on select statement with joins,"UPDATE  public_document_store a
        INNER JOIN public_document_store_talkback b
            ON b.document_id = a.document_id
SET     a.skin_id = 6
WHERE   b.is_released = 1 AND 
        b.is_rejected = 0 AND 
        a.section_id = 10
"
22267,How do I find/replace rows in oracle having text containing % and other special characters,"update temp 
set address = regexp_replace(address,'[%|^\/]',' ') 
where regexp_like(address, '[%|^\/]')
"
35558,Find difference between two consecutive rows of same column in mysql,"select orderid
from orders
group by orderid
having sum(case when `type` = 'Order' then productsales else 0 end) +
       sum(case when `type` = 'Refund' then productsales else 0 end) > 0
"
35316,SQL Server - Select every second in a day,"SET NOCOUNT ON

DECLARE @YourDate DATETIME
SET @YourDate = '2/2/2012'

DECLARE @Numbers TABLE (Number INT)
DECLARE @Index INT

SET @Index = 0
WHILE (@Index < 86400)
BEGIN
    INSERT INTO @Numbers VALUES (@Index)
    SET @Index = @Index + 1
END

SELECT DATEADD(SECOND, n.Number, @YourDate)
FROM @Numbers n
WHERE n.Number < 86400
"
18676,counting employee attendance,"SELECT COUNT(NewEmployee.EmployeeID), NewEmployee.EmployeeId,EmployeeName
 FROM NewEmployee INNER JOIN NewTimeAttendance 
  ON NewEmployee.EmployeeID = NewTimeAttendance.EmployeeID
   and (month=1 or month =2 or month = 3)
GROUP BY NewEmployee.EmployeeID, EmployeeName
"
20209,SQL self referencing query,"SELECT Memberships.*
FROM Memberships
INNER JOIN MembershipControls ON Memberships.group_id = MembershipControls.group_id
WHERE Memberships.user_id = 1
AND Memberships.group_id NOT IN
(
  SELECT MembershipControls.group_id
  FROM GROUPS
  INNER JOIN Memberships ON Groups.id = Memberships.group_id
  INNER JOIN MembershipControls ON Memberships.group_id = MembershipControls.criteria_id
  WHERE Memberships.user_id = 1
  GROUP BY MembershipControls.group_id
)
"
4899,Is it possible to rename a joined column during an inner join?,"select d.Name as DogName, o.Name
from Dog d
inner join Owner o on d.OwnerID = o.OwnerID
"
2143,Count items and create an array,"SELECT a, array_agg(bs) AS b_list
FROM  (
    SELECT a, b || ':' || count(*) AS bs  -- coerced to text automatically
    FROM   tbl
    GROUP  BY a, b
    ORDER  BY a, b   -- to sort b_list in the result
    ) x
GROUP  BY a;
"
14506,SQL Query (Like) Trying to find Titles with AND,"SELECT NAME FROM TABLE WHERE NAME LIKE '% and %'
"
38732,SQL update based on value from other table,"Update TableB
Set IsValid = 0
From TableA as A INNER JOIN TableB as B
                      ON A.TableBNo = B.TableBNo And IsGood = 1
                 INNER JOIN TableBChild as BC
                       ON B.TableBID = BC.TableBID
AND BC.MEMBERID NOT IN ( SELECT MemberID from Member Where MemberNo = A.MemberNo )
"
14362,using order by for month with year,"select Column1
from YourTable
order by convert(datetime, left(Column1, 3)+' 01, '+right(Column1, 4), 107)
"
4047,TSQL Recursive Query Update Temp Table,"update t
set t.totalCount = a.count(*) - 1
from a
join @temp t
    on a.Direct = t.QID
group by a.direct, t.QID
option (maxrecursion 10)
"
1316,Returning a value from a stored procedure,"CREATE PROC ... 
    @PropertyID int OUTPUT
AS
...

select @PropertyID = SCOPE_IDENTITY() as 'MemberPropertyID'; (if it is a new property)
...
select @PropertyID = MemberPropertyID as 'MemberPropertyID'; (if it is an existing property)
from blah blah blah
...
GO

EXEC [import].[spInsertIntoTblMemberProperties] @PropertyID OUTPUT
"
34769,SQL query for Inner Join with Select,"SELECT 
      f.feature_id, 
      f.feature_name 
FROM  tbl_feature f 
LEFT JOIN (SELECT * FROM tbl_feature_and_profile fp WHERE fp.profile_id= ? ) 
     as fp ON (f.feature_id = fp.feature_id AND f.package_id = fp.package_id) 
WHERE 
     fp.feature_id IS NULL  AND f.package_id = ? ORDER BY f.feature_id
"
31797,Trigger that will now allow any operation on a table on particular days in PostgreSql,"CREATE FUNCTION check_sunday() RETURNS trigger AS $$
    BEGIN
        IF EXTRACT(DOW FROM NOW()) = 0 THEN
            RAISE EXCEPTION 'You cannot do this on Sunday!';
        END IF;
        RETURN NEW;
    END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER foo_trigger ON foo
BEFORE INSERT EXECUTE PROCEDURE check_sunday();
"
7418,oracle sql query statement NVL not working as desired,"SELECT NVL2( m.first_name ||m.last_name , m.first_name || ' ' || m.last_name, 'No One' )
   || ' supervises '
   || w.first_name
   || ' '
   || w.last_name FROM employees w, employees m WHERE w.manager_id = m.employee_id(+);
"
36795,MySQL: Order of query based on before rows,"select name
from (
 select insuredid, name, 0 ins
 from insured
 union all
 select insuredid, name, 1 ins
 from  accompany) isq
order by insuredid, ins
"
15157,How to list every accounts information and sum in sql without using a loop,"select
  account.accountNo,
  count(1) as number_of_events,
  sum(case when event.amount > 0 then event.amount else 0 end) as deposits,
  sum(case when event.amount < 0 then event.amount else 0 end) as withdrawals,
  sum(event.amount) as sum_deposits_withdrawals
from
  account
inner join
  event on
  event.accountNo = account.accountNo
group by
  account.accountNo
"
37120,How to get count of records added since the start of the current month,"SELECT COUNT(*)
FROM ws_account_log
WHERE
      account_log_account_id='1'
  AND account_log_timestamp >= SUBDATE(CURDATE(), DAYOFMONTH(CURDATE())-1)
"
18546,DISTINCT WITH SUM,"SELECT ID, Name, SUM(Score), SomeID
FROM tableA 
GROUP BY ID, Name, SomeID;
"
24836,Issue with Sql query: count distinct row values relative to other row value,"Select e.name, e.category, e.posts from exampletable e
where e.name not in
(select e1.name from exampletable e1 where e.name = e1.name and e.category <> e1.category) 
and e.category = '01'
"
20760,How can i display records from one table where the number of outputed records depend on another table,"select * from Vehicle v
where not exists (
    select 1 from Booking 
    where regNo = v.regNo
      and date_from <= '2015-04-05'
      and date_to   >= '2015-03-25' 
    )
"
24076,How to select multiple rows filled with constants?,"SELECT 1, 2, 3
UNION ALL SELECT 4, 5, 6
UNION ALL SELECT 7, 8, 9
"
12075,PL SQL Retrieve maximum version number,"select msg_id, max(""version number"")
from yourtable
group  by msg_id
"
15137,Find tables name in multi-part identifier,"SELECT [name]
FROM DatabaseOne.sys.tables t
INNER JOIN sys.schemas s
    ON s.schema_id = t.schema_id
WHERE s.name = 'MySchema'
ORDER BY [name]
"
22924,SQL order by two columns,"SELECT   colum1, column2
FROM     my_table
ORDER BY column1 ASC, column2 ASC
"
22915,Entity framework getting around unsupported methods,"using System.Data.EntityClient;

EntityConnection conn = new EntityConnection(myContext.Connection.ConnectionString);
conn.Open();
EntityCommand cmd = conn.CreateCommand();
cmd.CommandText = @""Select SqlServer.Power(t.MyValue, 2) From MyEntities.MyTable As t"";
var result = cmd.ExecuteReader(System.Data.CommandBehavior.SequentialAccess);
result.Read();
var valuePower2 = result.GetValue(0);
conn.Close();
"
20655,Select from 3 tables with one-to-many relation,"select
a.title,
a.content,
a.date,
group_concat(t.name) as name
from tags_in_news tin
inner join article a on a.id = tin.news_id
inner join tags t on t.id = tin.tag_id
group by a.id
"
3747,How to Count total Medal of Sports,"SELECT      STATE,
            SUM(Point) AS MEDAL,
            SUM(CASE WHEN Point = 7 THEN 1 ELSE 0 END) AS GoldCount,
            SUM(CASE WHEN Point = 5 THEN 1 ELSE 0 END) AS SilverCount,
            SUM(CASE WHEN Point = 4 THEN 1 ELSE 0 END) AS BronzeCount

FROM        [Sheet2$]

GROUP BY    STATE 

ORDER BY    SUM(Point) DESC
"
4570,MySQL with all and blank counts,"SELECT `emp_dept`, 
COUNT(*) AS 'DEPT_COUNT', 
SUM(IF(`emp_assessment_data` = '', 1, 0)) as 'BLANK_EMP_ASSESSMENT_COUNT' 
FROM `employee_master` GROUP BY `emp_dept`
"
27200,Don't return any result if the precedent query has at least 1 result?,"select t1.* 
   from 
      ( select if( count(*) > 0, 1, 2 ) IncludeType
           from tbl t2
           where t2.type = 1 ) preCheck,
      tbl t1
   where 
      t1.type = preCheck.IncludeType
"
22906,Computed Column -- Comma separated after checking NULL,"Coalesce(A+',','')+Coalesce(B+',','')+Coalesce(C,'')
"
35661,I want to write following query rails way,"User.select(""users.firstname"").includes(:members => [{:member_roles => :role}]).where(""roles.name"" => ""Project Coordinator"")
"
22524,SQL most recent using row_number() over partition,"SELECT user_id, page_name, recent_click
FROM (
  SELECT user_id,
         page_name,
         row_number() over (partition by session_id order by ts desc) as recent_click
  from clicks_data
) T
WHERE recent_click = 1
"
2244,How to run a query across three tables in MySQL using Joins?,"SELECT s.* 
FROM   grades g 
       JOIN module m 
         ON m.moduleid = g.moduleid 
       JOIN student s 
         ON s.studentid = g.studentid 
WHERE  g.studentid LIKE '10%' 
       AND g.grade = 'B' 
       AND m.modulename = 'Intelligent Systems' 
"
34355,SQL: cascade UNION and JOIN,"SELECT
    *
FROM
    TABLE_3
    LEFT JOIN
    (
    SELECT ID_1, name_1, surname_1, FROM T_ONE
    UNION --ALL would be more efficient if results do not overlap, as van's comment said
    SELECT ID_2, name_2, surname_2 FROM TABLE_2
    ) foo  ON TABLE_3.ID_3 = foo.ID_1
"
28891,Calculate columnwise total for dynamic columns in SQL Server,"   SET @sql = '

   SELECT *
   FROM (SELECT [NAMES], logdate, [worked time], [Total Time] 
         FROM tmp_phys_table 
         GROUP BY NAMES,LOGDATE,[WORKED TIME], [Total Time]
         ) AS [SubTable] 
   PIVOT
   (
    MAX([worked time])
             FOR [logdate] IN ([' + @docDates + '])
       ) AS [Pivot] ;';
"
19054,Can a many-to-many join table have more than two columns?,"Team_Id
Position_Code
Member_Id
Start_Date
End_Date NULLABLE
"
28802,Better way of performing dynamic conditional searching in TSQL?,"SELECT x.*
FROM   x
WHERE  (x.id = @NameFilter
OR     @NameFilter is null)
AND    (x.typeId = @typeFilter
OR     -1 =  @typeFilter)
AND    (x.date = @date
OR     @date is null)
AND    (x.someStingType = @someStringType
Or     '' = @someStringType)
"
10042,sql select statement select sum where,"SUM(CASE WHEN condition_1=1 THEN sum_value ELSE 0 END) AS 1_amt
"
34875,Replace Number in Row with Description When Running SELECT Query,"SELECT t1.USERNAME, t2.REGION_DESC
    FROM table1 t1
        INNER JOIN table2 t2
            ON t1.REGION = t2.REGION_ID;
"
7905,Suggest appropriate mysql date function,"SELECT DATE('2013-01-10 05:10:50') <= CURDATE() FROM DUAL;

SELECT '2013-01-10 05:10:50' <= DATE_FORMAT(NOW(), '%Y-%m-%d 23:59:59') FROM DUAL;
"
21166,Postgres 9.2 PL/pgSQL simple update in loop,"with new_numbers as (
   select id,  
          trail_id,
          row_number() over (partition by trail_id order by id) as position
   from photos
)
update photos
  set position = nn.position
from new_numbers nn
where nn.id = photos.id;
"
26833,MySQL grouping with search criteria,"SELECT f.name
FROM files as f
INNER JOIN (SELECT file_id
            FROM files_tags_associations
            WHERE tag_id IN (3,5)
            GROUP BY file_id
            HAVING COUNT(*) = 2) as ft
    ON f.file_id = ft.file_id
"
9968,How to apply md5 function to field in django orm?,"import hashlib
myModel(models.Model):
    field = models.CharField(max_length=30)
    field_md5 = models.CharField(max_length=16, editable = false )

    def save(self, *args, **kwargs):        
        self.field_md5 = hashlib.md5.new(self.field).digest()
        super(Model, self).save(*args, **kwargs)
"
28636,"MySQL join headaches, please help!","  SELECT snu.scenid,
         sn.side,
         ubd.nation,
         ubd.name
    FROM UNIT_BASIC_DATA ubd
    JOIN SCENARIO_NEEDUNITS snu ON snu.unitid = ubd.unitid
                               AND snu.scenid = ?
    JOIN SCENARIO_NATIONS sn ON sn.scenid = snu.scenid
ORDER BY snu.scenid, sn.side, ubd.nation, ubd.name
"
34601,mysql: how do i get a list of databases available?,"show databases;
"
3104,Get information from another table with JOIN,"SELECT ca.id_imdb AS IMDb_ID
, caat.id_collection AS collection_ID
, ca.data_name AS actors_name
FROM collection_actors AS ca
INNER JOIN collection_actors_assignedto AS caat ON ca.id_imdb = caat.id_collection
WHERE caat.id_collection = 'tt1104001'
"
4538,MS Access Rounding issue,"SELECT
    Format(IIf(saleprice Is Null, productprice, saleprice), '#') AS reward_price
FROM YourTable;
"
30025,How to convert SQL column null value to 0 and varchar to decimal in sql query,"SELECT 
    COALESCE(CAST(debit as DECIMAL(9,2)),0) as debit,
    COALESCE(CAST(credit as DECIMAL(9,2)),0) as credit,
    sum_accname,
    sum_date, 
    sum_description
FROM 
    sum_balance
"
29627,SQL Server - how to select x number of task per x number of workers,"select WorkerID, TaskID
FROM (
    SELECT Workers.WorkerID, Tasks.TaskID, 
        row_number() over (partition by Workers.WorkerID order by Tasks.TaskID) AS rn
    FROM Workers
    LEFT JOIN Tasks ON Workers.WorkerID = Tasks.WorkerID 
    WHERE Workers.WorkerName LIKE '%Browne%'
) where rn <= 4
"
16709,SQL using NOT EXISTS and LEFT OUTER JOIN,"select * from  Reports rpt
left join InsurancePlan Ip
on IP.PlanName  = rpt.PlanId
Where rpt.[Account] = 'Pharmacy'
and (rpt.Code = 3 or Ip.PlanName is null)
"
18070,How to write custom object to database when app crashes?,"    Thread.setDefaultUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler()
    {
        @Override
        public void uncaughtException(Thread thread, Throwable ex)
        {
            // Insert your code here
        }
    });
"
2921,Deleting from a database map,"DELETE FROM MAP WHERE ItemID = @MyItem1Id
                AND CatID <> @MyCat2Id
"
23023,ORACLE SDO_GEOMETRY ToString()?,"SELECT c.shape.Get_WKT()
  FROM cola_markets c WHERE c.name = 'cola_b';

C.SHAPE.GET_WKT()                                                               
--------------------------------------------------------------------------------
POLYGON ((5.0 1.0, 8.0 1.0, 8.0 6.0, 5.0 7.0, 5.0 1.0)) 
"
6495,SQL Validation on insert - only allow one or another column to be populated,"ALTER TABLE MyTable WITH CHECK ADD
   CONSTRAINT CK_Mytable_ABSorPercent
          CHECK (ABSValue IS NULL OR PercentValue IS NULL)
"
17458,how to retrieve all data from joining table using parent key,"select u.FirstName, u.LastName, up.PostStatus
from UserPosts as up
    inner join Users as u on u.UserID = up.UserID
where
    up.UserID = @UserID or
    exists (
        select *
        from Followers as f
        where f.FollowerID = up.UserID and f.UserID = @UserID
    )
"
14589,Query to find mutual likes?,"SELECT p.p1, p.p2
FROM Likes p
    INNER JOIN Likes p2 ON 
        p.p1=p2.p2 AND 
        p.p2=p2.p1 AND 
        p.p1<p2.p1
"
5684,sqlplus statement from command line,"sqlplus -s /nolog <<EOF
connect user/pass
select blah;
quit
EOF
"
18140,continue statement in pl/SQl?,"loop
   if something then
      goto continue_label;
   end if;
   ...
   <<continue_label>> null;
end loop;
"
18068,SQL Server 2008 Collation conflict - how to resolve?,"select AH_NAME1 COLLATE DATABASE_DEFAULT from GGIMAIN.SYSADM.BW_AUFTR_KOPF
union
select AH_NAME1 COLLATE DATABASE_DEFAULT from GGI2014.SYSADM.BW_AUFTR_KOPF
"
17929,"TSQL, How can I group rows?","select
contact,
max(phone),
max(address),
max(email)
from table_name
group by contact
"
629,SQL query JOIN is greyed out and 3rd table is blank,"SELECT a.NAME
,(CASE 
        WHEN a.TIME = b.schedule
            THEN 0
        ELSE 1
  END ) AS number
 INTO C
FROM a
INNER JOIN b
 on substring(a.Name,1,CHARINDEX(';',a.Name)) = substring(b.Name,1,CHARINDEX(';',b.Name))
"
39810,MySQL select SUM with conditional to change the sign of the column being summed,"SELECT 
    IF(buyerID = 100, sellerID, buyerID) AS other_company,
    SUM(IF(buyerID = 100, transactionAmount, transactionAmount * -1)) AS netSum
FROM transactions
WHERE 100 IN (buyerID, sellerID)
GROUP BY other_company
ORDER BY netSum DESC
LIMIT 1
"
13229,MySQL: how to select many results from linked table at one row to another?," SELECT o.id_org, o.org_name, GROUP_CONCAT(concat(s.id_staff, ' ', s.staff_name) ORDER BY s.id_staff SEPARATOR ' ')
 FROM Organizations o, staff s
 WHERE s.id_org = o.id_org
 GROUP BY id_org, org_name;
"
32308,How can I do a MATCH AGAINST with a FULLINDEX against two or more columns in MySQL?,"ALTER TABLE pin ADD FULLTEXT(title, front);

SELECT *
FROM   pin
WHERE  MATCH(title, front) AGAINST ('+red +yellow +blue' IN BOOLEAN MODE);
"
19811,Aggregate Results According to Another Column,"SELECT COUNT(*), EXTRACT(year from DAY_DATE)
FROM ( INNER_SELECT_QUERY )
GROUP BY EXTRACT(year from DAY_DATE) ;
"
8207,SQL Check for duplicated userid within EACH TABLE,"insert into table3(userid,issue) 
select t2.userid, 'dup user id'from table1 t1 join table2 t2
where t1.userid = t2.userid
"
37527,SQL Sorting with Two Joined Tables,"SELECT p.id, p.name, MAX(a.date_answered)
FROM people p
LEFT JOIN answer_sheets a on p.id = a.personID
GROUP BY p.id, p.name
ORDER BY MAX(date_answered) ASC
"
25373,SQL Server scalar function with table,"select t.*,
       dbo.getMinutesWork(StartDate, EndDate)
from table t;
"
23167,Get the string before substring using sql?,"DECLARE @str VARCHAR(100) = '025-121-3453'

SELECT  LEFT(@str, CHARINDEX('121', @str) - 1) ,
        RIGHT(@str, CHARINDEX('121', REVERSE(@str)) - 1)
"
25928,How to use GROUP BY on a CLOB column with Oracle?,"    SELECT TABLE_A.ID,
       TABLE_A.VA,
       B.TRACE
FROM
(SELECT A.T_ID ID,
          MAX(A.V) VA
   FROM BDD.LOG A
   GROUP BY A.T_ID HAVING MAX(A.V) <= '1.00') TABLE_A,
                                                                BDD.T B
WHERE TABLE_A.ID = B.T_id;
"
27833,Cascading deletes like ON DELETE CASCADE for a one time operation in MySQL,"DELETE a, b, c, d
FROM a
  LEFT JOIN b  ON  b.a_id = a.a_id
  LEFT JOIN c  ON  c.a_id = a.a_id
  LEFT JOIN d  ON  d.b_id = b.b_id 
WHERE
    a.a_id = 1 ;
"
21862,Calculate Weighted Average in sql for duplicate items,"SELECT ITEMNAME, ITEMSKU, SUM(QUANT), SUM(QUANT * ITEM_LANDING) / SUM(QUANT)
FROM <YourTable>
GROUP BY ITEMNAME, ITEMSKU
"
35971,SQL : Conditional result used in the same conditional outputs,"SELECT column10, COALESCE(
   (SELECT columnName10 
   FROM OtherExampleTable WHERE id=15), 'nothing') 
FROM ExampleTable;
"
27953,sql table update problem,"update ob
set address = address_table.addr
where ob.name = address_table.dname
"
29881,To find a solution to the problem with LEFT JOIN's IN in SQL,"SELECT questions.title, questions.question_id, tags.tag
FROM questions
LEFT JOIN tags
ON questions.question_id = tags.question_id
WHERE questions.question_id = 14
ORDER BY was_sent_at_time
DESC LIMIT 50;
"
4911,Best method of organizing database?,"SELECT 
 * 
FROM 
  CLASSES 
JOIN 
  SUBJECTS_PER_CLASS 
ON 
  CLASSES.ID = SUBJECTS_PER_CLASS.class_id
JOIN 
  Subjects 
ON 
  Subjects.id = SUBJECTS_PER_CLASS.mat_id
"
21620,.NET MVC check if query is not null and show partial view,"if(membership.Any()){...}
"
13747,Need to display records by joining two tables and the records should be Unique,"SELECT t.id, s.firstname,s.lastname, t.effort 
FROM taskeffort t 
LEFT OUTER JOIN student s ON s.studentid = t.studentid 
WHERE t.id = 4;
"
14185,SAS create a flag in table1 if variable is present in table2," data want ;
   merge table1(in=in1) table2(in=in2);
   by class student course;
   if in1 ;
   flag=in2;
 run;
"
31431,Heroku - SQL query return difference results on localhost and heroku,"db=# select current_date - interval '15' year;
      ?column?       
---------------------
 1997-04-26 00:00:00

db=# select current_date - interval '15'
        years        
---------------------
 2012-04-25 23:59:45

db=# select current_date - interval '15 year';
      ?column?       
---------------------
 1997-04-26 00:00:00
"
23146,Select only the YEAR from DATE?,"SELECT * FROM EMPLOYEE_T WHERE EXTRACT (YEAR FROM EmployeeDateHired) = 1999
"
7090,Reputation Formula - Best Approach,"function calc_rep (i_comments in number, i_posts in number, i_ratings in number,
                  i_followers in number, i_following in number, i_badges in number,
                  i_connections in number) return number deterministic is
...
end calc_rep;

function get_rep_for_user (i_user_id in number) is
  v_comments ....
begin
  select .....
  calc_rep (v_comments...)
end get_rep_for_user;
"
12220,SQL Query with Optional Parameter and Possible Null Column,"select id, customername
from customertable
where (referredby = @referredby OR @referredby is null)
"
26039,retrieve data from movie database,"select max(c.character_name) character_name,
       max(a.name) || ' ' || max(a.surname) actor,
       group_concat(distinct m.title) other_movies
from cast c
join actors a on c.actor_id = a.actor_id
left join cast omc on c.actor_id = omc.actor_id and c.movie_id <> omc.movie_id
left join movies m on omc.movie_id = m.movie_id
where c.movie_id = ?
group by a.actor_id
"
5455,sql query for merging two tables and then applying count,"select paper_author.author_id,
       count(distinct paper_data.paper_year) as distinct_paper_year_count
from paper_author
  join paper_data on paper_author.paper_id = paper_data.paper_id
group by paper_author.author_id
"
30721,DESCRIPTION' is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause,"INSERT INTO myTable2 (ID,INDEX,STATUS,DESCRIPTION,TS)
SELECT ID,min(INDEX),STATUS,DESCRIPTION,min(TS) from myTable2 t1top
WHERE (EXISTS(
    SELECT * FROM myTable1 WHERE ID=t1top.ID AND STATUS='Completed' )) 
GROUP BY ID, STATUS, DESCRIPTION
ORDER BY ID  DESC, STATUS DESC
"
33871,find rank of a student in a table that its contained students point,"SELECT * from
(Select username ,average,[fname],[lname],point, 
 Rank() over(order by point desc) as  'ranking' 
 from karbar order by point desc) t
WHERE username=@username
"
38246,How can i use INSERT as subquery in SELECT statement in sqlite?,"INSERT INTO table1(name) VALUES('value_abcd');
SELECT last_insert_rowid();
"
15127,Getting MIN date,"select
  a.ID,
  a.DATE,
  b.name,
  c.price
FROM tablea a 
INNER JOIN
(
   SELECT Id, MIN(Date) AS MinDate 
   FROM tablea
   GROUP BY Id
) As minA ON a.date = mina.mindate AND a.id = mina.id
inner join tableb b on a.ID = b.ID
inner join tablec c b.ID = c.ID
"
29335,One-off Read-only SQL Statement Verification in MySQL 5.5?,"START TRANSACTION READ ONLY;
"
34589,How can I update multiple tables via a trigger when updating a column in one table?,"CREATE OR REPLACE TRIGGER COSO_BT
 BEFORE UPDATE
 ON BASE_INFORMATION REFERENCING NEW AS NEW OLD AS OLD
 FOR EACH ROW
BEGIN
    if :new.balance != :old.balance
      then 
            update USER_TABLE
               set balance = :new.balance
             where account_no = :new.account_no;
    end if;

END;
/
"
26702,Do databases always lock non-existent rows after a query or update?,"-- BAD! DO NOT DO THIS! --
insert customer (email, count) 
select 'foo@example.com', 0
where not exists (
      select 1 from customer
      where email = 'foo@example.com'
)
"
35861,Mysql: Confused about query joining two tables,"select s.`OrderID`
from `Shipment` s
join `Warehouse` w on w.`WarehouseID` = s.`WarehouseID`
where w.`WCity` = 'new york';
"
35395,SQL : select distinct of one column while ignoring other columns,"select id, min(keyid) from tbl group by id
"
15589,RegEx for capturing table names and aliases from a SQL Statement,"(?i)\bJOIN\s+([\w.]+)(?:\s+(?!ON\b)(\w+))?
"
5910,MYSQL - How to UPDATE after SELECT from a table,"UPDATE dvd_copies
SET your_column_to_update ='your value'
WHERE id_dvd = '001-192.168.1.103-6' AND id_toko='002'
ORDER BY id_copies DESC
LIMIT 2
"
20843,Basic SQL query question,"SELECT     
  Base.ReportDate, 
  Base.PropertyCode, 
  Base.FirstName, 
  Base.MiddleName, 
  Base.LastName, 
  Person.FirstName, 
  Person.MiddleName, 
  Person.LastName
FROM  Base
LEFT JOIN (
    SELECT LeaseID, MIN(TenantID) AS [TenantID]
    FROM LeaseT
    GROUP BY LeaseID) AS [LeaseT_SinglePerson] ON Base.LeaseID = [LeaseT_SinglePerson].LeaseID
LEFT JOIN Person ON [LeaseT_SinglePerson].TenantID = Person.ID
"
18333,MySQL Group_Concat Distinct By Id,"SELECT GROUP_CONCAT(VALUE)
FROM
(
    SELECT DISTINCT ID, VALUE
    FROM TableName
) a
"
28848,Group values by month in Access,"SELECT Format([Mese],""mmmm"") + "" "" + Format([Mese],""yyyy"") AS [Date], Sum(Manodopera.Costo_Totale) AS SumOfCosto_Totale
FROM Manodopera
GROUP BY Format([Mese],""mmmm"")+"" ""+Format([Mese],""yyyy"");
"
32622,MySQL Ignore NULL results after first occurrence,"SELECT * FROM
(SELECT * FROM `lastviewed` WHERE `user_id` = 266 AND record_id IS NOT NULL 
UNION
SELECT * FROM `lastviewed` WHERE product_id NOT IN
(SELECT product_id FROM `lastviewed` WHERE record_id IS NOT NULL GROUP BY product_id)
) AS q1 
GROUP BY product_id, record_id
ORDER BY `lastviewed` DESC 
LIMIT 4;
"
17741,Get Bookings from current date when using Date from - Date To,"SELECT *
FROM < YOUR_TABLE >
WHERE cast(Date_From AS DATE) < = cast(CURRENT_TIMESTAMP AS DATE)
    AND cast(Date_To AS DATE) >= cast(CURRENT_TIMESTAMP AS DATE)
"
3122,Joining on variables with two different formats,"select...
from X
join Y on X.year_of_birth = substr(Y.date_of_birth, length(Y.date_of_birth)-3,4)
"
36822,Return a substring from a field in SQL,"SELECT ID, SUBSTRING(content, PATINDEX('%CTid%', content) + 5, PATINDEX('%[^0-9]%', SUBSTRING(content, PATINDEX('%CTid%', content) + 5, 12)) - 1) AS CTid       
FROM ARTICLES
WHERE content LIKE '%CTid%'
"
3534,Determine if month of date falls on a quarter of date,"(mod(EXTRACT(MONTH FROM SYSDATE()), 3)) = (mod(EXTRACT(MONTH FROM <input date>), 3))
"
2078,Displaying both duplicate and non-duplicate values with some condition,"WITH CTE AS
(
   SELECT Code, Name, Code2,
      RN = ROW_NUMBER() OVER (PARTITION BY Code, Name ORDER BY Code2)
   FROM dbo.TableName
   WHERE ....
)
SELECT 
    CASE WHEN RN > 1 THEN '' ELSE Code END AS Code, 
    CASE WHEN RN > 1 THEN '' ELSE Name END AS Name, 
    Code2
FROM CTE
"
16984,Combining two Postgresql similar tables located on two different machines,"delete from yourtablename2 where id in (select id from yourtablename)

insert into yourtablename 
select * from yourtablename2

drop table yourtablename2
"
23552,select count(*) with left join,"SELECT 
  COUNT(IFNULL(cp.Procuct_id,0)) AS summe 
FROM
  feeds 
  LEFT JOIN cat_product cp 
    ON cp.product_id = feeds.productid 
WHERE 1 = 1 
  AND cp.price BETWEEN 950 
  AND 1450 
  AND cp.ram_cap BETWEEN 5 
  AND 11 
  AND feeds.tdcategoryname LIKE '%Laptop%' 
  AND feeds.brand IN ('Dell', 'Lenovo', 'Acer', 'Asus') 
"
8638,MySQL find duplicate rows between certain days,"select *
from tickets t1
join tickets t2 on
    t1.id <> t2.id
    and t1.operator_id = t2.operator_id
    and t1.product_id = t2.product_id
    and ABS(DATEDIFF(t1.created_timestamp, t2.created_timestamp)) <= 2
;
"
7435,sql query to get data from two tables,"SELECT movie_name
FROM table1
JOIN table2 USING (movie_id)
WHERE movie_genre = 'some_genre'
"
12123,Access DataSource in groovy class in grails dynamically,"import org.springframework.context.*

class MyService implements ApplicationContextAware {
  ApplicationContext  applicationContext

  ...

  def getDataSource( name ) {
    applicationContext.getBean( name )
  }

  ...
}
"
24116,Oracle SQL - Maximum from two select statements,"SELECT MAX(SALARY) FROM TABLE1 WHERE ROLE = 'MANAGER' OR ROLE = 'DEVELOPER'
"
30723,Django complex Query through database API,"profile = EnterpriseProfile.objects.get(pk=1)  # or whatever to get the object
# next returns all users related to that enterprise in the M2M
profile.enterprise.users.all()  
"
1959,How to join two table in SQL like this?,"select 
    number_of_day, [0-1000], [1000-5000], [5000-15000] 
from 
(
    select number_of_day, concat(min_amount,'-', max_amount) range, rate 
    from master join detail on detail.repo_rate_master_id = master.id
) x 
pivot 
(
    max(rate) for range in ([0-1000], [1000-5000], [5000-15000])
) p 
"
26185,SQL: Best approach to Select and Insert from multiple tables,"SELECT ...
FROM lookup l JOIN table15 t ON l.zipcode = t.zipcode
WHERE l.tableID = 15
"
38252,Incrementing counter on each duplicate in column,"SELECT 
  t.*, 
  @i:=IF(id=@id, @i+1, 1) AS num, 
  @id:=id 
FROM 
  t 
  CROSS JOIN (SELECT @i:=0, @id:=0) AS init 
ORDER BY id
"
23729,How to find unused tables in SQL Server,"SELECT *
FROM sys.dm_db_index_usage_stats
WHERE [database_id] = DB_ID() 
    AND [object_id] = OBJECT_ID('TableName')
"
29562,compiling invalid oracle procedures,"CREATE OR REPLACE PROCEDURE proc_main AS
BEGIN

   EXECUTE IMMEDIATE 'BEGIN proc_child1; END;';

   EXECUTE IMMEDIATE 'BEGIN proc_child2; END;';

   EXECUTE IMMEDIATE 'BEGIN proc_child3; END;';

   proc_compile_invalids;  -- This invokes 
                           -- ""alter procedure <procedure_name> compile"" 
                           -- statement for all the invalids.

END;
"
3206,Set auto-increment field on Oracle select sql statement,"SELECT *, ROW_NUMBER() OVER(PARTITION BY ... ORDER BY ... ) AS rn
FROM your_tab
"
22976,optimizing the DELETE statement with a count,"declare @batchSize int = 10000;
do while(1=1)
begin
   delete top(@batchSize) from ProductInfo where productId = @productId;
   if (0 = @@rowcount)
      break;
end
"
23957,How to join 3 tables and get sum from result of individual joins?,"select users.user_id,l.login,p.points from users
inner join (select user_id, count(1) login from login
       group by login) as l on users.user_id=login.user_id
inner join (select user_id, sum(point) as point 
        from point group by user_id ) as p on users.user_id=point.user_id
"
27464,Microsoft SQL Server : max records in a column,"SELECT table.*
FROM dbo.X table
WHERE row_numbers IN (SELECT MAX(row_numbers) FROM dbo.X)
"
8458,How to connect an existing SQL Server login to an existing SQL Server database user of same name,"ALTER USER OrphanUser WITH LOGIN = correctedLoginName
"
37948,SQL detecting partially duplicated rows,"SELECT ID
    FROM YourTable
    WHERE X IN ('YES', 'NO')
    GROUP BY ID
    HAVING COUNT(DISTINCT X) = 2
"
11462,Query for Count on coulmns by condition with Group BY,"select
id,
count(id) as cnt,
sum(if(now() - interval 7 day <= dated_on,1,0)) as lastweek
from table
group by id
"
33221,SQLite: Calculate col based on the result of other Calculated Col,"SELECT a, a+1 AS b, (a+1)*2 AS c FROM test
"
36410,Return Values from one table that have no entries in another?,"select CompanyName
from tblCompany
left join tblInvoice on tblCompany.CompanyID = tblInvoice.CompanyID 
where tblInvoice.CompanyID is null
"
22324,Is it possible to perform a bitwise group function?,"SELECT user_id, BIT_OR(permissions) as all_perms
FROM permissions
GROUP BY user_id
"
19802,SQL: Joining on max value,"SELECT a.Id,a.Value,a.Year,MAX(b.Value)
FROM tableA A
JOIN tableB B ON A.Year = b.Year AND b.Value < A.Value
GROUP BY a.Id,a.Value,a.Year
"
38454,Saving data to a table then retrieving the autonumber to save to another table,"Option Compare Database
Option Explicit

Sub test()
Dim cdb As DAO.Database, rst As DAO.Recordset, newID As Long
Set cdb = CurrentDb
cdb.Execute ""INSERT INTO Users (Email) VALUES (""""gord@example.com"""")"", dbFailOnError
Set rst = cdb.OpenRecordset(""SELECT @@IDENTITY"", dbOpenSnapshot)
newID = rst(0).Value
rst.Close
Set rst = Nothing
Set cdb = Nothing
Debug.Print newID
End Sub
"
2149,Ignore rows which contain a hyphen in MySQL,"SELECT *
FROM   TableName
WHERE  words NOT LIKE '%-%'
"
4325,SQL filter based on data in multiple rows,"SELECT title_code, product_number, format_code
FROM {table} 
WHERE format_code = 'OC'
AND   title_code NOT IN ( SELECT title_code 
                          FROM  {table}
                          WHERE format_code = 'HB' 
                          OR    format_code = 'PB'
                        );
"
3102,How do I make a cross table select in SQL?,"SELECT SellerID FROM SALES
GROUP BY SellerID, GoodsID
HAVING COUNT(ProjectID) = SELECT count(ProjectID) FROM Projects
"
31016,sql select only when there is two way relationship for user,"SELECT f1.asked_user_id AS friend_id
FROM friends AS f1 JOIN friends AS f2
    ON f1.asked_user_id = f2.asker_user_id
   AND f1.asker_user_id = f2.asked_user_id
WHERE f1.status = 1 AND f2.status = 1
"
1213,SQL how to update left joined tables?," UPDATE alldistros SET name=""CatMan"" WHERE name = ""Absolute Linux""
"
6810,Something like reference counting or shared pointers for database rows?,"DELETE FROM filepaths fp
WHERE NOT EXISTS ( SELECT * FROM events ev where ev.file_id = fp.file_id)
AND NOT EXISTS (SELECT * FROM events_version_xxx ev where ev.file_id = fp.file_id)
AND NOT EXISTS (SELECT * FROM events_version_yyy ev where ev.file_id = fp.file_id)
...
;
"
5761,Returning all values in another table that matches one linked value in another,"SELECT c.Car, m.Model_ID, m.Model
FROM Models m
INNER JOIN Cars c ON c.Car_ID = M.Car_ID
WHERE m.Car_ID = (SELECT Car_ID FROM Models WHERE Model = 'Escort');
"
1106,Pulling multiple tables with MySQL,"SELECT 
  c.SetID
  , s.SetName
  , b.BName 
  , count(*) as TotalCards
  , sum(if(c.rarity = 1,1,0) as Total_of_Rarity_1
  , sum(if(c.rarity = 2,1,0) as Total_of_Rarity_2
FROM card c
INNER JOIN `set` s ON (s.SetID = c.SetID)
INNER JOIN b on (b.BID = s.BID)
GROUP BY c.SetID
"
13914,Insert from Select except specific column(s) in Oracle,"insert into yourTable (col1, col2, col3)
select col1, col2, 'diffValue'
  from someTable
 where SomePK = SomeVal;
"
19295,Return first character SQL Derby,"select substr(table.column,1,1) 
from table
order by table.column
"
9978,Adding table to existing database in SQL,"    use [NorthWind]
    go

    CREATE TABLE Persons
    (
    PersonID int,
    LastName varchar(255),
    FirstName varchar(255),
    Address varchar(255),
    City varchar(255)
    );
"
9677,Select users who do not answer a survey yet,"select * from user where id not in (select user_id from questionnaire_self)
"
4551,Doing two COUNT on a single column without using views in one sql statement or in pl/sql block,"    SELECT student_idstudent,
    count(CASE WHEN  status = 'Present'  then 1 END)/count(*)*100 as percentage
    FROM attendence 
    where student_subject_subjectid = 102
    group by student_idstudent;
"
35118,Splitting flat file rows to multiple flat files SSIS,"int val = Convert.ToInt32(Dts.Variables[""Counter""].Value);
Dts.Connections[""destinationConnectionName""].ConnectionString = ""c:\\yourpath\\"" + val.ToString() + "".txt"";
"
8625,Nested SQL Server Query Max Date,"select 
    * 
from 
    VIEW c 
    INNER JOIN 
    ( 
        SELECT 
            Category, 
            MAX(UploadDate) as maxuploaddate  
        FROM 
            View 
        GROUP BY 
            Category
    ) temp ON temp.Category = c.Category AND UploadDate = temp.maxuploaddate 
"
7555,check if a value exists in array of constants in oracle,"if v_type IN ('ABC','DEF','ASD') then
  do things;
end if;
"
16480,SQL query logging for SQLite?,"void *sqlite3_trace(sqlite3*, void(*xTrace)(void*,const char*), void*);
"
27982,How can I build my SQL query from these tables?,"SELECT ... FROM Table1
INNER JOIN (SELECT MemberId, SUM(Amount2) FROM Table2 GROUP BY MemberId) Agg
ON Table1.MemberId = Agg.MemberId
"
39160,SQL: Regular Expressions `,"42\.(6[7-9]|7[0-9]|8[0-6])
"
6442,Find all nodes within a subtree that has 0 or 1 children,"SELECT t1.*, t2.numchildren
FROM user_tree t1
LEFT JOIN ( SELECT parent_id, COUNT(*) AS numchildren
            FROM user_tree
            GROUP BY parent_id ) t2
ON t1.id = t2.parent_id
WHERE t2.numchildren IS NULL
OR t2.numchildren = 1;
"
6597,How do I select rows where only return keys that don't have '1' in column c,"SELECT t.[Key]
FROM TableName t 
WHERE NOT EXISTS (SELECT 1 
                  FROM TableName 
                  WHERE t.[key] = [key]
                   AND ColumnC = 1)
GROUP BY t.[Key]
"
1573,"Declaring, setting, and displaying a var in PL/SQL","SQL>  variable v_dCnt number;
SQL> begin
  2    select count(*)
  3      into :v_dCnt
  4      from dual;
  5  end;
  6  /

PL/SQL procedure successfully completed.

SQL> ed
Wrote file afiedt.buf

  1* select 'There are ' || :v_dCnt || ' rows' from dual
SQL> /

'THEREARE'||:V_DCNT||'ROWS'
-------------------------------------------------------
There are 1 rows
"
38780,insert into table and a look up table,"INSERT INTO xrefSomeListIdAndAttendeeIds
   (SomeListId, AttendeeId)
   SELECT 1, AttendeeId
   FROM Attendee
"
30982,Select records by comparing subsets,"SELECT
  table1.x
FROM
  table1
INNER JOIN
  table2
    ON table1.y = table2.z
GROUP BY
  table1.x
HAVING
      COUNT(*) = (SELECT COUNT(*) FROM table2 AS lookup)
  AND COUNT(*) = (SELECT COUNT(*) FROM table1 AS lookup WHERE x = table1.x)
"
21037,SQL set specific month as first month of the year," select 
      (Datepart(week, convert(datetime, 
            substring(CONVERT(VARCHAR(11),@date,6), 1, 7) + '2000'))  % 27) + 1
"
27738,PL/SQL: Assign a data type to a variable,"create or replace
package SOME_PACKAGE as
  subtype filetype is clob; --assign clob's filetype to a variable
end SOME_PACKAGE;
/
"
2722,Oracle SQL - calculate avg pay in department and select all above avg,"select name, department, pay, avergePay
from EMPLOYEE
join DEPARTMENT using (department_id)
join (
select department_id, avg(pay) averagePay
from EMPLOYEE
join DEPARTMENT using (department_id)
) temp using (department_id)
"
3572,Stored procedure unsure syntax,"CREATE PROCEDURE procedure4 
    @Customerid varchar(5) = null
AS 

BEGIN
    SET NOCOUNT ON;

    DECLARE @FoundCustomer varchar(10) = ''

    IF @FoundCustomer is not null

    BEGIN
        IF (SELECT COUNT(1) FROM customers WHERE customerid = @customerid) > 0
            SET @FoundCustomer = 'Found'
        ELSE 
            SET @FoundCustomer = 'Not Found'
    END

    SELECT @FoundCustomer

END
"
4552,Getting most recent date values where other column values change,"WITH x AS
(SELECT id, value, date 
        , ROW_NUMBER() OVER (PARTITION BY id ORDER BY date DESC) AS RowNum
FROM table
)
SELECT id, value, date
FROM x
WHERE RowNum = 1
"
27537,Average Function SQL,"SELECT DoctorUsername FROM TABLE_NAME GROUP BY DoctorUsername HAVING AVG(Rating) = 4
"
3363,exact sql query string for my 2 tables,"SELECT Employee.EmpID, Employee.Name, Sum(NZ(DateDiff(""s"",Punches.LogIN,Punches.LogOUT),0)) AS THours
FROM Employee 
LEFT JOIN Punches  
    ON Punches.EmpID=Employee.EmpID
GROUP BY Employee.Name, Employee.EmpID
ORDER BY Employee.EmpID;
"
35254,mysql too many indexes?,"WHERE DATE(datetime_column) = ...
"
31548,How do i convert columns into rows for each status,"  SELECT Name, 'Joined' AS [ACTION], JOIN_DT AS ACTION_DATE
  FROM SomeTable
UNION ALL
  SELECT Name, 'Started' START_DTTM
  FROM SomeTable
UNION ALL
  SELECT Name, 'ended', END_DT
  FROM SomeTable
"
31647,Hierarchical data with CTE,"with t as
(
  select id,name,mgrid,1 as level,cast(name as varchar(max)) as path 
         from emp where mgrid=0
  union all 
  select emp.id,emp.name,emp.mgrid, t.level+1 as level, 
         t.path+cast(emp.name as varchar(max)) as path

  from emp
  join t on emp.mgrid=t.id
)

select replicate('+', level)+name from t order by path
"
36188,How to query a table for different columns based on first column result,"select * 
  from my_table 
 where (column_1 = ""xxx""
   and exists (select null from my_table where column_1 = ""xxx""))
    or (column_2 = ""xxx""
   and not exists (select null from my_table where column_1 = ""xxx""))
"
15206,confusion with multiple conditions in where clause of select statement,"SELECT pet_id, pet_name, pet_age, pet_dead 
FROM person
JOIN person_pet ON person.id = person_pet.person_id
JOIN pet ON pet.id = person_pet.pet_id
WHERE person.first_name = 'Zed'
"
8453,MYSQL online members in past 30 days,"select 
count(*) as users 
from table 
where from_unixtime(lastonline) >= now() - interval 30 day
"
10389,Powershell Code to Get List of Files,"$files = $directoryList | %{ Get-ChildItem $_ } | 
    ?{ $_.extension -eq "".sql"" } | %{ ""$($_.Directory.Name)\$($_.Name)"" }
"
32777,TSQL Order By - List of hard-coded values,"WITH StatusOrders
AS
(
  SELECT StatusOrderID, StatusName
  FROM (VALUES(1, 'Active'), 
              (2, 'Deleted'),
              ...
              n, 'last status')) AS Statuses(StatusOrderID, StatusName)
)
SELECT *
FROM YourTable t
INNER JOIN StatusOrders s ON t.StatusName = s.StatusName
ORDER BY s.StatusOrderID;
"
27080,SQL - Selecting the 6th visit from a customer,"SELECT AccountID
FROM View1 v
INNER JOIN (SELECT AccountID
            FROM Visits
            WHERE Visit < CONVERT(DATE, GETDATE())
            GROUP BY AccountID
            HAVING COUNT(1) = 5) hist ON v.AccountID = hist.AccountID
AND Visit_LastVisitDate = CONVERT(DATE, GETDATE())
"
24108,Using @@Identity,"Debug.Print ""most recent autonumber: "" & _
    conn.Execute(""SELECT @@Identity"")(0)
"
10936,How can I fill a table column with sequential values?,"UPDATE tt_calendar c1
SET tt_taskindex=(SELECT COUNT(*) FROM tt_calendar c2 
WHERE c2.tt_calendar_id < c1.tt_calendar_id)+1
"
32942,mysql select rows on comma seperated value in column,"SELECT product_id, product_name
FROM   products
WHERE  FIND_IN_SET ('pc', keywords) > 0 OR
       FIND_IN_SET ('personal computer', keywords) > 0
"
34283,SQL select max values,"select max(
    case myValue
        when 'X' then 1
        when 'Y' then 2
        when 'Z' then 0
    end) myValue
from myTable
"
13714,"Having two SQL Server related tables, select complete rows of one and partial of other","select
    Organigrama.Item, 
    Organigrama.Id, 
    Organigrama.ParentItem, 
    Rol_Menu.Cod_Rol
from
    Rol_Menu 
        right join
    Organigrama 
        on Rol_Menu.Cod_Menu = Organigrama.Id and
           Rol_Menu.Cod_Rol = '5'
"
9927,How to duplicate a record and specify a field value,"insert into tMyTable (userId, testDate, studentResponse)
select 100 as userId, testDate, studentResponse
from tMyTable 
where testId= 403 
"
5163,Best way to loop through all possible combinations across multiple tables?,"  SELECT osg.OrderStageID, ost.OrderStatusID, COUNT(o.OrderID) AS TotalOrders
  FROM   orderStage osg CROSS JOIN orderStatus ost
             LEFT JOIN [order] o ON o.OrderStageID = osg.OrderStageID
                    AND o.OrderStatusID = ost.OrderStatusID
  GROUP BY osg.OrderStageID, ost.OrderStatusID
"
19055,Query Criteria Inquiry,"if(txtSex != """")
 sqlquery = ""select * from tbl where sex = txtSex.selectedvalue""
else
 sqlquery = ""select * from tbl""
"
30213,What fails in this row level trigger?,"if inserting then
  dbms_output.put_line(' On Insert');
  update fornecimento f set f.total_enc_fornec = nvl(f.total_enc_fornec, 0) +:NEW.prec_total_if  where f.id_fornecimento = :NEW.id_fornecimento;

else
dbms_output.put_line(' On Update');
update fornecimento f set f.total_enc_fornec = nvl(f.total_enc_fornec, 0) - :OLD.prec_total_if +:NEW.prec_total_if  where f.id_fornecimento = :NEW.id_fornecimento;

end if;
"
34858,SELECT COUNT across one-to-many relationship,"SELECT t.teamid, COUNT(p.team) player_count
FROM team t LEFT JOIN
     player p ON p.team = t.teamid
GROUP BY t.teamid
"
28579,How do I generate ADD FOREIGN KEY statements for a group of tables?,"SELECT CONCAT('ALTER TABLE ', table_name,
              ' ADD FOREIGN KEY (', constraint_name, ')',
              ' REFERENCES ', referenced_table_name,
              '(', referenced_column_name, ');') AS alter_cmd
FROM information_schema.key_column_usage
WHERE referenced_table_name IS NOT NULL;
"
4981,SQLite - Returning column total w/all rows,"SELECT  a.transaction_amount,
        a.transaction_date,
        b.Total
FROM prepaid_tbl  a,
        (
            SELECT  SUM(transaction_amount) AS  Total 
            FROM prepaid_tbl 
            WHERE playerID = 17 
        ) b
WHERE a.playerID = 17 
"
6120,SQL select: fits both id's,"SELECT t1.*
  FROM table AS t1
  JOIN table AS t2 ON t1.product_id = t2.product_id
 WHERE t1.filter = 1
   AND t2.filter = 12
"
33442,SQL - IF a value equals a certain number then the amount of rows should equal that certain number,"select T.Name from test12 T join master..spt_values M
on T.number>M.number
where type='p'
"
28090,SQL Syntax Help - Update,"update MyTable
set column =
    case 
        when d.data is not null 
        then d.column1 + rf.column2 + rwf.column3 
    end
from ...
"
28829,Find table value between range of column in sql,"select max(rate) as rate
from tblRate
where TotalDays <= ?
"
24460,MySQL copy multiple rows values with same ID into new columns?,"<?php
$query = $db->query('SELECT ItemID, GROUP_CONCAT(File SEPARATOR \'|$|\') AS Files FROM Table GROUP BY ItemID');
// Use a string that cant appear as part of the filename as the separator
$fh = fopen('items.csv', 'w');
foreach ($query->fetchAll(PDO::FETCH_ASSOC) as $row) {
    $files = explode('|$|', $row['Files']);
    fputcsv($fh, array_merge(array($row['ItemID']), $files));
}
fclose($fh);
"
8994,SQL Inner Join wih multiple table,"select
  t1.c1
, t2.c2
, t3.c3
, t4.c4
from ((t1
inner join t2 on t1.something = t2.something)
inner join t3 on t2.something = t3.something)
inner join t4 on t3.something = t4.something
"
23941,Select distinct on one col and everything else,"SELECT a.*
FROM items a
     INNER JOIN ( SELECT MIN(id) id
                  FROM items
                  GROUP BY name
                ) b
                ON a.id = b.id
ORDER BY a.name;
"
17163,MySQL select query for date range with same time,"WHERE EventTime >= '2013-09-26 12:01' - INTERVAL 5 DAY
  AND EventTime <= '2013-09-26 12:01' + INTERVAL 5 DAY
  AND TIME(EventTime) = TIME('2013-09-26 12:01')
"
26749,sql server transpose rows to column value," SELECT Project,
  (SELECT State + ''
   FROM table t
   WHERE t.project = m.project
   FOR XML PATH(''))
 FROM table m
 GROUP BY Project
"
28005,"How to use ""Partition By"" or ""Max""?","select year, x,y
from (
      select year, x, y, max(year) over(partition by x) max_year
      from my data
      )
where  year = max_year
"
3947,T SQL Information schema?,"declare @databasename nvarchar(100) = 'roflcopter'
, @destination = 'myschema.mytable'
declare @companylist nvarchar(max) = (select stuff( select ',' +convert(nvarchar(5),companyid) from companytable where database = @databasename),1,1,'')

declare @query nvarchar(max) 
= N'use ['+@databasename+']
insert into '+@destination+' /* maybe add dynamic columns here */
select /*same dynamic columns */
from mytable /*or another variable*/
where companyid in('''+@companylist+''')
'
exec (@query)
"
8553,Display all table A records which are not in table B using mysql joins concept,"SELECT 
t1.*
FROM tableA as t1
LEFT JOIN tableB t2 ON t1.email=t2.email
WHERE t2.id IS NULL
"
7719,Insert data into table with relationship,"INSERT INTO t_Bild ( B_ID, M_ID, Dateiname, Datum )
   SELECT 1+ MAX(B_ID), 8, ""someName.png"", DATE()
   FROM t_Bild GROUP BY 2,3,4
"
17169,Creating an UPDATE trigger that causes the removal of the triggering row,"CREATE TRIGGER remove_useless_surveys 
AFTER UPDATE OF agent_id, agency_id, province_id ON surveys 
BEGIN
  DELETE FROM surveys 
  WHERE  agent_id IS NULL 
  AND    agency_id IS NULL
  AND    province_id IS NULL;
END;
"
13522,Query either field with highest number,"SELECT IF(a > b, a, b) AS max_value
  FROM (SELECT MAX(up) AS a,
               MAX(down) AS b
          FROM table) x
"
15995,See what sp_execute is doing,"select text
    from sys.dm_exec_requests
    cross apply sys.dm_exec_sql_text(plan_handle)
    where session_id = <SPID FROM PROFILER>
"
3447,How to use Hibernate Criteria order by with associate tables?,"<property name=""name"" formula=""(SELECT COALESCE((SELECT t.NAME FROM TABLE_B t WHERE t.PK_ID = FK_TABLE_A),(SELECT n.NAME FROM TABLE_C n WHERE n.FK_TABLE_A=PK_ID) ,'') FROM DUAL)""/>
"
28380,Select a single row with a given date using SQL Server 2014,"declare @t1 as table (id int,date datetime)
insert into @t1 select 1,'2016/1/05'
insert into @t1 select 2,'2012/5/09'
insert into @t1 select 3,'2010/6/23'
insert into @t1 select 4,'2009/7/18'
insert into @t1 select 5,'2002/2/13'

declare @inputDate datetime = '2003/2/12'
select top 1.id from @t1 order by abs(datediff(dd,date,@inputDate))

set @inputDate = '2016/1/02'
select top 1.id from @t1 order by abs(datediff(dd,date,@inputDate))
"
28209,Whats the right syntax for the string comparison query involving variable name in PostgreSQL?,"SELECT *
FROM name
WHERE strpos(LastName, FirstName) > 0;
"
16868,How to add new column into temp table,"SELECT t.component_id, t.pub_id, m.Date_Value
FROM #temp2 t
JOIN CUSTOM_META m
ON t.pub_id = m.ITEM_ID
AND m.KEY_NAME = 'ArticleDate'
"
2133,SQL UNION on 2 table variables where date is same but other data is not," SELECT Company, Date, Type, Select FROM DataTable
 UNION ALL
 SELECT Company, Date, Type, Select FROM DateTable
    WHERE EXISTS (SELECT * FROM DataTable WHERE Company = DateTable.Company AND Date = DateTable.Date)
    AND NOT EXISTS (SELECT * FROM DataTable WHERE Company = DateTable.Company AND Date = DateTable.Date AND Type = DateTable.Type)
"
3451,Why is MySQL using filesort in this case?,"CREATE INDEX idx_newsletters_status
ON newsletters(status, last_update, id);
"
2159,Is it correct to say that data reading operations need not run inside transactions?,"select * from Tab
except select * from Tab
"
6749,Is it possible to insert data into the mid section of a table using the INSERT command?,"CREATE INDEX row_index_index ON `some_table` (`index`);
"
25722,"how to deal withenddate null value when you do DATEADD(dd,1, s.endDate))","Select* form s where AND (GETDATE() >= s.startDate AND 
GETDATE() <=  DATEADD(dd,1, COALESCE(s.endDate,s.startDate))
"
32494,How to use values retured from mysql stored function with in() function?,"select * 
from dp_deals as d 
  left join dp_business_locations as b 
    on FIND_IN_SET(b.businessLocID, d.dealBusinessLocations)
"
22980,Get value from another table,"select table1.*, table2.file_name from table1
inner join table2 on table2.file_doc_id = table1.doc_id
where table1.doc_folder='1010'
"
408,How to select the same value only once in MysQL?,"select id, a, b from table 
where id in (1,2,5)
"
10216,Wordpress: automatically delete posts that are x days old?,"SELECT * FROM `wp_posts`
WHERE `post_type` = 'post'
AND DATEDIFF(NOW(), `post_date`) > 30
"
16347,Limiting MySQL results to prior days of the week,"WHERE DAYNAME(FROM_UNIXTIME(`date`)) = 'Monday'  <-- by day of the week
  AND `date` < INTERVAL CURRENT_DATE - 7 DAY     <-- within the last week
"
17044,Remove zeros between a number SQL,"select amount, replace(amount, '0', '') as new_amount from my_deductions;
"
3318,Get list of tables but not include system tables (SQL Server 2K)?,"select name from sysobjects where type='U'
"
20117,"Oracle group by, take first element from non-grouped column","SELECT person_id, account_login, add_date
  FROM (SELECT table.*
             , DENSE_RANK() OVER (PARTITION BY person_id ORDER BY add_date) rnk
         FROM table)
 WHERE rnk = 1;
"
2001,Stop mysql MEDIUMINT maxing out to 16777214 on substraction,"UPDATE users 
SET    posts = posts - 1 
WHERE  user_id = 5214 AND 
       posts > 0
"
31607,MySQL Fulltext Search for attributes,"SELECT  col
FROM    mytable
WHERE   MATCH(text_data) AGAINST('+""data 1244"" +""amt 78""' IN BOOLEAN MODE)
"
27504,Documents read per user per day,"select d.date, t.user_id, count(*)
from (select distinct date from t) d cross join
     (select distinct user_id from t) u left join
     t
     on t.date = d.date and t.user_id = u.user_id
group by d.date, t.user_id
order by d.date, t.user_id;
"
33629,MySQL - How Do I Count Nulls and Not Nulls?,"SELECT prod_code,
       COUNT(email) AS total_installs,
       COUNT(install_slot) AS used_installs
FROM installs
WHERE email='example@example.com'
GROUP BY prod_code
"
10959,Get all partitioned tables,"SELECT partition_number,rows,object_name(object_id)
FROM sys.partitions s
WHERE EXISTS(SELECT NULL 
                FROM sys.partitions s2 
                WHERE s.object_id = s2.object_id 
                AND partition_number > 1
                AND s.index_id = s2.index_id)
"
35165,How to update table with value from another table,"update nol_art 
    set  
        CENA_IZM=coalesce(xd.IZM, CENA_IZM) 
    from 
        #tmpIzm xd 
        join nol_art a on a.ART_ID=xd.ID_ART 
    where  
        a.ART_ID=xd.ID_ART 
"
12616,Show rows data into column format,"SELECT itemName,
       GROUP_CONCAT(CASE Date_format(`Date`,'%Y-%d-%m') WHEN '2012-01-12' THEN `isAvailable` ELSE NULL END) AS `2012-01-12`
      ,GROUP_CONCAT(CASE Date_format(`Date`,'%Y-%d-%m') WHEN '2012-02-12' THEN `isAvailable` ELSE NULL END) AS `2012-02-12`
      ,GROUP_CONCAT(CASE Date_format(`Date`,'%Y-%d-%m') WHEN '2012-03-12' THEN `isAvailable` ELSE NULL END) AS `2012-03-12`
FROM Table1
GROUP BY `itemName`;
"
12677,Update only the date from datetime - Oracle,"UPDATE table_name
   SET column_name = column_name - interval '12' day
 WHERE trunc( column_name ) = date '2012-02-06';
"
7080,SQL - Partial Sum of results for two different columns,"SELECT Name, 
    sum(case when Rank in (1, 2) then Score else null end) as Score1,
    sum(case when Rank < 1 or Rank > 2 then Score else null end) as Score2
FROM Table 
GROUP BY Name 
"
33661,SQL pivot-like records arrangement,"select id,
       max(case when header = 'firstname' then value end) as firstname,
       max(case when header = 'lastname' then value end) as lastname
from t
group by id;
"
33260,SELECT in SQL QUERY - is it possible,"SELECT name, address, description
FROM names JOIN info USING(id)
"
412,Update date field to the same date one month back Oracle,"UPDATE My_table_name
SET my_date_field = ADD_MONTHS( my_date_field, -1)
"
829,SQL Server update with random values,"UPDATE totals
SET pin = (@Lower + ABS(CRYPT_GEN_RANDOM(8) % (@Upper-@Lower+1)))
"
15070,Query to get records from table on basis of one field and to check that if the field is not -1,"SELECT
    Document_ID,
    Cluster_ID
FROM Documents
WHERE Cluster_ID =
(
    SELECT
        Cluster_ID
    FROM Documents
    WHERE Document_ID = @Document_ID
)
AND Cluster_ID <> -1

UNION

SELECT
    Document_ID,
    Cluster_ID
FROM Documents
WHERE Document_ID = @Document_ID 
AND Cluster_ID = -1
"
11982,Add Where clause to only select records within certain date range,"ALTER PROCEDURE [dbo].[FetchRequests]
    @rangeStart datetime,
    @rangeEnd datetime
AS
BEGIN
    SET NOCOUNT ON;

    SELECT      logID,
                flag,
                reviewer,
                dateRec
    FROM        LogRequests
    WHERE       dateRec BETWEEN @rangeStart AND @rangeEnd
    FOR XML PATH('requests'), ELEMENTS, TYPE, ROOT('ranks')
END
"
8569,"SQL query to change all attributes of a product to ""use default website""","DELETE FROM catalog_product_entity_datetime WHERE store_id > 0;
DELETE FROM catalog_product_entity_decimal WHERE store_id > 0;
DELETE FROM catalog_product_entity_gallery WHERE store_id > 0;
DELETE FROM catalog_product_entity_int WHERE store_id > 0;
DELETE FROM catalog_product_entity_media_gallery_value WHERE store_id > 0;
DELETE FROM catalog_product_entity_text WHERE store_id > 0;
DELETE FROM catalog_product_entity_varchar WHERE store_id > 0;
"
34847,Oracle: MIN() Statement causes empty row returns,"select * from (
-- your original select without rownum and with order by
)
WHERE ROWNUM = 1
"
27636,Clone MySQL database when had read-only permission,"mysqldump -h host1 -u user1 -ppass1 --single-transaction database1 |
mysql -h host2 -u user2 -ppass2 database2
"
6902,Fetch all rows until a special one matched,"SELECT *
FROM logTable a
WHERE NOT EXISTS
(
    SELECT 1
    FROM logTable b
    WHERE b.date <= a.date
    AND b.type = 3
)
"
1801,counting events where events are bunched if there is a small time gap,"select count(*)
from (select t.*,
             lag(timestamp) over (partition by user order by timestamp) as prev_timestamp
      from t
     ) t
where prev_timestamp is null or
      (timestamp - prev_timestamp) > 5*60;
"
27987,GROUPING ORDER BY - SQL,"ORDER BY marks DESC, time ASC
"
33120,Percentage calculation when size is same but weight is different,"SELECT
      name
    , size
    , 100 * Weight / SUM(Weight) OVER (PARTITION BY Name) AS Per
FROM (
      SELECT
            Name
          , Size
          , SUM(weight) AS weight
      FROM worker
      GROUP BY
            name
          , size
) AS w
"
15255,SQL Left Outer Join Conditionally,"left outer join SoilsSpecies ss on
    (CONVERT(nvarchar,ss.speciesID) = sv.plantname)
"
14329,MS SQL 2008 - How do I convert xml value into a collection of rows from a ms sql table?,"select 
  T.N.value('Key[1]', 'int') as [Key],
  T.N.value('Value[1]', 'varchar(10)') as Value
from @x.nodes('/root/KV') as T(N)
"
39575,Insert characters into existing cells,"UPDATE Cells SET Cell = LEFT(Cell, 1) + '08' + SUBSTRING(Cell, 1, LEN(Cell)-1)
"
34670,How to insert a range of keys in another column,"INSERT INTO C
SELECT A_Id, 1
FROM A
"
13365,proper use of count(*) with group by function,"SELECT country, SUM(population) AS country_population, COUNT(*) AS count_cities 
FROM list_of_cities 
GROUP BY country;
"
10755,Tsql Union Query is breaking sorting in my asp.net gridview,"(Query A)
UNION 
(Query B)
ORDER BY xxx
"
18554,IF statement on query results," Select Orders.TransactionNumber, Orders.RepNumber, Orders.CustomerID,
 Orders.ShipToId, orders.ItemCode, Orders.Quantity, Orders.ReceivedDate, 
 Orders.TransmitStatus from (select TransactionNumber from Orders
 group by TransactionNumber
 having COUNT (TransactionNumber)=1) as transa

 Inner join Orders on Orders.TransactionNumber=transa.TransactionNumber

 where ItemCode=9987 and ReceivedDate > DateADD (day, -4, GetDate() )
 Order by ReceivedDate

IF @@ROWCOUNT > 0
PRINT 'send mail<your logic goes here>'
"
7929,Deleting rows with integrity constraint,"SELECT TABLE_A.B_id 
INTO #TEMP_A
FROM TABLE_A
WHERE condition

DELETE FROM TABLE_A
WHERE B_id IN 
(SELECT B_id FROM #TEMP_A) 

DELETE FROM TABLE_B
WHERE id IN 
(SELECT B_id FROM #TEMP_A) 

DROP TABLE #TEMP_A
"
32476,Import text file in phpMyAdmin,"CREATE TABLE my_table (
  id        SERIAL,
  my_column TEXT
);
"
14573,Is it possible to use timestamp without having to convert it to String in Oracle?,"SELECT * 
FROM tabela 
WHERE dateField = timestamp '2014-02-10 15:56:00.000';
"
17886,join count mysql query,"  SELECT `albums`.*, count(images.id) as num 
  FROM (`albums`) 
  LEFT JOIN `images` ON `images`.`album_id`=`albums`.`id`
  GROUP BY albums.id
"
38586,Is there a way to have a placeholder when select returns no rows?,"select max(case when calculation_type_cd = 'UNITEMIZED_PLUS_LUMPSUM' and total_type_cd = 'TOT_CNTRB' 
                then total_amt end) as unitem_cntrib,
       max(case when calculation_type_cd = 'GRANDTOTAL' and total_type_cd = 'TOT_CNTRB' 
                then total_amt end) as total_cntrib,
       . . . 
from report_total rt
where rt.report_info_id = $P{ReportID};
"
11552,How do I make a MySQL statement from ID to ID,"SELECT *
FROM users
WHERE user_id BETWEEN 1 AND 50
AND moderator_id = '1';
"
19610,SQL query to ignore space,"SELECT * FROM mytable 
    WHERE LTRIM(RTRIM(username)) = LTRIM(RTRIM(""John Bob Jones""))
"
15826,SQL - IF statement around AND," SELECT DISTINCT
    id
    name
    active
    FROM team
 WHERE id = 1234
   AND (team.active = 'y'
     AND team.id IN
        {
          query
        }) 
   OR
    (team.active = 'n'
     AND team.id IN
      {
        query
      })
"
13732,Opposite of INTERSECT in Oracle,"SELECT * FROM (select1 UNION ALL select2) a
GROUP BY a.col1, a.col2, ...
HAVING count(*) = 1
"
18657,Oracle SQL getting max date value from when joining to another table,"SELECT a.VolumeID ""WFID""
     , a.Manager
     , t.TimeEst
     , t.SALTRecordedBy
     , MAX(t.SALTRecordedDate)
FROM ctxAssistanceWF a JOIN ctxAssistanceSaltWF t ON a.VolumeID = t.SaltWFID  
WHERE a.RowSeqNum = 1  
GROUP BY a.VolumeID
       , a.Manager
       , t.TimeEst
       , t.SALTRecordedBy
"
17243,CREATE VIEW with multiple tables - must show 0 values,"SELECT s.status, p.priority, COUNT(pr.status) AS hits
FROM (SELECT DISTINCT status FROM projects) s CROSS JOIN
     (SELECT DISTINCT priority FROM projects) p LEFT JOIN
     project pr
     ON pr.status = s.status and pr.priority = p.priority
GROUP BY s.status, p.priority;
"
8704,Database structure design with variable amounts of fields,"TABLE item_type (
  item_type_id INT,
  ... )

TABLE properties (
  property_id INT, -- primary key
  item_type_id INT, -- foreign key for item_type
  key NVARCHAR(max), -- adjust type to your needs
  value NVARCHAR(max) )
"
9786,Comma delimited resultes in SQL using SUM(CASE WHEN,"listagg(CASE WHEN b.item LIKE 'EU%' THEN b.item END, ',') within group (order by b.item)
"
25003,Fetching data,"if exists (
  select *
  from MyUserList
  where IsAdmin = 1
    and UserName = SUSER_NAME()
)
begin
  select *
  from MyUserList /* Or whatever you need to do if the user is admin */
end
else
begin
/* Do whatever you need to do if the user is not an admin */
end
"
5468,How to declare a constant in an SQL query?,"WITH const as
      (select max(case when c.code = 'Approved' then c.value end) as Approved,
              max(case when c.code = 'Approved' then c.value end) as Approved,
              max(case when c.code = 'Scheduled' then c.value end) as Scheduled
       from configuration c
      ),
      . . .
SELECT
FROM const cross join
     list l
WHERE status_key > Approved;
"
1664,Conditional sql query to fetch substring,"SELECT * FROM
(
    select OCCURTIME,ID,
    case 
    when OBJECTNAME like 'Installmx_CHX sd:21%' then substr(OBJECTNAME,1,13) 
    when OBJECTNAME like 'Installmx_F sd:23%' then substr(OBJECTNAME,1,11) 
    when OBJECTNAME like 'Installmx_TPONS sd:993%' then substr(OBJECTNAME,1,15)
    end as ONAME
    from anx_m1 
) T where ONAME is not null
"
12841,How to create an Sqlite3 database - IOS,"sqlite3 mydata.db
"
12848,Complex MySql query help needed,"SELECT t.id, c.id 
FROM tb_event t
INNER JOIN cr_event c ON t.id = c.eid
LEFT OUTER JOIN searchable_data s ON c.id = s.race_id

WHERE c.tfile = ''
AND s.race_id IS NULL -- This is what you need to check for
GROUP BY t.id, c.id
"
38369,Sqlite: get Count and Max of children in second tables,"SELECT s._id, s.name, COUNT(i._id) count, MAX(i._id) max
FROM sector s
LEFT JOIN images i ON s._id = i.sector_id
GROUP BY s._id, s.name
"
11764,Is there any way to speed up this query?,"SELECT mlscopy.listing_listnum 
FROM mlscopy A
NOT EXISTS
(
    SELECT *
    FROM mls_cvrmls B
    WHERE B.listing_listnum = A.listing_listnum
);
"
36396,How to form an SQL query that is like using 'IN' across two columns as pairs?,"select yourtable.* 
from yourtable
     inner join 
     (
          select 2 as v1, 3 as v2 
          union select 3,4
          union select 2,5
          union select 3,6
     ) pairs
         on yourtable.value1 = pairs.v1
         and yourtable.value2 = pairs.v2
"
34517,Importing selective data using impdp,"impdp ... Content=data_only exclude=TABLE:""IN ('table1', 'table2')""
"
21605,Create Temp Table with Range of Numbers,"WITH    q AS
        (
        SELECT  startId, endId
        FROM    ranges
        UNION ALL
        SELECT  startId + 1, endId
        FROM    q
        WHERE   startId < endId
        )
SELECT  startId
FROM    q
OPTION  (MAXRECURSION 0)
"
16898,How do I get all different property values of a ruby DataMapper::Collection?,"repository(:default).adapter.select('SELECT created_at FROM entries WHERE text SIMILAR TO ' + pattern)
"
9311,How to extract the latest row,"select * 
from table as outertable
where date = (select max(date) from table where Serial_No = outertable.Serial_No)
"
21925,How to create an auto increment primary key in SQLite,"CREATE TABLE Employee (
    Id integer primary key autoincrement,
    . . .
"
5619,SQL replace specific date in a select,"

SELECT 
   productname, 
   DATEADD(YEAR, 42, datediff(day, MIN(case when year(DateAdded) = '1970'
				then  dateadd(YY,CEILING(datediff(YY,DateAdded,'1/1/2012')),DateAdded)
				else a  end ),getdate())/nullif(SalesToDate,0)) as [Days For A Sale] 
   FROM TABLE"
38815,SQL how to select date from 1 - many,";with cteMinDate as (
    select FooId, min(CreatedDate) As CreatedDate
    from Bar            WHERE
          (@StartDate is null OR CreatedDate>= @StartDate)
          AND (@EndDate is null OR CreatedDate<= @EndDate)
        group by FooId
)
"
25358,"SQL In and having-clause, why do they produce different results?","SELECT m1.country, m1.production_year, m1.title
FROM movie m1
WHERE m1.country <> ""Spain""
AND 1 < (
    SELECT count(*) 
    FROM movie m2
    WHERE m2.country = m1.country
  )
ORDER BY m1.country ASC , m1.production_year DESC 
"
36320,SQL Outer Join Function,"SELECT COALESCE(c.price, r.price) AS price
FROM regPrice r LEFT OUTER JOIN custPrice c
 ON (r.itemID = c.itemID AND c.acct = ?)
WHERE r.itemID = ?;
"
11657,Changing SET to ENUM in MySQL?,"alter table `table_name` change column_name new_column_name enum('a','b','c','d');
"
23155,MySQL Query for getting payments evolution graph during latest 12 months,"SELECT 
    DATE_FORMAT(mrendido,'%y-%m') as xyearmonth, 
    SUM(FORMAT(ammountpaid,2)) AS ammtotal 
FROM sis_pyments
WHERE mrendido >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) 
GROUP BY xyearmonth 
ORDER BY xyearmonth ASC
"
24045,On duplicate key update with the new value,"ON DUPLICATE KEY UPDATE total = VALUES(total)
"
1325,get status on specific date,"select * from 
(

    select 
      customer_id, 
      status, 
      status_from_date, 
      nvl(lead(status_from_date) over (partition by customer_id order by status_from_date)-1,
          to_date('2099','yyyy')
         )as end_date
    from your_table

)
where your_date_here between status_start_date and end_date
"
12746,select distinct value from 1 column only with multiple column?," SELECT [Model Name],
        MIN([seq number]) AS [seq number] 
 FROM table1 
 GROUP BY [Model Name]
"
14799,Match where value is NULL in SPARQL,"select ?label ?img where {
?uri rdfs:label ?label.
 OPTIONAL { ?uri vtio:hasImage ?img. }
}
"
33320,How can I compare a varchar in SQL Server ignoring tilde character,"SELECT * FROM table WHERE varchar1 = 'variable' COLLATE SQL_LATIN1_GENERAL_CP1_CI_AI;
"
7883,Like PIVOT but values not discrete,"SELECT
    A,
    B,
    C,
    SUM(CASE WHEN P < 1 THEN 1 ELSE 0 END) AS P1,
    SUM(CASE WHEN P < 2 THEN 1 ELSE 0 END) AS P2,
    SUM(CASE WHEN P < 3 THEN 1 ELSE 0 END) AS P3,
    SUM(CASE WHEN P < 4 THEN 1 ELSE 0 END) AS P4
FROM
    Events
GROUP BY
    A,
    B,
    C
"
29672,Oracle Regular Expression (REGEXP_LIKE) Too Long Error - ORA-12733,"CREATE OR REPLACE AND RESOLVE JAVA SOURCE NAMED ipv6 as
import java.net.Inet6Address;
public class ipv6
...
create or replace function isProperIPv6Address (string varchar2) return number 
as language java name 'ipv6.isProperIPv6Address(java.lang.String) return int';
"
8341,Adding a derived column on an existing table,"SELECT
    a.* -- you should explicitly list the columns you want, though
    ,b.[Summary] SummaryPreviousYear
FROM
    myTable a
JOIN
    myTable b
        ON b.[Account] = a.[Account]
        AND DATEPART(""yyyy"" , b.[date] ) = DATEPART(""yyyy"" , a.[date] ) - 1
        AND DATEPART(""mm"" , b.[date] ) = 12
        -- AND whatever other conditions define unique rows
"
18713,sql get result of current year only,"select * from table where YEAR(date) = YEAR(CURDATE())
"
9155,SQL: Can I negate a condition in a where clause?,"SELECT *
FROM TableA A
WHERE (    (@checkbool) AND (A.Id =  123))
   OR ((NOT @checkbool) AND (A.Id <> 123))
"
14480,Android: How to search data using SugarORM,"List<ExerciseDB> bb = ExerciseDB.findWithQuery(ExerciseDB.class, ""Select * from Ex_Records where ex_recordId = ?"", ""ex0001"");
"
789,SQL group results as a column array,"SELECT rooms.id, rooms.name, niceDate, room_transcripts.date, group_concat(long) as long
 FROM room_transcripts
  JOIN rooms ON room_transcripts.room=rooms.id 
  JOIN transcript_users ON transcript_users.room=rooms.id AND transcript_users.date=room_transcripts.date 
  JOIN users ON transcript_users.user=users.id 
 WHERE room_transcripts.deleted=0 AND rooms.id IN (1,2)
 GROUP BY room_transcripts.id
 ORDER BY room_transcripts.id DESC
"
33295,Updating postgreSQL column with EXTRACT function (More than one row returned by a subquery used as an expression),"UPDATE table SET day = EXTRACT (DAY FROM ""timestamp"");
"
34723,How to transform a DB2 hard-coded view into an Oracle view,"CREATE VIEW SCHEMA.TYPE(TYPEID, TYPENAME)
AS
SELECT 0,'A' FROM DUAL
UNION
SELECT 1,'B' FROM DUAL
UNION
SELECT 2,'C' FROM DUAL
UNION
SELECT 3,'D' FROM DUAL
UNION
SELECT 4,'E' FROM DUAL
UNION
SELECT 5,'F' FROM DUAL
"
2489,Oracle Group By Issue,"SELECT id,
       id_idea,
       date_vote
FROM   (SELECT id,
               id_idea,
               date_vote,
               Row_number() over (PARTITION BY id_idea 
                                      ORDER BY date_vote DESC NULLS LAST) AS rn
        FROM   VOTE) AS t
WHERE  rn = 1  
"
22978,Not taking into account condition,"declare @id int

set @id = null

select * 
from   users 
where  (id = @id) 
       or (@id is null)
"
14656,How to swap the column values in a table with a single update query,"update tablename t
    set gender = (case when gender = 'm' then 'f'
                       when gender = 'f' then 'm'
                       else gender
                  end);
"
31344,update table with data from another table where ids match,"UPDATE table2
SET type_id = a.type_id
FROM table2 b
    JOIN table1 a ON a.id = b.table_id
"
24072,multiple attribute,"CREATE TABLE People ( 
  persion_id INTEGER NOT NULL PRIMARY KEY, 
  first_name VARCHAR(20),
  middle_name VARCHAR(20),
  last_name VARCHAR(30) )
"
25561,SQL SERVER 2008 Max Constant Value,"SELECT ClientID, YEAR, MIN(MONTH)
FROM table
WHERE NOT EXISTS (SELECT * 
    FROM table c 
    WHERE c.MONTH = table.MONTH + 1 
        AND c.ClientID = table.ClientID
        AND c.YEAR = table.YEAR)
GROUP BY ClientID, YEAR
"
19193,How to add new Column to Android SQLite Database?," @Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

    // If you need to add a column
    if (newVersion > oldVersion) {
        db.execSQL(""ALTER TABLE foo ADD COLUMN new_column INTEGER DEFAULT 0"");
    }
}
"
32415,Access 2010 Me.Refresh/Me.Requery,"DoCmd.RunMacro (""Mac_1"")
Me.TextBox1.Value = ""Null""
Me.CombBox1.Value = ""Null""
Me.Refresh

MsgBox ""Your Save Was Successful."", vbOKOnly, ""Saved""
"
13818,How to return column that matched the query in Solr..?,"hl=on&hl.fl=name,displayName,description,extra
"
13951,Get all siblings in SQL tree,"WITH RECURSIVE tree(product_id, name, parentlist) AS (
  SELECT product_id, name, ARRAY[ row_number() OVER (ORDER BY product_id) ]
  FROM tree_products
  WHERE parent_id IS NULL
  UNION
  SELECT tp.product_id, tp.name, array_append(parentlist, row_number() OVER (ORDER BY tp.product_id))
  FROM tree_products tp
  INNER JOIN tree t
  ON (tp.parent_id = t.product_id)
)
SELECT *
FROM tree
ORDER BY parentlist;
"
3718,Put blank in sql server column with integer datatype,"SELECT
    CASE WHEN position < 0 THEN '' ELSE CAST(column1 as VARCHAR(10)) END as position
,   column2
FROM myTable
"
6289,Reorganise table structure or possible with one query,"SELECT COUNT(1)
FROM A JOIN B ON A.prod_id = B.prod_id
WHERE A.site_name = 'foo'
"
13353,How to return all values of a column as null except one column value in SQL script?,"SELECT column, cast(null as int) as intcolumnexample, cast(null as nvarchar) as stringcolumnexample FROM tbl
"
9441,T-SQL MERGE statement - ... WHEN MATCHED AND ... OR ... - are brackets (parentheses) required?,"WHEN MATCHED [ AND <clause_search_condition> ]
"
34482,Constraint on non-id in foreign table,"ALTER TABLE EMAIL_QUEUE WITH CHECK
  ADD CONSTRAINT MIME_TYPE_CHECK CHECK (MIME_TYPE_ID IN (3,4))
"
10535,find most number of languages used,"select top 1 developin, COUNT(developin) as 'total' 
from software 
group by developin
order by COUNT(developin) desc
"
1697,MySQL select row from two tables even though only one table may have the row,"SELECT col1,col2,.. 
FROM pages 
WHERE slug = 'about' 

UNION

SELECT col1,col2,.. 
FROM posts 
WHERE slug = 'about'
"
11106,MySQL INNER JOIN from second table (TOP10),"$stmt = $conn->prepare('SELECT  a.*, 
    IFNULL((SELECT SUM(amount) FROM bankaccounts b WHERE b.owner=a.id),0) AS BANK_MONEY,
    (IFNULL(a.money,0) + IFNULL((SELECT SUM(amount) FROM bankaccounts c WHERE c.owner=a.id),0)) AS ARESULT
    FROM users a 
    ORDER BY ARESULT DESC LIMIT 0, 10');
"
29328,How to retrieve sum of data form last 7 days as a separate sums,"SELECT
    DATE(lead_create_date) AS `Date`,
    COUNT(*) AS `Leads`
FROM
    tab_leads
WHERE
    lead_create_date >=  CURRENT_DATE - INTERVAL 6 DAY
GROUP BY
    DATE(lead_create_date)
"
1270,sql - return max value for a time period in two tables,"SELECT TOP 1 ST_STUDENT_ID, ST_TIMESTAMP, SC_SCORE
FROM STUDENTS 
JOIN SCORES ON ST_STUDENT_ID = SC_STUDENT_ID
WHERE ST_TIMESTAMP >= '2011-01-01'
AND ST_TIMESTAMP <= '2011-02-01'
ORDER BY SC_SCORE DESC, ST_STUDENT_ID DESC
"
10882,Oracle sqlldr timestamp format headache,"event_timestamp TIMESTAMP ""dd-MON-yy hh.mi.ss.ff6 PM""
"
31760,Joining 3 tables with conditions,"SELECT *
FROM users u LEFT JOIN
     user_details ud
     ON ud.user_id = u.user_id AND ud.active = 1 LEFT JOIN 
     user_addresses ua 
     ON ua.using_id = ud.using_id AND ua.active = 1
WHERE u.user_code = 'TRY001' AND u.active = 1 ;
"
32039,Pivot Table in Oracle 11g,"SELECT *
FROM table1
unpivot
(
  ""Values"" FOR ""Number"" IN (""1"",""2"",""3"",""4"",""5"")
 );
"
10432,Aggregating rows with rank or index >= N,"SELECT customer_id,min(order_id),min(order_ts), CASE WHEN rnk < 5 then rnk else 5 end as rnk,sum(amount)
FROM(
    SELECT customer_id, 
           order_id, 
           order_ts, 
           RANK() OVER (PARTITION BY customer_id ORDER BY order_ts ASC) as rnk, 
           amount 
    FROM jq)
GROUP BY customer_id,
         CASE WHEN rnk < 5 then rnk else 5 end
ORDER BY customer_id
"
34559,Update duplicated records MySQL,"SELECT   q, SUM(A) A, SUM(B) B
FROM     my_table
GROUP BY q
"
13348,How to sum different row values of all rows that have a specific identifier as parent,"SELECT SUM(QuotaValue) 
   FROM PackageQuotas 
WHERE QuotaID = @QuotaID 
   AND PackageID IN 
    (
     SELECT PackageId FROM Packages WHERE ParentPackageID = 32455 
     )
"
734,Sql query for searching through firstName and lastName columns for all similar records,"SELECT *, 
     MATCH ( `FirstName`, `Lastname`) 
     AGAINST ('+name +middle_name +lastname' IN BOOLEAN MODE) as `rel`
FROM `table` 
WHERE MATCH ( `FirstName`, `Lastname`) 
     AGAINST ('+name +middle_name +lastname' IN BOOLEAN MODE)
ORDER BY `rel` DESC
"
21814,SQL Logic In Query,"SELECT Name,
       DENSE_RANK() OVER(ORDER BY Name) [Count]
FROM dbo.YourTable;
"
3522,select more than one count in mysql,"SELECT COUNT(*), 
       SUM(CASE WHEN FOO IS NULL THEN 1 ELSE 0 END) AS COUNT_CONDITIONAL
  FROM baz
"
27395,Assign variable in select statement,"DO
$$
DECLARE
    this_score int;
BEGIN
    SELECT score FROM scores WHERE id = 3 INTO this_score;
    RAISE NOTICE 'this_score is: %', this_score;
END;
$$;
"
24127,Insert Tomorrows Date at Specific Time,"SELECT DATEADD(hh,10, DATEDIFF(dd,0, DATEADD(dd, 1, GetDate())))
"
20901,sort a mysql table column value by part of its value,"SELECT * FROM sample ORDER BY RIGHT(Id, 3);
"
22885,How do I get a specific string UNTIL a specific character out of a string in SQL Server?,"SELECT LEFT(ColumnName, CHARINDEX('-', ColumnName)-1)
FROM TableName
"
16866,SQLite order by 3 fields and return top 1 for each category,"SELECT *
FROM CAPTURES_TABLE AS C1
WHERE (100*Pounds+10*Ounces+Drams) = 
      (SELECT MAX(100*Pounds+10*Ounces+Drams) 
      FROM CAPTURES_TABLE AS C2
      WHERE C2.SPECIES=C1.SPECIES)
ORDER BY pounds DESC, ounces DESC, drams DESC
"
9596,SQL Query to retrieve next available ID from table,"SELECT CONCAT('STK', 
              LPAD(MAX(SUBSTRING(ticket_id, 4)) + 1, 
                   10, 
                   '0')
             ) 
FROM sma_support_tickets;
"
13656,Using linQ to perform a simple select where,"// You expect 1 to many results and get the first
txtEgdon.Text = result.First().ToString()
// You expect 0 to many results and get the first or null in case of zero results 
txtEgdon.Text = result.FirstOrDefault().ToString() 
// You expect exactly 1 result and get it (you will get an exception if no results are returned)
txtEgdon.Text = result.Single().ToString() 
// You expect exactly 0 or 1 results and get null or the result
txtEgdon.Text = result.SingleOrDefault().ToString() 
"
17433,How to get non-aggregate value from a record while using MAX()?,"SELECT * FROM
(
SELECT symid, current_price, ROW_NUMBER() OVER (PARTITION BY symid ORDER BY price_date_time DESC) AS rn
FROM tblHistory
) AS T
WHERE rn = 1
"
38644,Sorting results on Oracle as ASCII,"SELECT id, my_varchar2 
FROM my_table 
ORDER BY NLSSORT(MY_VARCHAR2, 'NLS_SORT = BINARY')
"
6389,Detecting last row of a group,"select uid,something,
  ROW_NUMBER() OVER (PARTITION BY uid ORDER BY something desc) as row
from
  someTable
"
10058,Problem with MySql INSERT MAX()+1,"INSERT INTO users (user_id, name)
SELECT 1 + coalesce((SELECT max(user_id) FROM users WHERE name='Bob'), 0), 'Bob';
"
9764,Get all orders shipped to NY,"WHERE (dateord >= '2014-02-25')
  AND (dateord < '2014-02-25' + INTERVAL 1 DAY)
  AND (activeFlag = 1)
  AND (COALESCE(`ship_state`, `billing_state`) = 'NY')
"
17315,"SQL Server 2005, Calculating upcoming birthdays from date of birth","select * from Customers c 
where dateadd(year, 1900-year(dob), dob) 
    between dateadd(year, 1900-year(getdate()), getdate())
    and dateadd(year, 1900-year(getdate()), getdate())+7
"
27033,MySQL - Selecting the items that have the highest count of trips but not repeated,"SELECT stop_code, COUNT(*) AS count
FROM (SELECT trip_id, MIN(stop_code) AS stop_code
      FROM stop_times
      WHERE `time` BETWEEN '13:00:00' AND '13:05:00' 
      GROUP BY trip_id) AS x
GROUP BY stop_code
ORDER BY count DESC
"
39767,"Query output, is an input for another query does - not work","where handler like
    concat('%', (select ja.id 
        from job_applications ja 
        join users u 
        on u.id = ja.user_id 
        where u.email='xxxxx@gmail.com' 
        order by ja.updated_at desc
        limit 1),
    '%')
"
10173,Help converting subquery to query with joins,"SELECT c.company, c.cID
   FROM contractors c
   LEFT JOIN contractors2label c2
          ON ( c2.cID = c.cID AND c2.labelID <> 1 AND c2.countyID <> 1 )
   WHERE c.complete = 1
   AND c.archived = 0
   AND c2.cID IS NULL
"
26943,How to write select query for this?,"declare @year int 
declare @month int

set @year = 2010 --desire year
set @month = 8   --desire month

select sum(COMPONENT_AMOUNT)
from [TEAM_FUNDS_DETAILS] 
WHERE
    [COMPONENT_TYPE] = 1
    and  (
           YEAR_FOR < @year
        or (year_for=@year and month_for<=@month)
          )
"
3613,Import specific tables from oracle dump file?,"ORA-02291: integrity constraint violated - parent key not found
"
30231,Select from dynamic table into Datatable Oracle,"CREATE OR REPLACE PROCEDURE GET_TABLEINFO(o_rc OUT sys_refcursor, inTableName IN varchar2) AS       
    sqlquery VARCHAR2(32000);
BEGIN
    sqlquery := 'SELECT * FROM ' || inTableName;
    OPEN o_rc FOR sqlquery;
END;
"
8309,Granting roles and privileges in Oracle - should I use procedures or functions?,"CREATE OR REPLACE PROCEDURE PROC_CREATE_ROLES IS
BEGIN
  EXECUTE IMMEDIATE 'CREATE ROLE ADMIN_STAFF';

  EXECUTE IMMEDIATE 'GRANT SELECT ON BLAH TO ADMIN_STAFF';
  EXECUTE IMMEDIATE 'GRANT SELECT, UPDATE ON BLORT TO ADMIN_STAFF';
  EXECUTE IMMEDIATE 'GRANT SELECT, INSERT, UPDATE ON YADA TO ADMIN_STAFF';

  EXECUTE IMMEDIATE 'GRANT ADMIN_STAFF TO USER1, USER2, USER3';
END PROC_CREATE_ROLES;
"
10018,Count X and Not X in Oracle,"select column_a, column_b, column_c,
       count(*) over (partition by (case when column_c = 'z' then column_c end) as ""count(c)"" 
From Generic table;
"
20801,Update a column based on two matching values of a column in two tables,"update table1 t1
join table2 t2 on t1.B = t2.B
set t1.A = 'some value'
"
451,2 SQL Updates in 1 statement,"UPDATE table 
    SET fieldA = case when id = 'id1' then 'valueA' else fieldA end, 
        fieldB = case when id = 'id2' then 'valueB' else fieldB end
WHERE id in ('id1', 'id2');
"
22275,Compare two dates from columns SQL,";WITH x AS
(
  SELECT DateStarted, Field9, Field2, ID, Field6,
   rn = ROW_NUMBER() OVER (PARTITION BY Field9 ORDER BY DateStarted DESC)
  FROM dbo.your_table_name
),
y AS 
(
  SELECT x.*, [SUB] = x.Field6 - COALESCE(y.Field6, 0)
  FROM x LEFT OUTER JOIN x AS y
  ON x.Field9 = y.Field9
  AND x.rn = 1 AND y.rn = 2
)
SELECT DateStarted, Field1 = Field9, Field2, ID, [SUB]
  FROM y
  WHERE rn = 1
  ORDER BY Field1;
"
8430,Find leaf nodes in hierarchical tree,"SELECT * FROM `mytree` WHERE `id` NOT IN (
    SELECT DISTINCT `parentid` FROM `mytree` WHERE `parentid` IS NOT NULL)
"
7798,T-SQL Insert into table without having to specify every column,"-- Select everything into temp table
Select * Into 
    #tmpBigTable
    From [YourBigTable]

-- Drop the Primary Key Column from the temp table  
Alter Table #tmpBigTable Drop Column [PrimaryKeyColumn]

-- Insert that into your other big table
Insert Into [YourOtherBigTable]
    Select * From #tmpBigTable

-- Drop the temp table you created
Drop Table #tmpBigTable
"
25221,Select all rows from all tables where column name equals given value,"+---------------+
| TABLE_NAME    |
+---------------+
| name_of_table |
+---------------+
"
26919,Filtering condition in SSRS 2008,"=IIF(
    (Fields!New_Renew.Value = ""Renewal"" AND IsDate(Fields!MaturityDate.Value))
        OR Fields!New_Renew.Value = ""New"", 
    cdbl(1),
    cdbl(0)
)
"
11740,SQL Query select last entry for each product and the one previous the last,"SELECT u1.*
FROM $usertable u1
WHERE (
        SELECT  COUNT(*) 
        FROM $usertable u2
        WHERE u2.component= u1.component
         AND u2.ref= u1.ref
         AND  u2.date>= u1.date
        ) <= 2
ORDER BY component ASC, ref ASC
"
38960,sql: how to query foreign key not based upon ID,"SELECT COUNT(il.DocumentNumber) AS TotalNumberIncomingLetters
FROM IncomingLetter il
 INNER JOIN Department d on d.ID = il.Assigned_To_Department
WHERE d.Short_Name=""My Department Name"";
"
20874,An efficient way to set the same value to an attribute for all entities in a django model,"MyModel.objects.update(fk=None)
"
33704,Set server output only in spool,"$ sqlplus -S user/password @test.sql > /dev/null
$ cat test.sql 
set serveroutput on
set feedback off
spool log.txt
exec dbms_output.put_line('This is great!! and working');
spool off;
exit;
$ cat log.txt 
This is great!! and working                                                     
$ 
"
39467,SQL select menus which have no submenu,"SELECT T1.*
FROM YOURTABLE T1 LEFT JOIN YOURTABLE T2 ON T1.ID = T2.REFER
WHERE T2.REFER IS NULL AND T1.REFER=0
"
19866,Logically determine a composite key in SQL,"select xid,yid
from table
group by xid,yid
having count(1) > 1
"
34536,How to put If else statement in SQL where condition?,"select * 
from article
where (year*10000+month*100+day) between (syear*10000+smonth*100+sday) and (eyear*10000+emonth*100+eday)
"
15003,Debug SQL in pgAdmin when SQL contains variables,"PREPARE test AS SELECT * FROM users WHERE first_name = $1;
EXECUTE test ('paul');
DEALLOCATE test;
"
18844,Select random records from mysql,"(select * from your_table where Y = 1 order by rand() limit 1)
union
(select * from your_table where Y = 2 order by rand() limit 2)
union
(select * from your_table where Y in (4,5,6) order by rand() limit 2)
"
5535,Getting name from other table with joins,"SELECT l.*,
       t.typename 
  FROM logging l JOIN logging_types t
    ON l.type_id = t.id
"
29617,"Complex query, many joins","SELECT  *
FROM    A
        INNER JOIN B ON B.AID = A.AID
        INNER JOIN C ON C.BID = B.BID
        INNER JOIN D ON D.AID = A.AID
        INNER JOIN E ON E.DID = D.DID
        INNER JOIN F ON F.EID = E.EID
WHERE   C.Field = F.Field
"
15326,Need MySQL help,"SELECT kid_id, status, MAX(`timestamp`) as `timestamp`
FROM actions
WHERE DATE(`timestamp`) = CURDATE()
GROUP BY kid_id, status
"
20959,Rows to Columns in Sql,"SELECT LISTAGG ( EMAIL, ',') WITHIN GROUP (ORDER BY EMAIL) EMAIL1 
FROM USER
WHERE ID IN (107) 
GROUP BY ID 
"
7021,Mysql Select only percentage of rows,"SELECT title, COUNT(art) AS art_count
FROM table1
GROUP BY art 
HAVING art_count >= (select count(*) * X / 100 from table1)
"
36191,id field is not int and CakePHP,"    echo $this->Form->input('id', array('type' => 'text'));
"
20634,Strange behaviour with Fulltext search in SQL Server,"SELECT * FROM MyTable WHERE CONTAINS(Message, @Keyword, langauge 1033) 
"
6483,DB2 SQL Query not considering spaces in field's data,"WHERE VAR_DATA = 'I' AND LENGTH(VAR_DATA) = 2
"
21851,Can I check for constraints before a delete in SQL Server?,"If Exists ( Select * From OtherTable
            Where OtherTableFKColumn = MainTablePrimaryKey) 
   Begin
       Rollback Transaction
       RaisError('Violating FK Constraint in Table [OtherTable]', 16, 1)
   End
"
13010,Analytic function - Comparing values using LAG(),"select case 
         when col1 = lag(col1,1,col1) over (partition by trunc(col2) order by col2) then 0 
         else 1
       end as changes
from the_table;
"
33594,Slow SQL Query speed,"id, l_name, customer_id: pictures table
contact_id: cats_contacts table
id, category_id: cats_master table
"
22718,returning entries based on a is contained predicate with sql,"WITH RECURSIVE search_path(id, name) AS (
        SELECT f.id, f.name
        FROM filesystem f
        WHERE id=5
      UNION ALL
        SELECT f.id, f.name
        FROM filesystem f
        JOIN search_path sf ON f.parentid=sf.id
)
SELECT * FROM search_path;
"
27340,SQL - Group results by time interval,"select eventTime/5,count(*)
from   evalHubSupply
group by eventTime/5
"
22527,Query objects from a Many to Many look-up table,"Sub1Collection subs = DB.Select().From<Sub1>()  
  .InnerJoin(Master1Sub1_Map)  
  .InnerJoin(Master1)  
  .Where(Master1.Columns.Id).IsEqualTo(1)  
  .ExecuteAsCollection<Sub1Collection>();
"
30455,SQL group by: using where-clause logic to filter results based on aggregate functions,"select url, avg(contentping+tcpping), count(*) from websites ws, ping pi 
where ws.idwebsite = pi.idwebsite and errortype is null
group by url 
having avg(contenetping+tcpping) < 500
order by avg(contentping+tcpping) asc;
"
8073,Fetch data from two tables?,"SELECT Table-A.id, Table-A.article-name, Table-A.date, (SELECT COUNT(id) FROM Table-B WHERE Article-id=Table-A.id) AS NumberOfComments FROM Table-A;
"
37566,Mysql insert new row,"select * from table order by (id=4) DESC,id ASC
"
2742,Using JOINS in MySQL,"SELECT     *
FROM       Customer c
INNER JOIN CustAppointments ca ON ca.CxId = c.CustomerID
INNER JOIN ClinicRooms cr ON cr.AppRoomID = ca.AppRoomID
INNER JOIN AppClinics ac ON ac.ClinID = cr.ClinID
WHERE      ap.ClinDate BETWEEN '20090101' AND '20091119'
AND        SacCode IN (SELECT sc.SacCode 
                       FROM SacCode sc 
                       WHERE sc.ResellerCorporateID = 392)
"
25716,Selecting multiple timestamps between multiple start and end times from another table,"SELECT time, data
FROM data_raw, label
WHERE data_raw.serial = label.serial 
AND time BETWEEN label.start_time AND label.end_time
"
20032,How can I create select statement on this two tables,"SELECT u1.user_id, u1.user_name, u2.user_name AS p_name, u2.user_id AS pid
FROM gather_table g 
LEFT JOIN user_table u1 ON g.u_id = u1.user_id 
LEFT JOIN user_table u2 ON g.p_id = u2.user_id 
"
36943,SQL Select Rows Where Does not Exist,"SELECT DISTINCT Date
FROM Table
WHERE Date NOT IN
(
   SELECT Date FROM Table where Name = 'John'
)
"
20742,Define column name as another name in SQL?,"SELECT ((col1+col2+col3)/col4) as value
FROM ((SELECT col1, col2, col3, col4
       FROM table1
      ) UNION ALL
      (SELECT col1, col2, col3, col4
       FROM table2
      )
     ) t
HAVING value > 4 and value < 5
"
12898,Alter an existing table with a default value,"ALTER TABLE dbo.users
ADD CONSTRAINT DF_Users DEFAULT ('new_member') FOR type;
"
37519,Query on Many to Many tables with multiple OR/AND,"DECLARE @filterCount int = 3
DECLARE @filterSet TABLE ( filterNum int, filterName varchar(max) )

INSERT @filterSet VALUES
  (1,'blue'),(1,'green'),
  (2,'large'),(2,'xlarge'),
  (3,'forMen')

SELECT pf.ProductId
FROM tbProductFilter pf
INNER JOIN tbFilter f ON f.filterId = pf.filterId
INNER JOIN @filterSet s ON s.filterName = f.filterName
GROUP BY pf.productId
HAVING COUNT(DISTINCT s.filterNum) = @filterCount
"
17240,sql update statement for two tables," UPDATE menu_items mi 
     JOIN inventory_items ii ON mi.bin_number=ii.bin_number 
         AND mi.location_id=ii.location_id
 SET mi.inventory_item_id = ii.id 
"
2008,sql join 2 rows in the same table,"select 
    address.name,
    address.value as address,
    phone.value as phone
from
    yourtable as address left join
    yourtable as phone on address.name = phone.name
where address.type = 'address' and
      (phone.type is null or phone.type = 'phone')
"
72,oracle sql count (or other sufficient aggregate) return zero when row not present,"select
  f.Finish,
  count(c.Finish) as Finish_Amount
from 
  (select '1st' as Finish from dual
   union all
   select '2nd' from dual
   union all
   select '3rd' from dual
   union all
   select 'DNF' from dual
  ) f
  left join Cars c 
    on f.Finish = c.finish
    and c.Car = 'Toyota'
    --and c.Race = 'Atlanta'
group by f.Finish
order by 1
"
8235,SQL Server 2008 R2 Express: way to convert NULL's from Joins to zeros,"Select t1.SalesId, COALESCE(t2.AvgMnthSales,0) as AvgMnthSales
from table1 t1
left join
table2 t2
on t1.SalesId = t2.SalesId
"
34974,MYSQL Multi group by and max,"select t1.*
from (select discussion_id,post_id,sum(vote_sign) as score
      from posts_votes
      group by discussion_id,post_id) t1
join (select discussion_id,max(score) as maxscore 
      from (select discussion_id,post_id,sum(vote_sign) as score
            from posts_votes
            group by discussion_id,post_id) t
      group by discussion_id) t2 
on t1.discussion_id = t2.discussion_id and t1.score = t2.maxscore
"
35931,Query Active & Inactive Connections based off Machine and Username,"SELECT s.machine
     , s.username 
     , count(decode(s.STATUS, 'ACTIVE', 1))   as active_con
     , count(decode(s.STATUS, 'INACTIVE', 1)) as inactive_con
     , count(*)                               as total_con
FROM v$session s
WHERE type <> 'BACKGROUND'
GROUP BY username, machine 
ORDER BY total_con DESC;
"
34907,How do I invert my join critera in TSQL?,"SELECT * 
FROM source s
WHERE NOT EXISTS (SELECT 1
                  FROM reference r 
                  WHERE s.serial = r.serial AND s.trans = r.trans)
"
39249,MySQL: Get the records whose largest value in another field is below some threshold,"UPDATE 
    Account
SET
    Account.Available = true
WHERE
    Id IN(
        SELECT 
            AccountId 
        FROM 
            Note 
        GROUP BY 
            AccountId 
        HAVING 
            Max(Note.When) < DATE_ADD(NOW(), INTERVAL -90 DAY)
    );
"
32112,first duplicate and then change ID of duplicated data in mysql," INSERT INTO anag_competenze_medico (id_global_key, ...)
    (SELECT 'newID',....
    FROM anag_competenze_medico 
    WHERE id_global_key= 'oldID')
"
7197,oracle 11g SQL :help for a complicated sql query,"select acc_num, 
max(decode(open,1,date)) open_date,
max(decode(close,1,date)) close_date,
max(decode(activate,1,date)) activate_date
from table
group by acc_num
"
30577,What is universal SQL way to obtain names of columns in Primary Key?,"SELECT pk.TABLE_NAME, c.COLUMN_NAME primary_key
  FROM information_schema.table_constraints pk 
  JOIN information_schema.key_column_usage c
    ON c.table_name = pk.table_name 
   AND c.constraint_name = pk.constraint_name
 WHERE constraint_type = 'primary key'
"
303,sql: how to test password strength,"SELECT Password,
    CASE WHEN 
        Password COLLATE Latin1_General_BIN LIKE '%[a-z]%[a-z]%' AND
        Password COLLATE Latin1_General_BIN LIKE '%[A-Z]%[A-Z]%' AND
        Password LIKE '%[0-9]%[0-9]%' AND
        Password LIKE '%[~!@#$%^&]%[~!@#$%^&]%' AND
        LEN(Password) >= 8
    THEN 1 ELSE 0 END AS Valid
FROM TableWithPasswords
"
2787,Selecting records with multiple between clauses,"SELECT * FROM dbo.Items WHERE ((PostDate BETWEEN Date1 AND Date2) OR (PostDate BETWEEN Date3 AND Date4))
"
31973,SQL VB.net insert using select AND values,"Insert into [MyTable] (Max,Value1,Value2,Value3) values((select Max(Number) from Table1),@p1,@p2,@p3)
"
22271,bring all categories of data using where,"SELECT  a.City, IFNULL(SUM(age = 27), 0) Nmb_of_employees 
FROM    city a
        LEFT JOIN Data b
            ON a.code = b.cityCode
GROUP   BY a.City
"
1572,Find value and corresponding entries with number at the end,"SELECT SUBSTR(col4, 0, instr(col4, regexp_substr(col4, '\.\d+$')) -1) AS VALUE, col4
 FROM new_test
  where regexp_like(col4, '\.\d+$');
"
36612,MySQL: Statement with 'LIKE' order by degree of resemblance,"SELECT * 
from table_name 
WHERE column_name LIKE '%inter%'
order by length(column_name) desc
"
31406,Oracle Sequence generator syntax,"Example of “noorder” sequence in 10g RAC:

Session 1 on node-A: nextval -> 101
Session 2 on node-A: nextval -> 102
Session 1 on node-B: nextval -> 121
Session 1 on node-B: nextval -> 122
Session 1 on node-A: nextval -> 103
Session 1 on node-A: nextval -> 104
"
31526,Select top records with unique ids,"SELECT TOP(1000) UserId, [Key], Value 
FROM
 (SELECT *, RN = ROW_NUMBER() OVER (PARTITION BY UserId order by TimeStamp)
  FROM MyTable 
  WHERE Processed = 'false') X
WHERE RN=1
ORDER BY TimeStamp;
"
27776,VBA / Visual Basic. Simple String SQL,"update [Table1] SET [Vote] = Vote + 1 WHERE ID = 1
"
8610,Cursors in SQL Server: High Performance Penalty,"select c.*, a.activity
from calltable c outer apply
     (select top 1 a.*
      from activitytable a
      where a.memberId = c.memberId and
            a.datetime <= c.datetime
      order by a.datetime asc
     ) a;
"
722,sql - How to select two different counts from different level of join?,"select pub.pub_id, count(p.article_id), count(distinct j.article_id) 
from publication pub
inner join journal j on pub.journal_id=j.journal_id
left join published p on j.article_id=p.article_id
group by pub.pub_id
"
27386,"Multi value field sql query, check if value exist","select entity_id
from your_table
group by entity_id
having sum(name = 'test') = 0
"
1547,"SQL Query to get a row, and the count of associated rows","SELECT a.ID, a.Title, COUNT(c.ID) AS NumComments
FROM Articles a
LEFT JOIN Comments c ON c.ParentID = a.ID
GROUP BY a.ID, a.Title
"
33327,sql-query that change all validTo dates to the next validFrom date minus one Day,"update mytable upd
set enddate = coalesce(
(
  select min(startdate) - 1
  from mytable later
  where later.startdate > upd.startdate
  and later.anr = upd.anr -- same product
), date'9999-12-31') -- coalesce for the case there is no later record
where enddate = date'9999-12-31';
"
6682,Return Only number from a string if it contains numbers,"select (regexp_matches('abc123CD', '\d+'))[1];
"
15282,how to change structure of multiple tables at once in sql,"    private static final String ALTER_USER_TABLE_ColumnDetails = 
        "" ADD NEW_COLUMN_NAME TEXT"";

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) 
    {
 // strTableList - Array of Table Names
       for(int i=0;i<strTableList.length;i++)
       {
       db.execSQL(""ALTER TABLE ""+strTableList[i]+ALTER_USER_TABLE_ColumnDetails);
       }
    }
"
23012,"EF code first, polymorphism cast","using AutoMapper;

//Create Map from Person to RegisteredPerson
Mapper.CreateMap<Person, RegisteredPerson>();

//Load person from Database
Person p = context.Persons.SingleOrDefault(predicate);
//Map Person to RegisteredPerson
RegisteredPerson r = Mapper.Map<Person, RegisteredPerson>(p);
//Assign values to RegisteredPerson
r.ProxyId = SomeValue;
using (var context = new YourContext())
{
    context.Persons.Attach(r);
    context.SaveChanges();
}
//Load new RegisteredPerson
using (var context = new YourContext())
{
    RegisteredPerson rp = context.Persons.OfType<RegisteredPerson>().SingleOrDefault(predicate);
}
"
19403,Return multiple columns of data from a single column with different WHERE statements,"SELECT
    [DateTime],
    MAX(CASE WHEN ID='Measure 1' THEN [Values] END) as Measure1,
    MAX(CASE WHEN ID='Measure 2' THEN [Values] END) as Measure2
FROM
    [table]
GROUP BY
    [DateTime]
"
22148,How does order by row id work in Oracle?,"select rowid, 
       dbms_rowid.rowid_relative_fno(rowid) as rel_fno,
       dbms_rowid.rowid_row_number(rowid) as row_num,
       dbms_rowid.rowid_block_number(rowid) as block_num, 
       dbms_rowid.rowid_object(rowid)
from points 
order by rowid
"
39382,Select only ids with tags that matches an array exactly,"SELECT id 
FROM t
GROUP BY id 
HAVING 
    COUNT(DISTINCT CASE WHEN tags IN('apples', 'pears', 'oranges') THEN tags END)=3
    AND COUNT(DISTINCT CASE WHEN tags NOT IN('apples', 'pears', 'oranges') THEN tags END) = 0;
"
15376,Limiting the number of rows in one to many relationship?,"select address.addressid,
       employee.employeeid
from employee,
     address
where address.employeeid = employee.employeeid
group by employee.employeeid
having count(address.employeeid) > 2
"
39288,SQL query to count widgets of a certain type missing a transaction of a certain type,"SELECT Count(widgets.*) AS count
FROM (widgets 
INNER JOIN widget_info 
    ON widget_info.widget_number = widgets.widget_number) 
INNER JOIN inspections 
    ON inspections.widget_number = widgets.widget_number
WHERE widget_info.type ='A' AND 
NOT EXISTS (SELECT 1 FROM inspections WHERE inspections.type <> 'internal'
    AND inspections.widget_number = widgets.widget_number);
"
6726,Combine multiple rows using SUM that share a same column value but has different other column values,"SELECT 
  Account, 
  SUM(Charges)  AS TotCharges, 
  SUM(Charges2) AS TotCharges2, 
  MIN(Date) AS Date
FROM TABLE
GROUP BY Account
ORDER BY Account
"
39611,How can I optimize this SQL query with nested SELECT's?,"SELECT photo.src_big, photo.created, photo.modified, photo.owner, photo.aid, 
photo.caption FROM photo 
inner join album on album.aid = photo.aid 
inner join  friend on album.owner = friend.uid2 
WHERE uid1=me() or uid2 = me()
order by modified desc,created DESC LIMIT 30
"
35321,SQL select from two tables (user have max car),"select  user.name_user 
from user 
inner join  (select id_user,  count(*) num 
     from car group by id_user order by num desc limit 1) as t on t.id_user  = user.id
"
34604,"Using "".."" in SQL (INSERT INTO X..Y (A) VALUES ('1')","select * from master..sysobjects

select * from master.dbo.sysobjects
"
7472,Add an interval to a date until is today sql server query,"  Select * 
    from A
    where datediff(dd,date,getdate())% 7 = 0 
"
17080,Write advanced SQL Select,"SELECT Item, 
  [ProdSched(1)(Qnty)] = MAX(CASE WHEN ProdSched = 1 THEN Qnty END),
  [ProdSched(2)(Qnty)] = MAX(CASE WHEN ProdSched = 2 THEN Qnty END)
FROM dbo.tablename
GROUP BY Item
ORDER BY Item;
"
3369,Selecting fields from one table based on unrelated fields from another table (Bridge Table with id values links them),"select s.Name
from Student s
join StudentCourse sc
on sc.StudentId = s.StudentId
join Course c
on c.CourseId = sc.CourseId
where c.CourseId = 123;
"
34237,SQL Server + Inserting values from a select statement into a table,"INSERT INTO [Notification]
(
    [Recipient], 
    [Message],
    [Type],
    [DateCreated]
)
SELECT UserName, 'Testing Message', 'Type1', GETUTCDATE()
FROM payroll p
INNER JOIN aspnet_Users u
    ON (p.staffId= u.UserId)
WHERE jobId = '1011'
"
38300,MySQL join a different table based on field value,"select coalesce(n.id, t.id) id
,      c.type
,      c.resource_id
from   comments c
left
outer
join   news n
on     n.id = comments.resource_id
and    c.type = 1
left
outer
join   tutorial t
on     t.id = comments.resource_id
and    c.type = 3
"
37103,Retrieve first email from string in SQL row,"select     ltrim(rtrim(cdu_mail)),     
    substring(ltrim(RTRIM(cdu_mail)), 0, charindex(';',ltrim(RTRIM(cdu_mail + ';')))) 
FROM #Clientes 
"
26207,sqlite change date format of every cell in column,"UPDATE MyTable
SET MyDate = substr(MyDate, 7, 4) || '-' ||
             substr(MyDate, 1, 2) || '-' ||
             substr(MyDate, 4, 2)
"
32002,SQL Analysing Data by Comparing Data Rows,"LAG() OVER (PARTITION BY ORDER BY)
LEAD() OVER (PARTITION BY ORDER BY)
SUM() OVER (ORDER BY)
SUM() OVER (PARTITION BY ORDER BY ROWS BETWEEN UNBOUND PRECEDING AND CURRENT ROW)
"
31219,ODBC linked database with / in field name,"Dim ConnectionStr As String
ConnectionStr = ""ODBC;Driver={Oracle in OraHome92};Dbq=BLA1;Uid=BLA2;Pwd=BLA3;""
DoCmd.TransferDatabase acImport, ""ODBC Database"", ConnectionStr, acTable, ""MyTable"", ""NewTable""
"
7669,How to get values from rows on one table to column of other,"select t1.CustomerId, t1.CustomerName,
       max(case when seqnum = 1 then PhoneNmber end) as PhoneNmber1,
       max(case when seqnum = 2 then PhoneNmber end) as PhoneNmber2
from table1 t1 left join
     (select t2.*,
             row_number() over (partition by customerId order by customerId) as seqnum
      from table2 t2
     ) t2
     on t1.CustomerId = t2.CustomerId
group by t1.CustomerId, t1.CustomerName;
"
39167,SQL Query to get IDs of elements that have X number of counts in another table,"SELECT designs.*, photo.* /* You only need designs */
FROM designs /* You are looking for designs, so start there */
JOIN photos ON designs.id = photos.design_id /* append the matching photo */
LEFT JOIN votes ON designs.id = votes.design_id /* append all votes */
GROUP BY designs.id /* group all rows by design */
HAVING COUNT(*) > 50;
"
24208,Select a Range of Letters,"select ID, Name
from SampleTable
where Name >= 'A' and Name < 'E'
order by Name
"
38991,how do I join multiple tables if one table doesn't have the reference?,"SELECT *
FROM systems sys
    LEFT JOIN diskdrives dd ON sys.id = dd.system_id
    LEFT JOIN opticaldrives od ON sys.id = od_system_id
"
35475,How can I prevent all Null values from being returned in this TSQL?,"SELECT Invd.unit, 
       M.membername, 
       Invd.description 
FROM   invoicedetail Invd 
       INNER JOIN members M 
               ON Invd.memberno = M.memberno 
WHERE  Invd.unit IS NOT NULL 
       AND M.membername IS NOT NULL 
       AND Invd.description IS NOT NULL 
GROUP  BY Invd.unit, 
          M.membername, 
          Invd.description 
"
3320,sql query with table structure,"SELECT m.mytableid, CASE WHEN dt.datatypeid = 1 AND d.datatypeid =1 THEN d.datavalue ELSE null END AS ""address1""
    , CASE WHEN dt.datatypeid = 2 AND d.datatypeid =2 THEN d.datavalue ELSE null END AS ""address2""
    ,m.datecreated    
FROM datatype dt inner join
    data d on dt.datatypeid = d.datatypeid inner join
    mytable m on d.mytableid = m.mytableid
"
3224,select max value of a column in table with no rows,"SELECT COALESCE(MAX(ROUTE_ID),0) ...
"
22311,MS Access sum of 2 table in one query,"select* into #temp from table1
union
select* from table2

select id,sum(ppic) as ppic, sum(pcrt) as pcrt from #temp group by id
"
15914,Duplicate MySQL rows,"select d1.id,d2.id from datesBooked d1
   inner join datesBooked d2 on 
      d1.cottageid=d2.cottageid
      and d1.from = d2.from
      and d1.to = d2.to
      and d1.id<d2.id
"
36966,How to write a query to join 2 tables and only return records where MULTIPLE child records are included in a set of possibilities,"SELECT p.* FROM person p Where Exists (Select * from interests i where i.person = p.name and i.interest = 'skiing') and Exists (Select * from interests i where i.person = p.name and i.interest = 'biking')
"
20247,Access (ADO) query between two hour ranges,"WHERE TimeValue([Date_Time_Of_Birth]) Between #16:00:00# and #18:00:00#

WHERE TimeValue([Date_Time_Of_Birth]) Between #4 PM# and #6 PM#
"
4288,Value in one field as lookup from same table,"select c.id, 
left(c.title, instrrev(c.title, ""/"")-1)  as parentValue
, p.id as parentID
from nodeIDs c
left join
nodeIDs p
on left(c.title, instrrev(c.title, ""/"")-1) = p.title
"
18077,Convert SQL DateTime format,"select stuff(convert(varchar, getdate(), 105), 3, 1, '/') + ' ' + left(convert(varchar, getdate(), 8), 5)
"
34210,Generate an executable SQL script from an SQL Server database project,"    private void UpgradeDatabaseWithDacpac(string connectionString, string databaseName, string dacpacFileName)
    {
        DacPackage dacPackage = DacPackage.Load(dacpacFileName);
        DacServices dacServices = new DacServices(connectionString);
        dacServices.Deploy(dacPackage, databaseName, true);
    }  
"
30117,sql join on string = integer to work on any RDBMS,"CAST(a.numeric_Field AS CHAR(5))` = b.stringfield
"
535,adding a column which calculates days until next event,"SELECT t.Id,t.START_DATE,
       DATEDIFF(day,(select min(s.START_DATE) from dbo.MyTable s
                     where t.Id = s.Id and t.START_DATE < s.START_DATE),
                t.start_date)  as DifferenceInDays
FROM dbo.MyTable t
"
23520,Join two tables and group by xyz,"SELECT DISTINCT ref, status
FROM
(
    SELECT ref, status
    FROM Table1
    UNION ALL
    SELECT ref, status
    FROM Table2
) x
"
22553,Get string name from a relative path,"SELECT 
    RIGHT(testcolumn, CHARINDEX('\', REVERSE(REPLACE(testcolumn, '/', '\'))) - 1) AS FileName
FROM testable
"
6929,SQLite3 performance with OR of BETWEEN ranges,"SELECT * FROM sometable WHERE ID BETWEEN 10 AND 11
UNION ALL
SELECT * FROM sometable WHERE ID BETWEEN 20 AND 21
UNION ALL
SELECT * FROM sometable WHERE ID BETWEEN 30 AND 31 
...
"
8626,MySQL: Split string SQL to be used in WHERE clause,"WHERE FIND_IN_SET(CID, ""145,45,452"")
"
35781,Accuracy of my SELECT query,";with cte AS (SELECT  *,ROW_NUMBER() OVER(PARTITION BY PaperPersonID ORDER BY PaperPersonID) AS RN
                       ,COUNT(*) OVER(PARTITION BY PaperPersonID) AS Dup_CT
              FROM <Redacted>.[AuditedObjectWeakReference])
 SELECT *
 FROM cte
 WHERE Dup_CT > 1
"
35034,basic many-to-many sql select query,"SELECT a.BankName, a.AcctNumber, a.Balance, ag.GroupName
FROM (Accounts a 
      LEFT JOIN JoinAccountsGroups jag 
      ON a.ID = jag.AID) 
      LEFT JOIN AccountGroups ag
      ON jag.GID = ag.GroupName;
"
27589,get ids for a given date range,"select id from bulbs where
end_date >= '2012-02-10' and
start_date <= '2012-02-20'
"
27892,Conditional SQL Join using a 3rd table,"select ...
from tblEquipment e
left join vwCategoryTree c on e.EquipmentTypeID = c.EquipmentTypeID
join tblActionsRequired r 
  on (e.EquipmentID = r.EquipmentID or 
      e.EquipmentTypeID = r.EquipmentTypeID or 
      c.ParentCategoryID = r.EquipmentCategoryID)
"
31091,Entity Framework - how to join tables without LINQ and with only string?,"var db = CustomEntity();

ObjectQuery<Categories> query1 = db.Categories.Where(""it.CategoryName='Demo'"").Select (""it.CategoryID"");
var categorySQL = query1.ToTraceString().Replace(""dbo"", ""CustomEntity""); // E-SQL need this syntax
ObjectQuery<Products> query2 = db.Categories.Where(""it.CategoryID = ("" + categorySQL + "")"");
"
8108,'for each' behaviour in a single SQL statement over multiple tables,"select  *
from    Authors
outer apply
        (
        select  top 1 *
        from    Articles
        where   Authors.ID = Articles.AuthorId
        order by
                Articles.PublishDate desc
        ) as LastArticle
"
35469,How to grab from right in postgressql,"split_part( trim( '}' from split_part(fieldname,'{',12) ), ';', 3)
"
34299,Multiple Tables Ordered GROUP BY or Distinct SQL,"SELECT 
items.id, 
max(items.name) as name,
max(item_flags.flagid) as flagid,
max(COALESCE(item_flags.timestamp, items.timestamp)) AS tm
FROM   
items
LEFT JOIN 
item_flags 
ON 
item_flags.itemid = items.id 
GROUP BY items.id 
ORDER BY tm DESC
"
30079,How to print VARCHAR(MAX) using Print Statement?,"DECLARE @Counter INT
SET @Counter = 0
DECLARE @TotalPrints INT
SET @TotalPrints = (LENGTH(@script) / 8000) + 1
WHILE @Counter < @TotalPrints 
BEGIN
    -- Do your printing...
    SET @Counter = @Counter + 1
END
"
23327,SQL Find original data and where fielda+1 = value of a fieldb,"SELECT * 
FROM MyTable A
JOIN MyTable B ON (A.TranID + 1) = B.TranID
WHERE A.Code1 = 1 AND B.Code2 = 'SR'
"
36123,Query database for list of records intersecting with relational table,"select movie.name
from movie
join moviehascast mc on mc.movieid = movie.id
join cast on cast.id = mc.castid
where cast.name in (@actor1, @actor2)
group by movie.name
having count(1) = @numberOfActorsSearched
"
27146,Find Mode in Postgres SQL,"select 
    src as text,
    count(*) as total
from t
group by 1
order by total desc
limit 10;
"
28484,Duplicate rows and change category value,"insert into Table1(category, Column1, Column2)
select 17, Column1, Column2
from Table1
where category = 16
"
24074,Getting Distinct Count using SQL?,"Select AccountNo, CheckNo, Count(*) as Total
from MyTable
group by AccountNo, CheckNo
"
35620,oracle sql date format to only seconds,"SELECT interval_value,
         (EXTRACT (DAY FROM interval_value) * 24 * 60 * 60)
       + (EXTRACT (HOUR FROM interval_value) * 60 * 60)
       + (EXTRACT (MINUTE FROM interval_value) * 60)
       + EXTRACT (SECOND FROM interval_value)
          AS interval_in_sec
FROM   (SELECT SYSTIMESTAMP - TRUNC (SYSTIMESTAMP - 1) AS interval_value
        FROM   DUAL)
"
6825,Storing Business Hours in a Database,"CREATE TABLE ""business_hours"" (
     ""id"" integer NOT NULL PRIMARY KEY,
     ""business_id"" integer NOT NULL FOREIGN KEY REFERENCES ""businesses"",
     ""day"" integer NOT NULL,
     ""open_time"" time,
     ""close_time"" time
)
"
1125,Edit a row you just inserted in the db,"CREATE OR REPLACE TRIGGER XXX
    BEFORE INSERT --<< You need a BEFORE trigger for this to work.
    ON A
    FOR EACH ROW
BEGIN
    :new.val := 'LOL';
END;
"
11646,mysql stored function parameter,"DROP FUNCTION IF EXISTS `example`.`test` $$
CREATE FUNCTION `example`.`test` (param INT) RETURNS VARCHAR(32)
BEGIN

  DECLARE new_username VARCHAR(32);

    SELECT `username`
      INTO new_username
      FROM `users`
     WHERE `ID` = param;

    RETURN COALESCE(new_username, 'Username not found');

END $$
"
18109,How to make a query to obtain only results that have N number within a range of values?,"SELECT ndat.NDB_No
FROM
    NUT_DATA AS ndat
    INNER JOIN WEIGHT AS wt
    ON ndat.NDB_No = wt.NDB_No
WHERE
        ndat.Nutr_Val>0
    AND ndat.Nutr_No IN('501','502','503','504','505','506','507','508','509','510','511')
    AND wt.Seq='1'
GROUP BY ndat.NDB_No
HAVING Count(ndat.Nutr_No)=11;
"
35136,Dynamic Datasource in SQL Server Stored Procudure,"DECLARE @theSql varchar(1000)
DECLARE @installId int
SET @installId = 1
SET @theSql = 'SELECT COUNT(*) FROM dbo.Installation' + CAST(@installId as nvarchar) + '.Names'
EXEC  (@theSql)
"
28137,Case expression in Oracle where clause," (CASE WHEN p_appr_status is null and APPR_STATUS<>101 THEN APPR_STATUS
  WHEN p_appr_status is not null THEN (p_appr_status)
  END)
"
21906,Getting all fields from table filtered by MAX(Column1),";with cte as(select *, row_number(partition by tin order by specified desc, id desc) as rn
             from tablename)
select * from cte where rn = 1
"
25898,"Adding one month to date if two values fall withinin same month, and then repeating the validation check (recursion?)","UPDATE dates
SET dt = DATEADD(MONTH, 1, dt)
WHERE YEAR(dt) * 100 + MONTH(dt) IN (
    SELECT YEAR(dt) * 100 + MONTH(dt)
    FROM dates
    GROUP BY YEAR(dt), MONTH(dt)
    HAVING COUNT(*) > 1
)
AND dt NOT IN (
    SELECT MIN(dt)
    FROM dates
    GROUP BY YEAR(dt), MONTH(dt)
    HAVING COUNT(*) > 1
)
"
20204,Roll up sparse table in vertica,"    select session_token, max(col1), max(col2),.., max(colN) 
      from user_session
  group by session_token
"
22540,Check constraint when table is created with default value?,"Alter table table_test modify (foo varchar(3) NULL default 'bar');
"
29456,SQL Select First Name and Doesn't Contain Last Name Matching,"select p.*
from tablPerson p
where not exists (select 1
                  from tablPerson p2
                  where p2.LastName = 'Smith' and p2.FirstName = p.FirstName
                 );
"
9945,MS Access SQL: Return rows from Table 1 that aren't in Table 2,"SELECT TableB.con_number
FROM tableB
    LEFT JOIN TableA on
        TableB.con_number=TableA.con_number
WHERE tableA.Con_Number IS NULL
GROUP BY TableB.Con_number
"
25337,SQL Choosing a Primary Policy if it exists or,"select pd.policy_owner,
       (case min(case policy_type when 'HOME' then 1 when 'VEHICLE' then 2 else 3 end)
             when 1 then 'HOME'
             when 2 then 'VEHICLE'
             when 3 then 'FLOOD'
        end)
from owners o join
     policydetails pd
     on o.policy_id = pd.policy_id
group by pd.policy_owner;
"
20012,Multiple inner joins or multiple queries?,"SELECT games.id, games.title, 
        GROUP_CONCAT(DISTINCT dc.name) AS developers,
        GROUP_CONCAT(DISTINCT pc.name) AS publishers
INNER JOIN game_developer ON game_developer.games_id = games.id
INNER JOIN companies AS dc ON dc.id = game_developer.companies_id
INNER JOIN game_publisher AS gp ON gp.games_id = games.id
INNER JOIN companies AS dp ON dp.id = gp.companies_id
GROUP BY games.id
ORDER BY games.title
LIMIT 50
"
10853,How to combine aggregate functions in MySQL?,"  SELECT x.user, 
         AVG(x.cnt)
    FROM (SELECT user, COUNT(answer) AS cnt
            FROM surveyValues 
           WHERE study='a1' 
        GROUP BY user) x
GROUP BY x.user
"
29303,show max date of customer,"SELECT
P_Master.PID,
Visit_Date,
(SELECT MAX(Visit_Date) FROM P_Visit v WHERE v.PID = p_Master.PID) as MaxVisit
FROM P_Master
LEFT JOIN P_VISIT
ON P_Master.PID=P_VISIT.PID
WHERE CAST(CONVERT(varchar(10), Visit_Date, 101) AS datetime)='2013-10-29'
"
20863,PostgreSQL select value and increment at once,"UPDATE the_table
SET the_column = the_column + 1
WHERE qualifier = X
RETURNING the_column;
"
673,How to display Date in DD/MM/YYYY H:MM AM/PM format in SQL Server,"print convert(nvarchar(10), getdate(), 103) + right(convert(nvarchar(30), getdate(), 0), 8)
"
35543,query to fetch record without duplication,"select distinct d1.name, d1.age, concat(d1.city, ' , ' ,d2.city) AS city  from
Details d1 join Details d2
on d1.name = d2.name
and d1.age = d2.age
and d1.city != d2.city
and d1.id < d2.id
"
26227,How to get the last 3 group created at the same time?,"SELECT t1.`coupon name`, t1.`Created at`
FROM mytable AS t1
INNER JOIN (
  SELECT `Created at`
  FROM mytable
  GROUP BY `Created at`
  ORDER BY `Created at` DESC LIMIT 3
) AS t2 ON t1.`Created at` = t2.`Created at`
"
20933,MySQL conditionally create a table,"SET @sql := CASE WHEN EXISTS (SELECT * FROM USERS WHERE name='JOHN') THEN
 'CREATE TABLE CREATE_THIS (
    ID VARCHAR(255) COLLATE utf8_bin NOT NULL,
    NAME VARCHAR(255) COLLATE utf8_bin NOT NULL   
  ) ENGINE=MyISAM DEFAULT CHARSET=utf8'
END;

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;
"
18889,SQL Lower Bound?,"SELECT n FROM table WHERE n > $x ORDER BY n DESC
    UNION SELECT n from table WHERE n < $x ORDER By n DESC LIMIT 0,1;
"
18062,How to pass function a output of select query,"select p.*
from   product p
join   product_category_maping pcm
on     p.id = pcm.productid
join   category c
on     c.id = pcm.categoryid
where  dbo.[checkcharindex](@keyword, p.name + ' ' +  c.name) = 1
"
30874,SQL convert from 3 to 2 columns,"SELECT s.*
FROM t
CROSS APPLY(VALUES('Base', Temp),(CAST(Year AS NVARCHAR(100)), Temp1)
           ) AS s(year,value);
"
19669,sql group by per month and year with one row id,"select month, year,
       (case when min(id) = max(id) then min(id) end) as id
from t
group by month, year;
"
24255,Date format in asp to excel form,"<td align=""left"" style=""vertical-align:middle; mso-number-format:\@;""><%=(( objRS_Search(""PROD_FORMATTED""))) %></td>
"
13696,MS Access database in Windows Server 2003 using classic ASP,"""Driver={Microsoft Access Driver (*.mdb)};Dbq=c:\database.mdb;Uid=Admin;Pwd=""
"
25757,SQL Query Help: Returning distinct values from Count subquery,"SELECT Number
FROM Notes 
WHERE Result = 'NA'
GROUP BY Number
HAVING COUNT(Result) > 25
"
1271,SQL query optimization help please,"SELECT TOP 30 m.*
FROM media m
  LEFT JOIN multimediagroups g ON m.multimediagroupid = g.multimediagroupid
    AND g.ispollgroup = 1
WHERE m.remoteMedia = 1
  AND m.multimediaGroupID <> 13
  AND m.siloID <> 16
  AND m.siloID = 1
  AND (m.fcsPathHigh like '%.flv' AND m.fcsPathLow like '%.flv')                     
  AND g.multimediagroupid IS NULL
ORDER BY m.dateUploaded DESC
"
16668,How do I replace the values of one column with the values of another column in the same table,"UPDATE MyTable Set Column1 = Column2
"
4620,SQL count number of each actions performed on one object (using different tables),"SELECT a.UserId, a.ActionId, b.ActionTypeName, COUNT(*) AS ActionCount
FROM Activity a
INNER JOIN ActionType b
ON a.ActionId=b.ActionId
GROUP BY a.UserId, a.ActionId, b.ActionTypeName
"
6392,sql oracle using update,"update table1
    column2 = (select column4 from table2 t2 where t2.column1 = table1.column6)
    where exists (select 1 from table2 t2 where t2.column1 = table1.column6);
"
12763,How to redirect 'dbms_output.put_line content' to log file from a TimesTen Stored Procedure,"spool c:\logfile.log append
"
20205,ORA-01779: cannot modify a column which maps to a non key-preserved table on updating joined tables,"MERGE INTO uas_mapping_test t1
USING 
(   
  select pt.poid_id0, umt.plan_id
    from norie.plan_t_test pt 
    join norie.UAS_MAPPING_TEST umt on (pt.poid_id0 = umt.plan_id)
) ta ON poid_id0 <> plan_id
WHEN MATCHED THEN UPDATE 
set plan_id = poid_id0
"
10918,Get Duplicate Records and identify the lowest ID then use the lowest ID to populate Id_to_keep field,"WITH CTE AS
(   SELECT  ID, 
            IDTOKEEP,
            MinID = MIN(ID) OVER(PARTITION BY ZIPCODE, ADDRESS),
            [Count] = COUNT(ID) OVER(PARTITION BY ZIPCODE, ADDRESS)
    FROM    T
)
UPDATE  CTE
SET     IDTOKEEP = MinID
WHERE   [Count] > 1;
"
310,Regular expression in T-SQL,"SELECT data
FROM   (SELECT *,
               Parsename(Replace(Replace(data, ' ', ''), '-', '.'), 2) st,
               Parsename(Replace(Replace(data, ' ', ''), '-', '.'), 1) ed
        FROM   @tmp) a
WHERE  st NOT LIKE '%[^0-9]%'
        OR ed NOT LIKE '%[^0-9]%' 
"
8080,How to convert to explicit join?,"select
    S.sname
from
    P
    inner join SPJ on `P.p#` = `SPJ.p#` and P.pname = 'Bolt'
    inner join J on `SPJ.j#` = `J.j#` and J.city = 'London'
    inner join S on `SPJ.s#` = `S.s#`
"
30832,How do I check whether the time has reached the next half hour in SQL?,"CREATE TABLE EMAIL_AUDIT_TRAIL
(
    EMAIL_SEND_TIME AS DATETIME NOT NULL,
    EMAIL_SUMMARY AS VARCHAR(100)
)
"
27634,T-SQL XML get a value from a node problem?,"set @ProdId = @myDoc.value('
    declare namespace PD=""http://schemas.datacontract.org/2004/07/Project"";           
(PD:ExportProjectDetailsMessage/PD:CPProjectId)[1]', 'varchar(max)' )
"
27515,In out parameter not working properly in Mysql,"delimiter //
DROP PROCEDURE IF EXISTS empInfo ;
CREATE PROCEDURE empInfo (in tblname VARCHAR(255), in clName VARCHAR(255))
BEGIN
  SET @s = CONCAT(""SELECT count("", clName ,"") into @total FROM "", tblname);
  PREPARE stmt FROM @s;
  EXECUTE stmt;
END//
delimiter ;
CALL empInfo('emo','empid');
select @total;
"
21152,Split a row based on a column value,"SELECT col1,
       Split.a.value('.', 'VARCHAR(100)') col2
FROM   (SELECT col1,
               col2,
               Cast ('<M>' + Replace(col2, ' ', '</M><M>') + '</M>' AS XML) AS Data
        FROM   Yourtable) AS A
       CROSS APPLY Data.nodes ('/M') AS Split(a) 
"
5221,Can you dynamically generate regions in Oracle APEX using PL/SQL?,"l_user varchar2(500) := v('APP_USER');
"
30485,views/ queries for multiple foreign keys referencing same primary keys,"select *
from RISK r
LEFT OUTER JOIN STAFF o ON r.owner_id = o.staff_id
LEFT OUTER JOIN STAFF c ON r.contact_id = c.staff_id
"
7358,How can I select the count of a field multiple times for a different value in Transact-SQL?,"transform 
    count(*) as CountOfReceipts
select
    Month(x.[Receipt Date]) as Month
from
    the_table x
where
    Department = 'marketing'
group by
    Month(x.[Receipt Date])
pivot
    x.Type;
"
13598,mysql select information from two tables if second has match,"SELECT table1.*, table2.*
FROM mytable_normalinfo as table1 LEFT JOIN
     mytable_extrainfo as table2
     ON table1.supplier =  table2.supplier AND
        table1.id = table2.id
WHERE MATCH(table1.fulltextcollum) AGAINST ('+test*' IN BOOLEAN MODE)
LIMIT 10;
"
10203,MySQL get the column name from column value,"select states.name,
       city.name as CityName
   from
      city
         join states
           on city.stateabbrev = states.stateabbrev
   where
      city.name = 'New York'
"
5823,How to convert JSON object to varchar2 using PL/JSON,"text := mapData.to_char();
"
19360,Doing a where x in (select y from tbl.A ),"SELECT  b.doctor
       ,b.patient
       ,CASE WHEN a.doctor IS NOT NULL THEN 1 ELSE 0 END AS PCP
 FROM        tblB b
 LEFT JOIN   tblA a
    ON a.doctor=b.doctor
   AND a.patient = b.patient
"
28098,postgresql partition large dataset and random select 3 from a category,"SELECT * 
FROM (
    SELECT *, row_number() OVER (PARTITION BY category ORDER BY random()) as rn
    FROM data2016
  ) sub
WHERE rn <= 3;
"
11432,How to use sql server like query?," DECLARE @search VARCHAR(20)

 SET @search = 'sh'    

 SELECT * FROM tbl_master WHERE Name LIKE @search+'%'    
"
4449,"Fastest way to perform multiple ""IN"" queries in SQL","SELECT SU.SystemUserID
FROM [dbo].[SystemUser] SU 
WHERE SU.SystemUserID IN
(
    10, 61, 80, 93, 98
)
EXCEPT
SELECT GM.SystemUserID
FROM [dbo].[GroupMembership] GM
WHERE GM.GroupID IN
(
    1, 7, 8, 10, 32
)
"
37225,How to convert negative value into zero,"SELECT t1.name AS Name, CASE WHEN t1.Interest > 0 THEN Interest ELSE 0 END AS Interest
FROM (select name, (sum(case when TransTypeName like 'credit%' then amount else 0 end) - sum(case when TransTypeName like 'Debit%' then amount else 0 end)) *5/100 as Interest from ...........) as t1
"
26959,Consistent read and update without table locking in MySQL/InnoDB,"SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
START TRANSACTION;
SELECT  id
FROM    mytable
WHERE   status = 0
FOR UPDATE;
UPDATE  mytable
SET     status = 1,
        cnt = cnt + 1
WHERE   status = 0;
COMMIT;
"
24091,Why is there no `select last` or `select bottom` in SQL Server like there is `select top`?,"
OFFSET { integer_constant | offset_row_count_expression } { ROW | ROWS }
[
  FETCH { FIRST | NEXT } {integer_constant | fetch_row_count_expression } { ROW | ROWS } ONLY
]
"
26055,"Retrieve list of products of a given Category, based on latest snapshot?","SELECT pc.product_id
FROM Product_Category pc JOIN
     (SELECT category_id, MAX( snapshot_date ) as maxsd
      FROM Product_Category
      WHERE category_id = 1
      GROUP BY category_id
     ) pcmax
     ON pc.category_id = pcmax.category_id and
        pc.snapshot_date = pcmax.stampshot_date;
"
19613,Oracle replacing null using NVL check for empty rows,"select NVL(MAX(A_COUNT),0) from MYTABLE where VEH_YEAR = '2003';
"
21684,how to find the lowest common denominator on one side of a many to many query,"Select IC.ColorId, C.Name
From ItemColors As IC
    Join Colors As C
        On C.Id = IC.ColorId
Group By IC.ColorId, C.Name
Having Count(*) =   (
                    Select Count(*) 
                    From Items As I2 
                    )
"
5250,How to update a temporary table with a value from a select statement?,"INSERT INTO #TempCount VALUES(0, 0, 0)
"
8094,Count row number from a mysql table subquery,"select count(*)
from department_courses dc
where dc.id <= (select dc2.id
                from department_courses dc2
                where dc2.name = 'Lopps'
               );
"
21368,How to get all the data from a table in sql?," SELECT col_name1, col_name2, col_name3 from Table_Name 
"
2876,Oracle Query: How to get the most recent Active Record from this Log Table?,"select *
 from (select skl.*,
              row_number() over (partition by skl.KeyId order by skl.PublishDate desc) as rn
         from ServerKeyLog skl
        where skl.PublishDate >= date '2015-08-01'
          and skl.PublishDate < date '2015-09-01')
where rn = 1
  and IsActive = 'T'
order by KeyId
"
26863,Mysql custom where condition,"SELECT student_id, course_id, result FROM tbl WHERE result = 0 
AND student_id NOT IN (SELECT student_id FROM table WHERE result =1 
                                      and course_id = tbl.course_id )
"
12758,Finding data from Table A and Table B relation,"select * from tableA
where status = 'InActive'
and not exists (select * from tableB where tableA.AID = tableB.AID)
"
30876,"Need to select most recent record, group by customer and item code","   select
    * -- or whatever columns you actually want
    from
    RDR1
    inner join
    (SELECT itemCode, MAX(docDate) AS docDate
    FROM RDR1 
    WHERE customerCode= 'TEST001' 
    GROUP BY ItemCode) MD
    on MD.docDate = RDR1.docDate
and md.ItemCode = RDR1.ItemCode
"
2835,"Through ""SELECT"" Query show table data in form of ""INSERT"" Query","SELECT CONCAT(""INSERT INTO ABC (id, name) VALUES (1,'"", id, ""'), 2, '"", name, ""')"")
FROM ABC
"
8765,RANK() OVER ignore equal ranks,"SELECT patientid, practiceid, visitcount
FROM (SELECT patientid, practiceid, visitcount,
             RANK() OVER (PARTITION BY patientid ORDER BY visitcount DESC) as Rank,
             COUNT(*) over (PARTITION by patientid, visitcount) as RankCount
      FROM aco.patients_practices
      WHERE practiceid in (select id from aco.practices where parentaco = 30982) and isprimary = 0
     ) A
WHERE Rank = 1 and RankCount = 1
"
23804,sql join statement and deliberately repeat first line in every group,"SELECT InvH, Line FROM InvHed join InvDet on (invH = invD) where VoidLine = '' 
UNION ALL 
SELECT InvH, MIN(Line) FROM InvHed join InvDet on (invH = invD) where VoidLine = '' GROUP BY InvH
"
9026,MSSQL Find if Column Value has change for same ID,"select t.*
from t outer apply
     (select top 1 t2.*
      from t t2
      where t2.emp_id = t.emp_id and t2.startdate < t.startdate
      order by t2.startdate desc
     ) tprev
where tprev is null or tprev.color <> t.color
"
13490,SQL Server - Constructing a Column Definition,"select table_name, column_name,
column_definition = data_type + isnull('(' + convert(varchar, character_maximum_length) + ')', '') 
from information_schema.columns
"
28145,Combine contents of multiple rows in 3NF mysql tables,"SET SESSION group_concat_max_len = <your value here>
"
37586,displaying values in the table programatically,"select A, 
  case when (row_number() over (partition by A order by A)) = 1
    then 1 
    else 0 
  end as B    
from TEST
"
26005,SQL query count from instances,"SELECT  busId, COUNT(*)
FROM    (
        SELECT  busId, studentId,
                ROW_NUMBER() OVER (PARTITION BY studentId ORDER BY id DESC) rn
        FROM    busSignupInstance
        ) q
WHERE   rn = 1
GROUP BY
        busId
"
27239,SQL deleting rows with duplicate dates conditional upon values in two columns,"SELECT ID, date, MIN(code), MAX(prog) FROM table
GROUP BY date
"
36403,How to join multiple subqueries in view,"drop view if exists view_OffersStat;
create view view_OffersStat as

select
o.Id as Offer_Id,
o.Title,
o.Start,
o.Expires,
count(*) as Total_Sales,
sum(s.Net) as Total_Net,
sum(s.Gross) as Total_Gross,
max(s.Gross) as Max_Gross,

from Offer as o
inner join Sale as s
on s.Merchant_Id=o.Merchant_Id
group by s.Merchant_Id;
"
33041,Is this query irreducibly complex?,"SELECT d.id, d.name, l.message
FROM device AS d
LEFT JOIN (
  SELECT l1.device_id, l1.message
  FROM log AS l1
  WHERE l1.when = (
        SELECT MAX(l2.when)
        FROM log AS l2
        WHERE l2.device_id = l1.device_id
  ) l ON l.device_id = d.id
WHERE d.active = 1
ORDER BY d.id ASC;
"
23080,SQL value of a row as column name,"SELECT c.customerID, a2.input_value AS first_name, a1.input_value AS last_name
FROM customers c
LEFT JOIN additional a1 ON a1.ID = c.ID and a1.input_name = 'last name'
LEFT JOIN additional a2 ON a2.ID = c.ID and a2.input_name = 'first name'
"
24315,"SQL to have one specific record at the top, all others below","select * 
from the_table 
order by (case id when 999 then 0 else 1 end), date_added desc
"
19036,"SQL request with case in order by throws ""(1) 1st ORDER BY term does not match any column in the result set""","SELECT t, s, jy, descriptions, CASE ... END AS ordernr FROM ...
UNION ALL
SELECT t, s, jy, descriptions, CASE ... END AS ordernr FROM ...
ORDER BY ordernr,
         descriptions
"
28569,Would Like to Know how Instead of UPDATE Trigger with Inner join on inserted Table Works,"UPDATE MyTable SET MyField = MyField
"
22948,RowNumber on join?,"WITH TableBoxesRanked AS (
  SELECT
    *,
    BoxNumber = ROW_NUMBER() OVER (ORDER BY BoxCode)
  FROM TableBoxes
)
SELECT
  b.BoxNumber,
  ItemNumber = ROW_NUMBER() OVER (ORDER BY i.ItemNo),
  i.ItemDesc
FROM TableItems i
  INNER JOIN TableBoxesRanked b ON i.BoxCode = b.BoxCode
WHERE a.BoxCode = 'X1'
"
35472,Oracle-update multiple row value where the the id column equals specific values,"merge into
  tester
using (
  select 1 id,'0123456785' employee_phone_number from dual union all
  select 2 id,'0123456786' employee_phone_number from dual) new_values
on (
  tester.id = new_values.id)
when matched then update 
  set employee_phone_number = new_values.employee_phone_number;
"
16055,Alternatives to SQL COUNT(*) practices?,"however, in the real world, count() isn’t used very often
"
2822,Getting the value of a query into a parameter,"SELECT
  YourField
INTO
  :YourParam
FROM
  YourTable
WHERE
  ID = 1
"
31020,MySQL match existence of a term amongst comma seperated values using REGEXP,"SELECT * FROM tblnecklaces WHERE nsubcat LIKE '%bank special%';
"
16049,Using SQL or PL/SQL to replace empty lines before start of content in CLOB,"SELECT LTRIM (clob_field, CHR (10) || CHR (13) || ' ') FROM yourtable;
"
37645,Select only two rows with condition,"select * from content where title in (
  select title 
  from content 
  group by title
  having count(*)=2 
)
"
15736,Match comma separated values in column,"WHERE (',' + Categories + ',') LIKE '%,science,%'
"
7609,How to Create MySQL Query to Find Related Posts from Multiple Tables?," SELECT article_id, count(*) as common_term_count FROM 
      (
      SELECT article_id FROM tags WHERE tag IN 
         (SELECT tag FROM tags WHERE article_id = :YourArticle)
      UNION ALL 
      SELECT article_id FROM categories WHERE category IN
         (SELECT category FROM categories WHERE article_id = :YourArticle)
       ) AS accumulator_table 
 GROUP BY article_id ORDER common_term_count DESC
"
24770,Set variable to NULL if not found in query statement,"SET @a = (
SELECT TOP 1
    id
FROM
    test
WHERE
    name = 'notexist'
)

SELECT @a
"
28469,Rearranging rows in MYSQL pivot select,"select
  group_concat(distinct
    concat(
      'max(case when year = ',
      year,
      ' then experience_rate end) AS `',
      year, '-Pen`'
    )
    order by year          
  ) into @sql
from
  spooner_pec;
"
24630,insert and convert null to 0,"Insert into MyNewTable (A, B, C) select (AA, BB, ISNULL(CC,0)) from MyOldTable
"
24853,SQL Server query to list all columns in table except the primary key and alternate keys,"DECLARE @tableName nvarchar(max) = 'table_name'

SELECT COLUMN_NAME
FROM INFORMATION_SCHEMA.COLUMNS 
WHERE TABLE_NAME = @tableName

EXCEPT

SELECT COLUMN_NAME
FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS [tc]
JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE [ku] ON tc.CONSTRAINT_NAME = ku.CONSTRAINT_NAME
    AND ku.table_name = @tableName
"
38346,MySQL Cannot join columns from different database having different data type,"SELECT HEX(id), id2, count 
 FROM `Database 1`.`Table 1` a
 INNER JOIN `Database 2`.`Table 1` b
ON BINARY HEX(`a`.id) = BINARY UPPER(`b`.id)
"
35915,How do you enforce unique across 2 tables in SQL Server,"CREATE TABLE Emp(EPID INT PRIMARY KEY,
    t CHAR(2) NOT NULL, UNIQUE (EPID,t));

CREATE TABLE EmpFT(EPID INT PRIMARY KEY, ... other columns
    t CHAR(2) NOT NULL CHECK (t = 'FT'),
    FOREIGN KEY (EPID,t) REFERENCES Emp (EPID,t));

CREATE TABLE EmpPT(EPID INT PRIMARY KEY, ... other columns
    t CHAR(2) NOT NULL CHECK (t = 'PT'),
    FOREIGN KEY (EPID,t) REFERENCES Emp (EPID,t));
"
12977,How do I select the record with the largets X for each of a group of records,"select *
from tablename t1
where t1.Age = (select max(t2.Age) from tablename t2
                where t2.Last_Name = t1.Last_Name)
"
25238,SQL Update Multi Row At One Time,"Update options
Set value = name + ' value'
where name in ('aa', 'bb')
"
34348,PL/SQL getting average value in case statement,"SELECT QTR, ROUND(AVG(PCT_PERF), 2) AS QTR_PCT FROM ... GROUP BY QTR
"
16072,WPF toolkit datagrid,"Grid grd = new Grid();
XpsDocumentWriter wrt = new XpsDocumentWriter();
//Bunch of code to manipulate your grid here

//Now we calculate the scaling required:
double ScaleX = PageWidth / grd.Width; //The page width must be in Device Independent Units
double ScaleY = ScaleX;

grd.RenderTransform = new ScaleTransform(ScaleX, ScaleY);

wrt.Write(grd);
"
38476,how in SQL to sum up (+1) and down (-1) votes using 1 and 0 values?,"SELECT SUM(vote * 2 - 1) ...
"
9072,Get IDs based corresponding value pairs uniquely,"select
  min(id)
from (
  select 
    id, 
    group_concat(value order by value) as values
  from <table>
  group by id
) r
group by values
"
28940,oracle replace subcharacter using REGEXP_REPLACE function,"regexp_replace(yourValue,'(XX)0([0-4])(*)', '\1\2\3')
"
2339,Formatting Decimal with SQL,"select proc_P,RIGHT('000'+CAST(CAST((CAST(proc_P as decimal(4,0))/100) as decimal(4,2)) as VARCHAR(5)),5)
from test
"
31663,DB2 SQL Show Long and Short Table Names?,"select *
from qsys2.systables
where table_schema IN ('LAWMOD9T', 'LIBDDS')
"
22745,How do I use an IF type structure in an UPDATE statement?,"CREATE PROCEDURE spSomePS
@Number1 int,
@Number2 int,
@Amt money
AS
BEGIN
UPATE SomeTable
SET MoneyColumn = 
  CASE WHEN @Number1 +1 = @Number2
       THEN MoneyColumn - @Amt
       ELSE MoneyColumn + @Amt
  END -- end the CASE statement
"
17200,execute several queries in one variable,"DECLARE COL_COUNT NUMBER;
 BEGIN
 EXECUTE IMMEDIATE 'BEGIN insert into ex_employee (id) values (3); insert into ex_employee (id) values (4); END;';
 EXCEPTION
 WHEN OTHERS THEN
        --Handle Exception here.
 END;
 /
"
17310,Convert LINQ query to Sqlquery,"SELECT v.* from Varors v
JOIN ordervarors ov on v.id = ov.id
where ov.idOrder == @OrderId
"
24443,"sql select,get most recent entry for each car","SELECT C.*, J.id, MAX(J.date)
FROM cars C 
INNER JOIN jobs J on J.car_id = C.id
GROUP BY C.id
"
23618,Combine results from different procedures into a single table,"Declare @sql varchar(max)='Declare @tempTable Table (product nvarchar(50) ); '
Select @sql = @sql + 'Insert into @tempTable exec proc1 ' + CONVERT(nvarchar(50),s1.product) + ';'
 from (Select Distinct(s2.product) as product from Sales s2) as s1;
Set @sql = @sql + 'Select * from @tempTable';
Exec (@sql)
"
39322,Treat column as different type for sorting,"select name from tbl order by cast(stringColumn as float)
"
17104,query without subqueries? SQL,"SELECT tbla.person 
FROM tbla 
inner join tblb on tblb.person = tbla.person
inner join tblc on tblc.age = tblb.age
WHERE tblc.age = '20'
"
11338,How to get min date of every month for six months?,"select Process_date, SEQ_No
  from (select Process_date, SEQ_No, 
               row_number() over (partition by trunc(process_date, 'mm') order by process_date) rn
          from yourtab
         where Process_date < trunc(sysdate, 'mm'))
 where rn = 1;
"
19937,Date between said dates in sql server with null,"select UserId, Pay
from Pay
where @date between startdate and isnull(enddate, '9999-12-31')
"
6286,How to select records in a track with gaps not greater than 5 minutes between each record?,"SELECT 
    f.ID AS from_ID,
    t.ID AS to_ID
FROM
    GPSTable AS f 
JOIN GPSTable AS t
    ON f.ID = t.ID-1 
WHERE
    TIMESTAMPDIFF(SECOND, f.Date, t.Date) < 300
;
"
34081,List number of rows per field value in SQL,"select EmployeeId,count(*)
from YourTable
Group by EmployeeId
"
5744,Query to fill in Null fields with maximum value based on other fields,";WITH cte (A, highest_c)
AS
(
   SELECT
      A,
      highest = MAX(C)
   FROM ALinQ1
   GROUP BY A
)
UPDATE tab
SET C = c.highest_c
FROM ALinQ1 tab
INNER JOIN cte c
  ON tab.a = c.a
WHERE tab.C IS NULL
    AND tab.B <> 0;
"
18352,SQL select records with minimum number of related records,"select m.*, t.* 
from monkeys m 
inner join monkey_hangouts h on m.id = h.monkey_id 
inner join trees t on t.id = h.tree_id
where m.id in (select monkey_id 
    from monkey_hangouts
    group by monkey_id
    having count(*) > 1)
order by m.id
"
34675,Performing SQL Update Using Join and Matching Specific Columns,"UPDATE
 R
SET
  R.CLASS_LEVEL = A.CLASS_LEVEL
FROM
  Residents R
  INNER JOIN
  CAMPUS..ACADEMIC A ON R.PEOPLE_CODE_ID = A.PEOPLE_ID
WHERE
  A.ACADEMIC_TERM='Fall' AND A.ACADEMIC_YEAR='2011'
"
34709,Best way to do multiple left outer excluding joins,"select * from master_table m
 where not exists( select 1 from table_1 where m.customer_id=table_1.customer_id)
   and not exists( select 1 from table_2 where m.customer_id=table_2.customer_id)
   and not exists( select 1 from table_3 where m.customer_id=table_3.customer_id)
   and not exists( select 1 from table_4 where m.customer_id=table_4.customer_id)
"
24096,Kohana 3.x: SQL-Query for Entities and all their Members,"SELECT * FROM myEntity
join member on member.foreignKey = myEntity.foreignKey
WHERE myEntity.foreignKey = {$myForeignKey};
"
39000,Calculating the sum of rows that have been grouped in SQL,"SELECT substring(Code,1,6) as Code,
       SUM(Number) AS [Sum] -- Add this line

From Table

Group by substring(Code,1,6)

Order By Code
"
10837,Select WHERE IN in entity framwork,"var q = from p in dbContext.Providers
        where !dbContext.ProviderTeams.Any(pt => pt.TeamRef == 134 && pt.providerRef == p.serial)
        select p;
"
28784,Sql view with column identifier,"CREATE VIEW dbo.vname
AS
    SELECT [Row] = ROW_NUMBER() OVER (ORDER BY A), A, B, C FROM
    ( <UNION query here> ) AS x;
"
25374,SQL Join two tables statement,"SELECT
  article_id,
  title,
  body,
  date,
  categories.category,
  author
FROM
  articles
  LEFT JOIN categories ON articles.category = categories.category_id
"
29778,Filter rows by count of two column values,"SELECT *
FROM (
    SELECT *,
        COUNT(MembershipNumber) OVER(PARTITION BY EmbossName) AS cnt
    FROM card
    WHERE status = 'E0'
)A
WHERE cnt > 1 
"
35176,Fire one trigger when modifying two different tables,"CREATE or REPLACE TRIGGER test
  AFTER INSERT OR UPDATE OR DELETE ON tabletest
  REFERENCING OLD AS OLD NEW AS NEW 
  FOR EACH ROW 

DECLARE
      << Your declarations>>
BEGIN


IF INSERTING THEN 
<<Your insertions>>
END IF;

IF UPDATING THEN 
<<Your updations>>
END IF;    

IF DELETING THEN 
<<Your deletions>>
END IF;


EXCEPTION
    WHEN OTHERS THEN 
    <<exception handling>>;

END;
"
5450,Remove last 2 digits from column1 and append those 2 digits to column2,"SELECT LEFT(Column1, LEN(Column1) - 2) Edited_Column1,
       RIGHT(Column1, 2) + ' ' + Column2 Edited_Column2
FROM   table1
"
6586,where condition multiple values on multiple columns,"SELECT 
    a.obj, a.prop, a.val 
FROM
    testCondition a
    JOIN (SELECT obj FROM testCondition WHERE (prop = 10 AND val = 'A')) AS b ON a.obj = b.obj
    JOIN (SELECT obj FROM testCondition WHERE (prop = 12 AND val = 'C')) AS c ON a.obj = c.obj
WHERE 
  ((prop = 10 AND val = 'A') OR 
  (prop = 12 AND val = 'C'))
"
26461,Select random x of top y records,"SELECT TOP 5 * FROM (SELECT TOP 100 * FROM Cars order by Price desc) [A] ORDER BY NEWID()
"
36160,Rollback + Commit some changes,"  PRAGMA AUTONOMOUS_TRANSACTION;
"
1577,Extract size (numeric) from string,"select ltrim(rtrim(left(val, pos1 - spacebefore))) as product,
     substring(val, pos1 - spacebefore + 1, 1000) as size
from (select t.*, charindex(' ', reverse(left(val, pos1-1))) as spacebefore
      from (select t.*,
                   charindex(' X ', val) as pos1
            from (select 'abce 15/3 x 2' as val) t
           ) t
     ) t
"
3553,SQL Select statement for first two occurrences,"SELECT *
FROM (
  SELECT *,
        rn = ROW_NUMBER() OVER(PARTITION BY [reference], [key] ORDER BY [datetime])
  FROM your_table) AS sub
WHERE rn <= 2;
"
16750,The SQL Server equivalent for the MySQL Limit,"SELECT * 
FROM 
( 
      SELECT *, 
        ROW_NUMBER() OVER (ORDER BY email) as rowNum 
      FROM tableName
) sub 
WHERE rowNum > 9 
  AND rowNum <= 9 + 20 
  AND id = 3
"
36322,Calculating the average time between orders for each customer,"select cust_id , avg(orderdate - lag_orderdate) as avg_time_between_orders
from (
    select cust_id , orderDate , lag(orderdate) over (partition by cust_id) as lag_orderdate
    from  orders )
"
20782,T-SQL: Round to nearest 15 minute interval,"CREATE FUNCTION [dbo].[RoundTime] (@Time datetime, @RoundTo float) RETURNS datetime
AS
BEGIN
    DECLARE @RoundedTime smalldatetime, @Multiplier float

    SET @Multiplier = 24.0 / @RoundTo

    SET @RoundedTime= ROUND(CAST(CAST(CONVERT(varchar, @Time, 121) AS datetime) AS float) * @Multiplier, 0) / @Multiplier

    RETURN @RoundedTime
END

-- Usage    
SELECT dbo.RoundTime('13:15', 0.5)
"
20970,SQL date comparison,"SELECT (CAST(FLOOR(CAST(GETDATE() as FLOAT)) AS DateTime))
"
32996,SQL Select values starting with a capital letter,"where ASCII(left(col1, 1)) between ASCII('A') and ASCII('Z')
"
13440,Compare current date with stored datetime using month an year only,"WHERE YEAR( columnName ) = YEAR( getDate() )
"
26885,SQL query involving 2 tables,"Select  T1.bk_title, Count(*) As Num_Copies
From    Table_1 T1
Join    Table_2 T2  On  T1.id = T2.bk_no
Group by T1.bk_title
"
35572,Sql Query left outer join,"SELECT      Doc.UserID,
            Doc.DocumentID,
            Doc.DocumentName 

FROM        Documents Doc 

JOIN DocumentUserMapping DUM 
    ON      DUM.DocumentID = Doc.DocumentID 
WHERE Doc.UserID != @i_userid
AND DUM.UserID = @i_userid
"
6285,How to count duplicates based on other column?,"select 
    col_1,
    col_2,
    row_number() over(
        partition by col_2 order by col_1
    ) - 1 as col3
from yourtablename
"
35726,MySQL | Update query to populate children,"UPDATE  tableName a
        INNER JOIN
        (
            SELECT  a.ID, GROUP_CONCAT(b.ID) Children
            FROM    tableName a
                    INNER JOIN tableName b
                        ON a.ID = b.ParentID
            GROUP   BY a.ID
        ) b ON a.ID = b.ID
SET     a.Children = b.Children
"
38876,Sp_OADestory is not clearing/destroying created object,"Response.Expires = 0
Response.Expiresabsolute = Now() - 1
Response.AddHeader ""pragma"",""no-cache""
Response.AddHeader ""cache-control"",""private""
Response.CacheControl = ""no-cache"" 
"
9923,insert into for all users who are in another table,"INSERT INTO notifications(from_id, to_id, type, checked, page_id) 
    select f.follower_id, :to_id, :type, :checked, f.page_id
    from following f
    where f.page_id = :page_id;
"
19464,Sql count inside groups,"SELECT dep,
       count(*) totalrows,
       SUM(n_of_cust > n_of_employees) many_cust_rows,
       SUM(n_of_cust = n_of_employees) equal_cust_rows
  FROM My_table
  GROUP BY dep
"
38505,MySQL query with and without WHERE condition at once,"SELECT l.id, 
       l.value * SUM(if(c.id = <SOME_CLIENT>,clientStudents,0)) / SUM(totalStudents) as total 
FROM Lesson l 
JOIN lesson_student ls ON l.id = ls.lesson_id 
JOIN Student s ON ls.student_id = s.id 
JOIN Client c ON s.client_id = c.id
GROUP BY l.id, l.value
"
36249,How to compare dates in sql query?,"SELECT tahminler.match_id, tahminler.tahmin_text,matches_of_comments.match_id
FROM tahminler
INNER JOIN matches_of_comments ON tahminler.match_id = matches_of_comments.match_id
WHERE (

MONTH(STR_TO_DATE(matches_of_comments.match_date , '%m/%d/%Y'))=  '07'//month variable
 AND YEAR(STR_TO_DATE(matches_of_comments.match_date , '%m/%d/%Y'))=  '2013'//year variable
)
AND tahminler.user_id =12
"
5227,convert row_number() to int in sql server,"SELECT ID, 
CAST(ROW_NUMBER() over(order by Position desc) AS INT) Rank
FROM Tbl
"
37935,Convert table column and table row in SQL,"SELECT 
    Item,
    case when [DAY] = 1 then value else '' end as Day1,
    case when [DAY] = 2 then value else '' end as Day2,
    case when [DAY] = 3 then value else '' end as Day3
FROM
    [yourtablename]
"
22699,How do you connect to a recently create postgres database?,"\c newdb
"
2249,SQL Query in Access that lists values not in both tables,"select distinct driverlist.driverid, driverlist.driverlastname, driverlist.driverfirstname
from driverlist
left outer join transactionreport
on driverlist.driverid = transactionreport.driverid
where transactionreport.driverid is null
"
10913,Mysql query to Select where timestamp between date1 and date 2,"select * from table1
where cast(substr(p_image FROM 7 FOR 14) as date)
between '2013/12/01' and '2014/07/30'
"
16342,how to convert a number into timestamp in oracle/sql,"select to_timestamp( to_char(20131108) ,'yyyymmdd') from dual
"
14879,"Postgres 9.2 find, compare and replace two values in column","update fruittable 
   set fruitvalue = (SELECT MAX (fruitvalue) 
                     FROM fruit 
                     WHERE fruitname IN ('apple','pear'));
where fruitname in ('apple', 'pear');
"
34738,Calculate the Rates based on the Hour value SQL Server,"declare @t decimal(5,2)=1.3

/* converting to hours */
select cast(@t as int)+@t%1*100/60
"
28953,Selecting all rows after a row with specific values without repeating the same subquery,"SELECT * FROM (
  SELECT row_number() OVER (ORDER BY c1, c3) myOrder, c2, c3
        ,CASE WHEN c2 = ""foo"" AND c3 = ""bar""
              THEN row_number() OVER (ORDER BY c1, c3)
         END target_rn
  FROM t1, t2
  WHERE condition
  ORDER BY conditions
) WHERE myOrder > target_rn;
"
15332,How do I return a Unicode value in this SQL example?,"SET @Test = 'Баннер'
"
7969,How can I attack this mySQL query?,"select p.ssn, coalesce(c.cityid, 0)
from people p left join
     cities c
     on c.name = concat_ws(' ', p.name, p.lname)
union all
select distinct 0, c.cityid
from cities c
where not exists (select 1 from people p where c.name = concat_ws(' ', p.name, p.lname);
"
18279,How do I Change SQL Server column names in T-SQL?,"SELECT 'EXEC sp_rename ''' + TABLE_NAME + '.' + QUOTENAME(COLUMN_NAME) + ''', ''' + REPLACE(COLUMN_NAME, '%', '') + ''', ''COLUMN''; '
FROM INFORMATION_SCHEMA.COLUMNS
WHERE COLUMN_NAME LIKE '%[%]%'
"
23270,SQL Pivot return all rows on table join even if no record exists (cross join?),"                      dbo.KPIDatas AS t0 RIGHT OUTER JOIN
"
1805,Is my stored procedure executing out of order?,"CREATE TABLE #temp_t
 (
  myInt int,
  myUser varchar(100)
 )

INSERT INTO #temp_t(myInt, myUser) VALUES(1, 'Jon1')
INSERT INTO #temp_t(myInt, myUser) VALUES(2, 'Jon2')
INSERT INTO #temp_t(myInt, myUser) VALUES(3, 'Jon3')
INSERT INTO #temp_t(myInt, myUser) VALUES(4, 'Jon4')

ALTER TABLE #temp_t
DROP Column myUser

SELECT * FROM #temp_t

DROP TABLE #temp_t
"
23110,postgresSQL - update table using select statement,"update survey_responders
    set username = concat(left(first_name, 1), left(last_name, 1));
"
26604,"Query in sql to get the top 10 percent in standard sql (without limit, top and the likes, without window functions)","select s1.id, s1.name s1.points, count(s2.points)
from score s1, score s2
where s2.points > s1.points
group by s1.id, s1.name s1.points
having count(s2.points) <= (select count(*)*.1 from score)
"
2303,"create database after deleting by syntex this.deletedatabase(""database_name"") where database_name is my database name","if number_of_rows in <table> > limit
    do not insert
    OR
    remove oldest row and insert new
else
    insert row
"
7706,Replacing two MINUS/EXCEPT queries,"SELECT 
  value1, value2, value3,
  sum(decode(uploadID, 'afterTurning', 1, 'beforeTurning', -1)) AS diff
FROM table1 
GROUP BY value1, value2, value3
HAVING sum(decode(uploadID, 'afterTurning', 1, 'beforeTurning', -1)) <> 0
"
31466,Android upload SQLite data to server database,"select
     QUIZ.quiz_name
     ,QUESTION.question_name
     ,ANSWER.answer_name
     ,MCQ_ANSWER.mcq_answer_name
from QUIZ
     left join QUESTION on QUESTION.quiz_id_fk = QUIZ.quiz_id
     left join ANSWER on ANSWER.question_id_fk = QUESTION.question_id
     left join MCQ_ANSWER on MCQ_ANSWER.question_id_fk = QUESTION.question_id
//where QUIZ.quiz_id = ...
"
8104,What is the difference between INTERSECT and WHERE IN?,"SELECT name,date from customers
EXCEPT
SELECT name, date from orders
"
39247,SELECT product from subclass: How many queries do I need?,"SELECT
  t.product_type_name,
  t.product_type_id 
  p.product_id,
  p.product_name,
  p.[common attributes to all products...],
  m.*,
  w.*
FROM
  product p
  INNER JOIN product_type t ON t.product_type_id = p.product_type_id
  LEFT  JOIN magazine     m ON m.product_id      = p.product_id
  LEFT  JOIN web_site     w ON w.product_id      = p.product_id
WHERE
  p.product_id = ?
"
23847,How can I get the percentage of total rows with mysql for a group?,"select num, string, 100 * num / total as percent
from (
    select count(*) as num, string
    from useragent_ip
    left join useragents on useragent_id = useragents.id
    group by useragent_id) x
cross join (
    select count(*) as total
    from useragent_ip
    left join useragents on useragent_id = useragents.id) y
order by num desc, string;
"
20124,Oracle: Check if rows exist in other table,"select O.ID
    , case when N.ref_id is not null then 1 else 0 end as ref_exists
from old_table o
left outer join (select distinct ref_id from new_table) N
   on O.id = N.ref_id
"
31345,SQL Query Performance Query,"Select * 
from vw_Employee  emp
Where emp.CostCentreId = @NodeId 
UNION
Select * 
from vw_Employee  emp
Where emp.DepartmentId=@NodeId 
UNION
Select * 
from vw_Employee  emp
Where emp.CompanyId=@NodeId 
UNION
Select * 
from vw_Employee  emp
Where emp.GroupId= @NodeId
"
28254,SQLbuilder LIKE parameters with %,"    for($i=0; $i < sizeof($tags); $i++){
        $queryBuilder->andWhere($queryBuilder->expr()->like('k.key', $queryBuilder->expr()->literal('%' . $tags[$i] . '%')));
    }
"
2535,Inefficient if/then loop in a SQL query,"If exists (Select * from A join B on A.id=B.id)
begin
    Select * from A join B on A.id=B.id
end
else
    Select 'No Results'
"
22380,query related to in clause,"SELECT
   table1.fid
FROM
      table1
   INNER JOIN
      table2
   ON
          table1.fid = table2.fid
      AND table1.field = table2.field
WHERE
       table2.name = 'dell'
   AND table1.queryorder <> 1
"
24350,Retrieve names by ratio of their occurance,"SELECT name, COUNT(name)/(SELECT COUNT(1) FROM names) FROM names GROUP BY name;
"
461,SQL performance on multiple id matching and a Join statement,"SELECT lt.link_id
   , GROUP_CONCAT(ls.link_title) as link_titles
   , GROUP_CONCAT(ls.link_url) as link_urls
FROM linkindex_tags lt
INNER JOIN links_sorted ls ON ls.link_id = lt.link_id
WHERE lt.word_id <= 1748
GROUP BY lt.link_id
ORDER BY
(
  lt.word_id IN (400,177,114,9,270,715,279,1,1748)
)  DESC
LIMIT 15 OFFSET 0;
"
32026,combine two columns only if both column has value in it,"SELECT CustFName + ' ' + JointCustFName as [BothName]
FROM table
WHERE custFName IS NOT NULL and JointCustFName IS NOT NULL
      and custFNAME <> '' and JointCustFName <> ''
"
23257,SQL self join query,"SELECT f.facilitatorName,
       SUM(case when ts.serviceTypeId = '1' then ts.capacity end) as Beds,
       SUM(case when ts.serviceTypeId = '2' then ts.capacity end) as Seats
FROM dbo.Facilitator as f
LEFT JOIN dbo.ServiceFacilitator as sf ON f.facilitatorId = sf.facilitatorId
LEFT JOIN dbo.TestService as ts ON sf.serviceId = ts.serviceId
GROUP BY f.facilitatorName
"
21585,"How can I get started with PHPUnit, where my class construct requires a preconfigured db connection?","public class TestMyACL extends PHPUnit_Framework_TestCase {

    protected $adapter;
    protected $config;
    protected $myACL;

    protected function setUp() {
        $this->adapter  = // however you create a new ZendDbADapter
        $this->config   = // however you create a new config array
        $this->myACL    = new ACL($this->adapter, $this->config); // This is the System  Under Test (SUT)
    }

}
"
9368,SQL Server 2008 R2 Express Row numbers,"ALTER TABLE dbo.YourTable
    ADD ID INT IDENTITY(1,1)
"
12426,Remove duplicates in Left join SQL Server,"Select o.OrderNumber, max(t.TrackingID) as TrackingId,
       o.BalanceDue, o.Approved, o.Name, o.ShipCity,  
       o.OrderDate, o.country, o.Shipping, o.CartId
from orders l left join 
     Tracking t
     on o.OrderNumber = t.ordernum 
group by o.OrderNumber, o.BalanceDue, o.Approved, o.Name, o.ShipCity, 
         o.OrderDate, o.country, o.Shipping, o.CartId;
"
10641,Difference Between Timestamps in Milliseconds in Oracle,"select
  extract(second from systimestamp - doj) * 1000
from
  test1;
"
33531,Type-based database design,"Student:
   id
   name
   class
   ...

Teacher:
   id
   name
   subject
   ...

voterType
   id 
   description (student or teacher)

contest:
   id
   description (ex: 1st Semester 2013)

contestVotes:
   id
   contestId
   voterType (Teacher or Student)
   voterId
   ratingTypeId
"
18691,yii2 upload file to database,"$model->file = UploadedFile::getInstance($model, 'file');//Get the uploaded file

$model->file->saveAs('uploads/' . $model->file->name);//Save uploaded file at your desired location

$user->image = $model->file->name;//image is my database field name,to only save the name of the uploaded file
"
19294,Replace/Assign a value in select statement,"select CASE paymentType WHEN 'p' THEN 'Part' WHEN 'f' THEN 'Full' END AS paymentType from paymentAccount
"
31126,Which query is more efficient if I use complex expressions?,"SELECT
    count(*),
    (age - 18) AS newcol
FROM qmao_person
WHERE age > 18
GROUP BY age
ORDER BY age DESC
"
3973,Is it possible to use a database sequence for a non-PK field in a Grails app?,"static mapping = {
    intField1 generator:'sequence', params:[sequence:'sequence_name']
    intField2 generator:'sequence', params:[table: 'hi_value', column: 'next_value', max_lo: 100]
} 
"
11697,AdventureWorks2012 DB - how the password validated in sql?,"CREATE STORED PROCEDURE CheckPassword
@username VARCHAR(20),
@password varchar(20)
AS
BEGIN

IF (CONVERT(NVARCHAR(4000), HASHBYTES('sha1', @password), 1)) <> (select PassColumn from myTable WHERE myUser = @username )
BEGIN 
    print 'Password Matches'
END
else
    print 'Password does not match'
END
"
26239,Write a T-SQL query that filters records containing NCHAR(2028),"select * 
from tablename
where columnname COLLATE Latin1_General_Bin like '%' + NCHAR(2028) + '%'
"
27507,Writing Lengthy SQL queries via RODBC in R,"my_query <- paste(readLines('your_query.sql'), collapse='\n')
results <- sqlQuery(con, my_query)
"
15361,MySQL Count paid sales and orders,"select Sales.id,
    Max(Sales.price) Sales_price,
    Sum(Payment.price) Payment_price
from Sales, Payment
where Sales.id = Payment.sale_id
group by Sales.id
having Max(Sales.price) = Sum(Payment.price)
"
32725,MYSQL IF ELSE? What is the correct statement to use (stock from multiple suppliers),"SELECT name, MIN(price) AS minPrice, coalesce(sum(quantity), 0) AS quantity 
FROM products
GROUP BY name;
"
34047,Using cookie to execute SQL select,"var customerName = """";
var customerEmail = """";
if (Request.Cookies[""BookingReq""] != null) {
    var breq = db.Query(""SELECT * FROM BookingRequests WHERE BookingGUID = @0"", Request.Cookies[""BookingReq""].Value);
    //I don't know webmatrix so I don't know what happens to breq if that value doesn't exist - I'll assume it's null
    if (breq != null) {
        customerName = breq.CustomerName;
        customerEmail = breq.CustomerEmail;
    }
}
"
7446,Complex sql query with multiple tables,"SELECT C.ID_CUSTOMER, C.Name, 
      SUM(P.PRICE * O.QUANTITY) AS Total FROM Customers C 
      JOIN Orders O ON C.CUSTOMER_ID = O.CUSTOMER_ID
      JOIN Procucts P ON P.PRODUCT_ID = O.PRODUCT_ID
      GROUP BY C.ID_CUSTOMER, C.Name
      HAVING SUM(P.PRICE * O.QUANTITY) >= 10000
"
4773,Create MySQL Tables with Ansible,"- mysql_db: name=my_db state=import target=/tmp/dump.sql.bz2
"
18690,oracle select from a in memory table in PLSQL,"declare
  x sys.odcinumberlist := sys.odcinumberlist(123);
  y number;
begin
  select column_value into y from table(x);
  dbms_output.put_line(y);
end;
"
13849,SQL Server CHECK Constraint - Ensure no duplicates on text,"ALTER TABLE MyTable ADD CONSTRAINT UK_MyUniqueConstraint UNIQUE (MyColumn)
"
32333,Can I avoid rewriting a table expression in an update?,"UPDATE rem
   SET rem.a = loc.a
  FROM OPENQUERY( server, 'SELECT a from b' ) rem
      ,local_table loc
 WHERE rem.id = loc.id
"
7159,Querying a table that contains an XML column,"SELECT TOP 1000 [Id]
    ,[Name]
    ,[Value]
FROM [MyTable]
where CAST(Value AS VARCHAR(MAX)) like '%something%'
"
11782,How to get initials easily out of text field using Postgres,"select full_name, string_agg(substr(initials, 1,1)||'.', ' ') initials
from (
    select full_name, unnest(string_to_array(full_name,' ')) initials
    from my_table
    ) sub
group by 1;

       full_name        |  initials   
------------------------+-------------
 Phil Smith             | P. S.
 Joe Blow               | J. B.
 Jose Maria Allan Pride | J. M. A. P.
 Eric A. Korver         | E. A. K.
(4 rows)
"
36063,How to convert time which is in GPS format to Local time format in SQL?,"declare @x bigint = 1392979784822
declare @msin1day bigint = 3600 * 24 * 1000

select dateadd(ms, @x % @msin1day, dateadd(day, @x / @msin1day, '19700101'))

(No column name)
2014-02-21 10:49:44.823
"
35684,Remove incomplete ISO dates from SQL query?,"where DATE_COL not like '%-00-00'
"
21658,SQL Concatenate both lines in a single one,"select key, col1, col2, col3, string_agg(col4, ';')
from t
group by key;
"
18773,How do I restore one database from a mysqldump containing multiple databases?,"cat mysqldumped.sql | \
sed -n -e '/^CREATE DATABASE.*`the_database_you_want`/,/^CREATE DATABASE/ p' | \
sed -e '$d' | \
mysql
"
6804,Datetime and Integer functions on Varchar fields,"SELECT Column1, Column2
FROM Table
WHERE CONVERT(datetime, DateColumn, 3) BETWEEN @StartDate AND @EndDate
"
2286,How to insert a record in many to many relationship tables?,"alter table teacher_student
   add constraint s_t_fk_t foreign key (T_Id)
   references teachers (id)
   on delete cascade
   on update cascade;

alter table teacher_student
   add constraint s_t_fk_s foreign key (S_Id)
   references students (id)
   on delete cascade
   on update cascade;
"
24897,Limiting the count in group by," select id,
        (select count(*) from t2 where t2.id = t1.id and rownum <= 3) c_star
 from   t1
"
29966,Can there be constraints with the same name in a DB?,"CREATE TABLE BankAccount
(
    BankAccountID   INT            PRIMARY KEY,
    EmployerCode    VARCHAR(20)    NOT NULL,
    Amount          MONEY          NOT NULL,
    CONSTRAINT FK_BankAccount_Employer 
        FOREIGN KEY (EmployerCode) REFERENCES Employer
)
"
31055,Saving SQL files into specific folders in Oracle,"edit c:\users\dibya\projects\erp\logindetails.sql
"
7991,Adding column to Oracle OLTP table,"create or replace 
procedure execDDL(ddl in varchar2) is
   myexp EXCEPTION;
   pragma exception_init (myexp, -54);
begin

 loop
   begin
      execute immediate ddl;
      exit;
   exception
      when myexp then 
         null;
 end loop;
 end;
"
6386,SQL replace old values with new ones,"Update  tbl.Products
Set articlenumber = replace(articlenumber, 's401', 'I00010')
"
12170,Building a complex SQLite query,"select 
  c.name as ""Conference Name"",
  c.Date, 
  coalesce(n2.name, n2.""fallback_name"") as ""Main Contact"",
  group_concat(coalesce(n.name, n.""fallback_name""), ', ') as Attendees
from conferences c
inner join attendees a on c.""Conference ID"" = a.""Conference ID""
inner join name n on n.id = a.""Name Row""
inner join name n2 on n2.Contact_id = c.""main_contact""
group by c.name 
order by c.date
"
38435,How to merge multiple tables in MYSQl which have two columns in common,"SELECT table_1.*, table_2.*, table_3.*, table_4.* FROM table_1  
  INNER JOIN table_2 ON table_1.age_grp = table_2.age_grp  
    AND table_1.gender = table_2.gender
  INNER JOIN table_3 ON table_2.age_grp = table_3.age_grp  
    AND table_2.gender = table_3.gender
  INNER JOIN table_4 ON table_3.age_grp = table_4.age_grp  
    AND table_3.gender = table_4.gender
"
5534,sum record by the acceptance condition in MySql,"SELECT SUM(accepted = 0) zero
     , SUM(accepted = 1) one
     , SUM(accepted = 2) two 
  FROM my_table 
 WHERE date BETWEEN '2016-01-01 00:00:00' AND '2016-01-22 23:59:59';
"
14996,Sql join and insert if not exists,"Insert into Itemlookup (ItemNumber, Cases, [TimeStamp])
Select a.ItemNumber, b.CaseCount, a.TimeStamp 
from ItemsProduced a 
inner join MasterItemList b on a.ItemNumber = b.ItemNumber
left join Itemlookup i on i.ItemNumber = a.ItemNumber
                      and i.Cases= b.CaseCount
                      and i.TimeStamp = a.TimeStamp 
where i.ItemNumber is null
"
21776,Retain NULL in MAX() ORDER BY,"select seq_no, timestamp, 
       (case when timestamp is not null
             then max(timestamp) over (partition by seq_no)
        end) as maxtimestamp
from temp
"
24689,Conditional select statement,"SELECT *
FROM Table1
WHERE
  IIF(VAL IS NULL, 0, 1) +
  IIF(EQ IS NULL, 0, 1) + 
  IIF(EFF IS NULL, 0, 1) + 
  IIF(SIZE IS NULL, 0, 1) + 
  IIF(FSCR IS NULL, 0, 1) +
  IIF(MSCR IS NULL, 0, 1) + 
  IIF(SY IS NULL, 0, 1) >= 4
"
9003,How would you add a column that only has a set choice of values?,"Gender VARCHAR(6) NOT NULL CHECK (Gender IN ('Male', 'Female'))
"
7525,"Foxpro database and date, how?","Select * from table where between(mydate, gomonth(mydate, -12), mydate)
"
25269,Rename XML Node Name in XML column SQL Server using SQL Script,"update yourtable
set yourcolumn = 
       replace(cast(yourcolumn as nvarchar(max)), 'TestName', 'ValidationName');
"
25914,Add Case Statement in Where Clause,"SELECT * 
FROM  myTable
WHEN  id = 12345
AND   ((TermDate IS NULL AND 
        getdate() BETWEEN StartDate AND DATEADD(dd, 30, StartDate)) OR
       GETDATE() < TermDate)
"
15502,sql join within join?,"SELECT
  files.Id, files.Name, links.Id, links.Name
FROM
  files, links
INNER JOIN
  folder_files
  ON files.Id = folder_files.File_Id
INNER JOIN
  links
  ON links.Id = folder_files.Folder_Id
WHERE
  files.Id = 10
ORDER BY
  folder_files.File_Id ASC, links.Id ASC
LIMIT 1;"
29887,Select unique results and null,"select t.id, t.name, t.`group`
from tablename t 
join (select `group`, min(id) as mid
      from tablename
      where `group` is not null
      group by `group`) x on x.mid = t.id and x.`group` = t.`group`
union all 
select id, name, `group` 
from tablename
where `group` is null
"
38839,Limit SQL query to only the top two counts per group,"SELECT
   State,
   flv,
   total
FROM (SELECT
         ROW_NUMBER() OVER ( PARTITION BY state ORDER BY count(INITCAP(TRIM(flavor))) DESC ) RowNumber,
         State,
         INITCAP(TRIM(flavor)) flv,
         count(INITCAP(TRIM(flavor))) total
      FROM favorite_flavor
      GROUP BY state, INITCAP(TRIM(flavor))
      ) dt
WHERE RowNumber <= 2
ORDER BY state ASC, total DESC
"
29462,SQL Server : Query using data from a file,"SET NOCOUNT ON;

USE Your_DB;

GO

CREATE TABLE dbo.t (
    i int, 
    n varchar(10),
    d decimal(18,4),
    dt datetime
    );
GO


BULK INSERT dbo.t
    FROM 'D:\import\data.txt'
    WITH (FIELDTERMINATOR = ',', ROWTERMINATOR = '\n');
"
13195,N+1 query where the 'n' part is not always there but I need a default value,"select
 p.*,
 c.role
from projects p
left join collaborations c 
 on 
  c.project_id = p.project_id
   and
  c.user_id = 2
   and
  c.role in ('Leader', 'Member')
where
 p.is_archived = false
"
22010,Select from multiple tables with multiple where clauses,"select 
    casestatus.casestatusid,
    casestatusdesc,
    COUNT(caseid)
from casestatus
    left join cases 
        on casestatus.casestatusid = cases.casestatusid
        and cases.isdeleted=0
where
    casestatus.isdeleted=0
group by    
    casestatus.casestatusid,
    casestatusdesc
"
37007,Get values from first and last row per group,"select t.name, min(t.week) as minWeek, max(firstvalue) as firstvalue,
       max(t.week) as maxWeek, max(lastvalue) as lastValue
from (select t.*, first_value(value) over (partition by name order by week) as firstvalue,
             last_value(value) over (partition by name order by week) as lastvalue
      from table t
     ) t
group by t.name;
"
2750,MYSQL applying a group by to a rank column,"FIND_IN_SET(points_total, (
        SELECT GROUP_CONCAT( points_total ORDER BY points_total DESC )
        FROM user_results ur2
        WHERE ur2.race_id = ur.race_id)) as Rank
"
30759,Android SQLite Delete row issue,"db.delete(DBAdapter.TableName, ""Id=? AND QstnrId=? AND QstnId=?"",
          new String[] { Id.toString(), QuestionnaireId, QuestionId });
"
4705,SQL - Getting Most Recent Date From Multiple Columns,"SELECT MAX(CASE WHEN (DateDeleted IS NULL OR DateModified > DateDeleted)
                THEN DateModified ELSE DateDeleted END) AS MaxDate
FROM Table
"
30481,Strange behaviour of hierarchical query,"SELECT 
   SYS_CONNECT_BY_PATH(DUMMY, '/') 
FROM 
   DUAL 
CONNECT BY 
   LEVEL<4;

SYS_CONNECT_BY_PATH(DUMMY,'/')
--------------------------------
/X
/X/X
/X/X/X
"
36596,SQL joining tables only on specific rows,"select t1.parameters,
  t1.value,
  case when t2.mammal is null then '' else t2.mammal end Mammal
from table1 t1
left join table2 t2
  on t1.value = t2.animal
"
10919,SQL: Expand 1 Column into 3 on Summarize Table,"SELECT 
    Product,
    MAX(CASE WHEN Availability='Store1' THEN 'Yes' ELSE 'No' END) AS Store1,
    MAX(CASE WHEN Availability='Store2' THEN 'Yes' ELSE 'No' END) AS Store2,
    MAX(CASE WHEN Availability='Store3' THEN 'Yes' ELSE 'No' END) AS Store3
FROM YourTable
GROUP BY Product
"
1744,"GROUP BY, ORDER BY - How to make group by consider latest apperance of item","SELECT 
  p.p_pid, 
  p.p_name, 
  p.p_url 
FROM products p 
INNER JOIN activity a on p.p_pid = a.a_pid 
WHERE 
  a.a_uid= "".$uid_int."" 
GROUP BY 
  p_pid, p_name, p_url
ORDER BY 
  max(a.a_time) DESC 
  LIMIT 6
"
9748,sql filter many to many relationship,"SELECT
    ct.competition_id FROM
    competitions c
JOIN competition_type ct ON ct.competition_id = c.id AND ct.Type_id = 1 
WHERE
    NOT EXISTS(SELECT * FROM competitions c2 
                     JOIN competition_type ct2 
                     ON ct2.competition_id = c2.id AND ct2.Type_id = 2 
                     WHERE c2.id = c.id)
"
38183,Run Postgres query that groups by one field and sorts by another,"select t1.url, t2.title, t1.cnt
from (
  select url, count(title) cnt 
  from headlines 
  group by url
) t1
join (
  select distinct on (url) url, title 
  from headlines 
  order by url, created_at desc
) t2 on t1.url = t2.url
order by t1.url
"
28197,How to insert a record and make sure the entire row is unique,"INSERT INTO myCities (UserID,CityID) 
SELECT @UserID,@CityID
        WHERE NOT EXISTS ( 
                   SELECT UserID FROM myCities 
                   WHERE 
                   UserID = @UserID and 
                   CityID = @CityID
                 )
"
21957,record still appears after deleting,"SELECT distinct 
dbo.HrEmployee.EmplID, 
dbo.HrEmployee.EmplName, 
dbo.AtdRecord.RecDate, 
dbo.AtdRecord.RecTime, 
dbo.HrDept.DeptName
FROM dbo.HrDept 
left outer JOIN dbo.HrEmployee
ON dbo.HrDept.DeptID = dbo.HrEmployee.DeptID 
left outer JOIN dbo.AtdRecord 
ON dbo.HrEmployee.EmplID = dbo.AtdRecord.EmplID
where HrEmployee.EmplID = 13
"
7125,Matching databases data,"SELECT COUNT(*) num_mismatch
FROM table1 JOIN table2 ON (..whatever the unique ID you use for matching is...)
WHERE table1.col1 != table2.col1 OR table1.col2 != table2.col2 OR ......etc.
"
20100,Optimizing Oracle query,"SELECT MAX(verification_id)
  FROM VERIFICATION_TABLE
 WHERE head = 687422
   AND mbr = 23102
   AND TRIM(lname) = '.iq bzw'
   AND TRUNCATE(dob) = TO_DATE('08/10/2004')
   AND system_code = 'M';
"
6946,Dynamic SQL - something up with the where clause,"Create PROCEDURE [dbo].[myProc]
@TableName nvarchar(100), 
@RowID int
AS
BEGIN
    DECLARE @SQLQuery NVARCHAR(500); 
    IF (OBJECT_ID(@TableName) IS NOT NULL)
        BEGIN
            SET @SQLQuery = 'Select * from ' + QUOTENAME(@TableName) + ' where ID = @RowId' 
            EXECUTE sp_executesql @SQLQuery, N'@RowId INTEGER', @RowID
        END
END
"
5389,SQL Query to get the emp and corresponding manager from Emp Audit table,"SELECT Emp_ID, manager_ID, Date
FROM
(
    SELECT  Emp_ID, manager_ID, Date,
            ROW_NUMBER() OVER (PARTITION BY Emp_ID ORDER BY DATE DESC) rn
    FROM    tableName
) a
WHERE   rn = 1
"
26897,loop with variable in sqlite3,"use strict; use warnings;

my $formatString = ""attach 'database%04d.db3' as toimport;
insert into [main].[Titles] select * from [toimport].[Titles];
insert into [main].[TitlesData] select * from [toimport].[TitlesData];
DETACH DATABASE toimport;\n"";

for (my $variable = 1; $variable <= 30; ++$variable) {
        printf ($formatString, $variable);
}
"
12078,(SQL) Any Ideas for a Query?,"SELECT
a.Team
,d.Field
FROM TAnswers a
LEFT JOIN SecondTable b on a.Field = b.Field
LEFT JOIN ThirdTable c on a.Field = c.Field
LEFT JOIN FourthTable d on a.Field = d.Field
"
867,SQL Table Max Rows,"2000000000000 bytes / 4 bytes per field = 500000000000 = 5 billion records
"
5621,LIMIT optimized queries,"SELECT id FROM foo1
INTERSECT ALL  -- don't fold dupes
SELECT id FROM foo2
LIMIT 50;

SELECT * FROM foo1 JOIN foo2 USING (id) LIMIT 50; -- return single id column"
13683,mysql join respect to a column,"select name,email 
from tbl1 t1
LEFT JOIN tbl2 t2 
  on t1.id = t2.id2;
"
29516,How to select only distinct row when there might be duplicates using SQL?,"select fname, lname, phone, email, job
from (
    SELECT fname, lname, phone, email, job,
        row_number() over (
            partition by fname, lname, phone, email
            order by primary_job_ind desc
        ) r
    FROM phonedirectory
) where r = 1
"
31694,sql - left join - count,"   SELECT a.articleid, 
          COUNT(*) AS num_comments
     FROM ARTICLES a
LEFT JOIN COMMENTS c ON c.articleid = a.articleid
 GROUP BY a.articleid
"
22197,SQL model optimization question,"UPDATE hit_count_table SET hit_count = hit_count + 1
   WHERE user_id = :userid AND thing_id = :thingid;
"
11252,How to implement the greater than or equal SQL statement in iBatis?,"WHERE numberOfCookies &gt;= 10
"
3023,Change datatype of entire database SQL,"SELECT 'ALTER TABLE ' + OBJECT_NAME(c.object_id) + ' ALTER COLUMN ' + c.name + ' DECIMAL(30,10);' AS sqlCommand
FROM sys.columns AS c
INNER JOIN sys.types AS t ON t.system_type_id=c.system_type_id
WHERE t.name='float';
"
15924,Strip first whitespace importing csv data,"CREATE TEMP TABLE tmp_x AS
SELECT * FROM users LIMIT 0;   -- empty temp table with structure of target

\copy tmp_x FROM '/absolute/path/to/file' delimiters E';'; -- psql command (!)

INSERT INTO users
      (usr_id,       usr,  ...) -- list columns
SELECT usr_id, ltrim(usr), ...
FROM   tmp_x;

DROP TABLE tmp_x;  -- optional; is destroyed at end of session automatically
"
28132,merged SQL table names,"SELECT 
     Name, 
    'Users' AS Type 
FROM users 
WHERE name LIKE '%alex%'
UNION
SELECT 
     Name, 
     'Admins' AS Type 
FROM admins 
WHERE name LIKE'%alex%'
"
29003,"Removing ending letter from number, and ordering","order by cast(rtrim(substr(col_name, 1, LENGTH(col_name) - 1)) as int);
"
39094,How to update and format every fields of a column in SQL Server?,"UPDATE [Table] SET [Column] = STUFF([Column],5,0,' ');
"
37620,SQL Server LIKE comparison,"SELECT KB.*, VN.VDescription
FROM Knowledge_Base KB

INNER JOIN 
   (
   select V.[Name] as VDescription, K.Description as KDescription
   FROM vendor, knowledge_base 
   where knowledge_base.description like '%' + vendor.name + '%'
   ) VN
ON KB.Description = VN.KDescription
"
10472,SQL conditional insert into,"insert into [table] (#FIELDS#)
select (#VALUES#) from [table]
where (select count(*) from [table]) < 5
FETCH FIRST ROW ONLY
"
16522,Do triggers have any performance impact on the stored procedure,"     BEFORE or  AFTER 
"
20046,SQL: Create a view that creates a position based on a date,"select pt.*,
       row_number() over (partition by code order by code) as Position
from PositionTest pt
"
5209,Postgres: Get aggregation query based on multiple values in a column,"SELECT owner_id, count(partner_id),
       sum(case when level = 'gold' then 1 else 0 end) as gold,
       sum(case when level = 'silver' then 1 else 0 end) as silver,
       sum(case when level = 'bronze' then 1 else 0 end) as bronze
FROM owner_partner
GROUP BY owner_id;
"
2705,query the highest latest userid,"select name, max(userid) as max_userid
from users
group by name
order by max(userid) asc
"
35182,MySQL special ORDER BY,"SELECT * FROM `table` ORDER BY FIELD(`genre`, 'horror', 'scifi', 'horror'), `name`;
"
18735,Highest Count with a group,"with cte as (
    select p.productcategory, p.ProductSubCategory, COUNT(*) cnt, 
        ROW_NUMBER() over (partition by p.productcategory order by count(*) desc) rn 
    from products p 
        join sales s on p.ProductSubCategory = s.ProductSubCategory
    group by p.productcategory, p.ProductSubCategory
    )
select * 
from cte 
where rn = 1
"
27503,Postgres: select n unique rows for ID,"select id, make, model, type
from (
  select id, make, model, type, 
         row_number() over (partition by id order by make) as rn
  from the_table
  where type = 'coupe'
) t
where rn <= 2
order by id, make;
"
6458,Fast search of nearest values in SQL,"select * from pos order by ((lat-48.00333)*(lat-48.00333)+(long-11.0)*(long-11.0)+(alt-652)*(alt-652));
"
13475,What does a (+) sign mean in an Oracle SQL WHERE clause?,"SELECT t0.foo, t1.bar
  FROM FIRST_TABLE t0
 RIGHT OUTER JOIN SECOND_TABLE t1;
"
7942,Count and group by join,"SELECT
    products.product,
    COUNT(users.prod_id) AS productsBought
FROM
    A AS products
    INNER JOIN B AS users
        ON products.prod_id = users.prod_id
WHERE products.site_name = 'ebay'
GROUP BY products.product
"
37173,Split and select specific values from sqlserver table,"SELECT distinct year( convert(datetime,StartDate,105)) 
FROM [kneipp].[dbo].[kn_projects]
"
5576,SQL Server : how to parse a column value and insert in multiple columns of separate table?,"INSERT INTO STG_TXN
select SUBSTRING(address,0,LEN(address) - 4),SUBSTRING(address,LEN(address) - 3,2)
,SUBSTRING(address,LEN(address) - 1,2)
from CUSTOMER
"
5883,Produce as many lines in SQL thant an integer in a column,"create table t (id varchar(10), num int);

insert into t values('0A',3);
insert into t values('4B',2);

create table nums (n int);

insert into nums values(1);
insert into nums values(2);
insert into nums values(3);
insert into nums values(4);
insert into nums values(5);
insert into nums values(6);

select concat(t.id,'00',nums.n)
from nums join t 
on nums.n <= t.num;
"
2003,Deleting non matching records from a table prior to linking,"DELETE FROM LandingDetails WHERE LandingId NOT IN (SELECT LandingId FROM LandingHeaders)
"
19347,how to get days out of date using sql,"select 
   date(google_date) as dateday, 
   sum(google_orders) as total 
from site_google 
where 
date_sub(curdate(), interval 120 day) <= google_date 
and dayofweek(date(google_date)) = 2
group by dateday
"
26147,How to Sum multiple lines in sql,"SELECT Company_Name, Company_ID, SUM(Amount) 
FROM TableName GROUP BY Company_Name, Company_ID
"
20356,SQL Count divided by count,"select sum(case when order_number like ""2%"" and gender <> """" then 1.0 else 0 end) / count(*)
from db;
"
12840,SQL Nested Query Homework,"CREATE VIEW  ThisYear AS 
    SELECT v.pid,v.vid,v.did
    FROM Visits v
     WHERE v.date LIKE '%2012';

CREATE VIEW DoctorsVisitCount AS
    SELECT v.did, COUNT(v.vid) as c
    FROM ThisYear v
    GROUP BY v.did;

SELECT DISTINCT d.did,d.dname,dvc.c
FROM Doctors d,DoctorsVisitCount dvc
WHERE dvc.c < (SELECT AVG(dvc.c)
               FROM DoctorsVisitCount dvc);
"
4433,Unique constraint in PL/SQL of date field limited to the year,"create unique index unique_year 
  on the_table (the_varchar_column, extract(year from the_date_column));
"
29122,Query Time range between Dates using DATETIME mysql,"WHERE HOUR(TIME)...GROUP BY DAY(TIME) 
"
3647,Comparing phone numbers sql,"ALTER TABLE dbo.YourSecondTable
ADD NormalizedPhone AS REPLACE(REPLACE(PhoneColumn, '-', ''), ' ', '') PERSISTED
"
543,MySql select from two tables statment,"SELECT
  u.id,
  u.name,
  u.isSpecial,
  d.country,
  d.zipCode
FROM Users u
LEFT JOIN Detals d
ON u.id = d.userId
WHERE u.name = 'Jorden'
  OR u.isSpecial = 1
"
8179,Print equivalent on Oracle PLSQL,"set feedback off
"
9302,SQL Server - Simultaneous Inserts to the table from multiple clients - Check Limit and Block,"DECLARE @SumSaleValue MONEY

BEGIN TRAN

SELECT @SumSaleValue = SUM(SaleValue)
FROM dbo.Orders WITH (UPDLOCK, HOLDLOCK)
WHERE TransactionId = @TransactionId

IF @SumSaleValue > 1000
    BEGIN
    RAISERROR('Cannot do insert as total would exceed order limit',16,1);
    ROLLBACK;
    RETURN;
    END

/*Code for INSERT goes here*/

COMMIT
"
24831,is it possible to Sum values grouped by month?,"SELECT YEAR([Calendar Date]) As [YEAR],
       Month([Calendar Date]) As [Month],
       SUM([Working Day] As [Working Days]
FROM [Calendar]
GROUP BY YEAR([Calendar Date]), 
         Month([Calendar Date]) 
"
23732,T-SQL How to select rows without duplicate values from one column?,"SELECT MAX(ID) as [ID], ID_PROJ_CSR
FROM my_table
GROUP BY ID_PROJ_CSR
"
19150,Select multiple records as multiple columns in SQL,"select id,
       max(case when seqnum = 1 then name end) as name1,
       max(case when seqnum = 2 then name end) as name2,
       max(case when seqnum = 3 then name end) as name3
from (select t.*, row_number() over (partition by id order by name) as seqnum
      from table t
     ) t
group by id;
"
36912,TSQL where case,"select *
from [table]
where case when var_c = 'something' then var_a else var_b end = '10'
"
20650,OUTER JOIN using IN list?,"select customers.custid, name, email
  from customers
    left outer join dbo.get_id_table('1111', '2222', '3333', '4444') as ids
      on (customers.custid = ids.custid)
"
12210,Sorting Child Related Rows Consecutively after Parent Rows,"select * from test
order by coalesce(parentid,id)
"
36185,Is there a way to select like with custom separator,"SELECT ""id""
FROM ""table""
WHERE '|' || ""names"" || '|' LIKE '%|bar|%';
"
17568,How to design an election poll database,"SELECT
    p.PartyName,
    s.StateName,
    c.CityName,
    v.TotalVotes
FROM
    Votes v
        INNER JOIN Party p ON p.PartyId = v.PartyId
        INNER JOIN City c ON c.CityId = v.CityId
            INNER JOIN State s ON s.StateId = c.StateId
"
21979,SQL - Group by special case,"SELECT 
   t1.WO,
   t1.x - t2.x,
   t1.y - t2.y,
   t1.z - t2.z,
   t1.date
FROM tab AS t1
JOIN 
 (
   SELECT tab.*,
      ROW_NUMBER()
      OVER (PARTITION BY WO 
      ORDER BY date) AS rn
   FROM tab
 ) AS t2
  ON t1.WO = t2.WO 
 AND t1.date <> t2.date
 AND t2.rn = 1
"
32239,SQL -- Show results only when count's higher than xx,"SELECT 
    Query,
    SUM(CASE WHEN SearchDate >= '2012-01-01' and SearchDate < '2013-01-01' THEN 1 ELSE 0 END) as Year2012,
    SUM(CASE WHEN SearchDate >= '2013-01-01' and SearchDate < '2014-01-01' THEN 1 ELSE 0 END) as Year2013
FROM dbo.tblSearch WITH (NOLOCK)
WHERE DomainProjectID=13
GROUP BY Query
having 
  SUM(CASE WHEN SearchDate >= '2012-01-01' and SearchDate < '2014-01-01' 
           THEN 1 
           ELSE 0 
      END) >= 100 
"
19796,What database can store trees?,"CREATE TABLE IF NOT EXISTS article
(
    article_id integer not null auto_increment,
    comment_id integer,
    primary key(article_id),
    constraint fk_comment foreign key(comment_id) references article(article_id) on delete cascade on update cascade
);
"
12267,Mysql: How to update current rows with the value of current - x row's value?,"set @previousRow1 = 0.0,@previousRow2 = 0.0,@previousRow3 = 0.0;
ALTER TABLE b ADD previousRow Double;
UPDATE `b` SET `result`=@previousRow1 
      , @previousRow1 = @previousRow2
      , @previousRow2 = @previousRow3
      , @previousRow3 = `x`;
"
8264,how to use an in clause to check if a column is a certain string or not when referencing 3 tables,"SELECT r.*, e.EquipmentName
FROM TRIDENT.Maintenance.RCFAs AS r
LEFT JOIN TRIDENT.Maintenance.Equipment AS e
    ON e.EquipmentId = r.EquipmentId
JOIN TRIDENT.Maintenance.RCFAXrefComponents AS c
    ON c.Year = r.Year
    AND c.RCFAId = r.RCFAId
WHERE c.ComponentID = 'BOLTS'
"
2222,When does full text index update in sql server?,"SELECT OBJECT_NAME(object_id), is_enabled, has_crawl_completed, crawl_type, crawl_start_date, crawl_end_date
FROM sys.fulltext_indexes;
"
5824,Return group_concat with multiple rows,"SELECT orderLine.orderId,
       GROUP_CONCAT(orderLine.productId)
FROM orders
  INNER JOIN orderLine ON orders.orderLineId = orderLine.orderId
WHERE orders.orderId = 1
GROUP BY orderLine.orderId
"
18427,joining 4 tables in mysql," SELECT r.* FROM room r LEFT JOIN `reservationroom` rr ON r.`hotelID` = rr.`hotelID` AND r.`roomID` = rr.`roomID`
 WHERE ( rr.`reservationroomID` = '' OR rr.`reservationroomID` IS  NULL );
"
38975,Adding where clause to MySQL session,"CREATE VIEW view2 AS SELECT * FROM table1 WHERE companyid = 2;
"
12249,Finding similarity between users in telecomunication network,"SELECT C1.UserID AS User1, C2.UserID AS User2
  FROM CallingList AS C1
  JOIN CallingList AS C2 ON C1.PhoneNumber = C2.PhoneNumber
 WHERE C1.UserID < C2.UserID
 GROUP BY C1.UserID, C2.UserID
HAVING COUNT(*) >= 3
"
16517,Limiting integer data type field lengths,"delimiter //
CREATE TRIGGER trigger_check BEFORE INSERT ON your_table
FOR EACH ROW 
BEGIN 
    IF NEW.NUM > 99999 THEN 
        SET NEW.NUM = 0; 
    END IF; 
END
//
"
358,MySQL - Return parent records based on conflicting WHERE clauses on child records,"SELECT orders.id, SUM(lines.supplier_id = 1) AS wanted,
    SUM(lines.supplier_id <> 1) AS unwanted
FROM orders
INNER JOIN lines lines.order_id = orders.id
GROUP BY orders.id
HAVING unwanted = 0 AND wanted > 0
"
38859,Structuring user data by email address or by user ID,"users
  uid_0
   name:
   gender:
   etc
  uid_1
   name:
   gender:
   etc
"
14707,MySQL equally distributed random rows with WHERE clause,"    SELECT r1.*
    FROM
        (SELECT  person_id,
                 @curRow := @curRow + 1 AS row_number
        FROM persons as p,
             (SELECT @curRow := 0) r0
        WHERE points>0) r1
    , (SELECT COUNT(1) * RAND() id
       FROM persons
       WHERE points>0) r2
    WHERE r1.person_id>=r2.id
    ORDER BY r1.person_id ASC
    LIMIT 1;
"
16171,"TSQL, Ordering of ORDER BY","SELECT *
FROM table
ORDER BY age DESC,
         name ASC
"
13932,"SQL Server Multiple LEFT JOIN, one-to-many","SELECT a.NAME
    ,b.address
    ,c.phone
FROM tblname a
LEFT JOIN tbladdress b ON a.nid = b.nid
LEFT JOIN tblPhone c ON a.PID = c.PID
"
21140,Fail to use Not Like in sql,"SELECT 
   CASE CHARINDEX( '?', SessionURL)        
      WHEN 0 THEN SessionURL         
   ELSE LEFT(SessionURL, CHARINDEX( '?', SessionURL) - 1) END AS VisitPage , count(1) as [VisitTime]  
  FROM VistedURL
  GROUP BY SessionURL WHERE SessionURL NOT LIKE '%admin%'
"
7645,how to group by time stamp field?,"select productid, time::DATE as dt, sum(qty)
from tablename
where action like 'in'
group by productid, time::DATE
"
10132,Windowed Functions in SQL Server 2014,"WITH CTE 
     AS (SELECT TotalContacts, 
                Count(C.PatientID) 
                  OVER (Partition BY C.HospCode) AS Cnt
         FROM   Totals AS T 
                INNER JOIN Contacts AS C 
                        ON T.HospCode = C.HospCode) 
UPDATE CTE 
SET    TotalContacts = Cnt
"
17754,Scrub email address from Mysql,"UPDATE YourTable
    SET EmailColumn = 'xxx' + RIGHT(EmailColumn, LENGTH(EmailColumn) - LOCATE('@', EmailColumn) + 1)
"
35411,Is a partial delete of column values in SQL database?,"update t
    set location = replace(replace(replace(location, 'R00', ''), 'B00', ''), 'L00', '');
"
36430,How to add a custom column with a default value in an sql query?,"select first_name, 
       last_name,
       'test' as default_value, --<< a ""virtual"" column containing a character value
       42 as the_answer         --<< another column containing a numeric value
from table1 
  join table2 on table1.id = table2.customer_id;
"
2765,How to extract info from database to excel,"select t1.SKU SKU, concat(t1.SerialNo, ""  "", t1.grade) SerialGrade from yourTable t1
    join tempTable t2 on t2.SerialNo = t1.SerialNo
    orderby t1.SerialNo ASC
"
35603,SQL Query to match if data is not present in another table,"SELECT Name
  FROM tblFolding 
  WHERE FoldingID NOT IN (
    SELECT FoldingID
    FROM tblStockManagement 
  )
;
"
39873,SQL Change Text To Unique ID Number,"select StateId, StateName, UniqueId from states
INNER JOIN countries
ON states.CountryName = countries.CountryName;
"
11405,SQL: replacing a value with corresponding values in differet table after join,"select survey.worker_id,
   (Select Value from Code where ID = survey.code_number_of_days_id) as No_of_Days,
   (Select Value from Code where ID = survey.code_gender) as Gender,
   Info.Name, 
   (Select Value from Code where ID = Info.code_category_id) as Category,
   (Select Value from Code where ID = Info.code_confirmed_status_id) as Confirmed,
from Survey 
full outer join Info 
on Survey.worker_id = Info.id 
"
35727,Get the correct days in vacation accumulation report,"select (case when DATEADD(year, datediff(year, hiredate, getdate()), hiredate) < GETDATE()
             then DATEDIFF(dd, DATEADD(year, datediff(year, hiredate, getdate()), hiredate), getdate())
             else DATEDIFF(dd, DATEADD(year, datediff(year, hiredate, getdate()) - 1, hiredate), getdate())
        end)
from preh;
"
15513,SQL query instead of loop,"SELECT country, count(*) 
FROM devices
GROUP BY country;
"
13126,"How to use ""like"" and ""not like"" in SQL MSAccess for the same field?","filed like ""*AA*"" and filed not like ""*BB*""
"
2879,"Django LEFT JOIN, efficiently?","for album in PhotoAlbum.objects.filter(title__startswith='The').prefetch_related('photo_set')[:10]:
    print album.photo_set.all()
"
10632,Split Result from SQL Query,"select * from 
( 
     select tb.*,rownum t_count from table_name tb
) ss
where ss.t_count >= @min_value and ss.t_count <= @max_value
"
33721,Finding unmatched records with SQL,"SELECT
    *
FROM
    Table2 T2
WHERE
    NOT EXISTS (SELECT *
        FROM
           Table1 T1
        WHERE
           T1.State = T2.State AND
           T1.Product = T2.Product AND
           T1.Distributor = 'X')
"
27426,how to change the value of a query returning TRUE/FALSE,"select case when md.seen_doctor = 'FALSE' 
            then 'Did not seek medical attention'
            else 'Did seek medical attention'
       end as res_checkbox
from your_table
"
19624,one table or several table in mysql,"alter table user_movies 
add primary key (user_id, movie_id)
partition by hash(user_id) partitions 100;
"
5300,Cannot search in all columns of differing types,"SELECT * 
  FROM (SELECT to_char(n) as n, s FROM t) 
UNPIVOT (anywhere FOR col IN (...));
"
5735,Random join in oracle,"with randomAddress as(
  select rownum id, street, num from (
    select * from addresses where valid=1 order by dbms_random.random
  )
),
randomPrename as(
  select rownum id, prename from(
    select * from person order by dbms_random.random
  )
),
randomSurname as(
  select rownum id, surname from(
    select * from person order by dbms_random.random
  )
)
select street, num, prename, surname
  from randomAddress
  join randomPrename using(id)
  join randomSurname using(id)
;
"
990,SQL query to implement multiple WHERE condition on same column,"SELECT  tbl1.uid, tbl2.id, tbl2.status 
 FROM tbl1
INNER JOIN tbl2 ON (tbl1.uid = tbl2.uid)
WHERE tbl2.status = 0
and tbl2.uid NOT IN (SELECT uid from tbl2 where status=1);
"
32903,Query to make group of records,"select name, max(colb), max(colm), max(colp)
from table
group by name
"
2245,group rows in plain sql,"WITH   CTE AS(
       SELECT * ,ROW_NUMBER() OVER (ORDER BY [DATE] ) - 
                 ROW_NUMBER() OVER (PARTITION BY NUMBER ORDER BY [DATE] ) AS ROW_NUM
       FROM TABLE1)
SELECT NUMBER,MIN(DATE) AS DATE
FROM   CTE
GROUP BY ROW_NUM,NUMBER
ORDER BY DATE
"
29931,How to code this SELECT statment?,"SELECT user_id, MAX(logout_time)
FROM activity 
WHERE logout_time <> ""0"" 
GROUP BY user_id;
"
20712,How to select insert more than once using INSERT INTO?,"INSERT INTO `wp_postmeta` (post_id, meta_key, meta_value)
SELECT post_id, 'custom', custom FROM `wp_temp` WHERE custom IS NOT NULL
UNION ALL
SELECT post_id, '_custom', 'field_514e91e73640d' FROM `wp_temp` WHERE custom IS NOT NULL
"
10828,Sql query to get Total in columns,"SELECT Table.Region, Table.Country, Sum(Table.[Population]) AS [Sum Population]
FROM Table
GROUP BY Table.Region, Table.Country;
"
30316,DB2 Select where not equal to string that is NULL,"SELECT COLUMN1 FROM MYTABLE WHERE (COLUMN1 != 'A' OR COLUMN1 IS NULL)
"
10781,mysql count from same table and data from the other table,"SELECT a.id, a.regname, COUNT(1)
  FROM reg_table a, details_table b,
    details_table c
 WHERE b.replyid=10
   AND b.regid = a.id
     AND c.regid = a.id
GROUP   BY a.id, a.regname
"
26040,"Best practices for managing simple ""description"" tables","ID      Code     Description
--      ----     -----------
0       M        Male
1       F        Female
2       T        Transgender
"
799,mysql multiple where and where not in,"select * 
from `users`   
where (`first_name` LIKE ""%Martin%"" or
       `last_name` LIKE ""%Martin%"" or  
       `email` LIKE ""%Martin%"" ) and
       `users`.`id` not in (186,85,184,252,256,181)
"
31012,SQL-Delete from a table based on a nested query,"DELETE FROM orderdetail 
WHERE orderdetail.order_sequence_number IN 
(
    SELECT id 
    FROM orders 
    WHERE date_ordered BETWEEN X AND Y
)
"
12621,How can I escape the input to a MySQL db in Python3?(Solved),"import pymysql
import sys
conn = pymysql.connect(host=""localhost"",
            user=""test"",
            passwd="""",
            db=""test"")
cursor = conn.cursor()
text = conn.escape(request[1])
cursor.execute(""SELECT * FROM `Codes` WHERE `ShortCode` =  {}"".format(text))

cursor.close()
conn.close()
"
7794,django-admin.py dumpdata to SQL statements,"# Convert file existing_db.db to SQL dump file dump.sql
import sqlite3, os

con = sqlite3.connect('existing_db.db')
with open('dump.sql', 'w') as f:
    for line in con.iterdump():
        f.write('%s\n' % line)
"
17032,"SQL - Last 6 months (12,18,24,30) divisor by 6 months query","SELECT  *
FROM    T
        INNER JOIN
        (   SELECT  [Date] = DATEADD(MONTH, - Number, @Date)
            FROM    Master..spt_values
            WHERE   Type = 'P'
            AND     Number % 6 = 0
        ) D
            ON D.Date = T.LastSalesDate
"
31898,T-SQL: Select partitions which have more than 1 row,"SELECT PartGrp,
       VendorPn,
       customer,
       sum(sales) as totalSales,
       ROW_NUMBER() OVER (PARTITION BY partgrp,vendorpn ORDER BY SUM(sales) DESC) as seqnum,
       COUNT(1) OVER (PARTITION BY partgrp,vendorpn) as cnt
FROM BG_Invoice 
GROUP BY PartGrp,VendorPn, customer
HAVING cnt > 1
ORDER BY PartGrp,VendorPn, totalSales desc
"
5316,SSRS Report Data Source for Query with Multiple Databases,"SELECT * FROM vw_Interactions
"
2578,How to delete data from specified tables at once in oracle sql,"DECLARE
  v_sql VARCHAR2(100);
BEGIN
  FOR i IN
  (SELECT table_name FROM user_tables where table_name like 'TEMP%'
  )
  LOOP
    v_sql := 'TRUNCATE TABLE '||i.table_name;
    EXECUTE immediate v_sql;
  END LOOP;
END;
/
"
9952,How to structure a database with multiple join tables,"SELECT ingredient_id
FROM Recipe r
JOIN Step_ingredient si on si.step_recipe_id = r.recipe_id
JOIN Ingredient i on si.ingredient_id = i.ingredient_id
"
39444,how to replace overflows with NULL?,"case when (rbaging.billing_period_end - 693594)>1
then DATEADD(DD, rbaging.billing_period_end - 693594, '1900-01-01')
else '' end,

case when (rbaging.billing_period_apply - 693594)>1
then DATEADD(DD, rbaging.billing_period_apply - 693594, '1900-01-01')
else ''
end
"
7009,sum of Times in SQL,"SELECT Personel_Code, SUM(DATEDIFF(MINUTE, '0:00:00', convert(time, Time, 8))) as totalTime
FROM thisTable
GROUP BY Personel_Code
"
22955,DB2 SQL Optimization suggestion,"SELECT count(*) 
FROM DB2INST3.VWQueue1_119 
WHERE userid1 is not null and
      nItemIndex is not null and
      string1 is not null and
      (F_BoundUser in (?, ?) and
      (F_Locked < 2) and
      (inbasketName = 'PSIQUEUE1Index') 
"
39254,Group By by hiding a column - TSQL,"SELECT
  ID,
  SUM(case when productid in (1,2,3)       then qty * hrs
           when productid in (100,200,300) then qty
      end) result1
FROM
  Prod
GROUP BY
  ID
"
39746,Stored Procedure for upgrading Bags to Lists,"UPDATE rating r
SET    resource_list_order = sub.rn
FROM  (
    SELECT id, row_number() OVER (PARTITION BY about_resource
                                  ORDER BY resource_list_order) - 1 AS rn
    FROM   rating
    ) sub
WHERE  r.id = sub.id;
"
29210,Checking Duplicates before inserting into SQL database,"ALTER TABLE clients ADD UNIQUE KEY (clientname);
"
21808,MySQL: Sorting rows from 2 (or more) tables by their columns,"SELECT id, name, time
FROM
(
    SELECT book_id id, book_name name, book_time time FROM books
    UNION
    SELECT movie_id id, movie_name name, movie_time time FROM movies
) booksandmovies
ORDER BY time DESC;
"
20623,SQL statement 4 table connect," LEFT OUTER JOIN tbl_advisor AS d 
 ON d.id = c.advisor_id
"
35757,Sql Syntax: Update All values in table based on a value in a different table,"UPDATE table2
SET Value = 55
FROM table2
JOIN table3 ON table3.fkValueId = table2.id
WHERE table3.fkValueTypeId = 0
"
6336,Help with MYSQL query,"SELECT DATE(timestamp) AS type, COUNT(*) AS `count`
FROM sometable
GROUP BY DATE(timestamp)
ORDER BY DATE(timestamp)
"
1386,BEGIN/END and CREATE Table in single .sql file,"BEGIN     
     EXECUTE IMMEDIATE 'DROP TABLE symbols'; 
EXCEPTION     
  WHEN OTHERS THEN         
   IF SQLCODE != -942 THEN     
 --here you have to write something for this exception
 -- if you don't have any activity to do then you can use NULL (atleast)
 -- you can't put this if statement body empty in oracle
 NULL;
END IF; 
END; 
/ 
"
16578,SQL WHERE Temporary Column,"SELECT c.CategoryName + ' (' + cast(count(ic.CategoryId) as varchar(255)) + ')' AS CategoryName,
       count(ic.CategoryId) AS NumPhotos,
       c.Slug, c.ParentCategoryId, c.Id
FROM Categories c INNER JOIN
     ItemCategories ic
     on ic.CategoryId = c.Id
GROUP BY c.CategoryName, c.slug, c.ParentCategoryId, c.id
ORDER BY ParentCategoryId DESC;
"
38044,trunc date field in mysql like oracle,"SELECT *
  FROM dlbcc_purchase
  WHERE DATE(due_date) = '2014-11-20'
"
13698,Oracle: Update with join not working as expected,"update d_dim 
    set FLAG = case when id in (select id from t_temp) then 'Y' else 'N' end;
"
1261,Returning string from database as currency,"lblTodayAmount.Text = BarOrderTableAdapter.TodaysSalesAmount(CDate(strEndDay), CDate(strBeginDay)).ToString(""C"")
"
25059,How to add data from different rows and display them as columns of one row in sql query,"select studentid AS Student,
(select Questionpoints from Student where studentid = a.studentid and Questionid = 8) AS Qn1,
(select Questionpoints from Student where studentid = a.studentid and Questionid = 9) AS Qn2,
(select Questionpoints from Student where studentid = a.studentid and Questionid = 10) AS Qn3
from Student as a
group by studentid;
"
35330,Why is the use of @variable in this SQL statement not yielding results?,"SELECT 'sites/mysite.co.uk/' + 'files'
"
6171,Conditional SQL Trigger?,"DECLARE @statusOldValue status_type
DECLARE @statusNewValue status_type

SELECT @statusOldValue = status FROM deleted

SELECT @statusNewValue= status FROM inserted

IF (@statusOldValue<>@statusNewValue) THEN
BEGIN
 -- Do what you want
END
"
10467,make a select query with group by,"SELECT A.ID,
       A.PATH,
       A.CATEGORY,
       A.SECTOR_ID,
       A.dDATE
FROM yourTable A
INNER JOIN
  (SELECT CATEGORY, 
          MAX(dDate) AS dDate
   FROM yourTable
   GROUP BY CATEGORY) B
  ON A.CATEGORY = B.CATEGORY
    AND A.dDate = B.dDate
"
39952,creating an efficient query with a UNION,"SELECT CountryCitizenID, Country = 'USA', Resident = CASE WHEN EXISTS
(
    SELECT 1
    FROM dbo.FT_City fte 
    WHERE fte.CitizenID = dtu.CountryCitizenID
    AND   fte.cityID = 5
) THEN 'YES' ELSE 'NO' END
FROM dbo.DT_Country_CitizenS AS dtu
WHERE dtu.Country = 'USA';
"
8250,Update columns with equal values in the same table,"UPDATE Table1 T
JOIN ( select title,note from Table1 where id =1) NewT
on T.title = NewT.title 
and T.note = NewT.note
SET T.title = 'newTitle' 
"
22682,"Simple MYSQL count, group by, not working using Pentaho Report Designer CE","SELECT count(*)
FROM cuesheet_tx_dates td INNER JOIN
     cuesheets s
     ON td.cuesheets_id = s.id
WHERE td.txdate BETWEEN '2015-01-01' and '2014-01-31' AND 
      td.trans_station = 'HIS' AND
      s.status = 'C';
"
22098,How can I make an average of dates in MySQL?,"SELECT
    from_unixtime(
        avg(
            unix_timestamp(date_one)-unix_timestamp(date_two)
        )
    )
FROM
    some_table
WHERE
    some-restriction-applies
"
28421,Looped cursor to match fields,"Update marbilder as t1 inner join marbilder as t2 on 
t1.DateinameMarbilder  like  concat(',%',t2.DateinameMarbilder)       
set
t2.PfadNeu=t1.PfadNeu
where t1.DateinameMarbilder like '%-%' and t2.PfadNeu is null  
"
4936,Two tables having same composite key,"select  t1.No
,       t1.Date
,       t1.S_hour - t2.L_hour
from    Table1 t1
join    Table2 t2
on      t1.No = t2.No
        and t1.Date = t2.Date
"
24457,How do I get the sum of a column as a new row with column data,"select 
  SrNo, Descript, item1, item2, 
  item1+item2 as totalitems
from tbl
ORDER BY SrNo

union all

select  
  max(SrNo) + 1, 'Total', sum(item1), sum(item2), 
  sum(item1+item2) as totalitems
from tbl
"
29844,Select and update SQL,"UPDATE up
SET    up.role = 'IBS__bGlobal__bCustomer__b__P__bTLO__b__p'
FROM   users u
       INNER JOIN user_profiles up
               ON up.user_id = u.user_id
WHERE  project_id = '28'
       AND up.role = 'customer__bread__fsubmit__fedit__bdefault' 
"
27952,Mysql Subquery Syntax,"DELETE FROM mytable
    WHERE id = ANY ( SELECT * FROM ( SELECT id FROM mytable ORDER BY created_time ASC LIMIT 3') t)
"
14170,Netezza UPDATE from one table to another,"UPDATE TABLE1 A
SET col1 = B.col1
FROM TABLE2 B
WHERE
A.ID = B.ID AND 
A.DeptID = 3 AND 
B.DeptID = 104
"
30601,Making SQL query with multiple where conditions and variables more efficient,"  SELECT t1.BigID, count(t1.LittleID)
  FROM Table1 t1
  WHERE t1.BigID IN (1, 2, 3) and
        t1.LittleID not in (SELECT t2.LittleID
                            FROM Table2 t2
                            WHERE t2.BigID = t1.BigId
                           )
  GROUP BY t1.BigID
"
9316,T-SQL Sorting by year and month,"SELECT Year(join_date) As JoinedYear, MONTH(join_date) AS JoinedMonth, COUNT(*) AS Count
FROM X
WHERE mtype ='A' AND (join_date BETWEEN DATEADD(year, -5, GETDATE()) AND GETDATE())
GROUP BY YEAR(join_date), MONTH(join_date)
ORDER BY YEAR(join_date) ASC, MONTH(join_date) ASC
"
22867,NLS_LANG setting for JDBC thin driver?,"Locale.setDefault(Locale.<your locale here>);
"
15014,How can I make a unique constraint order independently on two columns,"CREATE UNIQUE INDEX idx_unique_edge
    ON map( greatest( point_one, point_two ),
            least( point_one, point_two ) );
"
439,Update statement in Mysql and Oracle,"UPDATE table1 
SET ST_CD = 'QUEST03'
WHERE EXISTS 
     (SELECT 1 
      FROM table2 
      WHERE clsf_ind='NC' AND table1.cse_cd=table2.cse_cd); 
"
38790,finding products that customers bought together,"SELECT c.original_SKU, c.bought_with, count(*) as times_bought_together
FROM (
  SELECT a.sku as original_SKU, b.sku as bought_with
  FROM items a
  INNER join items b
  ON a.order_id = b.order_id AND a.sku != b.sku) c
GROUP BY c.original_SKU, c.bought_with
"
33643,How to handle NULL values in multiple SQL table joins,"SELECT SC_NumberCart.Number, SC_Packages.PkgName, SC_Features.FeatureName  
FROM SC_NumberCart 
LEFT JOIN SC_Packages ON SC_NumberCart.PkgID = SC_Packages.PkgID 
LEFT JOIN SC_FeatureCart ON SC_NumberCart.NumberID = SC_FeatureCart.NumberID 
                            AND SC_NumberCart.RecordID = SC_FeatureCart.RecordID 
LEFT JOIN SC_Features ON SC_FeatureCart.FeatureID = SC_Features.FeatureID 
WHERE SC_NumberCart.CpyID = @CpyID
"
31995,Retrieving values from two columns based on different conditions,"SELECT H2.HWMODEL AS HW,H1.PHONENUM,H1.USERID FROM HARDWARE H1 INNER JOIN HARDWARE H2 ON H1.USERID = H2.USERID
    WHERE ISNULL(H1.PHONENUM,'') <> ''
    AND ISNULL(H2.PHONENUM,'') = ''
ORDER BY H2.HWMODEL ASC
"
8365,How to use NVL in where clause,"SELECT
  cr_ts,
  msg_id,
  info
FROM messaging_log
WHERE UPPER(INFO) LIKE '%' || TRIM(UPPER(P_INFO)) || '%'
AND ((P_DATE IS NULL AND cr_ts >= (SYSDATE - 10)) OR cr_ts >= P_DATE)
AND (P_ID IS NULL OR msg_id = P_ID)
ORDER BY cr_ts DESC;
"
3359,"SQL, Edit a field in a table row, entering a character at the beginning and at the end.","update tablename
set
  field = concat('[:en]', field, '[:]')
"
22262,MySQL: Multi-column join on several tables,"SELECT a.*, e.citympg, e.hwympg
FROM table1 a
  JOIN table2 b on a.makeid=b.makeid
  JOIN table3 c on a.modelid=c.modelid
  JOIN table4 d on a.catid=d.catid
  Join table5 e on b.makename = e.make
                and c.modelname = e.model
                and a.caryear = e.year
  WHERE a.carid = $carid;
"
26362,Selecting data from two different tables,"SELECT idR, count(*)
FROM RecipIngr
GROUP BY idR
"
20192,Semi-complex aggregate select statement confusion,"Select ID, A.PersonID, A.StoreID, Data1, Data2, A.EntryDate
From ExampleTable As A
Inner Join
    (select PersonID, StoreID, max(EntryDate) As EntryDate
    from ExampleTable
    group by PersonID, StoreID, dbo.dayof(EntryDate)) As B
  On ExampleTable.PersonID = B.PersonID 
    And ExampleTable.StoreID = B.StoreID 
    And ExampleTable.EntryDate = B.EntryDate
"
18349,Is this possible in SQL?,"select a.claim_ID
from   TableA a, 
       TableB term, 
       TableB paid
where  a.claim_id  =  term.claim_id
and    a.claim_id  =  paid.claim_id
and    term.Claim State  = 'TERMINATED'
and    paid.Claim State  = 'PAID'
and    term.Claim_State_Start_Date >= paid.Claim_State_Start_Date
"
18004,List the type of records stored in a column,"SELECT DISTINCT colname
FROM tabelname
"
4037,Laravel 5: Join On with IN query,"$days = '(\'2015-07-09\', \'2015-07-10\')';
$results = DB::table('users')->leftJoin('checklist_items', function($join) use ($days) {
    $join->on('users.id', '=', 'checklist_items.user_id')
        ->on('checklist_items.due_date', 'IN', DB::raw($days));
})
->where('checklist_items.user_id', null)
->limit(10)
->toSql();

echo $results;
"
27074,SQL Select statment with remove first row," SELECT * FROM (
    select ROW_NUMBER()OVER(ORDER BY id ASC) row,* from pdetails where pcode='P000437'
    )t
    WHERE row != 1;
"
28036,INSERT or UPDATE from another table in mysql,"   INSERT INTO test2 
   SELECT a, b, c as c1 FROM test1
   ON DUPLICATE KEY UPDATE c = c + c1
"
33752,"subtract / change a ""zero"" number in ms sql: 1001 to 101","UPDATE table SET col=col
    -power(10, floor(log10(col)))*floor(col/power(10, floor(log10(col))))
    +power(10, floor(log10(col))-1)*floor(col/power(10, floor(log10(col))))
"
13256,SQL Select Last Timestamp of Each Day,"select max(intTimeStamp) as lasttimestamp
from TableA 
group by date(from_unixtime(intTimeStamp))
order by lasttimestamp desc;
"
34405,INSERT result of a SELECT and other values as well,"INSERT INTO table (columns)
SELECT
  column or column expression1,
  column or column expression2,
  …
  constant or constant expression1,
  constant or constant expression2,
  …
FROM a set of tables/joins
WHERE …
"
26792,SQL returning NULL instead of empty result,"SELECT *, GROUP_CONCAT(item_category) AS item_categories
FROM (`dev_pages`)
LEFT JOIN `dev_items_to_categories` ON `dev_items_to_categories`.`item_id` = `dev_pages`.`page_id` AND `item_category` =  '16'
WHERE deleted_time IS NULL
AND `page_type` =  'blog'
GROUP BY dev_pages.page_id
ORDER BY `page_title` ASC
"
29061,Querying SQLITE DB for Data from One Column Based On Another Column,"SELECT substr(MyDate, 7, 4) AS Year,
       substr(MyDate, 1, 2) AS Month,
       sum(Price)
FROM Purchases
GROUP BY Year,
         Month
"
1827,Get auto generated sequence in postgresql,"
select city_name as name
      ,row_number() over() id 
from cities;
"
14341,Join data on a table based on a relationship table,"SELECT cause.Name AS 'Cause', effect.Name AS 'Effect' 
FROM Fact_Cause c
INNER JOIN Fact cause ON c.IDCauseFact = cause.ID
INNER JOIN Fact effect ON c.IDEffectCause = effect.Id
"
14142,Update datetime field randomly according known datetime,"UPDATE training SET finalized = complete_date + INTERVAL FLOOR(1 + (RAND() * 3)) DAY
"
21408,"How to SELECT two columns, where one column must be DISTINCT?","SELECT col1, MAX(col2) col2_max
FROM Table1
WHERE col3 = 'X'
GROUP BY col1
ORDER BY col2_max
"
28301,Replace null value using the select statement for ms access,"SELECT A.CABLE_NO,A.LOC_A,A.LOC_B,
    ISNULL(B.LENGTH,'SITE') AS CABLE_LENGTH
FROM TABLE_A AS A, TABLE_B AS B
WHERE A.id =B.id 
"
20759,SQL One row that has multiple joins from different columns,"Select m.Description, st.Description 
FROM BaseTable bt 
LEFT JOIN Mapping m where m.toID = bt.id
LEFT JOIN BaseTable bt2 where m.FromID = bt2.id,
inner join SubTypeTable stt on bt2.subTypeID = stt.id
"
16864,Union 'expression must have same datatype as corresponding expression',"Select Column A, Column B, Number A, Number B, Number C, Number D
   From Table A
UNION
Select Column A, Column B, NULL, NULL, NULL, NULL
   From Table B
"
1085,SELECT Values in one table that don't match another table but also reference another column?,"SELECT 
   positID, trainID 
FROM 
   positTraining 
WHERE 
   positID = X 
   AND trainID not in (
      SELECT trainID FROM empTraining WHERE empID = A)
"
14581,SQL add columns of each record together,"select t.name, sum(p.goals) as cnt, 
from players p inner join teams t on p.teamid = t.id
group by t.name
"
16639,How to convert date to text Month?,"SELECT DATENAME(mm, DateCol) AS [Month]
FROM MyTable
"
13316,MySQL how use correlated query in join,"SELECT
  x.*, COUNT(y.ID) AS y_count
FROM tableX x
  LEFT JOIN tableY y
    ON y.xFK = x.ID
GROUP BY
  x.ID
HAVING
  y_count > 1
"
4648,Setting the parameters of a SP from a table row,"declare @uploadedBy varchar(50)
declare @anothervariable whatevertype 

select @uploadedBy=uploadedBy, 
       @anothervariable=anotherColumn 
from CommonImport 
where CommonImportID=@CommonImportID
"
33894,Get column names,"Set db = CurrentDb()
Set rs1 = db.OpenRecordset(""Table1"")
Dim fld As DAO.Field
For Each fld In rs1.Fields
    MsgBox (fld.Name)
Next
Set fld = Nothing
"
994,Left joining 2 of the same table with count,"select a.Month, a.TotalCountSub, b.TotalCountCust from (
  SELECT Datepart(mm,starttime) as Month, COUNT(*) TotalCountSub
  from data 
  where usertype='subscriber'
  group by Datepart(mm,starttime)
  having count(*) > 1
 ) a
 INNER JOIN (
   SELECT Datepart(mm,starttime) as Month, COUNT(*) TotalCountCust
   from data
   where usertype='Customer'
   group by Datepart(mm,starttime)
   having count(*) > 1
 ) b 
ON a.Month = b.Month
order by a.Month ASC
"
14992,SQL - Max dates,"SELECT HIC,CODE,PROVIDER DATE,TypeCode,MAX([Effective Date])[Effective Date]
FROM <TABLE>
GROUP BY HIC,CODE,PROVIDER DATE,TypeCode
"
15917,Convert SQL query to HQL," DetachedCriteria detachedQuery = DetachedCriteria.forClass(X.class)
 .setProjection(Projections.distinct(Projections.property(""field1"")))
 .add(Restrictions.eq(""field2"",value2))  
 .add(Restrictions.gt(""field1"", value1))
 .add(Restrictions.in(""field3"",value3))
 .add(Restrictions.in(""field4"", value4))
 .add(Restrictions.isNull(""field5""))
 .addOrder(Order.asc(""field1"");

 Criteria criteria= session.createCriteria(X.class);
 criteria.add(Property.forName(""field1"")
     .in(detachedQuery))
     .setMaxResults(20);
"
29446,How to determine tables size in Oracle,"SELECT DS.TABLESPACE_NAME, SEGMENT_NAME, ROUND(SUM(DS.BYTES) / (1024 * 1024)) AS MB
  FROM DBA_SEGMENTS DS
  WHERE SEGMENT_NAME IN (SELECT TABLE_NAME FROM DBA_TABLES)
 GROUP BY DS.TABLESPACE_NAME,
       SEGMENT_NAME;
"
39139,MySQL update join with limit,"UPDATE wp_postmeta t JOIN
(
    SELECT p.meta_id, m.newmap
      FROM wp_postmeta p JOIN wp_map m
        ON p.meta_value = m.oldmap
     ORDER BY p.meta_id
     LIMIT 100
) s
   ON t.meta_id = s.meta_id
  SET t.meta_value = s.newmap;
"
1001,Insert into table,"INSERT INTO mylog (c1,c2) 
VALUES('username', coalesce((SELECT webuser 
                             FROM myusers 
                             WHERE webuser='username'),'X'));
"
7376,"SQL - Row of IDs, fetch joined data","select g.garageid, c1.color as color1, c2.color as color2, c3.color as color3
from garages g left join
     cars c1
     on g.car1 = c1.carid left join
     cars c2
     on g.car2 = c2.carid left join
     cars c3
     on g.car3 = c3.carid;
"
16951,"In Mongodb , how do I check if all the documents are unique for a value?","function allDifferent() {
    var m = function() { emit(this.name, 1); }
    var r = function(key, emits) {
        var n = 0; emits.forEach(function(v) { n += v; }); return n;
    }
    var result = db.mycol.mapReduce(m, r, { out: ""namecounts"" });
    var allDifferent= (db.namecounts.count( { value: { $gt: 1 } } ) == 0)
    db.namecounts.drop();
    return allDifferent;
}
"
19786,SQL EXCLUDE records with timestamps defined in the separate table,"SELECT datavalue
FROM   table1 a
       INNER JOIN table2 b
               ON a.datavalue NOT BETWEEN b.start_date AND b.endate 
"
2607,select max value of a row from two tables,"SELECT * FROM (

SELECT 
       a.user_id,
       a.name,
       b.class,
       year
FROM
       table1 a
INNER JOIN
           table2 b
    ON
           a.user_id=b.user_id
ORDER BY year desc

) h
GROUP BY user_id
"
10846,Mysql customise order by with group by,"ORDER BY FIELD(color, 49, 2) DESC
"
14646,Oracle left outer join: howto limit requests in right table,"SELECT
    *
FROM
    accounts a,
    (
      SELECT
          user_id,
          *
      FROM
          settings
      WHERE
          RANK() OVER (ORDER BY id DESC, PARTITION BY user_id) = 1
    ) s
"
29647,Codeigniter generate simple array from database,"$query = $this->db->query('SELECT val FROM table')->result_array();

$array = array();

foreach ( $query as $key => $val )
{
    $temp = array_values($val);
    $array[] = $temp[0];
}
"
13509,SQL server Query Count() Optimization,"select 
    side,
    uid,
    cside,
    cside/3 as pairs,
    cside/3*15 as commisonPrice 
from
(
    select
    p.side ,
    p.uid as uid , 
    count (p.side) as cside
    from tempComm as p 
    group by p.side , p.uid
) t
order by uid; 
"
16973,"phpMyAdmin, get a list of user email addess that don't exists in another table","select mail from users where mail NOT IN (select mail from commerce_order) 
"
17832,Converting subquery to join,"  SELECT c.id as chapter_id,
         COUNT(*) as num_of_questions 
    FROM CHAPTERS AS c
    JOIN LESSONS AS l ON l.chapter_id = c.id
    JOIN QUESTIONS AS q ON q.lesson_id = l.id
GROUP BY c.id
"
24834,MS Access; Count number of times linked value occurs in multiple columns,"SELECT m.Meal, COUNT(*) AS Orders
FROM tbl_Meal_Options AS m
LEFT JOIN (
    SELECT Meal_1 AS Meal FROM tbl_Invitations
    UNION ALL
    SELECT Meal_2 AS Meal FROM tbl_Invitations
    UNION ALL
    SELECT Meal_3 AS Meal FROM tbl_Invitations
    UNION ALL
    SELECT Meal_4 AS Meal FROM tbl_Invitations
) AS i
ON m.Meal_Option = i.Meal
GROUP BY m.Meal
"
31048,How do I compare dates in one SQL table to a range defined in another table?,"SELECT 
    t1.Name, t1.DOB
FROM 
    t1
    JOIN t2 AS startDate ON (startDate.Code = 'YearStart')
    JOIN t2 AS endDate ON (endDate.Code = 'YearEnd')
WHERE 
    STUFF(CONVERT(varchar, t1.DOB, 112), 1, 4, '') BETWEEN 
        STUFF(CONVERT(varchar, startDate.[Date], 112), 1, 4, '')
        AND
        STUFF(CONVERT(varchar, endDate.[Date], 112), 1, 4, '')  
"
31948,Subtract two dates in sql to hhhh:mm:ss,"DECLARE @date1 datetime = '19000101 00:00:00.000',
        @date2 datetime = '19000102 01:00:00.000'

SELECT CAST(DATEDIFF(hour, @date1, @date2) AS nvarchar(5))+ ':00:00.0'
"
32753,SQL How to join multiplue columns with same name to one column,"SELECT ID, balance, TYPE FROM saving
UNION ALL
SELECT ID, balance, TYPE FROM time
UNION ALL
SELECT ID, balance, TYPE FROM fore;
"
12669,A function calculating average age in years in SQL [postgresql]," SELECT AVG(AGE(dateofbirth)) 
   FROM person 
"
27534,Sql Server Mapping ID's in the same table,"Insert Into TableA
(
  Field1,
  Field2,
  Field3
)
  Output Inserted.Field1, Field2, Field3, MappingID
  Into MappingTable
Select Field1, Field2, Field3
From Rooms
"
37772,What type of entity is this?,"Name
Description
UnitPrice
"
881,Group by selects first occurence of field how can I get the last one?,"SELECT user_id, created
FROM photo_comments o
WHERE created =
    (SELECT MAX(created) 
    FROM photo_comments i
    WHERE o.user_id=i.user_id)
"
8715,Combine records from two tables in one query,"select id, userId, part_id, url, 'from tbl1' as which
from tbl1
union all
select id, userId, part_id, notes, 'from tbl2'
from tbl2;
"
9313,retrieve date format from machine settings,"Select DateFormat 
From   sys.syslanguages 
Where  name = @@Language
"
26990,MySQL Query to get row with least amount of data?,"SELECT  ID,
        name,
        CASE WHEN col1 IS NOT NULL THEN 1 ELSE 0 END +
        CASE WHEN col2 IS NOT NULL THEN 1 ELSE 0 END +
        CASE WHEN col3 IS NOT NULL THEN 1 ELSE 0 END +
        CASE WHEN col4 IS NOT NULL THEN 1 ELSE 0 END +
        CASE WHEN col5 IS NOT NULL THEN 1 ELSE 0 END filledData
FROM    tableName
"
19288,Calculating an average number from three columns,"SELECT m.title, m.imdbrating, m.metacritic,
       t.rating,
       ((case when imdbrating > 0 then imdbrating else 0 end) +
        (case when metacritic > 0 then metacritic else 0 end) +
        (case when t.rating > 0 then t.rating else 0 end) +
       ) / nullif(coalesce((imdbrating > 0), 0) + coalesce((metacritic > 0), 0) + coalesce((t.rating > 0), 0)), 0)
FROM movie m JOIN
     tomato t
     ON m.imdbid = t.imdbid;
"
34199,how to make one sql query asking for many rows,"SELECT n1.node_id FROM node_tags n1
INNER JOIN node_tags n2 ON n1.node_id = n2.node_id
INNER JOIN node_tags n3 ON n1.node_id = n3.node_id
WHERE n1.k = 'addr:housenumber' AND n1.v = '50'
AND n2.k = 'addr:street' AND n2.v = 'Kingsway'
AND n3.k = 'addr:city' AND n3.v = 'London'
"
28489,Create Trigger to log SQL that affected table?,"SELECT 
    qStats.last_execution_time AS [ExecutedAt],
    qTxt.[text] AS [Query], qTxt.number
FROM
    sys.dm_exec_query_stats AS qStats
    CROSS APPLY
    sys.dm_exec_sql_text(qStats.sql_handle) AS qTxt
WHERE
    qTxt.[dbid] = @DbId
    AND qTxt.[text] like '%UPDATE%'
    AND qStats.last_execution_time between @StartExecutionSearchTime and @EndExecutionSearchTime
ORDER BY
    qStats.last_execution_time DESC 
"
10889,Merge to update all target table columns,"UPDATE trg
  SET col1 = src.col1,
      col2 = src.col2, 
      ...
  FROM DB1.dbo.table AS trg
  INNER JOIN DB2.dbo.table AS src
    ON trg.ID = src.ID;
"
30058,MySql : issue with GROUP BY and COUNT clauses,"SELECT DISTINCT product, type
FROM   mytable
WHERE  product IN (SELECT   product
                   FROM     mytable
                   GROUP BY product
                   HAVING   COUNT(DISTINCT type) > 1)
"
4216,MySQL Create View from 2 different tables and columns,"
create view OrderItemsVW
as 
select wp_cart66_orders.bill_first_name as Bill_First_Name,   
       wp_cart66_orders.bill_last_name as Bill_Last_Name,  
       wp_cart66_orders.Description as OrdersDescription,          
       wp_cart66_order_items.Description as OrderItemsDescription
from wp_cart66_orders 
inner join wp_cart66_order_items
    on wp_cart66_orders.id=wp_cart66_order_items.order_id
where wp_cart66_orders.status = 'new';
"
36412,ASP.net MVC How to run multiple instances of the same app at the same time in different subdomains?,"/website/sub1
/website/sub2
"
20125,Oracle: how to write a query with enable / disable WHERE condition,"WITH temp AS (SELECT 'case1' _case FROM DUAL)
SELECT 1
  FROM temp
 WHERE   
 1 = case
      when _case = 'case1'
      AND SYSDATE > TO_DATE ('01/01/2013', 'DD/MM/YYYY')
      then 1
      when _case = 'case2'
      AND SYSDATE > TO_DATE ('01/01/2013', 'DD/MM/YYYY')
      then 1
      else 0
     end 
; 
"
27879,MySQL insert id values from other table into matching rows,"update products INNER JOIN manufacturers
set products.manufacturer_id = manufacturers.id
where products.manufacturer = manufacturers.name
"
29082,How to lock a line of a table,"Foo
===
Id | ...data... | Timestamp | LockOwner | LockTimeout
---+------------+-----------+-----------+------------
"
13279,Making a table which is difference of 2 table by eliminating first char,"insert into ebl_test
select example1,
       example2,
       Substring(example3,1,14) --Lose the first character of example 3
from ebl_old a 
where not exists (select null from ebl  b where a.imei=b.imei)
"
18345,Get data from table using group by,"Select A.*
    From EmpTbl A
        Inner Join
    EmpTbl B
        On  SubString(A.EmpType, 2, 4) = SubString(B.EmpType, 2, 4) And
        SubString(A.EmpType, 1, 1) <> SubString(B.EmpType , 1, 1)
"
24397,getting sum of count() in groupby,"GROUP BY date(alertDate)
"
30512,Blank result for criteria not matching IN() statement,";with CTE AS (
SELECT 1 AS col_

UNION ALL 

SELECT 1 + col_
FROM cte

WHERE col_ <100
)

SELECT col_, mt.*
FROM cte

LEFT JOIN myTable mt
ON mt.id = col_
"
8030,mysql get array of ids,"SELECT 
    a.id, 
    a.name, 
    SUBSTRING_INDEX(GROUP_CONCAT(b.effect_id ORDER BY b.effectcnt DESC), ',', 5) AS top_effect_ids
FROM 
    plants a
INNER JOIN
(
    SELECT plant_id, effect_id, COUNT(1) AS effectcnt
    FROM planteffects
    GROUP BY plant_id, effect_id
) b ON a.id = b.plant_id
GROUP BY 
    a.id, a.name
"
15726,Update records based on inserted IDs and another non source column in SQL,"INSERT INTO @MyTableVar(id, EmployeeId)
SELECT id, EmployeeId 
FROM (
    MERGE dbo.target TGT
    USING dbo.source SRC
    ON TGT.employee = SRC.employee
    WHEN NOT MATCHED THEN
       INSERT (employee)
       VALUES (src.employee)
    OUTPUT inserted.id, SRC.EmployeeId)
AS out(id, EmployeeId);;
"
3753,How can you reference multiple rows in another table?,"CREATE TABLE PersonRoles (
    PersonID int not null,
    RoleID int not null,
    constraint PK_PersonRoles PRIMARY KEY (PersonID,RoleID),
    constraint FK_PersonRoles_Persons FOREIGN KEY (PersonID) references Person (ID),
    constraint FK_PersonRoles_Roles FOREIGN KEY (RoleID) references Role (ID)
)
"
17975,SQL: select multiple columns based on multiple groups of minimum values?,"select * from (
select a.id, b.id, a.time_point, b.time_point, 
rank() over (partition by a.id, b.id
order by calculatedValue() asc) ranker
from orientation_momentum a, orientation_momentum b
where a.id = '00820001001' and b.id between 10 and 20
) Z where ranker = 1
"
3549,Locking a table during insertion,"INSERT INTO MyTable WITH (TABLOCK)
(field 1, field2, field3...)
VALUES
(value 1, value 2, value 3...)
"
18146,Complex SQL Query - nested query,"SELECT jf.job_id,
       jf.name, 
       MIN(ij.date) AS first_job_date, 
       MAX(ij.date) as last_job_date, 
       COUNT(*) as count_of_jobs
FROM job_form jf
  INNER JOIN individual_job ij
    ON jf.job_num = ij.job_num
GROUP BY jf.job_id, jf.name -- i.e. non-aggregated select fields here
"
25727,mysql get minutes between a datetime and NOW(),"SELECT UNIX_TIMESTAMP() - UNIX_TIMESTAMP(datetime_col)
"
28960,SQL: How to select highest PK out of multiple records returned,"SELECT TOP 1
       Journal_Entry_ID, Entry_Date
FROM Journal_Entry
ORDER BY Entry_Date DESC, Journal_Entry_ID DESC
"
37902,What is the best way to transfer excel row from on change named range to sql server db?,"MERGE dbo.Tests AS t
USING (SELECT Row1, Row2 FROM dbo.Tests_import) AS s
ON (t.Row1 = s.Row1)
WHEN NOT MATCHED THEN
    INSERT (Row1, Row2, DateCreated) VALUES(s.Row1, s.Row2, GETDATE())
WHEN MATCHED and s.Row2 <> t.Row2 THEN
    UPDATE SET t.Row2 = s.Row2, t.DateUpdated = GETDATE()
OUTPUT $action, inserted.TestID, inserted.Row1, inserted.Row2, inserted.DateCreated, inserted.DateUpdated
INTO dbo.Tests_History ([Action], fk_TestID, Row1, Row2, DateCreated, DateUpdated);  
"
30283,"SQL Server 2008 R2 Subquery grouping, summing and count","select
    agent_id,
    sum(matrix_1) Matrix1Sum,
    avg(case when matrix_1 > 0 then cast(matrix_1 as float) end) Matrix1Average,
    sum(matrix_2) Matrix2Sum,
    avg(case when matrix_2 > 0 then cast(matrix_2 as float) end) Matrix2Average,
    sum(matrix_3) Matrix3Sum,
    avg(case when matrix_3 > 0 then cast(matrix_3 as float) end) Matrix3Average
from evals
group by
    agent_id
"
182,Select @ before values,"declare @email varchar(100)
set @email='sample@gmail.com'
select substring(@email,1,charindex('@',@email)-1)
"
29776,How to decrease value by all cells in the column in MySQL query?,"UPDATE yourtablename SET columnname = columname-1
"
15977,Delete duplicates in SQL query ms access,"DELETE FROM Table a
WHERE
(a.Mood='Sad' 
AND EXISTS
  (SELECT 1
   FROM Table b
   WHERE b.DayNumber = a.DayNumber
   AND b.Mood in ('Happy','Mad')))
OR
(a.Mood = 'Mad'
AND EXISTS
  (SELECT 1
   FROM Table c
   WHERE c.DayNumber = a.DayNumber
   AND c.Mood = 'Happy')))
"
7736,Select count of column grouped by another column SQL,"SELECT PC.Category_Name, Sum(P.Products_Inventory)
FROM Products_Category PC
   INNER JOIN Products P ON PC.ProductId = P.ProductId
GROUP BY PC.Category_Name
"
7544,How to use SQL to find second-highest auction bids,"SELECT TOP 1 *
FROM (
   SELECT TOP 2 *
   FROM table
   WHERE <criteria match>
   ORDER BY amount DESC
) AS newTable
ORDER BY amount ASC
"
27084,Return query results into an array,"  SELECT
    plr_function(
      array_agg(array[s.id,s.latitude_decimal,s.longitude_decimal])
    )
  FROM
    climate.station s
  WHERE
    s.applicable AND
    s.latitude_decimal BETWEEN box.latitude_min AND box.latitude_max AND
    s.longitude_decimal BETWEEN box.longitude_min AND box.longitude_max
"
10342,How to get velocity in last n minutes,"timestamp > DATE_SUB(NOW(), INTERVAL 1 minute)
"
11967,How to set Doctrine 1.2 ATTR_CASCADE_SAVES off in databases.yml?,"public function configureDoctrineConnectionDoctrine(Doctrine_Connection $connection)
{
  $connection->setAttribute('CASCADE_SAVES', false);
}
"
7518,Postgres: Ordering result by to_char date field,"order by min(service_date_time)
"
14411,Using 'with' clause for update purpose,"with ds as (
      SELECT COMPUTER.compID, COMPUTER.serialNo, COMPUTER.cpuId, 
             CPU_TYPE.name, CPU_TYPE.cpuSpeed, COMPUTER.cpu
      FROM COMPUTER LEFT OUTER JOIN
           CPU_TYPE
           ON COMPUTER.cpuId = CPU_TYPE.cpuId
     )
update ds
     set cpu = name +', '+ coalesce(cpuSpeed, '');
"
8490,How do I get LIKE and COUNT to return the number of rows less than a value not in the row?,"SELECT COUNT(ID) FROM My_Table
WHERE ID < (SELECT ID FROM My_Table
  WHERE SUBSTRING(ID, 2) >= 4
ORDER BY ID LIMIT 1)   
"
2504,SQL - selecting the first record found before a given date,"Select top 1 ID, DATE
from table
where DATE < '4/1/12'
order by DATE DESC
"
39132,Reverse order of firstname and lastname in SQL column,"ALTER TABLE SillyTable ADD FirstInitial char(1), LastName varchar(50);

INSERT INTO SillyTable(FirstInitial, LastName) 
SELECT SUBSTRING(NameColumn, 1, 1), SUBSTRING(NameColumn, 3, LEN(NameColumn) - 2)
FROM SillyTable;

SELECT LastName + ' ' + FirstInitial AS WhatMyBossWantsToday FROM SillyTable;
"
5480,getting different column names from 2 tables in sql server,"select i.ItemName, i.ItemCost, s.SalesName, s.SalesDate 
from Item as i, Sales as s;
"
10866,Aggregate and calculate total minutes for set of records as productivity,"SELECT NAME,
       COUNT(*) AS ""Records for NAME"",
       TO_CHAR(NUMTODSINTERVAL(SUM(END_DATE_TIME - START_DATE_TIME), 'DAY')) AS MINUTES
  FROM TABLE1
  GROUP BY NAME
"
6967,Update from inner join,"SELECT id.ISBN, COUNT(*)
FROM dbo.Sync_ImportData id
GROUP BY id.ProductCode
HAVING COUNT(*) > 1
"
22272,Connect database using query to a datatable in vb codes,"Imports System.Configuration
Imports System.Data
Imports System.Data.SqlClient

Public Function GetList() As DataTable

    Dim Query As String = ""Select * FROM Intranet_Gn_ISCoordinators""
    Dim dt As DataTable = New DataTable()

    Using adapter = New SqlDataAdapter(Query, ConfigurationManager.ConnectionStrings[""IntranetConnectionString""].ConnectionString)
        adapter.Fill(dt)
        return dt
    End Using

End Function
"
38946,SQL Query count how many products bought on one day by those who bought more than 3 products on a different day,"SELECT sum(s.units_sold)
FROM Sales s, Products p
WHERE p.name = 'Chair' and s.date = '2015-01-01' and s.product_id = p.id
AND s.customer_id IN (SELECT customer_id FROM Sales WHERE date = '2016-01-01' AND units_sold > 1)
"
18150,How to remove/rename a duplicate column in SQL (not duplicate rows)," SELECT firstTable.PatID as 'pID', firstTable.column2, secondTable.* FROM...
"
35234,SELECT inside a COUNT,"SELECT a, COUNT(*) AS b,
   SUM( CASE WHEN c = 'const' THEN 1 ELSE 0 END ) as d,
   from t group by a order by b desc
"
21733,Join multiple tables with same column name,"SELECT g.id, g.scenario, f.expiresAt 
FROM generalTable g
JOIN facebookTable f
ON g.id = f.id
UNION ALL
SELECT g.id, g.scenario, c.expiresAt 
FROM generalTable g
JOIN chiefTable c
ON g.id = c.id;
"
10196,Get ID of a row having maximum value in other column,"SELECT TOP 1 ID
FROM table_name 
Where col2 = 2
ORDER BY col3 DESC
"
2588,SQL Group by one column,"SELECT t0.ID, t0.INITIAL_DATE, t0.TAX
FROM (  SELECT *, ROW_NUMBER() OVER(PARTITION BY ID ORDER BY TAX DESC , INITIAL_DATE DESC) Corr
        FROM t) t0
WHERE t0.Corr = 1
"
33810,How to create stored procedure with print from 2 different tables?,"SELECT 
     c.MemeberID
     , m.MemberName
     , m.ContactNumber
FROM 
     class c
     INNER JOIN members m ON
         c.MemberID = m.MemberID 
WHERE c.classID = @classID
"
1960,Insert double quotes into SQL output,"SELECT QUOTENAME(First, '""'), QUOTENAME(Last, '""'), QUOTENAME(Email, '""')
    FROM People
"
36740,Querying the sum using SQL,"SELECT 
Department,
SUM(Income),
CASE 
WHEN Department = 'A' THEN SUM(Income) / 2
WHEN Department = 'B' THEN SUM(Income)
WHEN Department = 'C' THEN SUM(Income) / 4
END
 AS ModifiedIncome FROM School GROUP BY Department;
"
29511,For Each equivalent in SQL,"UPDATE tblDocs
SET 
  Active = CASE WHEN DocLocation = 'something' THEN 1 ELSE 0 END,
  DocID = CASE WHEN DocLocation = 'something' THEN NULL ELSE DocID END
"
10830,Using Count value in WHERE clause,"SELECT tel_number.number, COUNT(DISTINCT(i2.id_img)) as matching_img_count
FROM img_reference i
JOIN img_reference i2 ON i.id_img = i2.id_img
JOIN tel_number ON i.id_tel = tel_number.id_tel
WHERE tel_number.id_tel != 13777
    AND i2.id_tel=13777
GROUP BY i.id_tel, i2.id_tel
HAVING matching_img_count > 1
"
12943,how do i select previous date using ssis expression?,"@[User::FilePath]+""Bloomberg_""+((DT_I4)DATEPART(""weekday"",@[System::StartTime]) ==1 ? 
Replace((DT_STR, 20, 1252)(DATEADD( ""D"", -3,@[System::StartTime])),"":"","""") + "".xls"" :
Replace((DT_STR, 20, 1252)(DATEADD( ""D"", -1,@[System::StartTime])),"":"","""") + "".xls"")
"
21289,Merge an Update Query with a Select Query MS Access,"UPDATE tblOrder
    SET tblOrder.Statusfk = 2
WHERE NOT EXISTS (SELECT 1
                  FROM tblOrderDetail
                  WHERE tblOrderDetail.OrderFK = tblOrder.OrderPK AND
                        tblOrderDetail.StatusFK <> 2 AND
                        tblOrder.StatusFK
                 );
"
12377,Group different groups as the same and count?,"GROUP BY LEFT(typeOwner, position('<xType>' in typeOwner) -1)
"
25710,Can I optimize this sql Query?,"SELECT u.UserID,
    SUM(CASE WHEN Success = 1 THEN 1 ELSE 0 END) AS Successful,
    SUM(CASE WHEN Success = 0 THEN 1 ELSE 0 END) AS Unsuccessful,
    MAX(LoginDate) AS LastLogin
FROM Users u
INNER JOIN Logins l on u.UserID = l.UserID
GROUP BY u.UserID
"
25190,SQL - COUNT DISTINCT,"SELECT ip.CLIENT, cpst.STATUS, MIN(cps.date), MAX(cpst.DATE_EXE), COUNT(*)
FROM IP ip JOIN
     CPS cps
     ON ip.PF_ID = cps.PF_ID JOIN
     CPST cpst
     ON cps.PF_GUID = cpst.PF_GUID 
WHERE cpst.STATUS IN (100,400,550) AND
      cps.DATE BETWEEN DATE '2014-07-01' and DATE '2014-09-30'
GROUP BY ip.CLIENT, cps.STATUS;
"
17793,How do I find the nth row from a sql query?,";WITH cte AS
(
    SELECT DENSE_RANK() OVER (ORDER BY Salary DESC) AS r, *
    FROM Employee e
)
SELECT *
FROM cte
WHERE r = 2
"
2586,SQL output two rows using one entry,"select a.checkkey, a.checknum,a.confirmed, a.printed,a.canceled,  b.status
from table_A a
inner join table_B b
on a.checkkey = b.checkkey
union all
select a.checkkey, a.checknum,a.confirmed, a.printed,a.canceled, NULL as status
from table_A a
order by checkkey, checknum;
"
27645,"Determine if two parameters are null, then use parameters in the where clause"," FROM DI_Intervention_Schedule S
    WHERE
    (S.[ID] = @ID OR @ID IS NULL)
    AND (( S.[StartDateTime] >= @StartDate   AND S.[EndDateTime] <= @EndDate)  OR @StartDate IS NULL )
"
35909,sql return dates where there are no results,"SELECT q.date_column, count(f.id) FROM
(SELECT
 generate_series(min(date_column),max(date_column), '1 day') AS date_column
 FROM mytable) AS q
LEFT JOIN mytable AS f
ON q.date_column=f.date_column
GROUP BY q.date_column ORDER BY q.date_column;
"
17595,"Why are ""Null Like X"" and ""Not (Null Like X)"" equal?","NULL LIKE 'X'
NULL NOT LIKE 'X'
NOT (NULL LIKE 'X')
NOT (NULL NOT LIKE 'X')
"
20908,Heroku - what happened? `sql` is not a heroku command,"heroku pg:psql
"
5276,How to get list of tables which have rows?,"SELECT obj.name TableName, st.row_count
            FROM sys.dm_db_partition_stats(nolock) st
            inner join sys.objects(nolock) obj on st.object_id = obj.object_id
    WHERE index_id < 2 and st.row_count > 1 and obj.type = 'u'
"
31425,Find rows where value in column not found in another row,"select t1.Key1, t1.Key2, t1.Type
from table1 t1
left join table1 t2 
          on t1.key1 = t2.key2 
          and t2.type = 'typeb'
where t1.type = 'typea' 
      and t1.key2 is null 
      and t2.key1 is null
"
26572,multiple lines in a single line in oracle,"SELECT MAX(CASE WHEN tab1.type = 'aaa' THEN tab1.price ELSE 0 END) col1,
       MAX(CASE WHEN tab1.type = 'bbb' THEN tab1.price ELSE 0 END) col2,
       MAX(CASE WHEN tab1.type = 'ccc' THEN tab1.price ELSE 0 END) col3,
       MAX(CASE WHEN tab1.type = 'ddd' THEN tab1.price ELSE 0 END) col4
FROM tab1
INNER JOIN tab2
  ON tab1.id = tab2.id_fruits
"
14375,SQL Max get the highest id,"SELECT 
    c.clientid, c.clientname, c.billingdate, 
    i.total - (select ifnull(sum(p.amount), 0) from payment p 
               where p.invoice = i.invoiceid Order by i.invoiceid) AS remaining 
FROM 
    client c 
INNER JOIN 
    invoice i 
WHERE 
    c.clientid = i.client 
AND i.invoiceid = (SELECT MAX(i2.invoiceid) FROM invoice i2 WHERE i2.client = i.client) 
ORDER BY 
    clientname
"
5820,Replace second value if count is greater than one,"SELECT
ID, 
IF(Name = @prev, 'XYZ', Name) AS Name,
Value
, @prev:=Name
FROM a
, (SELECT @prev:=NULL) var
ORDER BY ID
"
32887,JPA mapping @OneToOne own class,"  @OneToOne
  @JoinColumns({@JoinColumn(name=""CONIUGE_NAME"", referencedColumnName=""NAME""),
      @JoinColumn(name=""CONIUGE_SURNAME"", referencedColumnName=""SURNAME"")})
  private Person coniuge;
"
39668,IF ELSE CONDITION IN SQL WHERE CLAUSE,"AND CASE WHEN @AutoApprove=0 THEN isapprove ELSE 1 END = 1
"
23544,SQL - difference and average between more records," SELECT Country, City, 
  AVG(CASE WHEN Year=2010 THEN People END)-AVG(CASE WHEN Year=1980 THEN People END) as AvgPeople
 FROM COUNTRY_PEOPLE
 GROUP BY Country, City
"
8303,Joining 3 tables on 2 columns?,"Select coalesce(a.year, b.year, c.year) as Year
  , coalesce(a.variety, b.variety, c.variety) as Variety
  , a.Quantity, b.Quantity, c.Quantity
from tableA a
full outer join tableB b
  on a.variety = b.variety 
  and a.year = b.year
full outer join tableC c
  on isnull(a.variety, b.variety) = c.variety
  and isnull(a.year, b.year) = c.year
where coalesce(a.year, b.year, c.year) = 2015
"
29904,sql how to extract the most common of values from a windowing function,"select id, channel
from (select id, channel, count(*) as cnt,
             row_number() over (partition by id order by count(*) desc) as seqnum
      from table t
      group by id, channel
     ) ic
where seqnum = 1;
"
29880,MySql LeftJoin From Three Tables,"SELECT  a.GamerID,
        a.Name,
        COUNT(*) = COUNT(c.GamerID)
FROM    Gamers a
        CROSS JOIN `Match` b
        LEFT JOIN GameMatches c
            ON  a.GamerID = c.GamerID AND
                b.MatchID = c.MatchID
WHERE   b.gameDate >= CURDATE()
GROUP   BY  a.GamerID,
            a.Name
"
22862,How do I successfully cast a division equation in a Select statement to a floating point or percentage?,"Select Precincts.precinctid,Residences.unique_resadd,Precincts.count_prcnt,(Precincts.precinctID::float8 / Residences.precinctID::float8) AS PCT 
From Residences,Precincts 
Where Precincts.precinctID = Residences.precinctID 
ORDER BY Precincts.precinctid;
"
10491,Group by and counting not returning what I expect,"select group_id, count(distinct album_id) AS churned_albums
from relations
group by group_id;
"
4677,Multiple conditions on filtered index in sql server?,"create table TestTable (
  id int identity primary key,
  a varchar(50),
  b varchar(50)
)

create nonclustered index TestTableFilteredIndex 
on TestTable (b)
where id > 100 
  and a is not null
"
8339,T/SQL - String Manipulation,"SELECT 
  string as InitialString
  ,LEFT(LEFT(String,5) + replace(replace(replace(RIGHT(String,LEN(String)-5),
  'Sa','S'),'Su','S'),'--','-') + '--',7) as FinalString
FROM TempTable;
"
29021,why won't my SQL SUM add for my join?,"SELECT   vendor_name, SUM(payment_total) AS payment_total
FROM     Vendors 
JOIN     Invoices ON (Vendors.vendor_id = Invoices.vendor_id)
GROUP BY vendor_name
ORDER BY payment_total DESC;
"
34428,Cross Join with Filter?,"select t1.vItem, t2.VItem from
    ( select *, ROW_NUMBER() over (order by vItem) r from US ) t1
        inner join
    ( select *, ROW_NUMBER() over  (order by vItem desc) -1 r from SE ) t2
        on t2.r = t1.r % (select COUNT(*) from SE)
order by t1.vItem
"
17557,How to get uniqe values of a varchar variable in oracle pl/sql,"SELECT LISTAGG(x, ';') WITHIN GROUP(ORDER BY x)
FROM (
  SELECT DISTINCT regexp_substr('aa;bb;aa;cc;dd;ee;dd', '[^;]+', 1, LEVEL) AS x
  FROM dual
  CONNECT BY regexp_substr('aa;bb;aa;cc;dd;ee;dd', '[^;]+', 1, LEVEL) IS NOT NULL
);
"
22182,Using If Statement within SQL query,"SELECT t1.ticketId, t1.submittedBy,
  COALESCE(t2.priority, t1.priority),
  COALESCE(t2.ticket_description, t1.ticket_description),
  t1.current_status
FROM table1 t1
LEFT JOIN table2 t2 ON t1.ticketId = t2.ticketId
"
38554,Finding rows with the maximum,"SELECT P.*
  FROM Palettes AS P JOIN
       (SELECT name, MAX(""count"") AS max_count
          FROM Palette
         GROUP BY Name) AS MC
       ON MC.Name = P.Name AND P.""count"" = MC.Max_Count;
"
9015,Convert int to date in SQL server,"SELECT DATEADD(DAY,duration_stay,movedate) AS toDate FROM Table_name;
"
29760,grant permission for dbms_crypto,"select *
from dba_tab_privs
where table_name = 'DBMS_CRYPTO'
  and owner = 'SYS';
"
39373,n00b oracle question,"SQL> conn apc
Enter password:
Connected.
SQL> show user
USER is ""APC""
SQL> conn apc as sysdba
Enter password:
Connected.
SQL> show user
USER is ""SYS""
SQL>
"
23444,"Oracle SQL Query one row with monthly value only, but need to group it by month","SELECT Name,
  SUM(CASE WHEN Start_date <= TO_DATE('01-JAN-2014','DD-MON-YYYY')
      THEN Monthly_Amount ELSE 0 END) AS Jan14,
  SUM(CASE WHEN Start_date <= TO_DATE('01-FEB-2014','DD-MON-YYYY')
      THEN Monthly_Amount ELSE 0 END) AS Feb14,
(etc.)
FROM table1
GROUP BY Name;
"
11706,Find and insert dummy rows - possible scenario for OUTER APPLY,"insert into People(Name, Category, Id)
(
select distinct
  p.Name, 
  c.Category, 
  p.Id 
from 
        people p 
  cross join category c
where
  Concat(p.id, c.Category) not in (select Concat(id, Category) from people)
);
"
29373,"Using CTE , i need to filter out the data",";
WITH myTable([Date], [Name]) 
AS (
    SELECT *
    FROM source_name
    WHERE [Date] BETWEEN DATEADD(day, (@no_of_days*-1), @date) AND DATEADD(day, @no_of_days, @date)
    AND [Date] != @Date

)
.... do something here.
"
24459,combine 2 queries,"Select users.ID as UserID,users.Username, policy.ID as PolicyID,policy.PolicyName, source.Path
from users join groups on group.ID = user.groupID_FK 
   join policy on group.policyID_FK = policy.ID
   left join source
      on group.policyID_FK = source.policyID_FK
      and SourceType = 0 
"
30422,Redundancy in doing sum(),"from table1 t1 join table2 t2 on  t1.id = t2.id
"
22689,Join If ID exists Else return Other Column,"SELECT
  PeopleList.AutoInc_ID,
  IFNULL(EmployeeList.AliasName,PeopleList.Name) as WorkerName
FROM
  PeopleList
  LEFT JOIN EmployeeList ON PeopleList.EmployeeID=EmployeeList.EmployeeID
;
"
23242,Return records repeated according to field value,"WITH RECURSIVE tQty AS(
    SELECT ta.name, ta.qty
       FROM T ta
       WHERE(ta.qty > 0)
 UNION ALL
    SELECT tb.name, tb.qty-1
       FROM tQty tb
       WHERE(tb.qty-1 > 0)
 )
 SELECT name,qty FROM tQty
       ORDER BY name
"
31510,Changing format of Date in sql Excel,"    IIF(`ZVSHPtemp$`.F5 is null, null, dateserial(Right(`ZVSHPtemp$`.F5,4),mid
(`ZVSHPtemp$`.F5,4,2),left(`ZVSHPtemp$`.F5,2))) as [Planned date of shipment start]
"
8111,Hourly average except when hour has only one value,"select 
    dateadd(hour, datediff(hour, 0, CounterDateTime), 0), 
    avg(CounterValue) 
from mopsxactthroughput 
group by 
    dateadd(hour, datediff(hour, 0, CounterDateTime), 0)
having count(*) > 1
"
24446,Entity Relationship diagram for a three-way relationship,"COMPANY_EMPLOYEE_DEPARTMENT:
    COMPANY (PK)
    EMPLOYEE (PK)
    DEPARTMENT
"
19171,SQL Select statement check condition,"SELECT ID, NAME FROM TABLE WHERE ID=@ID

IF (@@rowcount = 0)
    SELECT QTY FROM TABLE WHERE ID=@ID
"
20368,SQL query for finding pairs that share some values but not others,"SELECT T1.Person,T2.Person,CONCAT(T1.Person,' ',T2.Person) AS Person
    FROM
          Build T1 
    INNER JOIN 
          Build T2 
    ON T1.WorkedOn = T2.WorkedOn AND T1.Financed <> T2.Financed 
   WHERE T1.Person < T2.Person
"
30017,Remove duplicate overlapping dates in DB2 Table,"delete from MYTABLE t1 
where t1.DELETABLEFLAG = 'Y' and
exists (select 1
        from MYTABLE t2
        where t2.MATCHCOLUMN = t1.MATCHCOLUMN AND
              t2.DELETABLEFLAG <> 'Y' AND
              t1.START_DATE <= t2.END_DATE AND
              t1.END_DATE >= t2.START_DATE
      );
"
34258,Autonumber - specify starting point,"Dim strSql as String
strSql = ""ALTER TABLE YourTable ALTER COLUMN YourAutoNumberColumn COUNTER(5000, 9)""
CurrentProject.Connection.Execute strSql
"
36190,How to make SQL-injection proof calls to custom table I have created in my Wordpress Database?,"SELECT ... LIMIT  0,9;  -- get 9 records starting from record 0
SELECT ... LIMIT  9,9;  -- get 9 records starting from record 9
SELECT ... LIMIT 18,9;  -- get 9 records starting from record 18
-- etc
"
9384,Can you change content in database via query,"UPDATE table_name
   SET url = CONCAT( 'www.', SUBSTR(url, 8, LENGTH(url) - 7) )
 WHERE url LIKE 'http://%'
"
34168,Loop a Create type as table argument in a stored procedure,"CREATE PROCedure dbo.MyStoredProdure
    @childs as dbo.ChildsCodeList READONLY
    AS    
    SET NOCOUNT ON
    INSERT INTO tbl_test
    -- since no ordering is to be done among rows use 'Select 1'
    SELECT CODE,row_number() over (order by (select 1 )) as Rownum
    FROM   @childs

GO
"
5871,SQLite Convert String to Date in SQL Statement,"SELECT SUM(amount) AS total, 
       (substr(date, 7, 4) || '-' || substr(date, 1, 2) || '-' || substr(date, 4, 2)) AS SomeDate 
FROM transactionRec 
WHERE type = 'W' AND SomeDate BETWEEN DATE('now') AND DATE('now', '+1 day')
"
29098,LPAD/RPAD: Align column,"SELECT k.KUNDENID AS ID, 
       vorname AS Vorname, 
       nachname AS Nachname, 
       LPAD(
         CONCAT(IFNULL(ROUND(SUM(Betrag), 2), 0), ' Euro')
       , 13, ' ') AS Gesamt  
FROM kunde k  
LEFT JOIN verkauf v ON k.KUNDENID = v.KUNDENID  
GROUP BY k.KUNDENID;
"
21679,How to use indexes for a query filtering BETWEEN two columns,"SELECT * FROM autumn.ip WHERE :number-constant >= start
ORDER BY start DESC LIMIT 1
UNION
SELECT * FROM autumn.ip WHERE :number-constant <= end
ORDER BY start ASC LIMIT 1;
"
24451,Sql Server Replication and Identity Columns,"EXEC sp_MSForEachTable '
IF OBJECTPROPERTY(object_id(''?''), ''TableHasIdentity'') = 1
DBCC CHECKIDENT (''?'', RESEED)'
"
12796,Neo4j/Cypher | Not getting unique results from the database,"MATCH (u:user {name:'"" + user + ""'})-[:watched]->()-[r:is_similar_to]-(m)
WHERE NOT (u)-[:watched]-(m) 
RETURN m, sum(r.rated) as score
ORDER by score DESC
"
1624,primary key and clustered index,"CREATE TABLE TableName
(ID INT NOT NULL PRIMARY KEY,
Contact INT NOT NULL UNIQUE CLUSTERED)
GO
"
35761,How to join to a table using aliases,"SELECT Name, PostCode, A.RowIdx AS RowIdx 
FROM
    (SELECT Val AS Name, RowIdx FROM myTable WHERE ColumnID=1) A
    INNER JOIN
    (SELECT Val AS PostCode, RowIdx FROM myTable WHERE ColumnID=2) B
ON A.RowIdx = B.RowIdx;
"
33576,Is it possible using Regular Expression in Oracle?,"update YOUR_TABLE  
set COL = regexp_replace(regexp_replace(COL, 'kumar$|bhai$', ''), 'kumar\s|bhai\s', ' ')
"
27079,Grouping similar values into new select statement,"SELECT Supplier_Name, 
  MAX(CASE WHEN STATUS = 'Unavailable' THEN Count ELSE 0 END) as Unavailable,
  MAX(CASE WHEN STATUS = 'Refunded' THEN Count ELSE 0 END) as refunded,
  MAX(CASE WHEN STATUS = 'Shipped' THEN Count ELSE 0 END) as shipped
FROM YourTable
GROUP BY Supplier_Name
"
22130,SQL Case Statement with a Subselect,"select totaltime = CAST (
   case when exists(
     select * 
     from dg_world_records wr (nolock) 
     where wr.gametypeid = 4 and wr.playerid = 1) 
    then (select min(totaltime) from dg_world_records (nolock) where playerid = 1 and gametypeid = 4)
    else (select max(totaltime) from dg_world_records (nolock) where gametypeid = 4)
    end AS INT)
"
32507,Splitting a string in a stored procedure,"SELECT @len=LEN(@str)

WHILE(@i <=@len)

    BEGIN

        if (SUBSTRING(@str1,@i,1)=@str2)

            BEGIN

                SELECT @laststr = SUBSTRING(@str1,@i+1,@len) 
                break
            END
        SELECT @i = @i + 1
    END
"
2550,Exclude records if right table matches,"SELECT
  A.*
FROM
  A
LEFT JOIN
  B
  ON A.id = B.A
  AND B.cond = 'X'
WHERE
  B.A IS NULL
"
1544,Find Duplicate in Two Columns in sql server,"SELECT  PropertyID, DistrictID
FROM dbo.TableName
GROUP BY PropertyID, DistrictID
HAVING COUNT(*) > 1
"
2337,Avoid repetative column data using select query in oracle,"select 
      CASE
        WHEN f.fyeardescr = lag(f.fyeardescr) over (order by f.fyeardescr)
        THEN NULL
        ELSE f.fyeardescr
      END 
                        AS fyeardescr
  , p.paymnthid
  , p.paymnthnm
  from financialyear f, mnthpll p
 where f.status = 'A' and p.fyearcd = f.fyearcd
"
35104,MySQL query - Inner join using only the latest version of an entry,"SELECT  a.*, c.*
FROM    jobs a
        INNER JOIN
        (
            SELECT jobID, MAX(time) maxVal
            FROM purchaseOrders
            GROUP BY jobID
        ) b ON a.jobID = b.jobID
        INNER JOIN purchaseOrders c
            ON c.jobID = b.JobID AND
                c.time = b.maxVal
"
4616,Updating a record on another table that corresponds to the same record,"CurrentDb.Execute "" UPDATE InfoTable SET Reason = 'blah' WHERE KitNumber = "" & Me.KitNumber
"
4726,How to remove duplicate items in MySQL with a dataset of 20 million rows?,"ALTER IGNORE TABLE my_tablename ADD UNIQUE INDEX idx_name (text1 , text2);
"
3454,How do you update only the year in and keep day and month - sql server,"Update TableName set date = DateAdd(yy,-1,Date) 
"
13887,Get the single column records from the same table,"select ConnectionId as AllId
from LearnerConnections
where LearnerId = 1
union all
select LearnerId as AllId
from LearnerConnections
where ConnectionId = 1
"
3453,OUTER APPLY conditionally pass values into function,"OUTER APPLY [dbo].[udf_GETVMSFleet](o.ClientNum,
  CASE WHEN ou.[UnitNum] = '' THEN ou.[TailerNum] ELSE ou.[UnitNum] END
) AS orgLevels
"
7622,MySQL: Conditions for JOIN ON SELECT UNION,"SELECT o.*, coalesce(r.name, w.name) as name, coalesce(r.address, w.address) as address
FROM order o left outer join
     retailer r
     on o.type_id = r.id and o.type = 'retailer' left outer join
     wholesaler w
     on o.type_id = w.id and o.type = 'wholesaler';
"
7961,MS Access SQL: Grouping By Month,"SELECT
   Format(Sum(IIf(MONTH(Sale_PickupDateTime)=1,1,0))/Count(Sale_PickupDateTime)
         , ""Percent"") AS January
FROM [Sales Table];
"
9271,Assistance with an SQL query using a possible Group By clause?,"SELECT c1.*, c2.*, p1.phone_number
FROM customer c1
JOIN customer_phone_number p1 ON p1.customer_id = c1.id
JOIN customer_phone_number p2 
    ON p1.phone_number = p2.phone_number and p2.customer_id != p1.customer_id 
JOIN customer c2 ON c2.id = p2.customer_id
"
29000,"SQL Group By, Get The row of the Min function","WITH CTE AS
(
   SELECT t.*, RN = ROW_NUMBER() OVER (PARTITION BY prd_id  -- add more columns if you want to group by multiple columns 
                                       ORDER BY prd_estimate_time ASC)
   FROM dbo.TableName
)
SELECT prd_id, prd_description, Stock, [Todays Order], [Tomorrows Order], [Next Batch], prd_status, Prd_line, prd_estimate_time, left_to_produce
FROM CTE
WHERE RN = 1
"
17751,How to select records that are not in another table?,"SELECT t1.cert,t2.job,t2.pcmk,t2.pn
FROM table1 t1
join table2 t2 on (t1.pcmk=t2.pcmk)
WHERE (t1.pn=t2.pn and (t1.stat="""" or t1.stat is null)) 
or t2.pn NOT IN(
  SELECT pn
  FROM table1
  WHERE table1.pcmk=t2.pcmk)
  group by t2.pcmk,t2.pn;
"
18642,Randomly order by display Mysql Row,"SELECT t.*, 
       Floor(Rand() * 500) + 1 AS Random_ID 
FROM   tbl_question t 
ORDER  BY random_id 
"
20916,sql server 2008 - get schema name of the stored procedure getting executed,"OBJECT_SCHEMA_NAME(@@PROCID)
"
24085,Inner queries on a single table with IN and NOT IN conditions,"select user_id
  from my_table
 where role_id in (13,15,11,14) 
 group by user_id.
having sum( case when role_id in (13,15) then 1 else 0 end) = 2
   and sum( case when role_id in (11,14) then 1 else 0 end) = 0
"
8544,"SQL order by highest amount of ""kills divided by deaths""","select id from table order by kills/deaths desc limit 1;
"
5228,How to keep a specific row as the first result of a query (T-SQL)?,"SELECT Name FROM (
    SELECT 'All'       as Name
    UNION 
    SELECT DISTINCT    Manager
    FROM               IS_Projects
) T
ORDER BY CASE Name WHEN 'All' THEN 0 ELSE 1 END, Name
"
2808,How to get the columns from three different tables?,"SELECT 
mg.go_id,
mm.mirna ,
g.go_id , 
g.category, 
g.evidence, 
g.term , 
mg.MSU7_LOC 
FROM  mirna_mrna mm
inner join  mrna_go mg on mg.MSU7_LOC = mm.MSU7_LOC 
inner join  gene_ontology g  on mg.go_id = g.go_id 
where mg.go_id in ('GO:0009058') ;
"
26497,make zero appear last in a list of ascending numbers," ORDER BY epoch_date.epoch == 0, epoch_date.epoch
"
5044,Getting count of each row in oracle sql,"select t.*,
       count(*) over (partition by EmpId) as Count
from table t;
"
27298,columns to rows maintaining userid,"Select UserID,'col1',col1 as 'value' from mytable
union
Select UserID,'col2',col2 from mytable
union
Select UserID,'col3',col3 from mytable
union
Select UserID,'col4',col4 from mytable
"
17341,Limiting output with different criterias,"select row_number() over (), car, group, yearout
from
(
  select 
    row_number() over (partition by inner.group, inner.yearout order by inner.car) as rn,
    inner.car, inner.group, inner.yearout 
  from (select..... ) inner 
  where inner.yearout between '2010' and '2030'
  order by inner.group
) all_records
where all_records.rn <=
(
  select amnt
  from outerno 
  where outerno.year = all_records.yearout
  and outerno.no = all_records.group
);
"
33957,SUM of metric for normalized logical hierarchy,"with recursive temp_table (RootValue, Child, Metric)
as 
(select
    root.Child, root.Child, root.Metric
from table1 root
union all
select
    direct.RootValue, indirect.Child, indirect.Metric
from temp_table direct join table1 indirect on indirect.Parent = direct.Child
)
select
    RootValue, SUM(Metric)
from temp_table
group by RootValue;
"
27871,I do not want all the values in my table,"insert into TableB (SELECT * FROM TableA ORDER BY timestamp DESC LIMIT 100)
"
38972,SQL Repeate or Duplicate results,"SELECT 
emp.name,
emp.lastname,
emp.birthdate,
emp.gender
FROM employee emp
inner join (select 1 as a union all select 2) a on 1 = 1
WHERE employeeid = 1
"
16550,Oracle : how to subtract two dates and get minutes of the result,"SELECT (date2 - date1) * 24 * 60 AS minutesBetween
FROM ...
"
14720,How to get all pks after grouping them (finding duplicates),"select distinct ta_pk, tc_pk
from (
  select ta.pk as ta_pk, 
         tc.pk as tc_pk, 
         count(*) over (partition by ta.fk2) as cnt
  from ta
    join tb on ta.fk2 = tb.pk
    join tc on ta.fk1 = tc.pk
) t
where cnt > 1;
"
2171,"Clickable ListView item needs SQL function new item, how?","lv.setOnItemClickListener(new OnItemClickListener(){
                public void onItemClick(AdapterView<?> parent, View view,
                        int position, long id) {
     String rowData = (String) lv.getItemAtPosition(position); //you'll need to make the lv as final
     String[] data = rowData.split("" ""); //split the result using the spaces (so you could obtain the name, hotness and the other string you use)
     entry.createEntry(data[0], data[1]);
}
"
7744,Convert SQL to MongoDB,"db.oshibka.remove( { date : { $lt : <now-900> } } )
"
14724,Is it possible to optimize these 2 select statements into one?,"Select 1 
from Friend f
join User u
    on f.FriendID = u.UserID
    and u.UserName = 'friend_user'
where 
    f.UserID = 1;
"
6738,How to SQL Insert IDs with PHP,"INSERT INTO MUSIC (SONG, ARTIST) VALUES (earth, mark);
"
32865,Sql recursive query to create a unique list,"; WITH CategoryTree(CategoryID, sorthelp) AS
(SELECT CategoryID, 0 FROM Categories WHERE ParentID IS NULL)

UNION ALL

(SELECT C.CategoryID, CT.sorthelp + 1 FROM Categories C INNER JOIN CategoryTree CT ON C.PARENTID = CT.CategoryID)

SELECT DISTINCT TemplateID FROM RoleTemplates WHERE CategoryID IN (SELECT CategoryID FROM CategoryTree)
"
1509,"Insert manually into a table by SQL statement, but key is autoincremented","INSERT INTO table_name (username, password)
VALUES ('Mike', 'Mike');
"
39543,SQL: join 2 table and change id to username,"SELECT t1.id, t1.item_name,
  t2enteredBy.username enteredBy,
  t2modifyBy.username modifyBy
FROM table1 t1
JOIN table2 t2enteredBy ON t1.entered_by = t2enteredBy.id
JOIN table2 t2modifyBy ON t1.modify_by = t2modifyBy.id
"
18096,"How ""sqlplus /"" works","#!/bin/bash
if [[ ""$1"" != ""/"" ]] ; then
    $ORACLE_HOME/bin/sqlplus ""$@""
    exit
fi
shift
$ORACLE_HOME/bin/sqlplus $MY_ORA_USER/$MY_ORA_PWD ""$@""
"
21102,sql statement query last data,"WITH years([year])
AS
(
SELECT   DISTINCT TOP 3 YEAR([date]) AS [date]
FROM     Table1
ORDER BY YEAR([date]) DESC
)
SELECT TOP 3 [year]
FROM years 
ORDER BY [year] ASC;
"
23459,Optimal use of indexes for aggregate queries,"CREATE INDEX tbl_mult_idx ON tbl (tran_type, acct_id)
"
18141,get empty result from sql query,"SELECT    p1.cost AS V1, p2.cost AS V2 , p3.cost AS V3 
FROM      product p1
LEFT JOIN product p2 on p2.id = 2
LEFT JOIN product p3 on p3.id = 3
WHERE     p1.id = 1
"
9019,"Make SSRS Multiple Values parameters act like a ""AND""","WHERE Monday = 'YES' AND Tuesday = 'YES'
"
27428,Oracle conditional join,"select t1.* from table1 t1
  where 
    (should_filter_table2 = 0 or (
        (t1.key, 'something', 1) in (
             select key, value, row_number() over 
                               (partition by key order by whatever) rn 
               from table2) 
        )
    )
  and [...lots of things...]
"
19732,sql server : count records,"WITH tableA(ID, Match) AS
(
SELECT 1,123 UNION ALL
SELECT 2,123 UNION ALL
SELECT 3,12 UNION ALL
SELECT 4,12 UNION ALL
SELECT 5,4 UNION ALL
SELECT 6,12 UNION ALL
SELECT 7,8
)
SELECT *,
       CASE
         WHEN ROW_NUMBER() OVER (PARTITION BY Match ORDER BY ID) = 1 
         THEN COUNT(*) OVER (PARTITION BY Match)
       END AS Tot
FROM   tableA
ORDER  BY ID  
"
7740,Using a third table to define my selection,"select students.*
from students
join student_class
on students.student_id = student_class.student_id
where
    (select distinct event.class_id 
    from event
    inner join student_class
    on student_class.class_id = event.class_id
    where upper(event.event_name) = 'GUEST SPEAKER'
    ) = student_class.class_id;
"
12417,SQL returning duplicates,"SELECT t1.JobID AS JID, SUM(DISTINCT(TimeTaken)) as 'HoursSold', SUM(DISTINCT(s.CostPrice * mfj.Quantity)) as 'TotalStockCost'
FROM TimeLogs tl
LEFT JOIN MaterialsForJob mfj on mfj.JobID = tl.JobID and mfj.UserID = tl.UserID
INNER JOIN Stock s on s.ID = mfj.StockID
WHERE 
    tl.UserID = 10000 and 
    tl.DateEntry between dateadd(wk, datediff(wk,0,'11/07/2013'), 0) and
    dateadd(wk, datediff(wk,0,'11/07/2013'), 6)
GROUP BY JID
"
12569,SQL Select aggregate values in column,"SELECT  name,
        COALESCE(SUM(CASE WHEN availability = 'available' THEN 1 ELSE 0 END), 0) AS available,
        COALESCE(SUM(CASE WHEN availability = 'available' THEN 0 ELSE 1 END), 0) AS not_available
FROM    mytable
GROUP BY
        name
"
32019,What is returned when I count nulls?,"SELECT 
     SUM(CASE WHEN field IS NULL THEN 1 ELSE 0 END) as numNULL,
     SUM(CASE WHEN field IS NULL THEN 0 ELSE 1 END) as numNOT_NULL,
FROM table
"
39001,Search and replace part of string in database,"update VersionedFields
set Value = replace(value,'<iframe','<a>iframe')

update VersionedFields
set Value = replace(value,'> </iframe>','</a>')
"
3938,Query automatically excluding records with no entries,"SELECT v.vname, count(ok)/count(distinct o.pk) AS avg 
FROM v
left join o on o.pk = p.pk
inner join p on p.vk = v.vk
group v.vname
"
19897,selecting from a table based on a distinct column,"SELECT 
    MAX(id) AS id, 
    pro 
FROM ProLookup 
WHERE pro LIKE '%"" & replace(q,""'"",""''"") & ""%'""
GROUP BY pro
"
11443,SQL Server 2008 Inserting new record for missing dates in a table,"select t1.product, t2.enddate, coalesce(t3.saleamt,0) saleamt
from (select distinct product
      from table1) t1
cross join (select distinct enddate
            from table2) t2
left join table1 t3 on t1.product = t3.product 
  and t2.enddate = t3.enddate
"
39672,Oracle sql Inner join first record in right table,"SELECT t1.symbol, t3.high, t3.low, t3.timestamp 
FROM Table1 t1
JOIN (
      SELECT inn.* 
      FROM (SELECT t2.*, (ROW_NUMBER() OVER(PARTITION BY symbol ORDER BY timestamp DESC)) As Rank 
            FROM Table2 t2) inn 
      WHERE inn.Rank=1
     ) t3
     ON t1.symbol = t3.symbol;  
"
6244,More efficient SQL statement to eliminate my n^2 algorithm?,"SELECT *
FROM Customer c
WHERE
    NOT EXISTS(
        SELECT 1
        FROM GroupCustomer
        WHERE
            CustomerID = c.CustomerID
            AND GroupID = @selectedGroupParameter
    )
"
32587,MySQL - How to perform a multiple join query?,"select
    c.cashierid, min(c.name) as name, min(c.age) as age,
    sum(s1.amount * 0.2) + sum(s2.amount * 0.3) + sum(s3.amount * 0.4)
from
    cashiers c
    left outer join sales s1 on s1.cashierid1 = c.cashierid
    left outer join sales s2 on s2.cashierid2 = c.cashierid
    left outer join sales s3 on s3.cashierid3 = c.cashierid
group by
    c.cashierId
"
11890,Run function on table_1 with every value from table_2 as a parameter,"SELECT 
  ph.parent_id, 
  ph.child_id,
  th.aname AS attribute_label,
  get_attribute(child_id, th.aname) AS attribute
FROM 
  product_hierarchy ph
  CROSS JOIN table_hierarchy th
"
3049,dumping non transfered data in a positional file,"CREATE PROCEDURE my_procedure_name AS
    v_file UTL_FILE.file_type;
BEGIN
   ...
END;
/
"
33244,SQL Query without duplicates,"WITH pjobs AS (
  SELECT id, job, 
  ROW_NUMBER() OVER(PARTITION BY id ORDER BY   job) rn FROM jobs
), pphones AS (
  SELECT id, phone, 
  ROW_NUMBER() OVER(PARTITION BY id ORDER BY phone) rn FROM phones
)
SELECT name, job, phone
FROM pjobs FULL JOIN pphones ON pjobs.rn = pphones.rn AND pjobs.id = pphones.id
RIGHT JOIN names ON names.id = pjobs.id OR names.id = pphones.id
"
5564,mysql query to get the count of each element in a column,"select main_cat_id , count(*) as total
from category
where ( main_cat_id in (select categoryid from products) 
                       OR 
       sub_cat_id in (select categoryid from products)
       )
group by main_cat_id 
order by total desc
"
15800,MySQL query that checks if two user ids are friends,"SELECT a.userid1, a.userid2
FROM friendship a
INNER JOIN friendship b
ON a.userId1 = b.userId2 AND b.userId1 = a.userId2
"
30105,Excluding insert of specific rows when copying data in same table,"INSERT INTO table (product_id, value, branch_id)
SELECT t1.product_id, t1.value, '71'
FROM table AS t1
LEFT JOIN table AS t2 ON t1.product_id = t2.product_id AND t2.branch_id = '71'
WHERE t1.branch_id = '53' AND t2.product_id IS NULL
"
1165,"Non linear, three way sum of table data","select user_name, id, min(status), sum (calls)
from yourtable
where status in  ('BadAD', 'Lead', 'DNC')
group by user_name, id
"
9824,MySQL order STRING as INT and inserting,"ORDER BY print_id + 0, print_id
"
33099,Issue with Oracle Stored Function,"SELECT rec_date_sf(registration) as date_rent_start, 
       registration
  FROM i_booking 
 WHERE registration = 'E246WFC';
"
22727,SELECT query from 2 tables,"SELECT userId, firstName, lastName, phone, address, SUM(score) AS score FROM matches join users on matches.user_id = users.user_id GROUP BY userId ORDER BY score DESC
"
15878,optimize query using NOT EXIST,"Select I_Ftn, I_Col, count(c.i_id_num) cnt 
From DSCL_ALL.W_CALENDER c 
Where c.UNIT_CODE= '01' 
AND c.i_g_vill = '45'
and c.i_g_code = '1'
and c.survey_year = '2012-2013'
and not exists (select 1 from w_mill_pur m where m.unit_code = c.unit_code and m.m_vill = c.i_g_vill and m.m_grow = c.i_g_code and m.m_indent = c.i_number)  
Group By I_Ftn, I_Col
ORDER BY I_ftn, I_col)
"
38528,How do I join the most recent row in one table to another table?,"SELECT e.*, s1.score, s1.date_added 
FROM entities e
  INNER JOIN scores s1
    ON (e.id = s1.entity_id)
  LEFT OUTER JOIN scores s2
    ON (e.id = s2.entity_id AND s1.id < s2.id)
WHERE s2.id IS NULL;
"
35267,Use IF statement within update statement in SQL,"UPDATE table SET col=
 case when (condition) then value1
 ELSE value2
 end
"
34272,How can I form MySQL query algorithm to add columns to another table?,"INSERT INTO mynewtable 
SELECT LINKS.sentenceId, SRC_SENT.language AS srcLanguage,
       LINKS.translatedId, DST_SENT.language AS dstLanguage
FROM LINKS
INNER JOIN sentences SRC_SENT ON (LINKS.sentenceId = SRC_SENT.id)
INNER JOIN sentences DST_SENT ON (LINKS.translatedId = DST_SENT.id)
"
1588,Joining 2 tables SQL,"SELECT t.Name, a.X, a.Y
FROM aisle a INNER JOIN type t 
ON   a.aisle_id = t.aisle_id
WHERE a.Name =""bread""
"
6592,How to fill null field from another table in oracle?,"select e.op_id
,      nvl(e.op_name, o.emp_name) op_name
,      e.emp_id 
from   employee e
,      other_employee_table o
where  e.emp_id = o.emp_id
and    ...
"
19593,SQL Unpivot Text Contents,"SELECT 
    [PK_ID]
    ,[JOB_ID]
    ,[NOTE] 
FROM 
    Table1 
CROSS APPLY 
(
    SELECT [NOTE1] AS [NOTE]
    UNION ALL 
    SELECT [NOTE2] AS [NOTE]
) T
WHERE T.NOTE IS NOT NULL
"
13230,Nested SELECT query with COUNT condition,"select DEALS.id, DEALS.field_b, DEALS_COUNTRY.field_c DEALS_COUNTRY.field_d, 
 from DEALS
 inner join DEALS_COUNTRY
 on DEALS.id = DEALS_COUNTRY.id
 where  exists
 (
    select x.id
    from DEALS_COUNTRY x
    where  x.id = DEALS.id
    group by x.id
    having count(x.id) > 1
 ) 
 order by deal_id
"
7316,How to do row-wise comparison between SQL (Oracle) fields?,"select *
from tablename
where time < start_time
"
21339,Connecting table with multiple foreign keys in mysql,"select u.displayname
from users u
inner join owners o on
    o.primaryitowner = u.username
    or o.secondaryitowner = u.username
    or o.primarybusinessowner = u.username
    or o.secondarybusinessowner = u.username
"
14739,INSERT in TABLES with circular references SQL,"ALTER TABLE DEPARTAMENTOS 
    ADD CONSTRAINT FK_DEPT_EMP FOREIGN KEY (numDirect) 
    REFERENCES EMPLEADOS(numEmpl)
    DEFERRABLE INITIALLY DEFERRED
    ;
ALTER TABLE EMPLEADOS 
    ADD CONSTRAINT FK_EMP_DEPT FOREIGN KEY (numDept) 
    REFERENCES DEPARTAMENTOS(numDept)
    DEFERRABLE INITIALLY DEFERRED
    ;
"
35205,MySQL distinct count type query with RethinkDB,"r.table('channels').filter(
  {community_id: 'MY_COMMUNITY_ID', type: 'public'}
).merge(function(channel) {
  return {user_count: r.table('channel_users').filter({channel_id: channel('id')}).count()};
}).orderBy(r.desc('user_count')).limit(5)
"
934,ORACLE sql hours between two timestamps format,"SELECT  extract( hour from x) hours FROM
(SELECT (date1 - date2)x FROM B)
"
12133,SQL Select - Fetching two different values from another table based on two different IDs,"select t1.EmployeeId, t1.EmployeeCarModelID, t2emp.CarModelName as EmployeeCarModelName,
       t1.SpouseCarModelID, t2sp.CarModelName as SpouseCarModelName
from table1 t1 left join
     table2 t2emp
     on t1.EmployeeCarModelID = t2emp.CarModelId left join
     table2 t2sp
     on t1.SpouseCarModelId = t2sp.CarModelId;
"
30321,Compare two tables and extract missing element per date,"select
    d.datePlaying, p.namePlayer
from
    table2 p
cross join 
    (select distinct datePlaying from table1) d
left join
    table1 t on t.idPlayer = p.idPlayer and t.datePlaying = d.datePlaying
where
    t.idPlayer is null
"
27002,Query to find columns that end with percent symbol %,"DECLARE @TMP TABLE(COL VARCHAR(MAX))
INSERT INTO @TMP VALUES ('100%')
INSERT INTO @TMP VALUES ('100px')

SELECT * FROM @TMP WHERE COL LIKE '%[%]' 
"
37276,Trying to read multi valued items using YAML,"#!/usr/bin/perl
use strict;
use warnings;

use YAML;

my $struct = [ 'PROD_NAMEA' => [qw[ system myschema myschema2 myschema3 ]],
               'PROD_NAMEB' => [qw[ system ]],
             ];
print Dump($struct);
"
32763,Laravel. seeding large sql file,"exec(""mysql -u "".\Config::get('database.mysql.user')."" -p"".\Config::get('database.mysql.password')."" "".\Config::get('database.mysql.database')."" < script.sql"")
"
16215,Is there a way to select the maximum row id in MySQL without scanning all rows with MAX()?,"alter table `table` add index groupId_with_id_idx (groupId, id);
desc SELECT MAX(id) FROM table use index (groupId_with_id_idx) WHERE groupID=12345;
/* the execution plan should return ""Select tables optimized away"" */
"
31059,Clearing a table before insertion,"TRUNCATE TABLE [dbo].[Cars]
SET IDENTITY_INSERT [dbo].[Cars] ON
.....
Many insert statements
.....
SET IDENTITY_INSERT [dbo].[Cars] OFF
"
39931,Help with string formatting in SQL Server Query,"CASE
    WHEN PageNumber LIKE '[0-9][0-9][0-9]%' THEN LEFT(PageNumber, 3)
    WHEN PageNumber LIKE '[0-9][0-9]-[0-9][0-9], [0-9][0-9][0-9]') THEN RIGHT(PageNumber , 3)
    WHEN PageNumber LIKE '[0-9][0-9]%') THEN LEFT(PageNumber, 2)
END
"
39642,Query database settings?,"SELECT name,
       snapshot_isolation_state, 
       is_read_committed_snapshot_on
  FROM sys.databases 
 WHERE name = @YourDatabaseName
"
32231,database design: problem with updating a table,"SET title = COALESCE(@title, title), 
    Desc= COALESCE(@Desc,Desc)
"
35349,Create new table with data from Wordpress wp_postmeta table,"select post_id, 
       max(case when meta_key = 'Name' then meta_value end) as Name,
       max(case when meta_key = 'Issuer' then meta_value end) as Issuer,
       max(case when meta_key = 'Issuer_Subtype' then meta_value end) as Subtype
FROM wp_postmeta
group by post_id 
"
25623,SQL Stuck on simple left join,"SELECT
    g.guest_id,
    g.fname,
    g.lname,
    i.fname AS inviter_fname,
    i.lname AS inviter_lname
FROM
    guests g
LEFT JOIN
    guests i
ON
    g.inviter_id = i.guest_id
"
16677,Changing TextBox fields on Lost Focus,"Private Sub txtCC_LostFocus()
      txtCC.Text = Left(txtCC, 4) & String(8, ""x"") & Right(txtCC, 4)
End Sub
"
21076,SQL - Returning all rows even if count is zero for item,"SELECT Tree.Type as 'Requirement Type',
       COUNT(CASE WHEN [Tree].[creationDate] >= ('2010-01-01') and [Tree].[creationDate] < ('2020-01-01') THEN Tree.Type END) AS 'Number in Creation Range'
FROM [Tree] 
INNER JOIN @ReqType As RT on RT.Type = Tree.Type
INNER JOIN [Project_INFO]  ON [Project_INFO].[ProjectID]=[Tree].[Project_ID] 
INNER JOIN @CreationCount AS CCount ON CCount.BaselineID=Tree.Baseline_ID 
WHERE [Project_INFO].[Name] = 'Address Book' AND CCount.Name = 'Current Baseline' 
GROUP BY tree.Type
"
2649,SQL Categories with JOIN - multiple Select,"SELECT *
FROM inserate
WHERE ID IN
(
SELECT InseratID
FROM rubrikenZuordnungen
WHERE RubrikID IN (35,36)
GROUP BY InseratID
HAVING COUNT(DISTINCT RubrikID)=2
)
"
35293,SQL-ex.ru Execise 14,"SELECT DISTINCT maker, type 
FROM product 
WHERE maker IN 
   (SELECT DISTINCT maker 
    FROM product 
    GROUP BY maker HAVING COUNT(distinct type) = 1
    AND count(model) > 1)
"
26519,What is difference in performance of following 2 queries,"A (id, name)
B (id) includes (class, std)
C (id) includes (result)
D (name) includes (grade)
"
34375,SQL - Update column for different rows,"SELECT
      id,
      -1 + ROW_NUMBER()  OVER (PARTITION BY some_id ORDER BY some_id) as [Count],
      some_id
FROM YourTable
"
1233,Grouping by MONTH in SQL,"select MONTH(DATE) As ""Month""
from DW******.SL****
Group By MONTH(DATE)
Order by MONTH(DATE)
"
14132,How to create an index for elements of an array in PostgreSQL?,"CREATE EXTENSION intarray;
"
18158,Calulating the hours and minutes between clock in and clock out timestamps,"select EMP ,sum(datediff(hour,cast([in] as datetime)
       ,cast([out] as datetime)) ) 
from table1
GROUP BY EMP
"
38382,SQL identifying the first occurance in a list,"select
   breakfast
 , case when rn = 1 then 1 else 0 end as first_occur
from (
       select 
         breakfast
       , row_number() over (partition by breakfast order by ID DESC) as rn
       from your_table
     ) as x
"
7078,Return all rows/columns where multiple columns are non distinct,"SELECT t1.*
FROM
    [DailyTaskHours] t1
INNER JOIN (
  SELECT
      ActivityDate, taskId
  FROM
      [DailyTaskHours]
  GROUP BY
      ActivityDate, taskId
  HAVING 
      COUNT(*) > 1
) t2 ON (
  t1.ActivityDate = t2.ActivityDate AND
  t1.taskId = t2.taskId
)
"
31504,Optional requirement on where clause in LINQ,"from x in p where (x.f1 == a || a == """") && (x.f2 == b || b == """") && (x.f3 == c || c == """") select new { f1 = x.f1, f2 = x.f2, f3 = x.f3 }
"
32249,Query Issue in sql,"SELECT COUNT(user_id) 
FROM t_user 
WHERE user_id = 2699478 
  AND object_id = 1329 
  AND user_id NOT IN
    (
        SELECT owner_user_id 
        FROM t_obj 
        WHERE actual_id = 17447
    ) 
"
34380,how to load specific attributes from two table to another?,"INSERT INTO newusers (Id, First_Name, Last_Name, Hometown_Id)
SELECT users.Id, users.First_Name, users.Last_Name, locations.Id
FROM users
INNER JOIN locations
ON locations.City = users.Hometown_City
AND locations.State = users.Hometown_State
AND locations.Country = users.Hometown_Country
"
36257,"Update Table with a ""Select query"" with a where clause","   update 
          my_table 
   set 
      my_table.totalZ = t.total 
   FROM
    my_table mt
    INNER JOIN 
       (select id,count(*) as total 
       FROM my_table2 
      WHERE column_2 = 1 GROUP BY id) t
   on mt.id  = t.id
"
21433,Can I consider Multiple Row values as one in a group by clause?,"SELECT
  CASE WHEN Col1 IN ('A','B') THEN 'AB' ELSE Col1 END AS Col1Group,
  COUNT(*)
FROM table
GROUP BY
    CASE WHEN Col1 IN ('A','B') THEN 'AB' ELSE Col1 END
"
29055,Getting a list of text concatenated in a group by,"Declare @tbl table ([site] nvarchar(100),Cell nvarchar(100),Value nvarchar(100))
INSERT INTO @tbl values('A','b','1')
INSERT INTO @tbl values('A','c','2')

SELECT [Site],
SUBSTRING(
(
select ' ,'+  Cell +'=' + CAST(value AS VARCHAR)
from @tbl b
WHERE a.[Site] = b.[Site]
FOR XML PATH('')
)
,3,100)

FROM @tbl a
GROUP BY a.[Site]
"
1902,counting rows in select clause with DB2,"select t.*, g.tally
  from mytable t,
       (select count(*) as tally
          from mytable
       ) as g;
"
36155,How to Check Oracle Column Values are all the same for a Specific ID,"SELECT ID, CASE WHEN COUNT(*) > 1 THEN 'No' ELSE 'Yes' END As ""Result""
FROM (SELECT DISTINCT ID, COL1, COL2, COL3, COL4, COL5
      FROM Table_Data) dist
GROUP BY ID      
"
33369,Use FLOOR() (or other SQL functions) in Django queries,"MyModel.objects.extra(group='FLOOR(quantity/100)')\
    .values('group')\
    .annotate(count=Sum('quantity'))\
    .order_by()
"
5748,Upload MVC4 site to server,"   <add name=""SimpleSecurityConnection"" connectionString=""Data Source=(LocalDb)\v11.0;Initial Catalog=aspnet-SeedSimple-20130125152904;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnet-SeedSimple-20130125152904.mdf"" providerName=""System.Data.SqlClient"" />
"
34820,How do you find out which database links are used in queries for the Oracle RDBMS?,"select * from dba_db_links;
"
851,"Counting orders and grouping them, linq to sql","Dim ord = (db.Orders.GroupBy(Function(n) n.ProductID, Function(key, values) New With {.ID = key, .Avg = values.Average(Function(n) n.Amount)})).GetEnumerator
"
9971,get unique color_id which stock's quantity is more than order's quantity,"SELECT *
FROM stock s LEFT JOIN
     order o
     on s.id = o.stock_id
WHERE s.quantity > COALESCE(o.quantity, 0);
"
37105,SQL Two fields from tables of unassociated data into the same field?,"SELECT Title FROM TableA
UNION ALL
SELECT Title FROM TableB
"
36982,Formatting Date from Select Statement," SELECT convert(varchar(10), a.[firstDate], 101) AS 'First Date',
     convert(varchar(10),a.[secondDate], 101) AS 'Second Date'
 FROM [firstTable] a
 left join [secondTable] b on b.[code] = a.[code]
 WHERE b.[name] = 'John Doe'
"
33942,Setting Oracle Timestamp with Coldfusion,"<cfquery name=""qTest"">
  insert into myTable(myTimestampCol)
  values (<cfqueryparam cfsqltype=""cf_sql_timestamp"" value=""#now()#"" />)
</cfquery>
"
18695,Like statement with quotes in sqlite database query?,"Cursor c = myDB.query(MY_DATABASE_TABLE, ""songname"",""songname like ?"" , new String[]{""%""+MATCH_STRING+""%""}, null,""SongHit"", null);
"
26345,Postgresql query current year,"SELECT * FROM mytable WHERE date_part('year', mydate) = date_part('year', CURRENT_DATE);
"
29075,To get the input of the subquery in the output of the main Result,"SELECT r.doc_id,a.id
FROM request r
INNER JOIN action a
ON r.id=a.request_id
WHERE a.id in (1253960076)
"
13108,Oracle Temporary Storage Within a Function,"declare
  type my_record_type is record (testId number, testvalue number);
  type my_table_type is table of my_record_type index by binary_integer;
  my_table my_table_type;
begin
  select x, y bulk collect into my_table from table_foo;
end;
"
39347,mySQL SELECT using a foreign key in another table,"select el.data from event_list el
join event_default ef on el.id = ef.default_id
"
33511,SQL update records in one table that satisify a query result on a related table,"UPDATE TBL_EVENTS 
SET Entered_By = 'Fred' 
WHERE EXISTS (
  SELECT 1 
  FROM   TBL_LOCATIONS 
  WHERE  TBL_LOCATIONS.Location_ID = TBL_EVENTS.Location_ID
  AND    TBL_LOCATIONS.Notes = 'needs update'
)
"
8049,"Joining two tables using third as linking table, including null entries","select
    account.bill_acct,
    account.status,
    account.remarks,
    stage.account_class
from
    registration_account account
    left join registration_profile profile
            on account.profile_id = profile.reg_prof_id
    left join acct_stg stage
            on stage.ecpd_profile_id = profile.ecpd_profile_id
                and stage.bill_acct = account.bill_acct
where
    profile.ecpd_profile_id = ?
"
9379,SQL Server: pointing to the ID from other table,"update B
set status2 = 'Fail of ID ' + CAST(A.ID1 AS VARCHAR(4))
from tableB B
Inner join tableA A
on a.match1 = b.match2
where a.status1 = 'FAIL'
"
32693,SQL Server: Curious about performance impact of this SQL statement,"SELECT SUM(CASE WHEN [Number] < @Value THEN [Number] ELSE @Value END)
FROM [MyTable] 
WHERE <condition>
"
8011,How to find partial duplicates?,"delete
  from #yourtable   t1
 where exists (
          select 1
            from #yourtable t2
           where t2.source = t1.source
             and t2.target <> t1.target
             and t2.target like t1.target || '%'
       )
     ;
"
21578,Combine two DateTimes,"SELECT CONVERT(VARCHAR(10),@DayPart,111) + ' ' +  
       CONVERT(VARCHAR(10),@TimePart,108);
"
3248,MySQL query with left Join?,"SELECT Items.*, useritems.UID FROM `Items` 
    left join useritems on Items.Item=useritems.Item 
    ORDER by `Icons` ASC
"
7528,Grouping by row number in a column,"SELECT PartNumber, SUM(Qty)
FROM (
   SELECT PartNumber, Qty, 
          ROW_NUMBER() OVER (PARTITION BY [Group] ORDER BY id) AS idx
   FROM mytable) AS t
GROUP BY PartNumber, idx
ORDER BY idx
"
9342,why is SQL CASE returning both true and false?,"SELECT  * 
FROM    #table1 t
JOIN    #table2 t2 ON t.fieldA = CASE WHEN t.fieldA <> t2.fieldB THEN '*** OTHER ***' ELSE t2.fieldB END
"
21246,Joining Table using range in foreign key,"select t1.*,
       (select top 1 Y
        from table2 t2
        where t2.id <= t.id
        order by t2.id desc
       ) as Y
from table1 t1;
"
24918,MySQL to display earliest duplicate based on given parameters,"echo ""select name, min(reported_at) from nodes where reported_at < curdate() or reported_at is null group by name;"" | 
mysql dashboard
"
16184,How to extract part of text that comes before first space in string?,"select (case when PersonalInfoName like '% %'
             then left(PersonalInfoName, charindex(' ', PersonalInfoName) - 1))
             else PersonalInfoName
        end)
"
14650,SQL/Oracle: Select min and max column values for each unique value in another column,"select min(code) as min,
       max(code) as max,
       type
from your_table
group by type
"
7408,Postgresql: Split columns into rows,"Select gid, 'cat1' as category, cat1 as value, some_value from t
union all
Select gid, 'cat2' as category, cast(cat2 as varchar(100)) as value, some_value from t
order by gid
"
33300,SQL UPDATE query with JOIN,"UPDATE ps_product_lang AS L 

  JOIN ps_product AS P 
    ON L.id_product = P.id_product

   SET L.description = REPLACE(L.description, '196,99', '197') 

 WHERE P.id_category_default = 23
"
5615,Oracle data in 24 hour format,"SELECT TO_CHAR(time, 'mm/dd/yyyy hh24:mi:ss') from mytable
"
15108,Query to Find Double-Header,"select team, day, count(*) as numgames
from ((select id, homeid as team, date(start_date) as day
       from t
      ) union all
      (select id, awayid as team, date(start_date)
       from t
      )
     ) t
group by team, day
having numgames > 1;
"
1017,MySQL having if,"SELECT id, name, label, date
FROM items
WHERE date >= date(now()) and date < date(now()) + interval 1 day
GROUP BY label
HAVING (COUNT(id) > 10 and label = 5) or (label <> 5);
"
2256,Getting lowest values in GROUP BY,"WITH test_data AS (
  SELECT 1 key, 1 a, 2 b FROM dual UNION ALL  --# Lowest a for key=1
  SELECT 1 key, 2 a, 1 b FROM dual UNION ALL
  SELECT 2 key, 3 a, 3 b FROM dual UNION ALL  --# Lowest a for key=2, lowest b
  SELECT 2 key, 3 a, 4 b FROM dual UNION ALL
  SELECT 2 key, 4 a, 5 b FROM dual
)
select 
  key, 
  min(a) as a,
  min(b) keep (dense_rank first ORDER BY a, b) as first_b,
  SUM(b) AS sum_b
FROM test_data
GROUP BY key
"
13515,Need Help Sending a URL with Device Token to our database from our iPhone App,"   NSString *deviceToken = [[_deviceToken description] stringByReplacingOccurrencesOfString: @""<"" withString: @""""];
    deviceToken = [deviceToken stringByReplacingOccurrencesOfString: @"">"" withString: @""""] ;
    deviceToken = [deviceToken stringByReplacingOccurrencesOfString: @"" "" withString: @""""];
"
32025,MySQL generate a column based on if condition,"select a.id, a.title, 
    case when p.id is not null then 1 else 0 end is_paid
from advertisement a
    left join payment p on a.id = p.ad_id and p.user_id = 123
"
1280,"date , time date format","SELECT CONVERT(VARCHAR(20), SYSDATETIME(), 22)
"
17578,Find IDs of differing values grouped by foreign key in MySQL,"SELECT ... FROM ... WHERE ... IN ('true','false')... GROUP BY ... HAVING COUNT(DISTINCT status) = 2;
"
39872,Retrieving data from unnormalized vertically ordered table,"select id,
       max(case when code = 100 then value end) as value1,
       max(case when code = 150 then value end) as value2,
       max(case when code = 200 then value end) as value3
from table t
group by id;
"
13759,Select 1 of many rows linked to ID SQL,"create table mydb.test as
select substr(db1.table1.Account_Num, 1, 6) as Account_Number,
       substr(db1.table1.Descriptor, 1, 2) as Company_Description,
  from db1.table1 
       join db1.table2 
           on db1.table1.Account_Num = db1.table2.Account_Num
 where db1.table1.descriptor like 'Company:%'
        order by Account_Number Desc;
"
20822,Search numeric or string value as wildcard in sql server,"DECLARE @p VARCHAR(10) = 'jo'
--DECLARE @p VARCHAR(10) = '34'

DECLARE @t TABLE(StuffID INT, Name VARCHAR(100))
INSERT INTO @t VALUES
(1234, 'Michael Jordan'),
(7845, 'Scottie Pippen'),
(6541, 'Dennis Rodman'),
(1987, 'Phil Jackson')

SELECT * FROM @t
WHERE (@p NOT LIKE '%[^0-9]%' AND StuffID LIKE '%' + @p + '%') OR
      (@p NOT LIKE '%[^a-z]%' AND Name LIKE '%' + @p + '%')
"
36246,Optimizing multiple selects from the same table,"SELECT DISTINCT
   X.*
FROM
   dbo.MyTable T
   CROSS APPLY (VALUES
      (1, T.Name, T.Description, NULL, NULL, NULL),
      (2, NULL, NULL, T.Price, NULL, NULL),
      (3, NULL, NULL, NULL, T.MiscColumn1, T.MiscColumn2)
   ) X (Type, Name, Description, Price, MiscColumn1, MiscColumn2)
;
"
14675,How to Compare information schema column with Table Column in Sql Server2008 using inner Join?,"select *
from A1 a
inner join information_schema.columns c on c.column_name = a.A1
where c.table_name = 'B'
"
13871,Rotate/Generate table in Oracle,"select * from 
table1
pivot
(
   max(""Value"")
  for ""Machine"" in ('M1', 'M2')
      )
"
3294,When using SELECT can you modify the value of a returned field based on other fields?,"SELECT city,state,
CASE 
 WHEN (city IS NULL OR city='') AND (state IS NULL or state='') THEN ''
 ELSE country
END as country_1
 FROM `table`
"
4153,group by access seperate column,"SELECT   t.date, COUNT(*)
FROM     (SELECT DISTINCT [TimeTrackingLog-sql].date, 
                          [TimeTrackingLog-sql].callerName
          FROM   [TimeTrackingLog-sql]) t
GROUP BY t.date
"
3230,Sql Pivoting with Two Aggregate Function,"select place, id,
       max(case when date_1 = '2016-03-01' then fq end) as fq_20160301,
       max(case when date_1 = '2016-03-01' then plan end) as plan_20160301,
       max(case when date_1 = '2016-03-02' then fq end) as fq_20160302,
       max(case when date_1 = '2016-03-02' then plan end) as plan_20160302
from t
group by place, id;
"
3474,SQL order by string order,"SELECT strNum FROM your_table
ORDER BY FIELD(strNum,'One','Two','Three','Four','Five','Six','Seven','Eight','Nine','Ten') ASC
"
22863,How do I convert an integer to string with a specific format in SQL,"Select CAST(sSuffixInt AS INT) as sSuffixNoLeadingZero 
"
6427,Partial copy of table and insert values at same time?,"SELECT NEWID()
"
7165,Select query from three tables SQL,"SELECT *
FROM   movie m
WHERE  NOT EXISTS (SELECT *
                   FROM   rating r
                   WHERE  r.movideid = m.moveid AND
                          r.username = 'given username here')
"
8150,Select rows where a value matches another value in another table,"SELECT a.id, a.subject, a.date, c.companyname
FROM Activity a 
INNER JOIN Company c ON a.companyid = c.companyid
INNER JOIN Companygroup cg ON c.companyid = cg.companyid
WHERE cg.groupid = 1
"
12281,Access db jet sql if else in query,"IIF([col2]<10, ""Less then 10"", IIF([col2]<=20, ""Less then20"", ""something else""))
"
10391,Relational Model vs EAV,"PostgresQL: 250 - 1600 depending on column types
MySQL: upto 4096, depending on row size
Oracle: 1000
IBM DB2: 1012
Mycrosoft SQL Server: 1024 - 30000
Sybase: 45000
"
25642,How to guarantee constraint between SQL rows?,"//java logic
try {
    //mysql logic
    start transaction;
    select * from where 'some condition' FOR UPDATE
    INSERT INTO TABLE ....    
    commit;
//java logic
catch (Exception e) {
    rollback;
}
"
35840,Drop multiple tables in one shot in mysql,"DROP TABLE IF EXISTS B,C,A;
"
26500,In Excel how to create multiple rows from a single data row,"SELECT id, desc, partNo, qty FROM parts 
UNION SELECT id, desc, partNo2 as partNo, qty2 as qty FROM parts 
UNION SELECT id, desc, partNo3 as partNo, qty3 as qty FROM parts 
ORDER BY id
"
27819,Selecting all rows in the oldest record," SELECT *
 from [order]
 WHERE OrderDate = (SELECT min(OrderDate) from [order]) 
"
31388,Select records after 5 records in a table,"WITH tmp AS  
(SELECT ROW_NUMBER() OVER (ORDER BY a.id) AS 'rn', a.* FROM table a)
SELECT * FROM tmp WHERE rn BETWEEN 5 AND 10
"
38820,MySQL: Joining different tables based on an if/case statement,"SELECT COALESCE(t2.id, t3.id) id,
       (t2.id IS NOT NULL) flag,
       COALESCE(t2.name, t3.name) name,
       COALESCE(t2.data1, t3.data1) data1
  FROM table1 t1 LEFT JOIN table2 t2
    ON t1.dec_id = t2.id LEFT JOIN table3 t3
    ON t1.rec_id = t3.id
"
7938,Oracle. Memory usage of object instances,"SELECT
    PROGRAM,
    SPID,
    ROUND(ALLOCATED / 1048576, 1) ALLOCATED,
    ROUND(USED / 1048576, 1) USED,
    ROUND(MAX_ALLOCATED / 1048576, 1) MAX_ALLOCATED
FROM
    V$PROCESS P,
    V$PROCESS_MEMORY PM
WHERE
    P.PID = PM.PID
    AND BACKGROUND IS NULL
    AND CATEGORY = 'PL/SQL'
    AND ADDR = (SELECT PADDR FROM V$SESSION WHERE SID = :SID)
"
19528,SQL gaps in dates,"WITH
  sequenced AS
(
  SELECT
    ROW_NUMBER() OVER (PARTITION BY StateID ORDER BY EfftiveDate) AS SequenceID,
    *
  FROM
    StateModel
)
SELECT
  *
FROM
  sequenced    AS a
INNER JOIN
  sequenced    AS b
    ON  a.StateID    = b.StateID
    AND a.SequenceID = b.SequenceID - 1
WHERE
  a.ExpirationDate < DATEADD(second, -1, b.EfftiveDate)
"
15358,How to group from COALESCE? SQL,"SELECT b.VehicleOwner, City
FROM (SELECT a.VehicleOwner,
      COALESCE(a.City, (Select b.City from a INNER Place b), 
              (Select b.City from a INNER   Place b)) AS City
      FROM VehicleMileage a) AS b
WHERE b.VehicleOwner IN (SELECT VehicleOwner 
                     FROM VehicleMileage 
                     GROUP BY VehicleOwner
                     HAVING COUNT(*)>1);
"
23521,Efficient Technique to Calculate Geographic Union of Many Polygons,"SELECT City,
geography::UnionAggregate(SpatialLocation) AS SpatialLocation
FROM Person.Address
WHERE PostalCode LIKE('981%')
GROUP BY City;
"
35521,SQL - table alias scope,"select t.* 
from table t 
join othertable o on t.nameid = o.nameid 
    and o.otherdesc in ('SomeDesc','SomeOtherDesc');
"
19985,Unifying Heterogeneous Tables in MySQL,"CREATE VIEW foo AS

SELECT id, type, name, [...], PRICE_PERSONAL(params) AS price
FROM products
INNER JOIN products_personal ON products.id = products_personal.pid
WHERE type = 'personal'

UNION ALL

SELECT id, type, name, [...], PRICE_INDUSTRIAL(params) AS price
FROM products
INNER JOIN products_industrial ON products.id = products_industrial.pid
WHERE type = 'industrial'
"
4436,SQL order with Union,"SELECT MainQ.* FROM 
(
  (SELECT * FROM MyTable AS T1 WHERE MyField = 1)
  UNION 
  (SELECT * FROM MyTable AS T2 WHERE MyField = 2)
) AS MainQ
ORDER BY MainQ.TableID
"
37400,Simple update statement so that all rows are assigned a different value,"UPDATE table1
SET    table2Id = (SELECT TOP 1 table2Id
                   FROM   table2
                   ORDER  BY Newid(),
                             table1.table1Id)
"
5802,how to count days between two dates with where conditions,"select 
    USERID, 
    NAME, 
    SUM(DATEDIFF(day, DATEFROM, DATETO)+1) total_leave_days
From leave 
group by USERID, NAME
"
29090,"is it possible to order by column based on values, in sqlite?","order by (case when status in (1, 2) then 1
               when status in (3, 4) then 2
               else 3
          end)
"
30090,Sql query split by a date range,"SELECT 
    student, 
    DATE_FORMAT(ApplicationDate,'%m/%Y') as Month
    count(id) as Applications
from YourTable
group by ApplicationDate
"
8224,Creating a Table in SQL,"CREATE TABLE blah AS (
SELECT T1.Q1, T1.Q2, T1.Q3, T1.ID, T1.QOL, T2.ID, T2.L1, T2.L2
FROM T1, T2
WHERE T1.ID = T2.ID);
"
352,Getting MAX of multiple AVG grouped by another column,"SELECT  PlayerID, Name, max(score)Avg, gamesCount, LeagueName, Season
FROM( SELECT  PlayerID, Player.Name as Name, Player.Gender as Gender, ROUND(AVG(score),2) as score, COUNT(score) as gamesCount, LeagueName, Season
    FROM  Scores JOIN Players as Player USING(PlayerID)
    WHERE Score > -1 AND bowlout = 'No' AND season = '2011-2012'
    GROUP BY PlayerID, LeagueName, Season
    HAVING gamesCount >= 50
    ORDER BY score /* Here is the added line that solves it all */
) as league_avg
WHERE Gender = 'Male'
GROUP BY PlayerID
ORDER BY Avg DESC LIMIT 0,50;
"
39192,"MySQL remove duplicates in one column, leaving smallest and greatest values based on second column","delete t
    from yourtable t join
         (select count, min(when) as minwhen, max(when() as maxwhen
          from yourtable
          group by count
         ) tokeep
         on t.count = tokeep.count and (t.when > tokeep.minwhen and t.when < tokeep.maxwhen);
"
28736,Storage of none default values,"(assuming only one wishlist per customer)

wishlist_items
- customer_id
- toy_id

toys
- toy_id
- description
- type (permanent / customer-defined)
"
22374,Updating a row in the same SQL table based on information from another table - MSSQL,"declare @Today datetime

select @Today = dateadd(dd, datediff(dd, 0, getdate()), 0)

update od2 set
    start_date = @Today,
    planned_end = dateadd(dd, od2.planned_duration, @Today)
from order_details as od
    inner join reference_table as rt on rt.current_step_id = od.step_id
    inner join order_details as od2 on od2.order_id = od.id and od2.step_id = rt.next_step_id
where
    od.complete_date = @Today and od2.start_date is null
"
30851,Is there any way to recover a stored procedure overwritten with an ALTER statement?,"SELECT execquery.last_execution_time AS [Date Time], execsql.text AS [Script] FROM sys.dm_exec_query_stats AS execquery
CROSS APPLY sys.dm_exec_sql_text(execquery.sql_handle) AS execsql
ORDER BY execquery.last_execution_time DESC
"
35258,SQl Server Pivot Query (simple group by?),"SELECT
    [Source],
    [True]  = SUM(CASE WHEN [Type] = 'TRUE' THEN [Count] ELSE 0 END),
    [False] = SUM(CASE WHEN [Type] = 'FALSE' THEN [Count] ELSE 0 END),
    [Sum]   = SUM([Sum])
FROM tbl
GROUP BY [Source]
"
15756,SQL replacing a field with specific text,"select 'longest time' AS status, name, longname, max(starting) from one
union
select 'shortest time' AS status, name, longname, min(starting) from one; 
"
22988,Option Recompile makes query fast - good or bad?,"EXEC sp_updatestats
"
33,SQL SELECT and SUM from three,"SELECT A.Id, A.Name, ISNULL(SUM(B.amount), 0) as bSum, ISNULL(SUM(C2.Amount), 0) as cSum
FROM A 
LEFT OUTER JOIN B ON A.Id = B.idA
LEFT OUTER JOIN (SELECT C.idB, SUM(C.AMOUNT) AS Amount FROM C GROUP BY C.idB) AS C2 ON C2.idB = B.Id
GROUP BY A.Id, A.Name
"
20869,Database table names: Plural or Singular,"SELECT idPost, Name FROM Posts
INNER JOIN Users ON Poster = idUser
"
23935,where clause is not narrowing down the records to what i have specified,"select count(*) from staff,office where office.office_id=staff.office_id and office.office_id=10;
"
326,How do I return rows with a specific value first?,"SELECT *
FROM `Users`
ORDER BY (`city` = 'New York') DESC, `city`
"
25285,SQL Server. How do i round a decimal considering all decimal digits,"SELECT CAST(CAST(795.5921967249997 AS decimal(18, 9)) as decimal(18, 8))
"
26696,Convincing the Oracle SQL optimizer that an indexed (though non-UNIQUE) column actually contains unique values in practice,"ALTER VIEW your_view_name
  ADD CONSTRAINT name_of_constraint UNIQUE( column_with_non_unique_index )
  RELY DISABLE NOVALIDATE;
"
10522,Create Ranges for a table by batchsize in SQL Server,"select (1 + (seqnum - 1) / @batchSize) as batch, min(id), max(id)
from (select t.*,
             row_number() over (order by id) as seqnum
      from t
     ) t
group by (seqnum - 1) / @batchSize
order by batch;
"
3148,is there a PRODUCT function like there is a SUM function in Oracle SQL?,"select exp(sum(ln(col)))
  from table;
"
13788,Can't think of a query structure to normalize this table,"UPDATE
  city_state cs
  INNER JOIN state s ON s.StateAbbr = cs.State
SET
  cs.StateID = s.StateID
"
7933,EntityDataSource CommandText Count Error,"Count='<%# Eval(""Count[0]"") %>'
"
31536,Copy data from one table to another AND set fixed values?,"INSERT INTO TableB (url, pageViews, ranking)
SELECT DISTINCT TOP(5) url AS url, SUM(HitCount) As pageViews, 'Top5' AS ranking
"
9469,SQL Search Help,"SELECT SKU, COUNT(*) AS Ranking
FROM tblKeyWords T1     -- or whatever the name
WHERE Keyword IN ('Lord', 'Ring')  -- here the keywords
AND KeywordType = 'T'   -- Optionally be specific on type
AND SKU IN (            -- filter to only take items that are DVDs
     SELECT SKU
     FROM tblKeywords
     WHERE KeywordType = 'X' AND Keyword = 'DVD'
     )
GROUP BY SKU
ORDER BY COUNT(*) DESC
"
23956,How to resolve this kind of query?,"SELECT subscriptions.id_user, packages.name, MAX(subscriptions.date), packages.expiry
FROM subscriptions JOIN packages ON subscriptions.id_package = packages.id
WHERE packages.visible = 1
GROUP BY subscriptions.id_user, subscriptions.id_package
ORDER BY packages.category
"
2082,How to select using criteria? SQL syntax,"Select Table1.*
from Table1
where (X = 0 or Width = X) and
      (Y = 0 or Height = Y) and
      (Z = 0 or Length = Z)
"
10711,How to map cursor data into another cursor? Android,"""select "" + 
ContactsContract.Profile.DISPLAY_NAME_PRIMARY + "" as "" + SearchManager.SUGGEST_COLUMN_TEXT_1 "", "" +
ContactsContract.Profile._ID + "" as "" + SearchManager.SUGGEST_COLUMN_TEXT_2 + "",""
.
.
.
"
15210,Cross apply to get a specific record based on DateTime,"select ca.Location, B.id, ca.Datetime
from 
    Base B
    cross apply
    (
        select top (1) E.Location, E.DateTime
        from Extract E 
        where 
            B.id = E.id
            AND B.DateTime >= E.DateTime
        order by E.Datetime DESC
    ) AS CA
"
7981,"MYSQL, Take value from 'reported users' table and use name to delete from another table","DELETE FROM male_users WHERE name IN(
SELECT name FROM users WHERE <logic> AND gender='male'
);
DELETE FROM female_users WHERE name IN(
SELECT name FROM users WHERE <logic> AND gender='female'
);
"
35313,How to check if selected date range is between another date range,"SELECT 
    *
FROM
    lifecycles
WHERE
    str_to_date(life_start_date, '%m/%d/%Y') <= '2014-01-01' 
    AND str_to_date(life_end_date, '%m/%d/%Y') >= '2013-08-01';
"
885,Find non-integer values in a float field,"select field
from table
where field like '%.%'
"
1515,Chracter codes in sql 'like' queries?,"SELECT * 
    FROM users
    WHERE CHARINDEX(CHAR(6), CompanyName) <> 0
"
698,Subtracting previous row minus current row in SQL," select a.Incoming, 
coalesce(a.Incoming - 
    (select b.Incoming from orders b where b.id = a.id + 1), a.Incoming) as differance
from orders a
"
490,How to properly use extended constraints on a LEFT JOIN so as to return all results on the left side,"SELECT b.Category AS Category, b.amount,
       SUM(e.Amount) AS Spent,
       (b.Amount - SUM(e.Amount)) AS Remaining
FROM Budget b LEFT JOIN
     Expenditure e 
    ON b.Category = e.BudgetCategory AND
       e.Date < '2016-01-01' AND
       e.Date >= '2015-01-01'
       b.Year = 2015
GROUP BY b.Category, b.amount;
"
33538,Merge 2 tables into a query on unequal column,"SELECT ID, TIMESTAMP, COLXYZ, COLZZZ, NULL AS COLABC, NULL AS COLDEF, NULL AS COLGHI
FROM TABLEA
UNION ALL
SELECT ID, TIMESTAMP, NULL, NULL, COLABC, COLDEF, COLGHI
FROM TABLEB
ORDER BY TIMESTAMP;
"
23324,Multiple max values in a query,"select id, bdate, value 
from myview 
where (id, bdate) in
    (select id, max(bdate)
     from myview group by id)
/
"
37209,"Limit number of root entities in Doctrine query, but allowing any number of joined entities","SELECT A.id
FROM Article A
LIMIT 10

SELECT A, C
FROM Article A
LEFT JOIN A.comments C
WHERE A.id IN (4, 8, 15, 16, 23, 42, ...)
"
23132,SQL PK Lookup with Extra Column,"UPDATE Subscriber SET Name = 'John' WHERE Id = 20 and OwnerId = 50;
"
31108,SQL Server : how to run a stored procedure at the end of each calendar month,"DECLARE @ReportStartDate date, @ReportEndDate date

-- for sqlserver 2012
SELECT 
  @ReportStartDate = EOmonth(getdate(), -1),
  @ReportEndDate = EOmonth(getdate())

-- for earlier versions
SELECT 
  @ReportStartDate = dateadd(month, datediff(m, 0, getdate()), -1),
  @ReportEndDate =  dateadd(month, datediff(m, -1, getdate()), -1)

EXEC my_report @ReportStartDate, @ReportEndDate
"
13382,SQL Server Selecting Records with most recent date time,"select t.* 
from
(
    select t.MyKey, t.MyDateTime
    , row_number() over 
         (partition by t.mykey order by t.MyDateTime desc) as keyOrderNbr
    from table t
) A
inner join table t
    on A.MyKey = t.MyKey 
    and A.MyDateTime = t.MyDateTime
where A.keyOrderNbr = 1
"
16680,How to select a related group of items in Oracle SQL,"SELECT DISTINCT key, id, link
  FROM the_table
  START WITH id = 'AA'
  CONNECT BY id = 'MASTER' and link = PRIOR link and 'AA' = PRIOR ID
"
31363,Sql Count on many to many,"       SELECT f.feature, count(f.feature)
       FROM  post_feature l 
       JOIN  features f ON l.featureid = f.id 
       JOIN  post p ON l.post_id =p.id 
       WHERE p.date > 'some_date'
       GROUP BY f.feature
"
2569,Combine SQL with XQuery and Linq To SQL,"var results = from r in MyXmlFieldTable
   let date = context.XQueryDateTime( r.XmlValues, ""MyContainer/MyDateTime"" )
   where date < DateTime.Now.AddDays( -5 )
   select new
   {
       Date = date,
       FirstName = context.XQueryString( r.XmlValues, ""MyContainer/FirstName"" ),
       LastName = context.XQueryString( r.XmlValues, ""MyContainer/LastName"" )
   };
"
16729,SQL statement to find Min Date,"SELECT MIN(entered), generalist, item
FROM dataTable
WHERE item = @itemParm
AND entered BETWEEN @enteredStart AND @enteredEnd
GROUP BY generalist, item
"
38121,SQL Server 2005 ROW_NUMBER() without ORDER BY,"INSERT dbo.TargetTable (ID, FIELD)
SELECT
   Row_Number() OVER (ORDER BY (SELECT 1))
      + Coalesce(
         (SELECT Max(ID) FROM dbo.TargetTable WITH (TABLOCKX, HOLDLOCK)),
         0
      ),
   FieldValue
FROM dbo.SourceTable
WHERE {somecondition};
"
480,"Oracle SQL help: after using group by, count types","select
  personid,
  count(case when type = 5 then 1 end) type5cnt,
  count(case when type = 12 then 12 end) type12cnt,
  count(case when type = 71 then 71 end) type71cnt
from table_name
group by personid
"
38278,Turning a select statement with group and having clause into a delete?,"delete from MyTable
where exists (
    select 1 from MyTable t2
    where MyTable.account_number=t2.account_number and MyTable.acc_cd=t2.acc_cd and MyTable.seq=t2.seq
)
"
39371,MYSQL Get Difference between two values,"SELECT A.MaxtotalPoints - A.totalPoints AS GAP
FROM
(
SELECT userName, totalPoints , MAX(totalPoints) MaxtotalPoints
FROM userTable
WHERE value='1'  
) A
ORDER BY GAP;
"
18228,Oracle REGEXP_REPLACE replacing ; delimited strings with quoted strings,"select q'{'}' ||
       replace( '123;234;345;123', ';', q'{','}' ) ||
       q'{'}'
  from dual
"
10801,select all rows which satisfy constraints from another table,"SELECT a.*
  FROM actions a
 WHERE NOT EXISTS
       (
   SELECT 1
     FROM has_constraints hc
    WHERE hc.action_id = a.id
      AND NOT EXISTS
          (    
      SELECT 1 
        FROM assure_constraints ac
       WHERE ac.state_id = $my_state_id
         AND ac.constraint_id = hc.constraint_id))
"
7784,Name Change SQL Query - Positive Attrition,"select eprev.*
from Employee e
     Employee eprev
     on e.EmployeeId = eprev.EmployeeId and
        cast(cast(e.EffectiveBeginDateKey as varchar(255)) as datetime) =
            cast(cast(eprev.EffectiveEndDateKey as varchar(255)) as datetime) + 1
where cast(cast(e.EffectiveBeginDateKey as varchar(255)) as datetime) >= dateadd(mm, -1, getdate()) and
      eprev.JobTitle <> e.JobTitle;
"
30437,mysql query help (select latest updates based on timestamp),"SELECT d.userid, 
       d.userinfo, 
       d.updated, 
       u.username 
  FROM datatable d
  JOIN usertable u ON u.userid = d.userid
  JOIN (SELECT t.userid,
               MAX(t.updated) AS max_updated
          FROM DATATABLE t
      GROUP BY t.userid) x ON x.userid = d.userid
                          AND x.max_updated = d.updated
"
26161,SQL Latest Date,"SELECT  CustomerID, MAX(Date)
FROM    Purchase
GROUP BY CustomerID, YEAR(Date), MONTH(Date)
"
29798,View Records in ascending order in Oracle Forms,"set_block_property('LAND_MANAGEMENT', order_by, 'SL_NO asc');
"
39406,Selecting the ID of GROUP BY based on other table value,"SELECT id, nome
FROM produtos p
WHERE id IN (
  SELECT COALESCE(MAX(rp.idproduto), MAX(p.id))
  FROM produtos p
  LEFT JOIN representantes_precos rp ON p.id = rp.idproduto
  GROUP BY p.nome)
"
19677,How to insert from one table into another with extra values in SQL?,"INSERT INTO Table2 ([Id], [Item Description], [Item Cost], [Order Date])
    SELECT NEWID(), Description, Cost, '2014-12-13'
    FROM  Table1
    WHERE Id = '1';
"
6911,Setting a NULL date,"Public Sub SetInactiveFlags(custIds As IEnumerable(Of Integer), inactiveDate As DateTime?, inactiveFlag As Boolean)
...
customer.Inactive_Date = inactiveDate
...
"
33506,Should I always index all entries of a join table?,"CREATE TABLE FooBar
(
FooId int NOT NULL REFERENCES Foo(FooId),
BarId int NOT NULL REFERENCES Bar(BarId),
PRIMARY KEY (FooId, BarId ),
UNIQUE (BarId, FooId )
)
"
12696,SQL query for the given select operation,"    Select * from 
    (select row_number() over (partition by ID order by Expense desc, date asc)
    RN,  id, expense, date, item
    from T)T
    where RN=1
"
32089,Select all from table where the rows has the highest id of all those with the same foreign keys,"SELECT * FROM Posts WHERE id IN (SELECT MAX(id) FROM Posts WHERE published = 1 GROUP BY author_id); 
"
26247,Lost one row in SQL statement,"SELECT S._id ,
       S.Name 
FROM Subject S 
INNER JOIN Occupied O ON O.idSubject = S.id
WHERE O.idClass='1';
"
24010,is SELECT COUNT(*) expensive?,"
mysql> SELECT COUNT(*) FROM student;
"
5497,Select count of specific values,"SELECT NAME FROM TABLE WHERE ELEMENT IN (SELECT ELEMENT                  
FROM TABLE WHERE ELEMENT IN('C', 'O') GROUP BY ELEMENT                  
HAVING COUNT(ELEMENT) > 2) 
"
8241,SELECT COUNT within date range,"SELECT EmailAddress,
       Sum(CASE WHEN ActionTaken = 'Deleted' THEN 1 ELSE 0 END) AS Deleted,
       Sum(CASE WHEN ActionTaken = 'Replied' THEN 1 ELSE 0 END) AS Replied,
       Sum(CASE WHEN ActionTaken = 'Read' THEN 1 ELSE 0 END)    AS [Read],
       Count(EmailAddress) AS Total
FROM   mails
WHERE  ReceivedTime >= Dateadd(DAY, -7, Getdate())
GROUP  BY EmailAddress
HAVING Count(EmailAddress) > 10 
"
39431,MySql - get days remaining,"SELECT *
FROM tblPremiumListings
WHERE created_date + INTERVAL `days` DAY >= CURDATE()
"
2600,Deleting partly duplicate rows in a table,";WITH x AS (
    SELECT rowid,
           rownumber() OVER (PARTITION BY user_id,productid ORDER BY times) AS rn
    FROM   tbl
    )
DELETE FROM x
WHERE  rn > 1;
"
10486,How to replace function with a view in sql?,"SELECT WarrantID, Remarks
FROM
(
    SELECT 
        RowNumber = ROW_NUMBER() OVER (PARTITION BY t.WarrantID ORDER BY t.NoteDate DESC),
        t.Remarks,
        t.WarrantID
    FROM
        Warrant_notes t
    WHERE NotesCat <> 0
) i
WHERE i.RowNumber = 1;
"
35056,Groupby where all children match a condition,"select parent_id, count(1) 
from MYTABLE
where parent_id != 0
group by parent_id
HAVING sum(case when status NOT IN ('A','B') then 1 else 0 end) = 0
"
3382,SQL Contains query,"SELECT *
FROM A 
WHERE NOT EXISTS( SELECT * 
                  FROM  B 
                  WHERE ' '+B.ExecID+' ' LIKE '% '+A.ExecID+' %')
"
24030,How do I import an Excel spreadsheet into SQL Server 2008R2 database?,"SELECT * INTO XLImport4 FROM OPENROWSET('Microsoft.Jet.OLEDB.4.0',
'Excel 8.0;Database=C:\test\xltest.xls', [Customers$])
"
30042,How can i make an insert of a SCOPE_IDENTITY() into update in SQL SERVER,"CREATE TRIGGER [dbo].[YourTriggerName]
   ON  [dbo].[Table2]
   AFTER  INSERT 
AS 
BEGIN
      UPDATE t1
      SET NAME= t2.IdColName
      FROM Table1 t1
         INNER JOIN  Inserted t2 ON ......

END
"
33781,Selecting a column with reference to MAX(addDate) from date column,"SELECT 
  ai_account.amount as amountPaid, 
  ai_account.addDate as lastPaymentDate 
FROM ai_account 
WHERE ai_account.id = (
    SELECT 
    id
    FROM ai_account 
    WHERE ai_account.trader_id = :traderId
    ORDER BY ai_account.addDate DESC
    LIMIT 1
    )
"
14572,MySQL return array of results ordered by another subquery count,"select 
   d.ID, 
   max(Name) as Name
from tagdefinitions d
join tags t on d.ID = t.tagid
group by d.ID
order by count(t.ID) desc, d.ID
"
19568,Finding First Occurrence Based on Multiple Criteria,"select t.*
from table t
where t.sale_date = (select min(t2.sale_date)
                     from table t2
                     where t2.id = t.id and t2.sale_cnt > 0
                    );
"
19017,join two tables on 2 conditions,"SELECT DISTINCT c.ID, c.Modif, c.Value
FROM Table1 c
JOIN Table2 o on o.ID = c.ID 
WHERE c.Modif NOT IN
(
  Select o.Modif FROM Table2 o
)
"
1394,What is a clean and quick way to use comparison operators on an MySQL field with a delimiter?,"set @field='70:30';
select substr(@field,1,LOCATE(':',@field)-1) as baselvl,
substr(@field,LOCATE(':',@field)+1,length(@field)-LOCATE(':',@field)) as oblvl
"
32101,Remove all characters at the beginning of string up to certain character in Oracle,"select substr(address, instr(address, '_') + 1, length(address)) as ""CityState""
from address
"
20673,How to split a really long mysql result set into two lines?,"SELECT substring(col, 1, 50) FROM foo
UNION ALL
SELECT substring(col, 51) FROM foo
"
24521,Change default dateformat stored in a database,"select stuff(convert(char(7), getdate(), 120), 5, 0, '-' + convert(char(2), getdate(), 3))
"
10464,Does it matter for DB efficiency what number is SQL Server's index column?,"Single column index -it does not matter 

Multi-column index - order of the column does matter in the index,
                     but not in the table
"
15089,Creating a check constraint for multiple specific inputs,"ServiceType in ('Training', 'Data_Recovery', 'Consultation', 'Software  Installation', 'Software Repair')
"
8026,search in sql with 2 input parameter,"CREATE PROC dbo.Answers
@Username nvarchar(20),
@Name nvarchar(20)
AS

declare  @Name2 nvarchar(20)
set @Name2 = ISNULL(@Name, '00')

SELECT *  
FROM dbo.tbl_answer
WHERE an_del = 1 AND ( u_username LIKE ISNULL('%' + @Username + '%', u_username)
  AND  
ISNULL(u_name,'00') LIKE  '%' + @Name2 + '%' )
"
12655,How to sum sales by months and compare them,"  SELECT DATEPART(Year, DATELASTFULFILLMENT) AS [Year], 
         DATEPART(Month, DATELASTFULFILLMENT) AS [Month], 
         SUM(TOTALPRICE) AS Total
    FROM SOITEM
GROUP BY DATEPART(Year, DATELASTFULFILLMENT), DATEPART(Month, DATELASTFULFILLMENT)
ORDER BY [Year], [Month]
"
29036,Checking the DB_LINK Connection,"select * from dual@LINK_NAME
"
15367,How do I script SQL constraint for a number to fall within a range?,"ALTER TABLE Table
ADD CONSTRAINT CK_Table_Column_Range CHECK (
   Column >= 0 AND Column <= 100 --Inclusive
)
"
27100,Trying to Get the Earliest Date using MIN(),"SELECT TOP 1 ID, AppID, Description, Min([Transaction Date]) AS TransactionDate
FROM AppProsHist
WHERE [Description]='Non-Final Rejection'
GROUP BY ID, AppID, Description
ORDER BY TransactionDate DESC, ID
"
30056,SQL Division using 'not exists' in mysql,"select distinct b.profname from committee b
where not exists (
    select commname from committee a
    where a.profname = 'piper' and not exists  (
        select commname from committee c
        where c.profname=b.profname and c.commname=a.commname
    )
);
"
28945,Grouping different 'names' into one,"select location, sum(qty) as total
from (select case when Location in ('Location A','Location B') then Location
             else 'Container' end as location,
             qty from tablename)
group by location
"
12488,Oracle combine two rows into one,"select some_date
,      some_id
,      some_name
,      some_number
,      max(paid) paid
,      max(amount) amount
,      max(etc) etc
from   some_table
group by some_date
,      some_id
,      some_name
,      some_number
"
35288,Postgresql : Loop thorugh each table and check for column?,"DO
$$
DECLARE
    rec record;
BEGIN
    FOR rec IN 
        SELECT table_schema, table_name, column_name
        FROM information_schema.columns 
        WHERE column_name = 'x'
    LOOP
        EXECUTE format('ALTER TABLE %I.%I RENAME COLUMN %I TO newname;',
            rec.table_schema, rec.table_name, rec.column_name);
    END LOOP;
END;
$$
LANGUAGE plpgsql;
"
6694,i want to merge two select statements,"SELECT KeywordId,currentposition,PsnUpdateDate,PsnUpdateBy
FROM seo.Tbl_KeywordPosition
WHERE psnupdatedate = '2015-01-22'
UNION
SELECT KeywordId,currentposition,PsnUpdateDate,PsnUpdateBy
FROM seo.Tbl_KeywordPosition
WHERE psnupdatedate ='2015-01-23';
"
28129,How to check if next value is close to previous value in sql,"SELECT ID, NUM, FK_POS, TRANS_DATE,
       NextRowHasSameValues = CASE 
          WHEN t2.ID IS NOT NULL
           AND t1.NUM = t2.NUM
           AND t1.FK_POS = t2.FK_POS 
           AND t1.TRANS_DATE = t2.TRANS_DATE 
          THEN 'Yes' ELSE 'No' END
FROM dbo.TableName t1
LEFT OUTER JOIN dbo.TablName t2
    ON t1.ID = t2.ID - 1
"
7600,How to write a Trigger based on row update,"create trigger your_trigger
on InvoiceHead
after update
as
//declare @status int;
//select @status=i.status from inserted i;  
//IF @status == 1 
//BEGIN

update d
set d.status = b.status
from InvoiceDetails as d
join inserted as b 
on a.InvoiceDetails_id = b.InvoiceHead_id
where b.status == 1; 

update m
set m.status = b.status
from InventoryMaster  as m
join inserted as b 
on m.InventoryMaster_Processid = b.InvoiceHead_id
where b.status == 1;


end
go  
"
1964,Doubling up on WHERE condition,"SELECT NAME FROM TABLE WHERE 
((@AGE='man'
   AND (AGE = 'man' or AGE = 'boy'))
OR
(@AGE <> 'man'
  AND (AGE = 'man')))
AND City IS NULL
"
18922,How to not add values from Join,"   SELECT rgn.*
     FROM Rep_GroupNode rgn
LEFT JOIN MappingTable mt ON mt.rgn_id = rgn.id
      AND mt.rgn_type = 'type1'
"
28190,Sort public trigram data in BigQuery,"SELECT ngram, FIRST(first), FIRST(second), FIRST(third), SUM(cell.match_count)
FROM [publicdata:samples.trigrams]
WHERE cell.value in (""2000"",""2001"",""2002"",""2003"",""2004"",""2005"",""2006"",""2007"",""2008"")
GROUP EACH BY ngram;
"
12203,Assigning result columns set to variables,"Declare @valCol1 INT, @valCol2 INT

    SELECT @valCol1 = MAX(col1), @valCol2 = b.[col2] from tablea ta JOIN tableb tb on ta.id = tb.id
    WHERE ta.id = @currentId

PRINT @valCol1
PRINT @valCol2
"
6923,Find string similarities between two dimensions in SQL,"SELECT 
    SEARCH_LOG.QUERY
FROM 
    SEARCH_LOG
WHERE 
    EXISTS
    (
        SELECT 
            NULL 
        FROM 
            SELECTION_TABLE
        WHERE
            UTL_MATCH.JARO_WINKLER_SIMILARITY(SEARCH_LOG.QUERY, SELECTION_TABLE.NAVN) >= 98
    );
"
13225,intervals with equal density sql,"SELECT  MIN(number_of_trades)::text || '-' || MAX(number_of_trades)::text AS ""number of trades"" 
, COUNT(number_of_trades) AS ""number of traders""
, AVG(number_of_trades*profit) AS AvgProfit 
FROM 
(
   SELECT ROW_NUMBER() OVER(ORDER BY number_of_trades) AS rn
     , number_of_trades
     , profit 
     , (COUNT(*) OVER(PARTITION BY NULL) / 100) AS Grp
   FROM TradersStat
  ) tab
GROUP BY (rn - 1) / Grp
"
9746,How to bin arbitrarily in MySQL?,"SELECT CASE WHEN age BETWEEN 13 AND 17 THEN '13-17' 
            WHEN age BETWEEN 18 AND 25 THEN '18-25' 
            ELSE '26+' END AS AgeGroup,
    COUNT(*) AS total
FROM MyTable
GROUP BY AgeGroup
"
21755,Generate string processing for on rows from some table,"DECLARE @SQLString NVARCHAR(MAX)
SELECT 
  @SQLString = COALESCE(@SQLString + ', ', '') + ColName + ' ' + ColType + ' ' + ColNullable
from 
  YourTable
select @SQLString

EXEC ('CREATE TABLE YourTableName (' + @SQLString + ')')
"
20598,Oracle Apex Custom Function,"create or replace function custom_authentication (p_username in varchar2, p_password in varchar2)
return boolean
IS
begin
Your code for authentication
return true
end
"
24653,Find all Database Objects by Name?,"SELECT *
FROM database.sys.all_objects
WHERE upper(name) like upper('my prefix%')  --use UPPER for case-INsensitivity
"
12924,sql search results by month in format 2010-04-01 10:40:20,"SELECT * FROM
table
WHERE MONTH(date) = 4 AND YEAR(date) = 2010
"
21326,SQL - How to get a range of timestamps using BETWEEN (mysql)?,"WHERE m.timestamp BETWEEN c.timestamp - interval 10 second AND
                          c.timestamp + interval 10 second
"
32698,reluctant quantifier using oracle regexp,"regexp_replace('''val1'',''val2''','(''.*?'')','upper(\1)')
"
2429,SQL select for average from another table,"SELECT C.id_car, name, AVG(rating_value) AS average
FROM car C JOIN rating R 
      ON C.id_car = R.id_car
GROUP By C.id_car, name
ORDER BY average DESC
"
31993,"SQL, how to pick portion of list of items via SELECT, WHERE clauses?","$query = ""select places.title, places.summary, places.description, places.year, places.date from places where places.eventid = $eventId order by places.date limit $numberOfItems offset $firstItem""; 
"
19271,DOS command to execute all SQL script in a directory and subdirectories,"for /r %f in (*.sql) do echo %f
"
8910,Oracle - JOIN two complex Views - optimizer faults,"SELECT /*+ NO_REWRITE */ rest_of_your_query_goes_here
"
14744,finding count using aggregate function sql,"select id, count(*) as cnt
from (select t.*, avg(salary) over (partition by id) as avgs
      from table t
     ) t
where salary < avgs
group by id;
"
10091,How to use a NOT in a join?,"SELECT DISTINCT releases.* 
FROM releases
INNER JOIN artist_love ON  releases.all_artists LIKE CONCAT('%',artist_love.artist,'%')
AND artist_love.user =  'Quickinho'
INNER JOIN label_love ON label_love.label = releases.label_no_country
AND label_love.user =  'Quickinho'
left join charts_extended on charts_extended.release_id=label_love=releases.id and charts_extended.artist =  'Quickinho'
where charts_extended.release_id is null
ORDER BY releases.date DESC 
LIMIT 0 , 102
"
25167,"Database joins with three tables, one is a category / tag table","select distinct u.name
from unit u 
join unitcategory uc on u.id = uc.unitid
join unitcategoryuser ucu on uc.category_id = ucu.categoryid
where ucu.userid = YourUserID
union
select distinct u2.name
from unit u2
join unitcategoryuser ucu2 on u2.id = ucu2.unitid
where ucu2.userid = YourUserID
"
23263,"Table has unique rows, however how can I find duplicates of certain columns?","select a.*
from yourTable as a
inner join (
    select id, sequence 
    from yourTable 
    group by id, sequence 
    having count(id)>1) as b on a.id = b.id and a.sequence=b.sequence
"
25637,"Extracting value from a group, basing on a condition on another column",";WITH CTE AS
(
    SELECT  *, 
            ROW_NUMBER() OVER(PARTITION BY CategoryId ORDER BY ItemValue DESC) MaxRN,
            ROW_NUMBER() OVER(PARTITION BY CategoryId ORDER BY ItemValue) MinRN
    FROM Items
)
SELECT  CategoryId, 
        MIN(CASE WHEN MaxRN = 1 THEN ItemId END) IdMaxValue,
        MIN(CASE WHEN MinRN = 1 THEN ItemId END) IdMinValue
FROM CTE
GROUP BY CategoryId;
"
8055,Fast Relational method of storing tree data (for instance threaded comments on articles),"1
1.1
1.1.1
1.2
1.2.1
"
34692,Search in joined table with multiple records,"SELECT 
    DISTINCT C.*
FROM 
    contacts C LEFT JOIN contacts_related R
    ON C.id=R.contact_id
WHERE
    C.name LIKE '%John%' OR 
    R.name LIKE '%John%'
"
27155,How can I use the 'NVL' function on a result table?,"select
    nvl(
        (select (aa + bb) from table_x where cc = 'on' and id = t2.id)
    , 0) + t2.b as sum
from
    table_y t2
"
8967,COUNT with DISTINCT,"SELECT  shippingid,
        COUNT(*) Items,
        ShipDate 
FROM mytable
WHERE customerID = 'C1'
GROUP BY shippingid,
         ShipDate 
"
25608,How to format the explain plan output in sqlplus,"set linesize value_size
"
19100,How to generate permutations?,"SELECT A.*, B.*, C.*
FROM A
CROSS JOIN B
CROSS JOIN C
"
296,Outer join in Oracle without using SQL 99 syntax,"SELECT D.COMPANY_ID, C.COMPANY_ID, D.DOCUMENT_ID, D.DOCUMENT_CODE
  FROM DOCUMENTS D, 
       COMPANIES C
 WHERE D.COMPANY_ID(+) = C.COMPANY_ID
"
18548,Oracle - Comparing two columns with <>,"WHERE End_dt <> NVL(End_dt2, date '9999-12-31')
"
17464,"How do I convert a number to a numeric, comma-separated formatted string?","SELECT Format(1234567.8, '##,##0') 
"
37717,Left Join based on field value,"SELECT p.type, t.id, t.title, t.description
FROM tbl_purchase p
JOIN tbl_track t ON t.id = p.item_id AND p.type = 0
UNION
SELECT p.type, a.id, a.title, a.description
FROM tbl_purchase p
JOIN tbl_album a ON a.id = p.item_id AND p.type = 1
"
8234,How can a query select dates from only a specific academic year?,"select
   *
from
   dts
where
   case
     when extract (month from dt) < 9 then extract (year from dt) - 1
       else extract (year from dt)
         end = extract (year from sysdate)
"
8272,"SQL join, select and where","SELECT f.Title, f.Rental_fee
FROM Film f
INNER JOIN Filmtype t ON f.Type_Id = t.Type_Id
WHERE f.Certificate=12 AND t.Type_Name='Drama'
"
9397,How to update a column when the same column in another table is changed ?(postgresql),"CREATE VIEW balance_amount AS
    SELECT la.creditid, la.credit_type, amount 
              - COALESCE(SUM(pay),0) balance
    FROM loan_amount la
    LEFT JOIN pay_the_loan pl
      ON la.creditid = pl.creditid 
     AND la.credit_type = pl.credit_type
     AND pl.status = 'OK'
    GROUP BY la.creditid, la.credit_type, la.amount;
"
34309,MySQL: Insert one row for each key in foreign table for each distinct value in table,"INSERT IGNORE INTO `table1`
SELECT DISTINCT `table2`.`col1`, `table1`.`col2`
FROM `table1`
JOIN `table2`
"
4252,Execute stored procedure in mvc through EnterpriseLibrary,"public IEnumerable<UserViewModel> GetUserList()
{
    DatabaseProviderFactory factory = new DatabaseProviderFactory();
    Database db = factory.Create(""MySqlConnection"");
    IEnumerable<UserViewModel> results = db.ExecuteSprocAccessor<UserViewModel>(""uspGetUserList"");

    return results;
}
"
33265,SQL many to many subquery,"SELECT 
  locations.""name"", 
  contacts.name, 
  array_agg(roles.""name"") AS ""Roles""
FROM locations INNER JOIN contacts ON locations.""id"" = contacts.location_id
   INNER JOIN ""public"".memberships ON ""public"".memberships.contact_id = contacts.""id""
   INNER JOIN roles ON ""public"".memberships.role_id = roles.""id""
 group by locations.""name"", contacts.name
"
11219,SQL merging 2 tables,"select t1.ids, t1.type, t2.d1, t2.d2, t2.d3
from (select t1.*, row_number() over (order by ids) as seqnum
      from t1
     ) t1 full outer join
     (select t2.*, row_number() over (order by d1) as seqnum
      from t2
     ) t2
     on t1.seqnum = t2.seqnum
"
25560,Join Query Results,"SELECT
  Coalesce(I.PartNo,O.PartNo) AS PartNo,
  IsNull(I.Qty,0) AS [In],
  IsNull(O.Qty,0) AS [Out],
  IsNull(I.Qty,0) - IsNull(O.Qty,0) AS [Total]
FROM
  (SELECT PartNo, Sum(Qty) AS Qty FROM InTable WHERE Date = '1/1/2013' GROUP BY PartNo) I
  FULL JOIN
  (SELECT PartNo, Sum(Qty) AS Qty FROM OutTable WHERE Date = '1/1/2013' GROUP BY PartNo) O ON I.PartNo = O.PartNo;
"
32913,Query also returns column with value 0,"SELECT 
    q.id_quest,
    q.desc_quest,
    COUNT(a.id_quest) as total_answer
FROM tb_question q
LEFT OUTER JOIN tb_answer a ON q.id_quest = a.id_quest
GROUP BY q.id_quest
"
22229,how to create UISelectItems from a Database,"parent.getChildren().add(selectItems);
"
24025,Update table in specific rows based on conditions for multiple previous rows,"UPDATE test SET indicator = 0 
WHERE (day, company) IN (
SELECT day, company
    FROM (
        SELECT company, day, 
        COUNT(CASE WHEN indicator <> 0 THEN 1 END) 
            OVER (PARTITION BY company ORDER BY day 
                ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) As cnt
        FROM test
        ) alias
    WHERE cnt >= 2)
"
7354,Specified DB name with previous year,"DECLARE @CURRENTYEAR  AS INT = year(getdate())
DECLARE @PREVIOUSYEAR AS INT = @CURRENTYEAR - 1

DECLARE @QUERY_ VARCHAR(2000)
SET @QUERY_ = 
'SELECT
     COL_1
    ,COL_2
    ...
FROM DB' + @CURRENTYEAR + '.DBO.TABLENAME

UNION ALL

SELECT
     COL_1
    ,COL_2
    ...
FROM DB' + @PREVIOUSYEAR + '2015.DBO.TABLENAME'

EXEC(@QUERY_)
"
12817,Can I execute a COUNT() before GROUP BY,"SELECT email_address, COUNT(distinct o.order_id) AS num_of_orders
"
27223,MySQL trigger to insert date to row with unique matching ID,"UPDATE `_JobTable` 
   SET `JobClosedDate` = ClosedDate 
 WHERE `JobID` = NEW.JobID;
"
29704,SQL check time difference hours between record and dateTime now,"DATEDIFF(SECOND, [dateTime], @Now) > (2 * 60 * 60)
"
31783,Is there a way to conditionally use default column values in an INSERT..SELECT statement?,"INSERT (columnA,B,C) ... ;

IF @prmSomeValue IS NOT NULL
    UPDATE ... ;
"
35648,update in mysql need good statement,"UPDATE reports_attributes 
 Set 
 ConID='78',
 CheckServices='Execute Summary',
 Attribute1='criminality',
 Attribute2='color1',
 Attribute3='education',
 Attribute4='color5',
 Attribute5='employment_check_2',
 Attribute6='color7',
 Attribute7='report_status',
 Attribute8='color9'
WHERE ConID=78 AND ReportType='interim_report'  
"
31597,SQL: How to find if there is at least one record matching a condition,"SELECT TOP 1 1 AS found
FROM tablename
WHERE ...
"
21753,"How to control number of returned rows in an SQL query, without knowing how many rows we need","SELECT C.CommentId, P.PostId FROM Post AS P
LEFT JOIN Comment AS C ON P.PostId = C.PostId
**where p.postID in (select top 2 postID from post order by postID)**
ORDER BY P.PostId ASC
"
33449,Oracle 10g Table size after deletion of multiple rows,"alter table t1 shrink space;
"
10264,Pairing Unique Columns MySQL?,"ALTER TABLE tableName ADD CONSTRAINT tb_UQ UNIQUE (follow, following)
"
13035,"is it possible create a sql view from ""horizontal"" to ""vertical""","SELECT period, value, category
FROM 
   (SELECT VendorID, charcge,nocharge
   FROM Table) p
UNPIVOT
   (value FOR category IN 
      (charge,nocharge)
)AS unpvt;
"
39988,How to set up this scope with association in Rails?,"scope :live, lambda {
    non_live_sql = joins(:topic => {:articles => :post})
      .where(""topics.article_count > ? AND posts.live = ?"", 0, false)
      .select('expert_topics.id').to_sql
    joins(:topic).where(""topics.article_count > ? AND expert_topics.id NOT IN (#{non_live_sql})"", 0)
}
"
18862,Query Join Condition,"SELECT  a.id
FROM    account a
LEFT JOIN
        assignedgroup b
ON      b.assignedgorup LIKE a.sourceaccount + '-%'
"
8071,Rebuilding Indexes with Scripts,"EXEC msdb..sp_start_job N'NAME OF JOB'
"
5743,How to get rid of null values in pivoted table?,"SELECT Date,
       MAX(RS1),
       MAX(RS2),
       MAX(RS3)
FROM Table1
GROUP BY Date
"
31725,SQL query: self-referencing foreign key relationship,"WITH SparePartCategories(CategoryId) AS
(
    SELECT c.idSparePartCategory
    FROM tabSparePartCategory c
    WHERE c.idSparePartCategory = 1

    UNION ALL

    SELECT c.idSparePartCategory
    FROM tabSparePartCategory c
    JOIN SparePartCategories parent ON c.fiSparePartCategory = parent.CategoryId
)
SELECT sp.SparePartName
FROM tabSparePart sp
JOIN SparePartCategories spc ON sp.fiSparePartCategory = spc.CategoryId
"
4286,What is the behavior of an application when upgdraded at appstore,"if it differ then 
    update schema, 
and if its same 
    no need to make any changes.
"
18487,"How can I find tables, having a defined column?","select 
    *
from 
  syscat.columns
where
 colname = 'person_name'
"
27502,union two tables and order by a common field like name which is present in both the tables,"select slug, name, 1 as mt 
  from tablea 
union 
select slug, name, 0 as mt 
  from tableb 
 order 
    by name;
"
39245,How to replace characters before a number in sql,"SELECT REPLACE(Name, SUBSTR(Name, 1, REGEXP_INSTR( Name, '[0-9]', 1)-1), 'Port ')
 FROM PORT
"
31772,How to prioritize in OR condition in SQL Server,"select top 10 *
from tblRFCWorkload
order by (case when f1 = 'mbb' then 1 else 2 end);
"
25398,SQLite: Get all dates between dates,"SELECT date_entry 
FROM vacation 
JOIN all_dates ON date_entry BETWEEN from_date AND to_date
GROUP BY date_entry
ORDER BY date_entry
"
32051,Return Auto Increment value after inserting a record on a table,"DECLARE @NewID int

INSERT INTO User ([UserFirstName], [UserSurname], [UserDob]) Values ('Bob', 'Smith', '1979-01-01')

Select @NewID = SCOPE_IDENTITY()


INSERT INTO OtherTable ([UserId]) Values (@NewID)
"
23446,Neo4j Cypher order by,"START
  n = node(*)
RETURN
  n
ORDER BY
  CASE n.activeTo WHEN 0 THEN 0 ELSE 1 END ASC,
  n.activeTo DESC
"
17779,SELECT using multiple JOINS needs to return even if one compairson is not equal,"SELECT P.[Name]+' - '+P.[Description] AS Sprint, ISNULL(S.Number, 'KanBan') AS Story,     T.[Name] AS Task
FROM DailyTaskHours D
INNER JOIN Task T ON D.TaskId = T.PK_Task 
INNER JOIN Story S ON T.StoryId = S.PK_Story 
LEFT JOIN Sprint P ON S.SprintId = P.PK_Sprint 
GROUP BY  P.[Name], P.[Description], S.[Number], T.[Name]
"
16265,How does an LDAP database differ from a SQL or MySql database,"ldapsearch -b""dc=example,dc=com"" ""cn=Joe S*""
"
33262,SQL - Slow subquery,"SELECT
     tu1.itemid AS trends_uint_itemid,
     tu1.clock AS time_value,
     tu1.value_avg AS pages
FROM
     trends_uint tu1
JOIN

(
     SELECT 
         itemid as theItem
         ,max(tu2.clock) AS LatestTime
     FROM trends_uint tu2
     GROUP BY itemid
) LatestClockForEachItem

ON tu1.itemid = LatestClockForEachItem.theItem
AND tu1.clock = LatestClockForEachItem.LatestTime

ORDER BY tu1.clock DESC;
"
35070,Complex insert statements,"Insert Into Test (Test_Date, Testno, Examno, Serialno, Type, Hours) 
Select S.Test_Date, E.Testno, S.Examno, S.Serialno, 'Non-Flight', (F.STARTED- F.ENDED) as Hours 
From Semester S, TIME F, TESTPAPERS e 
Where S.Testno = F.Testno And E.Testno = 1
"
28318,UPDATE table1 where table2 values multiple variables,"UPDATE
  fixtures
SET toggle = 'visible'
WHERE 
  /* Modify rows currently hidden (not strictly necessary since they would all end up with the same value anyway) */
  toggle = 'hidden'
  /* Retrieve competitions.id matching your criteria */
  AND compid IN (
   SELECT id 
   FROM `competitions` 
   WHERE `Year` LIKE CONVERT( _utf8 '2012' USING latin1 ) COLLATE latin1_swedish_ci 
      /* IN () clause is equivalent to your chain of OR operations */
      AND countyid IN (4, 11, 20, 22)
  )
"
30735,"SQL: Unable To Join These Two Tables (EAV Architechture, Magento)","SELECT e.entity_id, eav.value AS name, eav2.value as price
  FROM catalog_product_entity e
  JOIN catalog_product_entity_varchar eav
    ON e.entity_id = eav.entity_id
  JOIN eav_attribute ea
    ON eav.attribute_id = ea.attribute_id
  JOIN catalog_product_entity_decimal eav2
    ON e.entity_id = eav2.entity_id
  JOIN eav_attribute ea2
    ON eav2.attribute_id = ea2.attribute_id
 WHERE ea.attribute_code = 'name'
   and ea2.attribute_code = 'price'
"
17574,counting subquery in SQL,"SELECT id_count, COUNT(*) AS 'num_count'
FROM (SELECT a.process_track_id
            ,COUNT(*) AS 'id_count'
      FROM transreport.process_name a
      GROUP BY a.process_track_id
      )sub
GROUP BY id_count
"
32263,SQL how to join these tables,"SELECT COUNT(a.id) as total_votes, c.name as country_name
FROM Votes a
LEFT JOIN CARS b
ON a.car_id = b.id
LEFT JOIN Countries c
ON b.country_id = c.id
GROUP BY b.name, c.name
ORDER BY total_votes DESC
"
6255,mySQL - difference between two tables,"SELECT cty.`idCITY_NAME`
FROM `city` cty
LEFT JOIN `keywords_by_city` kbc ON cty.`idCITY_NAME` = kbc.`CITY` AND kbc.`idKEYWORD` = 781
WHERE kbc.`idKEYWORD` IS NULL
"
18877,Sub-query and join,"SELECT  DISTINCT a.*, b.* 
FROM    user a
        INNER JOIN follow b
            ON a.ID = b.user_id 
        INNER JOIN referent_follow c
            ON a.ID = c.follow
WHERE   c.referent = 3
"
21926,Maximum concurrent connections to MySQL," maximum range: 4,294,967,295  (e.g. 2**32 - 1)
"
26119,Force postgres dump to use copy rather than INSERTS,"pg_dump -Fp -t some_table -h localhost -d thisDB -f /some_dir/bkup
                                      ^^^^
"
3422,Get the sum even if a column false/true,"SELECT COALESCE(
    (SELECT ROUND(SUM([Time]*[Price]),0)  
     FROM [tblTime] Y 
     WHERE Y.[OwnerId] = <ID> AND Y.[Invoice] = 'True')
    , 0)    -- value 0 is used only if SELECT returns NULL
+
COALESCE(
    (SELECT ROUND(SUM([Amount]*[Price]),0)  
     FROM [tblMaterial] M 
     WHERE M.[OwnerId] = <ID> AND M.[Invoice] = 'True')
    , 0)    -- value 0 is used only if SELECT returns NULL
"
14979,SQL join on equal plus cartesian of those which not equal,"WITH MatchedRows
AS
SELECT A.a, B.b FROM A a INNER JOIN B b ON A.a = B.b

SELECT MatchedRows.a, MatchedRows.b
FROM MatchedRows
UNION
SELECT A.a, B.b FROM A a, B b
WHERE A.a NOT IN (SELECT a FROM MatchedRows)
  AND B.b NOT IN (SELECT b FROM MatchedRows)
"
142,Need distinct results for command-delimited string aggregation,"SELECT 
    CUSTOMER AS TN,
    substr
    (
        xmlserialize( xmlagg( xmltext( concat( ', ', ITEM) ) ) as varchar( 1024 ) ), 3 
    ) as M_Item
FROM 
    (
        select distinct customer, item
          from ORDERS
         WHERE ITEM LIKE 'CP%'
    ) as x;
"
25295,SQL JOIN a table and GROUP BY to get correct row,"FROM forum_topics
JOIN forum_replies ON forum_replies.topic = forum_topics.id
JOIN users usertopic ON forum_topics.createdby = usertopic.id
JOIN users userreplie ON forum_replies.createdby = userreplie.id
JOIN (select topic, max(created) as maxcreated
      from forum_replies
      group by topic
     ) frmax on frmax.topic = forum_replies.topic and
                frmax.maxcreated = forum_replies.created;
"
20672,using a join and a where ? MySQL,"SELECT delegate.name,
       module.code, 
       module.name,
       delegate.no 
FROM module 
INNER JOIN take 
ON module.code = take.code 
INNER JOIN delegate 
ON delegate.no = take.no 
WHERE grade<40;
"
16612,SQL query with decoding and comparison in where clause,"select *
from t1
where (v1 = 'Less Than' and D1 - D2 < v2) or
      (v1 = 'Greater Than' and D1 - D2 > v2)
"
16718,Calculate with datetime-format and integers,"SELECT DATEADD(MINUTE,106, GETDATE())
"
34184,SQL - Multiple entries in show one instance in c1 with it's correspondent mapping in c2,"SELECT     CASE WHEN ROW_NUMBER() OVER (PARTITION BY t1.c1 ORDER BY t2.c1,t3.c1) = 1 THEN t1.c1 END, 
           t2.c1, t3.c1
FROM       t1
CROSS JOIN t2
INNER JOIN t3
ON         t3.c1 = t2.c1
ORDER BY   t1.c1
"
29671,Creating a Comma Seperated List from a subquery in SQL,"SELECT 
id, 
name as title,
description as body,
(
    select GROUP_CONCAT( b.attributeValue ) as attributeValue
    from
    shop_product a,
    shop_product_attribute b 
    where 
    a.id = b.productId and
    b.attributeName=""Tag""
) as tags
FROM shop_product a
"
20808,SQL Server: use CASE with LIKE,"CASE WHEN countries LIKE '%'+@selCountry+'%' THEN 'national' ELSE 'regional' END
"
27186,Using the value of a column to select another column in SQL,"SELECT
  [DateColumn]=CASE STEP WHEN 1 THEN DATE1 
WHEN 2 THEN DATE2
WHEN 3 THEN DATE3
ELSE DATE4 END
FROM <Table>
"
32784,PLSQL WHERE date_time is in a range of dates,"WHERE date_column BETWEEN TO_DATE(start, 'MM/DD/YYYY')
                      AND TO_DATE(end, 'MM/DD/YYYY')
"
34212,better way to assign variable percentage change calculated,"percentage_change := case when original_count=0 then 0
                         else (todays_count - original_count)/original_count end;
"
6154,using same where clause on multiple tables before joining them,"select
  a.account_id, a.account, t.tax, t.rate
from 
  accounts a
  inner join account_location al 
    on al.account_id = a.account_id 
    and al.location = 'A'
  left join account_tax at
    on at.account_id = a.account_id
  left join tax t on t.tax_id = at.tax_id
"
18717,SELECT COUNT Based on another row in the same table,"select count(distinct email) from entries
"
1232,"SQL Server - For XML Path (nested elements, multiple records)","SELECT EmpName AS [Name],
       EmpSalary AS [WageAmount],
       (SELECT 
       Add1 AS [PersonAddress/Address1],
       Add2 AS [PersonAddress/Address2],
       Mobile AS [PersonAddress/Mobile] FROM Employee B WHERE EmpName = A.EmpName
       FOR XML PATH('AdditionalInfo'),type)
FROM   Employee A
GROUP BY EmpName,EmpSalary
FOR XML PATH ('Employee') 
"
16939,How to show indexes in Oracle SQL,"SELECT  *
FROM    all_indexes
WHERE   table_name = 'COUNTRY'
"
463,Compare field values in same row SQL,"select name, least(date_usa, date_jpn, date_uk)
from your_table
"
15646,Select max count per second,"SELECT COUNT(id), InDateTime
FROM news
GROUP BY InDateTime
"
12475,PLSQL Date Filter Error,"select ('[' || to_char(work_date, 'dd-MON-yyyy') || '] ' || field_name || ' - ' ||work_desc) d
from DAILY_WORK
where work_date >= to_date('30-Jan-2013','dd-MON-yyyy') - 31
order by work_date desc
"
6532,how to drop an index key from a table,"IF NOT EXISTS ( select * 
                  from sys.objects 
                 where parent_object_id = object_id('MyTable') 
                   and type = 'PK' )

do <create index for rec_index>
"
26096,select most recent rows from one table 1 and join to get rows from table 2,"SELECT FNAME, CITY, MY_DATE
FROM (SELECT T1.FNAME, T2.CITY, T2.MY_DATE
      FROM T2, T1
      WHERE T2.ID = T1.ID
      ORDER BY T2.MY_DATE DESC)
WHERE ROWNUM <= 2;
"
12309,Getting a count of a child relation and a count of a child of the child,"SELECT
    id,
    (
         SELECT count(map.id)
         FROM map 
         WHERE map.client_id = client.id
    ) AS n_maps,
    (
         SELECT count(layer.id)
         FROM map INNER JOIN layer ON (layer.map_id = map.id)
         WHERE map.client_id = client.id
    ) AS n_layers
FROM client;
"
34547,Oracle SQL Sum missing right parenthesis,"select p.id, p.name, 
  t.id as toyid, 
  t.name as toyname
from person p
inner join toys t on p.id = t.person_id
inner join 
(
  select person_id
  from toys 
  group by person_id
  having sum(case when name = 'hat' then 1 else 0 end) > 0 and
    sum(case when name = 'doll' then 1 else 0 end) > 0
) t2 
  on p.id = t2.person_id;
"
18627,List Duplicate Dates From 2 rows in one,"select a.rnumber,a.pid,first_viewdate,last_viewdate from 
(select rnumber,pid,viewdate as last_viewdate from table where rented='Y') a,
(select rnumber,pid,viewdate as first_viewdate from table where rowid in 
(select min(rowid) from table group by rnumber) and rented !='Y') b
where a.rnumber=b.rnumber;
"
1636,How To Check for an Index in Oracle,"DECLARE
    i INTEGER;
BEGIN
    SELECT COUNT(*) INTO i FROM user_indexes WHERE index_name = 'MYINDEX';
    IF i = 0 THEN
        EXECUTE IMMEDIATE 'CREATE INDEX myIndex ...';
    END IF;
END;
/
"
27063,SQL - Calculate percentage on count(column),"SELECT event, 
       count(event) as event_count,
       count(event) * 100.0 / (select count(*) from event_information) as event_percent
FROM event_information
group by event
"
27230,PostgreSQL INSERT FROM SELECT with additional column,"INSERT INTO T1
(c1, c_additional) -- here
SELECT 
        C1,
        'needed_value' -- just select a constant here
FROM dblink(
    'hostaddr=127.0.0.1 port=5432 dbname=DB2 user=postgres password=postgres', 
    'SELECT * FROM T2')
AS T2_row(C1 integer) 
"
27719,Get number with decimal value,"cast(621*1.0/7 as Decimal(5,3))
"
36503,Update table with values from other table,"update t1 set B = replace(B, cast(t2.B_old as varchar(10)), c2.B_new)
from Table1 t1
join Table2 t2 on t1.B like cast(t2.B_old as varchar(10)) + '%'
"
19993,Getting value from cursor,"Declare
    v_avgSal employees.salary%TYPE;
Begin    
    SELECT AVG(salary) into v_avgSal 
    FROM employees
    WHERE employee_id = 10 And 
          (payDate >= To_Date('01012015', 'MMDDYYYY') AND payDate < To_Date('01012016', 'MMDDYYYY'));
    Dbms_Output.Put_Line(v_avgSal);
End;
"
28084,groovy oracle result capital column name issue,"sql.rows('select * from people').each {
    People p = new People(it.collectEntries { k,v -> [k.toLowerCase(), v] })    
    println p.name
    println p.age
}
"
37233,SQL Identity with leading padded zeros,"SELECT RIGHT('00000' + CAST([number] AS varchar(5)) , 3)
FROM IdentityTest
"
786,Batch Delete from tableA based on data on tableB,"DELETE tableA
FROM tableB 
WHERE tableA.ID = tableB.ID
"
30309,Mapping a composite primary key with a foreign key relation in Nhibernate,"<many-to-one name=""Order"" class=""Order"" lazy=""proxy"">
  <column name=""OCLORDN"" not-null=""true""/>
  <column name=""OCLAMND"" not-null=""true""/>
  <column name=""OCLCOSC"" not-null=""true""/>
</many-to-one>   
"
28866,How to Assign value based on the Parent Field in SQL Server,";with cte as(select *, -1 + row_number() over(partition by parentid 
                                              order by id) as rn from tablename)
update cte set orderno = rn
"
2762,SQL Inner Join on 2 conditions where possible,"SELECT * FROM  
    #Table2 C 
     INNER JOIN Mapping F  
                  ON C.ID1 = F.ID1 AND 
                  C.ID2 = ISNULL(F.ID2, C.ID2)
"
21646,include primary key value in a procedure while executing the query,"SQL> create table t (code int primary key, text varchar2(10))
  2  /

SQL> set serveroutput on
SQL> begin
  2   insert into t values(1,'test');
  3  exception
  4   when dup_val_on_index then
  5     dbms_output.put_line('Duplicate !');
  6  end;
  7  /

SQL> /

Duplicate !                                                                     
"
30853,Limit SQL by the sum of the row's value,"SET @runtot:=0;
 SELECT 
    q1.t,
    q1.s,
    (@runtot := @runtot + q1.s) AS rt
 FROM 
    (SELECT Date AS t,
     SIZE AS s
     FROM  Table1
     ORDER  BY Date
     ) AS q1
WHERE @runtot + q1.s <= 20
"
30292,"Oracle SQL select highest values from different tables with ""in line view""","select  pg.group_name, max(p.price) 
from prod_group pg, product p
where pg.group_id = p.group_id
group by pg.group_name
order by pg.group_name
"
36555,Need to replace union in the SQL Query,"SELECT p.product_name , COUNT(b.customer_id)
  FROM product p LEFT OUTER JOIN buys b ON p.product_id = b.product_id AND b.year = 2010
  GROUP BY p.product_name;
"
28723,Add per row the total value in SQL,"SELECT 
    t1.id, t1.Game, t1.Points, SUM(t2.Points) [Points (Add)]
FROM 
    yourTable t1 JOIN
    yourTable t2 ON t1.Game = t2.Game AND t1.id >= t2.id
GROUP BY 
    t1.id, t1.Game, t1.Points
"
3105,How to alter all columns without specifying column_name?,"select 'alter table ' + table_name + ' alter column '+ column_name +' ' + data_type + 
(case 
  when character_maximum_length is not null and CHARACTER_MAXIMUM_LENGTH <> -1 then ' (' + CAST(CHARACTER_MAXIMUM_LENGTH as varchar) +')' 
  when CHARACTER_MAXIMUM_LENGTH = -1 then '(MAX)'
  else '' end)  + ' null;'  from tempdb.information_schema.COLUMNS
where TABLE_NAME = '<YOUR TABLE NAME>'
and IS_NULLABLE='NO';
"
10092,Retrieve rows where all related data meets specified criteria,"SELECT  a.ID  -- <<== add some columns here
FROM    job a INNER JOIN visit b ON a.id = b.job_ID
WHERE   a.paid = 'N'
GROUP   BY a.ID
HAVING  COUNT(DISTINCT b.Status) = 1 AND MAX(b.status) = 2
"
22365,How can I weight each MongoDB search query differently?,"db.rest.aggregate([{
    $project: { 
        _id: 1,
        sandwich: { $arrayElemAt: [ '$menu.sandwich', 0]},
        cookie: { $arrayElemAt: [ '$menu.cookie', 0]},
        menuItems: {$size: '$menu'}
    }
},{
    $project: { 
        _id: 1,
        rank: { $divide: [{ $add: ['$sandwich', '$cookie']}, '$menuItems' ]}
    }
}
"
18942,T-SQL Select first instance,"select PatientName, MRN, CSN, LOC as FirstUnit, DateTime as FirstUnitTime
from (select p.*,
             row_number() over (partition by PatientName, MRN, CSN
                                order by datetime asc) as seqnum
      from Patients p
      where loc <> 'ED'
     ) p
where seqnum = 1;
"
9819,SQL MULTIPLE COUNT AND JOIN,"SELECT
  users_entity.name,
  users_entity.username,
  COUNT(CASE WHEN river.action_type = 'create' AND river.view = 'river/object/thewire/create' THEN 1 END) AS Post_Message,
  COUNT(CASE WHEN river.action_type = 'reply' THEN 1 END) AS Discussion_Board
FROM river
JOIN users_entity ON users_entity.guid = river.subject_guid
GROUP BY
  users_entity.name,
  users_entity.username
ORDER BY ???
"
37736,mysql SQL query to compare integer and string,"SELECT C.id , C.Name, COUNT( * ) AS QuotesCount 
FROM categories AS C 
LEFT JOIN quotes  AS Q ON (FIND_IN_SET(c.id,Q.category_ids))
GROUP BY C.Name
"
39438,Convert keep dense_rank from Oracle query into postgres,"-- we only added infos to the activity_monitor_transaction
-- we are free to group by date_time or status
SELECT
  first_value(status) OVER w AS global_transaction_status,
  count(*) OVER w AS global_transaction_count,
  activity_monitor_transaction.*
FROM
  activity_monitor_transaction
WINDOW w AS (
  PARTITION BY global_transaction_id
  ORDER BY date_time DESC, id DESC
  ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
)
"
3829,Getting marks contribution based on sum not working,"select T.name,T.marks,T1.sum,cast(T.marks as float)/t1.sum
from dbo.Total_Marks as T
cross join (select SUM(Marks) sum from dbo.Total_Marks) t1
order by marks desc
"
10455,check condition in table definition,"create unique index on tab (isdefault)
where isdefault ;
"
21253,How to set priority for sequence of selects in mysql,"select * 
from Mytable  
where Myculomn like ""%apple%""
  OR Myculomn like ""%orange%""
  OR Myculomn like ""%strawberry%""
ORDER BY CASE WHEN Myculomn like ""%apple%"" THEN 1
    WHEN Myculomn like ""%orange%"" THEN 2
    WHEN Myculomn like ""%strawberry%"" THEN 3
    ELSE 4 END ASC
    LIMIT 4
"
19420,SQL Server equivalent of MySQL's USING,"SELECT * FROM user INNER JOIN perm ON user.uid = perm.uid
"
19572,MYSQL: get all tables and this tables columns,"select T.Table_name, C.column_name from information_schema.Tables AS T
LEFT JOIN information_schema.COLUMNS as C
ON T.Table_name = C.Table_name
where T.TABLE_SCHEMA = <YOUR_SCHEMA (name of db)>
order by C.ordinal_position
"
39665,Show datas from tables that can have a same data in a column in the same table,"SELECT w.url, w.title, a.title, a.authors, 
  d.content, d.title
FROM tb_doc d
INNER JOIN tb_wrapper w  ON d.title = w.title
INNER JOIN
(
   SELECT title, GROUP_CONCAT(author SEPARATOR ', ') AS authors
   FROM  tb_author
   GROUP BY title
 ) a ON w.title = a.title
"
29755,MySQL: Returning total record count from a CROSS JOINed row?,"SELECT names.pid, name, COUNT(extra) as total 
FROM names 
LEFT JOIN info 
ON info.pid=names.pid 
GROUP BY names.pid
"
33677,"In redis, how do i remove keys?","for key in `echo 'KEYS user*' | redis-cli | awk '{print $1}'`
 do echo DEL $key
done | redis-cli
"
10593,How to format query result in Oracle?,"select case JOB when 'CLERK' then 'NEW CLERK' else JOB end as JOB from your_table
"
29799,Delete row from multiple tables,"DELETE FROM 
  table1, table2, table3
USING 
  table1 
LEFT JOIN 
  table2 ON table2.colName = table1.colName 
LEFT JOIN 
  table3 ON table3.colName = table1.colName 
WHERE 
  table1.colName = 'value'
"
6510,generic Mysql stored procedure,"CREATE PROCEDURE `get`(IN tb VARCHAR(50), IN id INTEGER)
BEGIN
    PREPARE stmt1 FROM CONCAT('SELECT * FROM ', tb, ' WHERE Indx = id');
    EXECUTE stmt1;
    DEALLOCATE PREPARE stmt1;
END//
"
31766,SQL Server 2008 R2 VB.net Connection,"Data Source=MSSQLPROD;Initial Catalog=MS435_PROD;Integrated Security=SSPI
"
3360,Doctrine/Symfony losing M:N relationships on save,"public function configure()
{
  unset($this['beta_meeting_list']); // or the correct value
}
"
957,SQL. How should i write NOT LIKE statement,"SELECT * FROM [Table] WHERE Izdava IS NOT NULL
"
17963,How to create a date for identity field,"select dateadd(day, Date_, '19570417')
"
19046,Writing a select statement inside an Oracle user-defined function,"CREATE OR REPLACE FUNCTION GET_GROUP_BY_ID 
RETURN VARCHAR2 AS

  my_result FAV_GROUP.NAME%TYPE;

BEGIN

  SELECT fav_group.name 
    INTO my_result 
    FROM fav_group 
   WHERE fav_group.id = 12345;

  RETURN my_result;

END GET_GROUP_BY_ID;
"
19474,Sql query that numerates the returned result,"SELECT  (SELECT COUNT (1) FROM field_company fc2
         WHERE fc2.field_company_id <= fc.field_company_id) AS row_num,
        fc.field_company_name
FROM    field_company fc
"
8265,SQL Server query with same functionality as Excel VLookup,"select 
   b.columnb,
   case when a.columna is null then 'FALSE' else 'TRUE' end 

from
   tableb b left outer join
   tablea a on b.columnb = a.columna
"
23353,Concatenating multiple results of a query in one row in Oracle,"select c.firstname, c.lastname,
       list_agg(p.product||'-'||p.desc, ' , ') within group (order by p.id) as product_and_desc
from customer c join
     product p
     on c.id = p.customer_id
group by c.firstname, c.lastname;
"
11032,How to query range of data in DB2 with highest performance?,"SELECT * FROM TABLE LIMIT 5 AND 20
"
1360,COALESCE function returns no rows,"SELECT DISTINCT 'NA' AS ATTR FROM TABLE WHERE NOT EXISTS(SELECT 1 FROM TABLE WHERE %condition%)
UNION
SELECT ATTR FROM TABLE WHERE %condition%;
"
17556,Get start date of week using datepart,"

declare @StartDate as datetime = '1/1/' + cast(datepart(year,getdate()) as char(4))
declare @StartofYear as datetime = dateadd(day,(datepart(dw,@startdate)*-1)+1,@StartDate)

Select datepart(week, [Date]) as WeekNo, SUM([ItemsSold]) as Total, dateadd(day,(@WeekNo-1)*7,@StartofYear) as WeekOf
From [table] 
group by datepart(week, [Date])"
12024,Sql sum of count field with different product name once,"Select product, sum(count)
from table_name
group by product
"
7691,Oracle Materialized View: update MVs in the remote db?,"select nvl(a.key, b.key), decode(a.key, null, b.col, a.col)
from tab1_sister a 
full join mv_tab1 b on (a.key = b.key);
"
26622,SQL - Searching in a table based on information in another table and returning multiple results,"SELECT 
    t.GalaxyId As TraceGalaxyId,
    m.GalaxyId as MainGalaxyId,
    m.umag,
    m.imag 
FROM trace
JOIN main m 
ON m.galaxyId BETWEEN t.GalaxyId AND t.lastProgenitorId AND m.snap = 'Specific Value'
"
29940,"MySQL: SELECT query, but then delete records from that query where columns equal","DELETE bid_tag.*
FROM bid_tag join
     (select serial_number, count(*) as cnt
      from bid_tag where user_id = 0
      group by serial_number
     ) tsum
     on tsum.serial_number = bid_tag.serial_number and cnt > 1
WHERE tag_design = 0 AND tag_size = 0
order by bid_tag.serial_number
LIMIT 0, 21000;
"
37987,How to return N records in a SELECT statement without a table,"SELECT nacha_rows
FROM NACHA_TABLE
UNION ALL
SELECT TOP (SELECT (10-COUNT(*)%10)%10 FROM NACHA_TABLE) REPLICATE('9',94)
FROM master.dbo.spt_values
"
15781,sql query without subquery,"SELECT parts_a.name, parts_a.color 
FROM parts parts_a, parts parts_b
WHERE parts_a.weight > parts_b.weight
   AND parts_b.name = ""wheel""
"
16816,if conditions in where clause,"SELECT OrderId AS OrderId
       CASE 
           WHEN Action = 'add' AND amountRcd = 'Y' THEN addOrderComment
           WHEN Action = 'postpont' AND amountRcd = 'Y' THEN postponeOrderComment
           WHEN Action = 'cancel' THEN cancelOrderComment 
           ELSE 'Unrecognised action'
       END AS Comment
FROM tblOrders
"
4383,New Column with average by Date in SQL Server,"SELECT OrganizationCode, CreatedDate
     , AVG(TotalCost) OVER ( PARTITION BY CreatedDate ) AS [Daily Average]
     , COUNT(*) OVER ( PARTITION BY CreatedDate ) AS [Daily Amount]
  FROM #TempLocalOrg;
"
15805,How to query across three tables joined by an intermediate table?,"select c.*, p.* 
from categories c
inner join PROJECT_CATEGORY pc on pc.category_id = c.id
inner join projects p on pc.project_id = p.id
"
19346,fixing large number of constraints issues reported by DBCC,"select  *
from    ReferencingTable t1
where   not exists
        (
        select  *
        from    ReferencedTable t2
        where   t1.ForeignKeyColumn = t2.Id
        )
"
1909,count duplicate values in a column sql,"SELECT Count(Column) - Count(DISTINCT Column)
FROM   yourTable
"
37930,find the table size on IBM netezza sql database from Aginity workbench on win 7,"select used_bytes/pow(1024,3) as used_gb, *
from _v_table_storage_stat
where tablename = 'my_table_name'
"
14414,Delete dupes without deleting data loaded multiple times,"delete from (select t.*,
                    row_number() over (partition by enddate, loadedon, siteid order by loadedon desc) as seqnum
             from automation t
            ) t
where seqnum > 1
"
38202,Results based on column value in SQL Server,"WITH candidates AS (
SELECT Column1, Column2
  FROM Table1
  WHERE Column2 = 'Value20'
)
SELECT t.Column1, t.Column2
  FROM Table1 t
  JOIN candidates c ON (c.Column1 = t.Column1 AND t.Column2 <> 'Value20')
"
27694,select data between 2 dates in SQL,"select
    PM.PM_Eng_Name,
    sum(isnull(PMOutput.Quantity, 0)) as TotalOut
from PM
    left outer join PMOutput on PM.PM_code = PMOutput.PM_code and PMOutput.Output_Date BETWEEN ‘2013-01-01’ AND ‘2013-08-25’
group by PM.PM_Eng_Name
"
19236,updating two table with one single insert-SQL,"START TRANSACTION;
update customers set customer_name = 'John'  where customer_id=1;
update purchases set state='Accepted'  where customer_id=1;
COMMIT;
"
6360,MySQL query where you can't access relations through joins,"SELECT date, duration, educationDepartment, completedtasks 
FROM programm_completedtask 
WHERE date BETWEEN '2014-04-07' AND '2014-04-11'
AND trainee_id = (select id from users where username = 'XYZ');
"
10622,Selecting distinct values where input is in another column,"SELECT DISTINCT id
FROM myTable
WHERE @myInput IN (rColumn, sColumn);
"
3003,SQL Loop sadness,";WITH CTE as 
(SELECT row_number() over (order by pk) rn, items
FROM dbo.TEST)
SELECT @Name = Lower(items) FROM CTE where rn = @i
"
14096,Getting x amount of rows where id = id(other table) with the highest amount of rows with that id,"SELECT
  A.id,
  A.name
FROM
  A join
  B on A.id = B.id
GROUP BY
  A.name
ORDER BY
  count(B.id) desc
LIMIT 2
"
18126,concatenate results of a sql query,"SELECT LISTAGG(columnname, ',') WITHIN GROUP (ORDER BY columname)
"
32433,SQL Server - Selecting Most Recent Record to generate a list of changes,"  SELECT query.historyID
    FROM
    (SELECT MAX(track.trackID) AS maxTrackID, track.historyID
    FROM RS_HistoryTracker track
    WHERE track.trackDateTime <= '2009-08-06 23:59:59'
      AND track.action LIKE 'STATUS:%'
    GROUP BY historyID) AS query, RS_HistoryTracker track
    WHERE track.historyID = query.historyID
      AND track.trackID = query.maxTrackID
      AND track.action LIKE 'STATUS:%:DRAFT'
"
21643,Shredding XML from table column into a view in SQL Server,"SELECT     
        TeamName = Foot.value('(name)[1]', 'varchar(100)'),     
        Manager = Foot.value('(@manager)', 'varchar(100)'),     
        Ground = Foot.value('(ground)[1]', 'varchar(100)')   
FROM    
    Storage S 
        CROSS APPLY data.nodes('/footballteams/team') AS Tbl(Foot)
"
8065,SQL - Selecting multiple results using AVG,"SELECT groupnumber, SUM(score), AVG(score), MIN(score), MAX(score) 
FROM players
GROUP BY groupnumber;
"
3990,Conver varchar value as Time in oracle,"select
     to_char(
       to_date('001500','HH24MISS')
     ,'HH24:MI:SS')
from dual;  
"
9605,Select rows with not not duplicated specified fields (Transact-SQL),"SELECT        R1.id, 
              R1.way_id, 
              R1.node_id, 
              R1.sort
FROM          Relations R1
WHERE        R1.way_id = 107187465
AND R1.id = (SELECT MAX(R2.id) FROM Relations R2
             WHERE R1.node_id = R2.node_id)
"
26441,"How can i select a datetime as ddMMyy, so a two-digit year?","REPLACE(CONVERT(CHAR(10), ChargeArrival.CreatedAt, 3), '/', '')
"
33788,"How to find ""holes"" in a table","select ID +1 From Table t1
where not exists (select * from Table t2 where t1.id +1 = t2.id);
"
19021,Create a table + populate it using another table in One Query,"SELECT column1, column2, ...columnN 
   into first_table_name 
   FROM second_table_name
   [WHERE condition];
"
18082,How to get DB2 MQT last refresh time,"SELECT REFRESH_TIME
FROM SYSIBM.SYSVIEWS
WHERE NAME = ?
AND CREATOR = ?
AND TYPE = 'M'
"
30081,Disable a trigger from a trigger Oracle,"EXECUTE IMMEDIATE 'ALTER TRIGGER trigger_name_here DISABLE';
"
32772,SQL column containing array of table row values,"Persons(id int, name varchar(40)...)

Tags(id int, name varchar(40)....)

PersonTags(id int,
           personid FOREIGN KEY References Persons(id), 
           TagId FOREIGN KEY references Tags(id))
"
36802,Rails 3 ActiveRecord group by child attribute,"dupes = Subscription.joins(:mailing_address).group(""mailing_addresses.name"")
"
5704,"SQL query order date by ASC, but past entries on end?","SELECT * 
FROM agenda 
INNER JOIN organizer ON agenda.agenda_organizer=organizer.organizer_id
ORDER BY
CASE WHEN yourDateColumn > NOW() THEN 1
     WHEN yourDateColumn < NOW() THEN 2
END ASC,
yourDateColumn
"
30443,Latest instance of sql row without self join,"SELECT *
FROM
 ( SELECT userid, SUM(no) AS no_sum, version_no,
      ROW_NUMBER()
      OVER (PARTITION BY userid 
            ORDER BY version_no DESC) AS rn
   FROM table_name
   GROUP BY userid, version_no
 ) AS dt
WHERE rn = 1
"
12228,sql server get min time?,"SELECT [USERNAME], [DATE]
, min(case when [action] = 'Clock In' then [time]  end) as 'First in'
, min(case when [action] = 'Clock Out' then [time] end )as 'First out'
, max(case when [action] = 'Clock In' then [time] end) as 'Last in'
, max(case when [action] = 'Clock Out' then [time] end )as 'Last out'
FROM attendance
WHERE [USERNAME] = 'User1' AND [DATE] = '01/12/2012'
group by [username],[date]
"
35561,combinng two values in a column in SQL,"SELECT DISTINCT C.COL1
FROM (
SELECT P.PARTNER AS COL1
FROM TABLE AS P
UNION ALL
SELECT P.Name AS COL1
FROM TABLE AS P
) AS C
"
5172,How To Use The Where & Like Operator Together in SQL?,"SELECT firstname, lastname, state
FROM instructors
WHERE state = 'ga'
AND lastname LIKE '*son*'
"
15244,Dynamic update statement with variable column names,"declare @sql nvarchar (1000);
set @sql = N'update table set ' + @column_name + '= ''''';

exec sp_executesql @sql;
"
25809,SQL multiple join with count,"SELECT q.id question_id, a.answer_number, COUNT(ua.id) answer_count
FROM question q
JOIN answer a 
  ON q.id = a.question_id
LEFT JOIN users_answers ua 
  ON q.id = ua.question_id AND a.answer_number = ua.answer_number
GROUP BY q.id, a.answer_number
ORDER BY q.id, a.answer_number
"
23545,Comparing two tables for equality in HIVE,"select count(*) from table1 t1
full outer join table2 t2
on t1.key=t2.key and t1.c1=t2.c1 and t1.c2=t2.c2 and t1.c3=t2.c3
where t1.key is null /* this condition matches rows that only exist in t2 */
   or t2.key is null /* this condition matches rows that only exist in t1 */
"
31097,SQL - How to get 'number of days since last active day' using day flags,"set datefirst 1

declare @dt date = getdate() + 1 - 1
    , @mask varchar(7) = '0010010'

select charindex ('1', reverse (left (@mask + @mask, datepart (dw, @dt) + 7) ) ) - 1
"
25760,Microsoft SQL Querying Hours in Timestamp,"SELECT *
    FROM YourTable
    WHERE DATEPART(hh, YourColumn) BETWEEN 18 AND 20
"
29233,Avoiding a MySql Loop With Query,"select title
from packages p
inner join pack_to_tag pt on p.index = pt.pIndex
inner join keyworks w on w.index = pt.kindex
where word in ('keyword','array','returns','all','results')
group by title
having count(*) = 5
"
4673,ORDER BY a truth value,"SELECT *
FROM table
ORDER BY (score > 90) DESC, location;
"
30692,Allocated Cost Calculation in Oracle PL SQL Query [logical],"select 
BusinessUnit, CustomerID, ProductFamily , Revenue
, (table1.Cost * table2.Revenue ) 
  / (SUM(Revenue) over(partition by table1.BusinessUnit, table1.ProductFamily )) 
                 AS  Allocated_Cost
from 
    table1 
    INNER JOIN table2 ON ( table1.BusinessUnit =  table2.BusinessUnit
                          AND table1.ProductFamily = table2.ProductFamily )
;
"
26655,PL/SQL - caching two resultsets into collections and joining them together?,"create type foo as table of number;-- or a record type, data%rowtype, whatever
...
myfoo1 foo := foo (1,2,3);
myfoo2 foo := foo(3,4,5)

select column_value
into bar
from table(foo1) join table(foo2) using (column_value)
"
32432,optimise and merge sql queries into one - newbie alert,"SELECT m.username,
    (
        SELECT SUM(liter) AS SumOfLiters
        FROM diesel
        WHERE diesel.dato >= '$dx'
        AND diesel.IDField = d.IDField
    ) AS TotalFuel
FROM members m
    JOIN diesel d ON d.userid = m.id
WHERE d.dato >= '$dx'
"
38711,SQL MIN not working correctly,"SELECT
    SUM(cancellations), SUM(changes)
FROM (
    SELECT DISTINCT * FROM table_1
) AS t
"
28046,Equivalent of defining local variables in SQL,"SELECT stddev_pop(C) 
FROM
(
   SELECT B, C
   FROM   table1
   WHERE  B < (SELECT AVG(B) FROM table1 )
) s
"
14627,Select Mysql commutative sum of each row,"mysql> set @my_var=0;
mysql> select frq, @my_var:=@my_var+frq as commutative_sum from `mytable`
"
38154,Two entities should have same parent entity in relational model.,"ALTER TABLE PhotoPair
ADD CONSTRAINT 'photo1_person_fk'
    FOREIGN KEY (Photo1, PersonID)
    REFERENCES Photo (PhotoID, PersonID),
ADD CONSTRAINT 'photo2_person_fk'
    FOREIGN KEY (Photo2, PersonID)
    REFERENCES Photo (PhotoID, PersonID);
"
19024,sql query to get records based on 2 ID's,"select i.routeid, i.cid, p.plid, p.division
from ilroute i
  join plroute p on i.routeid = p.routeid 
where i.cid = 3 and 
  exists (select 1
                from PlRoute p2
                where p.routeid = p2.routeid 
                    and p2.plid = 7)
"
13748,MySQL: Combining the results of 2 columns in one statement,"SELECT
  name
FROM 
  person
  /* Join against the other table on *either* column c_1 or c_2 */
  INNER JOIN `table` ON `table`.c_1 = person.person_id OR `table`.c_2 = person.person_id
WHERE
  /* And the WHERE condition only needs to be applied once */
  c_1 = 3 OR c_2 = 3
"
29208,How do I select a date that is 4 days ago at this time?,"SELECT * FROM mytable WHERE created_at > sysdate - 4
"
24214,Oracle - complexer case statement in where-clause,"SELECT text, mydate
FROM mytable
WHERE
   (     to_number(TO_CHAR(sysdate, 'MM')) >= 4 -- if month of current year >= april
     AND mydate >=TRUNC(LAST_DAY(SYSDATE), 'YYYY') --beginning of current year
     AND mydate < TRUNC(LAST_DAY(SYSDATE)+1, 'YYYY') -- end of current year
   ) OR (
         to_number(TO_CHAR(sysdate, 'MM')) < 4 
    AND  mydate < sysdate)
   );
"
29282,Selecting most common month from DATETIME field,"SELECT month(""date""), count(*)
  FROM ""table""
 GROUP BY month(""date"");
"
20923,Grails: Join two tables using plain sql,"select p.first_name, v.visit_no from patient p join visit v on v.patient_id=p.id
"
38125,How to enter NULL into database table cell in MS Visual Studio table editor?,"CTRL + 0
"
16344,"How to insert a new collumn into a table , the table exist?","insert 
  into s_criteria ( module_name, include_list , created_by, date )
values ( 'max_days', 366, 'me', to_date('08/30/2013', 'MM/DD/YYYY') );
"
5765,INSERT statement conflicted with the CHECK constraint,"cast( cast( employeeNumber as int ) as char(8) ) = employeeNumber 
AND cast(employeeNumber as int) > 10000000
AND charindex('0', employeeNumber) = 0
"
8129,Comparing data from the same column in SQL Server,"select 
    -- Construct the string by left part + max(right part)
    LEFT([column], CHARINDEX(';', [column], 0) - 1) + ';' + 
    MAX(RIGHT([column], LEN([column]) - CHARINDEX(';', [column], 0)))
from 
    [table]
group by 
    LEFT([column], CHARINDEX(';', [column], 0) - 1) -- The left part of ';'
"
20626,select rows from multi tables sql,"select 'table_A' as table_name, No, date, data from table_A
where No = 1
union all
select 'table_B', No, date, data from table_B
where No = 1
union all
select 'table_C', No, date, data from table_C
where No = 1;
"
16948,Computing value in select statement t-sql,"SELECT Top(1) Name, 
LEN(Name) AS Equals, 
Abs(LEN('Johny') - LEN(Name)) AS NotEquals, 
cast(LEN(Name) as float)/(Abs(LEN('Johny') - LEN(Name)) + LEN(Name)) As Match
FROM Demo
WHERE Name = LEFT( 'Johny' , LEN(Name) ) 
ORDER BY LEN(Name) DESC 
"
37296,"If actual date is Friday, also show rows at saturday and sunday Oracle DB","Where Mydate.Arrival < Trunc (Sysdate) - 365
Or (to_char(Mydate.Arrival, 'D') = 6 AND Mydate.Arrival < Trunc (Sysdate) -363)
"
18429,Sql Query or Join for 3 tables,"SELECT        [User Table].User_id, [Events Table].*
FROM            [Commit Table] INNER JOIN
                         [User Table] ON [Commit Table].User_id = [User Table].User_id INNER JOIN
                         [Events Table] ON [Commit Table].Event_id = [Events Table].Event_id
"
39432,How to explode user id from a database column?,"select * from table 
where find_in_set(4,receiver_id ) >0
"
22913,how to get product id and sku in magento with SQL,"SELECT entity_id as product_id, sku FROM catalog_product_entity
"
6883,Joining 3 Tables (count like occurrences on post by user),"SELECT COUNT(1) FROM likes WHERE pid = :PID AND uid = :UID;
"
32408,ms-access selecting the problematic data,"select Col1, Col2 from MyTable
where Col1 not in (
    select Col1 
    from MyTable 
    where Col2 = 'ok'
)
"
13710,After 24 hours from creation ORDER BY ASC,"SELECT * 
FROM Table 
WHERE post_createdAt >= now() - INTERVAL 1 DAY 
ORDER BY post_createdAt DESC
UNION ALL
SELECT * 
FROM Table 
WHERE post_createdAt < DATE_SUB(NOW(), INTERVAL 24 HOUR)
ORDER BY post_createdAt ASC
"
9525,Cross tab Pivot in TSQLwith group by and order by,"SELECT *
FROM
(
    SELECT Part, LOCATION, Qty, FiscalMonthPeriod
    FROM @Table
) t
PIVOT
(
    SUM(Qty)
    FOR FiscalMonthPeriod IN ([CON00], [CON01], [CON02], [CON03])
) p
"
25875,unstack hierarchical data,"select 
  coalesce( l3.id_value,l2.id_value) as id_value ,
  l3.description as ""3"",
  l2.description as ""2"",
  l1.description as ""1""
from t l1 inner join
     t l2 on l2.""LEVEL""=2 and l1.id_value = l2.parent_id_value
          left outer join
     t l3 on l3.""LEVEL""=3 and l2.id_value = l3.parent_id_value
where l1.LEVEL = 1
"
13405,SQL Issues With Different Select Statements that are Grouped together,"SELECT TOP 2 * FROM (Select 1 as 'RowNum', OeeID, FkEquipmentType, Nominal, Low from #KpiSetupOee where FkEquipmentType ='WM'
Union
Select 2, OeeID, FkEquipmentType, Nominal, Low from #KpiSetupOee where FkEquipmentType <> 'WM') A Order by 'RowNum', Nominal asc 
"
9667,Count of similar data based on different range of dates,"SELECT
  name,  
  SUM(CASE WHEN DAY(date) BETWEEN 1 AND 10 THEN 1 ELSE 0 END) as ""1-10"",
  SUM(CASE WHEN DAY(date) BETWEEN 11 AND 20 THEN 1 ELSE 0 END) as ""11-20"",
  SUM(CASE WHEN DAY(date) BETWEEN 21 AND 30 THEN 1 ELSE 0 END) as ""21-30""
FROM flights
GROUP BY name
"
28887,Sorting according to number of characters in SQL Server,"order by len(name), name;
"
11585,Space SQL String VBA,".RowSource = ""SELECT Contacts.ID, FirstName & ' ' & LastName AS FullName FROM Contacts WHERE CompanyID = "" & CompanyValue & "";""
"
29727,How do I select a 1 as a bit in a sql-server view?,"SELECT id, name, CONVERT(bit, 1) AS active
FROM users
"
13052,"SQL - Order By ""Custom Preference List""","order by (case when field = n then 1
               when field = 0 then 2
               else 3
          end)
"
35536,Drag number of 1 from the database,"UPDATE 
  danshold 
SET 
  Maxantal = Maxantal - 1 
WHERE 
  Id = @tilmeldButton
"
39194,How to Display Dates in Calendar View from Database,"calendarView.setOnDateChangeListener(new OnDateChangeListener() {

            @Override
            public void onSelectedDayChange(CalendarView view, int year, int month,
                    int dayOfMonth) {

**here you start new activity.**

            }
        });
"
9914,SQL Query COUNT with two Joins,"SELECT m.id, 
       COUNT(DISTINCT c.id) AS t_comment, 
       COUNT(DISTINCT l.id) AS t_like
FROM messages m
LEFT JOIN user_comment_messages c ON c.message_id = m.id
LEFT JOIN user_like_messages l ON l.message_id = m.id
GROUP BY m.id;
"
17027,Create a table from another table,"create table new_table (like old_table);
"
545,How to compare two SELECT subqueries by using the BETWEEN operator?,"SELECT *
FROM (
  SELECT
     DATUM,
     AVG(SCHLUSSPREIS) OVER (ORDER BY DATUM rows BETWEEN 89 PRECEDING AND CURRENT ROW) AS TAGESLINIE
  FROM KURS
  WHERE WKN = 2
  ORDER BY DATUM DESC
) Moving_Average
WHERE ROWNUM <= 90;
"
17839,Joining and printing search results of a column with multiple values in a cell,"SELECT *, group_concat(T2.Genre separator ', ') AS GENRE_RESULT 
FROM books_db AS T1 
JOIN genre_link_db ON genre_link_db.ID_books = T1.ID
JOIN genre_db AS T2 ON genre_link_db.Genre_ID = T2.Genre_ID
WHERE books_db.Book_title like '%'
GROUP BY T1.ID;
"
37495,LINQ - Left Outer Join with multiple parameters in Where clause,"var leadIds = linq.Lead.Where(l => l.clientId == clientId.ToString()).Select(l => l.id);
var chatter = from chat in linq.Chat
              where (chat.typeId == 5 && chat.key == clientId.ToString()) ||
                    (chat.typeId == 4 && leadIds.Contains(chat.key));
"
31594,Select year/month format in a given interval of years,"SELECT d = REPLACE(CONVERT(CHAR(7), d, 121), '-', '/')
FROM 
(
  SELECT DISTINCT 
    d = DATEADD(MONTH, DATEDIFF(MONTH, '19000101', colDate), '19000101')
    FROM dbo.MyTable
    WHERE colDate >= '20120101'
    AND colDate < '20140101'
) AS x
ORDER BY d;
"
9436,"""Select Top 10, then Join Tables"", instead of ""Select Top 10 from Joined Tables""","SELECT * FROM
    (SELECT TOP 10 * FROM your_table
     ORDER BY your_condition) p
INNER JOIN second_table t
    ON p.field = t.field
"
23900,TSQL INNER JOIN,"SELECT support_ticket.something, engineers.engineer_display_name
FROM support_ticket
JOIN site_details ON ( site_details.site_id = support_ticket.site_id )
JOIN engineers ON ( engineers.engineer_id = site_details.site_default_engineer_id )
"
11703,SQL with inner join and subquery,"SELECT t.*,usend.user_name sender_name, urec.user_name receiver_name
FROM thread t
JOIN users usend on usend.user_id = t.sender
JOIN users urec on urec.user_id = t.receiver
where sender = 135 or receiver = 135
order by updatedttm desc
"
24338,Tomcat JDBCRealm using Oracle database over SSL (PROTOCOL=TCPS),"javax.net.ssl.trustStore=<path to trust store>
"
21557,SQL Database Query: Count(Distinct),"SELECT     project.PNO,
           project.PNAME, 
           COUNT(DISTINCT works_on.ESSN) AS '# of employess worked on'
FROM       project 
INNER JOIN works_on ON project.PNO = works_on.PNO
INNER JOIN employee ON works_on.ESSN = employee.SSN
GROUP BY   project.PNO, project.PNAME -- Here!
HAVING     COUNT(DISTINCT works_on.ESSN) > 2 AND project.PNO LIKE 1
"
34937,Get Weeks in SQL,"SELECT DATEPART(wk, DateField) AS WeekNumber, COUNT(*) AS HitsForWeek
FROM SomeTable
WHERE DateField >= '20090101' AND DateField < '20100101'
GROUP BY DATEPART(wk, DateField)
"
39407,How to use group by with null values,"SELECT personCount, SUM(toatlMinute) as toatlMinute, SUM(Meal) as Meal,
       max(QPWaiting) as QPWaiting, max(NoOfNCR) AS NoOfCR, max(NCRNo) AS CRNo 
FROM  @OperatorData
GROUP BY personCount;
"
20114,Is There Any Way to Combine These Queries into One?,"SELECT `bio_community_events`.`id`, `bio_community_events`.`begin_on`, `bio_community_events`.`name`
    FROM `bio_community_events` INNER JOIN `bio_contacts` on `bio_community_events`.user_id=bio_contacts.contact_id
WHERE bio_contacts.user_id=33;
"
35196,count coalesce to count from two columns,"SELECT
  COALESCE(productactual, product) AS product,
  COUNT(*) AS productcount
FROM atable
GROUP BY
  COALESCE(productactual, product)
;"
36026,Sql many to many relation with the same table,"|UserID1|UserID2|
|      1|      2|
|      2|      3|
"
4145,Scoring Formula with Positive/Negative Rank,"SELECT    UserID, WidgetID, Rank, IsPreferred, Rank() over (Partition BY UserID  order by Rank DESC) as Score
FROM         dbo.Table
Where IsPreferred = 1
Union
SELECT    UserID, WidgetID, Rank, IsPreferred, -1 * Rank() over (Partition BY UserID  order by Rank DESC) as Score
FROM         dbo.Table
Where IsPreferred = 0
ORDER BY UserID, Score
"
32065,Time stamp automatically update when update any field in mysql,"ALTER TABLE `user` 
   MODIFY keytime TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP;
"
28449,Trending sum over time,"SELECT DISTINCT   
  date, user_id, SUM(count) OVER (PARTITION BY user_id ORDER BY date) AS count 
  FROM actions
WHERE
  action IN ('Call', 'Email');
"
29080,one to many sql query with good performance,"Select PAYMENT_SCHEDULE_MASTER_ID from (
Select COUNT(*)  As IdCount, PAYMENT_SCHEDULE_MASTER_ID, ACTUAL , FORECAST
from PAYMENT_SCHEDULE_DETAIL
group by PAYMENT_SCHEDULE_MASTER_ID, ACTUAL, FORECAST) t
where t.IdCount = 1 
and t.ACTUAL = 0.00
and t.FORECAST = 0.00
"
26686,SQL Update column with data from another table,"UPDATE Devices d SET model_id = (SELECT c.change_model_id
                                 FROM Change_Values c
                                 WHERE c.d_id = d.device_id)
WHERE EXISTS (SELECT *
              FROM Change_Values c
              WHERE c.d_id = d.device_id);
"
4071,select 2 tables copy a unique number when records match,"UPDATE paypal_ipn_orders
SET sort_num = (SELECT sort_num
                FROM lookup
                WHERE lookup.item = paypal_ipn_orders.item_name)
"
22749,SQLite has no looping. How can I accomplish looping?,"CREATE TABLE t(x);
INSERT INTO t VALUES('1:2:3:4:5:6:7:8:9:10');

WITH RECURSIVE split(val, rest) AS (
  SELECT NULL,
         x || ':'
  FROM t
  UNION ALL
  SELECT substr(rest, 1, instr(rest, ':') - 1),
         substr(rest, instr(rest, ':') + 1)
  FROM split
  WHERE rest != ''
)
SELECT val
FROM split
WHERE val IS NOT NULL;
1
2
3
4
5
6
7
8
9
10
"
22484,Specify data type with column alias in SQL Server 2008,"SELECT CAST (CASE 
               WHEN LOWER(h.outofserv) = 'y' THEN 1 
               ELSE 0 
             END AS BIT) AS OOS 
 FROM HISTORY h
"
37892,sql: what does Max() -1 mean?,"select
    userName,
    avg(age)
from
    users
group by
    userName
"
35297,Compare rows in SQL query,"select id, checkin, checkout
from (select t.*, max(checkout) over (partition by id) as maxco
      from t
     ) t
where maxco <= trunc(sysdate)
"
31202,What is the best way to have many images and (thumbnails?) for one entity?,"Id    BikeId    Title
277   123       ""Cool picture""
"
28234,What can i use for a no-op in T-SQL?,"IF @parm = 1
    BEGIN
    print 'need to implement 1'
    END
IF @parm = 2
    BEGIN
    print 'need to implement 2'
    END
"
8791,Select statement to find duplicates on certain fields,"select field1,field2,field3, count(*)
  from table_name
  group by field1,field2,field3
  having count(*) > 1
"
7672,"MySQL - Finding if a User has taken a Course, and if so, which one, too many rows being generated","SELECT
    u.uid,
    MAX(IF(c.name REGEXP 'Course I?$ | Course I[[:space:]] | Course 1', 1, 0)) AS 'Course 1',
    MAX(IF(c.name REGEXP 'Course II$ | Course II[[:space:]] | Course 2', 1, 0)) AS 'Course 2'
FROM
    Users u
    INNER JOIN UserCourses uc ON uc.uid = u.uid
    LEFT JOIN Courses c ON c.cid = uc.cid
GROUP BY
    u.uid
ORDER BY 
    u.uid;
"
34717,Count same id column with different condition in same select statement,"SELECT SUM(job_status = 0) pending, SUM(job_status = 1) approved 
FROM tbl_employer_post_details epd 
INNER JOIN tbl_employer_registration er ON epd.employer_id = er.employer_id
WHERE job_status IN (0, 1);
"
18016,Using quotes in SQLite an Android,"INSERT INTO Users (code, name) VALUES (666, 'Bruce Dickinson')
"
37873,update a specifique word in column,"UPDATE myTable
SET MyColumn = REPLACE(MyColumn, 'paris', 'turkey')
WHERE MyColumn LIKE '%paris%'
"
7110,Check if record is referenced from another table,"SELECT c.CustomerID, c.Name, 
       (case when exists (select 1 from orders o where o.CustomerID = c.CustomerID)
             then 1 else 0
        end) as HasOrders
FROM Customers c;
"
7959,SQL unpivot & insert,"INSERT INTO TableB (UserID, Name, Value)
SELECT UserID, 'ClientUserID' AS Name, ClientUserID AS Value
FROM TableA
WHERE ClientUserID IS NOT NULL
UNION ALL
SELECT UserID, 'ClientSessionID' AS Name, ClientSessionID AS Value
FROM TableA
WHERE ClientSessionID IS NOT NULL
"
13889,Here is one possible way to find random rows in a table? Is there a better method?,"select TOP 30 *
from orders o inner join
     store s
     on o.Retailer_ID = s.ID
where s.Name='XXXX'
order by newid();
"
29378,TSQL Get Inserted Ids,"DECLARE @IDs table (ID int not null)
INSERT MyTable(col1, ....)
OUTPUT inserted.IdentityColumn INTO @IDs
SELECT p.i.value('@XmlAttribute', 'nvarchar(128)') FROM @myXml.nodes('/root/i') AS p(i)

SELECT * from @IDs
"
24851,SQL Query depending upon current time,"select * from @data
where value != 'First value'
and (value != 'Second value' OR NOT ( '2012-08-29 23:59:59' between '2012-08-30 23:59:59' and '2012-09-15 23:59:59'))
"
14221,Between clause from recordset,"SELECT  b.value1, b.value2, sum(a.Stat) 
FROM   table2 a
       JOIN table1 b
         ON a.value BETWEEN b.value1 AND b.value2 
 GROUP BY b.value1, b.value2
"
9943,How to replace the words with certain pattern in a file with sed?,"sed -i.bak 's/\<nchar *( *\([0-9]*\) *)/char(\1)/g' file.sql
"
10453,any one can simplify this mysql query,"SELECT Coalesce(sum(CASE WHEN type_id=2 THEN exp_amount END), 0) - Coalesce(sum(CASE WHEN type_id =1 THEN exp_amount END),0) AS balance
FROM expenses
WHERE account_id = 1
  AND type_id IN (1,2)
"
12269,SQL INNER JOIN and UNION,"select phoneID, make, ISNULL(colorID, 'your_default_value') FROM .....
LEFT JOIN ......
"
29295,Best practice for pagination in Oracle?,"SELECT * 
  FROM (SELECT *, rownum rn
          FROM (SELECT *
                  FROM your_table
                 ORDER BY col)
         WHERE rownum <= :Y)
 WHERE rn >= :X
"
4032,Computation inside select statement,"select col1, .... , 
      case col5 when 0 then ... 
                when 1 then ... , 
       col6, .... 
Where
   ...
"
25041,ORACLE - CHECK constraint enforcing conditional uniqueness,"CREATE UNIQUE INDEX idx_unique_program_name
    ON program( CASE WHEN program_number IS NULL
                     THEN program_name
                     ELSE NULL
                  END );
"
23663,pgsql time diffrence?,"select date_part('second',date1) - date_part('second',date2)
"
37258,How to prevent SQL from returning multiple resultsets,"CREATE TABLE #temporaryusers (Usertable fields here)
INSERT INTO #temporaryusers 
EXEC sp_two 

DROP TABLE #temporaryusers 
"
23289,How do I append data with Oracle's impdp?,"impdp hr/hr TABLES=employees DIRECTORY=dpump_dir1 DUMPFILE=expfull.dmp TABLE_EXISTS_ACTION=APPEND
"
32585, MongoDB shell's db.stats() in php and python,"
connection = pymongo.Connection(host = ""127.0.0.1"", port = 27017)
db = connection[""test_db""]
test_collection = db[""test_collection""]
db.command(""dbstats"") # prints database stats for ""test_db""
db.command(""collstats"", ""test_collection"") # prints collection-level stats for ""test_collection"" under ""test_db"".  
"
20880,Efficient way to query in SQL a table with relationships within that table who are also not in another table,"SELECT p.pid 
FROM people p,  activity a 
WHERE p.activityid = a.activityid 
AND p.active = 1 AND a.title = 'a' 
AND NOT EXISTS
( SELECT 1 FROM people pp, activity pa
  WHERE p.parentid = pp.id AND pp.activityid = pa.activityid
  AND pa.title NOT LIKE a.title||'%'
);
"
9872,Reproducing a nested not in statement through a join statement,"select p.productid, p.name
from production.product p
left join sales.salesorderdetail sod on sod.productid = p.productid
where sod.ProductID is null
order by p.productid;
"
11929,Select columns with and without group by,"select p.* from  Table1 as p inner join 
(SELECT ProductName, MIN(Price) AS minPrice    FROM Table1      GROUP BY ProductName) t 
on p.productname  = t.ProductName and p.price = t.minPrice    
"
36498,Conditional count over multiple tables,"select tablename, count(*)
from (select 'table1' as tablename, someid
      from table1
      union all
      select 'table2' as tablename, someid
      from table2
     ) t
where someid in ('1815972751', '1815751159', '1815752967', '1815756079')
group by tablename;
"
34382,Flattening a hierarchial data set in Oracle,"... beginning of your query ...
START WITH A.TREE_Name = 'MDA_GRN_KK'
connect by nocycle prior  A.TREE_NODE = A.PARENT_NODE_NAME
"
14217,SQL query to join several columns,"SELECT
    t.Desc, s1.Desc, s1.AAAAA, s2.Desc, s2.AAAAA, s3.Desc, s3.AAAA
    FROM Table2                t
        LEFT OUTER JOIN Source s1 ON t.ID1 = s1.ID
        LEFT OUTER JOIN Source s2 ON t.ID2 = s2.ID
        LEFT OUTER JOIN Source s3 ON t.ID3 = s2.ID
    WHERE t.ID=@YourIDHere
"
30007,SQL Server after update triggers on 2 tables,"SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
"
15792,Grand Totals with Rollup,"With CTE as (
--Insert Existing query without rollup here
)

Select * From CTE

Union All

Select 'Grand Total' as County
    , null as Year
    , SUM(Total) as Total
    , SUM(Q1) as Q1
    , SUM(Q2) as Q2
    , SUM(Q3) as Q3
    , SUM(Q4) as Q4

From CTE
"
1712,How to dynamically execute one of the query in a Union?,"SELECT per.PERSONAL_NUM as EMP_NUM,per.FIRST_NAME||' '||MIDDLE_NAME||' '||LAST_NAME AS NAME,per.EMPLOYEE_TYPE FROM PER_EMPLOYEE_MST per WHERE FIRST_NAME LIKE (:pname)||'%' AND :flag = 1

UNION ALL

SELECT dep.DEPUT_PERS_NUM as EMP_NUM,dep.FIRST_NAME||' '||MIDDLE_NAME||' '||LAST_NAME AS NAME,dep.EMPLOYEE_TYPE FROM PER_DEPUTATION_MST dep WHERE FIRST_NAME LIKE (:pname)||'%' AND :flag = 0

ORDER BY NAME
"
36427,how to print condition based values in column in mysql query,"SELECT name,
       IF (total_score < average_score, 'below average',
          IF(total_score > average_score, 'above average', 'average')) AS status
FROM (          
  SELECT name, 
         SUM(score) AS total_score, 
         (SELECT AVG(score) FROM mytable) AS average_score
  FROM mytable
  GROUP BY name ) AS t
"
39989,Update a column for all the rows,"UPDATE Employee
SET EMP_Name = REPLACE(Emp_name, 'xx\', '')
"
18811,MySQL COUNT() GROUP BY subquery(?) to count purchases on multiple items per month,"SELECT YEAR(purchase_date) as year, DATE_FORMAT(purchase_date, '%M') as month, COUNT(item_id) as cnt
FROM items_purchased
GROUP BY YEAR(purchase_date), MONTH(purchase_date)
ORDER BY year, month, cnt
"
26615,Multiple required value for a WHERE clause?,"SELECT c.name
FROM champions c
JOIN champs_to_roles ctr1 ON ctr1.ID_champ = c.id AND ctr1.ID_role = 1
JOIN champs_to_roles ctr2 ON ctr2.ID_champ = c.id AND ctr2.ID_role = 2
"
25654,SQL Query to find no of records created per day,"select trunc(created_date), count(*) as num_created
from the_table
group by trunc(created_date);
"
36914,insert on duplicate not saving,"UNIQUE KEY(name, user_id)
"
12687,SQL to select Top/Highest count when using Group By,"select comp_id, app_id, cnt
from (select t.*, row_number() over (partition by app_id order by cnt desc) as seqnum
      from (SELECT COMP_ID, APP_ID, count(*) as cnt
            FROM APP_ACCT_VIEW
            GROUP BY COMP_ID, APP_ID
           ) t
     ) t
where seqnum = 1
"
23356,how to concatenate values of a column if the other columns have the same value,"SELECT
    cc.contact_id,
    cc.name,
    GROUP_CONCAT(ct.name SEPARATOR ', ') AS contact_type
FROM
    contacts AS c
    LEFT JOIN contact_companies AS cc ON c.contact_id = cc.contact_id
    LEFT JOIN contacts_to_types AS ctt ON cc.contact_id = ctt.contact_id
    LEFT JOIN contact_types AS ct ON ctt.contact_type_id = ct.contact_type_id
WHERE
     cc.name LIKE '%p%'
GROUP BY cc.contact_id
ORDER BY name, contact_id
"
6230,Subtraction between two queries,"select * from b where 
not exists (select no from A where A.id=B.id and date=@yourdate)
"
30473,Get The Latest Data By DateTime and Name,"SELECT [a].[DateTime], [t].[Id], [a].[Name]
FROM (
    SELECT MAX([DateTime]) AS [DateTime], [Name]
    FROM [table]
    GROUP BY [Name]
) AS [a]
JOIN [table] AS [t]
ON [a].[DateTime] = [t].[DateTime]
AND [a].[Name] = [t].[Name]
"
6082,Id starting with 150. Data transfer between sql server & after that,"SET IDENTITY_INSERT [table name] ON
GO

INSERT INTO table (ID, Name) VALUES (1, 'value')
GO


SET IDENTITY_INSERT [table name] OFF
GO
"
22341,Display the number of days between system date and 1st January 2011,"SELECT DATEDIFF(DAY, '20110101', GETDATE())
"
39550,Using SELECT for simple BOOLEAN evaluation,"SELECT CASE WHEN 2 > 1 THEN 'True' ELSE 'False' END
"
29541,Can an oracle SQL query execute a string query selected from a table?,"FOR q IN (SELECT sql_text FROM query_table)
LOOP
  EXECUTE IMMEDIATE 'SELECT COUNT(*) FROM (' || q.sql_text || ')'
     INTO some_local_variable;
  <<do something with the local variable>>
END LOOP;
"
19675,Update a column in a table based on column in another table,"-- Update all type to A if [serviceid] and [userid] matches
UPDATE t2 SET t2.type = 'A'
FROM tbl2 t2
    INNER JOIN tbl1 t1
        ON t1.id = serviceid
        AND t2.userid = tbl1.userid;

-- Update all user if [serviceid] and [type] = A matches
UPDATE t2 SET t2.userid = tbl1.userid
FROM tbl2 t2
     INNER JOIN tbl1 t1
        ON t1.id = serviceid
WHERE t2.type = 'A'
"
29928,SQL to query drupal nodes with multiple taxonomies,"SELECT * FROM node 
INNER JOIN term_node AS tn ON node.vid = tn.vid 
LEFT JOIN content_type_extra_content AS xc ON node.vid = xc.vid 
WHERE tn.tid IN ('146','223')
GROUP BY node.vid
HAVING count(*) = 2
"
34916,SQL Order One Column By Value in Another,";with cte as (
   select *, cast([Item] as nvarchar(max)) as [path] from IndentedBOM where Depth = 0

   union all

   select i.*, c.[path] + '/' + i.[Item]
   from cte as c
       inner join IndentedBOM as i on i.[Assembly] = c.[Item]
)
select *
from cte
order by [path]
"
38480,"How to map data from a raw sql query to Model properties, in ASP.NET MVC?","public DbSet<art> arts { get; set; }
"
1267,MySQL: increment column value,"UPDATE <tablename> SET <fieldname>=<fieldname>+<additional-value> WHERE ...
"
715,SQL Get Delimited Results for All Columns,"SELECT * INTO OUTFILE 'filename'
FIELDS TERMINATED BY '|'
LINES TERMINATED BY '\n'
FROM yourtable;
"
28987,Filtering SQL results,"SELECT * from mytable WHERE `category` = '1' and id % 3 = 1 ORDER BY `id` 
DESC LIMIT 0 , 10
"
23442,Loading a CSV file with inconsistent spaces after commas,"LOAD DATA INFILE 'file.csv'
INTO TABLE t1 (column1, @col2, @col3, @col4)
SET
  column2 = TRIM(@col2),
  column3 = TRIM(@col3),
  column4 = TRIM(@col4)
"
24438,Using OleDb.OleDb??? vb code ExecuteReader: Connection property has not been initialized,"Dim conn As New OleDb.OleDbConnection
Dim dt As New DataTable
Dim readit As OleDb.OleDbDataReader
conn.ConnectionString = ""Provider=Microsoft.ACE.OLEDB.12.0;Data Source=N:\data\GameHQ.accdb""
conn.Open()
Dim cmd As New OleDb.OleDbCommand(""select * from <whatever you select from>"", conn)
readit = cmd.ExecuteReader()
readit.Read()
dt.Load(readit)
dgvInfo.DataSource = dt
dgvInfo.Refresh()
conn.Close()
"
21609,"In Mongodb, how do I add a field to every record?","db.foo.update({},{$set : { ""about.bio"" : """"}} , true, true);
"
14328,Special characters displaying incorrectly after BULK INSERT,"BULK INSERT dbo.temp FROM 'C:\Temp\file.csv' 
WITH (FIELDTERMINATOR = ',', ROWTERMINATOR = '\n', CODEPAGE = 'ACP');
"
37155,MYSQL query from different tables same ID,"select sum(voting_result1) as ""Total"" from #__ratings table 
where ID = 1 or 
ID in (select IDI from #__content table where IDI = 1)
"
27425,Setting two scalar variables in one SELECT statement?,"Declare @a int;
Declare @b int;

SELECT @a = StartNum, @b = EndNum 
FROM Users 
Where UserId = '1223'
"
24617,Not selecting duplicates from MySQL,"select distinct (player1)
from games
where player1 like 'pru%'
union
select distinct (player2)
from games
where player2 like 'pru%';
"
19470,Show rows that have values occur a certain number of times,"SELECT DISTINCT c.*, a.account_code FROM campaign c
JOIN account a ON c.account_id = a.account_id
WHERE c.account_id IN (
  SELECT account_id FROM campaign
  GROUP BY account_id
  HAVING count(*) >= 2
)
"
37691,SQL calculate difference between cell values,"SELECT 
  TableA.A1 - TableB.A1 AS A1,
  TableA.B1 - TableB.B1 AS B1
FROM TableA, TableB
"
22344,LEFT JOIN not returning NULL,"SELECT 
  qry_HersheySAPMaxDate2.ID, 
  qry_HersheySAPMaxDate2.item, 
"
36679,Searching for records based on time range using SQL,"where cast(ORDERDATE as time) between '16:30' and '17:00'
"
30266,Updating records that are exported using BCP utility,"bcp ""select * from `table` order by ID"" <other bcp params> -F @First -L @Last

WITH rows AS (
SELECT <columns to be updated>, ROW_NUMBER() OVER ( ORDER BY ID ) rn FROM `table`
)
UPDATE rows
SET <some indicator>
WHERE rn BETWEEN @First AND @Last
"
9533,Using GROUP BY aggregating SUM on a calculated column,"SELECT sub.RecDate, Sum(sub.AdjYield) AS SumOfAdjYield
FROM
    (
        SELECT RecDate, Weight * YTD / (SELECT SUM(Weight) From Records 
        WHERE Class1=t2.Class1 AND Class2 = t2.Class2) as AdjYield
        From Records as t2
        WHERE Class1=""fi"" AND Class2=""ra""
    ) AS sub
GROUP BY sub.RecDate;
"
15672,stored procedure pattern match," select a_val, b_val
   into vara_val, varb_val 
   from DATA_TABLE 
   where CALLNUM LIKE NumberPattern || '%';
"
22379,finding most common value across multiple tables,"select ip, count(*) from
(
select ip from bad_guys_1
union ALL
select ip from bad_guys_2
union ALL
select ip from bad_guys_3
union ALL
select ip from bad_guys_4
) as ranking
group by ip
order by count(*) DESC
"
3698,Reset IDs to logical order in SQL,"UPDATE mytable AS t1
JOIN (
   SELECT id, @rn := @rn + 1 AS rn   
   FROM mytable
   CROSS JOIN (SELECT @rn := 0) AS v
   ORDER BY id
) AS t2 ON t1.id = t2.id
SET t1.id = t2.rn;
"
32114,Redshift - Split column to find value between delimiter with uncertain position,"REGEXP_REPLACE(url, "".*[?&]fruit=([^&]*).*"", ""$1"");
"
11925,Delete Rows from pecific Table on Multi-table SELECT,"DELETE r
FROM   reviews r
       INNER JOIN items i ON i.item_id = r.item_id
       INNER JOIN master_cat c ON i.cat_id = c.cat_id
WHERE  category is null
"
10335,Query a string column,"SELECT *
FROM table
WHERE expected_salary >= 3000 AND is_competitive
"
30835,Duplicate data in table,"ALTER TABLE t_status
ADD CONSTRAINT T_Status_Unique_StudentId_LesId UNIQUE (student_id, les_id)
"
22717,"MySQL SELECT with join, count, order by","SELECT a.schedule_id, 
       COUNT(a.schedule_id) AS schedule_count, 
       MIN(a.startdate) AS earliest_startdate , 
       t.title
FROM tours_schedules a
JOIN tours t
ON a.tour_id = t.tour_id
GROUP BY t.tour_id
"
37871,SQL Server 2005 Using CHARINDEX() To split a string,"with t as (select 'LD-23DSP-1430' as val)
select t.*,
       LEFT(val, charindex('-', val) - 1),
   SUBSTRING(val, charindex('-', val)+1, len(val) - CHARINDEX('-', reverse(val)) - charindex('-', val)),
       REVERSE(LEFT(reverse(val), charindex('-', reverse(val)) - 1))
from t;
"
13835,pad database out with NULL criteria,"select i.id, s.date, t.type
from (select distinct id from sample) i cross join
     (select distinct type from sample) t left join
     sample s
     on s.id = i.id and
        s.type = t.type;
"
11234,Unique IDs based on First datetime,"select customer_id, min(FBPOINTSDTS) from [your table] group by customer_id;
"
17319,Limit number of occurances in output group-by sql query,"select 
    rep, companyname, [count], commission
from (
    select 
        rep, companyname,count(companyname) as [count], Commission,
        count(1) over (PARTITION by companyname) as [companycount]
    from customers
    group by repid,companyname,Commission
) sub
where companycount > 1
"
27501,MySQL CSV Row to multiple Rows,"for each (id, csv_foreign_keys) in source_rows do
    foreign_keys = split ',', csv_foreign_keys

    for each fk in foreign_keys do
        insert (id, fk) into many-to-many link table
"
11633,Inner queries on a single table,"select user_id
  from my_table
 where role_id in (13,15)
 group by user_id.
having count(distinct role_id) = 2
"
32990,Mysql substring string and attach chars such as ... to result command,"SELECT id ,
     CASE WHEN LENGTH(`subject`) >=100 then CONCAT(SUBSTR( `subject`, 1, 100 ),'...')
     ELSE `subject`
     END AS `subject`
FROM `contents`
"
2831,Need Multiple WITH statements in SQL UDF,"CREATE FUNCTION [dbo].[Func_PullFolderIdsForUser](@companyId [INT], @userId [INT])
    RETURNS @folders TABLE (
        [FolderID] [INT] NULL
    ) WITH SCHEMABINDING, EXECUTE AS SELF
    AS 
    BEGIN
    INSERT INTO @folders VALUES(1)
    RETURN
    END
"
1113,"How to copy, replace, and insert across all rows in the database","REPLACE( [ColumnName], ""SpecificValue"", ""ReplacementValue"" ) 
"
32697,Select First Row of Every Group in sql,"SELECT *
  FROM(SELECT workflowid, salesRepId, quantityAssigned,
              quantityLeft, month, year
              , ROW_NUMBER()
                OVER (PARTITION BY salesRepId
                          ORDER BY workflowid) AS rownumber
         FROM sm_salesRepWorkflow)
 WHERE rownumber = 1;
"
21921,Oracle Extract Value from CDATA,"regexp_substr(detail, '>([^<]+)<', 1, 1, '', 1)
"
32532,SQL UPDate same table,"SELECT LegacyFullPathNme
INTO newtable
FROM oldtable
GROUP BY LegacyFullPathNme;
"
34713,mysql: group surrounding records by same field value,"SELECT 
    type 
FROM(
    SELECT 
        type,
        if(@a = type, @b, @b := @b + 1) as grouping_col,
        @a := type
    FROM testing
    JOIN (select @a := 1, @b := 0) as temp
) as t
GROUP BY grouping_col;
"
8481,Convert this SQL approach into Oracle,"UPDATE Table1 SET ... WHERE Column1='SomeValue';
IF SQL%ROWCOUNT=0 THEN
    INSERT INTO Table1 VALUES (...);
END IF;
"
22367,"Find Rows Using Nested Count, Join, or Having","SELECT DISTINCT streetnum FROM atable AS a1,atable AS a2 WHERE a1.streetnum=a2.streenum AND a1.item IS NULL AND a2.item IS NOT NULL;
"
18578,SQL where customer_id in (xx),"-- this is creating the temporary table which would normally be created by a function.
DECLARE @Temp TABLE (Customer_id int)
INSERT INTO @Temp(Customer_id)
SELECT 1
INSERT INTO @Temp(Customer_id)
SELECT 2
INSERT INTO @Temp(Customer_id)
SELECT 3

-- now do the select statement.
SELECT 
    T.Customer_id,
     C.*
FROM
    Customers C
RIGHT OUTER JOIN
     @Temp T
ON
     T.Customer_id = C.Customer_id
"
27000,MySQL: Select Record If Every Search Criteria Is Found in One of the Child Records,"DECLARE p_Statement NVARCHAR(MAX)
SELECT p_Statement = 'SELECT id FROM hotels WHERE 1 = 1 '

for each p_catID in SelectedCatIds (loop) :
    SELECT p_Statement = p_Statement + 'AND id IN (SELECT hotel_id FROM hotel_category_infos WHERE cat_id = p_catID '
(end loop)

PREPARE stmt FROM p_Statement
EXECUTE stmt
"
12239,Update Linq database field depending on searched value - Password change,"    'initialise global variabel to take email string entered in text box
    GlobalVariables.SearchUserEmail = txtEmailAddress.Text

    'initialise global variable to hold email address retrieved from database
    Dim user = db.User_Signons.First(Function(u) u.Email = SearchUserEmail)
    GlobalVariables.CurrentEmailAddress = user.UserEmail

   'calls generatepassword method
    Dim stNewPassword As String = GeneratePassword()
    user.Password = stNewPassword
    db.SubmitChanges()
"
17912,Getting list of cities and countries from a SQL Table,"select distinct country, city
from <Table>
order by country, city;
"
20721,Mysql : Count Posts and Group by date,"  SELECT FROM_UNIXTIME(post_date, '%Y %D %M') AS POST_DATE,
         COUNT(post_id) AS POST_COUNT
    FROM posts
GROUP BY POST_DATE
"
10201,Is this the correct way to sort rows which have the same insert datetime?,"SELECT name, species, birth FROM pet
ORDER BY species, birth DESC
"
19921,"SQL select with """" netbeans without """"","  create table ""table1"" (id int not null);
  select * from table1 ;  -- ORA-00942: table or view does not exist
  select * from TABLE1;  -- ORA-00942: table or view does not exist
  select * from ""table1""; --ok

  ---------------------------- 
  create table table2 (id int not null); -- or TABLE2, or even ""TABLE2""
  select * from table2 ; -- ok
  select * from TABLE2;  --ok
  select * from ""TABLE2"";  --ok
"
14629,query taking long to execute,"DELETE e.*
FROM emaillikebusiness_2 AS e
JOIN per2 AS p
ON e.Email_id = p.BusinessEmail2
"
20691,What's the most efficient way to check the presence of a row in a table?,"SELECT COUNT(1) FROM mytable WHERE id = 5
"
7711,How can I get sets of 2 entries where each set starts with a different letter and no letter is repeated from a sqlite database?,"SELECT *
FROM YourTable a
WHERE wordField IN (SELECT wordField 
                    FROM YourTable AS b
                    WHERE substr(a.wordField ,1,1) = substr(b.wordField ,1,1)
                    ORDER BY wordField
                    LIMIT 2)
"
15164,mysql - Deleting Rows from InnoDB is very slow,"   DELETE FROM fuelinjection_stroke WHERE DBID < 1000000 LIMIT 10000;
"
4868,Select recent events with all activities listed SQL,"SELECT
  *
FROM
  event
INNER JOIN
(
  SELECT   eventName, Date
  FROM     events
  GROUP BY eventName, Date
  ORDER BY Date DESC
  LIMIT    20
)
  AS last_20_events
    ON  last_20_events.eventName = events.eventName
    AND last_20_events.Date      = events.Date
"
1511,Displaying values one above the other instead of in the same line which belong to the same row,"SELECT U.TeamID, TD.Team_Name
FROM Match_Schedule
UNPIVOT (TeamID FOR TeamName IN (HomeTeam, AwayTeam)) U
JOIN Team_Detail TD ON U.TeamID = TD.Serno
WHERE Match_Serno = 436
"
21419,How can I find if a column is auto_increment in mysql?,"select * from COLUMNS where  TABLE_SCHEMA='yourschema' and TABLE_NAME='yourtable' and EXTRA like '%auto_increment%'
"
11286,Copying set of records in Django,"obj = MyModel.objects.get(pk=1)
obj.pk = None
obj.save()
"
36522,Use query result as parameter to stored procedure in SSMS,"declare @myvar xml

select top 1 @myvar=your_xml_column from your_table where your_condition

exec spYourProc @xmlparam=@myvar
"
11451,MySQL having trouble sorting a query correctly,"SELECT ft.thread_id, ft.thread_title, fp.*, pmin.postcount
FROM forums_threads AS ft
JOIN (
      SELECT post_thread_id, MAX(post_date), COUNT(post_id) AS postcount
      FROM forums_posts
      GROUP BY post_thread_id
     ) AS pmin ON ft.thread_id=pmin.post_thread_id
JOIN forums_posts AS fp ON fp.post_thread_id=pmin.post_thread_id AND fp.post_date = pmin.post_date
WHERE ft.thread_forum_id=84
ORDER BY ft.thread_date DESC
"
19738,SAS: creating multiples files from multiple data sets,"%macro test();
%do i=1 %to 24;
  data file&i;
   set file&i;
    format date [dateformat];  /*replace with the format you want */ 

proc append base=unions data=file&i(where=(stock_symbol='Dell'));

data unions;
 set unions;
  stock_symbol='Goog';

%end;
%mend;

%test(); run;
"
6198,"Dividing date/time elements displayed from sql call, into sperate divs?","<div class=""example-date"">
    <span class=""day""><?php echo date('d', $row['ddtm_modified']); ?></span>
    <span class=""month""><?php echo date('F', $row['ddtm_modified']); ?></span>
    <span class=""year""><?php echo date('Y', $row['ddtm_modified']); ?></span>
</div>
"
13735,mysql join unrelated tables,"SELECT  w.id, w.name,
        (
        SELECT  GROUP_CONCAT(name ORDER BY name SEPARATOR ',')
        FROM    letters
        WHERE   lang = 'en'
        )
FROM    words
"
1038,Get the max values from list result,"WITH TT AS (
    SELECT ID, Name, Number, rank() OVER(PARTITION BY Name ORDER BY Number DESC) R
    FROM employee
)
SELECT ID, Name, Number
FROM TT
WHERE R = 1;
"
6679,"update column_B of specific row that ""xxx"" is present","UPDATE your_table
SET Update_Flag = 1            // this assumes the flag is an integer value
WHERE (column1 = ""xxx"")        // if it's a string do SET Update_Flag = ""True""
OR (column2 = ""xxx"")
OR (column3 = ""xxx"")
"
24645,Check if a column has a certain entry in a PL/SQL function,"FUNCTION my_func ()
RETURN BOOLEAN
IS
  l_contains_x NUMBER;
  l_contains_x_bool BOOLEAN := false;
BEGIN
  SELECT 1
  INTO l_contains_x
  FROM dual
  WHERE EXISTS (
    SELECT 1
    FROM table
    WHERE col = X
  );

  IF l_contains_x = 1 THEN 
    l_contains_x_bool := TRUE;
  END IF;

  RETURN l_contains_x_bool;

END;
"
32835,Pivot table Q - SQL Server 2008,"select 
    grouping
    ,num 
    ,det
    ,ply
    ,wth
from
(
  select grouping, num, total, source
  from #temp
) d
pivot 
(
  sum([TOTAL]) 
  for [SOURCE] in (det,ply,wth)
) x;
"
25931,fetch from function returning a ref cursor to record,"declare
  symbol_cursor  package_name.record_cursor;
  symbol_record  package_name.record_name;
begin
  symbol_cursor := package_name.function_name('argument');
  loop
    fetch symbol_cursor into symbol_record;
    exit when symbol_cursor%notfound;

    -- Do something with each record here, e.g.:
    dbms_output.put_line( symbol_record.field_a );

  end loop;

  CLOSE symbol_cursor;

end;
"
4041,SQL Server: GROUP BY datetime without ticks,"select convert(varchar(19), t.date, 120), count(*) as count
from table t
group by convert(varchar(19), t.date, 120) 
having count(*) = 1
order by convert(varchar(19), t.date, 120) 
"
16930,How do I summarize rows in an SQL table?,"SELECT EMP_NAME,
SUM(HOURS_WORKED) TOTAL_HOURS_WORKED
FROM EMPLOYEES
GROUP BY EMP_NAME
"
13646,"Select 1 row per order, but include order_line table?","CREATE FUNCTION [dbo].[GetCateogriesForOrder]
(
    @orderID int
)
RETURNS varchar(max)
AS
BEGIN
    declare @output varchar(max)
    select @output = COALESCE(@output + ', ', '') + cat_id
    from order_line
    where order_id = @orderID

    return @output
END

GO

SELECT order_ID, dbo. GetCateogriesForOrder(order_ID)
FROM order 

GO
"
6773,"SQL Server: expression in ""IN"" operator","SELECT ShopID, ShopName 
FROM Shops AS shopslist 
WHERE shopslist.ShopType in (SELECT ShopType FROM ShopClasses WHERE ShopClass = 2)
"
8916,Select all except some rows,"... WHERE NOT (model = 'Ford' AND color = 'yellow')
"
7100,Using a hard coded value and sub query in an IN clause,"SELECT *
  FROM Parent.Table
  WHERE Ref_Num In (SELECT Ref_Num
                      FROM Child.Table
                      WHERE Ref_Num ='234'
                    UNION
                      SELECT '4205' As Ref_Num
                        FROM SYSIBM.SYSDUMMY1)
    AND Asset_Type IN ('PUMPS','COLL')
"
29518,SELECT and UPDATE MySQL query,"UPDATE registration  
SET regnumber = concat('SHS', substr(regnumber, 4, 4))
where teacheremail='param';
"
24615,SQL where clause count for individual records,"select purchases.customer_name, purchases.product_name, COUNT(purchases.product_name) from purchases where customer_name ""Brian"" and product_name like 'Al% GROUP BY purchases.product_name, purchases.customer_name;
"
29855,SQL Select Query - Select rows in the table based on the latest values of column,"WITH 
CTE1
AS
(
    SELECT *,
        ROW_NUMBER() OVER(PARTITION BY tenant ORDER BY date desc) AS rn
    FROM yourTable
)
,CTE2
AS
(
  SELECT
    *
    ,rn - ROW_NUMBER() OVER (PARTITION BY tenant, area ORDER BY rn) AS rnk
  FROM CTE1
)
SELECT
  tenant
  ,area
  ,date
  ,sales
FROM CTE2
WHERE rnk = 0
ORDER BY tenant, date desc
"
39603,Help with SQL query - some magic needed,"SELECT a.ActivityID, a.Duration, a.BilledAt
FROM BilledTime a
LEFT JOIN BilledTime b on a.ActivityID = b.ActivityID AND b.BilledAt > a.BilledAt
WHERE b.ActivityID IS NULL
"
38208,delete records which are selected from select query on the same table,"delete from emp 
from  emp e
where exists (select * 
              from EMP 
              WHERE e.EMPNAME = EMPNAME
               AND  e.EMPSALARY = EMPSALARY 
               AND  <another Condition>)   --<-- Condition on which you want to delete rows
"
26998,SQL database averaging a value for distinct people,"SELECT AVG(Weight)
FROM
 (
   SELECT DISTINCT HouseHoldNumber, Weight -- maybe need to add TravelNumber or PersonNumber
   FROM tab
 ) AS dt
"
3952,How to join multiple tables in MySQL?,"SELECT DISTINCT concat(c.fname,"" "", c.lname) AS fullname, s.description
FROM customer c 
INNER JOIN orders o ON c.customer_num = o.customer_num
INNER JOIN items i ON o.order_num = i.order_num
INNER JOIN stock s on s.stock_num = i.stock_num
WHERE i.manu_code = 'ANZ'
"
20398,SQL: How can I order null and empty entries to the front in an orderby?,"ORDER BY 
    CASE 
    WHEN Name IS NULL THEN 1 
    WHEN Name = ''    THEN 2 
    ELSE 3 
    END DESC, 
    Name ASC
"
12958,Update table from large select query,"update extradata set line4 = 'TEST'
from extradata inner join @tmp T
on extradata.number = T.number
where extracode = 'L3'
"
7819,T-SQL: Include a row count as a column for unique rows,"SELECT Col1, Col2, Col3, COUNT(*) AS Total
FROM TableA
GROUP BY Col1, Col2, Col3
"
14139,SQL SELECT statement MAX date and table joins,"select ct.clientID, ct.clientName,max(nt.noteDate) latestNoteDate
from ClientTable  ct
left outer join NotesTable nt
on ct.clientID = nt.clientID 
group by ct.clientID, ct.clientName
"
8941,Select between dates and with initial values,"SELECT * FROM SomeTable a
JOIN (
    SELECT fk_b, MAX(timestamp) as latest
    FROM SomeTable
    GROUP BY fk_b
) b
ON a.id = b.id
WHERE a.fk_a = @someIdA
"
1477,SQL: Find highest number if its in nvarchar format containing special characters,"SELECT MAX(CAST(REPLACE(Column2, '.', '') as INT)) FROM table
"
20798,MySQL - on duplicate key - CASE WHEN THEN ELSE doesnt work,"INSERT INTO TableName (uid,A,B) 
VALUES (uid,A[2],B[2]) 
ON DUPLICATE KEY 
UPDATE  A= (IF(B=B[2],A,A[2])), 
        B= B[2]+1;
"
9875,Oracle newly created user privileges issue?,"select * from dba_sys_privs where grantee='JOHN';

select * from dba_tab_privs where grantee='JOHN';

select * from dba_role_privs where grantee='JOHN';
"
17718,Select statement in WHERE clause,"SELECT worktype
FROM (database)
WHERE (completed >= '2014-07-01') or
      (worktype = 'word' and completed = '0000-00-00');
"
29909,Finding a Named column present in a table,"SELECT DISTINCT TABLE_NAME, COLUMN_NAME
FROM INFORMATION_SCHEMA.COLUMNS
WHERE COLUMN_NAME = 'Name of column';
"
11786,How to draw a MongoDB diagram,"collection
`-- _id
`-- field1
`-- field2
    `-- f1
    `-- f2
`-- field3
"
14934,MYSQL Query Joining Tables,"SELECT DISTINCT LEFT(posts.post_title,1) AS first_letter 
FROM $wpdb->posts AS posts 
    INNER JOIN $wpdb->postmeta AS meta
        ON posts.ID = meta.post_id
WHERE posts.post_type = '$post_type' 
    AND posts.post_status = 'publish'
    AND meta.meta_key = 'spin2'
    AND meta.meta_value = 'Male'
ORDER BY first_letter ASC
"
19943,Returning Autogenerated Column value,"INSERT INTO YourTable(col1, col2) VALUES ""abc"", ""xyz"";

SELECT SCOPE_IDENTITY();
"
11406,SQL query efficiency,"select 
sum(Case when a.p_type = 'sell' then a.unit else null end) as sellUnit, 
sum(Case when a.p_type = 'CancelSell' then a.unit else null end) as CancelSellUnit,
sum(Case when a.p_type = 'Bank' then a.unit else null end) as BankUnit ,
sum(Case when a.p_type = 'CancelBank' then a.unit else null end) as CancelBankUnit  
from table1 a where and a.id=1 and a.fid=2 
"
12152,SQL: how do I find if the contents of a varchar column are numeric?,"CREATE OR REPLACE FUNCTION isnumeric(p_string in varchar2)
RETURN BOOLEAN
AS
    l_number number;
BEGIN
    l_number := p_string;
    RETURN TRUE;
EXCEPTION
    WHEN OTHERS THEN
        RETURN FALSE;
END;
/
"
25917,Oracle give more priority to like %term than %term%,"select city_desc from mst_city where upper(city_desc) like '%BRANCH%'
order by case when upper(city_desc) like 'BRANCH%' then 1 else 2 end
"
22279,Selecting by two fields in UNION ALL and ordering between rows,"SELECT DISTINCT c.* FROM categories c, categories p
WHERE c.status<>0 and (c.parent_id = 0 OR (c.parent_id=p.id and p.parent_id=0))
ORDER BY c.id,c.position
"
34240,How to design a database schema for an approval system,"select *
from users u
join sportClub sc on u.ClubId = sc.ClubId and 
                 (u.NumberApproved > 3 or u.NumberApproved = 
                 (select Count(*) from users us where us.Name <> ""Name Variable""))
where u.Name = ""Name Variable""
"
39748,SQL: How to exclude maximum if another column doesn't match,"select * from t where enrolldate=
(select max(enrolldate) from t as t1
  where t.id=t1.id)
  and t.code='WHEAT'
"
29910,Mysql advanced statement,"SELECT * FROM dbcasino_db22.tb_content
WHERE content_real_folder = 'foldername/' AND content_no < 5099
ORDER BY content_no DESC
LIMIT 1
"
8975,SQL FOR XML Help,"SELECT t.column1 AS ""@Name"",
       t.column2 AS Subcategory
  FROM TABLE t
FOR XML PATH ('Category')
"
24017,SQL query not providing range for nvarchar,"CAST(REPLACE(CubeNumber,'AA-','') as INT) BETWEEN 1 AND 20;
"
38837,Using Multiple ANDs and ORs in ANSI SQL,"SELECT
    w.fizz
FROM
    widgets w
WHERE
    w.special_id = 2394
    AND
    (
        (
            w.buzz != null
            AND w.foo = 12
        )
        OR
        (
            w.blah = 'YES'
            AND w.num = 4
        )
    )
"
32599,Looping on a Select query result set element and get the elements in MySQL,"...
DECLARE cur_orgs CURSOR FOR
           SELECT DISTINCT organization_id FROM tbl_organization;  
...

OPEN cur_orgs;
...

Reading_Orgs: LOOP
    FETCH cur_orgs INTO _org_id;
    ... 
    IF done THEN
      LEAVE Reading_Orgs;
    END IF;

    IF ... THEN
      ...
    ELSE
      ...
    END IF;
END LOOP;

CLOSE cur_orgs;

...
...
"
21088,TSQL query to filter configuration dates list,"select * from ConfigurationDate
where Year > 2012 OR ( Year = 2012 AND Month >= 9 )
Order By Year,Month ASC
"
32565,SQL Programming DateDiff,"CEILING(DATEDIFF(MONTH, DATE1, DATE2) / 12.0) as Total
"
3928,Group by week day,"SELECT  WEEK(FROM_UNIXTIME(time)) WeekNo,
        DATE_FORMAT(FROM_UNIXTIME(time),'%a') WeekName,
        COUNT(DISTINCT(session_id)) 
FROM    T 
GROUP   BY WEEK(FROM_UNIXTIME(time)),
           DATE_FORMAT(FROM_UNIXTIME(time),'%a')
"
18632,Merge and replace table id with string of two table SQL,"select b.id, 
       (select a.text from tableA a where a.id = b.title) as title, 
       (select a.text from tableA a where a.id = b.teme) as teme, 
       year, 
       (select a.text from tableA a where a.id = b.ed) as ed, 
       (select a.text from tableA a where a.id = b.cont) as cont
from tableB b
where b.id = 8
"
34329,return single value of first row when query return more than one row,"SELECT `ID` FROM tabel WHERE quiz_id = '$ID ORDER BY `ID` LIMIT 1
"
14757,Upgrading a varchar column to enum type in postgresql,"alter table foo 
  ALTER COLUMN varcharColumn TYPE enum_type using varcharColumn::enum_type;
"
15446,Mysql Join tables with condition,"select * from post 
left join comment
on post.id = comment.post_id
AND comment.user_id=1
"
38236,SQL Query for records with ONLY one condition,"select ISISProductCode 
from dbo.Product
join dbo.Item on dbo.Item.ISISStyleId = dbo.Product.ISISStyleId
group by ISISProductCode 
having sum(case when ISISMediaId <> '10' then 1 else 0 end) = 0
order by ISISProductCode
"
16370,Search sort by parameter match count in the query? PostgreSQL,"ORDER BY
    CASE WHEN color = 'Blue' THEN 1 ELSE 0 END +
    CASE WHEN type = '4-door' THEN 1 ELSE 0 END +
    CASE WHEN engine = 'V8' THEN 1 ELSE 0 END DESC
"
6193,group concat 2 values when clause would return only 1,"selec customer_id, text from
(SELECT customer_id, GROUP_CONCAT(text,' ') as text, sum(i) as total FROM table
WHERE i = 1
GROUP BY customer_id) T
where total > 0
"
1915,SQL sum hits per day and calculate percentage change,"select DATE(v.date), count(v.id_update) a, q2.b, count(v.id_update) - q2.b/count(v.id_update)*100 as Percentage
from vas_updates v
Left Join (select DATE_ADD(date, INTERVAL 1 DAY) d2, count(id_update) as b 
           from vas_updates group by d2) as q2
ON v.date = q2.d2
group by DATE(v.date)
"
7803,MySQL Sub select multiple condition,"SELECT USR_USERNAME AS 'User Name'
  ,COUNT(AD.app_uid) AS 'Total'
  ,SUM(case when AD.TAS_UID = '23423423455' then 1 else 0 end) as 'Total for Task A'
FROM APP_DELEGATION AS AD
  JOIN USERS AS U 
  ON AD.USR_UID = U.USR_UID
WHERE AD.DEL_THREAD_STATUS = 'Closed'
GROUP BY AD.USR_USERNAME
"
15148,"Sub query issue, SQL Server 2008","select count(*) from 
( select id, totalcharges from tblVisits where (totalcharges <10000)) t
"
29747,Security against select expressions in SQL,"DENY SELECT ON OBJECT::dbo.table2(salary) TO [user/role];
"
36397,3 boolean fiels or 1 field with 3 values - Relational Model DB,"-- UserType table
-- UserTypeID INT -- PK
-- Type NVARCHAR(50)
"
39682,IF function in Oracle to insert data into tables,"insert into t (col_came, col_sex) values (string_value, 
                                case when string_value like '%a' then 'F' else 'M' end);
"
35718,How can I query a value in SQL Server TEXT column that contains XML (not xml column type),";WITH cte AS (
  SELECT DocumentID, UserID, CAST(Content AS XML) AS XMLContent
  FROM Documents
)

SELECT XMLContent.query('/IDMSDocument/DocumentContent/Attribute[5]/Value/Value') 
FROM cte
WHERE XMLContent.value('(/IDMSDocument/DocumentContent/Attribute[5]/Value/Value)[1]', 'nvarchar(max)') like '%search%'
"
28188,SQL query time series data to find trend counts for user activity,"WITH actions(action) AS(
  VALUES ('X'),('Y'),('Z'))
SELECT d.action
       ,Count(DISTINCT a.userid)
FROM table1 as a
  LEFT JOIN table1 AS b
    ON a.userid = b.userid AND b.action = 'Y' AND a.timestamp < b.timestamp
  LEFT JOIN table1 AS c
    ON a.userid = c.userid AND c.action = 'Z' AND b.timestamp < c.timestamp
  JOIN actions AS d
    ON d.action IN (a.action, b.action, c.action)
WHERE a.action = 'X'
GROUP BY d.action
"
18653,SQL query to get rows with maximum of some column,"select vehicleID, max(vehicleSpeed) from vehicleData group by vehicleID
"
38871,How to do a conditional where clause with where in PL/SQL within Procedure,"SELECT *
FROM TABLE1
WHERE (CASE WHEN variable IS NULL AND column IS NULL THEN 1
            WHEN variable LIKE '%' AND column LIKE variable||'%' THEN 1
            ELSE 0
       END) = 1
AND...
"
16858,SQL Server 2008 Find the min date,"SELECT MIN([date]) 
FROM [DAY] 
WHERE instruction = '-1' 
  AND grade = '14' 
GROUP BY calendarID
       , structureID
"
37223,MySQL: Query to convert a key-value table into a human-readable one?,"SELECT DISTINCT entry_num,(SELECT VALUE FROM your_tab t2 WHERE t2.entry_num = t1.entry_num
AND t2.field_num = 1)  AS email,
(SELECT VALUE FROM your_tab t2 WHERE t2.entry_num = t1.entry_num AND t2.field_num = 2)  AS age,
(SELECT VALUE FROM your_tab t2 WHERE t2.entry_num = t1.entry_num AND t2.field_num = 3) as color
 FROM your_tab t1
"
2057,Using a mysql alias in the same sql statement,"SELECT substring_index(userBody, ' ', 60) as body, SUM(LENGTH(substring_index(userBody, ' ', 60))-LENGTH(REPLACE(substring_index(userBody, ' ', 60),' ',''))+1) as wordCount from articles where artcId = 10;
"
5165,Find Groups that don't contain all records,"SELECT DISTINCT b1.GroupID
FROM @B b1
WHERE EXISTS (
  SELECT 1 
  FROM @A a
  WHERE NOT EXISTS (
    SELECT 1
    FROM @B b2
    WHERE b1.GroupID = b2.GroupID
    AND b2.ID = a.ID
  )
);
"
34824,"Can you define ""literal"" tables in SQL?","SELECT a, b, c, d
FROM (
    SELECT 1 AS a, 2 AS b, 3 AS c, 4 AS d
    UNION ALL 
    SELECT 5 , 6, 7, 8
) AS temp;
"
32174,Having trouble with joining tables in query,"SELECT * FROM 
Question q INNER JOIN Answer a ON q.QuestionID = a.QuestionID
INNER JOIN Option_Table ot ON ot.optionID = q.optionID
INNER JOIN session s ON s.sessionid = q.sessionid
"
38444,SQL for selecting only the last item from a versioned table,"SELECT distinct on (parent_id) 
    parent_id
  , version_id
FROM items
ORDER BY parent_id, version_id DESC
"
16345,Count distinct rows via a pair of known values,"SELECT 
    ms.master_content_id,
    (SELECT COUNT(DISTINCT f.user_id) FROM flagged f WHERE
                      f.content_id = ms.slave_content_id OR
                      f.content_id = ms.master_content_id)
FROM
    master_slave ms
"
28861,stored procedure insert into select,"    begin
        for rec in (select col1, col2 from test)
        loop
            stored_procedure(rec.col1, rec.col2);
        end loop;
    end;
    /   
"
19168,concatenate values from two columns and compare it against one value in sqlite,"SELECT name FROM CONTACT_LIST 
WHERE mblDc || mbl = ""+8801617634317"";
"
13438,How to execute an Oracle stored procedure via a database link,"EXEC mySchema.myPackage.myProcedure@myRemoteDB( 'someParameter' );
"
18151,MySQL function which takes a set of strings?,"SELECT * FROM myTbl WHERE name IN ('bob', 'jane', 'sally')
"
17238,SQL LOOP INSERT Based on List of ID's,"declare @IDList table (ID int)

insert into @IDList
SELECT id
FROM table1
WHERE idType = 1

declare @i int
select @i = min(ID) from @IDList
while @i is not null
begin
  INSERT INTO table2(col1,col2,col3) 
  SELECT col1, col2, col3
  FROM table1
  WHERE col1 = @i AND idType = 1

  select @i = min(ID) from @IDList where ID > @i
end
"
2674,Numbering table columns,"update C
set OrderView = case
                  when Country = 'United States' then 1
                  when Country > 'United States' then rn
                  else rn + 1
                end
from (
      select OrderView,
             Country,
             row_number() over(order by Country) rn
      from YourTable
     ) as C
"
24378,How to select duplicate columns data from table,"WITH CTE AS
(
    SELECT col1, col2, col3, col4, cnt = COUNT(*) OVER (PARTITION BY col2, col3, col4)
    FROM dbo.TableName t
)
SELECT col1, col2, col3, col4
FROM CTE WHERE cnt > 1
"
35685,mysql query to run query after grouping rows based on product_id,"SELECT DISTINCT product_id
FROM oc_product_attribute t1 
WHERE EXISTS(SELECT * FROM oc_product_attribute t2 
  WHERE t1.product_id=t2.product_id
  AND attribute_id = 26 AND CAST(text AS UNSIGNED) >= '1'
) 
AND EXISTS (SELECT * FROM oc_product_attribute t3
  WHERE t1.product_id=t3.product_id
AND attribute_id = 29 AND text = 'Flange')
"
24005,Archive Parent / Child Table Hierarchy in MySQL,"START TRANSACTION;

INSERT Child_Archive 
SELECT DISTINCT 
Child.* FROM Child, Parent
WHERE Child.FK = Parent.PK
  AND Parent.something=11; 

DELETE Child WHERE FK IN (
    SELECT DISTINCT PK FROM Parent WHERE Parent.something=11); 

INSERT Parent_Archive
SELECT DISTINCT * FROM Parent WHERE Parent.something=11;

DELETE Parent WHERE Parent.something=11;

COMMIT;
"
33404,SQL Query with Sum and Group By,"SELECT Field1, SUM(Field2) as Field2
FROM Mytable
GROUP BY Field1
"
32749,ORACLE SQL Developer (Query),"SELECT AVG(NO_OF_SEATS) ""WEEKLY AVERAGE"", TRUNC(TRAVEL_DATE,'IW')
FROM RESER
GROUP BY TRUNC(TRAVEL_DATE,'IW');
"
10513,Use alias name in same query for SQL Server,"SELECT 
a.QUANTITY,
a.AMOUNT,
SUM(a.CntAmount) AS SUM_CNTAMOUNT
FROM (SELECT 
      QUANTITY, 
      AMOUNT, 
      Count(AMOUNT) AS CntAmount
      FROM   MY_TEST 
      GROUP  BY QUANTITY,  AMOUNT) AS a
GROUP BY a.QUANTITY, a.AMOUNT
"
20909,"Get ""non-existing"" values from database","SELECT
  pfc.ContentID as PFC_ContentID,
  pfc.Content as PFC_FieldContent,
  pfc.FieldID as PFC_FieldID
FROM pages p
LEFT JOIN pagefields pf
  ON p.PageID = pf.PageID
LEFT JOIN fields ptf
  ON pf.FieldID = ptf.FieldID
LEFT JOIN pagesfieldcontents pfc
  ON p.PageID = pfc.PageID
  AND pf.FieldID = pfc.FieldID
WHERE some where-statement
ORDER BY somefield desc
"
1653,Crystal Report Record Filtering 3 different ways per record CR10,"If (isnull({Command.owner}) or {Command.owner?} = ""N"") and not isnull({Command.setup} and {Command.Owner?} <> ""Y"") then {Command.setup} = ""B""
Else if {Command.Owner?} = ""Y"" Then {Command.owner} = ""B""
Else {Command.unit} = ""B""
"
31841,SQL Statement for gouping messages,"SELECT receiver AS id, msg
FROM user_messages outerTable
WHERE NOT EXISTS
  ( SELECT * 
    FROM user_messages innerTable
    WHERE innerTable.sender = outerTable.sender
      AND innerTable.receiver = outerTable.receiver
      AND innerTable.added > outerTable.added
  )
  AND sender = 1
"
30798,Group all the fields in one row,"SELECT
  GROUP_CONCAT(id_count SEPARATOR ', ')
FROM
  (SELECT CONCAT('id(', id, ') = ', count(type)) id_count FROM T GROUP BY id) data
"
33452,How do I remove all tables and not the schema in Postgresql?,"select 'drop table if exists ""' || tablename || '"" cascade;' 
  from pg_tables
 where schemaname = 'jason'; 
"
3659,Stratified Sampling based on a column category in postgres,"select *
from (
    (select *
    from observations
    where category = 'C'
    order by random()
    limit 243369* 0.1)
    union
    (select *
    from observations
    where category <> 'C')
    ) sub
order by random()
limit 1;
"
9395,"Return rows around my selection args (""surrounding rows"") in a database query","SELECT *
FROM myTable LIMIT 2
OFFSET
  (SELECT _id
   FROM myTable
   WHERE time<=1332200003002
   ORDER BY time DESC LIMIT 1) - 1;
"
7207,How to group duplicate records and then update all members except lowest id for each group?,"update temp1 set publish=0 where id in (select x.id from (select a.id from temp1 a ,temp1 b 
where
a.id<>b.id and (a.name=b.name or a.description=b.description)and a.id>b.id 
group by a.id) as x); 
"
22155,"SQL - remove duplicate tuples, even if values are out of order","select distinct least(name_1, name_2) name_1,
       greatest(name_1, name_2) name_2,
       value
from yourtable
"
38028,GROUP BY characteristic in mysql,"SELECT t.* FROM (
select * from billing_billingmatrix 
where (provider_id=24 
or provider_id is null) 
and (service_id=25 or service_id is null)
ORDER BY service_id DESC
  ) t GROUP BY t.definition_id 
"
36897,SQL Server - Return value after INSERT,"INSERT INTO table (name)
OUTPUT Inserted.ID
VALUES('bob');
"
3499,EXEC to USE Database,"set @sql = 'use ' + quotename(@new_db_name) + '; disable trigger t1;'
exec (@sql)
"
14698,How to use an aggregate function over all groups in SQL?,"SELECT SUM(field_to_sum) / total_sum
FROM your_table t
CROSS JOIN (
    SELECT SUM(field_to_sum) total_sum
    FROM your_table
) d
GROUP BY t.field_to_group
"
1429,How to keep the value of a dropdown selected after post (razor),"<select class=""form-dropdown"" style=""width:130px"" id=""formAssigned_To"" name=""formAssigned_To""> 
 <option selected =""""></option>
 <option selected=""@(Request[""formAssigned_To""] == ""Not Assigned"")"" value=""Not Assigned"">Not Assigned</option>
@{foreach(var row in db.Query(""SELECT DISTINCT Name FROM Admins"")){    
 <option selected=""@(Request[""formAssigned_To""] == row.Name)"" value=""@row.Name"">@row.Name</option>
  }
  }
</select>
"
21087,OrientDB - Result from 2 different tables,"SELECT in.*,out.*,Day 
FROM (SELECT expand(both('Friend').outE('isGoing')[Day = 29]) 
      FROM #12:0)
"
10276,How do I grab a column from table B if it that column may or may not be there?,"SELECT  a.*, b.city
FROM    tableA a
        LEFT JOIN tableB  b
            ON a.ID = b.ID
"
36436,SQL Pivot table,"CASE WHEN t.AttributeID = 10 THEN t.EntityValue ELSE NULL END 'FirstName'
"
11539,Query Optimization to check if column is up to date in entire database in MySQL,"SELECT COUNT(a.column1) FROM table1 a
INNER JOIN table2 b ON a.column1 = c.column3
WHERE a.max_age <> -1
AND a.max_age = (2013 - c.birth_year)
"
22946,Vertical Join in an SQL Statement,"select *, (ro.FirstName + ' ' + LastName) as ReportingName
from Leaves inner join LeaveDetails on Leaves.LeaveId= LeaveDetails.LeaveId 
inner join Employee on Leaves.EmployeeCode =  Employee.EmployeeCode
inner join LeaveType on Leaves.LeaveTypeId= LeaveType.LeaveTypeId 
inner join LeaveStatus on Leaves.StatusId = LeaveStatus.StatusId 
inner join Employee_organizationaldetails on Employee_organizationaldetails.EmployeeCode=Employee.EmployeeCode  left outer join
Employee ro
on ro.EmployeeCode = ReportingTo
where Leaves.LeaveId = 7295;
"
34353,Comparing version string in sql,"SELECT *
FROM app
where version < '1.1.125';
SELECT *
FROM app
where version < '1.1.145';
"
4920,"T-SQL: test condition if match other table, otherwise include without test","Select myTable1.myKey1, myTable1.myDate1
    FROM 
(SELECT myKey2, myDate2 FROM myTable2) as myDatesQuery
left outer join myTable1 
        on myTable1.myKey1 = myDatesQuery.myKey2
        where myTable1.myKey1 is null or myTable1.myDate1< myDatesQuery.MyDate2
"
976,PostgreSQL database - only insert if the record doesn't exist,"insert into company (unique_id, company_name)
select 42, 'New Company Name'
from company
where not exists (select 1 from company where unique_id = 42);
"
2595,SQL Group By where no row has value,"SELECT ID
FROM table
GROUP BY ID
HAVING MAX(CreatedDate) <= '2012-01-01'
"
6304,Building SQL query in XML with a CDATA select," select REPLACE ( column_name, '""', '&quot;' ) from table_name
"
26091,Get sql data group by month and category as column,"select
    month
  , coalesce(cat1,0) as cat1
  , coalesce(cat2,0) as cat2
  , coalesce(cat3,0) as cat3
  , coalesce(cat4,0) as cat4
from tbl
pivot(sum(amt) for category in ([cat1], [cat2], [cat3], [cat4])) p
"
22771,SQL (Sqlite) GROUP BY and COUNT,"select album, avg(rating) AS avgRating
from file 
group by album 
having sum(case when rating > 0 then 1 end)*1.0 / count(*) > 0.5
order by avgRating DESC
"
2356,using IN and comma in a CASE WHEN THEN ELSE,"and 
(
    @country ='NO' and n.stdnote_code in ('81','82','84','85','86','90','91')
    OR 
    @country<>'NO' and n.stdnote_code in ('86','87')
)
"
35239,How to get current GMT in Oracle,"SELECT systimestamp AT TIME ZONE 'GMT'
  FROM dual
"
1892,self join on huge table,"SELECT 
  A.dateField, B.dateField, A.curStatus, B.curStatus, A.prevStatus, B.prevStatus 
FROM 
  table1 A
CROSS APPLY
(
-- consider using
--  SELECT top 1 dateField, curStatus, prevStatus 
-- if you only want 1 row for each match
SELECT dateField, curStatus, prevStatus 
FROM table1
WHERE 
  dateField BETWEEN a.dateField and dateadd(d, 2, a.dateField) AND 
  curStatus = 0 and prevStatus = 27
-- in case you just want 1 row
-- ORDER BY datefield --(or whatever you want to order by)
) B
WHERE A.curStatus = 27 and A.prevStatus = 0
"
27684,Find out the list of recently run stored procs with start and end times,"SELECT DatabaseName = DB_NAME(st.dbid)
    , SchemaName = OBJECT_SCHEMA_NAME(st.objectid, dbid)
    , StoredProcedure = OBJECT_NAME(st.objectid, dbid)
    , cp.last_execution_Time
FROM sys.dm_exec_query_stats cp
CROSS APPLY sys.dm_exec_sql_text(cp.plan_handle) st
WHERE DB_NAME(st.dbid) IS NOT NULL
    AND cp.last_execution_Time >= '2014-02-19 10:14:45.590'
"
24152,what is the best SQL for this scenario,"select
  Team,
  Region,
  count(distinct Person)
from mytable
group by 1,2
"
6447,MySql query : Show Columns as Rows from 1 table,"select
p.ProjectID,e.EmployeeID,e.Username 
from Project p 
join Employee e on e.EmployeeID = p.Project_ManagerID

union all

select
p.ProjectID,e.EmployeeID,e.Username 
from Project p 
join Employee e on e.EmployeeID = p.EmployeeID
"
14117,Finding the largest group of consecutive numbers within a partition,"select player_id, runs, count(*) as numruns
from (select p.*,
             (row_number() over (partition by player_id order by match_date) -
              row_number() over (partition by player_id, runs order by match_date)
             ) as grp
      from players p
     ) pg
group by grp, player_id, runs
order by numruns desc
limit 1;
"
28761,count(*) on three tables,"SELECT  S.Statename, 
        COUNT(DISTINCT C.dict_id) district_count,
        COUNT(DISTINCT C.city_id) city_count
FROM City C
INNER JOIN District D
    ON C.dict_id = D.dict_id
INNER JOIN State S
    ON S.stateid = D.stateid
GROUP BY S.Statename
"
28388,Value of id corresponding to max value of another column,"select 
    staff_id as id,
    totalrentaltranscations
from a_table
order by 2 desc
limit 1;
"
35100,Parallelism in PL/SQL,"EXAMPLE
CREATE OR REPLACE PROCEDURE target_deletion
IS
   number_of_the_job   NUMBER;
BEGIN
   DBMS_JOB.submit (number_of_the_job, 'begin stored_procedure_for_deletion; end;', SYSDATE);
END;
/
"
7102,Sum multiple columns based on criteria from other columns - SQL Teradata,"SELECT County, SUM(Score) AS TotalScore
FROM (                   
  SELECT County1 AS County, Player1_Score AS Score
  FROM mytable

  UNION ALL

  SELECT County2, Player2_Score
  FROM mytable) AS t
GROUP BY County
ORDER BY TotalScore DESC
"
22676,"Break this simple SQL/HQL Query down - DATEADD, DATEDIFF?",".. CAST((GETDATE() - 84) AS DATE)
.. CAST(DATEADD(day, -84, GETDATE()) as DATE)
"
11714,Display part of entry,"Select left(yourcolumn, charindex(' ',yourcolumn)) ...
"
14886,How do I do a SQL BETWEEN where the date and time are stored seperatly as integers,"SELECT * FROM transactions
WHERE (txnDate > @minDate AND txnDate < @maxDate)
   OR (txnDate = @minDate AND txnTime >= @minTime)
   OR (txnDate = @maxDate AND txnTime <= @maxTime)
"
15604,Move duplicate values to another column,"INSERT INTO new_table
SELECT t1.id_image, t1.score, t1.stddev, t2.id_image,
  t2.score, t2.stddev, t1.id_location
FROM old_table t1
JOIN old_table t2
ON t2.id_location = t1.id_location
  AND t2.id_image < t1.id_image
"
32923,Oracle: how to flash back a specific column?,"update t t1 
  set b = (select b from (select a, b from t as of scn 1201789714628) t2
           where t1.a = t2.a);
"
30030,Queries within queries counting rows to make a score based on categories chosen,"SELECT    master.id
,         SUM(IF(s.category='1',1,0))   cat1
,         SUM(IF(s.category='2',1,0))   cat2
,         SUM(1)                        total
FROM      master m
LEFT JOIN scores s
ON        m.id = s.id
GROUP BY  master.id
"
3579,Using DateDiff() in Oracle,"CREATE OR REPLACE FUNCTION dateDiff( p_dt1 IN DATE,
                                     p_dt2 IN DATE )
  RETURN NUMBER
IS
BEGIN
  RETURN p_dt1 - p_dt2;
END;
"
18615,How to determine if a date range overlaps any part of a specific month?,"select * 
from EA_Engagements 
where StartDate <= '1999-11-30' 
  and EndDate   >= '1999-11-01'
"
34346,Escaping a single quote in Oracle regex query,"select * 
  from dm_name 
  WHERE regexp_like(last_name, '([^A-Za-z ''-])');
"
12462,MySQL UPDATE WHERE IN for each listed value separately?,"UPDATE car
SET photo_count = photo_count + (
    SELECT count(*)
    FROM photos
    WHERE photo.car_id = car.car_id
    AND photo_status = 0
    AND photo_id IN ($ids)
);

UPDATE photo
SET photo_status = 1
WHERE photo_id IN ($ids);
"
37724,How to write any UDF getting value according any index gap?,"create function GetValueUDF
(
  @string varchar(max), 
  @startPosition int,
  @length int
)
returns varchar(max)
as

begin
  return substring(@string, @startPosition, @length)
end
"
17545,GROUP BY the CASE statement output,"SELECT YR, qtr, code,max(qtr_pct)  aa
FROM (
SELECT YR, qtr, code, pctref,  CASE WHEN pctref >= 85 THEN round(avg(pctref) over (partition BY YEAR, qtr, code))
  ELSE NULL END qtr_pct
FROM ANOTHER_VIEW) t
GROUP BY YR, qtr, code;
"
7761,Retrieve last entry for each,"WITH CTE AS
(
    SELECT StudentID, EvaluationStatusID, Date,
           RN = ROW_NUMBER() OVER (PARTITION BY StudentID
                                   ORDER BY Date DESC)
    FROM dbo.Student
)
SELECT StudentID, EvaluationStatusID, Date
FROM CTE WHERE RN = 1
"
23917,creating a SQL table with multiple columns automatically,"DECLARE @COUNTER INT = 1
WHILE @COUNTER < 10
BEGIN
    PRINT 'ALTER TABLE table_name ADD N' + RIGHT('00' + CONVERT(NVARCHAR(4), @COUNTER), 2) + ' bit'
    SET @COUNTER += 1
END
"
4924,Using output of one select query as input for another,"SELECT e.Id [EmployeeId], e.MgrId [ManagerId], m.MgrId [ManagerManagerId]
FROM Employees e
LEFT JOIN Employees m ON e.MgrId = m.Id
WHERE e.EmpId=@EmpId
"
31375,SQL Adding Within Statment,"SELECT 
    OrderID,
    OrderNum,
    Amount ,
    SUM(Amount) OVER (PARTITION BY OrderID) as Total
FROM OrderLine
"
5884,Sql Query help is needed,"SELECT t.Student, t.Class, t.Marks
FROM tableName t
INNER JOIN (
    SELECT Student, max(Date) as MaxDate
    FROM tableName)
tm ON t.Student=tm.Student AND t.Date=tm.MaDate)
WHERE ""Subject ID""=givenSubjectID
"
7903,SQL Group By Range,"WITH Issues AS (
  SELECT 1 as Number
  UNION ALL
  SELECT Number + 1 as Number
  FROM Issues WHERE Number + 1 <= (SELECT MAX(Expiry_Issue) FROM Subscriber)
)
SELECT issue.Number, COUNT(DISTINCT s.id)
FROM 
  Subscriber s INNER JOIN 
  Issues i ON i.Number BETWEEN s.First_Issue AND s.Expiry_Issue
"
42,SQL Query to select records based on 2 different values in the same field and a condition,"SELECT DISTINCT d1.trid 
FROM dennis d1
     INNER JOIN dennis d2 ON d2.trid=d1.trid
WHERE d1.place = 'bangalore' and d2.place = 'mumbai' AND d1.si < d2.si
"
31884,Mysql query to select from database where term occurs more than x amount of time,"SELECT SUBSTRING_INDEX( SUBSTRING_INDEX(  URL_COLUMN,  '://', 3 ) ,  '/', 3 ) 
FROM YOUR_TABLE group by
SUBSTRING_INDEX( SUBSTRING_INDEX(  URL_COLUMN,  '://', 3 ) ,  '/', 3 )
having  count(*)> 1000 
"
1207,return values within the last 365 counting from newest date ORACLE SQL,"SELECT *
FROM (SELECT et.*,
             MAX(TIMESTAMP_DATE) OVER (PARTITION BY EMPLOYEE_ID) as MAX_TIMESTAMP_DATE
      FROM EMPLOYEE_TIMESTAMPS
     ) et
WHERE TIMESTAMP_DATE >= MAX_TIMESTAMP_DATE - 365;
"
9272,"SQL, Transferring a ""SELECT"" result list into another table","UPDATE users u INNER JOIN (SELECT * FROM fastighet GROUP BY FNR HAVING COUNT(*) = 1) f 
ON u.username = f.FNR
SET u.adress = f.BELAGENHETSADRESS;
"
20550,How to select the last latest records with associated IDs from the excluded row on the query?,"    select * from (
select  Id,UserEmail,SellerEmail,Messages,UserName,MessageID ,
row_number () over (partition by UserEmail order by ID desc  ) as rnm
from [MessagesTab] 
where MessageID in
( 
    select  MessageID 
    from [MessagesTab]
    where UserEmail = 'ddfgdfjn84@outlook.com'
) 
and UserEmail <> 'ddfgdfjn84@outlook.com' ) x
where rnm =1;
"
7509,SQL return n rows per row value,"SELECT  *
FROM    (
        SELECT  p.*,
                ROW_NUMBER() OVER (PARTITION BY birthCountry ORDER BY birthDate DESC) rn
        FROM    persons p
        )
WHERE   rn <= 10
"
6411,"SQL why use isnull(field, '') <> ''?","IH.CustomerItemNumber <> '' and IH.CustomerItemNumber is not null
"
23496,How to filter a measure based on another measure,"WITH 
  MEMBER [Measures].[CntUsersActive5DaysOrMore] AS 
    Sum
    (
      [UserId].[UserId] //<<< or [UserId].[UserId].[UserId]
     ,IIF
      (
        [Measures].[ACTIVE DAYS] > 5
       ,1
       ,0
      )
    ) 
SELECT 
  [Measures].[CntUsersActive5DaysOrMore] ON 0
FROM [YourCube];
"
39770,get-wmiobject sql join in powershell - trying to find physical memory vs. virtual memory of remote systems,"gwmi -query ""Select TotalPhysicalMemory,TotalPageFileSpace from Win32_LogicalMemoryConfiguration"" -computer $COMPUTERNAME |
  select @{Name='Computer', Expression=$COMPUTERNAME},
         @{Name='Physical Memory', Expression=$_.TotalPhysicalMemory},
         @{Name='Virtual Memory', Expression=$_.TotalPageFileSize} |
  Export-Csv
"
4317,Database Design For Image Table,"DATATYPE    DATAID    IMAGEID
 1           10         1
 2            8         2
"
26223,SQL query to select only entries that have grandchildren,"SELECT DISTINCT p1.name 
FROM people AS p1
INNER JOIN people AS p2 ON p1.id = p2.parent_id
INNER JOIN people AS p3 ON p2.id = p3.parent_id
WHERE p1.parent_id = 0 
"
37327,How to access the data of a table from parent database in SQL Server,"select
    LocalTable.*, tmp.*
from
    LocalTable,
    [OtherServerName].[OtherDB].[dbo].[OtherTable] as 'tmp'
"
5092,update 5 successive row with 5 data in a sqlite database," //Clears learnDataTable:
 mDb.execSQL(""DELETE FROM learnDataTable"");
 //Insert 5 random rows from dic:
 mDb.execSQL(""INSERT INTO learnDataTable (english, bangla) SELECT english ,bangla FROM dic ORDER BY RANDOM() LIMIT 5"");
"
13341,How to get unique number of rows from the secondary table,"select count(distinct product_id) from pro_category
"
19142,Grouping values from dynamic columns,"Select * from TAB2 A join 
   (Select ID1, ID2, MIN(ROOT), NAME from TAB2 
       group by ID2, ID1, NAME) B
   on A.ID1 = B.ID1 and B.ID2 = A.ID2 and A.NAME = B.NAME
"
25535,MySQL select id which is not in specific date and time,"SELECT c.car_id
FROM cars c 
LEFT JOIN ( SELECT car_id 
            FROM bookings 
            WHERE '2015-01-15 11:00:00' BETWEEN CAST(CONCAT(Pick_Date, ' ', Pick_Time) AS DATETIME) AND CAST(CONCAT(Drop_Date, ' ', Drop_Time) AS DATETIME) 
          ) AS A ON c.car_id = A.car_id 
WHERE A.car_id IS NULL
"
33135,Check date split periods are continuous,"select ref,
       ((max(to_date) - min(from_date)) -
        sum(to_date - from_date)
       ) as total_gaps
from t
group by ref;
"
36174,"How can I use underscores in ""LIKE"" conditions in Tivoli?","select NODE_NAME from NODES where NODE_NAME like '%__SQL' escape '_'
"
37909,How could I remove unnecessary characters in SQL,"UPDATE tableName
SET EMAIL_ADD = TRIM(TRAILING ',' FROM EMAIL_ADD)
"
971,Set max value as default value,"CREATE TRIGGER `productInsert`
    BEFORE INSERT ON `products`
    FOR EACH ROW
BEGIN
    set NEW.rank = (select max(rank) + 1
                    from products p
                    where p.type_id = NEW.type_id
                   );
END
"
16292,SQL Select Friends Change Column Name,"SELECT  MemberID, FriendID
FROM    Friends
WHERE   MemberID = @MemberID
UNION ALL
SELECT  FriendID, MemberID
FROM    Friends
WHERE   FriendID = @MemberID
"
6602,SQL Select query rows using explode on a string,"select t.*
from testtbl t2
where exists (select 1
              from testtbl t2
              where t2.id = 1 and
                    find_in_set(t.id, replace(t2.children, ';', ',')) > 0
             );
"
27443,MySQL Selecting from multiple rows,"SELECT
    p.*,
    j.company_id as companyid,        
    f.id IS NOT NULL AS jid,
    p.id as pid,
    f.id AS fave_id,
    f.id IS NOT NULL AS fave
FROM people p  
LEFT JOIN job j 
       ON j.id = p.job_id
LEFT JOIN favourites f 
       ON f.people_id=p.id
      AND f.user_id = 12
WHERE p.company_id = 3
ORDER BY p.id ASC
"
22020,Counting the number of columns in the database,"SELECT COUNT(*)
FROM `INFORMATION_SCHEMA`.`COLUMNS` 
WHERE `TABLE_SCHEMA`='Yourdatabase' 
    AND `TABLE_NAME`='yourtable';
"
16549,SQL: Counting number of matching results when using a LIMIT query,"SELECT SQL_CALC_FOUND_ROWS * FROM users LIMIT 100 OFFSET 200;
SELECT FOUND_ROWS();
"
24237,Minimum GRANTs needed by mysqldump for dumping a full schema? (TRIGGERs are missing!!),"GRANT USAGE ON *.* TO 'dump'@'%' IDENTIFIED BY ...;
GRANT SELECT, LOCK TABLES ON `mysql`.* TO 'dump'@'%';
GRANT SELECT, LOCK TABLES, SHOW VIEW, EVENT, TRIGGER ON `myschema`.* TO 'dump'@'%';
"
2472,SQL Server compare values of two rows of same table and get not matching column names,"SELECT
-- For each column you're checking.  Also account for ISNull if you need to
CASE WHEN I.Col1 = D.Col1 THEN 0 ELSE 1 END AS Col1Changed.......
FROM INSERTED I
INNER JOIN DELETED D on (I.<PK> = D.<PK>)
"
7607,Performance of Oracle's dbms_crypto.hash function for SHA-1,"Begin
   DBMS_OUTPUT.PUT_LINE(DBMS_PROFILER.START_PROFILER('tag value for your run'));
   your_procedure_to_test();
   DBMS_OUTPUT.PUT_LINE(DBMS_PROFILER.STOP_PROFILER());
END;
"
20750,UPDATE part of value in a column,"UPDATE test
SET col = regexp_replace(col, '(?:city)','town','g');
"
31764,Issue with SELECTing a value from one coloumn that is dependant on another SQL,"SELECT product, SUM(status = 'booking') as CountOf 
FROM sw_orders 
GROUP BY product;
"
12511,Show number of row in mysql select,"SELECT cnt, name, avgrate,
       (@curRank := @curRank + 1) AS rank 
FROM (SELECT count(o.name) as cnt, o.name, avg(oc.rate) as avgrate, 
      FROM avatec_objects o JOIN
           avatec_objects_comments oc
           ON oc.oid = o.id 
      WHERE o.status = 0
      GROUP BY o.name
     ) oc CROSS JOIN
     (SELECT @curRank := 0) vars
ORDER BY  avgrate desc, cnt desc;
"
26291,datetime parameters in reporting service," `SET @StartDate = @StartDate + '6:00:00.00'` -- Adds 6 Hours or


 SET @StartDate = DATEADD(Hour,6,@StartDate)
 SET @StartDate = DATEADD(Minute,30,@StartDate)
 SET @StartDate = DATEADD(Second,45,@StartDate)
"
8406,querying using count,"select suppcode, count(distinct storecode) as StoresSupplied
from stocks
group by suppcode
having count(distinct storecode) > 3
"
14158,Dynamically removing records when certain columns = 0; data cleansing,"update `users_individual_cards` ...
delete `users_individual_cards` where ... (same condition) and own + want + trade = 0
"
21346,How do I return first value on joined tables with aggregated columns,"SELECT   m.Name as Name
         , SUM(tp.Value) as TotalValue
         , MIN(s.EmailAddress) as EmailAddress
FROM     Member m 
         INNER JOIN Transaction t ON m.ID = t.MemberID 
         INNER JOIN TransactionPart tp ON tp.TransactionID = t.ID 
         INNER JOIN Scheme s ON s.ID = tp.SchemeID
GROUP BY 
         m.Name
"
5803,MYSQL - How do i fill a column in a database with 6 random varchar?,"update padron_filtrado pf
    set pf.provicias = elt(1 + floor(rand()*7),
                           'Heredia', 'San Jose', 'Cartago', 'Puntarenas', 'Alajeula, 'Limon', 'Guanacaste'
                          );
"
27224,Oracle 11g - factorial not working with large numbers,"select sum(ln(rownum)) ln_fact
from dual
connect by level <= 7;
"
10834,Stored Procedure to SELECT Last 6 Digits of Number,"DECLARE @bigOne bigint

SET @bigOne = 999333444

SELECT RIGHT(@bigOne, 6)
"
26435,Copying row from one table to another when trigger is called,"CREATE TRIGGER tg_insert ON A
FOR INSERT
AS
BEGIN
  INSERT B
  SELECT id, val
  FROM inserted
END
"
2117,LIKE clause is not working in SQL server,"SELECT DocId, NSN, Qty, RequestDate, ReceiveDate
FROM Orders
WHERE (DocID LIKE '%DSRB%') OR (DocID LIKE '%DHA%')
"
11549,"Where Clause for Multiple Filters for the Same Field Plus a ""SELECT ALL"" Option","where
    (DATA_TYPE='Direct' and (@Request.Direct in ('All Direct', BUSINESS_TYPE)) or
    (DATA_TYPE='Indirect' and (@Request.Indirect in ('All Indirect', BUSINESS_TYPE)) or
    (DATA_TYPE='Other' and (@Request.Other in ('All Other', BUSINESS_TYPE))
"
39027,How to split first 4 rows and sum the remaining records and show as last record,"select col1,col2,col3 from dbo.t3 where col1<='i4'
union
select '>i4',SUM(col2),SUM(col3) from dbo.t3 where col1>'i4'
"
36137,How to escape a string for use with the LIKE operator in SQL Server?,"REPLACE(REPLACE(REPLACE(@myString, '[', '[[]'), '_', '[_]'), '%', '[%]')
"
27310,PostgreSQL: select distinct id union vs. select id full join,"SELECT id
from table1 a FULL JOIN
     table2 b
     using (id) FULL JOIN
     table3 c
     using (id) FULL JOIN
     table4
     using (id);
"
5903,Display a range of values between two user input values between two different columns in SQL?,"SELECT DISTINCT column1, column2 
FROM table 
WHERE column1 
BETWEEN '&column1' AND (SELECT column1 FROM table WHERE column2 = '&column2') 
ORDER BY column1;
"
17170,Many to Many SQL Query for selecting all Images Tagged with certain words,"SELECT i.id, i.relative_url, count(*) as number_of_tags_matched
FROM   images i
    join tags_image_relations ti on i.id = ti.image_id
    join tags t on t.id = ti.tag_id
    where t.name in ('google','microsoft','apple')
    group by i.id having count(i.id) <= 3
    order by count(i.id)
"
2331,MySQL - Trying to count tickets sold for an event,"SELECT  events.id,
,       events.name
,       events.capacity
,       events.capacity - COUNT(tickets.id) AS available
FROM    events
LEFT JOIN 
        tickets 
ON      events.id = tickets.event_id
group by
        events.id,
,       events.name
,       events.capacity
"
14286,"I want to select a specific data, but query result gives all column in sqlite","SELECT Country_Code 
FROM COUNTRIES, COUNTRY_SMALL_INFO 
WHERE COUNTRIES.ID = COUNTRY_SMALL_INFO.ID AND COUNTRIES.Country_Name = 'Belgium'
"
12358,Databases - ID column - identity or not?,"DELIMITER $$

CREATE TRIGGER adresse_trigger_insert_check
 BEFORE INSERT ON adresse
 FOR EACH ROW BEGIN
 IF NEW.land IS NULL THEN
  SET NEW.land := 'XY';
 END IF;
END$$

DELIMITER ;
"
26382,Using decode to check for negative and positive values,"select CASE 
 WHEN money_return < 0 THEN abs(money_return)
 WHEN money_return > 0 THEN money_return*10
 ELSE money_return END money_return from cash_t;
"
8315,SQL query that combines 3 tables,"select StaffId, fName, lName, sum(Quantity) 
from DeliveryStaff ds, Orders o, OrderItems oi 
where StaffId = DeliveryStaffId 
  and o.OrderId = oi.OrderId 
group by StaffId, fName, lName
"
14789,Find and display only values that are the same in sql,"SELECT Swimmers, 
       Eventid, 
       Place
FROM  Results a INNER JOIN
        (
            SELECT EventID, Place ,COUNT(Place) totalPlace
            FROM Results
            GROUP BY EventID, Place
            HAVING COUNT(Place) > 1
        ) b ON a.eventID = b.EventID AND
                a.Place = b.Place
-- WHERE -- add extra conditions here
"
18476,Pass explicit NULL value to stored procedure from T-SQL not from application,"EXEC sp_bla NULL, 'Noob Question Name', 'Noob Surname'
"
8116,Postgresql - How to select results depending on results of another query,"select
    t1.*,
    case when t2.user is not null then 1 else 0 end is_mutual
from test as t1
    left outer join test as t2 on t2.user = t1.friend and t2.friend = t1.user
"
38852,Show new field from count result in other table,"select p.id, p.name, p.cnt 
from tbl_people p
inner join
   (select personid, count(1) as Cnt
   from tbl_vehicle
   where vehicle_name = 'Car'
   group by personid) v
on v.personid = p.id
order by p.name
"
4432,SQL get change in values based on consecutive dates,"select
    t1.date,
    t1.company,
    t1.price,
    t1.price - t2.price as day_change
from price_table t1
left join price_table t2 
    on t2.date = subdate(t1.date, 1)
    and t2.company = t1.company
"
28480,Can I add multiple columns to Totals,"SELECT
    sub.a,
    sub.b,
    (sub.a + sub.b) as c,
FROM
(
    select 
        case when x > 4 then 4 else x end a,
        (select count(*) somethingElse) b
    FROM MyTable 
) sub
ORDER BY c
"
31380,Oracle SQL insert into statement ORA-00979,"  insert into my_new_table
     ( my_table_count,
       my_table_date_value,
       my_table_value )
  select count(*) as my_table_count,
           my_table_date_value ,
           my_table_value
    from my_table 
   where my_table_value > 0
   group by my_table_date_value,
            my_table_value
"
9212,SQL/SQLite/SQLite studio: Get strings composed from at least two words,"SELECT english
FROM translations
WHERE english like '% %'
"
34360,SQL: how do you look for missing ids?,"SELECT t1.id FROM your_list t1
LEFT JOIN your_table t2
  ON t1.id = t2.id
WHERE t2.id IS NULL
"
33626,How to make a list of T-SQL results with comma's between them?,"create table #temp
(
    y int,
    x varchar(10)
)

insert into #temp values (1, 'value 1')
insert into #temp values (1, 'value 2')
insert into #temp values (1, 'value 3')
insert into #temp values (1, 'value 4')

DECLARE @listStr varchar(255)

SELECT @listStr = COALESCE(@listStr+', ', '') + x
FROM #temp
WHERE #temp.y = 1

SELECT @listStr as List

drop table #temp
"
35278,SQL check if more than one field in range is >0,"Select RowId, Case when NewField > 1 then 1 else 0 end as 'Status' from 
(
    Select *,
        case when Football > 0 then 1 else 0 end +
        case when Cricket > 0 then 1 else 0 end +
        case when Tennis > 0 then 1 else 0 end +
        case when Athletics > 0 then 1 else 0 end as 'NewField'
    from TableName
)
"
17408,Need help writing trigger to only allow certain users to update/delete based on JOINED tables," if exists (select 1 from deleted d INNER JOIN tableA a on d.? = a.? where a.[BitFlag] = 1) 
     and exists (select 1 from inserted i INNER JOIN tableA a on i.? = a.? where a.[BitFlag] = 1) 
"
29458,Joining one table with 3 others,"SELECT t.id, t.date_created, t.date_due, t.summary, t.description, t.solution, 
       e.name, s.status, c.name
FROM issue_tickets t
LEFT JOIN equipment e on t.equipment_id = e.id
LEFT JOIN issue_status s on t.issue_status_id = s.id
LEFT JOIN issue_categories c on t.issue_categories_id = c.id
"
24667,Parse XML Without Knowing The Schema,"SELECT 
    e.e.value('../recordid[1]', 'INT') As [recordid]
    ,e.e.value('fn:local-name(.)', 'NVARCHAR(100)') As [ElementName]
    ,e.e.value('.', 'NVARCHAR(100)') As [Value]
FROM @xml.nodes('/*/*/*') e(e)
WHERE
    e.e.value('fn:local-name(.)', 'NVARCHAR(100)') != 'recordid'
"
35656,Subqueries for individual fields create multiple records,"SELECT
  rea.id,
  MAX(CASE WHEN rej.rejection_rowId = '1' THEN rej.rejection_code END) AS rejection1,
  MAX(CASE WHEN rej.rejection_rowId = '2' THEN rej.rejection_code END) AS rejection2,
  MAX(CASE WHEN rej.rejection_rowId = '3' THEN rej.rejection_code END) AS rejection3,
FROM
  reason rea
  INNER JOIN rejection rej ON rea.rowId = rej.rowId
WHERE
  rea.id = '12345'
GROUP BY rea.id
"
4489,third nearest element pl/sql oracle,"SELECT * FROM (
  SELECT ROWNUM RN, V.* FROM (
    SELECT pid, ABS(price - 17.50) distance, price
    FROM Parts
    ORDER BY 2 asc, year desc, pid desc
    ) V
  ) V2
WHERE RN = 3
"
848,access sql changing where parameters,"SELECT y.IDPerson,y.ExpensesTotal,isnull(x.ExpensesBefore_1_2_2014,0) as ExpensesBefore_1_2_2014  from 
(SELECT IDPerson ,sum(expenses) as ExpensesTotal from tableA GROUP BY IDPerson) as y full join ( SELECT  tableA.IDPerson , sum(expenses)  as    ExpensesBefore_1_2_2014 from tableA 
where data < '01.02.2014'
GROUP BY tableA.IDPerson ) as x on x.IDPerson = y.IDPerson
"
30655,SQL Server equivalent to MySQL enum data type?,"mycol VARCHAR(10) NOT NULL CHECK (mycol IN('Useful', 'Useless', 'Unknown'))
"
26025,Sql trigger whenever a field gets null (empty),"CREATE TRIGGER change_field_if_other_field_is_null 
BEFORE UPDATE ON your_table
FOR EACH ROW SET NEW.to_change = IF (NEW.isnt_null IS NULL, 5, NEW.to_change);
"
33307,"Recursive ""ON DUPLICATE KEY UPDATE""","SELECT DATE_ADD(Min(a.`date`), INTERVAL '1' DAY) AS `free_date`
FROM `activity` a
LEFT JOIN `activity` z
ON z.`date` = DATE_ADD(a.`date`, INTERVAL '1' DAY)
WHERE z.`date` IS NULL 
AND a.`date` >= '2009-07-31'
"
24886,SQL Server Update Using Multiple Tables,"UPDATE A
SET A.A1 = 'TRUE' 
FROM Attendance A
INNER JOIN Student S
    ON A.StudentId = S.ID
INNER JOIN Module M
    ON A.ModuleId = M.ID
WHERE S.ID = '3a0070c48' 
AND M.[Day] = 'Friday' 
AND '1100' BETWEEN M.StartTime AND M.EndTime
"
32075,Creating a Form in APEX to set Variables in a Query for an Interactive Report,"select e.* 
from emp e
"
13066,Insert into one column data from two columns," INSERT INTO TableB (Col1)
 (SELECT Col1 FROM TableA
  UNION
 SELECT Col2 FROM TableA)
"
14607,MySQL Count Unique Of One Column Where Other Column Has Single Value In Group By,"SELECT group_id, count(*) AS always_declines
FROM (SELECT group_id, visitor_id
      FROM customer_actions 
      GROUP BY group_id, visitor_id
      HAVING SUM(outcome <> 'declined') = 0
     ) gv
GROUP BY group_id;
"
30884,Inserting numerous incremental values in a column,"UPDATE YOUR_TABLE
  SET new_column = (SELECT 'Candidate'+ CAST(ROW_NUMBER() OVER(ORDER BY yt.id) AS VARCHAR(4))
                      FROM YOUR_TABLE yt
                     WHERE yt.id = YOUR_TABLE.id)
"
34637,"MySQL statment, how to show when a column has not results","SELECT t1.id_user, t1.name, COALESCE(SUM(t2.points), 0) AS points
FROM TABLE_A AS t1 
LEFT JOIN TABLE_B AS t2 ON t1.id_user = t2.id_user AND t2.date = 'today'
GROUP BY t1.id_user, t1.name
"
3095,How can I insert Date Time with WSO2 Data Service in Oracle,"<param name=""execution"" sqlType=""TIMESTAMP"" ordinal=""17""/>
"
28026,ApplySimple Formula for Current year in Microstrategy,"Year(CurrentDate())
"
13087,SQL select clause with a compound,"SELECT PublicationId, UserId
FROM   Unsubscribed
MINUS
SELECT PublicationId, UserId
FROM   Subscribed
"
19622,merge two columns then group by,"select t.loc, max(t.group_no)
(
    select loc1 as loc, group_no from test

    union

    select loc2 as loc, group_no from test
) t
group by t.loc
order by 2,1
"
252,using aggregate function with more than two columns,"select
    distinct on (stat_id)
    *
FROM
    stat_log
WHERE
    user_id = 1
order by stat_id desc, registered_desc;
"
30754,sql query gives different result for PercentAnalysed,"CAST(COALESCE(ROUND(((counts.COUNT * 100.0) / NULLIF(failcount, 0)), 0), 100) AS NUMERIC)
"
8947,SQL : How to select a column based on partial string of the column,"  select 
  comments, substr(comments, instr(comments, '2012'), instr(comments, 'M') - 6) YEAR
  from TABLEA
  order by substr(comments, instr(comments, '2012'), instr(comments, 'M') - 6) desc
  where rownum = 1
"
22303,SQL select query not working with variable parameter in my servelets,"ResultSet rs = stmnt.executeQuery(""select * from ZEE.WORDCOUNT where WORD ='"" + searchTxt+""'"");
"
14227,"Select a field from sql IF, otherwise select another","select
  third_id,
  case when other_id = second_id then first_id 
       when other_id = first_id  then second_id
  end as id
from my_table
where ....
"
4112,SQL from inside in affects join results,"-- this one returns 13 tuples
select c.companyname
    from companies as c
    join stocklist as s
    using (companyid)
    where s.price in(s.price,s.price)
"
25628,SQL update records with incrementing value starting from 1 each time,"INSERT targetTable(Batch,Name,IncementingValue)
SELECT BatchId,
       Name,
       ROW_NUMBER() OVER (ORDER BY Name)
FROM sourceTable
"
16738,insert from ordered select results,"insert into dbo.Feedback.QueueAccountOrder
(
    QOrder,
    Code,
    Utc
)
select
    row_number() over(order by T.CityName, T.AccountName),
    T.AccountCode,
    T.Utc
from
(
    select distinct tA.AccountCode, tA.AccountName, tA.Utc, tC.CityCode, tC.CityName
    from #TempTree tC
        left join #TempTree tA on tA.CityCode = tC.CityCode
) as T
"
17026,"Collaps function on Date from SQL, failing to give result","DECLARE @listStr VARCHAR(MAX)
SELECT @listStr = COALESCE(@listStr+',' ,'') + Isnull(CAST (CONVERT(DATE,SP.StartDateTime,103) as Varchar),'')
FROM testtable AS SP
SELECT @listStr
GO
"
24660,SQL text before then Nth match?,"DECLARE @str VARCHAR(50)
SET @str = '/one/two/three/whatever/testing'
SELECT SUBSTRING(@str, 0, CHARINDEX('/', @str, CHARINDEX('/', @str, CHARINDEX('/', @str, CHARINDEX('/', @str, 0) + 1) + 1) + 1))
"
4809,Select statement to return constant when no records found in table in SQL Server 2008,"SELECT (CASE WHEN Ta.ID IS NULL THEN TBL.ID 
ELSE Ta.ID END) AS ID,Ta.Text,Ta.Date
FROM (VALUES(-5)) AS TBL(ID)
LEFT JOIN
(
   SELECT ID,Text,Date FROM tblData WHERE ID = 12
)
AS Ta ON Ta.ID = Ta.ID
"
2277,Transpose data with MS Access SQL,"select year, quarter, 'P1' as value, p1
from table1
union all
select year, quarter, 'P2' as value, p2
from table1;
"
29402,SQL function question,"SET @_result = REPLACE(@_result, '&', 'eseses')
SET @_result = REPLACE(@_result, '-', 'vagyvagy')
"
20935,Return date from function in PL/SQL,"rec := to_date(a||'/'||b||'/'||c,'YY/MM/DD');
"
37335,How to Convert 'September 2014' to '2014-09-01' in mysql," SELECT STR_TO_DATE(CONCAT('September 2013',',1'),'%M %Y,%D');
"
22372,Select Random 20 rows from database table where id = (some id),"SELECT TOP 20 column FROM table WHERE id = some_id
ORDER BY NEWID()
"
9698,Filter a select where results of expression meet criteria,"SELECT r.id AS result_id, 
c.count_id AS count_id,
c.numerator/CAST(c.denom AS numeric) * 100 AS freq 
FROM results r 
INNER JOIN infos i 
    ON r.infos_id = i.info_id 
INNER JOIN counts c 
    ON i.counts_id = c.count_id 
WHERE c.numerator/CAST(c.denom AS numeric) * 100 < 12
"
28510,SQL UPDATE TOP with ORDER BY?,";with cte as (
   select top (@MaxRecords)
       status
   from Messages 
   where Status = 'N' and InsertDate >= getdate()
   order by ...
)
update cte set
    status = 'P'
output inserted.*
"
17091,SQL priority conditon,"SELECT * 
FROM mytable 
WHERE  (`field1` LIKE '%search%' OR `field2` LIKE '%search%' OR `field3` LIKE '%search%')
ORDER BY 
CASE 
  WHEN `field1` LIKE '%search%' THEN 1
  WHEN `field2` LIKE '%search%' THEN 2
  WHEN `field3` LIKE '%search%' THEN 3
  ELSE 4
END 
"
32281,Check that the values in all the columns are different in sql - Oracle,"select * from
 (select sys.dbms_debug_vc2coll(1,2,3) a, 
         sys.dbms_debug_vc2coll(1,2,3) multiset union distinct sys.dbms_debug_vc2coll() b
 from dual)
where a=b;

select * from
 (select sys.dbms_debug_vc2coll(1,2,3,1) a, 
         sys.dbms_debug_vc2coll(1,2,3,1) multiset union distinct sys.dbms_debug_vc2coll() b
 from dual)
where a=b
"
39019,How to delete a row with a condition in other table (sql),"DELETE
FROM   orders
WHERE  aid IN (SELECT aid
               FROM   agent
               WHERE  city = 'New York')
"
3620,Normalizing database,"Table: User [UID, Uname, PW]

Table: Bookmark [BID, UID, url]

Table: Tag [TID, Tagname]

Table: Bookmark_Tag [BID, TID]
"
35212,Short test statements in PL-SQL?,"SELECT 'xyz' from dual;


SQL> select user,sysdate,lower(user) loweruser, 10*1023 from dual;

USER       SYSDATE    LOWERUSER     10*1023
---------- ---------- ---------- ----------
NKODNER    22-NOV-11  nkodner         10230
"
29611,PostgreSQL get last value in a comma separated list of values,"select id, regexp_replace(mycolumn, '.*,', '')
from mytable
order by id;
"
1473,Using advance SELECT statement for SQL QUERY,"SELECT p.name, p.name_id
FROM people p
JOIN area a
  ON p.name_id = a.name_id
JOIN area_use au
  ON a.area_id = au.area_id
 AND au.veg_grown = 'tomato'
LEFT JOIN area_use au2
  ON a.area_id = au2.area_id
 AND au2.veg_grown <> 'tomato'
WHERE au2.area_id IS NULL;
"
16058,MySQL find duplicates + one other field,"SELECT s.username
     , s.acctsessionid
  FROM (
         SELECT r.username
           FROM radacct r 
          WHERE r.acctstoptime IS NULL
          GROUP BY r.username
         HAVING COUNT(1) > 1
       ) d
  JOIN radacct s
    ON s.username = d.username
 WHERE s.acctstoptime IS NULL
 ORDER
    BY s.username
     , s.acctsessionid
"
36653,How to deal with Unicode replacement character � (0xFFFD / 65533) in SQL,"SELECT REPLACE(N'test' + NCHAR(65533) 
COLLATE Latin1_General_BIN, NCHAR(65533) COLLATE Latin1_General_BIN, '')
"
5525,MariaDB: Select the fields from one column in one table that are not in a subset of another column from another table,"SELECT f.follower
FROM following f
LEFT OUTER JOIN association_record a
ON f.follower = a.user_id
AND a.poll_id = 88
WHERE f.followee = 5
AND a.user_id is null
"
34104,Using SQL keyword in title of table or column,"SELECT * FROM `ORDER` ORDER BY NAME;
"
21133,Block a row from reads whilst sp executes,"SELECT @status = status FROM t (UPDLOCK) WHERE t.id = @id
"
1972,Select three rows when two of them need to be unique (SQL),"SELECT domain_name, index_path, MIN(collection_name) collection_name
FROM TABLENAMEHERE
GROUP BY domain_name, index_path;
"
27928,Proper way to use a join?,"select
t1.Name as `Small City Name`,
t2.Name as `Med City Name`,
t3.Name as `Big City Name`
from table1 t
inner join table2 t1 on t1.ID = t.`Small City`
inner join table2 t2 on t2.ID = t.`Med City`
inner join table2 t3 on t3.ID = t.`Big City`
"
6667,SQL join rows in two tables,"SELECT DISTINCT category 
FROM Table_A
UNION 
SELECT DISTINCT category
FROM Table_B
ORDER BY category
"
9584,Select multiple results from sub query into single row (as array datatype),"SELECT  c.id, 
    c.model, 
    c.color,
    LISTAGG(d.name, ',') WITHIN GROUP (ORDER BY d.name) AS ""Drivers""
FROM tblCars c
JOIN tblDrivers d
ON c.id = d.fID_TblCars
GROUP BY c.id,
    c.model,
    c.color
ORDER BY c.Id
"
30909,SQL DELETE with INNER JOIN,"DELETE s.* FROM spawnlist s
INNER JOIN npc n ON s.npc_templateid = n.idTemplate
WHERE (n.type = ""monster"");
"
32678,Oracle : Which column to update ? Complex query,"update
  my_table
set
  january_col  = case when column_to_update = 1 then new_value else january_col  end,
  february_col = case when column_to_update = 2 then new_value else february_col end,
  march_col    = case when column_to_update = 3 then new_value else march_col    end,
  ... etc
where
  ...
"
20823,Computing ratio of records existing in another table,"select t1.attr, count(t2.url) / count(t1.attr) as ratio
from t1
left join t2 on t2.url = t1.link
group by t1.attr
order by ratio
"
9665,How to get DISTINCT row from INNER JOIN Query in SQL Server,"select
  t.teacherid, 
  t.teachername, 
  g.gender, 
  t.dob, 
  coalesce(s.subject, 'no subject') as subject, 
  t.contact, 
  t.address, 
  t.email, 
  t.photo
from teacher t
join gender g on g.genderid = t.gender
left join 
(
   select teacherid, max(subjectid) as max_subjectid
   from teachersubject
   group by teacherid
) ts on ts.teacherid = t.teacherid
left join subject s on s.subjectid = ts.max_subjectid;
"
14699,Concatenate values from multiple columns in Oracle,"   select col1,rtrim( col2||','||col3||','||col4||','||col5,' ,') as col2  from table_name
"
18440,"Adding a ""total sum"" row with a select statement in Mysql","SELECT   IFNULL((CASE
           WHEN a.account_number = '123456' THEN 'Savings'
           WHEN a.account_number = '123321' THEN 'Credit'
         END), ""Total"") AS ""Account""
FROM accounts a
GROUP BY a.account_number WITH ROLLUP;
"
8887,execute procedure for a sequence of elements (execute theProc (select id from table)),"declare @sqlstr nvarchar(max)

set @sqlstr = ''

select  @sqlstr = @sqlstr + ' exec deleteQuestion ' + cast(q.id as nvarchar(max))
from Questions q where stuff = @stuff

exec (@sqlstr)
"
13268,SQL joins with an aggregation,"SELECT p.id, COUNT( pf.id )
FROM prod p
LEFT JOIN prod_feat pf
ON p.id = pf.prod_id
GROUP BY p.id
"
21540,I want to see the information beign reference by the feign key in my table,"select * from ticket 
inner join employee on ticket.eid = employee.id
where employee.id = 1
"
24077,How to group row updates based on column values?,"UPDATE c 
SET c.Class_Total = (SELECT SUM(c2.Value)
                     FROM dbo.Contrived c2
                     WHERE c2.Class = c.Class)
FROM dbo.Contrived c
"
27484,how to get distinct result in sql?,"Select id, name, max(created_on) as created_on from table group by id
"
15973,Special ORDER BY with CASE statement - In need of guidance,"select id, price
from (select t.*,
             min(price) over (partition by id) as minprice
      from t
     ) t
order by minprice, id, price
"
37522,django order by date in datetime / extract date from datetime,"popular = Entry.objects.filter(**conditions).extra(select = 
    {'custom_dt': 'to_date(dt_published)'}).order_by('-custom_dt')
"
7475,How to generate reliably a random UUID on Oracle?,"grant execute on sys.dbms_crypto to uuid_user;
"
28154,need to envelop query to count results,"COUNT (*) AS Amount FROM
(
SELECT 
[QUERY1].[py],
[QUERY1].[al],
[QUERY1].[ga],
[QUERY1].[sy],
[QUERY1].[pl]
FROM [tab-Sample] as QUERY1, [tab-Sample]
WHERE [tab-Sample].[py] = [QUERY1].[py] AND
[tab-Sample].[al] <> [QUERY1].[al] 
) Total
"
22747,MS Access. SQL. get current time,"SELECT Month(date_of_visit), Sum(cost)
FROM VISIT
WHERE Year(date_of_visit) = Year(Date())
GROUP BY Month(date_of_visit);
"
14210,How to perform a join in SQL Server without using tables,"DECLARE @a TABLE (str varchar(100))
INSERT INTO @a
VALUES
('a'),
('b')...

DECLARE @b table (str varchar(100))
INSERT INTO @b
VALUES
...

(SELECT str FROM @a
EXCEPT 
SELECT str FROM @b)
UNION
(SELECT str FROM @b
EXCEPT
SELECT str FROM @a)
"
13974,Size of database in MongoDB,"db.collectionName.stats(1024) //for output in kb
"
21519,SQL Exclude duplicate entries meeting specific criteria (traditional where logic wont work),";With Cte As
(
    Select  ID, ACCT, TYPE, 
            Sum(Case When TYPE = 'A' Then 1 Else 0 End) Over (Partition By ID) NumA
    From    YourTable
)
Select  ID, ACCT, TYPE
From    Cte
Where   NumA < 2
"
16579,Crosstab of row - SQL - Oracle,"with c as (
      select iso_1 as iso
      from tbl_currency_pair
      union
      select iso_2
      from tbl_currency_pair
     )
select c1.iso || '.' || c2.iso
from c c1 cross join c c2;
"
5177,How to join with most recent record?,"proc sql;
   create index bond
      on work.daily_transactions(bond);
quit;

proc sql;
   create index bond
      on work.bond_ratings(bond);
quit;
"
10971,Designing Tables: One to many and one to one at same time?,"table favourite(
  ,parent_id
  ,child_id
  ,primary key(parent_id)
);
"
9779,SQL - Rounding decimals from a count sum without a column,"cast((COUNT(v.id) * r.res_cpm/1000)as decimal (10,2))
"
7646,Ruby SQL query inter related attributes,"participants = Participant.joins(:training_programs).
  where('training_programs.skills_development_id' => @skills_development.id).
  where('training_programs.category' => %w(A B C)).
  where('participants.gender' => 'female')
"
2638,sql query for a report,"select name,
       sum(case when rating > 1 then 1 else 0 end) as cnt1,
       sum(case when rating > 5 then 1 else 0 end) as cnt2
       /* ... repeat as many times as needed */
    from myview
    group by name
"
28379,SQL LEFT JOIN with a CASE Statement,"'Enable' = CASE WHEN hid.ID IS NULL THEN 'true' ELSE 'false' END
"
35315,Similar SQL queries returning different results,"SELECT count(*)
FROM comments
WHERE thread=1
AND parent_id=0
AND NOT EXISTS (SELECT 1 FROM users
                WHERE users.user_id=comments.user_id)
"
20027,Single query instead of multiple select statements,"select c.* 
from customers c
join categories ca on c.customer_id = ca.customer_id
where ca.category_name='Realtor';
"
23199,Determine table to select from based on indicator,"SELECT *
  FROM( SELECT *
          FROM table1
        UNION ALL
        SELECT *
          FROM table2
        UNION ALL 
        SELECT *
          FROM table3 )
 WHERE flag = 'Y'
"
31885,Help with a basic SQL query,"SELECT e.name, l.location 
FROM employee e
JOIN location l ON e.location_id = l.location_id
"
36556,Can we have multiple key values in same column?,"student_id           sport_id
  1                     1
  1                     2
  2                     2
  3                     1
"
31284,Selecting with two references to same table,"SELECT
    SP.*,
    RP,*,
    O.*
FROM Order O
JOIN Person SP ON SP.PersonID = O.Sender_PersonID
JOIN Person RP ON RP.PersonID = O.Receiver_PersonID
"
28868,Reference field outside the subgroup (Unknown column in where clause),"UPDATE order_items a 
    JOIN order_items b ON b.pointer = a.pointer AND b.id_parent = 0
SET a.id_parent = b.id
WHERE a.id_parent > 9999;
"
16849,Oracle Nested Grouping,"select *
from
 (
   select user_id, read_date, count(*) as cnt, 
      rank()
      over (partition by read_date           -- each day
            order by count(*) desc) as rnk  -- maximum number
   from tab
   group by user_id, read_date
 ) dt 
where rnk = 1
"
36387,Postgres CASE statement,"SELECT ROUND((SUM((to_number((case when g.grade='DRP' then '5.00' else g.grade end), '9D99') * s.subjunits)))/(SUM(s.subjunits)), 2)
"
14737,GETDATE() method for DB2,"SELECT CURRENT DATE - 1 DAY FROM sysibm.sysdummy1
"
7415,Get Incremental index for specific rows,"SELECT
    ID,
    Name,
    CASE WHEN LEN(Value)>0 THEN ROW_NUMBER() OVER (
        PARTITION BY CASE WHEN LEN(Value)>0 THEN 1 ELSE 0 END
        ORDER BY ID) ELSE '' END as Note       
FROM  ABCD AS ABC WITH(NOLOCK)
    INNER JOIN XYZ AS XYZ WITH(NOLOCK)
        ON ABC.Id = XYZ.ID
Where ABC.Id = 10
"
31327,mysql Join table,"SELECT table1.name, table2.name2 , table3.name3 
from table3 
left join table2 
on table3.table2Id = table2.table2Id
left join table1 
on table2.table1Id = table1.table1Id
"
38376,T-Sql Query - Get Unique Rows Across 2 Columns,"where X < Y
"
15226,How to Transpose a resultset from SQL,"SELECT RespondentId, CanBathe, TimesADay, SoapPrice
FROM (SELECT RespondentId, ColumnName, AnswerValue FROM MyTable) AS src
PIVOT (MIN(AnswerValue) FOR ColumnName IN(CanBathe, TimesADay, SoapPrice)) AS pvt
"
15947,Getting results to display that exist in table 1 but not table 2,"select distinct tbl.id, 0 cnt --for ids not exists in table2
from table1 tbl 
where not exists (select t.id from table2 t where t.id=tbl.id)
union
select t1.id, count(t1.id) cnt ----for ids exists in table2
from table1 t1
where exists (select t2.id from table2 t2 where t1.id=t2.id)
group by t1.id
"
31668,"SQL, select in tables","SELECT c.*
FROM   customer c
WHERE EXISTS (
    SELECT 1
    FROM   sell s
    JOIN   veicle v ON v.cod = s.veicle
    WHERE  s.customer = c.cod
    AND    v.country = 'Argentina'
    )
AND NOT EXISTS (
    SELECT 1
    FROM ...
    );
"
24379,An Iteration with renaming and avoiding duplicates,"INSERT INTO Table1(Column1)
    SELECT  REPLACE(OriginalColumn, '_', '')
      FROM  Table2 t2
            LEFT OUTER JOIN Table1 t1 ON t1.Column1 = REPLACE(OriginalColumn, '_', '')
     WHERE  t1.Column1 IS NULL  -- Not a duplicate Record
"
20470,How to check if one row in one table is in the other table using mysql?,"SELECT  a.col1, a.col2, COUNT(b.col1)
FROM table1 a LEFT JOIN table2 b
ON (a.col1 = b.col1 OR a.col1 = b.col2) 
AND (a.col2 = b.col1 OR a.col2 = b.col2)
GROUP BY a.col1, a.col2
"
13262,How to Filter records with some column with similar value and some not,"select t1.* 
from your_table t1
join
(
  select id
  from your_table
  group by id, date
  having count(distinct price) > 1
) t2 on t1.id = t2.id
"
13749,How can I add a If Else End If to this query,"SET @id = 26;
SELECT 
IFNULL(
  (SELECT id FROM devTable WHERE id <= @id AND country = 'US' ORDER BY id DESC LIMIT 9,1),
  'Not Found') AS prev,
IFNULL(
  (SELECT id FROM devTable WHERE id >= @id AND country = 'US' ORDER BY id ASC  LIMIT 1,1),
  'Not Found') AS next
"
9915,Delete row with the use of Max(Date)?,"Delete from rental r where r.member_id in (
  select i.member_id 
  from rental i 
  group by i.member_id 
  having MONTHS_BETWEEN(sysdate, max(dateout))>(36)
);

DELETE FROM Member where not exists(
  Select * 
  from rental 
  where Member.Member_ID =  Rental.Member_ID
);
"
5298,Add amount once on duplicate entries,"select * from your_tab 
where job_card in (
    select min(JOB_CARD)
    from your_tab group by CLIENT, DATE
);
"
13266,SQL - Multiple queries on same table,"SELECT DeviceName,
       SUM(CASE WHEN JobType = 'copy' THEN PageCount ELSE 0 END) AS Copy,
       SUM(CASE WHEN JobType = 'print' THEN PageCount ELSE 0 END) AS Print
FROM Tracking
GROUP BY DeviceName
"
28085,Complex MYSQL select,"SELECT tags.tag_name, news_tags.tag_id, COUNT(*) as count 
FROM    news_tags 
        LEFT JOIN tags 
            ON tags.tag_id = news_tags.tag_id 
        LEFT JOIN news
            ON news.id = news_tags.news_id
WHERE   news.status = 1
GROUP BY news_tags.tag_id 
ORDER BY count DESC
"
46,Declare a variable in Oracle SQL to use in a query,"variable var DATE
exec :var := '15-OCT-13'
"
3849,How to update a table from 2 others that contain the old values and the new values in SQL Server?,"UPDATE t
  SET t.Telephone = b.Telephone
FROM TelephonesOrganization AS t
INNER JOIN
(
  SELECT 
    ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS 'ID'
   ,Telephone
   FROM TelephonesToUpdate
) AS a
  ON t.Telephone = a.Telephone
INNER JOIN
(
  SELECT 
    ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS 'ID'
   ,Telephone
   FROM TelephonesNewValues
) AS b
  ON a.ID = b.ID
;
"
13636,MYSQL Query Count the Number of Distinct Values Per Day For Past 7 Days,"COUNT(DISTINCT ip) AS numberOfItems
"
13022,Get peak amount of active rows from all time,"select ts, (select count(*) from tablename t2
            where timestamps.ts between t2.start and t2.end) as count
from (select start as ts
      from tablename
      union all
      select end
      from tablename) as timestamps
order by count desc
limit 1
"
19725,Accessing column alias in postgresql,"SELECT * 
FROM
(
    SELECT DISTINCT robber.robberid, nickname, count(accomplices.robberid)  
    AS count1 FROM robber                   
    INNER JOIN accomplices  
    ON accomplices.robberid = robber.robberid  
    GROUP BY robber.robberid, robber.nickname  
) v
ORDER BY count1 desc
"
12009,Changing multiple column names in a mysql table,"SELECT
    CONCAT(
           'ALTER TABLE ', C.TABLE_NAME, ' CHANGE ', 
           C.COLUMN_NAME, ' ', REPLACE(C.COLUMN_NAME, 'field_t', 'field_c')
           )
FROM
    INFORMATION_SCHEMA.COLUMNS C
WHERE
    C.COLUMN_NAME LIKE 'field[_]t[_]%';
"
23366,Implement Partial sorted query in sql server 2005,"Select state
From statemaster
Order By
  Case When stateid = 5 Then 0 Else 1 End,
  state
"
36926,Table with columns TABLE_NAME and NUMBER_COLUMNS in Oracle,"select table_name, owner, count(*) as Number_Columns
from all_tab_cols
group by table_name, owner;
"
38162,SQL Gaps in Data- Enroll Date and Disenroll Date 'Active_members',"SELECT  Client, min( Enroll_date) [Registered date], 
        CASE WHEN (SELECT 1 FROM big_pink.EnrollmentHistory  WHERE  Disenroll_Date IS NULL) =  1
        THEN NULL --or whatever value you wish
        ELSE max (Disenroll_Date)
        END [End date], COUNT(*) as n
FROM    big_pink.EnrollmentHistory 
WHERE   Sub_Client_Cd = 'B01' 
AND     Policy_Holder_ID = 'BIS355702848' and Suffix_ID = 'e';
GROUP BY Client
"
39740,BLToolKit: how to insert a list of objects?,"using (var db = new DbManager())
    db.InsertBatch(list);
"
34087,SQL: Combination of one column + count,"SELECT sT1.action, sT2.action, count(*)
FROM sourceTable sT1
LEFT INNER JOIN sourceTable sT2 ON (sT1.userID=sT2.userID)
where (st1.RowID <> st1.RowID)
and sT1.action <= sT2.action
GROUP BY st1.action, st2.action
HAVING count(*) > 0
"
20508,database columns and foreign key normalization,"databases: companies
tables: clients, clients_products, products
column: id, name, address, city
key: name
unique key: name
"
13491,Problems using GROUP BY and ORDER BY in SQL Oracle,"SELECT manager_id AS ""Manager ID"",
MIN(salary) AS ""Lowest Paid Salary""
FROM employees
WHERE manager_id IS NOT NULL
AND salary > 6000 
GROUP BY manager_id
ORDER BY min(salary) DESC;
"
25616,Is Golang's SQL package incapable of ad hoc / exploratory queries?,"columnNames, err := rows.Columns()
if err != nil {
    log.Fatalln(err) // or whatever error handling is appropriate
}
columns := make([]interface{}, len(columnNames))
columnPointers := make([]interface{}, len(columnNames))
for i := 0; i < len(columnNames); i++ {
    columnPointers[i] = &columns[i]
}
if err := rows.Scan(columnPointers...); err != nil {
    log.Fatalln(err)
}
"
12063,Inserting all the results of a query into table,"insert into MainTable
(Id,Value)
select distinct 100,  value from RefTable
where id =1
"
8729,SQL AND NOT and AND equivalents,"AND (wo.ci_cnc_date IS NULL OR p.prioid == '1 - Routine')    
"
13828,What do the : and ' operators mean,"EXECUTE IMMEDIATE 'UPDATE mytable SET age = 25 WHERE age = :1' 
     USING IN localVarAge;
"
35394,SQL MAX( ) function,"SELECT top 1 *
FROM MATCHES
WHERE GOALS_FOR > 2
ORDER BY DATE Desc
"
2511,Mysql Table Join on itself,"select 
F1.File as File, 
F1.Status as StatusIn, 
F2.Status as StatusOut 
from 
(
select t1.file, t1.status
from photo as t1 where t1.status = ""Raw Scanned"" )F1
left join
(
select t2.file, t2.status
from photo as t2
where t2.status = ""Processed"" )F2
on F1.file = F2.file;
"
39468,"SQl query for (person,theatre) relation","select v.person
  from visit v
 where v.theatre = all ( 
         select vt.theatre
           from visit vt)
"
18943,How to count similar interests in MySQL,"SELECT ui.userid, COUNT(*) AS common_interests
FROM users_interests ui
WHERE ui.interestid IN (
    SELECT ui2.interestid FROM users_interests ui2 WHERE ui2.userid = 2
) 
AND ui.userid <> 2
GROUP BY ui.userid
HAVING common_interests > 3;
"
24970,Oracle SQL Two Group function why can't be in the same select?,"select budget/workers
  from (select (select sum(p.project_budget) from project p) budget,
               (select count(w.worker_name) from worker w) workers
          from dual);
"
6395,No logging and compression on newly created table,"ALTER TABLE pull_dtl NOLOGGING;
"
27179,Using if else on update sqlplus,"UPDATE CUSTOMER
SET Status = CASE WHEN CUSTOMER.CUSTOMERId IN (SELECT customerID from invoice)
    THEN 'y'
    ELSE 'n' END
where status is null;
"
6094,Sqlite select max query and sorting,"select * 
from table
where product_price = (SELECT max(product_price) FROM table)
order by id desc
limit 1
"
7925,Group results of grouped query,"select daily_user_count, count(*) from (
SELECT COUNT(*) as daily_user_count FROM Activity
GROUP BY entity_uid, date
) Z
group by daily_user_count
"
6536,Select Max and Select other column,"SELECT SectionItem,
       (select MAX(SectionItemID)+1 FROM Core.SectionItem_Lkup) AS SectionItemID
FROM Core.SectionItem_Lkup
"
19076,SQL Server: Date conversion problem?,"Set DateFormat DMY
GO
Select Cast(Stuff(Stuff(SomeValue, 3, 0, '-'), 6, 0, '-') As datetime)
From MyData
"
36906,SQL select and group records with same words in different order,"select f.*
from fruits f
  join orders o 
    on string_to_array(f.name, ' ') @> string_to_array(o.name, ' ')
   and cardinality(string_to_array(f.name, ' ')) = cardinality(string_to_array(o.name, ' '));
"
32303,Count distinct with repeating entries over time,"select year, count(*)
from
(
  select customerid, min(transactiondate) as year
  from transactions
  where transactiontype = 'Presell'
  group by customerid
) first_presells
group by year
order by year;
"
23759,How can i set object type to out in oracle stored procedure?,"create or replace procedure procedure1(IDD IN number, p_out out behzadtype);
"
27431,How to declare a string of strings?,"DECLARE @What TABLE(txt VARCHAR(MAX))
INSERT INTO @What (txt) VALUES ('100'),('200'),('300')
SELECT * FROM MyTable WHERE MyRow IN (SELECT txt FROM @What)
"
25354,Why SQLite index is not speed up query?,"INSERT INTO KeysTable (KeyText, Id)
  SELECT KeyText
       , KeysTable.ID  
  FROM KeysTable
    INNER JOIN StatTable 
      ON KeysTable.ID = StatTable.Key_ID
  WHERE StatTable.StatCommandCode = 4 
"
38667,Select DISTINCT from two columns in t-SQL,"SELECT id, (SELECT TOP 1 type FROM tbl a WHERE id = b.id)
FROM tbl b GROUP BY id
"
27750,SQL: If-condition when result does not exist?,"select OrderDate, isnull(c.FullName, 'No customer') CustomerName
from Orders o
left join Customers c on o.CustomerId = c.CustomerId
"
14623,Selecting rows based on Priority -Sql,"SELECT TOP (1) *
FROM MyTable
ORDER BY Customer_Status, Family_Status DESC
"
17946,Searching inside a SQL record with date limits,"select order_number
from t
having sum(case when DATEDIFF(day, date, getdate()) < 2 and
                     Note like '%OBC%'
                then 1 else 0
           end) = 0
"
28702,Sqlite FTS: Performing AND across two columns,"select * from messages
where messagefts
match ""categories:Office subject:Hi there"";
"
39861,MySQL: Multiple condition with sub-query,"SELECT a.* FROM a 
   LEFT OUTER JOIN b 
       ON (a.cityid = b.id OR a.regionid = b.id or a.countryid = b.id) 
WHERE b.id IS NOT NULL
"
19016,"Remove "" "" from values","UPDATE TableName
SET ColName = REPLACE(ColName, '""', '');
WHERE ColName SIMILAR TO '%""%'
"
32692,Copy a table and replace foreign surrogate key column with text column,"INSERT INTO NewTable(CHILDNAME, CURRENTPAR_NAME, PREVIOUSPAR_NAME)
  SELECT c.CHILDNAME, p1.PARENTNAME, p2.PARENTNAME
    FROM Child c
    JOIN Parent p1 ON (p1.PARENTID = c.CURRENTPARENTID)
    JOIN Parent p2 ON (p2.PARENTID = c.PREVIOUSPARENTID)
;
"
35551,ColdFusion 8 connect to remote access MDB,"Dim strSQL As String
 'assign connection string
strConString = ""Provider=MS Remote;"" & _
               ""Remote Server=http://192.168.1.1;"" & _
               ""Remote Provider=Microsoft.Jet.OLEDB.4.0;"" & _
               ""Data Source=MyRemoteDB;Persist Security Info=False""
    'initialize connection object variable
Set adoConn = New ADODB.Connection
'open connection adoConn.Open strConString, ""admin"", """"
"
2666,Postgres: group query,"select t.country, t.month, t.code, t.code_count,
100 * t.code_count / cast( x.scc as float) as percentage
from t
left join
(
select country, month, sum(code_count) as scc
from t
group by country, month
) x
on x.month = t.month
"
10740,SQL Concat function only when row count less than number,"SELECT CASE WHEN COUNT(Quarters.QuarterNumber) < 4
          THEN CONCAT(Years.YearName, ' - Partial') 
          ELSE CAST(Years.YearName AS varchar)
       END as YearsList
FROM dbo.Quarters Quarters,
     dbo.Years Years
WHERE Quarters.YearUuid = Years.YearUuid
      AND Quarters.ActiveStatus = 'ACTIVE'
      AND Quarters.BroadcastQuarterType = 'STANDARD'
GROUP BY Years.YearName
ORDER BY Years.YearName ASC;
"
25199,SQL MySQL query joining two tables,"SELECT 
    Contact.Name, Contact.Email, Contact.PrimaryPhone, Company.Name, 
    Company.Email, Contact.Description. Company.Description, Contact.CompanyName
FROM Contact
RIGHT JOIN Company ON Company.Id = Contact.CompanyId
WHERE Contact.Name LIKE '%x%' OR Company.Name LIKE '%x%'
"
25990,MySQL Combining data from multiple tables (foreign key) into an array,"select c.id, c.title, group_concat(p.id) posts
from categories c
  left join posts p on c.id = p.category
group by c.id
"
6185,MYSQL formate string to number,"SELECT CAST(REPLACE(colName, ',', '') AS DECIMAL(10,2))
"
16168,Using execute function in sql as value for update - set,"UPDATE table SET value = name();
"
24871,How to calculate mode from database,"SELECT Price_€, COUNT(Price_€) FROM `sales20102015` 
WHERE Date_of_Sale LIKE '%2010%' AND County = 'Monaghan'
GROUP BY Price_€
ORDER BY COUNT(Price_€) DESC
LIMIT 1;
"
27459,What date format is this,"date(milliscolumn/1000,'unixepoch','localtime') 
"
4203,Oracle - How to know a bulk insert has ended?,"select count(*)
  from v$locked_object v
  join all_objects d
    on v.object_id = d.object_id
  join v$session s
    on v.session_id = s.sid
 where d.owner = :owner
   and d.object_name = :table_name
   and s.<some_identifying_data> = :something
"
5632,insert values from one table to another talbe,"INSERT INTO Tbl2(UserId, TimesTamp)
SELECT u.Id,'2016-01-31 23:59:59'
FROM tbl1 AS u;
"
1759,how to determine which class the item belongs to from onContextItemSelected,"int groupPos = 0, childPos = 0;
int type = ExpandableListView.getPackedPositionType(info.packedPosition);
if (type == ExpandableListView.PACKED_POSITION_TYPE_CHILD) {
    groupPos = ExpandableListView
            .getPackedPositionGroup(info.packedPosition);
    childPos = ExpandableListView
            .getPackedPositionChild(info.packedPosition);
}
"
14178,How to run the following Oracle exec statements in SQL Developer?,"DECLARE
    output1 NUMBER;
    output2 VARCHAR2(100);
BEGIN
    rp_orader_closure_pxkg.rp_exaec_close_SILvl_WKO('aaa', '1', 
        '10aaa001a6414339', output1, output2);
END;
"
37087,Extracting hour value from datetime column using DATEPART function,"SELECT DATEPART(""h"", [Time Aired]) AS Foo
FROM DRTV_CentralOnly
WHERE [Time Aired] <> null;
"
33129,A CREATE statement with quoted fields in Oracle,"SELECT ""id"", ""description"" FROM test;
"
12674,SQLite scripting with objective C,"NSString *sql = [NSString stringWithFormat:@""SELECT * FROM %@"",self.databaseName];
const char *sqlStatement = [sql UTF8String];
"
803,Replace with like,"UPDATE tablename.dbo.news
SET brief_n = substring(brief_n,10,4000)
WHERE brief_n LIKE '__/__/__:%'
"
23703,SELECT * FROM db value defined by customer in a form,"$price=filter_var($_POST['price'], FILTER_SANITIZE_STRING); //USER SUBMITTED sanitization stage 1.

$query=$dbh->prepare(""SELECT *  FROM $table WHERE price=?;"");
$query->execute(array($price));
"
12502,Grouping by an aggregate column,";with x as (
    select *,
    lag(widget) over(order by id) as lg
    from #t
),
y as (
    select *, sum(case when widget<>lg then 1 else 0 end) over(order by id) as grp
    from x
)
select widget, min(part), count(*)
from y
group by widget, grp
"
17502,SQL Join Statement,"SELECT bar_id, bar_name, town_name, advert_text      
FROM bar b
inner join towns t on t.town_id = b.town_id_fk 
left outer join baradverts ba on t.town_id = ba.town_id_fk 
    AND b.bar_id = ba.bar_id_fk 
"
23048,"sql server 2012 - ranking orders by year, month, supplier and location","SELECT 
  YEAR(pickup_date) AS 'PickupYear', 
  MONTH(pickup_date) AS 'PickupMonth', 
  Supplier_id,
  Location,
  COUNT(*)
FROM MyTable
GROUP BY   
  YEAR(pickup_date), 
  MONTH(pickup_date), 
  Supplier_id,
  Location
"
16807,Group by a column without including in Select list,"INSERT INTO tbl (fld1, fld2, fld3, fld4)
SELECT fld1, fld2, fld3, fld4
GROUP BY fld1, fld2, fld3, fld4, fld5
"
24407,combine rows into one row in tsql,"WITH C AS(
    SELECT 
    RANK() OVER (PARTITION BY [User] ORDER BY Email) AS [Rank]
    ,[User], Email
    FROM Emails
)
SELECT [User]
    ,MIN(CASE C.[Rank] WHEN 1 THEN Email END) AS [Email1]
    ,MIN(CASE C.[Rank] WHEN 2 THEN Email END) AS [Email2]
    ,MIN(CASE C.[Rank] WHEN 3 THEN Email END) AS [Email3]
FROM C
GROUP BY [User]
"
16907,Complex where clause with multiple joins in SQL,"select leagues.id, leagues.name, sum(goals.num_goals) from leagues
  join teams on teams.id = leagues.id
  join players on players.id = teams.id
  join goals on goals.id = players.id
group by leagues.id, leagues.name;
"
17658,sql insert into lookup tables' association tables,"insert into LookUpTable1_AssociationTable1 ([LookupId],[AssociationId])
select 
    l.Id as LookupId
    ,a.Id as AssociationId 
from
    LookupTable1 l
    cross join Association a
"
38770,PostgreSQL update time zone offset,"UPDATE <table> SET <timestamptz_field> = (<timestamptz_field> AT TIME ZONE 'UTC') AT TIME ZONE '<correct_time_zone>';
"
3015,sql update / replace row leaving some columns unaffected,"UPDATE game_data
  SET col_a = 'a', col_b = 'b'
WHERE id= 99
"
24296,MySql random category limited select,"SELECT *
  FROM (SELECT i.*
          FROM ITEM i
         WHERE i.categoryid = 1
         LIMIT 1),
       (SELECT i.*
          FROM ITEM i
         WHERE i.categoryid = 2
         LIMIT 2),
       (SELECT i.*
          FROM ITEM i
         WHERE i.categoryid = 3
         LIMIT 2)
"
29606,How to test database frontend application written with MVVM pattern?,"public class MyMVVMClass
{
    public void CreateComplexObject()
    {
        var myDatabaseObject = new MyDatabaseObject();
        myDatabaseObject.DoSomethingComplexWithTheDatabase();
    }
}
"
38734,I need a SQL statement that returns the number rows in a table with a specific value,"   SELECT t.teamid,
          t.teamname,
          COALESCE(COUNT(p.playerid), 0) AS playercount,
          t.rosterspots
     FROM TEAMS t
LEFT JOIN PLAYERS p ON p.teamid = t.teamid
 GROUP BY t.teamid, t.teamname, t.rosterspots
"
8809,Can mobile db's be modified after installation and still work?,"@Override
public void onUpgrade(SQLiteDatabase db, int newVersionNumber, int oldVersionNumber) {  
      // Do your Changes here. You can Alter table, Drop column etc
}
"
15883,Inner join returning duplicate records access sql,"SELECT DISTINCT
  Things.Prefix,
  Things.Baseletter,
  Things.suff,
  Things.CSCcode,
  Things.WT,
  Mapping.BNO-CSCcode,
  Mapping.EID 
FROM 
  Things 
  INNER JOIN Mapping ON Things.BNO-CSCcode = Mapping.BNO-CSCcode 
"
15455,Signed variables - T/SQL,"select '-1' - 2, '+1' + 2;
"
26430,Limiting rows returned in a left join in MySQL issue,"SELECT 
 T0.timestamp AS 'Creation Date', 
 T0.ipaddress, T0.code_1 AS 'Alias', 
 T0.code_2 AS 'Case ID', 
 COUNT(T0.ipaddress) AS each_amount, 
 T0.first,
 (SELECT r.res_id from responses r
  where r.case = T0.code_2
  order by r.timestamp desc
  LIMIT 1) as responses

FROM `trackings` AS T0
WHERE T0.timestamp >= '2014-04-20 00:00:00'
AND T0.timestamp <= '2014-04-30 23:59:59'
GROUP BY code_2
"
2611,"list out most matching ids first, others later","select k.*
from table k
order by (find_in_set($keyword1, replace(keywords, ' ', ',')) > 0 +
          find_in_set($keyword2, replace(keywords, ' ', ',')) > 0 +
          find_in_set($keyword3, replace(keywords, ' ', ',')) > 0
         ) desc;
"
21343,How do I create a parameterized SQL query? Why Should I?,"Public Function GetBarFooByBaz(ByVal Baz As String) As String
    Dim sql As String = ""SELECT foo FROM bar WHERE baz= @Baz""

    Using cn As New SqlConnection(""Your connection string here""), _
        cmd As New SqlCommand(sql, cn)

        cmd.Parameters.Add(""@Baz"", SqlDbType.VarChar, 50).Value = Baz
        Return cmd.ExecuteScalar().ToString()
    End Using
End Function
"
9618,Show dates older than current date in sql query,"SELECT customers.firstname, items.itemname, CustEquipment.ReturnDate, customers.phonenumber
FROM items join
     CustEquipment
     on items.ItemId = CustEquipment.ItemId join
     customers 
     on CustEquipment.customerID=customers.customerID
where ReturnDate <= trunc(sysdate);
"
19300,Merge data from two tables into single column of another table,"INSERT INTO C (Col1)
(
    SELECT Col1 from A
UNION ALL
    SELECT Col1 from B
)
"
38585,How to count from a table based on another table,"SELECT QO.Question_ID, QO.Option_Label as Choice, COUNT(*) as VotesMale
FROM Question_Options QO 
LEFT JOIN Session_Answers SA ON QO.ID = SA.Option_ID
JOIN [Session] S ON S.ID = SA.Session_ID AND S.Gender = 'M'
WHERE QO.Question_ID = 10114<---the Question ID
GROUP BY QO.Question_ID, QO.Option_label
"
28021,SQL Server ROW_NUMBER() Issue,"SELECT * 
FROM   (SELECT * , RANK() OVER (PARTITION BY batchid ORDER BY scaqry) rk 
        FROM   sayimdcpc) t 
WHERE  rk = 1
"
37562,"Batch file ""For /f"" loops each folder twice and listing files twice","For /f %%G in ('dir /s /b ""%ScriptsPath%*.sql""') do (
    echo ""%%G""
) 
"
38951,Oracle Case Statement if null select a different table,"SELECT sp1.PREF_FIRST_NAME, CASE WHEN sp1.PREF_FIRST_NAME is null 
                                 THEN s1.FIRST_NAME
                                 ELSE  sp1.PREF_FIRST_NAME 
                            END as ""Pref_Name""
FROM TABLE1 sp1,TABLE2 s1
"
3533,SELECT query with COUNT and HAVING BY,"SELECT pl.*, u.*
FROM users AS u
JOIN (
    SELECT 
        userid,
        SUBSTRING_INDEX(GROUP_CONCAT(post_id ORDER BY post_id DESC), ',', 5) AS last_5_posts
    FROM post_list
    GROUP BY userid
) AS pl5 ON(u.id = pl5.userid)
JOIN post_list AS pl ON (FIND_IN_SET(pl.post_id, pl5.last_5_posts))
ORDER BY pl.post_id DESC
LIMIT 50
"
22356,How do i insert a value in 1 table if it doesnt exist in another,"INSERT INTO table2 (id, col1)
SELECT id, col1
FROM table1
WHERE NOT EXISTS (
    SELECT 1
    FROM table2 
    WHERE table1.id = table2.id)
"
11519,Setting Minute and Second component of Timestamp field to 0,"ts - (EXTRACT(MINUTE FROM ts) * INTERVAL '01' MINUTE)
   - (EXTRACT(SECOND FROM ts) * INTERVAL '01' SECOND)
"
8038,"Calculate diffference between 2 dates in SQL, excluding weekend days","select sysdate - creation_dttm
- 2 * (to_char(sysdate, 'WW') - to_char(creation_dttm, 'WW'))
from the_table"
24182,How to get distinct and lastest record with inner join query,"SELECT customer.mobileNo, MAX(bill.iDate) AS iDate
FROM (customer INNER JOIN
                 bill ON customer.bikeNo = bill.bikeNo)
GROUP BY customer.mobileNo
ORDER BY iDate
"
8747,Deleting partial data from a field in MySQL,"UPDATE table SET fieldname = REPLACE(fieldname, '<p>This is a test</p>', '');
"
57,Copy float data to varchar from table to another after excel import,"select cast(cast(YourValue as decimal) as varchar)
"
27930,How to branch SQL query statement using conditions?,"select p.last_name
from customer c join person p on c.subject_fk = p.person and c.subject_type_fk = 0
union    
select e.full_name
from customer c join enterprise e on c.subject_fk = e.enterprise and c.subject_type_fk = 1
"
35493,Best way to parse and concatenate a string with SQL,"replace(substr(a.object_name,instr(a.object_name,',',1,1) + 1),',','-') ||'-'
"
20505,Aggregate value under different conditions,"SELECT
    SUM(case when Assignment.job_id IS NOT NULL then 1 else 0 end) AS assignedjobs,
    SUM(case when Assignment.job_id IS NULL then 1 else 0 end) AS unassignedjobs,
    COUNT(*) as totaljobs
FROM Job
LEFT JOIN Assignment ON Assignment.job_id = Job.id
"
15408,Counting multiple value occurrences,"select (case when name1 = 'JOE' then name2 else name1 end) as name,
       sum(case when name1 = 'JOE' and winner = 2 then 1
                when name2 = 'JOE' and winner = 1 then 1
                else 0
           end) as wins,
       count(*) as games
from games g
where 'JOE' in (name1, name2)
group by (case when name1 = 'JOE' then name2 else name1 end);
"
25472,Mysql update decimal by increasing by value?,"update table t
    set col = col + 0.01;
"
33174,How to be a command in SQL using LIKE?,"SELECT * FROM tablename WHERE fieldname REGEXP '^[x]{20,}$'
"
34621,SQL Rank() for multiple conditions,"SELECT EmpId,Takings,SiteID, ROW_NUMBER() OVER (PARTITION BY SiteId ORDER BY Takings DESC) AS [Rank]
FROM #test
ORDER BY EmpId ASC, Takings DESC
"
13062,How to merge Consecutive duplicate status rows - Sql Server,"SELECT ProductID, Status, MAX([Date]) AS RequestDate
FROM YourTable
GROUP BY ProductID, Status, YEAR([Date])
ORDER BY MAX([Date])
"
35244,MySQL: Return fields where COUNT(*) is greater than ,"SELECT clicks.affiliate, COUNT(*) AS hits, affiliates.title, affiliates.url
FROM clicks
INNER JOIN affiliates ON affiliates.id = clicks.affiliate
GROUP BY clicks.affiliate
HAVING hits > 10
"
36386,Retrieve previous row to subtract from current row by date,"select NAV_date, NAV_value, (NAV_value / prev_value) - 1
from (select t.*,
             (select top 1 NAV_value
              from YOURTABLENAMEGOESHERE as t2
              where t2.NAV_date < t.NAV_date
              order by t2.NAV_date desc
             ) as prev_value
      from YOURTABLENAMEGOESHERE as t
     ) as t
"
4426,Any other option is there without using Oracle Analytical function,"select a 
from tt
where B in (
            select B
            from tt
            group by b
            having count(*) >= 2);
"
36852,T-SQL statement won't accept a variable as role name in a grant statement,"declare @sql nvarchar(max)
set @sql = 'Grant select on dbo.someTable to ' + @RoleName  -- protect if required
EXEC (sql)
"
12319,Result set to be displayed in multiple textfields,"if (rs.next()) {
     String option = rs.getString(""options"");
     jAnswerA.setText(option);
};

if (rs.next()) {
     String optionB = rs.getString(""options"");
     jAnswerB.setText(optionB);
};
"
34000,Turning off an index in Oracle,"ALTER INDEX idx1 [ INVISIBLE | VISIBLE ]
"
36473,SQL Sever 2008 - How to combine rows with related data,"SELECT rs.AlertName, COUNT(1) Totals
FROM (
    SELECT CASE 
        WHEN AlertName LIKE 'Windows Services%Core' 
            THEN 'Windows Services (Core)'
        WHEN AlertName LIKE 'Windows Services%SQL' 
            THEN 'Windows Services (SQL)'
       ELSE AlertName END AlertName
    from ALERTS) RS
Group By rs.AlertName
"
1083,django DISTINCT: COUNT vs len,"n = M.objects.order_by('a').values_list('a', flat=True).distinct()
"
7899,Group By and contact rows except the default value,"SELECT  Random_ID, GROUP_CONCAT(msg SEPARATOR ' ') Msg
FROM    TableName
WHERE   Random_ID <> 0
GROUP   BY Random_ID
UNION
SELECT  Random_ID, Msg
FROM    TableName
WHERE   Random_ID = 0
"
8287,Mixing 'Like' with comparators in an iif statement?,">=IIf([forms]![TransactionsForm]![txtAmountFrom] Is Null,0,[forms]![TransactionsForm]!
[txtAmountFrom]) And <=IIf([forms]![TransactionsForm]![txtAmountTo] Is Null,9999999999,
[forms]![TransactionsForm]![txtAmountTo])
"
32302,setting up unique constraint on referenced collumns in oracle 10g xe,"CREATE UNIQUE INDEX unqIndex
    ON CompetitionsLanguages(CompetitionsLanguages, CompetitionsLanguages);
"
10852,reference multiple tables sqlite where clause,"update table_a
    set year = (select b.year from table_b b where b.mol_id = table_a.mol_a);
"
15921,Insert + Select statements in one Query<T> gives ORA-00933: SQL command not properly ended,"  var param = new DynamicParameters();
param.Add(name: ""IinsValue"", value: value, direction: ParameterDirection.Input);
param.Add(name: ""Id"", dbType: DbType.Int32, direction: ParameterDirection.Output);
param.Add(name: ""Value"", dbType: DbType.String, direction: ParameterDirection.Output);
Connection.Execute(""INSERT INTO Table(Id, Value) Values(1, :value) returning Id,Values into :id, :value"", param );
var Id = param.get<int>(""Id"");
var Val = param.get<String>(""Value"");
"
71,Return NULL data in SQL,"SELECT dboUser.User, 
    dboComputer.ComputerName 
FROM dboUser LEFT JOIN dboComputer ON dboUser.User = dboComputer.User
WHERE dboUser.User IN ('user1', 'user2', 'user3');
"
7107,Counting Only Most Recent Entries Matching Multiple Conditions,"SELECT COUNT(1)
FROM (
    SELECT PupilId AS pupil_id, Max(PeriodId) AS max_period
    FROM steph1
    WHERE PeriodId <= 100
    GROUP BY PupilId
) steph2, steph1
WHERE
PupilId=pupil_id AND
max_period = PeriodId AND
Assessment = 7
"
11303,SQL Server Ordering Based on two columns - parent and child,"select primary, secondary
from (select t.primary, t.secondary,
             max(case when tsub.primary is not null then 1 else 0 end) as hasprimary
      from t left outer join
           t tsub
           on t.secondary = t.primary
      group by t.primary, t.secondary
     ) a
order by (case when hasprimary = 1 then secondary else primary end),
         hasprimary desc,
         secondary
"
9291,mySQL query to target different keys,"p.post_author = %s and (p.post_status = 'publish' or p.post_status = 'active')
"
23229,In MySQL How do I specify Collation for WHERE-IN clause?,"WHERE email_address IN ('foo@bar.com' COLLATE utf8_general_ci, 'test@test.com' COLLATE utf8_general_ci)
"
28612,View as table with range od date for each record,";with days as
(
  select convert(datetime,CONVERT(varchar(10), getdate(), 120)+' 00:00:00') day
  union all
  select d.day+1
  from days d
  where DATEDIFF(day,convert(datetime,CONVERT(varchar(10), getdate(), 120)+' 00:00:00'), d.day+1)<=30
)
select *
from days d
  join employees e on 1=1
"
6113,How to replace a column with null values in mysql,"update question_table
    set option = 'MCQ'
    where option is null;
"
38774,I can't update multiple records in SQL,"CREATE TRIGGER trg_tbl1_closeAction
ON tbl1
AFTER UPDATE
AS
  BEGIN
    SET NOCOUNT ON
    INSERT INTO tbl2
        (tbl_1_ID, col4, usr)
        select i.ID, '10', tu.id
        from inserted i
        LEFT OUTER JOIN tbl3 tu ON tu.usr=i.LastModifiedBy
        WHERE i.col1 LIKE '%Close%';  
    END
"
35181,Approach to a Bin Packing sql problem,"SELECT SUM([Item quantity]) as totalItems
     , SUM([Item quantity]) / 160 as totalBoxes
     , MOD(SUM([Item Quantity), 160) amountInLastBox
FROM [Transactions]
GROUP BY [Transaction Id]
"
6146,How to do an IN with a subquery returning 2 columns?,"SELECT *
FROM GUITARS.FENDER
WHERE EXISTS (SELECT 1
              FROM GUITARS.GUITAR_TYPE
              WHERE GuitarColor = 'RED' AND
                    FENDER.GUITARTYPE = GUITARTYPE.GUITARTYPE AND
                    FENDER.GUITARSUBTYPE = GUITARTYPE.GUITARSUBTYPE
             );
"
28143,create a view with hard coded values without writing insert,"SELECT 'abc' as id,
        CAST(""state"" AS CHAR(2)),
        CAST(LOCALITY_NAME AS CHAR(31)),
FROM tableB
"
13899,SQL Having Clause with multiple selected fields,"SELECT field1, field2, field3, field4, field5
FROM tablename 
WHERE field1 = condition
  AND field1 IN 
       (SELECT field1
        FROM tablename 
        GROUP BY 1
        HAVING COUNT(field1) >=2 );
"
10902,Looping through multiple tables in SQLite query for HTML5 - Asynchronous timing,"var len1 = results1.rows.length;
var order_id = results1.rows.item(0).orderID;
for (var i1=0; i1<len1; i1++){          
    $('.orderItem.'+order_id+' p').append(results1.rows.item(i1).productName);                       
}
"
17790,PLSQL Replace Hours in a date,"endDate := trunc(auxDate) + textHour/24 + textMin/24/60;
"
14599,Total execution time on Client Statistics for SQL Server Management,"CHECKPOINT;
GO
DBCC DROPCLEANBUFFERS;   --Clears query cache
GO  
DBCC FREEPROCCACHE;   --Clears execution plan cache
GO
"
4771,Oracle - Updating one column or another based on a condition,"UPDATE  table_creatures
SET     animal_type = 'Dog',
        modified_by = CASE p_updater WHEN 'person' THEN 'Bob' ELSE modified_by END,
        modified_by_process = CASE p_updater WHEN 'process' THEN 'creature_package' ELSE modified_by_process END
WHERE   animal_legs = 4
"
31727,What is the appropriate way to insert identity column manually?,"INSERT INTO TCustomer
    (UnitHolderIDNo,FullName,ExternalUnitHolder)
SELECT
    UnitHolderIDNo = STC.UnitHolderIDNo
    ,FullName = STC.FullName2
    ,ExternalUnitHolder = STC.ExternalUnitHolder
FROM
    SIAR.dbo.TCustomer STC
"
36225,Get earliest timestamps for user's cards in a mysql data table,"SELECT  `username`, `card_id`, MIN(`timeStamp`)
FROM    `usercardinfo` 
WHERE   `timeStamp` between '2009-04-01' and '2009-06-01'
GROUP BY
        `username`, `card_id`
"
13727,Subselect in SQL Server,"SELECT ID, Name,
       (SELECT COUNT(*) AS Count
          FROM Client AS T2
         WHERE (RoomID = T1.ID)) AS ClientCount,
       (SELECT COUNT(*) AS Count
          FROM ClientUsage
          JOIN Client ON ClientUsage.ClientID = Client.ID
         WHERE (StateID = 1)
           AND (Client.RoomID = T1.ID)
       ) AS ClientFreeCount
  FROM Room AS T1
"
20226,Retrieve data in mysql with foreign key relationships over multiple tables?,"SELECT * FROM task_id AS taskid INNER JOIN task_in AS taskin ON taskid.id = taskin.id INNER JOIN customer AS cust ON taskin.id = cust.id WHERE id = YOUR_VALUE_HERE   
"
7489,MySQL Rank with ties,"SELECT
  score_users.uid,
  score_users.score,
  @prev := @curr,
  @curr := score,
  @rank := IF(@prev = @curr, @rank, @rank + @i) AS rank,
  IF(@prev <> score, @i:=1, @i:=@i+1) AS counter
FROM
  score_users,
  (SELECT @curr := null, @prev := null, @rank := 0, @i := 0) tmp_tbl
WHERE
  score_users.matchday = 1
ORDER BY
  score_users.score DESC
"
14291,PIVOT not performing as expected,"select *
from
(
    select entityid, [name], stringvalue as stringvalue
    from mytable
) as d
pivot
(
    min(stringvalue)
    for [name] in ([ShortDescription],[LongDescription])
)
as p
"
32713,NOT IN not work in my query,"SELECT  a.*
FROM    data a
        LEFT JOIN page b
            ON a.ID = b.data_id
WHERE   b.data_id IS NULL
ORDER   BY a.title ASC
"
27357,How to select count of two distinct columns?,"select count(distinct (COMPONENT_ID || PACKAGE_ID))
  from BILL;
"
10612,How can I write this select query in SQL Server?,"select top 10 *
from Log nolock
where ProviderId=48  -- add more conditions here
group by SessionId
having sum(case when CallType = 'A' and Status = 'Failure' then 1 else 0 end) = 0 and
       sum(case when CallType = 'B' and Status = 'Failure' then 1 else 0 end) > 0 and
       sum(case when CallType = 'A' and Status = 'Success' then 1 else 0 end) > 0;
"
32696,How to configure reference to be deleted on parent table update?,"ALTER TABLE info WITH CHECK ADD
CONSTRAINT FK_fee_info_fee FOREIGN KEY (id) REFERENCES info_fee (fee_ID) ON DELETE SET NULL
"
29553,get latest record for each ID,"SELECT *
FROM yourtable
INNER JOIN (
   SELECT MAX(timeGenerated) as maxtime, ComputerName
   FROM yourtable
   GROUP BY ComputerName
) AS latest_record ON (yourtable.timeGenerated = maxtime)
   AND (latest_record.ComputerName = yourtable.ComputerName)
"
34361,Improve/optimize LEFT JOIN in SQL Server,"SELECT *
FROM Main_Table d
    LEFT JOIN 
        (SELECT TOP 1 *
         FROM Insurances 
         WHERE INS_TERMINATIONDATE IS NULL 
             AND INS_RANK = 0
         ORDER BY TAG_SYSTEMDATE DESC) i on i.IMREDEM_CODE = d.IMREDEM_CODE;
"
4159,"Sorting top ten vendors and showing remained vendors as ""other""","WITH rank AS (SELECT
VendorName,
PayableAmount,
ROW_NUMBER() OVER (ORDER BY PayableAmount DESC) AS rn
FROM vendors)

SELECT VendorName,
rn,
PayableAmount
FROM
rank WHERE rn <= 10

UNION

SELECT VendorName, 11 AS rn, PayableAmount 
FROM
  (
  SELECT 'Other' AS VendorName,
  SUM(PayableAmount) AS PayableAmount
  FROM
  rank WHERE rn > 10
  ) X11

ORDER BY rn
"
36646,Fixing Joined Many-to-Many MySQL Query,"SELECT GROUP_CONCAT(distinct `a`.`attr`) AS `attrs` . . .
"
36487,How would I convert this query to one using sub queries?,"select p.ProductNumber, p.Name
from product p
where p.ProductSubcategoryID in (select ps.ProductSubcategoryID
                                 from productsubcategory ps
                                 where ps.Name = 'Pedals'
                                )
order by p.ProductNumber;
"
17709,How can we display user who loading the record in MDS,"CREATE TRIGGER [mdm].[SOME_NAME]
  ON  [mdm].[YOUR_BASE_TABLE]
  AFTER INSERT

AS 
BEGIN

  SET NOCOUNT ON;
  UPDATE [mdm].[YOUR_SUBSCRIPTION_VIEW]
  SET [Owner] = [EnterUserName]
  FROM [mdm].[YOUR_SUBSCRIPTION_VIEW]
  WHERE  ID = (SELECT MAX(ID) FROM [mdm].[YOUR_SUBSCRIPTION_VIEW])

END
"
3462,Formating column in SQL,"select   column1, 
         column2,
         case 
           when column3 is not null 
           then '|' 
           else '' 
         end
from your_table
"
2311,How to split one column into two columns just by counting the charachters and inserting them into another table via a SQL query?,"insert into table2
select left(column1,2), substring(column1, 3, len(column1) ) from table1
"
7219,SQL Server: join three tables,"SELECT * 
FROM 
    Table1
INNER JOIN 
    Table2 ON Table1.field1 = Table2.field2
INNER JOIN
    Table3 ON Table1.field2 = Table3.field3
"
12041,Python 3.3.2 - How to Set Out a Small Database?,"from sqlalchemy import *
db = create_engine('sqlite:///people.db')

metadata = MetaData()

user = Table('people', metadata,
Column('ID', Integer, primary_key = True),
Column('name', String(16), nullable = False),
Column('area', String(16)),
Column('job', String(60))
)
"
36512,SQL: Subquery assistance,"select
  (select count(*) from entries where contest = 18 and won = 1) as wins,
  (select sum(quantity) from prizes where contest = 18) as quantity
"
18522,Change database of a ColdFusion website,"<cfscript>
    if (cgi.path_info contains ""dwtest"") {
    dsn = ""AntibioticsTest"";
    } else {
    dsn = ""Antibiotics"";
}
</cfscript>

<cfquery name=""GetLastInsertDates"" datasource=""#dsn#"">
sql not relevent
</cfquery>
"
17022,union on the same table,"select * from mytable where id2 in
(select id2 from mytable
group by id2
having count(*)>=2)
and (id1=196 or id1=150)
"
13383,How to delete rows in associated SQL tables?,"delete 
from GlassesColor 
where GlassesID in (select GlassesID from Glasses where CollectionID = 3)
"
17012,Flattening columns in a one-to-many relationship in Oracle 10g,"  SELECT a.prjid,
         wm_concat(b.userid) AS userids
    FROM TABLE_1 a
    JOIN TABLE_2 b ON b.prjid = a.prjid
GROUP BY a.prjid
"
6021,Remove suffix from column name,"SELECT case when t1.column_name like '%\_a' then SUBSTRING(t1.column_name, 1, length(t1.column_name)-2)
            when t1.column_name like '%|a' then SUBSTRING(t1.column_name, 1, length(t1.column_name)-2)  
       else t1.column_name end
FROM information_schema.Columns t1
WHERE t1.table_name = 'myTab1' AND t1.table_schema = 'myDatabase1'
"
19455,Relational Database Design (MySQL),"Table talent_user:
- id
- user_id
- talent_id


Table subtalent_user:
- id
- user_id
- subtalent_id
"
32695,SQL Query different value from same column,"SELECT  b.Name as CustNameFrom,
        a.Product_Name,
        a.Product_Desc,
        a.ETA,
        c.Name as CustNameTo
FROM    Products a
        INNER JOIN Customer b
            ON a.cust_from = b.ID
        INNER JOIN Customer c
            ON a.cust_to = c.ID
"
37661,Count unique rows,"SELECT COUNT(DISTINCT table1.PID), table2.CID
FROM table1 
INNER JOIN table2 using (OID)
WHERE table1.PID IN (
    SELECT table1.PID
    FROM table1 
    JOIN table2 using (OID)
    WHERE table2.CID = 'A'
) AND table2.CID != 'A'
GROUP BY table2.CID;
"
33032,What is best: several tables or a really big one?,"t  | x  | prime
---+----+------
1  | 20 | 1
2  | 50 | 1
3  | 30 | 1
3  | 28 | 2
4  | 56 | 2
6  | 28 | 2
5  | 35 | 3
6  | 92 | 3
7  | 23 | 3
"
15834,SELECT CASE to ExecuteScalar(),"SELECT CASE 
        WHEN e.ELECT_BONUS_DFRL_SEQ_ID IS NULL OR MAX(e.ELECT_BONUS_DFRL_SEQ_ID) < 1
        THEN 1
        ELSE MAX(e.ELECT_BONUS_DFRL_SEQ_ID) + 1
    END AS ELECT_BONUS_DFRL_SEQ_ID
FROM ELECT_BONUS_DFRL AS e
GROUP BY e.ELECT_BONUS_DFRL_SEQ_ID;
"
35450,Display null in the column where condition doesn't satisfy,"SELECT TE.EMPLOYEE_ID, TE.FIRST_NAME, TE.LAST_NAME,
       TO_CHAR(HIRE_DATE, 'DD-MON-YYYY') as HIRE_DATE, TD.DEPARTMENT_NAME
FROM training_employee TE LEFT JOIN
     training_department TD 
     ON TE.DEPARTMENT_ID = TD.DEPARTMENT_ID;
"
26202,How to combine multiple table headers columns into 1 list,"Select name
Into output.Header_List
FROM syscolumns
WHERE id in (OBJECT_ID('input.Table1'), OBJECT_ID('input.Table2'), ....);
"
225,Postgres: getting latest rows for an array of keys,"select distinct on (uid) uid, event_id, event_data
from events 
where uid in (1,4)
order by uid, event_id DESC
"
8063,SQL JOIN: Select Records from Another Table With Matching IDs,"SELECT p.ID, p.Name, 
       c1.CategoryName as CatID1, 
       c2.CategoryName as CatID2 
from product AS p 
LEFT JOIN categories AS c1 ON p.CatID1 = c1.CatID
LEFT JOIN categories AS c2 ON p.CatID2 = c2.CatID
"
25570,Joining outer table field to subquery,"SELECT 
    t2.fldnum t2f,t3.fldnum t3f,
    T2.fldNum + T3.fldnum/2 AS fldNum
FROM 
    tblNumbers AS t2
    INNER JOIN tblNumbers AS t3
    ON t2.fldIndex+1=t3.fldIndex
        AND t2.fldLink1=t3.fldLink1
        AND t2.fldLink2=t3.fldLink2
"
35333,Alternatives to using a SQL UNION in this query?,"select u.user
from users u
inner join friends f on u.user = case f.user1 when 'Joe' then f.user2 else f.user1 end
where f.user1 = 'Joe' or f.user2 = 'Joe'
"
26677,Oracle - how to create date from an already existing date?,"select date_field + dbms_random.value * 100 from table1;
"
35062,Select and update from same field in sql,"UPDATE library
SET key = key + 1
WHERE value = 'e_book';
"
13897,SQL Inner Join and further requirements,"SELECT *
FROM   Table2
WHERE  NOT EXISTS (
         SELECT *
         FROM   Table1
         WHERE  Table1.Name = Table2.Name AND Table1.Number = Table2.ID
       )
"
14933,MYSQL IN statement with column values from another table,"SELECT name FROM table2 WHERE name IN(SELECT name FROM table1 WHERE...)
"
38955,Give an Alias to a column I've casted as a date,"Cast(create_date as date) as [Column Name Here]
"
13497,Query to output unmatched column names,"SELECT T.*
FROM MyTable T
LEFT JOIN TblCountries C ON(T.Country = C.Country AND T.CountryCode = C.CountryCode)
WHERE C.CountryId IS NULL -- Assuming you have a column by that name that's not nullable.
"
25565,Combining results of two different tables in MYSQL,"SELECT salesperson, SUM(total), SUM(Units)
FROM 
     (
        SELECT salesperson, Amount as total, Units
        FROM Transactions
        UNION ALL
        SELECT salesperson, Profit as total, 0 as Units
        FROM Connections
    ) T
GROUP BY salesperson
"
28581,Calculating distances between two tables full of GEOGRAPHY points,"select
  t1.*,
  t2.*,
  t1.GeoLoc.STDistance(t2.GeoLoc) as DistanceApart
from table1 t1
join table2 t2
on (t1.GeoLoc.STDistance(t2.GeoLoc) <= @distanceX)
"
14155,How to get the result of data from sql by month and divided into weeks,"declare @starttime datetime
"
36662,How to implement capitalization in nHibernate?,"UPDATE T_Example  
    SET MT_Lang_DE = upper(substring(MT_Lang_DE, 1, 1)) + substring(lower(MT_Lang_DE), 2, length(MT_Lang_DE)-1)
"
17283,how to generate duplicate number if same number in table sql,"SELECT id, RIGHT('0'+ CAST((ROW_NUMBER() OVER (Partition By ID Order By ID)) as varchar(2)), 2) as     duplicate_id
FROM tbl
"
36651,Rollup query having joins and calculations on column?,"Select (CASE WHEN (GROUPING(p. product_name ) = 1) THEN 'Total'
             ELSE p.product_name
        END) AS ProductName,
      sum((o.item_price - o.discount_amount )*o.quantity) as Total_Amount  
from products p inner join 
     order_items o
     on o.product_id  = p.product_id
group by p.product_name with rollup;
"
10826,how can I fill the blank space in the example below?,"UPDATE  tt
SET     [stbk#] = tt2.[stbk#]
FROM    dbo.TestTable tt
JOIN    dbo.TestTable tt2
        ON tt.sttkt = tt2.sttkt
           AND NULLIF(tt2.[stbk#], '') IS NOT NULL
"
12774,Is there any function in SQL to get a random number in a given interval?,"DECLARE @MinValue INT
SET @MinValue = 50000

DECLARE @MaxValue INT
SET @MaxValue = 15000000

SELECT @MinValue + CAST(RAND() * (@MaxValue - @MinValue) AS INT)
"
4698,Update a VARCHAR2 column using a set of NUMBERS - how to force the decimal places?,"update dcr_temp set title = to_char(amount, 'fm9999999990D00') || '/' || client_number;
"
38289,Translate Value to Name SQL,"SELECT c1.CurrencyShortcut [Currency1], c2.CurrencyShortcut [Currency2] 
    /*, other columns you need*/
FROM Spot as s
    JOIN Currencies as c1 ON s.CurrencyId = c1.CurrencyId
    JOIN Currencies as c2 ON s.CurrencyId = c2.CurrencyId
"
39743,Convert rows into columns without using PIVOT or Cased Aggregate Functions,"select customer,
       max(case when seqnum = 1 then distributor end) as distributor1,
       max(case when seqnum = 2 then distributor end) as distributor2
from (select t.*,
             row_number() over (partition by customer order by (select null)) as seqnum
      from t
     ) t
group by customer;
"
30076,SQL: Count column and show the total result,"SELECT count(*) as Titel, KuenstlerName 
FROM Bild 
GROUP BY KuenstlerName
UNION ALL
SELECT count(*) as Titel, 'Total' AS KuenstlerName 
FROM Bild
"
22347,SQL Query -- IF X is shared between two strings in a primary composite key?,"SELECT ItemCode, COUNT(*)
FROM table
GROUP BY ItemCode
HAVING COUNT(*) > 1
"
12520,Sqlite - query 1 column in two identical tables where column equals a value,"select top 1 column1, column2.. from month1 WHERE task1_done = 1 order by IdentityColumn Desc
union 
select top 1 column1, column2.. from month2 WHERE task1_done = 1 order by IdentityColumn Desc
"
33284,Checking if a word appears a column with space delimited words,"SELECT * 
FROM   emp 
WHERE  FIND_IN_SET(?, REPLACE (address, ' ', ',')) > 0
"
20521,Is it possible to include a quotation mark as part of an nsstring from server?,"int measurement = 42;
NSString *measurementDisplay = [NSString stringWithFormat:@""%d\"""", measurement];
"
8369,SQL query for Pershing sub string from a string,"DECLARE @role VARCHAR(4000) = 'a:2{s:8:""folderid"";s:28:""0B2cFhOMCK2KEOVBzbnZOczZsNkU"";s:10:""foldertext"";s:17:""Home Health Files"";}'
SELECT SUBSTRING(@role,LEN(@role)-CHARINDEX('""',REVERSE(@role),CHARINDEX('""',REVERSE(@role),0)+1)+2,(LEN(@role)-CHARINDEX('""',REVERSE(@role),0)-1)-(LEN(@role)-CHARINDEX('""',REVERSE(@role),CHARINDEX('""',REVERSE(@role),0)+1)))
"
2425,How to create a comment to an oracle database view,"comment on table  <name of your view>   
"
4381,How to query a table with cardinality one to display all the Pk while also displaying the matching elements in a table with FK,"select .....
from A left outer join B
on (A.ApkColumn=B.AfkColumn)
"
28408,comparing two string arraylists or lists,"SELECT [id], [title], [url]
FROM [Table1] t1
JOIN [Table2] t2 ON t1.[title] = t2.[title]
"
7366,Set the maximum value of the group to each group id,"SELECT ID, Value, Gr_Id, (
           SELECT MAX(Value)
           FROM tableName t2 
           WHERE t1.Gr_Id = t2.Gr_Id
) as Gr_Value
FROM tableName t1
"
33413,Returning no. of orders and average spending for each customer in a given month using mysql,"SELECT
c.customerID,
COUNT(DISTINCT o.orderID) AS number_of_orders,
SUM(i.price) / COUNT(DISTINCT o.orderID) AS my_average
FROM
customers c 
LEFT JOIN orders o ON o.customerID = c.customerID AND o.date >= '2013-03-01' AND o.date < '2013-04-01'
LEFT JOIN items i ON o.itemID = i.itemID
GROUP BY c.customerID
"
38381,SQL Get Other Rows From Aggregate Function,"select *
from mytable t1
inner join
(
  select A, max(b) B
  from mytable
  where b >50
  group by a
) t2
  on t1.a = t2.a
  and t1.b = t2.b
where t1.b >50
"
31121,SQL query to compare rows of table comparing a column values,"(select  `table l`.*  from `table l`, `table r` 
where `table l`. `sensitivity*10` > 10 and `table l`.`sensitivity*10`>`table r`.`sensitivity*10`) 

union 

(select  `table r`.* from `table r`, `table l` 
where `table r`. `sensitivity*10` > 10 and `table r`.`sensitivity*10`>`table l`.`sensitivity*10`)
"
4593,sql select with null values,"@param1 text,
@param2 text
Select * from tablle1 where field1 like @param1 and isnull(field2,@param2) like @param2 
or
Select * from tablle1 where field1 like @param1 and isnull(field2,'') like @param2 
"
31802,How to resolve this normalization issue in ER diagram,"ALTER TABLE [config].[Generator]  WITH CHECK ADD  CONSTRAINT [CK_Generator] CHECK  
(( ([PNWriterProviderId] IS NOT NULL OR [BodWriterProviderId] IS NOT NULL)
and
([PNWriterProviderId] IS NULL OR [BodWriterProviderId] IS NULL)))
GO
"
13085,MySQL statement to get min value with max ID,"select * from table where id in (
SELECT max(id)
FROM table as a
where a.price = (select min(price) from table as b where a.type=b.type)
group by type
) as t
"
1790,SQL update trigger,"UPDATE Your_Table
SET Your_Table.ProcessDate = inserted.ProcessDate
FROM Your_table INNER JOIN inerted ON Your_Table.Msisdn = inserted.Msisdn
"
37301,Want to add some conditions in MERGE statement in oracle sql for insert/update,"...
WHEN MATCHED
THEN
   UPDATE
   SET   tgt.column3= src.column3,
         tgt.column4 = src.coulmn4
   WHERE tgt.column3 IN (val1, val2) 
WHEN NOT MATCHED
...
"
18679,two specific rank should be shown on the page,"SELECT id FROM brugere WHERE Id = @id and (rank >= 3 OR rank = 1)
"
8525,Help with SQL multi-table query,"SELECT * 
FROM 
    TABLE_A a
  INNER JOIN TABLE_B b 
  ON a.column_2 = b.column_8
 WHERE 
    a.column_1 LIKE 'foo'
     and a.column_2 = 'bar'
"
12043,mySQL how to prevent insert unless combination of two columns (fields) are unique?,"ALTER TABLE my_table ADD UNIQUE account_prod (Account_Num, Prod_Num);
"
30220,How can I get join not duplicate?,"Select p.pNo
,Coalesce(l.cDate,t.lDate,'2012-10-22') as ldate
,Coalesce(l.lStart,t.cIn) as lstart
,Coalesce(l.lStop,t.cOut  ) as lstop
from peopleall p
left join leave l on l.lNo=p.Pno and l.ldate='2012-10-22'
left join fTime t on t.tNo=p.Pno and t.cDate='2012-10-22'
"
4607,Dealing with Nulls in Comparison Tests in SQL Server 2005,"IF ((ISNULL(@1, -1) <> ISNULL(@2, -1)) OR (ISNULL(@3, -1) <> ISNULL(@4, -1)))
   BEGIN
     SELECT 1;
   END
ELSE
   BEGIN
     SELECT 2;
   END
"
20054,SQL Many to Many - Very simple,"SELECT * FROM Student tp
JOIN Student_Discipline tpt on tpt.sID = tp.sID
JOIN Discipline t on tpt.dID = t.dID
WHERE tp.Name like 'John%' and t.Name = 'Math'
"
9250,SQLite Greatest-N-Per-Group for sanitising imported data,"SELECT *, MAX(timestamp)
FROM import
GROUP BY pk1, pk2
"
21204,Do I need a temporary table?,"where . . .
having distance < 10
order by distance;
"
11358,SQL Pivot Problem - multiple aggregates?,"select * 
from Example
unpivot 
(
numbers 
for type in (x,y,z)
) as p
pivot 
(
Max(numbers)
for site in ([A],[B],[C])
) as q
"
26830,What is the fastest way to update existing records with a sequence?,"WITH T
     AS (SELECT *,
                ROW_NUMBER() OVER (PARTITION BY QuestionId 
                                       ORDER BY QuestionConditionId ) AS RN
         FROM   YourTable)
UPDATE T
SET    Sequence = RN 
"
3502,Designate different connection string within SQL Query,"INSERT INTO dbo.local_table (list, of, columns)
  SELECT list
       , of
       , columns
  FROM   linked_server.database_name.dbo.not_so_local_table
"
38224,Get the entire row of the maximum value of a column in every category,"SELECT * FROM ( 
   SELECT * FROM table ORDER BY date DESC
) as t
GROUP BY t.category;
"
36184,SQL: How do I count the number of clients that have already bought the same product?,"SELECT t_current.FEATUREID, COUNT(DISTINCT t_prior.CLIENTID)
FROM table_name t_current
LEFT JOIN table_name t_prior
ON t_current.FEATUREDATE > t_prior.FEATUREDATE
AND t_current.CLIENTID = t_prior.CLIENTID
AND t_current.PRODUCTID = t_prior.PRODUCTID
GROUP BY t_current.FEATUREID
"
33474,switch DataContext according to departmentID,"if (_login.departmentID==""Orange"")
{
  OrderDBDataContext OrderDBDC = new OrderDBDataContext(""ConnectionString 1"");
}

if (_login.departmentID==""Tristar"")
{
  OrderDBDataContext OrderDBDC = new OrderDBDataContext(""ConnectionString 2c"");
}
"
4207,mysql where statement date issue,"SELECT 
    * 
FROM 
    table_name 
WHERE 
    MONTH(Display_Date) = MONTH(CURDATE())
AND YEAR(Display_Date) = YEAR(CURDATE())
"
16476,update query question,"update MEN
set Fname='ZZZ'
where Fname='aaa';
"
21782,MySQL join while counting on joined tables,"select t1.id
     , t1.title
     , count(distinct t2.product_id) as product_count 
     , count(distinct t3.contact_id) as contact_count
from t1
join t2 on t1.id = t2.rfq_id
join t3 on t1.id = t3.rfq_id
group by t1.id
       , t1.title
"
19578,Structuring a Daily Sales Database,"# On Jan 5, 2011, Provider A makes $500 total off of its products
SELECT prov.*, SUM(sales.price)
FROM
    provider AS prov
INNER JOIN
    sales_transaction AS sales on sales.provider_id = prov.id
WHERE
    provider.name = 'Provider A'
AND
    sales.created_at BETWEEN '2012-01-05 00:00:00' AND '2012-01-05 23:59:59'
GROUP BY
    prov.id
"
24181,Mysql - Add auto_increment to primary key,"ALTER TABLE Parent MODIFY Identifier smallint(10) AUTO_INCREMENT;
"
7196,SQL Server - How to perform a calculation based on a dynamic formula,"DECLARE @sql VARCHAR(MAX)

SELECT @sql = 'SELECT ' + REPLACE(REPLACE(Calculation, 'Const1', Const1), 'Const2', Const2)... + ' AS result'
FROM My_Table
WHERE ID = 1

EXEC(@sql)
"
20502,Inserting into table the values returned from stored procedure," declare @t results (field1 int, ....)

 insert @t (field1,...)
 exec pr_test 
"
4572,join between three tables,"SELECT *
FROM Equipment, Instructor, EquipInstruct
WHERE Equipment.id = EquipInstruct.Eid
AND Instructor.id = EquipInstruct.Iid
"
36248,Subquery in where clause appears to be returning nothing but running the query on its own returns data,"update people set ID = regexp_replace(ID, '[[:cntrl:]]','');
commit;
"
12949,MySQL batch update statement with different IDs,"UPDATE table_name
   SET a = CASE WHEN id = 1
                THEN 'something'
                WHEN id = 2
                THEN 'something else'
                WHEN id = 3
                THEN 'another'
           END
 WHERE id IN (1,2,3)
;
"
26597,Returning multiple columns and grouping by month,"SELECT theMonth, sum(Sales) as sumSales, sum(Purchases) as sumPurchases
FROM
 ( SELECT date_format(theDate, ""%Y-%m"") AS theMonth, Cost as Sales, 0 AS Purchases
   FROM sales, products
   WHERE sales.productname=products.productname AND category='Food'
  UNION ALL
   SELECT date_format(theDate, ""%Y-%m"") AS theMonth, 0 as Sales, Cost as Purchases
   FROM purchases
 ) AS all_costs
group by theMonth;
"
21240,Is there a way to automatically update a value based on the date?,"create view v_table as
    select t.*,
           (startdate <= curdate() then 1 else 0 end) as has_started
    from table t;
"
558,Required help in a query,"Select
    'Yes' as ""label"",
    Count(*)    
FROM Table1
Where ""date"" between '2014-03-01' And '2014-03-05'
AND col3 = 'Y' AND NOT (col1='A' AND col2 IS NOT NULL AND col2='N')
"
26255,Get the original data format of a DataColumn,"DataTable schemaTable;

String sql = ""select * from ..."";

using (SqlConnection cnx = new SqlConnection(Properties.Settings.Default.ConnectionString))
{
  using (SqlCommand cmd = new SqlCommand(sql, cnx))
  {
     cnx.Open();

     using (SqlDataReader rdr = cmd.ExecuteReader(CommandBehavior.KeyInfo))
     {
        schemaTable = rdr.GetSchemaTable();
     }
  }
}
"
39342,How do I insert a simple value to a BLOB field using the INSERT INTO statement?,"INSERT INTO A(name, file) VALUES('abcvdfdfas', BINARY 'whatever');
"
33246,Getting 1 record even a day includes 2 different record,"DATEADD(DD, DATEDIFF(DD, 0, STARTTIME), 0)  BETWEEN DATEADD(DD, DATEDIFF(DD, 0, <DATE_TIME_PARAMETER>), 0) AND DATEADD(DD, DATEDIFF(DD, 0, <DATE_TIME_PARAMETER>), 0)
"
3930,Can I search stored procedure results?,"create table #result (LogDate datetime, ProcessInfo varchar(20),Text text)

INSERT INTO #Result
EXEC xp_readerrorlog

SELECT *
FROM #Result
WHERE datepart(yy,LogDate) = '2012'
"
25668,Querying MySQL for latitude and longitude coordinates that are within a given mile radius,"SELECT id, ( 3959 * acos( cos( radians(37) ) * cos( radians( lat ) ) 
    * cos( radians( lng ) - radians(-122) ) + sin( radians(37) ) * sin(radians(lat)) ) ) AS distance 
    FROM myTable
    HAVING distance < 50
    ORDER BY distance 
"
25025,Stored procedure to return an extra column with count of foreign id in SQL,"CREATE PROC ProcName
AS 
  SELECT f.Id, f.fruitSeason, COUNT(g.fruitId) 'Total Fruits in Oranges'
  FROM @fruits f 
  LEFT JOIN @Oranges g ON g.fruitId = f.Id
  GROUP BY f.Id, f.fruitSeason
"
4469,Simplifying the case statement,"UPDATE A
    SET OAP.GradeRange = 
            CASE WHEN (ABS(CAST(A.GRADE_FROM AS INT) - CAST(A.GRADE AS INT)) > 1) AND ((grade_from NOT IN ('13','15')) OR (GRADE NOT IN ('13','15')))  THEN 'Y'  
            ELSE 'N' END  
    FROM   dbo.Table A
"
6789,joining two tables,"SELECT  u.*, 'Developer'
FROM    users u
        INNER JOIN developer d ON d.user_id = u.user_id
UNION ALL 
SELECT  u.*, 'Manager'
FROM    users u
        INNER JOIN manager m ON m.user_id = u.user_id
"
8147,"Custom output column based on whether a value exists in any record of another, unrelated table","select c.*,
       case when (select count(*) from Subscriptions s
                  where s.Email = c.Email) > 0 then 'True'
            else 'False'
       end
from customers c
"
15143,How can I find the first start time within various sequences of events?,"select vehicleId, statusId, min(StartTime) as FirstStartTime
from (select se.*,
             (row_number() over (partition by vehicleId  order by StartTime) -
              row_number() over (partition by vehicleId, StatusId order by StartTime)
             ) as grp
      from StatusEvents se
     ) se
group by grp, statusId, vehicleId
order by vehicleId, FirstStartTime;
"
7384,Sorting Records on the Basis of Number of Items in a Group- SQL Server,"Select Product_ID, Item_Name, Item_Description, Item_Number
from Product 
order by COUNT(1) over (partition by Product_ID) desc
"
29555,SQL SELECT NOW(),"SELECT CURDATE()
"
10807,How to tell MonetDB that data are sorted in the table?,"
select ""column"",""sorted"" from storage() where ""table""='yourtable';
"
22291,iPhone SQLite question,"if(appDelegate.easymediumhard == 2 && gameVarLevel == 5){

       globalScore = timeSeconds;
       scoreValid = YES;

} else {

      scoreValid = NO;

}
"
17028,Calculating a field from SQL Query Selecting from multiple tables with Union,"SELECT MTGUID * 1.35 as calculatedMTGUID, SUBSEL.* FROM (  
SELECT BKRETAIL.* FROM BKRETAIL WHERE BKRETAIL.MKEY='SOMEKEY' 
UNION  SELECT BKWHOLESALE.* FROM BKWHOLESALE WHERE MKEY='SOMEKEY') SUBSEL
ORDER BY  
case STATUS     
WHEN 'RT' then 1     
WHEN 'WH' then 2     
WHEN 'OL' then 3     
WHEN 'OD' then 4     
WHEN NULL then 5     
else 6  
end; 
"
33890,How woud I join this query in one single SQL statement?,"select c.name, n.country_iso_code
from companies c,
companies_countries x,
countries n
where x.company_id = c.company_id
and n.country_id = x.country_id
"
32332,How to select all data with inner join,"select A.h1, B.h2
from table_1 A
left join table_2 B ON A.h1 = B.h1
"
7764,"In Oracle APEX, How to check number of working hours as a Developer I spent?","Administration > Monitor Activity > Application Changes by Day / By Developer / ...
"
9118,Preventing adjacent/overlapping entries with EXCLUDE in PostgreSQL,"CREATE TABLE tbl (
   tbl_id serial PRIMARY KEY
 , tsr tsrange
 , EXCLUDE USING gist (tsr WITH &&)               -- no overlapping
 , EXCLUDE USING gist (tsr WITH -|-)              -- no adjacent
 , CHECK (lower_inc(tsr) AND NOT upper_inc(tsr))  -- enforce [) bounds
);
"
19291,Optimize SQL statement with multiple CONCAT clauses?,"SELECT * FROM pages
INNER JOIN cms_collection ON
(cms_collection.collection_id LIKE CONCAT('%', pages.page_id, '/heading%')) OR
(cms_collection.collection_id LIKE CONCAT('%', pages.page_id, '/content%'))
WHERE site_id = 51 LIMIT 10
"
37629,MySQL optimization - traverse whole table for WHERE foo IN sub-select?,"SELECT  username, timestamp, tweet
FROM    follow2 f
JOIN    tweets2 t
ON      t.username = f.followee
WHERE   f.follower = 'user1'
ORDER BY
        timestamp DESC
"
19121,Compare result of 'as' expression in 'where' statement,"SELECT (mytable.field1 + 10) AS x FROM `mytable` WHERE (mytable.field1 + 10) < 50;
"
37536,PowerBuilder application login,"n_cst_String lnv_String

ltr_NewConnect.DBMS = SQLCA.DBMS
ltr_NewConnect.AutoCommit = SQLCA.AutoCommit
ltr_NewConnect.DBParm = lnv_String.of_GlobalReplace (SQLCA.DBParm, ""mytestdb"", ""myotherdb"")
"
23035,SQL query same exposed names,"select
      T.Trades_ID1,
      N1.Name as Trade1Name,
      T.Trades_ID2,
      N2.Name as Trade2Name
   from
      Trades T
         JOIN NAME N1 on T.Trades_ID1 = N1.NameID
         JOIN NAME N2 on T.Trades_ID2 = N2.NameID
"
12743,Is there a way to make Oracle recalculate a query plan for each query invocation?,"GRANT SELECT ON table1 TO user1;
"
25759,Is there such a thing as portable SQL?,"UPDATE some_table
    SET some_column = some_column || '_more_data';
"
6116,Want to delete multiple row but not first row for same property in mysql?,"DELETE t1 FROM emailvalue t1
LEFT JOIN 
(
  SELECT email, value
  FROM emailvalue
  GROUP BY email
) t2 on t2.email = t1.email AND t2.value = t1.value
WHERE t2.value is null;
"
24548,How to update all records with a NULL value to the next existing value,"WITH B AS
(
SELECT ID, (SELECT MIN(Value) 
            FROM MyTable 
            WHERE ID > A.ID AND MyTable.Value IS NOT NULL) ValueToAssign
FROM MyTable A
WHERE Value IS NULL
)


UPDATE MyTable
SET Value = B.ValueToAssign
FROM MyTable JOIN B ON MyTable.ID = B.ID
"
5218,Sophisticated JPQL String Query,"LOWER(SUBSTRING(fs.filePath, LENGTH(fs.filePath) - (LOCATE('\\', REVERSE(fs.filePath)) - 2), (LOCATE('\\', REVERSE(fs.filePath)) - 1))) LIKE '%:query%'
"
10617,Data grid view showing columns but no data,"Private Sub frmClientDetails_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
 Dim ds As New DataSet
 objdataadapter.SelectCommand = New MySqlCommand()
 objdataadapter.SelectCommand.Connection = objconnection
 objdataadapter.SelectCommand.CommandType = CommandType.Text
 objdataadapter.SelectCommand.CommandText = ""SELECT * FROM Client_Details""
 objdataadapter.Fill(ds, ""Client_Details"")
 bind_dataset_DGVClient()
 count_records()
 rowposition = 0

 DGVClient.DataSource = ds.Tables(""Client_Details"")
"
448,How can I create a loop on an UPDATE statement that works until there is no row left to update?,"while 1 = 1
BEGIN
    UPDATE top (1000) tableToUpdate
    SET IsVegetable = 1
    WHERE 
        Date = '2011-07-23 14:00'
    AND IsNull(IsVegetable, 0) = 0

    if @@ROWCOUNT < 1000 BREAK
END
"
7988,to_timestamp -- ends in 04 or 05,"to_timestamp(txdt||hh||mm||ss, 'YYYYDDMMHH24MISS')::timestamp without time zone
"
14755,GROUP BY and get the top two row,"SELECT ap.AuthorId,
       SUBSTRING_INDEX(GROUP_CONCAT(ap.AuthorId ORDER BY ap.PublishedDate DESC
                                   ), ',', 2) as Top2Articles
FROM ArticlePage ap
GROUP BY ap.AuthorId;
"
3984,Oracle get previous day records,"SELECT field,datetime_field 
FROM database
WHERE datetime_field > (sysdate-1)
"
7016,Export data to SQL Server from Visual Studio,"Public Sub TestSql()
    Dim cnn As New System.Data.SqlClient.SqlConnection(""your connectionstring"")
    Dim cmd As System.Data.SqlClient.SqlCommand = cnn.CreateCommand()
    cmd.CommandText = ""INSERT INTO [MyTable] ( MyColumn ) VALUES ( @MyColumn )""
    cmd.Parameters.AddWithValue(""@MyColumn"", ""Hello World!"")
    cnn.Open()
    cmd.ExecuteNonQuery()
    cnn.Close()
End Sub
"
22811,Using variable in Oracle Connection Sql Query,"string query = ""select * from crm_visible_v where ownerid in (select sicilno from personel.pkim_kutlama@netdb_1.europe.nortel.com where cikis_tarihi is null start with sicilno ='""+SicilNumvber+""' connect by prior sicilno = amir)"";    
"
22950,SQL grammar for INSERT SELECT ON DUPLICATE UPDATE,"INSERT INTO tbdetail (detail, views)

SELECT detail, SUM(views) AS viewsall FROM tb GROUP BY detail

ON DUPLICATE KEY UPDATE views = views + VALUES(views);
"
10071,SQL database Structure,"id  |  word  |  parent_id
---------------------------
1   | abc    |  NULL
2   | def    |  1
"
1941,Postgres function with list argument and in clause,"CREATE OR REPLACE FUNCTION function_which_i_want(my_argument integer[])
RETURNS my_schema_and_table[] AS
$BODY$
DECLARE
result my_schema_and_table[];
BEGIN

for l in 
    select t.*
    from
        table2 t
        inner join
        unnest(my_argument) m(id) on m.id = t.id
loop
    SELECT * FROM my_schema_and_table;
END LOOP;
END;
"
4335,group by in single row with different columns,"select location_id
,MAX(CASE WHEN coordinate_type = 'lng' THEN value ELSE NULL END) AS 'lng'
, MAX(CASE WHEN coordinate_type = 'lat' THEN value ELSE NULL END) AS 'lat'
from Table1
GROUP BY location_id
"
30074,Join query explained,"FROM subscriptions 
JOIN users ON users.user_id =  subscriptions.following 

FROM subscriptions 
left JOIN users ON users.user_id =  subscriptions.following 

FROM subscriptions 
CROSS JOIN users

FROM subscriptions 
JOIN users ON users.referred by_id =  subscriptions.following 
"
