,NL,Code
5669,Getting two sums from different tables with a joining table,"SELECT t1.ValueSum1, t2.ValueSum2
FROM JoinTable jt Left Join
     (SELECT Joiningvalue, SUM(Table1.Value1) as ValueSum1
      FROM Table1
      GROUP BY Joiningvalue
     ) t1
     On jt.ID = t1.Joiningvalue LEFT JOIN
     (SELECT Joiningvalue, SUM(Table2.Value1) as ValueSum2
      FROM Table2
      GROUP BY Joiningvalue
     ) t2
     On jt.ID = t2.JoiningValue;
"
5286,Sql query with an or statement takes too long to execute,"delete from ref_table_id
where
  id in 
    ( select id from ref_table_id
      where
        ref_table_id = 1 and 
        ref_objid not in (select objid from table1)
      union all
      select id from ref_table_id
      where
        ref_table_id = 2 and 
        ref_objid not in (select objid from table2) 
    )
"
34888,Generalize SQL query to include data for all Users,"SELECT Posts.OwnerUserId,
       TagName,
       COUNT(*) AS UpVotes 
FROM Tags
    INNER JOIN PostTags ON PostTags.TagId = Tags.id
    INNER JOIN Posts ON Posts.ParentId = PostTags.PostId
    INNER JOIN Votes ON Votes.PostId = Posts.Id and VoteTypeId = 2
GROUP BY Posts.OwnerUserId, TagName 
ORDER BY UpVotes DESC
"
12903,SQL: How to select data from this 3 tables,"SELECT p.ProjectID, p.CompanyID, a.AddressID, a.Street
FROM Project p
INNER JOIN Company c
ON p.CompanyID = c.CompanyID
INNER JOIN Address a
ON ISNULL(p.AddressID, c.AddressID) = a.AddressID
"
35916,"Mysql query, populate a value based on other","update tbl t join (select post_id, meta_value
                     from tbl
                    where meta_value is not null) x on t.post_id = x.post_id
   set t.meta_value = replace(x.meta_value, '_ico', '_img')
 where t.meta_key = '_wpbdp[fields][10]'
"
9443,How to create a query with phpMoAdmin?,"array('name' => 'Smith')
"
4397,PostgreSQL Conditional Join,"select c.name, coalesce(a.address, a1. address) from contacts c
left outer join addresses a on c.address_id = a.address_id 
left outer join partners on c.name=partners.name1 
left outer join contacts c1 on c1.name=partners.name2 
left outer join addresses a1 on c1.address_id = a1.address_id;
"
31686,Laravel 4.2 open a second database connection to the main database,"$pdo = DB::connection('connection 2 name here')->getPdo();
"
32555,"using the ids returned from insert into, for record insertion with foreign key","with s(name, distance) as (
    values ('archer goblin', 10), ('dragon', 50)
), the_ids as (
    insert into monster(name) 
    select name
    from s
    returning id, name
)
insert into ranged_monster (id_monster, distance)
select id, distance
from
    s
    inner join
    the_ids using (name)
"
9769,How to update table from linking table?,"UPDATE zip_code z
SET    type_id = t.id
FROM   temp_zip_type tmp
JOIN   zip_code_type t ON t.value = tmp.temp_type
WHERE  z.zip_5_digit = tmp.temp_zip
AND    z.type_id IS DISTINCT FROM t.id;  -- avoid empty updates
"
23099,Need help writing a query,"select RESOURCE_ID from USER_ROLES where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_PLATFORMS where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_COMPETENCIES where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_TECH_SKILLS where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_MGR_SKILLS where TEST_IND ='Y'
UNION
select RESOURCE_ID from USER_APPS where TEST_IND ='Y'
UNION
select RESOURCE_ID from BUS_PROCS where TEST_IND ='Y'
"
30918,SQL Grouping by data,"SELECT
  FLOOR((ROW_NUMBER() OVER (ORDER BY EmployeeID) + 2) / 3) AS Item,
  EmployeeID,
  Employee
FROM Employees
ORDER BY EmployeeID
"
18783,MySQL go through all rows and number them,"ALTER TABLE tablename CHANGE id id INT(10) AUTO_INCREMENT PRIMARY KEY;
"
8473,Why does a FLOAT give me a more accurate result than a DECIMAL?,"SELECT (CAST(297282.26  AS DECIMAL(15, 9)) / CAST(495470.44 AS DECIMAL(24, 2))) AS ResultDecimal
"
25977,sql - select amount from each type,"select  s.name
,       s.type
from    (
        select  *
        ,       (@rn := if(@cur=type, @rn+1, 1)) as rn
        ,       @cur := type
        from    Games
        join    (select @cur := '') i
        order by
                type
        ) s
where   rn <= 2
"
22084,How to put products in a category by query,"INSERT INTO ps_category_product (id_category,id_product)
SELECT 2, ps_product_shop.id_product 
FROM ps_product_shop 
WHERE ps_product_shop.id_product > 10232 AND ps_product_shop.id_product < 10248
"
8509,Select count of dates older than x days,"SELECT count(distinct username) - 
       count(distinct case when DATEDIFF(NOW(), time) <= 30 then username end) as numusers
FROM tracking
"
16213,Suppress a duplicate row in SQL Server 2005 based on condition and list remaining rows that don't meet the condition,"SELECT SHPMNT_NO, TOT_WEIGHT, MAX(HAZARD) as HAZARD
FROM myTable
GROUP BY SHPMNT_NO, TOT_WEIGHT
"
13471,Does my trigger updates all the records,"UPDATE dbo.SubSections  
SET  SubSections.Priority = SubSections.Id 
FROM INSERTED
WHERE INSERTED.Id = dbo.SubSections.Id
"
20649,SUM data only when COUNT(*) > 0,"SELECT pr.[name], 
       SUM(COALESCE(qm.iscompleted,0)) AS count_yes,
       (case when COUNT(p.id) > 0 then 
             SUM(COALESCE(qm.iscompleted,1))
        else
             0 end) AS count_no,
       COUNT(p.id) AS tot
"
32104,Don't understand the 'AND' after the 'ON' clause in an ANSI SQL inner join syntax,"SELECT  *,
        SUM(transactions) OVER (PARTITION BY company_no ORDER BY trans_date)
FROM    transactions_tbl
WHERE   ts.company_no = 1080
        AND ts.trans_date >= '2010-08-01'
ORDER BY
        trans_date
"
29170,How does the IN predicate work in SQL?,"SELECT COUNT(*) FROM Table1 a 
WHERE a.Table1id NOT IN (
  SELECT b.Table1Id FROM Table2 b WHERE b.id_user = a.id_user
);
"
12766,Searching for list of tables from tab when only partial names of the tables are present,"SELECT COLUMN_NAME1 PATTERN, U.TABLE_NAME
FROM TABLE_NAME T, USER_TABLES U
WHERE REGEXP_INSTR(U.TABLE_NAME, '(^|_)' || T.COLUMN_NAME1 || '($|_)') != 0
"
39631,Can I flatten out header and detail records with a SQL Statement in Sql Server 2012,"; WITH headers AS (
  SELECT Name
       , Text
  FROM   dbo.Objective
  WHERE  Right(Name, 2) = '00'
)
, details AS (
  SELECT Name
       , Text
  FROM   dbo.Objective
  WHERE  Right(Name, 2) <> '00'
)
SELECT headers.Text + ' ||| ' + details.Text
FROM   headers
 LEFT
  JOIN details
    ON Left(details.name, 2) = Left(headers.name, 2)
"
35600,MySQL - delete from table Y based on results of deletion from table X,"DELETE  a, b
FROM    table1 a
        INNER JOIN table2 b
          ON a.name = b.name
WHERE   a.type = 'foo'
"
5304,"Oracle 11g, how to speed up an 'in' query","coalesce((select 'exists'
          from   veryyugetable vyt
          where  vyt.somenumber = someOtherTable.someNumber
          and    rownum = 1),
         'doesn''t exist') somecolumn
"
4158,How to find data from one table which don't exist in another table?,"SELECT * FROM data_entry 
WHERE  id NOT IN (SELECT  de_id FROM task_detail) 
"
32,Need to join 3 sql requests in one,"SELECT user.created_by AS promoter, 
COUNT(*) as total_registrations,
SUM(CASE WHEN task.status IN ('request', 'validated') THEN 1 END) AS with_photo,
SUM(CASE task.status WHEN 'new' THEN 1 END) AS without_photo
FROM user
JOIN project ON user.id = project.client_id
JOIN task ON project.id = task.project_id
WHERE task.type =  'registration'
AND(
    user.created_by =414
    OR user.created_by =415
    OR user.created_by =488
)
GROUP BY user.created_by;
"
10950,is it possible to update 2 fields in the same column in one query (mysql),"UPDATE System
SET Value = (CASE
    WHEN Variable = 'Username' THEN 'myuser'
    WHEN Variable = 'Password' THEN 'mypass'
  END)
 WHERE Variable = 'Username' or Variable = 'Password'
"
39261,"Is there any way/platform on which SQL binds can be evaluated as-needed, during query execution?","CREATE PROC MyFunc
AS
BEGIN
    SELECT * INTO #MyTempTable FROM data where data in ( ...do lots of long-running stuff);
    $boundthing='EXEC boundthing'
    select $boundthing, * from #MyTempTable
END
GO
"
8368,MySQL Select Query - Get only first 10 characters of a value,"SELECT LEFT(subject , 10) FROM tbl 
"
4309,How to add a not null constraint on column containing null values,"ALTER TABLE mytable MODIFY mycolumn NOT NULL NOVALIDATE;
"
9890,How to populate a table's foreign keys from other tables,"INSERT INTO translation (id, translated, language_id, template_id)
SELECT tmp.id, tmp.translated, l.id, t.id
FROM   tmp_table tmp
JOIN   language l USING (langname)
JOIN   template t USING (tplname, source, domain)
ORDER  BY tmp.id
"
14301,TSQL - Cast string to integer or return default value,"DECLARE @text AS NVARCHAR(10)

SET @text = '100'
SELECT CASE WHEN ISNUMERIC(@text) = 1 THEN CAST(@text AS INT) ELSE NULL END
-- returns 100

SET @text = 'XXX'
SELECT CASE WHEN ISNUMERIC(@text) = 1 THEN CAST(@text AS INT) ELSE NULL END
-- returns NULL
"
4731,Loop through Textboxes in access database," Dim c As Control
Dim txt As TextBox

For Each c In Me.Controls

    'check it's a text box ...
    If TypeOf c Is TextBox Then

        'see if including ...
        Set txt = c
        If Len(txt.Tag) > 0 Then

            'do something here (I've coloured, to show works)
            txt.BackColor = 10

        End If

    End If

Next c
"
38168,SQL Using COUNT,"SELECT
    Trains.departingStation,
    COUNT(*) AS numberOfTrains
FROM
    Trains
    INNER JOIN Services ON Trains.number = Services.number
WHERE
    arrivalStation = 'Edinburgh'
    AND
    Services.hasFirstClassService = 1
    AND
    day NOT IN ( 'Saturday', 'Sunday' )
GROUP BY
    departingStation
HAVING
    COUNT(*) >= 20
"
23049,How to select Multiple Rows based on one Column,"while($row = $result->fetch_array())
{
  $rows[] = $row;
}
"
1457,How to get sorted result based on residential address in oracle 10g?,"
SELECT YourAddress
FROM YourTable
order by TO_NUMBER(REGEXP_SUBSTR(AddressColumn, '^[0-9]+'));
"
9168,SQl Server: Add seconds to a datetime field?,"UPDATE tbluser SET DateField = DATEADD(ss,numOfSeconds,DateField)
"
37766,MySQL select column name and value as a field,"SELECT GROUP_CONCAT(temp_col) FROM
(
    SELECT 1 as 'temp_id',
    CONCAT(
      CONCAT('PO=', PO),
      ',',
      CONCAT('DAP=', DAP),
      ',',
      CONCAT('MEDIA=', MEDIA)
    ) AS 'temp_col'
    FROM test
) temp
GROUP BY temp_id
"
28637,Constraint using a Trigger,"CREATE OR REPLACE TRIGGER check_order_employee_no
  ON INSERT INTO orders
  BEFORE EACH ROW
  AS
    match_count  INTEGER;
  BEGIN
    SELECT COUNT(*)
      INTO match_count
      FROM employee
      WHERE employee_no = :new.employee_no
        AND position IN (3,4,5,6);
    IF match_count = 0 THEN
      raise_application_error( -20000, 'Employee # for order must be for a Sales employee' );
    END IF;
  END check_order_employee_no;
"
3949,SQL SELECT Between 2 Dates,"WHERE [BuildID] > 0 
AND cast([EndDate] as date) BETWEEN '2014-07-01' and '2014-07-31'
"
13478,Oracle trigger to update an entity in different table,"CREATE OR REPLACE TRIGGER update_flight_booking_info
  AFTER INSERT ON PASSENGER
  FOR EACH ROW

DECLARE
    v_flight_id number;
    v_booking_id number;
BEGIN
    v_booking_id  := :new.booking_id ;

    select flight_id into v_flight_id
    from flight_booking
    where booking_id = v_booking_id;

    update flight
    set NUM_BOOKED = NUM_BOOKED + 1
    where flight_id = v_flight_id;
END;
"
3159,GROUP BY clause on multiple joins,"SELECT CM.ClassName ,
SB.SubjectName , count(SA.Day1) as Present,
convert(varchar(10),AttendanceDate , 126)  as AttendancetimeTaken
from studentattendance SA 
inner join studentmaster SM on SA.StudentID=SM.ID  
join ProfessorMaster p on SA.ProfessorID =p.Id 
join Classmaster CM on SA.ClassID = CM.ID 
inner join SubjectMaster SB on SA.SubjectID =SB.ID
where SA.day1 = 'P'
group by CM.ClassName, SB.SubjectName, AttendanceDate
"
25661,Auto increment an ID with a string prefix in oracle sql?,"CREATE SEQUENCE CREATE SEQUENCE usertable_seq
START WITH 1
INCREMENT BY 1
NOCACHE
NOCYCLE;
/

CREATE OR REPLACE TRIGGER usertable_trigger  
BEFORE INSERT ON UserTable
FOR EACH ROW

BEGIN
  SELECT 'user' || to_char(usertable_seq.NEXTVAL, '000099')
  INTO   :new.userID
  FROM   dual;
END;
/
"
7014,How to concat a specific number to existing values for a particular column for all rows,"UPDATE Student SET Student_ID = CONCAT('11', Student_ID);
"
6463,ORA-22163: left hand and right hand side collections are not of same type,"CREATE TYPE col_sub_type IS TABLE OF VARCHAR2(50);
"
16608,How to populate a database column with random numbers,"---- Create the variables for the random number generation
DECLARE @Random INT;
DECLARE @Upper INT;
DECLARE @Lower INT;
DECLARE @Index integer

---- This will create a random number between 1 and 999
SET @Lower = 1 ---- The lowest random number
SET @Upper = 999 ---- The highest random number
SET @Index = 0 --- A while loop counter

--- Loop from 0 to 10
WHILE @Index < 10
BEGIN
  SELECT 'loop counter = ', @index
  SELECT @Random = ROUND(((@Upper - @Lower -1) * RAND() + @Lower), 0)
  --Insert @Random here.
  SET @index = @index + 1
END
"
4600,@SET (SQL) in PHP,"SELECT id from users where timemodified >= UNIX_TIMESTAMP(SUBDATE(curdate(), 28))
"
18102,Two foreign keys of the same table. How do I write this SELECT statement?,"SELECT u.username, i1.path AS thumb, i2.path AS full
  FROM users AS u
    JOIN images AS i1 ON u.thumb_id = i1.image_id
    JOIN images AS i2 ON u.fullimage_id = i2.image_id
"
37695,how to return (F1) from 113 key value ?,"((Keys)e.KeyValue).ToString();
"
9973,"Access- ""Join expression not supported""","SELECT e.ID,
    ByWho,
    [Date]
FROM ContactSummaries e
inner join (SELECT ID,
        MAX([Date]) AS LastContact
    FROM ContactSummaries
    GROUP BY
        ID) lu
  ON (e.ID = lu.ID AND e.Date = lu.LastContact)
"
16803,How does group by statement in SQL affect the results ?,"select 
  col1, col2, col3, 
  sum(col8) as total8 
from A 
group by col1, col2, col3
"
38433,How to return the highest value for every different row parameter,"SELECT Year, Max(TotalFreight) as [Total Freight]
FROM (
select YEAR(O.Orderdate) [Year] , SUM(O.Freight) [TotalFreight]
from Orders O inner join Shippers S on S.ShipperID = O.ShipVia
group by S.CompanyName, YEAR(O.Orderdate) T
group by Year
"
26104,Update column with values from another column using a cursor," select rowid, 
 DENSE_RANK () OVER (ORDER BY column1, column2) groupnum
 column1, column2, ROW_NUMBER () OVER 
 (PARTITION BY column1, column2 ORDER BY rowid) seqnum
 from table1
 where (column1, column2) in 
 (select column1, column2 
 from table1 
 group by column1, column2 
 having count(*) > 1)
"
17141,sql replace cell value with column name and avoid null values,"select  PF
,       HireDate
,       replace(
            iif(Writing is null;'';'Writing, ') +
            iif(Swimming is null;'';'Swimming, ') +
            iif(KickOff is null;'';'KickOff, ') +
            iif(Shopping is null;'';'Shopping, ') + '$';
            ', $'; '')
from    Agents a
join    Skills s
on      s.PF = a.PF
"
35975,Oracle SQL: select from table with nested table,"select t.""ID"", tt.myid, tt.myname 
from ""T_TABLE"" t, table(t.""NAME"") tt;
"
4267,"How to get values from tables A and C, joined by table B with default values from C when C has no key from A","select
coalesce(c.State, 'default value')
from
a
left join b on a.id = b.A_id
left join c on b.B_id = c.B_id
"
26253,SQL group dates as week date,"SELECT DAYOFWEEK('2007-02-03');
"
38504,EF 6.1 Index IsUnique not being generated,"class Role
{
    [Key]
    public int Id { get; set; }

    [MaxLength(127)]
    [Index(IsUnique = true)]
    public string Name { get; set; }       

    public virtual ICollection<User> Users { get; set; }
}
"
25382,sql for finding sum for each unique timestamp,"select site,
  sum(products) num_products,
  sell_time
from yourtable
where site = 'tokyo'
group by site, sell_time
"
29374,Can Compare the date and time in While Loop?,"declare @starttime datetime = '1/1/2015 11:00 PM'
declare @endtime datetime = DATEADD(d, 1, @starttime)

while @starttime <= @endtime
begin
select @starttime
set @starttime = DATEADD(HOUR, 2, @starttime)
end
"
446,MySQL rooms availability for range,"select a.title, ifnull(sum(datediff(least(b.end, '2014-06-30'), a.start) + 1),0) days_taken
from rooms a
left join rooms_booking b on a.id = b.rooms_id
where b.start >= '2014-06-15' and b.start <= '2014-06-30'
group by a.title
having days_taken <= datediff('2014-06-30', '2014-06-15');
"
22500,Group By from two tables,"SELECT COALESCE(t1.branch, t2.branch) branch, 
       COALESCE(t1.ordercount, 0) OrdersCountInTable1, 
       COALESCE(t2.ordercount, 0) OrdersCountInTable2
  FROM
(
  SELECT branch, COUNT(orderno) ordercount
    FROM Table1
   GROUP BY branch
) t1 FULL JOIN
(
  SELECT branch, COUNT(orderno) ordercount
    FROM Table2
   GROUP BY branch
) t2
 ON t1.branch = t2.branch
"
26836,Return union query into multiple columns,"select 
max(case when csv not in(select orderid from mg_orders) then csv end) as csv1,
max(case when csv not in(select orderid from lab_orders) then csv end) as csv2,
max(case when csv not in(select orderid from pcg_pharmacogenetics) then csv end) as csv3,
max(case when csv not in(select orderid from well_wellness) then csv end) as csv4
from csvdata
"
10845,Count number of occurences of a character in SQL string value?,"select len('you.late.you@asdf.com') - len(replace('you.late.you@asdf.com', '.', ''))
"
546,Union with a timediff statement in MySQL,"select TIMEDIFF(time2,time1) as diff, t.* from mytable t;
"
2239,Get all records for Top N Distinct values,"select t1.bookid, t1.authorid
from BookAuthor t1
inner join
(
  select distinct top 2 bookid
  from BookAuthor
  order by bookid
) t2
  on t1.bookid = t2.bookid
"
21258,Compare two time data types in sql,"DECLARE @dt1 datetime
DECLARE @dt2 datetime
SELECT @dt1 = '20090316 12:00:00.000', @dt2 = GETDATE()

SELECT CONVERT(varchar(12), DATEADD(ms, DATEDIFF(ms, @dt1, @dt2), 0), 114)
"
38280,using a loop in a stored procedure,"declare @start DATETIME = '2012-02-01'
declare @end DATETIME = '2013-02-01'
;with cte (date)
AS
(
    SELECT @start
    UNION ALL
    SELECT DATEADD(mm,1,cte.date)
    FROM cte WHERE DATEADD(mm,1,cte.date)<@end
)
select * from cte
"
19152,IF..ELSE-statement in SQL SELECT?,"$sql = ""
SELECT * FROM status 
WHERE author in (
        SELECT CASE WHEN user2 = '$log_username' THEN user1 ELSE user2
               END
         FROM friends 
        WHERE user1='$log_username'
          AND accepted='1' 
           OR user2='$log_username' 
          AND accepted='1'
    ) AND type='a' 
"";
"
32293,How to fit multiple equal references into table structure?,"FellowshipId   KidId
     1            1
     1            2
     2            3
     2            4 
     2            5
     . . .
"
23947,What is a good design for Ranking System,"SET @rownum := 0;

SELECT rank, userId, point 
FROM (
       SELECT @rownum := @rownum + 1 AS rank, userId, point
       FROM user ORDER BY point DESC
     ) 
as result WHERE userId = xxxxxxxx
"
25762,MySQL join 4 tables,"select o.callId , o.timestamp , o.duration ,o.callNote ,
o.state,o.contactId,
  j.firstName , j.lastName ,j.company Id as company,
  j.email, j.contactNote,

r.number

from calls o 
left outer join contacts j 
  on o.contactId =j.contactId  
left outer join numbers r 
  on j.contactId=r.contactId;
"
6148,SQL Server Management Studio: The multi-part identifier could not be bound,"select FirstName +' '+ LastName as FullName 
from EMPLOYEE
INNER JOIN PROJECT
on EmployeeID = PROJECT.Manager
group by FirstName +' '+ LastName
Having count(PROJECT.Manager) >= 2
"
30583,update column of table with other column,"UPDATE A SET A.col2 = B.col2
FROM TableA A INNER JOIN TableB B ON A.col1 = B.col1 
"
24654,Replace row value with empty string if duplicate,"select (case when row_number() over (partition by ProductCode order by (select NULL)) = 1
             then ProductCode
        end) as ProductCode
       Color
from Product
order by ProductCode;
"
4466,Setting one column value after another,"CREATE TRIGGER id_root_same AFTER INSERT ON categories 
FOR EACH ROW SET root = NEW.id;
"
34911,UPDATE Multiple Rows Using CASE in SQL 2008,"UPDATE Cars
SET  engineSize = CarSpecs1.value, colour = CarSpecs2.value
FROM Cars
INNER JOIN CarSpecs CarSpecs1 
    ON CarsSpecs1.carID = Cars.carID AND CarsSpecs1.specCode =1
INNER JOIN CarSpecs CarSpecs2 
    ON CarsSpecs2.carID = Cars.carID AND CarsSpecs2.specCode =2
"
7233,How to switch between two field value under some condition?,"SELECT ID, CASE WHEN nvl(doc_after,'') <> '' THEN doc_after ELSE doc_before END AS doc
, CASE WHEN nvl(doc_after) <> '' THEN 'doc_after' ELSE 'doc_before' END AS camefrom
FROM yourtable
"
2667,convert datediff minutes to 100 base format in sql,"Declare @Start DateTime='02-03-2014 14:25:00'
Declare @End DateTime='02-03-2014 20:29:00'

SELECT DATEDIFF(s,@Start,@End)/3600.00
"
27303,How can i do this query by pure sql?,"WITH cte as
    (
    select [first], [second], [first] - [second] as result,
        ROW_NUMBER() OVER (ORDER BY second, first) AS sequence
    from tableo
    )

SELECT t.[first], t.[second], SUM(t2.result) AS result
from cte t
JOIN cte t2 on t.sequence >= t2.sequence
GROUP BY t.[first], t.[second]
"
20093,Get CLOB data in a text/xml file,"use DBI;
my $db = DBI->connect('dbi:Oracle:tnsname','user','password',{RaiseError=>1});
my $txt = ($db->selectrow_array('select my_clob_col from my table where ...'))[0];
$db->close;
open my $fh, '>out.txt' or die $!;
print $fh $txt;
close $fh;
"
5925,SQL - How can I query for all objects who have COUNT(0) of related objects in a reverse relationship?,"SELECT *
FROM person p
WHERE NOT EXISTS
    (
        SELECT h.person_id
        FROM helmet h
        WHERE h.person_id = p.id
            AND is_safe = true
    )
LIMIT 100
"
2110,"SQL joining three tables to result in two columns, based on a DATE condition","SELECT 
  CASE WHEN table_x.date_column > GETDATE() THEN table_y.some_column 
                                            ELSE table_z.some_column END
FROM table_x JOIN table_y JOIN table_z (insert appropriate join clauses)
"
15581,SQL Update  table field x where field y is z,"UPDATE Cities SET County_Id = 20 WHERE Cities.Code >= 10000 AND Cities.Code < 20000
"
22575,Turning MYSQL query backwards to get different return,"SELECT IF(EXISTS (SELECT * FROM it_survey WHERE user_id = 7), 0, 1)
     + IF(EXISTS (SELECT * FROM lvis_survey WHERE user_id = 7), 0, 1)
     + IF(EXISTS (SELECT * FROM supplies_survey WHERE user_id = 7), 0, 1) AS unposted_surveys
"
3430,How do I delete a fixed number of rows with sorting in PostgreSQL?,"DELETE FROM logtable
WHERE ctid IN (
    SELECT ctid
    FROM logtable
    ORDER BY timestamp
    LIMIT 10
)
"
24271,Get part of a string in a sql statement based on a character,"SELECT SUBSTRING_INDEX(SUBSTRING_INDEX(cc.path,'/',3),'/',-1)
"
5388,selecting values after integer using substring,"select id,substring(street,charindex(' ',street)+1,6) from #t
"
22774,SQL to insert into table from two tables in ascending order,"WITH Table1Ranked AS (
  SELECT
    ID,
    rn = ROW_NUMBER() OVER (ORDER BY ID)
  FROM Table1
),
Table2Ranked AS (
  SELECT
    ID,
    rn = ROW_NUMBER() OVER (ORDER BY ID)
  FROM Table2
)
INSERT INTO MapTable (Table1ID, Table2ID)
SELECT t1.ID, t2.ID
FROM Table1Ranked t1
  INNER JOIN Table2Ranked t2 ON t1.rn = t2.rn
"
3304,Column Names in SQL Query,"select 
(select GETDATE()) as Date,
(select 
    ROUND(sum(QuantityInStore * AveragePrice),2)
from 
      inventoryinfo, 
      InventoryStoreInfo 
WHERE 
      InventoryCategoryID IN 
      ('3','6','19','22','23','40','32','56','52','41')
 ) as Photo
"
34192,How do I clone an entity that has a client-generated GUID as its ID? (Model-first),"INSERT INTO dbo.SomeTable(ID, Col1, Col2, ...., ColN)
   SELECT
       NEWID(), -- get a new GUID for the new row
       Col1, Col2, ...., ColN
   FROM 
       dbo.SomeTable
   WHERE
       ID = (some value defined here)
"
603,Why we can not fetch more than one value at a time in PL SQL?,"PROCEDURE process_all_rows
IS
   TYPE employees_aat 
   IS TABLE OF employees%ROWTYPE
      INDEX BY PLS_INTEGER;
   l_employees employees_aat;
BEGIN
   SELECT *
   BULK COLLECT INTO l_employees
      FROM employees;

   FOR indx IN 1 .. l_employees.COUNT 
   LOOP
       analyze_compensation 
      (l_employees(indx));
   END LOOP;
END process_all_rows;
"
17992,setting up a default value of a column in select statement,"SELECT name, city, addr, 12345 AS ph_no
FROM table1
"
32941,how to take all values from sql table column on condition?,"select 
*
from [vwMYDATA] 
where
Path like '%' + @path + '%' and
((@status IS NULL )OR (Status = @status or status IS NULL))
"
26294,Numbering duplicates record in mysql,"SELECT 
ID,
Name,
age,
( 
CASE Name 
WHEN @curType 
THEN @curRow := @curRow + 1 
ELSE @curRow := 1 AND @curType := Name END
) + 1 AS sequence_No

FROM student, (SELECT @curRow := 0, @curType := '') r
ORDER BY  ID,NAME;
"
25428,Better way SQL insert query,"INSERT INTO PERSON (ID, NAME, ADDRESS) 
VALUES ('001', 'Smit', 'London'), ('002', 'Jhon', 'London');
"
870,SQL query group by multiple time periods,"select productId,
       sum(case when salesdate >= dateadd(month, -1, getdate()) then quantitysold else 0 end) as qs1m,
       sum(case when salesdate >= dateadd(month, -3, getdate()) then quantitysold else 0 end) as qs3m
       sum(case when salesdate >= dateadd(month, -12, getdate()) then quantitysold else 0 end) as qs12m
from table t
group by productId;
"
26880,SQL Server Group By Query Select first row each group,"SELECT StudyID, Year, minAccess1, minAccess2, minAccess3
FROM (
   SELECT StudyID, Year, min(Access1) minAccess1, min(Access2) minAccess2,
          min(Access3) minAccess3, 
          ROW_NUMBER() OVER (PARTITION BY StudyID ORDER BY Year DESC) AS rn 
   FROM mytable
   GROUP BY StudyID, Year ) t
WHERE t.rn = 1
"
4036,How can I rearrange the numerical data of some columns,"select row_number() over (order by BookId) - 1 as BookId, BookTitle
from books b;
"
6429,How to implode a query result inside a mysql5 stored procedure?,"SELECT GROUP_CONCAT(id ORDER BY id DESC SEPARATOR ',') FROM temp;
"
8988,SQL(DB2) WHERE clause optimization,"WHERE 
  FOO = 'Y'
  AND iline = CASE iitem
                WHEN ? THEN ?
                WHEN ? THEN ?
                ...
              END
"
10967,"In a Many to Many relationship, how can records collectively owned be selected","SELECT b.*
FROM books b
INNER JOIN
  (SELECT book_id, COUNT(*) as cnt 
  FROM user_has_book 
  WHERE user_id IN ('Frank', 'Joe')    
  GROUP BY book_id
  HAVING cnt=2)x ON (x.book_id = b.book_id)
"
8927,SQL SELECT ORDER BY multiple columns depending on value of other column,"SELECT *
FROM vehicle
ORDER BY
  `revisit` DESC,
  CASE WHEN `revisit` = 1 THEN LEAST(`FL`, `FR`, `RR`, `RL`) END ASC,
  CASE WHEN `revisit` = 0 THEN `date` END ASC
"
17753,MAX(COUNT(*)) in Oracle,"select token_id, 
   MIN(tag_variable_type_id) KEEP (DENSE_RANK LAST ORDER BY usage) AS tag_variable_type_id,
   MAX(usage) AS usage from ( select tt.token_id, tt.tag_variable_type_id, count(*) as usage from tokens tt left outer join token_xref ttx on ttx.token_id = tt.token_id where tag_variable_type_id in (1, 2, 3) and ttx.template_id = 52 group by tt.token_id, tt.tag_variable_type_id ) group by token_id ;
"
25289,Sql select 2 tables,"SELECT p.[UserID]   AS'UserID',
       p.[UserName] AS'Name',
       f.[UserID]   AS 'RO',
       f.[UserName] AS 'RO_UserID'
FROM   [RF_ROTeacher]
       LEFT JOIN PPUser f
              ON RF_ROTeacher.ROID = f.PUID
       LEFT JOIN PPUser p
              ON RF_ROTeacher.UserID = p.PUID 
"
18406,Calculate or setup overlap calculation in MS Access,"select t1.code as code1, t2.code as code2, count(*) as NumOverlaps
from table1 as t1 inner join
     table1 as t2
     on t1.name = t2.name and t1.state = t2.state and t1.code < t2.code
group by t1.code, t2.code;
"
36019,MySQL: Retrieve data from multiple tables,"SELECT Portfolio.*,Client.name as ""Client Name"",Provider.name as ""Provider Name""
FROM Portfolio
INNER JOIN Client ON Portfolio.Client_id=Client.id
INNER JOIN Provider ON Client.Provider_id = Provider.id
"
108,How to select top record of same group?,"SELECT t1.*
FROM table AS t1
INNER JOIN (
    SELECT MIN(ID) AS MinID
    FROM table
    GROUP BY GroupNo) AS t2
ON t1.id = t2.MinID
"
24330,SQL Server 2000 - Update rows and return updated rows,"BEGIN TRANSACTION

SELECT * FROM TABLE WITH (ROWLOCK, READPAST, UPDLOCK) WHERE Locked = 0

UPDATE TABLE
SET Locked = 1
WHERE Locked = 0

COMMIT TRANSACTION
"
27593,"Oracle - Unique values from a single column, but returning other columns","SELECT *
  FROM (SELECT person,
               type,
               color,
               RANK() OVER( PARTITION BY person
                                ORDER BY type asc ) rnk
          FROM <<person_table>>)
 WHERE rnk = 1
"
14219,In SQL Where if date then compare dateColumn1 else compare with dateColumn2,"Select * From table Where case when @dateStart > '1/01/2014' then dateCol1 else dateCol2 end
between @dateStart and @dateEnd
"
35883,Build .SQL File with Batch file not working,"type Procedures\*.sql >> proc.sql
type Views\*.sql >> view.sql
type proc.sql >> Build.sql
type view.sql >> Build.sql
"
18491,store and fetch bold/italic font from sqlite database,"<p><strong>An HTML-encoded string</strong> inside a paragraph.</p>
"
28038,How to simplify this query with sql joins?,"select t1.id
from my_table as t1
join my_table as t2 
  on t1.value2 = t2.value2
  and t2.name = 'a_name'
  and t1.value < t2.value
"
22755,Get Week Before Last,"AND E.EventCreatedDateD between DATEADD(day, -31, GETDATE()) AND DATEADD(day, -14, GETDATE())
"
22728,T-SQL - SELECT by nearest date and GROUPED BY ID,"DECLARE @Date DATE = '10/01/2010';

WITH cte AS
    (
    SELECT ID, LinkedID, ABS(DATEDIFF(DD, @date, DATE)) diff,
        ROW_NUMBER() OVER (PARTITION BY LinkedID ORDER BY ABS(DATEDIFF(DD, @date, DATE))) AS SEQUENCE
    FROM MyTable
    )

SELECT *
FROM cte
WHERE SEQUENCE = 1
ORDER BY ID
;
"
6388,Get all userid friends give unnexpected result,"SELECT  id, fid, name
FROM users,friends where users.id=friends.fid
WHERE users.id = 33456
"
7941,"Convert SQL to Linq, with left join","from item in butik.preferences
select new
{
    Pref = butik.preferences.pref,
    IsSelected = 
        butik.userprefences.Any(up => up.pref == item.id && up.userid == 2)
        ? butik.userpreferences.First(up => up.pref == item.id && up.userid == 2).selected
        : false;
}
"
9034,SQL query to find users with certain values in another table,"SELECT `id`, LTRIM(RTRIM(`name`)), COUNT(`id`) AS `total`
FROM `tmc_users` u
LEFT JOIN `tmc_user_usergroup_map` g
  ON u.`id` = g.`user_id`
WHERE g.`group_id` = 12 AND 
     NOT EXISTS (SELECT 1
                 FROM `tmc_user_usergroup_map` AS t
                 WHERE t.`user_id` = u.`id` AND t.`group_id` = 17)
ORDER BY LTRIM(RTRIM(`name`)) ASC
"
23989,How to separate data from one column result into multiple columns?,"SELECT  *
FROM    (   SELECT row_number() over(order by AMPS) row_no, * 
            FROM @table1 t1 where t1.Feed = 'A' ) T1
    INNER JOIN (SELECT row_number() over(order by AMPS) row_no, * 
                FROM @table1 t2 where t2.Feed = 'B' ) T2
        ON T1.row_no = T2.row_no
"
13387,update column with other column,"update table t
    set d = (select count(distinct b)
             from table t2
             where t2.a = t.a and
                   t2.b <= t.b
            ) ;
"
29430,Find the last selling price of an item,"select t.*
from (select t.*,
             row_number() over (partition by item order by invoice desc, line desc) as seqnum
      from t
     ) t
where seqnum = 1;
"
16044,Query To Return Multiple Values From A Single Column Based On Value Of Another Column,"select startDt.EntryDate as StartDate,
       endDt.EntryDate as EndDate
from table startDt
inner join table endDt
on startDt.id = endDt.id
where startDt.ChecklistDay = 1
and endDt.CheckListDay = 10
"
34796,How to query multiple tables with a single query,"users (userId, name)
movies (movieId, movieInfo)
recommendations (fromUserId, toUserId, movieId, comment)

SELECT fromUser.name, toUser.name, m.movieInfo, r.comment
FROM recommendations r
INNER JOIN movies m ON m.movieId = r.movieId
INNER JOIN users fromUser ON r.fromUserId = fromUser.userId
INNER JOIN users toUser ON r.toUserId = toUser.userId
WHERE r.toUserId = << my user id, or whatever your criteria are >>
"
35307,Does grails/SQL automatically know which indices to use?,"static mapping = {
        firstName index: 'name_idx'
        lastName index: 'name_idx'
        description index: 'name_idx'
}
"
29279,How to using subquery values in arithmetic operations,"select Carikod, Unvani, mtoplam, stoplam, mtoplam - stoplam as Grand_total
from
(
    -- your full query here
) T
"
39436,Selecting not null column,"SELECT COALESCE(A, CAST(B As varbinary(max)))
"
34635,Group records into three predefined buckets in Postgres,"SELECT 
    CASE WHEN min(score) <= 150 THEN '*-150'
         WHEN min(score) <= 350 THEN '151-350'
         ELSE '350-*'
         END AS scorerange, #A comma is needed here right after scorerange
    count(*)
FROM scores
GROUP BY score <= 150, score <= 350;
"
36239,Finding Rows containing % symbol in a table,"select * from tablename where columnname like '%[%]%'
"
29569,Access query to email,"Dim rS as DAO.Recordset
Dim dbS as DAO.Database
Set dbS = CurrentDb()
Set rS = dbS.OpenRecordset(""Select DISTINCT emailaddress FROM <yourquery>"",DbOpenSnapshot)
Do While Not rS.EOF
<sometempvar> = rS!emailaddress
'your code to email filtered report using <sometempvar>'
rS.MoveNext
Loop
Set rS = Nothing
Set dbS = Nothing
"
35309,Using an equality check between columns in a SELECT clause,"case when FirstEvent.TitleID = SecondEvent.TitleID then 1 else 0 end as titlesSameCheck 
"
22029,What is the best JOIN for this? (Many to Many) MYSQL,"select p.*, hr.*, s.*
from procedure p
left outer join hr on p.procedure_id = hr.procedure_id
left outer join staff s on hr.staff_id = s.staff_id
"
32658,SQL - Reference current row in a computed column with SELECT,"DeadlineDate COMPUTED BY ((
select first 1 AddMonth(contract.BeginDate, DeadlineMonths)
from addendums contract
where contract.projectid = projects.projectid
order by contract.BeginDate ))
"
32486,select distinct elements from two columns with comma separated in sql,"DECLARE @val nvarchar(max)
SELECT @val = COALESCE(@val + ',' + col1, col1)
FROM (SELECT col1
      FROM dbo.twoColumns
      UNION
      SELECT col2
      FROM dbo.twoColumns
      ) x
SELECT @val
"
37274,MySQL DELETE in a single table,"DELETE
    FROM userurltag USING userurltag
    JOIN
        (SELECT userID
         FROM userurltag
         GROUP BY userID HAVING COUNT(*) < 3) as tmp
ON userurltag.userID = tmp.userID;
"
12071,Converted Pages in Books,"select * from Book as b
where not exists
 ( select * from BookPage as bp
   where b.Id = bp.BookId
     and bp.Text is null
 )
"
25676,SQL Error on Audit Trail Insert after Scope_Identity(),"Insert Input(OpenedByName,Owner,Description,WorkOfDate)
OUTPUT inserted.* INTO InputAuditTrail /*Inserts to Audit Table*/
OUTPUT inserted.* /*Returns to Client*/
Values (@vOpenedByFirstName,@vOwner,@vDescription,@vWorkOfDate)
"
23923,where is my database saved when I create it in MySQL?,"datadir = /var/lib/mysql
"
9497,SELECT DISTINCT: control priority when there are accents?," SELECT name FROM city_i18n
 WHERE (name != (SELECT name FROM city_i18n WHERE ID = 2745 AND culture = 'es_ES') 
        OR culture = 'es_ES')
 AND ID = 2745 AND culture IN ('es_ES', 'en_GB');
"
33309,Ms-Access SQL Query,"SELECT top 1 Title, ExpiryDate  
FROM Table1  
WHERE PublishDate<=Date() 
AND ExpiryDate>=Date() 
ORDER BY ExpiryDate ASC 
"
4859,update table by giving old and new entry from query,"UPDATE OTHER_TABLE t1
SET some_column = (SELECT t2.new FROM SOME_TABLE t2 
                   WHERE t2.old = t1.old_value_column)
"
19520,SQL query to count number of different values,"SELECT x, COUNT(DISTINCT y) AS cnt_y
FROM yourtable
GROUP BY x
"
2122,How can I join A with B and also B with C at one time?,"SELECT Product.title, User.username, Order.id
FROM Order
INNER join Product ON Order.ProductID = Product.ID
INNER JOIN user ON Product.UserID = User.ID
"
13810,Sql query to get a non-contiguous subset of results,"select FOO from BAZ limit 50
    union
select FOO from BAZ limit 50, 1
    union
select FOO from BAZ limit 99, 1
    union
select FOO from BAZ limit 100, 1
    union
select FOO from BAZ limit 149, 1
"
38550,Get private message group by user MySQL/PHP,"select * from messages 
where message_id in(select max(msg.message_id) from messages msg
                    where msg.receiver_id = 3 group by sender_id )
"
36929,Combine 2 requirements in 1 query,"SELECT t1.column_name, ch.id
FROM information_schema.Columns t1
LEFT JOIN checkbox ch
  ON t1.column_name = ch.column
WHERE t1.table_name = 'tab_col'
ORDER BY t1.column_name;
"
25310,Sql Query Solution,"SELECT
    T1.Month,
    SUM(CASE T1.GROUPTYPE WHEN 'Income' THEN T1.TOTAL ELSE 0 END) AS Income,
    SUM(CASE T1.GROUPTYPE WHEN 'Expense' THEN T1.TOTAL ELSE 0 END) AS Expense
FROM (/* Your query here */) AS T1
GROUP BY T1.Month
"
11296,Sum with expression and group by in Access 2007 / VBA,"UPDATE mt
SET rc='DAR'
WHERE  Account IN
(
  SELECT mt.account
  FROM 
    (
    SELECT mt.Account, SUM(mt.[amount]+Nz(mt.[SFS],0)) as total
    FROM mt
    GROUP BY mt.Account
    )    
  WHERE total>=500
);
"
11506,"need sql, a tricky one","SELECT s.supplierno
FROM supplier AS s
JOIN part_supplier AS ps
  ON s.supplierno = ps.supplierno
JOIN part AS p
  ON ps.partno = p.partno
GROUP BY s.supplierno
HAVING COUNT(DISTINCT p.color) = 1 -- only one color for all parts
"
4782,How to join data from three different tables?,"Select
  t1.Column1 AS ColumnA,
  t1.Column2 AS Table1Value,
  t2.Column2 AS Table2Value,
  t3.Column3 AS Table3Value
FROM Table1 t1
JOIN Table2 t2 ON t2.Column1 = t1.Column1
JOIN Table3 t3 ON t3.Column1 = t1.Column1
"
8228,array_append if element not exists,"UPDATE test
    SET myarray = myarray || array['fgh','gfdsa']::varchar[][]
    WHERE
        id = 'xyz'
        AND timestp = '2010-01-01 10:10:10'
        AND place = 'nowhere'
        AND not(myarray @> array['fgh','gfdsa']::varchar[][])
    ;
"
3940,Classic SQL Server Operation,"insert into tabDest(id, Date, Data1, Data2)
   Select id, date, Data1, Data2 
   from tabSRC_A A 
   inner join tabSRC_B B on A.id = B.id and A.date = B.date
   LEFT JOIN tabDest Dest 
   ON Dest.id = B.id and Dest.date = B.date
WHERE
   Dest.id is null
"
4111,Access sql query help - football database,"SELECT Conference.ConferenceName, AVG(Game.Attendance) AS AVG_ATT
FROM (Conference INNER JOIN School ON Conference.[ConferenceID] = School.[ConferenceID])
INNER JOIN Game ON (
       School.[SchoolID] = Game.[Team1] 
    OR School.[SchoolID] = Game.[Team2]
  )
GROUP BY Conference.ConferenceName;
"
9290,Strip numbers from JSON response in Rails 3?,"email_payload['subject'] = 'Results from Example Company - Surname/Firstname/[12345]'

email_payload['subject'].gsub!(/[^0-9]+/, '')
>> ""12345""
# gsub!() has mutated the value:
puts email_payload['subject']
>> 12345
"
13175,returning 0 as value for non-existing row,"SELECT product_id, product_number, NVL( desc, '0' )
  FROM table_1
       LEFT OUTER JOIN table_2 USING (product_id)
ORDER BY product_id
"
33057,Oracle vs MySQL - Insert,"INSERT INTO fake_table (names, gender)
  SELECT s.*, 'F'
    FROM (
      -- your query
      SELECT distinct(name) FROM target_table
    ) s
"
18937,mysql + update top n,"UPDATE  table
SET     status = 1
WHERE   status = 2
ORDER BY id
LIMIT 400
"
30328,Using composite PRIMARY KEY or UNIQUE key on INNODB table with multiple inserts,"CREATE TABLE data (
  backend_id INTEGER,
  unique_id INTEGER,
  weight INTEGER,
  PRIMARY KEY (backend_id, unique_id)
) ENGINE=InnoDB
"
23089,How to find who last modified the table in SQL server?,"   DECLARE @login_name NVARCHAR(200)
   SELECT  @login_name = loginame
   FROM  sys.sysprocesses
   WHERE   spid = @@SPID
"
32621,Inserting and transforming data from SQL table,"SELECT
    date,
    id,
    SUM(CASE WHEN status_id = 1 THEN status_time ELSE 0 END) AS lunch,
    SUM(CASE WHEN status_id = 2 THEN status_time ELSE 0 END) AS break,
    SUM(CASE WHEN status_id = 3 THEN status_time ELSE 0 END) AS vacation
FROM
    My_Table
GROUP BY
    date,
    id
"
5571,Unable to get child records after parent record in order by clause,"SELECT c.Name 'Category Name',
       s.Name 'Stage Name'
FROM Category c
LEFT JOIN Stages s
  ON c.Id = s.CategoryId
left join Stages ps
  on s.ParentStage = ps.Id
ORDER BY c.Ordinal,
case 
  when ps.Id is null then s.Ordinal * 1000
  else ps.Ordinal * 1000 + s.Ordinal
end
"
15862,Oracle SQL generate query,"SELECT MAX(CH.CHAN_NUMBER), MAX(CH.CHAN_NAME), COUNT(SRV.SURV_FAV_CHAN) FROM SURVEY SRV  
LEFT JOIN CHANNEL CH ON CH.CHAN_NUMBER = SRV.SURV_FAV_CHAN
GROUP BY SRV.SURV_FAV_CHAN HAVING COUNT(SRV.SURV_FAV_CHAN) > 1;
"
2327,SQL : how to select different rows where values are equal to an set of values?,"SELECT * 
FROM `services` 
WHERE servide IN ('wifi','pulizia','parking','ombrellone','driver','colazione') AND active = 1
"
27793,Exec procedure with @tpv from Sql,"declare @ ListCrc32

insert into @ (crc32)
select ... put here what you need to insert with.

exec UpdateAdsList @
"
15946,How to optimize my query joining two tables in Mysql,"SELECT *
FROM table2 t2
JOIN table1 t1 ON t1.Names = t2.names AND t1.Numbers = t2.numbers
WHERE t1.condi = 'FilterName'
AND t2.condition = 'Something'
"
1698,Oracle Rollback Segments and ADO.NET,"ALTER ROLLBACK SEGMENT <name> OFFLINE;

ALTER ROLLBACK SEGMENT <name> ONLINE;
"
38669,mySQL select any department that has had transactions in every month in the last year,"SELECT DeptID, COUNT(DISTINCT MONTH(`date`)) AS month_count
FROM Transactions
WHERE `date` >= CURDATE() - INTERVAL 1 YEAR
GROUP BY DeptID
HAVING month_count = 12;
"
22577,is there anyway to count values in a set of mysql cloumn,"SELECT id, LENGTH(colname) - LENGTH(REPLACE(colname, ',', '')) + 1 AS set_count
FROM YourTable
"
37203,getting two or more values from max min aggregate function,"select * from
(
    select s.*,
           row_number() over(partition by shippeddate order by saleamout desc) max_rw, 
           row_number() over(partition by shippeddate order by saleamout asc) min_rw
    from sales s
) 
-- where max_rw <= N -- max N
-- where min_rw <= N -- min N
"
23175,sql server 2005 - trigger to hash password at insertion,"create table TestTrigger2 (
TestTriggerID int not null identity(1,1),
Hashed binary(50),
PasswordProxy nvarchar(50)
)

--select HashBytes('MD5', N'This string')

create trigger HashPass2 on TestTrigger2
instead of insert
as 
begin
  insert into TestTrigger2 (Hashed)
    select HashBytes('MD5', '@!98ABc'+PasswordProxy) from inserted
end

insert into TestTrigger2
(PasswordProxy)
values
('My password' )

select *
from TestTrigger2
"
19058,Unwanted promotion using TransactionScope,"using (var scope = new TransactionScope())
{
    DalA.DoSomething();  
    DalB.DoSomething();
    scope.Complete();
}
"
9322,"How do I insert an empty row, but have the autonumber update correctly?","INSERT INTO `table` (`primary_key`) VALUES (NULL);
"
33312,"SQL query Lastname, first name within string","SELECT  
SUBSTRING(rowNameOcu,CHARINDEX(' ',rowNameOcu),CHARINDEX(' ',right(rowNameOcu,len(rowNameOcu) - CHARINDEX(' ',rowNameOcu)))) + ', ' + left(rowNameOcu,CHARINDEX(' ',rowNameOcu)) + RIGHT(rowNameOcu, CHARINDEX('-',reverse(rowNameOcu)))  
FROM MyTable
"
1831,MSSQL left join order by nulls to the end while if all nulls order by ID,"SELECT TOP 50 [id], [title], [url], [icon], linkstats.visits 
FROM [websites] LEFT OUTER JOIN [linkstats] ON websites.id=linkstats.lid AND linkstats.code=@country 
WHERE (([country] = @country OR [country]= 'all') AND 
      ([hot] = @hot)) 
ORDER BY CASE WHEN linkstats.lid IS NULL THEN 1 ELSE 0 END,
         linkstats.visits DESC
"
2817,Display a ranking grid for game : optimization of left outer join and find a player,"SELECT p.nickname as nickname
, SUM(IF(key = ""for"", value,0)) AS `for`
, SUM(IF(key = ""int"", value,0)) AS `int`
, SUM(IF(key = ""agi"", value,0)) AS `agi`
, SUM(IF(key = ""lvl"", value,0)) AS `lvl`
FROM Player p
LEFT OUTER JOIN SimpleValue v1 ON p.id=v1.playerId
GROUP By p.nickname
ORDER BY v1.value
"
1026,Populate the maximum value without a join oracle," first_value(step) over (partition by value1 order by date_ desc)
"
38698,"Is it possible to create and use ""virtual"" table in mysql query?","SELECT 1 AS product_id, 1 AS quantity
UNION ALL
SELECT 2, 1
UNION ALL
SELECT 3, 100
...
"
5457,How to obtain Max(Rank) for a Specific Month,"select v.*
from (select v.*, rank() over (partition by month order by [rank] desc) as rankrank
      from view v
     ) v
where rankrank = 1;
"
35793,postgresql import csv file,"country_code character varying(10)[] NOT NULL,
"
6790,Display TextView containing information from the database,"
displayTextView.settext(selected.getAdresse().toString());
"
26922,SQL Server query for top rows to select with condition,"with t2 as
(
select t1.*,
 row_number() over (order by id) rn 
from 
  (select email, max(id) as id from [user] group by email) as  t1
)

select * from t2 where rn between 5 and 10
"
31117,how to insert utf8 characters into oracle database using robotframework database library,"os.environ[""NLS_LANG""] = ""AMERICAN_AMERICA.AL32UTF8""
"
33087,Android - on post execute in AsyncTask,"@Override
protected void onPostExecute(Void result) {
    Log.d(TAG, ""p execute"");
    dialog.dismiss();
    sendButton.setEnabled(true);
    Log.d(TAG, ""done executing"");
}
"
31817,SQL Date Between Time Not Date,"SELECT COUNT(id) 
FROM mobile_statistics 
WHERE CAST(timestamp AS time) BETWEEN '5:00 PM' AND '9:00 PM';
"
19712,Postgresql At least 2 sales in the same day,"select id, 
       Name,
       Lastname,
       Seller,
       Date,
       Item
from (
  select id, 
         Name,
         Lastname,
         Seller,
         Date,
         Item,
         count(*) over (partition by date, seller) as cnt
   from the_table
) t
where cnt >= 2;
"
4575,How to sort Fiscal month that are stored as Nvarchar in SQL server 2008,"SELECT [Id],[FiscalMonth]
From Sample
order by convert(date,Substring([FiscalMonth],6,3)+ ' 01 ' + Substring([FiscalMonth],3,2),103)
"
24413,SQL query to calculate the users with highest success rate of answering questions,"SELECT b.user_id, username, count(*) as answers,
       avg(selected_answer = correct_answer) as p_correct
FROM score a JOIN
     processedquestion b 
     ON a.attempt_id = b.attempt_id JOIN
     users c 
     ON b.user_id = c.user_id 
WHERE selected_answer IS NOT NULL 
GROUP BY user_id 
ORDER BY p_correct DESC
LIMIT 5;
"
19391,Schema to support dynamic properties,"SELECT case when pd.type = ""numeric"" then pv.numeric
            when pd.type = ""textual"" then pv.textual
            when pd.type = ""boolean"" then pv.boolean
  from prov_vals pv 
  JOIN prop_defs pd ON pv.prop_def_id = pv.id
 WHERE pv.object_id = 2
   AND pd.name = ""Name""
"
164,SQL query: Finding unique number combinations within all records,"select distinct e.EntryID
from entry e, combination c
where c.Comb_Num1 in (e.NumberOne, e.NumberTwo, e.NumberThree, e.NumberFour, e.NumberFive)
and   c.Comb_Num2 in (e.NumberOne, e.NumberTwo, e.NumberThree, e.NumberFour, e.NumberFive)
and   c.Comb_Num3 in (e.NumberOne, e.NumberTwo, e.NumberThree, e.NumberFour, e.NumberFive)
and   c.CombID = @CombID
"
25596,How to write a select between two letters in Oracle database?,"WHERE substr(name,1,1) between p_fletter and p_lletter
"
20928,Getting table rows where multiple foreign table criteria need to be satisfied,"SELECT u.UserName 
FROM Users u 
     INNER JOIN Options o 
        ON o.User_ID = u.ID
WHERE o.Flag in (1, 2)
GROUP BY u.UserName 
HAVING COUNT(o.Flag) = 2
"
18363,How to combine two sql queries from same table,"select 
(select count(*) from SLA where device='some-dev' and DATE(times) = DATE(s.times) and  TIME(times) between '06:00:00' and '18:00:00' and value <150),
count(*), 
DATE(s.times) 
from SLA s
where device='some-dev' and DATE(times) between '2013-05-01' and '2013-05-31' and TIME(times) between '06:00:00' and '18:00:00' group by DATE(times)
"
7312,SQL to make new column(mySQL),"SELECT tableA.username as userA
    tableB.username as userB
FROM tableA
CROSS JOIN table B
WHERE tableA.username='abc'
    AND tableB.username='abcd'
    AND tableB.password='abcd';
"
39412,SQL 2 Inserts based on return of first,"declare @countryid int

Insert into country (Name) values('canada');
SELECT @countryid = SCOPE_IDENTITY()

Insert into provinces (CountryId, Name) values (@countryid,'ontario'); 
"
36119,I am not able to get the values from the database in the order I want,"select distinct month, 
    (select sum(amount) from expenses where month = t.month and status like '+' group by month) as income, 
    (select sum(amount) from expenses where month = t.month and status like '-' group by month) as expense 
from expenses t
"
13787,Replace column references in values,"UPDATE data 
   SET data = CONCAT('word=',(SELECT id 
                                FROM words 
                               WHERE words.word = SUBSTRING_INDEX(data.data,'=',-1)))
"
12954,How to count rows that have the same values in two columns and return only rows where count<N(SQL)?," SELECT ...
 FROM ...
 WHERE ...
 GROUP BY whatever
 HAVING count(*) <3
"
31715,SQL: Inner Join return one row based on criteria,"SELECT t1.id, d
FROM   TableOne t1
JOIN   (SELECT   id, MAX[date] AS d
        FROM     TableTwo
        GROUP BY id) t2 ON t1.id = t2.id
"
22348,How to query against multiple linked servers?,"DECLARE @dml nvarchar(max) = N''
SELECT @dml += 'UNION ALL SELECT * FROM ' + QUOTENAME(ss.name) + 
               '.[DBNAME].[dbo].foo ' 
FROM sys.servers ss
WHERE ss.server_id > 0

SELECT @dml = STUFF(@dml, 1, 10, '')
EXEC sp_executesql @dml
"
30952,Cumulative average number of records created for specific day of week or date range,"select
  DayOfWeek
, count(*)/count(distinct(WeekNumber)) as Average
from
  MyCompanionTable
group by
  DayOfWeek
"
31903,Joining tables in SQL,"SELECT  t.topicname, m. *, ms.avatar
FROM    `messages` m
JOIN    topics t
ON      t.topicid = m.topicid
LEFT JOIN
        users u
ON      u.username = m.author
LEFT JOIN
        misc ms
ON      ms.userid = u.userid
ORDER BY
        m.postdate DESC
LIMIT 5
"
25720,SQL - SELECT DISTINCT and ORDER BY Latest,"SELECT gameName , Max(modified) as modified
FROM myTable 
GROUP BY gameName 
ORDER BY gameName;
"
18278,SQL Trigger in phpmyadmin,"CREATE TRIGGER my_first_trigger BEFORE INSERT employees
FOR EACH ROW
BEGIN
IF NEW.id_employee = 55 THEN
INSERT INTO special_employees VALUES (NEW.id_employee, NEW.name);
END IF;
END $$
"
6808,MySQL conditional ORDER BY ASC/DESC for date column,"ORDER BY post_status ASC,
CASE post_status WHEN 'future' THEN POST_DATE END ASC,
CASE WHEN post_status <> 'future' THEN post_date END DESC
"
217,Fetching the list of last values from SQL Server database and left join to a view,"CREATE VIEW vw_CurrentTherapists 
AS
   WITH CurrentTherapist AS
   (
       SELECT 
          SID, TID, [Date],
          RowNum = ROW_NUMBER() OVER(PARTITION BY SID ORDER BY Date DESC) 
       FROM 
          dbo.SessionList
   )
   SELECT 
      SID, TID, [Date]
   FROM 
      CurrentTherapist
   WHERE
      RowNum = 1
"
13541,How to get one record per account?,"select memo_account, 
       max(case when SUFFIX = '00' then '00' else null end) as suff00, 
       max(case when SUFFIX = '08' then '08' else null end) as suff08, 
       date
   FROM MEMO
   left join daily on daily.ACCOUNT= memo.memo_account
   where flag_3  = 1 and suffix in (08,00)  
   and memo_number  =3333
group by memo_account, date
"
29572,Multiple joins on the same table,"select d.tech_id, t.first_name, t.last_name, 
       d.rt_completed as completed_id, 
       t2.first_name as completed_first_name, 
       t2.last_name as completed_last_name
from RT_QUEUE_Delta d
    join Technician t on d.tech_id = t.tech_id
    join Technician t2 on d.RT_Completed = t2.tech_id
"
34367,Slick 2.1.0 Filter Max Version in a Table,"private def configMaxVersionFilter(extId: String) = for {
  tbl <- myTable1Elems
  if tbl.externalId === s""$extId"" && tbl.version === (
    myTable1Elems
      .filter(_.externalId === s""$extId"")
      .map(_.version)
      .max
    )
} yield tbl
"
11892,"How to format time to '2:34 hrs', '0:34 hrs' etc in MySQL","SELECT operator_no, log_in_time,
       TIME_FORMAT(
           TIMEDIFF(log_in_time, log_out_time),
           '%H:%i hrs'
       ) AS Duration
"
27145,Filter results based on logged in user (Joomla 3.2.2),"WHERE s.email={$UserEmail} AND s.id IN (SELECT user_id FROM #__user_usergroup_map WHERE group_id=<yourgroupid>);
"
14735,double quotes at end of concatenated TSQL string,"select null as [dbnull], N'ldkjf' as [string], len(N'ldkjf') as [len]

select null as [dbnull], N'' as [empty_string], len(N'') as [len]
"
9673,Checking whether an item does not exist in another table,"SELECT p.name, p.id_string
FROM
    process p
    LEFT JOIN value_search v
        ON v.id_string = p.id_string
WHERE
    v.id_string IS NULL
    AND p.id_string IS NOT NULL
"
18302,Using the count function in SQL when when each row of the primary key are categorized?,"SELECT country, count(employee_names)
FROM table1
WHERE employee LIKE 'A%'
Group by country
"
39666,Where is the database connection information in an ADP file?,"? CurrentProject.Connection.ConnectionString
? CurrentProject.Connection.Provider
"
37277,how to compare SQL dates with null,"SELECT R.Country_CD, COUNT(*) AS d_null
FROM Reimbursement R
WHERE R.Country_CD = @Country_CD AND R.Effective_End_DT IS NULL
"
36025,Convert float to decimal with parameterized precision,"DECLARE @DecimalPlace INT = 4
DECLARE @sql NVARCHAR(MAX) = 'SELECT Convert(Decimal(15,' + CAST(@DecimalPlace AS NVARCHAR) + '),table.column) AS XYZ FROM table'
EXEC sp_executesql @sql
"
33498,Filter Left join sql,"   SELECT Customer.IDCustomer
        , Customer.Name
        , Sign.IdSign
        , Sign.Name
        , Sign.Delete
     FROM Customer
LEFT JOIN Sign_Customer
     JOIN Sign
       ON Sign_Customer.IdSign = Sign.IdSign
      AND Sign.Delete = 0
       ON Customer.IDCustomer = Sign_Customer.IDCustomer
 ORDER BY Customer.NAME;
"
14,Fetch a Unique Number from a file containing list of numbers concurrently,"create table special_number (id serial, num varchar(100) not null);
create unique index special_number_num on special_number(num);
copy special_number(num) from '/tmp/data.txt'; -- 1 special number per file line
create sequence num_seq;
select num from special_number where id = (select nextval('num_seq'));
"
25884,android: compare date with database,"$ sqlite3
sqlite> CREATE TABLE date_test(date DATE);
sqlite> INSERT INTO date_test VALUES('2012-01-01');
sqlite> INSERT INTO date_test VALUES('2012-02-01');
sqlite> INSERT INTO date_test VALUES('2012-03-01');
sqlite> SELECT date FROM date_test WHERE date < '2012-02-15';
2012-01-01
2012-02-01
"
38022,selecting remove duplicate entries using 2 fields from oracle,"SELECT DISTINCT unique_customer_id, message_id, MAX(date)
FROM TableName
GROUP BY unique_customer_id, message_id
"
4251,"MySQL, get the three clients who have the max purchases:","SELECT client.name
FROM client
JOIN purchase ON purchase.client_id = client.client_id
JOIN product ON purchase.product_id = product.product_id and product.product_id = 1
GROUP BY client.client_id
ORDER BY COUNT(purchase.purchase_id) DESC
LIMIT 3
"
3016,Alphanumeric constraints that will accept upper and lower case,"       CONSTRAINT PART_PartNumber_CC CHECK (REGEXP_LIKE (PartNumber, '^[[:alnum:]]+$'))
"
9599,Calculate Win/Loss Streak Query,"SELECT 
    Sum(IIF(Result = 'W', 1, 0)) As TotalWins, 
    Sum(IIF(Result = 'L', 1, 0)) As TotalLooses
FROM Table1;
"
37737,SELECT a cell and UPDATE at the same time?,"UPDATE NumSeries 
SET NumSeriesCurrent += 1
OUTPUT DELETED.NumSeriesCurrent
WHERE NumSeriesKey='X'
"
20374,Count(*) vs Count(1),"SELECT COUNT(1) FROM dbo.tab800krows
SELECT COUNT(1),FKID FROM dbo.tab800krows GROUP BY FKID

SELECT COUNT(*) FROM dbo.tab800krows
SELECT COUNT(*),FKID FROM dbo.tab800krows GROUP BY FKID
"
24766,T-SQL | Counts and ranks,"SELECT *
      ,RowNum = DENSE_RANK() OVER(ORDER BY KC1,KC2,KC3)
      ,OnCNT = SUM(CASE WHEN IsON = 1 THEN 1 END) OVER(PARTITION BY KC1,KC2,KC3)
      ,OffCNT = COALESCE(SUM(CASE WHEN IsON = 0 THEN 1 END) OVER(PARTITION BY KC1,KC2,KC3),0)
FROM  #TempTBL
"
17290,how to return last inserted (auto incremented) row id in HSQL?,"SELECT TOP 1 Id FROM [TABLENAME] ORDER BY Id DESC
"
15192,Access second table data using SQL Join,"SELECT 
    m.FullName, gm.ID
FROM 
    Members m
INNER JOIN 
    GroupMembers gm ON m.ID = gm.MemberID
WHERE 
    gm.GroupID = 'foo'
"
35842,Sum totals of two queries,"SELECT SUM(hr) FROM
(
  Select sum(hours) as hr FROM table WHERE name='xxx' and Description='Worked'
  UNION ALL
  Select sum(hours2) as hr FROM table WHERE name='xxx' and Description2='Worked'
)a
"
3068,"simple SQL query not working (emp,dept)","SELECT JOB, SUM(NVL(COMM,0)) AS TOTAL_COMM
FROM
EMP
GROUP BY JOB
"
32514,SQL Server : copy rows to another table without duplicate keys,"insert into DESTINATION 
Select * from (
select <column_list>,
row_number() over (partition by PK order by PK ) as rnm
from origin)Temp
where rnm=1;
"
19517,Convert string formatted as yyyymmddhhnn to datetime,"declare @t varchar(20)
set @t='200012011200'
select cast(stuff(stuff(@t, 11,0,':'),9,0,' ') as datetime)
"
27479,Insert constant value in table using sql script,"INSERT INTO receiving_tbl(id, name, color) 
SELECT id, name
     , CASE color_id WHEN 1 THEN 'Green'
                     WHEN 2 THEN 'Red'
                     ...
                     ELSE NULL
       END 
FROM parent_tbl
"
18257,sql - select all values id's and count how many time they appear within the last month,"SELECT     i.name, x.total 
FROM       Item i
LEFT JOIN  (SELECT   Item_id, COUNT(Item_id) as total 
            FROM     Tracking 
            WHERE    date > DATE_SUB(NOW(), INTERVAL 1 MONTH) 
            GROUP BY Item_id) x ON i.id = x.Item_id
"
3374,"ms sql 2008 - one table , multiple filter","Select p1.fkProductId From AttributeBindings p1
    inner join AttributeBindings p2 on p1.fkProductId = p2.fkProductId
where 
    (p1.fkAttributeId = 17 and p1.fkAttributeValueId = 97)
    and (p2.fkAttributeId = 6 and p2.fkAttributeValueId = 11)
"
13,Join 3 tables with query sql,"SELECT      D.Id,C.Country,COUNT(CU.Id) [number of creation]
FROM        Country C CROSS JOIN [Date] D
LEFT JOIN   customer CU on D.Dates.Id = CU.Date_Creation_Id And C.Country.Id = CU.Country_Id 
GROUP BY    D.Id,C.Country
ORDER BY    D.Id,C.Id
"
26835,how to update row,"select b.no, b.model, a1.desc as 'color', a.desc as 'finish' 
from tableb b
inner join tablea as a
on b.finish = a.code
inner join tabla as a1
on b.color = a1.code
"
39539,SQL Query to find customers who registered and purchased on the 2nd day to within 7th day of their registration,"SELECT DISTINCT
    Users.CustId
FROM
    Users JOIN Order ON Users.CustId = Order.CustId
WHERE
    DATEDIFF(dd, Users.PostedDate, Order.PostedDate) BETWEEN 1 AND 6
    AND Users.PostedDate BETWEEN @start_date AND @end_date
"
30342,How do I execute this GROUP BY mysql query?,"SELECT name, COUNT(*) as cnt
FROM Fruits
GROUP BY name
ORDER by cnt DESC
"
2318,PostgreSQL Order By SubQuery,"SELECT c.id, u.bought_date, max(u.bought_date) over (partition by c.id) as category_bd
FROM categry c left join
     product p
     on (c.id=p.category_id) left join
     user_list u
     on (p.id=u.product_id)
WHERE u.user_id = 3 
ORDER BY category_bd DESC NULLS LAST, u.bought_date DESC NULLS LAST
"
14520,How do I copy data from each record of one table into multiple records of another table related to the first table?,"UPDATE b
SET b.Age = a.Age, 
    b.Name = a.Name
FROM TableB b
INNER JOIN TableA a
ON b.Table_A_ID = a.ID;
"
2979,How to force a running t-sql query (half done) to commit?,"set rowcount 5000
delete table
while @@rowcount = 5000
    delete table
set rowcount 0
"
29521,"Binary ""OR"" operation on a SQL column",";with PowersOf2
as
(
    select 1 as Number
    union all
    select A.Number * 2 from PowersOf2 as A where A.Number < 64
)
select P.PERSON_NAME, sum(distinct P.PERSON_DAY & PowersOf2.Number)
from PERSON_DAYS as P
    left outer join PowersOf2 on PowersOf2.Number <= P.PERSON_DAY
where P.PERSON_ID = @myId
group by P.PERSON_NAME
"
4355,How to group by data and calculate at a time in mySQL?,"select
  pID,
  sum(case when InputType='Expenses' then Payable else Amount end) as Balance1,
  sum(case when InputType='Expenses' then Amount else Payable end) as Balance2
from tbl
group by pID
"
3510,"sql insert using select, case and subquery inside","select * into #transacTbl from tmpTrans
insert
   select tmpT.ID,
       (case when tmpT.TranStatus = 10
        then 'Returned'
        else 'GoodSale'
        end)
   from
      (select * from MainTransacSource) as tmpT <OR simply MainTransacSource tmpT (maybe)>
"
29,Remove duplicate records from a table and leaving the newest,"DELETE FROM TableName as a
WHERE EXISTS (SELECT '1'
              FROM TableName b
              WHERE b.id = a.id  -- Plus all other 'duplicate' columns
                    AND b.hdate > a.hdate);
"
38234,"Scala Slick / ScalaQuery BigDecimal creates decimal(10,0) how to allow decimals?","def employeeMultiplier = 
  column[BigDecimal](""employeeMultiplier"", O.DBType(""decimal(10, 4)""))
"
32556,"Put the servername, database name and schema automatically before the tablename in a select statement","DECLARE @sql VARCHAR(200)
SET @sql = 'CREATE TABLE tempdb.dbo.temp(id INT IDENTITY(1,1), DESCRIPTION VARCHAR(100))
INSERT INTO tempdb.dbo.temp SELECT ''1'' SELECT * FROM tempdb.dbo.temp'
PRINT (@sql)
EXEC (@sql)
SELECT * FROM tempdb.dbo.temp

DROP TABLE tempdb.dbo.temp
"
29850,Distinct Rows In Sql,"SELECT RefID, InvoiceNo, InvoicedDate, CustID,
       max(PaidOnTime), max(Paidlate), max(PaidByCash), max(PaidByCard)
FROM @Ref 
GROUP BY RefID, InvoiceNo, InvoicedDate, CustID
"
17281,"Using Multiple Tables, Multiple Values with Min() SQL","SELECT SUM(MIN(fp-20, ap)) FROM
  (SELECT dates.pk AS fd, SUM(points) AS fp
  FROM dates
  JOIN foods ON name_id = fd
  GROUP BY fd
  HAVING fp >= 20)
    JOIN
  (SELECT dates.pk AS ad, SUM(activity) AS ap
  FROM dates
  JOIN activities ON activity_id = ad
  GROUP BY ad)
    ON fd = ad
"
15077,Is unique foreign keys across multiple tables via normalization and without null columns possible?,"create table Vehicles (
    Vehicle int primary key,
    Registration varchar(255),
    Type varchar(255),
    constraint chk_type check (type in ('car', 'truck')),
    constraint unq_type_Vehicle unique (type, vehicle), -- this is redundant, but necessary
    . . .
);

create table car (
    VehicleId int,
    Type varchar(255), -- always 'car' in this table
    constraint fk_car_vehicle foreign key (VehicleId) references Vehicles(VehicleId),
    constraint fk_car_vehicle_type foreign key (Type, VehicleId) references Vehicles(Type, VehicleId)
);
"
30201,Get rows matching the combination of ids in sql server 2008,"select *
from T2 T21
inner join T2 T22
on T21.ID = T22.ID
inner join T1 T1
on T21.CombiIDs = T1.Combi1
and T22.CombiIDs = T1.Combi2
"
38978,SQL Query to generate an extra field from data in the table,"select 
  Person, 
  Cost, 
  FromDate, 
  coalesce((select min(FromDate) from Tbl1 later where later.FromDate > Tbl1.FromDate), '2099-01-01') as ToDate 
From Tbl1
order by Person, FromDate;
"
31125,Retrieve the last record in a database which has a alphanumeric key,"CREATE TABLE Games(
    GameID int IDENTITY(1,1),
    ...Other Columns,
    CONSTRAINT PK_Games PRIMARY KEY CLUSTERED(GameID))
"
12013,An SQL statement,"SELECT userName FROM tblUsers ORDER BY date ASC,score DESC
"
25309,Group By day of month across calendar days - SQL Server 2012,"sum(case when day([date]) = 1 then 1 else 0 end) as day1,
sum(case when day([date]) = 2 then 1 else 0 end) as day2,
sum(case when day([date]) = 3 then 1 else 0 end) as day3,
sum(case when day([date]) = 4 then 1 else 0 end) as day4,
etc
sum(case when day([date]) = 31 then 1 else 0 end) as day31
"
27377,Finding the earliest date that a specific event occurred,"SELECT USERID, PROGRAMID, CASE when (min((start_date) +30) >= coupon_date) then 1 else 0 end as match
FROM USERS
GROUP BY USERID, PROGRAMID
ORDER BY USERID
"
15709,Pivot query assistance,"select JobBatchId, 
  CompanyOutletId,
  STUFF(
    ISNULL(CASE WHEN ClearanceRequired = 'T' THEN ',Clearance Required' END, '')  +
    ISNULL(CASE WHEN HankyRequired = 'T' THEN ',Hanky Required' END, '') 
    , 1, 1, '') Reasons
from YourTable
"
34640,Confusion while using NOT IN clause in Postgres,"SELECT id
FROM flx2.groups
WHERE id NOT IN (SELECT groupid 
                 FROM flx2.lmsprovidergroups
                 WHERE groupid is not null)
"
33887,"Microsoft SQL-Apply ""Where"" Clause to Particular Columns","COUNT(case when Recordings_Sum >= 60 AND Recordings_Sum < 100 then 1 end) AS DaysAbove60
COUNT(case when Recordings_Sum >= 100 AND Recordings_Sum < 140 then 1 end) AS DaysAbove100
COUNT(case when Recordings_Sum >= 140 then 1 end) AS DaysAbove140
"
24073,Is there a way to force a table value to be 0 on all updates unless explicitly stated otherwise?,"CREATE TRIGGER tr_set_Defaults 
ON dbo.SomeTable
AFTER UPDATE 
AS
BEGIN
  SET NOCOUNT ON;

    UPDATE t
     SET t.Col1 = 0
    FROM dbo.SomeTable t
    INNER JOIN inserted i ON T.PK_Column = i.PK_Column
    WHERE i.Col1 IS NULL    --<-- Columns of intrest 

END
"
35096,Combining columns,"SELECT t.ename, t.deptno, mx.sal as sal, mx.avg_sal as avg_sal
FROM tbl t, 
  (SELECT MAX(sal) AS sal, AVG(sal) AS avg_sal, deptno
   FROM tbl
   GROUP BY deptno) mx
WHERE t.deptno = mx.deptno AND t.sal = mx.sal
"
13335,Query data by date parameter,"SELECT * FROM database.table WHERE columndate >= CURDATE();
"
12245,SQL Server: Copying column within table,"UPDATE <tablename>
SET <destination column name> = <source column name>
"
9707,Sql conditional statement on where clause,"
WHERE submitDate IS NULL
   OR submitDate >= @dateFrom AND submitDate < ISNULL(@dateTo, '30000101')
"
10287,"SQL code that will confirm that 2 columns of a table is 'synchronized', if not flag it","SELECT a.*, b.*
FROM ContactInfo a
  INNER JOIN ContactInfo b on a.address = b.address
WHERE a.phone != b.phone
"
34743,count() for distinct values,"select count(distinct iValue) from #repeated
"
6868,How to get rows from table,"SELECT recipe_ID, count(Distinct ingredient_id)
FROM recipes2ingredients
WHERE ingredient_ID in (1,2)
GROUP BY recipe_id
HAVING count(Distinct ingredient_id) = 2
"
37201,What is the sql query for this task to find first and last entry?,"SELECT min(date(timestamp1)) as FirstVisit, max(date(timestamp1)) as LastVisit, count(distinct(date(timestamp1))) as distinctDays from yourtablename
"
12891,Counting state changes,"with Changes as
(
  select name
    , stateChange = case when prev.state is null then 0
      when sc.state <> prev.state then 1
      else 0
      end
  from data sc
    outer apply
    (
      select top 1 prev.state
      from data prev
      where sc.timestamp > prev.timestamp
        and sc.name = prev.name
      order by prev.timestamp desc
    ) prev
)
select name, stateChanges = sum(stateChange)
from Changes
group by name
"
30039,Aggregating Different Column Types With Group By,"    SELECT  SUM(IF(type ='like',1,0) )as Likes, 
            SUM(IF(type='comment',1,0)) comments, 
            DAY(DATE) 'day'
    FROM `test_types`
    GROUP BY  DAY(DATE)
"
38175,Trying to remove an inner SQL select statement,"SELECT h1.song_id, h1.event_type, h1.id 
FROM histories AS h1
INNER JOIN
(
   SELECT station_id, song_id, MAX(id) AS MaxId
   FROM histories 
   WHERE station_id = 187 
     AND event_type IN (1, 2) 
   GROUP BY station_id, song_id
)  AS h2  ON h1.station_id = h2.station_id 
         AND h1.song_id    = h2.song_id
         AND h1.id         = h2.maxid
ORDER BY h1.id;
"
22419,"Remove duplicates from query, while repeating","select dt,col2 
from (
select dt,col2,
case when lag(col2,1,0) over(order by dt) = col2 then 1 else 0 end as somecol
from t) x 
where somecol=0
"
1358,Swap fields inside an Oracle record using couple separator * and elements separator |,"select 
  cola, 
  regexp_replace(cola, '([^*|]*)\|([^*|]*)(\*|$)','\2|\1\3') as swapped_col
from (
  select '3456|Abc*7890|Def*9430|Ghi*3534|Jkl' cola from dual
)
"
30633,merge 2 selects into 1,"SELECT g.naam,g.gebruikerID ,g2.naam,g2.gebruikerID
FROM gebruiker g , gebruiker g2, vriend v
WHERE g.gebruikerID = v.gebruikerID_Jezelf 
OR g2.gebruikerID = v.gebruikerID_Persoon
AND g.gebruikerID IN(SELECT gebruikerID_Jezelf FROM vriend) 
OR g2.gebruikerID IN(SELECT gebruikerID_Persoon FROM vriend);
"
12793,MySQL Parent details if it is a child account,"SELECT a.id, e.email 
FROM account a 
         INNER JOIN emails.e 
              ON e.account_id = IF(a.parent <> 0, a.parent, a.id)
"
34369,Calculate time of received 802.11 packets,"SELECT Device_id
,MIN(concat(date,' ',time)) as StartTime
,MAX(concat(date,' ',time)) as EndTime
,MIN(TIMESTAMP(date,time)) as StartTime2
,MAX(TIMESTAMP(date,time)) as EndTime2
From MyTable
Group by Device_ID
"
21149,Function format number and how to use it in sql statement,"select to_char(price, 'FM9,999,999.99')
  from A;
"
9690,How do I check that a number is in an array?,"select * from T where not array_contains(pixels,cast(12345 as bigint));
"
36475,SQL Server query help... need to convert varchar to date,"SELECT * FROM EMPLOYEES WHERE CONVERT(datetime, COLUMN1, 103) > CONVERT(datetime, '29/08/2010', 103)
"
32450,GROUP BY First_Name but show COUNT of the corresponding Last_Name SQL,"SELECT a.Last_Name, a.First_Name,
SUM(CASE WHEN b.ITM = 'P_10' THEN 1 ELSE 0 END) AS P_10_COUNT,
COUNT(c.Name_Count)
FROM CUST_PROFILE
INNER JOIN ORDER b
ON a.ID = b.ID
LEFT JOIN (select Last_Name, count(DISTINCT First_Name) Name_Count
from CUST_PROFILE
GROUP BY Last_Name) c ON c.Last_Name = a.Last_Name
GROUP BY a.First_Name, a.Last_Name; 
"
23380,SQL Inner Join. ON condition vs WHERE clause,"SELECT  i.*
  FROM InterestPayments p
    INNER JOIN InterestRunDailySum i 
      ON (i.IntRunCode = p.IntRunCode AND i.ClientCode = p.ClientCode)
    INNER JOIN InterestRunDetail ird 
      ON (ird.IntRunCode = p.IntRunCode AND ird.ClientCode = p.ClientCode)
  WHERE 
    p.IntrPayCode = 187
"
8925,How to find least non-null column in one particular row in SQL?,"SELECT IF(Col1 IS NULL OR Col2 IS NULL, COALESCE(Col1, Col2), LEAST(Col1,Col2))
"
10156,Nested select to LINQ,"var nestedquery= (from m in context.MoneyTable
                  where m.year >= 2014
                  group m by m.department into g
                  select g.Sum(e=>e.money)).ToList();

var result= new { minMon= nestedquery.Min(e=>e), maxMon=nestedquery.Max(e=>e)};
"
38424,mysql self join with where,"select c.category_id
from categories
where cat_id = 172
union all
select c1.category_id
from categories c join
     categories c1
     on c1.cat_id = c.category_id
where c.cat_id = 172;
"
13836,Calculate if Hour has at least half double coverage,"SELECT * FROM
(
    SELECT ROW_NUMBER() 
        OVER (PARTITION BY Hour ORDER BY EmployeesWorking DESC) AS RowNum, *
    FROM Table
) AS Agg
WHERE RowNum = 2
"
14499,Dynamic operators in where clause in Informatica,"SELECT p.id 
FROM products p
WHERE p.weight ~operator~ '30'
"
24568,I need to return daily SUM from two columns covering 7 months,"select cast(CurrentDate - 7.0/24 as date) as thedate,
       SUM(TotalBet) as SALES, SUM(totalbet) as PRIZES
from play nolock
group by cast(CurrentDate - 7.0/24 as date)
order by 1;
"
34569,Insert data with one SQL query,"with insert_into_account as (
    insert into account values (1, 'John Doe')
    )
insert into account_role values (1, 'John Doe');
"
29838,Select a substring of X where substring of X equals a specific character,"SELECT SUBSTRING(path, Y + 1, len(path)) -- Instead of 200 use Len() function
FROM lookup 
where SUBSTRING(path, Y, 1) = ':' -- Replace Y with position
"
31300,Will multiply insert requests to the same table with direct query and store-procedure cause collision?,"CREATE TABLE People (
    PersonID int IDENTITY(1,1) not null,
    Surname varchar(30) not null,
    Forename varchar(30) not null,
    ParentID int null,
    constraint PK_People PRIMARY KEY (PersonID),
    constraint FK_People_Parents FOREIGN KEY (ParentID) references People (PersonID)
)

CREATE UNIQUE INDEX IX_SoleFamilyRoot ON People (Surname) WHERE (ParentID is null)
"
26766,How can I create a disabled trigger in SQL Server 2005?,"begin tran
go
create trigger t_i on t after insert as begin /* trigger body */ end
go
disable trigger t_i on t
commit
go
"
16539,Role of where clause in query using exist condition?,"SELECT *
FROM classes a
WHERE EXISTS (
    SELECT 1
    FROM student b
    WHERE b.a_id = a.id  -- Here you relate inner query with outside query
    )
"
35921,How to compare Column data and replace text using SQL Query,"UPDATE t1
 SET Column1 = [1],
     Column2 = [2]
FROM #table1 t1
CROSS APPLY
(
SELECT *
FROM
(
SELECT  DENSE_Rank() OVER (ORDER BY MIN(Idx)) AS Rnk, 
        ColumnValue
FROM
(
VALUES(1, Column1),(2, Column2)) V(Idx, ColumnValue)
WHERE ColumnValue IS NOT NULL
GROUP BY ColumnValue
) D
PIVOT (MAX(ColumnValue) FOR Rnk IN ([1], [2])) AS P
) ca
"
30592,Select based on matching columns,"select one.*
from tableOne as one
  inner join tableTwo as two
    on one.companyID = two.companyID and
       one.someYear = two.someYear
"
17416,Getting the most recent date after using group by with mySQL,"SELECT *
FROM   messages
WHERE  (sender_id, receiver_id, date) IN (
          SELECT   sender_id, receiver_id, MAX(date)
          FROM     messages
          WHERE    receiver_id=7
          GROUP BY sender_id, receiver_id)
"
18189,"Two date columns, one date. How can I get the data?","SELECT * FROM table WHERE start_date <= '2012-02-29' AND end_date >= '2012-02-29';
"
29576,Join with subquery in Django ORM,"users_in_session= Session.objects.values_list('user_id', flat=True)
sessions_by_the_user_list= Session.objects.filter(user__in= set(users_in_session)).order_by('last_accessed').distinct()
"
29406,Merge result of two queries in SQL Server,"SELECT 
   PB_BANK_CODE,
   PB_BANK_NAME,
   ISNULL(SUM(PC_AMOUNT),0)
FROM GLAS_PDC_BANKS inner join GLAS_PDC_CHEQUES 
    on GLAS_PDC_BANKS.PB_BANK_CODE = GLAS_PDC_CHEQUES.PC_BANK_FROM
WHERE  PB_COMP_CODE='1' 
   AND PB_BANK_CODE='025' 
   AND ISNULL(PC_DISCD,'X') != 'C'
   AND PC_DUE_DATETIME BETWEEN '05/05/2008' AND '05/06/2008'
"
16087,MySQL Slow Query Optimisation,"SELECT e.id AS id, e.name AS name, e.url AS url, p.action AS action, gk.key AS `key`
FROM event AS e
    LEFT JOIN participation AS p ON (p.event=e.id AND p.person='139160')
    LEFT JOIN goldenkey AS gk ON gk.issuedto=p.person
"
37914,vb.net Comparing 2 Databases," SELECT t1.*, t2.* FROM Table1 t1 
 INNER JOIN [;DATABASE=Z:\Docs\Test.accdb].Table1 t2
 ON t1.ID=t2.ID
"
9359,3 table query with count,"select t.name as Team,
    count(distinct m.ID) as Member_cnt,
    count(distinct t.ID) as Task_cnt
from team t
   left join member m
       on t.ID= m.TEAM_ID
   left join tasks t
     on t.MEMBER_ID= m.ID
group by t.name;
"
3296,SQL: How to aggregate multiple rows according to commutable columns?,"select least(from_user_id, to_user_id) user_id_1,
       greatest(from_user_id, to_user_id) user_id_2,
       count(*)
from messages
group by 1, 2
"
28043,Most efficient indexes to use for a query using WHERE and GROUP BY?,"SELECT 
      MyField, 
      COUNT(*) 
   FROM 
      MyTable 
         LEFT join AnotherTable
            on MyTable.MyField = AnotherTable.Field
   WHERE 
          MyField2='ConstantValue' 
      AND AnotherTable.Field IS NULL 
      AND Timestamp >= [ArbitraryTimestamp] 
   GROUP BY 
      MyField;
"
28109,How to write a MySQL query that returns a temporary column containing flags for whether or not an item related to that row exists in another table,"   SELECT   tu.ID, 
            tu.NAME,
            CASE WHEN tf.ID IS NOT NULL THEN 'true' ELSE 'false' END AS Flagged
      FROM  TABLE_USER tu
            LEFT OUTER JOIN TABLE_FLAGS tf ON tu.ID = tf.ID
"
18822,how to sum up by hour in mysql,"select hour(StartTime), count(StartTime)
from table1
group by hour(StartTime)
"
23165,How to extract week number as week format in Oracle?,"select trunc(sysdate, 'W') as first_of_week, 
       trunc( sysdate + 7, 'W' ) - 1 as last_of_week,
       to_char( trunc(sysdate, 'W'), 'DD-MON-YYYY' ) || ' to ' ||
         to_char( trunc( sysdate + 7, 'W' ) - 1, 'DD-MON-YYYY' ) as week_range
  from dual
"
23812,How to select just the row in the second table?,"select t1.date, case when t3.IDCLIENT is not NULL then t3.value else t2.value end as Value
from Table1 t1 inner join Table2 t2 on t1.IDCLIENT = t2.IDCLIENT inner join
Table3 t3 on t1.IDCLIENT = t3.IDCLIENT
"
20410,Access VBA SQL: Find Max Date and retrieve row ID,"SELECT test.ID, test.Inv, test.TDate, test.Status
FROM test INNER JOIN 
   (SELECT test.Inv, Max(test.TDate) AS MaxOfTDate
    FROM test
    GROUP BY test.Inv)  AS q 
ON (test.TDate = q.MaxOfTDate) AND (test.Inv = q.Inv)
GROUP BY test.ID, test.Inv, test.TDate, test.Status;
"
6245,How many tables is acceptable in a Database?,"Table: Folders
    FolderId
    FolderName
    OwnerUserId     -- references Users table to identify the owner
    (additional columns as necessary to describe a single folder)

Table: Users
    UserId
    UserName
    (additional columns as necessary to describe a single user)

Table: FolderUsers
    FolderId    -- references Folders table
    UserId      -- references Users table
    Permission  -- (ViewOnly, Edit, Full, etc)
"
9174,find out the number of times an ANI has called in the service using sql queries,"SELECT
    SERVICE, ANI, COUNT(*) AS 'ANI_COUNT'
FROM
    MyTable
GROUP BY SERVICE, ANI
"
1640,Write a Postgres Get or Create SQL Query,"insert into mytable (color, brightness, size, age)
where not exists (
    select 1 from 
    from mytable
    where color = 'X' and brightness = 'Y'
);
SELECT (color, brightness, size, age) 
FROM mytable 
WHERE color = 'X' AND brightness= 'Y';
"
37111,Reset sequence to a specific value,"declare
 currval pls_integer;
 diff pls_integer;
begin
  select SQ_USER_ID.nextval into currval from dual;
  dbms_output.put_line('value before alter: ' || currval);
  diff := 99999 - currval;
  dbms_output.put_line('diff: ' || diff);
  execute immediate ' alter sequence SQ_USER_ID INCREMENT BY ' ||  diff || 'nocache';
  select SQ_USER_ID.nextval into currval from dual;
  dbms_output.put_line('value after alter: ' || currval);
  execute immediate 'alter sequence SQ_USER_ID INCREMENT BY 1  cache 20';
end;
"
28979,SQL select query about grouping 2 columns,"select
    videos as 'Number of videos',
    count(user_id) as 'Num of Users'
from (
   select
        count(distinct(topic_id)) as videos,
        user_id from topic_user
   group by
        user_id
 ) sub
 group by
    videos
"
32133,SQL Query with conditional JOIN,"WITH CTE AS
(
    SELECT
        t1.Name, t1.Description, t2.Title, t2.Date,
        ROW_NUMBER() OVER (PARTITION BY t1.CatId ORDER BY t2.Date DESC) AS Seq
    FROM Table1 t1
    LEFT JOIN Table2 t2
        ON t2.CatId = t1.CatId
)
SELECT *
FROM CTE
WHERE Seq = 1
OR Date IS NULL
"
1345,Split data from 2 symbols,"declare @S varchar(100) = '153:0|114:0|147:0|148:0|152:0|155:0'

declare @xml xml

select @xml = '<item><value>'+replace(replace(@s, ':','</value><value>'), '|','</value></item><item><value>')+'</value></item>'

select N.value('value[1]', 'int') as obj_id,
       N.value('value[2]', 'int') as obj_type
from @xml.nodes('item') as T(N)
"
12311,Can not clear table from sqlite in android,"db.execSQL(""DELETE FROM ""+ TABLE_SERVER_CONTACTS);
"
10884,extracting a value from XML using SQL using Oracle 11g,"SELECT 
  EXTRACTVALUE(XMLType(
     q'[<?xml version=""1.0"" encoding=""utf-8"" ?>
        <string xmlns=""http://someweburl""><SAMP_OVERALL>Y</SAMP_OVERALL></string>]')
, 
'/*[local-name()=""string""]/*[local-name()=""SAMP_OVERALL""]') myval
from dual;
"
38789,Is this a good or bad way of generating random numbers for each record?,"create table #t (i int)
insert into #t values (1)
insert into #t values (2)
insert into #t values (3)

select i, case when i = 1 then rand() else rand() end as r
from #t

1   0.84923391682467
2   0.0482397143838935
3   0.939738172108974
"
23791,SQL: Delete all rows except,"DELETE FROM `users logins` 
WHERE `userid` = '$user->id' AND
      `token` <> '$user->token'
"
32573,European format time - Convert string to Datetime in SQL,"select convert(datetime, '21-04-2010 11:06', 105) 
"
24856,Duplicate a tables structure,"select * into DestinationTable
    from SourceTable
    where 1 = 2
"
39210,SQL to retrieve thickness values with small variance,"select * 
from table t1
join table t2 on t1.substid < t2.substid
join table t3 on t2.substid < t3.substid
where abs(t1.thickness - t2.thickness) <= 3 and
      abs(t1.thickness - t3.thickness) <= 3 and
      abs(t2.thickness - t3.thickness) <= 3
"
39302,Differences between two tables,"select col1, col2, max(which)
from ((select col1, col2, 1 as which
       from table1 t1 
       where exists (select 1 from table2 t2 where t2.col1 = t1.col1)
      ) union all
      (select col1, col2, 2 as which
       from table2 t2
       where exists (select 1 from table1 t1 where t2.col1 = t1.col1)
      )
     ) tt
group by col1, col2
having count(*) = 1
"
25509,How to union rows on the table mysql,"SELECT 
    id, 
    MAX(CASE WHEN field_id = 1 THEN value_text END) AS city, 
    MAX(CASE WHEN field_id = 2 THEN value_text END) AS name, 
    MAX(CASE WHEN field_id = 4 THEN value_text END) AS email
FROM tbl
GROUP BY id
"
34271,Output dates in MMDDYYYY format efficiently,"SELECT REPLACE(CONVERT(VARCHAR(10), RowUpdateDateTime, 110),'-','') from MyTable
"
2699,stored procedure name to id translation,"INSERT INTO users (name, provider_id)
VALUES ($1, (SELECT id FROM provider WHERE name = $2))
RETURNING id;
"
27222,Find the oldest record in a join between two tables,"SELECT *
FROM
    questions
    LEFT JOIN results
        ON results.q_id = questions.id
ORDER BY
    ISNULL(results.id) DESC, results.created ASC
LIMIT 1
"
31218,SQL query: Select all references after a specific item,"select rs.*
from ridestop rs join
      (SELECT ride, rs.sequenceNumber
       FROM ride r join
            ridestop rs
            on r.ride = rs.ride
       where stationid = 8503000
      ) r
      on rs.ride = r.ride and
         rs.sequenceNumber >= r.sequenceNumber
order by rs.ride, rs.sequenceNumber
"
23181,Get a record position in a group + record count of the group on each record,"WITH CTE AS
(
  SELECT GroupId, Item
  , GroupCount = COUNT(GroupID) OVER (PARTITION BY GroupID)
  , Pos = ROW_NUMBER() OVER (Partition By GroupID Order By GroupId)
  FROM #Data
)
SELECT GroupID, Item, Pos, GroupCount 
FROM CTE
"
39627,Same value in two columns of same table,"select CODIGO, REFERENCIA, DESCRICAO  
from ESTOQUE 
where convert(varchar(max),CODIGO) = REFERENCIA
"
13678,"postgres, permute columns from file","COPY tablename [ ( column [, ...] ) ]
    FROM { 'filename' | STDIN }
    ...
"
29766,"Find the minimum date, but not null from different columns in a select","NULLIF(LEAST(COALESCE(date1, DATE '9999-12-31')(INTEGER),
             COALESCE(date2, DATE '9999-12-31')(INTEGER)), DATE '9999-12-31') (DATE)
"
15649,SQLite database update query with multiple where conditions in Android,"db.update(TABLE_NAME,
    contentValues,
    NAME + "" = ? AND "" + LASTNAME + "" = ?"",
    new String[]{""Manas"", ""Bajaj""});
"
15194,MYSQL Query Help JOIN Tables,"SELECT full_name, wk_date, SUM(hours) HOURS,
    (Select Sum(duration)
     From ies_mileage
     Where mil_date = w.wk_date
         and ies_id = w.is_id) DrivingTime
FROM ies_weekly w
    LEFT JOIN infant_specialist i
     ON i.is_id = w.is_id 
WHERE wk_date BETWEEN '2015-01-16' AND '2015-01-31' 
GROUP BY DAY(wk_date), w.is_id 
HAVING SUM(hours) > 6 
ORDER BY full_name ASC
"
14184,Selecting pages by path in MySQL/SQLite databases,"... WHERE path REGEXP '^articles/[^/]+'
"
38041,t-sql: update in specific order determined by 'in' expression,";WITH rn (ID, rowNumber) AS
(
    SELECT st.ID, ROW_NUMBER() OVER (ORDER BY st.ID)
    FROM SomeTable st
    WHERE EXISTS (
        SELECT 1
        FROM MyTable mt
        WHERE mt.Some_ID = st.ID
    )   
)
UPDATE mt
SET MyField = rowNumber
FROM 
    MyTable mt 
    JOIN rn ON rn.ID = mt.Some_ID
"
2056,Shall I set a column on NULL for optional values?,"select * from some_table
where size between x and y or size is null;
"
21332,Getting Percentages In Access,"SELECT 
Mgmt_Lvl.MGMT_LVL, 
Count(O896IA_VEMPPRSA.SYS_EMP_ID_NR) AS Total, 
Sum(IIf(emp_rlc_ir=""Y"",1,0))/Total AS Relocate, 
Sum(IIf(emp_int_asn_ir=""Y"",1,0))/Total AS International_Assignment, 
Sum(IIf(emp_tvl_ir=""y"",1,0))/Total AS Travel, 
Sum(IIf(emp_spc_asn_ir=""y"",1,0))/Total AS Special_Assignment
"
32217,SQL Query to Grid from Multiple Tables,"select Products.Name,'dealer 1','dealer 2','dealer 3','dealer 4'
from
( select Products.Name,qty from products inner join products_to_dealers_xref pd on Products.id = pd.product_id inner join dealers d on Products.Id = d.id) as p
Pivot 
(sum(qty) for products.name in (['dealer 1'],['dealer 2'],['dealer 3'],['dealer 4'])) as pvt
"
16132,Using nested select properly in a sqlite,"select (case when click_history_hour < '08:00:00' then 'time1'
             when click_history_hour < '12:00:00' then 'time2'
             else 'time3'
        end) as whichtime, count(*) as n
from click_history
group by (case when click_history_hour < '08:00:00' then 'time1'
               when click_history_hour < '12:00:00' then 'time2'
               else 'time3'
        end);
"
33878,How to exclude records with certain values in sql,"Select col1,col2
From table
Where col1 not in (Select col1 from table where col2 not in (1,20))
"
19576,Selecting Repeat Dates In SQL Query,"select program_name, provider_name, patient_name, service_date
from tablename
group by program_name, provider_name, patient_name, service_date
having count(*) > 1
"
13973,Is there a quick way to change the keys and foreign keys of my database during the development stage with script,"ALTER TABLE x ADD COLUMN y uniqueIdentifier null
GO
UPDATE TABLE x SET y = NEWID() --Or NEWSEQUENTIALID() if its safe
GO
ALTER TABLE x ALTER COLUMN y uniqueIdentifier NOT NULL
GO
ALTER TABLE x DROP CONSTRAINT PK_PrimaryKeyConstraintName
GO
ALTER TABLE x DROP COLUMN PrimaryKeyColumn
GO
ALTER TABLE x ADD CONSTRAINT PK_NewPrimaryKeyConstraint PRIMARY KEY CLUSTERED 
( 
    y ASC 
)
GO
"
2032,MySQL query to update records with incremented date,"UPDATE Table1 t1 JOIN
(
  SELECT id, @n := @n + 1 rnum
    FROM Table1 CROSS JOIN (SELECT @n := 0) i
   WHERE date IS NULL
   ORDER BY id
) t2 ON t1.id = t2.id CROSS JOIN
(
  SELECT MAX(date) date FROM Table1
) q
   SET t1.date = q.date + INTERVAL t2.rnum DAY
"
7624,SQL Server pivot does not group,"WITH CTE
     AS (SELECT [DepartmentName],
                [Gender],
                [BaseRate]
         FROM   [AdventureWorks].[dbo].[DimEmployee])
SELECT [DepartmentName],
       [M],
       [F]
FROM   CTE PIVOT (Avg(BaseRate) FOR [Gender] IN ([M], [F])) AS P 
"
27247,Sort results by number of NOT NULL values,"select ...
from ...
order by
  case when name is null then 0 else 4 end +
  case when distance is null then 0 else 3 end +
  case when proximity is null then 0 else 2 end desc
"
3824,How to construct query which compares two sets in M:N relationship?,"select uf.user, count(*) as FeaturesInCommon
from user_features uf join
     user_features uf2
     on uf.feature = uf2.feature
where uf2.user = $user
group by uf.user
order by FeaturesInCommon desc;
"
29962,Minus of time value problem?,"declare @a datetime
declare @b datetime
declare @c datetime

set @a = '09:00:00'
set @b = '17:00:00'
set @c = '01:00:00'

select @b - @a - case when datediff(n, @a, @b) < 60 then '00:00:00' else @c end
"
32398,SQL - Select A only if B doesn't exist,"SELECT tblInfo.IDNum, tblAddress.PrimaryAddress
FROM tblInfo
INNER JOIN tblAddress
    ON tblInfo.Agent = tblAddress.Agent
WHERE tblAddress.PrimaryAddress = 1
OR  ( tblAddress.PrimaryAddress = 0 AND NOT EXISTS
    (
       SELECT 1 FROM tblInfo t2 INNER JOIN tblAddress a2 ON t2.Agent = a2.Agent
       WHERE t2.IDNum = tblInfo.IDNum AND a2.PrimaryAddress = 1
    )
)
"
26395,SQL query oracle return more than expected result,"select sm.*
from (select sm.*, max(SEQUENCENO) over (partition by codeno) as maxseq
      from smalltbl sm
      where sm.CODE = 'D50451489'
     ) sm
where sequenceno = maxseq;
"
2955,Update statement using with clause,"update mytable t
set z = (
  with comp as (
    select b.*, 42 as computed 
    from mytable t 
    where bs_id = 1
  )
  select c.computed
  from  comp c
  where c.id = t.id
)
"
25104,Transposing column into rows and create new column?,"INSERT INTO NEW_TABLE_NAME (Date, `New Column`, Value)

SELECT    DATE, 'Col_1', Col_1

FROM      OLD_TABLE_NAME


UNION ALL


INSERT INTO NEW_TABLE_NAME (Date, `New Column`, Value)

SELECT    DATE, 'Col_2', Col_2

FROM      OLD_TABLE_NAME


UNION ALL


INSERT INTO NEW_TABLE_NAME (Date, `New Column`, Value)

SELECT    DATE, 'Col_3', Col_3

FROM      OLD_TABLE_NAME;
"
18771,SQL criteria set to form,"SELECT [1 Cut Wire & Cable Only].Element
  FROM [1 Cut Wire & Cable Only]
 WHERE  (
           [1 Cut Wire & Cable Only].Product_ID = [Forms]![New Report]![cbProduct_ID]
        );
"
26642,Hoax LIMIT value,"LIMIT 0, 18446744073709551615
"
20275,Bit field in where clause,"select * from Foo where firstname = 'xyz' and
    (@Active = 0 or Active = <filter condition>)
"
35686,PostgreSQL MAX() inner query really slow,"SELECT distinct on (inumber)
  equipmenttimestamp, 
  name, 
  iNumber, 
  datauserprovidername, 
  latitude, 
  longitude
FROM 
  public.positionview
WHERE outbound = false
AND referenceIdentifier is null
AND responseType = 'XYZ'
AND equipmentTimestamp >='2016-02-02 14:44:08.213'
AND equipmentTimestamp <='2016-02-05 14:44:08.213'
order by inumber, equipmentTimestamp desc;
"
19072,"Oracle, adding leading zeros to string (not number)","LPAD(string, 10, '0')
"
38449,Combine 2 SQL SELECT statements,"SELECT m.Id 'Member Id', ISNULL(c.StaffCount, 0) 'StuffCount'
FROM tblMembers m
LEFT JOIN
(
    SELECT staffId, COUNT(staffId) 'StaffCount'
    FROM tblClients
    GROUP BY staffId
) c ON m.Id = c.staffId
WHERE m.Cat = 'Some Id'
ORDER BY StuffCount
"
12642,"Output is ""1"" even if the column is empty for some entries in MySQL database","select Lastname,count(CASE item WHEN '' THEN NULL ELSE item END) item from info  group by Lastname;
"
16043,Local Database with Scheme,"(require db)
(define c (sqlite3-connect #:database ""path/to/db-file"" #:mode 'create)
"
10229,How to convert 3 type of dates?,"CASE
    WHEN CHARINDEX('/', val)=5 THEN CONVERT(date,val,111)
    ELSE CONVERT(date, val, CASE WHEN LEFT(val,2) <= '12' THEN 101 ELSE 103 END)
END
"
29262,sqlite sorting SUM column values,"SELECT SUM(bytes) AS total_bytes, stamp_updated 
FROM acct 
WHERE stamp_updated BETWEEN datetime('now', 'localtime','-7 hours') AND datetime('now', 'localtime') 
GROUP BY ip_src 
ORDER BY total_bytes DESC limit 10;
"
9801,How to delete some similar rows from a table?,"DELETE
FROM code_sum_country
WHERE code in
 (SELECT code
  FROM code_sum_country
  GROUP BY code
  HAVING COUNT (code) > 1) 
AND country NOT IN
 (SELECT MIN(country)
  FROM code_sum_country
  GROUP BY code
  HAVING COUNT (code) > 1)
"
20679,SQL SERVER: How to select Ids from the table which has values only in 1 or 3,"select id from <TABLE> t1 where not exists 
  (select 1 from <TABLE> t2 where t1.id=t2.id and t2.value not in (1,3));
"
7011,SQL multiple column unique,"ALTER TABLE my_table
ADD CONSTRAINT uc_my_table UNIQUE (id, text1, text2)
"
13968,group by WEEK() malfunction for 2013,"SELECT 
    ROUND(SUM(sell_price), 2) AS sell_price, 
    ROUND(SUM(buy_price/100*20), 2) AS fees, 
    ROUND(SUM(buy_price), 2) AS buy_price, 
    ROUND(SUM(sell_price/100*80 - buy_price), 2) AS margin, 
    DATE_SUB(FROM_UNIXTIME(time), INTERVAL (DAYOFWEEK(FROM_UNIXTIME(time)) - 1) DAY) AS fdow 
    FROM order_items 
    GROUP BY fdow
    ORDER BY fdow DESC
"
589,Magento Commerce and Google Merchants UK VAT?,"// VAT multiplier hack.
$this->_setAttributePrice(false, 1.2 * $object->getPrice());
"
20475,Count number of occurrences of keyword in comma separated column?,"with prodref as (
      select 'product1' as prod union all
      select 'product2' as prod union all
      select 'product5' as prod union all
      select 'product7' as prod
     )
select p.prod, count(*)
from prodref pr left outer join
     product p
     on ','+p.col+',' like '%,'+pr.prod+',%'
group by p.prod;
"
5751,"sql, select top 5 occurences for certain dates","SELECT date, occurrences, diagnosecode,     
FROM (SELECT diagnosecode, date, COUNT(*) as occurrences,
             ROW_NUMBER() OVER (PARTITION BY date ORDER BY COUNT(*) DESC) as seqnum
     FROM diagnoses 
     GROUP BY diagnoses, date
    ) dd
WHERE seqnum <= 5
ORDER BY date DESC, occurrences DESC;
"
28116,double inner join in access db," SELECT     Task_Id,
            e2.emploeey_name AS W_FROM,
            e1.emploeey_name AS W_TO,
            t.Task_Details
 FROM       
 (
      tasks AS T
      INNER JOIN Employees AS e1 
           ON e1.Emploeey_id = T.Task_To
 )
 INNER JOIN Employees AS e2 
      ON e2.Emploeey_id = T.write_From
"
4474,Get the Records as per the given OrderId only,"SELECT * FROM tblHeaderField
WHERE HeaderFieldID in (5,6,2,1,3,4,7,8,9,10,11,12,13,14,15)
ORDER BY CHARINDEX(CAST(HeaderFieldID AS VARCHAR), '5,6,2,1,3,4,7,8,9,10,11,12,13,14,15')
"
13246,Drop all columns from table in Rails migration,"class PurgeOldUsersSchema < ActiveRecord::Migration
  def change
    cols = []
    User.columns.collect(&:name).each do |col|
     cols.push(col.to_sym)
    end
    cols = cols - [:id]
    remove_column :users, cols
  end
end
"
28616,"In Oracle SQL, how to get the time for only this current week?","with dates as (select trunc(sysdate, 'mm') - 10 + level dt
               from   dual
               connect by level <= 40)
select dt
from   dates
where  dt >= trunc(sysdate, 'iw')
and    dt <= sysdate; -- only needed if the dates in the column could be beyond now.
"
10336,compare data two table in MySQL,"SELECT A.* FROM A
LEFT JOIN B ON A.column_a = B.column_b AND A.id = B.id
WHERE B.id IS NULL
"
32050,Order Comparison in Oracle SQL,"SELECT T2.ID
FROM (SELECT ID, ROW_NUMBER() OVER (ORDER BY Ordinal) AS rn FROM T1) T1
JOIN (SELECT ID, ROW_NUMBER() OVER (ORDER BY Ordinal) AS rn FROM T2) T2
ON T1.ID = T2.ID 
WHERE T1.rn <> T2.rn
"
2849,YearFrac in Sql 2005,"create function yearfrac (@d1 datetime, @d2 datetime) returns float
as
begin
return abs(datediff(d, @d1, @d2)) / 365.00
end
"
1413,LINQ to SQL: Concurrency resolution,"using (var db = new MyDataContext())
{
    var root = (from post in db.Post
                where post.Id == rootPostId
                select post).Single();

    root.LastActivityUtc = DateTime.UtcNow;

    try
    {
        db.SubmitChanges();
    }
    catch (ChangeConflictException)
    {
        db.ChangeConflicts.ResolveAll(RefreshMode.KeepChanges);
        db.SubmitChanges();
    }
}
"
3127,How to design a database where I can add unsettled number of items," USERS(ID_USER, NAME, NICK, REGISTER_DATE)

 ITEMS(ID_ITEM, DESCRIPTION, PRICE)

 PURCHASES(ID_PURCHASE, ID_USER, ID_ITEM, PRICE, PURCHASE_DATE)
"
25311,"SQL SELECT: ""Give me all documents where all of the documents procedures are 'work in progress'""","SELECT document_id, document_name, ...
FROM documents AS d
WHERE NOT EXISTS (SELECT document_id
                  FROM procedures
                  WHERE document_id = d.document_id
                      AND status != 'wip');
"
30498,How to group by to get rid of duplicates rows,"select min(pk), a, b, c 
from @dummy 
group by a, b, c
"
3025,A keyword to specify in WHERE clause to get all the data without filtering the field,"SELECT * FROM user WHERE @status is null Or status = @status
"
7955,SQL: aggregate function and group by,"SELECT 
 * 
FROM 
 scott.emp
WHERE 
 (deptno,job,sal) IN
 (SELECT 
   deptno,
   job,
   max(sal) 
  FROM 
   scott.emp
  WHERE 
   deptno = 20 
   and job = 'CLERK'
  GROUP BY 
   deptno,
   job
  )
"
23857,Getting all sub records in a one-to-many relationship,"<cfquery name=""local.tabQuery"" attributeCollection=""#Variables.dsn#"">
    SELECT t.id, t.name, t.sort, f.id AS fieldID, f.label
    FROM tabs t  INNER JOIN fields f ON t.id = f.tabID
    ORDER BY t.sort
</cfquery>

<cfoutput query=""local.tabQuery"" group=""sort"">
    Tab: #local.tabQuery.name#<br>

    <cfoutput>
        Field: #local.tabQuery.label#<br>
    </cfoutput>
</cfoutput>
"
33286,Create a new column and generate numbers in that column using TSQL,"/*To add the new column*/
ALTER TABLE emps ADD employee_no INT NULL

/*To populate it*/
;WITH T
     AS (SELECT employee_no,
                dense_rank() OVER (ORDER BY employee_name, employee_address) AS
                new_employee_no
         FROM   emps)
UPDATE T
SET    employee_no = new_employee_no   
"
29005,"Better way to demand, in SQL, that a column contains every specified value","SELECT p.name
    FROM person p
        INNER JOIN homes h
            ON p.id = h.pid
                AND h.type IN ('spaceport', 'cottage')
    GROUP BY p.name
    HAVING COUNT(DISTINCT h.type) = 2
"
33970,SQL statement for Group Count and Overall Count,"select student, own_80_cnt,
       sum(own_80_cnt) over () total_80_cnt
  from (select student,
               sum(case when score = 80 then 1 else 0 end) as own_80_cnt
          from mytable
         group by student);
"
32319,How to refresh datagrid from an sql query,"da.FillSchema(ds, SchemaType.Source)
"
8293,Is there an issue in SSIS with logging only child tasks but not its parent container?,"select id, event, source, starttime, endtime from dbo.sysssislog
"
22764,SQLite query to match text string in column,"select * from table 
where name like '%BMW%'
"
6565,SQL Server wildcard select with a twist,"SELECT FROM DESCRIPTION..LONG
    WHERE DESCR LIKE '%[ ""\/-]age[,.:;'' ""\/-]%'
"
36796,"Scala Enumerations (case objects) in Slick, good practice","implicit def doorStateMapper = MappedColumnType.base[DoorState, Int]( ... )
"
22213,NULL from SUM function,"WITH C AS(
    SELECT p_code, p_price, line_units 
    FROM product JOIN line USING (P_CODE)
    WHERE p_code = '23109-HB'
)
INSERT INTO line(inv_number, line_number, p_code, line_units, line_price)
  SELECT 1009, 1, p_code, line_units, SUM(p_price * line_units) FROM C 
"
31416,Retrieve info sql query,"SELECT  * FROM    EMPLOYEE 
where (Department_ID<>'30')
and 
 (
 employee_salary > 
  (select max(employee_salary) from EMPLOYEE  where  Department_ID='30')
 )
"
21026,How to check the value in comma separated data,"SELECT x, y
FROM theTable
WHERE ',' || x || ',' LIKE '%,' || searchValue || ',%'
"
5611,making a where clause optional in a sql statement,"SELECT `performers`.`hash`, `performers`.`alias`, 
  `performers`.`date_updated`, `performers`.`status`,
  IF(`performers`.`status` = 'active', 'deleted','active') AS `statususe`,
  `images`.`image_hash_file`
FROM `performers`
LEFT JOIN `images` ON `images`.`asset_id` = `performers`.`id` AND `images`.`asset_type` = 'performer'
ORDER BY `alias` ASC
LIMIT 12
"
27275,Group by clause to get name of highest paid employee,"WITH recordList
AS
(
    SELECT  dept, employeeName, salary,
            DENSE_RANK() OVER (PARTITION BY dept ORDER BY salary DESC) rn
    FROM    employee
)
SELECT dept, employeeName, salary
FROM   recordList
WHERE  rn = 1
"
27644,Android - Comparing String Input On A Textfile Content,"String delimiter = ""-"";
String[] temp;
String searchString = ""abacus"";

BufferedReader in = new BufferedReader(new FileReader(file));

while (in.readLine() != null) {
    String s = in.readLine();

    temp = s.split(delimiter);

    if(searchString.equals(temp[0])) {
        in.close();
        return s;
    }
}

in.close();
return (""Word not found"");
"
32843,WHERE ... IN with multiple columns,"SELECT * FROM users
WHERE 
    (firstname = 'Angelina' AND lastname = 'Jolie') 
OR
    (firstname = 'Brad' AND lastname = 'Pitt') 
OR
    (firstname = 'Kevin' AND lastname = 'Costner') 
"
3166,Delete Duplicate SQL Records,"delete 
   t1 
from 
   tTable t1, tTable t2 
where 
   t1.locationName = t2.locationName and  
   t1.id > t2.id
"
6249,HTML5 readTransaction not supported on iPad (iOS 3.2)?,"Mozilla/5.0 (iPad; U; CPU OS 3_2 like Mac OS X; en-us) AppleWebKit/531.21.10 (KHTML, like Gecko) Version/4.0.4 Mobile/7B334b Safari/531.21.10
"
12395,How can I use a SQL UPDATE statement to add 1 year to a DATETIME column?,"UPDATE Procrastination SET DropDeadDueDate = DATEADD(yyyy,1,DropDeadDueDate)
"
39803,How do I say where time is less that a certain hour/minute,"(
 DATEPART(hh,[AuditInsertTimestamp]) >= 17
 OR DATEPART(hh,[AuditInsertTimestamp]) < 5
 OR (DATEPART(hh,[AuditInsertTimestamp]) = 5
     AND
     DATEPART(minute,[AuditInsertTimestamp]) <= 30)
)
"
25763,SQL find next followup within X number of days (joins comparing datetimes),"select a.person_id, a.datetime, c.datetime as nextdatetime,
       (case when datediff(d, a.datetime, c.datetime) <= 3 then 'yes' else 'no'
        end) as within3days
from appointments a outer apply
     (select top 1 c.*
      from calls c
      where c.person_id = a.person_id and
            c.datetime > a.datetime
      order by c.datetime
     ) c;
"
15821,Mysql SELECT statement to return only rows where/if a given number of cols are not null,"SELECT * from Table 
WHERE ISNULL(c1) + ISNULL(c2) + ISNULL(c3) + ISNULL(c4) + ISNULL(c5) <= 2
"
541,how to create a b-tree index in H2 database?,"CREATE INDEX IDX_NAME ON TEST(NAME);
"
10664,Complex query filter using Like() in T-SQL,"SET @filter_1 = '%test%'
SET @filter_2 = '%foo%'
SET @filter_3 = '%'
SET @filter_4 = '%'

SELECT *
FROM BAR
WHERE var LIKE @filter_1
   OR var LIKE @filter_2
   OR var LIKE @filter_3
   OR var LIKE @filter_4
   OR var LIKE @filter_5
"
28140,Another substring question in sql server,";with T as
(
SELECT 'ABC;123; TGH' ColName
UNION ALL
SELECT 'DEF;123456; TFG'
)
SELECT
 PARSENAME(REPLACE(ColName,';','.'),2) as [result]
FROM T
"
3183,SQL query to select all columns in a table except two columns,"select a, c, d, e, g, h from TableA
"
14207,Retrieve table names from views using PL/SQL script,"SELECT
  * 
FROM
  sys.dba_dependencies 
WHERE referenced_type = 'TABLE'
START WITH ""NAME"" = 'VIEW_NAME_IN_QUESTION'
CONNECT BY PRIOR REFERENCED_NAME = ""NAME"" AND ""TYPE"" = 'VIEW';
"
15870,T-Sql: Select Rows where at least two fields matches condition,"SELECT *
FROM mytable
CROSS APPLY (
  SELECT COUNT(*) AS cnt
  FROM (VALUES (val1), (val2), (val3), (val4), (val5)) AS t(v)
  WHERE t.v = 4) AS x
WHERE x.cnt >= 2  
"
5054,Codeigniter LIKE with wildcard(%),"$this->db->like('title', $query);
$res = $this->db->get('film');
"
18520,How to use curly brace escaping for Oracle,"SELECT * FROM customer WHERE name = q'{Sam}'
"
29249,Show alternate result based on column value,"SELECT rnk, name ,gender
FROM (
  SELECT STRAIGHT_JOIN id, name, @y:=IF(@gender=gender,@y+1,1) AS rnk, @gender:=gender AS gender
  FROM (SELECT @gender:=NULL) AS x
  JOIN test
  ORDER BY gender, name DESC
) AS t
ORDER BY rnk ASC, gender DESC;
"
4838,Row value from another table,"Select * from Customer 
where CustNo IN
(
  SELECT CustNo
  FROM Rental
  GROUP BY CustNo
  HAVING COUNT(*) > 1
)
"
28432,Reverse engineer the structure of a database based on queries that are used,"DB: there is no name of DB
Table: sensor_readings (directly after from)
Column: READING_SENSOR_TEMP (AVG function take column as an argument) 
"
4017,How to pipe visually selected text to a UNIX command and append output to current buffer in Vim,":com -range C <line1>,<line2>yank | $ | put | .,$ !rev
"
30893,Finding the last duplicate row in (Oracle) SQL,"SELECT  *
FROM    (
        SELECT  h.*, 
                ROW_NUMBER() OVER (PARTITION BY workID ORDER BY date DESC) AS rn
        FROM    history
        )
WHERE   rn = 1
"
33079,"SQL aggregation query for SUM, but only allow positive sums (otherwise 0)","SELECT customer_id,
  CASE 
    WHEN SUM(order_total) < 0 THEN 0
    ELSE SUM(order_total)
  END
  FROM orders 
  GROUP BY customer_id;
"
24471,Can I use MySQL interactively from an SQL block in org-mode?,"C-c C-c send paragraph
C-c C-r send selected region
C-c C-b send entire buffer
C-c C-s send string
"
14427,Can't get unique values joining two tables,"SELECT
   MAX(t1.MB#) AS MB#,
   t2.RTU,t2.[Device Manufacturer],t2.PCC#_PRI,t2.PCC#_SEC,t2.[STATION ADDRESS] 
INTO C300_RTU_MASTERBLK_Map
FROM 
   dbombm_PCDIMasterBlk_tbl as t1
   JOIN
   dbo.WOA_PCC_Conn_tbl as t2 ON t1.PCCNo_PRI = t2.PCC#_PRI
GROUP BY
   t2.RTU,t2.[Device Manufacturer],t2.PCC#_PRI,t2.PCC#_SEC,t2.[STATION ADDRESS] 
"
21274,How do I build this complex sql?,"SELECT  a.*,
        b.Image as ID1IMAGE, -- alias is needed to avoid ambiguous columns
        c.Image as ID2Image
FROM    T2 a
        INNER JOIN T1 b
            ON a.ID1 = b.ID
        INNER JOIN T1 c
            ON a.ID2 = c.ID
WHERE   2 IN (a.ID1, a.ID2)   -- the condition can be done like this.
"
11289,change select statement value using sql,"SELECT 
'COM001', 
'John', 
case 
when cast('01-Jan-4501 00:00:00' as date) > cast('01-Jan-2100 00:00:00' as date)
then cast(getdate() as varchar(30))
else '01-Jan-4501 00:00:00'
end 
"
38671,Oracle Read Table and Conditional,"DECLARE
  pnum_cnt NUMBER;
BEGIN
  SELECT COUNT(*) INTO pnum_cnt FROM YOUR_TABLE;

  IF (pnum_cnt > 0) THEN
    -- Perform the other test
  END;
END;
"
32612,"Rails, ActiveRecord - how to get count rows in relation :belons_to?","Category.joins(:articles)
        .select(""categories.*, count(articles.id) as counter"")
        .order(""counter"")
"
7527,Increment column A when column B changes value,"select name, hour, value,
       dense_rank() over (order by name) as row_num
from t;
"
33901,Find all rows where start date is before a prior end date,"SELECT * 
FROM tblTest clashing
WHERE EXISTS 
(
    SELECT 1
    FROM tblTest mainlist
    WHERE clashing.trainderid = mainlist.trainderid 
        AND clashing.starttime < mainlist.endtime
        AND clashing.starttime > mainlist.starttime
)
"
8621,lock a table in sql server 2008 after select,"SELECT TOP 10 * FROM Orders WITH(NOLOCK) where UserName = 'VadaVici'
"
24399,Table with 2 FK that points to the same table,"SELECT j.ID, 
       p.Name AS `Person 1 Name`,
       p2.Name AS `Person 2 Name`
  FROM TableX j
  JOIN Person p
    ON p.ID = j.Person1ID
  JOIN Person p2
    ON p2.ID = j.Person2ID
"
5737,SQL Optimizer / Execution Plan - Repeated Subqueries,"> create table t(x);
> explain query plan
  select * from t
  where x in (select x from t) or
        x in (select x from t);
0|0|0|SCAN TABLE t (~500000 rows)
0|0|0|EXECUTE LIST SUBQUERY 1
1|0|0|SCAN TABLE t (~1000000 rows)
0|0|0|EXECUTE LIST SUBQUERY 2
2|0|0|SCAN TABLE t (~1000000 rows)
"
12264,SQLServer Query Windowing,"  ((row_number() over (order by group_rank, row_rank) - 1) / @batch_size) + 1
"
39457,SQL Display Most recent update from Junction table,"SELECT g.member_id, t.description
  FROM grades g
  INNER JOIN ( SELECT member_id, max(dte) as dte
         FROM grades
         GROUP BY member_id
          ) m
    ON (g.member_id = m.member_id AND g.dte = m.dte)
  INNER JOIN grade_type t ON (g.grade_id = t.id)
  ORDER BY g.member_id
"
3807,SQL Server 2005: Determine datatype of variable,"declare @d int

select @d = 500

if cast(sql_variant_property(@d,'BaseType') as varchar(20))  = 'int'
print 'yes'
else
print 'no'
"
9510,Cleaning up a database,"CREATE PROCEDURE sp_EmplyAllTable
AS
EXEC sp_MSForEachTable ALTER TABLE ? NOCHECK CONSTRAINT ALL
EXEC sp_MSForEachTable DELETE FROM ?
EXEC sp_MSForEachTable ALTER TABLE ? CHECK CONSTRAINT ALL
GO
"
22651,get the time difference?,"select datediff(hh, dateadd(ss, 1332516308, '19700101'),dateadd(ss, 1335192846, '19700101'))
"
30816,Specify a referential constraint with a constant,"SELECT Code 
FROM [Table 1]
WHERE Type = ""Foo""
"
33802,How do I select xml element attributes using a stored procedure?,"SELECT 
    Customer.attribute.value('@CustomerId', 'nvarchar(255)') AS CustomerId,
    Customer.attribute.value('@Name', 'nvarchar(255)') AS CustomerName
FROM 
    @xmlparam.nodes('Customers/Customer') AS Customer(attribute)
"
14106,Aggregate Self-Referencing Table,"with cte as (
    select t.Id, t.Amount, t.Id as [Parent Id]
    from Table1 as t

    union all

    select c.Id, t.Amount, t.Id as [Parent Id]
    from cte as c
        inner join Table1 as t on t.[Parent Id] = c.[Parent Id]
)

select Id, sum(Amount) as Amount
from cte
group by Id
"
14356,PL/SQL bulk collect into associative array with sparse key,"  cursor getPersonsCursor is
    SELECT ID, Name
    FROM   Persons
    WHERE  ...;

  subtype TPerson is getPersonsCursor%rowtype;
  type TPersonList is table of TPerson;
  persons TPersonList;
begin

open getPersonsCursor;
fetch getPersonsCursor
  bulk collect into persons;
close getPersonsCursor;

if persons.Count > 0 then
  for i in persons.First .. persons.Last loop
    yourAssocArray(persons(i).ID) := persons(i).Name;
  end loop;
end if;
"
8674,again new query. i am trying to solve this from one hour. please help,"select movie.title, actor.name
from movie
inner join casting 
    on movie.id = casting.movieid
    and casting.ord = 1 --Assuming this is the cast order flag
inner join actor
    on casting.actorid = actor.id
where movie.id in (
    select movie.id
    from movie 
    inner join casting 
        on movie.id = casting.movieid
        and casting.actorid = {your actorID in this case Julie Andrew's id
 )
"
32440,SQL query for selecting all items except given name and all rows with id of that given name,"SELECT cm.car_model_id, ci.car_location_name, cm.car_name
FROM CAR_MODEL cm
JOIN CAR_INVENTORY ci
  ON cm.car_model_id=ci.car_model_id
WHERE cm.car_model_id NOT IN (
  SELECT car_model_id FROM CAR_INVENTORY WHERE car_location_name='Germany'
)
"
30987,SQL query with simple join,"  select [Value] - lag([Value]) over (order by ID)
    from #test
"
20403,Does SQL*Plus natively allow queries to run from the shell itself?,"sqlplus  -S user/password << EOF | grep Primx
select * from emp;
EOF
"
9016,How to group by less columns than selected,"SELECT
    *
FROM (
  SELECT 
  a.str_column1, b.str_column2, c.date_column3, c.guid_column4,
  ROW_NUMBER() OVER (PARTITION BY a.str_column1, b.str_column2
                     ORDER BY c.date_column3 DESC) as rn
  FROM table
  ....
  joining the other tables here to get my columns
  ....
  --No longer needed GROUP BY a.str_column1, b.str_column2, c.date_column3, c.guid_column4
) t
WHERE t.rn = 1
"
26688,SQL table update all but the most recent record for every Id,"   FETCH NEXT FROM db_cursor INTO @customerid   
"
2797,Add a <script> tag to the <head> section from a partial loaded via af:declarativeComponent in Oracle ADF," <af:document>
   <af:resource type=""javascript"" source=""../javascripts/modernizr.js"">
   <af:resource type=""javascript"" source=""../some-stylesheet-file.css"">
  <af:form> 
   ...
  </af:form> 
</af:document>
"
35527,What is the best way to delete a joined association to a stored file in a database?,"UPDATE STEP
   SET screenshotid = NULL
 WHERE occurredon < DATEADD(dd, -30, GETDATE())

DELETE FROM SCREENSHOT
 WHERE NOT EXISTS(SELECT NULL
                    FROM STEP s
                   WHERE s.screenshotid = id)
"
13272,Joining table with range ID matching,"SELECT idX, columnX, columnY
FROM (
    SELECT id, columnY, @prevID AS prevID, @prevID := id
    FROM table2
    CROSS JOIN (SELECT @prevID := NULL) init
    ORDER BY id DESC) AS t2
JOIN table1 AS t1 ON t1.idX >= t2.id AND (t2.prevID IS NULL OR t1.idX < t2.prevID)
"
4692,"SQL join tables, total spent by all customers","SELECT c.custId, c.firstname, SUM(i.unitcost*li.quantity) total_spent
FROM customers c
    JOIN orders o ON c.custId = o.custId
    JOIN lineitems li ON o.orderId = li.orderId
    JOIN items i ON li.itemId = i.itemId
GROUP BY c.custId, c.firstname
HAVING COUNT(DISTINCT o.orderID)>1
LIMIT 0,30
"
4636,PL/SQL: How to detect which browser is being used?,"owa_util.get_cgi_env('HTTP_USER_AGENT')
"
34648,How to convert oracle number type to string with format?,"SQL> with t1(col) as(
  2    select 1   from dual union all
  3    select 2   from dual union all
  4    select 12  from dual union all
  5    select 340 from dual
  6  )
  7  select to_char(col, '000')        as num_1
  8       , lpad(to_char(col), 3, '0') as num_2
  9    from t1
 10  ;

NUM_1 NUM_2
----- ------------
 001  001
 002  002
 012  012
 340  340
"
15668,Auto Naming In Oracle DataBase when inserting to table,"insert into table_1 (p_code, o_code)
(-- add all rows in table_2 that are not present in table_1
 (select t2.p_code, t2.o_code from table_2 t2 
 minus
 select t1.p_code, t1.o_code from table_1 t1)
 union all
 -- add all rows in table_2 that are present in table_1
 (select t2.p_code, t2.o_code || '_2' from table_2 t2
  join table_1 t1a on t2.p_code = t1a.p_code and t2.o_code = t1a.o_code)
);
"
20747,Selecting Positive/Negative Values of a computation SQL,"HAVING (expr_for_ratio) > 0
"
6301,How to Select NOT IN Value (Formula Crystal Reports),"select * 
from  ARInvoices ar 
left join ARInvoiceDetails det on ar.InvoiceID = det.InvoiceID
left join CashReceiptInvoices cri on ar.InvoiceID = cri.InvoiceID
where  cri.InvoiceID IS NULL
   and det.SubmitTo = 1 
   and VoucherStatus = 0 
   and det.TransactionType = 1
"
25845,DELETE SQL: how delete only one value at a time,"DELETE FROM project.cart WHERE isbn = ? and ROWNUM=1;
"
30295,Modify argument in batch script,"$srch = '-v\s*(.*?)\s*=\s*%1'
$repl = ""-v `""'`$1'`"" = %1""

(Get-Content old.bat) -replace $srch, $repl | Set-Content new.bat
"
13851,SQL Getting Specific Column other than just the foreign key,"SELECT G.*, T1.NAME as T1_NAME, T2.NAME AS T2_NAME
FROM GAMES G
INNER JOIN TEAM T1 ON T1.T_ID=G.HO_T_ID
INNER JOIN TEAM T2 ON T2.T_ID=G.V_T_ID
"
21631,"SQL Server, Select CASE with different casting","IF @id = 1 THEN
 SELECT code ...
ELSE 
 SELECT Cast(Code AS int) as Code
"
23160,special characters in sql text,"INSERT INTO description(Text) VALUES (N'$text')
"
20490,Mysql Equal String returns 0 Rows and LIKE String returns 1 Row,"SELECT id FROM up_categorys WHERE TRIM(category_name) = 'Xbox Live' LIMIT 0 , 30
"
19888,Copy data from one table to another with constraints in Oracle,"UPDATE user u 
SET u.custom001 = (
  SELECT l.capacity
  FROM location l
  WHERE u.loc_id = l.loc_id
) where exists (
  select null from location l 
  WHERE l.loc_id = u.loc_id
  AND l.capacity <> u.custom001
  AND l.loc_type IN ('110','210')
  AND l.capacity IS NOT NULL 
  AND l.capacity <> 0
)
"
39122,Assigning a local variable from a table using a join statement,"   select [Type] From DP d 
   Join DTXR x on d.ProgramId = x.ProgramID
   where dtxr.QEI = @p_QEI
"
2261,SQL MAX() function selects the greatest in absolute value even if I don't use ABS()?,"SELECT TAG, MAX(cast(VALUE as decimal(10,1)))
FROM TABLE
GROUP BY TAG
"
15167,Oracle group data by Thursday to Wednesday,"TO_CHAR(NEXT_DAY(TRXDATE - 1, 'WED'), 'MM/DD/YYYY')
TO_CHAR(NEXT_DAY(TRXDATE - 1, 'WED'), 'IW')
"
20731,Select record Details and its own table count in select statements where Each record have its own table,"select recordid,name,description,rowcount
from
   [unnamedfirsttableinquestion] t
        inner join
  (select object_id,SUM(rows)
    from sys.partitions group by object_id) u (oid,rowcount)
     on
         u.oid = OBJECT_ID(t.tablename)
"
26129,"FirstName, LastName in SQL, too complex?","SELECT COALESCE(LastName + ', ' + FirstName, 
                LastName, FirstName) Name
FROM Person
"
25286,Reload database value after back button,"@Override
public void onResume()
{
    super.onResume();

    String s2 = ""Logged in as "" + myDbHelper.getActivePlayer();
    bPlayQuiz.setText(s2);
}
"
33961,MySQL get results for different timespans and group,"SELECT u.name, sum(s.online_time) as oneime,
       sum(case when login_time > NOW() - INTERVAL 1 DAY then s.online_time end) as ontime_1day,
       sum(case when login_time > NOW() - INTERVAL 7 DAY then s.online_time end) as ontime_1week,
       sum(case when login_time > NOW() - INTERVAL 1 MONTH then s.online_time end) as ontime_1month
FROM session_user s INNER JOIN
     users u
     ON u.id=s.user_id
GROUP BY u.id;
"
19310,sql to extract list of values given a xmlstring (oracle),"select x.myid
from xmltable('/xml/*'
  passing xmltype('
<xml>
    <myid>1</myid>
    <myid>2</myid>
    <myid>3</myid>
</xml>')
  columns myid path '/myid') x;
"
2211,Can .bat file execute an sql query and return a value?,"@echo select version from system; | sqlplus username/password@database 
"
2132,How to create temporary result set from selected set of data in SQL?,"with tmp_tbl as (
  select 'cat' as id from dual
  union all select 'dog' from dual
  union all select 'fish' from dual
)
select tmp_tbl.id, read_tbl.*
from tmp_tbl
left outer join real_tbl
on real_tbl.id = tmp_tbl.id;
"
21378,MySQL query optimization (joining similar query results)," SELECT COUNT(*) AS 'total' , 
       SUM(CASE WHEN `read`=0 THEN 1 ELSE 0 END) as `unread`
 FROM `the_table`
 WHERE `subject_id`=7
"
12596,Update more than one row in oracle,"   UPDATE emp_table  SET expiry_dt = TO_DATE 
   ('21.09.2009:00:00:01','DD.MM.YYYY:HH24:MI:SS'),
    WHERE emp_id IN ('78629160','111020102','88888888');
"
11895,Mysql count distinct with condition or case,"select sum(CaseStatus = 'Open') as OpenedCount
     , sum(CaseStatus = 'Closed') as ClosedCount
     , sum(CaseStatus = 'Hospitalized') as HospitalizedCount
from (<...>)
"
35502,mysql advanced order by query," SELECT id, TYPE FROM (
   SELECT id, TYPE, 
   IF(@myvar = 0 OR @myvar = TYPE, @counter := @counter + 1, @counter := 1) sequence,  
   @myvar := TYPE FROM mytable 
   JOIN (SELECT @myvar := 0, @counter := 0 ) a
   ORDER BY TYPE DESC, id) b 
ORDER BY sequence, TYPE DESC,  id
"
31078,Querying a many-to-many relationship with added difficulty,"SELECT *
FROM Objects o
WHERE 3 = (
    SELECT COUNT(DISTINCT t.id)
    FROM ObjectHasTag ot
    JOIN Tag t ON t.id=ot.tag_id
    WHERE o.id = ot.object_id
      AND t.tag IN ('tag1', 'tag2', 'tag3')
)
"
27994,SQL Query : select broken date ranges,"select tenantcode, date from DAILY where tenantcode = 'CMBINA15' 
AND CAST([date] as Date) between 
(
CAST('2013-02-01' as DATE) and CAST('2013-28-02'  as DATE) )
OR CAST([date] as Date) between
CAST('2014-02-01' as DATE) and CAST('2014-28-02'  as DATE) )
"
33009,How can I use a collection within an Oracle SQL statement,"CREATE OR REPLACE FUNCTION TESTFUNC01 RETURN VARCHAR2 AS 
  -- INT_LIST is declared globally as ""TYPE INT_LIST IS TABLE OF INTEGER""
  MyList INT_LIST := INT_LIST();
  MyName VARCHAR2(512);
BEGIN
  MyList.Extend(3);
  MyList(1) := 1;
  MyList(2) := 2;
  MyList(3) := 3;

  SELECT Name INTO MyName
  FROM Item WHERE ItemId NOT IN (select * from table(MyList));
  RETURN MyName;
END TESTFUNC01;
"
20379,Having trouble with this simple SQL Select statement,"select TableA.* 
  from TableA 
left outer join TableB on TableB.id = TableA.id
where TableB.id is null;
"
29244,SQL two lookups into same fields on one table,"select
    messages.*,
    f.user_name as from_id,
    t.user_name as to_id
from messages
    join users f on f.user_id = messages.from_id
    join users t on t.user_id = messages.to_id
;
"
15961,Numbering SQL query results based on groupings,"  select t.*,
         (@rn := if(@s = Section, @rn + 1,
                    if(@s := Section, 1, 1)
                   )
         ) as SubNumber
  from table t cross join
       (select @rn := 0, @s := '') vars
  order by Section;
"
21131,sql delete not working with ,"DELETE FROM <database> 
WHERE MAPPING_ID = '66' 
  AND FIELD_VALUE = N'Sanit' 
  AND PARENT_VALUE = 'ITA';
"
17175,"User emails with whitespaces, fix with MySQL?","update users set email = TRIM(email);
"
37054,Oracle null constraint,"CREATE TABLE mytable(   
   email varchar2(100), 
   cellphone varchar2(100),
   constraint null_check
   check (email is not null or cellphone is not null)
)
"
8184,"Oracle, describe users recyclebin, SQLPLUS","SELECT *
FROM dba_recylebin
WHERE owner = 'FOOBAR'
"
9061,Syntax for joining multiple tables,"select users.first_name,
users.last_name,
regions.name,
profiles.id, 
profiles.certs, 
profiles.title
from users 
left join profiles on profiles.user_id = users.id
left join region on profiles.region_id = regions.id;
"
29722,match results generated by SQL WHERE IN CLAUSE,"SELECT m.id 
FROM mySimpleTable m
JOIN (
  SELECT 'tom' AS name, 1 AS orderNum
  UNION ALL
  SELECT 'jerry' AS name, 2 AS orderNum
  UNION ALL
  SELECT 'kettie' AS name, 3 AS orderNum
) AS sub
ON m.name = sub.name
ORDER BY sub.orderNum ASC;
"
36546,Best way to compare and update two SQL tables,"delete SourceTableA 
where not exist (select 1 from DestinationTableB 
                 where DestinationTableB.key = SourceTableA.key)

insert into SourceTableA  
select * 
from DestinationTableB 
where not exist (select 1 from SourceTableA 
                 where DestinationTableB.key = SourceTableA.key)
"
3751,How to update one table from another table based on joins and subqueries,"update ppt
set ppt.PrjTermsID  = pp.PrjTermsID
from PlotPaymentTerms ppt
inner join ProjectPaymentTerms pp on ppt.InstNo = pp.InstNo and ppt.BlockID = 1
inner join PlotBooking pb on ppt.PlotBookingID = pb.PlotBookingID 
inner join PlotMaster pm on pb.PlotID = pm.PlotID 
where pm.AppartmentBlock = 1
"
22215,Getting new unique number in SQL Server,"declare @table table (id int, code int) 
insert @table values (1, 1), (2, 2), (3, 3), (4, 45), (5, 5)

select top 1 t1.code + 1
from (select null as id, 0 as code union all select * from @table) t1
left join @table t2 on t2.code = t1.code + 1
where t2.code is null
order by t1.code
"
21893,Insert multiple rows with default values without using union,"insert into user(name, subid)
    select n.name, coalesce(max(u.subid), 1)
    from (select 'bbb' as name union all select 'ccc') n left join
         user u
         on u.name = n.name
    group by u.name;
"
34468,Merging contacts in SQL table without creating duplicate entries,"--out with the bad
DELETE
FROM MailingListSubscription
WHERE PersonId = @SourcePerson
  and ListID in (SELECT ListID FROM MailingListSubscription WHERE PersonID = @DestPerson)

--update the rest (good)
UPDATE MailingListSubscription
SET PersonId = @DestPerson
WHERE PersonId = @SourcePerson
"
11727,SQL Inner join with function returning table,"SELECT t.col, s.Item
FROM dbo.tablename AS t
CROSS APPLY dbo.function_name(t.value) AS s;
"
20588,Select Query to generate and exclude some results by joining two tables,"SELECT home, configName, data, active
FROM config

UNION

SELECT ce.home, c.configName, c.data, c.active
FROM config_exceptions ce
INNER JOIN config c ON c.configName = ce.configName
WHERE ce.data <> c.data
AND c.home = 0
"
33591,Django Database: design of a model that combines two models,"class Order(models.Model):
    order_id = models.IntegerField(...)


class Step(models.Model):
    name = models.CharField(max_length=128)
    orders = models.ManyToManyField(Order, through='StepOrder')


class StepOrder(models.Model):
    order = models.ForeignKey(Order)
    step = models.ForeignKey(Step)

    ## date of the order starting this step
    date_created = models.DateField(...)
    date_end = models.DateField(...)

    status = models.CharField(max_length=128, default=""Pending"")
"
22989,In Where clause add check if Parameter is empty string,"SELECT a.Account_ID   
    FROM Accounts a
    WHERE ((@FirstName='' and a.FirstName is null) or a.FirstName = @FirstName) /*Add check if @FirstName = '' then a.FirstName IS NULL */ 
        AND a.LastName = @LastName 
        AND a.Middle = @MiddleName
        AND a.Email = @Email 
        AND a.Company = @Company
"
18381,"Select top 4 with order by, but only if actually required?","SELECT TOP 4
    M.SomeField,
    M.SomeField * 1/F.FunctionResults [SomeOtherField]
FROM #MytempTable M
CROSS APPLY (SELECT dbo.Myfunction(M.Param1, M.Param2, 34892)) F(FunctionResults)
ORDER BY F.FunctionResults
"
11912,Updating the cloned element values in db without deleting the Previous cloned field records,"@pre_data=MgMultiSelect.where(:mg_details_id=>params[:id])

@selected_data=params[:team_id_new]
if params[:team_id_new].present?

  params[:team_id_new].each do |id|
   obj = @pre_data.where(:team_id_new => id).first
   if obj.present?
    obj.update_attributes(:mg_details_id => @task_data.id,:is_deleted => 0 )
   end
  end
end
"
3501,Import sparse matrix from .csv directly into graph using neo4j and cypher,"LOAD CSV FROM 'file:///dummy.csv' AS line
MERGE (a:node {name:line[0]})
MERGE (b:node {name:line[1]})
MERGE (a)-[:connects]->(b);
"
28546,How to get 2 results from 3 tables with 1 mysql syntax,"SELECT a.soft_id,
  a.soft_name,
  b.p_cnt AS quantity,
  c.o_cnt AS owner_count
FROM soft a
INNER JOIN
  (SELECT soft_id, SUM(pu_quantity) AS p_cnt FROM product GROUP BY soft_id
  ) b
ON a.soft_id = b.soft_id
INNER JOIN
  (SELECT soft_id, COUNT(*) AS o_cnt FROM owner GROUP BY soft_id
  ) c
ON b.soft_id = c.soft_id
GROUP BY a.soft_id,
  a.soft_name
"
4049,How to display column name as data in another column,"DECLARE @SUBJECT_SPLIT VARCHAR(10)
SET @SUBJECT_SPLIT = SUBSTRING(@subject,1,2)
EXEC('SELECT FirstName, LastName,' + @Subject + ', ''' + @SUBJECT_SPLIT + '''
FROM Student')
"
23157,Oracle regex string not beginning with '40821',"^([012356789]|4[123456789]|40[012345679]|408[013456789]|4082[023456789])
"
30969,Conditional filtering based on a specified value or unspecified,"where tblRTC.CODE IN ('C1', 'C2', 'C3')
and CAST(tblDET.START_DATE AS Date) >= CAST (@start_date AS Date)
and CAST(tblDET.END_DATE AS Date) <= CAST (@end_date AS Date)
and tblSTACON.DESCRIPTION = (case when @station  not in( 'Unspecified') then @station else tblSTACON.DESCRIPTION end)
"
4557,MySQL update statement to store ranking positions,"select @rownum:=@rownum+1 rank, p.* 
from player p, (SELECT @rownum:=0) r 
order by score desc;
"
21637,Concating rows in SQL,"select NO,
  listagg(NAME, ',') within group (order by NAME) as name
from TableName
group by NO
"
35249,Use Case is postgresql query to get record based on condition,"SELECT e.emp_name,
       e.id,
       coalesce(r.leavingdate, e.retiredate) as some_date 
FROM tblemp e
   LEFT JOIN tblresign r ON e.id = r.emp_id
"
2436,"var data = Database.Open(""databasename"").Query(""SELECT * FROM table); visual studio","using (var con = new SqlConnection(WebConfigurationManager.ConnectionStrings[""databasename""].ConnectionString))
{
    var data = con.Query(""SELECT * FROM table"");

    foreach (var row in data)
        // do stuff
}
"
15461,SQL truncate length of a string,"select substring(name from 1 for 12) from your_table
"
22610,String replacement for formatting a name in mysql,"SELECT 
    CASE WHEN INSTR(name, ',') > 0 
        THEN TRIM(CONCAT(SUBSTRING_INDEX(name, ',', -1), ' ', SUBSTRING_INDEX(name, ',', 1))) 
    ELSE name END AS name_formatted
FROM tbl
"
18586,How do I group by first name in MySQL?,"SELECT COUNT(*),SUBSTRING_INDEX(fullname,' ',1) AS givenname 
 FROM yourtable 
 GROUP BY givenname;
"
13313,Omit Aggregate Column in SQL Query,"SELECT TOP 1 Id, Description
FROM Record
ORDER BY CREATED DESC
"
4357,Django keep statistics up to date,"from django.db.models import signals
import models

def itemSaved(sender, **kwargs):
    obj = kwargs['instance']
    colorMod =  models.Color.get(name = obj.color)
    colorMod.count = colorMod.count + 1
    colorMod.save()

# listen to post_save event for model MyModel
signals.post_save.connect(itemSaved, sender=models.MyModel)
"
18031,How to load a column with multiple values into separate lines into a table,"SELECT T1.ItemNum, T2.mySplits as Substitute
FROM
 (
  SELECT *,
  CAST('<X>'+replace(T.Substitutes,'/','</X><X>')+'</X>' as XML) as my_Xml 
  FROM Table1 T
 ) T1
 CROSS APPLY
 ( 
 SELECT my_Data.D.value('.','varchar(50)') as mySplits
 FROM T1.my_Xml.nodes('X') as my_Data(D)
 ) T2
"
7345,SQL Divide a string when a comma appears and join it back in reverse order,"Select 
right(name,len(name)-charindex(', ',name)) + ' ' +
left(name,charindex(', ',name)-1)
from @table1;
"
6857,Oracle: How to get a month without year restriction?,"select * 
from orders
where extract(month from order_date) in (3,4,5);
"
34908,Historical Data Test in SQL,"SELECT  COUNT(EMPNAME),
        [DATE]
from (
    select  TABLEB.EMPNAME,
            TABLEA.[DATE ]
    from TABLEB 
    cross join TABLEA  
    where TABLEA.[date] >= TABLEB.StartDate 
        and TABLEA.[date] <= TABLEB.ENDDATE
        ) AS T
group by [DATE];
"
38888,How to get students whose 21th birthday is next month in SQL?,"SELECT * FROM students
WHERE MONTH(birthdate) = (MONTH(NOW()) % 12) + 1
      AND
      TIMESTAMPDIFF(YEAR, birthdate, NOW()) = 20
"
7639,PostgreSQL performing an OR merge of two similar tables,"select year, 
       coalesce(a.r001, b.r001) as r001,
       coalesce(a.r002, b.r002) as r002
from table_a a
  full outer join table_b b using (year)
order by year;
"
15251,How do I do a where clause in sql and return a count back?,"Select Count(*)
From Product
where active = 'true'
"
33015,SQL Selecting all BUT the last row in a table?,"SELECT ...
FROM MyTable
WHERE Id < (SELECT MAX(Id) FROM MyTable)
"
22916,Find duplicate column value in sqlite,"SELECT DataId, COUNT(*) c FROM DataTab GROUP BY DataId HAVING c > 1;
"
6937,Sql query to determine when threshold was reached,"SELECT TOP 1 T1.Dateadded, T1.Team FROM Table1 T1
 JOIN Table1 T2
  ON T1.Team = T2.Team
    and T1.Dateadded >= T2.Dateadded
GROUP BY T1.Dateadded, T1.Team
HAVING SUM(T2.Score) >= @Threshold
ORDER BY T1.Dateadded 
"
21200,SQL Group By and Count on two columns,"SELECT country, city, count(city) as city_count,
       (SELECT count(*)
        FROM jobs AS j2
        WHERE j1.country = j2.country) AS country_count
FROM jobs AS j1
GROUP BY country, city
"
31982,Update a column of a table to be a sequence,"update a set c1 = c1_new
from (
  select 
    c1, c2
  , c1_new = row_number() over (order by nullif(c1,c1))
  from dbo.t1
  ) a
"
25843,How to do a right outer join in MySQL?,"SELECT t3.* FROM (
    SELECT t1.* FROM t1
    LEFT OUTER JOIN t2 ON t1.wid = t2.wid
    WHERE t2.wid IS NULL)
AS t3;
"
23138,Count query results on multi-join statements,"select 
    cnt.loginid, 
    COUNT(*)
from contact cnt 
    right join grpmem list on cnt.contact_uuid = list.member 
    left join contact grp on grp.contact_uuid = list.group_id 
    join contact_acctyp cntacc on cnt.contact_uuid = cntacc.contact_uuid
where cntacc.c_acctyp_id in (select id from acctyp_v2 where sym like 'CDN%')
GROUP BY
     cnt.loginid
"
27931,Is this a valid use of NULL foreign keys?,"Sensor
  ID: PK
  ... common sensor fields ...

SensorType1
  ID: FK(Sensor)
  ... specifics ...

SensorType2
  ID: FK(Sensor)
  ... specifics ...

Reading
  ID: PK
  Sensor: FK(Sensor)
  Timestamp: DateTime
  Value: whatever
"
21279,Using Table As Input to Query for Substrings,"select distinct wt.operation
from words_table wt
where YOURSTRING like '%' || wt.words || '%';
"
35035,"sql query, wildcard, MS SQL SERVER 2005","SELECT  DirName, count(*) AS FileCount, SUM(Size)/1024 as 'SizeKB' 
FROM  alldocs
Where DirName LIKE 'site/test/test/%'
GROUP BY  dirName 
ORDER BY DirName
"
36991,Migrating row from one table to another with conditions [MYSQL],"update table1 tab1, table2 tab2 set tab1.colorname=tab2.colorname where tab2.brand=tab1.brand;
"
26579,wrong date insert into the datablock,"SELECT  to_date(TO_CHAR(sysdate, 'DD/MM/YY HH:MI:SS AM'),'DD/MM/YYYY HH:MI:SS AM')
FROM dual;
"
3756,Multiple conditions on the joined table when using group by,"SELECT p.id AS id, p.name AS name
FROM   products p, products_sizes s
WHERE  p.id = s.product_id AND s.size_id IN (1, 3)
GROUP  BY s.product_id
HAVING COUNT(DISTINCT s.size_id) = 2;
"
24500,How can I use a variable within a stored procedure,"DECLARE @productType INT = 1
DECLARE @table  NVARCHAR(MAX)
DECLARE @sql    NVARCHAR(MAX)

SELECT @table = 
    CASE @productType
        WHEN 1 THEN 'products1'
        WHEN 2 THEN 'products2'
    END

SELECT @sql = 'SELECT * FROM ' + QUOTENAME(@table);

EXEC(@sql)
"
10192,Speed up MYSQL INNER JOIN Query Across Two Tables,"SELECT p.id
     , p.date
     , COUNT(*) AS t_count 
FROM posts p
  INNER JOIN post_tags pts 
    ON pts.post_id = p.id
WHERE EXISTS
      ( SELECT *
        FROM post_tags pt
        WHERE pt.post_id = p.id
          AND pt.t_id IN (7,456)
      )
GROUP BY p.id
ORDER BY t_count, p.s_count DESC, p.id DESC 
LIMIT 0, 50 ;
"
35448,Get best offers from the database query,"SELECT p.id, p.descricao, p_s.preco as antigo, pr.preco as novo
FROM produtos_supermercados p_s JOIN
     produtos p
     ON(p_s.id_produto = p.id) JOIN
     promocoes pr
     ON(pr.id_produto = p.id)
ORDER BY pr.preco / p_s.preco desc;
"
29482,In SQL how to check if a string contains a substring in(case insensitive)?,"SELECT * FROM products WHERE lower(name) LIKE '%a%'
"
1439,find nth highest salary in sql,"SELECT * FROM EMPLOYEE e1
WHERE N-1 = 
           (SELECT COUNT(e2.ORIG_SALARY) FROM EMPLOYEE e2
                  WHERE e2.ORIG_SALARY > e1.ORIG_SALARY)
"
39891,SQL - Select all teams that wore exactly two different shirt colors?,"SELECT TeamName 
FROM Playing 
GROUP BY TeamName 
HAVING COUNT(DISTINCT ShirtColor) = 2
"
30490,Finding statistics about duplicate emails in MySQL,"SELECT
  repeated,
  COUNT(*) AS numemails
FROM (
  SELECT 
     email,
     COUNT(*)
  FROM emails
  GROUP BY email
) emailcounts
"
19975,How to get JDBC SQL Count result as int?,"if (rs1.next()) {
  int count = rs1.getInt (1);
}
"
35329,Join Multiple Table on Mysql,"SELECT  a.Name, b.Description, c.Qty
FROM    Staff a
        CROSS JOIN Services b
        LEFT JOIN StaffServices c
            ON a.ID = c.Staff_ID AND
                b.ID = c.Services_ID
ORDER   BY a.Name, b.Description
"
24802,Get Id Column from XML Attributes,"select d.value('(//ProductVariantAttribute/@ID)[1]', 'int') val
from (select id, cast(xmlstring as xml) data from xmldata) d
cross apply data.nodes('//ProductVariantAttributeValue[Value[1] = 225]') data(d)
"
570,"Displaying last_name, Dept_id, (max)Salary","WITH RCounter AS (
    SELECT department_id, last_Name, Salary,
           DENSE_RANK() OVER(PARTITION BY department_id ORDER BY Salary DESC) AS RowNumberCounter
        FROM <<tablename>>
)
SELECT department_id, last_Name, Salary
    FROM RCounter 
    WHERE RowNumberCounter = 1;
"
24876,Drupal database data parsing,"$data = unserialize(""thatlongstring"");
print_r($data);
"
19408,Easiest way to populate a temp table with dates between and including 2 date parameters,";WITH cte AS (
SELECT CASE WHEN DATEPART(Day,@StartDate) = 1 THEN @StartDate 
            ELSE DATEADD(Month,DATEDIFF(Month,0,@StartDate)+1,0) END AS myDate
UNION ALL
SELECT DATEADD(Month,1,myDate)
FROM cte
WHERE DATEADD(Month,1,myDate) <=  @EndDate
)
SELECT myDate
FROM cte
OPTION (MAXRECURSION 0)
"
32988,Is it possible to name SQL result columns from rows in another table? (Postgres),"SELECT u.id, a_city.value AS city, a_region.value AS region
 FROM users u
 INNER JOIN user_attribute_values a_city ON a_city.client_id = u.id AND a_city.attribute_id = 8
 INNER JOIN user_attribute_values a_region ON a_region.client_id = u.id AND a_region.attribute_id = 9
 WHERE LENGTH(a_city.value) > 0
   AND LENGTH(a_region.value) > 0
"
31767,Query Asterisk CDR in MYSQL to list inbound calls by SIP number?,"SELECT 'xxxxxxxxxxx' as 'tel', count(*) as 'count' from CDR where did = 'xxxxxxxxxxx'
"
26371,SQL Batched Delete,"DECLARE @count int
SET @count = 10000

    DELETE  FROM table1 
    WHERE table1id IN (
    	SELECT TOP (@count) tableid
    	FROM table1
    	WHERE x='y'
    )
"
8863,"In Oracle SQL Developer, how do I create or update a procedure and have the schema name be a variable","DEFINE MY_SCHEMA_NAME = 'SCHEMA1'
/
CREATE OR REPLACE PROCEDURE &my_schema_name..updateDBUSER(
       p_userid IN DBUSER.USER_ID%TYPE,
       p_username IN DBUSER.USERNAME%TYPE)
IS
BEGIN
  UPDATE DBUSER SET USERNAME = p_username where USER_ID = p_userid;
  COMMIT;
END;
/
"
6947,how to filter a table that having exactly the specified values in tsql,"SELECT [group_ID]
FROM Table1 T
WHERE [tax_Id] in (2,3,4)
And not exists
( select 1 from Table1 E
Where T.group_id = E.group_id
And tax_id not in (2,3,4)
)
Group by group_id
Having count(distinct tax_id) =3
"
35545,Add results of one SQL query to another query,"select Person_Ref from Images where Effect_Ref = 2 and Person_Ref IN 
( your first query which gives 2 4 5 6)
"
29311,Query records that fall between two week numbers,"WHERE to_char(date, 'YYYY-IW') BETWEEN to_char(sysdate - 21, 'YYYY-IW') AND
                                       to_char(sysdate, 'YYYY-IW')
"
28884,SQL display today only between start date and end date,"SELECT *
FROM MyTable
WHERE Date() >= StartDate 
  AND Date() =< EndDate
  AND DateField = Date()
"
36516,select one row per ID,"SELECT
   ...
FROM
    (SELECT
       *,
       ROW_NUMBER() OVER (PARTITION BY Column1 ORDER BY (SELECT 1)) AS rn
    FROM
       MyTable
    ) foo
WHERE
   rn = 1
"
21728,MySQL Cross-Table Count(*) Query Help,"SELECT `t1`.`id` , COUNT(`t2`.`id`) AS `count`
FROM `t1` LEFT JOIN `t2` ON `t1`.`id` = `t2`.`id`
GROUP BY `t1`.`id`
"
11927,How can I use AND condition in IF EXISTS in SQL?,"IF EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'X' AND COLUMN_NAME = 'Y') 
AND EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'Z' AND COLUMN_NAME = 'A')

BEGIN
    UPDATE [dbo].[X] 
        SET Y= (SELECT inst.[A] FROM [dbo].[Z] s WHERE s.[B] = [dbo].[x].[B]);
END    
GO
"
31950,SQL: Where between two dates without year?,"SELECT * FROM tbl t
WHERE 
  MOD(DAYOFYEAR(currdate) - DAYOFYEAR(t.the_date) + 365, 365) <= 14
  OR MOD(DAYOFYEAR(t.the_date) - DAYOFYEAR(currdate) + 365, 365) <= 14
"
6843,"SQL date comparison in WHERE clause, TypoScript","lib.my_val {  
       select {  
        pidInList = 100000  
        max = 1  
        where = UNIX_TIMESTAMP(effective_date) < UNIX_TIMESTAMP()  
        orderBy = UNIX_TIMESTAMP(effective_date) DESC  
      }  
      table = tx_my_table  
    }
"
15220,SQL SELECT DISTINCT columns then add another column in same table,"SELECT 
USERID, Policy_Name, Account_Type, WEEKNUM, EMPLOYEETYPE, MANAGERID, max(""Acc-Check"")
FROM table1
group by USERID, Policy_Name, Account_Type, WEEKNUM, EMPLOYEETYPE, MANAGERID
"
28610,Using case to select field based on value of another field,"SELECT b.Bookingtype, b.Bookingnum
     , COALESCE(main.date, b.date) AS date
FROM   bookings b
LEFT   JOIN bookings main ON b.Bookingtype = 'sub'
                         AND main.Bookingnum = left(b.Bookingnum, 4);
"
35355,SQL: Union of polygons,"CREATE TABLE #g (i INT IDENTITY, a geometry)
INSERT INTO #g (a)
VALUES
    (geometry::STGeomFromText(
        'POLYGON((0 0, 3 0, 3 3, 0 3, 0 0))', 0)
    ),
    (geometry::STGeomFromText(
        'POLYGON((5 2, 7 2, 7 0, 5 0, 5 2))', 0)
    )

DECLARE @g geometry
SELECT TOP 1 @g = a FROM [#g]
SELECT @g = @g.STUnion(a) FROM #g

SELECT @g
"
35748,INNER JOIN does not work for me,"SELECT      dev.* 

FROM        dev

LEFT JOIN   task
    ON      dev.id=task.id_dev 

WHERE       task.id_dev IS NULL

ORDER BY    dev.id;
"
21818,Convert Access Left & Mid to SQL,"SELECT 
    name, 
    entnum,
    CASE 
        WHEN SUBSTRING(entnum,4,1) = '0' THEN SUBSTRING(entnum,5,2)
        ELSE SUBSTRING(entnum,4,3) 
    END agencycode
FROM CUSTFILE 
"
21554,SQL Server query xml attribute for an element value,";WITH XMLNAMESPACES(DEFAULT N'http://www.kaseya.com/vsa/2007/12/ServiceDeskDefinition.xsd')
select
    T.C.value('data(.)', 'nvarchar(128)')
from [YOUR_TABLE] as Y
    outer apply Y.[YOUR_XML_COLUMN].nodes('/CustomFields/Field[@fieldName=""CwTicketId""]') as T(C)
"
31523,Concatenate as A and choose either A or B according to their FKs,"SELECT IDowner as IDoutput,
       COALESCE(FirstName || ' '  || LastName, CompanyName) AS Name
FROM Owner
LEFT JOIN Contacts ON Owner.IDcontacts = Contacts.IDcontacts
LEFT JOIN Company  ON Owner.IDcompany  = Company .IDcompany
"
248,Does indexed search applies in a where clause with a bitwise operation?,"SELECT idRow, idThing,  morColumns FROM MyTable WHERE idUser = ? AND flags IN (combination1 ..combinationn);
"
31627,How do I create a not mandatory join?,"SELECT `prod_combined`.`sku`, `prod_combined`.`titel`, `prod_combined`.`preis_vk`, `prod_performance`.* 
FROM `prod_combined` 
LEFT JOIN `prod_performance` ON prod_combined.sku = prod_performance.sku
  AND prod_performance.partner_id = 801
  AND prod_performance.active >= 0
WHERE prod_combined.aktiv = 1 
  AND prod_combined.sku = 1006224000  
LIMIT 5
"
14513,"How to check for a substring in a column, using CASE /IF (SQL querying)","SELECT col5,
       CASE 
         WHEN Table1.Col1 IS NULL Then Table2.Col2
         WHEN Table1.Col1 LIKE '%substring' THEN Table1.Col1
         ELSE Table2.Col2
       END
FROM Table1
JOIN Tablex ON Tablex.colID= Tabley.colID
JOIN Table1 ON Table1.colID = Tablex.colID
"
17842,Combine two SQL queries with a different status column in each,"SELECT *, 'Required' as status FROM tblMain WHERE where_1
UNION
SELECT *, 'Optional' as status FROM tblMain WHERE where_2
AND ID Not IN (SELECT ID FROM tblMain WHERE where_1)
"
8423,Sql Like operator that matches a column with only multiple whitespaces,"SELECT 'True'
WHERE '                     ' = ''
"
24999,SQL Group By only incude distinct entries not previously in table,"SELECT   YearCreated, COUNT(*)
FROM     (SELECT    UserId, DATEPART(year, MIN(DateCreated)) AS YearCreated
          FROM      users
          GROUP BY  UserId) t
GROUP BY YearCreated
"
16193,connect to sql via windows authentification over vpn,"runas /noprofile /netonly /user:domain\username ssms.exe
"
29883,mysql Sub queries in COUNT along with GROUP BY YEAR,"SELECT 
YEAR(t.voucher_date) as period,
COUNT(t.id) as total_count, 
(SELECT COUNT(t2.id) FROM booking_global as t2 where t2.booking_status = 'CONFIRMED' and YEAR(t2.voucher_date) = YEAR(t.voucher_date)) as confirmed,
(SELECT COUNT(t3.id) FROM booking_global as t3 where t3.booking_status = 'PENDING'  and YEAR(t3.voucher_date) = YEAR(t.voucher_date)) as pending
FROM booking_global t 
GROUP BY YEAR(t.voucher_date)
"
1030,Database design for 2 tables which are related by an id,"Budget             Category          Transactions
budget_id          category_id       transaction_id
category_id                          budget_id   
"
33640,How to improve a postgresql query?,"with tmpdetail2 as (
  select d2.detailid, d2.objid, d2.p
  from _detail d2                         
  where d2.detailid in (19, 106)  
)
select distinct d.detailid, d.p, d.pval, d.objid
from _detail d 
left join tmpdetail2 d2
  on d.objid = d2.objid
where d2.objid is null 
  and d.p not in(select p from tmpdetail2)  
order by p asc, d.detailid asc;
"
14796,Need a query returns the records which contains different characters of a list,"select * from [TABLE] where [FIELD] LIKE '%[^a-zA-Z0-9-\& \.]%'
"
6430,SQL Server : Not So Simple IF Statement,"DECLARE @count INT
SET @count = isnull((SELECT TOP 1 [count] from products WHERE [count] > 1),0)
IF (@count > 1)
    BEGIN
        PRINT 'It works!'
    END
"
2142,Create a view that shows from which table content comes,"SELECT o.date, 'Output' AS type, ol.amount AS amount_out, NULL AS amount_in
FROM   outputline ol
JOIN   output     o USING (outputid)

UNION ALL
SELECT i.date, 'Input', NULL, il.amount
FROM   inputline il
JOIN   input     i USING (inputid)
ORDER  BY date, type;
"
11333,Quick SQL question: Correct syntax for creating a table with a primary key in H2?,"CREATE TABLE MyTableName(PKFieldName IDENTITY PRIMARY KEY, StringFieldName VARCHAR(255))
"
35995,Skip date in MySQL query if it is empty when using < and >,"SELECT SQL_CALC_FOUND_ROWS id, dateTime
FROM Message
where dateTime IS NULL or dateTime <> '';
"
26431,SQL CAST or Convert to SUM,"CAST(LTRIM(RTRIM(VL3CONSIDERATION)) AS NUMERIC (20,2))
"
12397,quickest way of deleting data from mysql,"DELETE  c
FROM    `qcvalues`.`batchinfo_2009` b
JOIN    calibration_2009 c
ON      c.rowid = b.rowid
WHERE   b.reporttime LIKE '%2010%';
"
6161,How to extract matched line of a multiline record in Oracle?,"select 
  customer_id,
  regexp_substr(exp_comment,'.*'||chr(10)||'(.*Export)', 1, 1, 'n', 1) as export
from export_comments 
"
37528,Delete duplicate rows from a table on the basis of column values,"with c as
(
    select *, row_number() over(partition by PromotionType, NightType order by [Value] desc) as n
    from PromoDescription
)
delete from c
where n > 1;
"
35399,get list of products in stock at any given date,"SELECT ProductFK, SUM(IF(m.direction='IN'))-SUM(IF(m.direction='OUT')) AS stock
FROM Move m WHERE m.Date < '20090101' AND stock > 0
"
37525,MyBatis RowBounds doesn't limit query results,"<select
  id=""selectFoo""
  parameterType=""com.foo.bar.SettingsBean"">

select *
from foo
where rownum >= #{rowStart}
  and rownum < #{rowEnd}
</select>
"
3732,"New activity record (startdate, enddate) without overlap in Standard SQL","(Start1, End1) overlaps (Start2, End2)
if and only if
Start1 < End2 && Start2 < End1
"
29437,"Fastest ""Get Duplicates"" SQL script","select afield1,count(afield1) from atable 
group by afield1 having count(afield1) > 1
"
18696,Distinct values in columns X per Distinct values in column Y,"select customer, sum(return) as return, sum(category) as category
from (select distinct customer, return, release, category
      from orders
     ) o
group by customer;
"
12748,"MYSQL - Is there a better way to query multiple unique values than using a large statement containing ""OR""s","SELECT * FROM table WHERE id IN (1173,223,363443,11532,45663,28313,717713,128313)
"
35696,How can I tell if I have uncommitted work in an Oracle transaction?,"SELECT  *
FROM    v$session v
WHERE   v.AUDSID = userenv('sessionid')
    AND v.TADDR IS NOT NULL
"
11295,How to get a specific combination of columns in MySQL,"select 
 e.employee_id, e.salary as emp_salary, e.manager_id, m.salary as mgr_salary
from employees as e
left outer join employees as m on m.employee_id=e.manager_id
where e.salary > m.salary
"
25192,complex paratition sum in postgresql,"Select .....,
       (coalesce( SUM(a.qty) OVER (PARTITION BY a.itemid), 0) -
        coalesce( SUM(a.qty) OVER (PARTITION BY a.itemid, a.deliveryid), 0)
       ) as qtyOther
"
30823,SQL - Select rows based on a hierarchy of conditions,"select * from (
select ID, Type, ROW_NUMBER() OVER (PARTITION BY ID ORDER BY Type DESC) rn
FROM #temp
) a where rn = 1
"
6294,Remove duplicates by key columns in SQL Server,";WITH CTE
AS
(
SELECT 
  key1, var1, key2, key3, var2, var3, 
  row_number() over (partition by key1, key2, key3 order by timestamp) rn
FROM 
  #HAVE
)
SELECT 
  key1, var1, key2, key3, var2, var3
FROM
  CTE
WHERE
  rn = 1
"
15384,How to check if a table already exists in the database by using MySQL?,"SELECT table_name
FROM information_schema.tables
WHERE table_schema = 'dbname'
  AND table_name = 'my_tablename';

+----------------------+
| table_name           |
+----------------------+
| my_tablename |
+----------------------+
"
874,SQL Join of 2 tables to subtract quantities using Java,"UPDATE Orderdetails od
INNER JOIN Titles t ON od.id = t.id
SET t.No_of_copies_in_inventory = (t.No_of_copies_in_inventory - o.QtyOrdered)
WHERE od.id = 'idhere'
"
12323,SQL query that reports N or more consecutive absents from attendance table,"SET @studentID = 0;
SET @subjectID = 0;
SET @absentRun = 0;

SELECT *,
CASE
    WHEN (@studentID  = studentID) AND (@subjectID  = subjectID) THEN @absentRun := IF(attendanceStatus = 1, 0, @absentRun + 1)
    WHEN (@studentID := studentID) AND (@subjectID := subjectID) THEN @absentRun := IF(attendanceStatus = 1, 0, 1)
END AS absentRun
FROM table4
ORDER BY studentID, subjectID, classDate
"
26081,SQL query to group by datetime and get total values for 2 other fields,"SELECT 
    CAST(Modified AS DATE) AS DateValue, 
    SUM(CASE WHEN [Status] = 1 THEN 1 ELSE 0 END) AS Status1Count,
    SUM(CASE WHEN [Status] = 2 THEN 1 ELSE 0 END) AS Status2Count    
FROM MyTable
GROUP BY 
    CAST(Modified AS DATE)
"
2717,SQL Update column values using subquery,"UPDATE employees x INNER JOIN (
    SELECT employeeId, newSalary FROM ....
) y ON x.employeeId=y.employeeId
SET x.salary=y.newSalary
"
11541,sql query to fetch data with a time interval,"select *
from
(
    select *, 
       datepart(minute, yourDate) mn, 
       row_number() over(partition by datepart(minute, yourDate) order by yourDate) rn
    from yourTable
) x
where (mn % 5) = 0
    and rn = 1
"
13614,Select most recent record based on date,"Select TOP 1 *
from Table
order by [Date] DESC
"
13649,Oracle - Selecting the n-1 record from a table,"SELECT results
  FROM (SELECT results,
               rank() over (order by results desc) rnk
          FROM your_table_name)
 WHERE rnk = 2
"
15072,Comparing counts across two tables,"INSERT INTO tblSignUps
select NULL,12,3 from dual
where exists (
   select * from tblEvents where
     fldEventId = 12 and
     fldWSCap > (select count(*) from tblSignUps where fldEventId = 12 and fldPosition = 3)
  );
"
39025,Select and count rows by category,"SELECT
    COUNT(item_table.id_category) as total,
    category_table.name
FROM
    category_table
    INNER JOIN item_table ON item_table.id_category = category_table.id_category
GROUP BY
    id_category
"
29670,SQL String Comparision Ignoring White Space,"WHERE REPLACE (column, ' ', '') LIKE 'SupervisionCharges'
"
32215,Sqlite SQL query to include empty groups,"SELECT participiants.name, MAX(outcomes.score)
FROM participiants
LEFT JOIN outcomes
ON participiants.name = outcomes.participiant
GROUP BY participiants.name
"
34610,Delete SQL looping,"INSERT INTO @ids (id)
SELECT id FROM (
    SELECT id, RANK() OVER (PARTITION BY clientid ORDER BY id) AS Rank FROM tRealtyTrac
) t
WHERE t.Rank <= 1000
"
32309,SQL Server Bulk Insert - How to define missing fields?,"INSERT ... SELECT * FROM OPENROWSET(BULK...)
"
9020,"Select single record where ""key = value"" or ""key is null"" if no match by value","SELECT *
FROM   YourTable yt
JOIN (
    SELECT ID, MAX(Key) AS Key
    FROM   YourTable
    WHERE  Key IS NULL
        OR Key = @key
    GROUP BY ID
) inQ ON inQ.KD = yt.ID AND inQ.Key = yt.Key
"
608,Restrict the date range to 20 days,"select * from my_table where date_field between From_date and From_date+20
"
26848,left outer join sql 2012,"SELECT t1.*, t2.column1
FROM t1
LEFT OUTER JOIN t2 ...
"
24340,Count multiple criteria in separate columns - MySQL,"SELECT
    User, 
    COUNT(*) AS Num,
    SUM(Action = 'Comment') AS NumComments,
    SUM(Action = 'View') AS NumViews
FROM some_table
GROUP BY User
"
31996,Calling sp_help on linked server,"exec [198.198.198.198].[sms].[dbo].sp_help 'id.applicantion'
"
5667,Finding Null values in multiple columns in SQL,"SELECT 
CAST (
(SELECT * FROM yourtable FOR XML path('x'),ELEMENTS XSINIL) 
AS XML)
.query('//.[@xsi:nil=""true""]/..')
"
30999,merge 2 identical tables rows,"SELECT id, total, 'OK' as status
FROM First_Table
UNION ALL
SELECT id, total, 'CANCEL' as status
FROM Second_Table
"
11693,Find efficient way of joining tables," SELECT title.*, film.*,songs.* 
 FROM title t JOIN film f
    ON t.title_name = f.title_name
 JOIN songs s
    ON t.title_name = s.title_name
"
29895,Stored procedure SQL Server parameter,"CREATE PROCEDURE [GetPercentages]
( @Low INT, @High INT )
AS
BEGIN
    SELECT *
    FROM [MyTable]
    WHERE [Percentage] BETWEEN @Low AND @High
END
"
39837,Fast solution to fill create and fill db table with data from csv file,"require 'csv'

CSV.foreach(fileName, :headers => true, encoding: ""UTF-8"") do |row|
  row['myfiled'].to_s
end
"
26060,How to make a inner join with condition...?,"SELECT * FROM table2
INNER JOIN WITH table1 ON table2.id = table1.id
    AND (table1.value1 = table2.value1 OR table1.value1 IS NULL)
    AND (table1.value2 = table2.value2 OR table1.value2 IS NULL)
"
19270,Using output of one sql query into another,"SELECT NameCode, Name,
       (SELECT SUM(MO + TU)    
          FROM tblFieldDays Y
         WHERE Y.NameCode IN (X.NameCode))
  FROM tblNames X;
"
17210,JDBC proxy to simulate a SQL view?,"SELECT *
  FROM (SELECT *
          FROM ...) x
"
29389,mysql get last N records with MAX(date),"SELECT prh.*
FROM product_rate_history prh INNER JOIN
     (SELECT max(created_on) as maxco
      FROM product_rate_history
      WHERE prh.product_id = 16
      GROUP BY Date(created_on)
     ) prh2
     ON prh.created_on = prh2.maxco
WHERE prh.product_id = 16
ORDER BY prh.created_on DESC;
"
2297,How to create SQL trigger for insert for three tables,"DECLARE @i INT, @d INT;
SELECT @i = COUNT(*) FROM inserted;
SELECT @d = COUNT(*) FROM deleted;
IF @i + @d > 0
BEGIN
    IF @i > 0 AND @d = 0
        -- insert
    IF @i > 0 AND @d > 0
        -- update
    IF @i = 0 AND @d > 0
        -- delete
END
"
780,summarize initial column mysql,"select malecount+femalecount as sumcount from  (select
count(if(gender=""male"",1,null)) as malecount,  
 count(if(gender=""female"",1,null)) as femalecount   from biodata) as
 query
"
31171,How to create a table with only read and write permission for all the user in Oracle?,"GRANT SELECT, INSERT, UPDATE, DELETE ON mytable TO PUBLIC
"
27214,Order by day_of_week in MySQL,"ORDER BY FIELD(<fieldname>, 'MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY', 'SATURDAY', 'SUNDAY');
"
31604,Is it possible to comment out blocks of code that contain comments?,"begin
 something1;
 $if false $then
  something2;
 $endif;
endl;
"
14854,Prevent delete on single row with trigger,"CREATE TRIGGER deleteWorkspace ON Workspaces
FOR DELETE AS

IF(SELECT COUNT(*) FROM deleted) = 1
BEGIN
RAISERROR('Single Delete Not Allowed!', 16, 1)
ROLLBACK
END
ELSE
RAISERROR('Multiple Rows Being Deleted, Allowed!', 16, 1)
BEGIN
END

END
GO
"
8756,What Oracle ADO.NET connector to install?,"install_odpm.bat c:\oracle both true
"
5977,mysql_db_query for mssql in php,"<?php 
function mssql_insert_id() { 
    $id = 0; 
    $res = mssql_query(""SELECT @@identity AS id""); 
    if ($row = mysql_fetch_array($res, MYSQL_ASSOC)) { 
        $id = $row[""id""]; 
    } 
    return $id; 
} 
?>
"
7795,convert datetime (mm/dd/YYYY) to decimal(YYYYmmDD),"select 10000 * year(datetime) + 100 * month(datetime) + day(datetime)
"
19440,Selecting only the highest value for a specific record with other unique columns?,"select fc.* 
from fruits_cities fc
where fc.cityId = (select max(CityId)
                   from fruits_cities fc2
                   where fc2.fruit_id = fc.fruit_id
                  );
"
37075,oracle 10g IN clause query,"select saalry from emp
where INSTR( ',' || :id || ','
           , ',' || TRIM(TO_CHAR(emp_id)) || ','
           ) > 0;
"
30845,Problem with UTF-8 Encoding on SQLCE,"<meta http-equiv=""Content-Type"" content=""text/html; charset=UTF-8"" />
"
13613,"SQL - Need to run stored proc with ~100 different params, what's the best way to do this?","CREATE TYPE LIST_OF_ID TABLE (ID INT);
go
CREATE PROCEDURE PROC1(@ids LIST_OF_ID READONLY) 
....
"
29996,SQL Server 2008 - separating Address field,"select 
  left(PostalAddress, charindex('^', PostalAddress) - 1) as street_address,
  left(second_part, len(second_part) - charindex(' ', reverse(second_part))) as suburb,
  right(second_part, charindex(' ', reverse(second_part))) as state,
  reverse(substring(reverse(PostalAddress), 2, 4)) as postal_code
from (
  select
    PostalAddress,
    rtrim(reverse(substring(reverse(PostalAddress), 6, len(PostalAddress) - charindex('^', PostalAddress) - 5))) as second_part
  from Addresses
) as t1
"
27099,Remove non-unique ids rows,"DELETE FROM myTable AS t1 
WHERE EXISTS (
    SELECT 1 FROM myTable AS t2 
    WHERE t1.ID=t2.ID AND t1.DateCreated<t2.DateCreated)
"
12259,How to change order by condition in cursor based on some value,"declare cursor file is
  select type,name,location, from filemstr order by decode(ord,'d',name,type)
  begin
    for i in file
    loop
  end;
"
4670,SQL select is not picking other column's value in the same row as the aggregated row,"select 
((close-open)/open) as daychange,
 date 
from prices
order by daychange desc
limit 1
;
"
37101,How to create a new column in a select query,"select A, B, 'c' as C
from MyTable
"
8981,Update Entity Data Model After Tree Drag and Drop,"public void TreeView_Droped (object sender, RoutedEventArgs e)
{
    //Do some work
    UpdateMyDataSource(sender, e, [another_fields_you_need]);
}
"
17713,"copy table from one database to another, maintaining table's structure and renaming it too","CREATE TABLE db_target.cloned_table 
SELECT * 
FROM db_source.source_table;
"
1376,How to query tree table structure which has no subnodes,"select name, id, parent_id from (
  select name, id, parent_id, connect_by_isleaf as isleaf
  from folder
  start with parent_id = parent_id -- from comments
  connect by nocycle parent_id = prior id
)
where isleaf = 1;
"
12557,"SQL, Get a list of all the custom data types","SELECT      n.nspname as schema, t.typname as type 
FROM        pg_type t 
LEFT JOIN   pg_catalog.pg_namespace n ON n.oid = t.typnamespace 
WHERE       (t.typrelid = 0 OR (SELECT c.relkind = 'c' FROM pg_catalog.pg_class c WHERE c.oid = t.typrelid)) 
AND     NOT EXISTS(SELECT 1 FROM pg_catalog.pg_type el WHERE el.oid = t.typelem AND el.typarray = t.oid)
AND     n.nspname NOT IN ('pg_catalog', 'information_schema')
"
15818,Oracle Full Hint,"select /*+ full(test) */ num from test;
"
6077,"MySQLdump is executing, but not actually working","mysql -u root -pxxxxxx test < test2backup.sql
"
20050,PL/pgSQL checking if a row exists - SELECT INTO boolean,"IF EXISTS (SELECT 1 FROM people WHERE person_id = my_person_id) THEN
  -- do something
END IF;
"
35588,SQL inner joins with table alias' - Can I optimize this query?,"t3.StatusName + ISNULL(' ' + t2.ErrorMessage, '') as SomeStatus
"
16359,how to get a string from a list of string using SQL query,"SELECT distinct Split.a.value('.', 'VARCHAR(100)') REF
           FROM   (select ID,Cast ('<M>'
                                + replace(Replace(REF, ',', '</M><M>'),'&','&amp;')
                                + '</M>' AS XML) AS Data from #Table) AS A
                  CROSS APPLY Data.nodes ('/M') AS Split(a) 
"
24036,How would you represent a hashtable collection in a database schema?,"table Space {
    SpaceCoordinate,
    Quadrant Foreign Key SpaceQuadrant(ID),
    SpaceObject -- whatever the object is (by ID)
    Primary Key(SpaceCoordinate, Quadrant)
}
"
16912,How to categories different strings as a group using SQL?,"SELECT InvoiceID, MAX(Status)
FROM Invoice
GROUP BY InvoiceID
"
35203,Create trigger on update and insert into customized table,"CREATE TRIGGER z_LOGIN2 AFTER UPDATE OF lastsignondttm ON SYSADM.PSOPRDEFN
FOR EACH ROW

BEGIN
  IF (SELECT COUNT(1)
      FROM SYSADM.psroleuser b
      WHERE b.roleuser = NEW.oprid AND (b.rolename = 'FAS Change Admin'
            OR b.rolename = 'PeopleSoft Administrator')) > 0 THEN

  INSERT INTO z_LOGIN VALUES (NEW.oprid,NEW.oprdefndesc,NEW.lastlogondttm);
 END IF;

END;
"
21668,about sql select not working,"SELECT id_towaru, nazwa_tow, 'it''s work' AS result
FROM TOWAR
WHERE ID_KATEGORIA = '00001'
"
34501,Find products that are sold at a price less than mine,"select distinct p1.* 
from prdtfrn p1
join prdtfrn p2 on p1.pid = p2.pid and p2.fid != 1 and p2.price < p1.price
where p1.fid = 1; // fid=1 is known to be 'Audrey'
"
13552,get top 10 posts and 10 comments for each post sql,"WITH a AS ( 
    SELECT TOP 10
        Score ,
        Post.ID AS PostID
    FROM Post
    ORDER BY Score DESC
)
SELECT  *
FROM    a
OUTER APPLY ( 
    SELECT TOP 10
        pc.PostID ,
        pc.ID AS CommentID
    FROM      PostComment pc
    WHERE     pc.PostID = a.PostID
    --ORDER BY SomeColumn
) o
"
7983,"Procedure or function  expects parameter '', which was not supplied","DECLARE @ParameterValue varchar(50) 

EXEC Getparameterdefaultvalues @ParameterName = 1, @ParameterValue = @ParameterValue OUTPUT

PRINT 'Result is: ' + @ParameterValue
"
10188,grouping records in one temp table,"INSERT theTempTable (Code)
SELECT t.Code
FROM   theTable t
       LEFT OUTER JOIN theTable subT ON (t.Code = subT.Code AND subT.status <> 'A')
WHERE  subT.Code IS NULL
GROUP BY t.Code
"
29992,Get total count using group by having count > 1,"select * from temp_new_template_pattern 
where vin_pattern in (
select vin_pattern
from temp_new_template_pattern 
group by vin_pattern 
having count(*) > 1)
"
10421,SQL Query to Subtract and Sum in same time,"select sum(value1-value2) as Result 
from tbl
"
23259,"Using CASE statements as a precursor for COUNT function in single (large) SQL query, syntax","SUM(CASE WHEN BIAdmin.Item.ItemStatus = 'inactive' THEN 0 ELSE 1 END) As ActiveItemCount
"
28601,To grab codeigniter database name,"$this->db->database;
"
2253,Oracle - select all where one of the columns satisfies predicate," select * from table where column is not null
"
38171,Get records with specific amount of years,"where (join_date > dateadd(year, -6, getdate()) and join_date <= dateadd(year, -5, getdate())
      ) or
      (join_date > dateadd(year, -11, getdate()) and join_date <= dateadd(year, -10, getdate())
      ) or
      (join_date > dateadd(year, -15, getdate()) and join_date <= dateadd(year, -16, getdate())
      )
"
12310,how can i retrieve same column with two different alias?,"select group_concat(case when rank > 0 then answer end) as pos_answers,
       group_concat(case when rank < 0 then answer end) as neg_answers
from answers
"
38833,SQL List the representative that handles the most customers,"SELECT TOP 1 WITH TIES rep_lname, COUNT(cust_num)
FROM customer inner join salesrep 
  ON customer.REP_NUM = SALESREP.REP_NUM 
GROUP BY rep_lname
ORDER BY count(cust_num) DESC
"
2721,Get the right result from the table,"SELECT 
    route FROM arrivaltimes 
INNER JOIN 
    stops ON arrivaltimes.stop_id = stops.stop_id 
INNER JOIN 
    stops ON arrivaltimes.location = stops.location 
WHERE 
    time_format(arrivaltime,'%H:%i') = time_format(curtime() ,'%H:%i')
ORDER BY 
    arrivaltimes.stop_id DESC LIMIT 1;
"
20472,change all dates but not the time in mysql using sql,"UPDATE tableName
SET columnName = columnName + INTERVAL 50 YEAR
"
1917,How to get distinct results in one row from two column of same table?,"SELECT GROUP_CONCAT((case when senderid = 1 then recid else senderid end) SEPARATOR ', '
                   ) AS trans 
FROM test 
WHERE senderid = 1 or recid = 1 ;
"
25222,What SQL coding standard do you follow?,"SELECT
    T1.col1,
    T1.col2,
    T2.col3
FROM
    table1 T1
    INNER JOIN ON Table2 T2 ON T1.ID = T2.ID
WHERE
    T1.col1 = 'xxx'
    AND T2.Col3 = 'yyy'
"
39974,"SQL insert only table, how to select only newest entries","SELECT kvtable.* 
FROM
  kvtable
  JOIN (
    SELECT
      MAX(id) AS id,
      user_id,
      property
    FROM kvtable
    /* optionally limit by user_id */
    WHERE user_id = <someuser>
    GROUP BY user_id, property
  ) maxids ON kvtable.id = maxids.id
"
32348,Count number of vowels in a word and generate a report summary using SQL in Oracle,"SELECT vowel_list.chr,
  COUNT(my_string.chr)
FROM
  (SELECT UPPER(SUBSTR('STACKOVERFLOW',level,1)) AS chr
  FROM dual
    CONNECT BY level <=LENGTH('STACKOVERFLOW')
  ) my_string,
  (SELECT UPPER(SUBSTR('AEIOU',level,1)) AS chr
  FROM dual
    CONNECT BY level <=LENGTH('AEIOU')
  ) vowel_list
WHERE vowel_list.chr = my_string.chr(+)
GROUP BY vowel_list.chr
ORDER BY 1;
"
20913,SQL Pairing rows with cross value,"SELECT t1.ZZ, t1.XX, t1.PZZ, t1.PXX
FROM mytable AS t1
INNER JOIN mytable AS t2 
ON t1.ZZ = t2.XX AND t1.XX = t2.ZZ AND t1.PZZ = t2.PXX AND t1.PXX = t2.PZZ
"
18012,Adding values in a table in SQL 2008,"  SELECT i.user, 
         COUNT(i.priority) AS total,
         SUM(CASE WHEN i.priority = 1 THEN 1 ELSE 0 END) AS 1,
         SUM(CASE WHEN i.priority = 2 THEN 1 ELSE 0 END) AS 2,
         SUM(CASE WHEN i.priority = 3 THEN 1 ELSE 0 END) AS 3,
         SUM(CASE WHEN i.priority = 4 THEN 1 ELSE 0 END) AS 4,
         SUM(CASE WHEN i.priority = 5 THEN 1 ELSE 0 END) AS 5
    FROM ISSUES i
GROUP BY i.user
"
32888,Having problem using left join with group_concat,"    group by j2.pkey) blockers

left join jiraissue j3 on blockers.id = j3.id
"
4758,View permissions on table type via T-SQL,"SELECT [type] = QUOTENAME(s.name) + '.' + QUOTENAME(tp.name), 
  dp.[permission_name], 
  [principal] = p.name
FROM sys.types AS tp
INNER JOIN sys.schemas AS s
ON tp.[schema_id] = s.[schema_id]
INNER JOIN sys.database_permissions AS dp
ON tp.user_type_id = dp.major_id
AND dp.class_desc = N'TYPE'
INNER JOIN sys.database_principals AS p
ON p.principal_id = dp.grantee_principal_id
WHERE tp.is_user_defined = 1;
"
35437,know the table names plus doing a count,"proc sql;
select libname, memname, nobs
from sashelp.vtable 
where upcase(libname)='WORK' and upcase(memname) in (Select upcase(table_name) from all_tables);
quit;
"
25556,Determine CaseSensitive in WHERE clause,"SELECT * FROM myTable
WHERE myColumn = 'New'
AND BINARY(myColumn) = BINARY('New');
"
23626,How to filter only the date from a string stored in a varchar,"SELECT * FROM whatever WHERE some_Date LIKE '02-Jul-12%';
"
3595,Formatting text boxes for postal codes & zip codes,"Private Sub txtPostCode_KeyDown(KeyCode As Integer, Shift As Integer)
  If KeyCode = vbKeySpace Then KeyCode = 0
End Sub

Private Sub txtPostCode_KeyPress(KeyAscii As Integer)
  Select Case KeyAscii
    Case Asc(""a"") To Asc(""z"")
      KeyAscii = KeyAscii + Asc(""A"") - Asc(""a"")
  End Select
End Sub
"
6993,Selecting rows distinctively,"SELECT   items, MAX(weight)
FROM     mytable
GROUP BY items
ORDER BY MAX(weight) DESC
"
915,Inserting the duration between two times..in mysql,"update meeting_hall_booking_master 
set booking_duration = TIMEDIFF(booking_to_time,booking_from_time);
"
37571,if minute is less than 60 then remove hour part from result,"SELECT @Average = 
   case
   when convert(int, @hour) <> 0 then convert(varchar(9), convert(int, @hour)) + ':'
   else ''
   end +   
   right('00' + convert(decimal(10,0), convert(decimal(18,2), @Mns)), 2) + ':' +
   right('00' + CONVERT(decimal(10,0), convert(varchar(10), @second)), 6)
"
29693,MYSQL Sub Query with two columns,"SELECT u.*
FROM
    userprofile u
    JOIN connect c ON (u.user_id = c.user_id OR u.user_id = c.connect_to_id)
WHERE
    (c.user_id = '1' OR c.connect_to_id = '1') AND
    c.is_connected = '1'
"
14947,How do I do an IF in Microsoft SQL SELECT query?,"select * from table where name like 'X%'

if @@ROWCOUNT = 0
   select * from table where name like 'Y%'
"
24591,MySql Query question last time record found in database,"  select device, count(*) as cnt, max(time) <-- same as latest time
    from database.table 
group by device
  having cnt>1
order by device;
"
18987,Preparing SQL query,"$mysqli = new mysqli(""localhost"", ""my_user"", ""my_password"", ""db"");

if(isset($_GET['id']))
{
    $id = $_GET['id'];
    $q = ""SELECT some_field FROM `objekt_t` WHERE `id`= ?"";

    if ($stmt = $mysqli->prepare($q)) {    
        $stmt->bind_param(""i"", $id);
        $stmt->execute();
        $stmt->bind_result($result);
        $stmt->fetch();
    }
}
"
8236,MySQL - how do I write this Query,"SELECT a.Actor_name, d.Director_name
FROM (
  (SELECT DISTINCT Actor_name from movie) a
  CROSS JOIN
  (SELECT DISTINCT Director_name from movie) d
) WHERE NOT EXISTS (
  SELECT * FROM movie m
  WHERE m.Actor_name=a.Actor_name
    AND m.Director_name=d.Director_name
)
"
30329,column decimal point value,"SELECT CONVERT(DECIMAL(10,2),SUM(PAPostedTotalCostN)) AS Total_Cost 
FROM PA01201
WHERE PA01201.PAcontid = '00900'
"
33044,How can I select only the first record with each foreign key in SQL Server?,";with cd as(
select *, rn = dense_rank(partition by bioid order by addressline, city)
from ContactDetails cd
)
select c.bioid, c.firstname, c.lastname, cd1.AddressLine, cd1.City, cd2.AddressLine, cd2.City, cd3.AddressLine, cd3.City
from Contact c 
left join cd cd1 on c.bioid = cd1.bioid and cd1.rn = 1
left join cd cd2 on c.bioid = cd2.bioid and cd2.rn = 2
left join cd cd3 on c.bioid = cd3.bioid and cd3.rn = 3
"
4326,DB2 Date format,"SELECT VARCHAR_FORMAT(CURRENT TIMESTAMP, 'YYYYMMDD')
FROM SYSIBM.SYSDUMMY1
"
36371,How can I finding the index of a record with SQL or Stored Procedure?,";WITH Q as (
    SELECT id, text, date, ROW_NUMBER() OVER (ORDER BY date) as RowNumber 
    FROM t
)
SELECT * FROM Q WHERE RowNumber = 3
"
1352,"String Pattern Matching for Limited, Ltd, Incorporated, Inc, Etc","Ltd   Limited 
Ltd   Ltd.
St    Street
St    Str.
"
18775,Pivot Query SQL Duplicating rows,"SELECT *
 FROM (
  SELECT regno,eventb,timec,rfid from  @tmpTable2
 ) AS SourceTable
 PIVOT
(
max(timec)
FOR eventb
IN (
[Veh Reg Time],[Fitness ok time],[RFID Issue time],[MG-IN],[WB IN],
[MG-OUT],      [WB OUT]
)
) AS PivotTableAlias
"
5841,Case sensitive searching,"SELECT * FROM a WHERE name glob 'A*'
"
1561,SQL Table selection,"@TableId int
As

Declare @nameoftable varchar(50)
select @nameoftable = Nameoftable from tablelist where id = @tableid

-- returning on selected table

declare @sql nvarchar(1000)
set @sql = 'Select somestuff from ' + Quotename(@nameoftable)
exec(@sql)
"
7735,Delete record from database where it doesnot match with physical file entries,"declare @file_path  nvarchar(500)
declare @file_exists    int

set @file_path = 'C:\temp.txt'

**exec master.dbo.xp_fileexist
    @file_path,
    @file_exists output**

select @file_exists
Print   'File '+isnull(@file_path,'NULL')+' '+
    case when @file_exists = 1
    then 'exists'
    else 'does not exist' end ;
"
8212,Select data with condition multiple like,"SELECT product_id  
FROM product 
WHERE product_part LIKE '%bolt%' OR product_part LIKE '%gear%'
GROUP BY product_id 
HAVING COUNT(CASE WHEN product_part LIKE '%bolt%' THEN 1 END) > 0 AND 
       COUNT(CASE WHEN product_part LIKE '%gear%' THEN 1 END) > 0
"
21005,sql server break columns into row with join,"select distinct Package_id, package_title, durationindays,videourl,package_image_1 + ',' + package_image_2 + ',' + package_image_3 + ',' + package_image_4 + ',' + package_image_5 As Pacakage,  Rating, AdultPrice
from packages
inner join
rates_and_dates on rates_and_dates.package = packages.package_id
where package_id=1 and adultprice='4500'
"
32925,Using the sum function on an indirectly joined table. .,"SELECT SUM(distance)
FROM tblC
JOIN tblB ON tblC.workoutId = tblB.workoutId
         AND tblB.userOd = 1
"
28473,Preferred way to create composite unique index with NULL values,"ALTER TABLE main_itemmaster ADD COLUMN uniquer BIGINT NOT NULL;
DELIMITER $$
CREATE TRIGGER add_uniquer BEFORE INSERT ON main_itemmaster
FOR EACH ROW
  BEGIN
    SET NEW.uniquer = (SELECT UUID_SHORT());
  END $$
DELIMITER ;
ALTER TABLE main_itemmaster ADD UNIQUE KEY (tv_series_id, tv_season_number, tv_episode_number, name, uniquer);
"
1811,SQL Order By Except When You Don't,"order by (case when currentValue <= 6 then 1 else 0 end) desc,
         (case when currentValue <= 6 then column end) desc
"
10672,T-Sql group/sum query question,"SELECT
      t.AssessorParcelNumber,
      t.[r_number],
      t.Closed,
      SUM([assoc_balance]),
      SUM([rr_balance]),
      SUM([_balance]),
      SUM([balance])
    FROM (/* Insert your original query here */) t
    GROUP BY t.AssessorParcelNumber, t.r_number, t.Closed
"
7752,Simplify nested subselects containing aggregates,"select cr.invoice_number, cr.salesperson_id, cr.commission_amt  
from CommissionReport CR
where cr.invoice_number in (
    select top 1 invoice_number
    from CommissionReport CR2
    group by CR2.invoice_number
    order by count(*) desc
)
"
6693,Oracle 10g Range Partition Query,"create table LAB6_ZL
(
  ID        number not null
 ,TITLE     varchar2(40)
 ,PUBID     char(3)
 ,PUBDATE   date
 ,constraint LAB6_PK primary key(ID)
)
partition by range (PUBDATE)
  (partition TWO
     values less than (date '2000-01-01')
  ,partition ONE
     values less than (date '2010-01-01')
  ,partition THREE
     values less than (MAXVALUE));
"
21660,MS Access Distinct Records in Recordset,"SELECT c.* 
FROM   component c 
WHERE  c.id IN (SELECT c.component_id 
                FROM   widget w 
                       INNER JOIN widget_component c 
                         ON w.id = c.widget_id 
                WHERE  w.mfg_id = 123) 
"
35516,rows processed statistics information in sql server 2005,"SELECT 
    *
FROM 
    sys.dm_exec_query_stats  QS
    CROSS APPLY 
    sys.dm_exec_sql_text(sql_handle) ST
"
5034,Subtotal for a partition by column value," SELECT 
      K1,
      K2,
      V3, 
      count(V3) over (partition by K1, K2) as Total,
      count(V3) over (partition by K1, K2, V3) as Subtotal
FROM DataTable
"
22822,inserting rows by using insert and values and subqueries,"BEGIN
 declare @id1 int
 select @id1=id from inserted

insert into Dossiers_CheckList
(DOS_id ,CheckListParm_id)

SELECT @id1,CheckListParms.id
 from CheckListParms
 where CheckListParms.DOC_IS_OBLIG=1



END 
"
12306,Have one part of a query update based on another,"create table computed
(
    column1 int, 
    descr as 'aliasFor'+CAST(column1 as varchar))
)
"
15547,"duplicate rows in table, but need to change data in one column","INSERT INTO `step_year` (`id`, `step_id`, `year`)
SELECT `id`, `step_id`, 1112 AS `year` 
FROM `step_year` where `year` = 1011
"
21362,Denormalizing and querying a giant Couchbase data set,"function(doc) {
  if (doc.type == 'user')
    emit(doc.email_host, doc);
}
"
318,"SQL. How to select something ""lower than"" ? explained better in topic","SELECT * FROM -//- WHERE weight < 10
"
13526,How to list indexes on materialized views (Oracle),"SELECT owner, object_name, object_type
  FROM all_objects
 WHERE owner = 'SOME_OWNER' 
   AND object_name = 'SOME_TABLE' 
"
28008,JOIN table when selecting a max value of columns,"SELECT t.*
FROM
(
   SELECT
     *,
     ROW_NUMBER() OVER (PARTITION BY CommentID ORDER BY CreateDateTime desc) as rn
   FROM
     tbCommentBreadCrumb
     WHERE CommentStatusTypeID = 4
            AND    CreateDateTime <= {ts '2014-02-09 09:44:57'}
) t
JOIN tbComment c ON t.CommentID = c.CommentID
WHERE
   t.rn = 1
AND c.CommentIsLocked = 1
ORDER BY CommentStatusID DESC
"
12972,"SQL syntax issue using ""IN"" keyword with dynamic data","IN (SELECT myField from #myTable)
"
16767,How to avoid repeating expressions in SELECT?,"SELECT   func_call(t1.id1,t2.id2,SUM(t3.id3))
FROM     table1 t1
JOIN     ----
WHERE    ---
GROUP BY t2.id2
ORDER BY 1 DESC -- Here
LIMIT    10
"
36130,Simple mysql query displaying results in specific order,"SELECT * FROM conversation c, messages m 
WHERE (c.user_id1='$userid' OR c.user_id2='$userid')
AND c.last_message_id=m.message_id
ORDER BY created_time DESC
"
8600,Set up Oracle Text to index values of multiple columns in Oracle tables,"begin
ctx_ddl.create_preference('my_multi', 'MULTI_COLUMN_DATASTORE');
ctx_ddl.set_attribute('my_multi', 'columns', 'column1, column2, column3');
end;


create index myindex on mytable(docs) 
  indextype is ctxsys.context 
  parameters ('DATASTORE my_multi');
"
5906,if/case statement in where clause,"where BUSINESS_UNIT=1227 and b.year_audit=2016 and taggable='YES'
and (
      (
        (select count(*) from #tempdept) > 0 and fix_asset.department in (select item from #tempdept) 
      )
      or
      (select count(*) from #tempdept) = 0
    )
"
10599,M2M relationship or 2 FKs?,"groups = models.ManyToManyField(Group, through='GroupMember')
"
11840,List oracle stored procedures name with original case,"CREATE PROCEDURE ""myCamelCaseProc""
...
"
1219,sql statement help,"SELECT title, price
FROM Book
WHERE copies < 16
"
26001,Mysql Update Records,"UPDATE SET table SET user_name= CAP_FIRST(CONCAT(SUBSTRING_INDEX(user_name, ' ',-1), ' ', SUBSTRING_INDEX(user_name, ' ',1)))
"
22984,PostgreSQL CASE statement,"... WHEN expression [, expression [ ... ]] THEN
"
30658,Export table description in PHPMyAdmin/MySQL,"SELECT * FROM information_schema.tables INTO OUTFILE dump_tables.csv
"
17384,Period representation in SQL Server including not finished ones,"DECLARE @PeriodStartDate DATETIME
DECLARE @PeriodEndDate DATETIME

SET @PeriodStartDate = CONVERT(DateTime, '20140101')
SET @PeriodEndDate = NULL

SELECT * FROM Table WHERE SaveDate BETWEEN @PeriodStartDate AND ISNULL(@PeriodEndDate, CURRENT_TIMESTAMP)
"
31347,SQL Bank DB: return only people with a given property,"  select c.customerID, c.name, a.UAN, a.balance, a.overdraft
  From customer c join current_acc a
  on c.customerID = a.customerID and a ='current account'
"
25901,i want to get the max(HA) and max(Total) of grouped by 'subject' for all students for the given table,"  select sem,section,subject,usn, Name, max(HA), MAX(total)
    from table
    group by sem, section, subject, usn, naam
"
31338,Why does the content of one scenario in a case decide whether the other's content should be right trimmed?,"SET ANSI_PADDING OFF;

--trims trailing spaces
SELECT a = 
    CASE WHEN 1=1 THEN
        'a '
    ELSE
        'b  '
    END + 'c';

--does not trim trailing spaces
SET ANSI_PADDING ON;

SELECT a = 
    CASE WHEN 1=1 THEN
        'a '
    ELSE
        'b  '
    END + 'c';
"
34798,MySQL Query Order By Most Occurences,"SELECT M.id, M.game_type, M.votes 
FROM MyTable AS M INNER JOIN
    (SELECT game_type, COUNT(game_Type) AS TypeCount
     FROM MyTable
     GROUP BY game_type
     ORDER BY COUNT(game_Type) DESC) AS U
  ON M.game_type=U.game_type
ORDER BY U.TypeCount DESC, M.game_type, M.votes DESC
"
4763,TSQL using an IF or CASE to generate an IN list,"WHERE
...
AND
(
        @ClientID = 0 AND [ClientID] IN <sub select to get appropriate ids>
    OR
        [ClientID] = @ClientID
)
"
24726,"HQL ""is null"" And ""!= null"" on an Oracle column","is not null
"
24666,"What is the best design for a database table that can be owned by two different resources, and therefore needs two different foreign keys?","CHECK (
    (group_id IS NOT NULL AND user_id IS NULL)
    OR (group_id IS NULL AND user_id IS NOT NULL)
)
"
17761,Add date of first day of week to date dimension,"UPDATE  C
SET     WeekStartDate = week_start
FROM
(
    select  *, week_start = min(CalendarDate) 
                            over (partition by year(CalendarDate), WeekNumber)
    from    Calendar
) AS C
"
18217,SQL - condition for each record in bundle,"select  *
from    bundles b
where   not exists
        (
        select  *
        from    courses c
        where   c.id = b.course
                and course_date < getdate() -- Note inverse condition
                and ...
        )
"
33092,Is it possible to select a value in the table on another row using that id?,"select t1.id, t1.name, t2.name as parent_name
from mytable t1
left join mytable t2 on t2.id = t1.id_relation
where t1.id = 2; -- where clause is optional. leave off to get all rows
"
29575,Query to Not selecting columns if multiple,";with cte_proj as
(
select Project_Num from YourTable    
group by Project_Num
having count(Project_Num) = 1)
select Project_Num from cte_proj c
inner join YourTable t on c.Project_Num = t.Project_Num
where t.Type = 'O'
"
2152,Loop through rows and count based on table name,"SELECT
    OrderStatus AS Status,
    COUNT(OrderStatus) AS Total,
    ROUND((COUNT(OrderStatus ) * 100)/(select COUNT(*) from myTable),2) AS [Percent]
FROM
    myTable
Group by OrderStatus
"
28646,SQL print a space between concat statements,"(Cast(NBR as varchar(20)) + ' ' + Cast(ACCT_NBR as varchar(20))) as acct,
"
14869,Wrestling with SQL,"SELECT x.friend,
       MAX(x.created)
  FROM (SELECT t.recipient_id 'friend',
               t.created
          FROM MESSAGE t
         WHERE t.sender_id = @id 
        UNION
        SELECT r.sender_id 'friend',
               r.created
          FROM MESSAGE r
         WHERE r.recipient_id = @id) x
GROUP BY x.friend
"
27266,In Oracle how to search with sub conditions on same column,"select t1.car, t1.feature
from yourtable t1
inner join
(  -- inner select returns the cars with the Feature1 and Feature2 or Feature3
  select car, feature
  from yourtable 
  where feature = 'Feature1'
    and exists (select car
                from yourtable 
                where feature in ('Feature2', 'Feature3'))
) t2
  on t1.car = t2.car
where t1.feature in ('Feature1', 'Feature2', 'Feature3') -- this excludes any other features
"
712,Designing database,"Select rec.rec_id, 
       Count(itn.item_id) as [NumMatches]
From recipe as rec
Join items_needed as itn on itn.rec_id = rec.rec_id
Where itn.item_id in (comma-delimited-list-of-itemIDs)
Group By rec.rec_ID
Having Count(itn.item_id) > 0
Order By Count(itn.item_id) desc
"
38295,SQL Determine if parameter has a value not working,"CREATE PROCEDURE [dbo].[spAttachment_View]
    @knowid int,
    @actionid int   
AS
    if(@actionid is null)
    begin
        SELECT 'Im null'                       
    end
    else
    begin
       SELECT 'Im not null'
    end

EXEC [dbo].[spAttachment_View] @knowid =1 , @actionid = null
"
33839,MS SQL Update Numbers (ID) for each Type,"with cte as (
    select AgendaType, 
           Genre, 
           Priority,
           row_number() over (partition by AgendaType, Genre order by AgendaType) rn
    from yourtable
) 
update cte
set priority = rn
"
29733,SQL: Replacing rows in a table using the rows in another table,"UPDATE TableA
SET Enabled = false
WHERE rowid IN
(SELECT rowid FROM TableB)
"
807,inner join same table,"select user.user_fname
      ,user.user_lname
      ,parent.user_fname
      ,parent.user_lname
  from users as user
  join users as parent on parent.user_id = user.user_parent_id
 where user.user_id = $_GET[id]
"
1600,MySQL select * from last 5 days from a datetime field,"Select 
* 
from 
'myTable' 
where 'datetime' >=
      (
           select  
          `datetime` 
          from myTable 
          group by DATE(`datetime`) 
          order by `datetime` desc 4,1
        )
"
17691,SQL query to linked index server does not work w wildcards,"SELECT DISTINCT DOC.ID_Kandidat, IDXS.* FROM
OPENQUERY([GRIP-SERVER],'select FileName, path, size, vpath from ""GRIP-SERVER"".""Web2""..SCOPE() where
contains(''""reiseportal*""'')') AS IDXS INNER JOIN
tblK_Dokumente AS DOC
ON DOC.Link = IDXS.[FileName]
ORDER BY ID_Kandidat
"
20378,MySQL Select Data from 2 Tables With Unique ID in one Query,"select stream_name as name from streams where id=<id>
Union
select movie_name as name from movies where id=<id>
"
34198,Why does updating only some rows delete the rest of the rows in the column?,"UPDATE t100 SET text = (SELECT text FROM t50 WHERE t50.id = t100.id)
WHERE t100.id IN (SELECT id FROM t50)
"
14012,Mutating table issue when TRIGGER needs to select and insert rows in same table,"create trigger table1_io
instead of insert or update or delete on table1
for each row
begin
  if inserting or updating then 
      update table1_base
      set active = 'N'
      where id = :new.id
      and active = 'y';

      insert into table1_base...;
  elsif deleting then
      update table1_base
      set active = 'N'
      where id = :old.id
      and active = 'y';
  end if;
end;
"
542,Solution to a complicated SQL query,"select user_name, new_status, status_change_date as StartTime,
       lead(status_change_date) over (partition by user_name order by status_change_date) as EndTime
from app_users
"
13183,Unable to add tables to Crystal Reports,"For Each oConnection As IConnectionInfo In oReport.DataSourceConnections
    If fUseIntegratedSecurity Then
        oConnection.SetConnection(sServerName, sDatabaseName, True)
    Else
        oConnection.IntegratedSecurity = False
        oConnection.SetConnection(sServerName, sDatabaseName, sUserLogon, sUserPassword)
    End If
Next
"
4810,"SQLite, sliding to get results based on value and date","SELECT *
FROM Data
WHERE company IN (SELECT company
                  FROM Data
                  GROUP BY company
                  HAVING max(value) <= 20)
"
1977,Get row number using where clause,"select * from
(SELECT @rn:=@rn+1 AS rank, user, score
  FROM scores,
  (SELECT @rn:=0) t2
ORDER BY score DESC) t
where user=2
"
32912,Declaring a variable with a value from select query,"SELECT t.BusinessEntityID, t.BirthDate, t.Age
FROM
(SELECT emp.BusinessEntityID, emp.BirthDate, CAST(datediff(DAY, emp.Birthdate, GETDATE()) / (365.23076923074) as int) as 'Age'
FROM HumanResources.Employee AS emp
WHERE emp.OrganizationLevel > = 3) t
WHERE t.Age >= 30 and t.Age <=40
"
38607,MYSQL - SELECT statement that can name the results based on the condition,"SELECT  
  UNIX_TIMESTAMP(dayStart) as yourDate
, CASE
     WHEN dayStart LIKE '2012-06-11%' THEN 'today'
     WHEN dayStart LIKE '2012-06-10%' THEN 'yest'
     WHEN dayStart LIKE '2012-06-12%' THEN 'tomor'
  END as dayType
FROM dayBook
WHERE userID = 1
"
26996,Join two tables without subquery,"SELECT A.idContactOwner, B.whatEverFields, count(A.idContactOwner) AS counter
FROM contacts A, customers B
WHERE A.idContactOwner=B.id 
GROUP BY A.idContactOwner 
HAVING counter>5;
"
7665,Randomly SELECT two disctinct rows on a table,"SELECT DISTINCT postid 
FROM tablename
ORDER BY RAND()
LIMIT 2
"
28415,Create a table of two types in PostgreSQL,"CREATE TABLE info (
  prod_id integer
 ,category integer
);

CREATE TABLE movie (
   title text
  ,actor text
  ,price float
);

CREATE  TABLE movie_info (
   PRIMARY KEY(prod_id)             -- now we can use the base column!
)
INHERITS (info, movie);

INSERT INTO movie_info (prod_id, category, title, actor, price)
VALUES (1, 2, 'who donnit?', 'James Dean', '15.90');

SELECT * FROM movie_info;
"
24603,Oracle Date Formating Null date as 00/00/0000,"select nvl(to_char(null, 'DD-MM-YYYY'), '00-00-0000') from dual"
20473,update statement using nested query,"UPDATE mytable SET lastLogDate = t.maxDateForUser  
FROM  
(  
    SELECT userid, MAX(logDate) as maxDateForUser  
    FROM mytable  
    GROUP BY userId  
) t  
WHERE mytable.userid = t.userid
"
34410,"How to find records from table A, which are not present in table B?","SELECT a.*
FROM      table_a a
LEFT JOIN table_b b ON a.request_id = b.request_id
                   AND a.order_id   = b.order_id
WHERE b.request_id IS NULL
"
15020,How can I optimize this query that has an inner select query for date?,"select sum(value) 
  from TAB 
 where col1=12 and col2=18
 group by TimeStamp
 order by TimeStamp desc
 limit 1 
"
37555,How should i modify this SQL select?,"SELECT 
    @YourTeam ,
    SUM(
        CASE
            WHEN dt.TeamInGR=@YourTeam THEN dt.GoalsIn
            WHEN dt.TeamGR=@YourTeam THEN GoalsOut
            ELSE 0
        END
       ) AS Goals
    FROM (

         --YOUR QUERY HERE

         ) dt
"
23231,How can I apply all the sql files in a directory?,"<sql
    driver=""org.database.jdbcDriver""
    url=""jdbc:database-url""
    userid=""sa""
    password=""pass"">
  <path>
    <fileset dir=""."">
      <include name=""data*.sql""/>
    </fileset>
  <path>
</sql>
"
4447,SubQuery inner join with condition,"SELECT MAX(CASE WHEN rd.REPNUMBER BETWEEN 11000000 and 11099999 
           THEN rd.REPNUMBER END) + 1 as REPNUMBER, 
       MAX(ri.REPITEM) + 1 as REPITEM 
FROM  REPORTDETAILS rd 
       INNER JOIN REPORTITEMS ri ON rd.REPNUMBER = ri.REPNUMBER  
"
29560,Sybase Multiple Substrings Search,"AND (entry_txt in ('fight', 'grab', 'push', 'strike', 'hit')
     OR entry_txt like 'confron%'
     OR entry_txt like 'aggres%'
     OR entry_txt like 'assa%')
"
10788,Access join on first record,"SELECT tblProducts.intID
, tblProducts.strTitle
, (SELECT TOP 1 intGroup 
   FROM tblProductGroups 
   WHERE intProduct=tblProducts.intID 
   ORDER BY intGroup ASC) AS intGroup
FROM tblProducts 
WHERE tblProducts.blnActive 
ORDER BY tblProducts.intSort ASC, tblProducts.curPrice ASC
"
25506,How do I do this in a query (example provided)?,"SELECT 
    *
FROM 
    property.lease_period lp
WHERE
    lp.lease_current_stop_date < GETDATE() 
    AND
    (lp.lease_status = 'Active' or lp.lease_status = 'Overholding')
    AND 
    lp.period_id = 263      --- Period ID
    AND
    lp.building_id = 40000  --- Building ID
    AND
    lp.suite_id NOT IN (SELECT tenancy_reference FROM lease_deal.lease)
"
39904,SQL group counts per section and show records,"select s.sitename, sa.assetname, sac.costname, sum(value) as value
from siteassetcosts sac join
     siteassets sa
     on sac.siteassetid = sa.id join
     sites s
     on sa.siteid = s.id
group by s.sitename, sa.assetname, sac.costname with rollup;
"
38256,MySQL query to calculate percentage within each group,"SELECT week, day, hour, branch, sales,
       (sales/(SELECT SUM(sales)
               FROM test t2
               WHERE t2.hour = t.hour and t2.week = t.week and t2.day = t.day
              )
       ) * 100 AS Percentage
FROM test t
GROUP BY week, day, hour, branch;
"
38937,SQL query to count rows under 3 different conditions,"count(case when severity = 1 then 1 else null end) as one
"
32994,How to retrieve the internal node's dataset using MDX query?,"select ({[Customer].[Education].[All Customers]}) on axis(0) ,
       ({[Geography].[Country].[All Geographies]}) on axis(1)
 from [Adventure Works]
where [Measures].[Internet Sales Amount]
"
7164,Execute queries until non-empty result,"declare @result table (flag int, col1 int, col2 varchar(50))
insert @result select 1, col1, col2 from Table1 where Column1 = 'a'
if @@rowcount = 0 
    begin
    insert @result select 2, col1, col2 from Table2 where Column1 = 'b'
    end
if @@rowcount = 0 
    begin
    insert @result select 3, col1, col2 from Table1 A, Table2 B 
        where A.Column1 <> B.Column1
    end

select * from @result
"
25396,MySQL - How to get EXACT difference of hours between two dates,"select time_to_sec(timediff('2010-09-01 03:00:00', '2010-09-01 00:10:00' )) / 3600;

+-----------------------------------------------------------------------------+
| time_to_sec(timediff('2010-09-01 03:00:00', '2010-09-01 00:10:00' )) / 3600 |
+-----------------------------------------------------------------------------+
|                                                                      2.8333 | 
+-----------------------------------------------------------------------------+
"
31612,is it possible to set column value to a concatenation of string and iteration value?,"update T
SET LOGIN_NAME = LOGIN_NAME + CAST(rn AS varchar(10))
FROM
   (SELECT
       LOGIN_NAME,
       ROW_NUMBER() OVER (ORDER BY something /*or (SELECT 1)/*) as rn
    FROM
       TB_USER
    WHERE
       LOGIN_NAME = 'Bob'
    ) T
"
29773,Include admin role in users table from roles table,"select u.id, u.username, if (id_role is null,  'N', 'Y') as is_admin
  from users u
  left outer join user_roles r
    on u.id = r.id_user and r.id_role = 1
"
28477,Creating multi-dimentional NetCDF in matlab,"netcdf.endDef(ncid);
% Write one specific value to the last position. 
% See help netcdf.putVar. start is zero based.
% start argument's order corresponds to dimension definition above.
netcdf.putVar(ncid,varid,[50 100 32 95], 10);

netcdf.close(ncid);
"
9733,hotel reservation system SQL: identify any room available in date range,"SELECT r.* 
FROM rooms r
  LEFT JOIN availability a ON (r.id = a.room_id 
 AND a.date_occupied BETWEEN :start_date AND :end_date)
WHERE a.id IS NULL
"
30624,How can I create an ordered list of the most common substrings inside of my MySQL varchar column?,"myisam_ftdump -c yourtablename 1 >wordfreq.dump
"
2402,How to get one row to always display (using one view),"SELECT T1.item, T2.text
FROM T1 LEFT OUTER JOIN
     T2
     ON T1.code = T2.code AND T1.item = T2.item AND T2.detailID = '99'
WHERE (T1.item = '12345') AND (T1.code = '678') ;
"
1954,How do I dynamically create column in a SQL view using a Select statement?,"SELECT     sym1, msg1, 'src1' as src 
FROM       table_src1 
UNION ALL 
SELECT     sym2, msg2, 'src2' as src 
FROM       table_src2 
"
21422,How to insert datas from a table to another table?,"INSERT INTO USER
SELECT * FROM USER_1
"
22707,SELECT newest entry by timestamp,"SELECT * FROM(
    SELECT 
     ID,
     TimeStamp_1,
     TimeStamp_2,
     ROW_NUMBER() OVER(PARTITION BY ID, TimeStamp_2 ORDER BY TimeStamp_1 DESC) AS RNum
    FROM TableName
)x
WHERE RNum=1
"
34061,Aggregate function on DATEDIFF result,"select top 1 s.*
from schedules s
where username = 'username' and CAST('2008-12-20 10:00' AS DATETIME) >= startdate 
order by startdate;
"
31124,All value in a SQL syntax with precompiled query,"WHERE [any condition] 
AND (t.range = x or x is null)
"
32247,SQL Geography point inside polygon not returning true on STIntersect (but returns true using Geometry),"DECLARE @point GEOGRAPHY = GEOGRAPHY::Point(1, 1, 4326)
DECLARE @polygon GEOGRAPHY = GEOGRAPHY::STGeomFromText('POLYGON((0 0, 2 0, 2 2, 0 2, 0 0))', 4326)

SELECT @polygon.STIntersects(@point), @point.STIntersects(@polygon)
"
11121,How is my database connecting without setting a port?,"bool QPSQLDriver::open(const QString & db, const QString & user,
  const QString & password, const QString & host,
  int port, const QString& connOpts)
{
  if (isOpen()) close();

  QString conn;

  if (!host.isEmpty())
    conn.append(QLatin1String(""host="")).append(qQuote(host));
  :
  if (port != -1)
    conn.append(QLatin1String("" port="")).append(qQuote(QString::number(port)));
  :
  d->connection = PQconnectdb(conn.toLocal8Bit().constData());
  :
  return true;
}
"
29548,Postgres time with time zone equality,"SELECT a, b, a = b AS plain_equality
      ,'2000-1-1'::date + a = '2000-1-1'::date + b AS ts_equality
      ,a AT TIME ZONE 'UTC', b AT TIME ZONE 'UTC'  AS timetz_equality
FROM (
   SELECT '12:00:00 -0800'::timetz AS a, '14:00:00 -0600'::timetz AS b
   ) sub;
"
16953,Use Regex to Extract SQL Queries From Source Code,"/""(?:(select)(?:[^""]|""(?=[ \n\r\w]))*?from (\w+)(?:(?:[^""]|""(?=[ \n\r\w]))*?join (\w+))?(?:(?:[^""]|""(?=[ \n\r\w]))*?join (\w+))?(?:(?:[^""]|""(?=[ \n\r\w]))*?join(\w+))?(?:(?:[^""]|""(?=[ \n\r\w]))*?join (\w+))?|(update) (\w+)|(delete) from (\w+)|(insert) into (\w+)).*?""(?=[\n\r])/im
"
17621,join two tables in mysql,"SELECT
  a.course_id,
  a.teach_id,
  a.class_id,
  s.student_id,
  s.student_name
FROM Student AS s
INNER JOIN Apsent AS a ON s.student_id = a.student_id;
"
19834,MySQL: Possible to have wildcards in AS aliases?,"SELECT t1.*, alias2.*, alias3.*
  FROM t1, 
       t2 AS alias2, 
       t3 AS alias3
"
581,Display order of a SQL Query without order by clause,"SELECT EmpId,EmpName,Sal
FROM Emp
WHERE EmpId IN (10,9,5,7,3,8)
ORDER BY CASE EmpId
    WHEN 10 THEN 1
    WHEN 9 THEN 2
    WHEN 5 THEN 3
    WHEN 7 THEN 4
    WHEN 3 THEN 5
    WHEN 8 THEN 6
    ELSE 7
END;
"
28392,Oracle SQL grouping,"select period,
       max(nvl(label1, 0)) label1, 
       max(nvl(label2, 0)) label2, 
       max(nvl(label3, 0)) label3, 
       max(nvl(label4, 0)) label4
from my_table
group by period;
"
22548,Is this method of building dynamic SQL vulnerable to SQL injection or bad for performance?," SELECT * FROM Books Where Type='Novel' AND author=? AND pages > ?
"
32278,Optimizing sql query to find number of non unique values in a column,"ALTER TABLE tableNAME ADD INDEX (field1)
"
25094,Get MIN value for each id,"select t.callid, 
       min(timein) as 'mintime' 
from loggeddata 
GROUP BY callid
"
19587,How to return extra dynamic column based on query?,"SELECT A,
       B,
       C,
       (SELECT somecol
        FROM   sometable
        ORDER  BY somecol
        limit 1) AS D
FROM   Table_A 
"
10856,How do I call a SQL Server 2000 DTS package in VB.net,"process.start(""dtsrun /S """"server name"""" /U sa /N """"d:\task.dts"""""")
"
30221,Counting the occurrences of a distinct values depending on its date,"Select 
  in_date, 
  Sum (case when item_code = item1 then 1 else 0 end) item1,
  Sum (case when item_code = item2 then 1 else 0 end) item2
From tbl
Group by in_date
"
27056,Oracle week calculation issue,"CASE
  --if [date field]'s day-of-week (e.g. Monday) is earlier than 1/1/YYYY's day-of-week
  WHEN to_char(to_date('01/01/' || to_char([date field],'YYYY'),'mm/dd/yyyy'), 'D') - to_char([date field], 'D') > 1 THEN
    --adjust the week
    trunc(to_char([date field], 'DDD') / 7) + 1 + 1 --'+ 1 + 1' used for clarity
  ELSE trunc(to_char([date field], 'DDD') / 7) + 1
END calendar_week
"
34960,how to select specific value from text column containing an xml string?,"SELECT convert(XML,my_col).value('(/rootElementName/@Recommended)[1]', 'bit') rec
FROM  my_table
"
18876,How to run oracle imp/exp from sql plus,"SQL> host exp RATOR_MONITORING/RATOR_MONITORING@10.127.130.125/O2P00R11 PARFILE=exp02_rm.par
"
26957,SQL Check constraint on set of two columns,"create unique index idx_table_userId_active
    on table(userId)
    where active = 1;
"
30978,Insert into a child table for every row in a parent table,"insert into tblAuditAnswers (AuditID, QuestionID)
select A.AuditID, QD.QuestionID
from tblAudits as A
  cross join tblQuestionDefs as QD
where (A.AuditStatus='Issued' or A.AuditStatus='Pending') and
        not exists (select *
                    from tblAuditAnswers as AA
                    where QD.QuestionID = AA.QuestionID and
                          A.AuditID = AA.AuditID)
"
29393,how to write query to get the data based on month?,"SELECT monthname(attendencedate) AS monthname,
  COUNT(*) AS totalworking_days,
  SUM(CASE WHEN attendence = 'present' THEN 1 ELSE 0 END) AS present,
  SUM(CASE WHEN attendence = 'absent' THEN 1 ELSE 0 END AS absent      
FROM lstms_attendence
WHERE addmissionno = 'LSTM-0008/2013-2014'
GROUP BY monthname(attendencedate);
"
2016,"i do a case when section with group by, after i want a count","select count(*) as anum, voucher, date
from (
     select case when anum like '0%' then 0 else 1 end anum ,
        ,voucher
        , date 
     from ledger
     group by voucher, date, case when accountnum like '0%' then 0 else 1 end
     order by voucher
) sq
group by voucher, date
"
28498,Joining two tables for the result?,"   SELECT o.order_id, o.order_no, o.person_id, p.name
     FROM `order` o
LEFT JOIN person p
       ON p.person_id = o.person_id AND p.FIRST_NAME IS NOT NULL
"
11045,Only LIMIT rows with specific number,"SELECT *, c.id AS cid, u.id AS userid 
FROM comments c 
INNER JOIN users u ON u.id = c.uid 
WHERE c.tid = :id 
AND pid != 0
ORDER BY c.posted ASC
LIMIT // whatever limit you want here
UNION
SELECT *, c.id AS cid, u.id AS userid 
FROM comments c 
INNER JOIN users u ON u.id = c.uid 
WHERE c.tid = :id 
AND pid = 0
ORDER BY c.posted ASC
LIMIT 20
"
4176,Calling procedure on linked server without distributed transaction,"EXEC sp_serveroption 'servername', 'remote proc transaction promotion', 'false'
"
33697,Division in SQL Query always equals 0,"SELECT MAX(ID)*1.0 / (MAX(ID) + count(*)) as PercentIgnored from student
"
6686,SQL: disjoint select to one table,"SELECT  Person_ID
FROM    Exam_Result
WHERE   Exam_type = 'type_here'
GROUP   BY Person_ID
HAVING  COUNT(CASE WHEN EXAM_RESULT = 'PASSED' THEN 1 END) = 0
"
4351,mysql: select * where first and last name starts with the same letter,"SELECT * FROM `people` WHERE UPPER(LEFT(first_name, 1)) = UPPER(LEFT(last_name, 1))
"
11716,Replacing the last characters of a string value with the id of the table,"UPDATE accounts
SET account_id=CONCAT(LEFT(account_id,9), LPAD(id, 4, '0'))
"
14272,Check the length and add corresponding column,"SELECT 
CASE 
WHEN ((LEN(ID))<5) THEN (RTRIM(ID)+LTRIM(Code)) ELSE ID END AS ID
FROM tblID
ORDER BY ID DESC
"
39083,How to find fields with calculating other fields?,"SELECT Temp_Table.name AS NameOfPerson 
FROM   (SELECT cust.name, 
               Count(DISTINCT restaurant) AS UniqueRest 
        FROM   visits, 
               cust 
        WHERE  cust.name = visits.name 
               AND cust.gender = 'female' 
        GROUP  BY cust.name) AS Temp_Table 
WHERE  UniqueRest >= 2 
"
27548,"sql question, alternative to if-else for this example?","DECLARE @cityID bigint;
set @cityID = NULL
--set @cityID = 3

SELECT ID,
        Name,
        CityID,
        IsProvince
FROM TABLE t
    WHERE (@cityID IS NULL AND t.CityID IS NULL AND IsProvince = 1)
          OR (t.CityID = @cityID)
"
3387,How to trigger a table to change the value of another table column,"CREATE TRIGGER trgAfterInsert ON [dbo].[Payment] 
FOR INSERT
AS
declare @ClientID int;
select @ClientID =i.ClientID from inserted i;   

if update(ClientID)
    UPDATE Reservation set Reservation_paid='Yes' WHERE  
    ClientID=@ClientID;
"
17088,Retrieving data from column depending on another column in mysql,"SELECT e.id, e.name, s.name 
FROM Employee e LEFT JOIN Supervisor s ON e.supervisor = s.id
"
38681,Schedule a SQL INSERT from a live table to another table with a group function in Oracle,"TO_DATE(TO_CHAR(s.starttm, 'YYYY-MM-DD HH24:')||TRUNC(TO_NUMBER(TO_CHAR(s.starttm,'MI'))/30,0)*30||':00', 'YYYY-MM-DD HH24:MI:SS') 
"
1308,How to inspect SQL Server database during a transaction?,"SELECT * FROM dbo.Table WITH (NOLOCK)
"
20350,"How to call stored procedure within function by output value, then get and return this value?","CREATE FUNCTION [dbo].[spsRouteRules_getNewNumber](@oldNumber NVARCHAR(15))
RETURNS NVARCHAR(15)
AS BEGIN
    SET NOCOUNT ON;

    RETURN ISNULL(SELECT TOP 1 newTellNo FROM changedPhones WHERE oldTelNo = @oldNumber),0);
END
"
29901,SQL Query: Group by multiple columns in different tables,"select u.name, s.status, count(t.userid) as cnt
from users u cross join
     (select distinct status from tasks) s left join
     tasks t
     on t.userid = u.id and t.status = s.status
group by u.name, s.status
order by u.name, s.status;
"
38354,Merge a specific table column from one database to another,"UPDATE [new_table_name] SET comment = [old_table_name].onecomment
  FROM [new_table_name]
  INNER JOIN [old_table_name] ON [new_table_name].aboutme_id = [old_table_name].aboutme_id
"
16300,MYSQL get spacific table fields counts,"SELECT a.idea_id, a.property_id, a.the_idea, a.user_id, a.added_date, a.status, 
       SUM(b.thumbs = 1) AS up, SUM(b.thumbs = 0) AS down
FROM idea_box a 
LEFT JOIN idea_box_voting b ON a.idea_id = b.idea_id 
GROUP BY a.idea_id;
"
23225,query last value,"select top 1 
       l.klantId, bh.rechten, kg.voornaam, kg.achternaam, kg.woonplaats, kg.telefoonnr, og.klantbericht, s.klantstatus 
from login l 
inner join klantGegevens kg on l.klantId=kg.klantid 
inner join bevoegdheden bh on l.rechten=bh.id 
inner join orderGegevens og on og.loginNr=l.klantid 
inner join status s on s.id=og.klantstatus 
where l.klantid=1 
order by ordernr desc
"
19817,sum and order by on multiple tables,"SELECT userid,SUM(filesize) as TotalSize
FROM files
GROUP BY userid
ORDER BY SUM(filesize) DESC
"
2923,help with mysql query,"SELECT u.user_id, g.owner_id, g.comment_author_id, g.comment_text, c.user_name, p.path
FROM users u
LEFT JOIN guestbook g
    ON u.user_id = g.owner_id
LEFT JOIN users c
    ON c.user_id = g.comment_author_id
LEFT JOIN profile_photo p
    ON p.user_id = g.comment_author_id
WHERE u.user_name = $user_name
"
39063,How do I count how many of these columns have a value in SQL?,"SELECT
  Id,
  SUM(
    CASE WHEN Item1 is NULL THEN 0 ELSE 1 END
    +
    CASE WHEN Item2 is NULL THEN 0 ELSE 1 END
    +
    CASE WHEN Item3 is NULL THEN 0 ELSE 1 END
    +
    CASE WHEN Item4 is NULL THEN 0 ELSE 1 END
    +
    CASE WHEN Item5 is NULL THEN 0 ELSE 1 END
    ) 'Count'
FROM 
   tableName
GROUP BY 
   Id
"
26776,how to hold datetime into a field in oracle?,"insert into table_name
(date_field)
values
(to_date('2010/01/04 09:00:00', 'yyyy/mm/dd hh24:mi:ss'));
"
1670,select distinct records where multiple rows exist for one ID based on values in another column,"SELECT ID
FROM TableA
WHERE ID NOT IN(SELECT ID
            FROM TableA
            WHERE CODE='AAA')
"
39799,Does dynamically formed SQL in Stored Procedures negate the very purpose of Stored Procedures?,"CREATE PROCEDURE MyProc
  (@FirstName varchar(50),
   @LastName varchar(50))
AS
BEGIN
    SELECT * FROM TABLENAME
    WHERE FirstName = @FirstName
        AND LastName = @LastName
END
"
18308,Table without ID's in other Table,"   SELECT A.*
    FROM Users A
    Where A.ID NOT IN (Select Id From Blacklist )
"
32471,"Order by birthday, disregarding year","ORDER BY DATEADD(YEAR, 2000-YEAR(birthday), birthday);
"
26809,Embed rich text with CATextLAyer,"layer.text=@""The article was about employment. He leafed through it in an instant. His feeling of anxiety resurfaced and he closed the magazine.\n\n-Hm, he breathed.\n\n-Have you been looking for work long?, asked the stranger at his side.""
"
25344,Using existing Database Sequence and creating custom generator,"String sql = ""select MY_SEQ_ID.nextval from dual"";
        SQLQuery query = session.getCurrentSession().createSQLQuery(sql);
        List idList=query.list();
        BigDecimal number=(BigDecimal) idList.get(0);
        System.out.println(number);
"
29184,How to check for null/empty/whitespace values with a single test?,"SELECT column_name
  FROM table_name
 WHERE TRIM(column_name) IS NULL
"
24356,Compare row count of two tables in a single query and return boolean,"FROM Table1,Table2
"
9883,INSERT OR REPLACE only specific values?,"db.execute(""UPDATE ..."")
if db.affected_rows == 0:
    db.execute(""INSERT ..."")
"
7046,"SQL Return Unique Count from 3 Columns - DateTime, Vehicle, Driver","SELECT
    m.CurrentDateTime, v.VehicleName, count(distinct m.Driver)
FROM
    Vehicles AS v INNER JOIN
    MainData AS m
    ON l.VehicleID = m.VehicleID
WHERE
    v.VehicleName = 'Car 1' 
GROUP BY
    m.CurrentDateTime 
    , v.VehicleName
ORDER BY 
    m.CurrentDateTime 
    , v.VehicleName
"
33997,Choose minumum result of SELECT query in Postgresql,"SELECT t.userid AS us
      ,ST_Distance(t.thegeometry, b.thegeomtry) AS dist
FROM   track t
CROSS  JOIN buildings b
WHERE  b.type = 'store'
ORDER  BY dist 
LIMIT  1;
"
13484,SQL get differences in one column by ID,"SELECT id  
FROM mytable
GROUP BY id
HAVING MIN(name) <> MAX(name)
"
4506,Select rows with dates and article points (without relation),"SELECT DISTINCT E.Name,
  E.SurName,
  a.Date_Publish, 
  IFNULL(AG.Points,0) Points
FROM Articles A CROSS JOIN
  Employee E LEFT JOIN
  ArticlesGroup AG ON ag.ID_group = a.ID_group_AG 
    AND E.Id = ag.ID_employee
"
37980,SQL Command Not Properly Ended in Oracle - Problems updating table values using joins,"UPDATE SUPPLY
set sprice=(1.1*SPRICE)    
WHERE SUPPLY.SID IN (SELECT SID FROM Supplier WHERE Supplier.CITY='DC');
"
39029,how to return duplicate rows if date difference is equal or more than 4 days or 96 hours,"-- Simply grouping each ID and get unique row with minimum date
SELECT MIN(SDATE) [SDate], ID
FROM tt
GROUP BY ID

UNION 

-- Get the row with each ID's difference is more than 96 hours
SELECT D.MaxDate  [SDate], D.ID
FROM (
    SELECT MIN(SDATE) [MinDate], MAX(SDATE) [MaxDate], ID
    FROM tt
    GROUP BY ID
) D
WHERE DATEDIFF(HH, D.MinDate, D.MaxDate) >= 96
"
11881,How to do a Postgresql group aggregation: 2 fields using one to select the other,"select Name, sum(Amount),
       max(case when seqnum = 1 then Last end) as Last,
       max(date)
from (select d.*, row_number() over (partition by name order by date desc) as seqnum
      from data d
     ) d
group by Name;
"
37621,Mimic STRING_SPLIT without custom function in SQL Server 2008,"DECLARE @Result Table(Value varchar(50))
DECLARE @x XML
SELECT @X = CAST('<A>' + REPLACE(@StringList, '|', '</A><A>') + '</A>' AS XML)

INSERT INTO @Result
SELECT t.value('.', 'varchar(50)') as inVal
FROM @X.nodes('/A') AS x(t)
"
26498,String Replace PNG For Jpg,"update TABLE_NAME set FIELD_NAME = replace(FIELD_NAME, find this string, replace found string with this string);
"
28363,Need help coming up with query to find something that is in everything,"select t1.title from titles t1
where t1.title_id not in (
  select sub.title_id from sales sa
  right join (
    select t.title_id, stor_id from titles t, stores st
  ) Sub on sa.title_id = sub.title_id and sa.stor_id = sub.stor_id
  where sa.title_id is null)
"
25175,Find bad/duplicate data in same table,"SELECT
  c1.Name as Name1,
  c1.Surname as Surname1,
  c2.Name as Name2, 
  c2.Surname as Surname2,
  c.Phone
FROM 
  Customers c1 INNER JOIN 
  Customers c2 ON c1.Phone = c2.Phone AND c1.id < c2.id
"
24674,MySQL JOIN ON the one of two columns that doesn't match variable,"SELECT coalesce(u1.name, u2.name) as name
FROM matches m LEFT JOIN
     users u1
     ON u.userId = m.userId1 AND m.userId2 = '1' LEFT JOIN
     users u2 
     ON u.userId = m.userId2 AND m.userId1 = '1'
WHERE '1' in (m.userId1, m.userId2);
"
17048,Finding duplicate rows in SQL Server,"select o.orgName, oc.dupeCount, o.id
from organizations o
inner join (
    SELECT orgName, COUNT(*) AS dupeCount
    FROM organizations
    GROUP BY orgName
    HAVING COUNT(*) > 1
) oc on o.orgName = oc.orgName
"
13185,SQL Design: Is it wise to have a table for current orders and one with all orders for historical purposes?,"(
     ...
     ...
     IsArchived       Bit
)
"
11875,Summing Counts into Multiple New Columns Grouped By Another Column,"

select Date, 
sum(case when diff <= -3 then 1 else 0 ) AS [<=-3], 
sum(case when diff = -2 then 1 else 0 ) AS [-2], 
sum(case when diff = -1 then 1 else 0 ) AS [-1], 
sum(case when diff = 0 then 1 else 0 ) AS [0], 
sum(case when diff = 1 then 1 else 0 ) AS [+1], 
sum(case when diff = 2 then 1 else 0 ) AS [+2], 
sum(case when diff >= 3 then 1 else 0 ) AS [>=+3]
from 
(select Date, Num1, Num2, (Num1-Num2) diff from TableA)TableB
group by Date"
23255,Select from a SQL table starting with a certain index?,"select from table
offset 50
limit 50
"
13741,consolidating and Adding data to new lines to a field in a column in mysql table,"SELECT 
     x2.id, 
     STUFF((SELECT char(10)+x1.State+':'+x1.Type FROM tableX x1 WHERE x1.id=x2.id GROUP BY x1.id for xml path(''),TYPE),1,1,'') as stype 
FROM tableX x2
GROUP BY x2.id
"
25084,Getting value from a table and add value from table 2 if excist,"SELECT *
FROM Employee_Table e LEFT JOIN
     Computer_Table c
     ON c.EmployeeNr = c.EmployeeNr
WHERE e.username LIKE '%SomeUsername%';
"
25077,How to use parameters in contains method in store procedure,"DECLARE @nameX NVARCHAR(4000) = '""' + @name + '"" OR ""' + @name + '*""'
...
CONTAINS(name, @nameX)
"
9268,Determine overlapping times between record sets,"Select (case when p.StartTime > s.StartTime then p.StartTime else s.StartTime
        end) as StartTime,
       (case when p.EndTime < s.EndTime then p.EndTime else s.EndTime
        end) as EndTime
from Patient p Inner Join
     Staff s
     on s.LocationId = p.LocationId qne
        s.StartTime <= p.EndTime and s.EndTime >= p.StartTime;
"
9821,MongoImport Dates Occurring Before The Epoch,"Dates.each do |d|
  d.mydate = d.mydate.to_date
  d.save
end
"
15410,SQL to Count status text and change some of those status texts (and their count) based on a date,"DECLARE @currentDate DATE = '20160404'

SELECT
    Status =
        CASE 
            WHEN DueDate <= @currentDate AND ISNULL(Status, '') <> 'Complete' THEN 'Late'
            ELSE Status
        END,
    COUNT(*)
FROM DispatchStatus
GROUP BY
    CASE 
        WHEN DueDate <= @currentDate AND ISNULL(Status, '') <> 'Complete' THEN 'Late'
        ELSE Status
    END
"
18994,How can I select duplicate records and keep the data using MySQL statements?,"SELECT Tab1.categories_id, Tab1.categories_name
FROM categories AS Tab1
RIGHT JOIN
(
   SELECT ""aaa"" AS categories_name
   UNION ALL
   SELECT ""bbb"" 
   UNION ALL
   SELECT ""bbb""
   UNION ALL
   SELECT ""ccc""
   UNION ALL
   SELECT ""ccc""
   UNION ALL
   SELECT ""ddd""
   UNION ALL
   SELECT ""ddd""
   UNION ALL
   SELECT ""ddd""
) AS Tab2 
ON Tab1.categories_name = Tab2.categories_name
ORDER BY Tab1.categories_name;
"
37043,Access get all tables,"SELECT MSysObjects.*, MSysObjects.Type
FROM MSysObjects
WHERE (((MSysObjects.Type)=1)) OR (((MSysObjects.Type)=6));
"
7250,sql searching multiple words in a string,"Select * from table where 
  columnname like'%David%' and 
  columnname like '%Moses%' and columnname like'%Robi%' 
"
11200,Conditional Statements Inside A Where Clause,"   Select ...
   Where id = @my_id  
      And (status = 1 Or 
         (Db_Name() <> @DbName And status = 3))
"
37158,Postgresql distinct by priority,"select distinct on (postcards.id)
    postcards.id, postcards.title, rational
from
(
    select
        postcards.id, postcards.title,
        some_complex_condition as rational
    from postcards
) as postcards
order by postcards.id, rational
"
27376,"SQL to answer: which customers were active in a given month, based on activate/deactivate records","select t2.custid from
(
-- select the most recent entry for each customer
select custid, date, action 
from cust_table t1 
where date = (select max(date) 
    from cust_table where custid = t1.custid)
) as t2
where t2.date < '2011-06-01'
-- where the most recent entry is in May or is an activate entry
-- assumes they have to have an activate entry before they get a deactivate entry 
and (date > '2011-05-01' or [action] = 'activate')
"
19774,Explicitly specify sort order for mysql query?,"select * from TABLE order by field(ID,4,2,5,3,1)
"
36087,Oracle: Disable a constraint inside a trigger,"declare
 pragma AUTONOMOUS_TRANSACTION;
begin
 execute immediate 'alter table SESSION_LOGGING ......';
"
19685,locate mysql function doesnt play nice with unicodes?,"SELECT
  name,
  name LIKE BINARY '%ba%',
  name LIKE '%ba%',
  LOCATE('ba', name)
FROM
  `keywords`;
"
27324,Create a group indicator (SQL),"(CASE WHEN COUNT(*) OVER (partition by name, zip, phone) > 1
      THEN 'X'
      ELSE NULL
  END) duplicate,
DENSE_RANK() OVER (ORDER BY name, zip, phone) group_rank
"
14131,Oracle date function for the previous month," select count(distinct switch_id)   
  from xx_new.xx_cti_call_details@appsread.prd.com  
 where dealer_name =  'XXXX'    
   and creation_date between add_months(trunc(sysdate,'mm'),-1) and last_day(add_months(trunc(sysdate,'mm'),-1))
"
21781,MySQL : collect the sum of the associated values,"SELECT date,SUM(in_stock) in_stock,SUM(out_stock) out_stock FROM
 (
 SELECT stock_date date,quantity in_stock,0 out_stock FROM article
  UNION
 SELECT selling_date,0,quantity FROM selling JOIN selling_detail ON selling_detail.selling_id = selling.id
 ) x
GROUP BY date;
"
7755,Trouble with computed column in SQL,"SELECT
   id AS outerid,
   (SELECT COUNT(Id) FROM tablename
    WHERE id<outie.id AND answertime IS NOT NULL)
FROM tablename outie
WHERE answertime IS NULL;
"
36677,Get how many users who responded to a survey,"SELECT COUNT(DISTINCT ID_User) FROM fs_surveys
"
4163,get age using year of birth only on perl,"[test]> create table person (name varchar(20), birth year);
Query OK, 0 rows affected (0.04 sec)

[test]> insert into person values ('Dave', 1962);
Query OK, 1 row affected (0.02 sec)

[test]> select name, year(now()) - birth as age from person;
+------+------+
| name | age  |
+------+------+
| Dave |   52 |
+------+------+
1 row in set (0.00 sec)
"
16113,How can I INSERT rows into a new table and update the primary key of the transported items?,"INSERT INTO xyz_1mydata (field1, field2, ...)
    SELECT field1, field2, ... FROM xyz_1production...
"
6971,TYPO3 Extbase: Check if Database entry already exist,"if(!$this->someRepository->countByRegId($regId)) {
    // there isnt a object with $regId yet
}
"
36044,SQl query across 2 tables with conditional,"INNERJOIN ShippingMethods ON (Sales.ShippingMethodID = ShippingMethods.ShippingMethodID  
        AND ShippingsMethods.ShippingMethod = 'Post')
"
3750,Find amount of updated rows in T-SQL,"declare @aaa int -- this name's noty the best... use @row_count instead ;)
UPDATE Table SET value=2 WHERE value2=1
set @aaa = @@ROWCOUNT
select @aaa
"
33347,Can you use a select statement as well as manual entry with an insert statement?,"INSERT INTO table1(col1, col2)
select col1, '0'
from table1
where table1.col1 = 'test'
"
19871,SQL select distinct by 2 or more columns,"SELECT distinct col1, col2, col3
FROM   mytable
"
20423,"In SQL, what is the relation between the ""with"" clause and views?",";WITH CTE AS
(
  SELECT Stuff...
  FROM Table
  WHERE things

)
"
11005,How to efficiently retrieve data in one to many relationships,"SELECT first_table.ID, CASE WHEN EXISTS (SELECT * FROM second_table WHERE first_table.ID = second_table.ID) THEN 1 ELSE 0 END FROM first_table
"
38341,CURSOR vs. UPDATE,"DECLARE @Done bit = 0
WHILE @Done = 0
BEGIN
    UPDATE TOP(10000)
        Customers SET Phone = 222- + SUBSTRING(Phone,5,8) 
    FROM Customers WHERE SUBSTRING(Phone,1,3) = 111 
    AND SUBSTRING(Phone,5,3) >= 500 

    IF @@ROWCOUNT = 0
    BEGIN
        SET @Done = 1
    END
END
"
32400,SQL How can I select data that appear stored in similar columns from two tables ignoring the case?,"select upper(people)
from TableA
intersect
select upper(people)
from TableB
order by 1
"
30542,Showing combined results for graph from two tables,"SELECT t.ID, t.YearMonth, COALESCE(V.Votes,0) Votes, COALESCE(L.Lectures,0) Lectures
FROM (
    SELECT DISTINCT ID, YearMonth
    FROM Votes
    UNION 
    SELECT DISTINCT ID, YearMonth
    FROM Lectures 
    ) t
    LEFT JOIN Votes v on t.ID = v.ID AND t.YearMonth = v.YearMonth
    LEFT JOIN Lectures l on t.ID = l.ID AND t.YearMonth = l.YearMonth
"
25173,sql - how to merge different rows into one without group_concat," select user_id, 
       max(case when `key` = 'name' then value end) as name,
       max(case when `key` = 'url' then value end) as url,
       max(case when `key` = 'email' then value end) as email
from your_table
group by user_id
"
16593,Insert one column after selecting multiple,"SELECT  
  org_id, site_id, site, 
  COUNT(DISTINCT mailing_list) AS count_mailing_lists,
  COUNT(email_address) AS aggregate_email_count,
  COUNT(DISTINCT email_address) AS unique_email_count
FROM Data_Table
GROUP BY org_id, site_id WITH ROLLUP
"
20432,Selective join for two tables (SQL Server),"SELECT t1.docnum, t1.doctype, t1.code, t2.invnum
FROM 
(
    select *, row_number() over (partition by docnum ORDER BY docnum, poline) as ordinal
    from table1
) t1
LEFT JOIN 
(
    select *, row_number() over (parition by docnum ORDER BY docnum, invseq) as ordinal
) t2 ON t2.docnum = t1.docnum and t2.ordinal = t1.ordinal
"
28491,ON DELETE trigger in SQL Server 2008 affects more rows than intended,"update 
        dbo.Job 
set 
        objectid = -1, lat = -1, lng = -1, location = null 
from
        dbo.Job as j 
    join
        dbo.Plan as p   on  p.planid = j.planid
    join
        deleted as d    on  d.objectid = j.objectid
                        and d.user_id = p.userid ;
"
27729,how do I aggregate one column for 2 tests into two columns on one row,"select      codename
            , codedesc
            , sum(case when passfail = 1 then 1 else 0 end) as pass_values
            , sum(case when passfail = 0 then 1 else 0 end) as fail_values
from        passfailmaster
group by    codename
            , codedesc
"
5893,Converting a mixed fraction to a float number in Netezza,"select
  case when instr(num,'/') > 0 then 
       cast(substr(num,1,2) as float) 
       + (cast(substr(num,4,1) as float)/cast(substr(num,6,1) as float))
  when instr(num,'.') > 0 then cast(substr(num,1,4) as float) 
  else cast(num as float)
end as float_num
"
873,Update Field When Not Null,"UPDATE newspapers
SET scan_notes = ""data"",    
  scan_entered_by = ""some_name"",    
  scan_modified_date = ""current_unix_timestamp"",
  scan_created_date = COALESCE(scan_Created_date, ""current_unix_timestamp"")
WHERE id = X
"
23723,Split words in many columns sql,"select
    regexp_substr(""Column-desc"", '\S+', 1, 1) as ""return-desc1"",
    regexp_substr(""Column-desc"", '\S+', 1, 2) as ""return-desc2"",
    regexp_substr(""Column-desc"", '\S+', 1, 3) as ""return-desc3"",
    regexp_substr(""Column-desc"", '\S+', 1, 4) as ""return-desc4""
from your_table
"
32052,Display if column has more than 1 @ sign,"SELECT * FROM your_table WHERE email LIKE '%@%@%';
"
2738,How to find change in column from table?,"select PNUM,count(distinct CUR) changecount
from table
group by PNUM
having count(distinct CUR)>1
"
38979,How would I execute this complex conditional multi-table MySQL join (queries provided)?,"SELECT DISTINCT
       item.name,
       item.owner_id,
       item.description,
       user.name
  FROM items AS item
       LEFT JOIN users AS user ON item.owner_id = user.id
       LEFT JOIN locations AS loc ON item.location_id = loc.id
       LEFT JOIN cabs AS cab ON item.cab_id = cabs.id
 WHERE ((loc.name = 'Seattle' AND cab.name = 'Cool')
    OR  (loc.name = 'Denver' AND cab.name = 'thecab'))
"
27555,Row number only for matching rows by id?,"select category, empname, row_number() over(partition by category)
"
10236,RpgSQL - Why is it so slow?,"R> library(RPostgreSQL)
Loading required package: DBI
R> drv <- dbDriver(""PostgreSQL"")
R> con <- dbConnect(drv, password=""...."", dbname=""beancounter"")
R> system.time(res <- dbGetQuery(con,
+>             ""select * from fxprices where date >= '2005-01-01' limit 1000"")) 
   user  system elapsed 
  0.030   0.000   0.113
R> dim(res)
[1] 1000    8
R>
"
9787,Performing an SQL cast in Slick,"SimpleExpression.unary[Date, String] { (date, qb) =>
      qb.sqlBuilder += ""CAST( ""
      qb.expr(date)
      qb.sqlBuilder += "" AS CHAR)""
    }
"
11966,SQL Server 2005 - Columns to Row,"select distinct t1.[key],
  STUFF((SELECT distinct ', ' + t2.plant
         from yourtable t2
         where t1.[key] = t2.[key]
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,2,'') plant
from yourtable t1;
"
23462,Adding elements in a Varray,"UPDATE employees
  SET ls_pnm = list_surname('<list of values>')
 WHERE name ='<conditions>';
"
34605,Count unread messages from a sender,"select senderid,
       max(case when r.deleted_by_recipient = 'no' and r.recipientID = '001' then m.msgID end
          ) as CurrentMsg,
       sum(r.msgStatus = 'unread') as unread
from messages m left outer join
     recipients r
     on  m.msgID = r.msgID
group by senderid;
"
20637,opposite to top,"SELECT TOP 1 OrderDate FROM ordersview ORDER BY OrderDate DESC
"
15493,Oracle ranking with condition,"with x as (
    select 1 col1, 1 col2, 2 col3 from dual union all
    select 1, 3, 33 from dual union all
    select 2, 4, 5 from dual union all
    select 3, 6, 40 from dual union all
    select 1, 2, 5 from dual union all
    select 3, 5, 10 from dual
 )
 select col1, col2, col3,
        sum( case when col3 > 30 then 1 else 0 end ) 
          over( partition by col1
                order by col2 ) + 1 rnk
   from x
"
13976,Interbase XE7 Precedence using Brackets,"SELECT * FROM table1
 WHERE
cast (fdate ||' '||ftime as timestamp) >= '2015-05-01 07:00:00'
 and
cast (fdate ||' '||ftime as timestamp) < '2015-05-02 07:00:00'
"
26078,Best database field type for CONTENT_LENGTH Http Header,"   Content-Length: 3495
"
13302,Remove on update condition without drop mysql table,"ALTER TABLE `invoices`.`invoices`
    CHANGE `DateTime` `DateTime` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
"
3078,"How can I convert this SQL query using COUNT, SUM, CASE, and BETWEEN into Perl DBIx::Class?","my $rs = My::Schema->resultset('Students') #
    ->search({
        status => 6,
        grad_date => { 'between' => [ $start_dt, $end_dt ] },
    });

my $num_grads    = $rs->count();
my $num_employed = $rs->search({ employment_status => 1 })->count();
"
30885,"how to manage millions/billions of small values in a ""database""","CREATE TABLE myTable (
    [DATE] datetime,
    [TYPE] varchar(255),
    [VALUE] varchar(255)
)
"
4301,Fetching values from tables and adding other parameters in Insert Query,"Insert into TableA (P1,P2,P3,P4,P5,P6,P7,P8) 
     SELECT b.column1, b.column2, b.column3, b.column4, @P5, @P6, @P7, @P8
     FROM TableB b
     WHERE ...
"
436,Conditional Statement in SQL defining variables,"LEFT JOIN ratings as r
    ON r.item_id = c.item_id AND c.user_id = r.user_id
WHERE i.item = '{$item}'
"
20748,"SQL, finding entries when value to one column is A or B","select * from table where col in ('foo1', 'foo2')

select * from table where col = 'foo1' or col = 'foo2'
"
24375,How to persist Entity object which contains another Entity Objects to the database?,"@Entity
public class Customer {
    @OneToMany(cascade=CascadeType.ALL, mappedBy=""customer"")
    public Set<Order> getOrders() { 
        return orders; 
    }
    ...
}

@Entity
public class Order {
    @OneToOne
    Customer customer;
    ...
}
"
28159,Pl/Sql using instr to find exact match,"select replace(name,' serv ', ' Services ')
from names;
"
30401,MySQL - Select from table 1 if second table is empty or not not empty,"SELECT ST.* , E.data, E.status
FROM `students` ST
LEFT JOIN `table2` E
ON E.id_student=ST.id_student and E.data LIKE '$year-$month-%'
WHERE ST.class='$class'
ORDER BY ST.surname, ST.name, E.data
"
27771,MySQL : How do I select the next rows from ID,"select * 
from your_table 
where id > 5 
order by id asc limit 5
"
33529,MySQL: handle EMPTY SET in UPDATE statement,"UPDATE table
SET field = if((SELECT field FROM another_table WHERE id = @id) IS NULL,true,false);
"
13653,Years calculations inside stored procedure,"select m.*, (year(Member_since) + n.n) as YearNotPaid
from members m join
     numbers n
     on year(Member_since) + n.n <= year(now()) left outer join
     membership ms
     on ms.code = m.code and
         year(Member_since) + n.n = year(ms.paid)
where ms.id is null;
"
33739,Is there a way to coalesce the top option value in stored procedure?,"@topParam
select TOP (COALESCE (@topParam, 1000000000))
"
35537,"How to use ""IN"" in CASE on SQL server?","WHERE (Column1 = @Value AND @chk = 'Y')
OR (@chk <> 'Y' AND Column1 IN (SELECT column2 FROM table2));
"
36233,How to get sum of multiple records in a column,"select TC.F_Exhibition_Name, T.F_Exhibitor_Name, TC.F_CreditNoteNo, 
       TC.F_Description, TC.F_Price,TC.F_Qty, TC.F_CNqty, TC.F_Totalamt,
       sum(TC.F_Totalamt) OVER () AS SumOfTotalamt
from T_CreditNote TC 
LEFT JOIN T_Exhibitor T on T.F_Exhibitor_Name=TC.F_Exhibitor_Name 
where TC.F_CreditNoteNo='CNINV100002'
"
6572,Are there problems with this 'Soft Delete' solution using EAV tables?,"create table mytable(
   col_1 int
  ,col_2 varchar(100)
  ,col_3 date 
  ,primary key(col_1)
)

create table mytable_deleted(
   delete_id  int      not null auto_increment
  ,delete_dtm datetime not null
-- All of the original columns
  ,col_1 int
  ,col_2 varchar(100)
  ,col_3 date 
  ,index(col_1)
  ,primary key(delete_id)
)
"
24531,iOS Data Storage Guidelines issues for a backwards-compatible app,"    BOOL success = [url setResourceValue: [NSNumber numberWithBool: skip]
                                  forKey: NSURLIsExcludedFromBackupKey error: &error];
"
11760,search product with their specifications filter,"select product 
from my_table  
where (custom = 'Ram' and custom_value = '2') 
    or (custom = 'vga' and custom_value in ('1', '512'))
group by product
having count(distinct custom) = 2
"
21740,How to calculate avarage value in mysql query?,"select name,v1,v2, (max(rate) + min(rate)) / 2 As `Average`
From messages m
INNER JOIN rates r
 ON r.id = m.rate_id
Group by name,v1,v2
"
4754,Shortest way to GROUP BY similar values and retain latest rows?,"SELECT A,B,max(Date) GROUP BY Text
"
34435,MySQL check if text date is between two dates,"select * 
from table 
where STR_TO_DATE(timesheet_report_month, '%M %Y') 
    between '2014-11-01' and '2015-03-31'
"
9039,SQL SELECT JOIN COLUMN ALIAS,"SELECT m.[MarriageID], peopleA.[PersonName] AS aName, peopleB.[PersonName] AS bName  
FROM [Marriages]  M
JOIN [People] peopleA ON m.[PersonIDa] = peopleA.[PersonID]  
JOIN [People] peopleB ON m.[PersonIDb] = peopleB.[PersonID]  
"
17197,SDU setting in the connection string with oracle 11G,"jdbc:oracle:thin:@(DESCRIPTION=(SDU=32767)(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.191.231)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=naladomain))
"
34766,How to enable/disable oracle job using job id,"begin
  dbms_job.broken(23, true);
  commit;
end;
/
"
3169,Add Enum to a existing sql column,"ALTER TABLE org ADD COLUMN classify_aux ENUM('Arg', 'Agent','brand') NOT NULL;

UPDATE org SET classify_aux = classify;

ALTER TABLE org DROP COLUMN classify;

ALTER TABLE org ADD COLUMN `classify` ENUM('Arg', 'Agent','brand') NOT NULL;

UPDATE org SET classify = classify_aux;

ALTER TABLE org DROP COLUMN classify_aux;
"
14263,SQL: Comparing MAX Dates from Two different Tables,"SELECT u.GroupID, u.UserName, py.LastPaymentDate, at.LastAttendenceDate
FROM User AS u,
(SELECT Username, Max(AttendenceDate) AS LastAttendenceDate FROM Attendence GROUP BY Username) AS at,
(SELECT GroupID, Max(PaymetDate) AS LastPaymentDate FROM Payment GROUP BY GroupID) AS py
WHERE u.UserName=at.Username
AND u.GroupID=py.GroupID
AND py.LastPaymentDate < at.LastAttendenceDate;
"
28170,Oracle EBS R12 related,"select t.LINE_NUMBER || '.' || t.shipment_number line_number 
from oe_order_lines_all t 
WHERE T.HEADER_ID = &header_id;
"
28908,"SQL multiple values, table design","Table: Color
Columns: ColorId, ColorName
Primary Key: ColorId

// table for the many-to-many relationship
// between Colors and Phones
Table: PhoneColor
Columns: PhoneId, ColorId
Primary Key: (PhoneId, ColorId)
Foreign Key: PhoneId
Foreign Key: ColorId

Table: Phone
Columns: PhoneId, PhoneName, PhoneManfId
Primary Key: PhoneId
Foreign Key: PhoneManfId

Table: PhoneManf
Columns: PhoneManfId, PhoneManfName, PhoneManfAddress
Primary Key: PhoneManfId
"
15648,return multiple counts from single table,"SELECT SUM(homescore > awayscore) AS won,
   SUM(homescore < awayscore) AS lost,
   SUM(homescore = awayscore) AS tie
FROM ...
"
25150,Can't update table,"IF 1 > 0
BEGIN
UPDATE TABLE_A 
SET COLUMN_1 =299999 
WHERE COLUMN_2 ='2014-01-03'  and COLUMN_3=0
END
"
33884,SQL Server SELECT in JOIN,"SELECT i.CODE, SUM(QTY_SOLD) SALES, i.QTY_AVAILABLE, i.LOCATION
FROM INVENTORY i
    JOIN INVOICE_HISTORY ih ON i.CODE = ih.ITEMCODE
GROUP BY i.CODE, i.QTY_AVAILABLE, i.LOCATION
"
39054,How do I return all data for the previous month in SQL?,"SELECT     DOD
FROM       ZZZ_DEPARTURE_DATES
WHERE      DOD >= TRUNC(ADD_MONTHS(SYSDATE,-1),'MON')
AND        DOD < TRUNC(SYSDATE,'MON');
"
9645,How does a database read data change during the transaction?,"Page1: A,B,C,
Page2: D,E,F
Page3: G,H,I
"
18347,Viewing & adding PDF to database simultaneously,"
<cfdocument filename = ""c:/~"" ...> <!--- filename attribute to save to server --->
   #pageContent#
</cfdocument>

<cfquery ...>
    <!--- sql --->
</cfquery>

<!--- once your document is saved and database updated--->
<cflocation url = ""[your saved file].pdf""...>
<!--- or as Peter Suggested --->
<cfcontent type=""application/pdf"" file=""[your saved file].pdf"">
"
38743,Postgres query to find all dependent tables,"select 'pg_statistics'::regclass; -- 'pg_statistics'
select 2619::regclass;            -- 'pg_statistics' too, on my install

# select refclassid::regclass from pg_depend where classid = 'pg_class'::regclass group by refclassid;
  refclassid  
--------------
 pg_namespace
 pg_type
 pg_class
"
32536,SQL - How can I count days by comparing current row to the 1st row?,"select id, order_date, 
      (select min(order_date) from your_table) as first_date,
      datediff('day', (select min(order_date) from your_table), order_date) as days_to_date
from your_table
order by order_date
"
23875,How do you find if a unique pair value already exists in a sql table?,"begin try
    insert into t(a, b) values('a', 'b')
end try
begin catch
    print 'Oops! There was a problem, maybe a constraint violation for example'
end catch;
"
21909,join query on one-to-one Grails domain using GORM with parameters,"String filter = ""hachiko""
def hero = Hero.createCriteria().list {
    familiar {
        like('name', filter)
    }    
}
"
38998,ORDER BY a concatenated name in Oracle?,"ORDER BY office_name, ""Employee Name""
"
22485,How to create correct SQL statement in delphi,"ADOQuery1.SQL.Text := 'INSERT INTO [dbo].[client] ([Meno],[Priezvisko]) ' +
                      'VALUES(:Meno, :Priezvisko)';
ADOQuery1.Parameters.ParamByName('Meno').Value := Edit1.Text;
ADOQuery1.Parameters.ParamByName('Priezvisko').Value := Edit2.Text;
ADOQuery1.ExecSQL;
"
1470,SQL question: how to select arbitrary numbers of records in each record group?,"select *
from (
    select
        row_number() over (partition by uid order by UpdateDt desc) 
        as rn
    ,   *
    from YourTable
) sub
where rn <= 3
"
30642,"Get new row id, after insert query in sql","Dim dbs as DAO.Database
Dim TranID as Long
TranID = dbs.OpenRecordset(""Select @@Identity"")(0)
"
7877,Join via junction table with nullable field,"SELECT  d.*, c.*
FROM    d
JOIN    junction j
ON      j.d_id = d.id
LEFT JOIN
        
ON      c.id = j.c_id
"
31820,"How to get Next 4 digit number from Table (Contains 3,4, 5 & 6, digit long numbers)","SELECT MIN([Number]) AS next_number
FROM  LineNumbersNotUsed
WHERE
        [Number] > 999
    AND [Number] < 10000;
"
36699,SQL Group by date only choose 1 record,"SELECT TOP 1 MAX (CreateDate) AS Create_Date, Firstname ,EventID
FROM SessionsEvents
WHERE TRN='0391588'
GROUP BY Firstname , TRN, EventID
"
10239,Query from table based on some condition,"SELECT a.*
FROM   table1 a
       LEFT JOIN table2 b
           on a.column_1 = b.column_1
WHERE b.column_1 IS NULL
"
29029,Cannot insert character '' in SQL Server 2008,"update ruds_values_short_text 
set value = N' asjdklasd'
where rud_id=12202 and field_code='detection_limit'
"
39489,SQL JOIN based on table contents,"ColorPref
ColorPrefQuestion
Rating
RatingQuestion
"
24493,How to join two tables and replace null in second table with zero,"select A.orderNo, coalesce(B.Price, 0) as Price
from A left join
     B
     on A.ProdID = B.ProdID;
"
21136,"SQL JOIN 3 tables, unique rows, calculation across tables","SELECT Col1, SUM(Col2) as Col2
FROM
(
SELECT Col1, Col2
FROM Table1
UNION ALL
SELECT Col1, Col2
FROM Table2
UNION ALL
SELECT Col1, Col2
FROM Table3
) as sub
GROUP BY Col1
"
15467,Check rows for same entries in neighbouring columns,"SELECT a.id, a.col1, a.col2
  FROM tbl AS a
  JOIN tbl AS b ON 
      (     a.id=b.id
        AND (a.col1 =  b.col2 OR  a.col2 = b.col1)
        AND (a.col1 != b.col1 AND a.col2 != b.col2)
      )
"
22358,Retrieve count of related records,"select count(*) as cnt
from member m
where m.trainerid = @TheTrainerId;
"
12431,SELECT inside SELECT statement returns 0 count,"select
count(distinct concat(date_reserve, ' ', start_time)) as my_count,
date_reserve,borrowerID,start_time,end_time
from
schedule
where borrowerID = 'bobi'
"
31252,Select from union tsql,"SELECT A
FROM
(
    SELECT A, B FROM TableA
    UNION
    SELECT A, B FROM TableB
) AS tbl
WHERE B > 'some value'
"
7163,SQL Relational query Help Student Do Sport,"SELECT * FROM Sport  s
WHERE NOT EXISTS(SELECT * FROM Student_Sport st WHERE st.sportId = s.sportId AND st.name IN('Captain', 'Vice Captain'))

SELECT * FROM Sport  s
LEFT JOIN Student_Sport st ON st.sportId = s.sportId AND st.Capacity IN('Captain', 'Vice Captain')
WHERE st.sportId IS NULL
"
5718,Deleting duplicate rows from sqlite database,"delete   from YourTable
where    rowid not in
         (
         select  min(rowid)
         from    YourTable
         group by
                 hash
         ,       d
         )
"
27460,Left Outer Join not working as expected,"ON Users.idUser = Timesheets.id_User
   AND Timesheets.EndDate = CONVERT(DATETIME, '2014-08-15 00:00:00', 102)
"
21459,"Group_concat, joining a column into a row, if other columns are equal","GROUP BY categories.name, color_variant.pcode, color_variant.price 
"
18988,convert date to integer in postgresql,"select date '2011-11-01' - date '1900-01-01'
"
9093,Merge Result Set from Different Query in SQL,"SELECT DISTINCT HighEnd AS CombinedSets FROM Chipset
UNION
SELECT DISTINCT LowEnd AS CombinedSets FROM VideoCard
"
14484,how to implement nested comment system using redis efficiently,"Article (
  id INT,
  name TEXT,
  body TEXT
)

Comment (
  id INT,
  article_id INT,
  parent INT,
  author TEXT,
  body TEXT
)
"
39335,SQL Server Cursor,"DECLARE db_cursor CURSOR FOR SELECT name, age, color FROM table; 
DECLARE @myName VARCHAR(256);
DECLARE @myAge INT;
DECLARE @myFavoriteColor VARCHAR(40);
OPEN db_cursor;
FETCH NEXT FROM db_cursor INTO @myName, @myAge, @myFavoriteColor;
WHILE @@FETCH_STATUS = 0  
BEGIN  

       --Do stuff with scalar values

       FETCH NEXT FROM db_cursor INTO @myName, @myAge, @myFavoriteColor;
END;
CLOSE db_cursor;
DEALLOCATE db_cursor;
"
4650,How to migrate data between MySQL bases on different servers?,"INSERT INTO T2 
(ID, Name, UserID) 
SELECT id, SUBSTR(title, 0, 100), uid 
FROM T1
"
11949,Zend merge 2 SQL statements in nested array,"$jsonArray = array();
foreach ( $results as $result ) {
    $jsonArray[] = array( 'personal_data' => array(
        'id' => $result->id,
        'name' => $result->name,
        'street' => $result->street,
        ...
    ));
}

return $jsonArray;
"
34684,"Oracle - single-row subquery returns more than one row , Need to fetch all the rows","select * from  sampleTable
             where 
             status = 'A' 
             and SUBSTR(some_code_column, 1, 4)  = 9999
"
36987,SQL simple SUBSELECT,"SELECT parent.DogKind_id, parent.Day_Id
FROM FooBar AS parent
INNER JOIN (
    SELECT DogKind_Id, MAX(FoodQuantity) AS Max
    FROM FooBar
    GROUP BY DogKind_Id
) AS child ON (parent.DogKind_Id=child.DogKind_Id) AND (parent.FoodQuantity = child.Max)
"
31359,Help with sql query,"SELECT city.name, citizen.name, citizen.age 
FROM citizen
JOIN city ON city.id_city = citizen.id_city
ORDER BY citizen.name <> 'some_name', citizen.age
"
36992,Add multiple values in table's column against specific id,"create table T (
    ID char(8) not null,
    /* other columns */
    constraint PK_T PRIMARY KEY (ID)
)

create table PhoneNumbers (
    ID char(8) not null,
    PhoneType varchar(12) not null,
    Number varchar(15) not null,
    constraint PK_PhoneNumbers PRIMARY KEY (PhoneNumbers,PhoneType),
    constraint CK_PhoneNumber_Types CHECK (PhoneType in ('Home','Work','Mobile')),
    constraint FK_PhoneNUmbers_T FOREIGN KEY (ID) references T(ID)
)
"
29810,MySQL: Update all rows in 2 table matching results of another query,"UPDATE T1
SET ID = T2.Value
FROM    Table_1 AS T1
    INNER JOIN Table_2 AS T2 ON T1.ID = T2.post_id
WHERE
    T2.pos_key = 'E_key'

UPDATE T2
SET post_id = NewIDs.Value
FROM    Table_2 AS T2
    INNER JOIN Table_2 AS NewIDs ON T2.post_id = NewIDs.post_id
WHERE
    NewIDs.pos_key = 'E_key'
"
12575,How to only get records under a certain column,"SELECT id
FROM dbo.Products
"
39326,Oracle database table creation,"create table abc.demo (c1 varchar2(10));
"
26850,"Crystal Reports - side by side details from actual and last year, using UNION ALL","select   
    ...
    ,[Date]
    ,CASE 
        WHEN YEAR([Date]) = YEAR(GETDATE()) - 1
        THEN 1
        ELSE 0
    END as [IsLastYear]
into #myTempTbl
from RowsDocs
"
21365,Delete rows that already appear in table,"Select 
id,user,col1,col2,.... 
from the Table_name
group by 
id,user,col1,col2,.... 
"
36954,Create an specific index,"update  YourTable
set     idx =
        case
        when path like '%least travelled%' then 1
        when path like '%highway%' then 2
        else 3
        end
"
11237,Rebuild Index in SQL Only On One Table,"ALTER INDEX ALL ON mySchema.myTable REBUILD
"
14814,"SQL Homework - ""IN"" Subquery","SELECT
   CustomerNum, CustomerName, StateProv
FROM
   tblCust
WHERE StateProv IN(SELECT StateProv FROM tblState WHERE StateProvDesc LIKE 'co%')
"
9197,Oracle SQL MINUS on 3 tables,"SELECT c.clientid, c.clientname
  FROM booking b JOIN client c
    ON b.clientid = c.clientid JOIN motel m
    ON b.motelid = m.motelid
 WHERE m.motelname = 'MotelOne'
MINUS
SELECT c.clientid, c.clientname
  FROM booking b JOIN client c
    ON b.clientid = c.clientid JOIN motel m
    ON b.motelid = m.motelid
 WHERE m.motelname = 'MotelTwo'
"
18806,"Oracle SQL help counting the same thing two different ways, but with common grouping","SELECT t1.closure_date, COUNT(t1.incident_id)
     , ( SELECT COUNT(t2.incident_id) FROM incident_table t2
          WHERE t2.status = 'open'
            AND t2.raised_date < t1.closure_date )
  FROM incident_table t1
 WHERE t1.closure_date IS NOT NULL
   AND t1.status = 'closed'
 GROUP BY t1.closure_date
"
33909,"Select From Table with Multiple Rows for some ID's, with an identifier value","select distinct id, 
  case when count(location) over (partition by id ) > 1 
    then 'Multiple' else location end Location
from yourtable
"
34078,retreive resultset based on where clause condition order in sql server,"SELECT * FROM MyTable WHERE ColID IN ('C', 'A', 'D') 
   ORDER BY 
      CASE ColID 
         WHEN 'C' THEN 0 
         WHEN 'A' THEN 1 
         ELSE 2 
      END
"
32983,Simple inner join not working,"SELECT SUM(CITY.POPULATION)
FROM COUNTRY
JOIN CITY
ON COUNTRY.CODE = CITY.COUNTRYCODE
WHERE COUNTRY.CONTINENT = ""Asia"";
"
25243,Combine a SELECT and a UNION ALL,"SELECT A.idA, A.idB, COALESCE(B1.Value, B2.Value)
FROM tableA A
WHERE idA = 1;
LEFT JOIN TableB1 B1 ON B1.idB = A.idB
LEFT JOIN TableB2 B2 on B2.idB = A.idB
"
22994,"SPIP API SQL, left join on a custom table","CREATE TABLE IF NOT EXISTS `spip_random` (
  `id_random` bigint(21) NOT NULL AUTO_INCREMENT,
  `objet` varchar(25) NOT NULL,
  `id_objet` bigint(21) NOT NULL DEFAULT '0',
  `type` text NOT NULL,
  `date_picked` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  PRIMARY KEY (`id_random`),
  KEY `objet` (`objet`,`id_objet`),
  KEY `id_random` (`id_random`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1;
"
19775,How to correctly do SQL UPDATE with weighted subselect?,"Update recipes
Set relevance =
(
  Select   Case When ingredients Like '%milk%' Then 1 Else 0 End
         + Case When ingredients Like '%flour%' Then 1 Else 0 End
         + ...
  From recipes r2
  Where r2.recipe_id = recipes.recipe_id
)
"
19263,mysql group by one field and order by another,"SELECT oid, pvalue FROM report
JOIN (SELECT oid, MAX(date) AS maxDate FROM report r WHERE `deviceid` = 'MRA-1011'
AND `date` <= '2012-01-20 00:00:00' GROUP BY oid) AS foo
ON foo.oid=r.oid AND foo.maxDate = report.date;
"
12189,XML transformation with xsl and DB query,"ResultSet rset = stmt.executeQuery();
OracleResultSet orset = (OracleResultSet) rset;
XMLType qRes = XMLType.createXML(orset.getOPAQUE(1));
"
11313,How do I escape reserved words used as identifier in Informix,"DELIMIDENT 
When set to Y, specifies that strings set off by 
double quotation marks are delimited identifiers
"
19281,Simple SQL Problem,"select  ssn, name
from    YourTable a
where   organisation = 'Finance'
        and exists
        (
        select  *
        from    YourTable b
        where   organisation = 'IT'
                and a.ssn = b.ssn
                and a.name <> b.name
        )
"
24899,SQL Server refactor a column from varchar(50) to uniqueidentifier and surrounding issues,"CREATE NONCLUSTERED INDEX [IX_message_external_id] ON [dbo].[message] 
(
    [external_id] ASC
)
INCLUDE ( [message_id],
[message_type_id],
[message_status_id],
[template_id],
[user_id],
[raw_message_body]) WITH (SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF) ON [PRIMARY]
"
28632,making an update query through a subquery using ROW_NUMBER()?,"MERGE INTO table_name t
USING ( SELECT rowid rid, row_number() OVER (order by sequence_job_day) rn FROM table_name ) u
ON ( t.rowid = u.rid AND t.column_pearson_id = 888 )
WHEN MATCHED THEN UPDATE SET t.column_update = u.rn;
"
3610,Specific Ordering in SQL,"order by case when department = 'Electronics' then 1
              when department = 'Automotive' then 2
              when department = 'Sports' then 3
              when department = 'Clothing' then 4
              else 5 end 
"
30559,SQL Server - only join if condition is met,"INSERT INTO GroupToItem(GroupID, ItemID)
SELECT  g.ID,
        i.ID,
FROM    Group g
JOIN    Item i ON i.Val IN g.Range
WHERE   g.ID = @GroupID
and (g.ID in (3) or exists (select top 1 1 from GroupToItem gti where g.Parent = gti.GroupID AND i.ID = gti.ItemID))
"
31863,Remove double join results from query,"select *
from tblTagGlass ttg
inner join tblTagGlass ttgC ON
ttg.JobID = ttgC.JobID
AND ttg.PartCode = ttgC.PartCode
where (ttg.TagHeight != ttgC.TagHeight OR ttg.TagWidth != ttgC.TagWidth)
AND ((ttg.TagHeight >= ttgC.TagHeight AND ttg.TagWidth >= ttgC.TagWidth) 
    OR (ttg.TagHeight > ttgC.TagHeight AND ttg.TagWidth < ttgC.TagWidth))
order by ttg.PartCode
"
4619,TSQL Dynamic Query,"        IF @awardEmployees IS NOT NULL
             SET @Where = @Where + ' AND A.[employee] IN (' + stuff(
          (
            select ','+QUOTENAME(ParamValues.x2.value('@empID[1]', 'VARCHAR(60)'), '''')
            FROM @awardEmployees.nodes('/employees/employee') AS ParamValues(x2)
            for xml path(''),type
          ).value('.','varchar(max)'),1,1,'') + ')'
"
16885,Checking if a string is found in one of multiple columns in mySQL,"SELECT * FROM tblClients
WHERE (name LIKE '%john%')
OR (surname LIKE '%john%')
"
23105,How do I Alter an attribute to change its datatype in Object type?,"ALTER TYPE MY_TYPE
  MODIFY ATTRIBUTE SOME_ATTRIBUTE NUMBER;
"
33303,Import Large SQL File,"mysqlimport -uYOU -p --lock-tables --lines-terminated-by=""\r\n"" --fields-terminated-by=""\t"" YOUR_DB name_same_as_table.txt
"
12661,"What's the difference between ""LIKE"" and ""="" in SQL?","create table t1 ( c10 char(10) );
insert into t1 values ('davyjones');

select * from t1 where c10 = 'davyjones';
-- yields 1 row

select * from t1 where c10 like 'davyjones';
-- yields 0 rows
"
34516,Check if Text Data is in Date Format,"select t.*
from t
where Remarks regexp '^[0-9]{4}-[0-9]{2}-[0-9]{2}$'
"
33203,SQL query to get all the combinations of two columns,"SELECT Flag1, Flag2, COUNT(GeneId) as NumGenes
FROM genetable
GROUP BY Flag1, Flag2
"
1760,How to use count(*) and Division Operation in SQL statements,"select ( count(*)/20000.0 ) from table
"
20646,Any way I could optimize this SQL statement?,"SELECT * FROM `earnfrom` 
    join `users` on `users`.`id` = `earnfrom`.`userid` 
    left join (select `earnid` from FROM `earnedby` WHERE `userid`= ?) sub ON sub.`earnid`=`earnfrom`.`userid`
WHERE (
        `active` = ? AND `type` = ?
)
AND `curdaily` <= `dailyclick` 
AND `clicks` <= `totalclick` 
AND sub.`earnid` is NULL
AND `userid` != ? AND  `users`.`points` >= `cpc` 
ORDER BY `cpc` DESC, RAND()"")
"
954,How to get repeated value in group,"SELECT MIN(`obsid`) AS `obsid`, `Name`, `Value`, COUNT(*) AS Value_occurrence             
FROM yourtable
GROUP BY `Name`, `Value`
"
38758,integrity constraint violated - parent key not found even when row exists in parent table,"SELECT * FROM user_constraints 
  WHERE WHERE table_name='<your_table_name>';

SELECT * FROM user_cons_columns 
  WHERE table_name='<your_table_name>';
"
20311,Convert row record to column for each emp using sql,"select person_number, home_number as PHONE_number, 'H' from tb_phone
UNION ALL
select person_number, mobile_number, 'M' from tb_phone
UNION ALL
select person_number, work_number,   'W' from tb_phone
"
12636,sql to calculate daily totals minues the previous day's totals,"SELECT o.report_date, o.tech, o.total_cpe, 
o.total_cpe -  (
    SELECT  IIf(Sum(oos.total_cpe) is null, 0,Sum(oos.total_cpe)) AS total_cpe 
    FROM oos 
    WHERE (((oos.tech)=o.tech) AND ((oos.report_date)<o.report_date))
) AS total
FROM oos o;
"
39694,Getting unwanted rows with LIKE in SQL,"SELECT
CompanyName
FROM Customers
WHERE CompanyName LIKE '[A/B]%[S/P]'
"
34239,find minimum of one variable and matching values of other variables in SQL,"Select v1, v2, v3 from test a
where (select min(v2)
from test b
where a.v1 = b.v1) = v2;
"
6841,SQL Server Query with count returns null or no result,"SELECT Centre.Centre_Name, Count(Shop_No) AS shopcount 
FROM Centre 
    LEFT JOIN Space ON Centre.Centre_Name = Space.Centre_Name 
GROUP BY Centre.Centre_Name
"
20434,SQL select the first and the last row based on another column (timestamp),"select A.Time, A.UserID, A.Data from yourtable A
join 
(
SELECT   UserID, MIN(Time) AS Min_Time, MAX(Time) AS Max_Time
FROM     yourtable
GROUP BY UserID
) B 
ON a.UserID = B.UserID
and A.time in (B.Min_Time, B.Max_Time) -- (A.time =B.Min_Time or A.time =B.Max_Time)
"
33368,Oracle JDBC ignoring SET CONSTRAINTS ALL DEFERRED in CONCUR_UPDATABLE ResultSet,"SELECT constraint_name, table_name, DEFERRABLE 
FROM all_constraints 
WHERE owner = 'myschema' 
  AND table_name = 'THE_TABLE';
"
4805,Using GROUP_CONCAT on subquery in MySQL,"SELECT
    items.name,
    items.color,
    CONCAT(favourites.userid) as idlist
FROM
    items
INNER JOIN favourites ON items.id = favourites.itemid
WHERE
    items.id = $someid
GROUP BY
    items.name,
    items.color;
"
36450,DB : perform an update query after a fetch one inside a transaction,"OPEN CURSOR

UPDATE table set col = :new_value
WHERE id = :id_from_cursor
last_updated = :last_updated_from_cursor;

CHECK if update row count == 1 COMMIT
IF not throw exception
"
18948,"oracle get the char of the longest charsequence from a ""characterlist"" in select","select character
from 
    (
    select character, count(1)
    from 
        (
        select substr('111122333334458888888888', level, 1) as character
        from dual
        connect by level <= length('111122333334458888888888')
        )
    group by character
    order by 2 desc    
    )
where rownum = 1
"
19942,SQL - select selective row multiple times,";WITH recurs AS (
  SELECT *, 1 AS LEVEL
  FROM tblContact
  UNION ALL
  SELECT t1.*, LEVEL + 1
  FROM tblContact t1
  INNER JOIN
  recurs t2
  ON t1.addressnum = t2.addressnum
  AND t2.labelsnum > t2.LEVEL
 )

SELECT *
FROM recurs
ORDER BY addressnum
"
34440,How do i do this simple SQL SELECT statement?,"select sno
    from spj
    where pno in ('P2','P4')
    group by sno
    having count(distinct pno) = 2
"
25179,Table design for cyclic dates,"CREATE TABLE availability_rules (
  id SERIAL UNIQUE,
  user_id NOT NULL REFERENCES users(id),
  day_of_week INTEGER CONSTRAINT valid_day_of_week CHECK (day_of_week BETWEEN 0 and 6)
  start_time TIME,
  start_date DATE,
  end_time TIME,
  end_date DATE
);
"
8878,Creating a View that returns the first occurrence of a value,"create view theview as
select 
  t1.s_id, min(dt) dt
from  
  table1 t1 inner join 
  table2 t2 on t1.s_id = t2.s_id
group by 
  t1.s_id
"
3544,Looping through a SQL QUERY record result from a Temp Table and Updating another table based on SQL QUERY results," Update TestTable set UserId = #Temptable.LikeId
     from TestTable as test
    inner join  #Temptable on  #Temptable.UserId = test.UserId
"
25187,MySQL Joining tables and pulling information to check,"SELECT Item_Type, COUNT(*) as theAmount, Session_date
FROM  Item
left outer join Order 
    on Item.Order_id = Order.Order_id
left outer join Session 
    on Order.Session_id = Session.Session_id
GROUP BY Item_Type
ORDER BY theAmount desc
LIMIT 10
"
35101,Ruby on rails count and group,"SELECT i.product_id
      ,p.name
      ,sum(i.quantity) AS sum_quantity
FROM   orders o
JOIN   items i ON i.order_id = o.id 
LEFT   JOIN product p USING (product_id)
WHERE  o.client_id = 2 
GROUP  BY 1,2
ORDER  BY 3 DESC, 2 -- with same quantity, order by name
LIMIT  10;
"
8952,Storing parameterized definitions of sets of elements and single pass queries to fetch them in SQL,"      SetId              Set
______________________________________
10                       1,4,5,6
11                       2,3
12                       null
"
11877,Average balance query in Oracle SQL,"select custcity, avg(custbal) as AvgBal
from rchamart.customer
where custstate = 'WA'
group by custcity;
"
32154,Create a WHERE OR IN postgres,"WHERE (SELECT id FROM users 
       WHERE email = 'dharness.student@gmail.com') 
   IN (user_b_id , user_a_id)
"
2199,How make sum using some conditions in sql?,"SELECT
ID,
[Date],
Value,
Total = Value + COALESCE(
(
    SELECT SUM(Value)
        FROM TableName AS s
        WHERE s.[Date] < o.[Date] AND s.Id=o.Id), 0
)
FROM TableName AS o
ORDER BY [Date];
"
22273,Know if a date is from today in Oracle,"SQL> SELECT
  2    CASE
  3      WHEN TRUNC(to_date('01/03/2016 09:40:35', 'dd/mm/yyyy hh24:mi:ss')) = TRUNC(SYSDATE)
  4      THEN 'Today'
  5      ELSE 'Not Today'
  6    END date_check
  7  FROM dual;

DATE_CHECK
----------
Today

SQL>
"
11127,SQL Multiple Groups - It's possible?,"SELECT e.date,
    SUM(CASE WHEN e.client = 0 THEN e.size ELSE 0 END) as CLI0-SIZE,
    SUM(CASE WHEN e.client = 1 THEN e.size ELSE 0 END) as CLI1-SIZE,
    SUM(CASE WHEN e.client = 2 THEN e.size ELSE 0 END) as CLI2-SIZE,
    SUM(CASE WHEN e.client = 3 THEN e.size ELSE 0 END) as CLI3-SIZE
FROM entries AS e
GROUP BY e.date
"
20459,Optimizing Large Number of Update Queries,"UPDATE tests
SET score = 100
WHERE TestID IN (1,2,10,1000);

UPDATE tests
SET score = 99
WHERE TestID IN (8,12,46,2000);
....
"
5030,Get a row by particular category SQLite android,"SELECT * FROM itemsDataTable WHERE category LIKE 'ELETRONIC'
"
1246,Get information about table valued function,"SELECT * 
FROM INFORMATION_SCHEMA.ROUTINE_COLUMNS 
WHERE TABLE_NAME = 'YourTableValuedFunctionName'
"
2891,plsql advanced or condition,"SELECT ""ID"", postcode, numbertype, minnumber, maxnumber
  INTO huidigPostcodeID_FK, databasePostcode, databaseNumberType, databaseMinNumber, databaseMaxNumber
  FROM (
    SELECT ""ID"", postcode, numbertype, minnumber, maxnumber
         , ROW_NUMBER() OVER ( PARTITION BY postcode ORDER BY DECODE(numbertype, 'mixed', 0, 1) ) AS rn
      FROM postcode
     WHERE postcode_id = 79417568 AND (numbertype = 'odd' OR numbertype = 'mixed')
) WHERE rn = 1
"
8160,SQL: Looking up the same field in one table for multiple values in another table?,"SELECT F.bar_id1, 
    (SELECT bar_desc FROM Bar B WHERE (F.bar_id1 = B.bar_id)),
    F.bar_id2, 
    (SELECT bar_desc FROM Bar B WHERE (F.bar_id2 = B.bar_id)),
    F.other_val
FROM FOO F;
"
15098,Access query to partition data and sum each partition?,"SELECT Table1.Dte, Int(([tme]-1)/100) AS Hr, Sum(Table1.Val) AS TotVal
FROM Table1
GROUP BY Table1.Dte, Int(([tme]-1)/100);
"
37403,Table type of variable returning blank cells after update sql 2008,"DECLARE @CompletedTotalValues TABLE (CMedian INT, CPerc INT);
INSERT @CompletedTotalValues (CMedian, CPerc)
SELECT  CMed = dbo.median(CASE WHEN cr.Priority = 1 THEN cr.Days END),
        CPerc = dbo.Percentile90(CASE WHENn cr.Priority = 1 THEN cr.Days END)
FROM    A 
        INNER JOIN B ON b.Id = a.Id
WHERE   b.StatusId = 3;
"
24323,not exists in the same table,"SELECT test_name
FROM tests 
WHERE version='ie7' 
AND test_name  NOT In (SELECT test_name FROM tests where version='ie8');
"
6710,Do indexes work in NOT IN or <> clause?,"Ind  col1 col2
 1    A    1
 2    A    1
 3    A    1
 4    A    2
 5    B    1
 6    B    1
 7    B    2
 8    B    3
 9    B    3
10    C    2
11    C    3
"
39676,How can make auto change in SQL Server,"UPDATE <tablename> SET
       IsPremium = 1
WHERE  [expires date] < GETDATE()
"
28824,Using select query for between where clause,"DECLARE @StartDate DATETIME,
        @EndDate DATETIME
SELECT @StartDate = month_start
       , @EndDate = month_end
FROM sales_month
WHERE [month] = 2 AND [year] = 2013

SELECT *
from member
where effective_date BETWEEN @StartDate AND @EndDate
"
31734,Selecting Account Numbers with latest date,"select s.*
from (select s.*,
             row_number() over (partition by customer, bankId order by date desc) as seqnum
      from stat s
     ) s
where seqnum = 1;
"
22874,Conversion failed when converting the varchar value to data type int while incrementing,"DECLARE @counter INT = 0

UPDATE TestTable
SET test_person = 'Test' + CAST(@counter AS VARCHAR(16)), @counter = @counter + 1
"
11765,Use of OUTER JOIN AND OR operators together,"SELECT A.ID_NO,A.NAME B.APPL_STATUS 
FROM PERSON A LEFT JOIN FORM_DETAILS B ON A.ID_NO=B.ID_NO
WHERE
B.APPL_DATE BETWEEN '12/07/2009' AND '12/09/2009' AND
(B.STATUS = 'A' OR
B.STATUS = 'C')
ORDER BY APPL_DATE
"
3825,Round Function return only two decimals,"SELECT          
    ROUND( CONVERT(DECIMAL,SUM(colors))/CONVERT(DECIMAL,COUNT(DISTINCTid)), 2) AS AVG_CONTACTS_VISITS_PER_MONTH
from a
"
5769,oracle partition active condition on table,"SELECT * FROM all_tab_partitions@your_dblink_name WHERE table_name = 'TRACK_TABLE';
"
22219,select those event that came on same day from table which contain date column in milliseconds?,"select event_id,
       event_title,
       datetime(event_date_in_milli_sec / (24 * 60 * 60 * 1000)) as dt
from table_events
order by dt
"
33341,Oracle Date subtraction with SQLLDR,"to_date(:END_TIME, 'dd/mm/yyyy hh:mi:ss AM')
- substr(:elapsed_time, 1, instr(:elapsed_time, ':') - 1) / 24
- substr(:elapsed_time, 
         instr(:elapsed_time, ':') + 1,
         instr(:elapsed_time, ':', 1, 2) - instr(:elapsed_time, ':') -1) / 24 / 60 
- substr(:elapsed_time, instr(:elapsed_time, ':', 1, 2) + 1) / 24 / 60 / 60
"
23143,Delete MySQL column index without knowing its name,"SELECT DISTINCT INDEX_NAME, TABLE_NAME, TABLE_SCHEMA FROM information_schema.STATISTICS;
"
5732,"MySQL: Code To Compare 2 Tables, Then If row is the same update Master Date","update master m inner join newdata n on n.code=m.code set m.validated_date = now()
"
31624,How to determine the hostname in Oracle APEX?,"function call                    |  result
---------------------------------|-----------------------------------
APEX_UTIL.HOST_URL()             |  http://example.com:5883
APEX_UTIL.HOST_URL('SCRIPT')     |  http://example.com:5883/pls/apex/
APEX_UTIL.HOST_URL('IMGPRE')     |  http://example.com:5883/i/
"
2265,"query with date_part, how to get sub_query to play along?","Select  date_part('Day', t.timestamp) as day_of_month, 
    Count(id) total, 
    sum(case when text_string_column Like '%keyword%' then 1 else 0 end)
From    the_table   t 
Group By date_part('Day', t.timestamp) 
Order By date_part('Day', t.timestamp) Desc
"
18495,Joining another database into SQL query,"LEFT JOIN T2Ddata.dbo.tblContacts c ON c.id = e.ContactId)
"
23610,How to compare smalldatetime in stored procedure,"select @ID=ID 
  from info_user
 where Name = @Name
   and cast (UpdateTime as Date) = Cast(@TestTime as Date)
"
6485,How to select a value with a column name that also needs selected?,"SELECT [key], val, col
FROM 
  (SELECT [key], a, b, c, d, e, f
   FROM table1
   WHERE [key] = @var2) AS src
UNPIVOT
   (val FOR col IN 
      (a, b, c, d, e, f)
)AS unpvt
WHERE col = (SELECT value FROM table2 WHERE id = @var1)
"
33602,Match groups in Oracle 10g2 regular expressions,"...
fOccurence := 0;
loop
  fSubstr := regex_substr(fSourceStr, '<image>.*?<type>(.+?)<\/type>', 1, fOccurence, 'gci');
  exit when fSubstr is null;
  fOccurence := fOccurence + 1;
  fResultStr := fResultStr || fSubstr;
end loop;
...
"
9424,Selecting rows from a table depending on keywords in another table,"declare @params table (Keyword varchar(6) primary key)

insert into @params
select 'House' union all
select 'Garden'

select
    b.Name
from Keywords as k
    inner join Buttons as b on b.ID = k.ButtonID
where k.Keyword in (select Keyword from @params)
group by b.Name
having count(*) = (select count(*) from @params)
"
9354,Selecting all bi-directional connection in a Table,"select A.* from connections A
inner join connections B on (A.startnode=B.endnode and A.endnode = B.startnode)
"
5766,select sum of a column between two dates,"SELECT DATEADD(dd, 0, DATEDIFF(dd, 0, p_date)) [date],
       SUM(p_amount) [sum]
  FROM tbl_Payments
 WHERE DATEADD(dd, 0, DATEDIFF(dd, 0, p_date)) BETWEEN '20130701' AND '20130731'
 GROUP BY DATEADD(dd, 0, DATEDIFF(dd, 0, p_date))
"
4347,passing a parameter into a subquery,"select cataloguenumber, productname,  shipping.carriagecost as carriagecost 
from products, shipping 
where shipping.carriageweight = products.weight
"
8217,"Sort the order of ""ORDER BY"" query","SELECT 
   TICKET_ITEM_ID, 
   TICKET_ITEM_DESC 
FROM ticket_item
INNER JOIN menu_category ON menu_category.CATEGORY_NAME=ticket_item.TICKET_PRINT_CAT
WHERE 
   ticket_item.TICKET_ID = 1 
GROUP BY TICKET_PRINT_CAT
ORDER BY menu_category.BUTTON_SORT
"
28483,MySQL Query Complex Relationship of One Way Linking,"SELECT post.post_id, website.website_id
FROM test_posts post
  JOIN test_posts website ON website.website_id NOT IN
(
  SELECT sl.website_id
  FROM test_posts f
    INNER JOIN test_smartlink_to_websites sl ON f.post_id = sl.post_id
  WHERE f.post_id = post.post_id
)
ORDER BY post_id
"
14848,Reformatting MySQL table as grid,"select token, group_concat(concat(iso,'|',content)) as contents
from translations
group by token
"
28976,Query regarding SQL Insert in SQL Server?,"INSERT INTO dbo.tblFiles(FileName, FileContent)
OUTPUT inserted.ID
VALUES ('yourfile.name', 'your contents')
"
20846,SQL: how to get sunday of current week,"SET DATEFIRST 1

Select DATEADD(DAY , 7-DATEPART(WEEKDAY,GETDATE()),GETDATE()) AS 'Last Day Of Week' 
"
37618,Adding a character to every row in a MySQL database,"UPDATE the_table t 
SET the_column = 
    CONCAT('/', the_column )
"
6472,How do I difference time in MySQL query?,"SELECT TIME_TO_SEC(TIMEDIFF(now(),time)) AS time FROM myTable;
"
9669,"Oracle Query with ""&"" special character","select <field> from <table> where field = 'ABC' || '&' || 'D';
"
38318,"In Teradata, with SQL, how do I compare multiple dates and select the latest date?","select *
from tab
QUALIFY -- similar to HAVING after GROUP BY
   row_number() -- or RANK to return multiple rows with the same (max date & status)
   over (partition by id 
         order by date desc, status) = 1
"
11957,Which datatype for flag?,"`status` tinyint(1) unsigned NOT NULL DEFAULT '0'
"
31404,Oracle Analytic Preceding Returns wrong/unanticipated results,"(ORDER BY WEEK RANGE BETWEEN INTERVAL '91' DAY PRECEDING AND INTERVAL '1' DAY PRECEDING)
"
9970,SQL: Move records agreeing on both conditions on top,"select *
from t
where CompanyId = 333 or CompanyName = 'Name1'
order by (case when companyId = 333 and CompanyName = 'Name1' then 1
               else 0
          end) desc
"
16514,"Using ""Is Null"" as a criteria based on a form","SELECT t.atext
FROM Table1 t
WHERE IsNull([atext])=[Forms]![Reports]![Status - Null]
"
8573,Select the first 3 rows of each table in a database,"DECLARE @sql VARCHAR(MAX)='';
SELECT @sql=@sql+'SELECT TOP 3 * FROM '+'['+SCHEMA_NAME(schema_id)+'].['+name+']'+';'
  FROM sys.tables
EXEC(@sql)
"
14067,Fetching records using query in batches from db2,"SELECT col1,col2 FROM 
   ( SELECT ROW_NUMBER() OVER (ORDER BY col2) AS rowNum, col2, col1 
     FROM  <schema>.table1) AS tab 
WHERE rowNum between 1 and 500
"
39918,LEFT JOIN missing values from the right table,"(newTable2.`X` = oldTable.`X` OR (newTable2.`X` IS NULL AND oldTable.`X` IS NULL))
"
19719,insert 2 select sql result into one insert sql,"insert into access (""user"", page) values
(  (select id as user from users where id =5),
   (select pagename as page from pages where id =10)
)
"
20277,Group data on weekly basis,"select
    DATEADD(week, DATEDIFF(week,0,data), 0) as Monday,
    sum([count]) as [count]
from
    yourtable
group by
    DATEADD(week, DATEDIFF(week,0,data), 0)
"
18592,Join two table. One column using SUM,"SELECT p.product_id, p.product_name, SUM(wp.quantity) as quantity 
FROM product as p 
LEFT JOIN warehouse_product as wp 
ON p.product_id = wp.product_id 
AND product_active = 1
GROUP BY p.product_id, p.product_name
"
13063,Sorting different rows based on multiple conditions,"SELECT *
FROM (SELECT *
      FROM Contacts
      ORDER BY priority DESC
      LIMIT 20)
UNION ALL
SELECT *
FROM (SELECT *
      FROM Contacts
      WHERE ID NOT IN (SELECT ID
                       FROM Contacts
                       ORDER BY priority DESC
                       LIMIT 20)
      ORDER BY name)
"
1104,Filter SQL table with max record within two specific dates range,"SELECT EmployeeName, TargetTxDate, sum(ActualTarget) as Actual, sum(RequiredTarget) AS ReqTarget, sum(variance) AS Variance 
FROM dbo.TargetsTx as TargetsTx
WHERE TargetTxDate >= @BgnDate
AND TargetTxDate < @EndDate
group by EmployeeName,TargetTxDate
ORDER BY TargetTxDate DESC
LIMIT 1
"
24475,"How to ""default"" a column in a SELECT query","select 
   a, b, c, d 
  from t 
 where a = :IN_A 
   and b = :IN_B 
   and c in (:IN_C,'  ') 
order by 
   case c when '  ' then 2 else 1 end 
fetch first 1 row only
"
20228,postgresql join on max(date) and another index,"select t2.*, t1.restock_date,
       (t1.restock_date - t2.analysis_date) as diff
from table2 t2 left join lateral
     (select t1.*
      from table1 t1
      where t2.part = t1.part and t2.analysis_date <= t1.restock_date
      order by t1.restock_date
      limit 1
     ) t1;
"
19138,LIMIT and JOIN order of actions,"SELECT ..
  FROM (SELECT ..
          FROM TABLE1 T1
          JOIN TABLE2 T2 ON ..
         LIMIT 10) X
  JOIN OTHERTABLE Y
 LIMIT 20;
"
30018,SQL Outer Join on multiple summed columns in same table,"SELECT SA_ID,
SUM(CASE WHEN LAYER = 1 THEN Number_of_Minutes ELSE 0 END) AS LAYER_1, 
SUM(CASE WHEN LAYER = 2 THEN Number_of_Minutes ELSE 0 END) AS LAYER_2,
SUM(CASE WHEN LAYER = 3 THEN Number_of_Minutes ELSE 0 END) AS LAYER_3,
SUM(CASE WHEN LAYER = 4 THEN Number_of_Minutes ELSE 0 END) AS LAYER_4
FROM Appt
GROUP BY SA_ID
"
5911,How to get the value of related rows?,"SELECT x.subject
     , y.id IS NOT NULL has_accepted
  FROM qanda x
  LEFT
  JOIN qanda y
    ON y.related = x.id
   AND y.type = 1
   AND y.acceptedanswer = 1
  JOIN qanda z
    ON z.related = x.id
 WHERE x.type = 0 
   AND z.id = 5;
"
37256,How to store the result of a query into an sql variable,"select * from city a 
where not exists 
(select 1 from city b where b.from_city=a.to_city and b.to_city = a.from_city
)
"
39720,Get a limited number of rows for each match in Postgres,"select nr, col1, col2, col3
from (
  select nr, col1, col2, col3,  
         row_number() over (partition by nr order by col1) as rn
  from the_table
) t
where rn <= 2;
"
6466,Insert on specific column using Select then normal struct on other columns,"INSERT INTO 
product (pname,currency,other,fields) 
(Select 'aNewProduct', currency, other fields... From Tablex where blah)
"
27325,sql : show data with condition in another table,"select distinct th.TransactionID,convert(varchar,th.TransactionDate,20)[tanggal]
from TransactionHeader th 
join TransactionDetail td on th.TransactionID = td.TransactionID 
where td.MedicineID  in 
(
select md.MedicineID
from MsMedicine md join MsMedicineType mmt on mmt.MedicineTypeID = md.MedicineTypeID
where mmt.MedicineTypeName not like 'syrup' and md.MedicinePrice > 15000

)
"
37239,SQL select at least X rows that are in a given time,"SELECT DISTINCT * FROM 

    (SELECT TOP 100 *
    FROM MyTable
    ORDER BY dateColumn DESC) A

UNION

    (SELECT *
    FROM MyTable
    WHERE dateColumn > '20090101')
"
15149,Oracle POSIX support for REGEXP_LIKE,"SELECT DISTINCT offer_id FROM fop WHERE REGEXP_LIKE (fop.offer_id, '^01[[:alpha:]].*');
"
37247,Editing a Datasource Sql Select statement to take text box inputs,"UpdateCommand=""UPDATE [TestTable] SET [CustomerName] = @CustomerName, [Status] = @Status, [phone] = @phone, [CustomerDate] = @CustomerDate WHERE [ID] = @ID"">

<UpdateParameters>
    <asp:Parameter Name=""CustomerName"" Type=""String"" />
    <asp:Parameter Name=""Status"" Type=""Int16"" />
    <asp:Parameter Name=""phone"" Type=""String"" />
    <asp:Parameter Name=""CustomerDate"" Type=""DateTime"" />
    <asp:Parameter Name=""ID"" Type=""Int32"" />
</UpdateParameters>
"
12920,how to retrieve imagepath value with count() who has max upvote value,"select imagepath from uploadimage
where upvote in (
   select max(upvote) from uploadimage
)
"
26052,Eliminate group of NULLs from result set,"SELECT
    Quarter, Count
FROM
    MyTable M
WHERE
    EXISTS (SELECT *
        FROM MyTable m2
        WHERE m2.Count IS NOT NULL AND m.Quarter = m2.Quarter)
"
5243,Mysql: Execute query for each date,"SELECT date,SUM(rainmm) FROM weather WHERE MOD(minute(time),60)=0
GROUP BY date
ORDER BY date;
"
1166,Efficient way of Retrieving data for multiple rows simulataneously,"from Foo foo where foo.id in (:fooIds)
"
24807,"SQL query to sum ""earned"" values versus the sum of all values","select p.Id, p.Name, sum(a.Points) as AP, cast(sum(a.Points) as decimal)/total.totalSum as Progress
from Player as p
cross join (SELECT SUM(Points) as totalSum FROM Achievement) as total
inner join EarnedAchievement as ea on ea.PlayerId = p.Id
inner join Achievement as a on ea.AchievementId = a.Id
group by p.Id, p.Name, total.totalSum
order by p.Name
"
11088,How to find max value of column with NULL being included and considered the max,"SELECT [ID]
     , CASE WHEN MAX(CASE WHEN [Date] IS NULL THEN 1 ELSE 0 END) = 0 THEN MAX([Date]) END
FROM YourTable
GROUP BY [ID]
"
36955,ISNULL in SQL subquery not returning anything,".. AS nvarchar(30)
"
25441,How to get an item from string in postgresql?,"select split_part('10,244,566', ',', 2);
"
1112,MYSQL If Condition to not display if then value is 0,"select
mm.module_id, 
mm.module_name, 
pm.permission_id, 
pm.permission_name, 
case 
when rp.permission_id is not null then false 
else true 
end as status 
from permission_master as pm 
left outer join role_permission as rp on pm.permission_id = rp.permission_id and rp.RoleID = 1 
left outer join module_master as mm on pm.module_id = mm.module_id 
having status = 1
order by mm.module_id, pm.permission_id
"
11067,update column value using a range group,"with cte as
(
    select Id, questionId, convert(int, rand() * Id * 1000) as surverId 
    from seq 
    where questionId = 0

    union all

    select seq.Id, seq.questionId, cte.surverId
    from seq
    inner join cte on cte.Id + 1 = seq.Id
    where seq.questionId <> 0
)

merge seq as target
using (select * from cte) as source (Id, questionId, surveyId)
on (target.Id = source.Id)
when matched then
    update set target.SurveyId = source.surveyId;
"
23512,select from two tables where linked column can be null,"select *
from orders o left join orderdata od on o.orderId=od.orderid
"
26210,Mysql update from a join query,"UPDATE USER 
JOIN   USER_SETTINGS 
ON     USER_SETTINGS.USER_ID = USER.ID 
SET    setting=settings.value
"
767,Need some modification in my SQL query,"select    date(update_timestamp) as date, count(*) users
from      calender_table c
left join registered r
on        date(update_timestamp)=c.date
where     c.date between date_sub(sysdate(), interval 7 day) and sysdate()
group by  c.date
"
37745,How to do full join on one field and inner join on another from same table,"sum(case when t2.chain is null then 0 else t1.qty end) as t1Total
"
39370,how to Get only the rows which's D column hold nearest lowest number to the C column?,"with MySortedData as
(
    select ID, Name, C, D, ROW_NUMBER() over(PARTITION BY C order by ABS(C - D)) as RowNum
    from Something
)

select *
from MySortedData
where RowNum = 1
"
24328,I need help writing a complex SELECT statement,"SELECT
    id,
    name,
    (SELECT COUNT(*) FROM attendance att WHERE att.event = ev.id) AS attending
FROM
    event ev
ORDER BY
    attending DESC
"
36938,unscope only the order statements,"chain.except(:order)
"
7695,Get max of column using sum,"SELECT saleId , SUM(amount) AS Amount
FROM Table1
GROUP BY saleId
HAVING SUM(amount) = 
( 
  SELECT MAX(AMOUNT) FROM
  (
      SELECT SUM(amount) AS AMOUNT FROM Table1
      WHERE date BETWEEN '10/10/2012' AND '12/10/2012'
      GROUP BY saleId
  ) AS A
)
"
3066,Symfony 2 + Doctrine |Entity must have all tags,"$qb->expr()->exists('SELECT b...') 
"
18623,How can I return the next row of WHERE clause?,"SELECT id1 FROM table WHERE id IN
(SELECT t1.id+1 FROM table t1 
LEFT JOIN table t2 ON t1.id1=t2.id 
WHERE t2.id1 IS NULL);
"
28585,How implement one-to-many objects database in sqlite for android,"SELECT u.User_ID, u.Name, p.Time, p.Message
FROM Users u INNER JOIN Posts p ON u.User_ID = p.User_ID
"
8013,Improve this query to fetch data from different tables,"SELECT a.*, 
   COALESCE(b.name, c.name), 
   COALESCE(b.field1, c.field1),
   COALESCE(b.field2, c.field2)
FROM events a
...
"
6403,MySQL select 10 random rows from 600K rows fast,"SELECT name
  FROM random AS r1 JOIN
       (SELECT CEIL(RAND() *
                     (SELECT MAX(id)
                        FROM random)) AS id)
        AS r2
 WHERE r1.id >= r2.id
 ORDER BY r1.id ASC
 LIMIT 1
"
15076,How to return weeks of data (Sun to Sun),"SELECT <fields>
FROM MyTable
WHERE YEAR(DateField) = 2011
AND DATEPART(week, Datefield) BETWEEN 
    DATEPART(week, '6/1/2011') AND DATEPART(week, (DATEADD(DAY, -1, (DATEADD(Month, 1,     '6/1/2011')))))
"
13802,mysql- join multiple table depending on column,"SELECT USER_ID,FIRST_NAME,LAST_NAME
FROM m_user_info
WHERE USER_ID IN 
(select m_groups.GROUP_CREATOR_ID as GROUP_ADMIN 
from m_groups where m_groups.GROUP_ID='6'  
union
select m_group_admin.GROUP_ADMIN from m_group_admin 
where m_group_admin .GROUP_ID='6';)
"
22966,Set-based alternative to loops in SQL,"SELECT W.DocumentId, SUM(W.Weight*Q.Weight) As Score
FROM TfidfWeights AS W
INNER JOIN Query AS Q ON W.StemId = Q.StemId
GROUP BY W.DocumentId
"
23456,"SQL Server : setting two variables month and year for previous month, year roll over safe","DECLARE @monthAgo dateTime
DECLARE @month int
DECLARE @year int

SET @monthAgo = DATEADD(month, -1, GETDATE())
SET @month = MONTH(@monthAgo)
SET @year = YEAR(@monthAgo)
"
18154,Are subqueries cached by MySQL when used in a WHERE clause?,"EXPLAIN EXTENDED
SELECT column_a, column_b FROM table_a WHERE
    column_b IN (SELECT b_id FROM table_b)
"
26429,How to create this SQL constraint,"ALTER TABLE ParentTable ADD 
   UNIQUE (ParentTableId);

ALTER TABLE ChildTable ADD 
   FOREIGN KEY (ParentTableId)
   REFERENCES ParentTable (ParentTableId);
"
37413,SQL Query to select parent that has child records with different values in the same column,"SELECT *
FROM CUSTOMER c
WHERE EXISTS (SELECT 1 FROM ORDERS o WHERE c.id = o.id and type = 'couch')
  and EXISTS (SELECT 1 FROM ORDERS o WHERE c.id = o.id and type = 'tv')
"
36056,How to INNER JOIN a variable number of tables,"with MyGroups as
(
    select 'Group1' as GroupName union all
    select 'Group2'
)

select g.GroupName
    , sm.MemberName
from MyGroups g
cross apply dbo.ShowMembers(g.GroupName) sm
group by g.GroupName
    , sm.MemberName
having COUNT(*) = (select COUNT(*) from MyGroups)
"
23102,help with SQL queries,"SELECT
    MemberId,
    OrganizationId,
    SUM(Amount) AS `Amount Donated to Organization`,
    COUNT(Amount) AS `Number of Donations`
FROM
    Donations
GROUP BY
    MemberId,
    OrganizationId
;
"
32915,What should I put in the Rails model definition for the index I just added to a MS SQL Server 2008R2 column?,"def up
  execute ""ALTER TABLE orders ADD UNIQUE ordering_date_ndx (ordering_date)""
end
"
26763,Problem reading from 3 tables in mysql,"select *
from
father 
inner join mother on father.IDNO = mother.IDNO
inner join parents on mother.IDNO = parents.IDNO
where
father.IDNO = '03a45'
"
1947,How to select the reserved word (limit) in postgres,"select ""limit"" 
from companies;
"
35207,Updating table metadata on the fly,"CREATE PROC dbo.OurMetaDataUpdate
   @tablename ...
   @uniqueid ...
WITH EXECUTE AS OWNER
AS
SET NOCOUNT ON

EXEC sp_addextendedproperty ...
GO
"
25866,Data migration in Oracle,"INSERT INTO ROLE_INFO (ROLE_ID, ROLE_NAME , ROLE_TAG)
SELECT U_ID, U_NAME,'BB'
FROM USR_INFO
WHERE U_ROLE='B';

COMMIT;

DELETE FROM USR_INFO
WHERE U_ROLE='B';

COMMIT;
"
25220,Outer Joining SQL Tables?,"SELECT
a.activity_id, a.activity_type, c.category_name 
FROM activity a
LEFT OUTER JOIN link l 
ON a.activity_id = l.activity_id
LEFT OUTER JOIN category c
ON c.category_id = l.category_id; 
"
28404,Get name of weekday in netezza,"select to_char(date, 'Day') from table
"
26709,Can a table name be used as a field for another table?,"Movies table:
M_ID, Title, Director, etc..

Person table:
P_ID, Name, Other attributes of an individual person...

MovieWatched table:
M_ID, P_ID, DateWatched

MovieOwned table:
M_ID, P_ID, NumberOfViews
"
22655,Is it possible to create a new column when returning an SQL result set?,"SELECT ticket,
  CONVERT(Bit, CASE WHEN (TicketExpires < getDate())
    THEN 0
    ELSE 1
  END) IsExpired
FROM Authentication
WHERE accountID = @id;
"
19983,SQL Server: How to find unused fields in view,"SELECT OBJECT_NAME(m.object_id), m.*
  FROM SYS.SQL_MODULES m
 WHERE m.definition like N'%my_view_name%'
"
7278,ms access - 3 table join w/ complex JOIN condition on third table,"SELECT ab.*, c.* 
FROM 
(
    SELECT a.ID AS ID1, a.ShoeSize AS ShoeSize1, b.ID AS ID2 
    FROM tblOne a LEFT JOIN tblTwo b 
        ON a.ParentId = b.Id
) ab LEFT JOIN tblThree c 
    ON c.ParentId = ab.ID2 and c.ShoeSize = ab.ShoeSize1
"
34051,Create zip file from SQL Server,"SET @Command = '""C:\Program Files\WinRAR\Rar.exe""  a -ep1 -pasd^^ad ' +@destination+' '+@source
"
14614,MySql - Inserting multiple rows with a joined subquery?,"INSERT INTO `subscrips` 
SELECT 37, id 
  FROM `proj_objects` 
 WHERE type = 'fthread'
"
24554,"Two tables of emails addresses, return where one is not in the other","`payer_email` NOT IN (SELECT `email` FROM `database2`.`Unsubscribers`)
"
27506,count and distinct over multiple columns,"select cost, count(*)
from
(
    SELECT id, cost1 AS cost FROM my_costs 
    UNION ALL
    SELECT id, cost2 AS c FROM my_costs
) v
group by cost
order by count(*) desc;
"
38615,Clarification in CASE statement in sql,"COALESCE(a.empname, a.mgrname) = b.stdname
"
30688,CPanel WHM setup website locally and download database,">>ssh user@your_website.com
>>Enter password: your_password
>>mysqldump -u [uname] -p[pass] [dbname] > [backupfile.sql]    
"
17732,Calculate a column on select in MySQL,"SELECT r.id roomId, coalesce(count(p.room),0) patientsCount
FROM room r left join patients p on r.id = p.room
GROUP BY r.id
"
29050,"Find duplicates or more in Mysql, delete them except the first one input"," DELETE FROM `80dage_garmin_track` t1
 WHERE EXISTS (SELECT 1 from `80dage_garmin_track` t2
          WHERE t1.Length = t2.Length
           AND t1.Time = t2.Time
           AND t1.idgarmin_track > t2.idgarmin_track)
"
1268,phpmyadmin - getting info for FK on delete and on update actions,"SELECT rc.*
FROM information_schema.referential_constraints AS rc ;
"
30119,UPDATE a column with a subquery,"UPDATE tbUser
SET username = LEFT(username, CHARINDEX('@', username) - 1)
WHERE username LIKE '%@%'
"
12246,Mysql EAV match row as field or entity's property value,"SELECT 
    o.create_date,
    o.title,
    o.author,
    op1.value AS start_date,
    op2.value AS end_date,
    ...
FROM object o
LEFT JOIN object_properties op1 ON op1.object_id=o.object_id AND op1.type_id=1
LEFT JOIN object_properties op2 ON op2.object_id=o.object_id AND op2.type_id=2
"
30763,Update a column in MySQL table if only the values are empty or NULL,"UPDATE
    jos_jbjobs_jobseeker a
    INNER JOIN jos_users b ON a.email = b.email
SET
    a.user_id = b.id
WHERE a.id IS NULL OR LENGTH(a.id)=0;
"
4079,Zend Form Object as a string,"$html = str_replace('{WIDGET_FORM}', $form->__toString(), $html);
"
37787,Simple Joining SQL on two fields,"select b.name, 
    b.date, 
    sum(case when product='Apple' then qty end) Apples,
    sum(case when product='Banana' then qty end) Bananas
from buyers b
    join purchases p on b.name = p.name and b.date = p.date
group by b.name, 
    b.date
"
171,MySQL - Inner join into same table with WHERE clause,"select c.*
from campaigns c
where c.isBalanced = 0
union all
(select c.*
 from campaigns c
 where c.isBalanced = 1
 limit ??
)
order by redirects
limit 1;
"
33095,SQL Distinct keyword in assignment statement,"declare
  @ProductID int,
  @relatedprods varchar(8000)

set @ProductID = '1234'
set @relatedprods = ''

select @relatedprods = @relatedprods + cast(ProductID as varchar) + ','
from (
  select distinct top 12 a.ProductId
  from A a
  inner join B b on b.CategoryID = a.CategoryID
  where  B.ProductID = @ProductID and a.ProductID != @ProductID
) x
"
7111,SQL query Where clause problem,"SELECT Id,Description
FROM NotificationEvents ne
WHERE NOT EXISTS(SELECT * 
                 FROM NotificationExcludes nx 
                 WHERE ne.Description 
                 LIKE nx.name + '%') /*<--Might need Concat or || here
                                          dependant upon RDBMS*/
"
15996,SQL Inner Join issues,"SELECT c.* FROM `clients` c
INNER JOIN `websites` w ON w.clientID = c.ID
WHERE w.`name` LIKE '%lead%'
LIMIT 0,20
"
29659,Is this sql query valid (many-to-many relation),"select concat(professor.name, "" "", professor.surname) as ""Professor"",
       subject.name as ""Subject""
from professor
inner join professor_subject
    on professor.id = professor_subject.professor_id
inner join subject
    on professor_subject.subject_id = subject.id
"
28247,Get count of mutually shared relations,"select count(event_id) as events
from event_registration
where user_id in (1,2,3)
group by event_id
having count(distinct user_id) = 3
"
22720,Merge two Table in SQL Server 2008,"when not matched then insert
  (id, name, email_id) 
  values (stage.id, stage.name, stage.email_id)
"
19407,If statements with SQL and returning string values,"select (case when value1 = 4 then 'free' else 'not free' end) as newval
from tablename
where value1 in (4, 5);
"
21141,"I need to select Year, AVG(score) where COUNT(id) is more than 1 grouped by year","Select Year, AVG(score)
FROM movies
GROUP BY year
HAVING count(*) > 1
ORDER BY year desc;
"
8550,how to merge two order by statements in sql,"select * from employeeb37 order by job_id asc, salary desc
"
477,How can I combine all this into one SQL UPDATE query?,"UPDATE FoodIntake 
   SET MealType = 'B' 
 WHERE substr(Time, -8) 
        BETWEEN (SELECT BrkStrt FROM Patient WHERE PatientId = :currentPatient)
            AND (SELECT LunchStrt FROM Patient WHERE PatientId = :currentPatient)
"
6933,Select join statement is not working,"SELECT 
    material_code 
FROM table1 
LEFT JOIN table2 
ON table1.material_code = table2.material_code 
WHERE status = 0
"
12874,Select statement to get 2 value from column in a table,"SELECT unsold.total, paid.total 
FROM (
  SELECT COUNT(Auction.AuctionID) AS total
  FROM Auction 
  INNER JOIN Item ON Auction.ItemID = Item.ItemID 
  WHERE (Auction.Status = 'UnSold') AND (Item.SellerID = 201)
  GROUP BY Auction.Status
) AS unsold,
(
  SELECT COUNT(BID.BidID) AS total
  FROM BID
  WHERE (BID.Status = 'Paid')
  GROUP BY BID.Status
) AS paid
"
19819,MYSQL - Union SELECT & GROUP BY Not working,"select cl.id, cl.user_id,
       coalesce(m.fullname, g.fullname) as fullname,
       cl.checkout_as
from checkout_log cl left join
     members m
     on cl.user_id = m.id and cl.checkout_as = 'member' left join
     guests g
     on cl.user_id = g.id and cl.checkout_as = 'guest';
"
30112,Guidance required for sql query,"select * 
from yourtable
where companyid in (
  select companyid
  from yourtable
  group by companyid
  having count(1) = (
    select count(1) cnt 
    from yourtable
    group by companyid
    order by 1 desc
    limit 1
    )
)
"
6958,"sqlplus - using a bind variable in ""IN"" clause","type t_id_table is table OF other_table.id%type index by binary_integer;
v_table t_id_table;

-- fill the table
select id
bulk collect into v_table
from other_table 
where abc in ('&val1','&val2','&val3');     

-- then at a later stage...    

select *
from some_table st
,    table(cast(v_table AS t_id_table)) idt
where st.id = idt.id;
"
32554,SQL: Additional condition inside the 'like'-condition,"  SELECT
      p1.time_neu as Datum
      count(p1.*) as Anzahl_Palette,
      count(p2.*) as Anzahl_Stangen_Behaelter
    FROM
      00_Gesamt_Pickauf p1,
      00_Gesamt_Pickauf p2
    WHERE
      p1.platz_von NOT LIKE '%-00-00%' AND
      p2.platz_von like ...
"
21457,Display cell value as column name using SQL,"SELECT
  Name, 
  MAX(CASE Subject WHEN 'C++'  THEN Grade END) 'C++',
  MAX(CASE Subject WHEN 'Java' THEN Grade END) 'Java'
FROM @test
GROUP BY Name;
"
29839,Apache Derby Insert Trigger - Retrieving inserted record,"create trigger insert_new_row
  after insert on table_1
  referencing new as insertedrow
  for each row 

insert into table_2 (a,b,c)
values( insertedrow.a, insertedrow.b, insertedrow.c);
"
6281,Sort by interger and then smalldatetime in SQL,"ORDER BY 
CONVERT(DateTime, CreatedDate,101)
"
26152,Difference between text references and int references in SQLite?,"       select * from people p
       join
       (
        select _id from people join offices
        on people.office = offices._id 
        and offices.name = 'Beadle County'

        UNION

        select _id from people join specialtyareas
        on people.specialty_area_1 = specialtyareas._id 
        and specialtyareas.name='Customer Service'

       ) as MatchingPeople
       on MatchingPeople._id = p._id
"
7450,JPA Native Query with call to Oracle function returns the same object in different calls in same Transaction context,"getEntityManager().createNativeQuery(sql, MyEntity.class);
"
8242,Converting a SQL update statement to a View statement,"CREATE TRIGGER update_table AFTER INSERT ON followers
        FOR EACH ROW
            BEGIN
              followers f left outer join followers f2   on f2.id = f.id
              set f.Growth = f.Growth_Speed/(SELECT AVG(f.Growth_Speed) FROM (SELECTf.Growth_Speed from followers f WHERE f.id <= f.id+1));            

            END
"
16356,Select only one row matching distinct values,"SELECT ID from portfolio WHERE category = 'x' AND description = 'x' LIMIT 1;
"
32227,Want to add if conditions in query,"SELECT sum(CASE
    WHEN $P{month} IN ('Jan','Feb','March') THEN t.quarter1
    WHEN $P{month} IN ('Apr','May','June') THEN t.quarter2
    WHEN $P{month} IN ('July','Aug','Sept') THEN t.quarter3
    WHEN $P{month} IN ('Oct','Nov','Dec') THEN t.quarter4
    ELSE 0 END) AS quarter,
    s.name as sname, f.name as fname, m.name as pname
  FROM ...
"
23880,How to efficiently select rows having a MIN date in postgres,"WITH find_first AS (
  SELECT foo_id, baz,
    row_number()
  OVER (PARTITION BY foo_id ORDER BY foo_id, save_date) AS rnum
  FROM samples
)
SELECT foo_id, baz FROM find_first WHERE rnum = 1;
"
28603,Updating a foreign key only when primary key exists,"WITH find_rec AS
  (SELECT id3 FROM s.t2 WHERE id4 = 'hello3')
UPDATE s.t1
SET id2 = find_rec.id3
WHERE id1 = 2
  AND EXISTS (SELECT 1 FROM find_rec);
"
6591,Database model for a 24/7 Staff roster at a casino,"MATCH (employee:Employee)-[:HAS_SKILL]->(skill:Skill),
      (employee)<-[:DEALS]-(game:Game)-[:LOCATION]->(table:Table),
      (game)-[:BEGINS]->(hour:H)<-[*]-(day:D)<-[*]-(month:M)<-[*]-(year:Y)
WHERE skill.type = ""Blackjack"" AND 
      day.day = 17 AND 
      month.month = 1 AND 
      year.year = 2014
RETURN employee, skill, game, table
"
3907,MS Access SQL: Adding two COUNT statements returns multiple copies of the sum instead of one,"SELECT 
    SUM(IIF(qryAttainment.[Attainment Samples Received]=""On Time"", 1, 0)) 
    +
    SUM(IIF(qryAttainment.[Attainment CofA Issued]=""On Time"", 1,  0))
 FROM qryAttainment
"
4148,How does this correlated Subquery works,"Salary
======
10000
20000
30000
40000
50000
60000
"
6706,Is there a similar count method in SQL like mysql_num_row,"SELECT COUNT(*) FROM tablename
"
29982,Complexity of inserting,"INSERT   INTO ProductZone 
SELECT ZoneNo, 
       ProductNo 
FROM   Product a 
       CROSS JOIN ZONE b 
WHERE  NOT EXISTS (SELECT 1 
                   FROM   ProductZone c 
                   WHERE  a.ProductNo = c.ProductNo 
                          AND a.zone = c.zone) 
"
32367,Multiple records in a table matched with a column,"select workerid 
from tags
where name in ('foo', 'bar')
group by workerid
having count(distinct name) = 2
"
11839,Group columns into one column,"Select b.BookingID, c.CustName + ' ' + c.CustEmail + ' ' + c.CustAdd As Cust
from  Booking b
INNER JOIN Customer c ON b.CustID = c.CustID
"
18626,adding condition when case statement is true in postgresql,"SELECT name,
        count(CASE WHEN date_part('year',time_stamp) = 2016 THEN answ_count end) AS Year15 
FROM 
        companies companies 
where 
    CASE when no_answer='f' then value_s ELSE '1' end IS  not  NULL
    OR  CASE when no_answer='f' then value_n  ELSE '1' end IS  not  NULL 
"
5897,Selecting rows and updating them in the same query?,"UPDATE products
SET update_id = '550b8d7f3ba477.82670719', 
    date_update_started = UTC_TIMESTAMP()
WHERE date_update_started < UTC_TIMESTAMP() - INTERVAL 1 HOUR 
    AND updated = 1
ORDER BY some_date
LIMIT 100
"
28844,Query help need in finding missing numbers,"select distinct id
from
(
    SELECT Id, Group, LAG(Group, 1, -1) over (partition by Id order by Group) prevGroup
 FROM Table
 )     
 WHERe Group -1 <> PrevGroup
"
25492,How do I limit the results of an SQL query?,"    SELECT id FROM table LIMIT 5
"
1799,XML datatype function does not exists?,"Select x.a.query('.') FROM @XmlEl.nodes('p/span') x(a)
"
21717,Get all discussions where a discussion has at least two active participants?,"SELECT discussion_id FROM message
  GROUP BY discussion_id 
  HAVING count(user_id) > 1
"
23876,How to declare and display a variable in Oracle,"DECLARE
    v_text VARCHAR2(10); -- declare
BEGIN
    v_text := 'Hello';  --assign
    dbms_output.Put_line(v_text); --display
END; 
"
29214,Maintaining a foreign key relationship when inserting into tables with autoincrementing Id's,"BEGIN TRAN

INSERT Defect ()
VALUES (...)

INSERT DefectData (DefectID, AdditionalNotes, ...)
VALUES (SCOPE_IDENTITY(), @AdditionalNotes, ...)

COMMIT TRAN
"
19439,How to subtract two consecutive rows in MS SQL Server?,"SELECT 
   location,
   SUM(DATEDIFF(SECOND, DateTime, 
                Lead(DateTime, 1) OVER(PARTITION BY location ORDER BY DateTime))) Elepase 
FROM 
    tableName  
GROUP BY 
    location
"
25135,Is it possible to create and use window function in the same query?,"select s.*
from (Select other things,itemid,stock,
             SUM(quantity) OVER (PARTITION BY itemid) AS total_sales
      from .....
     ) s
where total_sales < stock;
"
12341,Simple explanation for UNION,"select * from A
union  -- or union all
select * from B
"
21479,LEFT JOIN with self table only first row,"SELECT
  plus.timestamp AS start,
  IFNULL(MIN(minus.timestamp),'NA') AS end,
  plus.user AS user
FROM
  activity AS plus
  LEFT JOIN activity AS minus
    ON minus.timestamp>plus.timestamp
GROUP BY plus.timestamp
ORDER BY plus.timestamp
;
"
22908,Simple tag searching with Sphinx,"sql_joined_field = tags from query; tag.assoc.document_id, \
                   tag_content from tags join tag_assoc on \
                   tags.id=tar_assoc.tag_id order by tag.assoc.document_id asc
"
9210,SQL Trigger Using Variables,"CREATE TRIGGER dbo.OrderOffer_UpdatedUnits
ON dbo.OrderOffer
FOR UPDATE
AS
BEGIN

    UPDATE a
    SET dbo.UnitsAvailable = 
        (
            Select SUM(b.UnitsAvailable) 
            From dbo.Offer b 
            Where b.OfferId = a.OfferId
        )
    FROM OrderOffer a
    INNER JOIN INSERTED i
    ON i.OrderOfferid = a.OrderOfferid

END
"
16618,SQL Generate Random Number,"select x.a,
       (case when rand < 2 then 1 when rand < 3 then 2 else 999 end) as b
from (select x.*,
             dbms_random.value(1, 4) as rand
      from x
     ) x;
"
947,Get function parameter from select query,"SELECT * FROM INFORMATION_SCHEMA.PARAMETERS where SPECIFIC_NAME = 'Your Function Name'
"
32594,"Equally divide resultset into groups, with cursor or not?","SELECT  *,
        NTILE((SELECT CAST(CEILING(COUNT(*) / 6.00) AS INT) FROM drivers)) OVER (ORDER BY id) AS heat
FROM    drivers
"
11601,REPLACE and Unicode characters in SQL,"Select Replace(N'Clmentine', N'', N'')
"
14561,Bulk insert in SQL Server database from one table to another,"INSERT INTO NewTable (field1, field2, field3)
SELECT field1, field2, field3 FROM OldTable
"
11751,Use a particular set of where clauses depending on the comparision of 2 cells,"SELECT 
    SUM(case when Active_Date < Submit_Date and Submit_Date < '2014-07-28' then 1
             when Active_Date >= Submit_Date and Active_Date < '2014-07-28' then 1
        end) AS OutSLA
FROM
    WOI_WorkOrder
WHERE
    ASGRP IN ('WOIQUE')
AND
    Status = 'Assigned' OR Status = 'Pending' OR Status = 'In Progress'
"
18989,Why using NOT LIKE for one column in MySQL filters results for rows where column is empty?,"SELECT `visitors`.`id`, `visitors`.`ip`, `visitors`.`url`, `visitors`.`time`, `visitors`.`agent`, `visitors`.`reference`
FROM (`visitors`)
WHERE  `reference` NOT LIKE '%bot%' OR `reference` IS NULL
ORDER BY `id` desc
LIMIT 2000
"
13633,Sql search > Works on Mysql doesn't on SQLITE,"SELECT name_item, pot_item FROM items 
INNER JOIN item_region ON items.cod_item = item_region.cod_item
WHERE item_region.cod_region = ?;
"
3693,MySQL 3 table join,"SELECT LS.title, LS.id, LS.url, LS.description
FROM listings LS
WHERE 
LS.id IN (
   SELECT LM.listing_id
   FROM location_map LM
   WHERE LM.location_id = 123 )
"
13034,Why is 30 the default length for VARCHAR when using CAST?,"SELECT CAST('the quick brown fox jumped over the lazy dog' AS VARCHAR(45))
"
29936,SQL count with some conditions," SELECT Initialdate, OriginalTime, Gate1, 
      Destindate, DestinationTime, Gate2, 
      COUNT(1) as Freq
 FROM TABLE1
 GROUP BY Initialdate, OriginalTime, Gate1, 
      Destindate, DestinationTime, Gate2
"
31557,"SQL select from two tables, using a distinct value between the two IF it exists, otherwise only using value from the first table?","SELECT DISTINCT 
     roomList.room, 
     userlist.room, 
     roomList.totalDesks, 
     COUNT(DISTINCT userlist.desk) AS desksUsed, 
     roomlist.totalDesks-COUNT(DISTINCT userlist.desk) AS desksOpen 
     FROM roomlist 
         LEFT JOIN userlist ON roomlist.room=userlist.room
     GROUP BY roomList.room, 
         userlist.room, 
         roomList.totalDesks
"
19949,Duplicated rows in MS Access database,"select distinct t.*
into TempTABLE
from tablename t;

delete from tablename;

insert into tablename
    select *
    from TempTable;
"
27526,SQL Concatenate Joined Results into Column,"select t1.id, t1.title, group_concat(t2.category) as cat from table1 as t1
left join table2 as t2 on t1.id = t2.table1id
group by t1.id, t1.title
"
2050,MySQL query based on column value,"SELECT
  CASE
     WHEN (Failure1 > Failure2 AND Failure1 > Failure3) THEN Failure1
     WHEN (Failure2 > Failure1 AND Failure2 > Failure3) THEN Failure2
     WHEN (Failure3 > Failure1 AND Failure3 > Failure2) THEN Failure3
  END,
  --repeat Case for second and third column
FROM
   Failures
WHERE
   ID = 1
"
793,sql for a table with two foreign keys to same table causing Cartesian product,"SELECT wedding.*, guest.*
FROM guest
RIGHT JOIN wedding
    ON guest.guest_side = civil_union_side_a
    OR guest.guest_side = civil_union_side_b;
"
34421,Select from several tables with fix count rows in relative table,"select m.ThreadId
from members m
group by m.ThreadId
having count(*) = 2 and
       sum(case when m.name = 'AAA' then 1 else 0 end) = 1;
"
21750,Function return sys_refcursor call from sql with specific columns,"create or replace type myType as object (
a int,
b varchar2(10)
)
/

create or replace type myTable as table of myType;
/

create or replace function f1 return myTable as
l_data myTable := myTable();
begin
for i in 1 .. 5 loop
l_data.extend;
l_data(i) := myType(i, 'Row #'||i );
end loop;
return l_data;
end;
/

select * from TABLE ( cast( f1() as myTable ) );

---------- ----------
1 Row #1
2 Row #2
3 Row #3
4 Row #4
5 Row #5
"
19535,finding range by comparing two tables,"SELECT
  ( SELECT MAX( value ) FROM experience_range WHERE value <= :search_value ) AS range_start,
  ( SELECT MIN( value ) FROM experience_range WHERE value >  :search_value ) AS range_end
FROM dual;
"
487,In Firebird would be a way to auto-update coincident rows in a INSERT procedure?,"UPDATE OR INSERT INTO T1 (F1, F2)
    VALUES (:F1, :F2)
    MATCHING (F1);
"
11640,SQL statement for a tricky 2 table query,"SELECT t2.roll_id FROM table1 t1a, table1 t1b, table2 t2
WHERE t1a.flag = 0 AND t1a.usergroup = t1b.username
AND t1b.usergroup =  t2.username AND t1a.username = 'someUsername'
"
6238,parse openxml and get a name value collection for given node,"SELECT replace(name,'__',' ') as name, value 
            FROM OPENXML (@idoc, '/user/additionalfields/*',1) 
            WITH (          
                Name  nvarchar(4000) '@mp:localname',
                value  nvarchar(4000) './text()'
                  ) 
"
1289,updating a table by joining multiple tables,"UPDATE catalog_topics a
LEFT JOIN catalog_files_join b ON a.catalogID = b.foreignKey
LEFT JOIN catalog_files_join c ON c.foreignKey = b.catalogFileID
LEFT JOIN catalog_files d ON d.catalogFileID = b.catalogFileID
LEFT JOIN catalog_lu_topics e ON a.topicID = e.topicID
SET d.catalogFileID = 'cfil123',
    b.catalogFileID = 'cfil123'
WHERE b.fileTypeID = 'gvl401'
AND c.fileTypeID = 'gvl25'
AND e.parentID = 'top305'
AND a.sortorder =1
AND e.topicID = 'top318'
"
31818,find substrings in sql table using sql query,"DECLARE @x VARCHAR(255)
SET @x = 'My name is David'
SELECT a FROM tablex WHERE @x LIKE '%' + tablex.name + '%'
"
18490,RANDBETWEEN for SQL Server 2012,"SELECT CAST(RAND() * 298 + 3 AS INT)
"
3754,"SQL for sum of all ""children""","select t.*,
       (select sum(prices)
        from t t2
        where t2.path like t.path || '.%'
       ) as SumBeneath
from t;
"
7406,Update field of MYSQL Table depending upon values in another table,"UPDATE  companies cmp
        LEFT JOIN company_adv cma
            ON cmp.id = cma.company_id
SET     cmp.adv = IF(cma.image1 IS NULL, 0, 1)
"
19818,Populate SQL Database column with repeating sequential values,"select Record,(select COUNT(0) 
                from Table1 t1 
                where t1.Record <= t2.Record 
     )%3+1 as 'ID'
from Table1 t2 
ORDER BY Record; 
"
23842,Select inside an insert into.. values(...),"INSERT INTO SMS(N_SMS, CODIGO_CLIENTE) 
    VALUES (SEQ_SMS.NEXTVAL
            , (SELECT CODIGO_CLIENTE 
               FROM ORDEM_SERVICO, VEICULO 
               WHERE ORDEM_SERVICO.MATRICULA = VEICULO.MATRICULA)
           )
"
28208,Grails: Read Oracle Database User Roles,"DBA_ROLES
DBA_ROLE_PRIVS
ROLE_TAB_PRIVS
DBA_TAB_PRIVS
DBA_USERS
SESSION_PRIVS
SESSION_ROLES
TABLE_PRIVILEGES
"
26347,SQL Aggregate Calls,"select c.name,
       sum(case when p.state = 'Pending' then 1 else 0 end) as count_pending,
       sum(case when p.state = 'Shipped' then 1 else 0 end) as count_shipped
from customer c 
   left join products p on p.customer = c.id
group by name;
"
21772,SQL Update by Column Index,"declare @columnNum int
SET @columnNum = 3

declare @column nvarchar(100)

set @column = 
(
    SELECT TOP 1
        COLUMN_NAME
    from INFORMATION_SCHEMA.COLUMNS
    WHERE TABLE_NAME = 'Products'
        AND ORDINAL_POSITION = @columnNum
)

declare @sql nvarchar(500)

set @sql = 'Update Products Set ' + @column + ' = 54 where ProductID = 12947'

sp_executesql @sql
"
15189,PostgreSQL - divide query result into quintiles,"select t.id, ntile(5) over (order by t.id)
from t
"
24640,Combine IN Operator values with temporary table,"(CASE WHEN SUBSTRING(article_code,1,4) IN (select article_code from temp_table) THEN 'X'
      ELSE 'Y'
 END) AS lup
"
33818,"PostgreSQL : Weighted ordering, order by columnA * 0.7 + columnB * 0.3?","SELECT
  columnA,
  columnB,
  (columnA * 0.7) + (columnB * 0.3) as weighted_value
FROM
  table
ORDER BY 
  weighted_value DESC
"
34086,"Search ""AND"", ""OR"", ""NOT"" in the text of a document using OracleText","WHERE CONTAINS(column, '{cats and dogs}') > 0
"
18346,SQLZOO Nobel Tutorial #8,"select distinct yr from nobel 
where 
subject='Physics' and yr not in 
(select distinct yr from nobel where subject='Chemistry')
"
19843,SQL query to join 2 tables and find the matching rows based on a criteria,"SELECT t1.UserID, t1.FirstName, t1.LastName, MAX(SalesDate) AS SalesDate
FROM Table1 t1 JOIN Table2 t1 ON t1.UserId = t2.UserID
GROUP BY t1.UserID, t1.FirstName, t1.LastName
HAVING MAX(SalesDate) < '20120601'
"
31461,Append result of SQL queries inside Excel cell,"Dim strResult As String

'Put your first connection / recordset call here'

strResult = rs.fields(0) & "" to ""

'Put your second connection / recordset call here'

strResult = strResult & rs.fields(0)
"
22594,How do I get a string from an Access database?,"Dim Names As New List(Of String)

Using comm As New OleDbConnection(""Provider..."")
  comm.Open()
  Using cmd As New OleDbCommand(""SELECT FirstName FROM Contacts"", comm)
    Using reader As OleDbDataReader = cmd.ExecuteReader
      While reader.Read
        Names.Add(reader(""FirstName"").ToString)
      End While
    End Using
  End Using
End Using
"
35277,How to get data from 3 diffrent tables in MySql,"SELECT t1.name, 
       t2.department, 
       t3.salary 
FROM   table_one t1
       INNER JOIN table_two t2
              ON t2.dept_id = t1.dept_id 
       INNER JOIN table_three t3
              ON t1.emp_id = t3.emp_id 
WHERE  t1.name = 'Test2' 
"
10170,Tables join using mapping table,"select t1.id, t3.id
from table1 t1
full outer join mapping t2 on( t1.col2= t2.col1)
full outer join table3 t3 on(t1.year = t3.year and t2.col2 = t3.col2
"
9966,SQL code (SSRS 2008 version),"SELECT 
   ID, 
   Value1 = MAX(case WHEN [Text] = 'Value1' THEN 'yes' ELSE '' END),
   Value2 = MAX(case when [Text] = 'Value2' THEN 'yes' ELSE '' END),
   Value3 = MAX(case when [Text] = 'Value3' Then 'yes' ELSE '' END)
GROUP BY
   ID
"
17884,Join 3 tables in mysql,"$sql = ""SELECT p.id, m.menu_name, m.image_id, i.file_url 
            FROM product p 
            INNER JOIN menu m ON m.id = p.menu_id
            INNER JOIN icon i ON i.id = m.image_id
            WHERE ... "";
"
31739,Modeling A Food Recipes Database," RecipeIngredient (RecipeId, ItemId, Amount).  
"
16800,How to Create a Row for Each Row from Another Table,"INSERT INTO Membership (Id, StartDateTime, EndDateTime, Frozen, MembershipType)
SELECT Id, GETDATE(), GETDATE(), 0, 'Free' FROM User
"
38808,Table cell to count rows in other table,"CREATE TABLE [_member_data] (
  [ID]   INT IDENTITY(1, 1) NOT NULL,
  [Name]  NVARCHAR (100) NOT NULL,
  [Email] NVARCHAR (500) NOT NULL,
  PRIMARY KEY CLUSTERED ([ID] ASC)
);

CREATE VIEW [dbo].[Members] AS
  SELECT ID, Name, Email, COUNT(*)
    FROM _member_data JOIN dbo.Entries ON [Name] = [AssignedTo]
    GROUP BY 1, 2, 3;
"
38247,SQL query - IS NULL,"select ct.CountryId,max(ct.Name) from Country ct
left join City c on ct.CountryId=c.CountryId
left join Airport a on a.CityId=c.CityID
group by ct.CountryId
HAVING max(a.AirportID) IS NULL
"
33919,Choice Table-Column from a variable,"@Id AS int
@Day AS nvarchar,
@RefDayId AS int
AS
DECLARE @sql   varchar(500)
SELECT @sql = 'UPDATE dbo.table1 SET table1.'||@Day||' = '||@RefDayId||' WHERE table1.Id = '||@Id
EXECUTE(@sql)
RETURN
"
32702,Join two tables - One common column with different values,"SELECT COALESCE(A1.DateTime,A2.DateTime) DateTime,ACOQ1_Pump_Running, ACOQ2_Pump_Running
FROM ACOQ1 A1 
FULL OUTER JOIN ACOQ2 A2 
    ON A1.DateTime = A2.DateTime
"
4261,how to execute multiple procedure script in sql-server,"declare @sql nvarchar(max)=''
select @sql+= 'exec pr_tblmaster_split ''tblmaster_'+  Cast(year as nvarchar(4000)) +'''; ' 
from  tblmaster
group by year_id 
order by year_id asc

exec sp_executesql @sql
"
6708,Using a Join query with ignited datatables trying to get a where with two conditions,"$this->datatables->where(""lab.idaccount = $idaccount OR lab.idlab = 0"");
"
4534,SELECT a sequence of numbers and then link to another query,"SELECT * FROM Nums 
left join (SELECT EMAIL, COUNT(EMAIL) as nemail FROM PEOPLE GROUP By EMAIL) as x on 
nemail=n ORDER BY N
"
25327,Copy SQL-Server Login Schema Problems,"exec sp_changedbowner 'sa' -- first change to a known/existing user
exec sp_changedbowner '[insert new owner name here]' -- now change to new owner
"
36947,"Select the first 150 rows, then the next 150 and so on?","SELECT 
    a, b
FROM
    (SELECT rownum rn, a, b from table WHERE c=some_value ORDER BY some_column)
WHERE 
    rn BETWEEN 150 AND 300;
"
17535,How to find sum of qty for each month from the table that keep qty in dozen and piece at the same time?,"SELECT tbl_order.pd_id, 
       Sum(IIf([od_qty_unit]='dz',[od_qty]*12,[od_qty])) AS Qty
FROM tbl_order
GROUP BY tbl_order.pd_id;
"
37028,SQL SELECT names LIKE $name but not exact same name twice,"SELECT custName, date, id 
FROM booking b
INNER JOIN
(
    SELECT max(date) MaxDate, custName
    FROM booking
    WHERE custName LIKE '%$s%'
    GROUP BY custName
) bm
  ON b.custName = bm.custName
  AND b.date = bm.maxDate
WHERE custName LIKE '%$s%'
ORDER BY b.date DESC
"
2668,Max condition for a char datatype column in sql server,"SELECT  MAX(CAST(columnName AS INT)) MAX_VALUE
FROM    tableName
WHERE   ISNUMERIC(columnName) = 1
"
38491,how to update multiple column in a single table,"update [dbo].[HRAllowances] set  Amount=@Amount
"
24904,PostgreSQL - Joining a table to itself,"SELECT a.id,a.name,b.name ""sup name""
FROM tablea a
JOIN tablea b
  ON a.supid = b.id
"
22821,sqlite determine if index is used,"> EXPLAIN QUERY PLAN SELECT * from events WHERE type='comment' AND TIMESTAMP > $time AND PAGE = '$page' LIMIT 1
0|0|0|SEARCH TABLE events USING INDEX MyLittleIndex (page=?)
"
39518,Is there an sqlite function that can check if a field matches a certain value and return 0 or 1?,"SELECT col1, col2 = 200 AS SomeFunction FROM MyTable
"
21653,Group by on PostgreSQL,"select *
from (SELECT au,
             row_number() over (partition by au order by rank desc) as seqnum
      FROM activityupdate au INNER JOIN
           activity ac
           ON au.activity_id = ac.id INNER JOIN
           application ap
           ON ac.application_id = ap.id
      WHERE ap.id = 3
     ) t
where seqnum = 1
"
679,"MySQL same max value, different instances","select * from table 
  join (select day,max(count) as count from table group by day) as max_rec
    on table.day = max_rec.day and table.count = max_rec.count
"
34686,Accessing Data inside an object that is in a VARRAY Oracle,"CREATE TYPE MY_OBJECT AS OBJECT
(
    a_date date,
    a_char varchar2(1)
);

CREATE TYPE MY_COLUMN AS VARRAY(100) of MY_OBJECT;

create table my_table
(
    col1 number,
    my_columns my_column
);

INSERT INTO my_table 
VALUES(1, my_column(my_object(sysdate, 'X')));
"
5186,SQLite -> finding two closest points to two different points,"ORDER BY d1, d2
"
1542,SQL Server query question (Count maybe?),"SELECT  A.shipment_id
        ,COUNT(*) AS boxcount
        ,A.shipment_status
FROM shipments A
join boxes B on A.shipment_id = B.shipment_id
where A.shipment_status = 2
Group by A.shipment_id, A.shipment_status
"
32751,SQL Aggregate Count statement,"SELECT x.AuthorName, COUNT(x2.*) FROM
AuthorBooks x2 INNER JOIN Authors x1 ON x1.AuthorID = x2.AuthorID
GROUP BY x.AuthorName HAVING COUNT(x2.*) > 3
"
27592,SQL View Creation,"SELECT 
  FooUniqueID, Year, Name, Worth
FROM
  FOO
JOIN
  BAR on FOO.Year = BAR.Value
WHERE
  BAR.Name = 'Year' 
"
21586,SQL - selecting first matching record for join,"SELECT 
        items.member_id, items.item_id, items.title, photo.photo_id, photo.blob_id, photo.image_width, photo.image_height
FROM 
        items
JOIN photos on items.item_id = photos.item_id
JOIN (SELECT item_id, min(sort_order) as min_sort_order
        FROM photos
        GROUP BY item_id) min_photo on photos.item_id=min_photo.item_id and photos.sort_order=min_photo.min_sort_order
WHERE items.member_id=1
ORDER BY items.title;
"
10619,select records in a table that are repeated twice using MYSQL,"select list_id
from yourtable
group by list_id
having count(*) = 2
"
6943,how to update sqlite3 database in iphone,"const char *sqlStatement = ""UPDATE frame SET fileExist = '1' WHERE name=?"";

sqlite3_prepare_v2(database, sqlStatement, -1, &compiledStatement, NULL);

sqlite3_bind_text(sqlStatement, 1, variable, -1, SQLITE_TRANSIENT);

int success = sqlite3_step(sqlStatement);

sqlite3_reset(sqlStatement);
"
12629,Perl best way to compare two lists of dates & numbers,"use strict;
use warnings;

use Time::Piece;

my $str1 = '2014-03-27 17:00:00';
my $str2 = '2014-03-28 17:00:00';

my $t1 = Time::Piece->strptime($str1, '%Y-%m-%d %H:%M:%S');
my $t2 = Time::Piece->strptime($str2, '%Y-%m-%d %H:%M:%S');

print ""$t1\n"";
print ""$t2\n"";

my $diff = $t2 - $t1;

print ""$diff\n"";
"
25151,How do I set a variable to the value of only one block in SQL Server,"SELECT @State = state FROM projectlist WHERE project = @project

IF @State = 'active' 
UPDATE ......
ELSE
DELETE .....
"
31472,Mysql query incredibly slow in LEFT JOIN if the given value 0 to the primary id,"SELECT u.id,
           u.name 
      FROM shops s
 LEFT JOIN users u ON u.id IN ( s.user_id, s.owner_user_id )
WHERE s.status = 1
"
38050,Id in database using qt,"qint64 insertID = query.lastInsertId().toLongLong();
"
4043,transform and group data together,"select (case when min(category) <> max(category) then 'Both A and B'
             when min(category) = 'A' then 'A only'
             when min(category) = 'B' then 'B only'
         end)
from t
where code in (1, 2) and category in ('A', 'B');
"
3848,SQL SELECT QUERY COUNT,"select actorID, count(*)
from Roles  
group by actorID  
having count (*) >= 3
"
39499,"Need to query distinct combination of two fields, along with a count that distinct combination occurs","select a,b,count(*) from test
group by a,b
order by a
"
28068,How to reference CLR UDTs when creating a table,"CREATE TABLE dbo.Points 
(
    ID int IDENTITY(1,1) PRIMARY KEY, 
    PointValue Point
)
"
22038,sql query by using join only,"Select * from emp e1 join emp e2
where (e2.Ename = 'Miller' and e1.job = e2.job) 
or (e2.Ename = 'Allen' and e1.sal > e2.sal)
"
19962,sql query for many to one relationship,"select * from 
( 
   select StaffId, max(AssignedFromDate) as adate
   from StaffDepartmentAssgnment 
   group by staffid
) x
inner join StaffDepartmentAssgnment y
      on y.staffid = x.staffid and adate = y.AssignedFromDate
where DepartmentId = 'dept2'
"
18955,How to add the result of a query to another field by some critiria access,"CREATE VIEW view_Stock (IDPRo, IDstock, Quantity) AS 
  SELECT S.IDPro, S.IDstock, SUM (M.Quantity)
  FROM Stock S
  INNER JOIN Moves M
          ON S.IDPRo = M.IDPRo
  GROUP BY S.IDPro, S.IDstock
"
19816,Database design for 2 types of users,"[USER]
user_id (PK)
email
(Other fields common to both)

[USER_NORMAL]
user_id (PK, FK to USER.user_id)
password
(Other fields specific to 'normal')

[USER_FACEBOOK]
user_id (PK, FK to USER.user_id)
fb_userid
(Other fields specific to FB)
"
17272,Populate column from table X with value from table Y,"UPDATE m 
SET m.userid = profiles.userid
from map m
inner join profiles on m.employeeId = profiles.employeeId
"
25688,Fetch Date from database that is shipped with android app,"public Cursor query(String table, String[] columns, String selection, String[] selectionArgs, String groupBy, String having, String orderBy){
    // double check parameters I did type that here (no IDE)
    return myDataBase.query(table, columns, selection, selectionArgs, groupBy, having, orderBy);
}
"
29211,SQL 'like' not detecting delimited multiple values,"(T.Mode IN (@MODE))
"
26008,Constraint primary key,"ALTER TABLE yourTable RENAME CONSTRAINT SYS006321 TO yourNewName;
"
11258,How to use Unique Composite Key,"ALTER TABLE Items ADD UNIQUE INDEX(ItemName, ItemSize);
"
24787,How to enter multiple table data in mongoDB using json,"db.users.update(
    {
        ""student_number"": student_number,
        ""Semester"": semester
    },
    {
        ""$setOnInsert"": {
            ""given_name"": given_name,
            ""family_name"": family_name,
            ""Age"": age            
        },
        ""$addToSet"": { ""courses"": course }
    },
    { ""upsert"": true }
)
"
4512,split string in sql,"DECLARE @Str VARCHAR(120)

SET @Str = 'XXXX YYYY~#0018800~MMMMM~0401'

SELECT SUBSTRING(@Str, CHARINDEX('#', @Str)+1, CHARINDEX('~', @Str)-3)
"
9898,Laravel Data Structure,"$networkable = DB::table('users')->union(DB::table('companies'))->paginate(10);
"
31292,Can I set a column's default to be a character string from another column on the same row within the same table?,"CREATE TABLE employees (
  employeeid INT NOT NULL IDENTITY, 
  firstname VARCHAR(50), 
  middlename VARCHAR(50), 
  lastname VARCHAR(50), 
  assumedfirstname VARCHAR(50), 
  assumedname AS assumedfirstname + ' ' + lastname
);

CREATE TRIGGER MyTrigger on employees
FOR UPDATE, INSERT AS  
UPDATE e 
  SET e.assumedfirstname = COALESCE(e.assumedfirstname, i.firstname)
FROM employees e
JOIN inserted i
  ON i.employeeid=e.employeeid;
"
13857,"SQL Optimization, Nested Query","select t.* from table t
join
(
SELECT ID FROM table
GROUP BY ID
HAVING COUNT(ID) > 1
) a
on a.id=t.id
"
15974,SQL Query Multiple dates to one date,"select `Hostess Code`, DATE_FORMAT(`Datum Bezoek 1`, '%e %M'), count(PA), count(PB), count(PG), GoedkeuringDoorNew, Blanco,... where ... group by DATE_FORMAT(`Datum Bezoek 1`, '%e %M') order by DATE_FORMAT(`Datum Bezoek 1`, '%e %M')
"
1940,Grouping distinct values,"select distinct coalesce(val, 999)
from ((select val1 as val from tablewithvalues) union all
      (select val2 from tablewithvalues)
     ) twv;
"
9269,newid() with Entity Framework 6 Code First,"[DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
public Nullable<Guid> Entity_OID { get; set; }
"
14816,SQL query - need to add most recent date,"SELECT
    Property.ID, 
    Count(Viewings.Property_Viewed) AS ViewingCount,
    MAX(Viewings.Viewing_Date) AS Vdate
FROM
    Property
    LEFT JOIN Viewings
    ON Property.ID = Viewings.Property_Viewed
GROUP BY Property.ID;
"
34023,SQL - how to make a query account for all potential IDs,"TRANSFORM Count(Main.ID) AS CountOfID
SELECT 'Total IDs' AS [Construction site   >>>]
FROM Research LEFT OUTER JOIN Main ON Research.Primary_ID = Main.ID
GROUP BY 'Total IDs'
PIVOT Research.Construction_site;
"
31436,Sum all row exclude the negative numbers in Oracle Reports,"SELECT SUM( case when column_name > 0 
                 then column_name
                 else 0
              end ) sum_of_non_negative
  FROM table_name
"
35009,Efficient query for the first result in groups (postgresql 9),"SELECT name, date
FROM
  (
    SELECT DISTINCT ON (name) name, date
    FROM table
    ORDER BY name, date
  ) AS id_date
ORDER BY date
LIMIT 300;
"
1946,MySQL query table filtering issue,"select * from A where team_id = $team_id join B on B.a_id = A.id
where not exists
(
    select 1 from C where C.clothes_id = B.clothes_id and team_id = $team_id
)
"
34451,merging the lines of a sqlite query,"SELECT 
    MIN(CodeIrrigation) AS 'CodeIrrigation', 
    MIN(CodeSecteur) AS 'CodeSecteur1', 
    MAX(CodeSecteur) AS 'CodeSecteur2'
FROM table
GROUP BY Date_Irrigation
"
20696,How to get sum of rows in resultset?,"select case mod(empno,2)
when 0 then 'EVEN '
else 'ODD  '
end as empno, sum(sal)
from emp
group by mod(empno,2)

UNION ALL

select 'TOTAL' as empno, 
sum(sal)
from emp
"
20914,INSERT SELECT SQL from two tables,"INSERT INTO tbl_StudentPurchaseFromUnibooks (OrderLineID,   StudentID )   
SELECT tbl_OrderLineID.OrderLineID, tbl_Student.StudentID from tbl_OrderLineId left join tbl_Student on ??? WHERE tbl_Student.LoggedIn =""Yes"";
"
30840,How to see co-relation between course grades?,"SELECT qCP.*
FROM (SELECT RollNum, CGPA, Status, Name, FinalGrade
      FROM db
      WHERE Name = 'Computer Programming' 
      AND FinalGrade = 'A') qCP
INNER JOIN 
    (SELECT RollNum 
     FROM db 
     WHERE Name = 'Introduction to Computer Science' 
     AND FinalGrade = 'A') qIntro
ON qCP.RollNum = qIntro.RollNum
"
32850,LEFT JOIN with 3 tables,"SELECT u.unit_name, ur.unit, ur.rate, ur.tax 
FROM units u 
LEFT JOIN reservations r ON r.unit = u.id
AND r.arrival <= 2013-10-11
AND r.departure >= 2013-10-01
JOIN unit_rates ur ON ur.unit = u.id
WHERE r.unit IS NULL
"
18398,How to get database values by week,"WHERE MONTH(RH.DateReleased) = @MONTH 
  AND YEAR(RH.DateReleased) = @YEAR 
  AND DATEPART(WEEK,RH.DateReleased)
       -DATEPART(WEEK,DATEADD(DAY,-DAY(RH.DateReleased)+1,RH.DateReleased))+1 
       = @WEEK
"
5838,Use SQL statement result as string,"           DECLARE @anotherString VARCHAR(10)

           EXEC sp_executeSQL
           'SELECT @output = replace(replace(substring(base_object_name,1,CHARINDEX(''.'',base_object_name) - 1),''['',''''),'']'','''')
           FROM sys.synonyms WHERE name = ''S_LC''', N'@output VARCHAR(10) OUTPUT', @output= @anotherString OUTPUT;
"
37314,Pattern matching on strings from a table in SQL,"select *
from Table t
where exists (select 1
              from PatternTable pt
              where t.Column like pt.Pattern
             );
"
484,JPA -- named-query vs query,"Query query = entityManager.createQuery("" SELECT u FROM Users u"");
"
39378,Laravel 5.2 update datas,"public function update(Request $request) {
   //your code here
}
"
36489,How can I exclude GUIDs from a select distinct without listing all other columns in a table?,"SELECT * INTO #temp FROM table
ALTER TABLE #temp DROP COLUMN id
ALTER TABLE #temp DROP COLUMN msrepl_tran_version
SELECT DISTINCT * FROM #temp
"
37578,Convert Minutes in HH:MM in SQL-Server 2008R2,"select cast(minutescol/60 as varchar(100)) + ':' + 
replicate('0', 2-len(minutescol%60)) + cast(minutescol%60 as varchar(100))
"
15976,Order By using Polish letters,"SELECT   name
FROM     mytable
ORDER BY name COLLATE SQL_Polish_Cp1250_CS_AS_KI_WI
"
35892,MySQL - group rows in 4's," SELECT AffiliateId, ProductCode 
 FROM ( 
    SELECT 
      AffiliateId, ProductCode, 
      IF( @prev <> ID  @rownum := 1, @rownum := @rownum+1 ) AS rank, 
      @prev := ID 
    FROM your table 
 JOIN (SELECT @rownum := NULL, @prev := 0) AS r 
 ORDER BY AffiliateId, ProductCode 
 ) AS tmp 
 WHERE tmp.rank <= 4
 ORDER BY AffiliateId, ProductCode; 
"
8420,Sql Decode in BI-Publisher,"SQL> select DBMS_XMLGEN.CONVERT('HOLLAND &amp; BARRETT',1) from dual;

DBMS_XMLGEN.CONVERT('HOLLAND&AMP;BARRETT',1)
--------------------------------------------
HOLLAND & BARRETT
"
26906,Edit text in columns,"UPDATE example_table
SET product_item_short = SUBSTRING(product_item_short,6),
    product_item_long = SUBSTRING(product_item_long,6);
"
10951,SQL joins - Games where Users can place Bets,"SELECT g.id AS game_id, b.id AS bet_id 
FROM games g LEFT OUTER JOIN bets b ON g.id=b.game_id AND b.user_id = 1
"
30393,Parent Child Relationship - SQL,";WITH x as (
SELECT 
    Id, DepartmentName, 
    CAST(0 AS INT) AS 'ParentID',
    CAST(DepartmentName AS VARCHAR(1000)) AS fullname
FROM Departments
WHERE ParentID = 0

UNION ALL

SELECT 
   t2.Id, t2.DepartmentName, t2.ParentID,
   CAST(g.fullname + ' > ' + t2.DepartmentName AS VARCHAR(1000))
FROM Departments t2
INNER JOIN x g ON t2.ParentID = g.Id
)
SELECT * FROM x
"
2228,Which product is ordered most frequently?,"select top 1 ProductID, count(ProductID)
from OrderLine_T
group by ProductID
order by 2 desc;
"
9430,Using the output of an SQL statement in another SQL statement?,"SELECT event.event_id,booking.* 
FROM event
JOIN booking on event.event_id=booking.event_id
WHERE booking.user_id='$id';
"
22928,MS Access SQL: Use a field value to determine proper field to use in calculation,"ID                  Primary Key
ParentID            Foreign Key
PeriodID            Identifies the period
Value               The value of the Period for the given parent.
"
20413,postgresql function confusion,"select length(' '::character(1));
 length
--------
      0
(1 row)
"
35238,"SQL query does not work in VB6, but the same query works properly in Oracle","Select * 
 from crdh 
where expdate between (TO_DATE('03-12-2002','DD-MM-YYYY')) 
  and (TO_DATE('31-12-2012','DD-MM-YYYY')) 
  and CS='AA'
"
29686,How to evaluate an expression for last 12 weeks in SSRS,"SELECT TOP 12 [Date], [Abandon_Rate]
FROM
[db].[dbo].[table]
ORDER BY CONVERT(DATE,[Date]) DESC
"
8700,Get most expensive and cheapest items from two tables,"SELECT TOP 1 FIRST_VALUE(Price) OVER (ORDER BY Price) AS MinPrice,
           FIRST_VALUE(Name) OVER (ORDER BY Price) AS MinName,
           LAST_VALUE(Price) OVER (ORDER BY Price DESC) AS MaxPrice,
           LAST_VALUE(Name) OVER (ORDER BY Price DESC) AS MaxName
    FROM (
        SELECT ExtrasName AS Name, ExtrasPrice AS Price FROM Extras
        UNION ALL
        SELECT ItemName As Name, ItemPrice AS Price FROM Items) u
"
9442,How to extract out all multiple ID's of the same person in MYSQL,"SELECT a.songid FROM db.songs a 
INNER JOIN db.artists b on b.artistid=a.artistid
WHERE b.artistname='AKON'
"
2650,It is possible to do a autonumber sequence in a SELECT on Oracle?,"select 
  rownum
from 
  dba_objects, 
  dba_objects
where
  rownum <= 9000;
"
22179,Tune the PLSQL limit parameter in bulk update,"UPDATE table_user_backup tub
   SET (sirname, sirname_date) = (SELECT sirname, sysdate
                                    FROM table_user tu
                                   WHERE tu.id = tub.id)
 WHERE EXISTS( SELECT 1
                 FROM table_user
                WHERE tu.id = tub.id);
"
4416,Compare two tables and select the record that is no in table 2,"select coalesce(t1.id, t2.id) id, t1.name new_name, t2.name old_name,
    case when t1.id is null then 'row deleted'
         when t2.id is null then 'row inserted'
         when t1.name <> t2.name  
           or t1.name is null and t2.name is not null
           or t1.name is not null and t2.name is null
         then 'data changed'
    end change
  from t1 full join t2 on t1.id = t2.id order by id
"
4199,Case in nested select,"SELECT l.*,
Credit = (
   CASE WHEN ISNULL(M.POSTCODE,'') <> '' THEN
     (SELECT sum(Credit) from Balance cb Where LEFT(LTrim(cb.AccountHolder),4) LIKE LEFT(LTrim(m.Company),4))
   ELSE
     (SELECT sum(Credit) from Balance cb Where LEFT(LTrim(cb.AccountHolder),4) LIKE LEFT(LTrim(m.Company),4))
   END 
) 
FROM live l 
    INNER JOIN master m on m.ClientID = L.ClientID 
WHERE ClientID = 12345
"
15568,SQL SELECT WHERE subquery (multiple rows) = subquery (multiple rows),"SELECT result FROM t_courseResults WHERE PersonId IN (
  SELECT p.ID FROM t_staticList AS s
  INNER JOIN t_people as p ON p.ID = s.PersonId
  WHERE p.surname like '%B')
"
5070,How do not to round the number in SQL,"SELECT
  Customer,
  JobType,
  sum(SThours),
  sum(OThours),
  SortMonth,
  str((CAST(sum(OThours) AS DECIMAL)/sum(SThours) ),5,2) AS Ratios
FROM
   #data
GROUP BY
  Customer,  JobType,  SortMonth
"
16890,Inserting strings into an SQL table depending on what results a query returns,"DECLARE @testStatus NVARCHAR(MAX);

IF (
    SELECT COUNT(*)
    FROM Table1
    WHERE Table1.Column1 = ''
) = 0
    SET @testStatus = 'Test Passed'
ELSE
    SET @testStatus = 'Test Failed'

INSERT INTO Table2 (FileName, Date, Result)
VALUES ('File1', GetDate(), @testStatus)
"
16573,SQL Update doesn't save affected rows?," declare @sql varchar(1000)
 set @sql = 'UPDATE #tablenamenotrelevant# SET ' + @field + ' = 1 WHERE [MemberId] = 1060;'
 exec (@sql)
"
23119,oracle spatial sdo_on function returns no rows,"LOC  LOC_1
----------
LINE RECT
"
17532,How to link 4 tables using an mySQL query,"SELECT *
FROM Vehicle v
INNER JOIN Info   i ON          v.id = i.vehicle_id
INNER JOIN Axle1 a1 ON i.vehicle_id  = a1.vehicle_id
INNER JOIN Axle2 a2 ON a1.vehicle_id = a2.vehicle_id 
"
7526,Select randomly And Sort the records,"SELECT ID,name,level
FROM sample
ORDER BY level DESC,NEWID()
"
15563,SQL from where like with or statement,"def apps = Application.findAll(""from Application as app 
                                where lower(app.name) like '%${params.query.toLowerCase()}%' 
                                and app.language = userLanguageParameter
                                and app.status <> inactiveAppStatus "");
"
23374,Count rows in a table according to criteria in another table,"select count(*) as totalbookingcriteria 
  from public.booking b 
     INNER JOIN public.facility f 
           ON ( b.ID_FACILITY = f.ID ) 
 where f.hour = '9:00' 
   and f.name = 'Swimming Pool' 
"
34885,Read-only committed data,"select * from test with(readpast) 
"
28754,Simple calculation in SQL Server,"CREATE PROCEDURE SumDistances
AS
BEGIN
    SELECT SUM(Distance)
    FROM MyTable
END
"
32260,SQL query for accumulated sum using window function in postgresql,"SELECT id, sum(distance) OVER (ORDER BY id) AS cum_dist
FROM  (
   SELECT id, st_distance(geom, lag(geom, 1) OVER (ORDER BY id)) AS distance 
   FROM   foo
   ) sub
ORDER  BY id;
"
28659,Selecting the count of rows on second table based on foreign key in MySQL,"SELECT a.album_id, a.album_name, a.album_preview, a.album_owner, a.album_time, a.album_access, COUNT(i.*) AS images 
FROM imgzer_albums a 
LEFT JOIN imgzer_images i 
    ON a.album_id = i.album_id 
WHERE album_owner = SOME_VALUE
GROUP BY a.album_id
"
9131,SQL How do I use the parentheses correctly to separate the AND and OR statements?,"(DATE_SUB(expirationDate, INTERVAL 30 DAY) BETWEEN DATE_SUB(NOW(), INTERVAL 3 DAY) AND NOW())
AND
(DATE_ADD(warnedDate, INTERVAL 4 DAY) <= NOW())
"
1279,MySQL - Update with counter based on subquery,"UPDATE Table1 t1
JOIN (
   SELECT `PrimaryId`,
          `SecondaryId`,
          (SELECT count(*)
           FROM Table1 t1
           WHERE t1.`SecondaryId` = t.`SecondaryId`
            AND t1.`PrimaryId` <= t.`PrimaryId`
           ) `Order`
   FROM Table1 t
) t2
ON t1.`PrimaryId` = t2.`PrimaryId`
SET t1.`Order` = t2.`Order`
;
"
18277,SQL time query from 6pm at night to 6am,"SELECT COUNT(barcode)
FROM table1
WHERE timestamp >= DATEADD(HOUR,18,CONVERT(VARCHAR(10), GETDATE(),110))
  AND timestamp <= DATEADD(HOUR,6,CONVERT(VARCHAR(10), GETDATE()+1,110))
"
28865,Wrong Min value returned from list - MS Access Query," Select min(val([MinVal])) as MinimumVal from 
        ( SELECT Minimum([Day1],[Day2],[Day3],[Day4],[Day5],[Day6],[Day7],
        [Day8],[Day9],[Day10],[Additional]) as [MinVal] from Tasks) t ;
"
4602,Left joining only one result of corresponding table,"SELECT
    p.id
,   p.title
,   MIN(o.price) as min_price
,   MAX(o.price) AS max_price
FROM products p
LEFT JOIN offers o ON o.product_id = p.id
GROUP BY p.id, p.title
"
30795,query on two conditions without in,"select * from conv_master cm 
inner join currency_master m1  on cm.from_currency_id = m1.currency_id
inner join currency_master m2  on cm.to_currency_id = m2.currency_id
where m1.currency_code='USD' and m2.currency_code='EUR'
"
16545,MySQL joining tables gives unexpected output,"SELECT 
  table_A.*,
  table_B.*,
  table_C.*,
  table_D.*
FROM table_A
  INNER JOIN table_B ON
    table_A.my_field = table_B.my_field
  LEFT JOIN table_C ON
    table_B.my_field = table_C.my_field and table_B.complete ='1'
  LEFT JOIN table_D ON
    table_C.my_field = table_D.my_field 
"
5987,use oracle extract regular expression match the last appeared year in result,"[0-9]{4}[^;]*$
"
8851,substringing on a character in db2,"concat('Harry # ',substr( xmlserialize( xmlagg( xmltext( concat( ', ', substr(myTable.salary, locate('.',myTable.salary)+1) ) ) ) as varchar( 1024 ) ), 3 ))
"
31306,SQL Query Between 2 Dates or first one before,"(SELECT p.*
 FROM prices p
 WHERE activation_date BETWEEN '2014-12-09' AND '2014-12-14'
) UNION ALL
(SELECT p.*
 FROM prices p
 WHERE activation_date < '2014-12-09' AND
       NOT EXISTS (SELECT 1 FROM prices p2 WHERE activation_date BETWEEN '2014-12-09' AND '2014-12-14')
 ORDER BY activation_date DESC
 LIMIT 1
);
"
3728,I need a sql query to group by name but return other fields based on the most recent entry,"SELECT a.callerFName, a.callerLName, a.callerDOB, a.createdOn, a.phoneNoteId
FROM phoneCallNotes as a
LEFT JOIN phoneCallNotes as b
ON b.callerFName = a.callerFName
AND b.callerLName = a.callerLName
AND b.callerDOB = a.callerDOB
AND b.createdOn > a.createdOn
WHERE a.callerLName LIKE 'Public'
AND b.phoneNoteId IS NULL
"
16177,really return id column when we make insert row?,"INSERT INTO test
  (ID, Name)
VALUES
  ('$ID', '$Name');

SELECT LAST_INSERT_ID();
"
39895,Relational Algebra - Select with no predicate,"<selection condition>(R)
"
10860,Getting a rank from ActiveRecord,"def rank
  User.where(""points > ?"", points).count + 1
end
"
7492,"Join a table representing a ""transfer"" between two rows of another table","SELECT aid, from_b.name, to_b.name, amount
FROM   a
JOIN   b from_b ON from_b.bid = a.fromid
JOIN   b to_b ON to_b.bid = a.toid
"
15028,implementing Some kind of pivot in mysql,"SELECT
  m.Id,
  m.Name,
  m.LastName, 
  m.UserName,
  MAX(CASE WHEN i.Type = 'Avetar' THEN i.Image END) AS 'Image1',
  MAX(CASE WHEN i.Type ='Gallery' THEN i.Image END) AS 'Image2'
FROM member AS m
LEFT JOIN image AS i ON m.Id = i.MemberId
GROUP BY m.Id,
         m.Name,
         m.LastName, 
         m.UserName;
"
1571,Filemaker Pro 12 create a summary table,"PLAYER_ATTEMPTS_TB::Game_Level
"
30711,SQL specific question - get child that belong to all item of a collection,"Select cityname, count(distinct userID) 
from  User u inner join Person p on  u.personID = p.personID 
inner join Adresse a on  p.addressID = a.addressID
inner join City c on a.cityID = p.cityID 
group by cityName
"
19228,Complex count based on the latest date of a month,".extra(
    where=[""""""history_date = (SELECT MAX(history_date) FROM historical_record hr
                              WHERE hr.history_id = historical_record.history_id
                                    AND hr.history_date < %s)""""""],
    params=[month_end]
)
"
39852,How to get records of last working day using sql server," select ProductName , count(ProductName) as [No Of Products],SUM(Total) as [TotalCost] 
    from dbo.TransactionDetails 
    where CurrentTime >=dateadd(day,datediff(day,1,(select MAX(CurrentDateTime) 
    from CloseShifts)),0) 
    AND CurrentTime <dateadd(day,datediff(day,0,(select MAX(CurrentDateTime) 
    from CloseShifts)),0) 
    and  Transaction='BUY' 
    group by ProductName
"
15083,how to prevent MySql Cross Join Query returning zero results if one of the queries returns null,"SELECT e.id AS current, prev.id AS previous, next.id AS next 
FROM events e 
LEFT JOIN  
( 
    SELECT id FROM events  
    WHERE date < '{$result['date']}'  
    ORDER BY date DESC  
    LIMIT 1 
) ON prev 1=1 
LEFT JOIN  
( 
    SELECT id 
    FROM events  
    WHERE date > '{$result['date']}'  
    ORDER BY date  
    LIMIT 1 
) ON next 1=1 
WHERE e.date = '{$result['date']}' 
"
21628,how to get avg time in postgresql,"postgres=# SELECT *, total_time / number AS avg_time 
    FROM (SELECT INTERVAL '00:02:28' AS total_time, 10 AS number) a;
 total_time | number |  avg_time  
------------+--------+------------
 00:02:28   |     10 | 00:00:14.8
(1 row)
"
23607,How can I normalize data field in Access that has comma delimited values,"1. Created a Header table that stores all the ""Header Data"", in your case ProdID,Value

2. Created a table containing ""Detail Data"" in your case ProdID,RowNo,Color

3. Insert all Row's ProdID into Header Table
4. Split the values in  the field Color based on index of (,)Comma. For each Substring insert a row into Detail table with ProdID,RowNo,Substring as color.
"
21399,SQL combined SELECT statement,"SELECT name, continent, population 
FROM world w
WHERE NOT EXISTS (                  -- there are no countries
   SELECT *
   FROM world nx
   WHERE nx.continent = w.continent -- on the same continent
   AND nx.population > 25000000     -- with more than 25M population 
   );
"
13433,SQL query for finding pairs that share the exact same set of values,"select a.employee_name,b.employee_name
from tasks as a, tasks as b
where a.employee_name>b.employee_name
group by a.employee_name,b.employee_name
having group_concat(distinct a.task order by a.task)=group_concat(distinct b.task order by b.task)
"
19826,Oracle SQL to Sort Version Numbers,"select version_number 
from mytable 
order by substr(version_number, 1, instr(version_number,'.')-1) desc
        ,length(substr(version_number, instr(version_number,'.')+1)) desc
        ,substr(version_number, instr(version_number,'.')+1) desc
"
14994,PostgreSQL columns to rows with no explicilty specifying column names / columns,"SELECT id, skeys(hstore(users)) AS column, svals(hstore(users)) AS value FROM users;
"
33764,Count number of Rows with the same value in a Column,"SELECT book_count,a.author_id,a.fn, a.ln 
FROM author a
JOIN
(
  SELECT c.author_id,COUNT(*) book_count FROM book c
  GROUP BY c.author_id
) b 
ON a.author_id = b.author_id
ORDER BY book_count DESC LIMIT 1
"
34453,SQL - decrease value to zero,"UPDATE table
    SET value = value - 1
    WHERE id = 1 AND value > 0;
"
20692,SQL Update - Multiple Columns,"update tbl1
set col1 = a.col1, col2 = a.col2, col3 = a.col3
from tbl2 a
where tbl1.Id = 'someid'
and a.Id = 'differentid'
"
34376,dynamic update table from csv on multiple columns,"MERGE PermanentT AS [TARGET]
USING #TempT AS [SOURCE]
ON [TARGET].PrimId = [SOURCE].PrimId
    AND [TARGET].MyDates = [SOURCE].MyDates
WHEN MATCHED AND [TARGET].PRICE <> [SOURCE].PRICE
THEN UPDATE SET [TARGET].PRICE = [SOURCE].PRICE
WHEN NOT MATCHED
THEN INSERT (PrimID, myDate, myPrice) 
VALUES (SOURCE.PrimID, SOURCE.myDate, SOURCE.myPrice);
"
33857,"Meta table VS table with many fields, on a large scale. Performance-wise","- Entity    = User, in your Wordpress Example  
- Attribute = 'First Name', 'Last Name', etc  
- Value     = 'John', 'Smith', etc  
"
16286,SQL select step,"DECLARE @start int = 3,  @step int = 2,  @stop int = 7;

;WITH cte AS
(
    SELECT @start AS ID
    UNION ALL
    SELECT ID + @step FROM cte WHERE ID + @step <= @stop
)

SELECT * 
FROM cte JOIN MyTable M ON cte.ID = MyTable.ID
"
26480,Retrieve two different fields for a joined table with repeated foreign key,"select g.*,
       'DOSE UNITS' = (CASE WHEN CHECK_UNIT IS NULL THEN du.UNIT_DESCR
                            ELSE CONCAT(du.UNIT_DESCR+'/'+cu.UNIT_DESCR)
                       END) 
from groups g left outer join
     units cu
     on g.check_unit_id = cu.unit_id left outer join
     units du
     on g.drug_unit_id = du.unit_id
"
18856,Selecting maximum column and row id,"SELECT MAX(a.seq), (SELECT id FROM t1 as b where b.ident=a.ident AND MAX(a.seq) = b.seq LIMIT 1) as id FROM t1 AS a GROUP BY a.ident;
"
1910,Date conversion failed from string,"SELECT CONVERT(datetime, '20/04/2013', 103)
"
19909,I need to get an output like below from a single SQL query to dual table. How to do it?,"with nums as (
    select rownum num from dual connect by level <= 2
)   
select 1, a.num as l, b.num as r
from nums a, nums b;
"
14077,SQL all students who are older than the youngest teacher?,"select s_id, s_firstname
from s_schueler 
where s_gebdatum > (select max(l_gebdatum) from l_lehrer); 
"
35490,How can i count all likes from another tabel?,"SELECT tbl_posts.*,tbl_users.name,COUNT(tbl_posts_likes.user_id) AS likes
FROM tbl_posts 
INNER JOIN tbl_users ON tbl_posts.user_id = tbl_users.id 
LEFT JOIN tbl_posts_likes 
ON tbl_posts.id = tbl_posts_likes.post_id
group by tbl_posts.id
"
17525,Change SQL query of split form and refresh to get new result,"Me.recordsource = query.SQL
"
9249,return 0 is count for particular condition is NULL,"select DATE(feed_date) as fdate, 
       SUM(id = 8671) as count 
from table 
group by fdate
"
25430,Load parameter from second mysql table when ID equals,"SELECT m.id, m.category_id, m.menu_name, m.image_id , i.file_url
FROM menu m 
INNER JOIN icon i
ON i.id = m.image_id
WHERE m.restaurant_id = '"" . (int) $_SESSION['uid'] . ""' 
AND  m.status='1'
"
22464,How to make database connection with oracle in delphi xe2 using TADOConnection?,"Provider=OraOLEDB.Oracle
"
27135,Query on mysql with inner join,"SELECT * 
FROM `jos_clientes_contratos` 
LEFT JOIN jos_users 
 ON jos_clientes_contratos.cpf_cnpj_cliente = jos_users.username
WHERE jos_users.username is null
"
4540,How do I generate a series of hourly averages in MySQL?,"SELECT AVG( value ) , thetime
FROM hourly_averages
GROUP BY DATE( thetime ), HOUR( thetime )
"
14109,IBM i UNION *ALL used here,"CREATE VIEW yourViewName AS 
SELECT *
FROM JETDTA.EODDETAILH
UNION
SELECT *
FROM JETDTA.EODDETAILS
"
27936,Convert MySQL Month/Year to Datetime or Unixtime," mysql> select date_format(str_to_date('February 2015','%M %Y'),'%Y-%m-01 %H:%i:%s') as date;
+---------------------+
| date                |
+---------------------+
| 2015-02-01 00:00:00 |
+---------------------+
1 row in set (0.00 sec)
"
6720,SQL: Select all values from one table in a join while not knowing all column names?,"SELECT tget.* FROM contact AS tget ...
"
14136,How to list columns name from any sql query,"sql = ""SELECT * FROM users;""
res_proxy = session.execute(sql)
column_names = res_proxy.keys()
"
25672,How to update time in the timestamp column in oracle?,"UPDATE table_name
   SET timeout  = timeout + interval '12' hour
 WHERE timeout > timein;
"
10381,how to write sql query? for ms sql server,"UPDATE b
SET    Amount = b.Amount + a.People
FROM DB2.dbo.TableB b
INNER JOIN DB1.dbo.TableA a
  ON  a.UserId = b.UserId
"
31524,Using SYS_REFCURSOR returned from a FUNCTION in SELECT statement,"VARIABLE cur REFCURSOR;
BEGIN
  :cur := test();
END;
/
PRINT cur;
"
15653,Most efficient/succinct way of combining queries with a filter?,"SELECT dc.content, dc.state
FROM destination_content dc
INNER JOIN properties p ON  ( dc.state = p.state AND dc.content = p.content )
WHERE p.active = 1
"
18547,What is the best way to check for the existence of a Login in SQL Server 2005,"select * from master.sys.syslogins WHERE [name] ='loginname'
"
22695,How can I select the record with the 2nd highest salary in database Oracle?,"select * from (
  select e.*, row_number() over (order by sal desc) rn from emp e
)
where rn = 2;
"
76,SQL group by with a count,"SELECT  company
FROM    tableName
GROUP   BY company, name
HAVING  COUNT(DISTINCT age) <> 1
"
426,Build a latest table from a history table using max(),"INSERT INTO mls                -- assuming it's empty
SELECT DISTINCT ON (mlsnum) *
FROM   mls_history
ORDER  BY mlsnum, stat_date DESC;
"
3241,efficiently compute percentages in hive or sql,"SELECT COUNT(DISTINCT case when tag = FRAUD then account_id end) as distinct_fraud,
       COUNT(DISTINCT case when tag = FRAUD then NULL else account_id end) as distinct_notfraud,
       (COUNT(DISTINCT case when tag = FRAUD then account_id end)*1.0/count(distinct account_id)
       ) as fraud_rate
    FROM fraud_tags ft;
"
30217,"Query returning users, first record and last record","select 
    u.userid as [Userid],
    u.username as [UserName],
    min([Date]) as [First Log Date],
    max([Date]) as [Last Log Date]
from users u 
inner join log l on u.userid = l.userid
group by u.userid, u.username 
"
39018,Oracle : Checking for NOT NULL in Tuples,"select orders.* from orders where Delivery_Date is not null or type !='A'
 /*Assuming type as a char field and this query will output all records 
             excluding deliverydate_null with type ='A' */
"
1998,Select field from a table its name come from an other select,"DECLARE @TableName NVARCHAR(MAX)
DECLARE @Sql NVARCHAR(MAX)

SELECT @TableName = ad_table.tablename
FROM ad_table
WHERE ad_table.ad_table_id =fact_acct.ad_table_id

SET @Sql='SELECT documentNo FROM '+@TableName

EXEC(@Sql)
"
16032,T-SQL creating a dynamic where statement?,"declare @sql nvarchar(max);
set @sql = N'select * from table where ' + quotename(@search) + N'=''1''';
exec sp_executesql @sql;
"
17692,"Is there a way to return SELECT results sorted by order of ""WHERE IN"" values?","SELECT * FROM tablename WHERE id IN (5,3,8,9)
ORDER BY 
CASE id
    WHEN 5 THEN 1
    WHEN 3 THEN 2
    WHEN 8 THEN 3
    WHEN 9 THEN 4
    ELSE 5
  END
"
23638,How to get the correct format of date,"declare @UNIX_TIME int
select @UNIX_TIME = 1111111111
-- Using dateadd to add seconds to 1970-01-01
select [Datetime from UNIX Time] = dateadd(ss,@UNIX_TIME,'1970-01-01')
"
1241,ORACLE JOIN TABLES,"select coalesce(t1.user_id, t2.user_id) as user_id,
       t2.android, t1.osx
from t1 full join
     t2
     on t1.user_id = t2.user_id;
"
19117,How to find list of tables having no records in SQL server,"SELECT 
    t.NAME AS TableName,
    p.rows AS RowCounts
FROM 
    sys.tables t
INNER JOIN 
    sys.partitions p ON t.object_id = p.OBJECT_ID 
WHERE 
    t.NAME NOT LIKE 'dt%' 
    AND t.is_ms_shipped = 0
    AND p.rows = 0
GROUP BY 
    t.Name, p.Rows
ORDER BY 
    t.Name
"
28400,"SQL XML XQUERY - Looks right, NULL/empty value returned","EXECUTE sp_executesql @SqlCmd, N'@ContactID nvarchar(20) out, @ContactData XML',@ContactID out, @ContactData
"
26002,Why MySQL isn't using my FULLTEXT indexes?,"glean2_saves(username, ses_id, save_status, id)
"
16211,SQL Distinct Query for Two Tables,"SELECT table1.*, GROUP_CONCAT(table2.job), GROUP_CONCAT(table2.date)
FROM table1
INNER JOIN table2 ON (t1.id = t2.finished_by)
GROUP BY t1.id
"
11245,Webmatrix csv import to SQL Server Compact,"var db = Database.Open(""your_db"");
var data = File.ReadAllLines(path_to_csv_file);
foreach(var row in data){
    var columns = row.Split(new []{';'});
    var sql = ""INSERT INTO MyTable (f1, f2, f3, etc) VALUES (@0, @1, @2, etc)"";
    db.Execute(sql, item[0], item[1], item[2], etc);
}
"
10110,Is there a better way to extract the time of day?,"SELECT
    CAST(colname AS time)
FROM
    tablename;
"
7816,SQL: How to get relational data from two tables? (Using JOIN ?),"SELECT CUSTOMERS.ID, CUSTOMERS.CUSTOMER_NAME, TO-DOS.TASK 
FROM TO_DOS
INNER JOIN CUSTOMERS 
ON TO_DOS.CUSTOMER_ID = CUSTOMERS.ID
WHERE CUSTOMERS.COMPANY_CONTACT = 1
"
37496,Command DELETE dont work in vba,"Set dbs = CurrentDb
dbs.Execute ""DELETE * FROM TMP WHERE diaMes = "" & _
            Format(tmp7, ""\#mm\/dd\/yyyy\#"")
"
17728,Get the deviation of values between two dates in Sql server,"SELECT test_alias, max(test_value) - min(test_value) AS deviation
  FROM my_table
  WHERE run_date >= Dateadd(month, -3, Getdate())
  GROUP BY test_alias
  HAVING (max(test_value) - min(test_value)) BETWEEN 2 AND 4
"
8800,Need a hand with a simple query,"select name, count(*) from names group by name;
"
11780,SQL Finding two duplicated strings,"Select s.*
From stackoverflow as s inner join
(Select stack1, count(*)
From stackoverflow
Group by stack1
Having count(*) > 1) as dups
On s.stack1 = dups.stack1
"
20608,"MS SQL ""ON DELETE CASCADE"" multiple foreign keys pointing to the same table?","create trigger T_Insights_D
on Insights
instead of delete
as
    set nocount on
    delete from broader_insights_insights
    where insight_id in (select ID from deleted) or
    broader_insight_id in (select ID from deleted)

    delete from Insights where ID in (select ID from deleted)
"
21286,MySQL OUTER LEFT JOIN performance,"SELECT *, a.id as `tag_id`, a.tag, a.type
FROM items LEFT OUTER JOIN
     (SELECT id, item_id, tag, type from itemtags ORDER BY 1,2,3) a
     ON items.id = a.item_id
ORDER BY items.id;
"
13332,MS Access fields as columns,"TRANSFORM Sum(tabl1.[Quantity]) AS SumOfQuantity
SELECT tabl1.[brand], Sum( tabl1.[Quantity]) AS [Total Of Quantity]
FROM tabl1
GROUP BY tabl1.[brand]
PIVOT tabl1.[Date];
"
28284,"MySQL, compare date is less then another when in format DD-MMM-YYYY","WHERE STR_TO_DATE(due, '%d-%b-%Y') < NOW()
"
22977,Generating number,"select a,b,
rank() over (partition by b order by a) c 
from tbl
order by a;
"
39706,MySQL - Group By SUM with two tables,"select  e.department_emp
,       sum(p.price)
from    (
        select  distinct department_emp
        ,       number_project
        from    Employee
        ) e
join    Projects p
on      p.code_project = e.number_project
group by
        e.department_emp
"
3621,SQL selection over two rows,"SELECT a.object 
FROM mytable a, mytable b 
WHERE a.object = b.object 
  AND a.key = 'a' AND a.value = 'A'
  AND b.key = 'b' AND b.value = 'B'
"
37559,How to insert one column into other column within the same table in SQL Server,"UPDATE table
SET col_2 = col_1
"
30399,Viewing a very large CSV file?,"/* the columns in this table are the same as the columns in your csv: */
create table if not exists my_csv (
  some_field text, ...
);

/* COPY appends, so truncate the table if loading fresh data again: */
truncate table my_csv;

/* 
you need to be a postgres superuser to use COPY 
use psql \copy if you can't be superuser 
put the csv file in /srv/vendor-name/
*/

copy 
  my_csv 
from 
  '/srv/vendor-name/my.csv'
with (
  format csv
);
"
6688,How to aggregate 7 days in SQL,"SELECT DATEPART(ww, DATEADD(d,-2,[DATE])) AS WEEK_NO, 
       SUM(Bread) AS Bread_Total, SUM(Milk) as Milk_Total
FROM YOUR_TABLE
GROUP BY DATEPART(ww, DATEADD(d,-2,[DATE]))
"
3211,Eliminate NULL values,"SELECT MAX(A) AS A,MAX(B) AS B
FROM Table_Name
"
27215,How to count the number of duplicate records in a database?,"select user_id, sum(count)
from
(
select user_id, text, count(tweet_id) count
from tweets 
group by 
user_id, text
having count(tweet_id) > 1
) t
group by user_id
"
20535,REGEXP_SUBSTR Is taking more time for execution in Oracle,"WHERE email IN (
  select regexp_substr('one@gmail.com,two@gamil.com,three@gmail.com,four@gmail.com','[^,]+', 1, level) from dual
  connect by regexp_substr('one@gmail.com,two@gamil.com,three@gmail.com,four@gmail.com', '[^,]+', 1, level) is not null );
"
33719,Current date in Oracle Db,"SELECT ""DATE"", BUS, VALUE
FROM {your_table}
WHERE ""DATE"" >= trunc(sysdate) and ""DATE"" < trunc(sysdate+1)
"
27656,Counting the number of transactions by left joining a category table,"SELECT
  Category.ID,
  COUNT(Trxn.Cat_ID)
FROM
  Category
LEFT JOIN
  Trxn
  ON Category.ID = (rtrim(Trxn.Cat_ID)+ltrim(Trxn.STV))
  AND Trxn.Status='ok'
WHERE Category.Status='A'
GROUP BY Category.ID
"
5687,Check constraint that checks another column value,"ALTER TABLE ADD CONSTRAINT A_B_Check
CHECK (
        ColumnA IS NOT NULL 
    OR (ColumnA IS NULL AND (ColumnB <> 8802 AND ColumnB <> 8804))
);
"
34169,MAX on columns generated by SUM and GROUP BY,"SELECT SUM(video_plays) AS total_video_plays
FROM `video_statistics` v_stat
GROUP BY v_stat.`video_id` 
ORDER BY total_video_plays DESC 
LIMIT 1 
"
20537,Cannot execute script: Insufficient memory to continue the execution of the program,"SQLCMD -d database -i filename.sql
"
30268,SQL query results Need to Return all records in WHERE clause even duplicates,"SELECT tb1.* 
FROM   (VALUES ('000520'), 
               ('000531'), 
               ('000531'), 
               ('000636')) tc (hdrcode ) 
       JOIN table1 tbl1 
         ON tc.hdrcode = tb1.hdrcode 
"
2746,joining with a group by and pivot,"SELECT
tbl1.qNum,
MAX(CASE when tbl2.displayNum=1 then 1 else 0 end) AS filter1,
MAX(CASE when tbl2.displayNum=2 then 1 else 0 end) AS filter2,
MAX(CASE when tbl2.displayNum=3 then 1 else 0 end) AS filter3,
MAX(CASE when tbl2.displayNum=4 then 1 else 0 end) AS filter4,
MAX(CASE when tbl2.displayNum=5 then 1 else 0 end) AS filter5
FROM
tbl1
Left Join tbl2 ON tbl1.qNum = tbl2.qNum
GROUP BY
tbl1.qNum
"
3818,MySQL: Query for most recent entires of distict fields set prior to specified date,"select c.*
from components c
where c.date = (select max(c2.date)
                from components c2
                where c2.sys_id = c.sys_id and
                      c2.serial_num = c.serial_num and
                      c2.date <= '2010-02-05'
               );
"
16109,Organizing query results from Microsoft sql server 2008,"select ownername,
       hotel,
MAX(CASE 
    WHEN ownername = salescashier and drinksales ='pepsi' then 'y'
    else 'n'
END) as pepsi,
MAX(CASE 
    WHEN ownername = salescashier and drinksales ='mountaindew' then 'y'
    else 'n'
END) as mountainDew
FROM HotelDrinksOrders
GROUP BY ownername,hotel
"
6292,Calculating aggregated field,"HAVING EXTRACT(DAY FROM MAX(plans.updated_at) - MIN(plans.created_at)) > 0
"
34522,SQL - Pivot/Unpivot?,"SELECT 'Miles' AS Type, SUM(CASE WHEN date = lastweek THEN miles ELSE 0 END) as lastweek
, SUM(CASE WHEN date = thisweek THEN miles ELSE 0 END) as thisweek
SUM(CASE WHEN date = lastweek THEN miles ELSE 0 END) - SUM(CASE WHEN date = thisweek THEN miles ELSE 0 END) as variance
FROM yourtable
UNION
SELECT 'Cost' AS Type, SUM(CASE WHEN date = lastweek THEN cost ELSE 0 END) as lastweek
, SUM(CASE WHEN date = thisweek THEN cost ELSE 0 END) as thisweek
SUM(CASE WHEN date = lastweek THEN cost ELSE 0 END) - SUM(CASE WHEN date = thisweek THEN cost ELSE 0 END) as variance
FROM yourtable
"
15452,How to get sum of records based on another column?,"SELECT   JobCode, designation, SUM(salaryWithIncrement)
FROM     table1
GROUP BY JobCode, designation
"
33889,T-SQL: Deleting all duplicate rows but keeping one,"WITH cte AS (
  SELECT[foo], [bar], 
     row_number() OVER(PARTITION BY foo, bar ORDER BY baz) AS [rn]
  FROM TABLE
)
DELETE cte WHERE [rn] > 1
"
11521,"Order by date, if name not found order by time","ORDER BY CASE
  WHEN date IS NOT NULL AND time < date THEN date
  WHEN time > date OR date IS NULL THEN time
  ELSE time
END
"
3260,Finding parents by matching on children FKs,"SELECT  * FROM Playlists WHERE ID IN(
SELECT PlaylistId FROM PlaylistItems where Title LIKE '%Geographer - Kites%'
INTERSECT
SELECT PlaylistId FROM PlaylistItems where Title LIKE '%Sam Kang%')
"
26437,How to do full outer join in MySQL,"select t1.id,t1.c, t2.id, t2.c
FROM t1
LEFT JOIN t2 on t1.id=t2.id
UNION
select t1.id,t1.c, t2.id, t2.c
FROM t2
LEFT JOIN t1 on t1.id=t2.id
"
560,MySql: Why Is this Query running so slow?,"SELECT DISTINCT cart_product.* FROM cart_product 
  INNER JOIN cart_product_related ON product_id = product_related_related_id
WHERE product_related_product_id IN (5401,5402,4983,5004)
  AND product_id NOT IN(5401,5402,4983,5004)
"
14579,SQL Server: what's the best way to query a table whose name is stored in a column?,"DECLARE @recordId INT = 7108162;

WITH cte(FileId, FileData, Year) AS
(
   SELECT FileId , FileData, 2012 AS [Year]
   FROM FILES_2012
   UNION ALL
   SELECT FileId , FileData, 2013
   FROM FILES_2013
   UNION ALL
   SELECT FileId , FileData, 2014 
   FROM FILES_2014
)
SELECT c.*
FROM FILES f
JOIN cte c
  ON f.FileId = c.FileId
WHERE f.RecordId = @RecordId;
"
21517,Delete Rows in one table based on row values in this and another table,"DELETE  a
FROM    table1 a
        INNER JOIN table2 b
            ON  a.Stall = b.Stall AND
                a.Fruit = b.Fruit
"
38915,Select different strings in the same row,"SELECT COUNT(distinct var) AS COUNT 
from character_certifications 
where classId=0 AND charId=268482320 
AND (var LIKE ""EmergentAbility65%"" OR var LIKE ""EmergentAbility70%"")
"
6645,Oracle SQL: How to define loop counter value in a column?,"SQL> set serveroutput on
SQL> BEGIN
  2    FOR i IN
  3    (SELECT empno FROM emp
  4    )
  5    LOOP
  6      dbms_output.put_line(i.empno);
  7    END LOOP;
  8  END;
  9  /
7369
7499
7521
7566
7654
7698
7782
7788
7839
7844
7876
7900
7902
7934

PL/SQL procedure successfully completed.

SQL>
"
13165,I need to get the average for every 3 records in one table and update column in separate table,"UPDATE Table2 T2
JOIN (
   SELECT AVG(Actual) as AverageValue, 
       CEIL((@rank:=@rank+1)/3) AS rank 
   FROM Table1, (select @rank:=0) t 
   Group BY rank )T1
on T2.id = T1.rank
SET Actual = T1.AverageValue
"
22703,Access SQL: Choosing which table to SELECT from based on a condition,"SELECT *
FROM Attendance 
WHERE ([a checkbox on a form that indicates whether the user wants the condition] and condition) or
      (not [a checkbox on a form that indicates whether the user wants the condition] )
"
12602,How do I exclude multi-line set of data when ONE line of data has a specific value? SQL-ORACLE,"NOT EXISTS (SELECT 1
            FROM sqlmgr.PRICE P2
            WHERE p2.ITEM = p.ITEM AND P2.PRICE = 'PRICE1'
           )
"
6558,Slow IN() MySQL query optimization,"SELECT
    p.name AS personName,
    p.slug AS personSlug,
    COUNT(p.slug) AS personCount
FROM
    person AS p
INNER JOIN
    person AS p2
ON
    p.checksum = p2.checksum
WHERE
    p2.slug = 'john-doe'
    AND p.slug <> 'john-doe'
GROUP BY personName
ORDER BY personCount DESC
"
19053,Mysql Join Query optimization,"SELECT  res.TIndex ,
        res.PNumber ,
        res.Sender ,
        res.Receiver ,
        sta.Nickname ,
        rta.Nickname
FROM    Results AS res
        INNER JOIN Nodes AS sta ON res.sender_h = sta.name
        INNER JOIN Nodes AS rta ON res.receiver_h = rta.NAME
"
953,Improve the join performance on multiple tables,"select user_id, sum(car_count) cars, sum(house_count) houses
from (select id user_id, 0 car_count, 0 house_count from User
      union all
      select user_id, 1 car_count, 0 house_count from Car
      union all
      select user_id, 0 car_count, 1 house_count from House) ilv
group by user_id
"
27678,How to duplicate records in same table,"select item, date, ruunit, fdhunit, difference
from t
union all
select item, date, null, null, runit - fdhunit
from t
order by item, (case when runit is not null then 1 else 2 end);
"
10600,Table Transpose in SQL,"SELECT US,
       CA,
       GB,
       AU
FROM   Yourtable
       PIVOT (Max(total)
             FOR county IN (US,
                            CA,
                            GB,
                            AU)) pv 
"
29133,Selecting top values without limit,"SELECT poverty
FROM (SELECT COUNT(language) as langnum, country,
             RANK() OVER (ORDER BY COUNT(language) DESC) as ranking
      FROM ""Language""
      GROUP BY country
     ) conto JOIN ""Economy"" AS E
     ON E.country=conto.country
WHERE conto.ranking = 1
ORDER BY conto.langnum DESC;
"
25433,"SQL Count and Group by - Do count and group, used together, allow for this?","SELECT S.id StudentID, S.name, C.id CourseID
FROM Student S
JOIN Registration R on S.id = R.studentID
JOIN Class L on R.ClassId = L.id
JOIN Course C on L.courseId = C.id 
GROUP BY S.id, S.name, C.id
HAVING COUNT(R.studentID) > 2;
"
15527,Returning unused values from a list in Oracle SQL Developer,"SELECT LEVEL + 1833
FROM   DUAL
CONNECT BY LEVEL <= (2000 - 1833)
MINUS
SELECT ID_TX
FROM   ATTR
WHERE  ID_TX BETWEEN 1834 AND 2000;
"
27077,"one select, two tables and no join","SELECT m.username, c.companyname
FROM member m CROSS JOIN company c
WHERE m.id = 5 AND c.id = 10;
"
26115,SQL Arithmetics with unique cells of tables,"SELECT tom08/tom, tom920/tom, tom2135/tom, tom3650/tom, tom51/tom  
FROM table1 t1, table2 t2 
WHERE t1.ppoint = t2.ppoint;
"
36839,Multiple queries into one query,"SELECT 'Year' As Topic, In_year As Value, count(In_year) AS Count 
FROM INTERNSHIP 
GROUP BY In_year

UNION ALL

SELECT 'Qtr' As Topic, In_qtr As Value, count(In_qtr) AS Count 
FROM INTERNSHIP 
GROUP BY In_Qtr

UNION ALL

SELECT 'Location' As Topic, In_location As Value, count(In_location) AS Count
FROM INTERNSHIP 
GROUP BY In_location;
"
19604,foreign key select only one record from table,"SELECT *
FROM M_SALES 
JOIN (SELECT sales_id, max(country_code) as country_code
                    FROM M_SALES_COUNTRY GROUP BY sales_id
    ) M_SALES_COUNTRY
ON M_SALES_COUNTRY.sales_id = M_SALES.sales_id
"
21316,Trying to add a where clause for row_number,"SELECT * FROM (
SELECT TOP 200 ROW_NUMBER() OVER (ORDER BY KEY_TBL.RANK DESC) AS RowNumber, FT_TBL.JobId, 
FT_TBL.Title, FT_TBL.[Description], FT_TBL.Location, KEY_TBL.RANK
FROM Jobs AS FT_TBL 
INNER JOIN 
FREETEXTTABLE (Jobs, (Title, [Description]), 'packaging')
AS KEY_TBL ON FT_TBL.JobId = KEY_TBL.[KEY]
WHERE CONTAINS (Location, '""luton*""')
      AND PostedDate >= GETDATE() - 7
) as tmp WHERE tmp.RowNumber > 5
"
9948,SQL join two tables using value from one as column name for other,"select * from Results
unpivot (""result"" for ""bucket_id"" in (""buc_1"" as 1, ""buc_2"" as 2))
join Patterns
using(""bucket_id"")
where ""result"" = 'fail';
"
24792,versioning of a table,"Id bigint not null,
TableName nvarchar(50),
ColumnName nvarchar(50),
PKColumnName nvarchar(50),
PKValue bigint, //or whatever datatype
OriginalValue nvarchar(max),
NewValue nvarchar(max),
ChangeDate datetime
"
10407,Is it possible to do a left outer join where something other than NULL fills the non-values?,"select a.*, (case when a.id is not null then coalesce(ans, -1) end) as ans
from b left join
     a
     on b.answerid = a.id;
"
12447,SQL Server 2005 - Table Functions in a Select statement,"SELECT D.deptid, D.deptname, D.deptmgrid, ST.empid, ST.empname, ST.mgrid
FROM Departments AS D
    CROSS APPLY fn_getsubtree(D.deptmgrid) AS ST;
"
28939,String manipulation SQL,"SELECT REPLACE(my_column, 'Order was assigned to ', '')
"
10187,Fetch corresponding States of Countries table,"SELECT *
FROM    Country AS C
WHERE   EXISTS (SELECT TOP 1 1 
                FROM    CountryStates CS
                WHERE   CS.CountryId = C.CountryId
            )
"
29623,Verify result set has a row for each value in a column,"SELECT 
    SubID,
    WorkFlowID
FROM @DataTable 
GROUP BY SubID, WorkFlowID
HAVING SUM(CASE WHEN ProcessCode = '10' THEN 1 ELSE 0 END) > 0
AND COUNT(DISTINCT (CASE WHEN ProcessCode IN ('20','30','40') THEN ProcessCode ELSE NULL END)) < 3
"
38583,"SQL Server - Select Rows, Remove Duplicates But Keep row with highest date",";WITH Actions AS
(
   SELECT 
       ActionID, ActionType, ActionDate, UserID, ContentID,
       RowNum = ROW_NUMBER() OVER(PARTITION BY ContentID, ActionType ORDER BY ActionDate DESC)
   FROM 
       dbo.YourTable
   WHERE
      ......
)
SELECT 
   ActionID, ActionType, ActionDate, UserID, ContentID,
FROM 
   Actions
WHERE
   RowNum = 1
ORDER BY 
   ActionDate DESC
"
27693,Logical Modeling difficulty,"Connection(cust_id1, cust_id2, connectdate)
"
28532,How to improve the search efficiency of SQLite database?,"WHERE x = ... AND y=... AND zoom=... AND type =...
"
19311,MySQL multi-table query,"EXPLAIN SELECT
    dp.disp_id AS dispId, dp.name AS dispName, dp.address1 AS dispAddress1, dp.zip AS dispZip, zc.state AS zipState, zc.county AS zipCounty, zc.city AS zipCity, zc.zip_code AS zipCode
FROM
    disp_profile dp
INNER JOIN
    zipcodes zc
ON
    dp.zip = zc.zip_code
WHERE
    dp.state = 'CA'
"
3351,Replace data in a column for a character in SQL,"select 
    Description, 
    ISNULL(
       REVERSE(STUFF(REVERSE(Name), CHARINDEX(',', REVERSE(Name), 0),1,'dna ')), 
    Name) Name
From YourTable
"
36152,trigger save old record in another column in the same table oracle,"BEGIN
   IF UPDATING ('VISIT_DATE') THEN 
       :NEW.old_visit_date    := OLD.visit_date ; 
   END IF;
END;
"
11030,how to get the cell value from table and assign to the variable in sql,"DECLARE @StartMonth nvarchar(5) 
select top 1 @StartMonth = Value from dbo.split('jun - may', '-')
"
30184,Get XML Node while using tsql,"DECLARE @x xml

SET @x = '<ROOT>
<IDS>
<ID>
<NAME>bla1</NAME>
<AGE>25</AGE>
</ID>
<ID>
<NAME>bla2</NAME>
<AGE>26</AGE>
</ID>
</IDS>
</ROOT>'

SELECT T.c.value('local-name(.)', 'varchar(50)') 
FROM @x.nodes('/ROOT/IDS/ID[1]/*') T(c)
"
27421,Using JOIN on several tables matching a foreign key,"SELECT *
FROM `company` C LEFT OUTER JOIN
      sales S
      USING (CompanyID) LEFT OUTER JOIN
      owner O
      USING (CompanyID);
"
742,Round number up until it is evenly divisible into another number - not limited to integers,"select @SheetLength / floor(@SheetLength / @PartLength)
"
25948,How to mirror ListView to Database?,"1. String - Stored String notes
2. Integer - Stored all Primary Keys
"
22286,SQLite - Negative value by substracting months of different years,"SELECT round((julianday(Date('now')) - 
        julianday(Dates))/30) as MonthsDiff
from demo;


| MonthsDiff |
--------------
|       11.0 |
|        2.0 |
"
14020,combining mysql statement into 3 columns not 3 rows,"select (select count(*) from p_a a inner join p_aa aa on a.ID = aa.AlbumID where a.ID = '04c9ed6e-1fb2-4d49-b5f6-a9d227ad7e7d'),
       (select count(*) from _ph p inner join pa a on a.ID = p.AlbumID where a.ID = '04c9ed6e-1fb2-4d49-b5f6-a9d227ad7e7d'),
       (select LastUpdate from tsimestamp ats where ats.AlbumID = '04c9ed6e-1fb2-4d49-b5f6-a9d227ad7e7d');
"
11606,"sql - selecting, counting and Updating","$short    = $_POST['short'];
$opponent = $_POST['opponent'];

safe_query(""UPDATE "".PREFIX.""teams_members SET win=win+1 WHERE teamID='$opponent'"");
safe_query(""UPDATE "".PREFIX.""teams_members SET lost=lost+1 WHERE teamID='$short'"");
"
20603,"SQL ORDER BY (CASE), NEWID()","ORDER BY CASE 
WHEN RQID <> '' 
THEN 1 
ELSE 0 
END, RQID, NEWID()
"
20161,sql query to return display by month,"select
  name, 
  case when month(createDate) = '1' then amount end as Jan,
  case when month(createDate) = '2' then amount end as Feb
  --etc...
from
  table1
group by
  name
;
"
9418,How to insert data in different tables using MySql database?,"INSERT INTO sales (user, date) values('user', now()); 
INSERT INTO settings (price) values(100);
"
24239,How to SQL SUM with condition,"select
sum(CASE WHEN type = 'IncomingTransfer' THEN amount ELSE -amount END) as totalsum
from t;
"
6487,Count the ratings of each child element under each parent in SQL,"SELECT ParentID, 
       COUNT(CASE WHEN Rating = 'A' THEN 1 END) AS A,
       COUNT(CASE WHEN Rating = 'B' THEN 1 END) AS B,
       COUNT(CASE WHEN Rating = 'C' THEN 1 END) AS C
FROM mytable
WHERE ParentID IS NOT NULL
GROUP BY ParentID
"
36859,How to use temp tables in SQL Server to display the days of the week,"select DATENAME(weekday, Orders.OrderDate) as [weekday], Orders.OrderDate as [Date], Category.Description as Category, Authors.State, isnull(SUM(OrderLine.Quantity),0) as [NumberSold]
into #booksales
from Books
Left Outer join OrderLine
on Books.BookID = OrderLine.BookID
Join Orders
on Orders.OrderID=OrderLine.OrderID
Join Authors
on Books.AuthorID = Authors.AuthorID
Join Category
on Books.CategoryID = Category.CategoryID
WHERE Orders.OrderDate BETWEEN @begindate AND @enddate
GROUP BY DATENAME(weekday, Orders.OrderDate), Orders.OrderDate, Category.Description, Authors.State
"
9529,Sql server 2008 covert float to varchar gives me wrong data,"UPDATE table_name
SET new_varchar = STR(telephone);
"
13673,"BASH: How can i use ""read"" with parameters two times?","b=1
c=1
echo ""What is the name for the $((b++)) database ?""
read name
name=$name$((c++))
echo $name >> foo.sh
"
24148,How can I limit the numbers of results being grouped in my Group By in Oracle?,"AVG(NumericValue) over (order by pSummaryTime RANGE BETWEEN 15 PRECEDING AND 5 FOLLOWING)
"
31848,Access Oracle schema objects from another user without using user prefix,"ALTER SESSION SET current_schema = UserA;
"
631,UNION ALL two SELECTs with different column types - expected behaviour?,"create table ""tab1"" (""c1"" varchar(max));
create table ""tab2"" (""c3"" integer);
insert into tab1 values(N'asd'), (N'qweqwe');
insert into tab2 values(123), (345);
select
c_newname as myname
from
(
select ""c1"" as c_newname from ""tab1""
union all
select cast(""c3""  as varchar(max)) from ""tab2""
) as T_UNI;
"
23094,"SELECT entry in SQLite, without a WHERE condition?","result = db.rawQuery(""SELECT col FROM tbl"", new String[0]);
"
3177,Oracle query output to be comma-separated,"select 
quote_id || ', ' || coverage_amount 
from Customer;
"
25856,can this be written with an outer join,"INSERT INTO A(id, x, y)
SELECT id, x, y
FROM TableB b
  Left Join TableA a
     On a.Id = b.Id
        And a.x = 't'
Where a.Id Is Null
"
13005,Retrieve List of all SPs with some condition,"select OBJECT_NAME(object_id) 
from sys.sql_modules
where  OBJECTPROPERTY(object_id,'IsProcedure') = 1 and 
    definition like '%StudentId%' 
"
26909,"Add milliseconds to date in SQL, not seconds","SELECT ADD_SECONDS (TO_TIMESTAMP('2014-04-10 09:11:45'), 0.1) FROM DUMMY  
"
7478,Count passed logins and failed logins in same query?,"SELECT uid, COUNT(uid) AS cnt, COUNT( IF( passed = 0, 1, NULL ) ) AS failed
FROM logins
GROUP BY uid
ORDER BY cnt DESC 
LIMIT 5
"
18662,Creating Index for a table that had existed for a long time," UPDATE STATISTICS <table>.<column> ESTIMATE SAMPLE 20 PERCENT
"
12689,Oracle - Output number of rows affected from dynamic merge statement,"  EXECUTE IMMEDIATE l_sql_stmt;
  l_rows_affected := SQL%ROWCOUNT;
"
10976,LLblgen: Select distinct?,"List<string> cities = PeopleCollection.Select(x=>x.City).Distinct();
"
24602,SQLite3 with multiple WHERE,"if (sqlite3_bind_double( 
      statement,
      1,  // Index of wildcard
      4.2 // Value
      ) != SQLITE_OK) {
  // Error handling...
}
"
5130,Unique value in either one of two columns,"WITH ordered AS (
  SELECT
    *,
    Person1 = CASE WHEN Sender > Recipient THEN Recipient ELSE Sender END,
    Person2 = CASE WHEN Sender > Recipient THEN Sender ELSE Recipient END
  FROM atable
),
ranked AS (
  SELECT
    *,
    rank = ROW_NUMBER() OVER (PARTITION BY Person1, Person2 ORDER BY Date DESC)
  FROM ordered
)
SELECT
  ID,
  Sender,
  Recipient,
  Date,
  Message
FROM ranked
WHERE rank = 1
"
37425,SQL: Only showing friends,"WHERE users_friends.bID='$USER' AND users_friends.type = '$typeUsers' AND (
 (users.firstname = '$firstname' AND users.lastname='$lastname') OR
 (users.firstname LIKE '$firstname%' AND users.lastname LIKE '$lastname%') OR
 users.firstname LIKE '$firstname%' OR
 users.lastname LIKE '$firstname%'
)
"
19425,Receive day id to use in where clause (SQL Server),"Select * From table Where DATENAME(dw,DateColumn) = 'Monday'
Select * From table Where DATEPART(dw,DateColumn) = 1
"
9477,Oracle SQL table history,"SELECT * FROM yourtable
  AS OF TIMESTAMP TO_TIMESTAMP('2004-04-04 09:30:00', 'YYYY-MM-DD HH:MI:SS');
"
850,SQL Join on two tables for messages,"SELECT Messages1.body
from Messages1
where Messages1.Thread_ID = '9'
union
SELECT Messages2.Body
from Messages2
where Messages2.Thread_ID = '9'
"
7562,SQL Server inner join only getting results from 1 table,"select top 1000 * from profile;
"
17155,Get data from one table using id and date ranges stored in another table,"select l.*, c.*
from log l left outer join
     RentOut ro
     on l.unit_id_fk = ro.unit_id_rk and
        l.datetime between ro.start_date and ro.end_date left outer join
     Customer c
     on ro.customer_id = c.id
where c.<whatever> = <foobar>
"
31364,SQL - how to return rows containing ALL children rows," SELECT parent_id 
 from XRefTable 
 where ref_id in ( 2, 3 ) 
 group by PARENT_ID 
 having count(distinct ref_id) = 2
"
4070,SQL IF - ELSE Statement,"insert into wp_viewcount values(1,1) on duplicate key update view=view+1;
"
25168,MYSQL: Problems using COUNT and SUM functions in multi row select,"SELECT * FROM (
  SELECT @t1 := @t1 + 1 AS num, ads.*
  FROM ads, (SELECT @t1 := -1) init
  WHERE city = 'Maitland' AND spot = 'home-banner'
  ORDER BY id ASC
) dt
WHERE dt.num = (
  SELECT SUM(views) % COUNT(id) FROM ads
  WHERE city = 'Maitland' AND spot = 'home-banner')
"
35964,Oracle Apex Custom Authentication Error - 'MY_AUTHENTICATION' IS NOT A PROCEDURE,"apex_authentication.login(    
    p_username => :P101_USERNAME,
    p_password => :P101_PASSWORD
);
"
29691,SQL query for total unique hits,"select s.site_id, count(*) as totalhits
from sites s join hits h
on s.site_id = h.site_id
group by s.site_id
"
27764,SQL: delete all the data from all available tables,"select 'truncate table ' || table_name || ';' from user_tables
"
3568,How do I write this darned SQL query?,"SELECT year
    FROM TeamRankings
    WHERE qualities_id = 1
        AND team_id IN (4,8,15,16,23,42)
    GROUP BY year
    HAVING COUNT(DISTINCT team_id) = 6;
"
21054,How to order result but not selected row using sql query?," ORDER BY 
 CASE WHEN externalkey = '970000' THEN 0 else 1 END,
           org.description
"
34386,SQL join several tables based on latest entry in transaction table per join record,"SELECT
  eventTable.EvtName AS EvtD,
  transTable.TranAct AS LastTrans,
  userTable.UserName AS UsrNm,
FROM
  transTable
  INNER JOIN (
    SELECT evId, MAX(UID) uid FROM transTable GROUP BY evId 
  ) last ON last.evId = transTable.evId AND last.uid = transTable.uid
  INNER JOIN eventTable ON eventTable.evId = transTable.evId
  INNER JOIN userTable ON userTable.usId = transTable.usId
"
15624,Select rows which appear more than given number of times in table,"SELECT t.*
FROM   t
JOIN   (SELECT   name, surname, COUNT(*)
        FROM     t
        GROUP BY name, surname
        HAVING   COUNT(*) > 10) aggr ON t.name = aggr.name AND 
                                        t.surname = aggr.surname
"
7459,Excel & SQL: How to convert string to double in Select statement,"Select  *  from [""&strSheetName&""$]   where CInt(TestCaseId)  >= "" & abs (strRow)
"
38410,SQL how to make null values come last when sorting ascending,"select MyDate
from MyTable
order by case when MyDate is null then 1 else 0 end, MyDate
"
5826,Mysql mulitple row insert-select statement with last_insert_id(),"INSERT INTO dbNEW.`user` (userID, entityID, other)  
SELECT user_id, entityID, other
FROM
(
    SELECT user_id, @key + @rn entityID, other, @rn := @rn + 1
    FROM (select @rn:=0) x, dbOLD.`user`
    order by user_id
) y;
"
8597,How to design output in command line in Oracle?,"set pagesize 0 -- SET PAGESIZE number_of_lines
set heading off -- No headers
set linesize 200 -- Line size 
etc.
"
35576,Update table using different random values for each update row,"update tab_ex
    set val = val + random() * 2000
    where id in (select id
                 from tab_ex
                 order by random()
                 limit (select count(*)*0.2 from tab_ex)
                );
"
31023,merge two queries with different where into 1,"SELECT  MeasureDate, col1, col2
FROM Table1
WHERE Col3 = 2
  or (Col3 = 1 AND Col4 = 7000);


SELECT  sum(col1) / sum(col2) AS Percentage , GROUP BY MeasureDate
FROM Table1
WHERE Col3 = 2
  or (Col3 = 1 AND Col4 = 7000)
GROUP BY MeasureDate;
"
14817,how to display data from different tables column into one table column,"SELECT     Location =C.Location
           ,Customer =C.Customer
           ,Service =C.Service
           ,Location2=(SELECT B.Location FROM Table2 B  where     B.customerid=C.customerid)
    FROM   Customer C --  Use alais names 
"
9843,How do you examine objects from psql?,"=> SELECT oid FROM pg_catalog.pg_class c WHERE c.relname LIKE 'my_index';
  oid  
-------
 25240
(1 row)
=> SELECT attname, attnum FROM pg_attribute a WHERE a.attrelid = '25240';
     attname      | attnum 
------------------+--------
 iso_country_code |      1
 type_name        |      2
 pg_expression_3  |      3
(3 rows)
=> SELECT pg_get_indexdef(25240, 3, true);
 pg_get_indexdef 
-----------------
 upper(name)
(1 row)
"
39868,Projection in Relational Algebra," name ( age = 34 (Person)) 
"
4313,Non GUI access to Oracle Wallet Manager,"orapki wallet create -wallet /private/user/orapki_use/server -auto_login
orapki wallet add -wallet /private/user/orapki_use/server -trusted_cert -cert /private/user/orapki_use/root/b64certificate.txt
"
8493,How to convert a varchar column type to date type without losing the dates,"CREATE TABLE temp (startdate varchar(255), stuff varchar(255));

INSERT INTO temp
SELECT startdate,stuff
FROM mytable;

TRUNCATE TABLE mytable;

ALTER TABLE mytable ALTER COLUMN startdate DATETIME NOT NULL;

INSERT INTO mytable
SELECT CAST(startdate AS DATETIME), stuff FROM temp;

DROP TABLE temp;
"
34866,SQL - Get highest utilization by member by provider,"SELECT *
FROM Member
WHERE Member.UtilizationCounts = 
          (SELECT MAX(UtilizationCounts) 
           FROM Member m2 
           WHERE m2.MemberID = Member.MemberID)
"
10281,How to write this query in SQL Server 2008?,"where (component = 'B' and quantity > 1) or
      (component = 'C' and quantity > 5) or
      (component = 'D' and quantity > 6)
"
22652,How to split the total time with condition,"select  ID
,       case when totaltime > 8 then 8 
             else totaltime end
,       case when totaltime > 10 then 2
             when totaltime > 8 then totaltime - 8
             else 0 end
,       case when totaltime > 10 then totaltime - 10
             else 0 end
from    YourTable
"
35547,"MySQL 5.0 reporting ""concat does not exist""","SELECT CONCAT ('a', 'b');
"
32392,Sort Only Part of a String in Oracle,"SELECT AB
FROM THING
WHERE AB like '%111';
"
23766,Oracle Grant privileges,"grant all
   on customer
   to some_user
 with grant option;
"
28941,.net datatable alphanumerical,"Dim myadapter As New MySqlDataAdapter(""SELECT * FROM core WHERE F1 = '"" & strdocument &""'"", dbConn)
"
15065,SQL - safely downcast BIGINT to INT,"SET ARITHABORT OFF;
SET ARITHIGNORE ON;
"
10205,SQLite IF Exists Clause,"select exists(
    select 1
    from tbl_stats_assigned
    where username = 'abc'
);
"
9986,SQL: Need help with query construction,"SELECT
    COUNT(*) AS [Total Orders],
    CustomerID,
    MIN(Transaction_date) AS [Transaction Date]
FROM product_orders
WHERE product_orders.Status = 'Active'
GROUP BY
    CustomerId
HAVING COUNT(*) >= 10
"
16746,Row permissions based on child rows,"SELECT * FROM events where id NOT IN(
  SELECT event_id FROM events_accounts WHERE account_id NOT IN(
    SELECT account_id FROM users_accounts WHERE user_id = @user_id
))
"
36727,SQL mass insert based off of data pulled from another table,"insert into table2 (Xid, configKey, ConfigVal)
select id, 'doSomething', 'true'
from table1
"
28653,PostgreSQL conditional statement,"with c as (select count(*) cnt from table1)
select table2.* from table2, c where c.cnt < 1
union all
select table3.* from table3, c where c.cnt >= 1
"
27744,Calculating a running count of Weeks,"SELECT
    *   ,
    SUM(ChangedRow) OVER (ORDER BY DateKey ROWS BETWEEN 99999 PRECEDING AND CURRENT ROW)    
FROM
(
    SELECT 
        DateKey,
        TWEEK,  
        ChangedRow=CASE WHEN LAG(TWEEK) OVER (ORDER BY DateKey) <> TWEEK THEN 1 ELSE 0 END          

    FROM 
        @foobar F2
)AS DETAIL
"
35958,Zend_Db order by field Value,"$name = 'John';
$order = new Zend_Db_Expr($this->getAdapter()->quoteInto(""name = ?"", $name) ."" DESC, `name`"");
$select = $this->select();
$select->order($order);
return $this->fetchAll($select);
"
35693,"How to identify what control has focus, MS Access VBA"," Screen.ActiveControl
"
7317,SQL group by month and add 15mins,"SELECT Sum(Value)
FROM MyTable
GROUP BY MONTH(DATEADD(minute,15,myDate)), YEAR(DATEADD(minute,15,myDate))
"
10665,convert tostring to datetime in sql,"declare @y varchar(256) = '20140619105204'
declare @x varchar(256) 

set @x = SUBSTRING(@y, 0,5) + '-' + SUBSTRING(@y, 5,2) +'-'+ SUBSTRING(@y, 7,2) +' ' 
          + SUBSTRING(@y,9,2) + ':' + SUBSTRING(@y,11,2) +  ':' + SUBSTRING(@y,13,2)


SELECT CONVERT(varchar, cast(@x as datetime),22)
"
22570,How to combine multiple queries of different time range in one table scan,"SELECT   provider_id, sum(spent)
FROM     spent_table 
WHERE    (date BETWEEN '20130930' AND '20140101' AND provider_id = 272) OR
         (date BETWEEN '20130730' AND '20131201' AND provider_id = 273)
GROUP BY provider_id
"
35924,"Best way to do 10,000 inserts in a SQL db?","BEGIN TRANSACTION

INSERT INTO msgs (publisherid, msg)
VALUES(@publisherid, @msg)
SET @messageid = SCOPE_IDENTITY()

INSERT INTO msqqueue (recipientid, messageid, status)
SELECT subscriberid, @messageid, 0 -- unread
FROM subscribers
WHERE subscribers.publisherid = @publisherid

COMMIT TRANSACTION
"
39003,Get value with the clause IF and IN,"select distinct
case when Month(t.DATE) >=7 then Year(t.DATE) else Year(t.DATE)-1 end as FiscalYear
from THE_TABLE t
order by FiscalYear desc
"
22463,Add 1 day to original date and put in a different table,"UPDATE someTable SET Due_Date = DATEADD(day,1,Created_Date) WHERE ...
"
24673,Find matching column data between two rows in the same table,"select t1.rowid as r1, t2.rowid as r2, t2.col as matchvalue from <yourtable> t1 join
(
  select rowid, col1 col from <yourtable> where rowid = 3 union all
  select rowid, col2 from <yourtable> where rowid = 3 union all
  select rowid, col3 from <yourtable> where rowid = 3
) t2
on t2.col in (t1.col1, t1.col2, t1.col3)
and t1.rowid < t2.rowid -- you don't need this if you have two specific rows
and t1.rowid = 1
"
34553,Remove Duplicate Query,"SELECT ce_email,max(c_no)
FROM comm_list
WHERE clp_no = 585
GROUP BY ce_email;
"
26838,JDBC URL / RAC Server,"jdbc:oracle:thin:@(DESCRIPTION=(LOAD_BALANCE=on)(FAILOVER=on)(ADDRESS =(PROTOCOL=TCP)(HOST=scan-alias)(PORT = 1521))(CONNECT_DATA=(SERVICE_NAME=servicename)))
"
12771,Drupal 7 db_select nested select query,"$term = 'apple';

$sub_query = db_select('tbl_subword')
  ->fields('tbl_subword', array('WordID'))
  ->condition('EngWord', '%' . db_like($term) . '%'), 'LIKE');

$query = db_select('tbl_word')
  ->fields('tbl_word')
  ->condition(db_or()
    ->condition('EngWord', '%' . db_like($term) . '%', 'LIKE')
    ->condition('WordID', $sub_query, 'IN')
  );

$results = $query->execute()->fetchAll();
"
23185,SQL Server : Select from two tables with default value 0,"select B.caseNumber, ISNULL(count(C.checkupNumber) ,0)
from BaseTable B
left join Checkup C
on B.caseNumber = C.caseNumber
where B.patientId ='P201'
group by B.caseNumber
"
11280,how to query for the 2 id's field whose value present in the same table B,"SELECT 
    f.id
    , n1.name_id As seller
    , n2.name_id As buyer
FROM Friends f
    INNER JOIN Name n1 ON n1.id = f.seller_id
    INNER JOIN Name n2 ON n2.id = f.buyer_id
"
14433,"query runs fine in sql developer, but crashes in hibernate","public class MySQL5Dialect extends org.hibernate.dialect.MySQL5Dialect
{
    public MySQL5Dialect()
    { 
        super(); // register additional hibernate types for default use in scalar sqlquery type auto detection 
        registerHibernateType(Types.LONGVARCHAR, Hibernate.TEXT.getName()); 
    }

}
"
12877,Select without a FROM clause in Oracle,"SELECT  level
FROM    dual
CONNECT BY
        level <= 100
"
22069,Select exclusively a field from a table,"- Table Coupons
  - ID
  - name
  - coupon_type_id # (or whatever fits your style guidelines)
  - amount # Example: 10.00 (treated as $10 off for amount type, treated as  
           # 10% for percent type or 10 for 1 with the final type) 
  - expiration_date

- Table CouponTypes
  - ID
  - type # (amount, percent, <whatever you decided to call the 2 for 1> :))
"
35546,How to select only 1 row per unique field (with another field determining which in case of duplicates),"SELECT  a.*
FROM    tableName a
        INNER JOIN
        (
            SELECT  elem_ID, MAX(`Draft`) maxDraft
            FROM tableName
            GROUP BY elem_ID
        ) b ON a.elem_ID = b.elem_ID AND
                a.`draft` = b.maxDraft
"
21052,"MS SQL, Grouping, For XML, and more... need some help with this query"," SELECT 
   RIGHT(categ.Name, 4) as ""@nam"" ,    
   (
   SELECT hardware.Name as ""@fromDevice""
   FROM tblHardware AS hardware
   WHERE RIGHT(categ.Name, 4) = RIGHT(hardware.Name, 4)
   for xml path ('hardware') , type
   )
 FROM tblHardware as categ
 GROUP BY  RIGHT(categ.Name, 4)
 for xml path ('headEnd'), root ('EXAMPLE_DATA')
"
8300,fill month gaps,"SELECT date, product FROM (
SELECT date,SUM(orders.product) AS product
FROM orders 
GROUP BY MONTH(date),YEAR(date)
UNION 
select datefield AS date, '0' AS product
from calendar
WHERE (calendar.datefield BETWEEN (SELECT MIN(DATE(date)) FROM orders) AND (SELECT MAX(DATE(date)) FROM orders))
GROUP BY MONTH(date),YEAR(date)
) AS a
GROUP BY MONTH(date),YEAR(date)
ORDER BY date
"
25486,SQL Check for Null Date and then Case Switch,"where isnull(completetion_date,created_date) between {1} and {2}
"
3337,"Drop Database called ""User"" from Oracle","drop table ""myschema"".""user""
"
32976,"sql select min, return value from different column in same row with grouping","SELECT [T].* 
FROM (  
    SELECT [Name]
         , [DATE]
         , [OrderType]
         , ROW_NUMBER() OVER (PARTITION BY [Name] ORDER BY [Date]) AS [seq]
    FROM [TableA]
) AS [T]
WHERE [T].[seq] = 1
"
34694,Case insensitive in SQLite,"SELECT id,name 
FROM trait 
WHERE UPPER(name) IN (""RATIO"")
"
19748,SQL - Check if data exists on either table,"SELECT TOP 1 * 
FROM(
  SELECT studentId AS userID, password, firstName, LastName
  FROM tblUserStudent 
  WHERE StudentID = 'S1201235'
  UNION ALL
  SELECT LibrarianID,password, NULL, NULL
  FROM tblUserLibrarian 
  WHERE LibrarianID = 'S1201235'
) a
"
5603,Select not null values in a single row,"select id, 
max(value1) as value1,
max(value2) as value2,
max(value3) as value3
from table
group by id
"
14398,Why aren't nulls counted in COUNT(columnname),"SELECT COUNT(ID) as NotNull, SUM(CASE WHEN ID IS NULL then 1 else 0 end) as NullCount
"
11134,Count only the id's which are not counted in earlier group,"SELECT GroupID, COUNT(Distinct GroupParticipantID) AS CNT 
FROM #Temp1 A
WHERE A.GroupParticipantID NOT IN
(
SELECT GroupParticipantID 
  FROM #Temp1 B
  WHERE A.GroupID > B.GroupID
)
Group BY GroupID
"
37530,Excel-to-Excel data connection gives limited SQL options,"SELECT
[ID],
[Gift],
Now() AS [Refresh Date]
"
14738,"Search (in Oracle), using wild card without worrying about the case or order in which the words appear","select * 
from yourtable
where yourfield like '%a%'
and yourfield like '%b%'
"
9135,Use alias name as a column,"select [Year],
       [FinanceValue-2014],
       [FinanceValue-2013],
       [FinanceValue-2012],
       [FinanceValue Variance],
       Round([FinanceValue Variance] * 2.50,4) as [NewVariance]
from (
select [Year],
       [FinanceValue-2014],
       [FinanceValue-2013],
       [FinanceValue-2012],
       [FinanceValue-2014]-[FinanceValue-2013] as [FinanceValue Variance]      
from Finance)T
"
9940,JOIN only if column is NULL,"SELECT T.ID
       ,COALESCE(TT.TITLE, T.TITLE) AS TITLE
FROM tag T
LEFT JOIN tag_translation TT
    ON T.ID = TT.tag_id
    AND TT.locale = 'FR';
"
13874,mysql compare columns,"SELECT XY.`id` 
FROM XY
WHERE `id` NOT IN(
   SELECT XY.`id` 
   FROM XY
   JOIN XZ ON XY.`id`=XZ.`id`);
"
26438,Optimize many SQL request in 1,"SELECT FAI, 
       sum( status = 0 ) AS send_count,
       sum( status = 1 ) AS deferred_count,
       sum( status = 2 ) AS Bounced_count
FROM  `email_errors` 
GROUP BY FAI
"
9289,Dividing summed field by another summed field in the same query,"SELECT
    Table1.SID,
    Sum(Table1.Credit) AS SumOfCredit,
    Sum(Table1.Mark) AS SumOfMark,
    Sum([Mark])/Sum([Credit]) AS FAvg
FROM
    Table1
GROUP BY
    Table1.SID;
"
23045,Creating multi-column constraints depending on column value,"create unique index mytable_idx on mytable
   ( case when column1 = 'somevalue' then column2 end
   , case when column1 = 'somevalue' then column3 end
   );
"
20035,Sql to pick n rows from each value of where clause," SELECT a.* FROM
 (
 select EMPLOYEENAME , 
 ROW_NUMBER() OVER(PARTITION BY state ORDER BY EMPLOYEENAME) as rn
 from EMPLOYEE where state in ('NY','CA','TX')
 )a WHERE rn <=10;
"
12626,MSsql select count case only if > 0,"WITH cte AS ( 
SELECT row_number() OVER(order by cars.make ASC,cars.model ASC) AS rn, cars.id, cars.make 
    FROM cars 
    LEFT JOIN transport ON cars.transportfrom=transport.id 
    WHERE Make in ('DAIHATSU','DODGE','JEEP','KIA','LANCIA')
) 
 SELECT make, count(CASE WHEN RN BETWEEN 51 AND 100 THEN 1 END) AS    
 CountInResponse, count(1) AS total 
 FROM cte 
 GROUP BY make
 having count(CASE WHEN RN BETWEEN 51 AND 100 THEN 1 END) > 0
"
22095,UNION Error when creating a Veiw,"SELECT category_id, category_name, COUNT(film_id)
FROM film_category JOIN category USING category_id
GROUP BY category_id, category_name;
"
35763,Why can't I compare these hex values?," 0x        0062EB3F 
 0x000000020062EB3F
          *
          *
"
38307,Get records that has some value in some tandem period,"SELECT a.id, a.city, a.year, a.month, a.f1, a.f2
FROM mytable a, mytable b
WHERE ((b.month = a.month + 1 AND b.year = a.year) 
 OR (b.year = a.year + 1 AND a.month = 12 AND b.month = 1))
AND a.city = b.city AND b.f2 = '05';
"
34278,Is there any term like 'DOT(.) notation' used in SQL joins?,"on a.userid = n.userid
"
19432,MYSQL - How to let 3 row data become 1 row data,"select 
   remark,
   sum(totalA) as totalA,
   sum(totalB) as totalB,
   sum(totalC) as totalC
from the_table
group by remark
"
32270,MySQL query String contains,"mysql_query(""
SELECT *
FROM `table`
WHERE `column` LIKE '%{$needle}%'
"");
"
4210,Scoring database entries by multiple columns,"select *
from (
    select *,
      case when location = 'berlin' then 5 else 0 end +
      case when royality >= 100 then 1 else 0 end +
      case when familylaw = null then 1 else 0 end +
      case when criminallaw = true then 1 else 0 end as score
    from tbl
) scored
order by score desc
"
36744,How to group different columns and return only the first that was found,"WITH CTE AS
(
    SELECT Email,   IP,   Country
         , RN = ROW_NUMBER() OVER (PARTITION BY Email ORDER BY Email)
    FROM dbo.Emails
)
SELECT Email,   IP,   Country
FROM CTE
WHERE RN = 1
"
14003,Right way to use MySQL to assign tasks to worker processes,"BEGIN TRANSACTION;
SELECT DISTINCT url FROM urls WHERE task_assigned is NULL ORDER BY id LIMIT 100 FOR UPDATE;
UPDATE urls SET task_assigned = NOW() WHERE url IN [list of URLs] COLLATE utf8_bin;
COMMIT;
"
17919,SQL: How to return matching AND non-matching rows with WHERE condition,"SELECT c.f_assetID as f_logmachine, f_logsoftware
FROM tb_computers c
LEFT JOIN ( SELECT *
            FROM tb_softwareinstalls
            WHERE f_logsoftware = 'Java (7.0.750)') s 
    ON c.f_assetID = s.f_logmachine
ORDER BY c.f_assetID
"
32722,"Query to get all those names of employees,who have 'A' as their middle character in their name","SELECT `ENAME` FROM  `EMPLOYEES` WHERE SUBSTR(`ENAME`, LENGTH(`ENAME`)/2+1, 1) =  'A'
"
37683,Cummulative left overs using SQL,"select category,
       time,
       quantity, 
       500 - sum(quantity) over (partition by category order by time) as leftover
from the_unknown_table;
order by category, time
"
33352,SQL Select multiple rows with same column values,"select [column1], [column2], [column3], [column4]
from
(
  select [column1], [column2], [column3], [column4],
    row_number() over(partition by column2, column3, column4 order by column1) rn
  from yourtable
) src
where rn <= 3
"
21854,oracle sql query to format number by comma,"SELECT  TO_CHAR(696585242087, '99G999G999G9999', 'NLS_NUMERIC_CHARACTERS="",.""')
FROM    dual
"
17490,How would you solve this tricky SQL problem?,"select courseid as cid,
if ( select count(*) from instructor where courseid = cid ) > 2 
   then 'Committee' 
else 
   list(name order by name) 
endif as profs
from instructor
group by courseid
order by cid
"
16559,SQL: Remove rows whose associations are broken (orphaned data),"delete from your_table
where user_id not in (select id from users_table)
or item_id not in (select id from items_table)
"
36260,Exclude value of a record in a group if another is present,"select 
  id, 
  case 
     when count(case mark when 'C' then 1 else null end) = 0 
     then 
        sum(amount)
     else 
        sum(case when mark <> 'A' then amount else 0 end)
  end
from sampletable
group by id
"
12037,Relating multiple tables to each other in SQL,"Comments
 - CommentID
 - CommentText

Posts
 - PostID
 - Other fields

Pages
 - PageID
 - Other fields

PostComments
 - PostID
 - CommentID

PageComments
 - PageID
 - CommentID
"
32073,How do I force sqlite to merge journal file into main database?,"db.rawQuery(""PRAGMA journal_mode=OFF"", null).close();
"
5519,Multiple conditions in WHERE clause,"select * 
from @Accessories 
where (@Param = 0)
  or (@Param = 1 and atype = 'HDD') 
--or (@Param = 1 and itype = 1) , if itype and atype are connected
  or (@Param = 2 and atype != 'HDD')
option (recompile)
"
8586,transfer table data when normalize tables in database,"INSERT INTO table2 (category_title)
SELECT DISTINCT category_title FROM table1;

INSERT INTO table3 (subcategory, table2_id)
SELECT DISTINCT subcategory, table2.id
FROM
  table1 INNER JOIN table2 ON table1.category_title=table2.category_title;
"
34581,Joining two tables and returning the bigger value of one column,"select t1.dno, greatest(coalesce(t1.sal,0), coalesce(t2.sal,0)) as sal
from emp1 t1
  join emp2 t2 on t1.dno = t2.dno;
"
24428,Delete where not in query,"DELETE LU
FROM ##lookup LU
LEFT OUTER JOIN Table1 T1 ON T1.my_pk = LU.my_pk
WHERE T1.my_pk IS NULL

INSERT INTO ##lookup (my_pk, col1, col2...)
SELECT T1.my_pk, T1.col1, T1.col2...
FROM Table1 T1
LEFT OUTER JOIN ##lookup LU ON LU.my_pk = T1.my_pk
WHERE LU.my_pk IS NULL
"
18747,SQL Query to get countries,"select C.country
from   CountriesInfo C 
join
    (select *
     from  CountriesInfo
     where country='India')a
on C.continent=a.continent
"
6112,How to find duplicate record for same date,"select id, roomid, inv_date, count(room)
from room_inventory
group by id, roomid, inv_date
having count(room) > 1;
"
9257,How can two hierarchies be efficiently merged in SQL Server?,"node_id   parent_id
1         NULL
2         1
3         2
4         3

node_id   parent_id
1         NULL
3         1
5         2
6         1
"
22060,Reduce subquery to join,"SELECT *
  FROM Rp_Clientaffectationhistory AS T1
left join Rp_Clientaffectationhistory as T2 on (T1.Rp_Clientid = T2.Rp_Clientid) and T1.Rp_Clientaffectationhistoryid < T2.Rp_Clientaffectationhistoryid
where T2.Rp_Clientaffectationhistoryid is null
and T1.Rp_Userid = 57
"
6211,count dates between range,"select repo, count(distinct date)
from SVNLogEntry
where repo = 'test' and date between '2011-01-01' and '2017-01-01'
group by repo;
"
35033,SQL Query to check if today is Employee's birthday,"SELECT *
FROM Employees
WHERE DATEPART(d, DateOfBirth) = DATEPART(d, GETDATE())
    AND DATEPART(m, DateOfBirth) = DATEPART(m, GETDATE())
"
27667,How can I query records depending on value existance?,"SELECT  ID, VALUE, CATEGORY
  FROM  (
      SELECT ID, VALUE, CATEGORY,
          ROW_NUMBER() OVER (PARTITION BY ID) as SEQ_ID
        FROM MY_TABLE
      ORDER BY ID, CATEGORY DESC
  )
 WHERE SEQ_ID = 1
"
5302,Stored Procedure slower than query in SSMS,"SELECT *
FROM MyTable WITH (INDEX(IndexName))
WHERE MyIndexedColumn = 0
"
6695,get All distinct (by ID) Users list and count only thoose who is Active,"SELECT ID, SUM(CASE WHEN Active='True' THEN 1 ELSE 0 END)
FROM Users 
GROUP BY ID
"
39150,SQL UNION result format,"select t1.Date, t1.value, t2.value
  from table1 t1 left join table2 t2 on t1.date=t2.date
"
26363,"SQL query with join, sum, group by, etc","WITH    calendar(mon) AS
    	(
    	SELECT	1
    	UNION ALL
    	SELECT	mon + 1
    	FROM	calendar
    	WHERE	mon < 12
    	)
SELECT  itemID, mon, SUM(value)
FROM    calendar c, t_item i
LEFT OUTER JOIN
    	t_value v
ON  	v.itemID = i.itemID
    	AND MONTH(date) = mon
GROUP BY
    	i.itemID, mon
"
28333,How to sort number output descending,"SELECT k.name AS hicompany, count( * ) AS howmany
FROM people p
JOIN hicompany k ON p.id= k.id
GROUP BY name
ORDER BY COUNT(*) DESC
"
38254,SQL query formulation,"UPDATE jos_k2_items set created_by='97'
WHERE CATID = '1616'
"
1772,LISTAGG: group within group,"SELECT storeId,
       LISTAGG(ProductCategory || ':' || '(' || ProductIds || ')', ', ')
            WITHIN GROUP (ORDER BY ProductCategory) as ProductsAndCategories
FROM (SELECT StoreId, ProductCategory,
             LISTAGG(ProductId, ',') WITHIN GROUP (ORDER BY ProductId) as ProductIds
      FROM SUPERMARKET
      GROUP BY StoreId, ProductCategory
     ) s
GROUP BY StoreId;
"
31132,Return custom value if join not successfull?,"  a.deptcode || '  ' || coalesce (b.deptname, '<missing>') as fulldeptname
"
12,How to Add a Blank field in a DropDown List,"<asp:DropDownList ID=""ddlGroup"" runat=""server"" DataSourceID=""getGroup"" 
DataTextField=""group_name"" DataValueField=""group_id"" AutoPostBack=""True"" 
onselectedindexchanged=""ddlGroup_SelectedIndexChanged"" 
AppendDataBoundItems=""True"" ViewStateMode=""Disabled"">
     <asp:ListItem Value=""-1"">Select Group</asp:ListItem>
</asp:DropDownList>
"
4878,SQL OR clause to not read every row in table,"create proc dbo.MySearch @col1 int, @col2 varchar(30) as

declare @sql nvarchar(max), @params nvarchar(max);
set @sql = 'select col1, col2 from dbo.Table where 1 = 1';
set @params = '@col1 int, @col2 varchar(30)';

if @col1 is not null set @sql += 'and Col1 = @col1';
if @col2 is not null set @sql += 'and Col2 = @col2';

exec sp_executesql @sql, @params, @col1, @col2;
"
34336,Use View from a Query across multiple SELECTS,"with 
work_table_1 as (
   SELECT blah
   FROM   A, B, C
   WHERE  $SOME_COMMON_IF_AND
)
SELECT blah
FROM   WORK_TABLE_1
WHERE  $SPECIFIC_1

UNION

SELECT blah
FROM   WORK_TABLE_1
WHERE  $SPECIFIC_2
"
17194,Find mean of difference between dates -Sql Select,"select  b1.RepId
,       avg(abs(datediff(hour, b1.buildDate, b2.buildDate)))
from    builds b1
join    builds b2
on      b1.BuildVersion = b2.BuildVersion + 1
        and b1.Repid = b2.Repid
group by
        b1.RepId
"
13730,How do I SELECT such that a group by column has every value from supplied list in another coumn,"select majorid
from ReportStack
where value in (1, 3)
group by majorid
having count (distinct value) = 2
"
37146,Select all values in a column into a string in SQLite?,"select group_concat(a, ',')
from yourtable
"
38735,Avg amount of items user bought over the time,"select userId, count(*)/count(distinct orderNumber) avg_items
from orders
group by userId
"
18767,SQL ranking and ties,"SELECT Value, 
count(*) over (partition by value)/2 + rank() over(order by value) as Ranking1, 
count(*) over (partition by value) + rank() over(order by value) -1 as Ranking2 
FROM table
"
15177,odbc syntax to update,"OdbcCommand cmd = new OdbcCommand(""UPDATE awm_create 
   SET referral_email=? WHERE email=?"" , MyConnection);
"
37894,Create table with duplicate records?,"create table dupes as 
  select * 
   from nds_master_child_merge a
   join cam_dim b 
     on a.can_id = b.cam_id
"
2503,Conditional aggregation with JOIN?,"SELECT SUM(p.num_pills/r.pills_per_day)
FROM prescriptions p INNER join recommendations r 
    ON p.code = r.bnf_code
WHERE p.code Like '0403%'
"
49,Percentage of requests SQL,"select sum(case when abc = 'yes' then 1 else 0 end) * 100 / count(*)
from your_table
"
36841,Show only the most recent givendate for each record in MySQL,"SELECT patientID, vaccinename, MAX(givenDate)
FROM patient_info
GROUP BY patientID, vaccinename
"
15388,MySQL replace result value with another value,"SELECT name, CASE WHEN re_type = 1 THEN 'Student' WHEN re_type = 2 THEN 'Teacher' ELSE 'Donno' END AS re_type_text
FROM myTable 
"
6590,How to do SQL calculation from a view?,"SELECT  Channel,
        SUM(CASE WHEN Type = 'N' THEN -1 ELSE 1 END * total_month_count) ""Calculation""
FROM    yourView
GROUP BY Channel
"
6405,SQL Performance of grouping by DATE(TIMESTAMP) vs separate columns for DATE and TIME,"SELECT DATE(Time) as D, COUNT(*) as S 
  FROM Stats
 WHERE Time >= CURDATE() - INTERVAL 30 DAY 
  GROUP BY D ORDER BY D DESC
"
3034,sql : which dates contain time between 12:00 and 22:00,"SELECT RecTime, 
       CASE WHEN CAST(RecTime AS TIME) 
                 BETWEEN '12:00:00' AND '22:00:00' 
            THEN 1 ELSE 0 END foo
  FROM Table1
"
28895,Create a data migration strategy for testers working through the app,"<changeSet id=""1"" author=""x"">
   <createTable name=""a""../>
</changeSet>
<changeSet id=""2"" author=""x"">
   <createTable name=""b""../>
</changeSet>

<changeSet id=""3"" author=""x"" context=""test"">
   <sqlFile path=""data-dump.1.sql"">
</changeSet>

<changeSet id=""4"" author=""x"">
   <renameColumn oldColumnName=""s"" newColumnName=""t""../>
</changeSet>

<changeSet id=""5"" author=""x"" context=""test"">
   <sqlFile path=""data-dump.2.sql"">
</changeSet>
"
3254,Matching only one specific row in a JOIN where many exist,"SELECT ... FROM service s
INNER JOIN provider p ON p.ProvID = s.ProvID
AND (COALESCE(p.EndDate, '2037-01-01') = (
   SELECT Max(COALESCE(EndDate, '2037-01-01')) FROM
   provider lu WHERE lu.ProvID = s.ProvID)
)
"
4217,Replace OR with dynamic sql or IF,"...
AND COALESCE(@dep_id, t.dep_id) = t.dep_id
"
32735,Querying a django DB with model forms,"def query_queries(request):
    form = QueryForm(request.POST or None)
    if form.is_valid():
        # this is the same as doing
        # Query.objects.filter(studyName=form.cleaned_data['studyName']...)
        queries = Query.objects.filter(**form.cleaned_data)

    context = {
        'queries': queries
    }
    return render(request, ""query_queries.html"", context)
"
22039,sql server query- converting postgres to ms sql server db,"SELECT
    CONVERT(VARCHAR(20), rolloffdate, 101) AS Period, *
FROM employeedetails
WHERE EMPLOYEE_STATUS > 3 
ORDER BY Period
"
5372,Escape percent sign in SQL query regex?,"SELECT * FROM example WHERE content REGEXP '[[:<:]]100%([[:blank:]]|[[:punct:]]|$)';
"
7433,Remove percentage sign from values in MySQL table,"UPDATE YourTable
    SET YourColumn = REPLACE(YourColumn, '%', '');
"
33223,List and Linq To Sql Performance Issue,"var commonUrls = DbContext.postedurllists
                          .Select(c => c.PostedUrl)
                          .Where(url => Urls.Contains(url))
                          .ToList();

var separateUrls = Urls.Except(commonUrls);
"
16433,mysql binary comparison doesnt use index,"ALTER TABLE YourTable MODIFY
   YourColumn VARCHAR(4)
   CHARACTER SET latin1
   COLLATE latin1_bin;
"
6658,GROUP data in one record (many-to-many),"SELECT GROUP_CONCAT(s.Size SEPARATOR ', ')
FROM RESERVATION r INNER JOIN
     RESERVATIONS_HAS_SIZE rhs
     ON r.ID = rhs.RESERVATION_ID INNER JOIN
     SIZES s
     ON rhs.SIZE_ID = s.ID;
"
10194,"ISQL app migration option, Progress - ""OpenEdge"" Personal RDBMS with 4GL(ABL) development system?","FOR EACH order-line OF order ...
"
8951,"Mysql complex query, group by with limit","SELECT store_id, SUM(visits) AS sum_visits 
FROM store_visits sv
WHERE sv.date <= '2014-06-28' AND sv.date >= '2014-06-27' AND sv.city_id = 2 
GROUP BY store_id 
ORDER BY sum_visits DESC LIMIT 5
"
23589,How can I get the most recent log entries across multiple log tables,"SELECT TOP 20 *
FROM(
    SELECT TOP 20
        Description, Created, Type, MachineName
    FROM [BAB].[dbo].[ActivityLog]
    WHERE Created > (GETDATE() - 1)
    ORDER BY Created DESC
    UNION ALL
    SELECT TOP 20
        Description, Created, Type, MachineName
    FROM [BAC].[dbo].[ActivityLog]
    WHERE Created > (GETDATE() - 1)
    ORDER BY Created DESC
) x
ORDER BY
    x.Created DESC
"
36022,SQL LIKE REGEXP Matching Single Value and Comma'd String,"SELECT resource_id,filename,id FROM image WHERE find_in_set('6154',other_vendors)
"
20493,"OrientDB: slow query, need help creating index to speed it up","SELECT timestamp, txId
FROM (
     SELECT expand(out(""AccountMoneyProfile"").in(""MoneyTransactionAccount""))
     FROM Account
     WHERE accountId = :accountId
     )
WHERE moneyType = :moneyType AND :registerType IN registerQuantities.keys()
ORDER BY timestamp DESC, @rid DESC
"
20131,Find foreign key matching multiple row values,"SELECT
  person_id
FROM
  yourTable
WHERE
     department = 'a'
  OR department = 'b'
GROUP BY
  person_id
HAVING
  COUNT(DISTINCT department) = 2
"
12786,Updating data in a table,"update criminals set charge1 = 
replace(charge1,substring(charge1, charindex('#',charge1), len(charge1)),'')
where charindex('#',charge1) > 0
"
28463,insert substring into new column,"UPDATE Name
SET ref_id = CASE WHEN CHARINDEX('-',full_id) = 4 THEN SUBSTRING(full_id,1,3) ELSE NULL END
"
17772,Advanced SQL Update query,"update ProductRelationship
    set rel_product_item_id = (select product_item_id 
                                   from ProductDetails 
                                   where sku = @UserInput)
    where product_item_id = @ValueSetOnPage
"
37199,Concatenate data from two fields ignoring NULL values in one of them?,"SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name,
a.city, a.street & (' ' +a.housenum) AS address
FROM Employees AS a
"
11118,Adding averages to a table,"select distinct
  location, unit, 
  cast(count(*) over (partition by unit, location) as decimal) / 
  cast(count(*) over (partition by unit) as decimal) as weight
from mytable
order by unit, location;
"
35953,SQL: join within same table with different 'where' clause,"  SELECT t.id,
         MAX(CASE WHEN t.key = 1 THEN t.value ELSE NULL END) AS ""1"",
         MAX(CASE WHEN t.key = 2 THEN t.value ELSE NULL END) AS ""2""
    FROM TABLE t
GROUP BY t.id
"
37190,Update a column based on results from junction table,"UPDATE i
SET i.organizations = 
  STUFF((
    SELECT ', ' + o.OrganizationName
    FROM Items_Organizations AS io
    INNER JOIN organizations AS o  ON o.organizationID = io.organizationID
    WHERE io.Item_Id = i.Item_Id AND io.Item_Id = 1
    FOR XML PATH(''))
  ,1,2,'')
FROM items AS i
WHERE i.Item_id = 1;
"
15364,"Why does ""select count(*)"" from nothing return 1","select 'test'
"
8728,Return all duplicate rows,"SELECT * 
FROM StyleTable 
WHERE Color IN (
  SELECT Color  
  FROM StyleTable   
  GROUP BY Color  
  HAVING count(*) > 1 
)     
"
1342,querying oracle table based on cumulative amount based of fiscal year and fiscal period,"SELECT
    sum(TRANASCTION_AMOUNT)
FROM MIGUEL83.CUM_LEDGER 
WHERE (TO_NUMBER(FISCAL_PERIOD) <= 10 AND FISCAL_YEAR = 2007)
OR FISCAL_YEAR < 2007
"
5107,Select from multiple tables in asp.net,"SELECT
  u.userid,
  u.firstname,
  u.lastname,
  a.Street,
  a.City
FROM [User] AS u
INNER JOIN Address AS a ON u.userId = a.userid;
"
14916,How to implement the D'Hondt method to allocate seats to votes in SQL?,"update dhont
set    seats = coalesce(calculated.seats, 0)
from   dhont as parties
left join (
  select party, count(*) as seats
  from (
    select     party
    from       dhont
    cross join generate_series(1, :seat_count) as divisor
    order by   cast(votes as decimal) / divisor desc
    limit      :seat_count
  ) as seat_labels
  group by party
) as calculated on parties.party = calculated.party
where parties.party = dhont.party
"
23883,Extracting only one data in a table using select,"select transferId, userId, subDeptId
from (select t.*,
             row_number() over (partition by userid order by TransferId desc) as seqnum
      from t
     ) t
where seqnum = 1
"
12208,Update MySQL tables with some duplicated entries,"CREATE UNIQUE INDEX Table1Column3 on Table1(Column3);

INSERT INTO Table1(Column1, Column2, Column3)
SELECT Column1, Column2, Column3
FROM Table2
ON DUPLICATE KEY UPDATE Column1 = Table2.Column1, Column2 = Table2.Column2
"
11354,bubble a record to the top of mySQL query based on record number,"SELECT ... ORDER BY (key_col = 123) DESC
"
5721,MSAccess: Ranking rows based upon column criteria,"SELECT a.Account, a.[Cost Centre], a.TransNo, (SELECT Count(*) 
   FROM table4  b
   WHERE b.Account=a.Account 
   AND b.[Cost Centre]=a.[Cost Centre] 
   AND b.TransNo<=a.TransNo) AS AccountNo
FROM Table4 AS a
ORDER BY a.Account, a.[Cost Centre], a.TransNo;
"
5501,What characters are allowed in Oracle bind param placeholders?,"create or replace function F0416B
RETURN VARCHAR2
is
    V_STMT    VARCHAR2(1999);
    V_RESULT  VARCHAR2(1999);
BEGIN 
    V_STMT := 'INSERT INTO TEST0411(FIELD1, FIELD2) VALUES ( :""A.1"" , :""A.2"")';
    EXECUTE IMMEDIATE V_STMT USING  'AS201', 'AS202';
    RETURN 'INSERT-OK';
    COMMIT;
EXCEPTION
WHEN OTHERS THEN RETURN SQLERRM;
END;    
"
9417,SQL - Is there a command to do this?,"create table #test (Item char(1),  TimeSold varchar(20))

  insert #test values('A','05/2010')
  insert #test values('B','04/2010')
  insert #test values('C','03/2010')
  insert #test values('A','04/2010')
  insert #test values('A','05/2010')

  SELECT *
FROM
(SELECT Item,TimeSold
FROM #test) AS pivTemp
PIVOT
(   COUNT(TimeSold)
    FOR TimeSold IN ([05/2010],[04/2010],[03/2010])
) AS pivTable
"
32005,Calc Order sum where Orderline contains product,"select o.OrderNo, OrderDate, ol.Amount,(select sum(oll.Amount * oll.UnitPrice) from OrderLine oll where oll.OrderNo = o.OrderNo) as OrderTotal
....
"
33338,decimal data type in Oracle,"Select to_char(1234.4, 'fm9999999.00') from dual; 
Select to_char(1234.45, 'fm9999999.00') from dual; 
Select to_char(1234,'fm9999999.00') from dual;
Select to_char(1234.4567, 'fm9999999.00') from dual;
"
18829,sql join parent record,"SELECT 
    A.visitid,
    A.Locn1ID,
    CASE 
      WHEN A.Locn2Name is null THEN A.Locn1Name 
      ELSE A.Locn2Name
    END 
    FROM (Select cvl.*, l2.* from
cv3clientvisit cv
inner join CV3ClientVisitLocation cvl on cv.guid = cvl.clientvisitguid
inner join cv3Location l on CVl.locationguid = l.guid
left join cv3location l2 on l.locngrpguid = l2.guid) as A
"
22645,how to write mysql trigger,"begin
   insert into summary_score (name,number,all_marks)
   values(new.name,new.marks,new.score)
   on duplicate key update all_marks=old.all_marks+new.student_marks
  where B.Name=new.Name;
end $$
"
11028,How to modify the date column values?,"DECLARE @Table TABLE(
    	Val VARCHAR(10)
)

INSERT INTO @Table (Val) SELECT '2009/01/31'
INSERT INTO @Table (Val) SELECT '2009/02/00'

SELECT * FROM @Table

SELECT  CAST(SUBSTRING(Val, 1, 8) + CASE WHEN SUBSTRING(Val, 9, 2) = '00' THEN '01' ELSE SUBSTRING(Val, 9, 2) END AS DATETIME) + CASE WHEN SUBSTRING(Val, 9, 2) = '00' THEN -1 ELSE 0 END
FROM    @Table
"
36682,Android SQLite search a column,"UPDATE your_table
   SET column_1 = ?,
       column_2 = ?
 WHERE number_column = number_from_code
"
1330,How can I get an SQL query to display only entries for the last week?,"WHERE (e.TotalCount = 1 OR e.LastThreeMonths = 1)
     AND OINV.[TaxDate] >= (GETDATE() - 7)
"
8817,Select records fillin a field on a block (Oracle Forms),"GO_BLOCK('MYTABLE');
EXECUTE_QUERY;
"
15487,How do I write this SQL Query to join these three tables?,"Select t2.AppName, t3.ProjectName
from table1 t1
inner join table2 t2 on t2.AppID = t1.AppID
inner join table3 t3 on t3.ProjectID = t1.ProjectID
"
20308,"Using the ""AND"" operator in with linq","from a in objcxt.tableA
join b in objcxt.tableB
on
    new { a.fld1, a.fld2 }
equals
    new { b.fld1, b.fld2 }
into b_join from b in b_join.DefaultIfEmpty()
"
6876,short sql challenge with multiple next row on a resultset with group by and having count,"select input.*
from 
    (select min(in_id) as idmin, to_id  
            from input 
            where us_id=1 group by to_id
    ) mintable, 
    input 
where 
   (input.to_id = mintable.to_id and input.in_id > mintable.idmin) 
   and us_id <> 1;
"
20011,how to have a Count when using Groupby?,"SELECT country,COUNT(*)  
FROM table        
GROUP BY country;  
"
32592,SELECT only records which must fill two conditions,"select a.*
from table1 a
    left join table1 b on b.otherid = a.otherid and b.type = 5
where a.type = 4 and b.id is null
"
27447,sql - Exec Stored Procedure using OpenRowSet,"SELECT *
FROM OPENQUERY(OtherServer, 'EXEC db.dbo.MyStoredProcedure ''test'', 100')
"
34004,Drop tables by date it were created,"select 
    'drop table  [' + s.name +'].[' + t.name +']' , t.create_date 
from 
    sys.tables t
inner join
    sys.schemas s
    on
    s.schema_id = t.schema_id
where 
    create_date< DATEADD(year,-3, GETDATE())
     and type='U'
"
33478,return a list from different rows into a single field,"select animal, group_concat(name)
from your_table
group by animal
"
5928,"basic sql : selecting the same column multiple times in one query, when each occurrence is dependent on different where clause","SELECT
(SELECT x FROM table WHERE y=1) AS x1,
(SELECT x FROM table WHERE y=2) AS x2,
(SELECT x FROM table WHERE y=3) AS x3
"
30697,Two Primary Key for a table and primary key,"CREATE TABLE myTable (
    key1 INTEGER NOT NULL, 
    key2 INTEGER NOT NULL, 
    PRIMARY KEY (key1, key2), 
    FOREIGN KEY (key2) REFERENCES otherTable (anotherKey),
    anotherField CHAR(100) NULL
)
"
30442,Can I selectively update rows based on existence of duplicate rows?,"UPDATE mytable t1
LEFT JOIN mytable t2 ON t1.type = t2.type AND t2.name = 'barney'
SET t1.name = CASE 
              WHEN t2.name IS NULL THEN 'barney'
              ELSE t1.name
           END,
    t1.status = CASE 
                WHEN t2.name IS NULL THEN t2.status
                ELSE 'DEL'
             END
WHERE t1.name = 'fred';
"
9383,"Teradata .NET Paramaters: Can I use Output parameters with SQL (ie, not using a stored procedure)?","Using cmd As TdCommand = MyConnection.CreateCommand
    cmd.GeneratedDataBehavior = GeneratedDataBehavior.IdentityColumn
    cmd.CommandText = ""insert into mydb.employee (name, email) values ('bob', 'bob@snob.com')""
    Using reader As TdDataReader = cmd.ExecuteReader
        While reader.Read
            Id = reader.GetInt64(reader.GetOrdinal(""Id""))
            iRowsInserted += 1
        End While
    End Using
End Using
"
7750,Razor check if row exists,"var db = Database.Open(""SmallBakery"");
var count = db.QueryValue(""SELECT COUNT(*) FROM Product WHERE Id = @0"", 123);
if (count > 0) {
    // the record exists
}
"
4641,Selecting filtered values from Oracle using ROWNUM,"select
  *
from
  (select
    dense_rank() over (order by PS_PK) as RANKING,
    p.*
  from
    ProcessSummary p)
where
  ProcessId IS NULL OR StepId IS NULL OR AsscoiateId IS NULL
"
19027,SQl query calculations across multiple tables,"SELECT *, SUM(amount_of_shares*c.share_price) as total FROM `portfolios`
LEFT JOIN companies c ON c.id = portfolios.company_id
GROUP BY `user_id`
ORDER BY total DESC
LIMIT 5
"
17533,Creating Associations from Comma Delimited List in SQL,"INSERT INTO PeopleLanguages (PeopleID, LanguageID)
SELECT P.Id, L.Id
FROM People P
JOIN Language L ON  CHARINDEX(L.Name, P.Languages) > 0
"
4175,"aggregate function, newest date","SELECT maxdate, t.name, t.address
from table1 t
inner join
(
    SELECT MAX(date) as maxdate, name
    FROM table1
    GROUP BY name
) d on(t.date = d.maxdate and t.name = d.name)
"
4403,how do I select a column based on condition?,"SELECT ordr_num as num, ordr_date as date, 
    CASE WHEN @status<>'Cancelled' THEN ordr_ship_with ELSE NULL END as shipwith 
FROM order 
WHERE ordr_num = @ordrNum
"
632,"Mysql column sorting of string data with characters like `() ' ""`","ORDER BY REPLACE(REPLACE(REPLACE(REPLACE(my_col,'""', ''), '(',''), ')', ''), '''','') ASC
"
26926,SQL Statements in a Windows Batch File,"echo select * from dual; | sqlplus user/pw@db
"
29314,Combine 2 SQL Query results,"select dateName(month, DateAccessed) ""Month""
, datePart(month, DateAccessed) sortColumn
, count(1) totalVisits
, count(distinct l.userName) UsersVisit
from and where clause goes here
group by dateName(monthDateAccessed)
order by sortColumn
"
21271,how to fill bed number column for patients table in a hospital database according to the occupied dates of a particular bed,"select bed_id
from bed
minus
select bed_id
from bed_occupancy
where enter_datetime is not null
and departure_datetime is null
"
11006,row number based on field data,"ROW_NUMBER() OVER(PARTITION BY docRefID ORDER BY docExternalContent)
"
17722,Reduce the number of characters in an SQL function in Oracle database,"select c,s,f as f,d as d, v as v from (mysql)
UNION ALL
select c,s,f+(select max(d)-min(d) from mysql)+t.r as f,d+(select max(d)-min(d) from mysql)+t.r as d,0 as v 
from (mysql)
CROSS JOIN 
(
SELECT Rownum r
FROM  dual
CONNECT BY Rownum <= 15
) t
"
28283,How to combine two tables into one with a new field with table source?,"(SELECT `date`, `index`, idOne AS id, 'One' AS idType
 FROM   one
 WHERE  id = 5)
UNION ALL
(SELECT `date`, `index`, idTwo AS id, 'Two' AS idType
 FROM   two
 WHERE  id = 5)
"
7879,Difference between a select with and without join,"SELECT Persons.LastName, Persons.FirstName, Orders.OrderNo
FROM Persons, Orders
WHERE Persons.Id_P = Orders.Id_P 
"
23286,How can I find days between different paired rows?,"select count(distinct recipient_id)
from email e1
where e1.activity = 'delivered'
  and exists
        (select * from email e2
         where e1.recipient_id = e2.recipient_id
           and e2.activity = 'open'
           and datediff(e2.action_date,e1.action_date) <= 1)
"
4400,How to fill the mysql table with other columns,"UPDATE yourtable SET username = email;
"
20232,Two-way encryption + look-up?,"SELECT ...
FROM yourtable
WHERE encrypted_email = AES_ENCRYPT('someone@example.com', 'crypt key here');
"
27621,Check duplicates in nvarchar column of table in SQL Server,"select ii.itemno, s.c, count(*) as cnt
from importitem ii apply
     dbo.split(ii.countryids) as s(c)
group by ii.itemno, s.c
having count(*) > 1;
"
36941,How do I this in MySQL?,"CREATE UNIQUE INDEX ux_platform_version ON tbl (platform, version)
"
4737,join two mysql queries to order the first query by the result of the second,"SELECT Posts.*, count(Comments.ReportID) as CommentCount FROM Posts 
LEFT JOIN Comments
ON Comments.ReportID = Posts.ReportID
WHERE private = 0
GROUP BY Comments.ReportID
ORDER BY CommentCount, ReportID Desc;
"
4459,Denormalizing using query in Oracle,"SELECT *
FROM   (SELECT *
        FROM   x)
PIVOT  (MAX(marks)  FOR (SUBJECT) IN ('ENGLISH', 'MATHS', 'TAMIL'));
"
34667,Vba built in function for holidays during a year?,"SELECT d.the_date
FROM
    [date-table] AS d
    LEFT JOIN statHolidaysTbl AS h
    ON d.the_date = h.Date
WHERE h.Date Is Null;
"
31972,Formating big int SQL Server,"select sn % 10000000000000 from table1
"
37961,Get top 1 row of each group,";WITH cte AS
(
   SELECT *,
         ROW_NUMBER() OVER (PARTITION BY DocumentID ORDER BY DateCreated DESC) AS rn
   FROM DocumentStatusLogs
)
SELECT *
FROM cte
WHERE rn = 1
"
20953,join multiple rows from one table into one row from another table,"select f.Idloko,
       max(case when seqnum = 1 then s.personal end) as personal1,
       max(case when seqnum = 2 then s.personal end) as personal2,
       max(case when seqnum = 3 then s.personal end) as personal3
from first f left join
     (select s.*,
             row_number() over (partition by IdlokoStav order by idPersonalStav) as seqnum
      from second s
     ) s
     on f.IdlokoStav = s.IdlokoStav
group by f.Idloko;
"
13418,SQL Query which depends on the existence of other rows,"with input(cat, code) as (select 'c1', 'x' from dual 
                union all select 'c2', 'a' from dual
                union all select 'c3', 'k' from dual)
select id from (
  select t.id, max(decode(i.code, t.code, 1, 0)) cc from t
    left join input i on i.cat = t.cat and i.code = t.code
    group by t.id, t.cat)
  group by id having min(cc) = 1;
"
28351,SQL select and match from multiple tables,"SELECT TOP 10000
  [Logs].[LogUID],
  [LogGroups].[LogUID],
  [LogGroups].[GroupUID]
FROM
  [log].[dbo].[Logs]
INNER JOIN
  [log].[dbo].[LogGroups]
    ON [Logs].[LogUID] = [LogGroups].LogUID ; 
"
33976,How to make a statement starting with '#' not considered as a comment in an SQL script?,"insert into table (funcs)
values('func1()'||
'func2()'||
'#func3()'||
'func4()'||
'#func5()');
"
12224,Concatenation multiple rows and columns in SQL Server,"select s.id, s.name,
       stuff((select ',' + cast(subjectid as varchar(8000)) + ':' + cast(marks as varchar(8000))
             from marks m
             where m.studentid = s.id
             for xml path (''), type
             ).value('.', 'varchar(max)'), 1, 1, ''
            ) as SubjectMarks
from student s;
"
34270,SQL joins with order by,"select n.col1
     , n.date1
     , m.col2
     , m.date2
from t1 n 
full join t2 m on n.date1 = m.date2
              and n.col1 = (select max(col1) from t1 where date1 = m.date2 )  
              and n.col1 is not null
where n.date1 is not null or m.date2 is not null
order by coalesce(n.date1, m.date2)
       , coalesce(n.col1, m.col2)
"
37781,"What is the correct datatype to store ""Worked Hours""","Time int
---- ---
1:30 90
0:45 45
2:15 135
8:00 480
6:19 379
"
34915,MySQL Query for getting records with reference to records of related table with condition,"SELECT pr.id, pr.jobNo 
FROM project pr 
JOIN (SELECT jobNo 
      FROM user_table u 
      JOIN Assign_User a ON u.id=a.F_userID 
      JOIN project p ON p.id=a.F_projectID WHERE u.id=2) a 
ON pr.jobNo=a.jobNo 
WHERE pr.islive='Y';
"
15785,SQL Server Reversed CONTAINS,"DECLARE @param varchar(10)
SET @param = '100023'

SELECT Value 
FROM dbo.TableName 
WHERE @param LIKE '%' + Value + '%'
"
9023,Select Column Based on Maximum Value in Another Column,"SELECT id FROM test
GROUP BY id
HAVING MAX(time) <= 'X'
"
36439,Convert different time zone in SQL Server,"-- define your input in Eastern Time
DECLARE @Input DATETIMEOFFSET = SYSDATETIME()
-- SET @Input = SWITCHOFFSET(@Input, '-05:00')
SET @Input = SWITCHOFFSET(@Input, -300)

DECLARE @output DATETIMEOFFSET

-- convert Eastern Time to IST
-- SET @output = SWITCHOFFSET(@input, '+05:30')
SET @output = SWITCHOFFSET(@input, 330)

SELECT @Input, @output
"
35312,Is it possible to change the values in a database column to lowercase?,"SELECT lower (field_id_90)
FROM exp_channel_data;
"
37393,PSQL not counting all entries,"      SELECT COUNT(a.event_id) as attendances
      FROM (SELECT DISTINCT event_id, member_pers_id
            FROM event_attendance
            WHERE status NOT LIKE 'Apology' OR status IS NULL
           ) a
"
7424,How to select all the columns of a table except one column?,"SELECT * INTO #TemporaryTable FROM YourTableName

ALTER TABLE #TemporaryTable DROP COLUMN Columnwhichyouwanttoremove

SELECT * FROM #TemporaryTable 

DROP TABLE #TemporaryTable 
"
3243,MySQL query - show results that are not in another table,"SELECT lesson.id, p1.first_name, p1.surname, start_time, instrument.name 
FROM  lesson l JOIN person p1 ON l.student = p1.id
JOIN person p2 ON l.teacher = p2.id
JOIN instrument i ON i.id = l.instrument_id
LEFT JOIN invoice_lesson il ON l.id = il.lesson_id
WHERE il.lesson_id IS NULL
ORDER BY surname
"
6306,SQL - Select rows from two different tables,"select itemID, itemTitle, deleted, userID
FROM(
SELECT i.id_itemID, i.itemTitle, M.deleted, M.userID
FROM
    MyList M
    right OUTER JOIN Items I ON I.itemID= M.itemID
) as MyTableItems
where itemID = 3 or itemID is null
"
24577,What is the Oracle equivalent of the Informix `interval` function?,"WHERE f.writetime > current_timestamp - INTERVAL 'xxx' DAY TO DAY
"
26856,how to change permission for the service account in azure's sql management portal,"DELETE FROM dbo.Users WHERE Username = 'Nazerke'
"
28230,"MySQL query takes over 15 minutes, doesn't seem like its THAT much data","SELECT content FROM buttons btns
JOIN 
    (SELECT distinct qid_id FROM groups_qids WHERE group_id IN
        (SELECT 5 
         UNION
         SELECT id FROM groups WHERE parent_id=5
         UNION
         SELECT id FROM groups WHERE parent_id IN 
           (SELECT id FROM groups WHERE parent_id=5))) tbl ON tbl.qid_id = btns.qid_id
WHERE btns.button_type_id=8;
"
23892,deleting from table (join),"DELETE from t1 where t1.ID not in (SELECT ID FROM t2)
"
24729,VIEW SQL data table,"select  DUN
    ,SUM(Case When JANTINA = 'MELAYU' Then JUMLAH else 0 end) as MELAYU
    ,SUM(Case When JANTINA = 'CINA' Then JUMLAH else 0 end) as CINA
 from maklumat
 group by DUN
"
14229,Multi inputs search doesnt work properly,"SELECT * FROM `inmuebles` 
WHERE action = 'sell' 
AND type = 'apartment' 
AND city = 'Los Angeles') 
AND rooms BETWEEN 2 AND 5
"
7734,Access query using * and sort criteria on columns - how to make field show just column name?,"SELECT Projects.*
FROM Projects
ORDER BY Projects.MySortField DESC;
"
30807,how to select first non-duplicate data in sql,"WITH CTE AS(
   SELECT Id, Name, Type,
       RN = ROW_NUMBER() OVER ( PARTITION BY Type ORDER BY ID )
   FROM dbo.Table1
)
SELECT Id, Name, Type FROM CTE WHERE RN = 1
"
19023,How to write an SQL query to find out which logins have been granted which rights in Sql Server 2005?,"select DbRole = g.name, MemberName = u.name
  from @NAME.sys.database_principals u, @NAME.sys.database_principals g, @NAME.sys.database_role_members m
  where   g.principal_id = m.role_principal_id
    and u.principal_id = m.member_principal_id
    and g.name in (''db_ddladmin'', ''db_owner'', ''db_securityadmin'') 
    and u.name not in (''dbo'')
  order by 1, 2
"
18629,Porting from MySql to T-Sql. Any INET_ATON() equivalent?,"create function INET_ATON (@addr varchar(15))
returns bigint
with schemabinding
as
begin
  return  
    cast(parsename(@addr, 4) as bigint) * 16777216 +
    cast(parsename(@addr, 3) as bigint) * 65536 +
    cast(parsename(@addr, 2) as bigint) * 256 +
    cast(parsename(@addr, 1) as bigint)
end
"
31057,Can you increase the salary for 2 different job ID's in the same select statement?,"case when job_id like '%VP%' then 1.3 else 1.2 end * salary
"
24172,SQL: Deleting duplicate records in SQL Server,";WITH r AS
(
    SELECT col1, col2, col3, -- whatever columns make a ""unique"" row
    rn = ROW_NUMBER() OVER (PARTITION BY col1, col2, col3 ORDER BY col1)
    FROM dbo.SomeTable
)
DELETE r WHERE rn > 1;
"
15572,How to query Oracle v$ tables using Groovy,"sql.eachRow( '''Select
               |  'Y' as runInd
               |  from v$session
               |  where upper(module) = ?
               |  having count(*) > 1'''.stripMargin(), [programName]) { row ->
    etc...
}
"
38551,mySQL join with where condition,"$kvvesDetails = $conn->prepare( ""SELECT u.id, u.name, u.phone, u.email, u.address, m.name, m.designantion, m.phone, m.email, m.image FROM kvves_units AS u JOIN kvves_members AS m ON m.unit_id = u.id WHERE name = '$committee'""
"
34813,"Updating tables from generate_series(int, int) function Postgres 9.0","update data 
   set ordering = t.rn
  from (select pk_column, 
               row_number() over (partition by clientid  order by pk_column) as rn
          from data
       ) t
where t.pk_column = data.pk_column;
"
36447,Selecting records with single quotes escaped by double backslashes only,"SELECT * FROM my_table WHERE my_column RLIKE '[\\]{2}';
"
12701,Counting sum of items of type," SELECT 
   SUM(CASE type WHEN 'shoe' then quantity ELSE 0 END) AS ""shoes"",
   SUM(CASE type WHEN 'hat' then quantity ELSE 0 END) AS ""hats""
 FROM items ;
"
24334,"SQL more than 100 'OR' conditions, and CASE/WHEN does not return the desired values","SELECT  t.*
FROM    Tab t,
        Conditions c 
WHERE   (t.hv = c.hv) and 
        (c.h1 is null or t.h1 = c.h1) and 
        (c.h2 is null or t.h2 = c.h2)
"
37644,Squeryl dynamic join clauses,"on(
   t1.secondary === t2.id and
   (if(hasFallback.isDefined) t1.fallback.isNotNull else 1 === 1.inhibitWhen(true))
)
"
33277,PostgreSQL count() and arrays,"SELECT SUM(array_length(episode_number, 1))
  FROM episodes
 WHERE show_id = 1
"
25677,SQL - Filter rows with the same foreign key as a group,"select s.*
from session s
where s.id in (select session_id
               from pageview pv
               group by session_id
               having sum(case when url ilike '%step-1%' then 1 else 0 end) > 0 and
                      sum(case when url ilike '%finish%' then 1 else 0 end) > 0
             );
"
11771,Mysql Date to timestamp SQL Query,"SELECT data.content,item.value
FROM contents 
 AS data 
JOIN items 
 AS item 
WHERE data.id=item.content_id 
ORDER BY data.release_date DESC
LIMIT 50
"
32660,FOR ALL/EXIST Queries,"SELECT distinct P1.name
FROM Persons P1 
INNER JOIN Knows K ON K.personA_id = P1.id
INNER JOIN Persons P2 ON K.personB_id = P2.id AND P1.age - P2.age > 5
"
23738,Get table name of an entity for a query in TYPO3 Flow,"/**
 * @Flow\Inject
 * @var \Doctrine\Common\Persistence\ObjectManager
 */
protected $entityManager;

[...]

$dql = 'SELECT COUNT(e) FROM Vendor\Package\Domain\Model\Entity e WHERE e.property = :property';

$query = $this->entityManager->createQuery($dql);
$query->setParameters(array('property' => $property));
$result = $query->execute();
"
34865,MS SQL query - 2 tables same field - decide whitch to use,"SELECT COALESCE(PriceDiscount, Price) AS Price FROM mytable
"
36223,Is it possible to delete all databases that were created by a specific user?,"SELECT db FROM mysql.db WHERE user = ""<user>""
"
36762,How can I convert 02-August-2014 to datetime type in SQL?,"declare @a varchar(20)
set @a='02-August-2014'

select cast(@a as date)

select CONVERT(VARCHAR(12), cast(@a as date), 105) AS [DD-MM-YYYY]
"
12003,"Join on a lookup table, to display the whole of one table where id's match?","select
  planner.cell_id
, planner.recipe_name
, planner.day
, ingredients.quantity
, ingredients.measurement
, ingredients.description
from 
  planner inner join lookup
    on planner.recipe_id = lookup.recipe_serial
  inner join ingredients 
    on lookup.ingredient_serial = ingredients.serial
where planner.is_populated = 1
order by
  planner.cell_id
, ingredients.serial
"
847,Numbering rows without window functions,"drop sequence if exists row_numbers;
create temporary sequence row_numbers;

select next_val('row_numbers'), dt.c
from (select c from t order by c) as dt;
"
19020,SAS/SQL aggregate by multiple columns,"select Trader
     , sum(Trade) as Total
from (
    select Trade_Party_1 as Trader, Trade from tbl
    union all
    select Trade_Party_2 as Trader, Trade from tbl ) t
group by Trader
"
28604,How to express this query in SQL Server 2008,"SELECT *
FROM
(
    SELECT OutletId, CampaignId, ItemId, Qty
FROM Reporting) AS p
PIVOT
(
    SUM(Qty)
    FOR ItemId IN (SELECT ItemId FROM Reporting WHERE campaignId =1) 
) as pvt
"
25691,CASTing a datetime to string if null value - keeping original datetime formatting,"ISNULL(convert(varchar(20), fd.decision_date, 120), 'PENDING') as facility,
"
23348,How to get user of a schema with sql/plsql,"SELECT osuser 
FROM   v$session 
WHERE  schemaname = 'abc';
"
8276,Create a row in another table based on currently inserted row,"DELIMITER $$
CREATE
    TRIGGER `user_after_insert` AFTER INSERT 
    ON `users` 
    FOR EACH ROW BEGIN  
        INSERT INTO data (uid) VALUES (NEW.id);
END$$
DELIMITER ;
"
35302,Writing a SQL script but having trouble,"WITH cteRowNums AS (
    SELECT MainId, SecondaryId, Type, Year, DateColumn,
           ROW_NUMBER() OVER(PARTITION BY MainId, SecondaryId, Type, Year ORDER BY DateColumn DESC) AS RowNum
        FROM image
)
DELETE FROM cteRowNums
    WHERE RowNum <> 1;
"
23902,Limiting mySQL data as 5 column 2 entries per column 1 entry,"CREATE TRIGGER LimitTweetUpdates BEFORE INSERT ON myTweeterTable
  FOR EACH ROW BEGIN
    DELETE FROM myTweeterTable
    WHERE person = NEW.person
    AND id NOT IN 
      (SELECT id FROM myTweeterTable  
       WHERE person = NEW.person
       ORDER BY id DESC
       LIMIT 5)
  END;
"
6724,Join Multiple tables (basically the same table) with Joins,"Select CompanyId, Category_ID
From Product1 inner join
     Category
     on Category.Id = Product1.Category_ID
where Product1.CompanyId = 10
union
Select CompanyId, Category_ID From Product2 
From Product2 inner join
     Category
     on Category.Id = Product1.Category_ID
where Product2.CompanyId = 10
union
Select CompanyId, Category_ID From Product3
From Product3 inner join
     Category
     on Category.Id = Product3.Category_ID
where Product1.CompanyId = 10;
"
11154,How to select the total number of logins by date?,"select year, month, day, sum(loginCount) 
  from user 
 group by year, month, day
"
25502,Trigger with insert statement,"ALTER DATABASE databasename 
SET RECURSIVE_TRIGGERS ON | OFF
"
8022,How to set/check for a unique value in a column with CHAR (1) = y/n,"update MyTable set Visible = 'N' where
Visible = 'Y';
update MyTable set Visible = 'Y' where
ID = 123;
"
32376,Change field name in django admin,"name = models.CharField(max_length=200, verbose_name=""Nom"")
"
16041,SQL Server Group By and Left Outer Join Custom result set,"SELECT ?? FROM RDC
OUTER APPLY
(SELECT TOP 1 * FROM CONS_STATUS
WHERE RDC.RDC_CONSNO = STS_CONSNO
ORDER BY sts_id DESC
) a
INNER JOIN DESTINATION d
ON d.DEST_ID=RDC.RDC_DESTINATION 
WHERE RDC.RDC_CONSNO='HD88300'
ORDER BY a.STS_ID
"
32800,Query counts using inner selects,"SELECT 
    t.event as event_date,
    SUM(t.type = 2) AS type_count,
    SUM(t.type != 3)AS non_type_count
FROM mytable t
WHERE t.event >= '2013-10-01' AND t.event <= '2013-10-08'
GROUP BY t.event
"
7820,Comparing huge amounts of binary data quickly,"<fieldType 
   name=""signatureNgrams"" 
   stored=""false"" 
   class=""solr.StrField""> 
 <analyzer type=""index""> 
   <tokenizer 
       class=""solr.analysis.NGramTokenizerFactory"" 
       minGramSize=""4"" 
       maxGramSize=""4"" 
       /> 
   <filter class=""solr.LowerCaseFilterFactory""/> 
 </analyzer> 
</fieldType>
"
34083,"Search query - Postcode, Company name or Location","select distinct c.*
from company c
join postcode_areas p on p.company_id = c.company_id
where c.name like <input>
or c.location like <input>
or p.postcode like <input>
"
18218,How to group columns into a field containing the data?,"GROUP_CONCAT(CONCAT(wu_paqueteproducto.extra1, ' ', wu_paqueteproducto.producto)) AS elproducto
"
21427,Sql Query Filter,"SELECT   room_no, type
FROM     (SELECT   room_no, type, COUNT(DISTINCT date) AS cnt
          FROM     rooms
          GROUP BY room_no, type) r
JOIN     (SELECT COUNT(DISTINCT date) AS cnt
          FROM   rooms) c ON r.cnt = c.cnt
"
8577,Trying to capture all of the Row_Numbers with Rows > 1,"COUNT(*) OVER(PARTITION BY m.memberfirstname+' '+m.memberlastname,m.MemberDOB,s.GroupID ORDER BY m.MemberDOB) CountNo
"
17639,Postgresql fetch raw value in two tables which have in same column,"SELECT Table_one.school_id, Table_one.subjec_code as subject, Table_one.student_count,
     Table_two.subjec_code, Table_two.teacher_count
    FROM Table_one FULL OUTER JOIN  Table_two
    ON Table_one.school_id = Table_two.school_id
    AND Table_one.subjec_code = Table_two.subjec_code
    ORDER BY table_one.school_id, Table_one.subjec_code;
"
39753,SQl Query to get data from single row as multiple rows,"SELECT
  Department_name,
  'Owner'
FROM test
WHERE Owner_ID = 1234567

UNION ALL

SELECT
  Department_name,
  'Approver'
FROM test
WHERE Approver_ID = 1234567
"
33732,Insert function parameter in select part of sql query,"create or replace function GetHorizonTime(HorizonWindowMinutes IN NUMBER) 
  return timestamp
IS
BEGIN
  return SYSDATE + numtodsinterval( HorizonWindowMinutes, 'minute' );
END;
/
"
25290,ACCESS 2007: Determine maximum value per row across multiple columns,"select
  EmployeeColumn,
  iff(iif(Date1 > Date2, Date1, Date2) > Date3, iif(Date1 > Date2, Date1, Date2), Date3)
from yourTable
"
34073,How to show the vertical data horizentally through sql,"SELECT  JID,WID,AccountReference,OEReference,InvoiceNumber
FROM    
( 
    SELECT colname, data FROM YourTableName
) 
p 
PIVOT 
( 
    Max(data) FOR colname 
    IN ([JID],[WID],[AccountReference],[OEReference],[InvoiceNumber])
) AS pvt
"
27854,Count The number of Visit in SQL,"select CNT,   PATID,     DATE,      PATName, 
row_number() over (partition by PATName order by PATID) as VISIT
from table
"
2692,Deciding between two methods to check if a row exists (more subqueries VS more left joins),"     EXISTS (SELECT 1 FROM review r WHERE r.product_id = p.product_id) AS has_review,
     EXISTS (SELECT 1 FROM thread t WHERE t.product_id = p.product_id) AS has_thread,
     EXISTS (SELECT 1 FROM award a WHERE a.product_id = p.product_id) AS has_award,
"
28386,cannot pass dynamic query to sql-function,"DROP FUNCTION function_test(text);
CREATE OR REPLACE FUNCTION function_test(text) RETURNS bigint AS $$
    DECLARE
        ret bigint;
    BEGIN
    execute(format($q$
        SELECT count(mt.id) INTO ret
        FROM mytable as mt
        WHERE mt.location_id = 29671
        %s; $q$, $1)
    );
    RETURN ret;
    END;
$$ LANGUAGE plpgsql;
"
24928,Find the record with the lest amount of associated records,"SELECT Questions.ID, COUNT(Results.ID) Result_Count
FROM
    Questions
    LEFT JOIN Results ON Questions.ID = Results.Q_ID
GROUP BY Questions.ID
ORDER BY COUNT(Results.ID)
"
14046,SQL count variables and write into another table,"update smf_members a, 
    (select user_id,
    sum(if(karma_action='+',1,0)) karma_good,
    sum(if(karma_action='-',1,0)) karma_bad
    from phpbb_karma
    group by user_id) b
set a.karma_good=b.karma_good, a.karma_bad = b.karma_bad
where a.id_member = b.user_id;
"
2810,How to place quotes around a SQL parameter?,"DECLARE @SearchTerm nvarchar(1000)
SET @SearchTerm = N'""' + @SearchTerm + N'""'
SELECT
  ProductName
FROM
  dbo.Products p1
WHERE
  CONTAINS((p1.ProductName), @SearchTerm)
"
22569,MySQL query and count from other table,"SELECT
    c.*, COUNT(u.cid) AS count
FROM
    cars c
LEFT JOIN 
    uploads u
ON
    u.cid=c.customer
WHERE
    u.customer = 11;
GROUP BY c.cid
"
14035,How to show 0 in column if no match is found?,"Nz(Actual, 0) AS Actual
"
29306,Get alternate weekend in month,"WHERE
    DATEPART(weekday,DateToCheck) = DATEPART(weekday,'20120910') AND
    (
        DATEPART(day,DateToCheck) between 1 and 7 OR
        DATEPART(day,DateToCheck) between 15 and 21 OR
        DATEPART(day,DateToCheck) between 29 and 31
    )
"
26728,selecting based on all conditions being met (relational division),"  SELECT qht.questionid
    FROM question_has_topic AS qht
   WHERE qht.topicid IN (8,9,10)
GROUP BY qht.questionid
  HAVING COUNT(*) = 3 AND
         COUNT(*) = (SELECT COUNT(*) FROM question_has_topic AS dupe
                     WHERE dupe.questionid = qht.questionid)
"
10008,VBA - SQL - Include records with zero count,"select year(joining_date), month(joining_date),
       sum(case when department = 'IT' then 1 else 0 end)
from sample 
group by year(joining_date), month(joining_date)
order by 1, 2;
"
2707,Need Help formulating an SQL Query,"SELECT
    pickupid,
    pickuplocation,
    IF(Date1 > NOW(),Date1,NULL) AS Date1,
    IF(Date2 > NOW(),Date2,NULL) AS Date2,
    IF(Date3 > NOW(),Date3,NULL) AS Date3,
    IF(Date4 > NOW(),Date4,NULL) AS Date4
FROM
    locations_table
WHERE
    Date1 > NOW() 
    OR Date2 > NOW()
    OR Date3 > NOW()
    OR Date4 > NOW()
"
24469,Return all rows but aggregate some of them (and not others),"select cola,
       (case when cola = 'B' then 'all'
             else colb
        end),
       sum(value)
from TABLE1 T1
group by cola,
         (case when cola = 'B' then 'all'
               else colb
          end);
"
33443,using sql count in a case statement,"SELECT 
    COUNT(CASE WHEN rsp_ind = 0 then 1 ELSE NULL END) as ""New"",
    COUNT(CASE WHEN rsp_ind = 1 then 1 ELSE NULL END) as ""Accepted""
from tb_a
"
11401,merge adjacent repeated rows into one,"select *
from table t1
where not exists(select * from table t2 where t2.order = t1.order - 1 and t1.data = t2.data)
"
13242,`GROUP_CONCAT()` for many to many,"select brand.title, brand.slug, GROUP_CONCAT(j2.slug) AS types
from brand brand LEFT join
     type_brand j1
     on j1.brand_id = brand.id LEFT join
     types j2
     on j2.id = j1.type_id
group by brand.title, brand.slug 
limit 10;
"
3431,How to convert XY coordinates to GPS in Oracle Spatial?,"select 
sdo_lrs.locate_pt(sdo_lrs.convert_to_lrs_geom(sdo_cs.transform(shape,8307)),0.02).sdo_ordinates  
from 
TEST_SCHEMA.TEST_TABLE
where 
route='ABC'
and
segmentnum='101.1'
"
1806,Examining KEYLOCKs in SQL Server 2005,"SELECT  *
FROM    mytable
WHERE   %%LOCKRES%% = '{0000ABCDEFAB}'
"
22327,Firebird second instance is not accessible,"isql localhost/13050:employee
"
28630,How to select all from SQL query including subquery,"select a.*
    , name = case
        when 
           a.name = 'a'
         then 0 
        else 1
    end
as selected
from points as a
"
11348,Need help to write Sql update query?,"update table1 
set column1 = table2.name 
FROM table1 join table2 ON table1.column2 = table2.ID
where table2.profile = true
"
8533,PostgreSQL complex JOIN or Subselect query structure,"select geonameid, isolanguage,
       max(case when ispreferredname = t or isshortname = t then NULL
                else alternatename
           end) as alternatename,
       max(case when ispreferredname = t then alternatename
           end) as preferredname,
       max(case when isshortname = t then alternatename
           end) as shortname
from table t
group by geonameid, isolanguage;
"
34091,12 months rolling data from previous month in sql,"SELECT 
    AVG(AEBill.[TotalCost])
    ,AEEnc.ProviderID
            ,AEEnc.Date
    INTO #TotalCostAccuteCareAE
    FROM EncDetail AEEnc
    INNER JOIN [EncBilling] as AEBill
    ON  AEBill.[SK_EncID] = AEEnc.[SK_EncID]    
        AND AEBill.ProviderID = AEEnc.ProviderID
            WHERE AEEnc.Date <= DATEADD(year,-1,GETDATE())
    GROUP BY AEBill.ProviderID
"
33365,how to know the count of words starting with a particular word in database?,"select s_no,name from tablename where name like 'a%' or name like 'b%'
"
32030,MySQL and UTF-8,"SET character_set_client = x;
SET character_set_results = x;
SET collation_connection = @@collation_database;
"
19845,Filtering data in sql for each month from a date field,"SELECT  P.pid
,p.productname
,Month=datepart(mm, O.date)
,QuantitySold = sum(L.number)
,NumberCustomer = count(distinct cid)
,Revenue = sum(L.totalprice)
FROM orders O 
JOIN customer C on C.cid = O.cid
JOIN lineitem L on L.oid = O.oid
JOIN product P on P.pid = L.pid
GROUP BY
 P.pid
,p.productname
,Month=datepart(mm, O.date)
"
3125,How to make a query to a table generated by a select?,"SELECT count(subadd.address) 
FROM (SELECT name, address, phone, from user) as subadd;
"
16340,MySQL query aggregating users who perform an activity,"SELECT number_of_activities, COUNT(*) AS cnt
FROM
(
   SELECT COUNT(*) AS number_of_activities
   FROM ca_activity
   GROUP BY user_id
) T1
GROUP BY number_of_activities
ORDER BY number_of_activities
"
30446,NSFetchedResultsController OR predicate returning duplicates on iOS6 for certain items,"NSPredicate *predicate = [NSPredicate predicateWithFormat:@""isMarkedForDelete != YES AND isTopReferenceMessage = YES AND SUBQUERY(folders, $folder, $folder = %@).@count != 0 AND account = %@"", folder, folder.account];
"
19565,TSQL 2012 Format String Literal with AM and PM,"    THEN format(dateadd(hh, -4, GETDATE()), 'MMMM d, yyyy h:mmtt EDT')
ELSE format(dateadd(hh, -5, GETDATE()), 'MMMM d, yyyy h:mmtt EST')
"
16906,SQL Delete Records within a specific Range,"delete from Table where id between 79 and 296
"
824,Combine records based on unique account number,"with cte as (
  select row_number() over (partition by accountno order by pk) rn,
    accountno, ownerfname, ownerlname
  from yourtable
  )
select 
  accountno, 
  max(case when rn = 1 then ownerfname end) OwnerFname,
  max(case when rn = 1 then ownerlname end) OwnerLname,
  max(case when rn = 2 then ownerfname end) OwnerFname2,
  max(case when rn = 2 then ownerlname end) OwnerLname2
from cte
group by accountno
"
17239,mysql query : i want to 2 queries result merged w.r.t primary key,"select ledger.refno, (sum(ledger.rate*ledger.quantity-recieved) - customer.deposit) AS total from ledger
INNER JOIN customer
ON customer.refno = ledger.refno
"
3626,Get registrations per class even if nobody has registered,"CREATE PROCEDURE dbo.ClassRegistration
AS
BEGIN
  SET NOCOUNT ON;

  SELECT c.ClassName, t.TeacherName, 
    COUNT(cr.Student_ID) As Registrations, 
    COUNT(NULLIF(cr.HasPaidFees, 0)) As NumberPaid
  FROM dbo.Class As c
  INNER JOIN dbo.Teacher As t
  ON t.Teacher_ID = c.Teacher_ID
  LEFT OUTER JOIN dbo.ClassRegistration As cr
  ON c.Class_ID = cr.Class_ID
  GROUP BY c.ClassName, t.TeacherName;
END
GO
"
602,get rank of specific users in mysql,"select uv.*, (@rank := @rank + 1) as rank
from uservotes uv cross join
     (select @rank := 0) const
where uv.id in (2, 4, 6, 8, 10)
order by votes desc;
"
3639,problems while trying to optimize my SQL(inner join and group),"SELECT otd.userid,otd.task,otd.date_request,ot.approved_by 
FROM otd
JOIN ot 
  ON otd.userid = ot.requested_by
  AND otd.date_request = ot.date_request
WHERE otd.userid ='xxx' 
  AND CONVERT(varchar,otd.date_request,101) BETWEEN '09/10/2013' AND '09/11/2013'
  AND ot.status ='A'
ORDER BY otd.date_request,ot.date_request ASC
"
37805,SQL IF THEN for concatenating fields,"select if(min_price=max_price,min_price,concat(min_price,' - ',max_price)) as price
from your_table;
"
18925,Joining 3 tables,"SELECT comments.*, users.username, 
FROM comments C INNER JOIN task t ON C.task_id=t.task_id 
INNER JOIN users U on  C.user_id = u.user_id    
WHERE t.task_id = @task_id  //(this is variable, pass your task value here)
"
3485,Right make SQL query's,"SELECT sw.word 
FROM words w
INNER JOIN
    synonyms s ON
        s.w_id = w.id
INNER JOIN
    words sw ON
        sw.id = s.s_id
WHERE w.word = 'Profit'
"
4584,Bash while read : output issue,"#!/bin/bash
MAX=8
j=0
while read ip code
do
   (sleep 5; echo $ip $code) &   # Replace this with your SNMPGET
   ((j++))
   if [ $j -eq $MAX ]; then
      echo -n Pausing with $MAX processes...
      j=0
      wait
   fi
done < file
wait
"
14882,how convert column to row and get its row_number in postgresql,"select row_number() over() row_num,col_val from (
select unnest((
 select array[c1,c2,c3,c4] from (
select 55  c1,5 c2 ,8 c3,3 c4 )s 
)) as col_val) b
"
19401,How do I query a parent table for two distinct child rows?,"select distinct o.order_id
from order o
join lineitem item1
  on item1.order_id = o.order_id
join lineitem item2
  on item2.order_id = o.order_id
 and item2.lineitem_id != item1.lineitem_id
where item1.price = 10
  and item2.productcode = 12345
"
8291,Combining Query Result sets in Oracle sql,"Select *
from table
where ((cond 1) and (cond 2)) or
      ((cond 3) and (cond 4));
"
24614,SQL:how to find duplicated combinations in two adjacent columns,"select *
from mytable t
join (
    select field3, field4, count(*) from (
      select field3, field4 from mytable where field3 <= field4
      union all
      select field4, field3 from mytable where field3 > field4) x
    group by field3, field4
    having count(*) > 1) y
  on (t.field3 = y.field3 and t.field4 = y.field4)
    or (t.field3 = y.field4 and t.field4 = y.field3)
"
1722,SQL: Use table from table valued function,"select
    @RUNS = count(*),
    @WON = sum(case when PosNum = 1 then 1 else 0 end)
from tvf_horse_going('Allow Me', 'HEAVY')

set @PERC = (@WON * 100) / @RUNS
"
24690,SQL to COUNT items associated with individuals,"SELECT StudentId,
       Student,
       Count(Module) Module,
       Sum(Credits) Credits
FROM   tablename
WHERE  EndDate BETWEEN '2014-01-01' AND '2014-11-24'
GROUP  BY StudentId,
          Student 
"
5494,Joining 2 mysql table and ordering by number of same rows in 1 table,"SELECT  a.photo_url, COUNT(b.photo_ID) totalVotes
FROM    table1 a
        LEFT JOIN table2 b
            ON a.photo_ID = b.photo_id
GROUP BY a.photo_url
ORDER BY totalVotes DESC
"
29698,Trouble with Select statement,"SELECT
  division, 
  division_name, 
  object_account, 
  account_description, 
  SUM(CASE WHEN vendor_type = 'PV' THEN value ELSE 0 END) as PreferedSpend,
  SUM(value) AS TotalSpend
FROM jde_dw.blanket_rpt 
WHERE division = 02 
AND month = 07 
AND year = 2013 
GROUP BY division, division_name, object_account, account_description 
ORDER BY division
"
18233,Trim whitespace while comparing strings - sql,"SELECT *
FROM ReportData L 
LEFT JOIN ATM A 
  ON LTRIM(RTRIM(L.ATMID))=LTRIM(RTRIM(A.ATM))
WHERE L.IssuerNetwork <> '0000'
"
23986,MySQL - match columns between two tables / outer join,"SELECT b.z
FROM a
INNER JOIN b ON a.x=b.y
"
4867,Split delimited string in SQL Server," SET @chunk = @chunk + '/'
"
9686,Oracle Loop Through Join Statement,"select startid = min(id) from customer;
select maxid = max(id) from customer;

i = startid
while i <= maxid

begin
   with myCTE as (select ... from customer where id >= i and id < i + 1000)
   insert into xxx (....)
   select ....
   from myCustomerChunk
        join productcustomers pc on ....
        join product p on ....

   i = i+1000
end
"
25702,SQL query to update serial number,";WITH CTE as 
(
select srno,passportnumber,flightnumbe,
row_number() over (partition by passportnumber order by (select 0)) as rnk 
from yourtable
)

update CTE set srno=rnk 
"
4061,How to get count in this query?,"SELECT ListID, SUM(IF(Status=""YES"",1,0)) 
FROM yourtable
GROUP BY `ListID`
"
35159,What does 'default' varchar(255) in MySQL mean?,"CREATE TABLE foo (
    [defaultXyz] varchar(255)
)
"
32847,How do I combine these SQL queries to give me one result?,"Select heading
,            sum(number)
from ( [your queries with union all] )
group by heading
"
27331,Insert multiple records,"Insert Into dbo.[Order] (UserId, FirstName, LastName, Credits)
SELECT  u.Id, u.FirstName, u.LastName, u.Credits
FROM    [User] u WHERE u.Id NOT IN (SELECT o.UserId FROM dbo.[Order] o)
"
10968,MySQL Using alias in subquery,"SELECT 
  gs.PAGE, 
  gs.ID, 
  gs.CATALOGID
FROM pages gs 
WHERE gs.ID    = 404 
   OR gs.PAGE = ( SELECT PAGE + 1
                  FROM pages x 
                  where x.id = 404 
                  and gs.CATALOGID = x.CATALOGID); 
"
276,Alter view from columns in the View,"
CREATE OR REPLACE VIEW VW_StockOpname
AS
SELECT ...
"
3271,Query to delete records,"delete from temp1 
where 
    Title IN 
        (SELECT Title FROM temp1 where [flag] = 'No')
"
16473,SQL clause: newbie question,"select * from tbl where culture = 'es'
UNION
select * from tbl where culture = 'eu'
"
32328,How to determine if a variable has a special character using dual table on sql?,"SELECT REGEXP_INSTR('Test!ing','[^[:alnum:]]') FROM dual;
"
7566,How to count non empty cols ? mysql,"select id, ((col1 != '') + (col2 != '') + (col3 != '')) as non_empty_count
from table;
"
24540,Entity Framework: Multiple Inheritance,"Client c;

c.Customer.[...]
c.Supplier.[...]
"
19837,Multiple SQL joins difficult query,"SELECT
    lo.*,
    vo.*,
    vi.*,
    q.*
FROM se_lesson_org lo
LEFT JOIN se_vocab vo
    ON vo.id = lo.section_object_id
    AND lo.section_object_type = 'vocabulary'
LEFT JOIN se_video vi
    ON vi.id = lo.section_object_id
    AND lo.section_object_type = 'video'
LEFT JOIN se_quizzes q
    ON q.id = lo.section_object_id
    AND lo.section_object_type = 'quiz'
"
9113,Retrieve xml-data from text-column,"<cfoutput>#myQuery[""XML_F52E2B61-18A1-11D1-B105-00805F49916B""][1]#</cfoutput>
"
1898,How to write SQL with count and group by common fields from two tables,"SELECT 
  COALESCE(Shape, t2.PickedShape) AS Shape, COUNT(Shape) AS Available,
  ISNULL(Picked, 0) AS Picked, ISNULL(Finished, 0) AS Finished
FROM 
 Store 
FULL JOIN 
  (SELECT PickedShape, COUNT(1) As Picked, SUM(CASE WHEN Finished='Y' THEN 1 ELSE 0 END) AS Finished 
   FROM Record 
   GROUP BY PickedShape) t2 ON Store.Shape = t2.PickedShape
GROUP BY 
  Shape, t2.PickedShape, Picked, Finished
"
143,MySQL get MAX value with COUNT for every row in GROUP BY,"SELECT site_id, MAX(download_date) AS download_date, count(*)
FROM pages_urls
GROUP BY site_id;
"
29551,SQL: Viewing the latest ID based on latest updated timestamp,"select route_de.route_name, route_de.route_id from route_de join
(select max(updatedDate) as maxDate, route_name from route_de group by route_name) maxRoutes
on maxRoutes.maxDate = route_de.updatedDate and maxRoutes.route_name = route_de.route_name
"
30531,SQL retrieving filtered value in subquery,"SELECT Customers.cust_id, Customers.cust_name, COUNT(*) ords
FROM Orders, Customers 
WHERE Orders.cust_id = Customers.cust_id
GROUP BY 1,2
HAVING COUNT(*)<2
"
15647,Get all dates in date range,"Create Procedure spGenerateDateRange(@FromDate Date, @ToDate Date)
As Begin

    ;With Date (Date) As
    (
        Select  @FromDate Union All
        Select  DateAdd(Day, 1, Date)
        From    Date
        Where   Date < @ToDate
    )
    Select  Date
    From    Date
    Option  (MaxRecursion 0)

End
"
18180,SQL query with distinct and sum,"SELECT color, fruit, sum(rating)
FROM medleys
GROUP BY color, fruit
"
10952,How can I remove partial duplicates in my MS SQL Database?,"WITH CTE AS
(
   SELECT EID, TID, StartDate, EndDate,
      RN = ROW_NUMBER() OVER (PARTITION BY  EID, TID ORDER BY StartDate, EndDate)
   FROM Table1 
)
DELETE FROM CTE WHERE RN > 1
"
4948,SQL OR within WHEN (in CASE)," case when x = val1 or y = val2 or z in (val3, val4, val5) then result1 
      else defaultResult end
"
2314,How to select multiple column with one column being max() from multiple tables,"select top 1 some_column1, some_column2 from(
    select distinct some_column1, some_column2 from @table1 where some_column1 = (select max(some_column1) from @table1)
    union all
    select distinct some_column1, some_column2 from @table2 where some_column1 = (select max(some_column1) from @table2) 
    union all
    select distinct some_column1, some_column2 from @table3 where some_column1 = (select max(some_column1) from @table3)
) as max_result
order by some_column1 desc
"
24329,Selecting if all row ids exists in other table with column check,"Select count(*) From sites 
Where site_id NOT IN (Select DISTINCT site_id From callback_votes Where ip='1.0.0.127')
"
37715,Changing single column data with multiple rows to multiple column data with single row,"SELECT [1], [2], [3], [4], [5]
FROM
(SELECT TOP 5 trans_data_np, ROW_NUMBER() over (order by day_in_id) as rowNumber  
    FROM day_in_status_mcg
    ORDER BY day_in_id
    ) AS SourceTable
PIVOT
(
min(trans_data_np)
FOR rowNumber IN ([1], [2], [3], [4], [5])
) AS PivotTable;
"
34280,SQL Count empty fields,"SELECT count(improve) + count(timeframe) + count(impact) + count(criteria) FROM data 
"
10949,Query - Trying to SUM one field based on content of another field,"SELECT DayOfWeek, Sum(Enrollments) AS SumOfEnrollments
FROM YourTable
GROUP BY DayOfWeek;
"
1870,SQL concat select count and varchar,"'Express 24: ' + CAST(
    (
    SELECT  COUNT(Product) 
    FROM    [DHL].[dbo].[F_SubBetsy](@startdate, @enddate, 
                                    'EXPRESS EXPRESS 24', @contract, @account) 
    ) as varchar(16)) +
'\r\nExpress 48: ' + (SEL...
"
1903,SQL Server - Get highest values when previous date not blank,"SELECT TOP 3 p.name,
             player_id,
             steps,
             date
FROM   steppers_step_log
       JOIN steppers_players P
         ON player_id = P.id
WHERE EXISTS
(
   SELECT 1 FROM steppers_step_log ssp
   WHERE ssp.player_id = P.id
   AND date = DATEADD(day, -1, steppers_step_log.date)
)
ORDER  BY steps DESC 
"
24978,Mind numbing SQL madness,"SELECT u.user_id, u.name, i.currency, SUM(i.amount) invoiceAmount 
FROM mydb.users u 
INNER JOIN mydb.invoices i ON u.user_id = i.user_id 
WHERE i.is_paid = 0
GROUP BY u.user_id, i.currency
HAVING SUM(i.amount) >= (CASE i.currency WHEN 'usd' THEN 100 WHEN 'gbp' THEN 155 WHEN 'cad' THEN 117 END)
ORDER BY u.name, i.currency;
"
16954,'NOT GREATER THAN' condition Mysql,"SELECT UserID, MAX(CreatedOn) CreatedOn
  FROM table1
 GROUP BY UserId
HAVING CreatedOn < '2013-09-08'
"
35634,Getting individual counts of last three distinct rows in column of data retrieved from multiple tables,"SELECT TOP 3 ST.EffectiveDate, COUNT(*) as cnt
FROM Person.Contact C INNER JOIN
     Sales.SalesPerson SP
     ON C.ContactID = SP.SalesPersonID FULL OUTER JOIN
     Sales.SalesTerritory ST
     ON ST.TerritoryID = SP.TerritoryID
GROUP BY ST.EffectiveDate
ORDER BY ST.EffectiveDate DESC
"
35419,COUNT FUNCTION where clause,"SELECT COMPANY_NAME, ENROLLMENT_FEE, COUNT(COMPANY_NAME) AS NR_OF_MEMBER
FROM COMPANY
GROUP BY COMPANY_NAME, ENROLLMENT_FEE
ORDER BY NR_OF_MEMBER DESC
LIMIT 1;
"
18720,MySQL query with multiple tables for autocomplete,"SELECT DISTINCT name AS name 
FROM products_names A JOIN products B ON A.id_product = B.id 
WHERE ((name LIKE '%$q%' AND language_code = 'pl') OR (name2 LIKE '%$q%' AND language_code = 'pl')) AND status = 0
"
30599,SUM by Combination in SAS,"select  ProductCode
        ,ClientNO
        ,sum(Fund) as Total
from    FundsData
group by 
        ProductCode
        ,ClientNO
"
29285,Mysql - Sum only distinct row selected,"SELECT MAX(A.id_transaction), A.id_book, 
       COUNT(DISTINCT CASE WHEN A.finalized = 'Y' THEN A.id_transaction END) AS books_read, 
       COUNT(DISTINCT CASE WHEN A.finalized = 'N' THEN A.id_transaction END) AS books_unread, 
       COUNT( DISTINCT A.id_transaction ) as books_read_unread 
FROM ebook_la_rentalbooks_meter_reading AS A
WHERE A.id_customer = 33 
GROUP BY A.id_book 
ORDER BY books_read DESC, books_unread DESC;
"
17850,Table insert unexisting values,"INSERT INTO tblGamePoints (Gamenumber, PlayerId, Game, Points) 
SELECT      3, tblPlayer.Id, 'FPS', 0 
FROM        tblPlayer 
WHERE       Game = 'FPS' AND 
            ValidatedEntry='1' AND 
            NOT EXISTS (SELECT *
                        FROM   tblGamePoints
                        WHERE  PlayerId = tblPlayer.Id AND Game = 3)
"
9681,How to group by a Calculated Field,"select dateadd(day, -7, Convert(DateTime, mwspp.DateDue) + (7 - datepart(weekday, mwspp.DateDue))),
sum(mwspp.QtyRequired)
from manufacturingweekshortagepartpurchasing mwspp
where mwspp.buildScheduleSimID = 10109 and mwspp.partID = 8366
group by dateadd(day, -7, Convert(DateTime, mwspp.DateDue) + (7 - datepart(weekday, mwspp.DateDue)))
order by dateadd(day, -7, Convert(DateTime, mwspp.DateDue) + (7 - datepart(weekday, mwspp.DateDue)))
"
33105,SQL convert multi level xml with attribute into table,"  SELECT 
    Tbl.Col.value('../@ItemID', 'nvarchar(16)') as [ItemID],  
    Tbl.Col.value('@ObjID', 'nvarchar(16)') as [ObjID]   
  FROM 
    @x.nodes('root/items/item/obj') Tbl(Col);
"
12708,Reserving mySQL auto-incremented IDs?,"START TRANSACTION;
INSERT INTO mytable () VALUES ();
ROLLBACK;
SELECT LAST_INSERT_ID() INTO @my_ai_value;
"
37254,Case Statement With Between Clause In Sql Server,"SELECT tbl1.Column1,tbl1.Column2 
FROM table1 tbl1
WHERE 
(@DateTo = '1900-01-01' AND @DateFrom = '1900-01-01')
OR 
(
 NOT (@DateTo = '1900-01-01' AND @DateFrom = '1900-01-01') 
 AND (CAST(tbl1.txnDate  AS DATE) BETWEEN @DateFrom AND @DateTo)
 )
"
25618,"Update Subquery Question, with foreign key","UPDATE Products
SET Products.TemplateID = Templates.TemplateID
FROM Templates
WHERE Templates.TemplateName = Products.TemplateName
"
19941,How to separate positive and negative numbers into their own columns?,"select activity_dt, sum(case when activity_amt < 0 then activity_amt else 0 end) as debits, sum(case when activity_amt > 0 then activity_amt else 0 end) as credits
from the_table
group by activity_dt
order by activity_dt
"
21968,Change the execution plan of query in postgresql manually?,"CREATE OR REPLACE FUNCTION public.test()
 RETURNS integer
 LANGUAGE plpgsql
 IMMUTABLE COST 1000 -- very expensive function
AS $function$
declare i int;
declare j int;
begin
  i := 1;
  while i < 10000 loop
    j := 1;
    while j < 1000 loop
      j := j + 1;
    end loop;
    i := i + 1;
  end loop;
  return i;
end;
$function$
"
37777,Number of decimal digits in Oracle SQL Developer query result sheet,"select to_char(salary,'999999.000'), employee_id from employees;
"
23546,query to count number of different values?,"SELECT url, count(id) as CountOfId
FROM
(
   SELECT distinct id, url
   FROM yourtable
) x
GROUP BY url
"
28060,SQL select all if parameter is null and order by Date else return specific item,"create procedure GetX
(
@IDX int
)
as
begin
    select * from dbo.X 
    where IDX = case when @IDX IS NULL then IDX 
    else @IDX end 
    ORDER BY ModifiedDate desc
end
go
"
5976,Mysql: Count records (including zero) per month,"SELECT
   YEAR(time) AS year
   MONTH(time) AS month,
   COUNT(myTable.year) AS cnt, 
FROM months
LEFT JOIN myTable 
    ON months.year = myTable.year
    AND months.month = myTable.month
GROUP BY months.year, months.month
ORDER BY months.year, months.month
"
3190,sql to read n number of rows and display in fixed number of columns,"select  max(case when rn % 3 = 0 then serialno end) as sn1
,       max(case when rn % 3 = 1 then serialno end) as sn2
,       max(case when rn % 3 = 2 then serialno end) as sn3
from    (
        select  row_number() over (order by serialno) -1 as rn
        ,       serialno
        from    @t
        ) as SubQueryAlias
group by
        rn / 3
"
16537,Collation help needed,"CREATE TABLE #tmp_NoRotadayOff
    (
      DayOfYear datetime
    , Rota varchar(10) COLLATE DATABASE_DEFAULT
    , RotaTemplate varchar(50) COLLATE DATABASE_DEFAULT
    );
"
7863,How to output string after a specific character?,"SELECT LEFT('suarez/john doe', charindex('/', 'suarez/john doe') - 1) + ' ' + SUBSTRING('suarez/john doe', charindex('/', 'suarez/john doe') + 1, 1)
"
38885,Return if more than x day of the week,"select customernumber, date, sum(transactionvalue) as transaction_amt
from transactions   
where date >= '2015-01-01' and date < '2015-07-01'
    and datename(weekday, date) = 'Sunday'
and customernumber in (
  select customernumber
  from transactions  
  where date >= '2015-01-01' and date < '2015-07-01'
      and datename(weekday, date) = 'Sunday'
  group by customernumber
  having count(distinct date) >= 3
)    
group by customernumber, date
"
17960,Show values that occur certain number of times in particular column,"select 
  account_id 
From YourTable 
group by account_id 
having count(*)>=2
"
36927,How to represent EAV in CSV?,"product, name_1, value_1, name_2, value_2
apple, size, small, color, green
apple, size, small, color, red
apple, size, large, color, green
apple, size, large, color, red
car, type, coupe, fuel, diesel
car, type, coupe, fuel, gas
car, type, sedan, fuel, diesel
car, type, sedan, fuel, gas
"
1107,Symfony2 & Doctrine: Order entites by foreign attribute,"$query = $repo->createQueryBuilder('r')
    ->join('r.fevent', 'f')
    ->orderBy('f.date', 'DESC')
    ->getQuery()
;
"
8360,IF/THEN logic in SQL statements,"LEFT JOIN tblproduct_options 
ON tblshopping_cart.product_option = tblproduct_options.option_product_id
"
21565,Removing special character SQL,"SELECT regexp_replace(some_column, '[^0-9]*', '') as clean_value
FROM your_table
"
3881,"SQL subquery multiple values, how can i parse each row with a query for every row instead of having all the table displayed?","UPDATE LNS
SET LNS.GrossPrice = dbo.INVOICELINES.NetPrice/100*(100+(txr.TaxRate)
from dbo.INVOICELINES LNS
JOIN dbo.TaxRates txr ON LNS.TAX=txr.code
"
7970,How to set a default row for a query that returns no rows?,"SELECT val
FROM myTable
UNION ALL
SELECT 'DEFAULT'
FROM dual
WHERE NOT EXISTS (SELECT * FROM myTable)
"
12583,SQL SELECT from three tables,"SELECT mt.*, ut.name, ct.title
FROM
     Map_table mt
INNER JOIN
     User_table ut on mt.from_user_id = ut.id
LEFT JOIN 
     Content_table ct on mt.content_id = ct.id
WHERE 
     mt.to_user_id = 1
"
7086,How to filter max value records in SQL query,"select * from tab where avg<(select max(avg) from tab);
"
28249,"sqlbulkcopy, i want to overwrite current rows in the database","INSERT INTO MyTable
(Column1, Column2, [etc...])
SELECT Column1, Column2, [etc...] 
FROM Test_Staging
WHERE [Some condition]
"
34425,Columns to Rows in SQL Server,"select location, month, value
from <yourquery here>
unpivot
(
  value
  for month in (January, February, March, April, May, June, July, August,
                September, October, November, December)
) unpiv
"
6044,T-SQL Update data query,"UPDATE a
    SET DataYear0 = COALESCE(d0.DataYear,DataYear0),
        DataYear1 = COALESCE(d1.DataYear,DataYear1),
        DataYear2 = COALESCE(d2.DataYear,DataYear2)
FROM A a
LEFT JOIN B d0 ON d0.Id = a.Id and d0.[Year] = YEAR(GETDATE())-1
LEFT JOIN B d1 ON d1.Id = a.Id and d1.[Year] = YEAR(GETDATE())-2
LEFT JOIN B d2 ON d2.Id = a.Id and d2.[Year] = YEAR(GETDATE())-3
"
2363,Upload image to SQL Server 2008," CREATE TABLE dbo.YourTable
     (....... define the fields here ......)
     ON Data                   -- the basic ""Data"" filegroup for the regular data
     TEXTIMAGE_ON LARGE_DATA   -- the filegroup for large chunks of data
"
27091,How to query for strings based on their length,"SELECT
  *
FROM
  dict
WHERE
  LENGTH(word) = 4 /* 1. */
  OR (LENGTH(word) > 4) /* 2. */
  OR (LENGTH(word) >=4 AND LENGTH(word) <= 8) /* 3. */
  OR (LENGTH(word) <4) /* 4. */

/* Choose the right WHERE clause, based on your case */
"
4954,Reset SQL variable inside SELECT statement,"SET @prevID:=@runSum:=0;

UPDATE teamrank t -- one row per team?
  JOIN members  m USING ( teamID ) -- multiple rows per team?
   SET rank =
IF( @prevID != m.teamID, /* Capture when a teamIDs changes */
    ( @runSum := m.rank ) + ((@prevID := m.teamID)*0), /* reset both @runSum and @prevTeam */
    ( @runSum := @runSum + m.rank) /* increment running sum */
  )
-- It is important to have proper sequencing, so to reset @runSum when a teamID changes.
ORDER BY t.teamID 
;
"
19974,Trim string based on characters,"reverse(right(reverse(@string), len(@string) - charindex('-',reverse(@string),1)));
"
7290,How to use DISTINCT in WHERE CLAUSE to avoid repeated row returns,"SELECT 
baseFeeds.siteURL, feedFinishes.timeTaken, feedFinishes.timeSubmitted
FROM feedFinishes 
JOIN baseFeeds 
ON feedFinishes.GUID = baseFeeds.GUID 
WHERE baseFeeds.siteURL LIKE '%www.example.com%' 
GROUP BY
baseFeeds.siteURL, feedFinishes.timeTaken, feedFinishes.timeSubmitted
"
36379,sql with substring to a special character with sqlite,"SUBSTR(col,1,INSTR(col,'#') -1)
"
3716,Can I select the data of a given row and column while executing a sql statement,"SELECT *
FROM dbo.EVNT_HSTRY hstry
WHERE evnt_hstry_cd LIKE '3' and
not exists (select 1 from EVNT_HSTRY WHERE hstry.evnt_id = evnt_id
AND Hstry.adt_trl_dt_tm > adt_trl_dt_tm)
"
19175,select date+time+timezone with oracle db,"to_char(sysdate, 'YYYY-mm-DD""T""HH24:MI:SS.""0Z""')
"
39435,SQL Return values in Delphi via ADO,"function UserCheckExist(Login, pw: string): boolean;
begin
    with DM do
    begin
        AQ_LOGIN.Close;
        AQ_LOGIN.SQL.Clear;
        AQ_LOGIN.SQL.Add('select BLOGIN from BENU where BLOGIN = ''Login'' AND BPW = ''pw''');
        AQ_LOGIN.Open;
        Result := (AQ_LOGIN.RecordCount > 0);
        AQ_LOGIN.Close;
    end;
end;
"
17462,Select rolling date range from year/month instead of date field,"Select Item, [Year], [Month],[Demand QTY] 
FROM [table1] 
Where ( [Year] = Year(getdate())-'1' and [Month] >= Month(getdate()) ) or 
      ( [Year] = year(getdate()) and [Month] <= month(getdate()) )
"
11831,"select top 1000, but know how many rows are there?","SELECT TOP 1000 x,y,z, COUNT(*) OVER () AS TotalCount
FROM dbo.table
"
37668,How to split a column in two and display in two separate columns base on the conditions?,"select left(COL1, charindex(':-', COL1)),
       right(COL1, len(COL1) - charindex(':-', COL1) - 1)
"
27521,need help prioritizing output with a SQL query,"ORDER BY 
 CASE 
  WHEN user_meta.grad_year = 2012 THEN 1 
  WHEN user_meta.grad_year = 2011 THEN 2 
  WHEN user_meta.grad_year = 2013 THEN 3 
  ELSE NULL 
 end
"
6803,Mysql complex issue on a single table,"select c.Cid
     , .name
     , group_concat(ci.ImgId separator ',')
from customer c
join CustomerImage ci on c.Cid = ci.Cid 
group by  c.Cid
        , c.name
"
10812,MySQL Check for 3 or more consecutive (specific) entries,"SELECT COUNT(*) FROM `table` 
WHERE 
    id > 
        (IFNULL(
            (SELECT id 
            FROM `table` 
            WHERE `type`='LOGIN_SUCCESS' 
            ORDER BY id DESC 
            LIMIT 1),0
        )
    AND `type`='LOGIN_FAIL'
"
18107,Laravel Eloquent to join table and count related,"$this->model->leftJoin('Rooms', 'Properties.ID', '=', 'Rooms.Property')
  ->selectRaw('Properties.*, count(Rooms.RoomID) as RoomsCount')
  ->groupBy('Properties.ID')
  ->get();
"
29239,Dynamic Pivot result into fixed table (SSIS or SQL),"INSERT INTO MyResults (Property_A, Property_C)
EXEC dbo.usp_MakeData_1

INSERT INTO MyResults (Property_A, Property_B)
EXEC dbo.usp_MakeData_2
"
27470,Abort a PL/SQL program,"MWATSON@> set serveroutput on
MWATSON@> !cat test.sql

BEGIN
 IF 1 = 1 THEN
    DBMS_OUTPUT.PUT_LINE('ABOUT TO EXIT');
    RETURN;
  END IF;
  DBMS_OUTPUT.PUT_LINE('DID NOT EXIT');
END;

MWATSON@> @test
  8  /
ABOUT TO EXIT

PL/SQL procedure successfully completed.

MWATSON@>
"
32266,compare two select statements in oracle SQL,"SELECT (whatever operations you gonna do) FROM dual WHERE (select sum(quantity) from Table 1 where order_number = XXXX) = (select sum(quantity) from Table 2 where order_number = XXXX);
"
30470,"How do I bring back an entire range of dates in SQL between two dates, even when there is no data?","WITH DateRange(date) AS
(
  SELECT @dateFrom date
  UNION ALL
  SELECT DATEADD(dd, 1, date) date FROM DateRange WHERE date < @dateTo
)

SELECT DateRange.date, count(incident.id) 
FROM DateRange
LEFT OUTER JOIN incident
  ON incident.date >= DateRange.date 
  AND incident.date < DATEADD(dd, 1, DateRange.date)
GROUP BY DateRange.date
ORDER BY DateRange.date
"
36642,SQL Query help in MS Access?,"SELECT Student.*
FROM Student, Placement, InterShip
WHERE Placement.i_code=Internship.code   
AND Placement.s_code=Student.id
AND Student.f_id <> Internship.f_id  
"
24901,SQL Joining on Different cell values,"SELECT Name,A.Code,B.Code,B.Val 
FROM table1 A
JOIN table2 B ON A.Code =LEFT(B.Code,PATINDEX('%[0-9]%',B.Code)-1)
"
17676,SQL Query to select data from two tables with single column known,"SELECT
    *
FROM
    alumnidetails ad
INNER JOIN alumwork aw
    ON ad.username = aw.username
WHERE
    ad.firstname = Pete;
"
29152,MySQL - Exclude row if no row exists from LEFT OUTER JOIN,"SELECT ...
    FROM_UNIXTIME(cm.added, '%D %M %Y') AS dateadded"").""
    FROM mdl_course_modules cm 
    LEFT OUTER JOIN mdl_modules m on cm.module = m.id
    LEFT OUTER JOIN mdl_resource r on cm.instance = r.id
    WHERE m.name = 'resource' AND cm.visible = 1
        && (!ISNULL(m.name) || !ISNULL(r.name))
"
2367,sql server - join 2 tables based on earliest date in 2nd table,"SELECT C.ID
      ,C.Customer
      ,C.Product
      ,C.ReportedDate
      ,DATEDIFF(HOUR, C.ReportedDate, A.DateCreated) AS [TimePassed]
      ,A.CreatedBy
FROM [Case] C INNER JOIN 
            (SELECT *,
                  ROW_NUMBER() OVER (PARTITION BY CaseId ORDER BY DateCreated ASC) AS rn
            FROM [Activity]) A 
ON C.ID = A.CaseId
WHERE A.rn = 1
"
39049,Best Practice to querying a Lookup table,"select * from Property
where 
exists (select * from Property_Feature where pid = property.pid and fid = 'key_air_conditioning')
and
exists (select * from Property_Feature where pid = property.pid and fid = 'key_pool')
"
33386,How to get the common row of ManyToMany relationship tables,"SELECT F.Name
FROM   person_fruit PF INNER JOIN fruit F ON PF.Fruit_ID = F.ID
WHERE  PF.Person_ID IN (1,2,4)    '<- List of person IDs'
GROUP  BY PF.Fruit_ID
HAVING COUNT(Person_ID) = 3       '<- Total number of person IDs'
"
15403,collating stats into time chunks,"SELECT
    DATE_FORMAT( time, ""%H:%i"" ),
    SUM( bytesIn ),
    SUM( butesOut )
FROM
    stats
WHERE
    time BETWEEN <start> AND <end>
GROUP BY
    DATE_FORMAT( time, ""%H:%i"" )
"
18518,"Increment counter or insert row in one statement, in SQLite","INSERT OR REPLACE INTO observations
VALUES (:src, :dest, :verb,
  COALESCE(
    (SELECT occurrences FROM observations
       WHERE src=:src AND dest=:dest AND verb=:verb),
    0) + 1);
"
11486,#1075 MySQL Error,"CREATE TABLE `testing` (
  `id` INT NOT NULL AUTO_INCREMENT, 
  `date` DATE NOT NULL, 
  `text_1` TEXT CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL, 
  `text_2` TEXT CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE = MYISAM ;
"
2467,Enhance SQL script to better handle more than one result from subquery,"UPDATE 
  Remark
SET 
  CurrentTransactionId = NULL
WHERE 
  RemarkConsumerId = @ConsumerVar
  AND 
  CurrentTransactionId IS NOT NULL
"
35866,SQL analogue of SelectMany,"select  c.Code
,       d.Divisor
from    Codes as c
outer apply
        dbo.YourTableUdf(c.Code) as d
"
38383,ANSI NULLS and the ON clause,"select housenumber, street, town, country postcode, count(*) as cnt,
       min(a.id) as masterid, max(a.id) as childid 
from #address a
group by housenumber, street, town, country postcode
having count(*) >= 2;
"
24109,Paper Trail for .Net,"ayende
"
3669,How to get unique values from a column access sql,"SELECT BNO, MAX(EID) EID, MAX(E_Description) E_Description, MAX(CSCII) CSCII
FROM MyTable
GROUP BY BNO
"
5711,how to change the beginning position of the field in sql loader,"...
(
skip_1     FILLER,
skip_2     FILLER,
skip_3     FILLER,
skip_4     FILLER,
skip_5     FILLER,
nickname1,
nickname2,
class      CONSTANT '10',
Address    CONSTANT 'NA'
)
"
14030,MySQL query to find unique records,"select distinct id
from table t
where status = 'ACTIVE'
and not exists (select null
                  from table
                  where t.id = id and t.media = media
                  and status = 'PENDING')
"
32926,How to obtain and count '@gmail.com' from a column of email accounts in SQL,"select sum(instr(some_column, '@gmail.com') > 0) as gmail_count
from your_table
"
30298,Select DISTINCT returning too many records,"SELECT DISTINCT ON (items.condition) items.id, items.condition, items.price, products.name
FROM products
INNER JOIN items ON products.id = items.product_id
WHERE products.id = 1
ORDER BY items.condition, items.price, products.name;
"
37501,MySQL Union - Select data from first table in union first,"SELECT service.*, 1 as OBCol
FROM star_service
INNER JOIN service ON service.code = star_service.service

UNION

SELECT service.*, 2 as OBCol
FROM service

ORDER BY OBCol
"
27016,Find missing MySQL Data,"-- Fetch all 'IN' records without a corresponding 'OUT'
    SELECT tp_in.*
     FROM timePunches tp_in
LEFT JOIN timePunches tp_out
          ON tp_in.employeeID = tp_out.employeeID
             AND
             tp_in.punchDATETIME = tp_out.punchDTC_LINK
    WHERE tp_in.punchDIRECTION = 'IN'
          AND
          tp_out.punchDTC_LINK IS NULL;
"
32655,Only get users with a specific joined table count,"SELECT 
    user.id,
    user.name,
    item.id as item_id,
    itemstatus.item_status,
    COUNT(item.status) as status
FROM user
JOIN item ON (user.id = item.user_id)
JOIN itemstatus ON (item.status = itemstatus.id)
WHERE item.status = 1
GROUP BY user.id
HAVING COUNT(item.status) >= 3
"
23891,Change the primary key of a table in SQLite,"CREATE TABLE my_table_copy( 
    id INTEGER, 
    lang INTEGER,
    data TEXT,
    PRIMARY KEY (id, lang)
);
INSERT INTO my_table_copy (id, lang, data)
   SELECT id, lang, data FROM my_table;
DROP TABLE my_table;
ALTER TABLE my_table_copy RENAME TO my_table;
"
3792,Alter column length in Schema builder?,"/**
 * Make changes to the database.
 *
 * @return void
 */
public function up()
{
  DB::query('alter table MYTABLE modify MYCOLUMN varchar(new-length)');
}

/**
 * Revert the changes to the database.
 *
 * @return void
 */
public function down()
{
  DB::query('alter table MYTABLE modify MYCOLUMN varchar(old-length)');
}
"
29696,How to use the Input Dialog to execute SQL queries,"prompt = {'Enter table name:','Enter query field:'};
dlg_title = 'Input for query';
num_lines = 1;
def = {'mytable','thatProperty'};
answer = inputdlg(prompt,dlg_title,num_lines,def);
curs = fetch(exec(conn, ['SELECT * FROM ' char(answer{1}) ' WHERE ' char(answer{1}) '= ' '''' pdbSearchQuery '''']));
"
14645,Duplicate Results with LISTAGG Function,"....as PLAN_AMT,
RTRIM(
         REGEXP_REPLACE(
           (listagg(DX.DIAG_CD,',') WITHIN GROUP (ORDER BY DX.LVL_CD) ), 
           '([^,]*)(,\1)+($|,)', 
           '\1\3'),
         ',') AS DX_CODES
FROM......
"
17115,Play a audio/sound in plsql,"SQL> set serveroutput on
SQL> exec dbms_output.put_line(rpad(chr(7),1000,chr(7)));
"
7557,Having issue with MySQL INNER JOIN query having sub-query in it,"SELECT *
FROM `category`   AS c
INNER JOIN images AS i ON i.category = c.id
INNER JOIN
(
    SELECT  category, MAX(ID) AS MAXId
    FROM `images` 
    GROUP BY `category`
)AS a  ON i.category = a.category
      AND i.ID       = a.MaxID
WHERE c.`parent` = '1';
"
19698,Select value on next date to be calculated on current date SQL,";with CTE as
( select row_number() over ( partition by GroupID, oDate order by oTime Asc) as rownum, 
         GroupID, oDate, oValue,oTime
  from Test
)
select CTE.GroupID,CTE1.oDate, (CTE.oValue - CTE1.oValue) as oResult
from CTE
inner join CTE as CTE1 on datediff (day,CTE1.oDate, CTE.oDate) = 1  
and CTE1.rownum= CTE.rownum 
and  CTE1.GroupID= CTE.GroupID
where CTE.rownum = 1
"
5539,SQL Numeric to Date (with an exception),"SELECT WMACCT# AS 'Account #',
  CASE 
    WHEN OPENDT = 0 THEN '2013-10-31'
        ELSE CONVERT(DATE, CONVERT(VARCHAR(8), OPENDT), 104)
    END AS 'Open Date',
  CASE 
    WHEN DATE = 0 THEN NULL
        ELSE CONVERT(DATE, CONVERT(VARCHAR(8), CLDT), 104)
    END AS 'Close Date'
FROM SERVER.SERVER
"
1929,Let me know if i can optimize this query?,"SELECT COUNT(client_id) FROM (
  SELECT client_id FROM `cdr` WHERE 
    (start BETWEEN '2014-04-21 00:00:00' AND '2014-04-25 23:59:59') AND 
    `service` = 'test' 
    GROUP BY client_id  
    HAVING SUM(duration) > 300 
)as t1
"
16391,count how many rows from parent table exist in other 2 tables,"     SELECT COUNT(distinct l.protocol) as parent
           ,COUNT(distinct e.protocol) as tbl2
           ,COUNT(distinct n.protocol) as tbl3
    FROM parent L
    LEFT JOIN tbl2 E on L.protocol=E.protocol
    LEFT JOIN tbl3 N on L.protocol=N.protocol
    UNION ALL 
    --same for the LOP count  
"
586,Android Null Checker,"filled = (change != null);
"
14503,SQL concat rows with same name value,"SELECT Name
     , GROUP_CONCAT(Stage) AS Stages
     , GROUP_CONCAT(Date) AS Dates
  FROM my_table
GROUP BY Name;
"
38930,Intersecting a result set with a table,"select pg.group_id
from people_group pg join
     people p
     on pg.person_id = p.id and p.age >= 18
group by pg.group_id
having count(distinct pg.person_id) = (select count(*) from people where age >= 18);
"
18722,How to insert Byte[] into the Informix database through the SQL Editor interface,"INSERT INTO Temp (id, name) VALUES (1, VARBINARY('rg_book'));
"
38119,SQL Alternative,"SELECT ""CLASS"",""SCHOOL"",""Year"",""MONTH"",
  AVG(NULLIF(""JanIncome"",0)) AS ""JanAvg"",
  AVG(NULLIF(""FebIncome"",0)) as ""FebAvg""
"
14408,How can I get the latest dataset fore each foreign key ID with one SQL query?,"select t1.* from wm_renderings t1
left join wm_renderings t2 on t1.formula_id = t2.formula_id
and t1.creation_time < t2.creation_time
where t2.id is null
"
29782,Detect unset $VARIABLE in query for trac report,"SELECT status, 
id AS ticket, summary, priority, keywords,  
datetime(changetime/1000000, 'unixepoch') AS last_updated, 
milestone AS __group__,
reporter, owner
FROM ticket t
WHERE status NOT IN ('closed', 'resolved') 
AND (CASE WHEN '$MILESTONE' != '' THEN (milestone='$MILESTONE') 
     ELSE (milestone in ('project1', 'project2', 'project3')) END)
ORDER by t.milestone ASC, p.value
"
14991,"WHERE col1,col2 IN (...) [SQL subquery using composite primary key]","sqlite> create table foo (a,b,c);
sqlite> create table bar (x,y);
sqlite> select * from foo where exists (select 1 from bar where foo.a = bar.x and foo.b = bar.y);
"
25146,vb.net handling many table name using string,"ugad = ""INSERT INTO "" & dept & ""(Ugname,Ugdob,Uggender)"" 
"
7032,Retrieving a row number of a specific row from a group of rows in a table in Oracle 10g,"select row_num 
  from  (select row_number() over (partition by user_id 
                                   order by user_role_id desc) as row_num, 
                user_role_id, user_id
           from user_roles)
where user_role_id=28 and user_id = 2;
"
16175,"Displaying whether a foreign key is set when doing a left join, but still showing distinct records at the same time","CASE WHEN MAX(p.Id) IS NULL THEN 'No' ELSE 'Yes' END as InUse
"
19746,SQL select with hierarchy for default values,"SELECT COALESCE( usr.value, def.value ) AS value
FROM your_table def
LEFT JOIN your_table usr ON ( usr.i = def.i AND usr.u = your_user )
WHERE def.u = 0
"
2772,calculate percentage with subqueries,"SELECT
    day,
    return_rate_mr * 100 / return_count as perc_value,
    ... any other columns ...
FROM
    ( ... your original query here ...) as myalias;
"
27270,Android-SQLite. One to many relation,"CREATE TABLE locations(
  loc_id INTTEGER PRIMARY KEY, 
  longitude REAL,
  latitude REAL
);

CREATE TABLE photos(
  photo_id INTEGER PRIMARY KEY, 
  path TEXT, 
  fk_location INTEGER,
  FOREIGN KEY(fk_location) REFERENCES locations(loc_id)
);
"
30276,insert many rows with one static field and fields selected from another table,"create table #tmp
( id1 int)

insert into #tmp (id1)
(
    select top 10 id1 from Table1
)

insert into Table2 (id1, id2) 
(
    select id1, 5 from #tmp
)

drop table #tmp
"
3981,REGEXP_SUBSTR : extracting portion of string between [ ] including [],"select
 regexp_replace('select userid,username from tablename where user_id=[REQ.UID] and username=[REQD.VP.UNAME]'
,'.*(\[.*?\]).*(\[.*?\]).*','\1\2')
from dual
;
"
20893,Sum a subquery and group by customer info,"SELECT  AddressState, DATEPART(mm, OpenedDate), SUM(Amount)
FROM    Customer c
INNER JOIN Account a  ON a.CustomerID = c.CustomerID
INNER JOIN Payments p ON p.AccountID = a.AccountID
GROUP BY   AddressState, DATEPART(mm, OpenedDate)
"
28175,Oracle Sequence start with doubt,"CREATE SEQUENCE EMP.SEQ_ID
START WITH 41
NOMAXVALUE
CACHE 50;
"
13848,compare values in a column and find if there is an increment,"SELECT  MonthId,
    CASE WHEN Sales < (SELECT Sales FROM TestTable WHERE MonthId = TT.MonthId - 1) THEN 'Decremented' ELSE 'Incremented' END
FROM TestTable TT
"
14617,Select all parents or children in same table relation SQL Server," --all  ""parent + grandparent + etc"" @childID Replaced with the ID you need

with tbParent as
(
   select * from Elem where [KEY]=@childID
   union all
   select Elem.* from Elem  join tbParent  on Elem.[KEY]=tbParent.PARENT_KEY
)
 SELECT * FROM  tbParent
 --all ""sons + grandsons + etc"" @parentID Replaced with the ID you need

with tbsons as
(
  select * from Elem where [KEY]=@parentID
  union all
  select Elem.* from Elem  join tbsons  on Elem.PARENT_KEY=tbsons.[KEY]
)
SELECT * FROM tbsons
"
2420,From oracle to mySQL,"  SELECT CONCAT('DROP TABLE `',t.table_schema,'`.`',t.table_name,'`;') AS stmt
       FROM information_schema.tables t WHERE
         t.table_name LIKE 'USER_%%' ESCAPE '\\'
         ORDER BY t.table_name
"
16590,SQL trigger to merge totals to parent table (with cancelled column),"WITH Deltas as (
    SELECT AccountID, Sum(case when IsCancelled = 0 then InvoiceTotal else 0 end) as InvoiceTotal From inserted Group By AccountID
    UNION ALL
    SELECT AccountID, Sum(case when IsCancelled = 0 then InvoiceTotal * -1 else 0 end) as InvoiceTotal From deleted Group By AccountID
),
Merged as
    (Select AccountID, Sum(InvoiceTotal) InvoiceTotal From Deltas Group by AccountID)
Update Account set InvoiceTotal = Account.InvoiceTotal + Merged.InvoiceTotal From Merged Where Account.AccountID = Merged.AccountID;
"
15041,SQL formatting standards,"select
    ST.ColumnName1,
    JT.ColumnName2,
    SJT.ColumnName3
from 
    SourceTable ST
inner join JoinTable JT on 
    JT.SourceTableID = ST.SourceTableID
inner join SecondJoinTable SJT on 
    ST.SourceTableID = SJT.SourceTableID
where
        ST.SourceTableID = X
    and JT.ColumnName3 = Y
    and JT.Column3 = SJT.Column4
"
37819,get top 3 random values from sql query,"select * from (
   SELECT itemcode,itemname from hmis.shopitemcode order by dbms_random.value
)
where rownum <= 5;
"
9565,Hebrew encoding in sql server2005,"declare @userName nvarchar(50)
set @userName=N'2'    
print @userName
"
26534,SQL select percentage,"   Select ( (SELECT COUNT(social_users.id) FROM social_users LEFT JOIN socials ON
    social_users.id = socials.social_user_id WHERE socials.social_user_id
    IS NULL) / (select count(social_users.id) FROM social_users))*100 as Percentage
"
22065,SQL query for data extraction from two tables,"SELECT
    t.team_Name,
    p1.name + ' ' + p1.surname AS '1st_player_name',
    p2.name + ' ' + p2.surname AS '2nd_player_name'
FROM
    team t
INNER JOIN 
    player p1 ON t.player1_id = p1.id
INNER JOIN 
    player p2 ON t.player2_id = p2.id
"
29017,Why i can't use my column in WHERE while i can in GROUP BY?,"A select_expr can be given an alias using AS alias_name. The alias is used as the expression's column name and can be used in GROUP BY, ORDER BY, or HAVING clauses. For example:
"
37789,News articles database - should I use index on date_publish field for faster SELECTS,"SELECT * FROM articles WHERE date_publish < $time
"
7218,Bulk Update Email Trigger,"WHERE inserted.ColumnName <> deleted.ColumnName
"
373,how do i use this select,"Update MSLStore1_Products set ExternalCoode = right(MSLStore1_Products.productcode, len(MSLStore1_Products.productcode) - LEN(supplier.prefix) )
From 
MSLStore1_Products , supplier WHERE MSLStore1_Products.suppid = 9217 AND MSLStore1_Products.SgpID = 123 and supplier.supno = MSLStore1_Products.suppid 
"
7427,Row_number() function for Informix,"SELECT SKIP 100 FIRST 100 t.*
  FROM Table AS T
 WHERE ...other criteria...
"
34110,Output of CSUM() in teradata,"SELECT ROW_NUMBER() OVER (ORDER BY column(s)_with_a_low_number_of_rows_per_value)
   + COALESCE((SELECT MAX(seqnum) FROM table),0)
   ,....
FROM table
"
26402,Howto delete FK and all dependent table entries?,"delete from c
    from city c
        inner join region r
            on c.region_id = r.region_id
        inner join state s
            on r.state_id = s.state_id
    where s.state = 'France'

delete from r
    from region r
        inner join state s
            on r.state_id = s.state_id
    where s.state = 'France'

delete from s
    from state s
    where s.state = 'France'
"
13987,Complex Joins and Select Query,"select Fname,Lname,Pname, Employee.DepartNum E_DNUM,Project.DepNum P_DNUM
from Employee
join WorksOn on WorksOn.EmpSSN = Employee.SSN
join Project on WorksOn.ProjNum = Project.Pnumber
join Department on Project.DepNum = Department.Dnumber
where Employee.DepartNum <> Project.DepNum
"
13124,How to avoid a duplicate row situation in mysql query below?,"SELECT r.id, r.phone, st.title, rhs.comment, rhs.date
FROM (
    SELECT r.id, max(rhs.date) AS date
    FROM Requests_has_Statuses AS rhs
    INNER JOIN Requests r ON r.id = rhs.requestId
    GROUP BY r.id) AS temp
INNER JOIN Requests AS r ON temp.id = r.id
INNER JOIN Requests_has_Statuses AS rhs ON rhs.requestId = temp.id and rhs.date = temp.date
INNER JOIN Statuses AS st ON rhs.statusId = st.id
"
29073,How to increment value of a Column based on previous Row's value in SQL,"update  im
set     im.item_order = im.rn
from    (
        select  row_number() over (partition by user_id
                                   order by item_id) - 1 as rn
        ,       *
        from    item_master
        ) as im;
"
28081,How to check for one value in multiple rows,"select groupID,case when cnt = 1 then 1 else 0 end as IND_ONE_CAPTAIN from (
select groupID, sum(case when positionid = '10' then 1 else 0 end) as cnt
from players
group by groupID)
"
8973,How to join single table multiple time on single column in sql server,"    Select pe.*, c1.CitizenName as PatientName, c2.CitizenName as DoctorName 
    from tbPatientEpisode pe
    join tbPatient p on pe.PatientIDF = p.PatientIDP
    join tbDoctor d on pe.DoctorIDF = d.DoctorIDP
    join tbCitizen c1 on p.CitizenIDF = c1.CitizenIDP
    join tbCitizen c2 on d.CitizenIDF = c2.CitizenIDP
"
10966,Can you query two tables in one statement in Android?,"Cursor c = mApp.getContentResolver().query(ContactsContract.Data.CONTENT_URI,
    null,
    null,
    null,
    ContactsContract.Data.CONTACT_ID + "" ASC"");
"
37445,MYSQL query for selecting the result of a condition of one table and showing it on another table,"Insert into Table2(stock_name,temple,quantity)
SELECT a.stock_name, a.temple, SUM(Case when Type='purchase' then quantity else (quantity*-1) End) AS quantity
FROM Table1 a
GROUP BY a.stock_name, a.temple
"
3821,UDF that accepts one parameter and returns a table,"CREATE FUNCTION fx_TaxStCtry(@StateProvince nvarchar(50)) 
RETURNS @TaxStCtry TABLE 
(TaxRate SmallMoney not null,
StateProvinceCode Nchar(3) not null ,
CountryRegionCode Nvarchar(3) not null) 
AS 
BEGIN INSERT @TaxStCtry 
SELECT  tr.TaxRat,sp.StateProvinceCode,sp.CountryRegionCode
FROM Person.StateProvince sp 
JOIN   Sales.SalesTaxRate tr 
ON tr.stateprovinceid = sp.stateprovinceid
WHERE   sp.Name=@StateProvince 
RETURN 
END
"
26448,Order by in SQL,"select * from table1 orderby column1 asc , column2 desc
"
34036,How do I declare a multi-column PK in MySQL,"CREATE TABLE table_name 
(
    c1 INT NOT NULL,
    c2 INT NOT NULL,
    PRIMARY KEY (c1, c2)
)
"
9542,How to get TotalSold/Year in Northwind?,"USE Northwind
GO

SELECT C.CompanyName, YEAR(O.OrderDate) AS [Year],
   SUM(OD.UnitPrice * OD.Quantity) AS TotalSold
FROM Customers AS C
INNER JOIN Orders AS O
   ON C.CustomerID = O.CustomerID
INNER JOIN [Order Details] AS OD
   ON O.OrderID = OD.OrderID
GROUP BY YEAR(O.OrderDate), C.CompanyName
GO
"
6731,combining multiple columns in two tables,"SELECT t1.id, t21.name, t22.name, t23.name
FROM T1 
    INNER JOIN T2 t21 ON t21.id = T1.referencePerson1ID
    INNER JOIN T2 t22 ON t22.id = T1.referencePerson2ID
    INNER JOIN T2 t23 ON t23.id = T1.referencePerson3ID
WHERE T1.id = 1
"
4980,Query to Find max of three columns in a row,"SELECT GREATEST(
    COALESCE(date1, date2, date3)
,   COALESCE(date2, date1, date3)
,   COALESCE(date3, date1, date2)
)
FROM my_test_table
"
37140,Extract Columns names from XML file,"declare @xml xml = '
<Item>
  <Product>Food</Product>
  <Date>09/03/11</Date>
  <Shipped>10/01/11</Shipped> 
</Item>'

select T.X.value('local-name(.)', 'nvarchar(128)')
from @xml.nodes('/Item/*') as T(X)
"
14168,Improving performance of join on subselect,"SELECT c.id as comment_id, SUM (v.vote) as votes, c.text
FROM comments c
LEFT JOIN votes v ON c.id = v.comment_id
WHERE c.post_id = 12
GROUP BY c.id, c.text
"
33660,Recursive function improperly breaking up badly maintained CSV string field,"SELECT [goat]
,left(emailITEM, CHARINDEX(',',emailItem+',')-1)
,STUFF(emailITEM, 1, CHARINDEX(',',emailItem+','), '')
,[id]
FROM independent
where 
emailITEM > ''
"
7839,Mysql Query [0001],"SELECT owners.city, count(DISTINCT owners.id) AS 'Owners' 
FROM owners INNER JOIN dogs ON (owners.id = dogs.owner_id) 
GROUP BY owners.city
"
11123,SQL: Is it possible to merge these two SQL statements into a single query?,"SELECT COUNT(DISTINCT CustomerID) as Total,
       COUNT(DISTINCT CASE WHEN OrderDate >= '2016-01-01' THEN CustomerID END) as Total_2016
FROM Orders;
"
32355,faster way to do this select query,"SELECT FirstName, LastName, ID FROM EMPLOYEE WHERE FirstName = 'Test%'
OR (FirstName <> 'Test%' AND LastName = 'Test%')
"
39771,In a SELECT statement(MS SQL) how do you trim a string,"SELECT LTRIM(RTRIM(Names)) AS Names FROM Customer
"
11838,Oracle: insert-only materialized view,"Capable of:
  REFRESH_FAST
  REFRESH_FAST_AFTER_INSERT
Not Capable of:
  REFRESH_FAST_AFTER_ONETAB_DML
    AMT_SUM
    SUM(expr) without COUNT(expr)
  REFRESH_FAST_AFTER_ONETAB_DML
    COUNT(*) is not present in the select list
  REFRESH_FAST_AFTER_ANY_DML
    see the reason why REFRESH_FAST_AFTER_ONETAB_DML is disabled
"
3220,MySQL: SELECT inside SELECT IF() statement,"SELECT  1
FROM    dual
WHERE   NOT EXISTS
        (
        SELECT  NULL
        FROM    mytable
        WHERE   id = 1
        )
"
3852,Split Up Text In A Column,"DECLARE @Sql varchar(50) = 'TEST|00000298398293|EQ5|Patient'


SELECT
    PARSENAME(REPLACE(@sql,'|','.'),4),
    PARSENAME(REPLACE(@sql,'|','.'),3),
    PARSENAME(REPLACE(@sql,'|','.'),2),
    PARSENAME(REPLACE(@sql,'|','.'),1)
"
17181,How to update column text value with concatenation of multiple columns text values?,"Update table_x 
set 
merged_content=
concat('<p>',first_name,' ',last_name,'</p><p><b>Address -</b> ',address,'</p>'); 
"
7977,Selecting particular data from SQL SERVER VIEW?,"select *
from (
    select *, row_number() over (partition by id order by addedon desc) rn
    from yourview
) t
where rn = 1
"
16012,Month Number In Prompted Query,"AND ((Year([EventLog]![Date])) Between CInt([Enter Start Year:] )
                               And CInt([Enter End Year:]) )
AND ((Month([EventLog]![Date])) Between CInt([Enter Start Month:] )
                                And CInt([Enter End Month:])))
"
28369,How to delete all rows in all table of a database in mysql,"mysqldump -d dbname > structure.sql
mysqladmin drop dbname
mysqladmin create dbname
mysql dbname < structure.sql
"
13752,Using between operator with numeric text values in Microsoft Access SQL,"SELECT * FROM TABLE WHERE COLUMN BETWEEN '1' AND '9' and LEN(COLUMN) = 1;
"
35404,simple(?) PIVOT without an aggregate,"select [1] as field1,
  [2] as field2
from
(
  select col1, row_number() Over(order by col1) rn
  from yourtable
) src
pivot
(
  max(col1)
  for rn in ([1], [2])
) piv
"
9481,bind's queries per second by an SQL query,"group by to_char(log_time, 'HH24:MI:SS'), log_client
"
30486,Single SQLstatement for many INSERTs,"declare @maxkey int
select @maxkey = max([Key]) from Test

insert into Test (Name, [Key]) 
select Name, row_number () over (order by (select null)) + @maxkey
from Test2
"
39859,Mysql - Left Join all tables,"SELECT temp_table.* FROM
    (SELECT 'asdf', '123' ... FROM DUAL) temp_table
LEFT JOIN table1
on
(
    new_condition
)

LEFT JOIN table2
on
(
    condition1
)

LEFT JOIN table3
on
(
    condition2
)

where
(
    main_condition
)
"
28506,Getting the ID From MAX(SUM()) SQL GROUP BY,"SELECT *
FROM (SELECT PlayerIDFK, sum(TwoPointMade) as TwoPointMade, sum(ThreePointMade) as ThreePointMAde 
      FROM PlayerPerformance
      GROUP BY PlayerIDFK
      ORDER BY ( sum(TwoPointMade) + sum(ThreePointMade) ) desc
     ) pp
WHERE rownum = 1;
"
5645,SQL query for fetching a value where all but one row matches,"SELECT DISTINCT
    task_group
FROM query_tst As a
WHERE (
    (NOT EXISTS (
        SELECT NULL
        FROM query_tst As b
        WHERE (
            (a.task_group = b.task_group) And
            (b.task_name <> 'Initial') And
            (b.performed_by <> 'AUTO')
        )
    ))
);
"
22061,MSSQL Cursor for huge tables cannot allocate space,"WHERE
    MD2.iBatchNumber = @iBatchNumber
ORDER BY
    MD2.sTableName, MD2.iRowIndex
"
33668,case condition then using two tables,"select firstname,lastname 
from table1 (nolock) 
left outer join table2 on table1.ID=table2.ID
where isnull(billingaddress, shippingaddress) like 'Lake street'
"
257,creating xml from multiple sql tables,"SELECT approval.*,
(select diag.*
from diag diag 
where approval.id =diag.id
FOR XML PATH('diag'), TYPE
),
(select ser.*
from ser ser
where approval.id =ser.id
FOR XML PATH('ser'), TYPE
)
FROM approval approval,
where approval.id = 1
FOR XML PATH, ELEMENTS,
root('Head')
"
15073,Combining multiple excel worksheets into a single sheet,"Sub Combine()
Dim J As Integer
On Error Resume Next
Sheets(1).Select
Worksheets.Add
Sheets(1).Name = ""Combined""
Sheets(2).Activate
Range(""A1:C3"").EntireRow.Select
Selection.Copy Destination:=Sheets(1).Range(""A1"")
For J = 2 To Sheets.Count
Sheets(J).Activate
Range(""A1"").Select
Selection.CurrentRegion.Select
Selection.Offset(3, 0).Resize(Selection.Rows.Count - 3).Select
Selection.Copy Destination:=Sheets(1).Range(""A65536"").End(xlUp)(2)
Next
End Sub
"
36478,SQL Server to Oracle SQL Developer Query,"WITH
konstants AS
(
    SELECT 'Tim' NAME,
           55    AGE
    FROM DUAL
)
SELECT *
FROM TblIdentifier 
WHERE NAME = (SELECT NAME FROM konstants) 
  AND AGE  = (SELECT AGE  FROM konstants)
"
22067,How to find the last row in a column with duplicate values,"select t.* 
from 
(
    select userid, max(rownumber) m 
    from table
    group by userid
) c
    inner join table t
         on c.userid = t.userid and c.m = t.rownumber
"
30285,Nested Select SQL statements in an Insert SQL statement,"insert into OrderItem (MenuID, OrderID)  
    Select MenuID, last_insert_rowid()
    from Cart
    Where Username = 'Foris';
"
1861,How To Calculate values,"select a.name, a.total / b.all_total
from user a
join calculate b;
"
18902,How to convert the following SQL query to Linq?,"var result = ServiceCalls
        .Where(s => s.Ser_CallDate.Month == DateTime.Now.Month
            && s.Ser_CallDate.Year == DateTime.Now.Year)
        .GroupBy(s => s.Ser_CallDate)
        .Select(g => new {
                OrderDate = g.Key,
                TotalCall = g.Count()})
        .ToList();
"
26135,how to select where entire field is uppercase in sql,"SELECT * FROM TABLE_NAME WHERE COLUMN_NAME COLLATE Latin1_General_CS_AI=UPPER (COLUMN_NAME)
"
18385,Returning MONTH and YEAR in the same column in SQL,"SELECT DATE_FORMAT(myDateColumn, '%Y-%m'), COUNT(*)
FROM myTable
GROUP BY DATE_FORMAT(myDateColumn, '%Y-%m')
ORDER BY 1
"
31050,String split to table on whole column,"SELECT q.PersonID, r.RaceDescription
FROM dbo.QuestionaireResponse q JOIN dbo.Race r 
ON ',' + q.RaceIDs + ','  LIKE  '%,' + CONVERT(varchar(10),r.RaceID) + ',%';
"
30964,SQL Server self join,"WITH ranked AS (
  SELECT
    *,
    rn = ROW_NUMBER() OVER (PARTITION BY col3 ORDER BY col2)
  FROM table1
)
SELECT
  col1 = r1.col2,
  col2 = r2.col2
FROM ranked r1
  INNER JOIN ranked r2 ON r1.col3 = r2.col3
WHERE r1.rn = 1
  AND r2.rn = 2
"
24124,Cascade Updates with Math in SQL,"SELECT (SELECT COUNT(*) FROM table_name AS p2 WHERE p2.num_pawns + 3*p2.num_knights + 5*num_castles > p1.num_pawns + 3*p2.num_knights + 5*num_castles) FROM table_name AS p1 where p1.rowid=x); where x is a rowid
"
36514,Change only single column values when we use * in sql,"SELECT COL1||'_asd_', T.*
FROM MYTABLE T;
"
19730,Delete similar entries in ms access,"DELETE
FROM MyTable
WHERE ID NOT IN
(
SELECT MAX(ID)
FROM MyTable
GROUP BY DuplicateColumn1, DuplicateColumn2, DuplicateColumn3)
"
1220,postgresql - Why does % not return exact matches?,"SELECT users.* FROM ""users"" WHERE (trim(lower(fname)) || ' ' || trim(lower(lname)) LIKE '%jeff ba%')
"
17630,how to write store procedure from two table,"SELECT OrderNo = t1.order_no
    , OrderId = t1.order_Id
    , OrderNoWithInvoiceId = 
      CASE 
        WHEN t2.inv_no IS NULL 
            THEN t1.order_no 
        ELSE t1.order_no + '_' + t2.inv_no 
      END 
FROM t1 INNER JOIN t2 ON t1.order_no = t2.order_no
"
39312,Checking a String value,"Select iif(Answer = """""""""""", ""No Response"", Answer)
From tblAnswers
"
38017,"MySQL: selecting unique name, but sum matching columns","SELECT project_id,
sum(case when phase_id=1 then hours_worked else 0 end),
sum(case when phase_id=2 then hours_worked else 0 end),
sum(case when phase_id=5 then hours_worked else 0 end)
from table_name
group by project_id
"
28105,SQL Server 2005 where clause,"SELECT Symbol FROM Opt
WHERE (Symbol like @Symbol+'%' AND REPLACE(Symbol,@Symbol,'')='FUT')
   OR (CAST(left(Replace(Symbol,@Symbol,''), 
            len(Replace(Symbol,@Symbol,''))-2) AS INT) 
         BETWEEN @SpFrom AND @SpTo AND Symbol LIKE @Symbol+'%')
"
29746,Spring inject xml values to properties-config.xml then to a bean,"<property name=""insertSql"" value=""${sql.accountdao.insert}"" />
<property name=""selectSql"" value=""${sql.accountdao.select}"" />
"
2756,Remove h1 text from column in MySQL,"UPDATE table
SET post_content = CONCAT(SUBSTR(post_content, 1, LOCATE('<h1>', post_content) - 1),
    SUBSTR(post_content, LOCATE('</h1>', post_content) + 5));
"
19563,How can I make this query run faster in SQL?,"select l.year, count(*)
from laws
group by l.year
order by l.year desc;
"
17241,Selecting everything but not a specific value,"SELECT p.*
FROM Proofs p
WHERE p.Proof <> 'All proofs'
"
21847,Blocking within SSMS tab,"ALTER DATABASE MYTEST
SET OFFLINE
WITH ROLLBACK IMMEDIATE
"
30799,the work flows and how to design an er model or diagram," SELECT | gives the right to read the table contents.
 INSERT | gives the right to add new rows to the table.
 DELETE | gives the right to remove rows from the table.
 UPDATE | gives the right to update the contents of the table.
"
39109,How do I use the LIKE query in and UPDATE statement? *Example provided*,"UPDATE MEMBERS
SET Address = REPLACE(Address, 'Road', 'Rd')
WHERE Address LIKE '*Road'
"
14276,My SQL DISTINCT and count if,"SELECT Adid, SUM(New = 1) new
  FROM Message 
 WHERE (MesFrom = 1 OR MesTo = 1) 
   AND (MesFrom = 2 OR MesTo = 2) 
 GROUP BY Adid
"
13827,Why does PostgreSQL allow frame clause without order by expression?,"select  id
,       max(id) over (rows between 1 following and 1 following) as next_id
from    AnyTable
"
13350,Convert float to DateTime in Oracle DB,"select to_date('12/30/1899', 'MM/DD/YYYY') + 40676.2641666667 from dual;
"
253,Getting the max value and the month and hour it occurred in access,"select A.clientid, A.clientname, A.power, A.date, A.hour
from tabledata A
JOIN
(
    SELECT clientid, max([power]) as max_power
    from tabledata
    group by ClientID
) as B on A.ClientID = b.ClientID and A.[power] = B.max_power
"
25891,How many chars are available in nvarchar(MAX),"declare @string nvarchar(MAX) = ''
select datalength(@string), LEN(@string)
GO

declare @string nvarchar(MAX) = '1'
select datalength(@string), LEN(@string)
"
22033,Limit the number of rows being processed in this query,"SELECT (columns)
FROM (.......) as temp 
WHERE rownum BETWEEN 0 AND 20 
"
2546,How to display SQL result like that,"select document_name, group_concat(tag SEPARATOR ', ')
from Documents
group by document_name
"
36936,Is it possible to order by substrings in postgreSQL?,"select id, 
       version
from widgets
order by string_to_array(version, '.')::int[]
"
1192,Which layout is better for this database table?,"CREATE TABLE `Questions` (
  `QuestionId` int(11) NOT NULL AUTO_INCREMENT,
  `AnswerId` int(11) DEFAULT NULL,
  PRIMARY KEY (`QuestionId`),
  KEY `FK_Answer` (`AnswerId`),
  CONSTRAINT `FK_Answer` FOREIGN KEY (`AnswerId`) REFERENCES `Answers` (`AnswersId`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `Answers` (
  `AnswerId` int(11) NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`AnswerId`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
"
28972,Select top nth row (or last row if there's fewer than n rows),"select score
from (
    select score
    from table
    order by score desc
    limit 1000
) s
order by score
limit 1
"
9761,How to count the occurrences of a value in a row based on a WHERE condition?,"select ID,sum(i_count) as unpaid_count
from
(
select ID ,case when Jan = 'PAID' then 0 else 1 end as i_count,1 as month_no
from payments
union all
select ID, case when Feb = 'PAID' then 0 else 1 end ,2
from payments  
union all
select ID, case when Mar = 'PAID' then 0 else 1 end ,3
from payments
union all
select ID, case when Apr = 'PAID' then 0 else 1 end ,4
from payments 
union all
..
) A 
Where month_no <= strftime('%m', date('now')) 
"
31142,SQL Incremenet and Reset Variable Insert,"SELECT ID, DateField, FieldA, 
    ROW_NUMBER() OVER(PARTITION BY ID ORDER BY DateField ASC) AS Counter
FROM YourTable
ORDER BY ID, DateField
"
27212,using multiple conditions in one query in oracle,"select id, performer, max(END_TIME) from workstep where workstep_name = 'Review' and status ='W_COMPLETED' group by id,performer
"
37509,method to query for changes in single table with multiple data loads and set the mutationcode identifier,"UPDATE r1
SET r1.mutationcode = 1
FROM record as r1
join record as r2 on r2.loadno < r1.loadno
                  and r2.firstname = r1.firstname
                  and r2.lastname = r1.lastname
WHERE r2.street != r1.street
   or r2.streetno != r1.streetno
   ;
"
39821,choose month according to number of date he has been hired,"select round(<yourdate>, 'MONTH') hire_month from dual
"
35758,How to get total count of orders placed on spesific date using Raw query,"SELECT COUNT(*)
FROM TABLE_NAME
WHERE DATE_COL = 'YOUR_DATE'
"
31907,How to use CStatRelation in Yii,"'maxBid' => array(self::STAT, 'Bid', 'auction_id', 'select'=>'MAX(bid_amount)'),
"
2501,How do i get relationships between users?,"SELECT u.username, 
FROM users u
JOIN relationships r ON u.id = r.me OR u.id = r.partner
JOIN users u2 ON r.me = u2.id OR r.partner = u2.id
WHERE u.id = 'THE USER YOU CARE ABOUT'
"
3630,Convert rows in columns with informix query,"select inpvacart, 1 as line, inpvapvta as value from inpva
union all
select inpvacart, 2 as line, inpvapvt1 as value from inpva
union all
select inpvacart, 3 as line, inpvapvt2 as value from inpva
union all
select inpvacart, 4 as line, inpvapvt3 as value from inpva
union all
select inpvacart, 5 as line, inpvapvt4 as value from inpva
order by inpvacart, line;
"
22633,Develop for SQL Server Standard using SQL Server Express?,"Data Source=ServerName;Initial Catalog=AppDatabase;Integrated Security=True;Persist Security Info=True;Connect Timeout=30
"
3920,"SELECT Top 1 ID, DISTINCT Field","SELECT min(ID), City
FROM Cities
Group by City
"
29308,Why is this mySQL query extremely slow?,"SELECT
    t2.products_id,
    count(t2.products_id) AS counter
FROM orders_products t1
JOIN orders_products t2
    ON t2.orders_id = t1.orders_id
    AND t2.products_id != 85094 
WHERE t1.products_id = 85094
GROUP BY t2.products_id
ORDER BY counter DESC
LIMIT 4
"
27539,Dynamic SQL Select Variable Statement,"declare

currMonth number:=12;
plsql_block VARCHAR2(500);

begin
plsql_block:='Select Month'||currMonth -2||'_Values,
                     Month'||curr_month-1||'_Values,
                     Month'||currMonth||'_Values 
              from test_table';

execute immediate plsql_block;
end
"
10134,Cannot get correct query keep getting duplications,"SELECT      a.name, c.name, c.number
FROM        a
INNER JOIN  b ON a.ID = b.ID
INNER JOIN  c ON b.StoreID = c.ID
"
13612,SQL inner join not returning records with blank values,"select i.ItemID, i.qty, i.description, c.firstname,
       c.lastname, inv.InvoiceDate, i.status 
from items i left outer join
     Invoices inv
     on i.InvoiceID = inv.InvoiceID left outer join
     customers c
     on inv.CustomerID = c.CustomerID 
where i.Status = 'ONTIME' 
order by InvoiceDate asc;
"
1557,count items in each category,"Select item_Id, category_id
From Table
Group By item_Id, category_id
Having Count(*) > 1
"
6100,MySQL subquery to count user results in another table is sloooooooow,"SELECT users.email, COUNT(r.result_id) as results
FROM users
INNER JOIN users_groups ON users_groups.user_id=users.id
INNER JOIN programmes_results r on ((r.client_id=users.client_id) AND (r.email=users.email))
WHERE users.client_id='130' AND users_groups.group_id IN (5)
group by users.email
ORDER BY users.email asc
LIMIT 10
"
34568,"Update query ""updatable query"" issue","UPDATE T1 SET Indicator = 1 
WHERE Indicator = 0
AND EXISTS (SELECT * FROM T1 AS T2 WHERE T2.Indicator = 1 AND T1.ID = T2.ID)
"
20256,Selecting unique records from database,"SELECT distinct number
FROM MyTable
WHERE branch=1 and number not in 
( SELECT distinct number
FROM MyTable
WHERE branch != 1 )
"
14515,Is there any alternative for mysql concat with better performance?,"SELECT * FROM Employee e INNER JOIN MasterEmployee me
    ON e.id LIKE CONCAT('08080', me.id, '_')
   AND e.status = me.status
 WHERE e.status = 'approved';
"
16956,How do I avoid a repetitive subquery JOIN in SQL?,";WITH YourQuery AS
(
 SELECT code, date1, date2 from Table
)
SELECT 
    T1.stuff, T2.morestuff 
    from YourQuery           T1
        INNER JOIN YourQuery T2 ON T1.code = T2.code and  T1.date1 = T2.date2
"
29898,"SQL Server, Remove null values in a select case query","select 
A.ekod
,sum(case when a.unit='3' then 1 else 0 end) AS [Unit=3]
from [Stat_unitdata].[dbo].[XXX_YYY] A
group by a.ekod
order by ekod
"
20272,Merge two or more fields before inserting,"SELECT id, CONCAT_WS(' ', first_name, second_name) as full_name, dob
"
14378,SQL : Getting data as well as count from a single table for a month,"insert into empty_table  
select id
   ,count(distinct name)
   ,min(date) 
from existing_table 
where date >= DATE '2015-03-01'
  and date < DATE '2015-04-01'
group by id;
"
9961,Do i need separate index in addition to primary key in a MySQL table?," PRIMARY_KEY(Name, Time)
"
30234,Conditional ORDER BY depending on column values,"SELECT TOP 1 FROM ... ORDER BY 
    (CASE WHEN column1 IS NULL THEN column2 ELSE column1 END) 
"
37689,sql - get parentID with or without child in self refrenced table,"SELECT DISTINCT COALESCE(e2.eventID, e1.eventID), 
       COALESCE(e2.eventName, e1.eventName),
       COALESCE(e2.appFK, e1.appFK)
FROM events AS  e1
LEFT JOIN events AS e2 ON e1.parentID = e2.eventID AND e1.appFK = 1
WHERE (e1.appFK = 1 AND e1.parentID IS NULL) OR (e2.eventID IS NOT NULL)
"
11510,How to get size of mysql database?,"SELECT table_schema                                        ""DB Name"", 
   Round(Sum(data_length + index_length) / 1024 / 1024, 1) ""DB Size in MB"" 
FROM   information_schema.tables 
GROUP  BY table_schema; 
"
31337,Database triggers / referential integrity and in-memory caching,"   Question
   (TagId)         1 | Database triggers / referential integrity and in-memory caching
      |  
    -----
    | | |
  QuestionTag
 (QuestionId)       1 | 1  ... 1 | 2  ... 1 | 3 ...
    (TagId)
    | | |
    -----
      |
     Tag            1 | database ... 2 | referential-integrity ... 3 | triggers ...
   (TagId)
"
35446,Changing from static date to changing date in Query & issue with Aggregate Function - MYSQL,"   SELECT SUM(date_format(purchasedate, '%m-%Y') = CONCAT('07-',YEAR(CURDATE()))
         / SUM(date_format(purchasedate, '%m-%Y') = 
                         CONCAT('07-',YEAR(DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) 
   FROM Sales
"
27107,How to write efficient UPDATE-SELECT sql,"create table t as select column_list from a join b on column=column;
alter table t rename to users;
"
24943,SQL. The intricate JOIN between two tables,"SELECT u.*, 
        CASE WHEN s.user_id IS NULL THEN 'false' ELSE 'true' END as IsSubscriber 
FROM users u 
   LEFT JOIN subscribers s ON u.id = s.user_id
"
27638,Update another table when field is changed,"Private Sub Text4_Exit(Cancel As Integer)
Dim strSQL As String
strSQL = ""UPDATE Quantity "" _
& ""SET [DateProduced] = #"" & Format(Me.Text4.Value, ""dd-mm-yyyy"") & ""#"" _
& ""WHERE [ID] = ("" & Me![Text0] & "");""

DoCmd.RunSQL strSQL

End Sub
"
31922,SQL query multiple tables in database," select PropertyName, ClientsInProp_VisitDate, ClientName 
 from Property
   left join ClientsInProp on ClientsInProp_Propertyid = Property_PropertyID
   left join Client on Client_Clientid = ClientsInProp_ClientId 
 where Proprty_Name = 'House 1' and ClientsInProp_VisitDate > '01.10.2013'
"
9412,What is the least expensive method to get a row count for a SQL Query?,"SELECT mycolumns, (select count(*) from table) as Count 
FROM table 
LIMIT 100
"
23428,Get items before and after an item - SQL Query,"WITH NumberedZipCodes AS
(SELECT SELECT ROW_NUMBER() OVER (ORDER BY ZipCode) AS RowNumber, *
FROM ZipCodes)

SELECT * From NumberedZipCodes
WHERE RowNumber BETWEEN
(SELECT RowNumber FROM NumberedZipCodes WHERE ZipCode=91803) - 3
AND (SELECT RowNumber FROM NumberedPerson WHERE ZipCode=91803) + 3
"
25019,Sequence numbers for individual values in column,"declare @t table(id int,Name varchar(10))

    insert into @t (id,name)values (1,'HO')
    insert into @t (id,name)values (1,'HO')
    insert into @t (id,name)values (2,'HO')
    insert into @t (id,name)values (2,'HO')

    select id,name +CAST(row_number()OVER(PARTITION BY id order by name )AS VARCHAR)rn from @t
"
26563,Disable the query retrieve (ctrl+f11) on a detail block in master-detail relation in Oracle Forms,"begin
   << display your message>>
   raise form_trigger_failure;
end;
"
37200,"MongoDB Given a list of keys, get all matching docs and create new docs for non-matching keys","var emails;
var matchingMails = users.find({""email"" : {$in : emails}}, {""email"":1, ""_id"":0});
var newEmails = emails.subtract(matchingMails); // set difference
db.batchInsert(createUsersFromEmails(newEmails));
"
36319,Writing SQL query where a value maps to all possible values,"SELECT A.name, B.marks FROM A, B WHERE A.num = 0 OR A.num = B.num
"
29183,Distinct over several field but show all field SQL Server,"SELECT * FROM(
    SELECT
        ROW_NUMBER() OVER (Partition by [Type], [Div] ORDER BY [Date] DESC) RowNum,
        [Date], 
        [No.PO], 
        [Product], 
        [Type], 
        [Div], 
        [Price] 
    FROM TABLE_Name
)x WHERE RowNum=1 
ORDER BY [Date] DESC
"
38545,How to replace last occurrence of a substring in MYSQL?,"select reverse(concat(
               left(reverse('American Corp National Corp'),
                    instr(reverse('American Corp National Corp'),reverse('Corp'))-1),
               substr(reverse('American Corp National Corp'),
                      instr(reverse('American Corp National Corp'),reverse('Corp'))+
                      length('Corp')))) result
"
39329,Can someone explain to me how this statement is an exclude?,"SELECT *
    FROM [table].[dbo].[one] AS t1
    LEFT JOIN [table].[dbo].[one] AS t2
         ON (t1.ColumnX = t2.ColumnX AND t2.columnY = 1)
    WHERE t2.tableID IS NULL
"
37482,Creating a summary of a table using GROUP BY and conditional statements,"select category, year,
       sum(case when step1 = 'Yes' then 1 else 0 end) as Step1,
       sum(case when step2 = 'Yes' then 1 else 0 end) as Step2,
       sum(case when step3 = 'Yes' then 1 else 0 end) as Step3
from mytable
where year = 2014
group by category, year;
"
32676,select from unpopulated table - IS NULL does not work,"where 
Sp.sprite_change_ind is null
and sh.TRAN_REQUEST_DATE between sysdate-1 and sysdate
and (sf.stcr_term_code = '201401' or sf.stcr_term_code = '201402')
AND SV.RSTS_ENRL = 'Y'
and trim(NL.DGMR_DEGS_CODE) is null
"
3547,sql query to get dIvided group,"    ;with cte as (
select 
    case 
        when stat = 'N' and duedate > GETDATE() then 'NG' 
        when stat = 'N' and duedate < GETDATE() then 'NL' 
        else stat 
    end As S, duedate from activity)
    select S,COUNT(*) from CTE group by (S)
"
28420,Is there a way to return each value as a row in SQL,"select 'Draft' as Enum
union
select 'Submitted' as Enum
union
select 'Cancelled' as Enum
union
select 'Accepted' as Enum
union
select 'Accepted and Modified' as Enum
union
select 'Open' as Enum
union
select 'Pending' as Enum
union
select 'Seller Reject' as Enum
"
19763,SQL Group by Age Range," SELECT SUM(CASE WHEN age_c < 18 THEN 1 ELSE 0 END) AS [Under 18],
        SUM(CASE WHEN age_c BETWEEN 18 AND 24 THEN 1 ELSE 0 END) AS [18-24],
        SUM(CASE WHEN age_c BETWEEN 25 AND 34 THEN 1 ELSE 0 END) AS [25-34]
 FROM contacts
"
7663,Joining Multiple Large Tables,"select t1.a, t1.b
into t4
from t1
join t2 on t1.a = t2.a and t1.c = t2.c
join t3 on t1.a = t3.a and t1.c = t3.c
where t3.e / t2.d < x
"
30842,How to include missing rows in sql return,"SELECT NAME, SUM(VALUE), TIME.MONTH
FROM (SELECT DISTINCT MONTH FROM TIME_TABLE 
      WHERE MONTH BETWEEN 12 MONTHS AGO AND NOW) TIME
     LEFT OUTER JOIN TABLE ON (TIME.MONTH = TABLE.MONTH)
GROUP BY TIME.MONTH, NAME
"
7856,Select row that has max total value SQL Server,"SELECT Top 1 WITH TIES c.CustomerName, SUM(s.SUM) AS TotalSum
FROM Customer c JOIN Sales s ON s.CustomerId = c.CustomerId
GROUP BY c.CustomerId, c.CustomerName
ORDER BY SUM(s.SUM) DESC
"
15151,SQL - sequential update problem - update using the updating data,"DECLARE @Data TABLE (ID INTEGER PRIMARY KEY, Total INTEGER, Diff INTEGER)
INSERT @Data VALUES (1, 100, 20)
INSERT @Data VALUES (2, NULL, 30)
INSERT @Data VALUES (3, NULL, -15)
INSERT @Data VALUES (4, NULL, 4)

DECLARE @PreviousTotal INTEGER
SELECT @PreviousTotal = Total
FROM @Data 
WHERE ID = 1

UPDATE d
SET @PreviousTotal = d.Total = @PreviousTotal + d2.Diff
FROM @Data d
    JOIN @Data d2 ON d.ID = d2.Id + 1

SELECT * FROM @Data 
"
2703,PostgreSQL - Determining the Percentage of a Total,"SELECT  100.0 * number / sum(number) over () as perc
FROM    mytable;
"
21995,grabbing information by joining multiple tables,"select co.*
from link l left join
     clients cl
     on l.src = 0 and l.uid = cl.code left join
     carriers ca
     on l.src = 1 and l.uid = ca.code left join
     contacts co
     on l.contactid = co.contactid
where 'ABC' in (co.code, cl.code)
"
38212,SQL - Retrieve Closest Lower Value,"SELECT TOP 1 (pay) as incentivePay
FROM incentive
WHERE yearsOfService <= '10'
ORDER BY yearsOfService desc
"
2310,Is there a way in MySQL to choose an order for the beginning and end of rows returned?,"  SELECT u.id
    FROM USERS u
ORDER BY CASE id
           WHEN 4 THEN 1
           WHEN 5 THEN 2
           WHEN 7 THEN 3
           WHEN 8 THEN 4
           WHEN 55 THEN 100000
           WHEN 56 THEN 100001
           WHEN 58 THEN 100002
           ELSE id
         END ASC
"
12864,SQL update statement is executing but updating with incorrect values,"select
     c1.NO as NO_target
    ,c2.NO as NO_source
    ,c1.SID as SID_old
    ,c2.SID as SID_new
from table1 c1
join table2 c2
   on c1.NO = c2.NO
  and c1.UID = c2.UID   -- I believe this line is needed to prevent a partial Cartesian product
where c1.UID = '09999138181408374834'
  and c1.NO is not null
"
15951,SELECT in Table (SQL),"select Name
from t
where id in (select manager_id from t)
"
23228,How to delete duplicate entries?,"CREATE TABLE tmp ...
INSERT INTO tmp SELECT DISTINCT * FROM t;
DROP TABLE t;
ALTER TABLE tmp RENAME TO t;
"
9722,Total ROWS selected in a LOOP ORACLE PL/SQL,"DECLARE
  strLast_ID  VARCHAR2(1000) := NULL;

  CURSOR CLEEVECTOR IS
    select regexp_substr(p_checkboxes,'[^,]+', 1, level) ID
      from dual
      connect by regexp_substr(p_checkboxes, '[^,]+', 1, level) is not null;
BEGIN
  FOR X IN CLEEVECTOR LOOP
    IF strLast_ID IS NOT NULL THEN
      -- code to process strLast_ID
    END IF;

    strLast_ID := X.ID;
  END LOOP;
END;
"
13527,mysql update table with values within table,"UPDATE WP_POSTMETA p1, WP_POSTMETA p2
     , WP_ICL_TRANSLATIONS t1, WP_ICL_TRANSLATIONS t2
   SET p1.post_content = p2.post_content
 WHERE t1.trid = t2.trid
   AND t1.element_id = p1.ID
   AND t2.element_id = p2.ID
   AND t1.language_code = 'en'
   AND t2.language_code = 'zh-hans'
"
15147,SSRS Default Title Bar,"this.ReportViewer1.ShowToolBar = false;
"
38917,T-SQL QUERY PROBLEM,"/* @Parent is VarChar(255) because definition is unknown.
   We use Top(1) because in example ID is not unique.
   We assume the ID being passed in is declared as @ID.*/
Declare @ParentID Int
Set @ParentID=(@ID-1)
Declare @Parent VarChar(255)
Set @Parent = (Select Top(1) Name From Summary
               Where ID=@ParentID) 
"
27585,Removing NULLS from conditional aggregation results,"select itemid,title,description,cat,fibre,washing,colours,promo,
       isnull(max(case when seqnum = 1 then chm_sizegrouping end),'') as sizes_1,
       isnull(max(case when seqnum = 2 then chm_sizegrouping end),'') as sizes_2,
........
"
16107,distinct and order-by for result of regexp_substr,"select distinct to_char(regexp_substr(longarg, '30G([^|]*)', 1, 1, '', 1)) founded
from dod
order by founded;
"
27444,Access query select,"SELECT  a.IdDisease,
        a.DiseaseName
FROM    Diseases AS a
        INNER JOIN SymptomsDiseases as B
            ON a.IdDisease = b.IdDiseases_fk
WHERE   b.IdSymptoms_fk IN (3,4,5)               -- <<== list of ID of Symptoms
GROUP   BY a.IdDisease, a.DiseaseName
HAVING  COUNT(*) = 3                             -- <<== number of symptoms
"
28348,How to seperate SQL query result based on parts of the column input,"SELECT ROUND(SUM(pixeldatafilesize)/1048576,2) AS studysizemb,CONVERT(varchar(50),DateTime ,101)  AS DateTime FROM filename 
WHERE DateTime BETWEEN '2014-05-01' AND '2014-06-01' 
GROUP BY CONVERT(varchar(50),DateTime ,101) 
"
25302,"sql, how to eliminated repeated data across columns"," SELECT DISTINCT ON (LEAST(c1, c2), GREATEST(c1, c2))
   LEAST(c1, c2), GREATEST(c1, c2), city FROM t;
"
16259,SQL Select Text for multiple foreign keys to lookup table in same row,"select i.item_id, 
    i.old_status, 
    i.new_status,
    i.timestamp,
    s1.statustext,
    s2.statustext
from items i
    join status s1 on i.old_status = s1.statusid
    join status s2 on i.new_status = s2.statusid
"
1369,How do I directly read and write database files in vb2008?,"Dim DBConn as New OleDbConnection(""Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\MyDBFile.mdb;"")
"
12304,after update trigger to deal with multiple rows,"CREATE TRIGGER [dbo].[Group_Update]
ON [dbo].[TBL_ADM_USER_GROUP]
AFTER UPDATE
AS
BEGIN
   SET NOCOUNT ON;

   INSERT INTO TBL_TestTable    -- define column list for clarity
   SELECT CONCAT('Group ""' ,i.name,'"" is updated'),
         'GROUP', 'Update', SYSDATETIME(),
         i.changer_user_id
   FROM inserted i;
END
"
24019,Use Except with taking into account the number of duplicate,"Select id,a,b,c from 
(
Select *, Row_Number() Over (Partition By id,a,b,c order by id,a,b,c) as Row
from t1
Except
Select *, Row_Number() Over (Partition By id,a,b,c order by id,a,b,c) as Tow
from t2
  ) t
"
19814,Filter data from table by checking field value,"select refid, model, make, style, imageid, dealerId
from test t1
where (dealerId is not null and dealerId <>'')
   or not exists (select 1 
                  from test t2
                  where t1.refid = t2.refid
                    and (dealerId is not null and dealerId <>''))
;
"
8286,How do I incorporate NEXTVAL in my procedure?,"create or replace procedure prod_add_sp (p_idproduct in bb_product.idproduct%type, p_prodname in bb_product.productname%type, p_descrip in bb_product.description%type, p_prodimage in bb_product.productimage%type, p_prodprice in bb_product.price%type, p_prodactive in bb_product.active%type) is
begin 
insert into bb_product(idproduct,productname,description,
productimage,price,active)
values (nextID.nextVal,p_prodname,p_descrip,
p_prodimage,p_prodprice,p_prodactive);

commit; 
end;
"
27990,mysql: how to put row data into one return column,"SELECT GROUP_CONCAT(ID)
FROM tablename
Where Running = 3
"
10751,Performance of JOIN vs SELECT...WHERE with an example,"SELECT article, dealer, price
FROM   shop
WHERE  price IN (SELECT MAX(price) FROM shop);
"
11308,How to count unique rows in Oracle,"SELECT COUNT(*) 
FROM (SELECT DISTINCT * FROM Table)
"
28548,How to use the SUM function on a specific table two times and then make a deduction,"SELECT  ITEM_ID, 
        SUM(CASE WHEN OCCASION = 1 THEN QTY ELSE 0 END)
        - SUM(CASE WHEN OCCASION = 2 THEN QTY ELSE 0 END)
FROM    TEMPTABLE
GROUP BY ITEM_ID
"
22004,Select * where tag name is in junction table,"SELECT SQL_CALC_FOUND_ROWS a.vid_id, count(a.id) as idCount
FROM scruseronline as a
INNER JOIN tag_map as b
ON b.vid_id = a.vid_id
INNER JOIN tags2 as c
ON c.tag_id = b.tag_id
AND c.name IN (?)
GROUP BY a.vid_id
ORDER BY idCount DESC
"
12072,Database Query: Importing data from an excel spreadsheet. Without it opening that spreadsheet.,"If Err.Number = (The error number you get) then
    Set xlWorkbook = GetObject(""C:\Test\MyWb.xlsx"", ""Excel.Application"")
end if
"
18164,Efficient way to replace HTML codes with special characters in oracle sql,"select
   'UPDATE ' || table_name || ' SET ' || col_name || ' = UTL_I18N.unescape_reference(' || col_name || ');'
from
   all_tab_cols
where
   owner = <MY_NAME>
and 
   table_name in ('....') -- you can use this clause too: table_name like '%my_table%'
"
38580,How to model this one-to-one relation?,"if(usertype==admin)
  select * from  admins where userid=:id;
else    
  select * from  general where userid=:id;
"
23994,how to do a retrieve user posts from this database design?,"SELECT 
      u.userName, 
      p.Text
FROM 
      UserPosts up 
INNER JOIN
      Users u 
ON  
      u.userID = up.userID
INNER JOIN 
      Posts p ON p.postID = up.postID
"
22829,How to do a OUTER JOIN on a query,"SELECT TableA.Type, SUM(b.HreReelles) AS HreReellesTotales, 
       b.NoProjet_Short 
FROM TableA 
LEFT JOIN (SELECT * FROM TableB 
  WHERE TableB.ColumnName = 'SomeValue') b
ON TableA.IDType = b.IDType  
WHERE TableA.Categorie = 'Electrique' 
GROUP BY b.NoProjet_Short,TableA.Type
"
26470,Find rows with same value of a column,"SELECT t1.what
FROM Table t1
JOIN Table t2
ON t1.why = t2.why and t1.what != t2.what
"
9648,Oracle NUMBER(3) = -999 to 999 or -99 to 99 (is the sign part of the precision)?,"SQL> create table numcheck(a number(3));

Table created.

SQL> insert into numcheck values (-999);

1 row created.

SQL> insert into numcheck values (999);

1 row created.

SQL> select a, vsize(a), dump(a) from numcheck;

         A   VSIZE(A) DUMP(A)
---------- ---------- ------------------------------
      -999          4 Typ=2 Len=4: 61,92,2,102
       999          3 Typ=2 Len=3: 194,10,100
"
23453,PostgreSQL: Outer and self join,"SELECT b.price_timestamp, b.security, b.close AS bid, t.close AS trade
  FROM stock b
  FULL OUTER JOIN stock t
    ON b.price_timestamp = t.price_timestamp
   AND b.security = t.security
   AND t.price_type = 'TRADE'
 WHERE b.price_type = 'BID'
"
15053,use next_day and to_date in where clause,"SELECT  next_day(((to_date(20140203, 'yyyymmdd') - 90) -7), 'SUNDAY')
FROM DUAL;
"
28335,String loses last character when concatenated with empty string in Oracle SQL Developer,"SQL> select utl_raw.cast_to_varchar2('C5C6') i0 from dual;

I0
--------------------------------------------------------------------------------


SQL> select utl_raw.cast_to_varchar2('C5C6')||'' i1 from dual;

I1
--------------------------------------------------------------------------------


SQL> select utl_raw.cast_to_varchar2('C5C6')||''||'' i2 from dual;

I2
--------------------------------------------------------------------------------
"
20749,How to select only the rows that have a column with a repeated value?,"select t1.run, t1.code, t2.code from tablename t1, tablename t2
    where t1.run = t2.run and t1.code = 1 and t2.code = 8;
"
35669,How to count over several relations in SQL,"SELECT gp.id,
       gp.name,
       COUNT(DISTINCT c.id)
FROM   grandparents gp
       INNER JOIN parents p
               ON p.grandparent_id = gp.id
       INNER JOIN children c
               ON c.parent_id = p.id
GROUP  BY gp.id,
          gp.name  
"
14779,Convert linq statement to sql,"CREATE PROCEDURE [procedure_name] @variable1 varchar(50)
AS
BEGIN
    SELECT *
    FROM ID9Codes
    WHERE LEN(LTRIM(RTRIM(ISNULL(@variable1, '')))) = 0
        OR Code lIKE @Variable1 + '%'
END
"
34969,T-SQL: How to do this: select * from xy where uid in (@parameter),"DECLARE @QueryUIDs  varchar(MAX)
SET @QueryUIDs = '''E8812237-2F3B-445E-8EEF-020E0B6F6A53'', ''66E57225-642F-45B5-8E5D-070F2D1CF99D'', ''751C615B-EB9C-4D25-955D-0E0EB3CD05A2''' 

SELECT StateFullName, StateAbbrv, StateUID
FROM tblStates 
WHERE @QueryUIDs LIKE '%' + CAST(StateUID AS CHAR(36)) + '%'
"
37849,SELECT Only the words that are capitalized,"SELECT * 
FROM Location 
WHERE Cities LIKE 'CITY 1' 
COLLATE Latin1_General_CS_AI
"
24858,SQL Server - selecting data where not exists,"select f.* 
from Farm f 
left outer join (
    select FarmID 
    from Animal 
    where Name = 'pig'    
) a on f.ID = a.FarmID 
where a.ID is null
"
5253,What is the most effective way to correct these sections of this ERD?,"movie_x_id    movie_y_id   ratings_until  users_connecting  users_connecting_same  users_connecting_anti 
"
3069,Change mysql column rows,"ALTER TABLE emails MODIFY COLUMN name `name_data_type` after email;
"
10724,Select columns from one table based on the column names from another table,"DECLARE @listStr varchar(MAX);
set @liststr =
        (
select [column] + ',' from dbo.columns where nwlevel = '1' for xml path('')
        )

DECLARE @query varchar(MAX);
set @query =
        (
        'SELECT ' + LEFT(@listStr, LEN(@listStr)-1) + ' FROM staff'
        )
execute(@query)
"
10113,How can I update the table based on a SELECT query?,"update SignIn
    set SignInDateTime = dateadd('d', 1, DATE())
    where SignInDateTime is null;
"
36599,SQL Server - How to filter rows based on matching rows?,"SELECT
  AccountID
 ,MIN(SDIStatus) AS MinSDIStatus
INTO #MinTable
FROM #tempTBRB
GROUP BY AccountID

SELECT *
FROM #tempTBRB T
JOIN #MinTable M ON
     T.AccountID = M.AccountID
     AND T.SDIStatus = M.MinSDIStatus

DROP TABLE #MinTable
"
4031,How can I make a predicate with this?,"[NSPredicate predicateWithFormat:
    @""language.languageCode == %@ OR
    (language.languageCode = 'en' AND NOT (question IN %@))"", languageCode, foundLanguages]
"
8031,Joining different tables based on column value,"SELECT DISTINCT n.id 
FROM notifications n 
JOIN (
     (SELECT b.id, 'book' AS type FROM books b WHERE b.is_visible = 1)
  UNION
     (SELECT i.id, 'interview' AS type FROM interviews i WHERE i.is_visible = 1)
) ids ON n.parent_id = ids.id AND n.parent_type = ids.type
WHERE n.user_id = 1
"
24164,rank items in sql by dates,"ORDER BY 
  CASE WHEN movieDate >= DATEADD(hour, -24, GETDATE()) THEN movieDate END DESC,
  CHECKSUM(NEWID())
"
682,MySQL structuring a query,"SELECT ll.id, 
  ll.globalId,
  ll.date AS leveldate,
  ll.serverId,
  ll.gamemodeId,
  ll.mapId,
  pj.date AS joindate,
  pj.playerId
FROM levelsloaded AS ll
INNER JOIN playerjoins AS pj
  ON pj.date <= ll.date
LEFT OUTER JOIN playerjoins AS pj2
  ON pj.playerId = pj2.playerId AND pj2.date <= ll.date AND pj.date < pj2.date 
WHERE pj.playerId = 976
  AND pj2.playerID IS NULL
ORDER BY joindate DESC
"
33294,Getting unique tuples in SQL," select distinct least(from_st, to_st), greatest(from_st, to_st), fare
 from your table;
"
15912,"Order by some row matching a specific condition, and then another condition for the rest?","// first some sample data
declare @stories table (story varchar(20), lang char(2), votes int)
insert @stories values 
('Story 1', 'DK', 1),('Story 2', 'DK', 3),
('Story 3', 'EN', 4),('Story 4', 'EN', 3),
('Story 5', 'EN', 2),('Story 6', 'EN', 1)

// and the query
select top 3 * from (
    (select top 1 *, 1 as ranking from @stories where lang = 'DK' order by votes desc)
    union
    (select top 3 *, 2 as ranking from @stories where lang = 'EN' order by votes desc)
) x 
order by ranking, votes desc
"
35796,Optimizing key_len on mysql index,"SELECT * FROM `my_table` ORDER BY `name` ASC
"
12331,Food Selection Query,"SELECT Distinct a.Name AS Dish1, b.Name As Dish2
FROM Food a, Food b, ThroughAway c
WHERE a.Name <> b.Name AND a.Deskno = b.deskno AND 
(a.category = c.category1 AND c.category2 = b.category) ;
"
33965,Is it possible to detect where the join fails on a certain record?,"SELECT p.PropertyPK, ty.TenancyPK, t.ContactFK,
       c.strTitle, c.strFirstName, c.strSurname
FROM dbo.Property p LEFT JOIN
     dbo.Tenancy ty
     ON p.PropertyPK = ty.PropertyFK LEFT JOIN
     dbo.Tenant t
     ON ty.TenancyPK = t.TenancyFK LEFT JOIN
     dbo.Contacts c
     ON t.ContactFK = c.ContactPK;
"
25758,Calculating number of times a game was played,"Select maf_game.name as daname , count(maf_game_attempts.id) as danum from maf_game,maf_game_attempts where maf_game_attempts.gid=maf_game.id and maf_game_attempts.status='over';
"
15122,sql - aggregate max function and group by,"SELECT city, title, max (releasedate) as max_dateRelease
FROM movies inner join shownat on shownat.movietitle = movies.title join theatres 
on theatres.theatrename = shownat.theatrename
GROUP BY city, title, releasedate
ORDER BY city, max_dateRelease desc
"
9709,Update row with Top 1 value per group,"with toupdate as (
      select t.*, row_number() over (partition by name order by id) as seqnum
      from t
     )
update toupdate
    set code = tu2.code
    from toupdate join
         toupdate tu2
         on toupdate.name = tu2.name and
            tu2.seqnum = 1 and
            toupdate.seqnum > 1;
"
25394,Table with multiple foreign keys linking to the same primary key,"SELECT p.Name 
FROM `match` m
INNER JOIN `player` p 
    ON p.player_id IN (m.playerID1, m.playerID2, m.playerID3) //etc
"
13453,conversion failed when converting the varchar value '19500.00' to data type int,"UPDATE EMPLOYEES 
SET SALARY=cast(SALARY as decimal(10,2))+3500 
WHERE cast(SALARY as decimal(10,2)) < 33500
"
21247,MySQL using IF statements,"    SELECT contractType, paymentReceivedOn,
IF (contractType = 'abo3', ADDDATE(paymentReceivedOn, INTERVAL 3 MONTH), NULL)  
AS expiryDate FROM payments WHERE id=21
"
17590,Need to remove GO from string but only if followed or preceded by hidden character or space,"REPLACE(REPLACE(<columnname>,'GO ',''), CHAR(10)+CHAR(13), '').
"
36589,Something like MySQL triggers but as a whole?,"UPDATE u set u.customer_count = x.newcount
from
user u inner join 
(
select user, count(*) as newcount
from user group by customer_id
) x
"
24857,Change date format in mySql database table,"SELECT DATE_FORMAT(dateColumn,'%d/%m/%Y') AS dateColumn FROM table
"
19412,SQL - Selecting a field from another table using a primary key in a trigger,"select @TransactionTypeName = TT.Name
from inserted as i
    left outer join TransactionTypes as TT on TT.TransactionTypeId = i.TransactionType_TransactionTypeId
"
11719,SQL Server : calling a stored procedure or not,"ALTER PROCEDURE [dbo].[UpdateTheRate] (@PID int)
AS

-- defer executing the procedure unless necessary
IF EXISTS (SELECT 1 FROM TblChargeTable WHERE flag = 0 and PID = @PID)
BEGIN
   EXEC dbo.rate_procedure; -- get @user_rate via return code or out parameters perhaps
END

UPDATE t
SET    t.rate = 
       CASE WHEN t.flag = 1 THEN (select UnitRate from RateTable where state ='IL' and Term='20')
            WHEN t.flag = 0 THEN @user_rate END -- retrieved above
FROM   TblChargeTable t
WHERE  t.PID = @PID;
"
986,How can I fill my table?,"  INSERT INTO TableE (E_ID , E_NAME)
  SELECT b.B_ID ,d.D_ID FROM TableA a 
  INNER JOIN TableB b ON b.FROM_A = a.A_ID
  INNER JOIN TableC c ON c.C_ID  = a.A_TYPE
  INNER JOIN TableD d ON  d.D_NAME = c.C_NAME
"
17571,SQL query help select from multiple tables,"select ai.name, sum(ai.pay)
from actedin ai
group by ai.name
having sum(case when ai.year = 2010 then 1 else 0 end) > 0;
"
16606,Easiest way to modify a column?,"ALTER TABLE tbl_name DROP PRIMARY KEY my_misnamed_primary_key;
ALTER TABLE tbl_name RENAME COLUMN my_misnamed_primary_key TO primary_key;
ALTER TABLE tbl_name ADD PRIMARY KEY primary_key;
"
14381,"Add a new column to an existing table, with a value equal to the ID","ALTER TABLE [dbo].[Status] 
add Status_Code int NOT NULL DEFAULT 1 

UPDATE Status 
SET Status_Code = Status_ID 
"
35445,how to display a row that is null instead of 0,"SELECT w.FIRST_NAME,w.LAST_NAME,NULLIF(COUNT(s.SECTION_ID),0) AS COUNTED_SECTIONS
FROM INSTRUCTOR w LEFT OUTER JOIN SECTION s 
ON w.INSTRUCTOR_ID = s.INSTRUCTOR_ID
GROUP BY w.FIRST_NAME,w.LAST_NAME
ORDER BY w.LAST_NAME;
"
15068,A more efficient way to do this select and update loop,"UPDATE
    likes
INNER JOIN votes
    ON votes.votedElm = likes.id
    AND votes.country = likes.country
SET
    likes.votes = IF(votes.vote_type = 0,likes.votes+1,likes.votes-1),
    votes.voteProcessed = 1
WHERE
    votes.voteProcessed = 0
"
1066,Trouble converting from time to decimal time,"select datediff(second,
                cast('2000-01-01' as datetime),
                cast('2000-01-01 ' + '00:00:59' as datetime)
               )/3600.0 as DecimalHours
"
16982,How to get the objects from an oracle table of row objects,"declare
  plsql_table scd_type_table;
begin
  select VALUE(t) bulk collect into plsql_table from scd_table t;
  -- do stuff
end;
/
"
6393,Pass multiple parameters from stored procedure to crystal reports,"SELECT sum(case when Stat='1' then 1 else 0 end) as Counted, 
       sum(case when Stat='2' then 1 else 0 end) as Counted2 
from dbo.Batch
"
24033,Replace String in Oracle Procedure,"SELECT NAMA_AKUN, REPLACE(NAMA_AKUN, 'DOLLAR AMERICA', 'USD') AS NEW_NAMA_AKUN
  FROM MONDES_MSTR_CHART_OF_ACCOUNT
  WHERE INSTR(NAMA_AKUN, 'DOLLAR AMERICA') > 0;
"
31049,SQL query to exclude records if it matches an entry in another table (such as holiday dates),"SELECT apps.ApplicationName, apps.isavailable 
FROM dbo.Applications apps
WHERE apps.ApplicationName = @AppName
    AND NOT EXISTS 
( SELECT * 
  FROM Holidays 
  WHERE ApplicationId = apps.ApplicationId
     AND CONVERT(VARCHAR,getdate(),101) = CONVERT(VARCHAR,holidaydate,101)
)
"
28797,Is this an appropriate use of temptables?,"SELECT
    [Date],
    [Day of Week],
    [Hour],
    SUM(CASE WHEN TrxName = 'signon' AND Succeeded = 1 THEN 1 ELSE 0 END) AS [Login Success],
    SUM(CASE WHEN TrxName = 'signon' AND Succeeded = 0 THEN 1 ELSE 0 END) AS [Login Failure],
    SUM(CASE WHEN TrxName = 'signon' 1 ELSE 0 END) AS [Total Logins],
    COUNT(UniqueId) AS [Total Transactions]
FROM
    YourTable
GROUP BY
    [Date],
    [Day of Week],
    [Hour]
"
492,MySQL - SELECTing based on an IF-statement,"SELECT t.one,
       t.two,
       t.three,
       CASE WHEN 1 = 1 THEN t.four ELSE NULL END AS four
  FROM TABLE t
"
5231,Return NULL if no rows are found SQL,"Select  
    u.id,
    u.name,
    up.updown
From    
    user_table u left join updown_table up ON u.id=up.id;
"
37917,SQL Percentage Count Query By Date,"SELECT A.ADate, A.Val, COUNT(A.Val) / B.DateCount
FROM Table1 AS A
INNER JOIN (
    SELECT C.ADate, COUNT(*) AS DateCount
    FROM Table1 C
    GROUP BY C.ADate
) AS B ON A.ADate = B.ADate
GROUP BY A.ADate, A.Val, B.DateCount
"
2914,Multiple table joins with aggregate (mssql / sql server),"select a.*, b.sumb
from ta a left join
     (select b.uid, sum(b.amount) as sumb
      from tb b
      group by b.uid
     ) b
     on a.uid=b.uid
where a.year = 'value';
"
33548,Linq to Sql with the And operator on the same field,"var result = Orders.Where(o => o.OrderDetails.Any(od => od.ProductId == 11) 
                            && o.OrderDetails.Any(od => od.ProductId == 42));
"
17978,How to select only those rows which have more than one of given fields with values,"SELECT
   IF(`column1` != 0,1,0) +
   IF(`column2` != 0,1,0) +
   IF(`column3` != 0,1,0) +
   IF(`column4` != 0,1,0) AS `results_sum`
FROM `table`
HAVING
   `results_sum` > 1
"
13129,sql returning no rows selected,"select ur.uno, count(q.eno)*5
  from userresponse ur
       left outer join question q
         on(    ur.eno = q.eno 
            and q.correctanswer = ur.response 
            and q.qno = ur.qno 
            and q.eno = '1')
where ur.uno = '1' 
group by ur.uno
"
20044,Using basic joins in sequel,"Project.join(:users, :id=>:user_id).
 select(:projects.*).
 first(:users__name=>user_name, :projects__name=>project_name)
"
3140,Cross Join MySQL Query with Counts,"select t1.term as term1, t2.term as term2,
       count(distinct t1.usr_id) as num_users
from table t1 join
     table t2
     on t1.usr_id = t2.usr_id and t1.term <> t2.term
group by t1.term, t2.term;
"
13803,How can I achieve the following in oracle without creating a stored procedure?,"select employee_id,
       (phone_number || lead(phone_number) over (order by employee_id) )
from table t;
"
5387,PostgreSQL ORDER BY clause on numerical portion of text column,"SELECT * FROM mytable
ORDER BY right(id, -1)::integer;
"
4913,Delphi: using BigInts from a database,"SomeInt64Value := (qryMyQuery.FieldByName('blahblah') as TLargeIntField).AsLargeInt;
"
14372,MySQL. Working with Integer Data Interval,"first_stats_id INTEGER NOT NULL REFERENCES Stats(id)
last_stats_id  INTEGER NOT NULL REFERENCES Stats(id)
"
20186,Single Select SQL Statement for 2 different Values,"Select * 
From Table
Where Catg = @Catg OR @Catg IS NULL
"
4690,sql sort statement not working correctly,"SELECT country, COUNT(country) as total 
FROM user 
GROUP BY country 
order by total desc
"
36844,COUNT records in RANGE GROUP BY date,"SELECT saledate,
SUM(IIF(saletime >= 101 and saletime <= 159), 1, 0) as [101To159)
SUM(IIF(saletime >= 200 and saletime <= 259), 1, 0) as [200To259)
FROM myTable
GROUP BY saledate
"
31041,query and subquery on the same table,"select b.*
  from yourtable a
  left join
       yourtable b
    on (    a.Patient_ID = b.Patient_ID
        and a.DateOfService = b.DateOfService)
 where a.CPTCode = ""some value""
"
21415,Modify table: How to change 'Allow Nulls' attribute from not null to allow null,"-- replace NVARCHAR(42) with the actual type of your column
ALTER TABLE your_table
ALTER COLUMN your_column NVARCHAR(42) NULL
"
38417,How to order by two fields ? sql,"SELECT *
FROM MyTable
ORDER BY x DIV 10, y
"
21867,Merging two Schedule rows into one in SQL,"SELECT AcademicPeriod , BuildingNumber , RoomNumber , DayOfWeek
       MAX(930A) AS 930A,
       MAX(945A) AS 945A,
       MAX(1230P) AS 1230P,
       MAX(1245P) AS 1245P

  FROM {YourResultSet} 

 Group BY AcademicPeriod, 
          BuildingNumber, 
          RoomNumber, 
          DayOfWeek
"
4272,How to get the sentence number for each words in words table in SQL?,"select table.id, table.word, count(*) + 1 as serial_number
from table left join
( select id, word from table where word like '%.' ) Z 
on table.id > Z.id
group by table.id, table.word
"
14983,Insert into a table a part of another table,"INSERT INTO table1 (i, j, k, a, b, c, d, x, y ,z)
Select  @i, @j @k, a, b, c, d, @x, @y, @z
From    table2
Where   id = @id
"
3936,SQLite3 Order by list?,"select *
from apps
where id in (3, 5, 1)
order by (case id when 3 then 1
                  when 5 then 2
                  when 1 then 3
          end);
"
36405,sql select only specific fields and insert them in another table + static values,"INSERT INTO TableA(Field1, Field2, someOtherField, Field3) 
SELECT Field1, Field2, 'staticvalue', Field3
FROM TableB
WHERE TableB.Field6 = 'XYZ'
"
24263,How to Update a column of all duplicate records in mysql?,"UPDATE Qbank T1 JOIN 
  (SELECT Question FROM Qbank 
   GROUP BY Question HAVING count(ID) > 1) dup ON T1.Question = dup.Question 
SET T1.Repeated = 1
"
25339,SQL Concatenate 2 large TEXT rows from the datatype TEXT,"WITH cte1 AS
(
SELECT CAST('<XML></XML>' as text) as Result
UNION ALL
SELECT CAST('<XML AGAIN></XML AGAIN>' as text) as Result
), cte2 (XMLResult) AS
(
SELECT Result
FROM cte1
FOR XML PATH(''), TYPE
)

SELECT XMLResult.value('.','nvarchar(max)')
FROM cte2
"
26691,How do I fetch the count from MS Access tables using group by clause?,"SELECT      a.acountry
        ,   r.result_placing
        ,   sum(*) as cnt 
FROM        athletes        a 
RIGHT JOIN  result_placing  r 
ON          a.anumber       = r.anumber 
GROUP BY    a.acountry
        ,   r.result_placing 
ORDER BY    a.acountry
"
8468,Testing for existence of a column,"IF NOT EXISTS (SELECT * FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = tablename AND COLUMN_NAME = column)
"
35200,SQL: Select * where attribute matches all items in array,"SELECT photos.id,max(otherColumn)
FROM \""photos\"" 
INNER JOIN \""taggings\""
ON \""photos\"".\""id\"" = \""taggings\"".\""photo_id\"" 
INNER JOIN \""tags\"" 
ON \""tags\"".\""id\"" = \""taggings\"".\""tag_id\"" 
WHERE \""tags\"".\""name\"" IN ('foo', 'bar')
group by photos.id
having count(*) = 2 --2 is the number of items in your array of tags.
"
19932,SQL Query (or Join) for 3 tables,"select distinct m.name from students s
inner join mentor_ralationships mr on mr.student_id=s.student_id
inner join mentors m on m.mentoir_id=mr.mentor_id
where s.teacher_id=1;
"
31278,MySQL JOIN with results from single table,"SELECT a.* FROM tableA AS a etc
"
29117,Join multiple column with single row using mySql,"SELECT a.col_1,a.col_2,a.col_3, 
(SELECT b.col_2 FROM table2 AS b WHERE b.col_1=a.col_1 LIMIT 1) as col_4, 
(SELECT b.col_2 FROM table2 AS b WHERE b.col_1=a.col_1 LIMIT 1,1) as col_5 
FROM table1;
"
28108,"SQL join - Looking to search one table for keyword, two other tables","select
    c.company_name

from
    company c join company_states cs on c.companyID = cs.companyID
    join states s on cs.stateID = s.stateID

where
    c.company_name like '%associates%'
and
    s.stateID = 7
"
33728,Why is my query ignoring one of the WHERE clauses?,"select ASIN
from aboProducts
    left join lowestprices
        on aboProducts.asin = lowestprices.productAsin
        and lowestprices.pricedate > (GETDATE()-1)
where lowestprices.productAsin is null
and aboProducts.amzlive=1
"
33150,Update int column in table with incrementing value,"with cte as 
( select prodID, row_number() over (order by prodID) as rn 
  from table 
)
update cte set prodID = rn + 9
"
20058,Find Correctly Answered Questions in an Online Test with Single and Multi Choice Questions,"select
  count(*) - count(incorrect_answers_per_question) correct
from (
  select
    d.test_id,
    d.question_id,
    sum(case when r.correct_response_flag = 'N' then 1 end) incorrect_answers_per_question
  from test_response d
  join question_response r on d.response_id = r.question_resp_id
  where d.test_id = '10113'
  group by d.test_id, d.question_id
)
"
2251,Oracle pl/sql with variables: Creating Sequence with current date and host address,"DECLARE
  SQS number :=(sysdate - to_date('01-JANV.-1970','DD-MON-YYYY')) * (864000);
  sql_stmt varchar2(200);
BEGIN
  sql_stmt := 'create SEQUENCE XXXX_id_seq MINVALUE  100000 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH '||SQS||' CACHE 500 NOORDER CYCLE';
  EXECUTE IMMEDIATE sql_stmt ;
END;
"
9211,Beginner SQL Query Logic,"select distinct drinker
from likes l1
where not exists (
    select *
    from sells s
    where bar = 'Bobbys'
    and not exists (
       select *
       from likes l2 
       where s.beer = l2.beer
       and l2.drinker = l1.drinker
    )
);
"
16312,Tool for importing CSV files into MySQL database?,"LOAD DATA INFILE 'data.txt' INTO TABLE tbl_name
 FIELDS TERMINATED BY ',' ENCLOSED BY '""'
 LINES TERMINATED BY '\r\n'
 IGNORE 1 LINES;
"
21262,How to add values together inside of an object vb.net and itextsharp,"Debug.WriteLine(CStr(CDec(""5"") + CDec(""5"")))
"
15219,"How can I update a ""rank"" column's values based on the values of another column?","UPDATE goals_scored SET goalRank = (
  SELECT count(*) FROM goals_scored AS i WHERE 
    i.numGoalsScored > goals_scored.numGoalsScored AND
    i.gender = goals_scored.gender
) + 1;
"
24747,Using the value of an alias inside the same sql statement,"select @t:=now() as t, concat('Hello: ', username, @t) from t;
"
8853,How to serialize (to comma separated list) SQL rows,"SELECT ID, Name, Properties = STUFF((
    SELECT ',' + PropertyName FROM dbo.Properties
    WHERE ID = x.ID
    FOR XML PATH(''), TYPE).value('.[1]', 'nvarchar(max)'), 1, 1, '')
FROM dbo.ViewName AS x
GROUP BY ID, Name;
"
21823,Avoid CASE clause while importing data to SQL Server,"INSERT into new_Users 
SELECT Users.Name, careers.id
FROM Users inner join careers ON Users.career_name = careers.career_name
"
27283,What sql call should I use to get 10 newest entries in a table by a datetime type?,"SELECT * FROM your_table_name
ORDER BY time_played DESC
LIMIT 10
"
33850,Postgresql - return results if field value exists in another table,"SELECT statement_id, statement_value
FROM statement_bank sr
WHERE category_id=6 AND level=7 and
      exists (select 1
              from statement_record sr
              where sr.user_id = sb.user_id and
                    sr.statement_id = sb.statement_id and
                    sr.date between '2013-01-01' and '2013-12-31'
             );
"
30304,SQL Server join using multiple columns,"SELECT DISTINCT
    COALESCE(One1.A, One2.A, One3.A) AS A,
    D
FROM
    Two
    LEFT JOIN One AS One1 ON
        Two.C = One1.C1
    LEFT JOIN One AS One2 ON
        Two.C = One2.C2
    LEFT JOIN One AS One3 ON
        Two.C = One3.C3;
"
21308,"sql: selecting rows, in which some values are equal (not all)","SELECT t1.id, t1.value1, t1.value2
FROM mytable AS t1
INNER JOIN mytable AS t2 
ON t1.id <> t2.id AND t1.value1 = t2.value1 AND t1.value2 = t2.value2
"
8095,Google App Engine: Model integrity constraints?,"def range_validator(minval, maxval):
  def validator(v):
    if (minval is not None and v < minval) or (maxval is not None and v > maxval):
      raise ValueError(""Value %s outside range (%s, %s)"" % (v, minval, maxval))
  return validator

class Item(db.Model):
    CSIN = db.IntegerProperty()
    name = db.StringProperty()
    price = db.IntegerProperty()
    quantity = db.IntegerProperty(validator=range_validator(0, None))
"
8480,SQL query on 3 tables with one to many relationships,"SELECT U.UserID, COUNT(O.OrderID) OrderCount
FROM Users U INNER JOIN Orders O ON U.UserID = O.UserID
             INNER JOIN Line-Items L ON O.OrderID = L.OrderID
Where L.manufacturer = 'X-Parts'
Group BY U.UserID
Having count(O.orderID) >= 1
"
8146,Oracle parameter to a inner query,"SELECT * FROM Pro u 
LEFT JOIN (SELECT * FROM PROLOG d
WHERE d.Id = (SELECT MAX(Id) FROM PROLOG t
          WHERE t.Project = d.Project 
          AND t.Prodstatus IN    (5,40)))z ON (u.ID = z.Project)
WHERE u.Id = 22;
"
5528,Batch commit on large INSERT operation in native SQL?,"create cursor ....
select YEAR(DateCol), MONTH(DateCol) from whatever

while ....
    insert into yourtable(...)
    select * from whatever 
    where YEAR(DateCol) = year and MONTH(DateCol) = month
end
"
15617,Sum and subtraction to a single column,"SUM(CASE 
    WHEN p.batchtype IN ('PU','PA') THEN p.totalpaid 
    WHEN p.batchtype IN ('PUR','PAR') THEN -p.totalpaid 
    ELSE 0 
END) as TotalPaid
"
26486,Firebird search and find a string value in all columns,"sqlCommand = 'select * from '|| upper( :TBLNAME );

/* Rest of your code for creating the sqlCommand variable */

viewCommand = ""RECREATE VIEW V_SEARCH_RESULTS AS "" || sqlCommand;

EXECUTE STATEMENT viewCommand;
"
33561,Getting offset of datetimeoffset in SQL Server,"datepart(tz,@datetimeoffset)
"
32635,Left Outer Join with CONDITIONAL,"SELECT id
FROM DEVICE d LEFT OUTER JOIN
     USER_DEVICE ud
     ON d.id = ud.device_id and
        ud.user_id = 1
WHERE ud.device_id IS null;
"
19298,How to base on the counted values and separately insert the records with using SQL?,"SELECT ID,1
FROM YOURTABLE
CONNECT BY LEVEL <= COUNT1
   AND PRIOR id = id
   AND PRIOR sys_guid() IS NOT NULL; 
"
8206,Order by Month in SQL server 2008,"  ... Order By (Month(somedate) + 8) % 12
"
10466,how to use string with apostorphy sign in android database,"String name_search=edittext.getText().toString();
String query = ""select NAME from Category where NAME= ?"";
Cursor c=DB.rawQuery(query, new String[] { name_search});
"
964,Best way to add and populate new column with data from second table,"alter table A add CONTACT_NAME VARCHAR2(50);

update A 
set contact_name = (select value from B where B.invoice_id = A.invoice_id);
"
37637,easier way to select row matching condition having maximum for a certain column,"SELECT ID, NAME, rn
  FROM (SELECT id, NAME, rank() over(ORDER BY LVL DESC) rn 
          FROM my_table 
         WHERE NAME LIKE 'A%')
 WHERE rn = 1
"
14872,Counting records with a specific date value,"ALTER PROCEDURE [dbo].[SP_GET_QUEUESINFO_BY_DATE]
AS
BEGIN
declare @date2 datetime
set @date2= '2012-09-21'
select COUNT(QueueID) ,
sum(case when QueueNumIn != 0 THEN 1 else 0 end) as 'InQueue',
sum(case when QueueNumOut != 0 THEN 1 else 0 end) as  'OutQueue'
from Queue where QueueDate >= @date2
END
"
886,report builder - queries returning incorrect results,"WITH tmp as
(
 SELECT clientId, searchTerm, COUNT(1) as TermResults,
   DENSE_RANK() OVER (partition by clientId
    ORDER BY clientId, COUNT(1) DESC) as rnk
 FROM TFeed
 WHERE dateadded > GETDATE() - 10 
 GROUP BY clientId, searchterm 
)
SELECT *
FROM   tmp
WHERE rnk < 11
"
17801,SQL search for words beginning with A-L,"where left(name, 1) between 'A' and 'L'
"
3660,Between a MIN and MAX date in joined table,"SELECT
    CASE isPrivateClient
        WHEN 0 THEN ""business""
        WHEN 1 THEN ""private""
    END AS clientType,
    count(FacilityBooking.id) as count
FROM
    Booking INNER JOIN FacilityBooking ON
    Booking.id = FacilityBooking.booking_id
-- Between 2015-05-01 AND 2015-06-01 INCLUSSIVE'
WHERE FacilityBooking.from <= '2015-06-01' AND FacilityBooking.to >= '2015-05-01'
GROUP BY
    isPrivateClient
"
28710,Losing data when joining two tables in mysql?,"SELECT locations.id as loc_id, meets.id as meets_id, ... FROM meets LEFT JOIN locations ON locations.id=meets.loc ORDER BY date DESC
"
643,Combing two queries while using group by,"SELECT cId, crId, 
SUM(CASE WHEN EventType='0' OR EventType='0p' OR EventType='n' OR EventType = 'np' THEN 1 ELSE 0 END) AS Count_1,
SUM(CASE WHEN EventType='c' THEN 1 ELSE 0 END) AS Count_2
FROM Data
WHERE EventType IN ('0','0p','n','np','c')
GROUP BY crId;
"
15037,Updating parent table from referencing child,"DELIMITER $$
CREATE TRIGGER update_time_taskdata 
AFTER UPDATE ON Sub_task_data FOR EACH ROW 
BEGIN 
    UPDATE Task_data
       SET updated_on = NOW()
     WHERE id = NEW.task_data_id;
END;
$$
DELIMITER ;
"
20021,MySQL many-to-many intersection using a single query,"SELECT
    DISTINCT(m1.ID_PERSON)
FROM
    Meetings m1, Meetings m2
WHERE
    m1.ID_EMPLOYEE=:Employee2
AND
    m2.ID_EMPLOYEE=:Employee1
AND
    m1.ID_PERSON = m2.ID_PERSON
"
4633,MySQL: How can I remove trailing HTML from a field in the database?,"UPDATE mytable
   SET myattachment = SUBSTRING_INDEX(myattachment, '<', 1) 
 WHERE `myattachment` LIKE '%<%';
"
34033,ms access select into with fixed value for one field,"SELECT sourceNum, 'solid' AS type INTO NewTable 
FROM sourceTable
"
15262,"In a SQL Server view, get the ""AS"" info for the columns in the view","SELECT OBJECT_DEFINITION (OBJECT_ID('yourSchema.yourViewGoesHere')) AS ObjectDefinition; 
"
35570,MySQL join two columns on a single column,"SELECT  a.ID,
        a.bill_no,
        a.container_type,
        b.port_name AS Origin_name,
        c.port_name AS Destination_name
FROM    user_tracking a
        INNER JOIN sea_ports b
            ON a.origin_id = b.id
        INNER JOIN sea_ports c
            ON a.destination_id = c.id
WHERE   a.bill_number = '$bill_no'
"
10943,How to get all the rows that have multiple values,"(select * from Service 
where cusId='$cusId' 
and serviceType = 1 
order by date desc limit 1)

UNION

(select * from Service 
where cusId='$cusId' 
and serviceType = 2 
order by date desc limit 1)
"
1631,How to find missing alpha values in sets of data within same table in SQL,"SELECT DISTINCT M1.WONumber
FROM Mytable M1
WHERE
    NOT EXISTS (SELECT 1/0 --or NULL, 1, *, 'bob'. All the same
                  FROM Mytable M2
                  WHERE M2.ResourceID = 'RW' AND M1.WONumber = M2.WONumber)
"
22640,Can/how would you make a database where two items have multiple relations between them,"-- Query all chefs who like a particular sandwich
SELECT * FROM tblSandwichPreference
JOIN tblChef ON tblChef.Cid = tblSandwichPreference.Cid
WHERE tblSandwichPreference.SandwichName = @SandwichName

-- Query all sandwiches preferred by a particular chef
SELECT * FROM tblSandwichPreference
JOIN tblSandwich ON tblSandwich.Name = tblSandwichPreference.SandwichName
WHERE tblSandwichPreference.Cid = @ChefID
"
6672,using regex to find same digit phone numbers,"select *
from tblPhone
where 
substring(replace(PhoneNo,'+',''),1,len(replace(PhoneNo,'+',''))-1) 
= substring(replace(PhoneNo,'+',''),2,len(replace(PhoneNo,'+','')))
"
33612,SQL Query to calculate the difference of a number of fields and passing to ASP script,"SELECT MAX(RemainingCapacityBytes) - MIN(RemainingCapacityBytes) DiffCapacityBytes
   FROM [Check].[dbo].[tbl_BackupChecks_MediaInfo]   
 WHERE Company = 'Company Name' and ModifiedDateTime >= dateadd(d,-7,GETDATE()) 
"
39341,When #tmp table is null ignore where,"select * from foo
where (foo_id in (select my_id from #tmp) or not exists(select * from #tmp))
and (foo_name_id in (select my_name_id from #tmp2) or not exists(select * from #tmp2))
"
21875,Simply by the Query,"WITH q AS(
  SELECT *
  FROM Table1
  WHERE name IN ('AA','AC')
)
SELECT * FROM q
UNION ALL
SELECT * FROM Table1 t
WHERE t.undergroupno IN (
       SELECT groupno FROM q
)
"
19856,SQL simplification possible?,"SELECT p.npro, p.libelle
FROM produit p
JOIN detail d
  ON p.npro = d.npro
JOIN commande c
  ON d.ncom = c.ncom
JOIN client cl
  ON cl.ncli = c.ncli
WHERE p.libelle LIKE '%SAPIN%'
GROUP BY p.npro, p.libelle
HAVING COUNT(CASE WHEN cl.localite = 'Toulouse' THEN 1 END) > 0
   AND COUNT(CASE WHEN cl.localite <> 'Toulouse' THEN 1 END) = 0
"
4307,Oracle group/count query,"with t2 as (
    select  ColA2, ColB2, count(*) cnt 
    from TableTwo
    group by ColA2, ColB2 
)
select t1.Id1,
(  select max(cnt) MaxDup
   from t2
   where t2.ColA2=t1.Id1)
from TableOne t1
"
6319,Picking timeseries from SQL database in source priority order,"select timestamp,
       datapoint
from (select t.*,
             min(data_source) over (partition by timestamp) as minDataSource
      from t
     ) t
where data_source = minDataSource
"
29051,one sql instead of 2 for counting,"Select 
SUM(case when substr(id,1, 1) in (1,2) then 1 else 0 end) as M, 
SUM(case when substr(id,1, 1) in (3,4) then 1 else 0 end) as F 
from users where activated=1
"
12787,How to get expression from string,"SUBSTRING(
  yourString,
    LEN(yourString)
  - CHARINDEX('(', REVERSE(yourString), LEN(yourString) - CHARINDEX('/', yourString) + 2)
  + 1,
    CHARINDEX(')', yourString, CHARINDEX('/', yourString) + 1)
  - LEN(yourString)
  + CHARINDEX('(', REVERSE(yourString), LEN(yourString) - CHARINDEX('/', yourString) + 2)
  - 1
)
"
37929,Django Complex MySQL Query From PHP with Multiple Joins to Django ORM,"glasses = Code.objects.filter(glass__collection__item__discontinued=False)\
        .values('id', 'description')\
        .annotate(count=Count('glass__collection__item__id', distinct=True))
"
16083,mysql select unique users in table and count them multiple times based on a column,"SELECT vid, count(distinct(IP)) AS dstn from test
"
34647,SQL Server 2012: Select Top n based on multiple criteria,"select region, month, MemberId, sales
from (select region, month, MemberId, sum(sales) as sales
             row_number() over (partition by region, month order by sum(sales) desc) as seqnum
      from table t
      group by region, month, MemberId
     ) t
where seqnum <= 2;
"
3154,How to calculate an average in SQL excluding zeroes?,"SELECT AVG(Column1) FROM Table1 WHERE Column1 <> 0
"
11213,Inexact searching for nearest time value,"SELECT id, MIN(ABS(time(time) - time(""4:04:35""))) FROM table
"
37362,SQL ON JOIN LIKE (% before last 3 characters),"Left OUTER JOIN TableB ON trunc(TableA.ID, -4) = trunc(TableB.IDNumber, -4)
"
2354,Deleting a table in Oracle with WHERE condition in other tables,"delete from A
where ROWID in 
    (select A.ROWID
     from A,B
     where A.A1 = B.B1
     and A.A2 = concat(B.B2, B.B3, B.B4)
    )
"
13408,What can I do to make this SQL return results in certain situations?," AND (MATCH( T.truck_number, T.make, T.model, T.engine, T.vin_number,
      T.transmission_number, T.comments) AGAINST( '$vehicle' )
     OR MATCH( P.part_num, P.part_desc, P.part_ref,M.comments, M.work_done) 
     AGAINST( '$keywords' ))
"
25052,fetch most recent non null record,";WITH CTE AS
(
    SELECT *, ROW_NUMBER() OVER(PARTITION BY SIG_ID 
                                ORDER BY CASE WHEN DCRP IS NOT NULL THEN 0 ELSE 1 END,
                                DD DESC) RN
    FROM tbl
)
SELECT *
FROM CTE 
WHERE RN = 1
"
30199,Including multiple columns in a single index in Postgres,"CREATE FUNCTION no_dups_allowed() RETURNS trigger AS $$
DECLARE
    r ROW;
BEGIN
    SELECT 1 INTO r
    FROM users
    WHERE LOWER(email)     = LOWER(NEW.email_new)
       OR LOWER(email_new) = LOWER(NEW.email);
    IF FOUND THEN
        -- Found a duplicate so it is time for a hissy fit!
        RAISE 'Duplicate email address found' USING ERRCODE = 'unique_violation';
    END;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;
"
6728,"tricky select query, need assistance","SELECT RoleID
FROM RoleUser
GROUP BY RoleID
HAVING COUNT(UserID) <= 10
"
21533,SQL Subquery: SELECT in SELECT clause. Query the same column three times with three different conditions,"SELECT WLL17.Location, 
    SUM(case when WLL17.EE = ""Post Gate 60 (PV)"" then CC.HR1*WLL17.Hours else null end) AS Plant,         
    SUM(case when WLL17.CC<>""Outsourced Costs""  then CC.HR1*WLL17.Hours else null end) AS Location_Name1,
    SUM(case when [Write condition here] then CC.HR1*WLL17.Hours else null end) AS Location_Name2
FROM WLL17 INNER JOIN CC ON WLL17.CC = CC.CC
GROUP BY WLL17.Location;
"
18643,group by column not having specific value,"SELECT DISTINCT Case_Id
FROM   [dbo].[caseRole] cr
WHERE  NOT EXISTS (SELECT *
                   FROM   [dbo].[caseRole] cr_inner
                   WHERE  cr_inner.Case_Id = cr.case_id 
                          AND cr_inner.RoleId = 4);
"
15966,SQL query: select all where if x=1 then y<z else if x=2 then y<w,"SELECT * 
FROM   EntitlementEpisode
WHERE
   (EnFuel=1 AND EnEpisodeStart] > 
                (SELECT TOP 1 [BeYearStart] 
                FROM [BenefitYear] ORDER BY [BeId] desc))

   OR

   (EnFuel=0 AND [EnEpisodeStart] > 
                  CONVERT(VARCHAR(30), '1 OCT' + YEAR(GETDATE())))
"
28558,Oracle: What is the data type of ORA_ROWSCN?,"create table foo (
   col1 number
);

create view vw_foo
as
select col1, ora_rowscn scn
  from foo;

select * 
  from user_tab_cols 
 where table_name = 'VW_FOO';
"
15567,SQL Server - how to combine query and subquery results in a single node in a FOR XML PATH T-SQL query,"  SELECT (
    SELECT
      [customer]
     ,( SELECT
          [id] AS [@id],
          [Item] AS [data()]
        FROM @OrderDetail od
        WHERE od.fk_Order = ot.id
        FOR XML PATH('d'),TYPE
      )
    FROM @OrderTbl ot
    FOR XML PATH('c'),TYPE
  ) FOR XML PATH('b'), ROOT('a')
"
16115,"Where is ""Status Update History"" in Database","Status History related information are available in MSP_ASSIGNMENT_TRANSACTIONS table however Status Flag can be check by comparing WPROJ_LAST_PUB and ASSN_TRANS_SUBMIT_DATE fields.
"
7089,Comparing counts in a SQL where clause,"select numreported, count(*), min(user_id), max(user_id)
from (select p.user_id, sum(p.reported = 1) as numreported
      from photos p
      group by p.user_id
     ) p
group by numreported
order by numreported;
"
27244,Counting Items/Rows in DB as Columns Grouped by Another Column,"SELECT TYPE
      ,SUM(CASE WHEN MyDate = '' THEN 1 ELSE 0 END) AS [10/1]
      ,SUM(CASE WHEN MyDate = '' THEN 1 ELSE 0 END) AS [10/2]
FROM MyTable
GROUP BY TYPE
"
6651,MySQL fields from diferent rows to one string,"SELECT  ID, 
        GROUP_CONCAT(name ORDER BY sort ASC) ConcName
FROM    tableName
GROUP   BY ID
"
10208,Value before variable,"WHERE CCY = 'USD' 
"
38462,ORDER BY before GROUP BY,"    SELECT * FROM
    (SELECT * FROM post ORDER BY datotime DESC) as inv
    WHERE fk_user_to = '$userid'
    GROUP BY fk_user_from
    ORDER BY datotime DESC
"
19402,Performance optimisation for - MS SQL Delete query with NOT IN caluse,"ALTER TABLE table1 ADD INDEX (fk_id);
"
28796,Using WHERE clause to only retrieve results where array field has only ONE element inside,"SELECT *
FROM   attr_lookup
WHERE  array_length(target_tcode, 1) = 1;
"
10414,Merging unused timeslots,"select 
    StaffId,
    BranchId,
    MIN(StartTime),
    MAX(EndTime),
    PatientId
from
(
select *,       
    ROW_NUMBER() over (order by starttime) 
      - ROW_NUMBER() over (partition by isnull(PatientID,-1) order by starttime) rn     
from @results
) v
group by staffid, branchid, patientid, rn
order by MIN (starttime)
"
13804,Sql Script to find similar user records,";WITH CTE1 AS
(
    SELECT DISTINCT * FROM YOURTABLE
)
,CTE2 AS
(
   SELECT *, COUNT(*) OVER(PARTITION BY FirstName,LastName) CNT
   FROM CTE1
)
SELECT FirstName,LastName,userId
FROM CTE2 
WHERE CNT>1
"
8233,Prevent slow INNER JOIN in Django model calls when unnecessary,"class Book(models.Model):

    (...)

    class Meta:
        ordering = ['author', 'title']
"
39969,Selecting two rows from the same table,"INNER JOIN t_people people1 ON people1.id = m_table.red_id
INNER JOIN t_people people2 ON people2.id = m_table.blue_id
"
14405,"SQL 'Order By' Clause Appears to Work, but Returns Unsorted Data","select t.*
from dbo.tblfunc() t
order by t.date_received desc;
"
37752,Import and automatically update table from external website to sql,"from bs4 import BeautifulSoup as soup
 table = soup.find(id=""top-player-stats-summary-grid"")
"
680,Show MAX value with a join,"SELECT p.playername, s1.totalscore , s1.car, s1.track
FROM player p
INNER JOIN 
score s1 on p.id = s1.player_id
WHERE s1.totalscore = ( SELECT MAX(totalscore) FROM score s2 WHERE s2.player_id=s1.player_id)
ORDER BY s1.totalscore DESC
LIMIT 10
"
3924,Display all tables created after a particular date,"SELECT object_name, owner, created
FROM all_objects
WHERE object_type = 'TABLE' 
AND created >= TO_DATE('20120901', 'YYYYMMDD')
"
5382,SQL Server: set NULL value to today's value,"/*Deal with any existing NULLs*/
UPDATE YourTable SET EntryDate=GETDATE() WHERE EntryDate IS NULL

/*Disallow NULLs*/
ALTER TABLE YourTable ALTER COLUMN EntryDate DATE NOT NULL

/*Add default constraint*/
ALTER TABLE YourTable ADD CONSTRAINT
    DF_YourTable_EntryDate DEFAULT GETDATE() FOR EntryDate
"
29175,How to get combined output from two or more than two queries?,"select count(*) as someColumnName  from ABC where COLA=123
union
select count(*) from ABC WHERE COLA=321;
"
24308,"About randomly selecting some rows from a table, then taking the average","CREATE TABLE output (Selection INT, Avg_Height FLOAT)
GO
DECLARE @intFlag INT
SET @intFlag = 1
WHILE (@intFlag <=5)
BEGIN

    WITH cte AS (SELECT TOP 4 *
                 FROM Table1
                 ORDER BY NEWID())
    INSERT INTO output
    SELECT @intFlag, AVG(Height*1.0)
    FROM cte

SET @intFlag = @intFlag + 1
END
GO
"
21993,Union two select statements with different value in two columns,"SELECT ID, MAX(SURNAME) as SURNAME, MAX(FIRSTNAME) as FIRSTNAME
FROM (SELECT '1' AS ID , 'JOHN' AS SURNAME, NULL AS FIRSTNAME
      UNION ALL
      SELECT '1' AS ID,  NULL AS SURNAME, 'BLOGGS' AS FIRSTNAME
     ) t
GROUP BY ID;
"
18343,How do I order query results by an associated model field with conditions?,"SELECT *
        FROM keywords
        AS Keyword
        LEFT JOIN (SELECT keyword_id,count(*) AS click_count FROM clicks GROUP BY keyword_id)
        AS Click
        ON Keyword.id = Click.keyword_id
        WHERE Keyword.word_count > "".$keyword['Keyword']['word_count'].""
        AND UPPER(Keyword.keyword) LIKE '%"".strtoupper($keyword['Keyword']['keyword']).""%'
        ORDER BY Click.click_count DESC
"
32729,Select records from another table between result set dates,"select oe.OBJECT_ID, oe.EVENT_DATE, oe.EVENT_TYPE
from OBJ_EVENTS oe inner join
( *result set query here*) rs
on oe.OBJECT_ID = rs.OBJECT_ID and
  oe.EVENT_DATE between rs.START_DT and rs.END_DT;
"
7063,paginate while retrieving data cakephp with condition,"$this->paginate = array(
    'conditions' => array('Banner.customer_id' => $loggedUserId),
    'limit' => 20,
    'order' => array('id' => 'DESC'),
     );
"
25068,PostgreSQL select max from rows,"select distinct on (product_id) o.*
from offers o
order by product_id, amount desc;
"
3456,SQL Joins not giving correct sql output,"SELECT a.deptName, b.taskName, c.T1, c.T2,  c.Tn 
FROM Department a
INNER JOIN DepartmentTask b
ON a.deptID = b.deptID
INNER JOIN DepartmentTaskInMajorTask c
ON b.taskCode = c.taskCode
"
6316,Outer Join with 3 tables using SQL,"SELECT longitue, latitude, name from
UserEntry
FULL OUTER JOIN TwTbl
ON TwTbl.user_id = UserEntry.id
FULL OUTER JOIN Geo
ON Geo.id = twtbl.geo_count
"
31290,Show blank row for 'unfound' data details,"SELECT
    p.UPRN,
    COALESCE(a.UPRN,'Not Found') AS Column3
FROM TblProperty AS p
LEFT JOIN TblAssociatedData AS a
    ON a.UPRN = p.UPRN
WHERE p.UPRN LIKE '%99%'
"
6410,"In SQL Server, how to filter lots of elements across multiple columns","select t1.*
from t1
where not exists (select 1
                  from t2
                  where t2.code = t1.code1 or
                        t2.code = t1.code2 or
                        . . .
                        t2.code = t1.code20
                 );
"
30288,Entity Framkework 'like' statement query,"context.Table.Where(k => k.TURKCE_ADI.ToLower().Contains(""lpg"")).ToList();
"
30191,"How to compare a double value to a decimal from database and if they are alike, then return true","SELECT ROUND(myValue, 5) 
FROM myTable
"
9067,Microsoft Access: Adding items in a grouped query?,"SELECT FirstName, LastName, Description, SUM(CheckAmt) As 'Sum of Payment Types'
FROM MyTable
GROUP BY FirstName, LastName, Description
"
606,Non blank cell count for a particular row in dynamic colums in ssrs with matrix,"SUM(IIF(IsNothing(Fields!Comment.Value) OR (Fields!Comment.Value = """"),0,1))
"
18396,Getting a Dynamically-Generated Pivot-Table into a Temp Table,"-- add 'loopback' linkedserver 
if exists (select * from master..sysservers where srvname = 'loopback')
    exec sp_dropserver 'loopback'
go
exec sp_addlinkedserver @server = N'loopback',
    @srvproduct = N'',
    @provider = N'SQLOLEDB', 
    @datasrc = @@servername
go

declare @myDynamicSQL varchar(max)
select @myDynamicSQL = 'exec sp_who'
exec('
    select * into #t from openquery(loopback, ''' + @myDynamicSQL + ''');
    select * from #t
    ')
"
5405,Generate test data using Oracle PL/SQL developer,"insert into emp(id, name, salary)
select rownum, 'Employee ' || to_char(rownum), dbms_random.value(2, 9) * 1000
from dual
connect by level <= 100;
"
4073,SQL to update the salary of employees with their department's average salary,"UPDATE EMPLOYEE A
SET SAL = (SELECT AVG(SAL) FROM EMPLOYEE B WHERE B.DEPTNO = A.DEPTNO);
"
23452,SQLite: Autoincrementing an Id to increase by 2,"INSERT INTO MyTable(ID, Name, Number)
VALUES((SELECT MAX(ID) + 2 FROM MyTable),
       'me', 42);
"
3965,select statement over multiple columns in SQLite,"sqlite> select issue,url,steps from help where kw1='ie' or kw2='ie' or kw3='ie' or kw4='ie' or kw5='ie' or kw6='ie' or kw7='ie' or kw8='ie' or kw9='ie' or kw10='ie' or kw11='ie' or kw12='ie';
"
18572,Working with a table in a DB2 User Defined Function,"WITH T1 AS (SELECT word
            FROM TABLE(tokenize(STRING1, ' ')))
SELECT COUNT(*) / (SELECT COUNT(*) FROM T1) AS score
FROM (SELECT word
      FROM T1
      INTERSECT ALL
      SELECT word
      FROM TABLE(tokenize(STRING2, ' '))
)
"
22780,"create a table named ""select"" in SQL databases","CREATE TABLE ""SELECT"" ...
"
17644,SQL: generate incrementing integer based on value of another column,"insert into target
select
   ForeignID
  ,row_number()
   over (partition by ForeignID order by Detail) 
  ,Detail 
from source
"
37546,How to get the rows that is in the same week?,"select 
    trunc(date_column,'D') as start_date, 
    trunc(date_column,'D')+6 end_date, 
    count(*)
from your_table
group by trunc(date_column,'D')
"
30334,SQL Trim after final semi colon,"SELECT  MAX(RIGHT(
         E.EVENT_DESC
        ,LENGTH(E.EVENT_DESC) - LOCATE_IN_STRING(E.EVENT_DESC,';',-1)))
FROM    IASDB.EVENT E 
WHERE   SL.INVOICE_NO = E.INVOICE_NO 
AND     E.EVENT_CODE IN 'EDL'
"
894,SQL skip or ignore a specific cells,"SELECT NULLIF(Column1, 999999999), 
       NULLIF(Column2, 999999999), 
       NULLIF(Column3, 999999999)
FROM Table
"
25386,condition in where clause with optional parameter,"where
(@FromDate is null or ([Created] between @FromDate and @ToDate)) 
or
((@requestId is null or Id=@requestId) 
    and @FromDate is null) ----mix @requestId & @FromDate
"
22856,Convert searched case to simple case else,"SELECT * 
FROM weeks 
WHERE wenumber = CASE WHEN wet > 1000 THEN 1
                      WHEN wet BETWEEN 500 AND 1000 THEN 2
                      WHEN wet BETWEEN 100 AND 500 THEN 3
                      ELSE 22
                 END;
"
33767,How to reduce SQL queries in only one in this case,"select t.txt, count(t.age) from 
(select 
  case 
      when age<11 then concat(age ,' year') 
      else 'more than 10' 
  end txt, age
from your_table)t
group by t.txt
order by 1
"
26098,How can I delete records from two tables that share related information?," DELETE ul, ui
 FROM User_List ul
 LEFT JOIN User_Items ui ON ul.user_id = ui.user_list_id
 WHERE ul.user_id = 1
"
19555,Command Prompt: Check whether windows service is started or not,"start /wait sc start <name-of-your-oracle-service>
"
39942,SQL join within same table,"  select GUID, KeyInfo, Message from MyTable where GUID 
IN(SELECT GUID from MyTable Where KeyInfo = 'Test-1')
"
32150,Bulk user delete with same email,"DELETE FROM users    
WHERE email LIKE '%trash-mail.com'
"
25016,extract data in mysql from the string,"select left(val, instr(val, '&')-1) 
from (
  select substring(col,instr(col, 'pfid=')+5,length(col)) val
  from yourtable
  ) t
"
18804,SQL where particular column values appears,"SELECT id,type
FROM t
GROUP BY id 
HAVING SUM(type=0)>0
AND SUM(type=1)>0
"
28416,using NOT IN for multiple tables,"Select count (VisitorID)

from Company C
where
NOT EXISTS (select * from UserLog U where ActionID = 2 AND C.VisitorID  = U.VisitorID)
AND
NOT EXISTS (select * from Supplies S where productID = 4 AND S.VisitorID  = U.VisitorID)
"
19588,"Difference in two SQL query, but same result","SELECT  ename, deptno, sal, comm
FROM    emp
WHERE   (sal, comm) IN
(SELECT sal, comm FROM emp WHERE deptno = 30)
"
32102,Random numbers from database,"SELECT TOP 500
    CONVERT(INT, CONVERT(VARBINARY(16), NEWID()))
FROM
    dbo.MyTable
"
3636,Oracle SQL: Trying to exclude rows based on a combination of column values,"select *
from table t left outer join
     (select id
      from table t
      group by t
      having sum(case when comment = 'apple' then 1 else 0 end) > 0 and
             sum(case when comment = 'orange' then 1 else 0 end) > 0
     ) toexclude
     on t.id = toexclude.id
where toexclude.id is null;
"
24495,SQL Query to find which group does not have a given value,"select distinct value
from tbl1
where value not in
(
    select distinct value
    from tbl1
    where nbr = 6
)
"
24488,Select all the countries that have a minimum number of clients,"select *
from
 (
      select s.codeCountry, count(*) as cnt, 
         rank() over (order by count(*)) as rnk -- rank based on increasing counts
      from countries s join
           client t
           on s.codeCountry = t.privat_code_country 
      group by s.codeCountry
 ) dt 
where rnk = 1
"
35004,Copy field data from one table to another where matching id fields,"UPDATE Clients 
       INNER JOIN Quotes 
          ON Quotes.EnqNo = Clients.EnqNo
SET    Clients.Project = Quotes.Project
"
26268,What is POPULAR today when it comes to write SQL Queries: UPPER CASE or Lower Case?,"SELECT 
    M.Column1,
    CAST(O.Column2 AS int) AS IntColumn
FROM
    MyTable M
    JOIN
    OtherTable O ON M.SomeKey = O.SomeKey 
WHERE
    M.Column3 = 'bar'
ORDER BY
    M.Column1
"
34832,how to use like query to search a column value with % in it?,"SELECT `values`
FROM names
WHERE `values` LIKE '\%%'
"
10162,Android SQL Database returns null a String field with data that is really large,"TwitterObjectFactory.getRawJSON(status);
"
4237,why are my MySQL Left Join query results mixed up?,"AND FIND_IN_SET(p.brand_name, a.application_match_keys) <> 0
"
38974,Confusing regex behavior when combining ` with (,"%s/KEY \(`.*`\) \((.*)\) USING BTREE/KEY \1 USING BTREE \2/gc
"
34321,pivoting from comma delimited column value in sql server,"select id,
       (len(ans) - len(replace(ans, 'a', ''))) as a,
       (len(ans) - len(replace(ans, 'b', ''))) as b,
       (len(ans) - len(replace(ans, 'c', ''))) as c,
       (len(ans) - len(replace(ans, 'd', ''))) as d,
       (len(ans) - len(replace(ans, 'e', ''))) as e
from answers;
"
24693,insert by selecting values from two columns into a column from the same table,"INSERT INTO table1 (username)
SELECT CONCAT(COALESCE(prefix, 'AB'), LPAD(COALESCE(MAX(id), 0) + 1, 3, '0'))
  FROM table1
"
11752,sort on two parameters,"  SELECT userID, max(checkin_date), count(*) as nbVisit,
  FROM checkin_table
  WHERE checkin_date > '2014-01-25' 
  GROUP BY userId
  ORDER BY nbVisit desc
  LIMIT 10 ;
"
2744,SQL multiple Select ... where id in and a DISTINCT,"SELECT DISTINCT TP_Test_Info.id, TP_Test_Info.name
FROM TP_Test_Info
JOIN TP_Test_Sections 
  ON TP_Test_Sections.test_id = TP_Test_Info.id
JOIN TP_Test_Questions 
  ON TP_Test_Questions.section_id = TP_Test_Sections.id
JOIN TP_Student_Answers 
  ON TP_Student_Answers.question_id = TP_Test_Questions.id
WHERE TP_Student_Answers.student_id = 751
"
7660,How to make sql query case insensitive in sqlite for my iOS app,"SELECT * FROM PROFILE WHERE upper(no) = upper(?);
"
27060,print SQL output in jade file,"res.render('index', {
  title: 'Home',
  rows: rows
});
"
21863,PostgreSQL: Select one of two fields depending on which is empty,"SELECT 
(CASE WHEN (field1 IS NULL OR field1 = '') THEN field2 ELSE field1 END)
FROM table;
"
31209,SQL Cursor with condition in WHERE Clause,"cursor abc (c_flag ) 
IS
   select 1  
     from pqr  p 
    where 1 = CASE 
               when c_flag ='Y'      then 1
               when p.c1 IS NOT NULL then 1
               else 0
              END
"
8336,SQL - Add up all row-values of one column in a singletable,"SELECT SUM(size) AS overallSize FROM table WHERE bla = 5;
"
20328,How to dump whole csv database to format readable by Excel (csv is OK).,"DO $DO$
DECLARE 
r record;
BEGIN
   FOR r IN select tablename from pg_tables where NOT (tablename LIKE 'pg%' OR tablename LIKE 'sql%') LOOP
       EXECUTE 'copy (select * from ""'||  r.tablename || '"" ) to ''/tmp/dump/' || r.tablename || '.csv'' with csv header';
   END LOOP; 
END;

$DO$; 
"
17350,How to use a calculated column in where condition?,"select calcdate from
(
select startDate, endDate,
       decode (:pValue,1,
               select sysdate from dual,
               select activation_date from account where AcNo = 1234) as calcdate
)
where calcdate between startDate and endDate;
"
34126,SQL: two many to many joins with one match in each,"SELECT   Project.ProfileID
FROM     Project
    JOIN Projects_Specialities USING (ProjectID)
    JOIN Projects_Industries   USING (ProjectID)
WHERE    Projects_Specialities.SpecialityID = ?
     AND Projects_Industries.IndustryID     = ?
GROUP BY Project.ProfileID
HAVING   SUM(Projects_Specialities.SpecialityID = ?)
     AND SUM(Projects_Industries.IndustryID     = ?)
"
5219,Mysql concatenation operator," SELECT CONCAT(vend_name, '(', vend_country, ')')
"
8058,Display one character give number of times,"UPDATE U
SET stor_Id = stor_Id + REPLICATE('A',rank)
FROM MyTable AS U
WHERE qty <= 90
"
32972,SQL table ORDER BY with the column name having numbers,"SELECT * FROM MyTable ORDER BY CAST(substr(MyColumn, 7) AS INT)
"
2163,Oracle constraint / unique index: check if the query has no result - then you can insert the line,"create unique index idx_trainingrule_4 on (
         type, training_list_id, element_id, request_code,
         (case when after_rule is null and after_group is null then -1
               else trainingrule_id
          end)
        );
"
25861,SQL creating a concatenated string of names from an array of ids,"select prj.name, tsk.id as task_id
from project_table prj
  join ( 
     select id, regexp_split_to_table(projects, ',')::int as pid
     from task_table
  ) tsk on tsk.pid = prj.id
order by prj.id
"
6985,Sql Query Need help,"SELECT u.userid, u.username, max(lt.lastlogin) FROM
user u, logintrack lt
WHERE u.userid = lt.userid
GROUP BY u.userid, u.username
"
33958,SQL Stored Procedure - Columns From Three Tables?,"CREATE PROCEDURE getpoints @surname nvarchar(30)
AS
SELECT c.forename, c.surname, c.points, h.wins, h.losses, g.gametype
FROM videogames.cod c
left join videogames.codhost h on c.playerid = h.playerid
left join videogames.codgame g on h.gameid = g.gameid
WHERE c.surname = @surname
GO
"
2248,How to view a recordset in an access table by means of vba?,"Sub ShowQd(strQdName As String, strSql As String)
'creates queryDef and display it in a datasheet'
    Dim qd As DAO.QueryDef

    Set qd = CurrentDb.CreateQueryDef(strQdName)
    With qd
        .ReturnsRecords = True
        .SQL = strSql
    End With
    DoCmd.OpenQuery strQdName
End Sub
"
35927,Insert values into SQLite Database,"String state[] = { ""state1"" , ""state2"",.............};
    int id=1;
    for(int i=0;i<state.length;i++)
    {
    db.execSQL(""INSERT INTO tblState VALUES (id,state[i])"");
    id++;
    }
"
24734,Insert each column of one table as a row in another table,"INSERT INTO Some_Table (id, column_info)
SELECT id, c1 UNION ALL
SELECT id, c2 UNION ALL
SELECT id, c3 UNION ALL
SELECT id, c4 UNION ALL
SELECT id, c5
"
31983,How to get the max version records?,"select distinct t2.FId, t2.UId, t2.Version
from
(
    select FId, max(Version) as ""Version""
    from MyTable
    group by FId
) t1
inner join MyTable t2 on (t1.FId = t2.FId and t1.Version = t2.Version)
order by t2.FId, t2.UId
"
28187,SQL not including duplicate values on a combination of 2 columns,"SELECT A.model, B.model, A.speed, A.ram
FROM PC A
JOIN PC B ON (A.model > B.model) -- <<<=== Here
WHERE A.speed=B.speed
AND A.ram=B.ram
"
22388,MySQL query problems,"SELECT users.user_name
FROM users
WHERE users.id IN 
        (SELECT requests.from_user 
         FROM requests 
         WHERE 
              (SELECT id 
               FROM users 
               WHERE users.user_name='Gicu')
         =requests.to_user 
        )
"
515,Table with user activities - design issue,"CHECK (
    (ITEM_ID IS NOT NULL AND FOLLOWED_USER_ID IS NULL)
    OR (ITEM_ID IS NULL AND FOLLOWED_USER_ID IS NOT NULL)
)
"
19200,How to increment DateTime field in SQL Server 2005 by a month?,"update your_table set your_field = DATEADD(month, 1, your_field)
"
18426,tsql - updating a table from a select statement,"UPDATE TableB 
SET TableB.[VOLUME] = DATALENGTH([T2.Binary])
FROM TableB
INNER JOIN [VAULT].[TABLEA] T2 ON TableB.TAL_ID = T2.TAL_ID
"
18995,SQL Server question stored procedure loops,"INSERT INTO d (c)
  SELECT c FROM c WHERE c.a IN (SELECT a FROM a) AND c.b IN (SELECT b FROM b)
"
39307,Modifying hyphenated data with r,"x <- c('11111-111-11', '11111-1111-1', '1111-1111-11')
y <- strsplit(x, '-')
myfun <- function(y) {
  first <- sprintf('%05d', as.integer(y[1]))
  second <- sprintf('%04d', as.integer(y[2]))
  third <- sprintf('%02d', as.integer(y[3]))

  paste(first, second, third, sep='-')
}

sapply(y, myfun)
# [1] ""11111-0111-11"" ""11111-1111-01"" ""01111-1111-11""
"
28811,Change table cells in sql but how?,"select case when Date < '15:30' then '15:00 - 15:30'
            when Date < '16:00' then '15:30 - 16:00'
            else 'After 16:00' end as category
into #temp1
from Table1

select count(*) as VistingCount, category as Date
from #temp1
group by category
"
39306,SQL- How to query the whole table and grouped values,"SELECT Students.StudentID, Students.StudentName, Avg(Grades.Grade) AS StudentGradeAverage, qGradeAverage.OverallGradeAverage
FROM qGradeAverage, Grades INNER JOIN Students ON Grades.StudentID = Students.StudentID
GROUP BY Students.StudentID, Students.StudentName, qGradeAverage.OverallGradeAverage;
"
31089,Help with MySQL query synatx,"INSERT
INTO    wishlists (memberid, gameid, rank)
SELECT  @memberid, @gameid, COALESCE(MAX(rank), 0) + 1
FROM    wishlists
WHERE   memberid = @memberid
"
14546,INSERT INTO SELECT WHERE col = col,"UPDATE  tb1 a
        INNER JOIN
        (
            SELECT  user, MAX(DT) maxDT
            FROM    tb2
            GROUP by user
        ) b ON a.user = b.user
SET     a.DT = b.maxDT
"
27375,lowest and highest salaries display,"select top 5 salary from Employees order by Convert(numeric(18,2),salary) desc;
"
21836,Subtract hours from SQL Server 2012 query result,"SELECT DATEADD(HOUR,-4,YourColumnWithDateTimes)
FROM dbo.YourTable
"
27957,How to Short-Circuit SQL Where Clause,"declare @queryWord as nvarchar(20) = 'asdas'

SELECT  * FROM TABLE_1 
WHERE TABLE_1.INIT_DATE = (CASE WHEN ISDATE(@queryWord) = 1 
                                THEN CONVERT(Date, @queryWord)
                           ELSE NULL  END)
"
26265,Can I put update or create statements in from clause in DB2?,"     .-,---------------.   
     V                 |   
>>-FROM----table-reference-+-----------------------------------><
"
11551,Suggest SQL Query to retrieve all leaf nodes from Adjacency List Model,"select group_concat(lev0) from 
(select concat_ws(',',lev2,group_concat(lev3)) as lev0 from 
(SELECT  t2.id as lev2, 
t3.id as lev3, 
t4.id as lev4
FROM menus AS t1
LEFT JOIN menus AS t2 ON t2.parent_id = t1.id
LEFT JOIN menus AS t3 ON t3.parent_id = t2.id
LEFT JOIN menus AS t4 ON t4.parent_id = t3.id
WHERE t1.id = '2') t0 group by lev2) t;
"
34698,SQLite - WHERE Clause & UDFs,"SELECT ""code"",
    geo(38.73311, -9.138707, ""geo_latitude"", ""geo_longitude"") AS ""distance""
    FROM ""pt_postal"" WHERE 1 = 1
        AND ""geo_latitude"" BETWEEN 38.7241268076 AND 38.7420931924
        AND ""geo_longitude"" BETWEEN -9.15022289523 AND -9.12719110477
        AND ""distance"" <= 1
    ORDER BY ""distance"" ASC
LIMIT 2048;
"
8372,Add sequence number to query results,"select incidentid_uk, personid_uk,
       (select count(*)
        from table as t2
        where t2.incidentid_uk = t.incidentid_uk and
              t2.personid_uk <= t.personid_uk
       ) as sequence
from table as t;
"
28781,MYSQL DateTime '0000-00-00 00:00:00' + interval 1 month NOT being smaller than NOW(),"WHERE coalesce(DATE,'1900-01-01') + INTERVAL 5 MONTH < NOW()
"
37884,Select Parent Record With All Children in SQL,"SELECT Parent.ParentID, COUNT(*)
FROM Parent
INNER JOIN ChildParent
    ON ChildParent.ParentID = Parent.ParentID
INNER JOIN Child
    ON ChildParent.ChildID = Child.ChildID
WHERE <ChildFilterCriteria>
GROUP BY Parent.ParentID
HAVING COUNT(*) = (
    SELECT COUNT(Child.ChildID)
    FROM Child WHERE <ChildFilterCriteria>
)
"
20358,Checking sequence with SQL query,"select cur.*
from orders cur
left join orders prev 
    on cur.webordernumber = prev.webordernumber + 1
    and cur.webstoreid = prev.webstoreid
where cur.webordernumber <> 1
and prev.webordernumer is null
"
33765,Postgres query to select based on row count and existence,"WITH fb AS (
  SELECT user_id, image_url
  FROM profiles
  WHERE profile = 'Facebook'
), ggl AS (
  SELECT user_id, image_url
  FROM profiles
  WHERE profile = 'Google'
)
SELECT users.*, COALESCE(fb.image_url, ggl.image_url)
FROM users
LEFT JOIN ggl ON ggl.user_id = users.id
LEFT JOIN fb ON fb.user_id = users.id
"
33929,SQL Server - multiple rows into one,"SELECT productid,
       MAX(CASE WHEN property_name = 'type' THEN property_value END) AS type,
       MAX(CASE WHEN property_name = 'name' THEN property_value END) AS name,
       MAX(CASE WHEN property_name = 'cost' THEN property_value END) AS cost
FROM Product
GROUP BY productid
"
28413,Determine monthly values of timestamped records,"select left(date,7) as the_month, min(price),max(price),avg(price)
from fruit_price
where fruit_id = 2
and date >= concat(left(date_sub(curdate(), interval 11 month),7),'-01')
group by the_month;
"
25858,SQL matching columns between rows,"SELECT
  CR.ID,
  CR.Name,
  Folder.Name AS FolderName
FROM
  CR
  /* First join CR to VM */
  INNER JOIN VM ON CR.ID = VM.ObjectID
  /* Then join VM to itself aliased as VMLoc, mapping Location to ObjectID */
  INNER JOIN VM AS VMLoc ON VM.Location = VMLoc.ObjectID
  /* Finally join the second ObjectID to Folder to get Folder.Name */
  INNER JOIN Folder ON Folder.ID = VMLoc.ObjectID
"
12430,"Combining two tables together to get all columns, but I need separate rows for the data instead of one row","SELECT invoice_id, col1, col2, NULL AS pmt_invoice_id, NULL AS colA, NULL AS col
FROM tenant_invoices
UNION ALL
SELECT NULL, NULL, NULL, pmt_invoice_id, colA, colB
FROM tenant_payments
"
10556,Getting & Passing a search to a stored procedure,"Imports System.Data.OleDb


Dim cmd as new Oledb.OleDbCommand
Dim connection As New SqlConnection(""Connection String"")


cmd.Connection = connection
cmd.CommandText = ""SP_NAME""
cmd.CommandType = CommandType.StoredProcedure
cmd.Parameters.AddWithValue(""@PARAMETER_NAME"", ""PARAMETER_VALUE"")

Dim adapter As New SqlDataAdapter(CMD)

 Dim DS as DataSet    
 adapter.Fill(DS)
 connection.Close() 
ds.Dispose()
ds = Nothing
"
22131,How to exchange records values?,"UPDATE table

SET role = CASE role
               WHEN 1 THEN 2
               ELSE 1
           END

WHERE role = 1 OR role = 2;
"
10811,MySQL with IF statment with a Count and SubQuery Select,"SELECT ch.*,
       (EXISTS (SELECT 1 FROM invoice_items ii WHERE ii.chargeid = ch.chargeid
               )
       ) as billed
FROM charges ch
WHERE ch.customerid = %s AND ch.status <> 'completed';
"
31599,SQL SUM and CASE and DISTINCT,"COUNT(DISTINCT CASE WHEN a.Gender LIKE 'M%' THEN a.ChildID ELSE NULL END) AS Males
"
19514,DateTime issue with vb and mdb,"WHERE (DateOpen BETWEEN @DStart AND @DEnd)
"
37160,Teradata - limiting the results using TOP," SEL RANK(custID), custID 
 FROM mydatabase.tblcustomer
 QUALIFY RANK(custID) < 1000 AND RANK(custID) > 900
 ORDER BY custID;
"
2006,Update one row only out of two identical rows in sybase,"update top 1 table 
set col1 = XYZ
where col1 = ABC
"
33808,How to enumerate a continuous group of rows based on order in result of sql query,"SELECT id_key, sequence, [group],
       SUM(flag) OVER (PARTITION BY id_key 
                       ORDER BY sequence) + 1 AS desired_output
FROM (
  SELECT id_key, sequence, [group],
         IIF(LAG([group]) OVER (PARTITION BY id_key 
                                ORDER BY sequence) <> [group], 1, 0) AS flag
  FROM mytable) AS t
ORDER BY sequence
"
13479,Including records that are missing in another dataset,"ActStaffID NOT IN (
    SELECT *
    FROM
        CTE_PlanStaff
    WHERE
        CTE_PlanStaff.RegisterID = PlanActStaff.RegisterID
    AND
        CTE_PlanStaff.TT_ActivityDate = PlanActStaff.TT_ActivityDate
    AND
        CTE_PlanStaff.TT_ActivityTime = PlanActStaff.TT_ActivityTime
)
"
12289,TOP 1 Query from each ID with multiple instances,"SELECT ID, MAX(DATE)
FROM [table]
GROUP BY ID
"
18162,JOIN query with IN operator,"SELECT P.* 
FROM wp_posts AS P
INNER JOIN wp_comments AS C ON C.post_ID = P.post_ID
WHERE C.comment_ID IN (2, 4, 6, 7);
"
6277,Postgres perform JOIN on a table more than once,"select     
    c1.firstname || ' ' || c1.middlename AS Driver_assigned, 
    c2.firstname || ' ' || c2.middlename AS Who_assigned, 
from assignments a
join customers c1 on a.driver_assigned=c1.customer_id
join customers c2 on a.who_assigned=c2.customer_id
"
6164,How to check whether a SELECT query is Successful?,"CREATE PROCEDURE myTest 
 @Result INT OUTPUT  
AS  
BEGIN  
  SET NOCOUNT ON;

  BEGIN TRY
     SELECT FirstName,LastName FROM Employees  
     SET @Result = 1;
  END TRY  

  BEGIN CATCH
     SET @Result = 0;
  END CATCH

END;  
"
11804,get parent of grand children tree stored in database,"select @pv from
(select @pv:=t.parent_id
from (select * from cat order by cat_id desc) t
join (select @pv := 7) tmp
where t.cat_id = @pv) a limit 1;
"
11672,Is it possible to update the cell value only to the specific maximum value?,"UPDATE table_1 SET
   premium_photos = IF(premium_photos+2>4, 4, premium_photos+2)
WHERE number = '1234'
"
34927,Get value based on max of a different column grouped by another column,"select key, val
from (select t.*, row_number() over (partition by key order by num desc) as seqnum
      from table_name t
     ) t
where seqnum = 1;
"
14445,moving an entry form the end of table to the top,"update table_name set id=(select max(id)+1) from table_name where id=123;
/* this will move the last record to somewhere temporary */

update table_name set id=123 where id=1 ;
/* this will move the first row to the place of the row that was at the bottom */

update table_name set id=1 where id=(select max(id) from table_name);
/* moving from temporary row to the first of the table */
"
27937,SQL Query - SUM of data in transaction (for each transaction),"select sum(value)/count(*) 
from table
"
37966,SQL - Select most 'active' timespan fromdb,"select datepart(hour, the_column) as [hour], count(*) as total
from t
group by datepart(hour, the_column)
order by total desc
"
8173,Increment Variable in SQL,"insert into table1(ID,DATA) 
VALUES ((select max(id) from table1 as T) +1000, DATA), 
       ((select max(id) from table1 as T) +1000, DATA);
"
21844,How to store MySQL query results in another Table?,"INSERT INTO new_table_name
SELECT labels.label,shortabstracts.ShortAbstract,images.LinkToImage,types.Type 
FROM ner.images,ner.labels,ner.shortabstracts,ner.types 
WHERE labels.Resource=images.Resource AND labels.Resource=shortabstracts.Resource 
AND labels.Resource=types.Resource;
"
22397,Oracle equivalent of stored procedure that returns an inline table?,"PROCEDURE proc_get_tada(ip_user IN VARCHAR2, 
                        op_error_code OUT NUMBER, 
                        op_cursor OUT SYS_REFCURSOR,) AS

BEGIN

  OPEN op_cursor FOR
    SELECT * FROM your_table yt where yt.user = ip_user;

EXCEPTION
  WHEN OTHERS THEN
    op_error_code := -1;
END proc_get_tada;
"
639,SQL EXCEPT performance,"select field1,field2,field3,field4,field5 from dev.dbo.table1 
where field1+field2 in ('string1','string2','string3',...,'string50')
except
select field1,field2,field3,field4,field5 from test.dbo.table1 
where field1+field2 in ('string1','string2','string3',...,'string50')
option (hash join, merge join)
"
24727,how to get date from CDBVariant?,"CDBVariant var;

if(var.m_dwType == DBVT_DATE) 
{
    COleDateTime timestamp(var.m_pdate->year,var.m_pdate->month,var.m_pdate->day,
                     var.m_pdate->hour,var.m_pdate->minute,var.m_pdate->second);
    CString str = timestamp.Format(_T(""%B %d, %Y""));
}
"
6475,Find conversation between one or more users,"SELECT cu.`conversation_id` 
FROM `conversation_user` cu 
INNER JOIN (
    SELECT `conversation_id`
    FROM `conversation_user` 
    WHERE `user_id` IN (X, Y) 
    GROUP BY `conversation_id` HAVING COUNT(*) = Z 
) cu2 ON cu.conversation_id=cu2.conversation_id
GROUP BY `conversation_id` 
HAVING COUNT(*) = Z;
"
24781,Time taken for operation MongoDB,"> setVerboseShell(true)

> db.testing.update({}, {$set: { deleteme: true }}, { multi:true })
Updated 100 existing record(s) in 1ms
WriteResult({ ""nMatched"" : 100, ""nUpserted"" : 0, ""nModified"" : 100 })

> db.testing.remove({ deleteme:true })
Removed 100 record(s) in 1ms
WriteResult({ ""nRemoved"" : 100 })
"
27269,Is there a way to force OracleCommand.BindByName to be true by default for ODP.NET?,"public class DatabaseCommand
{
    private OracleCommand _command = null;

    public DatabaseCommand(string sql, OracleConnection connection)
    {
        _command = new OracleCommand(sql, connection)
        {
            BindByName = true
        };
    }

    public int ExecuteNonQuery()
    {
        return _command.ExecuteNonQuery();
    }

    // Rest of impl removed for brevity
}
"
29869,SQL Server : checking 2 tables at once,"SELECT  A.accountid
FROM    accounts A
        LEFT JOIN ( SELECT  accountID ,
                            MAX(rating) AS rating
                    FROM    ratings
                    GROUP BY accountID
                  ) M ON A.accountID = M.accountID
WHERE   A.flag = 1
AND (M.rating IS NULL OR M.rating < 0)
"
22125,MySQL - Create an UNIQUE index on two columns for ON DUPLICATE KEY,"INSERT INTO table (value,user_id,setting_id) VALUES (1,34,15)
  ON DUPLICATE KEY UPDATE value = 1, user_id = 34, setting_id = 15;
"
29875,How to Select where in(Other table) but with modification,"Select * 
from PmtHist
Where REPLACE(Confirmation, 'voided', '') in(
    Select Str1 as ConfirmationCode
    From @ConfListTable
)
"
1889,Multiple column to single column with column header?,";with cte as
 (select 
  ID,
  value,
  row_number() over (partition by id order by value) rn
  from dbo.Staging
  unpivot
  (
   value
   for col in (I1, I2,I3 )     
  ) un
 )

 select 
 id, 
 value, 
 case when rn = 1 then 'I1' when rn = 2 then 'I2' else 'I3' end as 'Column header name'
 from cte
"
38691,How do I convert an arbitrary list of strings to a SQL rowset?,"SELECT 'foo'
UNION
SELECT 'bar'
UNION
SELECT 'baz'
"
37656,Changing primary key value for a database row,"SET IDENTITY_INSERT aTable ON
GO

-- Attempt to insert an explicit ID value of 3
INSERT INTO aTable (id, product) VALUES(3, 'blah').
GO

SET IDENTITY_INSERT aTable OFF
GO
"
29821,ORDER BY with columns that are sometimes empty,"SELECT CompanyName , LastName , FirstName FROM ... JOIN ...
ORDER BY COALESCE(CompanyName , LastName, FirstName),
         COALESCE(LastName, FirstName),
         FirstName
"
34783,SQL Server : Joining two pivot tables,"select 
  GL_BU,
  GL_Source,
  GL_JE_Type,
  sum(case when Amount_Prefix = 'D' then GL_Amount else 0 end) Amount_D,
  sum(case when Amount_Prefix = 'C' then GL_Amount else 0 end) Amount_C,
  sum(case when Amount_Prefix = 'D' then 1 else 0 end) Count_D,
  sum(case when Amount_Prefix = 'C' then 1 else 0 end) Count_C,
  count(*) TotalCount,
  sum(GL_Amount) TotalAmount
from table_2013
group by GL_BU, GL_Source, GL_JE_Type;
"
16303,SQLite: Update column with value from another table,"           UPDATE table1 
           SET status = (SELECT t2.status FROM table2 t2 WHERE t2.trans_id = id) , 
               name = (SELECT t2.name FROM table2 t2 WHERE t2.trans_id = id)
           WHERE id IN (SELECT trans_id FROM table2 t2 WHERE t2.trans_id= id)
"
21302,SQL joining two tables,"SELECT e.id, e.name , s.salary FROM employees e 
INNER JOIN salary s
ON e.id=s.id
ORDER BY e.id ASC
"
37993,Using multiple values in SQL query where clause,"Select Distinct 
    SomeDay.SomeDayID,SomeDay.FolderName,SomeDay.FolderColor 
from 
    SomeDay,SomeDayEvent 
where 
    SomeDay.SomeDayID not in (4,3,2,1);
"
2403,Summing MAX and MIN values in the same column,"SELECT (MAX(payrate)+MIN(payrate))/2 AS PAYRATE
FROM    PAYCHECKS
WHERE PAYROLCD in ('01', '02') 
AND PYRLRTYP = 1 
AND EMPLOYID = A.EMPLOYID 
AND PYADNMBR = A.PYADNMBR
"
10533,How to add check constraint on one column using another column from same table,"ALTER TABLE Sale
  ADD CONSTRAINT ValidDiscount
  CHECK(discount <= unit_price *0.2);
"
13761,Retrieve image from user class in Parse,"PFUser *user = [PFUser currentUser];
PFFile *userImageFile = user[@""imageFile""];
[userImageFile getDataInBackgroundWithBlock:^(NSData *imageData, NSError *error) {
    if (!error) {
        UIImage *image = [UIImage imageWithData:imageData];
    }
}];
"
32782,get Value that does not exist in another table and vice versa,"select Candidate, CPEVENT, Test_Number, DosedTime, DoseTime, ExpectedTime, s.Timepoint as tmpt, t.Timepoint as tmpt1, CASE WHEN t.Timepoint IS NULL THEN 'Not Collected' WHEN s.timepoint IS NULL THEN 'Not Collected' ELSE 'Collected' END as Timepoint_Collection, case when t.timepoint is null THEN s.timepoint WHEN s.timepoint IS NULL THEN t.Timepoint WHEN s.timepoint = t.TIMEPOINT THEN s.timepoint END as Timepoint  from vw_data s FULL OUTER JOIN lu_pk_Timepoint t on s.PCTPT = t.Timepoint AND s.STUDY=t.Study
"
616,SQL Server: proper use of Select with calendar table,"SELECT     *
FROM       Calendar
WHERE      (yearCal    = 2014)
       AND (monthCal   = 12)
       AND (weekDayCal = 6)
       AND (dayInMonth BETWEEN 8 AND 14)
"
3857,MYSQL return null when more rows than IN values,"SELECT conversation_id
FROM conversation_list
WHERE user_id IN (5,6)
AND conversation_id NOT IN (
    SELECT conversation_id from conversation_list where user_id NOT IN (5,6)
)
GROUP BY conversation_id
HAVING COUNT(*) = :nb_users 
"
34651,OracleSQL Finding top N rows from a group,"select jobid, jobtitle, pay, name
from (
  select j.jobid, j.jobtitle, e.pay, e.name, 
         row_number() over (partition by j.jobid order by e.pay desc) as rn
  from employees e 
    join jobs j on j.jobid = e.job_id
) 
where rn <= 3
order by jobid, jobtitle, pay desc;
"
3667,Get rows with second-most-recent timestamp by category?,"SELECT
  t1.*, COUNT(*) pos
FROM formstatus t1
  LEFT JOIN formstatus t2
    ON t2.form = t1.form AND t2.timestamp >= t1.timestamp
GROUP BY
  t1.form, t1.timestamp
HAVING
  pos = 2;
"
23101,How to do sum of product of two columns in postgres and group by two columns?,"  SELECT date,
         store_id,
         SUM(on_hand*cost) inv_costs,
         SUM(on_hand) total_on_hand
    FROM Inventory
   WHERE store_id IN (100,101)
GROUP BY date, 
         store_id
"
33264,"SQL if date is null, have empty varchar, if not null convert date","CASE WHEN COALESCE(V_CONSTAT_ACTUAL_DATES.ID187, '') = '' THEN ' ' ELSE  CONVERT(varchar,CONVERT(date, V_CONSTAT_ACTUAL_DATES.ID187)) END AS 'actualFinish'
"
728,Inner join and Avg( ) function," Select a.StudentName, TableAvg.class, a.score
  From TableA a
  inner Join  (select class, avg(score) as AvgScore
        From TableA 
        group by class)  TableAvg
  On a.score >  TableAvg.AvgScore
  and a.class = TableAvg.class   
"
23136,mysql joing tables,"select a.uid,a.username,b.user_email, b.orders_is, c. product_name
from users a, users_orders b, order_products c
where a.uid = b.uid and b.order_id = c.order_id and product_id = 5
"
14290,Parsing full month and year in SQL,"SELECT CAST('July,1999' AS DATETIME)
"
13928,How to get null value when summing a column has a null value,"SELECT (case when count(*) = count(oran*deger)
             then SUM(oran*deger/100)
        end)
FROM @tablo;
"
25241,Get the count of A -> B and B->A without duplicates,"select `from` as A, `to` as B, count(*) as `count`
from your_table
group by if (from<to, concat(from,to), concat(to,from));
"
21126,Anything faster than count(1) from tableA to find row counts?,"IF EXISTS(SELECT * FROM YourTable)
"
378,How to export data for a manual read?,"select 'Col1:' + char(13) + Char(10) + Col1 + char(13) + Char(10)
     + 'Col2:' + char(13) + Char(10) + Col2 + char(13) + Char(10)
     + 'Col3:' + char(13) + Char(10) + Col3 + char(13) + Char(10)
     + char(13) + Char(10)
from table
"
38217,"SQL Server - where is ""sys.functions""?","CREATE VIEW my_sys_functions_equivalent
AS
SELECT *
FROM sys.objects
WHERE type IN ('FN', 'IF', 'TF')  -- scalar, inline table-valued, table-valued
"
348,Extract required data with details from SQL data table,"SELECT (ROW_NUMBER() OVER ( ORDER BY [Path]))   AS [Sr.]
       ,REPLACE ([Path],'Mb\Dbi','')            AS [Name]}
       ,[Path]                                  AS [Value]}
FROM  tbl_PathValues
"
5328,How to make this query start digits with ORMLite querybuilder?,"GenericRawResults<T> rawResults = getYourDao().queryRaw(
    ""SELECT * FROM "" + [tables] + "" WHERE "" + [column] + "" REGEXP '[0-9]+'"",
    getYourDao().getRawRowMapper(), String...params);
List<T> dataList = rawResults.getResults();
"
6259,Add a column to a table with a default value equal to the value of an existing column,"ALTER TABLE tablename ADD newcolumn type NOT NULL DEFAULT (0)
Go
Update tablename SET newcolumn = oldcolumn Where newcolumn = 0
Go
"
36221,How to rewrite a subquery to use joins when you used DISTINCT in the subquery?,"SELECT * 
FROM   table1 a 
       JOIN table2 b ON b.field1 = a.field1 
       JOIN ( SELECT DISTINCT field5 
                        FROM   table3 
                        WHERE  field6 = 172 ) C 
       ON C.field5 = a.field5

WHERE  b.field3 = 1531 AND a.field4 = 0 
"
23622,Using NOT IN and OR not working as intended in MySQL,"select p.pageid, p.pager from pages p where p.pageid not in (select pageid from updates)
union
select p.pageid,p.pager from pages p, updates u where p.pageid = u.pageid and u.pagenums > 1000
"
10175,Display a list of students where both students like each other in sql,"select A.name || ' likes ' || B.name
from   Highschooler A
join   likes          on A.id = Likes.ID1
join   Highschooler B on B.id = Likes.ID2
"
13144,How to select all joined rows from 2 tables including null,"SELECT
  registrations.registration_no,
  vaccination_type.vaccine_id,
  vaccination_type.name,
  vaccination.date
FROM
  registrations
  CROSS JOIN vaccination_type
  LEFT JOIN vaccination ON registrations.registration_no = vaccination.registration_no AND vaccination_type.vaccine_id = vaccination.vaccine_id
WHERE
  registrations.registration_no = 1111
"
9931,How to duplicate and add more characters to a string row in sql?,"select
  cname
from
  table1
union all
select
  cname + '*'
from
  table1 
union all
select
  cname + '#'
from
  table1 
order by cname
"
31192,Oracle function is Valid or Not,"SELECT status
FROM all_objects
WHERE object_name = 'MYFUNCTIONNAME'
AND object_type = 'FUNCTION';
"
74,Return the data are Max Datetime and different identity different row - MYSQL,"SELECT        *
FROM          tbl_locate AS a
INNER JOIN     
(
    SELECT    MainID, Max(DateTime) AS DateTime
    FROM      tbl_locate
    GROUP BY  MainID
) AS b
ON            a.MainID = b.MainID
AND           a.DateTime = b.DateTime
WHERE b.MainID in(1,2,3)
"
11165,Why does my Scalar UDF funciton return more than one row?,"SELECT dbo.TotalIncome('SPIKE', 'FRI') AS TotalIncome
"
35567,Get the value of print statement of sql server in vb.net by using oledb,"AddHandler myConnection.InfoMessage, New SqlInfoMessageEventHandler(AddressOf OnInfoMessage)

Private Sub OnInfoMessage(ByVal sender As Object, ByVal e As System.Data.SqlClient.SqlInfoMessageEventArgs)
        mySB.AppendLine(e.Message)
End Sub
"
30335,Is this a bad database design?,"CREATE TABLE staff (
    id    INTEGER PRIMARY KEY,
    name  TEXT NOT NULL
);

CREATE TABLE departments (
    id    INTEGER PRIMARY KEY,
    name  TEXT NOT NULL
);

CREATE TABLE department_roles (
    staff_id      INTEGER REFERENCES staff(id),
    department_id INTEGER REFERENCES departments(id),
    role          ENUM('chairman', 'teacher')
);
"
12850,sql addition of 2 queries return NULL,"select COALESCE(sum(lfh.montant), 0)
"
16588,MySQL : How to get records are have non null values?,"SELECT ID,
       Code, 
       CompareWithField 
  FROM `data`
 WHERE Indexed = 0 
   and code = 142 
   and NULLIF(CompareWithField,2.26) is not null
"
8802,SQL Server: display only rows where conditional concatinated column is not null,"SELECT * FROM (
  SELECT DISTINCT
  CONVERT (varchar(24), [LWEmail].[ID]) AS LogBatch,
  STUFF((SELECT CAST(', ' + LWEmail2.Email  AS VARCHAR(MAX))
         FROM   [LWEmail] AS LWEmail2
         WHERE  LWEmail2.[ID] = [LWEmail].[ID] and [MustUse] = 1
         FOR XML PATH('')), 1,2,'') AS Emails
  FROM   [LWEmail]
) t
where Emails is not null
"
35996,Also show row with NULL value,"SELECT * 
FROM project_category as a 
LEFT OUTER JOIN  project_estimate_detail  as b 
   ON a.id = b.project_cat_id 
where (b.project_cat_id IS NULL) OR (b.project_cat_id not in ('21','22','2'))
"
14428,SQL Server 2008 R2: Working with XML stored as BLOB (image data type),"SELECT CAST(cast(SomeXmlStoredAsBlob AS VARBINARY(MAX)) AS XML) AS MyXml
FROM MyTable
"
15186,Obtain all the players born in a particular month in Sqlite,"SELECT p.name, p.birth_date
    FROM Player p
        WHERE p.birth_date > '1986-04-30'
            AND p.birth_date < '1986-06-01';
"
23722,django aggregate for multiple days,">>> from django.db.models import Sum
>>> MyModel.objects.values('date').annotate(total_length=Sum('length'))
"
95,indexing two varchar columns for query with String concatenation,"create index on the_table ((a||b) varchar_pattern_ops);
"
4686,How to change Parameter format from DD/MM/YYY HH:MM;SS to DD/MM/YYYY,"SELECT CONVERT(VARCHAR(24),UploadedDate,103)
FROM table
"
2167,variable database name,"SET @db = 'db1';
SET @q = CONCAT('SELECT * FROM ', @db, '.mycol');
PREPARE stmt FROM @q;
EXECUTE stmt;
DEALLOCATE PREPARE stmt;
"
25154,How to update sql table join on 3 columns,"UPDATE  P
SET     Price = @variableNewPrice
FROM    Products    P
JOIN    #temptable  T   ON  P.PkProduct = T.PkProduct 
                        AND P.Price = T.Price
                        AND P.DateChanged = T.DateChanged
"
25,SQL adding value at every comma separation,"DECLARE @queryRWordsSameType VARCHAR(500) = ''
SELECT @queryRWordsSameType += CASE WHEN @queryRWordsSameType <> '' THEN ',' ELSE '' END + 'CAST([' + name + '] AS NVARCHAR(100)) AS [' + name + ']' + CHAR(13) + CHAR(10)
  FROM syscolumns
 WHERE id = object_id('YOUR_TABLE_NAME')
PRINT @queryRWordsSameType
"
35174,"Can I selectively create a backup of Postgres database, with only certian tables?","pg_dump -t '(A|B|C)'
"
15958,MySQL trying to use INNER JOIN and UNION together?,"SELECT course.course_title, course.department_id, departments.department_id, departments.department_name 
FROM departments 
  INNER JOIN course ON departments.department_id = course.department_id
WHERE course.course_title IN ('Calculus', 'British Literature I','Studio Art I')
"
27757,How to transform Oracle DateTime to Date,"SELECT TRUNC(SYSDATE, 'DAY') FROM DUAL;
"
33160,ifnull() function in where clause MYSQL,"select e.name, o.OrgName 
from Employee e
left join Organisation o on o.OrgID = e.OrgID
where e.EmpId = ?; 
"
22173,"sql select, get cars which are due a job","select c.id,c.reg,c.type
from cars c
where not exists 
(
  select NULL
  from jobs j
  where j.id = c.id
  and j.date >= CURRENT_DATE - INTERVAL 3 WEEK
);
"
30536,Suggested database design for columns that are usually empty,"`animal_additional`
- animal_id (FK)
- Trait (this would enumerate allowable traits)
- value
"
9107,SQL query to conditionally sum based on moving date window,"SELECT  COUNT(created_at) AS registered,
        SUM(CASE WHEN verified_at <= created_at + '60 day'::INTERVAL THEN 1 ELSE 0 END) AS verified
FROM    generate_series(1, 20) s
LEFT JOIN
        users
ON      created_at >= '2009-01-01'::datetime + (s || ' month')::interval
        AND created_at < '2009-01-01'::datetime + (s + 1 || ' month')::interval
GROUP BY
        s
"
34887,MySQL ROUND() calculates incorrectly,"SELECT CEILING(SUM(marks)/COUNT(marks)) as avg
"
31075,SQL select values with or,"select a,b
from database
where source = 2

union

select c,d
from database
where target = 2
"
19835,returning date from 30 days ago if current date is null,"SELECT (CASE WHEN lastupdatedatetime is null then DATEADD(day,-30,GETDATE()) ELSE lastupdatedatetime from ..
"
10359,sum of column name using group by in SQL server?,"SELECT MIN(PS.sno) AS sno, 
       PD.productname,
       SUM(PS.quantity) as quantity,
       PS.modelno 
FROM K_RT_PurchaseDet PS 
 JOIN K_RT_ProductDetails PD on PD.sno=PS.product 
 WHERE purchasedby=@purchasedby 
  AND PS.quantity!=0 and attrited='false'
GROUP BY PD.productname,
         PS.modelno,
         PS.company
"
37308,Oracle COUNT() function,"select count(*) DAYs FROM
    (
     select trunc(ADD_MONTHS(sysdate,-1),'MM') +  level -1 Dates from dual connect by
      level <= ADD_MONTHS(trunc(sysdate,'MM'),1)-1 -  trunc(sysdate,'MM')+1
   ) Where To_char(dates,'DY') NOT IN ('SA','SO')
"
23108,Can I have one million tables in my database?,"create table post(id integer primary key, post text);
create table comment(id integer primary key, postid integer , comment text, key fk (postid));
"
37633,"Recursive sql subset query, using connect by","select id from territories start with id in
  (select territory_id from agr_terr_def_terrs where def_id = :def_id_1)
  connect by parent_id = prior id
minus
select id from territories start with id in
  (select territory_id from agr_terr_def_terrs where def_id = :def_id_2)
  connect by parent_id = prior id
"
26619,How to add month to a date based on value from another columns,"with cte as (
      select id, PlannedDate, 0 as ind, PeriodLength
      from ip
      union all
      select id, dateadd(1, month, PlannedDate), ind + 1, PeriodLength
      from cte
      where ind <= PeriodLength
     )
select *
from cte;
"
5446,Help with count();,"SELECT Video.Id, COUNT(ThumbsUp.Video) 
FROM 
  Video LEFT JOIN ThumbsUp ON Video.Id = ThumbsUp.Video
WHERE Video.Profile = 2
GROUP BY Video.Id
"
26740,LEFT JOIN - How to join tables and include extra row even if you have right match,"SELECT A.ID, A.ProductName, B.ID, B.Size
FROM A
INNER JOIN B
ON B.ProductID = A.ID
UNION ALL
SELECT A.ID, A.ProductName, NULL, NULL
FROM A
"
3573,how to get the range of the price using range in sql?,"SELECT
    price 
FROM 
    my_table
WHERE
    Footage_Range1 <= YOUR_RANGE
ORDER BY
    Footage_Range1 DESC
LIMIT 1
"
7160,"How do I lock table so that a user cannot perform Insert, Update, delete operations on it (Only triggers can)","CREATE TRIGGER Trig_INS_Test ON Test
INSTEAD OF INSERT
AS
BEGIN
SET NOCOUNT ON

   INSERT INTO Test (CommaSeperatedString)
      SELECT CommaSeperatedString
      FROM inserted

END
"
29503,Get data sorted even if some references are NULL,"SELECT p.desc, p.price, m.title
FROM products AS p
LEFT JOIN manufacturer AS m ON m.id = p.manufacturer_id
ORDER BY m.title
"
12780,MySQL - Limit a left join to the first date-time that occurs?,"SELECT task_a, dts_completed,
bb.started
FROM tableA
INNER JOIN 
(SELECT task_b, MIN(dts_started) as started
FROM tableB GROUP BY taks_b)bb
ON (bb.task_b = tableA.task_a AND bb.started > tableA.dts_completed)
"
35480,using order by with union in inner select queries,"select colname,1 as OrderCol from table where <cond1> 
union select colname,2 as OrderCol  from table 
where <cond2>  
order by OrderCol
"
11532,"Use Select to Join two tables, Show only a few columns and also have a between criteria","Select Firstname, Lastname, Salary, 
   j.Field1, j.Field2 ... -- and other fields you want to select here
From Employee as E 
Join JobTitle as J
on E.JobTitleID = J.JobTitleID

WHERE Salary 
BETWEEN $25000.00 AND $50000.00
"
10130,ISNULL() not treating 0 value as NULL,"SELECT INVOICE_QUANTITY * COALESCE(NULLIF(MANUAL_PRICE, 0), LIST_PRICE, 0) as Revenue
"
20632,Random Row in MySQL,"SELECT u.* 
FROM   users u
      ,(SELECT min(id) AS min_id, max(id) AS max_id FROM users) x
WHERE  u.id > (floor((x.max_id - x.min_id + 1) * rand()) + x.min_id)
LIMIT  1;
"
38567,Using a SELECT statement with a searched CASE expression,"select student_id, course, score,
   case                        --<-- you dont need to mention column name here
     when score < 60  then 'fail'
     when score = 60  then  'bottomline' 
     when score > 60  then 'pass'
   end as 'result'
from scores
order by student_id
"
27791,In SQLite how to insert a new column into s table with values of a column in another table?,"UPDATE T1
SET t2_col = (SELECT t2_col
              FROM T2
              WHERE T2.rowid = T1.rowid)
"
9415,"Freebase: What data dump file contains the ""imdb_id""?","/m/015gxt       /type/object/key        /authority/imdb/title   tt0065126
"
31558,Sql query to fetch a single record from a multiple records grouped by a single column,"SELECT Company,  
       CASE WHEN COUNT(DISTINCT Sector) = 1 THEN MAX(Sector) END AS Sector
FROM mytable
GROUP BY Company
"
6806,Is it possible to set mySQL to have a saturday as the start of the week?,"
date_sub(t.date, interval if(dayofweek(t.date)-$weekStartingDay >= 0, dayofweek(t.date)-$weekStartingDay, dayofweek(t.date)-$weekStartingDay+7) day) week_start

date_sub(t.date, interval if(dayofweek(t.date)-$weekStartingDay >= 0, dayofweek(t.date)-$weekStartingDay, dayofweek(t.date)-$weekStartingDay+7) - 6 day) week_end
"
38495,"Should I use ""maxrows"" in my query? ColdFusion / SQL","<cfquery name=""q"">
    SELECT property1, property2, property3 
    FROM yourTable 
    WHERE RowID = <cfqueryparam value=""#NumericVariable#"" cfsqltype=""CF_SQL_INTEGER"" />
</cfquery>
"
4964,"IF statements based on numerical value(1,0) in table to determine string result","SELECT a.id, a.company_id, 
(CASE WHEN p.teacher_status = '1' THEN  'YES' ELSE 'NO' END
) AS teacher,
(CASE WHEN p.student_status = 1 THEN  'YES' ELSE 'NO' END
) AS student,
p.teacher_status, /* for testing purpose only to view the field value */
p.student_status  /* for testing purpose only to view the field value */
FROM company a
LEFT JOIN person p
ON a.company_id = p.company_id
"
15398,Permutation in SQL,"select pe1.projectid, pe1.employeeid as employeeid1, pe2.employeeid as employeeid2
from pe pe1 join
     pe pe2
     on pe1.projectid = pe2.projectid and pe1.employeeid < pe2.employeeid;
"
34252,SQL counting multi lines with each other using group by,"select r.ID, m.MATERIALID, m.LOT, sum(ms.AMMOUNT) as aantal,
       sum(m.NETPRICE )as prijs, sum(ms.AMMOUNT * m.NETPRICE) as Total
from rc_recall r inner join
     RC_RECALLMATSTORE ms
     on r.ID = ms.RECALLID inner join
     RC_RECALLMATERIAL m
     ON ms.RECALLID = m.RECALLID and ms.LINE = m.LINE 
where r.ID = '2015073' and d.LANG = 'FR'
group by r.ID, m.MATERIALID, m.LOT;
"
15136,"MySQL - Selecting how many ""Days Old"" a field is","SELECT DATEDIFF(NOW(), ts.dateadded) AS daysold
  FROM TBL_STUFF ts
"
6772,How to insert/find gaps in a table of sqlite,"SELECT 'p' || (substr(Name, length('p') + 1) + 1)
FROM MyTable
WHERE NOT EXISTS (SELECT 1
                  FROM MyTable AS T2
                  WHERE T2.Name = 'p' || (substr(MyTable.Name, length('p') + 1) + 1))
ORDER BY substr(Name, length('p') + 1) + 1
LIMIT 1;
"
26852,Select list of dates in oracle,"select to_date(:start_date,'dd-mon-yyyy') + rownum -1
    from all_objects
  where rownum <= 
to_date(:end_date,'dd-mon-yyyy')-to_date(:start_date,'dd-mon-yyyy')+1
"
34557,sql query returning invalid rows,"select distinct tz.zip,td.DTV_eligible,tu.cuid,tu.actvty_date
from T_ZIP5 tz left join T_DTV_CNTY_ELIGIBILITY td on tz.FIPS_CNTY=td.CNTY_FIPS 
left join T_USER_ACTIVITY tu on tz.zip=tu.zip
where tz.FIPS_CNTY='51001' 
"
8351,SQL Advance ORDER By,"select t1.* from mytable t1
join (
    select max(z) max_z, x
    from mytable
    group by x
) t2 on t2.x = t1.x
order by t2.max_z desc, t1.x, t1.z desc, t1.y desc
"
29251,Using sys.dm_sql_referenced_entities to show on dependencies that are views,"select referenced_entity_name, re.*
from sys.dm_sql_referenced_entities ('dbo.WEB_ANALYSER', 'OBJECT') as re
  inner join sys.views as sv
    on sv.name = re.referenced_entity_name
"
20086,Mysql fk problem,"select c.idcustomer, c.name, p.nameproduct
from customer c
join Product p on p.idproduct=c.idproduct;
"
13198,How should I structure my MySQL database?,"CREATE TABLE users {
 user_id  int UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
 user_type  int NOT NULL REFERENCES user_types(user_type_id),
 ssn      char(10) NOT NULL,
 password  varchar(40) NOT NULL,
 first_name  varchar(30) NOT NULL,
 last_name varchar(30) NOT NULL,
 address     varchar(80) NOT NULL,
 admin_id int REFERENCES users(user_id)
} engine = InnoDB;
"
27531,SQL - Best way to determine Operation Type in Trigger?,"SELECT @Action = CASE 
            WHEN EXISTS(SELECT 1 FROM INSERTED) 
             AND EXISTS(SELECT 1 FROM DELETED) THEN 'U'
            WHEN EXISTS(SELECT 1 FROM INSERTED) THEN 'I'
            ELSE 'D' END;
"
1201,Modify SQL trigger to work when inserted table contains more than one row,"UPDATE A
SET A.OriginalTemplateID = B.TemplateID
FROM [dbo].[Review] A
INNER JOIN INSERTED B
    ON A.ReviewID = B.ReviewID
WHERE A.OriginalTemplateID IS NULL AND B.TemplateID IS NOT NULL

UPDATE A
SET A.OriginalClientID = B.ClientID 
FROM [dbo].[Review] A
INNER JOIN INSERTED B
    ON A.ReviewID = B.ReviewID
WHERE A.OriginalClientID IS NULL AND B.ClientID IS NOT NULL
"
35265,PostgreSQL multi INSERT...RETURNING with multiple columns,"WITH ins1 AS (
   INSERT INTO table1 (username, name,  surname)
   VALUES ('johnee','john','smith')
   RETURNING user_id
   )
, ins2 AS (
   INSERT INTO table2 (user_id, password)
   SELECT ins1.user_id, 'secret'
   FROM   ins1                            -- nothing to return here
   )
INSERT INTO table3 (user_id, adress, city, phone)
SELECT ins1.user_id, ...
FROM   ins1
RETURNING user_id;
"
2713,Converting String Date to Date Time in Oracle,"SELECT TO_DATE('Sunday 6/1/2014 8:00AM', 'DAY M/D/YYYY HH:MIAM') FROM DUAL;
"
31441,How to select avg(value) per column_name in sql,"SELECT country,AVG(earnings) FROM studios GROUP BY country;
"
18599,How to read a class parameter using Cach SQL?,"SELECT * FROM %Dictionary.ParameterDefinition WHERE parent='Sample.Person'
"
18404,SQL finding second largest value in a table,"select ticker, No_indx_cusip, cor, dt_pnts
from (select b.Ticker, a.CUSIP_ID1 as No_indx_cusip, a.cor, a.dt_pnts,
             row_number() over (partition by b.ticker order by abs(a.cor) desc) as seqnum
      from  tbl1 a 
      inner join tbl3 b
            on a.CUSIP_ID1 = b.CUSIP_ID and a.dt_pnts > 20
     ) t
where seqnum = 2;
"
10901,How to insert a value from a select statement into a table along with a hardcoded value,"INSERT INTO DROLES(DID, DROLEDESC) 
SELECT MAX(ROLEID)+1, 'NEWROLEDESC' 
FROM ROLES;
"
9410,Specify different conditions for different columns in the same Query,"select 
a.col1,
sum (case when a.YourDateColumn between to_date ('01/01/1900', 'DD/MM/YYYY') and to_date ('01/10/1990', 'DD/MM/YYYY') then a.a1 else 0 end) as a1total,
sum (case when a.YourDateColumn between to_date ('01/01/1992', 'DD/MM/YYYY') and to_date ('01/10/1992', 'DD/MM/YYYY') then a.a2 else 0 end) as a2total
from A 
group by a.col1
"
33664,Select with COALESCE built list in query,"SELECT p.NamePK, p.Name,
 STUFF((
        select '+' + n.Note
        from tblNote n
        where n.NameFK = p.NamePK
        for xml path('')
    ), 1, 1, '')
FROM tblPeople p
"
20408,Checking for missing account numbers from one of the tables,"SELECT *
FROM [DS_PROD].[dbo].[Q04_ImportDetails] q04
WHERE Q04.ImportId = 680 AND q04.AccountNumber NOT IN 
    (SELECT AccountNumber 
    FROM [DS_PROD].[dbo].[T01_TransactionMaster] t01 
    WHERE t01.BatchNumber = '270864')
"
25850,How to update a set of records based on two different field values,"INSERT INTO secondTable
SELECT ID,fldNumData,AVG(fldData)
FROM thisTable
GROUP BY ID,fldNumData
"
31385,Save XML with attribute to Table in SQL Server,"declare @xml As XML = '...you XML string here...'
INSERT INTO YourTable
SELECT 
    guid.value('@GUID', 'varchar(100)') as 'GUID'
    ,guid.value('@SUBMITDATE', 'datetime') as 'SUBMIT DATE'
    ,guid.value('@ID', 'int') as 'ID'
    ,guid.value('ERROR[1]/@SEQ', 'int') as 'SEQ'
    ,guid.value('ERROR[1]/@CODE', 'int') as 'CODE'
FROM @xml.nodes('/MESSAGEACK/GUID') as x(guid)
"
15469,friends table best approach,"0: pending, A asked to B
1: pending, B asked to A
2: friends
"
39042,Stored Procedure to grab most recent database entry with one parameter?,"SELECT TOP 1 *
FROM dbo.Document 
WHERE Description = @yourparameter
ORDER BY CreatedDate desc
"
34456,Select multiple values from multiple rows,"SELECT 
  ProductID,
  GROUP_CONCAT(Variantno)
FROM tbl
GROUP BY ProductID
"
23749,Using the results of a stored procedure in a loop with a condition,"$Active = invoke-sqlcmd ""sp_whoisactive"" -database $DATABASE -serverinstance $SQLSERVER     -verbose
    If ($Active) {
        ""There is something active on the database server. Stopping.""
        }
    Else {
         ""There is nothing active on the database server."" }
"
31371,Update empty column with calculated values from SELECT statement?,"UPDATE Table_Name SET Column6 = Column4 + Column5
"
20779,Why won't this simple SQL statement work?,"WHERE dateposted BETWEEN DATE_ADD(NOW(), INTERVAL -7 DAY) AND NOW()
"
6167,SELECT only rows with either the MAX date or NULL,"SELECT m.member, mx.state, mx.country
FROM Member m
 LEFT OUTER JOIN (
SELECT ma.state, ma.country, ma.member from MemberAddress ma            
 INNER JOIN (SELECT Member, MAX(Modified) AS MaxDate
    FROM MemberAddress
    GROUP BY Member) AS m2
ON (ma.Member = m2.Member AND ma.Modified = m2.MaxDate)
) mx ON m.member = mx.member
"
17470,Table Pivot in SQL Server,"SELECT person_id, [1] Num_1,[2] Num_2,[3] Num_3,[4] Num_4,[5] Num_5
FROM Table1
PIVOT(MAX(number) FOR row_count IN ([1],[2],[3],[4],[5]))pvt
"
10350,Column as content with FOR XML PATH query in SQL Server,"select 
    p.cfProjId, 
    p.cfAcro,
    (
        select
            pt.cfLangCode as [@cfLangCode],
            pt.cfTrans as [@cfTrans],
            pt.cfTitle as [text()]
        from cfProjTitle as pt
        where pt.cfProjId = p.cfProjId
        for xml path('cfTitle'), type
    )
from cfProj as p
for xml path('cfProj')
"
20329,Recursive SQL and information on different level,"select connect_by_root cab
      , level, cab, niveau, entite, entite_parent, libelle
   from my_table
  where niveau = 2
  start with cab = 'XXX'
connect by prior entite_parent = entite
"
30959,Merge mysql colums to rows,"SELECT  * 
FROM
(
    SELECT FEATURE1 FEATURE FROM TableName
    UNION
    SELECT FEATURE2 FEATURE FROM TableName
    UNION
    SELECT FEATURE3 FEATURE FROM TableName
    UNION
    SELECT FEATURE4 FEATURE FROM TableName
) sub
WHERE   FEATURE LIKE 'gr%'
"
4717,How can I run this UPDATE query faster?,"UPDATE WEB 
SET WEB.ID_D_SUPPORT = DIM.ID_D_SUPPORT 
FROM dbo.F_SUPPORT_WEB WEB
INNER JOIN dbo.D_SUPPORT DIM ON WEB.id_support = DIM.id_support 
   AND (WEB.date_creation BETWEEN DIM.Date_Deb_Valid AND DIM.Date_Fin_Valid)
WHERE WEB.ID_D_SUPPORT <> DIM.ID_D_SUPPORT 
"
11598,Staff Wages in SQL,"select staffNo,
(Select avg(staffsalary) from staff) as avgSalary,
(select staffSalary from staff where staffNo = S.StaffNo) as Salary,
(Select staffSalary - (select avg(staffSalary) from staff) from staff where staffNo = S.staffNo ) as salDiff
from staff S
where staffSalary > (Select avg(staffSalary) from staff)
"
38063,get Mysql Event status,"mysql> select event_name, status -- from events where event_name =
    -> from information_schema.events where event_name = 'event_scheduling_sample';
+-------------------------+---------+
| event_name              | status  |
+-------------------------+---------+
| event_scheduling_sample | ENABLED |
+-------------------------+---------+
1 row in set (0.01 sec)
"
25177,Delphi XE3: DBLookupCombo Dropdown side effect,"  { Fix for Defect# 204311, Non-bound control should clear when list datasource changes }
"
29114,Testing equality of referencing rows,"Select B1.A_Id, B2.A_Id
From (
    Select Data, A_Id, Count(Id) A_Count
    From B
    Group By Data, A_Id
) b1 
inner join (
    Select Data, A_Id, Count(Id) a_count
    From B Group By Data, A_Id
) b2 on b1.data = b2.data and b1.a_count = b2.a_count and b1.a_id <> b2.a_id
"
24669,Listing specific data in Query,"  SELECT 
  Students.StudentName,
  Students.StudentNumber,
  Schools.SchoolAddress 
FROM
  XSchools 
  INNER JOIN YStudents 
    ON Schools.schoolName = Students.schoolName 
WHERE Schools.schoolName = 'London School' 
"
13853,getting the index of set bits from an int column in mysql,"SELECT
    MAKE_SET( val, '1', '2', '3', '4', '5', '6', '7', '8', '9' )
FROM
    example
"
3022,SQLite two columns from table joined on same other table,"SELECT
  TA.name,
  TB.name
FROM T1
  LEFT JOIN T2 TA ON(T1.person1 = TA.id)
  LEFT JOIN T2 TB ON(T1.person2 = TB.id)
"
20159,Filtering on views,"Select Location, Store, Result from
  (Select Location, Store, Result
    , Row_Number() over (partition by Location, Store 
            order by case Result when 'Executed' then 1 else 2 end) as RN
from Table
  ) a
where RN = 1
"
6624,How can I associate values in a table with ranges in another table?,"select * 
from entries as a
left outer join ranges as b 
  on (a.v between b.x and b.y);
"
15771,mysql update field's character,"UPDATE yourtable SET `alias`=REPLACE(`alias`,'_','.');
"
30632,Some sql queries work in terminal but not with db_query() function in Drupal 6 Why..?,"$sql = ""SELECT DATE_FORMAT(NOW(), '%%Y') - DATE_FORMAT(DOB, '%%Y') - (DATE_FORMAT(NOW(), '00-%%m-%%d') < DATE_FORMAT(DOB, '00-%%m-%%d')) AS age from test where user_name = '%s'"";
"
7082,How best to represent rational numbers in SQL Server?,"CREATE TABLE dbo.Whatever(
   Numerator INT NOT NULL,
   Denominator INT NOT NULL,
   Value AS (Numerator / Denominator) PERSISTED
)
"
6250,ORDER JOIN Left not taking effect,"select * from
(select a.id, field_list_you_want from table1 a
left join table2 o ON a.id = o.item_id

order by a.id,o.date desc) temp
group by id 
"
6859,"INSERT, and get the auto-incremented value"," insert into language(name) values ('value');
 SELECT IDENTITY_VAL_LOCAL();
"
32382,SQL JOIN : Help using join inisted subquery,"SELECT e.id, 
       e.name 
FROM   emp e 
       INNER JOIN deptid D_X 
               ON e.empid = d_x.empid 
                  AND deptid = 'X' 
       LEFT JOIN deptid D_Y 
              ON e.empid = d_Y.empid 
                 AND deptid = 'Y'
WHERE  d_Y.empid IS NULL 
"
25666,SQL select items that span entire range of attribute,"SELECT * FROM T 
WHERE  tog = 'yes' and val in (select val from t where tog='no')

UNION 

SELECT * FROM T 
WHERE  tog = 'no'  and val in (select val from t where tog='yes')
"
12695,Derby's handling of NULL values,"insert into T_AUTHOR (
  ID, FIRST_NAME, LAST_NAME, 
  DATE_OF_BIRTH, YEAR_OF_BIRTH, ADDRESS) 
VALUES ( 
  1000, 'Lukas', 'Eder', 
  '1981-07-10', null, null 
);
"
28507,Is there a smart way to link a field to another field?,"select
    s.SourceName as DensitySource,
    m.*
from
    metals m
    inner join SourceMatrix sm on
        m.SourceKey = sm.SourceKey
    inner join Source s on
        sm.DensitySourceKey = s.SourceKey
"
13819,MySQL / Searching Two Tables,"SELECT photoID AS contentID, colA, colB, ..., 'photo' AS ContentType
    FROM photos
UNION ALL
SELECT videoID AS contentID, colA, colB, ..., 'video' AS ContentType
    FROM videos
"
11132,SQL view with date calculations,"select H1.InvID,I.InventoryName,H1.SiteID,H1.[Timestamp] [date in],
MIN(H2.[Timestamp]) [date out] 
from    History H1 left outer join History H2
on      H1.InvID=H2.InvID and H1.[Timestamp]<H2.[Timestamp]
join Inventory I on I.InventoryID= H1.InvID
where   H1.SiteID=1
group by    H1.InvID,I.InventoryName,H1.SiteID,H1.[Timestamp]
"
6848,Update table from other table where row equal with a value,"UPDATE  [dbo].[TABLE1]
SET     CapelaWin  = 2,
        ProcyonWin = 1
from [dbo].[TABLE1] inner join [dbo].[TABLE2] on [dbo].[TABLE1].fld1 =[dbo].[TABLE1].fld2
WHERE   [dbo].[table2].[VictoryNation] = 1;
"
3167,SQL Server : Conditional Column on Select query,"select 
productname, total, 
case when total < 100 then 'Bad' 
     when total >= 100  and total < 200 then 'OK'
     when total > 200 then 'Good'
end as salestate
from
(       
select 
p.ProductName, sum(sd.Price*sd.Quantity) as Total
from Products p
left join [Sales Details] sd on p.ProductID = sd.ProductID
group by p.ProductName
) t
"
20098,Postgres unique combination constraint across tables,"CREATE OR REPLACE FUNCTION check_filename(product_id integer, file_id integer)
RETURNS boolean AS
$$
    LOCK product_attachment IN SHARE MODE;
    SELECT (COUNT(*) = 0)
    FROM product_attachment pa
    JOIN file f1 ON f1.file_id = pa.file_id
    JOIN file f2 ON f1.filename = f2.filename
    WHERE pa.product_id = $1 AND f2.file_id = $2
$$
LANGUAGE 'plpgsql'

ALTER TABLE product_attachment
ADD CONSTRAINT check_filename CHECK
(check_filename(product_id, file_id))
"
39172,View or Sub-query in MySQL,"select u.*, c.Categories_Name, s.Sub_Categories_Name
    from Users as u
    left outer join Categories as c
        on c.Category_ID = u.Category_ID
    left outer join SubCategories as s
        on s.Sub_Category_ID = u.Sub_Category_ID;
"
28236,MySQL. Insert UTF-8 characters to database,"if (!$mysqli->set_charset(""utf8"")) {
    printf(""Error loading character set utf8: %s\n"", $mysqli->error);
} else {
    printf(""Current character set: %s\n"", $mysqli->character_set_name());
}
"
36932,How to find a full node in a recursive SQL query,"ret r ON p.ParentID = r.ID
"
29590,SQL Cursor/Population Question,"INSERT INTO dbo.TmpFeesToRules1 (name, LookupId)
SELECT DISTINCT name, 0 FROM Fee

INSERT INTO Lookup (LookupType, LookupDesc)
SELECT 'FEE', name FROM dbo.TmpFeesToRules1

UPDATE TFTR
SET
    LookupID = LU.id
FROM
    Lookup LU
INNER JOIN dbo.TmpFeesToRules1 TFTR ON
    TFTR.name = LU.LookupDesc
WHERE
    LU.LookupType = 'FEE'
"
6317,sql dynamic replacement,"UPDATE dsopi_person_addr_rule ADDR
SET new_col = addr.src_address_line1
WHERE regexp_like (UPPER(addr.src_address_line1),   
                     'DEP|DPT$|ABT|DIP.|DIPART|AFDEL|AVDEL|AVD.|DIV|PGRD|PGP|PPG')
"
32650,Combining 2 Oracle Tables,"with res as(
select ""Id"" , ""Row"" , ""Description"" ,  ""Type"" , ""Answer"", ""Code"", ""ClientId"" from A

union all

select B.""Id"" as ""Id"" , B.""Row"" as ""Row"" , B.""Desc"" as ""Description"",
 B.""Type"" as ""Type"", null as ""Answer"", B.""Code"" as ""Code"", A1.""ClientId"" as ""ClientId""
 from B inner join (select distinct ""ClientId"", ""Code"" from A) A1 ON B.""Code""= A1.""Code""
 ) 
select * from res order by ""Code"", ""ClientId"", ""Answer""
"
17284,Compare values from 2 tables based on Dates from one of the 2 tables?,"Select p.ProfileName, p.AggregationDate,
p.TotalSalesAmount as ProfileAmount, a.DataValue as AggregationAmount,
Case When p.SalesAmount <> a.DataValue Then 1
else 0
end as Equal
From Aggregation a 
Inner Join ProfileReconcilation p On Convert(Date,p.AggregationDate) = a.DataDate
"
25282,How to set textview to show more than 1 line of database value?," <TextView
    android:id=""@+id/txtview""
    android:layout_height=""fill_parent""
    android:layout_width=""wrap_content""
    android:maxLines=""4""
    android:lines=""4"" />
"
6545,"MySQL - display rows of names and addresses grouped by name, where name occures more than once","SELECT t.name_id,
       t.last_name,
       a.street_address
  FROM NAME t
  JOIN ADDRESS a ON a.name_id = t.name_id
  JOIN (SELECT n.last_name
          FROM NAME n
      GROUP BY n.last_name
        HAVING COUNT(*) > 1) nn ON nn.last_name = t.last_name
"
36719,How To Rank In Oracle SQL Per Group For Whole Table?,"SELECT 
    D57.PERSON_REF, D57.START_DATE, D57.COMPDATE, 
    RANK() OVER (PARTITION BY PERSON_REF ORDER BY D57.COMPDATE asc) rnk 
FROM D57 
"
5249,Counting Distinct ID,"SELECT COUNT(DISTINCT q_id) AS Count
FROM table1
WHERE q_id IN (
    SELECT q_id
    FROM table1
    GROUP BY q_id
    HAVING MIN(q_status)<> 'Called'
)
"
7818,How to replace nth character in sql server,"select STUFF(ABC, ""Here your int position to replace"", 1, 'X') from XXX
"
2039,Database model issue with multiple cascade paths and 'on delete set null',"CREATE TRIGGER PARENT_TRIGGER ON PARENT_TABLE INSTEAD OF DELETE AS
BEGIN

    SET NOCOUNT ON;

    DELETE FROM CHILD_TABLE
    WHERE EXISTS (
        SELECT * FROM deleted
        WHERE CHILD_TABLE.PK = deleted.PK
    );

    -- You can DELETE from other child table here, etc...

END
GO
"
13883,Select rows with same id but different value in another column,"SELECT *
FROM YourTable
WHERE ARIDNR IN (
    SELECT ARIDNR
    FROM YourTable
    GROUP BY ARIDNR
    HAVING COUNT(*) > 1
)
"
8347,Foreign key not null default value for undirectional ManyToOne association,"alter table order add column product int8 not null default 0;
"
17902,Generating DDL script for object without schema name baked in using DBMS_METADATA.GET_DDL?,"DBMS_METADATA.SET_REMAP_PARAM(th,'REMAP_SCHEMA','HR',NULL);
"
7689,SQL to delete the duplicates in a table,"DELETE FROM transaction t1
 WHERE EXISTS( SELECT 1
                 FROM transaction t2
                WHERE t1.date = t2.date
                  AND t1.refnumber = t2.refnumber
                  AND t1.parentFolderId = t2.parentFolderId
                  AND t2.id > t1.id )
"
33792,Get all actions of the last three users,"SELECT  a.user_ID, a.action
FROM    tableName a
        INNER JOIN
        (
            SELECT  DISTINCT user_ID
            FROM    tableName   
            ORDER   BY ID DESC
            LIMIT   3
        ) b ON user_ID = b.user_ID
"
3691,DESCRIBE via database link?,"select column_name, data_type from all_tab_columns where table_name = 'TABLE_NAME';
"
38760,What is the best way to assign the returned value of a stored proc to a variable in SQL?,"declare @localVariable int
exec @localVariable =GetMyValue
select @localVariable
"
3197,SQL Server - Inserting a specific set of rows from one table to another table,";with cte as (
   select 
      *, 
      row_number() over(order by some_field ) as rn
   from table_one
)
insert into table_two ( fields )
  select fields from cte
   where rn < 1000000
"
6290,Get first three rows : with clause,"with TEMPRESULT AS 
(
    select * from 
    (
      select CONTACTS.line_id , count(*) totalcount
      from CONTACTS
      where (((E_DATE-S_DATE)*24*60*60)<=60 and to_char(S_DATE,'YYYY-MM-DD')='2015-12-12') 
      group by CONTACTS.line_id
      order by totalcount DESC
    ) x
    where rownum < 3
)  
"
30388,How to Update with a Self join?,"update results as r set
    status = 'W'
from (
    select t.seats, max(t.votes) as max_votes
    from results as t
    group by t.seats
) as a
where a.seats = r.seats and a.max_votes = r.votes; 
"
29721,MS Access SQL Get Latest Records From Each Category,"SELECT * 
FROM my_table AS T1
WHERE T1.report_date = (SELECT MAX(report_date) 
                        FROM my_table AS T2  
                        WHERE T1.category = T2.category)
"
23031,Return all child records related to parent,"SELECT T1.acct#, T1.name, T2.cfseq, T2.cfaal1, T2.cfacc#
FROM data.table1 T1
JOIN  data.table2 T2 ON T1.acct# = T2.cfacc# 
where
    T1.acct# in (select cfacc# from T2 where cfaal1 like '%POD%')
"
17509,Storing session in database with CakePHP 2.0,"<?php
Configure::write('Session', array(
    'defaults' => 'database',
    'handler' => array(
        'model' => 'cake_sessions'
    )
));
"
14305,How to find values from one table to limit other table?,"SELECT *
FROM QuestionTable
WHERE ID NOT IN
    (SELECT IDOFQuestion as ID FROM tableQuestion WHERE USER = 'USERHERE')
"
37275,Use a variable as a table name in a Alter Table Statement,"declare
   l_newtablename varchar2(50);
begin
   l_newtablename := 'TABLE_LERO_' || TO_CHAR (SYSDATE, 'MM_DD_YYYY');
   execute immediate 'ALTER TABLE TABLE_LERO RENAME TO ' || l_newtablename;
end;
/
"
10452,SQL Server : convert varchar to numeric with sign at the end,"DECLARE @TestConvert VARCHAR(MAX) = '1234.94-'
SELECT PARSE(@TestConvert AS  DECIMAL(18, 4)) AS Converted

Converted
---------------------------------------
-1234.9400

(1 row(s) affected)
"
35226,Add and order row on SQL result,"with cte_number_list as (
  select     rownum my_number
  from       dual
  connect by level <= 5)
select t.my_date,
       l.my_number,
       t.type
from   cte_number_list l left outer join
       my_table        t partition by (t.my_date)
                         on l.my_number = t.my_number;
"
31103,counting matches in sql,"SELECT     Departments.DepartmentName,
           count(Surveys.DepartmentID) as [survey count]
FROM         Departments LEFT JOIN
              Surveys ON Departments.DepartmentID =  Surveys.DepartmentID
 GROUP BY Departments.DepartmentName
"
7832,Retrieving rows based on time in SQL Server 2008,"SELECT *
FROM MyTable
WHERE StartTime <= '08:40:00'
  AND EndTime   >= '08:00:00'
"
1751,Get all columns of a table from a different database,"select column_name from Database_Name.information_schema.columns
where table_name = 'Table_Name' AND table_schema = 'dbo'
"
35555,SQL UPDATE statement to update a table with values from another table with no unique identifer,"UPDATE Table1
    JOIN Table2
        ON Table1.Col1 = Table2.Col2
SET Table1.Col2 = Table1.Col2/Table2.Col2
"
31367,Moving data by length,"INSERT INTO words_3char SELECT word FROM all_words WHERE LENGTH(word)=3;

DELETE FROM all_words WHERE LENGTH(word)=3;
"
23499,Where and if clause in SQL query,"SELECT * from A 
where name = 'blah' 
and (@flag = 1 or age = 13)
"
11263,store mysql query information chef,"require 'mysql'
db = ::Mysql.new('host', 'username', 'password', nil, 'port', 'socket') # varies with setup

users = db.query('SELECT * FROM users')

#
# You might need to manipulate the result into a more manageable data 
# structure by splitting on a carriage return, etc...
#
# Assume the new object is an Array where each entry is a username.
#

file '/etc/group' do
  contents users.join(""\n"")
end
"
8314,Oracle 11g : Sql Developer : How to execute more than one anonymous block,"Begin
 execute do something
end;
/

Begin
 execute do something
end;
/
"
21041,previous trimester in oracle SQL,"SELECT TRUNC(TRUNC(SYSDATE, 'Q') -1, 'Q') AS startLastQuarter,
       TRUNC(SYSDATE, 'Q')-1/(24*60*60)   AS endLastQuarter,
       TRUNC(SYSDATE, 'Q')                AS startThisQuarter    
FROM DUAL;
"
21969,Why would this query cause a Merge Cartesian Join in Oracle,"SELECT RTRIM (position) AS ""POSITION"", 
.  // Other fields 
. 
. 
FROM schema.table x 
     , ( select get_fiscal_year_start_date (SYSDATE) as fiscal_year 
         from dual ) fy
WHERE hours > 0  
AND pay = 'RGW' 
AND NOT EXISTS( SELECT position 
                FROM  schema.table2 y 
                where y.date = fy.fiscal_year
                AND y.position = x.position ) 
"
38588,Update a column based on its current value,"update the_table
  set team = case 
                when team = 1 then 2
                else 1
             end
where team in (1,2);
"
24147,SQL Server multiple conditions from table,"SELECT * FROM `table1` t1
LEFT JOIN `table2` t2 ON t1.member_id = t2.member_id
WHERE t2.date BETWEEN t1.date_start AND t1.date_end
"
24845,TSQL Multiple insert on splitstring,"INSERT INTO Tags_Accounts 
    (data, dataType, dataLocation, tag, whoAdded, whenAdded)
SELECT 
    @dbData, @dbDataType, @location, Name, @ntid, GETDATE() 
FROM dbo.splitstring (@tags);
"
19706,Relational Algebra and Confusing one Complex Examples,"all students
except
(
    all combinations of students and CS courses
    except
    all taken courses
)
"
7182,How to get the sum under different conditions in one query?,"SELECT SUM(CASE 
             WHEN active_flag = 1 THEN value + sal 
             ELSE 0 
           END) AS sump,
       SUM(CASE 
             WHEN active_flag = 2 THEN value + sal 
             ELSE 0 
           END) AS sumn 
FROM   loans 
WHERE  active_flag IN ( 1, 2 ) 
"
1835,Mysql subquery question,"SELECT foo.name
FROM foo
WHERE NOT EXISTS (SELECT 'x'
                  FROM bar
                  WHERE bar.fooid = foo.id
                    AND bar.value > 0)
"
2543,Advanced SQL GROUP BY query,"SELECT Category, Count(*) as TheCount
FROM
(
  SELECT Category1 as Category
  FROM Items
  UNION ALL
  SELECT Category2
  FROM Items
) sub
GROUP BY Category
"
14435,Execute Immediate bind variable,"CREATE OR REPLACE FUNCTION get_size(v_table_name IN VARCHAR2) 
   RETURN NUMBER IS total_size NUMBER(16);
   plsql_statement VARCHAR2(500)
BEGIN
    plsql_statement := 'SELECT COUNT(*) FROM  ' || v_table_name;
    EXECUTE IMMEDIATE plsql_statement INTO total_size;
    RETURN(total_size); 
END;
/


EXEC DBMS_OUTPUT.PUT_LINE(get_size('employees'));
"
9047,Select statement gives different set of records,"Select count(*) from stu_empl_pers a 
WHERE (a.faculty=1  OR a.staff=1) 
      AND a.status='A' AND a.site_Id = 'DEXLER';
"
39922,SQL Merge - Persist data,"MERGE dbo.T1 AS tgt
USING (SELECT ...) AS src ON ...
WHEN MATCHED THEN
    UPDATE ...
WHEN NOT MATCHED THEN
INSERT ...

OUTPUT $action, inserted.col1, inserted.col2, deleted.col1, deleted.col2
INTO @NewTable (action, inserted_col1, inserted_col2, deleted_col1, deleted_col2);
"
32523,How to distinguish if a database object (in Oracle) is a table or view,"select c.table_name 
from user_tab_columns c, user_tables t
where c.table_name = t.table_name
and c.column_name='STUDENTID';
"
11873,comparision of two columns within a single table,"SELECT `B`, COUNT(*) AS `Count`
FROM `Alpha` 
GROUP BY `B`
"
1531,Looping through a list of SQL data in VisualBasic.NET,"For Each row As DataRow In dtDataTable.Rows
    If row.Item(""fDateAdded"") = *your match criteria* Then
        *Do something - you can utilies* row.Item(""fName"") *if you need*
    End if
Next row
"
4814,Counting Combinations of rows/columns across one table,"SELECT *
FROM FilteredContact 
PIVOT ( count(p_id)
        for datatel_prospectstatusname IN ([Accepted], [Enrolled])
      ) as p
"
2726,SQL Group By With Count Zero,"SELECT 
    DocID
,   SUM(CASE WHEN Status <> 'Archived' THEN 1 ELSE 0 END) AS ArchivedCount
FROM 
    Doc
GROUP BY
    DocID
ORDER BY 
    DocID
"
19438,How to make a Named Calculation in SSAS return the minimum date while execution,"min(date) over(partition by customerID)
"
31977,Database Design: Should I create one table or two for this scenario?,"Id (PK)
Version
StartTime
EndTime
LaborDetailDescription
LaborType (FK) 
IndirectNumber (FK)
JobNumber (FK)
JobType
DirectType (FK) 
GoodQty
ScrapQty
SetupPercent
"
172,SQL Outer Joins with count function,"SELECT
  u.uid,
  firstname,
  lastname,
  email,
  zipcode,
  city,
  street,
  Count(*) AS 'likes'
FROM User u
LEFT JOIN Like l ON u.pid = l.pid
GROUP BY
  u.uid,
  firstname,
  lastname,
  email,
  zipcode,
  city,
  street
"
14318,How can i get sql result column as csv without 'for xml'-clause?,"SELECT 
  a
,   MAX( CASE seq WHEN 1 THEN (b) ELSE '' END )
  + MAX( CASE seq WHEN 2 THEN (', ' + b) ELSE '' END ) 
  + MAX( CASE seq WHEN 3 THEN (', ' + b) ELSE '' END ) 
  + MAX( CASE seq WHEN 4 THEN (', ..') ELSE '' END )
  AS b
FROM (SELECT 
        t1.a
      , t1.b
      , (SELECT COUNT(*) FROM t t2 WHERE t1.a = t2.a AND t2.b <= t1.b) AS seq 
      FROM t t1) AS temp
GROUP BY a
"
32824,Data Base Query,"SELECT state_name,district_name from TableName WHERE id='jk-01' //you can have your specific id here
"
36095,Returning multiple values in a CASE expression,"CASE
  WHEN (org.org_misc_data = 'PAC') THEN 'pac|' ELSE '' END
  + CASE 
    WHEN (org.dues_category = 'PART') THEN 'partner_member'
    WHEN (org.dues_category = 'FREE' AND org.org_status_flag = 'P') THEN 'associate_member'
    ELSE 'non_member'
END AS org_status
"
2208,SQL isset and not showing blank 'cells',"WHERE col1 IS NOT NULL
"
8669,How can I store a calendar data in database,"long millis = calendar.getTimeInMillis();
"
8378,Add Zero to the left in a field and concatenate Oracle,"select to_char(d, '99') || ' ' || to_char(h, '00') || ':'  || to_char(m, '00') || ':00'
"
16548,Alias for some code without CREATE FUNCTION?,"select foo_a, builtin(foo_a)
from (
    select foo(a) as foo_a
    from foobar
) s
group by 1
having builtin(foo_a) > bar()
order by 1
;
"
3888,SQL Server counter column that increments when a new record has been added,"SELECT *, 
  ROW_NUMBER() OVER (PARTITION BY ReportId ORDER BY Time) as IncrementColumn
FROM ProcessMaster
"
9282,Count only null values in two different columns and show in one select statement,"select
    (select count(*) from table1 where column1 is null) as 'Column1Count',
    (select count(*) from table1 where column2 is null) as 'Column2Count';
"
22870,SQL Statement to eliminate duplicates based on value in another column,"SELECT a.*
FROM Table1 a
INNER JOIN
(
SELECT ID, sdate = min(SplitDate)
FROM Table1
GROUP BY ID
) b
ON a.ID = b.ID
AND a.SplitDate = b.sdate
"
14128,Android: can I use one SQLiteOpenHelper class for multiple database files?,"public class DBOpenHelper extends SQLiteOpenHelper {

    public Helper(Context context, String dbName, int dbVersion) {
        super(context, dbName, null, dbVersion);
    }
...
}
"
29734,MS Access Substring,"SELECT ...
FROM [Service Calls]
WHERE ([Service Calls].[Service Address]) LIKE ""*"" & ([Forms]![Search]![sA]) & ""*"";
"
27467,mysql one to many in one row," SELECT t1.`id_c`,c.`name`,t1.latest,t1.`note` FROM `tablea`c

 INNER JOIN
 (
 SELECT t2.`id_c`,t2.latest,t3.`note` from `tableb` t3 

 INNER JOIN

 (SELECT `id_c`,MAX(`data_visited`) AS latest from
`tableb` 
GROUP BY(`id_c`))t2
 ON (t3.`id_c`=t2.`id_c`) AND (t3.`data_visited`=t2.latest)

)t1
ON(c.`id_c`=t1.`id_c`) 
"
7673,SQL run from Excel cannot use a temporary table,"set nocount on
declare @t table(fid int)  -- I'm sure I could add the rest of the columns if I wanted to
insert @t select freq_id from compass3.dbo.freq
select * from @t where fid>2
"
29865,"Always show ""label"" in a self join","SELECT ""COCAT_NAME"" AS MAIN,
(SELECT ""COCAT_NAME""
FROM cocat sub
LEFT JOIN cocatlnk ON ""COCATLNK_CAT"" = sub.""COCAT_ID""
WHERE ""COCATLNK_CO""='[lv_CO]' AND sub.""COCAT_MAIN""= main.""COCAT_ID"") AS SUB
FROM cocat main
WHERE ""COCAT_NODE""='0'
ORDER BY MAIN
"
30586,Simple DB query,"SELECT Users.id, Users.username, COUNT(*) AS classes 
  FROM Users 
LEFT OUTER JOIN Classes ON User.fk_class_id = Classes.id 
       GROUP BY Users.id, Users.username
"
31280,Get first value as NULL in SELECT query result,"Select Col1 from tbl1 where Col2= 'abc' Union select null as Col1 from dual; 
"
23523,how to return comma seperated values in oracle SP,"SELECT LISTAGG(last_name, ', ') 
    WITHIN GROUP (ORDER BY hire_date, last_name) ""Emp_list"",
    MIN(hire_date) ""Earliest""
    FROM employees
    WHERE department_id = 30;

Emp_list                                                     Earliest
------------------------------------------------------------ ---------
Raphaely, Khoo, Tobias, Baida, Himuro, Colmenares            07-DEC-02
"
22427,How can I sort the data in a table over four columns?,"SELECT
    t.KeyId,
    t.TypeName,
    t.GroupId,
    t.SpecialType
FROM @Table t
ORDER BY 
    KeyId,
    CASE WHEN SpecialType = 'R' THEN 1 ELSE 2 END,
    COUNT(CASE WHEN t.SpecialType = 'R' THEN SpecialType END) OVER (PARTITION BY t.GroupId) DESC,
    GroupId,
    SpecialType
"
4488,Oracle DB: How can I write query ignoring case?,"alter session set NLS_COMP=ANSI;
alter session set NLS_SORT=BINARY_CI;
"
22667,SQL query with start and end dates - what is the best option?,"where sysdate between effectivedate and enddate
"
17457,MySQL get a summary of data based on part of a string,"select 
  substring_index(email,'@',-1) as domain
  ,count(*) as userCount 
from your_table
group by domain 
order by usercount desc;
"
4484,Mysql inner query to get sum of amount,"SELECT o.id, o.vendor_id, SUM(product_amount) product_amount
FROM `order` o 
INNER JOIN order_products op ON o.id = op.order_id 
INNER JOIN vendors_product vp ON a.vendor_id = vp.vendor_id AND op.product_id = vp.product_id
GROUP BY o.id, o.vendor_id;
"
18802,"Update a column value, replacing part of a string","UPDATE urls
SET url = REPLACE(url, 'domain1.com/images/', 'domain2.com/otherfolder/')
"
1675,"Sort comments by upvotes-downvotes, make sure ones without votes are displayed above negative","SELECT c_id, c_text, c_date, c_parentid, u_username,
       coalesce((select sum(cv.cv_type = '1') from comment_votes cv where cv.cv_commentid= c.c_id ), 0) as upvotes,
       coalesce((select sum(cv.cv_type = '0') from comment_votes cv where cv.cv_commentid = c.c_id ), 0) as downvotes
FROM comments c INNER JOIN
     users u
     ON u.u_id = c.c_userid
WHERE c.c_postid = ? AND c.c_parentid = 0
ORDER BY upvotes - downvotes DESC
LIMIT 100;
"
8814,How to handle null in SQL conditional clauses?,"UPDATE company 
SET views = COALESCE(views, 0) + 1,
    trendingViews = IF(viewed != '2012-05-21 00:00:00', 1, trendingViews + 1),
    viewed = IF(viewed != '2012-05-21 00:00:00', '2012-05-21 00:00:00', viewed)
WHERE id = '3024'
"
4676,Dynamic Order by SELECT with multiple columns,"SELECT * FROM Products
ORDER BY 
CASE WHEN @SortIndex = 1 THEN Price END ASC,
CASE WHEN @SortIndex = 2 THEN Price END DESC, 
CASE WHEN @SortIndex = 2 THEN Title END ASC 
"
28680,Complicated select statement with SQL (mysql),"SELECT e.id AS entryid, us2.subunit_id AS subunitid,
    FROM unit_subunits AS us1 
        JOIN unit AS u1 ON (us1.unit_id = u1.id) 
        JOIN entry AS e ON (u1.entry_id = e.id)
        JOIN unit AS u2 ON (e.id = u2.entry_id)
        JOIN unit_subunits AS us2 ON (u2.id = us1.unit_id)
    WHERE us1.subunit_id = 5;
"
30106,Transpose rows to column and join table,"select
  a.id,
  max(case when a.key_info = 'amount' then a.value_info end) as amount,
  max(case when a.key_info = 'currency' then a.value_info end) as currency,
  max(case when a.key_info = 'level' then a.value_info end) as level,
  i.status
from
  attribute a
  join instance i on a.id = i.id
group by
  a.id,
  i.status
"
8616,Sorting dates stored as varchar/rfc822,"SET @dt = 'Mon Jun 13 2011 11:30:00 GMT-0400 (EDT)';

SELECT    
CONVERT_TZ(
  -- Parse all, but timezone
  STR_TO_DATE(@dt, '%a %b %e %Y %H:%i:%s'),

  -- Parse timezone to '+NN:NN' format
  INSERT(SUBSTRING_INDEX(SUBSTRING_INDEX(@dt, 'GMT', -1), ' ', 1), 4, 0, ':'),

  -- Our unified timezone
  '+00:00'
);

-- Result: 2011-06-13 15:30:00
"
10611,SQL Server: Use output from first insert to insert into second table,"BEGIN  
SET NOCOUNT ON;

 /* Here declare a Table Variable */

DECLARE @Table_Var TABLE(itemID INT)



    INSERT INTO Table1(colA,colB,colC)
    OUTPUT inserted.itemID  INTO @Table_Var(itemID)
    SELECT  @colA,@colB,@colC


    /* Now do the insert into Table 2*/

    INSERT INTO TABLE2
    SELECT itemID FROM @Table_Var
END
"
24979,How I can use 'OR' in my db queries,"  $query = db_select('watchdog', 'wa');
    $query->orderBy('wa.timestamp', 'DESC');
    $or = db_or();
    $or->condition('blablabla', 'closed', '=');
    $or->condition('blablabla', 'blabla', '=');
    $or->condition('blablabla', 'balblabla', '=');
    $query->condition($or);
    $query->range(0, 20);

    $result = $query->execute();
"
15393,MySQL query when grouping duplicate records,"SELECT a.*,b.sku
FROM sku_parent_attributes AS a
INNER JOIN
sku_parent_attributes as b
ON a.sku = b.sku
GROUP BY b.sku
HAVING COUNT(b.sku) = 3
"
38173,Comparing corresponding rows from the same column and same table,"Select customer_id, state, last_name, first_name
FROM Customers
WHERE (((state) In (Select state FROM Customers GROUP BY state HAVING (((Count(state))>1)))))
ORDER BY state,last_name, first_name
"
20483,access query to filter and combine count,"SELECT DISTINCT tableA.num, [tableA].[val]+[tableB].[val] AS Expr1
FROM tableA INNER JOIN tableB ON tableA.num = tableB.num
WHERE (((tableA.val)>=6) AND ((tableB.val)>=6));
"
36883,"Group by two fields, and having count() on first field","select userid, videoid
from (SELECT userid, videoid, count(distinct videoid) over (partition by userid) as cnt
      FROM table_play_list
      WHERE SOME CONDICTION
     ) t
where cnt > 2;
"
26070,2-part AfterUpdate() subroutine not working,"If Me.Dirty Then
    Me.Dirty = False
End If
"
29197,SQL Server Date Time custom Date,"declare @x datetime = '03-01-2013';
select @x = DateAdd(hh, 6, DateDiff(dd, 0, @x))
print @x
"
24715,Data size of table by column?,"select sum(data_length(col))
from table t;
"
39372,Counting most of entries (mode) in hive data,"select hour(ts), count(*) as cnt 
from twitter.full_text_ts
where to_date(ts) = '2010-03-06'
group by hour(ts)
order by cnt desc;
"
35453,How to show All names in order from Employee table and make one of the names shows up first,"Select Name
From Employees
Order By Case When Name = 'Odai' Then ' ' Else Name End
"
39318,Picking out respective serviceID for MAX() SQL SERVER- Row_number()?,"select a.*
from (select a.*,
             row_number() over (partition by Customer_nr order by [Months left till service expiry] desc) as seqnum
      from a
     ) a
where seqnum = 1;
"
35124,Birthdays in SQL... disregard year in a date value,"SELECT
   *
FROM
   Users
WHERE
   MONTH( Users.Birthdate ) = MONTH( GetDate() )
   AND
   DAY( Users.Birthdate ) = DAY( GetDate() )
"
38521,sql select with argument which can be NULL,"SELECT * from some_table where field IS NOT DISTINCT FROM ?;
"
11795,Search keyword with LIKE %[keyword]%,"SELECT *
FROM TransactionDetails
WHERE TransactionDetail LIKE '%[[]Log]%'
"
39291,SQL questions for selecting correct data,"SELECT PC.product_id, KC.color_id, C.color_name 
FROM kit_color as KC
LEFT JOIN color as C
ON KC.color_id = C.color_id
LEFT JOIN product_color as PC
ON PC.color_id = C.color_id
WHERE KC.id = %s
"
19114,SQL Join Not Returning What I Expect,"SELECT COUNT(e.EventID), T.Customer, T.Year, T.Month
FROM [Event] e
INNER JOIN #T T ON (
  T.CustomerID = e.CustomerID and 
  T.Year = year(e.DateOpened) and 
  T.Month = month(e.DateOpened) 
  ) 
WHERE T.Year = 2008 
  and T.Month = 12 
GROUP BY T.Customer, T.Year, T.Month
ORDER BY T.Year, T.Month
"
24576,Regular expression for MySQL database,"SELECT EMP_ID
FROM emp_skills
WHERE skill_ID IN (2,3)     
GROUP BY EMP_ID
HAVING COUNT(EMP_ID) = 2    -- the total number of skill_ID
"
35487,Some doubts about this simple INNER JOIN query?,"SELECT VF.* FROM VulnerabilityAlertDocument_VulnerabilityFix VAD_VF
            INNER JOIN VulnerabilityFix VF ON VAD_VF.VulnerabilityFixId = VF.Id
            WHERE VAD_VF.VulnerabilityAlertDocumentId = 78385
"
363,Oracle string replacement,"UPDATE table
SET col = replace(col, 'item c', '')
"
33269,how to search string value in different datetime format?,"SELECT * FROM [BankaEntegrasyonEslesmeyenler] AS x  WHERE CONVERT (CHAR(10), x.Tarih, 104) = '09.01.2013'
"
39663,SQLite: How to update order data in table?,"CREATE VIEW ordered_view AS
SELECT name, cost
FROM mytable
ORDER BY cost DESC;

SELECT name, cost FROM ordered_view;
"
36798,How can I select a value from a table twice with different values,"SELECT       SUR.SU_Username  As RecieverName
           , SUS.SU_Username As SenderName 
FROM            Message 
               JOIN SystemUser SUR
                  on (SUR.SU_ID = Message.MessageReciever )
               JOIN SystemUser SUS
                  on (SUS.SU_ID = Message.SenderID )
"
30171,Insert date and time as unix_timestamp in Mysql,"INSERT INTO `skadate`.`ow_base_user_online` (`id`, `userId`, `activityStamp`, `context`, `misc`) 
VALUES (NULL, '1402', UNIX_TIMESTAMP(), '1', '1');
"
15860,sql query - update fields in existing with record values in the same table,"WITH C as 
(
  select Tracker.*,
    ROW_NUMBER() OVER (PARTITION BY GroupId ORDER BY Id) as RN
  FROM Tracker  
)  
UPDATE CT 
SET CT.topSort=CTU.topSort,
    CT.sideSort=CTU.sideSort

FROM C as CT
JOIN C as CTU ON (CT.rn=CTU.rn) 
                  and (CTU.GroupID=1)
WHERE CT.GroupID=2
"
11456,Double SQL Query in vb.net MySQLDataAdapter,"Dim DataAdapterInb As New MySqlDataAdapter
(""SELECT t.* FROM 
       //^Changed
(SELECT * From inbox WHERE receiverid='"" & ID & ""')t
LIMIT 0,5;"", MySqlConnection)                    //^Changed
"
16642,Querying Oracle Clob datatype,"SET SQLBL ON;
SET DEFINE OFF;

CREATE TABLE CLOB_TEST
(
clob_in CLOB
);

INSERT
INTO CLOB_TEST VALUES
  (
    'I am working as a DBA and senior database resource in L&T Infotech in Pune India'
  );


SELECT DBMS_LOB.SUBSTR(CLOB_IN,3000) ot FROM CLOB_TEST;

-----------------------------OUTPUT------------------------------------------

OT
I am working as a DBA and senior database resource in L&T Infotech in Pune India

-----------------------------OUTPUT------------------------------------------
"
38106,how to pass the result of SELECT statement to Stored Proc,"DECLARE @MyJobID INT

SELECT 
      @MyJobID = [JobId]
FROM [v_Jobs]
WHERE jobreference =177127

EXEC  [dbo].[s_someStoredProc] @JobID = @MyJobID
"
6462,How to test existence of table column on a linked server,"IF EXISTS 
(
    SELECT * 
    FROM [MY_SRVR].MY_DB.sys.columns c
    join [MY_SRVR].MY_DB.sys.tables t on t.OBJECT_ID = c.OBJECT_ID
    WHERE c.name = N'My_Column'
        AND t.name = N'My_Table'
)
"
35853,Serial Numbering in a group in a table,"SELECT *,
      [product_code] = CONCAT(LEFT(suppliers_name,2), suppliers_code,
                              RIGHT('0000' + CAST(rn AS VARCHAR(5)),5)) 
FROM (SELECT *,
             rn = ROW_NUMBER() OVER(PARTITION BY suppliers_code ORDER BY product_name)
      FROM table_name ) AS sub;
"
34226,Sample sql script to zip and transfer database backup file,"EXEC master..xp_cmdshell 'C:\""Program Files""\WinZip\wzzip C:\Database.bak.zip C:\Database.bak';
EXEC master..xp_cmdshell 'C:\""Program Files""\WinZip\wzunzip -o ""C:\Database.bak.zip"" ""C:\Database""';
EXEC master..xp_cmdshell 'xcopy ""C:\Database.bak.zip"" ""\\networkshare\Backups"" /Y'
"
6579,SSRS 2008 Wont return the correct Dataset from Stored Procedure,"CREATE TABLE #ReportTable(col1 ID, col2 varchar(80), etc)
IF Reportname = 'Foo'
Begin
    INSERT #ReportTable(col1, col2, ...)
    EXEC dbo.GetDataForReport1 '7131', 25
End

IF ReportName = 'Bar'
Begin
    INSERT #ReportTable (col1, col2, ...)
    EXEC dbo.GetDataForReport2 '7131', 25
End

SELECT col1, col2, ...
FROM #ReportTable
"
398,SQL query to fillter and update table,"    UPDATE Employee
    SET NAME = 
        SUBSTRING(name,CHARINDEX('(',name)+1,(CHARINDEX(')',name)-CHARINDEX('(',name)-1))+
        ' ('+SUBSTRING(name,1,CHARINDEX('(',name)-1)+')'
FROM Employee
"
2135,I need to set as foreign key which refers to one of the composite primary key in other table,"alter table store add constraint FK_store_merchant foreign key (mId, addId) references merchant (mId,addId)
alter table merchant add constraint FK_merchant_address foreign key (addId) references address (addId)
"
8596,Parameterized LIKE clause in SQL statement using Dapper,"SELECT * FROM Users WHERE Name LIKE @pName + '%'
"
24083,Compare two DATETIME only by date not time in SQL Server 2008,"IF CAST(DateField1 AS DATE) = CAST(DateField2 AS DATE)
"
8806,Query data in one table based on IDs from another,"SELECT *
FROM `contacts`
WHERE `user_id` IN (
    SELECT `user_id` FROM `users` WHERE `username` LIKE ""%mysite.com%""
)
"
12383,"SSRS, how can I iterate over a hard-coded set","declare @RegionTax table (
    Region nvarchar(10),
    Tax float
)

insert @RegionTax values ('Region 1', .05)
insert @RegionTax values ('Region 2', .06)
insert @RegionTax values ('Region 3', .07)

select
    *
from
    Products p, @RegionTax t
"
21458,mysql adding total price of certain products,"SELECT SUBSTRING(prod_id,3,2)
      ,SUM(price * on_hand)
 WHERE SUBSTRING(prod_id,2,1) IN ('TA','HP')
 GROUP BY SUBSTRING(prod_id,3,2)
"
23803,SQL Server : mirror/cache current day data for performance reasons,"Job 1 (10 Minutes to midnight)

create view my_view_yyyymmdd (yyyymmdd = today + 1)
with schema_binding 
as 
select from mytable where datecol >=day+1 and datecol < today+2 --dateliterals;
create clustered index on my_view_yyyymmdd (yyyymmdd = today + 1)


Job2 (midnight + 1 second)
drop synonym mysyn;
create synonym mysyn for my_view_yyyymmdd (yyyymmdd = today )
drop view my_view_yyyymmdd my_view_yyyymmdd (yyyymmdd = today - 1)
"
331,How enable all CONSTRAINT?,"ALTER TABLE sales CHECK CONSTRAINT ALL;
"
15489,XML data type in SQL Server?,"DECLARE @mySchema NVARCHAR(MAX);  
SET @mySchema = N'';  
SET @mySchema =@mySchema  +   
(
  SELECT * FROM ChartSetting1 
  FOR XML AUTO, ELEMENTS, XMLSCHEMA('ChartSetting1')
);

SET @mySchema =@mySchema  +   
(
  SELECT * FROM ChartSetting2 
  FOR XML AUTO, ELEMENTS, XMLSCHEMA('ChartSetting2')
);

CREATE XML SCHEMA COLLECTION [name] AS @mySchema;

-- we don't need these tables , drop them  
DROP TABLE ChartSetting1,ChartSetting2
"
3564,Conditional Inserts SQL,"UPDATE SerialNo2 SET SerialNo2.Degree = IIf([Mark]>90,""A"",""B"")
"
29703,How to get rid of NULL values in SQL Server 2008 table,"UPDATE Tableeee t
SET t.a1 = COALESCE(t.a1,-1),
    t.a2 = COALESCE(t.a2,-1),
    t.a3 = COALESCE(t.a3,-1)
    t.a4 = COALESCE(t.a4,-1)
"
26941,WHERE cast column name equals,"SELECT *
FROM (
   SELECT id, 
     col1 as [description], 
     col2 as [date1], 
     col3 as [image], 
     col4 as [date2], 
     col5 as [link], 
     col6 as [location], 
     col7 as [price], 
     col8 as [title]
   FROM tableName
) as subquery
WHERE [title] = 'Lemons'
"
17738,Select element where condition is met on all joined elements,"SELECT f.folderId,
    COUNT(fls.fileId) as filesCount,
    SUM(a.surname = 'X' and a.firstName = 'Y') as authorFilesCount
FROM `folders` f 
     INNER JOIN `file_relation` rel ON rel.folderId = f.folderId 
     INNER JOIN `files` fls ON fls.fileId = rel.fileId 
     INNER JOIN `authors` a ON a.authorId = fls.authorId 
GROUP BY f.folderId
HAVING filesCount = authorFilesCount;
"
10265,VBA not recognizing Value of Unbound Textbox for Query,"whereString = ""LabDate Between #"" & myStartDate & ""# AND #"" & myEndDate & ""#""
"
34392,Using an sql statement select next 4 items,"SELECT  ID, Foo, Bar
FROM     (SELECT  ROW_NUMBER() OVER (ORDER BY ID ASC) AS Row,
          ID, Foo, Bar
FROM    SomeTable) tmp
WHERE   Row >= @RowRangeStart AND Row <= @RowRangeEnd
"
9715,Updating external DBMS tables with SAS data using PROC SQL passthrough -- is this possible?,"/* Access database is ""C:/database.mdb"".
   Original table in database is ""original"". 
   Processed table is ""work.updates"". */

libname mdbfile ""C:/database.mdb"";

proc sql;
create table mdbfile.updates as select * from work.updates;
connect to access (path=""C:/database.mdb"");
execute (
  update original as a inner join updates as b on a.id = b.id
  set a.variable1 = b.variable1
  where condition = 1
) by access;
execute (drop table updates) by access;
disconnect from access;
quit;
"
20495,How do I make sure there are no duplicates in a mysql table?,"ALTER `table_name` ADD UNIQUE (`first_name`,`last_name`);
"
9981,MySQL: How to find where a specific primary key is used as a foreign key in other tables?,"SELECT 
  table_name, column_name     
FROM
  information_schema.key_column_usage
WHERE
  referenced_table_name = '<table>'
  and referenced_column_name = '<primary key column>'
"
14918,Fetching complete rows based on unique values from a non-unique column,"WITH Emp_Salary
AS
(
    SELECT 
        Column1
        , Column2
        , Salary
        , ROW_NUMBER() OVER (PARTITION BY Salary ORDER BY Column1) r  --numbers each row uniquely per salary
        FROM emp_details
)
SELECT
    Column1
    , Column2
    , Salary
FROM Emp_Salary
WHERE r = 1 -- Filters all but the first row per salary.
;
"
191,new to sql -subqueries,"select *
from questions Q
where not exists (
        select 1
        from student_answers A
        where A.question_id = Q.question_id
            and A.student_answer = Q.correct_answer
    );
"
35471,SQL group by and max and other fields,"SELECT a.*
FROM tableName a 
     INNER JOIN
     (
        SELECT ITEMID , MAX(DATEPHYSICAL) max_date
        FROM tableName 
        GROUP BY ITEMID 
     ) b ON a.ITEMID  = b.ITEMID AND a.DATEPHYSICAL = b.max_date
"
6479,SQL Statement except,"SELECT      ProdName, ProdSupplier, ProdCategory, ProdInvQty
FROM        PRODUCT
WHERE       (ProdInvQty  >= 5 
OR          ProdSupplier = 'Spaulding')

ORDER BY    ProdSupplier, ProdInvQty;
"
27006,Get the last twelve months worth of data from a database,"SELECT ... WHERE STR_TO_DATE(CONCAT(period_name,' 1 ',year),'%M %d %Y') >= DATE_SUB(STR_TO_DATE(CONCAT(most_recent_period_name,' 1 ',most_recent_year),'%M %d %Y'), INTERVAL 1 YEAR) ...;
"
9335,SQL subquery logic confusion,"SELECT ha1.user_id, COUNT(DISTINCT ha1.id) as count 
FROM hwc_attend ha1
INNER JOIN eve_detail ed ON ha1.at_id = ed.evdet_id
INNER JOIN hwc_attend ha2 ON ed.evdet_id = ha2.at_id 
LEFT OUTER JOIN pReviews pr ON ed.location = pr.ASIN AND cID = **location**
WHERE ha2.attendstate = 1
AND ed.location <> ''
AND ed.evdet_id > 999
AND pr.ASIN IS NULL
GROUP BY ha1.user_id
"
39911,How do I SELECT the row with maximum value for an attribute in SQL,"SELECT Branche, COUNT(Phones) FROM Branch
GROUP BY Branche
ORDER BY COUNT(Phones) DESC
LIMIT 1
"
18079,Setting default value using data from another table,"CREATE TRIGGER IF NOT EXISTS Test_2_B2_value
AFTER INSERT ON Test_2
FOR EACH ROW WHEN Test_2.B2 IS NULL
BEGIN 
NEW.B2 = (SELECT A1 FROM Test_1 LIMIT 1);
END
"
972,SQL Pivot table with updating values,"select id, 
    max(case when attributename = 'DocName' then attributevalue end) docname,
    max(case when attributename = 'Category' then attributevalue end) Category,
    max(case when attributename = 'Owner' then attributevalue end) Owner
from (
    select *, rank() over (partition by id order by modified desc) rn
    from yourtable ) t
where rn = 1
group by id
"
31187,How to Carry forward a column value while inserting other column values in mysql?,"INSERT INTO my_table 
SELECT NULL
     , 'time5'
     , x.batchid
     , 1026 FROM my_table x 
  LEFT 
  JOIN my_table y 
    ON y.id > x.id -- or y.timestamp > x.timestamp if that's more appropriate
 WHERE y.id IS NULL;
"
28605,How do you reduce a long query running up mysql resources that requires you to run multiple searches?,"Select news.*
From news n
    Join subscriptions s
       On s.subscribed_id = n.user_id
Where subscriber_id = <user id of john>
"
29669,MS Access SQL query counting values in more than one column,"SELECT OPTION,sum(count) from (
  SELECT OPTION1 as OPTION,COUNT(*) as count FROM Table GROUP BY OPTION1
  union all
  SELECT OPTION2,COUNT(*) as count FROM Table GROUP BY OPTION2
  union all
  SELECT OPTION3,COUNT(*) as count FROM Table GROUP BY OPTION3
)group by OPTION
"
11162,Lowercase or uppercase for SQL Statements,"#define SQL(...) #__VA_ARGS__
"
30739,"SELECT inheritance performance: LEFT OUTER JOIN vs ""super-table"" TYPE COLUMN","SELECT h.id, h.date, h.ip, h.user_id, hc.id, he.id
FROM history h LEFT JOIN
     history_connection hc
     ON h.id = hc.id LEFT JOIN
     history_email he
     ON h.id = he.id;
"
8248,SQL Selecting from two tables,"SELECT CI.CITY_NAME, CO.COUNTRY_NAME
FROM CITY CI INNER JOIN COUNTRY CO
ON CI.COUNTRY_ID = CO.COUNTRY_ID
WHERE CO.COUNTRY_ID = 1;
"
13809,oracle primary key start with letter,"CREATE SEQUENCE your_pk_seq;

CREATE TRIGGER trg_populate_pk
  BEFORE INSERT ON your_table_name
  FOR EACH ROW
BEGIN
  SELECT 'S' || to_char( your_pk_seq.nextval )
    INTO :new.primary_key_column
    FROM dual;
END;
"
11952,Grouping rows in tsql,"SELECT CampaignId, [1] AS Rate1, [2] AS Rate2, [3] AS Rate3
FROM 
(SELECT CampaignId, RateNumber, RateValue
FROM CampaignRate) p
PIVOT
(
SUM (RateValue)
FOR RateNumber IN
( [1], [2], [3] )
) AS pvt
ORDER BY pvt.CampaignId;
    GO
"
21298,Multiple record to be passed to a function which inserts it to a table,"SqlCommand cmd  = new SqlCommand(""YourSPName"", conn);
cmd.CommandType = CommandType.StoredProcedure;

// add the parameters the SP needs
cmd.Parameters.Add(new SqlParameter(""@Parm1"", parm1Value));
cmd.Parameters.Add(new SqlParameter(""@Parm2"", parm2Value));
.
.

// execute the SP
cmd.ExecuteNonQuery();
"
3392,SQL Query - select data from table A based on two fields in table B,"Select B.Name
From A
Inner Join B
  On A.date = B.date
  And A.step = B.step
Where A.status = '1'
"
32747,SQL Trigger Delete oldest duplicate,"with todelete as (
      select t.*, row_number() over (partition by HID order by TID desc) as seqnum
      from tbl8_update_transactions t
     )
delete from todelete
    where seqnum > 1;
"
18921,Get all data from parent record as the child record,"select S.RequestId, S.PrimaryRequestID, coalesce(P.Prefix, S.Prefix) As Prefix
from myTable P
right join myTable S on P.RequestID = S.PrimaryRequestID
"
28059,SQL Query - Concatenating Results into One String,"DECLARE @CodeNameString varchar(100)

SELECT 
   @CodeNameString = STUFF( (SELECT ',' + CodeName 
                             FROM dbo.AccountCodes 
                             ORDER BY Sort
                             FOR XML PATH('')), 
                            1, 1, '')
"
4009,SELECT count(*) with ORDER BY,"SELECT timeontheserver ,count(*) AS cnt FROM players 
WHERE totalpoints>? GROUP BY timeontheserver  ORDER BY timeontheserver DESC   
"
31854,Select/Insert only newly entered data from one table to another,"insert into dbo.calculationtable (ID, Server, Datetime, UptimeStatus)
Select ID, SERVER, CheckTime, ResultType
From dbo.sample 
Where CheckTime > (Select max(DateTime) From dbo.calculationtable)
GO
"
3386,summarizing many tables in mysql,"SELECT  col1 as `Record Number`, 
        COUNT(*) as `Number`, 
        GROUP_CONCAT(_name) as `table name`
FROM
(
    SELECT col1, 'table_1' as _name FROM table_1
    UNION ALL
    SELECT col1, 'table_2' as _name FROM table_2
    UNION ALL
    SELECT col1, 'table_3' as _name FROM table_3
) a
GROUP BY col1
"
6697,How to get current and previous ids of current id in one query(mysql),"select * from employee
where empid = (select max(empid) from employee where empid < 4)
   OR empid = (select min(empid) from employee where empid > 4)
"
3119,SQL - specifying a condition in COUNT / returning a value from the same field more than once in one SELECT,"SELECT u.USER_NAME As [User]
  , COUNT(ad.ACTIVITY_ID) As [Total Activities Late]
  , SUM(CASE WHEN ad.DAYS_LATE BETWEEN 1 and 7 THEN 1 ELSE 0 END) As [Upto One Week Late]
  FROM USERS u
  JOIN ACTIVITY_DATA ad
    ON u.USER_ID = ad.USER_ID
  WHERE ad.DAYS_LATE > 0 AND ad.COMPLETED_DATE is NULL
  GROUP BY u.USER_NAME
"
8838,MySQL where if statement,"SELECT *
FROM car
WHERE (? is null or car_type = ?) AND
      (? is null or owner_id = ?);
"
23731,Auto Increment Problem,"DBCC CHECKIDENT ( databasename.dbo.yourtable,RESEED, 0) -- will start from 1
"
35335,How can I aggregate two classes of values in a SQL query?,"select user_id, sum(case billable when 1 then (end - start) end) as can_bill,
  sum(case billable when 0 then (end - start) end) as unbillable
"
31979,MySQL DataBase design Question,"Rooms
Number  ID
101     1
102     2

Items
Name    ID   NumberLost   NumberDamaged  
Lamp    1    3            0
Chair   2    0            1

Contains
RoomID  ItemID  Quantity
1       1       1
1       2       3
2       1       1
2       2       4
"
7310,Change sql Get date to format ccmmdd?,"CONVERT(VARCHAR(8),GETDATE(),12)
"
35216,Common one-to-many table for multiple entities,"Organizations       Vendors               Customers
--------------      ---------------------  ---------------------
OrganizationID(PK)  OrganizationID(FK/PK)  OrganizationID(FK/PK)
AddressID1(FK)
AddressID2(FK)
"
9602,Is there an Access SQL query that aggregates multiple rows into one row?,"TRANSFORM questions.Answer
SELECT questions.Question, answers.Answer 
FROM ((base INNER JOIN customers ON base.Patient_ID = 
customers.Identyfikator) LEFT JOIN answers ON base.answer_ID = answers.ID) 
LEFT JOIN questions ON base.question_ID = questions.ID 
WHERE (((customers.Identyfikator)=[param_ID]))
GROUP BY questions.question
PIVOT questions.Answer;
"
6471,Pivoting in MySQL table,"SELECT s.switchName, 
       MAX(CASE WHEN s.switchCondition = 'ON' THEN s.switchingTime ELSE '-' END) AS SwitchON, 
       MAX(CASE WHEN s.switchCondition = 'OFF' THEN s.switchingTime ELSE '-' END) AS SwitchOFF
FROM switches s 
GROUP BY s.switchName;
"
27273,Sqlite: Select last row group by 2 column,"SELECT DISTINCT id1, id2 FROM table WHERE id1=2
"
15605,SQL- Referencing the primary key of the current relation (homework),"create table Student
    StudentId int primary key
    MendtorId int foreign key references Student.StudentId
"
6382,How to create cartesian products between records for each group separately?,"select ss.service_start, se.service_end, ss.customer_id
from (select distinct customer_id, service_start from table) ss join
     (select distinct customer_id service_end from table) se
     on ss.customer_id = se.customer_id;
"
38,Mysql DELETE with SELECT(?),"DELETE FROM special_price 
WHERE id IN ( SELECT id FROM products WHERE products_name = 'iphone4' )
"
21601,Altering a Table Column to Accept More Characters,"ALTER TABLE [table] ALTER COLUMN [column] NVARCHAR(newsize)
"
33959,How to write to DB using Linq,"Dim dc as new DataClassesDataContext()

Dim deleteFruits = _
    From f In db.Fruits() _
    Where f.Remove _
    Select f

For Each fruit In deleteFruits
    db.Fruits.DeleteOnSubmit(fruit)
Next

Try
    db.SubmitChanges()
Catch ex As Exception
    Console.WriteLine(ex)
    ' Provide for exceptions
End Try
"
271,MySQL performance using IN predicate,"SELECT COUNT(DISTINCT workcode)
FROM worktag
LEFT JOIN tag
  ON worktag.tagId = tag.tagID
WHERE tag.name = 'programming'
"
11441,Compare rows and get percentage,"SELECT 
  cook_id, 
  count(cook_rating < 4 OR cook_rating IS NULL) as positive_ratings, 
  count(*) as total_ratings
FROM cook
GROUP BY cook_id
HAVING (positive_ratings / total_ratings) >= 0.70
ORDER BY positive_ratings DESC
"
7099,OraSQL Select Command where multiple entry have same data,"SELECT A.* FROM TABLE A
WHERE EXISTS
(SELECT 'X' FROM TABLE B
 WHERE A.DATE = B.DATE
  AND A.TIME = B.TIME
  AND A.ID <> B.ID)
"
15611,Order By ID With String and Word Combination,"order by length(cust_id) desc, cust_id desc
"
23010,Making a query on 2 columns as if they were one,"Select Z.name, Count(*) As Total
From    (
        Select col_a As name
        From total
        Union All
        Select col_b
        From total
        ) As Z
Group By Z.name
"
19700,printing rank of a player and his(her) neighbors,"WITH ranking AS
(
  SELECT *,
         RANK() OVER (ORDER BY score DESC) userRank
  FROM   TableName  
)
SELECT *
FROM   ranking
WHERE  userRank BETWEEN
        (SELECT userRank - 1 FROM ranking WHERE userID = 'bbb') AND
        (SELECT userRank + 1 FROM ranking WHERE userID = 'bbb')
"
9828,MySQL query - Getting people out that arent in another table?,"select *
from name n
    left join classesbooked c on n.NameNo = c.classesbooked_nameno
where c.classesbooked_nameno is null
"
456,Mysql replace a part from search (replace by pattern),"SET @a = ""..some text1 <a href=\""http://url_1_begin<a href=\""http://url2\"">_url_1_middle_</a>url_1_end\""> some text2 </a> some text3.."";

SELECT REPLACE(REPLACE(@a,""<a href"",""href""),""</a>"",'');
"
15197,calclulate percentage on values in mysql table and write the percentage value in another table,"CREATE TABLE newTable
SELECT t1.day_id, t1.hour_id, t1.user_type, t1.id, 
        (t1.Charge-t2.Charge)/t2.Charge*100 AS Charge_Change,
        (t1.mobile-t2.mobile)/t2.mobile*100 AS mobile_Change
FROM yourTable AS t1
JOIN yourTable AS t2 ON t1.day_id = DATE_ADD(t2.day_id, INTERVAL 2 DAY)
    AND t1.hour_id = t2.hour_id AND t1.user_type = t2.user_type
    AND t1.id = t2.id
"
12770,How to find the rows which are NOT found in another table?,"SELECT 
  item.id
FROM
  item left join log on (log.itemId = item.id)
WHERE
  log.itemId is null
  OR log.status !='1'
ORDER BY item.id LIMIT 1
"
38057,MySQL query with two joins,"SELECT areas.name AS aname, COUNT(consultants.id) AS cct 
FROM areas
    LEFT JOIN consAreas ON consAreas.area = areas.id 
    LEFT JOIN consultants ON consultants.id = consAreas.cons AND consultants.active = 1
WHERE 
    areas.areaID = $area 
GROUP BY areas.id 
ORDER BY areas.name
"
9286,How do I intentionally get the equivalent of a 'cross product' (in SQL Server)?,"declare @a Table (ID varchar(10),Parent Varchar(10))
Insert into @a Values ('A',NULL) ,('B' , 'A'),('C','A'),('E',NULL) ,('F','E')
Select a.ID,b.ID  as GroupMember
from @a a
JOIN @a b ON ISNULL(a.Parent,a.ID)=ISNULL(b.Parent,b.ID) 
"
31579,"Dangling ""else"" Resolution in T-SQL","DECLARE @testvar INT;
DECLARE @testvar2 INT;
SET @testvar = 1;
SET @testvar2 = 1;

IF @testvar = 1
    IF @testvar2 = 1
        SELECT 'Got to 1';
    ELSE 
        SELECT 'Got to 2';
"
38244,return single rows from one table that don't match other table,"select a.*
from a left outer join b
on (
  a.""name"" = b.""name""
  and a.""amount"" = b.""amount""
  and a.""date"" = b.""date""
) where b.""name"" is null
and b.""amount"" is null
and b.""date"" is null
"
30078,Pivot Assistance,"Select TR.Agent_ID
  ,TR.EvalForm_ID
  ,Max(TR.[1.0 Compliance]) [1.0 Compliance]
  ,Max(TR.REg_Fail)  REg_Fail
  ,Max(TR.[Marketing Guidelines]) [Marketing Guidelines]
FROM #TrendResults AS TR
WHERE TR.EvalForm_ID ='225777'
GROUP BY TR.Agent_ID, TR.EvalForm_ID;
"
35941,Inserting every OTHER ROW from one table to another (VBA MS Access 2010),"Dim booEveryOther as Boolean
booEveryOther = False

While Not rst.EOF
   If booEveryOther Then
      s1 = ""INSERT INTO ...
   End If

   booEveryOther = Not booEveryOther 
"
11029,concatenate strings in sqlite sum strings,"UPDATE fazerbem_carrinho_historico 
SET pendencia_pago = '10.00', 
    pendenciahistorico = pendenciahistorico || '12' 
WHERE data_compra = '76'
"
26582,How to get the numeric part from a string using T-SQL?,"select left(@str, patindex('%[^0-9]%', @str+'.') - 1)
"
3445,MySQL Creating an Advanced Query,"SELECT slide_id, sort_order, COALESCE(`templates`.page_name, `custom_slides`.page_name)  
FROM `user_slides` 
JOIN `slides` ON `slides`.slide_id = `user_slides` .slide_id
LEFT OUTER JOIN `templates` ON `templates`.template_id = `slides`.template_id
LEFT OUTER JOIN `custom_slides` ON `slides`.template_id IS NULL AND `custom_slides`.slide_id = `slides`.slide_id
WHERE `user_slides`.user_id = 1
"
28803,SQL - Two Outer Joins,"SELECT
  c.Name AS 'CountryName',
  '' AS 'ProvinceName',
  ISNULL(s.[Name], '') AS 'StateName'
FROM Country c 
LEFT OUTER JOIN [Province] p ON p.[CountryID]=c.[ID]
UNION ALL
SELECT
  c.Name AS 'CountryName',
  ISNULL(p.[Name], '') AS 'ProvinceName',
  '' AS 'ProvinceName'
FROM Country c 
LEFT OUTER JOIN [State] s ON s.[CountryID]=c.[ID]
"
28760,"Select 5 previous records, middle and 5 next records in 1 query","(select i.*
 from items i
 where price <= (select price from items i2 where name = @input_name)
 order by price desc
 limit 6
) union all
(select i.*
 from items i
 where price > (select price from items i2 where name = @input_name)
 order by price asc
 limit 5
)
"
29186,Compare 3 tables in SQLite,"SELECT course.* FROM course INNER JOIN jobscourse ON jobscourse.cID = course.cID WHERE jobscourse.jID = ?
"
31102,SQL for creating a range,"with t1 as (
select dept, min(term) mnterm
from table
group by dept)
, t2 as (select dept, mnterm as min_term, lead(mnterm) over(order by dept) as max_term
         from t1)
select * from t2;
"
24342,Selecting rows in SQL only where *all* values do not meet a certain criteria,"select [user id]
from table1
group by [user id]
having sum(case when status = 'true' then 1 else 0 end) < 1;
"
39069,Filtering multiple dates in row with optional to and from parameters,"WHERE 
   (Date1 >= ISNULL(@DateFrom,'17531231')
    AND Date1 <= ISNULL(@dateTo,'20991231'))
OR
 (Date2 >= ISNULL(@DateFrom,'1753-12-31')
    AND Date2 <= ISNULL(@dateTo,'20991231'))
OR
 (Date3 >= ISNULL(@DateFrom,'1753-12-31')
    AND Date3 <= ISNULL(@dateTo,'20991231'))
"
18220,Oracle working with UNIX timestamp,"SELECT * FROM SESSIONDATA WHERE MODIFIED BETWEEN (SYSDATE - TO_DATE('01-JAN-1970','DD-MON-YYYY')) * (86400) - 120 AND (SYSDATE - TO_DATE('01-JAN-1970','DD-MON-YYYY')) * (86400);
"
5729,SQL Indexing Strategy on Link Tables,"CREATE TABLE [dbo].[EventLog](
    [EventId] [int] NOT NULL,
    [UserId] [int] NOT NULL,
    [Time] [datetime] NOT NULL,
    [Timestamp] [timestamp] NOT NULL,
    PRIMARY KEY([EventId],[UserId])
"
25964,Long detailed listing in SELECT Queries,"SELECT * FROM `table` WHERE `column` = 'value' LIMIT 1\G
"
26301,Oracle SQL Syntax to Find Distinct Data over 24 Hour Time Period,"select distinct trunc(date_created), user_name
from login_history
order by trunc(date_created);
"
26535,update <ONE> from <MANY> in Postgresql,"with cte as (
    select b.user_id, sum(b.sumwin) as sumwin
    from bonus as b
    where
        b.pay = 0 and
        b.autopay = 1 and
        b.sumwin > 0
    group by b.user_id
)
update users as u set
    amount = u.amount + b.sumwin
from cte as b
where b.user_id = u.id;
"
21393,Mysql query NOT IN,"SELECT *,MATCH(file_name_keyword) AGAINST('$file_name_keyword') 
FROM `uploaded` 
WHERE (MATCH(file_name_keyword) AGAINST('$file_name_keyword') OR file_name_keyword REGEXP '.*($file_name_keyword).*' )
AND id NOT IN (57)
LIMIT 8
"
19651,SQL connect two columns,"SELECT *
FROM table1
WHERE CONCAT(column1, column2) = '0123456789';
"
23159,Where clause based upon the null and non null column in SQL Server,"select top 1 * from table1 
where col1 = @param1 and (col2 is null or col2 = @param2)
order by case when col2 is null then 1 else 0 end
"
5814,Which customer has bought 4 or more items in our store?,"SELECT cutomer.cusName, COUNT(itemName) AS 'Number of items'
FROM customer INNER JOIN store
ON customer.cusID = store.cusID
GROUP BY cutomer.cusName
HAVING count(itemName) >=4
"
21960,mySQL (left join?),"SELECT u.*,MAX(t.timestamp) latest_timestamp
FROM transactions t
LEFT JOIN users u ON t.user_id=u.id
GROUP BY t.user_id
"
19709,Help understand difference in sql query,"ORDER BY [User Name]
"
8098,SELECT and increasing id,"select rownum + 999
from   your_table
"
39948,how to pass an unknown amount of values in an IN condition in a SQL function?,"WHERE ','+@dynamicAmountOfInputs+',' like '%,'+ITEM_CODE+',%';
"
9262,JRValidationException: Report design not valid,"<field name=""department"" class=""java.lang.String""/>
"
16814,How to find a table in sql server if only the partial table name is known,"SELECT 
      OBJECT_SCHEMA_NAME(object_id) AS schema_name
    , name
FROM sys.tables
WHERE name LIKE '%[_]13[_]6[_]14%';

SELECT 
      TABLE_SCHEMA
    , TABLE_NAME
FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_NAME LIKE '%[_]13[_]6[_]14%';
"
12588,how to use a column value in postgresql,"select t1.weight-t2.weight from table as 't1' join table as 't2' on t1.order_item_id=t2.order_item_id where t1.order_status!=t2.order_status;
"
507,how to convert colums to rows in sql,"select *
from
(
select nams_contract_number, 1 as Sequence, 'Preqc' as DataType, act_preqc, est_preqc
from table
union all
select nams_contract_number, 2 as Sequence, 'abstractoin' as DataType, act_abstraction, est_abstraction
from table
union all
select nams_contract_number, 3 as Sequence, 'review' as DataType, act_review, est_review
from table
union all
select nams_contract_number, 4 as Sequence, 'postreview' as DataType, act_postreview, est_postreview
from table
) x
order by x.nams_contract_number, x.sequence
"
5407,How does one do a SQL select over multiple partitions?,"SELECT *
  FROM transactions
 WHERE transaction_date IN (date '2010-11-22', 
                            date '2010-11-23', 
                            date '2010-11-24')
"
13502,Selecting rows with repeating values in one column,"SELECT 
    MAX(t1.Id) as ID, 
    t1.code, 
    t1.sequence_number
FROM mytest t1
INNER JOIN mytest t2
ON t1.id <> t2.id
AND t1.code = t2.code
AND t1.sequence_number = t2.sequence_number
GROUP BY t1.code, 
    t1.sequence_number
    ORDER BY ID
"
18183,MySQL autoincrement tied with an attribute,"create table test (
  id smallint not null,
  norder int unsigned not null auto_increment,
  primary key (id,norder)
) engine=myisam;

insert into test(id) values (1),(1),(1),(2),(3),(1),(1),(4),(5),(1)
"
17405,Query to Re-index Primary Key of MySQL Database,"ALTER TABLE tableName ADD NewIdn INT NOT NULL AUTO_INCREMENT KEY
"
200,Oracle checking for existence of rows in a large table,"SELECT COUNT(*)
FROM   X
WHERE  id1 = :1 AND
       id2 = :2 AND
       ROWNUM = 1;
"
37650,Multiple Between Statements,"  SELECT Description, SUM(Balance) AS Total_Balance
    FROM Chart_Of_Accounts
   WHERE (Account BETWEEN '400401' AND '400407') 
      OR (Account BETWEEN '440094' AND '440100') 
      OR (Account BETWEEN '450094' AND '450100')
GROUP BY Description
"
17203,Two columns in subquery in where clause,"SELECT s.period, s.year, s.amount 
FROM salaries s
where (s.year, s.period) in (select year, period from periods)
"
14686,SELECT by related records?,"Select 
  posts.id
  posts.text
From 
  posts
Where 
  posts.id in (select PostID from userposts where UserID in (1,2))
"
29094,access forms: forcing UCASE in a textbox,"If isnull(me.MyTextBox) = false then
   Me.MyTextBox = ucase(Me.MyTextbos)
End if
"
25867,Find the closest timestamp SQL?,"SELECT c.FromIDNumber, m.Timestamp, m.X, m.Y
FROM Communication c
JOIN Movement m ON c.FromIDNumber = m.IDNumber
WHERE m.TimeStamp = (SELECT mm.Timestamp
                     FROM Movement mm
                     ORDER BY abs(mm.TimeStamp - c.TimeStamp)
                     LIMIT 1
                    );
"
26674,Joining two tables MySQL is slow even with indexing,"INDEX theIndex (name,pos,ref, alt)
"
18122,How do I extract records from a table which has datatype=Timestamp but I know only the date part of the key,"SELECT
  field1,
  field2
FROM
  table
WHERE
  timestampField >= '2016-01-01'
  AND timestampField < '2016-01-02';
"
17650,Where statement that will use a concat,"WHERE
  town like concat('%',@userinput,'%')
OR
  street like concat('%',@userinput,'%')
OR 
  other like concat('%',@userinput,'%')
"
32001,MySQL create tables using a cron job or use Views,"TRUNCATE TABLE user_reports;
"
21216,"SQL server, Order by datetime value","SELECT     SUM(LineTotalValue) AS Value, 
           CONVERT(date, DateTimeCreated)
FROM       SOPOrderReturnLine AS SOPOrderReturnLine 
WHERE      AnalysisCode1 LIKE 'value%'
GROUP BY   CONVERT(date, DateTimeCreated)
ORDER BY   CONVERT(date, DateTimeCreated) desc
"
18838,Selecting a grouped condition in an Aggregate query,"create view myview as
select
    avg(old_foo.stuff),
    foo.person_id,
    foo.date_ as this_date,
    offset
from
    generate_series(1, 100) as offset,
    foo,
    join ( select stuff, person_id, date_ from foo) as old_foo
        on old_foo.date_ < foo.date_
        and old_foo.date_ > foo.date_ - offset

group by person_id, this_date, offset
;


select * from myview where offset = 10;
"
17573,SQL: Sum a negative and positive real gives wrong value,"   1.67460317460317
+ -1.6746
-------------------
=  0.00000317460317
=  3.17e-06
"
2847,Unique entries for normal entries?,"ALTER TABLE      `table_name` 
ADD UNIQUE INDEX (`column1`, `column2`);
"
31660,SQL making last year's data into another column,"select revenue, country, date
  , (
    select revenue
    from revenue r2
    where r1.country=r2.country
      and r1.date = dateadd(yy,1,r2.date)
  ) as LastYearRevenue
from revenue r1
"
9487,SQLite SELECT with JOIN and GROUP?,"SELECT p.product_code AS ""Product Code"",
    p.description AS ""Description"", 
    SUM(CASE WHEN ri.quantity IS NULL THEN 0 ELSE ri.quantity END) AS ""Quantity"" 
FROM products AS p
    LEFT JOIN receipts_items AS ri ON ri.product_code = p.product_code
GROUP BY p.product_code
ORDER BY SUM(ri.quantity) DESC
"
16316,PostgreSQL Query Optimization,"with numbered as (
  select id as old_id, 
         row_number() over (order by id) as new_id
  from network
)
update network nt
  set id = nb.new_id - 1 // -1 to start at 0
from numbered nb
where nb.old_id = nt.id;
"
25996,Update value of one record with the value of another record in the same table,"UPDATE webform_submitted_data as a, webform_submitted_data as b 
SET a.data = b.data WHERE a.sid = b.sid AND a.cid = 64 AND b.cid = 56
"
8758,Count number of distinct rows,"SELECT COUNT(DISTINCT PoliticianId) AS result
FROM Votes
WHERE UserId = 1010 ;
"
21044,Mysql query deducting 2 counts result less 0,"GREATEST((countresult1-countresult2), 0) AS restresult
"
13563,Rails where doesn't work with time comparison,"p.comments.where(""comments.created_at > ?"", 1.day.ago)
"
27229,SQL find in string separated by commas,"select * from table 
where find_in_set(21, demo) > 0
"
8633,Selecting entries from a table by checking condition on another table,"SELECT t1.ServiceID FROM Table1 t1 INNER JOIN Table2 t2
ON t1.ID = t2.ID
WHERE t2.Value IS NOT NULL
"
26786,Update year and month of date based on select statement,"UPDATE
   YourTable
SET
   CreatedDate = DateAdd(year, [Year] - DatePart(year, CreatedDate), 
      DateAdd(day, [Day] - DatePart(day, CreatedDate), CreatedDate))
"
5135,Query for selecting count(*) of a query but only return a LIMIT of the query result OFFSET by something,"SELECT a.col1, 
       b.col4, 
       c.col5,
       count(*) over () as total_count
FROM a
  JOIN b ON ..
  JOIN c ON ...
LIMIT 20 OFFSET 5
"
8563,MySQL n to m relationship select confusion,"SELECT major.name FROM major
JOIN student_has_major_table ON student_has_major_table.major_id = major.id
JOIN student ON student.id = student_has_major_table.student_id
WHERE student.id=1
"
10524,mysql assign auto number to non-primary key column,"CREATE TABLE `customers` (
  `cid` int NOT NULL auto_increment,
  `cemail` varchar(123) NOT NULL,
  `cfax` varchar(123) NOT NULL,
  `cname` varchar(123) NOT NULL,
  PRIMARY KEY  (`cid`),
  UNIQUE KEY `cemail` (`cemail`,`cfax`,`cname`)
);
"
21432,organize sql heirarchy,"SELECT 
   id,
   son, 
   technology,
   ISNULL((select id from table t2 where t2.id = t1.son), 0) AS father,
   ROW_NUMBER() OVER (ORDER BY technology, father, son) AS RowNumber
FROM 
   table t1 
ORDER BY 
   RowNumber ASC
"
28063,How to get sum of votes for an item in a DB?,"select item_id , title , description , sum(votes) as totalVotes from items 
    left join votes on
    items.item_id = votes.item_id
    group by votes.item_id
    order by item_id desc
"
27984,Selecting distinct rows on all but one column,"SELECT min(id), date_f, date_t, num_n, num_d, mn, is 
FROM t
GROUP BY date_f, date_t, num_n, num_d, mn, is
"
21827,MySQL Order by NULL join,"ORDER BY ISNULL(photos.id), name DESC
"
23180,SQL - counting a column value of its joined ID,"COUNT(DISTINCT (CASE WHEN vote.vote_type = 'upvote' then vote_id ELSE NULL END)) AS 'upvote', 
COUNT(DISTINCT (CASE WHEN vote.vote_type = 'downvote' then vote_id ELSE NULL END)) AS 'downvote',
"
38639,How to update column text value with the output of multiple if statement in mysql?,"select 
     concat (
           case v1 when '1' then concat('<b>','v1','</b>') else '' end,
           case v2 when '1' then concat('<b>','v2','</b>') else '' end,
           case v3 when '1' then concat('<b>','v3','</b>') else '' end
       )
from table1
"
13794,How to execute a stored procedure after it is created?,"SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO            

CREATE PROCEDURE sp_Transfer_RegionData
AS
BEGIN
    INSERT INTO Region (regionName)
    SELECT column1
    FROM openquery(ITDB, 'select * from db.table1')

END

GO

EXEC sp_Transfer_RegionData
"
26538,How to delay expensive calculation in postgres until final steps,"select agg.*, fvec.fec
from (SELECT a, b, sum(c) as sumc
      FROM my_table
      GROUP BY a, b, f
     ) agg join
     (select f, very_expensive_calculation(f) as vec
      from (select distinct f from my_table) mt
     ) fvec
     on agg.f = fvec.f;
"
31918,SQLite Reset Primary Key Field,"delete from your_table;    
delete from sqlite_sequence where name='your_table';
"
29195,Get the first space on the left of varchar SQL,"DATALENGTH(@variable)
"
38501,SQL UPDATE WHERE IN (List) or UPDATE each individually?,"UPDATE table1 SET somecolumn = 'someVal' WHERE ID IN (SELECT ID FROM @definedTable);
"
14571,How to hide column based on condition,"SELECT Products.Active,
CASE Products.Active
 WHEN  'false' THEN  '' 
 ELSE  Products.product
END  AS 'HIDDEN COLUMN'
FROM Products
"
36904,How to cast varchar to datetime in sql,"-- converting from DD-MM-YYYY
select CONVERT(datetime, '29/11/2013 12:00:00 AM', 103)

-- converting from MM-DD-YYYY
select CONVERT(datetime, '11/29/2013 12:00:00 AM', 101)
"
23763,How do I query whether a row has N rows in another table that foreign key it?,"SELECT *
FROM Cards
WHERE (Cards.Id IN (
    SELECT DISTINCT CardID
    FROM Tags
    WHERE AttributeID IN (13, 45)
    GROUP BY CardID
    HAVING (COUNT(AttributeID) >= 2)
))
"
8865,Python counting sums of unique items in database,"
select count(*), type from that_one_table group by type
"
30522,Maintain sql order in mysql after group,"select  site_id
,       max(count) as TopCount
from    tags 
where   match (tag) against ('statistici' in boolean mode) 
group by 
        site_id 
order by
        TopCount DESC
"
30114,Oracle: sort by column with reserved name,"ORDER BY t1.""MODE""
"
36654,"Iterate over multiple MySQL tables, export 1 table from each","#!/bin/bash

mysql -B -e ""show databases"" | egrep -v ""Database|information_schema"" | while read db; 
do 
  echo ""$db""; 
  mysqldump $db TableName > $db.sql
done
"
28051,Trigger on PostgreSQL,"CREATE FUNCTION tEst() RETURNS TRIGGER AS $$
BEGIN
  IF NEW.est = 'A' AND NEW.sex = 'F' THEN
    NEW.est = 'B';
  END IF;
  RETURN NEW;
END;

CREATE TRIGGER tEst_trg BEFORE INSERT OR UPDATE ON peop
FOR EACH ROW EXECUTE PROCEDURE tEst();
"
2389,Compare two tables in postgres,"SELECT * FROM tabA, tabB 
WHERE tabA.user_id = tabA.user_id 
AND (
 tabA.contact != tabB.contact 
 OR
 tabA.promote != tabB.promote
);
"
4253,Is it possible to add SQL comments to a query built with the ORM?,"Object.objects.filter(Q(pub_date__lte=datetime.now()).extra(where=['1=1 /* query no. 123 */'])
"
16725,XPath get value of attribute 'A' based on attribute 'B' in SQL Server xml,"SELECT ID, Data
from Items 
where Data.value('(//data/add[@key=""images""]/@value)[1]', 'nvarchar(100)') Like '%img%'
"
17954,Set Order By Clause Dynamically for Procedure based data block," select ... from ...
 order by decode(:val, 1, col1, 2, col2)
"
2945,Access 2013: How to Return All Records With Date Older than X?,"Select * From YourTable
Where 
    IsDate([myDtField])
    And
    DateDiff(""d"", DateValue([myDtField]), Date()) > 120
"
1028,How to get the duplicate row count in postgres sql,"select string_agg(st_no,',') as st_no,
string_agg(st_name,',') as st_name,
string_agg(directions,',') as directions,
string_agg(others,',') as others from table1 group by st_no
"
27535,SQL query wrong result,"SELECT 
    completed.ID AS ID,
    completed.level AS level,
    completed.completed_in AS completed_in, 
    COUNT(questions.answer) AS right_answers_num 
FROM completed
        INNER JOIN history  ON history.ID = completed.ID
        LEFT JOIN questions ON questions.ID = history.question AND questions.answer = history.answer
WHERE 
    completed.student_id = '1'  
GROUP BY 
completed.ID 
ORDER BY completed.completed_in DESC
"
14786,sum column table filter by data," ALTER proc [dbo].[empcx](@caixa int,@inicio datetime)as
     select sum(total) ttotal from alteraca 
     where (Convert(varchar(10),DATA,101) = Convert(varchar(10),@inicio,101))
       and caixa=@caixa and pedido <>0
"
25913,Select Users who have made the most positive contributions,"select 
     count(artc_status) as stats , 
     count(case when artc_status=1 then 1 end) Positive,      
     artc_user[Contributing User] 
from 
    contributions 
group by 
    artc_user 
order by  stats desc;
"
4465,Two sums from a join in sqlite,"SELECT name, a.amount_sum, a.time_sum
FROM group g LEFT JOIN
     (SELECT group_id, SUM(amount) AS amount_sum, SUM(time) AS time_sum
      FROM actual
      GROUP BY group_id
     ) a
     ON a.group_id = g.id;
"
9336,sql query to add days to specific column date,"UPDATE <table> 
SET expiry_date = DATE_ADD(expiry_date , INTERVAL 7 DAY) 
WHERE DATE(expiry_date) >= DATE(NOW());
"
36207,Hive partitions by date?,"create table tab(id int,name string,dt string) partitioned by (year string,month string);

create table samp(id int,name string,dt string) row format delimited fields terminated by '\t';

load data inpath '\dir' into table samp;
insert overwrite table tab partition (y,m) select id,name dt,YEAR(dt),MONTH(dt) from samp;
"
39399,Need to know how to SQL query where all a like model numbers differs in description,"select *
  from test
where
  model_number in (
    select model_number
      from test
  group by model_number
    having count(distinct description) > 1)
"
7939,[SELECT with concat into %TYPE.],"DECLARE
v_var  VARCHAR2(250);
SUBTYPE v_var_type IS v_var%type;

BEGIN

--do something

END;
"
25461,SQL Server trigger to drop another database,"CREATE TRIGGER DeletedClientDB

ON systemclients

FOR DELETE
AS

DECLARE @dropdb VARCHAR(150);

Select @dropdb = 'drop database ' + deleted.SystemClientID FROM deleted)


Exec(@dropdb)

GO
"
36402,SQL query to get most recent row for each instance of a given key,"Select u.[username]
      ,u.[ip]
      ,q.[time_stamp]
From [users] As u
Inner Join (
    Select [username]
          ,max(time_stamp) as [time_stamp]
    From [users]
    Group By [username]) As [q]
On u.username = q.username
And u.time_stamp = q.time_stamp
"
1810,Retrieve Data from Different Tables (SQL Server),"SELECT c.CourseName, s.StudentName, u.SubjectName, u.Semester, a.Month, a.Count
FROM Student s 
    JOIN Attendance a ON s.StudentId = a.StudentId
    JOIN Course c ON a.CourseId = c.CourseId
    JOIN Subject u ON c.CourseId = u.CourseId
"
6096,SSRS: display a message conditionally if the report is empty,"NORowsMessage=""No data available for current filter selection""
"
16106,summation and grouping multiple columns in mysql,"group by
   `tweets`.`account_id`,
   `tweets`.`user_screenname`,
   cast(`tweets`.`datetime` as date)
"
30708,In SQL how to compare date values?,"WHERE DATEDIFF(mydata,'2008-11-20') >=0;
"
36542,counting overall results with groups in mysql,"SELECT 
  COUNT(a.word) 
FROM concordance a
JOIN (SELECT DISTINCT b.word
      FROM bigdic b) temp
ON temp.word = a.word
WHERE a.word LIKE '%"" . $name .  ""%'""
"
8204,How to sort particular list in sql," order by sortlist, case when sortlist='list3' then year else null end,
"
25645,Database design implementing support for different languages,"select show_ID
  from show s left join show_international_date sid          
    on s.show_ID = sid.show_ID
 where s.episodes_available > 5
   and sid.status           = 'Emitting'
   and sid.language_id      = (select language_ID 
                                 from show_languages 
                                where language = 'Italian')
"
35217,"How to create a select, and then an update stored procedure in SQL Server 2012","with toupdate as (
      SELECT TOP 1 l.*
      FROM dbo.Lead l
      WHERE l.IsLocked = 'False'
      ORDER BY l.uploadedDate
     )
Update toupdate
    SET IsLocked = 'TRUE';
"
9658,Need to get the output as positive and negative numbers from one column into different columns from a single table,"SELECT t1.col1 AS POSITIVE, t2.col1 AS NEGATIVE
FROM (
   SELECT col1
   from tableA
   WHERE col1 > 0 ) t1
FULL OUTER JOIN (
   SELECT col1
   FROM tableA
   WHERE col1 < 0 ) t2 ON t1.col1 = ABS(t2.col1)
ORDER BY ABS(COALESCE(t1.col1, t2.col1))
"
6201,Find and replace table data with another table in MySQL,"UPDATE items
JOIN   users ON users.name = items.created_by_alias
SET    created_by = items.id
"
38705,How to replace a part of the string using mysql,"update myTable
set email = replace(email, '@xy.com', '@xyz.com')
where email like '%@xy.com'
"
19109,Finding strings that differ with at most one letter from a given string in SAS with PROC SQL,"data typo;
input name $20.;
datalines;
massachusetts
masachusets
mssachusetts
nassachusets
nassachussets
massachusett
;

proc sql;
  select name from typo
  where complev(name, ""massachusetts"") <= 2;
quit;
"
5991,How to get last message from every conversation,"  select c.maxid as chatID,d.from_user,d.to_user,c.convo_id,d.message 
  from tblchat d 
  inner join  (select max(b.id) as maxID,b.convo_id  
  from tblconv a 
  inner join tblchat b 
  on a.convo_id=b.convo_id 
  group by b.convo_id) c 
  on c.maxID=d.id
"
34099,SQL select rows conditionally using CASE expression,"SELECT *
FROM emp
WHERE (CASE WHEN (sal+comm) > 1700 THEN 1
            ELSE 0
       END) = 1
"
10123,Returning NULLs in SQL if joined table is missing records for that Date,"LEFT OUTER JOIN dbo.tblSurveySession ON tblDateTrans.Date = dbo.tblSurveySession.surveyCompletedDate AND dbo.tblSurveySession.FK_StoreId = 4
"
26914,What is the execution order of Oracle MERGE INTO clauses with a subquery,"alter session set ""_complex_view_merging""=false;""  
"
15908,I Want to display items in listview from database as values of checkbox. in android,"int booleanRow = cursor.getColumnIndexOrThrow(FIELD);
boolean isChecked = (cursor.getInt(booleanRow) == 1)? true : false;
"
20071,Mysql update column based on a string from another table,"Update Workorders
set prebookCB = 1
where CustomerID in (select customerid from customers 
where customeerstatus='Good-Prebook')
"
33579,MySQL's IF leave second value blank,"Update table set col = IF(score < 10,1, col) where userId = 5
"
7733,SQL Server / SSRS 2005 CASE evaluation of Parameter and NULL,"=iif(Parameters!RPfname.Value=""All"", Parameters!RPfname.Value,Fields!fName.Value) = =Parameters!RPname.Value
"
38210,Group By with count doesn't work,"SELECT projects.AgencyId,projects.ProgramId,count(projects.ProjStatusByMin) as status,
projects.ProjStatusByMin 
from projects 
where projects.AgencyId=40 
group by projects.ProjStatusByMin, projects.AgencyId,projects.ProgramId
"
18093,SQL query select matched and absent values from two tables,"SELECT c.id, c.number, IFNULL(u.name, ""not linked"") AS name
FROM card AS c
LEFT JOIN user as U ON c.user_id = u.id
"
31689,"Select rows that are ""different"" than the previous row","select * from table_name 
where id in (select min(id) from table_name group by id_user)
"
6104,How can I merge 2 (or more) columns into a new one for each SQL row?,"INSERT INTO Table (Field1, Field2, Field3, History) 
                  (Field1, Field2, Field3, Field1+Field2+Field3)
"
2888,How to Join 2 tables using lambda expression,"from Fc in CoachingDef.FormCategory
join Ef in CoachingLang.ExpandedForm on Fc.FormID equals Ef.FormId 
join Ec in CoachingLang.ExpandedCategory on Fc.CategoryID equals Ec.CategoryId
where Ef.DictionaryId = -2147483645 && Ef.PropertyId = -2147483647
&& Ec.DictionaryId = -2147483645 && Ec.PropertyId = -2147483647

select new {Translation = Ef.Translation +' - '+ Ec.Translation, 
    Fc.FormCategoryID, Ef.FormId,Ef.Translation, 
    Ec.CategoryId, Ec.Translation}
"
22503,How to run a specific sql query for every row in the table?,"SELECT c.FromIDNumber, m.Timestamp, m.X, m.Y
FROM Communication c
JOIN Movement m ON c.FromIDNumber = m.IDNumber
WHERE m.TimeStamp = (SELECT MIN(mm.Timestamp)
                     FROM Movement mm
                     WHERE mm.TimeStamp >= c.TimeStamp)
"
35848,select latest entry per day and corresponding data,"SELECT t.timestamp,
       t.npass,
       t.nfails
  FROM TEST_RESULTS t
  JOIN (SELECT MAX(tt.timestamp) 'maxtimestamp'
         FROM TEST_RESULTS tt
     GROUP BY date(tt.timestamp)) m ON m.maxtimestamp = t.timestamp
"
26723,Top 2 Rows from every same data in SQL,"SELECT Details
FROM   (SELECT *,
               Row_number()OVER(partition BY Details ORDER BY Details) rn
        FROM   tablename) a
WHERE  rn <= 2 
"
16266,Using LIKE to pull out an ID from comma separated string,"$this->db->where(""FIND_IN_SET('$id',d.field_id_13 ) !="", 0);
"
14855,Remove unwanted space at the right of the reference field,"LTRIM(RTRIM(your field))
"
3443,Add values for records that appear more than once,"SELECT name, date_worked, SUM(`hours worked`) AS totalHoursWorked
FROM users u
     INNER JOIN records r
       ON u.id = r.users_id
GROUP BY name, date_worked
"
4827,execute mysql query present in variable,"SET @query = CONCAT(""INSERT INTO history VALUES ("",1,"","",50,"",UTC_TIMESTAMP()"");

PREPARE stmt1 FROM @query; 
EXECUTE stmt1; 
DEALLOCATE PREPARE stmt1; 
"
38543,Get rid from one column duplicate values in two column select,"    SELECT t1.NAME, t2.ITEMS
    FROM t1 INNER JOIN t2 ON t1.id = t2.names_id
"
38556,How to get only a particular month's data in SQL,"  where 
          datepart(Month, [so_date]) = datepart(Month, dateadd(month, -6,getdate())) 
       and
          datepart(Year, [so_date]) = datepart(year, dateadd(month, -6,getdate()))
"
6460,SQL ORACLE MERGE Table,"MERGE INTO MA_PARTICIPANT P
USING TABLE_TO_CHANGE TT 
ON (TT.PART_ID = P.PART_ID)
WHEN matched THEN
  UPDATE    
  SET CUSTOMER_RK = NEW_CUSTOMER_RK,
      DEACT_FLG =   'Y'
"
30665,Access: Criteria in A Query,"WHERE [Holiday Name] in ('Thanksgiving', 'Christmas', 'New Years');
"
32166,How can I optimize this query for time performance?,"DailyProfile_Current:
Customer_ID 
Tin, Last_Name
Geo 

crm_contact:
ext_customerid,deletionstatecode,statecode
ext_retail_prime_taxid, lastname ,deletionstatecode,statecode

crm_ext_ImportMapping:
ext_geocode,deletionstatecode,statecode
"
20568,Return result of SELECT to another procedure,"CREATE TABLE #TempResults
( 
  -- put definition of columns returned from your Procedure1 SP here
)

INSERT INTO #TempResults
EXEC Procedure1

-- now you have your result from Procedure1 in #TempResults
-- use it whatever way you want
SELECT * FROM #TempResults

-- finally drop the temp table when no longer needed
DROP TABLE #TempResults
"
20931,MySQL OR conditions,"where (column = 'US' 
   or (column = '*' 
       and not exists (select 'x' from table where column = 'US') ) )
"
14336,MySQL Fulltext search but using LIKE,"SELECT id, str
FROM item_strings
WHERE str LIKE '%term%'
   AND str LIKE '%another_term%'
   AND str LIKE '%a_much_deeper_term%'
"
21145,SQL aggregation question,"  Select Count(*) TotalPurchases, 
     Sum(Case When c.transaction_id Is Not Null 
          Then 1 Else 0 End) MatchablePurchases
  From unmatched_purchases u
     Join purchases p 
        On p.purchases_id = u.unmatched_purchases_id
     Left Join credit_card_transactions c
        On customer_id = p.customer_id
           And item_id = u.item_id 
           And trans_timestamp - purchase_date < @DelayThreshold
  Where Location_id = @Location
"
35644,Quirying several keywords separately but in a batch with SQL,"select * from MyTable where myfield in ( value1, value2, value3, value50 );
"
22339,"writing a query to get the value of a certain shortcode as on today,30 days back and 60 days back in a single select","select today.shortcode, today.value todayvalue, lastmonth.value lastmonthvalue, twomonths.value twomonthsvalue
    from revenue_shares today
    inner join revenue_shares lastmonth on lastmonth.shortcode=today.shortcode 
        and [date]=dateadd(day, -30, getdate())
    inner join revenue_shares twomonths on twomonthsshortcode=today.shortcode 
        and [date]=dateadd(day, -60, getdate())
     where today.[date]=getdate()
"
12507,"Update multiple rows with different, optional values for different colums","UPDATE person
SET name = CASE id
    WHEN 1 THEN 'Jim'
    WHEN 3 THEN 'Precious'
    ELSE name
END,
sex = CASE id
    WHEN 1 THEN 'female'
    WHEN 2 THEN 'male'
    ELSE sex
END
WHERE id IN (1,2,3)
"
34106,select distinct out of distinct," select  etar.EmplKey, min(emp.EmplFullName)
 FROM EmployeeTarget etar
 inner join DimEmployee emp on emp.emplkey = etar.emplkey
 inner join dimbranch br on br.BranchId = etar.BranchId
 where etar.BranchId = 8
 group by etar.EmplKey
"
35923,SQL Left Join losing rows after filtering,"SELECT 1.Label, COUNT(2.values)
FROM Table1 1
    LEFT JOIN Table2 2 ON 1.fk = 1.pk and
              2.Date BETWEEN 1/1/2010 AND 12/31/2010    
GROUP BY 1.Label
"
11079,sql many to many select with join,"SELECT 
   p.name AS ""place"", 
   t.name AS ""firstTag"" 
FROM 
   places p 
   LEFT JOIN
   places_tags pt1 
      ON pt1.place_id = p.id
   LEFT JOIN
   places_tags pt2 
      ON pt2.place_id = p.id AND pt2.tag_id < pt1.tag_id
   LEFT JOIN 
   tags t 
      ON t.id = pt1.tag_id
WHERE
   pt2.tag_id IS NULL
"
9314,Use daterange table to also return empty resultset,"SELECT user_id, d_date,
       COUNT(CASE WHEN messages.m_date = d.d_date then 1 end) Volume
FROM messages
CROSS JOIN datetable d
GROUP BY messages.user_id, d.d_date
ORDER BY messages.user_id, d.d_date ASC
"
26794,MySQL CREATE statement in MSSQL : the KEY keyword?,"CREATE TABLE database1.dbo.a (
  a nvarchar(25),
  b nvarchar(25),
)
GO

CREATE INDEX a_index
  ON database1.dbo.a(a)
GO
"
35138,SQL code to insert multiple rows in ms-access table,"library(RODBC)
MDB <- odbcConnectAccess(""database.mdb"")
sqlSave(channel = MDB, dat = sims, tablename = ""tblSimulation"", append = TRUE, rownames = FALSE)
odbcClose(MDB)
"
7168,"SQL ""chained"" queries?","SELECT s.id, s.name, s.lastname,c.date,c.grade 
FROM classes c
inner join students s
on c.studentid=s.id
WHERE c.date BETWEEN '01/01/2014' AND '01/01/2015'
"
39882,What can I use if I want't to display a top 10 list of records,"SELECT COUNT(*) as bCount, room_id 
FROM `bookings`
GROUP BY room_id
ORDER BY bCount
LIMIT 10
"
11064,SQL Query Count Instances a Column Type Appears,"select state, count(*) 
from table 
where type = 'Type 1'
group by state
"
29748,How to handle multiple one->many relationships?,"SELECT articlename, articlestatus, author, ISBN_Number 
FROM articles 
  INNER JOIN status ON articles.spubid = status.spubid   
  INNER JOIN people ON articles.spubid = people.spubid   
WHERE people.saffil = 'ABC' 
UNION ALL 
SELECT papername, paperstatus, author, null
FROM papers 
  INNER JOIN status ON papers.spubid = status.spubid   
  INNER JOIN people ON papers.spubid = people.spubid   
WHERE people.saffil = 'ABC'
"
255,MySQL CLAUSE can become a value?,"CREATE temp LIKE table;
ALTER TABLE temp ADD r FLOAT;

INSERT INTO temp(x, y, r)
    SELECT x, y, x*x+y*y as r
    FROM table 
    HAVING r < 1;
"
24525,Filter using a many-to-many table MySQL,"SELECT
  personID
FROM
  people_to_sports
WHERE
  sportID IN (1, 2)
GROUP BY
  personID
HAVING
  COUNT(*) = 2
"
13033,Get the Last Two Non-Null Values for a column in SQL Server 2008 R2,"SELECT  
    c.[date],
    c.id,
    price = ISNULL(c.price, x.price)
FROM dbo.catalogue c
OUTER APPLY(
    SELECT TOP 1 price
    FROM dbo.catalogue
    WHERE 
        DATEDIFF(DAY, [date], c.[date]) <= 2
        AND c.[date] > [date]
        AND id = c.id
    ORDER BY date DESC
)x
"
13978,Is there a way with nearest neighbour search in MySQL?,"SELECT MIN(v), id FROM number_t WHERE v >= q
UNION
SELECT MAX(v), id FROM number_t WHERE v < q
"
32831,Get data from another column where first column id is equals other and other column equals X,"public function takeAll() {
    $select = $this->_db->select();
    $select->from(array('a' => 'advertistment'));
    $select->join(array('d' => 'description'), 'a.id_advertistment = d.id_description');
    $select->where('d.type_of_house = ?', 'm');

    return $this->_db->fetchAll($select);
}
"
23418,Where date difference between now and max date value is greater than X,"select * from 
(SELECT usermaster.userid, date_trunc('days', now()-max(paymentdate)) as  
        last_payment
from usermaster, paymentdetail 
where usermaster.userid=paymentdetail.userid
group by usermaster.userid ) as temptab
where last_payment>100;
"
10992,How to create a sql script to consider two columns?,"SELECT 
    Emp, SIDate, item, TotQty, TotAmt, CMDate, CMAmt 
FROM 
    Table1
WHERE 
   SIDate BETWEEN '2014-01-01' AND '2014-01-18'
   AND (CMDate IS NULL OR CMDate BETWEEN '2014-01-01' AND '2014-01-18');
"
21974,"Convert bigint to Month Day, Year","SELECT CONVERT (VARCHAR(30), 
                Dateadd(SECOND, bigintcolumn / 1000 + 8 * 60 * 60, '19700101'), 
                107) AS Last_Checkin 
"
2348,MySQL - combine 2 tables,"create table table_3 as
select * from table_1
union
select * from table_2
"
37259,how to filter duplicate rows with different value,"SELECT Model, SUM(Qty), MAX(Date)
FROM YourTable
GROUP BY Model
HAVING SUM(Qty) <> 0
"
12459,grouping one to many relationship in a row,"SELECT
    p.name as name,
    f.stuff AS stuffF,
    d.stuff AS stuffD,
    e.stuff AS stuffE
FROM
    tableOne p JOIN tableTwo f on (p.id = f.id AND f.stufftype = 'F')
               JOIN tableTwo d on (p.id = d.id AND d.stufftype = 'D')
               JOIN tableTwo e on (p.id = e.id AND e.stufftype = 'E')    
"
13565,Split and join sql,"select a.id, group_concat(c.id)
from a join
     categories c
     on concat(', ', c.catename, ', ') like concat('%, ', name, ', %')
group by a.id;
"
9691,SQL Query help - need to calculate statistics on one parameter based on another,"    SELECT avg([Coat_Tank_Pressure]), [Run_Number]
    FROM WideHistory    
    WHERE wwRetrievalMode = 'Delta'   
     AND wwVersion = 'Latest'    
     AND DateTime >= DateAdd(hh,-1,GetDate())    
     AND DateTime <= GetDate()
    GROUP BY [Run_Number]
"
17336,Tabular Query to Compare Measures Across Dates,"Previous Value := CALCULATE(SUM(Table[Value]) - CALCULATE(SUM(Table[Value]), PREVIOUSDAY(Table[date])))
"
26729,The most effective implementation of conditional join,"inner join db.address addr 
on  f.town = addr.town OR (f.town='abc' AND addr.town =""abcd"")
"
14801,SQL Server 2008 - SELECT to combine multiple records (per ID) in to one record,"   WITH CTE_PGM
    AS
    (
        SELECT PGM.PID, MAX(  CASE PGM.CD
        WHEN '200' THEN 'DLA'
        ELSE ''
        END) AS MaxCD
        FROM PGM
        GROUP BY PGM.PID
    )
    SELECT STU.ID, STU.FN, STU.LN, MaxCD
    FROM  STU
    INNER JOIN CTE_PGM ON STU.ID = CTE_PGM.PID
"
36028,How do I select last message for each conversation?,"SELECT  *
FROM    conversations c
JOIN    messages m
ON      m.id =
        (
        SELECT  id
        FROM    messages mi
        WHERE   mi.conversation = c.id
        ORDER BY
                mi.conversation DESC, mi.id DESC
        LIMIT 1
        )
"
25851,"""Categorize"" or ""Mark"" SELECT query","$result = mysql_query(""SELECT *, 'test.1' FROM test.1 WHERE auth = 'mad' LIMIT 1 
                  UNION SELECT *, 'test.2' FROM test.2 WHERE auth = 'mad' LIMIT 1 
                  UNION SELECT *, 'test.3' FROM test.3 WHERE auth = 'mad' LIMIT 1"");
"
35218,"Show results for a given month, SQL","WHERE MONTH(OrderDate) = 5  AND YEAR(OrderDate) = 2014
"
13882,DateDiff Rounding in SQL Server,"SELECT CASE 
         WHEN DATEDIFF(hh, LastRunDateTime, GETDATE()) >= 1 THEN 1 
         ELSE 0 
       END
"
13037,Efficient progressive sum,"select 
  id,
  value,
  nvl(
    sum(value) over (
      order by id rows between unbounded preceding and 1 preceding
    ), 0) as offset
from table
"
21622,How to generate models from database structure existing,"java -jar schemaSpy.jar -t dbType -db dbName [-s schema] -u user [-p password] -o outputDir
"
33757,OUTER JOIN from different column names to same column,"SELECT a.name1, a.rating 
  FROM a
UNION ALL
SELECT b.firstname, b.rating 
  FROM b
UNION ALL
SELECT c.f_name, c.rating 
  FROM c
"
35999,SQL ALTER TABLE with default,"ALTER TABLE Stock_Qty
MODIFY Qty DEFAULT 1
"
34129,sql combine two columns that might have null values,"select 'All'= LTRIM(ISNULL(Name+' ','')+ISNULL(City+' ','')+ISNULL(CAST(Age as varchar(50))+' ','')  from zPerson)
"
18259,How can you use last_insert_rowid to insert multiple rows?,"BEGIN TRANSACTION;
INSERT INTO Persons(Name) VALUES(...);

INSERT INTO PhoneNumbers(PersonForeignKey, Number) 
VALUES(last_insert_rowid(), 'number 1');

INSERT INTO PhoneNumbers(PersonForeignKey, Number) 
SELECT PersonForeignKey, 'number 2' 
FROM PhoneNumbers where PhonePrimaryKey = last_insert_rowid();

INSERT INTO PhoneNumbers(PersonForeignKey, Number) 
SELECT PersonForeignKey, 'number 3' 
FROM PhoneNumbers where PhonePrimaryKey = last_insert_rowid();

END TRANSACTION;
"
275,SQL-Server Time data type,"alter table #mytable add thetime_hhmm as (left(thetime, 5));
"
3861,Query to Return One Row per Person,"with priorityRank as
(
  select *
    , priorityRank = row_number() over (partition by Person
        order by case Priority when 'High' then 1 when 'Low' then 2 end
          , Id)
  from
  Answers
)
select Id
  , Person
  , Answer
  , Priority
from priorityRank
where priorityRank = 1
"
11516,SQL Query For Non-Alphabet name field,"WHERE
   EmployeeName COLLATE Latin1_General_CI_AI LIKE '%[^a-z]%
"
17686,T-SQL Sum Case Confusion,"SELECT 
    SUPPLIERCODE,
    (SUM(CASE WHEN ISNULL(DATESUBMITTED,0) - ISNULL(FAILDATE,0) <15 THEN 1 ELSE 0 END)) AS     ACCEPTABLE,
    COUNT(ID) AS TOTALSUBMITTED,
    (SUM(CASE WHEN ISNULL(DATESUBMITTED,0) - ISNULL(FAILDATE,0) <15 THEN 1 ELSE 0 END)*1.0/COUNT(ID))
FROM SUPPLIERDATA
GROUP BY SUPPLIERCODE
"
37437,SQL Query group by highest revision number,"SELECT A.Id, A.ColumnId, A.Revision
from Bug A 
INNER JOIN
(SELECT ColumnId  MAX(Revision) As MaxRevision 
FROM BUG
GROUP BY ColumnId ) B ON
A.ColumnId = B.ColumnId AND
A.Revision = B.MaxRevision
"
1489,SQL GROUP BY multiple fields,"SELECT *
FROM (yourquery)
GROUP BY producer
"
36962,Optimizing SQL JOIN query,"SELECT
    pp.*
FROM published_post pp
LEFT JOIN friends f ON f.fb_id_user = pp.fb_id
WHERE pp.fb_id_friend = '12345'
ORDER BY f.post_date DESC
"
18920,SQL Query finding field with multiple rows,"SELECT EMP 
FROM Z_INSUR 
WHERE INSUR_TYPE = 'M'
GROUP BY EMP 
HAVING count(*) > 1;
"
33763,how to get certain numbers,"SELECT
    SUBSTRING(col, CHARINDEX('(', col) + 1, CHARINDEX(')', col) - CHARINDEX('(', col) - 1)
FROM
    Some_Table
"
27494,get count from sql query result,"SELECT COUNT(*)
FROM (
  --your current query here
) WHERE `id`=9
GROUP BY `id`
"
11788,sql server 2008 date,"... WHERE DATEPART(yy, `field1`) = datepart(yy, `field2) AND DATEPART(m, `field1`) = datepart(m, `field2)
"
36432,how to show column value only one time if it is repeated and blank until different value comes in sql,"SELECT
    CASE WHEN ROW_NUMBER() OVER(PARTITION BY Category ORDER BY BudgetType) = 1 
    THEN Category ELSE NULL END AS 'Category Caption'
    , Category
    , BudgetType
FROM yourTable
ORDER BY Category, BudgetType
"
30484,How to Update A database column with B database column?,"UPDATE B
SET table2Id = A_table1.table2Id
FROM A.dbo.table1 as A_table1
inner join B.dbo.table2 as B on A_table1.NaturalKey = B.NaturalKey
WHERE A_table1.Archive = 1
"
16221,Query criteria from another form's text boxes?,"SELECT [Forms]![frmQuarter]![StartQuarterDateTextbox] AS start_date;

SELECT [Forms]![frmQuarter]![EndQuarterDateTextbox] AS end_date;
"
29171,"SQL Server SQL ""down filling"" data that doesn't exist in source table","SELECT t2.company, t2.type, t1.dt, t2.value
FROM tbldata t1,
      tblfact t2
WHERE t2.dt <= t1.dt
AND   NOT EXISTS (SELECT top 1 1
                  FROM tblfact t22
                  WHERE t22.dt <= t1.dt
                  AND   t22.dt > t2.dt)
"
35144,SQL Optimising a spatial index for localised geography points,"DECLARE @point GEOGRAPHY = GEOGRAPHY::STPointFromText('POINT(<coords>)', 4326);
DECLARE @radius INT = 1000;

SELECT
*
FROM <table>
WHERE <GeographyColumn>.STIntersects(@point.STBuffer(@radius)) = 1;
"
34265,"What does ""t"" refer to in this SQL?","
SELECT AttemptNo FROM attempt_exercise 
  WHERE FK_UId = @uId AND FK_EId = @eId AND Mode = @mode
"
32583,Select query question,"""SELECT cd_id, SUM(tracks) as tracks FROM my_table GROUP BY cd_id""
"
19081,MSSQL: find records that has each value of column,"select
    value1
from 
    table as t1 inner join
    (select distinct year from table) as t2
    on t1.year=t2.year
group by
    val1 
having count(distinct t1.year)=(count(distinct t2.year) )
"
4097,SQL - Default Value of other columns/fields,"ALTER  Table TableA ADD    imageCode    
AS cast(itemCode as varchar(10))
+ 'IMG' + cast( id as varchar(10))
+ '.jpg' 
"
20426,Postgesql select from 2 tables. Joins?,"SELECT  list_id, phone, email
FROM    (
        SELECT  list_id, NULL AS phone, email, 1 AS set_id
        FROM    email_lists
        UNION ALL
        SELECT  list_id, phone, NULL AS email, 2 AS set_id
        FROM    phone_lists
        ) q
ORDER BY
        list_id, set_id
"
21841,Select a cloumn from given condition which is not the column name,"SELECT t2.*, t1.itemName
from Table2 t2
INNER JOIN Table1 t1 ON
  (t2.shopCode = 1 AND t2.itemCode = t1.codeA) OR
  (t2.shopCode = 2 AND t2.itemCode = t1.codeB) OR
  (t2.shopCode = 3 AND t2.itemCode = t1.codeC) OR
  (t2.shopCode = 4 AND t2.itemCode = t1.codeD);
"
11678,Oracle Database SQL Query,"SELECT C2.NATIONALITY, SUM(C2.TOTALPRIZEMONEY) AS TOTALPRIZEMONEY
FROM COMPETITOR C2, COMPETITION C1
WHERE NATIONALITY IN (SELECT COUNTRY FROM COMPETITION GROUP BY COUNTRY)
AND C1.TIMEPLANNED BETWEEN TO_DATE('01-JAN-15') AND TO_DATE ('31-DEC-15')
GROUP BY NATIONALITY;
"
5541,Query JSON inside SQL Server 2012 column,"SELECT *
FROM tb1
JOIN tb2 on tb2.bvin = 
    SUBSTRING(
        tb1.json
        ,CHARINDEX('""bvin"":""', tb1.json) + LEN('""bvin"":""')
        ,CHARINDEX('""', tb1.json, CHARINDEX('""bvin"":""', tb1.json) + LEN('""bvin"":""')) - CHARINDEX('""bvin"":""', tb1.json) - LEN('""bvin"":""')
    )
"
31728,"SQL: cleaning a DB, checking that there's no violation and maybe rolling back","SET AUTOCOMMIT OFF
"
30353,Which isolation level should I use for the following insert-if-not-present transaction?,"declare @LocationID          int
declare @LocationName        nvarchar (50)

/* fill in LocationID and LocationName appropriately */

INSERT dbo.Location
(LocationID, LocationName)
SELECT @LocationID, @LocationName
WHERE NOT EXISTS (
   SELECT L.*
   FROM dbo.Location L WITH (UPDLOCK, HOLDLOCK)
   WHERE L.LocationID = @LocationID)
"
26183,How to (or Can I) select a random value from the Postgresql database excluding some particular records?,"SELECT * 
FROM   employee 
WHERE  employeestatus != 2 
ORDER BY RANDOM()
LIMIT 1
"
39171,Group by two columns and count,"SELECT count(*), created_at FROM Order GROUP BY payment_option_id, created_at
"
10238,Combining two columns data into one using SQL Server 2008 R2,"select cola as columnName
from test
union
select colb as columnName 
from test
"
17356,SQL select the only rows with only a certain values in them,"select col2
from yourtable
group by col2 
having sum(col3=1) > 0 
  and sum(col3=2) > 0
  and sum(col3 not in (1,2)) = 0 
"
18604,Distinct multi-columns,"SELECT A.code, B.code
FROM work A, work B
WHERE A.name = B.name AND A.code < B.code
"
9068,How many times trigger in MySQL is called?,"INSERT INTO trigger_log(query) VALUES(?)
"
36178,How do I know if record from an SQL database is being used elsewhere?,"SELECT g.groupid, COUNT(*) AS user_count
FROM dbo.Groups g JOIN dbo.Users u ON (g.groupid = u.groupid)
GROUP BY g.groupid;
"
15607,A SQL query to show a list of sequences that have N occurrences of specific sequence,"SELECT *
FROM WhateverThatSuperSecretTableNameIs
WHERE ( 1 IN (C1, C2, C3, C4, C5)) +
      (10 IN (C1, C2, C3, C4, C5)) +
      (56 IN (C1, C2, C3, C4, C5)) +
      (78 IN (C1, C2, C3, C4, C5)) +
      (12 IN (C1, C2, C3, C4, C5))   >= 2
"
35976,Delete duplicated rows and Update references,"--updates the data table to the min ids for each name
update Data
set id = final_id
from
  Data
join
  Doubles 
on Doubles.id = Data.id
join
(
  select 
    name
    min(id) as final_id
  from Doubles
  group by name
) min_ids
on min_ids.name = Doubles.name

--deletes redundant ids from the Doubles table
delete 
from Doubles
where id not in
(
  select 
    min(id) as final_id
  from Doubles
  group by name
)
"
33539,Count number of occurrences based on user id,"SELECT sum(leadtype_c = 'Referral') as Referrals,
       sum(leadtype_c = 'VM') as VMs,
       sum(leadtype_c = 'Email') as Emails,
       users.`first_name`, users.`last_name`
FROM users join
    `leads`
     on  users.`id` = leads.`assigned_user_id` INNER JOIN
     `leads_cstm`
     ON `leads`.`id` = `leads_cstm`.`id_c`
group by users.id;
"
16005,SQL Server : check boolean can only occur once as true,"CREATE UNIQUE INDEX IX_... ON [Table](bDefault) WHERE bDefault = 1
"
26539,Transfer records from one MySQL DB to another,"mysqldump -c -w""column=value"" db table > table.sql
"
33510,Need to change this subquery to a join? (LINQ/T-SQL/EF),"var EmployeeScheduleRoles =
  from esrManager in dbcontext.EmployeeScheduleRoles
  join esrEmployee in dbContext.EmployeeScheduleRoles on esrEmployee.ScheduleID equals esrManager.ScheduleID
  where esrManager.EmployeeID == 15921 && esrManager.RoleID == 1
  select new 
  {
     esrEmployee.EmployeeID,
     esrEmployee.ScheduleID,
     esrEmployee.RoleID
  };
"
3813,Returning results for the whole of yesterday and not the last 24 hours,"select * from message where DATE_PART('day', now() - arrival_timestamp) <= 1
"
4450,How to change the default port of mysql from 3306 to 3360,"port = 3360
"
22104,Get first row in Oracle Sql,"select * from (
SELECT DISTINCT name, age
 FROM donates, persons
 WHERE name = donor 
 AND name IN (SELECT receiver FROM donates)
 ORDER BY age DESC
) where ROWNUM <= 1;
"
18960,How to get only the most recent record on a group of data?,"SELECT *
FROM mytable a
WHERE Date = (select max(Date) from mytable b
              where a.customer = b.customer)
"
32615,"mysql how to fill a table with values (""scores"") dependent on values in other tables","SELECT cgp.city_ID AS CityID,
CASE 
  WHEN cgp.gas_price>=1.5 and cgp.gas_price<2 THEN 1
  WHEN cgp.gas_price>=2 and cgp.gas_price<=2.5 THEN 2
END AS gas_price_score,
CASE 
  WHEN cgdp.GDP>=2 and cgp.GDP<3 THEN 1
  WHEN cgdp.GDP>=3 and cgp.city_ID<=4 THEN 2
END AS GDP_score   
FROM city_gas_prices cgp
INNER JOIN city_GDPs cgdp
on cgp.city_ID=cdgp.cityID
"
17037,Need to sum transaction totals from one table using customer information in another,"SELECT c.name,
       SUM(IF(transaction_date >= DATE__SUB(NOW(), INTERVAL 1 MONTH), total_amount, 0) AS total_amount_month,
       SUM(total_amount) AS total_amount_year
FROM transactions AS t
JOIN customer AS c ON c.internal_id = t.customer_id
WHERE transaction_date >= DATE__SUB(NOW(), INTERVAL 1 YEAR
GROUP BY t.customer_id
"
15793,Use MySQL match against matching from beginning of column only,"WHERE match(TITLE) against('Some text')
  AND TITLE like 'Some text%'
"
36401,mysql query - one to many relations,"SELECT c.cakeName FROM `cakes` c LEFT JOIN `chef` ch on (ch.id=c.idChef) GROUP BY ch.name
"
1296,Access SQL Query: Find the most recent date entry for each employee for each training course,"SELECT t1.*
FROM 
    Training t1 
    INNER JOIN 
    (
        SELECT [Employee ID], [Course ID], MAX([Course Date]) AS MaxDate 
        FROM Training 
        GROUP BY [Employee ID], [Course ID]
    ) t2 
        ON t1.[Employee ID]=t2.[Employee ID] 
            AND t1.[Course ID]=t2.[Course ID] 
            AND t1.[Course Date]=t2.MaxDate
"
12880,Getting data from different tables and databinding same repeater,"select Es.recid,Es.othercolumn, Es.estatetype, Es.otherColumn from Estatetypes Es,record rec where Es.ID = rec.EstatypeID
"
10041,Setting the field selection of a SELECT statement with the Stored Procedure's Input Variable,"ALTER PROCEDURE [dbo].[PageHeadingGetText]
    @columns nvarchar(max)
AS

BEGIN
    SET NOCOUNT ON;

    DECLARE @sqlCommand NVARCHAR(MAX)

    SET @sqlCommand = 'SELECT ' + @columns + ' FROM [dbo].[PageHeadingText]' 

    EXECUTE sp_executesql @sqlCommand
END
"
23273,Import txt file into database need formatting and styling the data,"function IsEnglishRow(row)
    returns whether the row is english or not

function GenerateInsertSQL(row)
    returns ""INSERT products (item, ...) VALUES ("" + row[1] + "")""

function ImportEverything
    sql = empty string
    allRows = ReadFile.SplitIntoRows
    for each row in allRows
        if IsEnglishRow(row)
            sql += GnerateInsertSQL
    RunSQLOnServer(sql)
"
27491,SQL Server Query to get latest items,"WITH fruitStatus
AS
(
    SELECT fruit, quality, [timestamp],
            ROW_NUMBER() OVER (Partition BY Fruit ORDER BY [TimeStamp] DESC) rn
    FROM    tableName
)
SELECT fruit, quality
FROM fruitStatus
WHERE rn = 1
"
3995,Creating unique hash code (string) in SQL Server from a combination of two or more columns (of different data types),"SELECT SUBSTRING(master.dbo.fn_varbintohexstr(HashBytes('MD5', 'HelloWorld')), 3, 32)
"
18565,Change SQL data temporarily," SELECT * FROM
(
(SELECT aID, CASE month WHEN 'July' THEN '1' WHEN 'August' THEN '2' WHEN 'September' THEN '3' ELSE month END AS monthA FROM tblA) AS a
INNER JOIN
(SELECT bID, CASE month WHEN 'July' THEN '1' WHEN 'August' THEN '2' WHEN 'September' THEN '3' ELSE month END AS monthB FROM tblB) AS b
ON a.aID = b.bID
)
WHERE a.monthA < b.monthB
"
34725,Search SQL Table and only Return columns with Text,"DECLARE @rowid varchar(10) = 'Row1'
DECLARE @columns varchar(200) = ''

SELECT @columns += ','+[Col]
FROM Example_Table
UNPIVOT      
(Items FOR Col IN           
([col1], [col2], [col3]) ) AS unpvt  
WHERE rowID = @rowid

DECLARE @sql nvarchar(max) = 
  'SELECT RowID' + @columns 
  + ' FROM Example_Table WHERE RowID = @id'

EXEC sp_executesql @sql, N'@id nvarchar(10)', @rowid
"
30630,trigger in MYSQL CONSOLE,"DELIMITER $$

DROP TRIGGER IF EXISTS `myTriggerName`$$

CREATE TRIGGER `myTriggerName` AFTER DELETE ON `myTableName` FOR EACH ROW BEGIN

...........
............
.............

END$$
DELIMITER ;
"
28676,psql table querying,"SELECT
    p.id,
    p.name,
    count(m1.*) + count(m2.*) as matches,
    count(w.*) as wins
FROM players p
LEFT JOIN matches m1
ON m.p_one_id = p.id
LEFT JOIN matches m2
on m.p_two_id = p.id
LEFT JOIN wins w
ON w.p_id = p.id
GROUP BY p.id, p.name
"
10146,"Extract month , calculate and put it in a column","SELECT tipe, 
       Extract(month FROM dateissued), 
       (SELECT Count(DISTINCT( Extract(month FROM dateissued) )) AS totalMonth 
        FROM   qwe) 
FROM   qwe 
GROUP  BY tipe, 
          dateissued;
"
7982,Get closest store for each customer,"111.045*DEGREES(ACOS(COS(RADIANS(lat1)) * COS(RADIANS(lat2)) *
                     COS(RADIANS(long1) - RADIANS(long2)) +
                     SIN(RADIANS(lat1)) * SIN(RADIANS(lat2)))) AS distance_in_km
"
32325,Metaprogramming oracle sql select statement,"  DECODE(ONE, 1, 1, 0) AS col1, 
  DECODE(JUST_ONE, 1, 1, 0) AS col2,
  DECODE(ANOTHER_ONE, 1, 1, 0) AS col3,
  DECODE(TWO, 1, 1, 0) AS col4,
  DECODE(JUST_TWO, 1, 1, 0) AS col5,
  DECODE(ANOTHER_TWO, 1, 1, 0) as col6
"
6115,ORACLE USER role to limit user to view and execute function without modifying it,"-- As sysdba:
-- 1) create an user account
create user <username> identified by <password>;
-- 2) allow user to log in
grant create session to <username>;
-- 3) allow user to execute a single procedure in other schema
grant execute on <other_schema.procedure_name> to <username>;
"
14148,Slick query for one to optional one (zero or one) relationship,"val query = for {
  (p, d) <- persons joinLeft deads on (_.id === _.personId)
} yield (p, d)

val results: Future[Seq[(Person, Option[Dead])]] = db.run(query.result)
"
23593,toggeling with case when -SQL,"update likes SET
active = case when active = 1 then 0 else 1 end 
where uuid=11 and scene_id=2;
"
6782,How to replace a whole observation working on a SAS file through IML,"/* get column names ONE TIME */
use (db);
   read next var _ALL_ into temp[colname=varNames]; /* get names of cols */
close (db);

/* read index checkObs and write to temp*/
edit (db);
read point (checkObs) into temp; /* Read an entire row*/
temp[nVarToUpdate] = 1; /* I would like to update some values*/
do i = 1 to ncol(temp);
   call valset(varNames[i], temp[i]); /* update scalar variables */
end;
replace point (checkObs) var _all_;
close (db);
"
7882,Gather statistics on materialized views as part of gather_schema_stats,"BEGIN
  FOR x IN (SELECT *
              FROM dba_tables
             WHERE owner = 'SOME_SCHEMA'
               AND table_name NOT IN (<<list of MVs>>))
  LOOP
     dbms_stats.gather_table_stats( x.owner, x.table_name, ... );
  END LOOP;
END;
"
14281,SELECT DISTINCT TWO COLUMNS and SUM another COLUMN's VALUES,"SELECT e.id, SUM(price) AS 'price', g.NAME 
FROM tbl_expense e
INNER JOIN tbl_gasoline g ON e.GasolineType = g.id 
GROUP BY e.id, g.NAME
"
13294,How to format XML using T-SQL,"select Convert(Xml, FolderXml)
  from StoreFolder
for xml path(''), root('Folders')
"
6200,Group by 24 hour and Day of week - time interval,"GROUP BY DATEPART(HH,CreateDate)
"
36630,Inserting rows of a table along with a separate value into another table in postgresql,"INSERT INTO t2(c1,c2,c3)
SELECT c1,c2, NOW() FROM t1;
"
20708,Merging columns from identical tables in SQL,"SELECT ColA, ColB, ColC
FROM Table1

UNION ALL

SELECT ColA, ColB, ColC
FROM Table2 
"
5537,How to select by two unique field values in mysql,"SELECT examid, level, MAX(`points`)
FROM score
GROUP BY examid, level
ORDER BY id
"
1344,Count rows with a specific condition in aggregate query,"SELECT  Country,
        COUNT(*) AS Total,
        COUNT(CASE WHEN Reconnect = true THEN 1 END) AS With_Reconnect
FROM    PlayerSession S 
        LEFT JOIN Player P 
            ON P.id = S.player_id
GROUP BY country
"
13132,Advanced Sql query to identify missing data,"select s.suburb_id, s2.suburb_id as s2id
from suburb s 
  join suburb s2 on 
    s.suburb_id <> s2.suburb_id
    and ',' + s2.adjacent_suburb_ids + ',' like 
        '%,' + cast(s.suburb_id as varchar(10)) + ',%' 
    and ',' + s.adjacent_suburb_ids + ',' not like 
        '%,' + cast(s2.suburb_id as varchar(10)) + ',%' 
"
26410,When refreshing the result of a view?,"CREATE TABLE FlagTable
  SourceTable varchar(30),
  UpdateDate DATETIME,
  Handled CHAR(1) DEFAULT 'N'
"
32955,MYSQL Sorting By Multiple Join Children,"select pm.post_id
from post_meta pm
where pm.key = 'coolness'
order by pm.value + 0;
"
35716,How to group rows in SQL with more than 2 columns are of the same value?,"Select column1, column2 from MyTable
GROUP BY column1, column2
"
24976,max count together in an sql query,"select modeldescription, count(modeldescription) 
from products 
group by modeldescription
order by 2 desc
"
36770,SQL SELECT statement from both tables,"SELECT DISTINCT ReportTitle from HRPastReports WHERE [username] LIKE '%"" + loggedIn + ""%'"";
UNION
SELECT DISTINCT ReportTitle from FinancePastReports WHERE [username] LIKE '%"" + loggedIn+ ""%'"";
"
2276,How to access a column whose name is stored in a variable?,"EXECUTE IMMEDIATE 'INSERT INTO TABLE_TMP(ID,COLUMN1)
            (SELECT a.ID,b.' || MYCOLUMNVAR || ' FROM TAB1 a, TAB2 b WHERE...)'
"
18155,Counting columns containing data,"select t.*,
       ((case when jan is not null then 1 else 0 end) +
        (case when feb is not null then 1 else 0 end) +
        (case when mar is not null then 1 else 0 end) +
        (case when apr is not null then 1 else 0 end) +
        (case when may is not null then 1 else 0 end)
       ) as MonthsWithData       
from t;
"
37208,Select min returns empty row,"SELECT MIN(price), MIN(year)
FROM tblProduct
WHERE price <> ''
"
2368,Sql query for getting top X 'distinct' values of one field when sorting by another?,"SELECT 
  ID AS MyDistinctValue, 
  MIN(intfld) AS MySort
FROM
  MyTable
GROUP BY ID
ORDER BY MySort
"
38023,Row average in MySQL - how to exclude NULL rows from the count,"SELECT
AVG(var1) AS var1,
AVG(var2) AS var2,
AVG(var3) AS var3,
(
 SUM(ifnull(var1,0))+
 SUM(ifnull(var2,0))+
 SUM(ifnull(var3,0))
) / (COUNT(var1)+COUNT(var2)+COUNT(var3))
 AS metric_total
FROM test
"
14836,SQL: how can I compare counts from 2 different tables but output the max,"select type1
from ocean 
group by type1
having count(type1) > (
    select count(type2) from lake where type2=type1 group by type2)
"
6144,SQL Delete specific records with condition,"DELETE FROM TableName
WHERE EmployeeID IN 
(SELECT EmployeeID FROM TableName
 GROUP BY EmployeeID
 HAVING MAX(DATE)<=@Date)
"
13665,Create 2 new columns from a query,"SELECT u.ID, u.fname, u.lname
      , d1.name as div_1_name
      , d2.name as div_2_name 
FROM USERS u 
LEFT JOIN DIVISIONS d1 ON u.div_1_id = d1.ID 
LEFT JOIN DIVISIONS d2 ON u.div_2_id = d2.ID
"
25239,Retrieve the names of employees who is making least in their departments,"select *
  from employee e
 where salary = (select min(x.salary) from employee x where x.dno = e.dno)
"
18289,Convert Intersect from Oracle to MySQL,"SELECT x.company_name FROM
(select DISTINCT company_name from employee
 inner join works on
 works.Lastname=employee.Lastname AND
 works.Firstname=employee.Firstname AND
 works.MidInitial=employee.MidInitial
 where employee.city='New York') x
INNER JOIN
(select DISTINCT company_name from employee
 inner join works on
 works.Lastname=employee.Lastname AND
 works.Firstname=employee.Firstname AND
 works.MidInitial=employee.MidInitial
 where employee.city='Seattle') y
USING (company_name)
"
26529,SQL select MAX(COUNT),"SELECT ""name"", count(*) maximum FROM ""users"" 
   INNER JOIN ""microposts"" ON ""microposts"".""user_id"" = ""users"".""id"" 
GROUP BY users.id 
ORDER BY maximum DESC 
LIMIT 1
"
36438,SQL Query Using Then(?) Or a points system,"SELECT User.id, User.first, User.last,
    IF (User.first = q1 OR User.first = q2, 1, 0) +
    IF (User.last = q1 OR User.last = q2, 1, 0) as points
FROM users as User
ORDER BY points DESC
"
16076,INSERT INTO with SELECT and some DEFAULT values,"INSERT INTO chatroom (col1) SELECT id FROM person
"
8513,"sql lite, android - copy record into the same table","try {
  while (cursor2.moveToNext()) {
    dbs.ad(Id, Id, cursor2.getString(3), """",
           cursor2.getString(5), cursor2.getString(6), cursor2.getString(7), 
           """", """");
    }
}
"
3247,Autoincrement through IDENTITY in SQL Server 2012 Management Studio,"INSERT INTO G_Members (Jmno,Nick,Pjmen, Pohlav,Datum_Narozen) VALUES ( 'Martin', 'Mates', 'kornk', 'M', 01-AUG-1978);
"
19008,how to get the next row in oracle sql,"select bpv_date
from all_dates
union
select bpv_date + 1 
from all_dates
where to_char(bpv_date, 'D') = 7  -- saturday for NLS_LANG='AMERICAN', otherwise use 6
"
22716,Is there any difference to use group by in a query ?,"SELECT bk_publisher, bk_price FROM books
GROUP BY bk_price, bk_publisher
"
21261,Merging two queries to one. both have group by on the same field,"SELECT a.IP, a.hits, b.clicks, c.bought
FROM (select IP, count (IP) as hits from A group by IP) a
JOIN (select IP, count(IP) as clicks from table A join table b on A.SID = B.SID group by IP) b on a.ip = b.ip
JOIN (select IP, count(IP) as bought from A join B on A.SID = B.SID join C on C.SID = B.SID group by IP) c ON a.ip = c.ip
"
6432,SQL - Unable to Convert a string in to YYYYMMDD format,"select convert(varchar(8), convert(datetime, 
    substring(
        @data.value('(/ActiveService/@TimePeriod)[1]','nvarchar(50)'), 29, 10
    ), 120), 112)
"
3253,Unioning multiple tables together and filtering out selection based on aggregated fields.,"SELECT *
FROM ((SELECT '001' AS ReportNumber, 'RPT001' AS ReportName, ISNULL(SUM(1),0) AS ActiveReportCount
       FROM [DBNAME].[dbo].[V_Rpt001]
      ) UNION ALL 
      (SELECT '002' AS ReportNumber, 'RPT_002' AS ReportName, ISNULL(SUM(1),0) AS ActiveReportCount
       FROM [DBNAME].[dbo].[V_Rpt001]
      )
     ) r
WHERE ActiveReportCount > 0;
"
20435,Mysql join two tables get same field value based on condition,"SELECT email, firstname, lastname
FROM table_a
UNION
SELECT email, firstname, lastname
FROM table_b
WHERE email NOT IN (SELECT email FROM  table_a)
"
1208,SP_RENAME doesn't work,"alter table patient.idp change column idP id <whatever the type is>;
"
15890,Multiple joins to same table,"SELECT i.name as name, v1.value as value_1, v2.value as value_2 
  FROM item i
       INNER JOIN item_value iv ON iv.item = i.id
       INNER JOIN property p ON iv.property = p.id
       LEFT JOIN value v1 ON p.name = 'prop1' AND v1.id = iv.value
       LEFT JOIn value v2 ON p.name = 'prop2' AND v2.id = iv.value
"
35458,How to avoid SQL Injection with Update command in Npgsql?,"string UpdateCmd = ""update dx set chronic = @p1 where (trim(lower(cdesc)), trim(cicd9)) = (@p2);"";

using (NpgsqlCommand command = new NpgsqlCommand(UpdateCmd, conn))
{
    cmd.Parameters.AddWithValue(""p1"", ""chronic"");
    cmd.Parameters.AddWithValue(""p2"", ""value"");
    cmd.ExecuteNonQuery();
}
"
32326,Find all indexes in my database SQL,"select *
from sys.indexes
where name is not null
"
21018,Join type based on column value,"select *
from shops LEFT JOIN products ON products.shop_id = shops.id
where shop_type = 0 or (products.shop_id is not NULL and shop_type = 1)
"
34069,SQL query to join results from two tables but also include rows that do not have counterparts in the other table?,"SELECT COALESCE(a.NAME, b.NAME) as NAME, APPLES, ORANGES 
FROM APPLE a 
FULL OUTER JOIN ORANGE o ON o.NAME = a.NAME 
"
31970,How can I select classmates of a given student from a student-class association table?,"SELECT t1.student_id
FROM student_class_assn t
JOIN student_class_assn t1 
    ON t1.class_id = t.student_id 
    AND t1.student_id <> 1
WHERE t.student_id = 1
"
5017,Query Returning Too Many Results?,"SELECT co.name         AS country,
       ct.name         AS city, 
       t.pop AS max_pop 
FROM country AS co
      INNER JOIN (
               SELECT country_code, Max(population) AS pop FROM city GROUP BY country_code
             ) t ON co.country_code = t.country_code 
      INNER JOIN city AS ct ON ct.population = t.pop AND co.country_code = ct.country_code 
ORDER  BY country.name ASC; 
"
29241,getting one column Count based on joining 3 tables in Sql server,"SELECT Table2.QuestionSetID,
       COUNT(QuestionID)
FROM Table2 
INNER JOIN Table3
ON Table2.QuesionID = Table3.QuesionID
WHERE difficultylevel='Low'
GROUP BY Table2.QuestionSetID
"
15246,Equivalent to Oracle external tables in SQL Server,"SELECT et.*
FROM OPENROWSET( BULK 'your_data_file', FORMATFILE = 'your_format_file.fmt') AS et
"
26811,SQL Update records to sum of previous records with condition,"declare @sumc decimal
declare @sumd decimal
set @sumc=0
set @sumd=0

update myTable set 
    @sumc+= case typ when 'c' then amn else 0 end, flwc=@sumc,
    @sumd+= case typ when 'd' then amn else 0 end, flwd=@sumd
"
7192,Selecting a distinct row for a group,"select c1, c2, c3
from (select t.*,
             row_number() over (partition by c1
                                order by c3 asc, (case when c2 = 'x' then 1 else 0 end) desc
                               ) as seqnum
      from tst t
     ) t
where seqnum = 1;
"
10829,SQL triggers split with a constant and conditional,"CREATE TRIGGER trg
BEFORE UPDATE OF dept_salary
ON employee_wages

BEGIN
   CASE
      WHEN INSERTING THEN
         DBMS_OUTPUT.PUT_LINE('Inserting');
      WHEN UPDATING ('salary') THEN
         DBMS_OUTPUT.PUT_LINE('UPDATING SALARY');
      WHEN DELETING THEN
         DBMS_OUTPUT.PUT_LINE('DELETING');
   ENDCASE
END
"
5021,Oracle SQL join on column with multiple Line feed (chr(10)) seperated values,"select chapter, c.output, page
from   table_chapters c join table_pages p
   on c.output like '%' || p.output || '%'
order by chapter, page
"
6401,Select First Row from each group when many columns,"
SELECT *
FROM (
    SELECT *,
        rn = ROW_NUMBER() OVER(PARTITION BY Name ORDER BY Part)
    FROM tbl
) AS t
WHERE rn = 1
"
23026,SORT BY in SELECT,"SORT it_abs3 BY request_id [ASCENDING] version_no DESCENDING.
DELETE ADJACENT DUPLICATES FROM it_abs3 COMPARE request_id.
"
28882,How to Change Counter position for SQL field,"ALTER TABLE tbl AUTO_INCREMENT = 1533;
"
19898,Oracle database table row count,"SELECT NUM_ROWS FROM ALL_TABLES WHERE TABLE_NAME = your_table_name;
"
33708,Get count against each distinct value in SQL Server,"select a.aliasname, count(d.aliasname) as quest_count, ic.is_correct
from (select distinct aliasname from tbl_demo
     ) a cross join
     (select distinct is_correct from tbl_demo
     ) ic left outer join
     tbl_demo d
     on d.aliasname = a.aliasname and d.is_correct = ic.is_correct
group by a.aliasname, ic.is_correct;
"
9741,Nested Select statement?,"select * from tb_Worker
  join tb_Manager on tb_Worker.ManagerID = tb_Manager.ManagerID
  join tb_Head on tb_Manager.HeadID = Head.HeadID
  where tb_Head.HeadID = <given value>
"
11846,Tricky SQL Query (for me at least!),"SELECT *
  FROM shippinginfo
 WHERE trackingno IN (

    SELECT trackingno
      FROM shippinginfo
  GROUP BY trackingno
    HAVING COUNT(*) > 1

)
"
36316,What does the to_char function do?," So, 
 TO_Char(hired_date -1, day) 
 T0_Char  = method name
 hired_date = orginional date
 -1 = orignional date minus 1 day
 day = return the the day ( Sunday , Monday wensday)
"
29240,How do I change the case on every field in a mysql table in one call?,"UPDATE table SET
column1 = LOWER(column1),
column2 = LOWER(column2),
 -- etc, listing all text type columns
columnN = LOWER(columnN);
"
28025,Compare output of select statement,"select group_concat(EmployeeName) as `o/p`
from Table2 
where FIND_IN_SET(EmployeeID, 
    (select Participantsid from Table1 
    where Validfrom = '2016-02-22 18:00:00' and Validto = '2016-02-22 19:00:00'));
"
1396,Insert the value from one table into another,"insert into CommisionPickups (pName) 
(select DISTINCT c.ClientName from Clients c
where NOT EXISTS (SELECT 1 FROM CommisionPickups cp
                  WHERE c.ClientName = cp.pName)
)
"
8083,How to use SADD in Redis,"SORT user:3:categories BY nosort GET category:*->name
"
29879,Sessions aren't automatically removing themselves from Database?,"public function destroy($id)
    {
        $return = false;

        if ($this->delete($this->_getPrimary($id, self::PRIMARY_TYPE_WHERECLAUSE))) {
            $return = true;
        }

        return $return;
    }
"
29792,Delete rows with index higher than X with the same value,"     Delete t1 from
       (select accountid, 
        row_number() over (partition by accountid, order by accountid,                    
       Timestamp desc) as r 
       From lastlogin ) t1 
     where t1.r > 10
"
25351,Can you use ascii codes in SELECT statements? Specifically the SOH character,"SELECT CHR(1) FROM DUAL;
"
14234,Group by minute and fill missing,"SELECT avg(load), min(created_at) as load 
FROM generate_series('2013-3-20 0:00:00'::timestamp, '2013-3-30 0:00:00', 
              '1 minute') AS minutes(minute)
    LEFT JOIN stats ON minute=date_trunc('minute', stats.created_at)
GROUP BY minute
"
22121,Oracle SQL query to return rows that matches a column value having not a digit,"where bar_status like '%[^0-9]%'
"
7985,"Average, Count, etc of entire column of table in SQL Query or as Function in VBA to Display result in Form?","Forms!MyForm!AvgTextBox = Avg([mytable.values2Baveraged])
Forms!MyForm!CountTextBox = Count([mytable.values2Bcounted])
"
20773,How to determine whether a table is used to store materialized view logs?,"SQL> select  master, log, temp_log from sys.mlog$ where mowner = user and master = 'T1';

MASTER               LOG                  TEMP_LOG
-------------------- -------------------- --------------------
T1                   MLOG$_T1             RUPD$_T1
"
33011,How to use aggregate function to filter a dataset in ssrs 2008,"=IIF(
Max(Fields!Q9Volume.Value)<=50,
True,False
)
"
31913,Custom user autonumber,"Me!AutoNumber.Value = Format(Val(Nz(Right(DMax(""[AutoNumber]"", ""[YourTable]""), 3), 0)) + 1, ""\D000"")
"
32327,SQL how to select data in this specific situation,"select i.item_id, il.price, i.quantity
from items i, items_list il
where i.player_id=$player_id
and i.item_id = il.item_id
group by i.item_id
"
15153,how to design a database table with similar entries,"select
      b.ProductName
    , c.ColorName
    , b.ProductPrice + coalesce(x.ColorPrice, 0.0) as ProductPrice
from      Product     as p
join      BaseProduct as b on b.BaseProductID = p.BaseProductID
join      Color       as c on c.ColorId       = p.ColorId
left join ColorCharge as x on x.BaseProductID = p.BaseProductID and x.ColorID = p.ColorID
where p.BaseProductID = specific_prodict_id;
"
1004,Case statement inside IN statement,"Select * 
from people p 
where 
( 
    @age = 0 
    AND p.age IN (10, 11, 12, 13)
)
OR
(
    @age != 0 
    AND p.age = @age
)
"
36593,Node.js store remote database locally (sync),"connection.query('select * from database.table;', function(err, results, fields) {
    if (!err) {
      fs.writeFile('location\name.json', JSON.stringify(results), function(err) {});
    }
  });
"
38158,Select parent row only if it has no children,"SELECT id FROM A LEFT OUTER JOIN B ON A.id=B.id WHERE B.id IS NULL
"
17995,How to search many tables efficiently,"Select match from 
(select name as match from costumers where name like'%foo%' UNION
 select category as match from products where category like'%foo%' ...)
"
39836,Finding the min and max length of movies in sqlite,"select min(length), max(length) from movies
"
20283,Updating a Table after some values are inserted into it in SQL Server 2008,"create procedure dbo.test

as

begin 

create table #temp (
name varchar(100) ,
id int
)

insert #temp
select name ,
       id 
from master..sysobjects

update #temp

set name='ALL Same'

from #temp

select * from #temp

drop table #temp

end
go
"
29309,Sorting an Alphanumeric value mysql,"select columnName from tableName
order by convert(int, right(columnName, 5)) desc
"
15998,PostgreSQL WITH query,"WITH t AS (
    UPDATE products SET price = price * 1.05
    RETURNING *
)
SELECT p.*, t.price, (t.price - old.price) as diff
FROM products p JOIN
     t
     ON p.productid = t.productid;
"
12372,"How to fix a count() in a query with a ""group by"" clause?","Select count(*) as rowcount from
(

     Paste your query here

) as countquery
"
4365,How do you create and update your SQL scripts?,"INSERT INTO DB_VERSION (upgrade_time, version_from, version_to, comment)
    VALUES ('2011-07-04T120320', '2.2.4', '2.3', 'add column x to table y.')
"
23275,"Given a table with time periods, query for a list of sum per day","SELECT 
    SUM(NumericColumnName)
    , DateTimePeriods.StartDate
    , DateTimePeriods.EndDate
FROM 
    TableName
    INNER JOIN DateTimePeriods ON TableName.dateColumnName BETWEEN DateTimePeriods.StartDate and DateTimePeriods.EndDate
GROUP BY 
    DateTimePeriods.StartDate
    , DateTimePeriods.EndDate
"
16535,SQL Group By a substring in a field,"SELECT SUBSTRING(cityname, CHARINDEX('(',cityname)+1,
           (LEN(cityname) - CHARINDEX('(',cityname)-1)) 
FROM cities WHERE cityname LIKE '(%)%' 
"
24441,SQL - Oracle - how to select securities from table with top change %,"select m.*
from (select security, price1, price2, ((price2 - price1)/price1)*100 as Percentage,
             dense_rank() over (order by ((price2 - price1)/price1)*100 desc) as ranking
      from market
     ) m
where ranking = 1;
"
32605,Filter max of rn,"select  *
from    (
        select  *
        ,       row_number() over (partition by name order by ox desc) as rn
        from    YourTable
        ) as SubQueryAlias
where   rn = 1
"
33963,Using a single common WHERE condition for UNION in SQL,"SELECT * FROM (
  SELECT a.date AS EnrollDate, a.id, a.name, b.address FROM student a JOIN Location b ON a.id=b.id  
  UNION  
  SELECT a.date AS EnrollDate, a.id, a.name, b.address FROM teacher a JOIN Location b ON a.id=b.id  
) A
WHERE EnrollDate > '2010-01-01'  
ORDER BY EnrollDate
"
4834,How do I retrieve all tables in a database using SQL in Ms Access?,"SELECT name
from msysobjects
WHERE type=1 and flags=0
;
"
17737,Inserting an automatically generated index from a table into another table,"insert into table1(name, type) values (y, z);
insert into table2(item_id, place) values (LAST_INSERT_ID() , w);
"
38367,Retrieving two COUNTs using a single SQL statement,"SELECT
   COUNT(CASE status WHEN 1 THEN 1 ELSE NULL END) AS Ones,
   COUNT(CASE status WHEN 0 THEN 1 ELSE NULL END) AS Zeros
FROM
   MyTable
"
29257,SQL Select Query,"select CarId, CustomerId, Price
    , cast(row_number() over (partition by CustomerId order by CustomerId) as varchar)
        + '/' + cast(count(*) over (partition by CustomerId ) as varchar)
    from t
"
12436,"Sql, Subquery into a LIKE() operator","SELECT * FROM users u WHERE u.user_name LIKE (select '%arthur%' from dual);
"
27,mySQL - how to flatten records and subrecords,"select r.username, street.value, city.value
from records r
join subrecords street
  on street.record = r.id
   and street.name = 'Street'
join subrecords city
  on city.record = r.id
   and city.name = 'City'
order by r.username;
"
17977,Alter a Table by adding a new column whose value depends on another column,"update smtp set connectionType = (case when connectionRequired = '1' then 1 else 0 end);
"
33253,MySQL Exclude results from JOIN,"SELECT s.location_id
FROM signals s
WHERE s.MAC in (1, 2, 3, 4)
GROUP BY s.location_id
HAVING COUNT(DISTINCT s.MAC) = 4;
"
29434,How to order by column not in select clause?,"order by min(dbo.ITR.ITR_TransDate)
"
2134,How to add 1 hour to currrent_timestamp in mysql which is the default value?,"CREATE TRIGGER tr_dt_table BEFORE INSERT ON your_table FOR EACH ROW BEGIN
  SET NEW.datetime_field = NOW() + INTERVAL 1 HOUR;
END
"
32418,Mysql storage engine for log table,"InnoDB has been designed for maximum performance when processing large data volumes. 
Its CPU efficiency is probably not matched by any other disk-based relational database
engine.
"
3580,Combining two fields from two different tables in SQL,"SELECT AVG(price) AS P FROM
(
    SELECT price FROM test
    UNION ALL
    SELECT price FROM test1
) AS TMP
"
5116,Slow Oracle execution,"FUNCTION orgname_format (p_org_name VARCHAR2)
   RETURN VARCHAR2 DETERMINISTIC IS
BEGIN 
   ...
END;
"
22466,SSRS - How to group Date into Today/Yesterday/Week/Month in a Matrix?,"SELECT 
 CASE WHEN DATEDIFF(day, GETDATE(), DateColumn) = 0 THEN SomeColumn ELSE 0 END cToday
 CASE WHEN DATEDIFF(day, GETDATE(), DateColumn) = 1 THEN SomeColumn ELSE 0 END cYesterday
 CASE WHEN DATEDIFF(day, GETDATE(), DateColumn) > 0 AND 
           DATEDIFF(day, GETDATE(), DateColumn) < 8 THEN SomeColumn ELSE 0 END cWeek
 CASE WHEN DATEDIFF(day, GETDATE(), DateColumn) > 0 THEN SomeColumn ELSE 0 END cMonth
FROM 
 SomeTable
WHERE 
 DateColumn > DATEADD(day, -28, GETDATE())
"
8860,Counting bussiness days between two dates for each row in a table,"with rcte(a,b, i, is_wd) as (
select from_dt , to_dt , id, case when (to_char(from_dt, 'DY') in ('SAT','SUN')) then 0 else 1 end from t
  union all
  select decode(a, null, a,a+1), b, i, case when (to_char(a, 'DY') in ('SAT','SUN')) then 0 else 1 end 
  from rcte
  where a+1 <= b
)
select i id, sum(is_wd) 
from rcte
group by i
"
8253,Create JSON string using standard functions using PL/SQL Oracle,"declare
   json_text varchar2(20);
begin
   json_text := '{""key"":""value""}';
end;
"
32345,SQL- countif correspondence from Excel,"select code1, 
       count(*) over (partition by code1) as cnt
from the_table
order by code1;
"
38739,Querying Two Tables At Once,"SELECT l.username, l.loginid, s.loginid, s.submissionid,
  s.title, s.url, s.datesubmitted, s.displayurl
FROM submission AS s
INNER JOIN login AS l
  ON s.loginid = l.loginid
WHERE l.username = '$profile'
ORDER BY s.datesubmitted DESC
"
36825,SQL Case with multiple values,"SELECT Name, CASE WHEN statusid < 4 THEN 'Alive'
                  WHEN statusid = 4 THEN 'Dying'
                  ELSE 'Dead' END AS some_alias
  FROM people
"
21835,Remove and split data into multiple columns in select statement,"SELECT SUBSTRING(@ourName, 1, CHARINDEX(' ', @ourName)) AS [First],
SUBSTRING(@ourName, CHARINDEX(' ', @ourName) + 2, LEN(@ourName)) AS[Last]
"
22636,How to select every row N times in MySql table?,"SELECT * FROM
(
  SELECT NAME, SURNAME FROM Person
  UNION ALL
  SELECT NAME, SURNAME FROM Person
  UNION ALL
  SELECT NAME, SURNAME FROM Person
) A ORDER BY NAME
"
15548,select query using multiple like conditions,"... payhistory.comment NOT LIKE 'Elit%'
AND not ((customer like 'FTS%' or customer like 'EMC%') AND batchtype = 'PC')
"
13240,Question on partial keys and an index on a database table,"CREATE INDEX the_idx {f2, f1, f3, f4}
"
1834,find out particular id,"SELECT id
FROM mytable
GROUP BY id
HAVING COUNT(CASE WHEN COALESCE(billpay, 0) <> 1 THEN 1 END) = 0 
"
9817,regexp_replace / Substr extract string before and after dashes Oracle,"SELECT Replace(REGEXP_SUBSTR(str, '\-([[:alnum:]]\-)+'), '-', ' ') as outstr
FROM (SELECT 'XTT-D-X-K-345ROCKVIEW-CA' AS str FROM dual
  UNION ALL SELECT 'RT-5-345REDE' AS str FROM dual
  UNION ALL SELECT 'FT-5-3-345HOTELWI' AS str FROM dual
"
38014,"sql query search into two tables, performance issue","select a.`ID_CLIENT`
from clienti a
where  a.`ClientName` LIKE '%blue%' 
union
SELECT b.`ID_CLIENT`
FROM Details b
WHERE b.`Details` LIKE '%blue%';
"
2506,Getting current system time in SQL Server,"SELECT GETDATE()
"
17860,How would I exclude query results if the result has a timestamp within a particular range of another result?,"select * from (
  select row_number() over (partition by person, action, item, CONVERT(date, time) order by time desc) rn, *
  from mytable
) t1 where rn = 1
"
39,SQL query to make a list from multiple tables,"SELECT i.code,
       i.description,
       it.description,
       sc.description,
       um.description
FROM items AS i
INNER JOIN itemtype AS it
    ON i.item_type_id = it.id
INNER JOIN subcategory AS sc
    ON i.subcateg_id = sc.id
INNER JOIN uom AS um
    ON i.uom_id = um.id
"
39700,Counting how many times a boolean value changes in SQL Server,"select count(*)
from (select t.*, lag(value) order by (sdate) as prev_value
      from table t
     ) t
where prev_value <> value ;
"
6027,Simple SQL Statement in Oracle,"select
   c.id,
   c.brandid,
   coalesce(b.brandname, 'Invalid')
from customers c
left join brands b on c.brandid = b.brandid;
"
11272,How to change a column's value according to If condition,"Update orderTB
  Set Status = 'Inactive'
  WHERE Status = 'ACTIVE'
    AND OrderDate < '10/10/2003'
"
4963,How to get rows with duplicate values with a better performance,"select `match`.* 
from `match` join (select `matchView`.`homeTeam` 
                   from `matchView` 
                   group by `matchView`.`homeTeam` 
                    having (count(0) > 1)) watches ON `match`.`homeTeam`=watches.`homeTeam`
order by `match`.`homeTeam`
"
17285,Only transfer rows Order Lines with matching Order Header,"insert into dbNew.dbo.OrderLines (columns)
select columns
from dbOld.dbo.OrderLines old_lines
where exists (
    select null
    from dbNew.dbo.OrderHeader h
    where old_lines.OrderID = h.OrderID
)
"
2018,SQL - Joining multiple records to one record,"select c.clientname, i.description, p.price, 
   stuff((select ', ' + a.AgentName 
    from SalesAgent sa join PurchaseSalesAgent psa on psa.AgentID = sa.AgentID
    where psa.PurchaseID = p.purchaseID
    for xml path('')),1,2,'') as Agents
from client c 
join purchase p on p.clientid = c.clientid
join item i on i.itemid = p.itemid
;
"
38230,How to write a relatively simple UPDATE query with two linked tables,"UDPATE
  orders
  JOIN CARS ON orders.Vrm = cars.VRM
SET orders.Mileage = cars.mileage
WHERE orders.mileage = ''
"
25352,Exclude tables in the Par file during export in oracle,"OWNER=RATOR_MONITORING
LOG=exp02_rm.log
FILE=exp02_rm.dmp
TABLES=KPI_LOGS,ALERT_LOGS
INDEXES=Y
CONSTRAINTS=Y
GRANTS=Y
COMPRESS=Y
FULL=N
ROWS=Y
CONSISTENT=Y
BUFFER=102035256
FEEDBACK=500
"
25625,Search string based on length of parameter and start of path,"set @dash = NCHAR(8211)

SELECT ID, AddedBy, Title, Path_String 
FROM MyTable 
WHERE Path_String Like  @Paramter + @dash + '%';
"
28795,ROR How to limit user actions,"before_action :check_admin, only: [:admin_actions_array]
before_action :check_user, only: [:create, :delete]

def check_user
  return false unless current_user
end

def check_admin
  return true if current_user.admin
end
"
33473,"ORDER BY ""ENUM field"" in MYSQL","ORDER BY CAST(noticeBy AS CHAR)
"
16499,SQL : Avoiding duplicates by comparing the consecutive rows,"select td.PS_DRIVER
from tabDrivers td
where td.PS_Completion_TS in (select max(td2.PS_Completion_TS) 
                              from tabDrivers td2 
                              where td2.PS_DRIVER = td.PS_DRIVER  )
"
9863,How can I be DRY in columns names in this MySQL procedure?,"information_schema.COLUMNS.COLUMN_COMMENT
"
8997,Calculated fields across different lines in SQL Server 2012,"select  *,(a.Qty * a.Price) as col1 from test a  join test b on a.BOMID = b.ItemId
"
26087,MySQL- how to get data from 3 table?,"SELECT Table3.* FROM Table1 LEFT JOIN (Table2, Table3) 
ON (table1.GID=1 and table2.UID=table1.UID and table3.CID=table2.CID)
"
23451,"Access SQL: How to select dates after today if current year, else select all dates","    select monto from cupones where (year(fechapago) = year(date() and (month(fechapago) > month(date()) or (month(fechapago) == month(date() and day(fechapago) > day(date()))( or (year(fechapago()) > year(date()))
"
12380,MySQL select multiple row on table 2 with two differents Id from table 1 result in one row as two differents fields,"select t21.text as subject, t22.text as description
from table1 t1
join table2 t21 on t1.refidone = t21.id
join table2 t22 on t1.refidtwo = t22.id
"
15283,Updating sql record based on 2 values in table,"update database
set [TimeOut] = @p_timeOut
where GRID = @p_GRID 
and GRVLID = (select MAX(GRVLID) from database WHERE where GRID = @p_GRID)
"
29677,How do I get the right 2 dimensional array for this table in H2?,"SELECT step_col, GROUP_CONCAT(time_col)
FROM H2 GROUP BY step_col
"
33946,Union of two boolean Rows with the same tag,"SELECT TAG,
    CAST(MAX(CAST(Bool1 as int)) as bit) as Bool1,
    CAST(MAX(CAST(Bool2 as int)) as bit) as Bool2,
    CAST(MAX(CAST(Bool3 as int)) as bit) as Bool3
from Table group by TAG
"
22622,Ordering SQL results by attributes in another table,"SELECT buses.*
FROM buses
ORDER BY (
  SELECT MIN(stops.time) FROM stops WHERE stops.bus_id = buses.id
)
"
14558,Select from two different tables,"SELECT
  N1.Name AS `Name1`,
  N2.Name AS `Name2`,
  N3.Name AS `Name3`,
  N4.Name AS `Name4`
FROM
  R
INNER JOIN
  N N1
ON
  N1.Id = R.Id1
INNER JOIN
  N N2
ON
  N2.Id = R.Id2
INNER JOIN
  N N3
ON
  N3.Id = R.Id3
INNER JOIN
  N N4
ON
  N4.Id = R.Id4
"
3559,Changing the value of a SQL table with inserts into an other table,"CREATE or REPLACE TRIGGER trg_transaction
AFTER INSERT
   ON ***transaction***

DECLARE
   -- variable declarations

BEGIN
   -- trigger code
   UPDATE ***bankaccount*** SET ....

END;
"
39163,MySQL AND OR Statement,"SELECT * 
FROM users
WHERE username =  'bob'
AND
( 
  device_1 =  'test'
  OR device_2 =  'test'
  OR device_3 =  'test'
) 
"
26942,Converting data in SQL Server,"select convert(datetime, '12-NOV-1975')
1975-11-12 00:00:00.000
"
8128,sum of last month and total,"SELECT p.user_login, 
  SUM(IF(DATE(`when`) >= CURDATE() - INTERVAL 30 DAY,p.value,0)) sum,
  SUM(p.value) total_sum
FROM user_value p
JOIN user u
  ON u.login = p.user_login
GROUP BY p.user_login
ORDER BY sum DESC;
"
32206,Wrong OrderBy in Sql query ordered in opposite way,"select * from users order by sc+0 desc
"
31881,Select all rows except that match the condition,"select F.Foo_id, F.Foo_Name
from
    Foo F left outer join Bar B
        on F.Foo_id = B.Foo_id and B.Bar_status = 'Yes'
where B.Foo_id is null
"
4818,get extra rows for each group where date doesn't exist,"select 
  s.emp_name as Name
  ,s.Number as m 
  ,st.salestotal as Amount
from (
  select distinct emp_name, number
  from salestotals, numbers 
  where number between 1 and 12) s left join salestotals st on 
    s.emp_name = st.emp_name and s.number = month(st.yearmonth)
"
23633,Joining the same table twice,"SELECT * FROM cases c
LEFT JOIN users u1 ON c.fk_supporter = u1.user_id
LEFT JOIN users u2 ON c.fk_creator = u2.user_id
"
35705,SQL query to return rows with the value of a column above a certain minimum value depending on category?,"select t1.*
from table1 t1 join table2 t2 on t1.category = t2.category
where t1.rating >= t2.minimum_rating;
"
24269,Symfony query on intermediate table,"$id = 1; // Your event id

$repository = $this->getDoctrine()
    ->getRepository('AcmeDemoBundle:Entity');

$query = $repository->createQueryBuilder('g')
    ->select('e')
    ->leftJoin('g.events', 'e', 'WITH', 'e.id = :id')
    ->setParameter('id', $id)
    ->getQuery();

$events = $query->getResult();
"
13638,Complex SQL select using group by,"Select
    A.*
From [Table] A
Join (Select Name, MAX(C2) From [Table] Group By [Name]) B
    On A.Name = B.Name And A.C2 = B.C2
"
18975,formatting decimal data type to show currency,"SELECT TRIM(salary * (-1) (FORMAT '-Z(I)BN'))
"
16204,MySQL Weekday/Weekend count - Part II,"SELECT 
  fname, 
  MONTH(eventDate), 
  SUM(IF(WEEKDAY(eventDate) < 5,1,0)) AS WeekdayCount,
  SUM(IF(WEEKDAY(eventDate) >= 5,1,0)) AS WeekendCount
FROM eventcal AS e
LEFT JOIN users AS u ON e.primary = u.username
GROUP BY fname, MONTH(eventDate);
"
9524,Getting wrong result when converting percentage field to float,"(code = '2222' AND cast(percentage as float)/100 < 0.50)
     OR   (code = '3333')
"
36236,Syntax for SQL Server when either of parameter is passed,"WHERE PROCESS_STEP_ID = coalesce( @processStepID, @PROCESS_StepID )
"
33967,sql lists out all foreign keys of a primary key,"select ku.* 
from INFORMATION_SCHEMA.table_constraints tc   
INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE ku ON
(tc.CONSTRAINT_NAME = ku.CONSTRAINT_NAME and tc.CONSTRAINT_SCHEMA =   
ku.CONSTRAINT_SCHEMA )
where constraint_type='FOREIGN KEY' and ku.REFERENCED_TABLE_NAME =     
'your_table_name'
"
37744,create if not exists view?,"CREATE VIEW Syntax

CREATE
    [OR REPLACE]
    [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}]
    [DEFINER = { user | CURRENT_USER }]
    [SQL SECURITY { DEFINER | INVOKER }]
    VIEW view_name [(column_list)]
    AS select_statement
    [WITH [CASCADED | LOCAL] CHECK OPTION]
"
8801,Store the query result in variable using postgresql Stored procedure,"select test_table.name into name from test_table where id = x;
"
25902,Adding strings in mysql,"SELECT CONCAT(  'data', CAST( CURDATE( ) AS CHAR ) ,  '.txt' )
"
33875,Set cursor order to desc but still start at beginning of table?,"select *
  from (select rank, item
          from itemtable
         order by rank asc)
 where rownum <= v_num
 order by rank desc
"
15783,Adding sums from one table to a second table,"SELECT SUM(u.amount)
FROM user_details u
where exists (select * from tempTable t where t.child_id = u.child_id)
"
3616,using dense_rank to find distinct,"select t.*
from (select t.*,
             row_number() over (partition by student_id order by student_id) as seqnum
      from test t
     ) t
where seqnum = 1;
"
37059,Oracle SQL - Not in subquery,"SELECT COUNT(DISTINCT CaseNumber) 
FROM LinkedPeople
WHERE CaseNumber NOT IN 
(
  SELECT DISTINCT C.CaseNumber
  FROM CaseDetail C       
  INNER JOIN LinkedPeople P ON C.CaseNumber = P.CaseNumber
  INNER JOIN Location L
  ON P.LinkedPerson = L.LinkedPerson
  WHERE Country = 'AU' AND C.CaseType = 'RelevantToThisQuestion'
)
"
16179,Oracle insert script with condition,"WHENEVER SQLERROR EXIT SQL.SQLCODE
"
29256,MySQL: get how many entrys for each id on each date?,"Select date, associate_id, count(*) as per_date
From tracking
Group By assoicate_id, date
Order by date
"
25890,How should i design my tables in relation database,"aaa | bbb | ccc | date
111 | 222 | 333 | 23.2.2016
...
"
24001,Update one Table with data from another Table,"update scores s join
       (select player, avg(kills) avgkills
        from games g
        group by player
       ) g
       on s.player = g.player
    set s.averagekils = g.avgkills;
"
19536,Get count by multiple condition,"select city,
       sum(case when active = 'true' then 1 else 0 end) active,
       sum(case when blacklist = 'true' then 1 else 0 end) blacklist,
       sum(case when license = 'true' then 1 else 0 end) license,
       sum(case when married = 'true' then 1 else 0 end) married
from TableName
group by city
"
25935,MySQL Workbench user input,"SET @mTest := 'This is a test';
Select tbl_test where testField like @mTest;
"
22023,insert if not exists in sqlite with vb.net,"if not exists(select 1 from xtable)
   begin
       insert into xtable(x,y,z) select $x, $y,$z from xtable
   end
"
31198,"""if, then, else"" in SQLite","CASE x WHEN w1 THEN r1 WHEN w2 THEN r2 ELSE r3 END
"
32384,How can I update contents on an HTML5 web application,"// use localStorage for persistent storage
// use sessionStorage for per tab storage
saveButton.addEventListener('click', function () {
  window.localStorage.setItem('value', area.value);
  window.localStorage.setItem('timestamp', (new Date()).getTime());
}, false);
textarea.value = window.localStorage.getItem('value');
"
29807,Problem creating foreign keys in mySql,"alter table users engine=InnoDB;
"
15101,How to create tables in Oracle DB from the set of *.sql files,"@script1.sql
@script2.sql
...etc...
"
15227,Apply grouping to a SQL Server view,"SELECT Cast(Datepart(YEAR, StartDate) AS VARCHAR(4))
       + '-'
       + Cast(Datepart(MONTH, StartDate) AS VARCHAR(2)) AS StartDate,
       Count(ServicePictureID)                          AS TotalPicture
FROM   PictureCount
WHERE  ProjectID = '11'
       AND CreatedDate BETWEEN '2014-10-31' AND '2014-12-06'
GROUP  BY Datepart(YEAR, StartDate),Datepart(MONTH, StartDate) 
"
39797,reverse SQL LIKE,"SELECT  *
FROM    table_name
WHERE   'Awesome stuff' LIKE field_value
"
10002,Grails: How to reduce DB queries,"import groovy.sql.Sql

class MyService {
  def dataSource

  int myCalc() {
    Sql sql = new Sql(dataSource)
    String query = """"""
select count(*) tot1, 
       (select count(*) from domain_class2) as tot2
  from domain_class1
""""""
    def row = sql.firstRow(query)
    //access properties directly
    println row.tot1
    println row.tot2
  }
}
"
2839,Need help in complex postgresql select,"select a.activity_id, coalesce(acs.score, 0) as thescore
from activities a left outer join
     activityscores acs
     on a.activity_id = acs.activity_id and
        acs.student_id = THESTUDENTID;
"
15600,MySQL return first row related to a given id,"SELECT total.department, total_count, IFNULL(done, 0) as done_count, ROUND((IFNULL(done, 0) / total_count)*100, 2) as percent 
FROM (SELECT department, COUNT(*) total_count FROM agents GROUP BY department) total 
LEFT JOIN (SELECT a.department as department, COUNT(distinct a.id) as done FROM agents a, tasks p WHERE p.task_responses_id IS NOT NULL AND (p.agent1_id = a.id OR p.agent2_id = a.id) 
GROUP BY a.department) done ON done.department = total.department;
"
15734,oracle sql. transform one column into one row,"select max(case when seqnum = 1 then t.col end) as col1,
       max(case when seqnum = 2 then t.col end) as col2,
       max(case when seqnum = 3 then t.col end) as col3,
       max(case when seqnum = 4 then t.col end) as col4
from (select t.*, row_number() over (order by NULL) as seqnum
      from t
     ) t
"
26905,COUNT( ) on multiple columns each having a condition,"select 
name,
sum(Present = 1) Presentcount,
sum(Absent = 1) Absentcount,
sum(Leaves= 1) Leavescount
from Attendance
group by name
"
32593,Is this SQL query guaranteed to join correctly?,"SELECT qr.* FROM question_records qr
                 enrollments      e
                 questions        q
  WHERE e.id = qr.enrollment_id
    AND q.id = qr.question_id
    -- your original WHERE condition
    AND enrollments.id IN (10,20) 
    AND questions.id IN (500,600) 
    AND question_records.id not in (3000,4000))
"
26299,Join two tables date from first in range of dates from second,"SELECT EH.*, EO.OVERTIME_DATE 
FROM EMPLOYEE_HOLIDAYS EH
JOIN EMPLOYEE_OVERTIMES EO
ON (EO.EMPLOYEE_ID = EH.EMPLOYEE_ID) AND 
   (EO.OVERTIME_DATE BETWEEN EH.START_DATE AND EH.END_DATE)
"
21151,executing null values records,"select * from newtimeattendance where TotalTime IS NULL
"
14840,mysql to check room availability in a hotel for a particular date and time duration,"SELECT * FROM hotel_room_book a , hotel_room_book b WHERE a.checkout_date<= 
 $new_checkin_date  AND b.checkin_date >= $new_checkout_date AND a.hotel_id = 
 b.hotel_id AND a.hotel_room_id = b.hotel_room_id ;
"
27403,MySQL: Use data from one table to fill a second table using phpMyAdmin,"INSERT INTO 'attempt'(snum,tnum,anum,period) SELECT DISTINCT snum,tnum,anum,CONCAT('2013-',anum) as period FROM mark;
"
13964,"Finding the ""&"" character in SQL SERVER using a like statement and Wildcards","SELECT * FROM TABLE WHERE FIELD LIKE '%&%'
"
12731,SQL breaking a string between characters in a view,"declare @a as varchar(100)
set @a='Trading~Concession~Telemetry - OCPD / Low Sales'

select substring(@a,0,patindex('%~%',@a)) as trading_status,reverse(substring(reverse(@a),0,PATINDEX('%~%',(reverse(@a))))) as problem1,
substring(@a,patindex('%~%',@a)+1,10) as problem2
"
30580,Lock SQL on Select,"BEGIN TRAN
    SELECT TOP * FROM TABLE WITH (XLOCK, ROWLOCK, READPAST)
    UPDATE TABLE SET Processed = 1
END TRAN
"
33932,"limitations of ""SELECT .. IN"" pgsql query","SELECT objectName, objectType
FROM objectTable INNER JOIN objectids ON (objecttable.objectid = objectids.id)
"
18863,"Oracle: Multi-Column ""Closest Match"" Autocomplete Strategy","    create table searcher
    (
    user_id  number, --FK back to users
    search_column  varchar2(50) -- or whatever size column is appropriate
    );

    select u.first_name, u.last_name, u.login. u.email,
utl_match.jaro_winkler_similarity(search_column, 'js')
    from users u
    join
    searcher s
    on (u.user_id = s.user_id)
    where s.search_column like upper('js%')
    order by 5;
"
7013,"How to insert result to table with ""WITH AS"" clause","DECLARE @MyTable TABLE(Field_1 INT, Field_2 INT);
------------------------------------------------^

INSERT @MyTable VALUES
(1,2),
(2,2);
-----^    

WITH x AS ( SELECT Field_1, Field_2  FROM @MyTable)
------------------------------------------^
INSERT INTO @MyTAble  SELECT * FROM x ;
---------------------^---------------^^

SELECT * FROM @MyTable;
--------------^-------^
"
23121,sql insert select combinations,"INSERT INTO cards (cardid, color, value)
Select c.colorid + 1000 * v.valueid, c.colorid, v.valueid
FROM   color c CROSS JOIN value v
"
19605,Excluding Values with a Subquery,"select movie_name
from movies as m
inner join actors_movies as am on m.movie_id = am.movie_id
left outer join actors as a on a.actor_id = am.actor_id
    and actor_name = 'actor_name'
where a.actor_id is null;
"
787,finding distinct elements in a column without using keyword DISTINCT in sql,"SELECT v1
FROM ztable
GROUP by v1
        ;
"
20174,How to GROUP entries BY uninterrupted sequence?,"SELECT title, string_agg(id::text, ',' ORDER BY id)
FROM (
  SELECT id, title, 
         ROW_NUMBER() OVER (ORDER BY load_sequence) -
         ROW_NUMBER() OVER (PARTITION BY title 
                            ORDER BY load_sequence) AS grp
  FROM entries ) AS t
GROUP BY title, grp
"
29759,Adding a WHERE clause to Zend_Validate_Db_NoRecordExists,"$validate = new Zend_Validate_Db_RecordExists (array (
    'table' => 'orders',
    'field' => 'id',
    'exclude' => 'recordDelete = 1'
));

$result = $validate->isValid ('000489FS1qT81XR4GWuV');
"
6197,SQL Query to List,"DECLARE @MyCSV Varchar(200) = ''

SELECT @MyCSV = @MyCSV +
CAST(faulttype AS Varchar) + ','
FROM @Simfaults
GROUP BY faultType

SET @MyCSV = LEFT(@MyCSV, LEN(@MyCSV) - 1)

SELECT @MyCSV
"
8608,Conditional Split in SSIS based on the number of times a character appears in a string,"LEN([email]) - LEN(REPLACE([email], ""@"", """"))
"
32584,"Using "" Is NULL/not NULL"" in LINQ To SQL","public static List<Agir> GetINDEFAgir()
 {

 DataClassesActilogDataContext db = ContextSingleton.GetDataContext();

 List<Agir> list;

 var v = from i in db.Agir
         where i.facturable == null && i.NouvelIncident == true
         select i;

 list = v.ToList();
 return list;

 }
"
9227,Average age using months_between(),"select [some columns here], AVG(SYSDATE - BORN)/365.25 as avg_age
from   your_table
"
34215,SELECT Table From Other Table,"SELECT ID FROM Table2 AS T2
INNER JOIN Table1 AS T1
ON T2.ID=T1.ID
"
35897,how to separate string into different columns?,"Declare @Sample Table
(MachineName varchar(max))

Insert into @Sample
values 
('Ab bb zecos'),('a Zeng')


  SELECT 
  Reverse(ParseName(Replace(Reverse(MachineName), ' ', '.'), 1)) As [M1]
 , Reverse(ParseName(Replace(Reverse(MachineName), ' ', '.'), 2)) As [M2]
 , Reverse(ParseName(Replace(Reverse(MachineName), ' ', '.'), 3)) As [M3]

  FROM  (Select MachineName from @Sample
  ) As [x] 
"
10927,SQL server Update using JOIN,"    UPDATE t2
    SET t2.LastGrantDate = t1.maxppsd
    from table2 t2 inner join
         (select FundingEstablish, max(PlannedProjStartDate) as maxppsd
          from table1
          group by FundingEstablish
         ) t1
         on t2.Serial = t1.FundingEstablish;
"
7853,"Need to compare 2 variables, each coming from a separate data set, and flag differences","proc freq data=rslt1;
tables accsnnum*ibtestcd/out=rsltcounts;
run;

proc freq data=lab1;
tables accsnnum*ibtestcd/out=labcounts;
run;

proc compare base=lab1 compare=rslt1 out=compares /* options */;
by accsnnum;
run;
"
7569,Adjust SQL Query to force a record to appear first?,"select * from Members
order by case when MemberID = XXX then 0 else 1 end
"
27580,ScalaQuery multiple primary key & foreign key,"object myTable2 extends Table([Int, Int, Int])(""myTable2"") {
  def pk1 = column[Int](""id1"")
  def pk2 = column[Int](""id2"")
  def fk1 = column[Int](""fk1"")
  def * = pk1 ~ pk2 ~ fk1
  def pk = primaryKey(""pk_myTable2"", pk1 ~ pk2)
  def fkMyTable1 = foreignKey(""myTable1_fk"", fk1, myTable1)(_.id)
}
"
17835,Very large intervals in PostgreSQL,"SELECT INTERVAL '1 second' * 50000000000;
"
22399,#1452 - Cannot add or update a child row in 2 tables,"-- Areas have to be inserted with null presidents, and updated later
insert into area values (1, null);
insert into member values(1, 1);
update area set presidentmemberid = 1 where areaid = 1;
"
32973,Webmatrix - Order by entry in separate table,"var images = db.query(@""SELECT t1.* FROM Images t1 LEFT JOIN Property t2 ON
    t1.ImageID = t2.Primary_Image WHERE t1.PropertyID = @0 ORDER BY
    t2.Primary_Image DESC"", PropertyID);
"
18704,TSQL Check for Date difference except for Min Value," SELECT *
 FROM Message m              
 WHERE m.ID NOT IN (SELECT mt.MessageID 
                  FROM MessageTracking mt
                  WHERE mt.SubscriberID = @UserID
                 )
 AND (m.DateExpires > GETDATE()) OR (m.DateExpires = '1900-01-01 00:00:00.000'))
 ORDER BY m.DateCreated DESC
"
13921,"""Where Not In"" in LINQ to EF4","var q = from p in ProductReport
        where !ClientProduct.Any(c => 
           c.ClientId == new Guid(""06ae6be1-ca94-44c9-bd30-f1d4f3ac3264"") && 
           p.ProductId == c.ProductId)
        select p.ProductId;
"
19356,How to optimize/replace cursor in SQL?,"SELECT s.StudentId, COUNT(*) AS CreationCount 
FROM Student s
INNER JOIN CreationHist c
    ON c.StudentId = s.StudentId
WHERE c.CreateDate = '05/02/2011'
GROUP BY s.StudentId
"
5206,Help forming a SQL statement,"SELECT City.Name, COUNT(Attractions.City) as AttractionCount
FROM City
LEFT OUTER JOIN Attractions ON City.City = Attractions.City
GROUP BY City.Name
ORDER BY COUNT(Attractions.City) DESC
"
18431,Positive value to negative and negative to positive in oracle,"select a
,      -1 * a ""changed value""
from   test_tab;
"
11851,How to efficiently store schedular dates?,"IF (<weekday_list_to_run_the _scheduled_tasks> AND 1000000) == 1 THEN 
     //Monday is set. 
END IF
"
32356,Using Substring and INSTR in Oracle,"SELECT DISTINCT REPLACE(PRODUCT_ID, 'EMA') FROM SYSADM.TABLE
"
2845,MYSQL query between two unix timestamp,"SELECT *
FROM   my_table
WHERE  FROM_UNIXTIME (timestamp_column, '%k') BETWEEN 13 AND 17 AND
       FROM_UNIXTIME (timestamp_column, '%m') = 11 AND
       FROM_UNIXTIME (timestamp_column, '%Y') = 2014
"
34449,SQL query for matching a column across two tables,"select u.user
from user u
join userGroup ug on u.user = ug.user
where u.gender = 'Male'
  and ug.group = 'groupA'
"
38058,How to update another table with the most recent data in SQL?,"UPDATE Table1
SET 
    f2 = T2.f2, 
    f3 = convert(varchar, T2.f3, 101) 
FROM 
    Table1 T1
INNER JOIN 
    Server.DB.dbo.Table2 T2
ON 
    T1.f1 = T2.f1
WHERE 
    T2.f3 = (SELECT MAX(f3) FROM Server.DB.dbo.Table2 WHERE f1 = T1.f1)
"
22260,Select ID where Table Row Count = 1,"select person.id from person where ((select count(*) from person) = 1)
"
5406,Constraints instead Triggers (Specific question),"CREATE TABLE Employees 
(
  ID INT IDENTITY(1,1) NOT NULL PRIMARY KEY,
  FirstName VARCHAR(100) NOT NULL DEFAULT '',
  LastName VARCHAR(100) NOT NULL DEFAULT ''
);

CREATE TABLE SalariedEmployees
(
  ID INT NOT NULL PRIMARY KEY REFERENCES Employees(ID),
  Salary DECIMAL(12,2) NOT NULL
);

CREATE TABLE ContractEmployees
(
  ID INT NOT NULL PRIMARY KEY REFERENCES Employees(ID),
  HourlyRate DECIMAL(12,2) NOT NULL
);
"
32874,Linq2sql Find Top Subscribers Question,"var feeds = (
   from f in myContext.tblFeeds
   order by f.Subscribers.Count() descending
   select f
   ).Take(5);
"
23973,Optional Attributes in Stored Procedure WHERE Clauses," SELECT 
     Name, 
     SolutionValue
 FROM 
     MyTable
WHERE
     //Compact syntax simple for optional equals filter
     FIELD1  = ISNULL(@Input1,FIELD1) 
     //intention clearer and let's you do more than equals      
     AND ( @Input2 IS NULL OR FIELD2 > @Input2 ) 
     //can be extended for Between... 
     AND ((@Input3 IS NULL or  @Input4 IS NULL)   OR  FIELD3 BETWEEN  @Input3 AND @Input4 )
"
18397,how to select the second row if the first row in empty,"select s.name, u.*
from site s
outer apply (
                select top(1) * 
                    from user u 
                    where u.phone like '+01%' 
                    and u.id in (select userId FROM siteUser su WHERE su.SiteId = s.Id)
                    order by u.registrationDate
            ) as u
"
26520,What's an efficient way to find rows where the timestamp and identity are not in sequence?,"SELECT
  *
FROM (
        SELECT
          t1.*,
          RANK() OVER (ORDER BY trans_id) AS trans_id_rank,
          -- Ordering by trans_id after CRT_DTTM to cater for transactions within the same second
          RANK() OVER (ORDER BY CRT_DTTM, trans_id) AS CRT_DTTM_rank
        FROM V_TRANS t1) t
WHERE trans_id_rank <> CRT_DTTM_rank
"
37740,How to select top 5 after 100 rows,"SELECT * FROM tbl_post ORDER BY whatever OFFSET 20 ROWS FETCH NEXT 5 ROWS ONLY;
"
6424,Alternativ to multiple AND conditions in oracle,"SELECT loginid
  FROM customer
 WHERE code IN ('TEST1', ... , 'TEST20')
 GROUP BY loginid
HAVING COUNT(DISTINCT code) = 20;
"
21538,SQL- Adding a condition,"SELECT CHARTER.CUS_CODE,
       CHARTER.DESTINATION ""AIRPORT"",
       CHARTER.CHAR_DATE,
       CHARTER.CHAR_DISTANCE,
       CHARTER.AC_NUMBER
  FROM CHARTER
 WHERE DESTINATION = 'BNA';
"
28552,How to join records from multiple object tables to a master table with a single query?,"select o1.name, o2.height, o3.weight
from object_master_list o1 left join obj_type_one o2 on o1.id = o2.id 
                           left join obj_type_two o3 on o1.id = o3.id
where o1.condition = 'true'
"
25696,Querying all data from a table joining ONLY the latest record from a junction table,"Select * from 
employees e
join emp_dept ed on e.emp_no = ed.emp_no 
                    and from_date = (Select Max(from_date) 
                       from emp_dept ed2 where ed2.emp_no = e.emp_no)
"
29800,SQL Query to get 1 output from 2 different columns within same table,"(SELECT DISTINCT CAT1 FROM Fruits)
UNION
(SELECT DISTINCT CAT2 FROM Fruits)
"
23314,Selection of Primary Key for distributed databases,"seq ... AUTO_INCREMENT,
machine TINYINT UNSIGNED NOT NULL,
PRIMARY KEY(machine, seq),
INDEX(seq)
"
1152,MS Access query sum up the values when certain columns match," SELECT [Shoot Day], Sum([Total])
 FROM Table
 GROUP BY [Shoot Day]
"
2175,Left Outer Join in sql query,"SELECT e.Lname, e.ssn
FROM Employee e   
JOIN works_on w
  ON e.ssn = w.essn
JOIN Project p
  ON w.pno = p.pnumber
GROUP BY e.ssn
HAVING 
     SUM(CASE WHEN p.plocation = 'Cleveland' THEN 1 ELSE 0 END) = 0
AND  COUNT(*) >= 3
"
27365,Find out which raw material made a manufactured product,"select i.item, m.material, m.begin_time
from items i join
     materials m
     on m.begin_time  between i.begin_time and i.end_time
union all
select item, material, begin_time
from (select i.item, m.material, m.begin_time,
             row_number() over (partition by i.item order by m.begin_time desc) as seqnum
      from items i join
           materials m
           on m.begin_time < i.begin_time 
     ) im
where seqnum <= 2;
"
14915,SQL server string manipulation in a view... Or in XSLT,"select
  date = case date_attribute
            when charindex('DSP',date_attribute) > 0 then substring(date_attribute,beg,end)
            when charindex('DISCH',date_attribute) > 0 then substring(date_attribute,beg,end)
            else 'unknown'
        end 
 from myTable
"
31906,Incorrect Sql query for date,"""[Date] >= #"" & Format(date, ""mm/dd/yyyy"") & ""#;""
"
31400,Theory of storing a number and text in same SQL field,"CREATE TABLE ValueCodes
(
    Value     INTEGER NOT NULL PRIMARY KEY,
    Meaning   VARCHAR(32) NOT NULL UNIQUE
);

CREATE TABLE Results
(
   TestID     ...,
   TestCode   ...,
   Value      INTEGER NOT NULL FOREIGN KEY REFERENCES ValueCodes
);
"
23223,py2neo update node in graph,"user[""name""] = ""Bob""
user[""age""] = 77
"
36731,"SQL join 2 tables, query 1st with condition from 2nd","SELECT D.CatID ,D.CatName ,D.SiteID
FROM Downtimes D INNER JOIN DowntimesCategories DC
    ON D.CatID = DC.CatID
WHERE DC.SiteID = put your id here
"
9921,"How to order by custom rule, e.g. how to order like 4,2,1,3","SELECT * FROM foo ORDER BY FIELD(season_id, 4, 2, 1, 3);
"
31092,SQL Datetime not working with between,"  set @start =convert(datetime,'10/13/2014')
  set @end =convert(datetime,'10/13/2014')
"
25703,Determine MAX Decimal Scale Used on a Column,"-- Find the first non-zero character in the reversed string...
-- And then subtract from the scale of the decimal + 1.
SELECT 9 - PATINDEX('%[1-9]%', REVERSE(Col1))
"
13176,Select last 12 rows oracle,"select * from 
    ( select estatisticas, rownum rn
        (SELECT *
        FROM series 
        ORDER BY odata DESC) estatisticas 
        WHERE ponteiro = 50 AND lotus = 30
    order by odata asc) where rownum <=12
"
38695,SQL Join two tables,"select a.Date, t.Value1
from AllDates a
left outer join table1 t on a.Date = t.Date and t.UserID = 1
where year(a.Date) = 2012 and month(a.Date) = 9    
order by a.Date
"
3625,Oracle cursor removes leading zero,"SQL>
SQL> WITH aa AS (
  2  select 1.3232 NUM from dual UNION ALL
  3  select 1.3232 NUM from dual UNION ALL
  4  select 332.323 NUM from dual UNION ALL
  5  select 0.3232 NUM from dual
  6  )
  7  select  NUM, to_char(NUM, 'FM999990D9999999') FORMATTED from aa
  8  /

       NUM FORMATTED
---------- ---------------
    1.3232 1.3232
    1.3232 1.3232
   332.323 332.323
     .3232 0.3232

SQL>
"
3291,Query performance on two databases on one server,"Live - Cardinality Estimate Expression=""CONVERT_IMPLICIT(nchar(18),[pn].[PartNumber],0)""

Test - Cardinality Estimate Expression=""CONVERT_IMPLICIT(nvarchar(50),[pn].[PartNumber],0)""
"
20628,SQL Server : format 700 as time,"select stuff(right('0' + replace([StartTime], ':', ''), 4), 3, 0, ':'),
       stuff(right('0' + replace([EndTime], ':', ''), 4), 3, 0, ':')
from [tblRota]
"
1727,Keep on sort order when using IN statement in WHERE clause,"SELECT Table_B.* 
FROM Table_B JOIN Table_A ON  Table_B.ID = Table_A.ID
ORDER BY Table_A.RowNumber
"
5825,SQL Query - Not in a set of already in-use items,"SELECT a.*
FROM jobs a
LEFT JOIN
(
    SELECT a.job_id
    FROM assigned a
    INNER JOIN
    (
        SELECT MAX(id) AS maxid
        FROM assigned
        GROUP BY user_id
    ) b ON a.id = b.maxid
) b ON a.id = b.job_id
WHERE b.job_id IS NULL
"
15534,Fetching one to many relationship from same table,"SELECT customer_id,
   LISTAGG(subscription_name, '; ') WITHIN GROUP (ORDER BY subscription_name) AS subscription_name
FROM subscription
GROUP BY customer_id
ORDER BY customer_id;
"
29574,does SQL Server handle or lock Transactions between two or more tables,"CREATE PROCEDURE PickTask  

    begin transaction
         select top (1) * from Tasks
         delete top (1) from Tasks
    commit 
"
30966,.NET SqlCommand - finding Parameters in inline querys (Regex?),"   Regex r = new Regex(@""(?<Parameter>@\w*)"", RegexOptions.Compiled);

   foreach (Match m in r.Matches(sqlStatement))
   {
      if(m.Success)
      {
         string parameterName = m.Value;
      }
   }
"
12022,DELETE ... OUTPUT COUNT(DELETED.*),"DELETE 
FROM datacache 
WHERE userId=@id

SELECT @@ROWCOUNT
"
11974,SQL server calculate and insert with loops,"UPDATE myTable
SET MaxWs2m = MaxWs * 0.75, AvgWs2m = AvgWs * 0.75
"
568,How to group count and join in sequel?,"DB[:a].
  left_outer_join(DB[:b].group_and_count(:a_id).as(:b), :a_id=>:id).
  order(:cnt).
  select_all(:a).
  select_more{IFNULL(:b__cnt, 0).as(:cnt)}
"
8523,SQL Query Optimisation: Comparing Adjacent Rows,"Select t1.*
From table t1
inner join table t2
on t1.key = t2.key - 1
where t1.Foo = 1
and t2.Bar = 0
"
7793,Fast selection of a block of following records,"select t.*
from t
where id >= SOMEID
order by id
limit <n>;
"
4334,SQL insert if missing value,"SELECT
P.itemId
,C.colorId
,I.iteration
,0 AS rating
FROM
(SELECT DISTINCT itemId FROM Process) P
CROSS JOIN
(SELECT DISTINCT colorId FROM Color) C
CROSS JOIN
(SELECT DISTINCT iteration FROM Process) I
LEFT JOIN
Process E
ON P.itemId = E.itemId
AND C.colorId = E.colorId
AND I.iteration = E.iteration

WHERE E.rating IS NULL
"
25591,How to find the nearest date?,"select top 1 *
from CdCl
order by abs(datediff(ms, ReadTime, <yourdatetime>))
"
22657,MySQL keyword search query to match items with ALL keywords?,"select Items.id, Items.Title
from Items
   inner join ItemsWords   
   on Items.ID = ItemsWords.ItemID
where ItemsWords.Word in ('WORD_TO_FIND','ANOTHER_WORD_TO_FIND') 
group by Items.id, Items.Title
having count(distinct ItemsWords.id) =2
"
39994,Django queryset: Filter by reverse key and order by,"last_statuses=Status.objects.filter(
    id__in=Status.objects.order_by('procedure_id', '-pk').distinct('procedure_id')
).filter(status=1)

procedures = Procedure.objects.filter(id__in=last_statuses.values('procedure_id'))
"
2679,SQL join on two columns with different format,"Select table1.* 
from TABLE1 join table2 
on replace(TABLE1.ID,'-','') = TABLE2.ID
"
37488,Apply where condition when I have multiple rows for each id (Single table or Join multiple ones),"select b.pid
from basic b
group by p.pid
having sum(case when (b.sid = 2) and (b.st >= 7) then 1 else 0 end) > 0 and
       sum(case when (b.wid = 9) and (b.wt >= 6) then 1 else 0 end) > 0;
"
31330,How to select non-distinct rows with a distinct on multiple columns,"select COLUMN1,COLUMN2,COLUMN3 
from TABLE_NAME 
group by COLUMN1,COLUMN2,COLUMN3 
having COUNT(*) > 1
"
36568,I got stuck a SQL Join and Count,"select rp.NameEN, rd.NameDefault,
       (select COUNT(NameEN)
        from [OTOP].[Custom].[tblRefProvince]
       ) as district
from [OTOP].[Custom].[tblRefProvince] rp inner join
     [OTOP].[Custom].[tblRefDistrict] rd
     on rp.ID = rd.ProvinceID;
"
15713,Getting cumulative count,"  SELECT COUNT(*) AS numCount,
         t.column2             
    FROM YOUR_TABLE t
GROUP BY t.column2
ORDER BY numCount DESC
"
4526,Postgres SQL to select the previous valid date,"Select s.Branch, s.Date, s.containers,
       lag(s.Date) over (partition by branch order by date) as prev_Date,
       lag(s.containers) over (partition by branch order by date) as prev_Containers
from shipping s;
"
23469,SQL to join tables only where ALL specified criteria are true,"SELECT cars.id
  FROM cars
  JOIN car_properties AS cp1
    ON cp1.car_id = cars.id
   AND cp1.property_id = 1
  JOIN car_properties AS cp2
    ON cp2.car_id = cars.id
   AND cp2.property_id = 2
;
"
28303,Confused how this query works,"SET @EmpID = (SELECT MIN(EmpID) FROM dbo.Emp WHERE MgrID = @Root AND EmpID > @EmpID)
"
10104,Concatenate characters according to a some number,"declare @chr varchar(1) = '.'
declare @len int = 3

UPDATE Table1 
SET column1 = column1 + replicate(@chr, LEN(column1))
WHERE LEN(column1) = @len -- where clause is optional
"
31426,SQL Int to Date then 1 year ahead?,"DATEADD(yyyy,1,convert(date,RIGHT(RTRIM([x].[Work_Month]),2) + '/01/' + LEFT([x].[Work_Month],4) ))
"
214,select all rows that have more than two matching composite keys in a table,"SELECT t1.pk1
FROM t1
WHERE pk2 IN (1, 2)
GROUP by t1.pk1
HAVING COUNT(*) = 2;
"
26989,How to detect the end of a user's session on website to delete session token,"<script>
function heartBeat() {
    setTimeout(function(){ 
      $.get(""heartBeat?id=""+mySessionId, function( data ) {
         // you may want to add sanity checks here, e.g. what with invalid session ids?
         heartBeat();   // next call to heartBeat after OK response
      }
    }, 10000);
}
heartBeat();  // first call to heartBeat
</script>
"
7997,Sybase Table Update Disable,"-- Because it's friday ...
REVOKE UPDATE ON hair TO pubic;
"
14197,Counting a number of purchases with the same data values in oracle,"SELECT COUNT(PurchaseNo)
FROM PURCHASE
GROUP BY ServiceType, PaymentType, GST
HAVING COUNT(PurchaseNo) >= 1000
"
15710,Get highest value for each group of names,"select  *
from    (
        select  row_number() over (
                    partition by substr(job_name,0,2) 
                    order by RunTime desc) as rn
        ,       Job_name
        ,       RunTime
        from    YourTable
        ) SubQueryAlias
where   rn = 1
"
33516,SQL - Find date closest to current date,"select  *
from    Table1
order by
        abs(now() - date) desc
limit   1
"
30871,Month sorting in sql,"SELECT * 
FROM TABLE_NAME
ORDER BY RIGHT([Month], 4) DESC , SUBSTRING([Month], 5, 2) DESC
"
13380,SQL Update command with various variables,"UPDATE Items
SET Name    = ISNULL(@NewName,Name),
    [Date]  = ISNULL(@NewDate,[Date]),
    Value   = ISNULL(@NewValue,Value)
WHERE ID = @ID
"
1414,Generating id in my table based on sub groups,"with tab as (SELECT NVL(MAX(newtable.ID), 0)+1 AS MAX_VAL FROM newtable)
    SELECT ((select max_val from tab) + 
           dense_rank() over (order by main.ID)) ID
          ,main.ID as ID_PLACE
          , main.place
          , sub.somedata 
        FROM main 
        LEFT JOIN sub on main.ID = sub.ID
"
39537,vfp query much faster in command window than compiled,"SELECT *;
    FROM cgift;
    LEFT JOIN;
         (select donor donor2, count(distinct solgroup) activesols from cGift group by donor);
    b ON cgift.donor = b.donor2 INTO CURSOR cgift
"
29549,Logic with MYSQL query multiple tables,"SELECT a.apiname, a.description, a.endpoint
FROM apis a
INNER JOIN subscriptions b ON b.api_id = a.apiname
WHERE b.user_id = '1234'
"
29787,Conditional Operator in SQL Where Clause,"SELECT  Team.teamID 
FROM    Team
WHERE   (@teamid = 0 AND Team.teamID > 0)
        OR (@teamid <> 0 AND Team.teamID = @teamid)
"
7633,Updating self joined table,"UPDATE t255
SET parent_id=p255.id
FROM t_category t255
INNER JOIN t_category t233 ON t255.Name=t233.Name AND t233.shop_id=233
INNER JOIN t_category p233 ON p233.id=t233.parent_id
INNER JOIN t_category p255 ON p255.Name=p233.Name
WHERE t255.shop_id=255
"
29998,Postgres Copy from file- changing the value of one column,"`COPY ... FROM PROGRAM 'awk -F ; ''{ printf ""%s,%s,%s,%s\n"",$1,""AAA"",$3,$4,$5; }'''`
"
30659,mysql substring get only characters,"select documentnumber
from transactionheader
where  documentnumber  LIKE 'RCV%'
"
26578,sql fetching data in minutes not getting proper result,"SELECT  t.TBarcode ,
        t.PlateNo
FROM    transaction_tbl t
WHERE   [status] = 4
       OR ([status] = 5 AND DATEDIFF(n, CAST(DelDate AS DATETIME), GETDATE()) <= 3)
"
9907,Using user defined function (UDF) in where clause more than once with running the function only once,"SELECT id, task_name, last_run, func.next_run
FROM tasks
Cross Apply (Select dbo.task_next_run(task_type, @task_schedule_day_of_week, @task_schedule_time, @task_period, @last_run) as next_run) as func
WHERE 
func.next_run < getdate() and
func.next_run > last_run
"
6641,What is the most efficient way to do check if a value exist then Update or Insert in Sql,"INSERT ... ON DUPLICATE KEY UPDATE
"
35310,SQL: get a substring by removing character off the right and left,"select substr(<val>, 2, length(<val>) - 2)
"
20983,how to avoid identical expressions in sql SELECT and WHERE?,"select *
from (
   select MATCH(test) AGAINST(""str"" IN BOOLEAN MODE) AS testRelevance,
          ....
   from ...
   where ... 
) as t
where testRelevance > 0
"
27314,Remove decimal points from numbers to use in a JOIN,"select a.cola, b.colb 
from tablea a inner join tableb b 
on replace(b.commonfield,'.','')=replace(a.commonfield,'.','')
"
9537,Joining Statements IN MVC 4,"var ts = db.Query(@""SELECT DISTINCT Types.Id, Types.Name FROM Types LEFT OUTER JOIN Cards ON Types.Id = Cards.Type WHERE Manufacturer=@0 ORDER BY Types.Name"", ManId).ToList();
"
38231,SQL Syntax to count number of digits in the whole number portion of a Decimal value,"SELECT distinct 
case when charindex('.',value) > 0 then len(substring(value, 1, charindex('.',value)-1))
else len(value) end as lngth
from Numbers
"
4244,Performing a multi-table inner/left/right join (or correlated subquery) with count?,"select count(vote.id)
from owner
left join item on (item.owner_id = owner.id)
left join vote on (vote.item_id = item.id)
where owner.id = :id
"
25294,SQL - how to get first and last occurence based on conditions,"SELECT article, 
       min(case when status = 3 and queue = INLOA then regdate end) as FirstLOA,
       min(case when status = 2 and queue = LO2ST then regdate end) as LAST
FROM A
GROUP BY A;
"
20791,Four Tables show single occurrence for outer most table,"SELECT DISTINCT ON(companies.name, employees.first_name) 
   applicants.id, companies.name, employees.first_name, departments.name, applied_date
FROM applicants
INNER JOIN departments ON applicants.department_id = departments.id
INNER JOIN companies ON departments.university_id = companies.id
INNER JOIN employees ON applicants.student_id = employees.id
ORDER BY companies.name, employees.first_name, applied_date
"
25817,Access: How to Find the Total of entries in a Query,"select FirstName, LastName, sum([Sum of Payment Types]) as [Total Pay]
from YourTable
group by FirstName, LastName ;
"
17484,concatenating local variable to parameter,"declare @arg varchar(8000) = 'Dear customer, Your complaint has been registered and your complaint no. is' + cast(@ComplaintID as varchar(255);

exec DeansSMSDB.dbo.ADD_SMS_InQueue @CellNo, @arg;
"
31877,How can I specify the order of results within groups when querying Derby?,"Select o.date_created, o.buyer_name,
       (select max(date_created) from orders where buyer_name = o.buyer_name) as most_recent_date
From ORDERS o
Order By most_recent_date, o.buyer_name, o.date_created Desc
"
13962,Show a row for every result between 3 mySQL tables,"SELECT m.field1, v.vegName, f.fruitName
FROM test_main m
INNER JOIN dummy d 
  ON d.id < 3
LEFT JOIN test_veg v 
  ON v.mainID = m.mainID 
  and d.id = 1
LEFT JOIN test_fruit f 
  ON f.mainID = m.mainID 
  and d.id = 2
WHERE m.mainid=1
"
1695,SQL Get data in this year,"DECLARE @datetime DATETIME = 'Jan 5 2014 6:26 PM' 
SELECT 
* 
FROM datetimes2
WHERE [Date] >= CONVERT(DATETIME, CAST(DATEPART(YEAR, @datetime) AS VARCHAR) + '-01-01')
  AND [Date] <= CONVERT(DATETIME, CAST(DATEPART(YEAR, @datetime) AS VARCHAR) + '-12-31')
"
39070,Select COUNT() from multiple databases in SQL,"DECLARE @movieId int
DECLARE @state varchar(2)

SET @movieId = 12345
SET @state = 'NY'

SELECT
	COUNT(DISTINCT C.CustomerID) as numCustomers
FROM
	CUSTOMER C
INNER JOIN
	RENTS R
ON
	C.CustomerID = R.CustomerId
WHERE
	C.ST = @state
AND
	R.mid = @movieId
"
24452,How to delete duplicate data with a condition,"delete from tbl_test t 
  where t.sta in ('F', 'R') and exists ( 
      select 1 from tbl_test b 
        where b.ser_no = t.ser_no 
          and (sta='L' or (sta<>'L' and b.id<t.id)) )
"
22918,SQL Server : get part of string between 'ServicePassword=' and '&' in a url string,"SELECT
    substring(
        Parameters, 
        charindex('ServicePW=', Parameters) + 10, -- len('ServicePW=')
        charindex('&', substring(Parameters, charindex('ServicePW=', Parameters), len(Parameters))) - 11 -- (- len('ServicePW=') - 1)
    )
FROM
    Table 
WHERE 
    TestID = 8
"
0,Making unique slug url in Oracle,"select regexp_substr('lorem-ipsum-dolor-2','\d+$') from dual;
"
31307,get percentage along with group by statement,"SELECT     title, COUNT(title) AS cnt, COUNT(title) / total_count AS percentage
FROM       users_titles
JOIN       users ON users_titles.uid = users.uid
CROSS JOIN (SELECT COUNT(*) AS total_count 
            FROM   users) t 
WHERE      users.useractivated = 1
GROUP BY   title
"
27319,Spring templates: how to execute multiple SQL statements?,"transactionTemplate.execute(new TransactionCallbackWithoutResult() {

  protected void doInTransactionWithoutResult(TransactionStatus status) {

      jdbcTemplate.update(""INSERT INTO PERSON (FIRSTNAME, LASTNAME) VALUES(?,?)"",
         new Object[] { firstName, lastName });

     ... multiple calls to JDBC template, all inside the same transaction ....
  }
});
"
28018,Find Identity when using Merge,"output 'dTable', @versionDate, action, inserted.bid, inserted.AID, @userid
into @version
"
5816,SQL Two columns of guids no duplicates,"SELECT *
FROM (
        SELECT [Inspection Guid], 
               [SensorData Guid], 
               [DateTime],
               ROW_NUMBER() OVER (PARTITION BY [Inspection Guid] 
                                  ORDER BY [DateTime] DESC) rn
        FROM YourTable
      ) T
WHERE rn = 1
ORDER BY [DateTime] DESC
"
3207,Use MySQL to Find Duplicates and Display on One Line,"SELECT personName, GROUP_CONCAT(fruitName) fruitList
FROM tableName
GROUP BY personName
"
10043,SQL Query Sets Within Sets Query with Exact Matching,"SELECT Product_Id
FROM table 
GROUP BY Product_Id
HAVING COUNT(DISTINCT CASE WHEN Attribute_Id IN (9, 5) THEN Attribute_Id END) = 2 AND
       COUNT(CASE WHEN Attribute_Id NOT IN (9, 5) THEN 1 END) = 0
"
6258,Complexity of retrieval of newest datetime entry in sql?,"select `dates`
from some_table
order by `dates` desc 
limit 1;
"
8976,How to JOIN four tables,"SELECT orders.ID, orders.Quantity, items.Desc, stores.store_name, projects.Project_no 
FROM orders
join items on items.item_id=orders.item_id
join stores on stores.store_id=orders.store_id
join projects on projects.project_id=orders.project_id
"
33177,Search for groups of first words,"select min(fazerbem_dates)
from table t
group by substr(fazerbem_dates, 1, 10);
"
7994,"SQL query, where = value of another table","select column1 from table1 
   inner join table2 on table1.column = table2.column
   where table2.columne=0
"
7260,Using the JOIN function,"SELECT number, COUNT(number)
FROM in_clicks
GROUP BY number
ORDER BY COUNT(number) DESC
"
25215,Oracle SQL - Is it possible to join two tables only when a certain condition is true?,"ALTERE TABLE emp_test MODIFY ename VARCHAR2(3000);

Update emp_test set ename = rpad(ename, 3000, ' '); Commit;

SELECT deptno
     , LISTAGG(TRIM(SUBSTR(ename, 1, 3000)), ',') WITHIN GROUP (ORDER BY ename) AS employees
    , count(*) total_emps
  FROM emp_test
GROUP BY deptno
/

SELECT deptno
     , WM_CONCAT(TRIM(SUBSTR(ename, 1, 3000))) AS employees
     , count(*) total_emps
 FROM emp_test
GROUP BY deptno
/
"
32859,T-SQL - Query that operates on multiple tables that have the same column name,"DECLARE @date AS DATETIME
SET @date = '2014-01-01'
SELECT 'SELECT ''' + OBJECT_NAME(object_id) + ''' AS [Table], COUNT(*) AS [Count] FROM [' + OBJECT_NAME(object_id) + '] WHERE [created] <= ''' + CONVERT(VARCHAR, @date, 20) + '''' FROM sys.columns WHERE name = 'created'
"
23991,mysql counts in a group by,"SELECT  user_id,
        SUM(user_points) as sum_points,
        COUNT(*) AS num_votes
FROM    voting_results
WHERE   voting_date > ('2009-09-18' - INTERVAL 1 WEEK)
GROUP BY
        user_id 
ORDER BY
        sum_points DESC
"
33504,Previous Month based on SYSDATE,"WHERE tr_date >= trunc( add_months( sysdate, -1 ), 'MM' )
  AND tr_date <  trunc( sysdate, 'MM' )
"
14091,How to using INNER JOIN if one table is empty or no data,"SELECT room.id_room
     , room.name_room
     , room.available_room - SUM(COALESCE(reservation.reserved_qty, 0)) AS remaining_rooms
    FROM room
        LEFT OUTER JOIN reservation
            ON room.id_room = reservation.id_room
    WHERE
        checkin_date IS NULL OR
        @day BETWEEN checkin_date AND checkout_date
    GROUP BY room.id_room, room.name_room;
"
10657,Altering column on two tables simultaneously,"UPDATE playerRegSeason s
INNER JOIN players p ON s.playerID = p.playerID
SET s.NewPlayerID =  p.NewPlayerID
"
17011,SQL counting and grouping unique values,"SELECT make, score, count(1)
FROM {your_table}
GROUP BY make,score
"
38108,How to select and sum() most recent item in a history table for each time period?,"select item_month, count(*), sum(amount)
from (
   select opportunity_id, 
          item_date,
          amount,
          to_char(item_date, 'yyyy-mm') as item_month,
          row_number() over (partition by opportunity_id, to_char(item_date, 'yyyy-mm') order by item_date desc) as rn
   from opportunity_history
) t
where rn = 1
group by item_month
order by 1;
"
29476,SQL SELECT and GROUP,"SELECT p.postid, GROUP_CONCAT(t.tags)
FROM posts p
INNER JOIN tags t ON t.did = p.did
INNER JOIN users u ON u.username = p.username
GROUP by t.did
"
39793,convert decimal to HH.MM format in SQl Server,"select floor(06.85) + cast(((06.85 - floor(06.85))*100) as int) / 60 + cast((cast((06.85 - floor(06.85)) * 100 as int) % 60) as float) / 100

 select floor(06.60) + cast(((06.60 - floor(06.60))*100) as int) / 60 + cast((cast((06.60 - floor(06.60)) * 100 as int) % 60) as float) / 100
"
25750,Creating a foreign key with SQLAlchemy,"class Account(db.Model):
    __tablename__ = 'accounts'
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(100), nullable=False)
    questions = relationship(""Question"", backref=""accounts"")

class Question(Base):
    __tablename__ = 'questions'
    id = db.Column(db.Integer, primary_key=True)
    account_id = db.Column(db.Integer, db.ForeignKey('accounts.id'))
    body = db.Column(db.String(500), nullable=False)
"
28513,How can I combine multiple rows into a comma-delimited list in SQL Server 2005?,"DECLARE @XYList varchar(MAX)
SET @XYList = ''

SELECT @XYList = @XYList + CONVERT(varchar, X) + ',' + CONVERT(varchar, Y) + ','
FROM POINTS

-- Remove last comma
SELECT LEFT(@XYList, LEN(@XYList) - 1)
"
29213,"Mutual Friend column, select a pair only once","SELECT ID1,
       ID2
FROM   likes L1
WHERE  ID1 > ID2
       AND EXISTS(SELECT *
                  FROM   likes L2
                  WHERE  L1.ID1 = L2.ID2
                         AND L1.ID2 = L2.ID1)  
"
754,How do I display all records in a subform EXCEPT the one being displayed in the main form in Access 2010 without VBA?,"'get all persons in a given relationship
SELECT p.Person_ID, First, Last 
FROM Person p INNER JOIN Relationship r ON p.Person_ID = r.Person_ID 

'define given relationship
WHERE Relationship_ID = (
  SELECT Relationship_ID FROM Relationship 
  WHERE Person_ID = Forms(nameOfYourMainForm)!nameOfTextboxInMainFormContainingPersonID)

'and the person isnt the person displayed on the main form:
AND p.Person_ID <> Forms(nameOfYourMainForm)!nameOfTextboxInMainFormContainingPersonID;
"
33891,SQL set floating point precision,"ROUND(AVG(CAST(e.employee_level as float)), 3)
"
7769,MySQL: Update a columns if certain value,"update tableName set columnA = 2
where columnA = 1
"
26887,COUNT over multiple columns,"SELECT V, COUNT(*) C
FROM (
    SELECT one V FROM your_table
    UNION ALL
    SELECT two FROM your_table
    UNION ALL
    SELECT three FROM your_table
    UNION ALL
    SELECT four FROM your_table
    UNION ALL
    SELECT five FROM your_table
    UNION ALL
    SELECT six FROM your_table
) Q
GROUP BY V
ORDER BY C DESC;
"
34149,SQL Select decimal not 0,"SELECT * 
FROM Table1 
WHERE Decimalvalue <> '0';
"
37159,How can I get the most recent date that doesn't have a NULL?,"WHERE   [O].[StageName] = 'In Progress'

AND NOT EXISTS (
    SELECT *
    FROM [saasdisp__Work_Order__c] AS [WO2] 
    WHERE [WO2].[saasdisp__Dispatch_Date__c] IS NULL
          AND [O].[Name] = [WO2].[OppName__c]
          AND [O].[Id] = [WO2].[Opportunity__c]
)


GROUP BY    [O].[Name],
            [O].[Office_Location__c]
"
31575,VB.net How to Update 2 column in a single sql code,"sql = ""update room set status = '"" & status & ""' , confirmstudentid = "" & 
       Form1.stuID & "" where id= "" & lblroomID.Text & "";""
"
35363,Complex summing in SQL,"SELECT SUM(subsum) / 15 FROM (
   SELECT SUM(column1) AS subsum
      FROM table
     UNION ALL
    SELECT SUM(column2) AS subsum
      FROM table
     UNION ALL
    ...
    SELECT SUM(column10) AS subsum
      FROM table
)
"
16637,Selecting/casting output as integer in SQL,"SELECT 
  CAST(sum(number)/count(number) as UNSIGNED) as average, 
  date 
FROM stats 
WHERE * 
GROUP BY date
"
14198,"Compare UTC NOW to a date field, T-SQL","select case when (cast('2014-06-14 T11:01:50.000' as datetimeoffset) > getutcdate()) then '1' else '0'end
select case when (cast('2014-06-14' as datetime) > getutcdate()) then '1' else '0'end
"
33429,SQL multiple join statement issues,"SELECT 
    CSLL.CommsLog.ID, 
    CSLL.CommsLog.CommType, 
    CSLL.CommsLog.Date, 
    UserTo.FirstName +' ' + UserTo.LastName, 
    UserFrom.FirstName +' ' + UserFrom.LastName, 
    CSLL.CommsLog.Version 
FROM CSLL.CommsLog
INNER JOIN CSLL.Users UserTo ON CSLL.CommsLog.SentTo=UserTo.Alias
INNER JOIN CSLL.Users UserFrom ON CSLL.CommsLog.SentFrom=UserFrom.Alias
"
17881,SQL date number,"Select username,
       select min(date) over (partition by username) as firstDate,
       date,
       row_number() over (partition by username order by date) as date_sequence
from data as outer;
"
37763,Add/remove columns of a table - code maintenance / optimisation,"INSERT dbo.table VALUES(@p1, @p2, ...);
"
37988,select values from table and create oracle objects,"SQL> INSERT INTO resultrow_obj
  2  VALUES((SELECT Test_obj('A', 'B', 'C') 
  3            FROM dual WHERE rownum <= 1), 
  4         1, 123);

1 row inserted
"
6525,Find average amount of times a value appears in table,"select count(id) / count(distinct id) as avgEntriesPerUser
from table t;
"
39014,Select latest values for group of related records,"select distinct on (relation_id, code) t.*
from t
order by relation_id, code, date desc;
"
23676,getting filename count from multiple tables group by that file name,"SELECT filename, 
       SUM(CASE WHEN t = 28 THEN 1 ELSE 0 END) t28count,
       SUM(CASE WHEN t = 29 THEN 1 ELSE 0 END) t29count,
       SUM(CASE WHEN t = 30 THEN 1 ELSE 0 END) t30count
  FROM
(
  SELECT 28 AS t, filename
    FROM t28
   UNION ALL
  SELECT 29 AS t, filename
    FROM t29
   UNION ALL
  SELECT 30 AS t, filename
    FROM t30
) q
 GROUP BY filename
 ORDER BY filename
"
12752,Multiple Polymorphic Model in Rails,"class Comment < ActiveRecord::Base
  belongs_to :commentable, :polymorphic => true
  belongs_to :authorable, :polymorphic => true
end

class User < ActiveRecord::Base
  has_many :comments, :as => :authorable
end

class Employee < ActiveRecord::Base
  has_many :comments, :as => :authorable
end
"
19724,SQL result query in another query,"SELECT name.name, name.number FROM name
    JOIN relationship AS r ON name .id = r.id_name 
    JOIN street ON street.id = r.id_street
    WHERE street.street = ""yourStreet"" AND street.zip=""1111"";
"
3950,ordering by total number of rows,"SELECT director_id, COUNT(*) as TotalMovies FROM movies
  GROUP BY director_id
  ORDER BY COUNT(*) DESC
"
16127,DB2 how to sum two column from two different table,"select sum(total) from
(
    select sum(amt) as total from tableA where id>10
    union all
    select sum(amount) from tableB where people = 'JOSH'
) as q
"
28184,Add date without exceeding a month,"SQL> select add_months(date '2008-01-31',1) from dual;

ADD_MONTHS(
-----------
29-FEB-2008

SQL> select add_months(date '2008-02-29',1) from dual;

ADD_MONTHS(
-----------
31-MAR-2008
"
31621,oracle sql developer: identify fields in table that have changed over time,"select t.*
from (select t.*,
             lag(rep_cat) over (partition by name order by year) as prev_rep_cat
      from t
     ) t
where rep_cat <> pre_rep_cat
"
24890,SELECT count(*) IN SELECT,"SELECT t1.idTab1,
       (SELECT count(*) 
          FROM table2 t2 
         WHERE t2.idTab1 = t1.idTab1) as Tab2CountIdTab1
  FROM table1 t1
 WHERE t1.idTab1 <= 3;
"
17114,SQL QUERY Result arrangement issue,"select name, description
from wp_widget_custom
where name in ('hemel-hempstead','maidenhead','guildford','bromley','east-london','hertfordshire','billericay','surrey')
order by field(name, 'hemel-hempstead','maidenhead','guildford','bromley','east-london','hertfordshire','billericay','surrey')
"
32738,MySQL Group by and Order,"SELECT console_msgs.*
FROM   console_msgs NATURAL JOIN (
         SELECT   MAX(time) AS time
         FROM     console_msgs
         WHERE    `to` = $user[id]
         GROUP BY `from`
       ) t
WHERE  `to` = $user[id]
"
9835,SELECT categories from a mapping table,"SELECT  a.username,
        GROUP_CONCAT(c.category)
FROM    users a
        INNER JOIN users_categories b
            On a.Id = b.userID
        INNER JOIN categories c
            ON b.categoryID = c.ID
GROUP BY a.ID
"
8904,"SQL Select; Concatenating strings, avoiding double commas where columns are null?","SELECT
SUPPNAME AS ""Supplier Name"",
(
CASE WHEN STREET IS NULL THEN '' ELSE STREET || ', ' END || 
CASE WHEN TOWN IS NULL THEN '' ELSE TOWN || ', ' END ||
CASE WHEN COUNTY IS NULL THEN '' ELSE COUNTY || ', ' END || 
CASE WHEN POSTCODE IS NULL THEN '' ELSE POSTCODE END
) AS ""Supplier Address""
FROM SUPPLIERS
"
30357,How can I count just the active rows and not the soft deletes,"SELECT inv.Id AS Id, COUNT(s.Id) AS Total, MIN(i.Name) AS Asset
FROM SerialAssets AS s
RIGHT JOIN Inventories AS inv ON s.InventoryId = inv.Id
         AND s.Active = 1
INNER JOIN Items AS i ON inv.ItemId = i.Id
WHERE i.Serialised = 1
GROUP BY inv.Id
"
33699,Optimizing basic SELECT query with multiple NOT IN values,"SELECT id 
FROM table T1 
LEFT JOIN tblFilter T2
       ON T2.col0 = T2.col0
WHERE T2.col0 IS NULL
"
28503,SQL 2005 - Query to Find Tables with Most Rows,"SELECT 
    [TableName] = so.name, 
    [RowCount] = MAX(si.rows) 
FROM 
    sysobjects so, 
    sysindexes si 
WHERE 
    so.xtype = 'U' 
    AND 
    si.id = OBJECT_ID(so.name) 
GROUP BY 
    so.name 
ORDER BY 
    2 DESC
"
17010,"SQL aggregate function to return single value if there is only one, otherwise null","SELECT  ID, 
        CASE WHEN COUNT(DISTINCT VAL) = 1 AND COUNT(ID) = COUNT(VAL)
             THEN MAX(VAL)
             ELSE NULL
        END ONLY_VAL
FROM    EXAMPLE
GROUP   BY ID
ORDER   BY ID
"
30584,Selecting array of options as part of select statement,"SELECT O.name, GROUP_CONCAT(SO.name) subOptionName
FROM Options O 
LEFT JOIN SubOptions SO ON O.id = SO.option_id 
GROUP BY O.name;
"
24403,SQL Query for information *not* in database,"SELECT emailaddress FROM temp_table WHERE emailaddress NOT IN (SELECT emailaddress FROM table)
"
1995,Extracting functions arguments using RegExp (PREG),"/(?:""(?:[^\x5C""]+|\x5C(?:\x5C\x5C)*[\x5C""])*""|'(?:[^\x5C']+|\x5C(?:\x5C\x5C)*[\x5C'])*'|[^""',]+)+/g
"
16176,Trouble with Joining Tables and Obtaining Data in Oracle SQL,"select t1.sku,
       t1.main_location,
       ml.quantity        as main_qty,
       t1.backup_location,
       bl.quantity        as bkup_qty
  from table_1 t1
  left join table_2 ml
    on t1.sku = ml.sku
   and t1.main_location = ml.location
  left join table_2 bl
    on t1.sku = ml.sku
   and t1.backup_location = bl.location
 order by t1.sku
"
28769,Convert UPDATE with INNER JOIN from SQL for use in MySQL,"UPDATE product 
SET price = 12.95 
WHERE product_id in
(SELECT product_id 
FROM product_to_category 
INNER JOIN category 
ON product_to_category.category_id = category.category_id 
WHERE category.parent_id = 39)
"
38891,Retrieving data using select SQL statement in Powershell,"$SqlConnection = New-Object System.Data.SqlClient.SqlConnection
$SqlConnection.ConnectionString = ""Server=HOME\SQLEXPRESS;Database=master;Integrated Security=True""
$SqlConnection.Open()
$SqlCmd = New-Object System.Data.SqlClient.SqlCommand
$SqlCmd.CommandText = ""select name from sysdatabases where name = 'tempdb'""
$SqlCmd.Connection = $SqlConnection
$dbname = $SqlCmd.ExecuteScalar()
$SqlConnection.Close()
Write-output ""Database is "" $dbname
"
19130,MySQL select timestamp as date string,"FROM_UNIXTIME(create_time, '%Y-%m-%d %H:%i:%s')
"
16724,Using Distinct in SQL Update,"UPDATE SETTING_VALUE
SET Enabled = 0
FROM SETTING_VALUE v
INNER JOIN SETTING s ON v.SettingID = s.SettingID
INNER JOIN LU_FIELD f ON f.FieldID = s.FieldID
WHERE v.DisplayValue LIKE '%Miami%'
AND f.ControlName LIKE '%City%'
"
30901,SQL Server with RegExp,"where cast(right(data, 8) as date) = cast(getdate() as date)
"
1742,How to create multiple sequences in one table?,"INSERT INTO receipts (customer_id, receipt_number)
SELECT :ci, COALESCE(MAX(receipt_number), 0) + 1
FROM receipts
WHERE customer_id = :ci;
"
29056,Deleted unreferenced records from table,"declare del_cur cursor
local
forward_only
static
scroll_locks
for
  select 0 from B
;

declare @foo int;

open del_cur;

fetch next from del_cur into @foo;
while @@fetch_status = 0
begin
  begin try
    delete from B where current of del_cur;
  end try
  begin catch
    -- It was referenced, skip
  end catch;

  fetch next from del_cur into @foo;
end;

close del_cur;
deallocate del_cur;
"
15006,SQL select MAX data within each 12 hours,"SELECT date, value
FROM
(SELECT t.date, 
    t.value,
    ROW_NUMBER() 
        OVER(PARTITION BY CAST(t.date AS date), CASE WHEN DATEPART(hour, t.date) < 12 THEN 0 ELSE 1 END 
        ORDER BY t.value DESC) AS rownum
    FROM temp t
    WHERE t.Date between DATEADD(hour, 7, '04/01/2016') and DATEADD(minute, 1859, '04/02/2016')
) max_val
WHERE max_val.rownum = 1
ORDER BY Date
"
26411,Sql-How to compare a comma seperated value in a column with a string,"SELECT * FROM GROUP WHERE find_in_set('17',grp_member);
"
13511,MySQL left outer join multiple tables,"select b.id, b.bname,
       t1.name as tagName1,
       t2.name as tagName2,
       t3.name as tagName3
from bookmark b
left join tag t1 on t1.tagid = b.tagid1
left join tag t2 on t2.tagid = b.tagid2
left join tag t3 on t3.tagid = b.tagid3
"
2410,Would storing my data bitwise make search results faster,"SELECT * FROM table WHERE type IN (0, 3, 4)
"
11589,Oracle SQL - How do I repeat a character based on a value in a column,"select rpad('$', round(salary/1000), '$') as ""Graphic"" from employees
"
3388,Truncate date to fiscal year,"SELECT ADD_MONTHS(TRUNC(ADD_MONTHS(SYSDATE,-3),'YYYY'),3)
FROM DUAL;
"
33068,Convert column from Date type to Timestamp,"CREATE OR REPLACE FUNCTION trigA()
  RETURNS trigger AS
$BODY$
begin
    new.modify=LOCALTIMESTAMP;
    return new;
end;
$BODY$
  LANGUAGE plpgsql VOLATILE
"
22591,ordering results based on combine weightage of fields,"SELECT * FROM
(
    SELECT id,
    (MATCH(name) AGAINST ('nice')*10 ) + MATCH(description) AGAINST('nice') AS relevance
    FROM products
    WHERE MATCH(name) AGAINST ('nice') OR
    MATCH(description) AGAINST ('nice')
) ORDER BY revelence DESC
"
16968,Trying to write a query that counts multiple things with different where cases,"SELECT Department, COUNT(*) AS Count
FROM PROJECT
WHERE Department IN  ('Marketing','Finance','Accounting')
GROUP BY Department
"
11007,Check if datetime is in current date,"WHERE CONVERT(date,Y)=CONVERT(DATE,getdate())
"
10941,SQL statement to update one table if value present in another,"UPDATE F4102 
SET    IBBUYR = 1009
WHERE EXISTS (
              SELECT 1
              FROM F4101 
              WHERE IMITM  = F4102.IBITM 
              AND  IMSRTX = 'RESIN'
             )
"
30488,Separate table for reference or Should I use one table?,"ENUM ( 'MALE' , 'FEMALE') .
"
15778,How to Combine Two SQL Queries,"select * from UNITHD
where ( driver1medical BETWEEN '1/1/1990' and GETDATE()+29 )
   or ( driver2medical BETWEEN '1/1/1990' and GETDATE()+29 )
ORDER BY driver1medical
"
19257,select speed on indexed column mysql,"SELECT * FROM tbl_name WHERE str_col=1;
"
2872,how to get Unique data from one table and the other,"JOIN
    conf_log t ON x.date_changed = t.date_changed
    And x.Order_Number = t.Order_number
"
10903,How to write a SQL join to retrieve results from second table?,"SELECT * FROM TABLE2
WHERE ID IN (SELECT ID FROM TABLE1 WHERE color = 'green');
"
19531,Copy contents of returned SQL Query row to a Listbox or Array,"For index = 1 To length
    ListBox1.Items.Add(adapter.SelectBeef(index))
Next
"
23995,Installing and running Pl/SQL packages,"SQL> @proc.prc
SQL> CREATE OR REPLACE PROCEDURE PROC(VAL1 IN NUMBER, VAL2 OUT NUMBER)
  2  AS
  3  BEGIN
  4     VAL2 := VAL1*2;
  5  END PROC;
  6  /

Procedure created.
"
1554,Getting the min() of a count(*) column,"SELECT 
    AVG(s.c)
    , MIN(s.c)
    , MAX(s.c)
    , s.ID
FROM
    --Note this is just your query
    (select id, to_char(time), count(*) as c from vehicle_location group by id, to_char(time), min having id = 16) as s
GROUP BY s.ID
"
10939,SELECTing the total count of multiple cells based upon a shared ID,"select f.lastname, count(m.firstname) as cnt
from familynames f
left join membernames m on m.id = f.id
group by f.id, f.lastname  
order by f.lastname
"
24193,sql left outer join order by column in left table but preserve all rows,"SELECT 
  t1.id
FROM table1 AS t1
LEFT OUTER JOIN
(
   SELECT table1_id, SUM(column1) sum1, SUM(column2) sum2
   FROM table2 
   GROUP BY table1_id
) AS t2  ON t2.table1_id = t.id
        AND t1.entry_id  = 2 
        AND t1.parent_id = 0 
ORDER BY t2.sum1 - t2.sum2;
"
8132,INNER JOIN two tables which were created by UNION ALL in SQL,"   select * 
   from   (Select * from TableA union all Select * from TableB) t1
   inner join TableC t2 on t1.somekey=t2.somekey;
"
34531,Oracle: counting the number of substrings in a string?,"select regexp_count('abba', 'b') from dual;
   2 
select regexp_count('abba', 'b+') from dual;
   1 
"
26588,"Return the first iteration of the set of values even if they repeat,","select *  
from 
(
SELECT *,
       LAG(Group, 1,0) OVER (ORDER BY BeginDate) AS PreviousGroup
FROM table 
)
where PreviousGroup is null or PreviousGroup  <> group 
"
6367,SQL comparison condition column to choose the table to JOIN,"select g.*, coalesce(s1.erynda_kakayato, konkretnaya_hren)
from general g left join
     secondary1 s1 
     on s1.general_id = g.id and g.type_id = 1 left join
     secondary s2
     on s2.general_id = g.id and g.type_id = 2 ;
"
37560,Selecting by tags while also returning all tags for the selected items,"SELECT i.*, GROUP_CONCAT(t.name) 
FROM item i INNER JOIN
     tag_link tl
     ON tl.item_id = i.id INNER JOIN
     tag t
     ON t.id = tl.tag_id
GROUP BY i.id
HAVING sum(t.name IN ('red', 'blue')) > 0;
"
20268,Conditional where clause SQL Server 2012,"Where 
( 
   (LeaveDateTime > FromDate and EnteringDateTime < ToDate) 
      AND
   dateadd(day, Threshhold, LeaveDateTime) >= EnteringDateTime
);
"
35583,sqlplus set command when using oracle sequence,"select to_char(test_seq.nextval) as my_val from dual;
"
2509,SQL query to count records,"SELECT Name, COUNT(*) FROM EntryLog WHERE CheckIn GROUP BY Name
"
16366,Getting random rows based on column index,"select name, text
from (SELECT name, text, row_number() over (partition by name order by random()) as seqnum
      FROM testing t INNER JOIN
           users u
           ON u.id = t.id
      ) t
where seqnum = 1;
"
38568,Show an empty result on succeeding rows,"select id, product_id, status,
       if(id <> @previd and @prevstatus <> status and status = 'Complete', transaction, NULL) as transaction,
       action,
       @previd := id, @prevstatus := status
from table t cross join
     (select @previd := -1, @prevstatus := '') const
order by id, product_id, status;
"
6870,Substract 1 to a IP Adrress in SQL,"select concat(substring_index(ip, '.', 3),
              '.',
              substring_index(ip, '.', -1) -1
             ) as NewIP
"
7248,Execute a set of stored procedures,"declare @SQL nvarchar(max) = ''

select @SQL = @SQL + 'EXEC ' + quotename(s.name) + '.' + quotename(b.name) + ';'
from sys.procedures b
join sys.schemas s on s.schema_id = b.schema_id
where s.name = 'IC'

select @SQL
--exec sp_executesql @SQL
"
31029,sql count results query with joins perfomance,"SELECT COUNT(t1.t1_id) AS count FROM (t1)
JOIN t2 ON (t1.column10 = 1) AND (t1.t2_id = t2.t2_id)
JOIN t3 ON t2.t3_id = t3.t3_id
JOIN t4 ON t3.t4_id = t4.t4_id
"
36168,How can I +1 to all numbers in a mySQL table column,"update the_table
   set school_year = school_year + 1;
"
5050,Using Select Distinct in Nested subquery,"SELECT Location.LocationID, Location.Location
FROM Location
WHERE Location.LocationID IN 
  (SELECT DISTINCT TransactionLocation 
   FROM Transactions
   WHERE Transactions.TransactionActivity = [Enter Activity] 
   AND Transactions.TransactionDate Between [Enter the start date:] And [Enter the end date:]);
"
24518,SQL how to extract middle of string,"declare @String varchar(500)

set @String = '<p>The status for the Unit # 3546 has changed from % to OUTTOVENDOR</p>'

select SUBSTRING(@String, charindex('# ', @String) + 2, charindex('has changed', @String) - charindex('# ', @String) - 2)
"
12962,Select 2 COUNT()'s from MySQL query,"SELECT username, SUM(outcome) AS wins, COUNT(*) - SUM(outcome) AS losses
  FROM tblBattleHistory 
  WHERE battle_type = '0'
  GROUP BY username 
  ORDER BY wins DESC, losses
"
33565,Help with insert query which replaces an original id with different value in sql?,"INESRT INTO InsertTable (ReplacementID, [Name])
SELECT R.ReplacementID, O.[Name]
FROM OriginalTable O
INNER JOIN Employee E ON E.EmployeeID = O.EmployeeID
INNER JOIN ReplacementEmployee R ON E.SerialNo = R.SerialNo
"
8266,SQL 2 Tables join id,"select
a.Name
from 
Anime a
left join anime_user2 au 
on au.anime_idAnime = a.animeID
where 
au.anime_idAnime is NULL
"
16501,Retrieving Certain Strings within a String Using Oracle SQL - Part 2,"SELECT regexp_substr(line, 'aXYZApple[^,]*') subtxt
FROM (SELECT regexp_substr(:x, '[^,]*\,', 1, rownum + 1) line
      FROM dual
      CONNECT BY LEVEL <= length(:x) - length(REPLACE(:x, ',', '')))
WHERE line LIKE '%aXYZApple%';
"
22798,How to update a table taking values to a second sql instance?,"UPDATE p
    SET column1 = t.column1
from <dbname>.<schema>.mytable p
join <TestLinkedServerName>.<dbname>.<schema>.mytable t
    on p.<id> = t.<id>
"
39266,Select query with unusual grouping,"select min(startdate) as startdate, max(enddate) as enddate, information
from (select f.*,
             (row_number() over (order by startdate) -
              row_number() over (partition by information order by startdate)
             ) as grp
      from fruits f
     ) f
group by grp, information;
"
24463,Specify default value where no matching JOINed record,"SELECT r.role_name,
       nvl( pr.person_name, 'Vacant' )
  FROM roles r
       LEFT OUTER JOIN personRoles pr  
         ON(    r.role_id = pr.rold_id
            AND <<some date parameter>> BETWEEN pr.start_date AND pr.end_date)
"
17430,Manipulating SQL query to create data categories that return maximum values,"SELECT Day,
  MAX(CASE WHEN Price BETWEEN 0 AND 10 THEN Limit ELSE 0 END) as ZeroToTen,
  MAX(CASE WHEN Price BETWEEN 10 AND 100 THEN Limit ELSE 0 END) as TenToHundred,
  MAX(CASE WHEN Price > 100 THEN Limit ELSE 0 END) as HundredPlus
FROM YourTable
GROUP BY Day
"
14490,Reading MS Access mdb files in Delphi (for free)?,"    DataSource := 'Provider=Microsoft.Jet.OLEDB.4.0;Data Source=' + Filename +
    ';Persist Security Info=False';

  ADOConnection1.ConnectionString := DataSource;
  ADOConnection1.LoginPrompt := False;
  ADOConnection1.Connected := true;

  // ADOConnection1.GetTableNames(listbox1.items);

  AdoTable1.Connection := ADOConnection1;
  AdoTable1.ReadOnly := false; //if u want to make changes
  ADOTable1.active := false;
  ADOTable1.TableName := 'B2777'; //table name
  ADOTable1.active := true;
"
12915,How to display all database queries made by Wordpress?,"if (current_user_can('administrator')){
    global $wpdb;
    echo ""<pre>"";
    print_r($wpdb->queries);
    echo ""</pre>"";
}
"
26901,Update statement to move wrong values to correct column,"update gender
    set gender1 = (case when gender2 = 'M' then 'M' else gender1 end),
        gender2 = (case when gender1 = 'F' then 'F' else gender2 end)
    where gender1 = 'F' or gender2 = 'M';
"
5840,selecting a column sorted by count but without the count,"SELECT type FROM log GROUP BY type ORDER BY COUNT(type) DESC LIMIT 5
"
5419,"How to remove duplicates, which are generated with array_agg postgres function","SELECT ARRAY_TO_STRING(ARRAY_AGG(DISTINCT CONCAT(u.firstname, ' ', u.lastname)), ', ')
FROM log_has_item logitem
  INNER JOIN log log ON log.id = logitem.log_id
  INNER JOIN worker u ON log.worker_id = u.id
WHERE logitem.company_id = 1
"
32637,Calculating average spending (amount spent/person) in a particular month mysql,"SELECT SUM(i.price)/(SELECT COUNT(*) FROM customers)
FROM items i
LEFT JOIN orders o ON i.itemID = o.itemID
                  AND o.date BETWEEN '2013-03-01' AND '2013-03-31'
WHERE o.itemID IS NOT NULL
"
8542,Using sequential values for the primary key in an INSERT query,"CREATE SEQUENCE LD_USER_ROLE_SEQ;

INSERT INTO LD_USER_ROLE
   (USER_ROLE_ID,INS_USER,INS_DATE, USERNAME) 
VALUES 
   (ld_user_role_seq.nextval, 'sp22',to_date('2003/05/03 21:02:44','yyyy/mm/dd hh24:mi:ss'),'JOHN BARRY', )
"
7927,Sql query - distinct groups,"; with maxes as (
  select ColumnA,
         ColumnB,
         ColumnC,
         max(ColumnB) over (partition by ColumnA) mx
    from tablea
)
select distinct
       ColumnA, 
       mx ColumnB, 
       case when mx = ColumnB 
            then ColumnC 
            else null 
        end ColumnC
from maxes
"
9886,"Database design for a blog with separate tables for users, comments and posts in cakephp","users('id', 'username', 'password'),
posts('id', 'title', 'content', 'slug', 'user_id'),
comments('id', 'content', 'date', 'post_id', 'user_id')
"
660,SQL - Execute SQL query on SQL query,"SELECT *
FROM
(
    YourQueryHere
) Inn
GROUP BY YourColumnHere
"
13114,MySQL subquery limit 1,"select * from unit u
left join (select id as billId, unit_id, added_on, end_reading, bill_type from bills
order by id desc) b ON unit_id = u.id
where community_Id = 1
and unit_section = 7
and unit_floor in (1,2,3,4,5)
group by u.id
order by unit_floor, display_order asc;
"
2892,Delet just one record of duplicate,"delete n1 from nlt_user n1
inner join nlt_user n2 on n1.e-mail=n2.e-mail and n1.id>n2.id;
"
12510,Constraints / Foreign keys information in Oracle,"a.constraint_name = b.constraint_name
"
37384,To get date from SQL,"   select date_sub(curdate(),interval 1 day) as Yesterday , 
          date_sub(curdate(),interval 7 day) as seven_days_ago ,
          min(DateA) as Life_Time_Date 
"
38345,SQL Select where value = 'X' or min value,"SELECT TOP 1 OrgId as [Default]
FROM MyTable
WHERE PersonId = 12
ORDER BY
    CASE WHEN IsDefault = 'T' THEN 0 ELSE 1 END,
    RowId
"
38881,How to create a query that takes long time to run in PostgreSQL,"select pg_sleep(5 * 60);
"
8384,What is the most efficient way of analysing and identifing candle sticks?,"SELECT * 
FROM tbl t1 
     join tbl t2 ON (t1.date=DATE_ADD(t2.date, INTERVAL 1 DAY))
WHERE
  t1.date>=start_date
and t1.date<end_date
-- plus all the candle restrictions here  --
"
27686,Embedded SQL Count is taking too much to proceed,"SELECT  
     ts.CHECK_NUMBER
    ,ts.CUSTOMER_NAME
    ,ts.COMPANY_NAME
    ,ISNULL(O.Total, 0) AS NB_OF_ORDERS
FROM  TRANSACTION_SUMMARY ts
LEFT JOIN    --<-- use inner join is you only want records with some orders
      ( SELECT CHECK_NUMBER, COUNT(*) AS Total 
        FROM   TRANSACTION_ORDER 
        GROUP BY CHECK_NUMBER
      ) as O
ON ts.CHECK_NUMBER = O.CHECK_NUMBER
ORDER BY  ts.BUSINESS_DATE
"
6214,Greatest value of multiple columns with column name?,"SELECT @var_max_val:= GREATEST(col1, col2, col3, ...) AS max_value,
       CASE @var_max_val WHEN col1 THEN 'col1'
                         WHEN col2 THEN 'col2'
                         ...
       END AS max_value_column_name
FROM table_name
WHERE ...
"
53,What's the appropiate method to store values from fragments?,"public class MyDatabaseHandler extends SQLiteOpenHelper{
    private static MyDatabaseHandler databaseHandlerInstance; 

    public static synchronized MyDatabaseHandler getInstance(Context context) {
      if(databaseHandlerInstance ==  null)
         databaseHandlerInstance = new MyDatabaseHandler(Context context);

      return databaseHandlerInstance;
    } 

    public MyDatabaseHandler(Context context){
        // Call to super class
        //
    }

   // ..... onCreate calls
}
"
25734,SQL how to implement if and else by checking column value,"SELECT 
    reservations.customerid, 
    reservations.roomno, 
    rooms.rate, 
    reservations.checkin_date, 
    reservations.billed_nights, 
    reservations.status,
    DateDiff(""d"", checkin_date, IIF(status = 'checkout', checkout_date, Now())) As DueNights
FROM 
    reservations 
    INNER JOIN      
    rooms  
    ON reservations.roomno = rooms.roomno;
"
28948,Trouble pulling records from a certain date range,"SELECT VisitorID, VisitorName, VisitDate FROM VisitList WHERE CAST(VisitDate As date) between CAST('07/01/2015' as date) and CAST('12/31/2015' as date)
"
6786,SQL Query with multiple criteria,"Select Analyst_Ratings.Stock_Ticker, 
   Analyst_Ratings.Analyst_Name, 
   Analyst_Ratings.Rating_Name 
From Analyst_Ratings
Where Rating_Date In(
Select Max(Rating_Date)
From Analyst_Ratings
group by stock_ticker, analyst_name
Where Rating_date <= '2010-01-01')
"
7978,SQL Conditional sum and grouping,"select patientid,
       admissionid,
       datediff(day, 
                  max(case when Admission_Event_Type = '(formal) Separation   ' then startdate end),
                  max(case when Admission_Event_Type = '(formal) Admission    ' then enddate end)
               ) as total_length
from data
group by patientid, admissionid
"
11983,SQL: Join table onto itself,"SELECT T1.Org, T1.Dest, T1.Amount, T2.Org, T2.Dest, T2.Amount, T3.Org, T3.Dest, T3.Amount
FROM dbo.RateTable T1 JOIN
     dbo.RateTable T2
     ON T1.Org = T2.Org JOIN
     dbo.RateTable T3 
     ON T1.Dest = T3.Dest AND T2.Dest = T3.Org
----------------------------------------^
WHERE T1.Amount > (T2.Amount + T3.Amount);
"
35844,How to implement a friendship system in my database?,"select case when id_user1=$my_user_id then alias_user2 else alias_user1 end
from friends
where id_user1=$my_user_id or id_user2=$my_user_id
"
5638,Perform INSERT with SELECT to insert multiple records,"INSERT 
  MainTable_Option 
  (
  MainTableID, 
  OptionID
  )
SELECT
  d.ID, 
  o.OptionId
FROM
  DodgyOldTable d
  INNER JOIN Option o ON
    (d.OptionVal1 = 'Y' AND o.OptionDesc = 'OptionVal1') OR
    (d.OptionVal2 = 'Y' AND o.OptionDesc = 'OptionVal2') OR
    (d.OptionVal3 = 'Y' AND o.OptionDesc = 'OptionVal3')
"
8267,Select all items with sum of fields in specified range,"SELECT * 
FROM test_table AS D0
WHERE (

  SELECT TOTAL( file_size ) 
  FROM test_table AS D1
  WHERE D1.file_time < D0.file_time
  OR (
    D1.file_time = D0.file_time
    AND D1.file_id <= D0.file_id
  )
  ORDER BY file_time, file_id DESC
)
BETWEEN 1 
AND 9
"
16829,Get only 1 result from SQL table (null or with date),"SELECT top 1 im.*
FROM ItemsMedia im
ORDER BY (case when FromDate <= GETDATE() AND ToDate >= GETDATE()
               then 1
               when FromDate IS NULL AND ToDate IS NULL
               then 2
               else 3
          end);
"
21819,mysql sorting by day with WHERE also,"SELECT DAY( DATE ) , 
sum(success = 1) as `success`,
sum(success = 0) as failure,
COUNT( * ) FROM logs 
WHERE DATE BETWEEN STR_TO_DATE('2015-03-01','%Y-%m-%d' )  AND NOW() 
GROUP BY DAY( DATE )
"
16180,printing message in trigger Mysql 5.0,"...
BEGIN
  IF NEW.Journey_Day < CURDATE() THEN
    CALL proc_error_date();
  END IF;
END
...
"
138,Dynamic Query in SQL Server,"declare @sql varchar(5000)
"
9604,How to evaluate parameter variable stored in a file in jMeter?,"import java.util.regex.Matcher;
import java.util.regex.Pattern;

String regex = ""\\$\\{([^}]+)\\}"";
SQLQuery = vars.get(""SQLQuery"");
Pattern pattern = Pattern.compile(regex);
Matcher matcher = pattern.matcher(SQLQuery);
while(matcher.find())
{
    String token = matcher.group();   //${var}
    String tokenKey = matcher.group(1);  // var
    SQLQuery = SQLQuery.replaceFirst(Pattern.quote(token), Matcher.quoteReplacement(vars.get(tokenKey)));
}
vars.put(""SQLQuery"", SQLQuery);
"
4934,SQL trigger for expiration date,"CREATE TABLE my_table (
    col1 VARCHAR(10),
    col2 VARCHAR(20),
    expiration_date DATE,
    is_expired AS CASE WHEN expiration_date > GETDATE() THEN 1 ELSE 0 END
);
"
37791,Combing multiple SELECT SQL Queries,"Select something, somethingelse, 'your label1'
FROM table1
UNION ALL
SELECT something, somethingelse, 'your label2'
FROM table2
"
4178,multiple row in a single row mysql,"SELECT  name, material,
        SUM(case when trnid = 1 then quantity else 0 end) as purchaseqty,
        SUM(case when trnid = 2 then quantity else 0 end) as issueqty
FROM transactions t JOIN
     item_master im
     ON t.material = im.id
GROUP BY name, material
LIMIT 0 , 30;
"
2043,How to use SQL to do a group by with different dates?,"SELECT
   ...,
   SUM(CASE WHEN SaleDate >= DATEADD(day, -7, GETDATE()) THEN 1 ELSE 0 END) AS 7days,
   COUNT(*) AS 14days
FROM
   MyTable
WHERE
   SaleDate >= DATEADD(day, -14, GETDATE())
GROUP BY
   ...
"
20686,SQL Return subquery 'Total Records' to outer query,"DECLARE @totalCount AS INT
DECLARE @result varchar(MAX)

SELECT @totalCount = COUNT(*) OVER(), @result = COALESCE(@result + '', '') + '<result title=""' + [Title] + '"" year=""' + [Year] + '"" type=""' + [Type] + '""/>'
FROM Movies where CONTAINS(Title, '@Title') Order by [Weight] DESC
OFFSET ((@PageNumber - 1) * @RowspPage) ROWS
FETCH NEXT @RowspPage ROWS ONLY
SELECT '<root totalCount=""' + CAST(@totalCount AS VARCHAR) + '"">' + @result + '</root>'
"
21696,Remove and add ID key index from Access table in VBA,"CurrentDb.Execute ""ALTER TABLE Aux_Tabla1 ALTER COLUMN ID COUNTER(1,1)""
"
26759,Advanced sql query,"SELECT t1.column1, 
       t1.column2, 
       t1.column5, 
       null column12, 
       t1.column13, 
       null column7
  FROM table1 t1
UNION ALL
SELECT t2.column1, 
       t2.column2, 
       null column5, 
       t2.column12, 
       null column13, 
       t2.column7
  FROM table2 t2
"
36493,TSQL Insert the column default value from Case Statement,"DECLARE @newA varchar(10) = 'Foo2'

IF (@newA <> 'Foo2')
BEGIN
   INSERT INTO Table_1 (A, B)
   SELECT @newA, 'bar'
END
ELSE
BEGIN
   --If you are using default values, you do not have to specify the column
   INSERT INTO Table_1 (A) 
   SELECT @newA
END
"
27366,Store each AWS S3 file in a database as a separate row?,"file_id  folder_id     file_path
  1          1       http://s3.aws.amazon.com/my-bucket/folder1/img1a.jpg
  2          1       http://s3.aws.amazon.com/my-bucket/folder1/img1b.jpg
  3          2       http://s3.aws.amazon.com/my-bucket/folder2/img2a.jpg
  4          2       http://s3.aws.amazon.com/my-bucket/folder2/img2b.jpg
"
22920,"MYSQL Comment Counting, not working","SELECT p.*, COALESCE(COUNT(c.post_id), 0) AS numberOfComments
FROM posts p 
LEFT JOIN comments c ON c.post_id = p.post_id
WHERE p.number_of_comments = 'B'
GROUP BY p.post_id
LIMIT 0, 30;
"
4373,Converting Date format to run select statement,"String sqlDate = ""1992-02-16"";
SimpleDateFormat sdfInput = new SimpleDateFormat(""yyyy-MM-dd"");
Date date = sdfInput.parse(sqlDate);
SimpleDateFormat sdfResult = new SimpleDateFormat(""MM-dd-yyyy"");
String result = sdfResult.format(date);
"
3762,Selecting Specific Information Using Two Tables,"SELECT p.Player_id,COUNT(*) FROM PLAYERS p
INNER JOIN LOGIN l ON p.Player_id = l.Player_id
WHERE l.login_date = '2014-06-01' AND l.email_address LIKE '%.net'
GROUP BY p.Player_id
"
26124,Calling table valued function twice. Could be once?,"select K.ID,  tf1.A, tf1.B
from K cross apply
     dbo.TableFunction1(K.ID, 0, 77) tf1
"
28359,"Mysql change id in field is another field = ""transfer""","UPDATE tableName
SET AccountID='2001'
WHERE Narrive=""transfer"" 
"
7537,similar to SELECT * in sql but with only a row,"declare @cols nvarchar(max)

select @cols = coalesce(@cols + ', ' + column_name, column_name)
from information_schema.COLUMNS
where TABLE_NAME = 'mytable'

declare @sql nvarchar(max)
select @sql = 'select ' + @cols + ' from myTable where Id = 1'

exec sp_executesql @sql
"
4038,Get all the unique entries from 2 tables,"select *
from table2
union all
select *
from table1
where table1.mid not in (select mid from table2)
"
19768,"In Oracle, how to catch exception when table used for the loop doesn't exists","DECLARE
    CUR SYS_REFCURSOR;
    <variables or record type> -- declare as appropriate
BEGIN
    OPEN CUR FOR 'SELECT * FROM SOME_USER.SOME_TABLE';
    LOOP
        FETCH CUR INTO <variables or record type>;
        EXIT WHEN CUR%NOTFOUND;
        -- do something with variables or record
    END LOOP;
    CLOSE CUR;
END;
/
"
22290,SQL where clause for a named table,"SELECT * FROM 
(
 SELECT ename as ""Name""
      , TO_CHAR(sysdate,'YYYY') - TO_CHAR(hiredate,'YYYY') as AGE 
  FROM scott.emp
)
WHERE age = (SELECT min(TO_CHAR(sysdate,'YYYY') - TO_CHAR(hiredate,'YYYY')) FROM scott.emp)
/

Name    AGE
----------------
SCOTT   26
ADAMS   26
"
29248,What does this code do: `dbo.sp_set_sqlagent_properties @local_host_server`,"EXEC msdb.dbo.sp_set_sqlagent_properties @email_save_in_sent_folder=1, 
        @databasemail_profile=N'(myservername)', 
        @use_databasemail=1
GO
"
23308,How do I convert a Decimal to Varchar with an specific format in SQL Server 2008,"declare @myNumber decimal(15,2) = 137909.19 
declare @myvalue varchar(20)

set @myvalue = convert(varchar, cast(@myNumber as money),1) 
PRINT @myvalue
"
2119,SQL count occurrence of value by distinct id,"SELECT a1.FlightId, COUNT(a2.FlightId) 
FROM A a1 LEFT JOIN A a2 ON a1.id = a2.id
AND a2.Roles = 'Steward'
GROUP BY a1.FlightId;
"
29971,What is the purpose of this SQL syntax (AS XYZ NUMBER)?,"CREATE OR REPLACE PROCEDURE <<procedure name>> (
  <<list of parameters>>
)
AS
  <<declare local variables>>
BEGIN
  <<do something>>
END <<procedure name>>;
"
3365,"Performance considerations for SUB QUERY, LIMIT and ORDER BY when using MySQL","SELECT u.*
FROM USERS u
WHERE u.cash_balance > 500 AND
      ((SELECT COUNT(*) AS n_ongoingGames
        FROM games g
        WHERE g.player1_userID = u.userID
       ) +
       (SELECT COUNT(*) AS n_ongoingGames
        FROM games g
        WHERE g.player2_userID = u.userID
       )
      ) < 5
ORDER BY u.user_rating
LIMIT 10;
"
38412,Can't insert date from table to other with 2 condition,"from emp e
inner join emp2  e2 on e.Id = e2.Id and e.storeId = e2.storeId
"
1446,Is there a way to SELECT by a part of a date in SQL?,"SELECT * FROM table WHERE datetime LIKE '2007-05%'
"
2386,Inserting a ref value into an object table,"INSERT INTO PROJECT_TABLE
(PROJECT_ID,
PROJECT_ASSIGNED_MEMBER,
PROJECT_TITLE)VALUES(
2,
(SELECT REF(M) FROM project_resources M WHERE M.member_id = 2),
'Bomb');
"
31076,SQL to get grades,"select 
    t1.id_student,
    t1.id_teacher,
    coalesce(t2.grade,t1.grade)
from
    (select id_student, id_teacher, grade from my_table where second_test = 'N') as t1
left join
    (select id_student, id_teacher, grade from my_table where second_test = 'Y') as t2
on 
    t1.id_student = t2.id_student and t1.id_teacher = t2.id_teacher
"
26114,How does SQL Server handle the following query?,"SELECT u.UserId,
       u.FullName,
       u.Location
FROM   [User] U
WHERE  NOT EXISTS (SELECT 1
                   FROM   ClubSponsorRelation csr
                   WHERE  u.UserId = csr.SponsorId
                   AND    csr.ClubId = @clubId)
       AND u.UserType = 'Sponsor' 
"
19946,merging two tables w/ same structure,"INSERT INTO siteScoring(mid, itemid, title, topic, url,  
                        votes, comments, user, itemTime, time)
SELECT  mid, itemid, title, topic, url,  
        votes, comments, user, itemTime, time
FROM    siteScoring1

UNION

SELECT  mid, itemid, title, topic, url,  
        votes, comments, user, itemTime, time
FROM    siteScoring2
"
24805,how to delete data from table that has date prior to 2006,"DELETE FROM TABLE_A
 WHERE last_update_date < TO_DATE('01/01/2006', 'MM/DD/YYYY')
"
38529,Database query to search using address,"  select city, postcode, name
  from dealers
  where name = p_search_term OR
        postcode = p_search_term OR
        city = p_search_term
  ORDER BY case when postcode = p_search_term then p_search_term else 1 end desc
           , case when name = p_search_term then p_search_term else city end asc
"
38255,What's the table name for a defined name in the scope of a worksheet?,"SELECT * FROM myname
SELECT * FROM [worksheet1$myname]
SELECT * FROM [worksheet2$myname]
"
32504,Generate comma separated value based on input in sql,"DECLARE @List varchar(100)

SELECT 
   @List = COALESCE(@List + ', ', '') + CAST(Value AS varchar(10))
FROM 
   Rule_X_ListType
WHERE 
   Rule_ID = 1 and ListType_ID = 2

SELECT @List
"
30682,select query -mysql,"SELECT * 
FROM table 
WHERE id NOT IN 
    ( SELECT DISTINCT id FROM table WHERE name2 = 'E' )
"
30557,Display same SQL attribute from different joins," SELECT t1.messageID, 
        fromName.displayName as fromDisplayName, 
        toName.displayName as toDisplayName
 FROM table1 t1
 JOIN table2 t2 
   ON t1.messageID = t2.messageID
 JOIN table3 fromName
   ON t1.fromID = fromName.id
 JOIN table3 toName
   ON t2.toID = toName.id   
"
16234,Joining one table multiple times with null FKs,"   SELECT g.id, p1.gender, p2.gender
     FROM Games g
LEFT JOIN Players p1 ON p1.id = g.player1Id
LEFT JOIN Players p2 on p2.id = g.player2Id
"
1958,How to Trace Procedure execution time?,"/* Start of your procedure */
Declare @startTime datetime = GETDATE()
Declare @duration varchar

/* Your procedure */
...

/* End of your procedure */
Set @duration = CONVERT(VARCHAR(8),GETDATE() - @startTime,108)
Insert into statisticTable 
Values ('procedureName', @duration)
"
2811,How would I go about rebuilding an object in an Oracle XE database?,"alter index smon_scn_time_tim_idx rebuild;
"
39008,Fixed array and random numbers in an SQL query,"select str
from (
  select 0 as id, 'apple' as str
  union all
  select 1, 'banana'
  union all
  select 2, 'orange'
  union all
  select 3, 'cherry'
  union all
  select 4, 'lemon'
) x
where id = floor(rand() * 5)
"
23587,How to get maximum for a field based on a date and get other fields also?,"select  startkey, name, min, lname, mname, id
from T T1
where min = 
 (select max(min) from T T2 where T1.startkey=T2.startkey)

order by startkey
"
4858,Why is subquery and join so slow,"SELECT b.*
  FROM SAP_STATES s 
 INNER LOOP JOIN BUNDLES b 
    ON s.SAP_STATE_ID = b.SAP_STATE_ID
 WHERE s.EXPORT_TO_SAP = 1
"
27759,Selecting items with same name and adding each value the line holds,"SELECT s.descr, SUM(s.unitqty) AS sum_of_unitqty
FROM saleslines s
GROUP BY s.descr
"
25431,SQL - Need to select most recent entries from a table Group By? Distinct?," select AirportFrom, AirportTo, Price
 from yourtable join
 (select AirportFrom af, AirportTo at, max(DateTimeAdded) LastUpdate
 from yourtable
 group by AirportFrom, AirportTo) temp on AirportFrom = af
 and AirportTo = at
 and DateTimeAdded = LastUpdate
"
13100,join between two database values,"SELECT COUNT(*)
FROM entries e
LEFT JOIN categories cat
ON e.entry_name = cat.name
WHERE cat.category = ?
"
23271,How to write this postgresql dynamic query,"update employees_wgs
  set source = get_nearest_station(x,y);
commit;
"
29547,idea to write procedure?,"SELECT ISNULL(p.someValue, d.someValue)
FROM DepartmentRelatedTable d
LEFT JOIN ProductRelatedTable p on (d.ProductId = p.ProductId)
WHERE d.ProductId = <some id here>
"
18221,How can I do boolean logic on two columns in MySQL?,"Select (payment1_paid && payment2_paid) as paid_in_full 
from denormalized_payments 
where payment1_type = 'check';
"
9253,SQL to get list of dates as well as days before and after without duplicates,"SELECT MyDate, Min(DateType)
From
(
  SELECT MyDate + T1.RecordType AS MyDate, T1.DateType
  FROM
  (
    Select 1 AS RecordType, 2 AS DateType
    Union ALL
    Select 0 AS RecordType, 1 AS DateType
    Union ALL
    Select -1 AS RecordType, 2 AS DateType
  ) AS T1
  CROSS JOIN myTable
  Where myTable.fkId = @MyFkId
) AS CombinedTable
Group By MyDate
"
10266,Tuning And Performance,"INSERT INTO <TABLED>
SELECT A.* FROM <TABLEA> A  
WHERE A.MED_DTL_STATUS='0' 
AND NOT EXISTS (
    SELECT B.TRANS_ID_X_REF 
    FROM <TABLEB> B 
    WHERE B.TRANS_ID_X_REF = A.TRANS_ID
)
AND NOT EXISTS (
    SELECT A2.TRANS_ID 
    FROM <TABLEA> A2 
    WHERE A2.TRANS_ID = A.TRANS_ID
    AND A2.ADJUSTMENT_TYPE='3'
);
"
16926,Need help in generating Query,"select
    col1,
    col2,
    col3 = (
        select col3 + ','
        from TestTable
        for xml path('')
    )
from TestTable
group by col1, col2
"
31816,Querying a one-to-many relationship such that all the children returned only belong to the parents returned in the query,"SELECT p.id, c.id
FROM Child c
JOIN Parent p ON c.parent_id = p.id
WHERE c.parent_id
IN (SELECT id
    FROM Parent
    WHERE rank <= 20)
"
25347,how does oracle makes 1 million insertion in 1 second,"create table tbl as 
select i as c1, 
       random() as c2, 
       clock_timestamp() + interval '1' second as c3 
  from generate_series(1,1000000) i
;
"
8274,Does it make sense to Order by a column not included in Result Set?,"SELECT ass.audio_id, SUM(au.audiolength) AS AudioFileLength
FROM cur_assigntable ass JOIN
     cur_audiofile_master au
     ON au.audioid = ass.audio_id
WHERE ass.auserid = '141' AND
      ass.delflag = 0 AND
      au.delflag = 0 AND
      tflag = 0 AND
      ass.serverflag = 1
GROUP BY ass.audio_id
ORDER BY MIN(ass.statflag) DESC, MIN(ass.serverflag) DESC;
"
30865,How create a Stored procedure that will accept a parameter,"CREATE PROCEDURE `execute`(IN sqlQuery varchar(255))
BEGIN

    set @sqlQuery := sqlQuery;

    prepare stmp from @sqlQuery; 

    execute stmp;

    deallocate prepare stmp; 

END

CREATE PROCEDURE `yourProcName`(IN tableName varchar(50))
BEGIN

    call execute(concat('DROP TABLE IF EXISTS ', tableName));
    call execute(concat('CREATE TABLE ', tableName, ' LIKE data._style'));

    ...

END
"
6961,"Why is ""0D0"" considered numeric in SQL Server 2008?","select CONVERT(float,'2D3')
"
32682,SQL XML Xquery data query using a variable in the node selection?,"declare @cf varchar(20)
set @cf='cf_item_type'

select distinct
  cast(customFields_xml.query(
    'data(/root/*[local-name(.) = sql:variable(""@cf"")])') as varchar(20)) as cloth
from designs
"
38423,Best table structure for tracking state changes,"SELECT *
FROM Components c
JOIN StatusHistoryItems shi on c.ID = shi.ComponentID
     AND c.IsCurrent = 1 --this condition will join exactly one row
"
27964,Problem joining on the highest value in mysql table,"SELECT p.*, r.*
FROM products AS p
  JOIN revisions AS r USING (product_id)
  LEFT OUTER JOIN revisions AS r2 
    ON (r.product_id = r2.product_id AND r.modified < r2.modified)
WHERE r2.revision_id IS NULL;
"
23907,Counting Distinct Records Using Multiple Criteria From Another Table In MySQL,"SELECT  COUNT(Recipe.ID) Answer
FROM    Recipe INNER JOIN
        Ingredient olives ON olives.RecipeID=Recipe.ID INNER JOIN
        Ingredient mushrooms ON mushrooms.RecipeID=Recipe.ID 
WHERE   olives.Name='Olives'
AND     mushrooms.Name='Mushrooms'
AND     olives.Amount = 1
AND     mushrooms.Amount = 2
"
33285,SQL server ignore case in a where expression,"SELECT * FROM myTable WHERE myField = 'sOmeVal' COLLATE SQL_Latin1_General_CP1_CI_AS
"
38457,Can SQL queries be combined?,"<cfquery name = ""fld"" datasource = ""Moxart"">
   select Fieldname, DBname, SelName from AuxXref 
   where SelName = <cfqueryparam value = ""#orig#"">
   AND FieldName = <cfqueryparam value = ""#orig#""> 
</cfquery>
"
16231,MySQL : Select all the rows except those having the specified values in columns,"SELECT  *
FROM    pledger
WHERE   dcno <> 1 OR pledger.etype <> 'sale'
"
4452,SQL select query to return only if a record has a field of a single value,"SELECT POLICYNUMBER, FPLAN, FEFFYY, FEFFMM, FEFFDD, FINSTP, CLIENTNUM, FIRSTNAME, 
MIDNAME, LASTNAME, BIRTHDATE FROM PFCASBENE 
INNER JOIN CMRELATN ON POLICYNUMBER = KEYFIELD1 
INNER JOIN CMPERSON ON CLIENTNUM = CLIENTID
WHERE (FPSFLG='I' OR FPSFLG='P') AND CLIENTNUM not in (
SELECT CLIENTNUM FROM PFCASBENE 
INNER JOIN CMRELATN ON POLICYNUMBER = KEYFIELD1 
INNER JOIN CMPERSON ON CLIENTNUM = CLIENTID
WHERE FINSTP <> 'F')
ORDER BY CLIENTNUM ASC
"
34613,SQL: Find different accounts in asset list,"SELECT b.amainnr,
       b.asubnr,
       b.account
FROM atable b
WHERE b.amainnr IN
    (SELECT a.amainnr
     FROM atable a
     GROUP BY a.amainnr HAVING count(distinct(a.account)) > 1)
"
39925,Creating SQL users and restricting their permissions,"
--Replace db with your database name
USE db

--Create a database role
CREATE ROLE db_execonly

--Grant EXEC permissions to the role
GRANT EXECUTE TO db_execonly

--Add users to the new role
EXEC sp_addrolemember 'db_execonly', 'user1'
EXEC sp_addrolemember 'db_execonly', 'user2'

--Deny permissions to specific objects for user2
DENY EXEC ON OBJECT::dbo.usp_sproc1 TO user2
DENY EXEC ON OBJECT::dbo.usp_sproc2 TO user2
"
29679,How to aggregate the result of an expression?,"select sum(DocBal) FROM
(select 
  DocBal =  CASE d.DocType WHEN 'AD' THEN -d.DocBal
                           ELSE d.DocBal END,
  CpnID
  from Vendor v
   inner join APDoc d
   on v.VendId = d.VendId
   where 
      d.PerPost = 201307
      and d.DocType in ('VO','AP','AD')
      and d.OpenDoc = 1
      and Acct = 210110) a
GROUP BY CpnID
"
8489,Select SUM(case when value1 =351 then 1 else 0 end) as value2 from table1,"Select MAX(case when value1 =351 then 'Y' else 'N' end) as value2 
from table1
"
32530,"SQL joining two tables, null same result","SELECT
   CASE WHEN (
     T1.Field1 = T2.Field1 OR (T1.Field1 IS NULL AND T2.Field1 IS NULL)
   ) THEN NULL ELSE T2.Field1 END AS Field1,
   CASE WHEN (
     T1.Field2 = T2.Field2 OR (T1.Field2 IS NULL AND T2.Field2 IS NULL)
   ) THEN NULL ELSE T2.Field1 END AS Field2
/** and so on **/
FROM
  Table1 T1
  FULL OUTER JOIN Table2 T2
    ON T1.JoinField = T2.JoinField
"
38066,CASE Statement in jooq?,"// Assuming a static import:
import static org.jooq.impl.DSL.*;
import static org.jooq.impl.SQLDataTypes.*;

decode().value(
       length(
           cast(
               substring(MY_TABLE.ATTACHEDBLOB, 1, 1),
               VARCHAR.length(1)
           )
       )
   )
   .when(1, ""true"")
   .otherwise(""false"")
   .as(""ReviewExistance"");
"
37687,query update table based on key from different table," Use this syntax :
UPDATE
    Table1
SET
    Table1.group1 = Table2.group2
FROM
    Table1
INNER JOIN
    Table2
ON
    Table1.name = Table2.name
"
19477,Latest date in SQL with four linked tables,"SELECT l.department, 
  d.PATID AS Appliance, 
  AppDescription As Type, 
  Location, 
  AppPass AS Result, 
  MAX(t.TestDate) AS LastTestDate 
FROM (Department_List AS l INNER JOIN (Appliance_Description AS a INNER JOIN Appliance_Details AS d ON a.Number = d.ShortDescription) ON l.Number = d.Department) 
INNER JOIN Test_Results AS t ON d.PATID = t.PATID 
GROUP BY l.department, d.PATID, AppDescription, Location, AppPass
ORDER BY l.department, d.PATID
"
9982,Database Table structure for search engine for my website,"Table  : tbl_wordsoccurrence
Fields : words_id, words 
(and if you like you can include also number_of_occurences and page_id fields)
"
20577,optimal view including last value,"create view as
    select ServerId, ClientId, time, type
    from (select t.*,
                 row_number() over (partition by ServerId, ClientId order by time desc) as seqnum
          from t
         ) t
    where seqnum = 1
"
23404,Using Wildcards in SQL Where statement,"OR skuDetails.ItemName LIKE  '%' ...
"
37852,SQL query for grouping monthly period ranges,"select name, min(period), max(period)
from (select t.*,
             (cast(left(period, 4) as int) * 12 + cast(right(period, 2) as int) -
              row_number() over (partition by name order by period)
             ) as grp
      from names t
     ) t
group by grp, name;
"
25626,GREATEST and LEAST in SQL standard,"  SELECT SUBSTR(section,1,2) AS campus, 
           AVG(CASE WHEN maximum - enrolled > 0 
                    THEN maximum - enrolled
                    ELSE 0
               END) AS empty 
    FROM sectionrun 
   WHERE coursenumber = '105' AND subject = 'ENGL' 
GROUP BY campus
"
19994,Increment field of mysql database using codeigniter's active record syntax,"$this->db->where('id', $post['identifier']);
$this->db->set('votes', 'votes+1', FALSE);
$this->db->update('users');
"
22161,How to find entities where key does not exist,"select *
from productattributes p1
where not exists (select 1 from productattributes p2
                  where p1.product_id = p2.product_id
                    and p2.attribute_id = 136)
"
10364,Copying double value from a column of a table into another string column with fixed lenth pattern in MySql,"UPDATE YourTable SET newcolumn = LPAD(REPLACE(FORMAT(Price,0),',',''),5,'0')
"
25808,How can I filter out the rows which contain a particular column with null or empty data in SQL?,"select name,age from members where name is not null and name <> ''
"
2880,How to separate string output?,"select 
   substring(member_name, charindex('/', member_name) + 1, 1) as first_initial,
   left(member_name, charindex('/', member_name) - 1) as last_name
from
   member
"
4314,How to determine if and which index is being used in oracle,"select * from table(dbms_xplan.display);
"
30714,Parse SQL Output,"$rawdata | Where-Object { $_.DistinguishedName -like '*DC=my,DC=domain' }
"
23772,Having trouble creating a MYSQL-Query which selects Data from two tables,"SELECT t.name,s.InstitutionName      
FROM Employees t
INNER JOIN Institutions s
ON(t.InstitutionID = s.insID
   AND s.Location = 'London')
"
6681,Select column based on max date timestamp,"select distinct on (col_a, col_b)
  *
from
  yourtable
order by
  col_a, col_b, -- columns from `distinct on` should be in the `order by` clause
  -- and here is a max value of date_added for every distinct (col_a, col_b) pairs 
  -- because of descending order
  date_added desc;
"
8170,How to Replace and Update Data From One Table to Another Table in MySQL,"UPDATE posts JOIN categories ON posts.cat_id = categories.cat_name SET posts.cat_id = categories.cat_id
"
12486,How to give a unique constraint to a combination of columns in Oracle?,"ALTER TABLE YourTable
  add CONSTRAINT YourTable_unique UNIQUE (B, C, D);
"
12532,not getting expected result while joining,"      select * from
        (select  A.mainid , A.name  from #acc
A left join #acc B
on A.subid   = B.mainid  ) as m where  m.mainid not in (select subid from #acc)
"
12361,SELECT Statement with if-else condition,"SELECT id
FROM page
WHERE name = ""Test""
AND (idLanguage = idlanguage OR idParent = idpage)
"
15092,Query between two related tables,"
SELECT * FROM users
LEFT JOIN friends f1 ON (users.id = friends.uid)
LEFT JOIN friends f2 ON (users.id = friends.fid)
WHERE f1.uid IS NULL AND f2.uid IS NULL
"
26719,SQL Server: Computed Column defintions retrievable from Database?,"create table dbo.Foo
(
StartDate int,
CallDT AS (CONVERT([datetime],dateadd(second,[StartDate],'01/01/1970'),(0)))
)

select definition 
from sys.computed_columns 
where name='CallDT' and object_id=object_id('dbo.Foo')
"
12666,Update column data according to Another column on the same table in Mysql,"UPDATE JurnalEntries.dbo
SET JE_OriginalFileName = CONCAT('FI ', MONTH(JE_InsertDate),' ', YEAR(JE_InsertDate),'.xlsx')
"
32096,Breaking out yearly payments into monthly payments with month name in a 3 year period,"with months as
(
  select BeginDate
    , EndDate
    , Payment = Payment / 12.0
  from MyTable
  union all
  select BeginDate = dateadd(mm, 1, BeginDate)
    , EndDate
    , Payment
  from months
  where dateadd(mm, 1, BeginDate) < EndDate
)
select BeginDate
  , EndDate = dateadd(dd, -1, dateadd(mm, 1, BeginDate))
  , Month = datename(mm, BeginDate)
  , MonthlyAmount = Payment
from months
order by BeginDate
"
33195,Recursive relations - list people with a supervisor and those without a supervisor,"SELECT o.official_name Official, p.official_name Supervisor
FROM official o
LEFT JOIN officialsupervisor s ON o.official_id = s.official_id
LEFT JOIN official p ON p.official_id = s.supervisor_official_id
"
34788,Oracle regular expression to pull rows from a table,"REGEXP_LIKE(col, '[^[:alnum:] _,-]')
"
21937,mysql unknown column in selct query as,"SELECT u.firstname, u.lastname, u.email,
       CONCAT(u.preference, ',') AS pref
FROM users u
WHERE u.status = 1 AND u.active = 1;
"
21881,Linking IDs of the same row to other tables,"SELECT map.Transition_Set_Variable_ID, 
       map.Transition_ID,
       variable.Name,
       variable2.Name,
       value.Name
FROM Variables AS variable 
  INNER JOIN Mapping AS map ON variable.VariableID = map.VariableID
  LEFT JOIN Variables AS variable2 ON map.To_VariableID = variable2.VariableID
  LEFT JOIN Values AS value ON tsv.To_ValueID = value.ValueID
ORDER BY map.TransitionID, variable.VariableID 
"
37829,"Union two or more tables, when you don't know the number of tables you are merging","select 
    f.* 
from 
    resultsTable rt
    cross apply dbo.subs(rt.ID) f
"
11230,how to do check if specific column null then ignore some part of query,"SELECT mc.* 
FROM media_credit mc
LEFT JOIN credit c 
    ON c.id = mc.credit_id
    AND c.status = $2
LEFT JOIN ""user"" u 
    ON u.id = mc.user_id
    AND u.status = $2
LEFT JOIN ""user"" _u 
    ON u.id = c.create_by_user_id
    AND _u.status = $2
WHERE 
    mc.media_id = $1
"
35579,How would I write this SQL in DQL?,"$rsm = new ResultSetMapping;
$rsm->addEntityResult('Player', 'p');
$rsm->addFieldResult('p', 'id', 'player_id');
$rsm->addFieldResult('p', 'name', 'name');

$sql = "" 
    SELECT p.*
      FROM players p
     WHERE CONCAT(p.first_name, ' ', p.last_name) = ?
"";

$query = $this->getEntityManager()->createNativeQuery($sql, $rsm);
$query->setParameter(1, $name);
"
37979,Select EndDate >= GETDATE() is not working?,"EndDate >= CAST(GETDATE() AS DATE)
"
25401,T-SQL to XML - Can multiple values per attribute be listed on their own line?,"SELECT
    'Fruits' AS [Attribute/@name],
    '' AS [Attribute],
    'Apple' AS [Attribute/Value],
    '' AS [Attribute],
    'Orange' AS [Attribute/Value],
    '' AS [Attribute],
    'Grape' AS [Attribute/Value]
FOR XML PATH (''), ROOT('CustomProduce'), TYPE
"
31283,SQL add new editable (Not Identity) column with incremented values,"alter table dbo.Ponies
add [IndexNumber] int not null default 0
Go

declare @index int = 0 
update dbo.Ponies set @index = [IndexNumber] = @index + 1

select * from dbo.Ponies
"
38005,mysql select based on two criteria,"SELECT t.max_id, t.product, pcl.date, pcl.change
    FROM (SELECT product, MAX(id) AS max_id
              FROM productChangeLog 
              WHERE change = 'price changed'
              GROUP BY product) t
        INNER JOIN productChangeLog pcl
            ON t.max_id = pcl.id
"
27844,SQL Server: How to Insert combining two different Selects,"INSERT  INTO RC_Items_Tags
(
        itemID,
        tag
)
SELECT 
        t.itemID,
        ParamValues.tag.value('.', 'varchar(255)')
FROM 
        @xmlTags.nodes('/tags/tag') AS ParamValues(tag)
              CROSS JOIN
        @temp t
"
38589,Using COUNT with MAX in SQL,"WITH TransactionCounts as (
   SELECT
       CustID,
       COUNT(*) AS TransactionCount
   FROM [dbo].[TRANSACTION]
   GROUP BY CustID
)
SELECT TOP 1 CUSTOMER.*, TransactionCount
FROM TransactionCounts
    INNER JOIN CUSTOMER ON CUSTOMER.CustID = TransactionCounts.CustId
ORDER BY TransactionCount DESC

-- alternate to select all if multiple customers are tied for highest count
--WHERE TransactionCount = (SELECT MAX(TransactionCount) FROM TransactionCounts)
"
13386,Reformat Excel List into Tagged Search,"SITE | TAG 
URL1 | Tag1 
URL1 | Tag2
URL1 | Tag3
URL2 | Tag1
URL2 | Tag3
URL3 | Tag1
"
25416,SQL Schema recommendations,"Users
  UserID int

Events
  EventID int
  <dates, or whatever>

EventUsers
  UserID int (Foreign key to Users.UserID)
  EventID int (Foreign key to Events.EventID)
"
4025,SQL Server 2005 One query to calculation two table,"Select pf.ID as PatientFileID,
    os.TotalOtherServices,
    pd.TotalDeposit
From PatientFiles pf
    Left Join
 (Select Patient_File_ID as PatientfileID, SUM(os.Quantum * os.Price) AS TotalOtherServices
  From OtherServices Group By Patient_File_ID) os on pf.PatientFileID = os.PatientFileID
    Left Join
 (Select Patient_File_ID AS PatientFileID, SUM(Deposit) AS TotalPatientDeposit
  From PatientsDeposits Group By Patient_File_ID) pd on pf.PatientFileID = pd.PatientFileID
"
24449,Retrieving rows that share multiple ID's in SQL,"SELECT DISTINCT w.WidId, p.ParId, w.Name
FROM Widget w
JOIN WidgetCategory wc ON wc.WidId=w.Id
JOIN PartCategory   pc ON pc.CatId=wc.CatId
JOIN Part           p  ON p.Id=pc.ParId
"
31309,Exclude result from query,"$sql = ""SELECT video.*,COUNT(*) as count 
FROM tags 
LEFT JOIN video 
ON (tags.vid_id = video.vid_id)
WHERE name IN(?,?) 
AND video.vid_id != some_id 
ORDER BY count DESC 
LIMIT 5"";
"
815,SQL use column name alias without SELECTING,"WITH clean_cte AS
(
  SELECT reallyLong.misleading.andAnnoying.columnName1 as cleanCompactAlias1,
    reallyLong.misleading.andAnnoying.columnName2 as cleanCompactAlias2
)
SELECT doManipulationStuff(cleanCompactAlias1), 
  doManipulationStuff(cleanCompactAlias2)
"
14322,mysql: Populate data in a column from different columns,"UPDATE tableName
SET name = CONCAT('Area ', area_id)
"
25859,SQL - Query records within an undefined interval,"SELECT N1.CustomerID, COUNT(N2.OrderDate)  FROM Northwind N1
INNER JOIN Northwind N2
ON N1.CustomerID=N2.CustomerID
AND N1.OrderDate<=Dateadd(MONTH, 6, N2.OrderDate)
GROUP BY N1.CustomerID
HAVING COUNT(N2.OrderDate)>=3
"
14822,How to select all rows where mycolumn is an integer value?,"SELECT * FROM mytable WHERE mycolumn REGEXP '^[0-9]+$'
"
9771,SQL User-Defined Functions: Fetching TOP n records in a user-defined function,"CREATE FUNCTION Test (@top integer)

RETURNS TABLE

AS

SET ROWCOUNT @top

RETURN SELECT * FROM SomeTable
"
3031,Output of mysql query using case not as expected,"select count(srcount) as SR_Count, guys_name
from
( select srcount,
CASE assignee_name
when 'U80040300' then 'ABC'
when 'U80036396' then 'DEF'
when 'U80035831' then 'GHI'
when 'U80042986' then 'JKL'
else 'A'
end as Guys_Name
from data ) as mydata
GROUP BY guys_name;
"
39605,How to Update value and ADD UP the previous value,"UPDATE YourTable
SET YourColumn = YourColumn+15
"
39733,Subqueries in SQL,"SELECT CharID 
FROM SRO_VT_SHARD.._CharTrijob 
WHERE JobType = 1 AND CharID = @CharID
"
10692,Second Order Relationship in Graph Database,"1. user-[:write]->comment
2. comment-[:about]->hotdog
3. comment-[:concern]->restaurant
4.restaurant-[serve]->hotdog 
"
21006,How can I eliminate the subquery to simplify my query?,"SELECT DISTINCT t1.extension
    , IFNULL(t2.status, t1.status) AS status
    , IFNULL(t2.systemid, t1.systemid) AS systemid
FROM pbx AS t1 
    LEFT OUTER JOIN
    pbx AS t2
    ON t1.extension = t2.extension
        AND t2.status = 'OK'
GROUP BY t1.extension, t2.status
ORDER BY t1.extension
"
20265,Make a single column value from multiple rows column (Stuff),"ORDER BY viwPerformance.LastModifiedOn,viwPerformance.SmartGoalId DESC)
"
33318,Do not return any records if one value exist in a field?,"SELECT id, first, last, category FROM names WHERE
ID NOT IN (SELECT id FROM names where category = 'Tutor')
"
33978,SQL - Selecting groups of rows that share a common value,"SELECT acc, ip
FROM YourTable
WHERE ip IN (SELECT ip
             FROM YourTable
             GROUP BY ip
             HAVING COUNT(*) > 1)
ORDER BY ip, acc
"
39527,"Concatenate multiple result rows of one column into one, group by another column","SELECT movie, string_agg(actor, ', ') AS actor_list
FROM   tbl
GROUP  BY 1;
"
34730,Can I use aggregate functions on PostgreSQL HStore values?,"CREATE TABLE my_table (
  id integer primary key,
  other hstore
);
insert into my_table values 
(1, hstore('height_in', '72') || hstore('weight_lbs', '180')),
(2, hstore('height_in', '65') || hstore('girth_in', '42'));

select sum((other->'height_in')::integer) sum_of_height
from my_table;

sum_of_height
--
137
"
20792,Microsoft SQL Query Get count of DISTINCT values using Over Partition,"SELECT DISTINCT 
  SecCol COLLATE sql_latin1_general_cp1_cs_as,
  FirstCol,
  [SecColCount] = COUNT(SecCol) OVER (PARTITION BY SecCol 
                                      COLLATE sql_latin1_general_cp1_cs_as) 
FROM #LocalTempTable;
"
32929,Using INFORMATION_SCHEMA in a cross database query,"SELECT 'db1' AS dbName, *
FROM db1.sys.columns
UNION ALL
SELECT 'db2' AS dbName, *
FROM db2.sys.columns
"
26236,"SQL count TIMESTAMPDIFF values, ordered by day entries","SELECT DATE(action_time) Date 
   ,COUNT(DISTINCT username) totalCOunt 
   ,SUM(TIMESTAMPDIFF(MINUTE, view_start, view_stop)) AS totalDiff 
FROM audit_data 
GROUP BY DATE(action_time)
ORDER BY 1
"
2426,SQL: select over two tables,"  SELECT c.clubid
    FROM PLAYSAT c
    JOIN PLAYER p ON p.playerid = c.playerid
   WHERE p.playername IN ('john', 'stephen')
GROUP BY c.clubid
  HAVING COUNT(DISTINCT p.playername) = 2
"
2613,Count rows per hour in SQL Server with full date-time value as result,"SELECT dateadd(hour, datediff(hour, 0, TimeStamp), 0) as TimeStampHour, Count(*)
FROM [TEST].[dbo].[data]
GROUP BY dateadd(hour, datediff(hour, 0, TimeStamp), 0)
ORDER BY dateadd(hour, datediff(hour, 0, TimeStamp), 0);
"
24391,Format Describe In SQL*Plus,"set linesize 100; 
describe all_tab_columns;
set linesize 3000; 
select * from all_tab_columns where rownum<=1;
"
33544,postgresql syntax check without running the query,"$ pgsanity good1.sql good2.sql bad.sql
bad.sql: line 1: ERROR: syntax error at or near ""bogus_token""

$ find -name '*.sql' | xargs pgsanity
./sql/bad1.sql: line 59: ERROR: syntax error at or near "";""
./sql/bad2.sql: line 41: ERROR: syntax error at or near ""insert""
./sql/bad3.sql: line 57: ERROR: syntax error at or near ""update""
"
7348,SQL Left Join Conditions,"Select a.ID,
a.AssociateName,
a.FormTypeID,
coalesce(b.Segment1, c.Segment1),
coalesce(b.Segment2, c.Segment2)
From NinjaTable a
Left Join ShinobiTable b On b.AssociateName = a.AssociateName and b.AssignmentStatus = 'Active'
Left Join ShinobiTable c On c.AssociateName = a.AssociateName and c.AssignmentStatus = 'Inactive'
"
5299,How to Program respond in Oracle REST Data Services,"begin
htp.p('your textual content as respond body');
end
"
18280,SQL phone number data correcting xxx-xxx-xxxx,"SELECT SUBSTRING(RIGHT(REPLACE(PhoneNumber,'-',''),10),1,3)+'-'
      +SUBSTRING(RIGHT(REPLACE(PhoneNumber,'-',''),10),4,3)+'-'
      +SUBSTRING(RIGHT(REPLACE(PhoneNumber,'-',''),10),7,4)         
"
19484,mySQL subquery slower than 2 seperate queries,"SELECT DISTINCT SUBSTRING( 6pp, 1, 4 ) AS postcode
FROM `6pp`
WHERE EXISTS (SELECT 1
              FROM tmp_orderimport oi
              WHERE oi.gebiedID = `6pp`.gemeenteID AND
                    typeGebied = 'Gemeente' AND idorder = 1733 AND STATUS = TRUE
             ); 
"
26860,SQL Group by Date Range,"select  min(date), max(date), code
from (select t.*,
             (row_number() over (order by date) -
              row_number() over (partition by code order by date)
             ) as grpid
      from followingdata t
     ) t
group by grpid, code;
"
6477,SQL return all id's from 1 table and only ones that don't match from another,"SELECT * FROM '#tmptable1' 
UNION ALL
SELECT * FROM  '#tmptable2' WHERE 
    ID NOT IN (SELECT ID FROM #tmptable1 WHERE ID IS NOT NULL)
"
5514,Heroku auto restore,"namespace :backup do
  desc ""copy the latest dump from a certain server to the DB of the current server""
  task restore_last_write_dump: :environment do
    last_dump_url = %x(heroku pgbackups:url --app [source_app_name])
    system(""heroku pgbackups:restore [DB_to_target_app] '#{last_dump_url}' -a [target_app_name] --confirm [target_app_name]"")
    puts ""Restored dump: #{last_dump_url}""
  end

end
"
29820,SQL Natural Join and use clause,"SELECT table1.data2
FROM table1 LEFT JOIN
     table2 
     on table1.nlm = table2.`#nlm`
WHERE table2.pid = 3;
"
36663,"Converting DateDiff(s, x, x) results to HH:MM","SELECT UserID,
First_NM,
Last_NM,
MgrName,
CONVERT(varchar(5),  DATEADD(minute, SUM(OnProd)/60, 0), 114) as OnProd,
CONVERT(varchar(5),  DATEADD(minute, SUM(OffProd)/60, 0), 114) as OffProd, 
CONVERT(varchar(5),  DATEADD(minute, SUM(OnProd+OffProd)/60, 0), 114) as SumProd FROM #ProdTmp Group By UserID, First_NM, Last_NM,  MgrName
"
1437,Making a Value Equal a Average value,"UPDATE scores AS s
JOIN (SELECT Player, AVG(kills) AS avkills
      FROM dem0n123
      GROUP BY Player) AS d
ON s.Player = d.Player
SET s.AverageKills = d.avkills
"
4750,"MySQL 1,000's of OR Statements (Good Idea?)","Select * from table where twitterid in (123,456,789,...)
"
25832,Update a foreign key by matching a column other than primary key in another table,"UPDATE Table_One SET FooID = 
    (SELECT FooID FROM Table_Two WHERE Description = 'Bar')
    WHERE Primary_ID = 3;
"
7602,Unix shell script run SQL scripts in parallel,"  sqlplus user1/pw @/home/scripts/tst1.sql
  sqlplus user1/pw @/home/scripts/tst2.sql &
  pid2=$!
  sqlplus user1/pw @/home/scripts/tst3.sql &
  pid3=$!
  # pseudo-code:
  # while (`ps -p""$pid2,$pid3"" | wc -l` != ""1"");
  sqlplus user1/pw @/home/scripts/tst4.sql
"
33048,Lookup two columns using SQL,"select count(*) from mytable t1
where not exists (
    select 1 from mytable t2
    where t2.id = t1.id
    and t2.name = t1.name
)
"
14856,Unexpected query results with multiple joins - mysql,"SELECT p.PurchActvtyID, a1.name AS billName, a1.address1 AS billAddress1, a2.name AS shipName, a2.address1 AS shipAddress1
FROM arrc_PurchaseActivity p
LEFT OUTER JOIN jos_customers_addresses a1 ON p.AcctID = a1.customer_id
LEFT OUTER JOIN jos_customers_addresses a2 ON p.ShipAddrID = a2.id
GROUP BY p.PurchActvtyID
ORDER BY p.PurchActvtyID ASC
"
27009,What are best practices for multi-language database design?,"Table ""Product"":
----------------
ID                 : int
<any other language-neutral fields>


Table ""ProductTranslations""
---------------------------
ID                 : int      (foreign key referencing the Product)
Language           : varchar  (e.g. ""en-US"", ""de-CH"")
IsDefault          : bit
ProductDescription : nvarchar
<any other localized data>
"
23098,Assign Rank to each row based on the type of row SQL,"select sequence , Type, Value,
       row_number() over(partition by Type order by sequence) As [Rank] 
From yourtable
"
38243,"SQL CASE, when column category = x group by category else don't group","SELECT category, date, client
FROM events
WHERE category <> 'bar'
UNION ALL
SELECT category, date, MIN(client) AS client
FROM events
WHERE category = 'bar'
GROUP BY category, date;
"
2193,SQL Carriage Return,"SELECT 'Hi i'm a select' ||
       CHR(13) || -- CR 
       CHR(10) || -- LF
       'and i want to be your friend'
FROM   dual
"
11849,SELECT DISTINCT - access,"SELECT Count(*) AS UniqueMembers
FROM    (
            SELECT DISTINCT TransID 
            FROM TransactionTable 
            WHERE (TransactionTable.TranDate) Between [Enter the start date:] And [Enter the end date:]
        )  AS T;
"
11723,Combining 2 queries into 1 query,"SELECT b.oprid 
FROM   ps_z_emp_benft a, 
       psoprdefn b, 
       ps_z_emp_yan c 
WHERE  a.emplid = b.emplid 
       AND a.emplid = c.emplid 
       AND A.z_pend_cover = 'Y' 
       AND oprid LIKE 'ZZ%' 
       AND c.z_yan_action_id = 1 
"
19040,Access SQL return nth row for each given field,"select id, date, 
       (
          select count(date) 
          from table As t1 
          where t1.id = t.id
            and t1.date <= t.date
       ) As rowNum
from table As t
"
6707,SQL Server - Find Minimum Value by Minute within Day Grouped by Symbol,"select ii.*
from (select ii.*,
             row_number() over (partition by symbol, currdate 
                                order by prlow asc end) as seqnum
      from IntradayInput ii
     ) ii
where seqnum = 1;
"
10562,How to create a dummy value column in MySQL depending on the Table specific information was selected from?,"SELECT current_users.lastname, 
       current_users.firstname, 
       current_users.id, 
       new_users,lastname, 
       new_users.firstname, 
       new_users.id,
       CASE WHEN new_users.id IS NULL THEN 0 ELSE 1 END as dummy_column
"
27822,SQL SELECT column letter prefix,"SELECT 'A' + CAST(ID as VARCHAR(15))
FROM...
"
464,Table analysis in SQL,"Select TABLE_B.ID_C AS ID_C, BEFORE = 
  CASE TABLE_C.AB
    WHEN 'BEFORE' THEN TABLE_B.BEFORE*TABLE_C.WEIGHT_N
    ELSE TABLE_B.BEFORE
  END,
AFTER =
  CASE TABLE_C.AB 
    WHEN 'AFTER' THEN TABLE_B.AFTER*TABLE_C.WEIGHT_N
    ELSE TABLE_B.AFTER
  END
FROM (SELECT ID_C, AB, EXP(SUM(ln(WEIGHT_N))) FROM TABLE_A GROUP BY ID_C, AB) as TABLE_C
JOIN TABLE_B ON TABLE_B.ID_C=TABLE_C.ID_C;
"
3076,Need a count query in access but one column only needs unique values,"INSERT INTO tblCountResults (Activity, Name, CountOfActivity)
SELECT Activity, min(Name), Count(tblBaseResults.Activity)
FROM tblBaseResults
WHERE instr(Name, '?') = 0
GROUP BY Activity
"
21887,SQL: Getting maximum number of files download on which day,"select date(da_te), count(*)
from tablename
group by date(da_te)
order by count(*) desc
limit 1
"
3525,Loop through all the rows of a temp table and call a stored procedure for each row,"DECLARE @id int
DECLARE @pass varchar(100)

DECLARE cur CURSOR FOR SELECT Id, Password FROM @temp
OPEN cur

FETCH NEXT FROM cur INTO @id, @pass

WHILE @@FETCH_STATUS = 0 BEGIN
    EXEC mysp @id, @pass ... -- call your sp here
    FETCH NEXT FROM cur INTO @id, @pass
END

CLOSE cur    
DEALLOCATE cur
"
33885,SQL: Optimize insensive SELECTs on DateTime fields,"select i.id, i.name, s.execute_at
from items i
inner join scheduled_items s on s.item_id = i.id
left join reviewed_items r on r.scheduled_items_id = s.id
where r.id is null
"
26458,How do a write a left join with a where clause restricting the left-hand portion across multiple tables?,"SELECT A.field, A.otherfield, B.field, B.otherfield, C.yetanotherfield
FROM table_A AS A
JOIN table_B as B on A.id = B.a_id
JOIN table_C as C on B.id = C.b_id
WHERE ...
"
21122,concatenating Columns and displaying in oracle,"select First_name || Lower(Last_name) from table_name;
"
4201,Sql involving 3 tables,"DECLARE @Date datetime = CAST('2014-11-13' as datetime)

SELECT 1 Id
into #TimeIntervals

SELECT 1 Id, 1 TimeIntervalId
INTO #Breaks

SELECT 1 Id, 1 BreakId, CAST('2014-11-14' as datetime) as Date
into #DeletedBreaks

SELECT *
FROM #TimeIntervals ti
INNER JOIN #Breaks b on ti.Id = b.TimeIntervalId
LEFT JOIN #DeletedBreaks db on db.BreakId = b.Id AND Date = @Date
WHERE (db.Id is null)

DROP TABLE #TimeIntervals
DROP TABLE #Breaks
DROP TABLE #DeletedBreaks    
"
23798,SQL Statement That Will Get Table Schema And Created Date,"declare @SqlStatement varchar(max)
select @SqlStatement = COALESCE(@SqlStatement, '') + 'DROP TABLE [TMP].' + QUOTENAME(t.name) + ';' + CHAR(13)
from sys.tables t 
    join sys.schemas s on t.schema_id = s.schema_id 
where s.name = 'TMP'
    and t.create_date > dateadd(day,-1,getdate())
print @SqlStatement
"
32136,how do i get the number of members on status name,"SELECT COUNT(*)
FROM member inner join mmship
   ON member.member_Id = mmship.member_Id
   INNER JOIN mshipstatus
   ON mshipstatus.mshipstatus_Id = mmship.mshipstatus_Id
WHERE mshipstatus.mshipstatusname = 'prospective'
   AND MONTH(mmship.mmshipstart_date) = MONTH(GETDATE())
"
19387,mysql query cant order records as needed,"SELECT temp_table.* FROM
  (SELECT COUNT(*) as hit_counts, date
   FROM visits
   GROUP BY date) as temp_table
ORDER BY temp_table.date ASC
LIMIT 25
"
726,How to write query that will do unusual distinct select from sql table?,"SELECT
  CASE WHEN CHARINDEX('<', Message) = 0 THEN Message ELSE LEFT(Message, CHARINDEX('<', Message)-1)) END AS Message
FROM
  yourTable
GROUP BY
  CASE WHEN CHARINDEX('<', Message) = 0 THEN Message ELSE LEFT(Message, CHARINDEX('<', Message)-1)) END
"
12266,Selecting only rows that return a matching column value using CASE THEN,"SELECT [ART_NO],
       [QTY],
       [DUE_DATE],
       [make],
       [PRODUCT],[PRICE],[DETAIL],
       [COLOUR],[RS1],[RS2],[RS3],
       [RS4],[RS5],[RS6],[RS7],[RS8],
       [RS9],[RS10],[RS11],[RS12]
FROM   [DBKular].[dbo].[INVOISTK]
WHERE  make = 'BANER'
ORDER  BY [MAKE] ASC,
          [DUE_Date] 
"
39856,SQL Joins with one to many relationship - Combine the many into one row?,"SELECT pt.`id`, 
       group_concat(pr.`price` separator ',') 
  FROM `products` AS PT  
  LEFT JOIN `prices` PR ON PR.`product` = PT.`ID`
  GROUP BY pt.`id`
"
22722,Powershell + Visio Creating a Crow's nest diagram?,"$x = 1
$y = 0.3
$Increment = 0.5
For ($i=1; $i -lt 5; $i++)  {
    $attr=  $page.DropIntoList($AttributeShape,$shape1,1)
    $attr.Text = (""Col Name "" + $i)
    $y = $y - $Increment
}
"
32829,How to use select statement insted of update,"Select   (CASE Range 
          WHEN  'M' THEN 'Medium'
          WHEN  'H' THEN 'High'
         WHEN   'L' THEN 'Low'
         end ) as Range from TableName
"
37510,"How to return a list of results in MySQL, WHERE only return one","select title from sakila.film f 
join sakila.film_actor fa on fa.film_id = f.film_id
where fa.actor_id = @id
"
27991,sql query by passing te values in one table,"SELECT TableA.EMPLOYEEID, SKILLSETCODE,CERTID, LASTNAME, FIRSTNAME, MIDDLEINITIAL 
FROM TableA, TableB
WHERE TableA.EMPLOYEEID = TableB.employeeid 
and TableB.key_user='249'
"
30753,JPQL query: use ORDER BY case insensitively,"List<Object[]> results = entityManager().createQuery(""SELECT o, LOWER(o.name) AS nameInOrder FROM UserGroup o ORDER BY nameInOrder ASC"", UserGroup.class).getResultList();
List<UserGroup> userGroups = new ArrayList<UserGroup>();
for(Object[] result : results) {
    userGroups.add( result[0] );
}
return userGroups;
"
25514,Oracle sql query with all mandatory values in where condition,"with emp_ids as (
   select 7521 as eid from dual
   union all 
   select 7566 from dual
   union all
   select 7698 from dual
)
select * 
from (
  select emp.*, 
         count(*) over() as cnt
  from emp_new emp
  where empid in (select eid from emp_ids)
)
where cnt = (select count(*) from emp_ids);
"
1957,Insert timestamp into a database + 7 days,"registration_expires=DATE_ADD(NOW(), INTERVAL 7 DAY)
"
24476,How can I replace a value within a Sql Select which returns multiple rows?,"CASE WHEN [Column] is Null then 'N/A'
"
7071,parse text file and remove white space,"s.Replace(""null"", string.Empty).Replace("" |"", ""|"").Replace(""| "", ""|"").Replace(""| |"", ""||"");
"
13717,SQL Like function for Uppercase letters with or without a dash,"WHERE  ItemCode NOT LIKE '%[^-A-Z0-9]%' Collate Latin1_General_Bin
"
36502,Show whole text in query result in mysql,"mysql> select external_password from login_user WHERE user_name = 'abc@123'\G
"
4003,issue with top 10 distinct values from multiple tables,"SELECT
  documentname,
  user,
  accesscount
  --and other columns
FROM
(
    SELECT 
      documentname,
      user,
      accesscount
      --and other columns
    FROM
      txn_jan

    UNION ALL

    SELECT 
      documentname,
      user,
      accesscount
      --and other columns
    FROM
      txn_feb

    --and other monthly summary tables

) yearly_summary
"
20091,VBA Select Query into String for use with automatic population of web page form,"Dim rs As DAO.Recordset
Set rs = dbs.OpenRecordset(strSQL)

Do Until rs.EOF = True
        OrderString = OrderString & rs!FieldName & vbCrLf
        rs.MoveNext
Loop
"
10775,Select fields from different tables in SQL without a need of matching fields,"SELECT mytable.mytable_id, yourtable.bar FROM mytable, yourtable ORDER BY RAND() LIMIT 2
"
3480,Select filtered records from a table with composite primary key,";WITH CTE AS(
    SELECT *,
        Y = SUM(CASE WHEN Actioned = 'YES' THEN 1 ELSE 0 END) OVER(PARTITION BY TeamName, ProjectCode),
        N = SUM(CASE WHEN Actioned = 'NO' THEN 1 ELSE 0 END) OVER(PARTITION BY TeamName, ProjectCode)
    FROM tbl
)
SELECT 
    TeamName, ProjectCode, Actioned
FROM CTE
WHERE
    (Y = 1 AND Actioned = 'Yes')
    OR (Y = 0)
"
4505,Date difference between first and last book per each author,"SELECT authors.author_id,
       max(name.first_name||' '||name.last_name) as full_name,
       max(to_char(yearpub,'yyyy')) - min(to_char(yearpub,'yyyy')) as  years
from author_name name, books,authors
where
      authors.author_id = name.author_id and
      authors.author_id = books.author_id and
      authors.book_id = books.book_id
group by authors.author_id
"
12742,grails displaying values from two tables using primary and foreign keys,"class TestExecQueue {
    static mapping = {
        scenario column:'test_scenario_id'
    }

    TestScenario scenario
}
"
6976,Multiple Count based on value MYSQL,"SELECT
SUM(IF (AlarmType = '1',Count,0)) as  AlarmType1,
SUM(IF (AlarmType = '2',Count,0)) as  AlarmType2,
SUM(IF (AlarmType = '3',Count,0)) as  AlarmType3,
AlarmHour
FROM 'Table1'
GROUP BY Time
"
29187,Can i append some country and city code in mongodb unique object id?,"db.<your collection>.createIndex({ country: 1, city: 1 })
"
25018,How to use a value of cell as a SELECT param in SQL SERVER,"DECLARE @SQL VARCHAR(MAX), @LAN_COLUMN VARCHAR(25)

SELECT @LAN_COLUMN = Language
FROM TextLang
JOIN Users ON Users.Id='11'
WHERE Key = '000'

SELECT @SQL = 
'Select '+@LAN_COLUMN+' FROM TextLang '
+' JOIN Users ON Users.Id=''11'''
+' WHERE Key = ''000'''

EXEC(@SQL)
"
973,Select count group by another count (My)SQL,"SELECT redCount, COUNT(*)
FROM (SELECT user_id, COUNT(color) as redCount
      FROM cars
      WHERE color = 'red'
      GROUP BY user_id
     ) uc
GROUP BY redCount;
"
3239,"GROUP BY, show MIN","SELECT title, MIN(date)
FROM financials
GROUP BY title
ORDER BY title
"
13379,nested Cursor TSQL (SQL Server),"-- INSERT INTO ##FlanschZuweisung (IDFZ, FL1, FL2)
SELECT row_number() over (order by t1.FlanschMin, t2. FlanschMin),
   t1.FlanschMin, t2. FlanschMin
FROM ##FlanschBreite as t1 CROSS JOIN ##FlanschBreite as t2
"
10393,SQL Nested Multiple Select Statement,"SELECT 
  limit, 
  SUM(CASE WHEN year=2013 THEN amount ELSE 0 END) amountN,
  SUM(CASE WHEN year=2014 THEN amount ELSE 0 END) amountN1
FROM myTable
GROUP BY limit
ORDER BY limit;
"
31331,Combining data from one table in Oracle,"SELECT contract,
       COALESCE(receipt_city, delivery_city, '') ""City"",
       LISTAGG(CASE WHEN receipt_city IS NOT NULL THEN 'Receipt' END ||
               CASE WHEN delivery_city IS NOT NULL THEN 'Delivery' END,
              ' ') 
                 WITHIN GROUP (ORDER BY contract) ""Direction""
FROM test_list
GROUP BY contract, COALESCE(receipt_city, delivery_city, '');
"
8175,Getting highest results in a JOIN,"SELECT a.id, a.title, ab.bid_points, u.display_name 
FROM Auction AS a
INNER JOIN (SELECT auction_id, MAX(bid_points) AS maxAmount FROM auction_bids GROUP BY auction_id) AS maxBids ON maxBids.auction_id = a.id
INNER JOIN auction_bids AS ab ON a.id = ab.auction_id
INNER JOIN users AS u ON u.id = ab.user_id
WHERE ab.auction_id = maxBids.auction_id AND ab.bid_amount = maxBids.maxAmount
"
35256,"Django sql query,'__startswith date and time'","Mpool.objects.filter(date__gte=start_date, date__lte=end_date)
"
8388,SQL count different jobs in each departmen,"SELECT DEPARTMENT_ID, substr(DEPARTMENT_NAME, 0, 15), 
substr(NVL(CITY, 'Not Assigned Yet'), 0, 20) ""City"", 
COUNT(DISTINCT JOB_ID) ""# of Jobs""
FROM EMPLOYEES
LEFT OUTER JOIN DEPARTMENTS
USING(DEPARTMENT_ID)
LEFT OUTER JOIN LOCATIONS
USING(LOCATION_ID)
GROUP BY DEPARTMENT_ID, DEPARTMENT_NAME, CITY
"
28608,Find all records that match a GROUP BY result HAVING count > 1 in SQLite,"SELECT * 
FROM transactions t JOIN 
(
  SELECT date, account, amount
    FROM transactions
   GROUP BY date, account, amount
  HAVING COUNT(*) > 1
) d
  ON (t.date = d.date
 AND t.account = d.account
 AND t.amount = d.amount) OR
     (t.date = d.date
 AND t.account IS NULL AND d.account IS NULL
 AND t.amount = d.amount)
"
17161,Select where column not in an other one 2 times,"SELECT * FROM table WHERE id NOT IN 
(SELECT c2 FROM table GROUP BY c2 HAVING Count(c2) = 2)
"
14657,I can' t access to column that is added afterward by me. What should I do?,"public void onCreate(SQLiteDatabase db) {
     db.execSQL(""CREATE TABLE "" + ""sorular""
             + "" (_id INTEGER PRIMARY KEY AUTO_INCREMENT,""
             + ""soruIcerik TEXT,"" + "" siklar1 TEXT,"" + "" siklar2 TEXT,""
             + "" siklar3 TEXT,"" + ""siklar4 TEXT,"" + "" zorluk INTEGER"" + ""cevap INTEGER);"");
}
"
18301,Best way to create a temp table with same columns and type as a permanent table,"select top 0 *
into #mytemptable
from myrealtable
"
17329,"Fetch unread messages, by user","SELECT id, message
FROM messages
LEFT JOIN messages_read
    ON messages_read.message_id = messages.id
    AND messages_read.[user_id] = @user_id
WHERE
    messages_read.message_id IS NULL
"
32510,"Saving running total to database every other week or so, in rails?","task :scheduler_every_monday => :environment do
  # update stuff
end
"
36365,SQL Server return multiple queries in a single query,"SELECT
TOP 1 
'Text' AS Type,
Text
FROM
your_table
ORDER BY Date DESC
UNION ALL
SELECT
TOP 1 
'ImagePath',
ImagePath
FROM
your_table
ORDER BY Date DESC
UNION ALL
SELECT
'Title', 
TOP 1 Title
FROM
your_table
ORDER BY Date DESC
"
11214,Transact-SQL: How do I tokenize a string?,"SELECT t.*
FROM atable t
  INNER JOIN dbo.Split(@UserInput, ' ') s ON t.Name LIKE '%' + s.Data + '%'
"
13162,Joining four tables with MySQL and get values from two of them,"SELECT 
  q.quote_ENG,
  a.author
FROM QuotesByTopic  AS qt 
INNER JOIN TopicMap AS t ON qt.topicmap_id = t.topicmap_id
INNER JOIN Quotes   AS q ON qt.quotes_id   = q.quotes_id
INNER JOIN Authors  AS a ON a.author_id    = q.author_id
WHERE t.topics_ENG = 'age'
"
15651,How to calculate derived attributes for dates in CREATE TABLE query. - MySQL,"CREATE TABLE Warranty(
    Warranty_ID     varchar(5),
    Begin_Date      date,
    End_Date        date,
    Terms           varchar(15),
    Primary Key (Warranty_ID));

CREATE VIEW vw_Warranty AS
SELECT
    Warranty_ID,
    Begin_Date,
    End_Date,
    Terms,
    IF(CURDATE() BETWEEN Begin_Date AND End_date, 'valid', 'not valid') as IS_Valid;
"
32060,"Am I being thick? MySQL: ""Not unique table/alias"" on LEFT JOIN","/* If SuppliersStock is a different table */
SELECT Stock.BuyingPrice, SuppliersStock.StockID, SuppliersStock.Quantity
FROM Stock
LEFT JOIN SuppliersStock on Stock.StockID = SuppliersStock.StockID 
WHERE Stock.StockID = <some-integer />

/* If SuppliersStock is the same table, needing an alias */
SELECT Stock.BuyingPrice, SuppliersStock.StockID, SuppliersStock.Quantity
FROM Stock
LEFT JOIN Stock AS SuppliersStock on Stock.StockID = SuppliersStock.StockID 
WHERE Stock.StockID = <some-integer />
"
1120,GROUP_CONCAT is showing all recored,"GROUP BY  user_messages.messageid,
          user_messages.message,
          user_messages.sentby,
          user_messages.visibility
"
28522,Join several times,"SELECT * FROM
(
    (SELECT * FROM table WHERE something = 1) a,
    (SELECT * FROM table WHERE something = 2) b,
    (SELECT * FROM table WHERE something = 3) c
)
"
25493,Conversion of Data Type in column of migration table,"change_column :attendances, :logout_time, :datetime
"
18756,SQL Server: Retrieve rows where the Prod Num is like a string found in a different table?,"SELECT *
FROM Sales S
  JOIN temp t ON s.pn like t.pn + '%'
"
22230,"How to convert Oracle ""TIME"" to JDBC Time in query?","String sql = ""Select to_date('1970-01-01 ' || ? ,'YYYY-MM-DD HH24:MI:SS) as MY_TIME from dual"";
Connection conn = null; //get Connection from somewhere
PreparedStatement stmt = conn.prepareStatement(sql);
stmt.setString(1, ""16:31:59"");
ResultSet rs = stmt.executeQuery();
rs.next(); //get to first element of result set;
java.sql.Time myTime = rs.getTime(1);
"
8017,How to use subselection result as temp table in MySQL update query?,"UPDATE tableA AS a
JOIN (select uid, uname
    from tableC 
    left join tableD on tableC.pid = tableD.pid and tableC.qid = tableD.qid
    group by uid) AS b ON a.uid = b.uid
SET a.uname = b.uname
"
34761,mysql join ON and AND to laravel eloquent,"$query = Person::leftJoin('actions', function($q) use ($user)
        {
            $q->on('actions.person_id', '=', 'persons.id')
                ->where('actions.user_id', '=', ""$user"");
        })
        ->groupBy('persons.id')
        ->where('type', 'foo')
        ->get(['persons.id', 'full_name', DB::raw('count(actions.id) as total')]);
"
1178,SQL Join to count based on query results,"SELECT master.description, sites.description, sites.site_id 
       ,count(order_id) order_count 
FROM sites sites
INNER JOIN sites master 
  ON sites.parent_id = master.site_id
LEFT JOIN orders o
ON master.site_id = o.Site_id
   and   o.order_date > '2015-10'
WHERE
       sites.site_type = 3 
GROUP by
 master.description, sites.description, sites.site_id 
"
20647,PyQt Get cell from TableView with header label,"def columnFromLabel(self, label):
    model = self.table.horizontalHeader().model()
    for column in range(model.columnCount()):
        if model.headerData(column, QtCore.Qt.Horizontal) == label:
            return column
    return -1
"
6022,SQL parameterization: How does this work behind the scenes?,"exec sp_executesql N'INSERT INTO Test (Col1) VALUES (@p0)',N'@p0 nvarchar(4000)',@p0=N'p1'
"
22328,SQL Query for avoiding any repetition for a specific column terms,";WITH x AS 
(
    SELECT id,bank_code,bank_name,interest_rate,
      rn = ROW_NUMBER() OVER (PARTITION BY bank_code ORDER BY interest_rate DESC)
    FROM dbo.[SAMPLE]
)
SELECT id,bank_code,bank_name,interest_rate
FROM x WHERE rn = 1
ORDER BY interest_rate DESC;
"
24070,Select into tables in SQL. How are they stored?,"CREATE TEMP TABLE tbl AS
SELECT a.run_uid, s.object_uid
FROM   dt.table_run_group a 
JOIN   dt.table_segment   s ON a.group_uid = s.object_uid;
"
32657,Joining tables with references to each other,"SELECT A.aID, B.bID
FROM A
LEFT OUTER JOIN B ON A.aID=B.aID -- We are not guaranteed to have B for each A
LEFT OUTER JOIN C ON C.aID=A.aID AND (C.bID IS NULL OR C.bID=B.bID)
WHERE C.cID IS NULL
"
9172,SQL - Date range Return all data,"Select emp_id,emp_name,Date1,(
CASE WHEN EXISTS(
sELECT emp_id FROM timesheet_tran AT WHERE T.emp_id =AT.emp_id AND T.date1=AT.date
) then 'Present' Else 'Absent' End )as Status
FROM
(
Select emp_id ,emp_name,Cast(date as DATE)AS DATE1 from emp_master a,(Select Distinct date    from timesheet_tran ) b
) T
"
29868,How to check for a duplicate value before inserting with SQL,"Dim strSQL As String = ""If Not Exists ("" & _
             ""Select * From tblDetail ""  & _
             ""Where PersonId = "" & strPersonID & "")"" & _
    ""INSERT INTO tblDetail VALUES('"" & strPersonID _   
         & ""','"" & strForename & ""','"" & strSurname & 
         ""','"" & strDateOfBirth & ""',"" &
          strCurrentlyWith & "",'"" & strConditions & ""')"" 
"
4635,Creating a feed (following) grouped by day and user that is ordered by most recent on ruby on rails,"current_user_id = current_user.id

Photo.select(%q{
  user_id, 
  COUNT(*) no_photos, 
  date_trunc('day', created_at::timestamp) as what_day
}).group(""what_day, user_id"").order(""what_day DESC"").where(%Q{
  user_id IN (
    (SELECT followable_id FROM follows where follower_id = #{current_user_id})
    UNION ALL
    (SELECT #{current_user_id} as followable_id)
  )
})
"
29006,Selecting range of records with MySql,"SELECT  @curRow := @curRow + 1 AS row_number,
    myTable.id
FROM myTable  LIMIT 5 OFFSET 6;
"
21640,Link one table to another through two columns in SQL,"select
  name, attribute
from
  users inner join attributes
  on users.qualification in (attributes.qual1, attributes.qual2)
group by attribute, name
having count(*)=2
"
3694,Query for sum of column values not giving me a value,"Update Product Set Value2 = Value1 + Value2 
Where ProductId = @Parameter
"
18262,SQL Nested Aggregation,"select count(40b1) as 40b1,
       count(40b2) as 40b2,
       count(40b1) + count(40b2) as sum,
       code/100 as code 
from     parta 
where  40b1=true and mandays>=1000
group by code/100 ;
"
10040,order by not formatted date sqlite,"select 
  substr(reversed_date, 7,4) || '-' || 
  substr(reversed_date, 4, 2)|| '-' ||
  substr(reversed_date, 1, 2) as proper_date
  from (
    select '12-03-2000' as reversed_date
  )
;
"
20177,Selecting users with criteria from second table,"SELECT u.id
FROM users as u
INNER JOIN users_info as ui
ON u.id = ui.user_id
WHERE profile_image is not null
"
3048,Sql Counting rows for two columns where col1 same as col2,"SELECT * FROM
  (SELECT Data1, COUNT(Data1) FROM Table GROUP BY Data1) d1
  JOIN (SELECT Data2, COUNT(Data2) FROM Table GROUP BY Data2 ORDER BY Data2) d2
    ON d1.Data1 = d2.Data2
  ORDER BY d1.Data1;
"
6149,T-SQL query to check number of existences,"RETURN ISNULL((SELECT 1
    WHERE
        EXISTS
        (
            SELECT 1
            FROM [accounts] AS A, [currency_types] AS CT
            WHERE
                A.[owner_id] = @client 
            AND A.[currency_id] = CT.[ID]
            AND CT.[name] != N'Ruble'

        )
    ), 0)
"
30156,SQL query select message prints itself,"SELECT 
'title in DB: ' || name as Name
FROM subject;
"
23028,Convert Column Heading to row data - sql,"SELECT 
   CASE Region 
    WHEN 1 THEN 'North'
    WHEN 2 THEN 'South' 
    WHEN 3 THEN 'West'
    WHEN 4 THEN 'East'
    WHEN 5 THEN 'Central' END AS Region  
    , COUNT(ID)   --or your primary key if it is different
FROM ATM
WHERE ATMStatus = 0 AND Bank = 1
GROUP BY Region
"
26658,SQL auto-cleanup with 0..1:1..n tables in MySQL,"DELETE tableA
FROM tableA LEFT JOIN tableB B ON A.id = B.a_id
WHERE B.a_id IS NULL;
"
30593,Constraint on multiple columns,"ALTER TABLE <your_table>
  ADD CONSTRAINT TWO_FILLED
  CHECK(NVL2(F_NAME, 1, 0) + NVL2(L_NAME, 1, 0) + NVL2(BIRTH_DATE, 1, 0) >= 2);
"
38561,SQL trigger - Always update or conditionally,"CREATE TRIGGER [UserSync]
ON [dbo].[Import]
FOR UPDATE
AS
BEGIN
  UPDATE UserLogin
  SET Password = i.password
  from UserLogon u
  inner join inserted i on i.Name = u.Name
  inner join deleted d on d.Name = i.Name
  WHERE i.password <> u.password
END
"
13205,SQL Count occurrence of a value,"select StudentId
from course_list
where CourseId = @CourseId
group by StudentId
having count(uid) > @MaxCount
"
18460,Run a query based on output of another query,"SELECT   XX,  
     CASE 
     WHEN Y =  1 THEN (Select X from table2 where xx= )
     WHEN Y = 2 THEN  (Select X from table3 where xx=)
  END 
   FROM table1
"
23347,Cannot insert into field with primary key constraint in PostgreSQL,"insert into teams (team_id,team_name)  
select distinct on (team_id) team_id, team_name
from rawtable
order by team_id;
"
2051,Logically Impossible to fetch this particular string.?,"jim@debian:~/tmp$ egrep -o ""[a-zA-Z]{2}[a-zA-Z0-9]{9}[0-9]{1}"" tmp
IT0004889033
DE000A1H36U5
XS0820547742
"
38897,"What's the best way to have a ""repeating field"" in SQL?","ALTER TABLE t ADD CONSTRAINT CH_ITEM1_LESSTHAN_ITEM2 CHECK (item_id_1 < item_id_2)
"
10876,Cannot perform aggreagate function on an expression,"SELECT field1,
       (SELECT COUNT(*) FROM yy Where zz AND t.value = xx ) as field2
FROM xx t
GROUP BY field1;
"
37476,PostgreSQL right join with group by,"select users.id,count(login_log.user_id)
from login_log
right join users on login_log.user_id=users.id 
group by users.id 
"
23344,"What kind of information should I store on the device, versus requesting via the web?","regarding single vs multiple requests:
"
5842,get duplicated fields and these fields may have spaces in mysql database,"SELECT * FROM users WHERE phone REGEXP ""\r\n"";
"
23241,Multiple Rows in to One Row,"SELECT NAME, 
       phase, 
       a_plan, 
       Max(a_actual), 
       b_plan, 
       Max(b_actual), 
       c_plan, 
       Max(c_actual) 
FROM   table 
GROUP  BY NAME, 
          phase, 
          a_plan, 
          b_plan, 
          c_plan
/
"
16200,Match similar zip codes,"test=# SELECT levenshtein('GUMBO', 'GAMBOL');
 levenshtein
-------------
           2
(1 row)
"
29738,Sum different row in column based on second column value,"SELECT
  SalesPersonId,
  SUM(
    CASE CurrencyID
      WHEN 1 THEN SaleAmount
      ELSE 0
    END
  ) AS TotalCAD,
  SUM(
    CASE CurrencyID
      WHEN 2 THEN SaleAmount
      ELSE 0
    END
  ) AS TotalUSD
FROM Orders
GROUP BY SalesPersonId
"
19801,PIVOT TABLE - That gets the grand total for the month,"select [month], sum([load]) as GrandTotal,
       sum( case when [onpeak] =0 then [load] end) as OnPeakTotalLoad,
       sum( case when [onpeak] =1 then [load] end) as OffPeakTotalLoad,
       max( case when [onpeak] =0 then [load] end) as OnPeakMaxLoad,
       max( case when [onpeak] =1 then [load] end) as OffPeakMaxLoad
from ReadingMonthPeak
group by [month]
order by [month]
"
22748,Age Calculations,"case when date_of_birth > p_some_year then 0
     else floor(abs(months_between(to_date('31-JAN-14','DD-MON-YY'),DATE_OF_BIRTH )/12))
end as age
"
36661,Oracle SQL Query for Stacked Pareto Chart,"select category, series, CntS 
from (
  select  distinct count(category) over (partition by category) cntC,
   count(series)  over (partition by category, series ) cntS,
   category, series 
from fruit   ) Tab
order by CntC desc, cntS desc; 
"
8575,Do we need a JOIN for this SQL statement?,"SELECT p.* 
FROM tbl_projekte p
INNER JOIN tbl_kunden k on k.uid = p.kunden_id
WHERE p.werbemittel ='12' 
ORDER BY k.kunden_name ASC
"
11474,why nr  bs + br for block transfer in worst case Nested-Loop Join?,"Total blocks of R = B(R)
Total tuples in R = N(R)
Total blocks of S = B(S)

R X S is done.
"
12819,"MySQL: If select in table X is empty, do select in table Y","SELECT IF(tableY.user_id IS NULL, tableX.id, tableY.user_id) AS id
    IF(tableY.user_id IS NULL, tableX.field2, tableY.other_field2) AS field2,
    etc
FROM (SELECT 1 AS dummy) a
LEFT OUTER JOIN tableY ON tableY.user_id = 1
LEFT OUTER JOIN tableX ON tableX.id = 1
"
24179,how to add percentages and insert the result into different table," insert into Transaction Set 
 Trans_id = your_transaction_id ,
 Buying_ID = (select (rate + (3*Rate)/100) as ratepos from Currency 
              where currency_code = 'euro'),
 Selling_ID = (select (rate - (3*Rate)/100) as rateneg from Currency 
               where currency_code = 'euro' )
"
29250,Track what an SQL-query actually does (insert/update/delete) in Oracle,"create table foo (
    bar int
)

insert into foo
output inserted.*
values (1)

update foo
set bar = bar + 1
output deleted.*, inserted.*

delete
from foo
output deleted.*
"
38624,Opening Hours Database Design,"CREATE TRIGGER [dbo].[mytable_iutrig] on [mytable] FOR INSERT, UPDATE AS

IF (SELECT COUNT(*)
FROM inserted, mytable
WHERE (inserted.startdate < mytable.enddate 
          AND inserted.startdate > mytable.startdate)
      OR (inserted.enddate < mytable.enddate 
          AND inserted.enddate > mytable.startdate)) > 0 
BEGIN
    RAISERROR --error number
    ROLLBACK TRANSACTION
END
"
38170,My MS Access control displays no text for appended items following an append query," <Me or form/subform name>.CodeCombo.Requery
"
9553,Using If/Then/Else in a stored procedure in SQL Server 2008,"AND (@MyRole IS NULL OR ROLE_ID = @MyRole)
AND (@MyFunction IS NULL OR FUNCTION_ID = @MyFunction)
"
8376,Inverting foreign key effectivly with SQL,"CREATE INDEX husband_id_index ON wife (husband_id);
REINDEX INDEX alt_md_index; -- not sure if this isn't required
"
23967,SQl Update from table of random Names,"update
TestNames left join 
(select ID,
floor(1+(rand()*600)) as rndid
from TestNames) as TN on TN.ID=TestNames.id
left join rndnames on TN.rndid=rndnames.id
set TestNames.fname=rndnames.FirstName,TestNames.lname=rndnames.LastName
"
15518,How to make an SSRS parameter = a field from another dataset,"select Customer, Name, BillAddress, BillCity, BillState, BillZip 
from ARCM where ARCM.Customer IN (
select Customer 
from ARBH
Where Invoice = @Invoice) and ARCM.CustGroup = 1
"
5466,Query Sum of the column based on query from another table,"SELECT SUM(dtl_erc_upd.quantity) AS project_count 
FROM dtl_erc_upd 
INNER JOIN project 
ON project.project_name = dtl_erc_upd.project_name 
"
8495,Writing a function in SQL to loop through a date range in a UDF,"select dhcp.singleday(a::date, a::date + 1)
from generate_series(
    '2012-11-24'::date,
    '2012-12-03',
    '1 day'
) s(a)
"
15084,Adding value to my Parse Table in Swift,"let myClass = PFObject(className: ""Testing"")

for (var i = 0 ; i <= 10 ; i++){
    myClass[""column\(i)""] = ""\(i)""
}

myClass.saveInBackground()
"
5605,ON clause variables order - optimisation,"SELECT * FROM table1 JOIN table2 ON (table1.c1 = table2.c1)
"
2922,SQL select record for each id where max year equals value,"SELECT members.member_id, MAX(pr.expiry_year)
FROM members m inner join
     payment_records pr
     on m.member_id = pr.member_id
WHERE m.member_category = 'Standard'
GROUP BY m.member_id
HAVING MAX(pr.expiry_year) = $year;
"
34306,"Select row which has all five under it in the ""tree""","select p.article_id
from Article a
inner join Structure s on s.article_above_id = article_id
inner join Article p on p.article_id = s.article_id
where a.article_number in (3,7,45,186,203)
group by p.article_id
having count(*) = 5
"
7497,SQL returning full objects (*) from distincted columns,"SELECT *
FROM (
    SELECT 
        *, ROW_NUMBER() OVER (PARTITION BY mt.column1, mt.column2, mt.column3 ORDER BY mt.column1, mt.column2, mt.column3) As Seq
    FROM 
        MyTable mt) AS DT
WHERE
    Seq = 1;
"
17330,Update Trigger without using a Cursor,"select i.emp_id,
  case when i.foo <> d.foo then ',foo' else '' end +
  case when i.bar <> d.bar then ',bar' else '' end as changedcolumns
  from inserted as i inner join
    deleted as d on d.emp_id = i.emp_id
"
4735,Why does a LIKE query in Access not return any records?,"SELECT * FROM MyTable WHERE [_Items] LIKE '%SPI%' 
"
11619,Selecting * from max id when grouping by parentid (MySQL),"select
t1.*
from aTable t1,
(select parentid, max(id) as id
 from aTable group by parentid) t2
where t1.id = t2.id
and t1.parentid = t2.parentid
"
16865,How to delete rows on table when date column is already past 2 days?,"DELETE o
FROM orders o
WHERE date_received <= date_sub(current_date, interval 2 day) and
      status = 0;
"
26328,"SQL Server, sort on two columnsfirst asc sort,second asc or desc based on the first odd-even","SELECT *
FROM tbl
ORDER BY
    FirstField,
    CASE 
        WHEN FirstField % 2 = 0 THEN -1 * SecondField
        ELSE SecondField
    END
"
5515,delete duplicate record from same table in mysql,"DELETE  c1
FROM    tblm_customer c1
        , tblm_customer c2
WHERE   c1.FirstName = c2.FirstName 
        AND c1.LastName = c2.LastName 
        AND c1.CustomerID < c2.CustomerID 
"
14255,PostgreSQL - SELECT duplicate data depending on 3 columns,"SELECT config ->>'external_http_port' AS external_http_port, 
       config->> 'external_host' AS external_host, 
       config-> 'snapshots'->> 'jpg' AS snapshots,
       count(*) 
FROM cameras  
GROUP BY config->>'external_http_port', config->> 'external_host', config-> 'snapshots'->> 'jpg' 
HAVING count(*) > 1;
"
28407,SQL select by a given time past the hour,"SELECT FROM table WHERE EXTRACT(MINUTE FROM TIMESTAMP field) = 30;
"
1980,Alter Primary key constraint,"ALTER TABLE <Table_Name>
DROP CONSTRAINT <constraint_name>

ALTER TABLE <Table_Name>
ADD CONSTRAINT <constraint_name> PRIMARY KEY (<Column1>,<Column2>)
"
25380,"Firstname, middlename and lastname MS SQL","SELECT  picture,person_id,   firstname+ ' ' +middlename+ ' ' +lastname AS fullName
FROM    PERSON
WHERE   (firstname+ ' ' + LTRIM(middlename + ' ') + lastname LIKE""%#queryString#%"")
"
34231,SQL Server : multiple foreign keys from first table linking to the primary key of second table,"SELECT
   Item1 = i1.item_name,    
   Item2 = i2.item_name,
   Item3 = i3.item_name,
   Item4 = i4.item_name
FROM
   itemrequest_table ir
INNER JOIN
   item_table i1 ON ir.item1 = i1.item_no
INNER JOIN
   item_table i2 ON ir.item2 = i2.item_no
INNER JOI
   item_table i3 ON ir.item3 = i3.item_no
INNER JOIN
   item_table i4 ON ir.item4 = i4.item_no       
"
16407,delete zero index of list view which populated from database Andriod,"//---deletes a particular entry---
public int deleteEntry(String id) 
{
    SQLiteDatabase db = dbHelper.getWritableDatabase();
    return db.delete(""TIME"", ""ID = "" + id, null) ;
}
"
20575,Extract first entry for each person for each day," select [date], agentname, [exception], [start], [stop]
 from table1 t
 inner join
 (
    select [date], agentname, min([start]) as [start]
    from table1
    group by [date], agentname
 ) X
 on t.[date] = x.[date] and t.agentname = x.agentname and t.[start] = x.[start]
"
31723,How Do I Count Unique Rows In Sql Vb.Net,"Using con = new MySqlConnection(....)
Using cmd = new MySqlCommand(""select product, Sum(amount) from tableName GROUP BY product"", con)
   con.Open()
   Dim dt = new DataTable()
   Using dr = cmd.ExecuteReader()
      dt.Load(dr)
      dataGridView.DataSource = dt
   End Using
End Using
End Using
"
8755,"Modifying column value according to status, and adding extra rows. (sql)","SELECT  name,
        CASE WHEN status = 'true' 
            THEN 'available' 
            ELSE 'not available' 
        END status
FROM    tableName
"
33512,Map 2 columns to 2 rows in 1 column?,"SELECT stuff, sender_id
    , (SELECT name FROM table2 WHERE id = sender_id) AS sender_name
    , recipient_id
    , (SELECT name FROM table2 WHERE id = recipient_id) AS recipient_name
FROM table1;
"
37292,"How can I produce rows that sum subgroups of rows, without grouping?","CREATE TABLE tab(id INT , income INT , expenses INT);

INSERT INTO tab(id, income, expenses)
VALUES (1, 1000, 200),(1, 2000, 400),(2, 500, 200),(2, 100, 60)


SELECT id,
       [income]         = SUM(income),
       [expenses]       = SUM(expenses),
       [grouping_level] = GROUPING_ID(id, income, expenses) /* 0 - actual data , 3 - group based on column income, expenses*/
FROM tab
GROUP BY GROUPING SETS ((id), (id,income, expenses))
"
33071,SQL Ordering in MySQL,"SELECT   1 as OrderBy, *
FROM     users
WHERE    description = ""query""
UNION ALL
SELECT   2 as OrderBy, *
FROM     users
WHERE    description = ""%query%""
...
ORDER BY
         OrderBy
"
35168,DB2 select multi rows into one row,"SELECT UserID, AVG(Number) AS Average
FROM YourTable
GROUP BY UserID
"
1454,MySQL - Using COUNT and LIMIT functions together,"SELECT COUNT(sid) FROM
(
    SELECT sid FROM Labs LIMIT 2, 18446744073709551615
) T1
"
24509,How do we implement intersection and union in mysql?," select
    t1.sid
    from
    (SELECT DISTINCT C.sid FROM Catalog C, Parts P WHERE C.pid = P.pid AND P.color = 'red') t1
    inner join
    (SELECT DISTINCT C.sid FROM Catalog C,Parts P WHERE C.pid = P.pid AND P.color = 'green') T2
    on t1.sid = t2.sid
"
24731,Clean Dirty data in SQL,"create table tmp_date(col1 varchar(100));

insert into tmp_date
VALUES('14 sept 2012'),('14 SEPTEMBER 2012'),('14th sept 2012'),('14th sept 12'),('14 sept 12')

select convert(datetime,left(col1,2)+'-'+lower(SUBSTRING(col1,CHARINDEX(' ',col1,1)+1,3))+'-'+ltrim(rtrim(reverse(LEFT(REVERSE(col1),CHARINDEX(' ',REVERSE(col1),1)))))) from tmp_date
"
11468,SQL Server: do readers wait on writers (for same data)?,"ALTER DATABASE [<dbname>] SET READ_COMMITTED_SNAPSHOT ON;
"
3433,Sql query on 3 tables (count),"select city, sum(clients) as clients, sum(staff) as staff
from 
(
  select city, count() as clients, null as staff from clients group by city
  union all 
  select city, null, count() from staff group by city
) tmp
group by city
"
21610,Case subquery returning too many rows within where clause,"SELECT `Job ID` 
FROM jobs 
WHERE `Building ID` = '1' 
and case when `Appointment Date` IS NOT NULL 
         then `Appointment Date` = '2013-10-10' 
         else `Backup Date` = '2013-10-10'
    end
"
27713,SQL Delete All Data,"DELETE FROM Test 
WHERE (Followers >=1 
AND Followers <10)
OR Followers >1000
"
30780,Insert PostGIS Object (e.g. ST_GeomFromText) from row variables in plpgsql script,"...
WITH result AS (
  INSERT INTO dest_pos (coord)
  SELECT ST_SetSRID(ST_MakePoint(longitude, latitude, altitude), 4326)
  FROM src_pos
  RETURNING 1
)
SELECT count(*) INTO updated FROM result;
RETURN updated;
...
"
38569,SQL 2012 + LIKE + SPRINTF,"SELECT * FROM myTable WHERE myField1 LIKE '%'+@token+'%'
"
22901,Merging records based on a time difference?,"SELECT DISTINCT a.id,a.name,a.startdate,a.enddate
FROM temp a
  LEFT JOIN temp b ON a.name = b.name AND a.id < b.id AND DATEDIFF(s,a.startdate,b.startdate)<=60
  LEFT JOIN temp c ON c.name = a.name AND c.id < a.id AND DATEDIFF(s,c.startdate,a.startdate)<=60
WHERE (b.id IS NOT NULL OR c.id IS NULL) AND a.id <= COALESCE(c.id,a.id)
"
37782,SQL count from same column but different conditions fetching later count result for all,"SELECT COUNT(CASE WHEN eqa.QU_ANSWER = 'Yes' THEN 1 ELSE NULL END) as gold_yes
     , COUNT(CASE WHEN eqa.QU_ANSWER = 'No' THEN 1 ELSE NULL END) as gold_no
FROM   EC_SECTION_ANSWER esa
       INNER JOIN EC_QUESTION_ANSWER eqa ON esa.ID = eqa.SC_ID
WHERE  esa.SC_NUMBER = 1079 
  AND  eqa.QU_TYPE = 'abc'; 
"
3934,MongoDB Find like Lodash Find,"db.theCollection.find({ $where : ""this.age - 10 > 24"" })
"
7062,counting times the most frequent record appears in a table," select top 1 deal_id, count(*) as numtimes 
 from DEAL_COUNTRY
 group by deal_id
 order by count(*) desc
"
12472,Full outer join on a table itself and run some window functions,"select min(past_id) as id, min(past_time) as event_time, 0 as freq1, 0 as freq2
from t
union all
(select current_id, current_time,
        sum(freq1) over (order by current_time),
        sum(freq2) over (order by current_time)
 from (select current_id, current_time, freq1, freq2,
              row_number() over (partition by current_id order by past_id desc) as seqnum
       from t
      ) t
  where seqnum = 1
);
"
38867,How can I get a list of the databases on a SQL Server Instance without Admin?,"select name from sys.databases
"
5380,"SQL select query, multiple tables","SELECT * FROM Posts WHERE ID NOT IN ( SELECT post_assoc FROM Images )
"
21504,sql update table set - The multi-part identifier could not be bound,"update t1
set t1.[Lattitude1] = t2.[Lattitude]
from table1 t1
left join table2 t2 
on (t1.StationID1 = t2.IDInfo)
"
25536,SQL: Get multiple line entries linked to one item?,"SELECT itemid
      ,count(status = 4 OR status = 5 OR NULL) AS met_requirements
      ,count(status < 4 OR status > 5 OR NULL) AS not_met_requirements
FROM   tbl
GROUP  BY itemid
ORDER  BY itemid;
"
6351,"SSRS, SQL - Select multiple email addresses as [CC] in Data Driven Subscription","john@company.biz; sue@company.biz AS [CC]
"
17642,Replacing Double Quotation to Single Quotation is SQLITE,"UPDATE your_table SET col = REPLACE(col, '''''' ,'''')
"
20194,Select a row used for GROUP BY,"SELECT id, 
       asset,
       rate,
       asset_count
FROM (
    SELECT id,
           asset, 
           rate,
           rank() over (partition by asset order by rate desc) as rank_rate,
           count(asset) over (partition by null) as asset_count
    FROM test 
    WHERE owner IN (1, 2)
) t
WHERE rank_rate = 1
ORDER BY rate DESC
"
27913,Convert SQL query to MDX?,"with member [Measures].[a] as ""welcome""
member [Measures].[b] as iif([Measures].[a] = ""welcome"", ""raj""+"",""+ ""venkat"", null)

select [Measures].[b] on 0 from [mycube]
"
16900,How to summarize two tables in teradata,"Select t2.datex, t2.caseid, sum(t1.points)
from table1 as t1 join table2 a t2 
on position(trim(t1.caseid) in t2.caseid) > 0
group by 1,2
"
11694,MySQL UPDATE only if field in other table meets condition,"UPDATE links
SET link = '$link', rid = $rid, order = $order
WHERE lid = $lid
and (SELECT COUNT(*) 
    FROM resources 
    WHERE rid = $rid 
    AND (sid = $sid OR sid IS NULL) 
    AND types IS NULL) = 1;
"
7299,SQL server : clearing cache has no effect on IO stats,"Table 't1'. Scan count 2, logical reads 32, physical reads 0, read-ahead reads 20
"
5962,SQL: find percentiles,"SELECT  percentile, score
FROM    (
        SELECT  ROW_NUMBER() OVER (PARTITION BY percentile ORDER BY score) AS rn, percentile, score
        FROM    (
                SELECT  score, NTILE(100) OVER (ORDER BY score) AS percentile
                FROM    mytable
                ) q
        ) q2
WHERE   rn = 1
"
29052,Can I perform this Android query with ContentResolver.query()? (LEFT JOIN and CASE),"SQLiteDatabase db = YourActivity.getDbHelper().getReadableDatabase();
String query = yourLongQuery;
Cursor c = db.rawQuery(query, null);
YourActivity.startManagingCursor(c);
c.setNotificationUri(YourActivity.getContentResolver(), YourContentProvider.CONTENT_URI);
"
6915,String formatting in T-SQL,"select Right( '0000' + cast( 1 as varchar),4)
"
13439,Select based on WHERE-clause on multiple rows,"select GroupID 
from your_table 
where UserID in (1,2,3)
GROUP BY GroupID
HAVING COUNT(*) = 3
"
32430,Get Weekly SUM from MySQL,"SELECT concat('CW',week(DateColumn),'/',year(DateColumn)) as weekDate,
       count(*) as cnt
FROM YourTable
GROUP BY concat('CW',week(DateColumn),'/',year(DateColumn))
ORDER BY year(DateColumn),week(DateColumn)
"
36492,"How can I optimize this query, takes more than a min to execute","select o.* from
(select * order order by id desc limit 100) o
inner join product p 
on o.product_id=p.id 
inner join person per 
on o.person_id=per.id 
order by o.id desc limit 100;
"
30010,Which way is the best way to grant read access to a remote database-server?,"mysql -u root -p mysql
mysql> update db set Host='999.999.999.999' where Db='MyDB';
mysql> update user set Host='999.999.999.999' where user='RemoteUsername';
mysql> exit;
"
24692,Query Performance tuning - Searching for other options,"select EXAM_DATE, SUBJECT,        
       SUM(GRADE IN (9,10) THEN 1 ELSE 0 END) as outstanding,
       SUM(GRADE IN (4,5,6,7,8) THEN 1 ELSE 0 END) as approved,
       SUM(GRADE IN (0,1,2,3) THEN 1 ELSE 0 END) as disapproved,
FROM EXAMS EXA
GROUP BY EXAM_DATE, SUBJECT;
"
21931,SQL search column where one item in column is substring of another item Update,"select * 
from tbltest 
where platform like '%' + item + CHAR(13) + CHAR(10) + '%'
or platform like '%' + item
"
17998,How to get all non null rows using a parameter?," WHERE
       (in_parm_list = '*')
    OR (mineral = in_parm_list)
"
3781,Using Substring to Identify Records and Update Records,"UPDATE P
SET Association_Key = PZ.Profile_Key
FROM [Profile] P
INNER JOIN Profile_Zip PZ
    ON PZ.Three_Digits = SUBSTRING(P.Zip, 1, 3)
"
32186,save result from dynamic query,"Solution
DECLARE @Banner nvarchar(255),
@chvSQL NVARCHAR(300)

SELECT @chvSQL = N'SELECT TOP 1 @Banner = [F1] from '+@dbTable_Dollar
EXEC sp_executesql @chvSQL, N'@Banner varchar(50) OUTPUT', @Banner OUTPUT
"
39509,Drop all sequences SqlAlchemy,"engine = create_engine('postgresql://user:password@localhost:5432/test', echo=True)
Base.metadata.drop_all(bind=engine)
"
16352,Select TOP 1 from records with weight taken into account,"select top 1 t.*
from (select t.*, cumulative_sum(weight) as cumweight,
             sum(weight) over (partition by NULL) as totalweight
      from t
     ) t
where rand()*(totalweight+1) < cumweight
order by cumweight desc
"
35498,How to enable Ad Hoc Distributed Queries,"EXEC sp_configure 'show advanced options', 1
RECONFIGURE
GO
EXEC sp_configure 'ad hoc distributed queries', 1
RECONFIGURE
GO
"
21713,Is there a way similar check constraint to help me to know if there is a duplicate column,"  create table tb1 
  (field1 number);

  insert into tb1 values (1);
  insert into tb1 values (1);
  insert into tb1 values (1);
  insert into tb1 values (2);
  insert into tb1 values (2);
  commit;

  -- There should be an non-unique index first
  create index idx_t1 on tb1 (field1);

  alter table tb1 add constraint pk_t1 primary key(field1) novalidate;

  -- If you try to insert another 1 or 2 you would get an error
  insert into tb1 values (1);
"
23391,Autogenerate ID in stored procedure -SQL,"ALTER TABLE Add IdKey INT IDENTITY(1,1)
"
37526,Convert DateTime SQL," SELECT ImpFile, DATEADD(hh, DATEDIFF(hh, 0, ImpDate), 0)
 FROM nol_artikula_izmaina
"
39971,Selecting from table into a column,"select table1.*, 
   case when table2.id is null then 
        case table1.status 
        when 0 then 'stopped'
        when 1 then 'started'
        end
   else 'damaged'
   end
from
   table1 left join table2 on table1.id = table2.id 
"
29278,Making a report in SQL from two tables,"select task_given_to,
       sum(time_to_complete) as sum_time_to_complete,
       sum(time_passed) as sum_time_passed,
       sum(time_to_complete) - sum(time_passed) as sum_differance
from atm_tasks_dit
where completed_percent = 100
and   task_given_to in (select initial 
                        from atm_name_initials)
group by task_given_to
"
33136,Call procedure in mysql,"UPDATE f
SET f_status = 0
WHERE ( f_userid1 = @userid1 AND f_userid2 = @userid2 )
   OR ( f_userid1 = @userid2 AND f_userid2 = @userid1 );
"
26576,Sending ' :new ' trigger object as my object,"SomeProc(MyObj(:new.name, :new.age));
"
38872,How to count students who got equal marks and also show the marks of that group in SQL Server,"select count(StudentName) as NoOfStudents, marks
from tablename
group by marks
order by marks desc
"
36759,Conditional WHERE condition SQL script,"SELECT SUM([Gain/Lost]
FROM   mytable
WHERE  NOT ([Reason] = 'Order Placed' AND [No Of Month Old] = 1)
"
10900,SQL Sort Month Ascending and Months Descending?,"SELECT  *
FROM    Fun
ORDER   BY YEAR(date) DESC, MONTH(date) DESC,
        DATE ASC
"
2385,how to perform a simple join,"select p1.userid, p1.username, p2.userid, p2.username
from players p
join users p1 on p.player1 = p1.userid
join users p2 on p.player2 = p2.userid
where ...
"
26896,need help for combine sql query,"select a.*, b.*
from customers a, order b
where a.name = b.customer_name
and a.orderdate < 01-09-2010
and b.purchasedate > 01-09-2010
"
35162,MySQL- How to implement event scheduler everyday + start from 8am to 10 pm+ every 15 min,"DELIMITER $$

CREATE EVENT STOCK_UPDATER 
   ON SCHEDULE EVERY 15 MINUTE 
      STARTS '2013-11-27 12:00:00' ON COMPLETION NOT PRESERVE ENABLE 
         DO BEGIN
    IF (HOUR(SYSDATE()) BETWEEN 8 AND 22) THEN 
    BEGIN 
         INSERT ABC VALUES (123);
    END IF;
END$$

DELIMITER ;
"
28713,MySQL - Get Distinct Primary Col Table Row Order By Foreign Key Table,"SELECT c.ContactID, c.Name, m.Text, m.Messagetime
FROM Contacts c INNER JOIN
     Messages m
     ON c.ContactID = m.ContactID
WHERE NOT EXISTS (select 1
                  from messages m2
                  where m2.ContactId = m.ContactId and
                        m2.MessageTime > m.MessageTime
                 )
ORDER BY m.MessageTime desc;
"
6454,How do I remove spaces while importing flat file containing intermediate blank lines?,"public override void Input0_ProcessInputRow(Input0Buffer Row)
{
    Row.CleansedData = Row.Name.Replace(@""\r\n"", string.Empty).Trim();
}
"
34155,SQL - insert a number for another number,"SELECT
        SalesRep,
        OrderValue,
        PaymentMethodID,
        CASE
            WHEN PaymentMethodID = 1 THEN 15.00
            WHEN PaymentMethodID = 2 THEN 15.00
            WHEN PaymentMethodID = 3 THEN 12.50
        END as CommisionPercent
FROM SomeTable
"
7976,Get Common data from two different table,"SELECT T1.*
FROM T1
INNER JOIN T2 
    ON T2.FirstName = T1.FirstName
    AND T2.LastName = T1.LastName
    AND T2.DateOfBirth = T1.DateOfBirth
UNION ALL
SELECT T2.*
FROM T2
INNER JOIN T1 
    ON T1.FirstName = T2.FirstName
    AND T1.LastName = T2.LastName
    AND T1.DateOfBirth = T2.DateOfBirth
"
14171,Update table new column with values from another table (MySQL),"update table1 t1
inner join 
table2 t2 on t2.ID_table2 = t1.ID_table2
set t1.ID_B = t2.ID_B
"
32993,Finding difference in row count of two tables in MySQL,"
SELECT inv_t.product_id, inventory_total-nvl(sales_total,0)
FROM 
  (SELECT product_id, sum(quantity) as inventory_total
   FROM inventory
   GROUP BY product_id) inv_t LEFT OUTER JOIN
  (SELECT product_id, count(*) AS sales_total 
   FROM sales 
   GROUP BY product_id) sale_t
  ON (inv_t.product_id = sale_t.product_id)

"
16778,"SQL two records, should be one","Select location,Cashier,[Time],
  stuff((SELECT distinct ', ' + cast(ref as varchar(500))
           FROM t t2
           where t2.location = t1.location
           FOR XML PATH('')),1,1,'') 
Grom t t1
Group By location, Cashier,[Time]
"
21913,How do you print the day name given a day number in SQL Server 2005 using SQL commands?,"declare @m varchar 
set @m=1 
SELECT DATENAME(DW,CAST(@m AS INT))
"
31813,How to change data type of a column in an SQL table from integer to decimal,"ALTER TABLE dbo.Budget
ALTER COLUMN ROE DECIMAL(20,2)   -- or whatever precision and scale you need.....
"
2215,Query values into a variable in shell script,"napp=$(psql -U postgres appdb -c ""
    select appno frpm app.apps
    where properties&2048=1024;""
)
cap=$(echo ""$napp"" | sed -nr 's/.*\(([0-9]+) rows.*/\1/p')
echo ""$cap""
"
854,Combine multiple result rows into one in SQL,"SELECT [Course Section], [Instructor Name], [Respondent Code], 
       max([1]) as [1], 
       max([2]) as [2], 
       max([3]) as [3], 
       max([4]) as [4], 
       max([5]) as [5]
FROM [sirssoctonlineforms].[dbo].[Denormalized_V]
where term = 'ss14' and subject = 'iss' and course like '%330%'
group by [Course Section], [Instructor Name], [Respondent Code]
order by subject, course, [course section], [respondent code]
"
18543,Does making a column unique force an index to be created?,"create table TestTable (id int)
alter table TestTable add constraint unique_id unique (id)
create unique index ix_TestTable_id on TestTable (id)

select * from sys.indexes where [object_id] = object_id('TestTable')
"
17167,How to mimic PreparedStatement to produce a valid SQL query (Sql#withBatch),"def updateCounts = sql.withBatch(20, 'insert into TABLENAME(a, b, c) values (?, ?, ?)') { ps ->
    ps.addBatch(10, 12, 5) // varargs style
    ps.addBatch([7, 3, 98]) // list
    ps.addBatch([22, 67, 11])
    ...
}
"
37800,Formulating Query,"WITH CTE AS (
    SELECT Itemset FROM TempC3
    UNION
    SELECT Itemset2 FROM TempC3
)
SELECT I1.Itemset, I2.Itemset, I3.Itemset FROM CTE AS I1
INNER JOIN CTE AS I2 ON I2.Itemset > I1.Itemset
INNER JOIN CTE AS I3 ON I3.Itemset > I2.Itemset
"
15047,Best way to get article from a database along with connected tags,"select a.id, group_concat(t.name) as tags
from articles a
left join connections c on c.art_id = a.id
left join tag t on t.id = c.tag_id
group by a.id
"
29421,SQL request on a newly saved Grails object,"lion.save( flush: true )
"
26404,Help forming a complex SQL statement,"SELECT u.firstname, q.question, r.tutor_id, r.response, u2.firstname AS TutorName FROM response r 
LEFT JOIN question q ON q.id = r.question_id
JOIN user u ON u.id = q.user_id
JOIN user u2 on u2.id = r.tutor_id
"
16272,"select value AND not select value from one column, and merge results","SELECT id
FROM Table1 a
WHERE ref = 'PRO'
AND EXISTS
(
    SELECT 1
    FROM Table1 b
    WHERE b.id = a.id
    AND b.ref <> 'PRO'
    AND b.valid = 'true'
)
"
15290,Select Query With Distinct on One Field," Select 
 ID1,ID2,ID3
 from 
 (
   SELECT 
        [T1].[Id], [T2].[Id] , [T3].[Id] ,
        rn = ROW_NUMBER() OVER(partition by [T1].[ID] order by [T1].[ID])
   FROM  [T1]
   INNER JOIN [T2] On [T1].[Id] = [T2].[T1Id]
   INNER JOIN [T3] On [T2].[Id] = [T3].[T2Id]
)a
where a.rn = 1
"
1142,SQL count hour for each date of a datetime column,"SELECT CONVERT(VARCHAR(10), LOG_DATE, 120), CONVERT(VARCHAR(2), LOG_DATE, 108)+':00:00', COUNT(*)
FROM TABLE1
GROUP BY CONVERT(VARCHAR(10), LOG_DATE, 120), CONVERT(VARCHAR(2), LOG_DATE, 108)+':00:00'
ORDER BY CONVERT(VARCHAR(10), LOG_DATE, 120), CONVERT(VARCHAR(2), LOG_DATE, 108)+':00:00'
"
39719,Find duplicated rows that are not exactly same,"SELECT A, B FROM MyTable
WHERE A IN
(
    SELECT A FROM MyTable GROUP BY A HAVING COUNT(*)>1
)
"
32542,combine SELECTS in ONE VIEW DISPLAY,"CREATE VIEW [account_balance_sums] AS
  SELECT SUM(balance) AS total, SUBSTRING (Account,0,2) AS account_group
    FROM COA
   GROUP BY account_group
  UNION ALL
  SELECT SUM(balance), 'Grand Total'
    FROM account_group
"
20927,Multi-Table Selecting with Count of Foreign Key Referred Rows,"SELECT Table1Id AS ID, COUNT(*) as FooCount FROM Table2 GROUP BY Table1Id
"
15583,help in sql command .. i want list names which have defined id s,"WHERE FIND_IN_SET(14, job)
"
36942,Filter by language only if the object is a literal,"SELECT DISTINCT
  ?predicate
  ?object
  ?label
WHERE {
  VALUES        ?subject     { <http://dbpedia.org/resource/Hercules_(1997_film)> }
  ?subject      ?predicate   ?object .
  ?predicate    rdfs:label   ?label .
  FILTER(!isLiteral(?object) || langMatches(lang(?object), ""EN""))
}
LIMIT 100
"
39208,How to merge multiple sql queries,"select name, lastname, gender, status, 
       sum(if(status = 'Trvl',  1, 0)) as TrvlCount,
       sum(if(status != 'Trvl',  1, 0)) as NotTrvlCount,
       count(id) as TotalCount
from Users
group by name, lastname, gender, dob;
"
8232,Migrate a production database to the same structure as a dev database,"Update-Database -Script -SourceMigration: VersionDeployed -TargetMigration: CurrentMigration
"
1247,Show all Children and Grandchildren in SQL Hierarchy CTE,"with cte as (
    select t.ChildId, t.ParentId, 0 as [Lvl]
    from @Table t
    where t.ParentId is not null
    union all
    select c.ChildId, t.ParentId, c.Lvl + 1
    from @Table t
        inner join cte c on c.ParentId = t.ChildId
    where t.ParentId is not null
)
select * from cte c order by c.ChildId, c.Lvl, c.ParentId;
"
16957,Get all Related Products which are not available in Related Product Table?,"select *
from    Product
where   id not in
  (select RelatedProductID
   from   RelatedProduct
   where  productID = @productID)
"
900,How to give different values to number of limit people in mysql database?,"UPDATE students SET class = ""Class 1"" 
WHERE payStatus = 1 AND is_completed = 1 AND 
      exam_place_id =11 AND (class IS NULL OR class = '') 
LIMIT 19
"
21125,Top 10 based on last month showing 6 previous months,"SELECT * FROM YourTable t
WHERE t.depositDate between StartRangeDate and EndRangeDate
AND t.ID in(select ID from(SELECT s.id,sum(s.depositAmount) as total
                           from YourTable s
                           where s.date between ThisMonthStart and ThisMonthEnd
                           group by s.id)
            order by total
            limit 10)
"
26068,Finding tags commonly used together,"SELECT t1.tag as tag, t2.tag as tag2, count(*)
FROM tags t1 join
     tags t2
     on t1.text_id = t2.text_id and t1.tag < t2.tag
GROUP BY t1.tag, t2.tag
ORDER BY count(*) desc;
"
17051,Two select statements in one query,"SELECT `age` FROM `users` WHERE `userid`=
  (SELECT `id` FROM `second`  
   WHERE `second`.`name` = 'Berna')
"
8605,Join two tables in Oracle,"select * 
from table1 a
where PKID = MasterPKID
and not exists (select 1 from table2 b where a.PKID = b.refno) 
"
8298,Improve sqlite perfomance,"SELECT  r.id, 
        r.number, 
        r.name, 
        r.views, 
        lower(hex(r.data)),
        r.previousRecord, 
        it.id, 
        it.type, 
        it.recordId, 
        lower(hex(it.data)) 
FROM 
    records r
    left outer join items as it on it.recordId = r.id
    order by r.id 
    limit 100 offset 100
"
5432,SQL Server import row string to table columns,"INSERT INTO a_table (col1, col2, col3, . . . )
SELECT dbo.fnParseString(-1, ',', str)
      ,dbo.fnParseString(-2, ',', str)
      ,dbo.fnParseString(-3, ',', str)
      ,....
FROM  yourtable 
"
20294,How to do multiple OR queries in Mongo?,"db.User.find({
    $or: [{firstName:'Foo'}, {firstName:'Bar'}]
  ,
    $or: [{lastName:'Baz'}, {lastName:'Qux'}]
  }
});
"
10923,SQL Server efficiently filter rows where times are not near another table's times,"SELECT t1.id,
       t1.value
  FROM temp1 t1
 WHERE NOT EXISTS(SELECT NULL
                    FROM temp2 t2
                   WHERE t2.value BETWEEN DATEADD(MINUTE, -1, t1.value)  
                                      AND DATEADD(MINUTE, 1, t1.value))
"
19545,POS (Shopping Cart) - Multiple items in a single Transaction No,"start transaction;
select key from current_key;
update current_key set key = :key + 1;
commit;
"
17196,Calculating information by using values from previous line,";
with CTEtest AS
    (SELECT ROW_NUMBER() OVER (PARTITION BY memberid order by effective year, effective month desc) AS Sequence, *
    FROM txn_by_month)

,test
as (select * , balance - netamt as running_sum from CTEtest where sequence = 1

union all

select t.*, t1.running_sum - t.netamt from CTEtest t inner join test t1

on t.memberid = t1.memberid and t.sequence = t1.Sequence+1 where t.sequence > 1)

select * from test
order by memberid, Sequence
"
18125,why does this SQL not work when both fields are included,"SELECT b.b_id 
FROM `buy` b 
    INNER JOIN `buy_multiples` AS bm 
        ON b.b_id = bm.b_id 
        AND b.buy_status IN (2)  
WHERE bm.`option_type` = 'area_id'  
AND bm.selected_option_key IN (10)
OR bm.`option_type` = 'bzips'  
AND bm.selected_option_key IN (37027)
GROUP BY b.b_id 
"
33584,SQL select sum of column with value in multiple rows,"select pid, val1, val2,
       sum(val1) over (partition by pid) as val1total,
       sum(val2) over (partition by pid) as val2total
from t;
"
4327,SQL: Select Top 3 Records + Sum of Quantity,"SELECT TOP 3 ProductID, SUM(Quantity) as qSum
FROM Table
GROUP BY ProductID
ORDER BY qSum DESC
"
37850,Sorting two columns in opposite way,"SELECT * FROM myTable
ORDER BY Total DESC, Area /* ASC */
"
11164,Need help on grouping this SQL table,"    SELECT
        ProductID, 
        SUM(Case When IsCreditor = 1 then TotalQty else 0 end) AS [TotalPurchase],
        SUM(Case When IsCreditor = 0 then TotalQty else 0 end) AS [TotalSale]
    FROM
        TestTable
    GROUP BY
        ProductID
"
27538,Need to set a one-off date range for SQL query,"SET @beginDate = '20151111'
SET @endDate= '20151130'
"
13493,How can I have my Postgresql SELECT return data from columns with the same name?," SELECT table1.name,
         table1.timetag,
         table1.status,
        table2.timetag AS theothertimetag,
        table2.description

    FROM
"
33520,sum function incorrect values and list of not paid yet this month,"select td1.client_name,td1.TotalDebt,td2.TotalPayment from (SELECT client_name, sum(total_debts) as TotalDebt FROM client_debts GROUP BY client_name) as td1
inner JOIN
(SELECT client_name, sum(payment) as TotalPayment FROM client_details GROUP BY client_name) as td2
on td1.client_name=td2.client_name
"
27168,How to get the right output from this query,"SELECT
  LicensePlateNo
FROM
  Car
  INNER JOIN
    CarTransaction 
  ON 
    Car.ChassisNo = CarTransaction.ChassisNo
WHERE
  Car.Make = 'Toyota' AND
  CarTransaction.TransactionID NOT IN (SELECT TransactionID FROM Sell) AND
  CarTransaction.TransactionID NOT IN (SELECT TransactionID FROM Rent)
;
"
18200,how to recognize an identifier inside a parenthesis,"SELECT S.cid, NLV(SUM(ph.credits#),0) AS mathCred
FROM Students S LEFT JOIN 
     (SELECT P.cid , P.credits#
      FROM PassedCourses P JOIN
           HasClass H
           ON P.code = H.code AND H.name = 'mathematical'
     ) ph
     ON S.cid = ph.cid
GROUP BY S.cid;
"
38426,how to rewrite this nested query in a better way?,"select 
    count (distinct t1.ID) 
from 
    takes as t1
    inner join teaches as t2 on 
        t1.course_id=t2.course_id and
    t1.sec_id=t2.sec_id and
    t1.semester=t2.semester and
    t1.year=t2.year 
where 
    t2.ID= 10101
"
25403,How can I get the difference of two dates from different tables and generate it as a summary using SQL query?,"SELECT table_1.REF, 

SUM(CASE WHEN DateDiff(day, table_1.StartDate, table_2.EndDate) < 30 THEN 1 ELSE 0 END)
FROM table1 table_1 
JOIN table2 table_2 ON table_1.REF = table_2.REF
GROUP BY table_1.REF

WHERE table_2.STATUS in ('max', 'stop')
"
8718,How to change date format in hive?,"select from_unixtime(unix_timestamp('2016/06/01','yyyy/MM/dd'),'yyyy-MM-dd') from table1; 
"
6320,Set of values such that no rows match condition,"select a_uuid
from t
group by a_uuid
having not bool_or(type = 'Purchase')
"
15855,case insensitive for sql LIKE wildcard statement,"SELECT  *
FROM    trees
WHERE   trees.`title` COLLATE UTF8_GENERAL_CI LIKE '%elm%'
"
15430,SQL Server 2008 Convert from GUID to Bigint and Back?,"------------------------------------
C50B0567-F8CC-4219-A1E1-91C97BD9AE1B

(1 row(s) affected)


--------------------
7423352504965404994

(1 row(s) affected)


------------------------------------
C50B0567-F8CC-4219-0000-000000000000

(1 row(s) affected)
"
16918,How to join results of 2 tables based on not condition,"SELECT id, name, partNumber, Aid, Aname, Apart
FROM TableB AS t
CROSS JOIN (SELECT id AS Aid, name AS Aname, partNumber AS Apart
            FROM TableA AS a
            WHERE NOT EXISTS (SELECT 1
                              FROM TableB AS b
                              WHERE b.partNumber = a.partNumber)) AS c
ORDER BY id    
"
29877,How to use two LEFT JOINs on one query?,"SELECT E.id, E.time, E.title, E.body, E.type, C.comments, E.googleID, L.likeCount
FROM elements E
LEFT JOIN(
    SELECT elementID, GROUP_CONCAT(body SEPARATOR '|-|') AS comments
    FROM comments
    GROUP BY elementID
) C on C.elementID = E.id
LEFT JOIN (
    SELECT elementID, COUNT(id) AS likeCount
    FROM likes
    GROUP BY elementID
) L ON L.elementID = E.id;
"
29297,SQL statement for evaluating multiple related tables,"SELECT * FROM Projects
LEFT JOIN Roofing ON (projectID)
LEFT JOIN Siding ON (projectID)
LEFT JOIN Gutters ON (projectID)
LEFT JOIN Misc ON (projectID)
WHERE (Roofing.status IS NULL OR Roofing.status=""completed"")
AND (Siding.status IS NULL OR Siding.status=""completed"")
AND (Gutters.status IS NULL OR Gutters.status=""completed"")
AND (Misc.status IS NULL OR Misc.status=""completed"")
"
36337,UPDATE after INSERT for potentially multiple rows - not working,"CREATE TRIGGER [dbo].[updateOSC]
ON [dbo].[REFERRALS]
AFTER INSERT

AS

BEGIN

SET NOCOUNT ON

UPDATE [dbo].[REFERRALS] 
SET  
    ORIGINAL_PATIENT_ID = i.PATIENT_ID 
FROM 
   Inserted i
WHERE 
   dbo.REFERRALS.PATIENT_ID = i.PATIENT_ID AND i.ORIGINAL_PATIENT_ID IS NULL
END
GO
"
588,Ordering by the difference between two averages,"SELECT `typeID`, AVG(IF(`bid`, `price`, 0)) AS `average_buy_price`, AVG(IF(`bid`, 0, `price`)) AS `average_sell_price`,
AVG(IF(`bid`, `price`, 0)) - AVG(IF(`bid`, 0, `price`)) AS `difference`
FROM `orders`
GROUP BY `typeID`
LIMIT 100
ORDER BY `difference` DESC;
"
18029,T-SQL sorting by a calculated column,"SELECT 
    ID, 
    Price, 
    IsMonthlyPrice, 
    CASE IsMonthlyPrice
    WHEN 1 THEN Price * 12 / 52
    ELSE price
    END
FROM [TABLE]
    order by 
        4
"
21420,Finding a Value In a Database Table Multivalued Column,"SELECT sr_redirect FROM search_redirect
INNER JOIN search_keyword_to_synonym
ON search_redirect.sr_id=search_keyword_to_synonym.sr_id
WHERE search_redirect.sr_keyword=whatever_input_you_have.
"
15723,Selecting penultimate record from a table,"SELECT * FROM tbl
    WHERE (probID = 2) AND (studentID = 2)
    ORDER BY id DESC
    LIMIT 1 OFFSET 1
"
33149,XPath/XQuery Regular Expression replacing a String pattern,"select regexp_replace('<!-- Oracle ...  -->blub', '<!.*?>', ' ') from dual
"
12201,SQL Query to concatenate strings or add default value,"SELECT 
  CODPROY, 
  DESCPROY, 
  USER, 
  CODPROY + ' - ' + COALESCE(USER,'NOT AVAILABLE') + ' - ' + DESCPROY AS Expr 
FROM dbo.PROY
"
21495,How can I include a SQL Function in my Code First EF query?,"create view transactions_view as
select t.ref, getrefstring(t.ref), ... (other cols you may want)
from transactions t;
"
7850,SQL SELECT with m:n relationship,"select *
from user u
where 3 = (
    select count(distinct t.id)
    from user_has_tag uht
    inner join tag t on t.id = uht.tag_id
    where t.name in ('apple', 'orange', 'banana') 
    and uht.user_id = u.userid
)
"
36054,Unusual two tables join,"SELECT
    A.id AS 'Person',
    A.name,
    A.phone,
    A.house_id,
    B.id AS 'House',
    B.street,
    B.number
FROM
    Persons AS A
    FULL OUTER JOIN Houses AS B
        ON A.house_id = B.id
"
11398,Nesting or Referencing Queries in Postgres,"select g.d, count(c.id)
from
    comments c 
    inner join
    posts p on c.post_id = p.id and p.site_id = 35
    right join
    generate_series (
        current_date - 7, current_date, '1 day'
    ) g(d) on g.d = date_trunc('day', c.created_at)
group by g.d
"
32984,How can I check if each record of a database has a similar record for all columns except one?,"select number, name from table where code is NULL
minus
select number, name from table where code = 1
"
20164,How to remove hex characters from DB?,"UPDATE tbl
SET col = REPLACE(col, '%20', UNHEX('20'))
WHERE col LIKE '%\%20%';
"
18433,How to remove 'NULL' from results of queries SQL Server 2008,"UPDATE my_table
SET    column_1 = COALESCE(column_1,'')
     , column_2 = COALESCE(column_2,'')
     ...
WHERE  column_1 IS NULL OR
       column_2 IS NULL OR
       ...                  -- avoid empty updates
;
"
17164,Implement deferrable validations,"CHECK (is_draft OR (condition_one AND condition_two AND condition_three))
"
37651,Android SQLite not selecting date,"    SELECT COUNT(id_sale) AS total_transactions,sold_to,
CAST(strftime('%m', sale_date) AS INTEGER) month, 
    CAST(strftime('%Y', sale_date) AS INTEGER) year,
    sale_date FROM sales  WHERE  month=5
"
14339,Delete all records except the most recent one?,"DELETE student
WHERE ApplicationDateTime <> (SELECT max(ApplicationDateTime) 
                              FROM student s2
                              WHERE s2.StudentID  = student.StudentID)
"
38450,Replacing HAVING with WHERE,"select * from (
  select team, v maxmarks, row_number() over (order by v desc) RNum from(
    SELECT team, sum(maths) v
    FROM marks 
    group by team 
  )x
)xx where RNum=1;
"
24687,Oracle : Create table in another schema and grant select and insert on it from the same schema,"CREATE OR REPLACE PROCEDURE definer_test AUTHID DEFINER IS 
BEGIN
    ...
END definer_test;
"
1131,Sort by month expressed by a string in SQL,"SELECT time, orderValue
FROM orders
ORDER BY CONVERT (DATETIME, '01 ' + time, 104)
"
876,Averaging In SQL When Multiples Values Possible In A Row,"select productname, 
       sum(unitprice * quantity) / sum(quantity) as avg_unit_price, 
       sum(quantity) as cnt
from your_table
group by productname
"
38843,(My)SQL: Get new ids in an 'INSERT INTO ... SELECT',"set @max_orig_id = coalesce((select max(id) from output_table),0);
insert into output_table (code) select code from input_table;
update input_table join output_table on input_table.code=output_table.code and output_table.id > @max_orig_id set input_table.new_id=output_table.id;
"
34070,How to add sequence number for each element in a group using a SQL query without temp tables,"SELECT
    ROW_NUMBER() OVER(PARTITION BY [Group] ORDER BY Record) AS GroupSequence1,
    RANK() OVER(PARTITION BY [Group] ORDER BY Record) AS GroupSequence2,
    DENSE_RANK() OVER(PARTITION BY [Group] ORDER BY Record) AS GroupSequence3,
    Table1.Group,
    Table1.Record
FROM
    Table1
"
38570,MySQL IN clause special query,"SELECT * FROM locations WHERE name IN ('city2','city3')
UNION
(SELECT * FROM locations WHERE name IN ('city1','country1') LIMIT 1)
"
19639,Count number of rows in each group in MySQLi,"select n.name, count(*)
from names n, mark m
where n.nameID = m.nameID and m.child = '1'
group by n.name
"
5778,How to get column values comma seperatedly,"Use XML path for this.

select (select BandName+',' from BandMaster where BandId<100 for xml path('')) as NewColumnName

Try this
"
35902,Need ALL data from a table with JOIN to another table with multile AND on multiple ROW,"  SELECT `h.id` , `h.name`  FROM `hotel` AS `h` 
  INNER JOIN `hotel_amenity` AS `ha` ON `h`.`id` = `ha`.`hotel_id` 
  INNER JOIN `amenity` AS `a` ON `ha`.`amenity_id` = `a`.`id` 
  GROUP BY `h`.`id` 
  HAVING COUNT( case when a.id in (1,3) then 1 else null end ) = 2
"
29095,Can you sort the output of SHOW COLUMNS or DESC?,"SELECT column_name
FROM information_schema.columns
WHERE table_name = 'table_name' ORDER BY column_name
"
28613,Update table based on row number,"SET @rownumber = 0;
INSERT INTO slides (id, displayorder) 
SELECT a.id, a.rownumber 
FROM (SELECT id, (@rownumber:=@rownumber+1) AS rownumber FROM slides WHERE active = 1 ORDER BY displayorder ASC) AS a ON DUPLICATE KEY UPDATE displayorder = a.rownumber
"
8325,Drop all constraints,"DECLARE @sql NVARCHAR(MAX) = N'';

SELECT @sql += N'
ALTER TABLE ' + TABLE_NAME +
    ' DROP CONSTRAINT ' + CONSTRAINT_NAME + ';'
DB_NAME.INFORMATION_SCHEMA.CONSTRAINT_TABLE_USAGE
WHERE TABLE_SCHEMA = 'dbo' AND TABLE_NAME = 'TestTable';

EXEC sp_executesql @sql;
"
31137,SELECT all items in common between two users from a SINGLE TABLE,"SELECT Item_ID
FROM xyz
WHERE  User_ID IN ('A','B')
GROUP BY Item_ID
HAVING COUNT(distinct user_id) = 2
"
22785,How to select highest paid employee in dept based on the following?,"WITH CTE AS(
    SELECT e.EmpID,e.EmpName,e.EmpSalary, e.Department,b.EmpBonus,
       RN = ROW_NUMBER() OVER (PARTITION BY Department 
                               ORDER BY (EmpSalary + COALESCE(EmpBonus,0)) DESC)
    FROM Employees e LEFT OUTER JOIN Bonuses b
       ON e.EmpID = b.EmpID 
)
SELECT EmpID, EmpName, EmpSalary, Department, EmpBonus
FROM CTE
WHERE RN = 1
"
34666,SQL Transpose Rows as Columns,"  SELECT r.user_id,
         MAX(CASE WHEN r.question_id = 1 THEN r.body ELSE NULL END) AS ""Do you like apples?"",
         MAX(CASE WHEN r.question_id = 2 THEN r.body ELSE NULL END) AS ""Do you like oranges?"",
         MAX(CASE WHEN r.question_id = 3 THEN r.body ELSE NULL END) AS ""Do you like carrots?""
    FROM RESPONSES r
    JOIN QUESTIONS q ON q.id = r.question_id
GROUP BY r.user_id
"
33684,How to group similar data in SQL Server,"SELECT case when seq >1 THEN '' ELSE foldername END as foldername,
       case when seq >1 THEN '' ELSE setname END as setname,
       case when seq >1 THEN '' ELSE testname END as testname,
       step,
       stepdescription
FROM
(
SELECT *,
     ROW_NUMBER() OVER ( PARTITION BY foldername, setname, testname order by (select NULL) ) as seq
FROM Table1
) T
"
12719,SQL Count with a Join,"  select product_name,
         count(product_order.product_id)
    From product left join product_order
      on product.product_id = product_order.product_id
group by product_name
"
11805,"In SQL, group user actions by first-time or recurring","select      
    COUNT(q.repetitions) 'first time',
    SUM(case when q.repetitions>1 then q.repetitions-1 else 0 end) as 'recurring',
    day
from (
select COUNT(i.action_type) as 'repetitions',convert(date,i.time_stamp) as 'day'  
from input i
group by i.user_id, i.action_type,convert(date,i.time_stamp)

) q
group by q.day
order  by day desc
"
2687,"Prepared Statement using VB.NET, MySql, and OleDbConnection","Using cmd As New OleDbCommand(""EXEC dbo.SearchActivities @value1 = ?, @value2 = ?"", New OleDbConnection(mySqlConn))
  cmd.Parameters.AddWithValue(""@value1"", LoggedUser.Text)
  cmd.Parameters.AddWithValue(""@value2"", searchAFEs.Text)
"
7378,"SQL - Computed column using ISNULL, DATEDIFF and GETDATE","  CASE ISNULL(return_date,'19000101') 
  WHEN '19000101' THEN DATEDIFF(dd, rental_date, GETDATE()) 
  ELSE 0 END 
"
36036,mysql - deleting from two tables in one query,"DELETE FROM Table1, Table2
USING Table1, Table2
WHERE Table1.month NOT IN (1,2)
  AND Table1.year NOT IN (1, 2)
  AND Table1.userId = 1
  AND Table2.userId = Table1.userId
"
1448,how to process a column and return it as part of a query?,"SELECT No AS ""Part Number"", Desc AS ""Description"", 
CASE 
WHEN Draw IS NOT NULL THEN 'Yes'
ELSE 'No'
END AS ""Is Packed""
FROM Part
"
15432,String.Join in SQL,"DECLARE @Codes VARCHAR(8000) 
SELECT @Codes = COALESCE(@Codes + ', ': '') +  tdefSymptomCode.SymptomCodeNumber
    FROM  RMA INNER JOIN
        trelRMA_SymptomCode ON RMA.IdRMA = trelRMA_SymptomCode.fiRMA INNER JOIN
        tdefSymptomCode ON trelRMA_SymptomCode.fiSymptomCode = tdefSymptomCode.idSymptomCode
    where idRMA=2
    order by SymptomCodeNumber
return @Codes
"
9884,Using the results of an aggregate function in a calculation,"SELECT MAX(Col1) OVER(PARTITION BY ID) MaxValue, 
       Col2 + MAX(Col1) OVER(PARTITION BY ID)
FROM TableA
"
7914,Spliting the string in SQL Server using a delimiter,"-- Get text between points
set @str = stuff (@str, 1, charindex ('.', @str), '')
set @str = left (@str, charindex ('.', @str) - 1)
-- Get rid of spaces, tabs and line ends
set @str = replace (replace (replace (replace (@str, ' ', ''), char(9), ''), char(10), ''), char(13), '')
-- Output
select ltrim (cast(replace (@str, '>', '/> ') as xml).value('.', 'varchar(max)'))
"
33306,SQL - Find duplicate lines in two tables,"select * from source_1
INTERSECT
select * from source_2
"
34337,Best equivalent of SQL Server UPDATE command in Hive,"INSERT OVERWRITE TABLE employee SELECT employeeId,employeeName, experienceMonths ,salary, CASE WHEN experienceMonths >=36 THEN YES ELSE visaEligibility END AS visaEligibility FROM employee;
"
36278,SQL Group by Having > 1,"SELECT *
FROM software
WHERE manufacture IN (
    -- This is your ""HAVING COUNT(*) > 1"" query inside.
    -- It drives the selection of rows in the outer query.
    SELECT manufacture
    FROM software
    GROUP BY manufacture
    HAVING COUNT(*) > 1
)
"
25505,SQL Grouping by offset date range,"SELECT NAME,YEAR(DATEADD(D, -1, DATE)), MONTH(DATEADD(D, -1, DATE)), SUM(GAIN) Gain_Total
FROM GainTable
GROUP BY Name, YEAR(DATEADD(D, -1, DATE)), MONTH(DATEADD(D, -1, DATE))
"
17359,SQL to find rows where two columns have the same value,"select column1, count (*)
from mytable
where column2 = column3
group by column1, column2;
"
868,How to create parent child relation in query?,"select t.id
      ,t.ParentID
  from table_name t
 start with t.ParentID = 0
connect by prior t.id = t.ParentID
"
31288,join clause not showing all results,"select  DATE_FORMAT(l.created_on,""%d/%m/%y"") as date
from logs l
left join logs_rewards lr on l.id = lr.related_log_id 
left join agents a on a.id = l.agent_id 
where l.log_status = ""1"" 
and DATE_FORMAT(l.created_on,""%m/%y"") = '12/12'
AND l.agent_id = '18' 
group by YEAR(l.created_on), MONTH(l.created_on), DAY(l.created_on) desc
"
23727,Substring selection within specific repetition of characters,"http:\/\/([^\/]+\/){n}([^\/]+).*$
"
14042,How do I find the makers that sell one type but not another?,"SELECT maker
FROM product
GROUP BY maker
HAVING SUM(CASE WHEN type = 'PC' THEN 1 ELSE 0 END) > 0
   AND SUM(CASE WHEN type = 'Laptop' THEN 1 ELSE 0 END) = 0
"
1587,how to display the most recent record in a database mysql,"SELECT * from DVD
WHERE Genre = 'Action'
ORDER BY YOR DESC LIMIT 1;
"
10779,Creating a table from a query using a different tablespace (Oracle SQL),"CREATE TABLE new_permanent_table
TABLESPACE other_tablespace
AS
SELECT *
FROM old_temporary_table
WHERE amount<5000;
"
320,Storing cvs data for further manipulation using Ruby,"Customer = Struct.new(:email, :name, :address) # etc.

bill = Customer.new('bill@asdf.com', 'Bill Foo', '123 Bar St.')

puts ""#{bill.name} lives at #{bill.address} and can be reached at #{bill.email}""
"
13739,SQL - Restrict the number of rows returned based on a count of rows,"SELECT * FROM 
(
  select item_id, group_id, count_of_items, 
  ROW_NUMBER() OVER(PARTITION BY group_id ORDER BY count_of_items DESC) 
  AS RN
  from items_in_groups
) A
WHERE RN <= 2
"
19207,sql join on two fields in one table," SELECT 
       ag.id, 
       p.first_name, 
       p.last_name, 
       p.organisation, 
       p.event_date, 
       p.wave
 FROM (
      SELECT booking.person_1 as id, booking.Car as car FROM booking
      union ALL
      SELECT booking.person_2 as id, booking.Car as car FROM booking
     ) as ag
JOIN people p ON people.id = ag.id;
INNER | LEFT JOIN Cars c ON c.ID = ag.car
"
5326,Mysql stored procedure for n*m inserts,"INSERT INTO TableC (SELECT * FROM TableA CROSS JOIN TableB)
"
28313,SQL : filter on case-statement data-substitution in the where clause,"SELECT 
   (CASE Animal 
    WHEN 'Horse' THEN 'Zebra' 
    ELSE Animal
    END) AS Species
FROM Beasties 
WHERE 'Zebra'=(CASE Animal WHEN 'Horse' THEN 'Zebra'  ELSE Animal END)
"
29976,Sql aggregate count = 0,"SELECT * from items i
where not exists(select holdings.item_id 
             from holdings 
             where holdings.active = 't' 
               and holdings.item_id = i.item_id)
"
11054,SQL Selecting distinct data,"SELECT
O.OrderID
,OI.ProductID
,OI.Amount

 FROM
(
SELECT
     MAX(OrderID) AS OrderID
FROM Orders
) AS O
LEFT JOIN OrdersInfo AS OI
OI.OrderID=O.OrderID
"
5613,mysql search events between dates?,"SELECT event_id, event_name
FROM events
WHERE start_date <= 2013-07-30 AND end_date >= 2013-07-16
"
13514,SQL: Getting the period start and end datetimes from data like this? Tricky little puzzle I'm struggling with,"select min(period) as period, MIN(date), MAX(date)
from (select t.*,
             (select min(date) from t t2 where t2.period <> t.period and t2.date > t.date) as nextp
      from t
     ) t
group by nextp
"
31801,What's wrong with my SQL statement?,"SELECT * FROM [makes$] WHERE [Corporate Name]='Champion Enterprises, Inc.'
"
11911,How to GROUP BY with a CASE statement?,"SELECT MAX(id)
FROM @a
WHERE val = 1
GROUP BY CASE WHEN val = 1 THEN id ELSE 0 END
"
19395,how to do get multiple columns + count in a single query?,"SELECT count(*) over (partition by seriesID) as NumEpisodesInSeries,
       st.SeriesId, st.SeriesName, et.episodeID, et.episodeName,
       ct.createdID, ct.CreatorName
FROM series_table st join
     episode_table et
     ON et.ofSeries = st.seriesID join
     creator_table ct
     ON ct.creatorID = st.byCreator;
"
30758,mysql trying a select with multiple conditions,"SELECT
  DISTINCT
  thisyear.user_ID,
  name
FROM
  /* Left side of join retrieces only this year (year=2012) */
  tbl_interviews thisyear
  /* Right side retrieves year < 2012 */
  /* The combined result will elmininate any users who don't exist on both sides of the join */
  INNER JOIN tbl_interviews previous_years ON thisyear.user_ID = previous_years.user_ID
  /* and JOIN in the user table to get a name */
  INNER JOIN tbl_users ON tbl_users.user_ID = thisyear.user_ID
WHERE
  YEAR(thisyear.date) = 2012
  AND YEAR(previous_years.date) < 2012
"
10183,SQL Server 2008 Table Structure with Guid Performance Considerations,"CREATE INDEX idx_posts_specialId
    ON Posts (specialID); 
GO
"
664,Query to check the average against a table and return a result if it is greater,"  SELECT company_name,
         AVG(salary) AS avg_salary             
    FROM works
   WHERE avg_salary > (
             SELECT AVG(salary) 
               FROM works 
              WHERE company_name = 'first_bank_corp' 
         )
GROUP BY company_name
"
9370,T-SQL Updating current row to next row's value issue,"with toupdate as (
      select t.*,
             lead(start_date) over (partition by entity order by start_date) as next_start_date
      from t
     )
update toupdate
     set end_date = dateadd(day, -1, next_start_date)
     where end_date = dateadd(day, -1, start_date);
"
32055,get count of families that have more than 1 child in their record,"create index families_fsc_unitid on families(family_status_cat_id, unit_id);
create index children_familyid on children(family_id);
"
38123,"In oracle SQL, how would you obtain the timestamp representing the start of the week?","SQL> select next_day(sysdate-7, 'MONDAY') FROM DUAL;

NEXT_DAY
---------
29-APR-13
"
29774,How to Update multiples row in a table with subquery in the where statement,"UPDATE Products
SET Active = 0
WHERE Active = 1 AND
      PkProduct IN (SELECT Pk FROM #temptable);
"
9300,How do I assign the results of an SQL query to multiple variables in VB.NET?,"dsCustomers.Tables(""Customer_Information"").Rows
"
24882,count or bool of child records,"select *,
(
    select (select case when COUNT(*)>0 then 1 else 0 end as reccount 
    from ListItems li3 where li3.listid = l.listid) 
    from Lists l where li2.name = l.listname
) as haschildrecords
 from ListItems li2 where listid=1
"
12582,Combined distinct values for 2 tables needed,"select * from table 1 
union 
select * from table 2
"
18519,Consulting if a record exist before inserting in Oracle,"MERGE INTO HEX_KE_LOC USING dual
   ON ( CLVE_LOC = '20000' )
WHEN NOT MATCHED THEN INSERT (CLVE_LOC,CLVE_STDO,MUN,CLVE_PAIS,UID_BUS_UNI,CLVE_ALTR,DSC,CIT,ZIPCODE) 
    VALUES ('20000','AGS','001','MX','0014','1','Zona Centro','01','20000');
"
12365,sql find children from selection,"SELECT *
FROM mytable AS t1
WHERE EXISTS (
  SELECT 1
  FROM mytable AS t2
  WHERE t1.Cnmbr = t2.Cnmbr AND `group` IN ('003', '015'))
"
699,HSQLSB - Select a random row from a db,"SELECT p.name as foo
From Playlist p
ORDER BY RAND() LIMIT 1
"
5509,How to find if there is only one hyphen in a column SQL Server 2008?,"select *
from customer
where (len(Customer) - len(replace(Customer, '-', ''))) = 1
"
16382,SQL: SUM function not returning results as I expect,"SELECT
  Payment,
  Vendor,
  SUM(Amount) AS AmountTotal,
  SUM(Discount) AS DiscountTotal,
  SUM(Amount) - SUM(Discount) AS NetPaymentTotal
FROM
  PaymentInfo
GROUP BY
  Payment, Vendor;
"
1401,Find block number of a table in Oracle database,"select owner, segment_name, tablespace_name, file_id, block_id
from dba_extents
where segment_name = 'FND_USER';
"
35413,"Oracle: a query, which counts occurrences of all non alphanumeric characters in a string","with d as (
   select '(1(2)3)' as str_value
   from dual)
select char_value, count(*)
from (select substr(str_value,level,1) as char_value
      from d
      connect by level <= length(str_value))
where regexp_instr(upper(char_value), '[^A-Z,^0-9]'), 1) <> 0
group by char_value;
"
38611,A query to return a mix of SUM and COUNT in 5 joined tables,"SELECT *,
(select count (*) from Applications as A1 where A.ID = A1.AdID ) as Applicants,
(select count(*) from Referrals as R where A.ID = R.AdID ) as Referrals,
(select count(*) from Subscribers as S where A.ID = S.AdID ) as Subscribers,
(select count(*) from Views  as V where A.ID = V.AdID ) as Views
FROM Ads as A
"
37293,How get data with redis using this hash,"hset user:id 1234 ""content of my first user""
hset user:id 1235 ""content of my second user""

hgetall user:id
"
30433,SQL MAX function and strings,"SELECT nr
FROM table WHERE (nr LIKE '12345-%')
ORDER BY regexp_replace(nr, '^\d+-', '')::integer DESC
LIMIT 1
"
34708,Rename all columns from a table within SELECT,"select '      u1.'+column_name+' as customer_'+column_name+','
from Information_Schema.columns
where table_name = 'users' and schema_name = 'dbo';
"
1353,Finding duplicates in MYSQL table where data is in multiple tables (multiple conditions needed),"SELECT r.form, s.value as email, COUNT(distinct s.record)  as form_count
FROM subrecords s join
     records r
     on s.record = r.id
WHERE s.title = 'email'
GROUP BY s.value, r.form
HAVING form_count > 1;
"
1662,"Using SQL to work out the average of some, but not all, records","SELECT 
  Avg(case when Field1 > 0 then Field1 end), 
  Avg(case when Field2 > 0 then Field2 end) 
FROM table
"
35704,Get next row value based on returned list of rows,"SELECT * FROM table1 where ID in (SELECT min(ID) FROM table1 WHERE ID > 12)
"
27414,How to insert umlaut with correct hex value in Oralce using sqlplus,"SQL> create table foo (
  2    col1 varchar2(1 char)
  3  );

Table created.

SQL> insert into foo values( unistr('\00fc') );

1 row created.

SQL> ed
Wrote file afiedt.buf

  1  select dump(col1, 1016)
  2*   from foo
SQL> /

DUMP(COL1,1016)
-------------------------------------------------------------

Typ=1 Len=2 CharacterSet=AL32UTF8: c3,bc
"
486,SQL select a column and add,"UPDATE RBL 
SET RegionId =  (SELECT  r.RegionId
                 FROM region r 
                 WHERE r.Name = RBL.Region_name)
"
4850,Group by/Print related query in SQL SERVER,"Select 
    DateOfBirth, 
    Case 
      when datepart(year, DateOfBirth) between 1970 and 1979 then 'Seventies' 
      when datepart(year, DateOfBirth) between 1980 and 1989 then 'Eighties' 
      when datepart(year, DateOfBirth) between 1990 and 1999 then 'Nineties' 
      when datepart(year, DateOfBirth) >= 2000 then '21st century' 
      else 'Before 1970' 
    end as DOBDecadeString
From 
   Customers
Order By DateOfBirth asc
"
31613,Update Duplicate Data,"WITH cte AS 
(
  SELECT DosyaNo, SiraNo, 
         ROW_NUMBER() OVER (PARTITION BY DosyaNo ORDER BY (SELECT NULL)) rnum
  FROM table1
)
UPDATE cte
   SET SiraNo = rnum
"
9234,How to select rows with column containing provided values,"SELECT * 
FROM TableName T 
WHERE EXISTS ( SELECT 1 
               FROM TableName
               WHERE T.Col1 = Col1 
                AND  Col3 = 'Aa')
"
13079,Database query on a non-dense index,"SELECT COUNT(*) FROM EMPLOYEE WHERE SALARY < 10,000
"
1214,How to rewrite SQL queries who give better performance in MySQL,"EXPLAIN SELECT foo,bar from glurch WHERE baz > 1 ORDER BY foo;
"
27469,PostgreSQL COALESCE with IN,"SELECT 
    coalesce(1 = any(null), true) a,
    coalesce(1 = any(array[1,2,3]), true) b,
    coalesce(1 = any('{1,2,3}'), true) c;

 a | b | c 
---+---+---
 t | t | t
(1 row)
"
7564,T-SQL transactions and table locking,"UPDATE dbo.MyTable WITH (XLOCK)
SET flag = 1 
OUTPUT INSERTED.*
WHERE flag IS NULL;
"
13363,Generate dummy sql rows based on value,"with a (idx) as (
         select level from dual connect by level <= (select max(users) from fruits)),
     b as (select fruit, users, idx from fruits join a on idx <= users)
select fruit, users from b order by users desc,  fruit
"
9636,How do I create a SQL Distinct query and add some additional fields,"SELECT  *
FROM    (
        SELECT  *, COUNT(*) OVER (PARTITION BY FirstName, LastName) AS cnt
        FROM    Contacts
        WHERE   ContactTypeId = 1
        ) q
WHERE   cnt > 1
ORDER BY
        cnt DESC
"
25754,Sql - can I search for particular numbers in a record?,"SELECT col_name 
FROM table_name 
WHERE FIND_IN_SET('563', col_name);
"
18846,How to write a SQL Query to get the following ...,"select Items.*, Owners.* 
from Items
left join Owners on Items.OwnerId = Owners.OwnerId
left join OwnerPermissions on OwnerPermissions.OwnerId = Owners.OwnerId
where OwnerPermissions.UserId = $userId
"
12530,For an n:m relation how can I search for all n that have at least the m defined in another table?,"select items.id, tags.id
from items
left join itemTags on (items.id=itemTags.itemId)
left join tags on (tags.id=itemTags.tagId)
where not exists(
   select 1 from tagSearch
   left join itemTags on (itemTags.tagId=tagSearch.tagId)
   where itemTags.tagId is null and tagSearch.searchId=?
)
"
39547,Retrieving string extract using Substring and Charindex,"Update [MM].[dbo].[Star]
SET [Query Name]= 
    SUBSTRING([File Name], LEN([File Name]) - CHARINDEX('\', REVERSE([File Name])) + 2, CHARINDEX('\', REVERSE([File Name])) - CHARINDEX(' ', REVERSE([File Name])) - 1)
"
702,Validate telephone number in SQL Server 2000," select number 
 from numberTable
 where dbo.fn_pcre_match(number, 'someRegex') = 1
"
33956,How to use DISTINCT in ms access?,"SELECT MAX(AwardDescriptions.aID) as aID, CostCentres.cCC 
FROM  AwardDescriptions INNER JOIN
      CostCentres
      ON AwardDescriptions.aID = CostCentres.cNumber 
GROUP BY CostCentres.cCC
ORDER BY CostCentres.cCC;
"
13342,ORA-02291: integrity constraint,"CONSTRAINT ""TFMODE_PRODUCT_FK1"" FOREIGN KEY (""F_PRODUCT"") REFERENCES 
 ""DESIGN"".""PRODUCT"" (""ID"") ENABLE
) 
"
38623,Difference between two queries,"A <- { 1, 2, 4 }
B <- { 1, 2(#1), 2(#2), 3 }

A join B => { 1, 2(#1), 2(#2) }
"
28624,SQL last day in moth select,"select a.datecreated,a.sale
         from salesummary a
 inner join calendar c
on a.datecreated = c.fulldatekey
 and c.IsLastDayOfMonth = 1
group by a.datecreated,a.sale
"
15628,Using SQL JOIN in One-to-Many Query,"$widget = $this->db->query(""SELECT
    widget.name
    , widget.color
    , reviews.rating AS rating
FROM
    widget
LEFT JOIN reviews
ON (widget.widget_id = reviews.widget_id)
WHERE widget.id = 46"");
"
12464,access (sql) group by query and join,"SELECT PROJECT.p_id, SUM(EXDE.EXD_AMOUNT) AS T
FROM  PROJECT 
LEFT JOIN EXDE
    ON PROJECT.p_id = EXDE.P_NO
GROUP BY  PROJECT.p_id
"
29656,Select Ids which have both NULL and Value(NOT NULL) in another column,"select Col1 
from mytable
group by Col1
having count(case when col1 is null then 1 end) > 0 and
       count(case when col1 is not null then 1 end) > 0
"
14031,Select locations from two tables,"SELECT l.*
FROM listings l
LEFT JOIN addresses a_l ON a_l.addressable_id = l.id
  AND a_l.addressable_type = ""App\\Listing""
  AND a_l.suburb = ""Melbourne""
LEFT JOIN addresses a_u ON a_u.addressable_id = l.user_id
  AND a_u.addressable_type = ""App\\User""
  AND a_u.suburb = ""Melbourne""
WHERE a_l.id IS NOT NULL OR a_u.id IS NOT NULL
"
11811,Will inserted and deleted record count always be equal in an update trigger?,"UPDATE TableA SET Column1 = ""ABC"" WHERE Column1 = ""DEF""
"
16212,SQL Server : PDO `IN` statement syntax,"$ids = array(1,2,3);
$in  = str_repeat('?,', count($arr) - 1) . '?';
$sql = ""SELECT * FROM table WHERE column IN ($in)"";
$stm = $db->prepare($sql);
$stm->execute($ids);
$data = $stm->fetchAll();
"
1239,Need an optimised and efficient query,"SELECT DISTINCT main_row.Res,
       main_row.UID,
       main_row.Req
FROM   TABLE AS main_row
JOIN   TABLE AS res_join 
       ON main_row.UID = res_join.UID 
       AND res_join.Res = 'to'
WHERE  main_row.Req = 'A'
"
22353,SQL how to do a pivot of one column regardless of the data,"WITH cte AS (
  SELECT myId, ROW_NUMBER() OVER (ORDER BY myId) rn FROM mytable
)
SELECT MAX(CASE WHEN rn=1 THEN myId END) field1,
       MAX(CASE WHEN rn=2 THEN myId END) field2,
       MAX(CASE WHEN rn=3 THEN myId END) field3
FROM cte;
"
35631,Updating nvarchar field to a non-english text,"     set Text=N''
"
38393,SQL: Querying within multiple records that represent the same individuals,"SELECT DISTINCT StudentID FROM alumni
WHERE StudentID NOT IN (
    SELECT StudentID FROM alumni WHERE State_Fee = 'state'
)
"
4473,copying data from one table to another based upon a condittion,"Insert into ASalesHistory (SalesNumber ,column1,column2,column3)
select SalesNumber, column1, column2,column3 from ASales 
where NOT exists  (SELECT 1 FROM ASalesHistory WHERE SalesNumber = ASales.SalesNumber)

UPDATE Hist
SET   column1 = A.SalesNumber
     ,column2 = A.column2
FROM  ASalesHistory Hist
INNER JOIN ASales A ON A.SalesNumber = Hist.SalesNumber
"
3597,Update top 50 rows from other table,";WITH query
AS (
    SELECT TOP 50 *
    FROM [Your Query]
)
UPDATE query
SET MagLoc   = items.UserField_06, 
    Itemcode = items.ItemCode,
    CCDate   = GETDATE()
"
26401,Oracle and SQL Dataset,"SELECT *
FROM sqlservertable
INNER JOIN linkedserver.oracletable
    ON whatever
"
20829,How to use MySQL to create view that selects an ID by the nearest price by timestamp,"CREATE VIEW block_pricing 
AS 
SELECT block.id,min(block.timestamp)timestamp, historic.usd 
FROM block, historic 
WHERE block.timestamp <= historic.timestamp
GROUP BY id;
"
34970,mysql query : null values behavior when left joining,"What will be the output if table2 is empty?
"
32341,Firebird 'update or insert into' with field reference in values?,"merge into TargetTable e
using (select :fielda FieldA, :fieldb FieldB from RDB$DATABASE ) n
on e.FieldA = n.FieldA
when matched then
  update set e.FieldB = coalesce( n.FieldB, e.FieldB )
when not matched then
  insert (FieldA, FieldB) values ( n.FieldA, n.FieldB )
"
9820,Returning Query_ID from insert statement,"INSERT INTO Master
VALUES (""a12t22h@hotmail.com"",""efheif"",""pwoe"");

SET @v1 = LAST_INSERT_ID()

INSERT INTO Duration(Status,DURATION)
SELECT STATE, FORMAT(DURATION, 6) AS DURATION
FROM INFORMATION_SCHEMA.PROFILING;
SELECT * FROM INFORMATION_SCHEMA.PROFILING
WHERE QUERY_ID = @v1;
"
4295,SQL Select column value where other column is max of group,"SELECT *
FROM
(
   SELECT
     *,
     ROW_NUMBER() OVER (PARTITION BY ID ORDER BY value desc) as rn
   FROM
     UnnamedTable
) t
WHERE
   t.rn = 1
"
30155,SQL looping over data to find maximum value (special case),"SELECT 
    * 
FROM x_world as xr
INNER JOIN (
        SELECT 
                x,
                MAX(population)
        FROM x_world as xr
        GROUP BY x 
) as xt ON xt.x = xr.x
GROUP BY village
"
31954,Sysdate function in SQL Insert query,"int j=st.executeUpdate(""insert into mtc (entryDate) values (SYSDATE())"");
"
24990,COUNT function and INNER JOIN on multiple tables,"SELECT COUNT(file_id) as 'Pending files', projects.project_id, projects.project_name, projects.status, projects.start_date

FROM ((project_manager 
LEFT JOIN files 
ON project_manager.mag_id = files.manager_id AND project_manager.mag_id = 11 AND file_status = 'Pending' AND project_manager.project_Id = files.project_id )
INNER JOIN projects
ON projects.project_id = project_manager.project_id)

WHERE project_manager.mag_id = 11
GROUP BY projects.project_id, projects.project_name, projects.status, projects.start_date
ORDER BY projects.status, projects.start_date DESC
"
39636,How can I select the first day of a month in SQL?,"SELECT DATEADD(month, DATEDIFF(month, 0, @mydate), 0) AS StartOfMonth
"
20872,How to use LIKE and NOT LIKE together in a SQL Server query,"SELECT TOP (15) * 
FROM [Users] 
WHERE [codename] LIKE '%Luis%' AND
      [codename] NOT LIKE '%/[LP/]%' escape '/';
"
36876,PK Field Does Not Allow Pivot to Display as 1 Record,"Select item_name, Growth,Leverage
from
(
  select item_name, item_value, decode
  from #Test
  where item_name = 'Threshold'
) d
Pivot 
(
  max(d.decode)
  for d.item_value in (Growth,Leverage)
) as pvt;
"
33695,Checking if a column is not null or empty,"COALESCE(v.file_name,'') != '' AND COALESCE(v.file_last_known_location,'') != ''
"
15181,ORA 00936 Missing Expression,"SELECT book_customer.firstname, book_customer.lastname, 
TO_CHAR(book_order.orderdate,'MM/DD/YYYY') AS ""Order Date"" -- Comma removed here
  FROM book_customer, book_order, order_items, books, publisher
    WHERE (book_customer.customerid = book_order.customerid) 
      AND (book_order.orderid = order_items.orderid)
      AND (order_items.bookid = books.bookid)
      AND (books.pubid = publisher.pubid)
      AND (publisher.publishername = 'printing with us');
"
29245,How can i create boolean column and assign value 1 when creating/altering a column of a mysql table?,"ALTER TABLE tablename CHANGE columnname columnname BOOLEAN DEFAULT '1' NOT NULL
"
24794,MySQL manual change tracking,"CREATE TABLE t1 (
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT ON UPDATE CURRENT_TIMESTAMP
);
"
21983,Restoring SQL table into new table with more columns,"Insert into taggings (id,tag_id,taggable_id,taggable_type,created_at) values (...your values...)
"
31433,SELECT IN THEN ORACLE,"SELECT RA1.RATE, RA1.EFFECTIVE_DATE
FROM RATES_ALL RA1
WHERE RA1.EFFECTIVE_DATE = add_months(&&EFF_DATE, -5)
   OR (RA1.EFFECTIVE_DATE = add_months(&&EFF_DATE, -5)-1
   AND NOT EXISTS(SELECT * FROM RATES_ALL RA2
                  WHERE RA2.EFFECTIVE_DATE = add_months(&&EFF_DATE, -5))
"
24517,sqlite data from one db to another ,"update `1table` 
set url = (select db2.`2table`.url 
           from db2.`2table` 
           where `1table`.name = db2.`2table`.name);
"
19442,Querying data from SQL table basing on other rows values,"SELECT 
    * 
FROM
(
    SELECT p.id AS p_id FROM photo p
    JOIN tag t ON t.photo_id = p.id
    JOIN tag_name tn ON tn.id = t.name_id
    WHERE tn.name = 'Date'
) AS ti
JOIN tag t1 ON t1.photo_id = p_id
JOIN tag_name tn1 ON tn1.id = t1.name_id
WHERE tn1.name = 'Time'
"
21017,Rows multiplication needed,"select t.*
from INVENTORY t
join (select level n from dual 
      connect by level <= (select max(QTY_ON_HAND) from INVENTORY)) 
on n <= t.QTY_ON_HAND
"
33734,code works on emulator but not on Phone,"DatabaseHelper dbh = new DatabaseHelper(context);
        dbh.getWritableDatabase().delete(table, whereClause, whereArgs);
"
15712,In operator matching all rows,"SELECT TypeID 
FROM @MyTable
WHERE TypeID NOT IN (
  SELECT TypeID
  FROM @MyTable t
  LEFT OUTER JOIN [dbo].[Split_String] (@InputString,',') ss
    ON t.UserId=ss.Value
  WHERE ss.Position IS NULL
) x
"
21256,Insert selected multiple records to a table from existing table with another value,"INSERT INTO VoterElection (voterID, elecID, voterType, votingStatus)
     SELECT userID, 1, 'Normal', 'Active' FROM Voter WHERE lgDiv=3;
"
8486,How to add up column data values when using GROUP BY,"SELECT A.CustomerNumber,
       A.Date,
       A.SalesDocNumber,
       A.Amount
       B.CCF
FROM TableA A
INNER JOIN (SELECT SalesDocNumber, SUM(CCF) AS CCF FROM TableB GROUP BY SalesDocNumber) B
ON A.SalesDocNumber = B.SalesDocNumber
"
14990,MySQL Return join of same table with same name,"select 
      s.stud_num, 
      CONCAT(p1.first_name, "" "", p1.last_name) as PROF1, 
      CONCAT(p2.first_name, "" "", p2.last_name) as PROF2
   from 
      students s
         LEFT join prof p1
            on s.prof1 = p1.prof
         LEFT join prof p2
            on s.prof2 = p2.prof
"
684,Are primary keys available in nonclustered indices?,"create index ixBlah on demo (name) include (password);
"
29341,SQL Query Using Minus/Not Exists,"select drinker
  from frequents f
 where not exists (select 1
          from frequents x
         where x.drinker = f.drinker
           and x.bar = 'Henrys');
"
15806,sql to select the the results of an update on a left join,"SELECT ID
    , Lat
    , Lon
    , ISNULL(Area,0)
FROM regionLL
LEFT JOIN regionA
    ON IDll = IDa
"
14163,Transfer data between two database and check not repeated values synchronously,"INSERT INTO [Target]
(
    [FirstName],
    [LastName],
    [PostalCode],
    [DuplicationID]
)
SELECT  
    [Sc].[FirstName],
    [Sc].[LastName],
    [Sc].[PostalCode],
    ROW_NUMBER() OVER (PARTITION BY [Sc].[PostalCode] ORDER BY [Sc].[PostalCode])
FROM 
    [Soruce] AS [Sc]
"
16760,SQL: Find a value based on effective date,"select e.*,
       (select top 1 eh.Role
        from EmployeeHistory eh
        where e.EmployeeId = eh.EmployeeId and
              e.date >= eh.EffectiveDate
        order by eh.EffectiveDate desc
       ) as Role
from Event e;
"
39553,very very hard Query,"SELECT a AS A, b AS B 
FROM tablea 
UNION ALL
SELECT c AS A, d AS B 
FROM tablea 
UNION ALL
SELECT f AS A, e AS B 
FROM tablea;
"
1682,What is the difference between a keyword and a clause in SQL?,"SELECT  col1
        ,col2
        ,col3
FROM yourTable1 AS t1
INNER JOIN yourTable2 AS t2 ON t1.Id = t2.Id
WHERE col1 = 'aaaa'
AND col2 = 'bbbb'
ORDER BY col1
"
3081,PHP MySQL Left Join more fields,"SELECT restaurants.id, GROUP_CONCAT(ResFoodHelper.id) 
FROM restaurants
LEFT JOIN ResFoodHelper ON restaurants.id = ResFoodHelper.resId
GROUP BY restaurants.id
"
21036,"""Column 'option_type_id' cannot be null...""","SET @valor := 10;
SET @op1 := @valor * 2 - 1,@op2 := @valor * 2;
"
5436,update trigger using mysql,"CREATE TRIGGER flag_order_complete AFTER UPDATE ON Sales_Order_Details
FOR EACH ROW
BEGIN
  DECLARE total_balance INT(10);

  SELECT SUM(Balance) INTO total_balance
    FROM Sales_Order_Details
   WHERE Order_ID = new.Order_ID;

  IF (total_balance = 0) THEN
    UPDATE Sales_Order SET Status = 'C' where Order_ID = new.Order_ID;
  END IF;
END;
"
5083,sub string for non English languages,"SELECT CHAR_LENGTH('poca Cosmticos_T2') AS _char_length
     , LENGTH('poca Cosmticos_T2') AS _length

_char_length  _length  
------------  -------
          19       21
"
27169,Simple Query to get exact result,"select 
t1.EmpName as EmoName, t2.EmpName as ManagerName
from   Employee t1 
LEFT join Employee t2 on t1.ManagerId = t2.EmpId
"
27401,(My)SQL: group rows by a given field and force the newest data to be used in the grouped row,"SELECT 
  i.* 
FROM
  invoices i 
JOIN 
  (SELECT 
      order_id,
      MAX(created_at) created_at 
    FROM
      invoices 
 GROUP BY order_id) ii 
ON (
  i.order_id = ii.order_id 
  AND i.created_at = ii.created_at
)
"
13684,Grouping data in SQL Server for particular patterns,"UPDATE o 
SET GroupID = bi.GroupID
FROM OriginalTable o 
    INNER JOIN BulkInsertTable bi 
    ON o.RecNum = bi.RecNum
"
3172,Recursive selection of categories,"WITH RECURSIVE cte_t1 (name, topcategory, Level)
AS
(
SELECT name, topcategory, 0 AS Level
FROM Category
WHERE topcategory = N'ComputerScience'
UNION ALL
SELECT t1.name, t1.topcategory, Level + 1
FROM Category t1, cte_t1 ctet1
WHERE ctet1.name= t1.topcategory
)
SELECT Level, topcategory, name
FROM cte_t1
"
38315,Select union table from same table based on key with oracle,"select au_id, data from tbl
union all
select t2.au_id, t1.data from tbl t1 join tbl t2 on t1.au_id = t2.follow_au_id
"
5400,"Sql order by first, then next","select studentname from table1
order by isedited, ismanuallyadded, studentname
"
4747,Create Table As Select and add an Index SQL Server 2008,"SELECT *
INTO TESTTABLE
FROM my_view;

ALTER TABLE TESTTABLE
ADD PK INT IDENTITY(1,1) PRIMARY KEY;

SELECT *
FROM TESTTABLE;

DROP TABLE TESTTABLE;
"
26132,Writing SQL Server case statement," CASE WHEN BloodPressureSystolic = 0 AND BloodPressureDiastolic = 0 THEN
      CAST(BPSRSit AS VARCHAR(10)) + '/' + CAST(BPDRSit AS VARCHAR(10)) END
"
27510,How do I pivot several different groups of column values in a row into their own single columns?,"SELECT n1,n2,n3,a,b
FROM 
   (SELECT * FROM t1) p
    UNPIVOT (a FOR ACOL IN (a1,a2,a3))AS u1
    UNPIVOT (b FOR BCOL IN (b1,b2,b3))AS u2
WHERE RIGHT(ACOL,1) =  RIGHT(BCOL,1);
"
12562,Can a where clause on a join be used in a view,"select 
    A.Name,
    B.Subscription,
    C.Expiry
from TestTableA as A
    left outer join TestTableB as B on A.ID = B.A_ID and B.Subscription in ('abcd', 'efgh') 
    left outer join
    (
        select min(T.Expiry) as Expiry, T.A_ID
        from TestTableC as T
        group by T.A_ID
    ) as C on A.ID = C.A_ID
"
21306,How can I write a SELECT query with starting row of particular PK?,"SELECT * FROM table WHERE (t.height = last_height AND t.id > last_id) OR t.height > last_height ORDER BY t.height ASC, t.id ASC LIMIT 2
"
15243,Describe table SQL Oracle,"SELECT * FROM ALL_TAB_COLUMNS
WHERE TABLE_NAME = 'MY_TABLE'
AND OWNER = 'MY_SCHEMA';
"
34874,Realm how to make a query for items that have the size of an array bigger than 0?,"RealmResults<User> r1 = realm.where(User.class)
                     .isEmpty(""dogs"")
                     .findAll();
"
3099,How to compare column of two table and insert a value into new table based on comparison in stored procedure in SQL Server,"TRUNCATE table3;
INSERT INTO table3 (ID, ItemCheck)
  SELECT ID, 
         CASE WHEN EXISTS (SELECT 1 FROM table2 t2 WHERE ID = t.ID)
              THEN 'T' 
              ELSE 'F' 
         END
    FROM table1 t
"
3233,MySQL LEFT JOIN dates with order,"SELECT
    s.id,
    s.name,
    s.key,
    s.code,
    m.first_value_generated_at,
    m.last_value_generated_at
FROM sensors s JOIN 
   (SELECT
      sensor_id,
      MIN(generated_at) as first_value_generated_at,
      MAX(generated_at) as last_value_generated_at
    FROM
      measurements
    GROUP BY
      sensor_id
   ) m ON s.id = m.sensor_id
ORDER BY
    s.id
"
7296,How to add auto-increment to column in mysql database using phpmyadmin?,"ALTER TABLE your_table
MODIFY some_column INT NOT NULL AUTO_INCREMENT;
"
1474,Give priority to specific row while fetching via select,"SELECT * FROM LOCATION a
ORDER BY 
   CASE WHEN a.code in ('hyd','blr') THEN 1 ELSE 2 END
"
5311,Need to retrieve 2nd to last word in SQL,"select t.*
from (select t.*, row_number() over (partition by t.id order by ind desc) as seqnum
      from table t outer apply
           splitstring(t.[desc])(str, ind)
     ) t
where seqnum = 2;
"
21537,How to select a table entry which is a substring to a value,"select max(prefix)
from t_prefix p
where '017512345789' like concat(p.prefix, '%');
"
20821,Update data in an Oracle view,"UPDATE TABLE1 SET col1= 'X', col2='Y' WHERE ...
"
38408,Get data from same table with the compare of multiple rows?,"DECLARE @ProjectID int = 1
WITH DirectReports 
AS
(
-- Anchor member definition
    SELECT C.*
    FROM tblProject AS C
    WHERE C.ProjectID = @ProjectID
    UNION ALL
-- Recursive member definition    
    SELECT C1.*
    FROM tblProject AS C1
    JOIN DirectReports AS d ON C1.ProjectID = d.ProjectID
)
-- Statement that executes the CTE
SELECT * FROM DirectReports
UNION ALL
SELECT C.*
FROM tblProject AS C
WHERE C.ProjectID = @ProjectID and C.ProjectID=C.ParentID
"
3000,Django - sorting a list of results from two QuerySet objects,"newlist = sorted(itertools.chain(queryset1, queryset2),
  key=operator.attrgetter('created'), reverse=True)
"
29613,postgresql aggregate of aggregate (sum of sum),"select d.name, sum(s.amount)
from sales s
join department_employees de on de.worker_id = s.worker_id
join departments d on d.id = de.department_id
group by d.name
"
22250,"Usage of Distinct key word, SQL","SELECT Customers.* FROM
Customers JOIN (
  SELECT city, MAX(ID) as id
  FROM Customers
  GROUP BY city
  ) as max_id 
on Customers.ID=max_id.id
"
19538,"postgresql send variables to a function, casting?","SELECT updateGeo2('area', (40.88)::float4, (-90.56)::float4);
"
39551,SQL: Group by date and summing values in a column,"select to_char(StarDate,'rrrr-mm-dd HH24:')||'00'  as DateHour,
    APIName as API,
    sum(StatValue) as Invocations
from STATISTICS
where StatName = 'Invocations' 
group by to_char(StarDate,'rrrr-mm-dd HH24:')||'00', APIName
"
5396,Is there a way to specify location in string when using SQL REPLACE?,"UPDATE table
SET field = (case when right(field, 7) = ',Friday'
                  then left(field, len(field) - 7)
                  else field
             end)


UPDATE table
SET field = (case when left(field, 7) = 'Friday,'
                  then right(field, len(field) - 7)
                  else field
             end)
"
37564,Update table from another table and different database,"UPDATE 
  prc.user, 
  prc_test.user 
SET 
  prc_test.user.pwd_user = prc.user.pwd_user
WHERE 
  prc_test.user.name_user = prc.user.name_user
"
13464,changing the column nullable by a specifique value from a column,"ALTER TABLE <table> ADD CONSTRAINT chk_x_z CHECK (X = 1 OR Z IS NOT NULL)
"
19781,Basic Access Query Sum across fields,"select mscat.itemnumber
,      ( select sum(sumofquantity) from janq where janq.itemnumber = mscat.itemnumber ) as jansum
,      ( select sum(sumofquantity) from febq where febq.itemnumber = mscat.itemnumber ) as febsum
from   mscat
;
"
8244,SQL - LOAD DATA INFILE - UTF8 issue,"LOAD DATA LOCAL INFILE '/path/pet.txt' 
INTO TABLE pet
CHARACTER SET UTF8;
"
30069,CASE expressions on datetime columns,"select CASE 
    when next_action_date between GETDATE() and GETDATE()+7 then 'Incoming'
    when next_action_date < GETDATE() THEN 'Overdue'
    else 'fine' end as Condition
from(
    select GETDATE()+6 next_action_date
)x
"
6293,How do I calulate week of year in Oracle using a non-standard first day of the week?,"to_char(your_date + 2, 'IW')
"
20376,create/ alter from SQL stored procedure,"begin
    for lrec in ( select table_name from user_tab_columns
                  where column_name = 'UNIVERSAL_COLUMN_NAME')
    loop
        execute immediate 'alter table '||lrec.table_name||
                               ' modify UNIVERSAL_COLUMN_NAME varchar2(255)';
    end loop;
end;
"
4360,Check multiple columns for duplicate and list all records,"select * 
from table 
where `day` in
( 
SELECT ID
FROM table 
GROUP BY  Content,`Day`
HAVING COUNT(*) > 1
) A
"
8958,I cannot enable sa account,"USE [YourDatabase]
GO

ALTER LOGIN [sa] ENABLE
GO
"
11393,WHERE clause with strpos,"select variable, col001, col002
from test
where strpos('col001,col002', variable) > 0
"
36939,Trouble with having a subquery with INNER JOIN,"$query = ""SELECT a.player,a.team,a.loc,a.pic,a.rank,b.rating FROM college AS a
          JOIN (
                SELECT player,AVG(rating) AS rating 
                FROM college_rating
                GROUP BY player
               ) AS b
        ON a.player=b.player
        ORDER BY rank DESC LIMIT 20"";
"
16845,Is it possible to find out dependent tables for a view?,"SELECT OBJECT_DEFINITION(OBJECT_ID(N'myview'))
"
34251,Search in Path which created by SYS_CONNECT_BY_PATH in Connect By Prior Query,"SELECT   
GROUP_ID, 
LPAD('-',LEVEL,'-')|| GROUP_NAME GROUP_NAME, 
 SYS_CONNECT_BY_PATH(GROUP_NAME, '->')  GROUP_NAME_PATH  
FROM  GROUPS 
START WITH PARENT_ID IS NULL AND TYPE='G' 
AND GROUP_ID <> 24 /* added condition */
CONNECT BY PRIOR GROUP_ID=PARENT_ID 
AND GROUP_ID <> 24 /* added condition */
"
28462,Left Join Query issue of displaying duplicate results,"SELECT p.person_id, p.person_name, p.instructor_role, IFNULL(lj.company_id, 0) as  company_id, lj.person_id, lj.course_name
FROM person as p
LEFT JOIN courses_by_instructors as lj
      ON (lj.person_id = p.person_id AND lj.company_id = 7 )
WHERE instructor_role = 1
GROUP BY p.person_id,lj.course_name
ORDER BY person_name
"
9664,"SQL integer query, find integer within +/- 1","SELECT integername 
FROM tblintegerlist 
WHERE (integername-<variable>) BETWEEN -1 AND 1
"
24716,"How to get user details from SQL Server session like user ip,host name etc","SELECT *
FROM sys.sysprocesses 
WHERE spid = @@SPID
"
28427,Compilation issue with JDBC under Apache Ant,"strictDelimiterMatching=""false""
"
31901,Select all IDs that have that value in MySQL,"SELECT GROUP_CONCAT(ITEM) AS group_item
FROM (SELECT Table1.ID, Table1.ITEM, Table1.date 
      FROM Table2 Table2 INNER JOIN Table1 Table1
      ON (Table2.ITEM = Table1.ITEM) WHERE table2.ITEM like ""A%"" 
      ORDER BY Table1.id, Table1.date, Table2.ITEM) as temp
GROUP BY ID
HAVING group_item LIKE '%F45%'
ORDER BY ID
"
32675,Limit by running total in SQLite,"select  *
from    YourTable t1
where   20 > coalesce(
        (
        select  sum(amount)
        from    YourTable t2
        where   t2.id < t1.id
        ), 0)
"
19002,remove characters from the table in oracle and update accordingly,"update table set name = regexp_replace(name,'[^[:digit:]]',null)
where  regexp_like (name,'[^[:digit:]]');
"
37918,SQL-Query in SQL Cell,"$SQL = mysqli_real_escape_string($link, $SQL);
"
7538,SQL SELECT from two tables - need join?,"select * from 
(
  SELECT
  E.cid, 
  date, 
  name, 
  gender
FROM Events E
LEFT JOIN Clients C
  ON E.cid = C.cid) t
"
29417,SQL Query to get the Max Date of a certain Status and subract that from the Max Date of another Status,"SELECT
    t.id
    ,DATEDIFF(second, start_time, stop_time) elapsed_sec
FROM (
    SELECT
        ID,
        (SELECT MAX(update_date) from xxx.dbo WHERE status = 'New' AND ID=t2.ID) start_time,
        (SELECT MAX(update_date) from xxx.dbo WHERE status = 'Completed' AND ID=t2.ID) stop_time
    FROM xxx.dbo t2
) t
"
1471,SQL Update via triggers without database locking,"SET TRANSACTION ISOLATION LEVEL SNAPSHOT
or
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
"
5031,MS Access sum of related records,"SELECT VendorPartNumber, Sum(Quantity) as TotalAllocations
    FROM YourTable
    GROUP BY VendorPartNumber
"
6085,Select a nullable bit with a default value,"isnull(bit_column, 0)
"
23614,How can I select the distinct value of two tables?,"SELECT col1 FROM table1 
UNION 
SELECT col1 FROM table2;
"
26561,working days between two date firebird,"select a.start_date, a.end_date, 
   (select count(*)
    from working_days
    where ""DATE"" between a.start_date and a.end_date
    and ""DAY"" = 'working') as nr_of_workdays
from start_end a
"
11797,Rows to mimic Columns,"entity  attribute   value
1       Type        Mini
1       Color       Silver
1       Year        2010
1       Make        Foobar
2       Type        Standard
2       Color       Silver    
etc...
"
3679,Limit results in SQL,"SELECT p1.* FROM Person p1
WHERE p1.id in (
    SELECT TOP 5 p2.id FROM Person p2
    WHERE p2.name = p1.name
)
ORDER BY p1.id
"
10815,telling if key exists in mysql table is taking too long,"select datediff(date,now()) from minute_data  
where EXISTS(SELECT * FROM minute_data WHERE symbol = ""CSCO"") 
AND symbol = ""CSCO"" order by date desc limit 1;
"
32340,SQL Join with multiple row condition in second table,"WITH cte AS (SELECT DISTINCT * FROM Table2)
SELECT t1.""pId"" 
FROM Table1 t1 JOIN cte t2 ON t1.""pId"" = t2.""pId""
WHERE t1.""status"" = 1 AND t1.""keyVal"" = 45
GROUP BY t1.""pId""
HAVING SUM(
  CASE WHEN t2.""mode""=2 AND t2.""modeVal""=5 OR t2.""mode""=3 AND t2.""modeVal""=6 
       THEN 1 END) = 2 AND COUNT(*)=2
"
26872,Oracle's Equivalent to DEFAULT in T-SQL,"CREATE OR REPLACE PACKAGE my_constants
AS
  color_alpha constant integer := 255;
END my_constants;
"
22054,SQL STR() function equality,"select 1 from tblMessage where '210' = STR(210,3)
"
29134,How to group by string ID in sql server 2008,"SELECT LEFT(ID, 8) AS nID,
       SUM(Value) AS tot
FROM your_table
GROUP BY LEFT(ID, 8)
"
30826,Do something with each row and then get union of results - SQL (DB2),"select fsfi.*
from A a cross join
     table(find_something_for_id(a.row_id)) fsfi;
"
8213,Sum and Inner Join with Group by in Sql Server,"select 
    emp_id,
    leaveTypesName,
    allowedLeaves,
    ISNULL((select SUM(datediff(d, FromDate, ToDate)+
                (case when LeaveStatus='Half Day' then .5 else 1 end)) 
    from LeaveEntries b where b.emp_id=a.emp_id and b.LeaveTypeSName=a.leaveTypesName), 0) as LeavesTaken
from EmployeeLeaves2014 a
"
4300,"SQL Server : add row if doesn't exist, increment value of one column, atomic","MERGE YourTable AS target
USING (SELECT @ActionCode, @UserID) AS source (ActionCode, UserID)
ON (target.ActionCode = source.ActionCode AND target.UserID = source.UserID)
WHEN MATCHED THEN 
    UPDATE SET [Count] = target.[Count] + 1
WHEN NOT MATCHED THEN   
    INSERT (ActionCode, UserID, [Count])
    VALUES (source.ActionCode, source.UserID, 1)
OUTPUT INSERTED.* INTO #MyTempTable;
"
37934,sql list number of people born every year,"Select Year, Count(*) as 'Number of people born' From SomeTable
GROUP BY Year
ORDER BY Year ASC
"
34174,Postgresql nested SELECT,"SELECT
  P.pid,
  G.gid,
  P.val
FROM
  Grid          AS G
INNER JOIN
  Points        AS P
    ON  P.val < g.max_val
    AND P.Val > g.min_val
"
13431,"using MIN on a datepart with Group BY not working, returns different dates","SELECT Model, Make, MIN(datepart(year,[Registration])) AS YearRegistered, MIN(SalePrice)
FROM [VehicleSales]
GROUP BY Model, Make
"
770,MySql: Grouping a grouped statement possible?,"select employeeid, sum(short)
from (
   <your sql here>
) sub
group by employeeid
"
106,How to add data from table to string,"declare @myStr nvarchar(max)

set @myStr=(SELECT STUFF((
SELECT '|' + CONVERT(VARCHAR,ID)
FROM @tbl
FOR XML PATH(''), TYPE).value('.', 'NVARCHAR(MAX)'), 1, 1, ''))

SELECT @myStr
"
4965,"Add column from another table, but not affect count()","SELECT reservation.reservation_id, customer.customer_id, customer.name, 
count(ordered_services.reservation_id) AS num_of_ordered_services,
(SELECT count(*) FROM payments WHERE reservation.reservation_id=payments.reservation_id) AS num_of_payments
FROM reservations
JOIN customers ON reservations.customer_id = customer.customer_id
LEFT JOIN ordered_services ON reservations.reservation_id = ordered_services.reservation_id
GROUP BY reservation.reservation_id, customer.customer_id, customer.name
ORDER BY reservation.reservation_id
"
27410,How to set multiple columns to null if they have meet some condition?,"SELECT NULLIF(Child0,Childx) Child0,
       NULLIF(Child6,Childx) Child6,
       ....
FROM dbo.YourTable
"
16450,equivalent of if exists in isqlplus?,"INSERT INTO ANOTHERTABLE (NBR, FNAME, LNAME) 
SELECT  2, 'John', 'Smith'
FROM DUAL
WHERE EXISTS (SELECT ID FROM SOMETABLE WHERE ID = 1)
"
5610,MySQL Join with condition when matching certain value,"SELECT 
    c.name, 
    GDP, 
    CASE WHEN c.name = 'USA' THEN c.GDP ELSE c.GDP/er.rate END AS 'GDP US$'
FROM countries c
LEFT JOIN exchange_rates er ON er.currency = c.currency;
"
8078,SQL Query counting appearances in multiple columns,"SELECT ClickLink1 as Page, 'ClickLink1' as Link, Count(ID) as Count
FROM myTable
GROUP BY ClickLink1
UNION
SELECT ClickLink2 as Page, 'ClickLink2' as Link, Count(ID) as Count
FROM myTable
GROUP BY ClickLink2
UNION
SELECT ClickLink3 as Page, 'ClickLink3' as Link, Count(ID) as Count
FROM myTable
GROUP BY ClickLink3
"
30838,Maintaining date range calculations across rows without looping,"select START_TIME, STOP_TIME,
       max(stop_time) over (order by start_time) as MaxCumStopTime
from t
"
9713,"Using ""case"" with ""or"" in a where clause","select Nom
from tab
where (
    libelle != ''
    and (
        Nom like Nom1
        or Nom like Nom2
    )
)
or (
    libelle = ''
    and Nom like Nom3
)
"
13513,How to construct this query in T-SQL,"SELECT Date, ColumnA, ColumnB
FROM TableName 
WHERE Date = 
  (SELECT max(Date) FROM TableName)
"
34388,Oracle query output is incomplete when spooled to file,"sqlplus > file.txt
"
24830,How can i change datetime format in sql?,"select cast(datepart(year, mydatecolumn)  as char(4)) + '-' 
   + datename(month, mydatecolumn)
from mytable
"
2653,Recurring Selection of rows based on value of the value in previous row,"SELECT id, name, mgrid
FROM emp
START WITH id = 101
CONNECT BY PRIOR mgrid = id
ORDER BY id
"
22254,How to select NEWID() for multiple rows,"select ImportDate,
       case when row_number() over(partition by EntryGUID order by ImportDate) = 1
            then EntryGUID else newid() end as EntryGUID
from(
SELECT DISTINCT  
     Header.EntryGUID,
     Header.ImportDate
FROM table_Name Header
WHERE Header.ID = 'variable')t
"
20547,Generates all dates between two dates stored in a table,";WITH DateRange(DateData, EndDate, Opt) AS 
(
    SELECT StartDate, EndDate , Opt FROM #data
    UNION ALL
    SELECT DATEADD(d,1,DateData), EndDate, Opt
    FROM DateRange 
    WHERE DateData < EndDate
)
SELECT DateData, Opt
FROM DateRange
ORDER BY opt, DateData
OPTION (MAXRECURSION 0)
"
38933,"mysql - get number of occurrences from ""diferent"" query results","Select Name,
       Count(Distinct Rank) as Ranks  
       from TableName
       where Rank=1 or Rank=2 
       Group By Name
"
10119,SSRS 2008 - Empty Textbox if condition is true,"=IIF(Previous(Fields!FieldName.Value) <> Fields!FieldName.Value, 
     Fields!FieldName.Value, """")
"
6223,SQL -- SUM query not returning 0s (MS-Access),"SELECT county_code,
      sum(iif(chem_code = ""465"", lbs_chem, 0))
FROM chem_apps_1991
GROUP BY county_code
ORDER BY county_code;
"
19249,Return all possible combinations of values within a single column in SQL,"select * from t t1 join t t2 on t1.id < t2.id;
"
29929,Combine three SQL queries,"SELECT 
board.id,
COUNT(DISTINCT r_forum_threads.id) AS thread_count,
COUNT(r_forum_posts.id) AS post_count
FROM board 
LEFT OUTER JOIN r_forum_threads ON board.id = r_forum_threads.board
LEFT OUTER JOIN r_forum_posts ON r_forum_posts.thread_id = r_forum_threads.id
GROUP BY board.id
ORDER BY board.position
"
22635,How to force logical sorting in teradata?,"ORDER BY month_event (DATE, FORMAT 'mmm')

ORDER BY 
  CASE month_event
    WHEN 'jan' THEN 1
    WHEN 'feb' THEN 2
    WHEN 'mar' THEN 3
    WHEN 'apr' THEN 4
    WHEN 'may' THEN 5
    WHEN 'jun' THEN 6
    WHEN 'jul' THEN 7
    WHEN 'aug' THEN 8
    WHEN 'sep' THEN 9
    WHEN 'oct' THEN 10
    WHEN 'nov' THEN 11
    WHEN 'dec' THEN 12
  END
"
10986,"trying to get the date of the first and last day of a week, given an arb. date","SELECT to_char(date_col, 'iw') w, trunc(date_col, 'd') st, trunc(date_col, 'd')+6 et
FROM your_table
"
28334,Count items in category A & B (MySQL),"SELECT  COUNT(*) totalCOunt
FROM
(
    SELECT  entry_id 
    FROM    tableName
    WHERE   cat_id IN (3, 5)
    GROUP   BY entry_id
    HAVING  COUNT(DISTINCT cat_id ) = 2
) s
"
6055,SQL - Products with No Sales,"SELECT product.productid
FROM product
LEFT JOIN orderline USING (productid)
WHERE orderline.productid IS NULL
ORDER BY product.productid
"
26921,Optimize mysql query with subquery in values list,"SELECT date, COUNT(user_id) AS numRecords
FROM myTable
GROUP BY date;
"
39626,SQL Sserver : two column have same value in different order and want only distinct combination,"select src, dest
from table t
where src < dest
union all
select dest, src
from table t
where dest > src and
      not exists (select 1 from table t2 where t.src = t2.dest and t.dest = t2.src);
"
37306,MySQL group_concat() ordering by case statement values,"SELECT 
  things.id
  ,group_concat(DISTINCT 
    CASE
    WHEN things.name <> 'United States' THEN 'Non-US'
    WHEN things.name IS NULL THEN 'Unknown'
    ELSE things.name
    END
  ORDER BY 1 SEPARATOR ', ')
FROM things
GROUP BY things.id
"
31190,How to create a List of Values based on a other List of Values?,"select solution d, solution r 
from table 
where example = :<ID of parent select list>
"
22352,Add rows to database dynamically,"_id int primary key autoincrement
"
22782,How to update specific row in datecolumn to date today after update on other column using after update trigger?,"CREATE TRIGGER trigger_name
   ON Table1
   AFTER UPDATE
AS 
BEGIN
      SET NOCOUNT ON;
      IF UPDATE(CustomerProductID) BEGIN
        Update t1
            SET DateMod = GETDATE() 
            FROM Table1 t1 join
                 Inserted i
                 ON Table1.PrimaryKeyColumn = i.PrimaryKeyColumn
      END
END
"
13626,Using CAST with an insert into ... select,"SELECT CAST(columnA AS decimal(7,2))
FROM src 
WHERE columnA <> ''
 UNION ALL
SELECT 0
FROM src
WHERE columnA = '';
"
11523,How to get the STDDEV() of groups of items without the MIN() and MAX() of the group,"select bottle, STDEV(d.count)
from drd.inks d join
     (select bottle, MIN(count) as minc, MAX(count) as maxc
      from drinks
      group by bottle
     ) dsum
     on d.bottle = dsum.bottle and
        d.count not in (dsum.minc, dsum.maxc)
group by d.bottle
"
9012,Select sub-categories from category where sub-cat has multiple parents,"SELECT name, LEFT(parent, INSTR(@parent, ',')-1),
 SUBSTR(parent,INSTR(parent, ',')+1,LENGTH(parent)) from cat WHERE thisCat.ID (**unspecified**) IN (parent)
"
26596,SQL Query Help 1 to N,"SELECT  e.ID, 
        e.Name,
        CASE WHEN ue.EntryID IS NULL THEN 0 ELSE 1 END AS UserFlag
FROM    Entry AS e
        LEFT JOIN user_Entry AS ue
            ON ue.EntryID = e.ID
            AND ue.UserID = x
"
38390,How to select columns that are similar values and calculate quantity and sum of prices,"select Ducumentnumber,Count(quantity) as Quatity,sum(price)
from table1
group by Ducumentnumber
"
18178,how to paste numbers with thousand separator from excel to sqldeveloper table editor,"Sub nospace()

Application.FindFormat.NumberFormat = ""#,##0""
Application.ReplaceFormat.NumberFormat = ""0""

Cells.Replace What:="""", Replacement:="""", _
    SearchFormat:=True, ReplaceFormat:=True

End Sub
"
26436,SQL Inner Join : DB stuck,"SELECT 
op.orders_id, 
p.products_id, 
op.products_name, 
op.products_price, 
op.products_quantity 
FROM orders_products op   
INNER JOIN products p
ON op.products_id = p.products_id 
WHERE p.manufacturers_id = 1 AND 
p.orders_id > 10000 
"
26063,How to select the last 12 months in sql?,"  SELECT sub.name, sub.num
    FROM (SELECT ROW_NUMBER () OVER (PARTITION BY name ORDER BY num DESC) rn,
                 name,
                 num
            FROM tab) sub
   WHERE sub.rn = 1
ORDER BY num DESC;
"
20103,Select entries by day over the last 7 days,"SELECT  DATE(FROM_UNIXTIME(columName)), COUNT(ID) totalCOunt
FROM    tableName
WHERE   DATE(FROM_UNIXTIME(columName)) BETWEEN CURDATE() + INTERVAL -7 DAY AND CURDATE()
GROUP   BY DATE(FROM_UNIXTIME(columName))
"
39679,Can anybody correct sql query?,"SELECT c.name city_name,   
COUNT(v.id) vac_num, (r.id) res_num 
FROM mnk_city c 
LEFT JOIN mnk_vacancy v
ON v.cityId = c.id 
LEFT JOIN mnk_resume r 
ON c.id = r.cityId 
GROUP BY c.name
"
22270,"MySQL query help (join, subselect)","SELECT orders.id, MAX(bookings.end_date)
FROM orders INNER JOIN bookings 
ON orders.id = bookings.order_id 
GROUP BY bookings.order_id
HAVING MAX(bookings.end_date) = '2014-06-30'
"
10082,Select count with join in SQL query,"SELECT table1.admin_name, COUNT(*) as cnt
FROM
  table1 INNER JOIN table2
  ON table1.admin_id = table2.admin_id
GROUP BY
  table1.admin_name
"
27540,MySQL: return first row from join,"select quiz_id, user_id
from users 
where id in(select min(id) from users group by quiz_id)
"
12849,How Select top 2 values from each group in a table with SQL using this specific query,";With Results
AS
 (
    Select D.JeanID, P.Desc
            , P.Price, rn = ROW_NUMBER() OVER (PARTITION BY D.JeanID ORDER BY P.Price DESC)
    FROM Products P inner join Jeans D 
    on D.CHG_I = P.CHGPI
    Where D.CHG_Date=convert(date,sysdatetime())
 )
SELECT JeanID, Desc, Price
FROM Results
WHERE rn <= 2
"
3315,Get IDENTITY value in the same T-SQL statement it is created in?,"CREATE TRIGGER trg_YourTableInsertID ON dbo.YourTable 
AFTER INSERT
AS 
UPDATE dbo.YourTable
SET dbo.YourTable.OtherID = i.ID
FROM dbo.YourTable t2
INNER JOIN INSERTED i ON i.ID = t2.ID
"
12618,MS Access validation rule,"UPDATE yourTable
SET me = LEFT(TNS_Type, 1)
"
37317,Database query on 2 tables,"Select * from tag_details 
   where tag_details_id not in 
                        (Select tag_details_id from movie_tags)
"
8970,How to insert split-ed amount into a table without using loop?,";with numbers as (
   select 1 number
   union all
   select number + 1
   from numbers
   where number < @number_of_installment
)
insert into @installment (amount,due_date) 
select @amount, dateadd(month,number,@date)
from numbers
option (maxrecursion 0)
"
26378,Script to compare Oracle Schema with Teradata Views,"SELECT TableName
FROM DBC.Tables
WHERE Tablekind = 'V'
AND requestText LIKE '%yourtablename%'
GROUP BY 1
ORDER BY 1;
"
38797,How to SELECT all pairs of ID except when IDs are the same or the pair already exist (even in reverse order),"SELECT a.id first, b.id second
FROM myrelation a, myrelation b
WHERE a.id < b.id;
"
3774,How can I get values from few rows to one in SQL Oracle,"select
 max(id),
 max(C_01),
 max(C_02),
 max(C_03)
from 
 tbl
"
10167,if user-defined type is null then select whole table,"select *
from tbl_something
where ( not exists(select 1 from @HaveItemList ) 
        or itemID in (select Defindex from @HaveItemList ))
"
38276,Doctrine ODM: How to select Mongo DB database,"$config->setDefaultDB('mydbname');
"
2301,How to use variable initiated in SQL query?,"Dim db As DAO.Database, rst As DAO.Recordset, sSQLmax As String
sSQLmax = ""SELECT MAX([tablename].rowname) as MaxNum FROM [tablename]""
Set db = CurrentDb

Set rst = db.OpenRecordset(sSQLmax, dbOpenDynaset)

If (rst.RecordCount <> 0) Then
  rst.MoveFirst
  MsgBox ""MaxNumber: "" & rst.Fields(""rowname"")
End If
"
10904,Selecting only such groups that contain certain value,"
 HAVING NOT SUM(FirstName = ""Thomas"") = 0
"
14119,How to update one table in MYSQL from another table? with extra values,"INSERT INTO word(id, name, describe) SELECT id, name, describe FROM temp 
ON DUPLICATE KEY UPDATE SET word.name = temp.name, word.describe = temp.describe;
"
30181,A sql script to startup and shutdown all Oracle services,"SQL>conn system/password 
SQL>shut immediate
ORA-01031: insufficient privileges
SQL>conn system/password as sysdba
SQL>@service.sql
"
13762,Everything is showing rather than what i need,"SELECT `inmate`.`fname`
     , `inmate`.`lname`
     , `facility`.`name`  
FROM inmate LEFT JOIN `prison`.`facility_inmate` ON `inmate`.`inmate_id` = `facility_inmate`.`inmate_id` 
            LEFT JOIN `prison`.`facility` ON `facility_inmate`.`facility_id` = `facility`.`facility_id` 
"
24041,Sorting posts on a WordPress site with custom SQL,"<?php
$args = array(
    'post__in' => array ( 1,2,3) //the Ids
);
$query = new WP_Query($args);
if ($query->have_posts()){
    while ($query->have_posts()) {
        $query->the_post();
        echo get_the_ID().'<br/>';
    }

} else {
    echo 'no posts found';
}
"
25013,How does one detect a non-contiguous number column in a MySQL query?,"SELECT t1.checkno,t1.id,
       IF(@lastCheckNo IS NULL OR @lastCheckNo = t1.checkno - 1,'','*') as outoforder,
       @lastCheckNo := t1.checkno
FROM (SELECT * FROM `table` ORDER BY checkno) t1,(SELECT @lastCheckNo := NULL)variable
"
7388,Search for same Values in two SQL TABLES,"select 
  * 
from 
  table1 t1 
  left join table2 t2 on t1.number=t2.number 
where 
  t2.number is null
"
27253,Query 2 date ranges against the same column in one select statement without using a sub select?,"SELECT CASE WHEN finvdate BETWEEN '6/15/2013' AND '1/15/2014' THEN finvdate ELSE NULL END AS FirstDate,
CASE WHEN finvdate BETWEEN '1/15/2014' AND '04/15/2014' THEN finvdate ELSE NULL END AS SecondDate,
FROM SalesDollars 
"
1048,Sql Count Where Groupby SubQuery,"SELECT item_type.id, item_type.item_type, 
    (SELECT COUNT(item.purchase_transaction_id) - COUNT(item.sale_transaction_id)
     FROM item 
     WHERE item.item_type_id = i.item_type_id) as stock_qty,
    (SELECT COUNT(item.sale_transaction_id) 
     FROM item 
     WHERE item.item_type_id = i.item_type_id ) as sold_qty
FROM item AS i
JOIN item_type ON i.item_type_id = item_type.id
GROUP BY i.item_type_id
"
7494,chaining statements in dynamic sql in oracle,"select 'quote here: ''' , 'double quote'from dual union all
select q'@quote here: ''@', 'q syntax, double quote means two quotes' from dual union all
select q'@quote here: '@', 'q syntax, no need fou double quotes' from dual union all
select 'two quotes here: ''''', 'same thing to have two quotes' from dual union all
select q'@two quotes here: ''@', 'and two quotes with q syntax ' from dual union all
select q'@this is the delimiter char: @.@', 'the delimiter character can be used wherever in the string' from dual union all
select q'@@delimiter is in the beginning and in the end@@', 'you have to double the delimiter if you want it in the end or beginning' from dual
"
32000,Sorting a SQL query by number of fields in a grouped selection,"SELECT product, COUNT(*) AS NumberOfEntries 
FROM Products 
GROUP BY product 
ORDER BY NumberOfEntries DESC
"
28643,SQL query for join table and multiple values,"SELECT Table1.id, COUNT(Table1_Table2.Table2_id)
FROM Table1
JOIN Table1_Table2 ON (Table1_Table2.Table1_id = Table1.id
                   AND Table1_Table2.Table2_id IN (#somelist#))
GROUP BY Table1.id
HAVING COUNT(Table1_Table2.Table2_id) = (#length of somelist#)
"
26365,How do I use on delete cascade in mysql?,"CREATE TABLE `components` (
    `id` int(10) unsigned NOT NULL auto_increment,
    `typeId` int(10) unsigned NOT NULL,
    `moreInfo` VARCHAR(32), 
    -- etc
    PRIMARY KEY (`id`),
    KEY `type` (`typeId`)
    CONSTRAINT `myForeignKey` FOREIGN KEY (`typeId`)
      REFERENCES `types` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
)
"
28977,Sort character-delimited string of variable length,"select * from mytable
order by
  right(number,2)
 ,CAST(LEFT(number,LEN(number)-3) AS int)
"
35342,T-SQL conditional UPDATE (v2),"Update [Message] 
SET    [Subject] = CASE WHEN @SubjectChanged = 1 THEN @Subject ELSE [Subject] END,
       Body = CASE WHEN @BodyChanged = 1 THEN @Body ELSE Body END
WHERE  MessageID = @MessageID
"
32706,Case statement for a date field with Mysql db,"CASE WHEN po_amend_received_date IS NULL THEN 'Pending'  
else  po_amend_received_date 
end as `po_amend_received_date`
"
28857,DevArt dotConnect for Oracle - how to do a WHERE LIKE clause with a parameter?,"cmd.CommandText =
  ""SELECT ID, COLUMN_A, COLUMN_B
   FROM TABLE_A
   WHERE COLUMN_A LIKE '%' || :SearchTerm || '%'"";

cmd.Parameters.AddWithValue(""SearchTerm"", term);
"
13083,Can't figure out a simple SQL query,"select i.* from items i
where i.GroupId = 1
and i.ID NOT IN (
    select ItemID from reports r
    where r.ShopID = 1
    and r.YearID = 2014
)
"
37594,select max version over several fields,"SELECT 
   value, version1, version2, version3
FROM (
   SELECT 
      ROW_NUMBER() OVER (
        PARTITION BY value 
        ORDER BY version1 DESC, version2 DESC, version3 DESC
      ) RN,
      value, version1, version2, version3
   FROM tableName
) T
WHERE RN = 1
"
6684,efficiently find subset of records as well as total count,"WITH q AS (
  SELECT record
  FROM   table
  WHERE  criteria like :criteria
)
SELECT q1.*, q2.*
FROM   q q1
       CROSS JOIN (
         SELECT COUNT(*) FROM q
       ) q2
WHERE  rownum <= :desiredCount
"
23945,Quarter values from previous year,"t1.[Fiscal Quarter ID] = cast((cast(left(t2.[Fiscal Quarter ID],4) as numeric) +1) as varchar)+right(t2.[Fiscal Quarter ID],2)
"
6888,Dynamic database instance in a query,"IF  EXISTS (SELECT * FROM sys.synonyms WHERE name = N'TABLE_SYNONYM') DROP SYNONYM [dbo].[TABLE_SYNONYM]
IF @region_id not in (2,3) CREATE SYNONYM [dbo].[TABLE_SYNONYM] FOR [DB_US].[dbo].[mytable]
IF @region_id = 2 CREATE SYNONYM [dbo].[TABLE_SYNONYM] FOR [DB_EU].[dbo].[mytable]
IF @region_id = 3 CREATE SYNONYM [dbo].[TABLE_SYNONYM] FOR [DB_Asia].[dbo].[mytable]

insert into [dbo].[TABLE_SYNONYM] (...) select ....
"
37709,Matching the beginning characters in a LIKE clause,"select *
from MyTable
where somecol LIKE 'Harris%'
"
36631,Get a particular day from a date range,"declare @DateFrom DateTime = CONVERT(DATETIME, '22/06/2014', 103) 
declare @DateTo DateTime = CONVERT(DATETIME, '28/06/2014', 103) 
;WITH CTE(dt) 
AS 
( 
Select @DateFrom 
Union All 
Select DATEADD(d,1,dt)FROM CTE 
Where dt<@DateTo 
) 

select *,'Monday' as [Day] from cte where datename(dw,dt) = 'Monday'
"
30173,A primary key's issue in mysql,"create table CongViec(
ID_VT int not null,
TenVT text,
loaiVT text,
donvt text,
tinhtrang text, 
xuatxu text, 
soluongton int,
inhhoa text,
ghichu text,
primary key (ID_VT)
);
"
12540,Importing to mySQL causes blank space to convert to '',"ALTER DATABASE YourDatabase CHARACTER SET utf8;
"
15768,Updating Single Row per Group,"with toupdate as (
      select tt.*, row_number() over (partition by OrderNumber order by id) as seqnum
      from #tempTable tt
     )
UPDATE toupdate
    SET toupdate.guestCount = q.guestCount
    FROM toupdate
    INNER JOIN queryTable q
    ON temp.OrderNumber = q.OrderNumber
    where toupdate.seqnum = 1;
"
35831,SQL Server Startup Parameters,"$startupParameters = $wmiserver.Services['MSSQLSERVER'].StartupParameters # YMMV on the service name if you use named instances
        $mtlSetting = $startupParameters.split(';') | ? { $_.StartsWith('-g'
"
10808,How can I replace all values in this string?,"with s as (
select 'Test size=""7"" size=""14"" text size=""14"" line=""22"" other size=""10""  size=""9"" ' as str
  from dual
       )
select regexp_replace(str, 'size=""\d+""', 'size=""8""', 1, 0)
  from s
"
6232,split row_number() over partition over multiple columns,"select
   product,
   price as Price1,
   min(price)
   over (partition by product
         order by price desc
         rows between 1 following and 1 following) as Price2,
   min(price)
   over (partition by product
         order by price desc
         rows between 2 following and 2 following) as Price3
from tab
qualify 
   row_number() 
   over (partition by product
         order by price desc) = 1
"
11658,MYSQL SQL statement. Is this conditional query possible?,"select mt.field1,
    mt.field2,
    mt.field3,
    CASE mt.field2 WHEN 1 THEN wt.widgetname WHEN 2 THEN gt.gizmoname END AS name 
from maintable mt
  left join widgettable wt
    on wt.widgetid = mt.field3
  left join gizmotable gt
    on gt.gizmoid = mt.field3
where mt.field1 = 'param'
   and ((mt.field2 = 1 and wt.widgetid is not null)
       or (mt.field2 = 2 and gt.gizmoid is not null))
"
20790,Tricky sql to select distinct user,"SELECT DISTINCT u1.UserName
FROM Users u1
INNER JOIN Users u2 ON u1.UserName = u2.UserName
INNER JOIN Users u3 ON u1.UserName = u3.UserName
WHERE u1.Value <> u2.Value
AND u1.UserID < u2.UserID
AND u2.Value <> u3.Value
AND u2.UserID < u3.UserID
"
21767,How to show all results except the first one?,"select * from table limit 10000000 offset 1
"
20988,Optimize query to find max timespan between orders,"SQLFiddle demo
select created,Previous_created,
       IF(tsd<>0,SEC_TO_TIME(tsd),0) as diff 
from
(
 select created,
       IF(@prev<>0,TIMESTAMPDIFF(second, @prev,created),0) tsd,
       @prev Previous_created,
       @prev:=created f2 
    from orders,(select @prev:=0) t1 
WHERE created >= '2012-06-01'
order by created
 ) t2 
order by tsd desc limit 100
"
26110,SQL query with operator between and date in a strange format,"SELECT * 
from table 
where 
STR_TO_DATE(date,'%d-%m-%Y %T')  between 
'2015-06-05 00:00:00' and '2015-06-5 23:59:59';
"
22499,Import PostgreSQL dump on OSX," psql -v ON_ERROR_STOP=1

 CREATE DATABASE mynewdb TEMPLATE template0 OWNER whateverowneruser;
 \c mynewdb
 \i /path/to/dump/file.sql
"
6307,NOT IN a specific table using MySQL,"SELECT *
FROM posts p
LEFT JOIN hiddenPosts hp on hp.id = p.id
WHERE hp.id IS NULL
;
"
20000,Change value of table field when value of another field was changed in oracle,"CREATE TRIGGER update_notes
BEFORE UPDATE ON table1
FOR EACH ROW
BEGIN
  IF :new.status = 'Active' THEN 
     :new.notes = null;
  END IF;
END;
"
383,Using AVG() in Oracle SQL,"SELECT *
FROM student
WHERE age > (SELECT AVG(age) FROM STUDENT)
"
10859,SQL parametrised query containing multiple options,"SELECT ... WHERE col1 IN (:c11, :c12, :c13) AND col2 IN (:c21, :c22, :c23);
"
862,SQL query for find out in/out time in a office,"SELECT FirstName,LastName,CardNumber,Department, Date , MIN(Time) AS intime , MAX(Time) AS outtime ,
convert(varchar(8),(convert(datetime,MAX(Time),110) - convert(datetime,MIN(Time),110)),108) AS Duration
FROM CARDENTRYEXITTRANSACTIONVIEW
GROUP BY FirstName, Date,LastName,CardNumber,Department
"
26933,Crosstable missing in Entity Framework?,"myPost.AddTag(myTag);
"
21667,SQL-Server 2008: How to update fields with a counter?,"Update t
Set t.elementorder = t.RowID
From
(
    Select ROW_NUMBER() Over(Order by collectionid) as RowID, * From collections_elements
)t
"
20807,"Using MySQL, is there any way to dump the count of records in each of all 200 tables in a database?","SELECT table_name,
       table_rows
  FROM `information_schema`.`tables`
 WHERE table_schema = '<Your Database Name>'
 ORDER BY table_rows DESC
"
29354,multiple tables in excel worksheet and sql file needed as output,"=""create table ""&B1&""(""&A2&"" ""&B2&"",""&A3&"" ""&B3&"");""
"
25886,Prioritize SQL WHERE clause,"SELECT *
FROM `table`
WHERE x = 'hello' OR x = 'bye'
order by (case when x = 'hello' then 1 else 2 end)
LIMIT 1'
"
9616,insert a random number into each row in table,"update lovalarm
set lovsiteid = TRUNC(dbms_random.value(14300,17300))
"
39787,SELECT information from another query SQL,"SELECT 
    CountValue, 
    count(countValue) TotalRecords
FROM 
  ( 
    SELECT 
        customer_identifier, 
        count(distinct([2nd_customer_identifier])) AS countValue 
    FROM table 
    GROUP BY customer_identifier
  ) a
GROUP BY countValue ;
"
8166,MyBatis Data Mapping. Collection. Relational Tables,"select T.template_name,SUM(R.item_percentage) as Fund_Template_Percentage, 
(CASE T.status WHEN 1 THEN ""Active"" ELSE ""NOT Active"" END) STATUS 
from fund_allocation_template T, r_template_item R 
where T.template_id=R.template_id
GROUP BY R.template_id;
"
17518,Is there a way to use a user-defined variable as a column length in a CREATE TABLE statement?,"SET @my_var = 50;

PREPARE sql FROM '
CREATE TABLE test_table (
    id SMALLINT NOT NULL,
    my_text VARCHAR(' + @my_var + '),
    PRIMARY KEY (id)
);
'
EXECUTE sql;
DEALLOCATE PREPARE sql;
"
10822,How can I make an SQL statement that finds unassociated records?,"SELECT countryID, countryCode 
  FROM tblCountry 
  WHERE countryID NOT IN ( SELECT countryID FROM tblProjectCountry )
"
2604,Select count() max() Date,"With ShiftCounts As
    (
    SELECT ope_id, count(ope_id) ShiftCount
        , ROW_NUMBER() OVER( ORDER BY Count(ope_id) Desc ) ShiftRank
    FROM operator_shift
    WHERE ope_shift_date >=to_date( '01-MAR-10','dd-mon-yy') 
        and ope_shift_date <= to_date('31-MAR-10','dd-mon-yy')
    GROUP BY OPE_ID 
    )
Select ope_id, ShiftCount
From ShiftCounts
Where ShiftRank = 1
"
1062,Sort mySQL table's fields,"ALTER TABLE name ORDER BY something
"
15289,SQL merge row from union result and calculate,"SELECT
  operation,
  SUM(CASE route WHEN 'No'  THEN measurement END) AS MeasurementNo,
  SUM(CASE route WHEN 'Yes' THEN measurement END) AS MeasurementYes,
  SUM(CASE route WHEN 'Yes' THEN measurement END)
  - SUM(CASE route WHEN 'No'  THEN measurement END) AS MeasurementDifference
FROM atable t
GROUP BY
  operation
"
8751,How to convert list of numbers into (temp) table using SQL (SQL Server),"INSERT INTO @temp SELECT * FROM dbo.split(@myList)

SELECT
  *
FROM
  myTable
INNER JOIN
  dbo.split(@myList) AS list
    ON list.id = myTable.id
"
37162,Grabbing the row with the highest value from each group?,"SELECT Group, Color
FROM MyTable t
INNER JOIN (SELECT Group, Max(CAST(Count as int)) as Ct
            FROM MyTable
            GROUP BY Group) Sub
   ON sub.group = t.group
   AND sub.ct = t.count
"
28800,SQL - just view the description for explanation,"SELECT Marks FROM Report WHERE Marks LIKE '%009%' OR '%090%' OR '%900%'
"
19594,Porting from ODP.NET to dotConnect - what's the equivalent of the OracleParameter.CollectionType property?,"OracleParameter parameter = new OracleParameter();
parameter.ParameterName = ""state"";
parameter.Direction = ParameterDirection.Input;
parameter.OracleDbType = OracleDbType.Number; 
parameter.ArrayLength = State.Count;
parameter.Value = State.ToArray();
command.Parameters.Add(parameter);
"
23310,Using sas or sql add new records to table based on monthly date variables,"data expand;
   set <data-name>;
   do time_id = 1 to total_months;
      output;
      end;
   run;
"
10471,Merge 2 columns from different SQL server table with empty lines,"SELECT 
    Datum, LeavetypeID 
FROM 
    Kalender 
LEFT JOIN 
    VerlofLijn 
ON Kalender.ID = VerlofLijn.DagID AND VerlofLijn.Persnummer = @pnummer;
"
9793,SQL to Parse a Key-Value String,"select max(case when LEFT(data, 4) = 'key1' then SUBSTRING(data, 6, len(data)) end) as key1,
       MAX(case when LEFT(data, 4) = 'key2' then SUBSTRING(data, 6, len(data)) end) as key2,
       MAX(case when LEFT(data, 4) = 'key2' then SUBSTRING(data, 6, len(data)) end) as key3
from t
group by (id - 1)/3
"
15636,How can I use two datasources in a CFQUERY?,"SELECT * FROM myTable 
WHERE myField IN 
(SELECT otherField FROM otherDatabase.dbo.tableName)
"
9437,SQL - Reduce the time request,"SELECT  COUNT(CASE WHEN CLOSE < OPEN THEN 1 END),
        COUNT(CASE WHEN CLOSE > OPEN THEN 1 END) 
FROM    eod
WHERE   company_symbol=""AAA"" 
AND     DATE BETWEEN ""0000-00-00"" AND ""0000-00-00"";
"
21367,ADODataSet deleting from joined table,"ADOQuery1.Properties['Unique Table'].Value := 'GAMES';
"
30652,"How to get records if a column has value A, if not then B?","SELECT DISTINCT a.p_id
FROM myTable a
WHERE a.lang = 'fr'
UNION
SELECT DISTINCT b.p_id
FROM myTable b
WHERE b.lang = 'en'
AND NOT EXISTS
(
 SELECT 1
 FROM myTable c
 WHERE c.lang = 'fr'
 AND c.p_id = b.p_id
)
"
26234,Signal from Database,"USE AdventureWorks2012;
GO
IF OBJECT_ID ('Sales.reminder2','TR') IS NOT NULL
    DROP TRIGGER Sales.reminder2;
GO
CREATE TRIGGER reminder2
ON Sales.Customer
AFTER INSERT, UPDATE, DELETE 
AS
   EXEC msdb.dbo.sp_send_dbmail
        @profile_name = 'AdventureWorks2012 Administrator',
        @recipients = 'danw@Adventure-Works.com',
        @body = 'Don''t forget to print a report for the sales force.',
        @subject = 'Reminder';
GO
"
26298,"Getting normalized values from two foreign key fields, SQL, double join?","Select
  Move.ID,
  [From] = FromLocation.Name,
  [To] = ToLocation.Name
From
  Move
  Inner Join Location As FromLocation On Move.[From] = FromLocation.ID
  Inner Join Location As ToLocation On Move.[To] = ToLocation.ID
"
14988,How to select SQL Server row values as columns (Dynamic Pivot),"CREATE TABLE #VALS (
    VALS NVARCHAR(4000)
)

INSERT INTO #VALS
SELECT DISTINCT RGUID
FROM [TABLE]

DECLARE @SQL NVARCHAR(MAX)
DECLARE @VALS NVARCHAR(4000)

SELECT @VALS = COALESCE(@VALS+', ','') + '[' + VALS + ']' FROM #VALS

SET @SQL = '
SELECT SGUID, '+@VALS+'
FROM [TABLE]
PIVOT(MAX(VAL) FOR RGUID IN ('+@VALS+')) PIV'
PRINT @SQL
EXEC (@SQL)
"
32152,Limit the data set of a single table within a multi-table sql select statement,"SELECT e.*, p.num
FROM EMPLOYEE emp JOIN
     (SELECT p.*,
             ROW_NUMBER() OVER (PARTITION BY emp_id ORDER BY emp_id) as seqnum
      FROM PHONE_NUMBER p
     ) p
    ON e.emp_id = p.emp_id and seqnum = 1;
"
4282,Choose rows based on two connected column values in one statement - ORACLE,"select *
from sample
where (upper(supplier),upper(buyer))
in (('A','X'),('A','Y'),('A','Z'),('B','X'),('B','Y'),('B','Z'));
"
15,How can I pass id value of just inserted row to another table?,"INSERT INTO tags_articles
  (tags_id, articles_id)
VALUES
  (..., LAST_INSERT_ID())
;
"
30421,sql concat columns from different tables,"select c.id, concat(c.fname, p.lname) as full_name from
parent p
inner join
child c
on p.id = c.parent_id
"
31900,Oracle SQL get column value associated with max(count()),"SELECT c.climberid AS oakid, STATS_MODE(r.rating) AS skill
FROM climbs c
INNER JOIN routes r ON (c.routename = r.name)
GROUP BY c.climberid;
"
28217,How to select only the characters appearing before a specific symbol in a SQL Select statement,"DECLARE @email VARCHAR(100)
SET @email = 'firstname.lastname@email.com/IMCLientName'

SELECT SUBSTRING(@email,0, CHARINDEX('@',@email))
"
31806,SQL Select Query with single field as formatted and remaining fields as wildcard,"SELECT  DATE_FORMAT(fdate,'%r %d-%m-%Y'), ud.*
FROM    userdetails ud
"
26857,Powershell script to import log file into SQL table,"WITH (CODEPAGE='RAW' ,FIELDTERMINATOR = '|',ROWTERMINATOR = '\n',FIRSTROW = 14,DATAFILETYPE='widechar')""
"
37406,Last day of month with H2,"SELECT DATEADD(dd, -DAY(DATEADD(m,1,@Today)), DATEADD(m,1,@Today))
"
27673,Postgresql regexp_replace 'g' flag,"select regexp_replace('[[good|12345]] [[bad1 [[bad2 [[bad3 [[bad4 [[bad5 [[good|12345]]', '\[\[([^\|]+?(?=\[\[|\Z))', '\1', 'g')
"
34269,Recursive MySQL Query with relational innoDB,"SELECT C.*, CHC.ID_SUBCONTENT
FROM CONTENT C
LEFT OUTER JOIN CONTENT_HAS_CONTENT CHC ON CHC.ID_CONTENT = C.ID_CONTENT
WHERE C.ID = ?
... // you get the idea
"
11554,SQL Server 2012 Group only by one column,"WITH CTE
AS
(
   SELECT 
     OrderID,
     Status,
     DateEdited,
     ROW_NUMBER() OVER(PARTITION BY OrderID ORDER BY DateEdited DESC) rownum
   FROM orders 
   WHERE Status='Pending'
)
SELECT 
  OrderID,
  Status,
  DateEdited
FROM CTE
WHERE rownum = 1;
"
6593,How I can delete repeated rows from database?,"SELECT DISTINCT *
INTO   #TempGood
FROM   Good_

TRUNCATE TABLE Good_

INSERT Good_
SELECT *
FROM   #TempGood

DROP TABLE #TempGood
"
3845,How to add a user defined column with a single value to a SQL query,"SELECT PRODUCT_ID, ORDER_QUANTITY, 999 as USER_VALUE
FROM PRODUCT_TABLE
GROUP BY SALES_DAY
"
19502,Adding an Column Populated by an Arbitrary Value in SQL,"SELECT 234 AS CONSUMER_ID, ACTION_LOG_ID, COMMUNICATIONS_ID 
  FROM consumer_action_log 
 WHERE COMM_TYPE_ID=4 
"
39484,How to check if something is not in the table,"SELECT l.levcode, 
       levnaam, 
       levadres, 
       levwoonplaats 
FROM   leverancier l 
WHERE  l.levcode NOT IN (SELECT b.levcode 
                         FROM   bestelling b) 
"
32559,Remove Varying levels of empty XML tags in SQL Server,"/Whatever/*//*[empty(.//text() | .//attribute())]
"
18041,Update table with if statement PL/SQL,"Update task_table
  set complete_date = nvl2(complete_date,NULL, <**your date**>)
  where task_id = 1;
"
14071,queries in PSQL that gets info from 2 different tables,"    SELECT country.name AS name   
    COUNT(city.name) AS   
    num_cities 
    FROM country 
    JOIN city 
    ON country.country_code =
    city.country_code
    GROUP BY country.nam
    HAVING COUNT(city.name) >=100
    ORDER by COUNT(city.name) ASC
"
34721,Is 20 MB generally enough for a blog database in SQL Server or MySQL?,"          D bytes per database
---------------------------------------  = weeks per database
(N posts per week) x (S bytes per post)
"
4330,Oracle SQL random value from string set,"with strings as (
      select 'string1' as s from dual union all
      select 'string2' as s from dual union all
      select 'string3' as s from dual union all
      select 'string4' as s from dual
     )
select <col1>,
       (select s
        from (select s from strings order by dbms_random.value) s
        where rownum = 1
       ) as RandomString
from dual;
"
4894,Mysql problems with Triggers,"...
begin
INSERT INTO customerbkp(cid,cname,cemail,phone,operation) 
    VALUES (NEW.cid, NEW.cname, NEW.cemail, NEW.phone, 'insert');
end;
...
"
35484,What is the difference between the two SQL queries?,"HAVING studdob = ( 
    select
      min(birthdate)
    from
      pat_Patient s,
      phy_Physician e
    where
      s.PCPPhysicianSID = e.PhysicianSID
      and
      e.PhysicianSID = 26665
  )
"
28429,math expression returns zero,"SELECT 
81234 / 160000 * 100                    AS Try1,
CAST((81234 / 160000 * 100) AS float)   AS Try2,
81234. / 160000. * 100.                    AS Try3
"
24100,Query for retrieving columns with null value,"select case
       when col01 is null
       then 'col1'
       when col02 is null
       then 'col2'
       when col03 is null
       then 'col3'
       when col04 is null
       then 'col4'
       when col05 is null
       then 'col5'
       else null
       end
       which_col
from   tableX
"
13539,Refer to other SQL SELECT statements aliased as tables in FROM clause,"WITH
table1 AS
        (
        SELECT  field1, field2
        FROM    some_table
        ),
table2 AS
        (
        SELECT  field1, field2
        FROM    other_table, table1
        )
SELECT  *
FROM    table2
"
7773,"In Mongoose (node.js MongoDB), how do I perform this update?","for(i in result.reports){
    result.reports[i].uid = 0;
}
result.save();
"
9862,SQL Query Regarding,"SELECT
  Country.CountryId,
  Country.CountryName,
  count(AirportID) AS Airports
FROM 
  Country
  LEFT JOIN city ON Country.CountryId=city.CountryId
  LEFT JOIN Airport ON city.CityId=Airport.CityId
GROUP BY Country.CountryId
"
19583,Is there a way to do a multi table query and get result just from specific tables?,"select a.id, a.column1, b.column2 
from table1 a 
left join table2 b on a.id = b.otherid;
"
16662,Do I need a subselect?,"SELECT b.* 
FROM Bookings b
INNER JOIN (
    SELECT userid
    FROM Bookings
    WHERE destination = ""Greece""
    GROUP BY userid
) aux ON aux.userid = b.userid
"
21292,How to use group by in this cquery?,"SELECT eav.value AS 'unspsc',COUNT( e.sku)
FROM catalog_product_entity e
JOIN catalog_product_entity_varchar eav
  ON e.entity_id = eav.entity_id
JOIN eav_attribute ea
  ON eav.attribute_id = ea.attribute_id
WHERE ea.attribute_code = 'unspsccode'
GROUP BY eav.value
"
11092,mysql: where write order clause in join stuctures?,"SELECT x.name
    FROM (SELECT a.name, a.order, 1 AS sort
            FROM LIST l
            JOIN a ON a.id = list.a_id
          WHERE l.name = 'foo'
          UNION ALL
          SELECT b.name, b.order, 2 AS sort
            FROM LIST l
            JOIN b ON b.id = list.b_id
           WHERE l.name = 'foo') x
ORDER BY x.sort, x.order
"
38095,sql query for string contains in C#,"field LIKE 'Hash.System.Data.DataSet has(%).ds'
"
33962,Concatenating columns and rows together,"SELECT DISTINCT c.Cust, options = ((SELECT c2.opt1 + c2.opt2 
  FROM dbo.myDB AS c2 WHERE c2.Cust = c.Cust 
  FOR XML PATH(''), TYPE).value('.[1]', 'nvarchar(max)'))
FROM dbo.myDB AS c;
"
10248,How can I sequence a column within a table using SQL (MySQL)?," SET @row := -1;
 UPDATE chart
 SET indx = @row := @row + 1
 WHERE report = 2
 ORDER BY indx
"
15507,case statement in sql with multiple joins,"select a, b, table_one.c, d, e
     , table_three.other_column is not null as flag
from table_one inner join table_two on table_one.d = table_two.c
     left join table_three on -- put here the relation rules between table_three
                              -- and the other tables
"
1850,Select all rows from a table where value on a column differs from previous value on that column,"with C
(
  select *,
         lag(mycolumn) over(partition by company_id order by Date) as lagmycolumn,
         lead(mycolumn) over(partition by company_id order by Date) as leadmycolumn
  from YourTable
)
select company_id, Date, mycolumn
from C
where mycolumn <> lagmycolumn or
      mycolumn <> leadmycolumn
"
11889,Optionally join tables in SQL with possible NULL values," DECLARE @SpecCount INT 
 DECLARE @BrandCount INT 

 SELECT @SpecCount = COUNT(*) FROM @SPEC 
 SELECT @BrandCount = COUNT(*) FROM @BRAND 

 SELECT p.*, 
     s.*, 
     b.* 
 FROM @PRODUCT p 
 LEFT JOIN @BRAND b 
     ON b.BRANDID = p.BRANDID 
 LEFT JOIN @SPEC s 
     ON s.SPECID = p.SPECID 
 WHERE ((s.SPECID IS NOT NULL OR @SpecCount = 0) 
     AND (b.BRANDID IS NOT NULL OR @BrandCount = 0))
"
9247,How to run mySQL function to update all rows?,"UPDATE mytable
SET    address = fnStripTags(address)
"
11125,Getting Number of Day in Quarter,"DECLARE @TestDate DateTime

SET @TestDate = 'January 25, 2012'


SELECT DATEDIFF(dd, DATEADD(q, DATEDIFF(q, 0, @TestDate),0), @TestDate) +1
"
22361,MYSQL Query with distinct and max,"SELECT id, `from`, `to`
FROM yourtable
WHERE id IN
(
    SELECT MAX(id)
    FROM yourtable
    WHERE `from` = 'joe' OR `to` = 'joe'
    GROUP BY LEAST(`from`, `to`), GREATEST(`from`, `to`)
)
ORDER BY id DESC
"
9866,postgres - with recursive,"WITH RECURSIVE recursetree(level_id, levelparent) AS (
    SELECT level_id, parent_level 
    FROM level 
    WHERE level_id = 197

    UNION ALL

    SELECT t.level_id, t.parent_level
    FROM level t JOIN recursetree rt ON rt.levelparent = t.level_id
    -- join condition fixed and ANSI-ified above
)
SELECT * FROM recursetree;
"
37100,Filtering my SQL to show only those records > 0,"HAVING ISNULL(max(m.Init_Amnt) - sum(d.Amnt-Appl), 1) > 0
"
19710,Centre or Centre of mass for Geometry points in SQL Server,"SELECT SUM(x)/COUNT(*) as CentreX, SUM(y)/COUNT(Y) as CentreY FROM ...
"
25597,"finding the lowest group of numbers in a row, not just the lowest","SELECT `src`, `value`
FROM
(
    SELECT 'a' AS `src`, a AS `value` FROM yourtable WHERE id = 42
    UNION ALL
    SELECT 'b' AS `src`, b AS `value` FROM yourtable WHERE id = 42
    UNION ALL
    -- etc...
    UNION ALL
    SELECT 'j' AS `src`, j AS `value` FROM yourtable WHERE id = 42
) T1
ORDER BY `value`
LIMIT 3
"
10567,How to get all rows in table which it's contains other row,"WITH cte AS
(
  SELECT id, CAST(name AS VARCHAR(MAX)) name, container 
    FROM Table1 
   WHERE container = 0
   UNION ALL
  SELECT t.id, CAST(p.name + '.' + t.name AS VARCHAR(MAX)), t.container
    FROM Table1 t JOIN cte p
      ON p.id = t.container
)
SELECT name 
  FROM cte 
 ORDER BY id
"
11075,SQL sorting with multiple criteria,"SELECT Tab1.id, Tab1.title
FROM Tab1
JOIN Tab2 t2_val ON t2_val.item_id = Tab1.id AND t2_val.item_key='value'
JOIN Tab2 t2_url ON t2_url.item_id = Tab1.id AND t2_url.item_key='url'
ORDER BY title, 
         t2_val.item_value DESC,
         t2_url.item_value LIKE '%123.com%' DESC
"
35228,How to use Not Equal with CASE statement in SQL query,"ELSE 'Other Expenses'
"
37978,How to add two columns from two separate MS SQL queries with different number of rows,"select ProductID, (inv.Inventory + s.Sales) as BalanceInventory
from
( 
    select  ProductID, Inventory
    from [table]
    where xxx
) inv
left outer join
(
   select  ProductID, Sales 
    from [table]
    where xxx
) s on (s.ProductID = inv.ProductID)
"
28529,refreshing changed db link source (oracle gateway to sql server),"alter system close database link linkname
"
12527,Select Null From A Table When Records May Not Exist,"select distinct
    base.id, 
    Att1.AttributeValue as Attribute1, 
    Att2.AttributeValue as Attribute2,
    Att3.AttributeValue as Attribute3,
    Att4.AttributeValue as Attribute4
from Attributes base
left join Attributes Att1 on base.id = Att1.id and Att1.AttributeType = 1
left join Attributes Att2 on base.id = Att2.id and Att2.AttributeType = 2
left join Attributes Att3 on base.id = Att3.id and Att3.AttributeType = 3
left join Attributes Att4 on base.id = Att4.id and Att4.AttributeType = 4
where base.id = 1
"
24725,Generate guid for a table without a loop,"ALTER TABLE
    [dbo].[Text]

ADD [GUID] uniqueidentifier NOT NULL DEFAULT NEWID()
"
7575,check the consultant_id of the current application user - ORACLE,"SELECT consultant_id
FROM lds_consultant
WHERE cst_name LIKE :app_user || ' %'
"
4528,VB.NET How to get row values from database to textbox (multiline),"  While reader.Read()
     TextBox1.Text &= reader(0).ToString() & Environment.NewLine 
  End While
"
39574,SQL nested count,"$query = ""SELECT COUNT(id), SUM(rating), (SUM(CASE WHEN rating > 0 THEN 1 ELSE 0 END)) 
FROM comments 
WHERE phone='$phone'"";
"
5458,How to optimize delete query (with subquery) in Oracle?," delete from tableA where tableA.fk in (
    select id from (
            select id from tableB where 
                tableB.column1='somevalue' and tableB.date between date1 and date2 and id in (select distinct fk from tableA.fk)

        )
        where rownum < XXXX 
    )
"
19218,The MIN() Function Ms Access,"SELECT WI.*
FROM tblWarehouseItem AS WI INNER JOIN (SELECT whiimtID, MIN(tblWarehouseItem.whiDateIn) AS whiDateIn
          FROM tblWarehouseItem
        GROUP BY whiimtID)  AS MinWI ON (WI.whiDateIn = MinWI.whiDateIn) AND (WI.whiimtID = MinWI.whiimtID);
"
39503,Using LIKE within CASE in TSQL,"SELECT * 
FROM Table
WHERE 
  ((@selctDescription IS NULL OR @selctDescription = '') 
   OR
   (t.[description] LIKE '%' + @selctDescription +'%'))
"
33331,MySQL: How to merge two tables on ID,"select b.*
from b
union all
select a.*
from a
where not exists (select 1 from b where b.id = a.id);
"
4089,UPDATE with JOIN and GROUP_CONCAT,"UPDATE t1 
INNER JOIN (SELECT t2.id, GROUP_CONCAT(t4.language ORDER BY t4.language) languages 
            FROM t2
            INNER JOIN t3 ON t2.id = t3.X_id
            INNER JOIN t4 ON t3.languages_iso2 = t4.iso2
            GROUP BY t2.id
          ) AS t2 ON t1.id = t2.id
SET t1.languages = t2.languages;
"
17769,Group By in MSSQL with the top 10 rows of each group,"SELECT t.id, AVG(u.Age) AS Average, MIN(u.Age) AS Minimum,
       MAX(u.Age) AS Maximum, COUNT(u.id) AS NumberOfUsers
FROM Teams t INNER JOIN
     (SELECT u.*,
             ROW_NUMBER() OVER (PARTITION BY id ORDER BY experience DESC) as seqnum
      FROM Users u
     ) u
     ON t.id = u.id  AND -- is this really the right join condition?
        seqnum <= 10
WHERE t.status IS NOT NULL
GROUP BY t.id
ORDER BY Average Desc;
"
7482,Access query or VBA code to move data from one table to another depending on first row unique identifier,"INSERT INTO tblSurveyReport(FirstName) SELECT FirstName FROM tblSurveyData where FirstColumn = 'A0'

INSERT INTO tblSurveyReport(MiddleName) SELECT MiddleName FROM tblSurveyData where FirstColumn = 'A1'
"
29822,Count across two tables,"select first_name, last_name, count(*) as cnt
from users
inner join bookings on bookings.user_id = user.id
group by user_id
order by cnt;
"
16068,Compare last to second last record for each contract,"SELECT a.contractId, a.Date, a.Value, (SELECT Top 1 b.[Value] 
        FROM tbl b 
        WHERE b.[Date] < a.[Date] And b.ContractID=a.ContractID
        ORDER BY b.[Date] Desc) AS Old_Value
FROM tbl AS a
WHERE a.Date IN 
       (SELECT TOP 1 b.Date 
        FROM tbl b 
        WHERE b.ContractID=a.ContractID
        AND b.Date < #2011/02/11#
        ORDER BY b.date DESC)
"
8269,Materialized Views - Identifying the last refresh,"SELECT owner, mview_name, last_refresh_date
  FROM all_mviews
 WHERE owner = <<user that owns the materialized view>>
   AND mview_name = <<name of the materialized view>>
"
39845,mySQL select distinct and add unique value,"select p.Patient_ID, 
       (@rn := if(@p = p.Patient_ID, @rn,
                  if(@p := p.Patient_ID, @rn + 1, @rn + 1)
                 )
       ) as New_Unique_Value
from t cross join
     (select @rn := 0, @p := -1) params
order by patient_id;
"
16669,SUBSTRING_INDEX equivalent in postgresql,"SELECT split_part(p.url, 'selection=', 2)...
"
22333,Getting sub data from a list of facilities,"select id, name, city, state, selcount from t 
where exists
(
  select 1 from
  (select name, city, state, max(selcount) selcount
     from t 
    group by name, city, state) s
  where s.name = t.name and s.city = t.city and s.state = t.state and s.selcount = t.selcount
)
"
8749,MYSQL employee and dependent," SELECT 
 e.fname
 e.minit
 , e.lname
 , dependent_name
 FROM employee AS e 
 INNER JOIN
 dependent
 ON SUBSTRING(e.minit,1,1) = SUBSTRING(dependent_name,1,1) AND  
 e.sex=dependent.sex AND essn=e.ssn
"
14791,Update local database using remote database data,"create or replace
PROCEDURE       ""LOAD_USERNAME"" 
IS
   cursor usu is
select distinct local_user.userid,your_dblink_table.cod_user
      from local_user, user_table@bdlink your_dblink_table
where local_user.userid=your_dblink_table.codperson
and local_user.externaluserid=local_user.userid;
BEGIN
   for usu_rec in usu
   loop
      update loc_user set username =usu_rec.cod_user
where externauserid=usu_rec.userid;
 end loop;
commit;
END;
"
7621,Selecting 1 From Each Group,"SELECT album 
FROM (
  SELECT DISTINCT album, artist
  FROM songs
)
"
28367,Capturing SQL Statistics Time In A Variable,"SELECT *
FROM sys.dm_exec_query_stats AS qs
CROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) AS st
where st.text = 'Your Query Here'
"
10647,Update value in a column based on another column in the same table in MYSQL,"update t
join (
    SELECT 
    Vid,
    @r:= CASE WHEN Video_id = @g THEN @r+1  ELSE @r:=1 END a_id 
    ,@g:=Video_id
    FROM t,(SELECT @r:=0,@g:=0) t1
    ORDER BY Video_id
) t1
on(t.Vid =t1.Vid)
set t.a_id = t1.a_id
"
26564,Dynamic Update Query in Oracle,"...
, submitted_date = DECODE( in_project_status, 'SUB', SYSDATE, submitted_date )
, approved_date  = DECODE( in_project_status, 'APP', SYSDATE, approved_date )
...
"
29661,how to select a column value as number or vice versa,"select case when col = 'yes'
            then 1
            else 0
       end as new_col_value
from your_table
"
1718,Add Group by and COUNT gives problems,"SELECT STUDENTS.NAME, count(*) 
FROM ORDERS
INNER JOIN STUDENTS
ON ORDERS.STUDENTS_ID = STUDENTS.ID
WHERE BARS_ID = '8' AND DATEORDER = '01-MAY-16'
GROUP BY STUDENTS.NAME;
"
13058,Selecting all data from all columns in a MySQL Database,"select id, attribute, '' AS attribute1 from DB1.Table1
UNION ALL 
select id, attribute, attribute1 from DB1.Table2;
"
39809,Fetch MySQL rows + one before condition,"SELECT  time
FROM    table
WHERE   event LIKE '%event_to_fint%'
UNION ALL
SELECT  MAX(time)
FROM    table
WHERE   time < (
                 SELECT  MIN(time)
                 FROM    table
                 WHERE   event LIKE '%event_to_fint%'
               )
"
3124,Is this sql command I wrote going to join these tables as desired?,"select t1.id, coalesce(t2.value, t1.value) as value
from table1 t1 left join
     table2 t2
     on t1.id = t2.id;
"
24200,rank() a group of items by count(*),"select item, value, c, total, total_by_item, what_i_need
from test 
group by item, value
model
  dimension by (row_number() over (order by null) d)
  measures (
    item, value,
    count(*) c,
    sum(count(*)) over () total,
    sum(count(*)) over (partition by item) total_by_item,
    1 what_i_need
  )
  rules (
    what_i_need[any] = dense_rank() over (order by total_by_item[cv()] desc)
  )
order by 5 desc;
"
12979,How to see the table just modified in a script with Sql Developer,"declare 
a temp.id%type; --name column in your table
cursor c1 is
select id from temp;
begin
  delete from temp;
  insert into temp values (1);
  open c1;
  loop 
  fetch c1 into a;
  dbms_output.put_line (a);
  exit when c1%notfound;
  end loop;
  CLOSE C1;
end;
"
4890,Creating a database through an sql script and then using that database,"CREATE DATABASE MyDatabase
GO
USE [MyDatabase]
"
29545,Parse limits on orQueries,"let colors = [""red"", ""blue"", ""green""]
query.whereKey(""color"", containedIn: colors)
query.limit = 1000  // still the max
"
31562,Django 1.4 primary key conflict after a bulk_create,"select setval('keyword_id_seq', 3); 
"
32009,Check constraint to make sure values in a character column are all digits,"SELECT 1 WHERE 'foo' NOT LIKE '%[^0-9]%'

SELECT 1 WHERE '123' NOT LIKE '%[^0-9]%'

SELECT 1 WHERE 'aa1' NOT LIKE '%[^0-9]%'

SELECT 1 WHERE '1bb' NOT LIKE '%[^0-9]%'

SELECT 1 WHERE NULL NOT LIKE '%[^0-9]%'

SELECT 1 WHERE '   ' NOT LIKE '%[^0-9]%'

--FAIL. Need extra check. Perhaps NULLIF
SELECT 1 WHERE '' NOT LIKE '%[^0-9]%'
"
24678,How to use COUNT(*) function with distinct values?,"SELECT geography, COUNT(DISTINCT children) 
FROM table1
GROUP BY geography
ORDER BY geography
"
16336,Require an explicit value in an UPDATE statement?,"if Update(column)
    --do whay you want;BEGIN....END;
"
23206,how to output image file from database drupal 7?,"$result = db_query(""SELECT myimage FROM example"");
$records = $result->fetchAll();

foreach ($records as  $value) {
    $uri = $value['url'];
    $url = file_create_url($uri);
}
"
10172,GROUP BY - sorting pre and post grouping,"SELECT a.id, a.name, a.[type], a.modified_time
FROM [events] AS a
    JOIN (
        SELECT MAX([events].id) AS id, [events].[type]
        FROM [events]
        GROUP BY [events].[type]    
    ) AS b ON a.id = b.id AND a.[type] = b.[type]
ORDER BY a.modified_time DESC
"
24104,Database design for images,"SELECT COALESCE( b.image, p.imagedata )
FROM buddy b, predefined_images p 
WHERE b.imageID = p.ID
"
4115,sql extremely advanced group query,"select * from 
(
SELECT        TemplateID, SlobID, FromYear, ToYear, ValidFrom As CurrentDate , row_number () over ( partition by TemplateID, SlobID,FromYear  order by ValidFrom desc) rowid
FROM            CommissionsPerTemplate AS CommissionsPerTemplate_1
where  (TemplateID = 2) AND (SlobID = 743)
) as x 
where rowid = 1
"
27578,Index view and execution plan,"Select col1, col2, col3
From dbo.vw_MyView With (NoExpand)
"
29099,rounding SQL decimal zero and then sum,"Select to_char(round(sum(NUMS),2), 'fm9999999.00') 
REQUIRED_OUTPUT from TESTDATA1;
"
30732,Filtering rows with DateTime values that are within 1 minute,"  SELECT yt.username , 
         MAX(yt.logged) AS logged
    FROM YOUR_TABLE yt
GROUP BY yt.username, DATEADD(minute,DATEDIFF(minute,0,logged),0)
"
11055,Combined Left Outer Join and Full Outer Join,"Select Coalesce(TableA.ResourceID, TableB.ResourceID) as ResourceID
     , Coalesce(TableA.Month,TableB.Month) as Month, Cost, Available
FROM TableA OUTER JOIN TableB
    ON TableA.ResourceID=TableB.ResourceID --I want only resources in Table A
        AND TableA.Month=TableB.Month --all months in TableA or TableB
        --but still create a single line for that resource/month
WHERE TableB.ResourceID IS NULL OR TableB.ResourceID IN (SELECT DISTINCT ResourceID FROM TableA)
"
21114,SQL Server: Get table primary key using sql query,"SELECT KU.table_name as tablename,column_name as primarykeycolumn
FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS TC
INNER JOIN
INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS KU
ON TC.CONSTRAINT_TYPE = 'PRIMARY KEY' AND
TC.CONSTRAINT_NAME = KU.CONSTRAINT_NAME
and ku.table_name='yourTableName'
ORDER BY KU.TABLE_NAME, KU.ORDINAL_POSITION;
"
19315,Can I add a foreign key to already existing table with data?,"alter table books add constraint fk_books_authorid
    foreign key (AUthorId) references Authors(ID);
"
38339,Create records duplicates mysql,"INSERT INTO school_entries (`date`,`secondfield`,...)
SELECT 
    `date` + 7 AS `date`,
    `secondfield`,
    ...
    /** 
     * YOU HAVE TO MANNUALLY SELECT ALL REQUIRED FIELDS
     * EXCEPT PRIMARY KEY, OR IF THERE IS ANY UNIQUE FIELDS
     * OTHERISE YOU'LL GET DUPLICATE ENTRY ERROR 
     */
FROM school_entries   
WHERE `date` BETWEEN DATE('$date') AND DATE_ADD(DATE('$date'), INTERVAL 6 DAY) 
"
36362,Using a variable in an SQL query (Oracle DBMS)?,"select
   my_date,
   ...
from(
   select to_date('02.05.2012','DD.MM.YYYY') my_date from dual),
   table2
where
   some_column <= my_date
"
64,SQL Server 2008: Fill multiple T-SQL variables from one SELECT query?,"SELECT TOP (1) @TargetID=ID, @TargetName=Name 
FROM @bigDataSet 
ORDER BY date DESC
"
38807,How do I get column type from table?,"select o.id [tableid], o.name [tableName], c.name [columnName], c.status [columnStatus] t.name [columnType] from sysobjects o
inner join syscolumns c on c.id = o.id
inner join systypes t on t.usertype = c.usertype
where o.type = 'U' and o.name in (tablename)
"
16692,T SQL Convert a row to a string,"SELECT  cast(ID as varchar(10)) + ' ' + [First Name] + ' ' + [Last Name] + ' ' + Color 
FROM    MyTable
"
38963,"SQL to find results where a field contains http:// not preceded by <a href="" or <img src=""?","SELECT Id AS [Post Link], Body
FROM Posts
WHERE REPLACE(
    REPLACE(
        Body,
        '<a href=""http',
        'xxxx'
    ),
    '<img src=""http',
    'xxxx'
)
LIKE '%http://%'
"
14829,"SQL Relations, Triggers and Foreign Keys","CREATE TRIGGER testref BEFORE INSERT ON test1
  FOR EACH ROW BEGIN
    INSERT INTO test2 SET a2 = NEW.a1;
    DELETE FROM test3 WHERE a3 = NEW.a1;
    UPDATE test4 SET b4 = b4 + 1 WHERE a4 = NEW.a1;
  END;
|
"
23911,How to make Password column in Sql Server 2008 case sensitive?,"SELECT [Password]
FROM [Users]
WHERE [Password] COLLATE Latin1_General_CS_AS = 'PaSSWord'
"
18098,"SQL - Return A when B is exactly x,y,z","select A
from t
group by A
having sum(case when B = 'A' then 1 else 0 end) > 0 and
       sum(case when B = 'B' then 1 else 0 end) > 0 and
       sum(case when B not in ('A', 'B') then 1 else 0 end) = 0;
"
35049,"Individual percentage for each item, throughput","SELECT
   unitid,
   COUNT(date) * 100
      / (SELECT COUNT(*) FROM items B WHERE B.unidid = A.unitid) AS Percentage
FROM items A
WHERE date !='Out'
GROUP BY unitid
"
14014,"voting system, relational db, sql query","SELECT `name`, COUNT(table2.voter) AS `count` 
FROM `table1` 
LEFT JOIN `table2` ON table1.idx = table2.support
GROUP BY `name`
ORDER BY COUNT(table2.voter) DESC;
"
39905,How to handle optional parameters in SQL query?,"WHERE m.id_pk = NVL(n_RequiredId, m.id_pk);
WHERE m.id_pk = COALESCE(n_RequiredId, m.id_pk);
WHERE (n_RequiredId IS NULL OR m.id_pk = n_RequiredId);
"
28329,select records with a column with specific value on specific date sql server 2000,"select cola, colb, colc
from yourtable
where cola not in (select cola
                   from yourtable
                   where colb = 'A'
                     and colc < '2013-08-28');
"
20733,Sum datediff and group by,"SELECT T.NAME, SUM(DATEDIFF(HH,T.DATE_DUE,T.DATE_START))as Donation_Hours 
FROM TASKS T  
GROUP BY t.name
ORDER BY name 
"
15801,Having trouble creating a Laravel query,"$user = Auth::user();
$albums = new \Illuminate\Database\Eloquent\Collection;
foreach($user->bands as $band){
    $albums = $albums->merge($band->albums);
}
"
26056,creating sqlite3 dump files with all table values,"sqlite> create table t(x);
sqlite> insert into t values (null), (0), (''), (x'');
sqlite> select * from t;

0


sqlite> .dump
PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE t(x);
INSERT INTO ""t"" VALUES(NULL);
INSERT INTO ""t"" VALUES(0);
INSERT INTO ""t"" VALUES('');
INSERT INTO ""t"" VALUES(X'');
COMMIT;
"
35922,Query to check whether the id exists in a table or not,"IF EXISTS (select * from TESTUSER where Var_LoggedInUser = @pLoggedUserId)
begin
  INSERT INTO TESTUSER (Var_LoggedInUser, Var_MappedUSer)
  VALUES (@pLoggedUserId, @pMappedUser)
end
ELSE
begin
  UPDATE TESTUSER   
  SET Var_MappedUSer = @pMappedUser 
  WHERE Var_LoggedInUser = @pLoggedUserId
end
"
31403,sum on column for records returned from another query,"SELECT SUM(volume) FROM voldata INNER JOIN catkeydata ON 
voldata.key_id = catkeydata.key_id WHERE cat_id = C_B3ZRB0QR 
AND dte = 2013-09-01;
"
29956,Get the last mod_date from MySQL data,"SELECT  a.*
FROM    tableName a
        INNER JOIN
        (
            SELECT name, MAX(mod_date) maxDate
            FROM tableName
            GROUP BY name
        ) s ON  a.name = s.name AND
                a.mod_date = s.maxDate
"
10703,Oracle INSERT INTO using SELECT,"insert into customer_address (customer_no, address_type, customer_name, customer_email)
select customer_no,
       2,
       customer_name, 
       customer_email
from customer_address
where customer_id = 40
  and address_type = 1;
commit;
"
5973,How to return only Numbers from a column that has numbers and letters?,"SELECT DISTINCT REPLACE(Cashregister, 'X', '') Cashregister
FROM   dbo.RPTrs
WHERE  TRSDate > GETDATE()-100 AND
       StoreID = @sname
"
6610,When does a deterministic function use the previous calculated value?,"select ( select get_name(:id) from dual )
   from your_table
"
28142,Oracle TO_DATE not working,"SELECT employee_id, last_name,hire_date
FROM employees WHERE hire_date > TO_DATE('25-JUN-90','dd-mon-RR');
"
36244,Getting Maximum price from minimum date in sql server,"SELECT TOP 1 Price
FROM TempTable
WHERE
  MaterialNo = @MaterialNo
  AND @PassDate >= Date
ORDER BY Date DESC, Price DESC
"
15193,Oracle: Using results of one subquery inside another,"with t1 as 
  (select * from table1 where name  = 'some')
, t1Joint2 as
  (select t1.c1,t2.c2 from t1,  table2 t2 where t1.c1 = t2.c2)
, t1Joint3 as
  (select t1.c1, t3.c3 from t1, table3 t3 where t1.c1 = t3.c3) 
select t1Joint2.c1,t1Joint3.c3 
from t1Joint2, t1Joint3
;
"
6159,For all records in a table how to guarantee at least one record on a foreign key related table?,"create table x (
  x_id integer primary key,
  y_id integer not null
);

create table y (
  y_id integer primary key,
  x_id integer not null references x (x_id)
);

alter table x
add constraint one_to_one
foreign key (y_id)
  references y (y_id) deferrable initially deferred;

begin transaction;
insert into x values (1, 100);
insert into y values (100, 1);
commit;
"
35248,SQL: N-N Select * from table1 and detect if relation exists with the other of a specific user id,"select p.*,
       (case when ulp.id_user is not null then 'Y' else 'N' end) as UserLikesPlace
from places p left outer join
     user_like_places ulp
     on p.id = ulp.id_place and
        ulp.id_user = @IDUSER;
"
24562,Update same row multiple times using MERGE,"UPDATE  P
   SET  Name = ISNULL(TP.Name,P.Name),
        Description = ISNULL(TP.Description,P.Description)
        Output inserted.Id,inserted.Name 
FROM    @Products P
        INNER JOIN @TempProducts TP
            ON P.Id = TP.Id
"
26984,LIKE and NULL in WHERE clause in SQL,"where @Keyword is null or CustomerName like '%' + @Keyword + '%' 
"
15044,how to query mysql on the current week?,"WHERE YEARWEEK(date_accepted) = YEARWEEK(NOW())
"
21763,How to make different mysql row updates based on a list of keys,"update your_table
set online = userID in (list of online IDs)
"
36960,Getting the percentile the item belongs to in SQL,"SELECT
    author,
    [count],
    sum_score,
    PERCENT_RANK() OVER(ORDER BY sum_score DESC) percentile_sum_score,
FROM (
  SELECT
    [by] author,
    COUNT(1) [count],
    SUM(score) sum_score,
  FROM [bigquery-public-data:hacker_news.stories]
  GROUP BY author
)
"
10818,SQL: replace with few records (mysql),"INSERT INTO `com_index` (word, ids)
VALUES ('word1', '2'), ('word2', '2')
ON DUPLICATE KEY UPDATE ids=concat(ids, ' 2')
"
39345,SQL Join Issue return DISTINCT Names,"SELECT var_label AS MyColumn
FROM Values
UNION
SELECT var_code
FROM Codes
"
24361,Get first and last date of a month given any date,"SELECT
  TRUNC(DATE '2013-02-01', 'MM') - INTERVAL '1' YEAR AS one_year_ago_first_day,
  LAST_DAY(TRUNC(DATE '2013-02-28', 'MM') - INTERVAL '1' YEAR) AS one_year_ago_last_day,
  TRUNC(DATE '2013-02-11', 'MM'),
  LAST_DAY(DATE '2013-02-11')
FROM
  dual;
"
28402,Relationship between two tables and their primary keys,"| account         |       | Acc_registration_Info |
| AccID_PK        |       | AccRegInfo_PK         |
| #AccRegInfo_FK  |       |                       |
|                 |       |                       |
"
1430,PostgreSQL: LEFT JOIN does not return entire left table,"SELECT
  a.code,
  count(b.*)
FROM town a 
  LEFT JOIN hospital b ON a.code = b.town_code AND b.type = '01'
GROUP BY a.code
"
18285,Cast collation of nvarchar variables in t-sql,"SELECT CAST('abc' AS varchar(5)) COLLATE French_CS_AS
"
23670,Joining multiple column with multiple column,"SELECT ename, deptno, sal, comm 
  FROM emp 
 WHERE (sal, deptno) IN (SELECT sal, deptno FROM emp WHERE comm IS NOT NULL);
"
10478,"SQL, how can I create a lot of records for a reference join table?","--assuming table is empty, insert 2 records
insert into util_nums values (null);
insert into util_nums values (null); 

insert into util_nums 
select null from     
util_nums,util_nums,util_nums,util_nums,util_nums,
util_nums,util_nums,util_nums,util_nums,util_nums,
util_nums,util_nums,util_nums,util_nums,util_nums,
util_nums,util_nums,util_nums,util_nums,util_nums
"
6279,JOIN across two tables,"SELECT a.vehicle, a.dev_name, dev_model, dev_serial, mac
FROM assets a
LEFT JOIN macs m ON m.vehicle = a.vehicle 
                 AND m.dev_name = a.dev_name
WHERE interface = 'E0'
ORDER BY a.vehicle, a.dev_name
"
2344,SQL - Sum within UNION query,"SELECT null,
sum(IIF(layer='key info',1,0)) AS [Key Info],
sum(IIF(layer='approaches',1,0)) AS [Approaches],
sum(IIF(layer='research',1,0)) AS [Research]
FROM resources
"
8816,mysql- Averaging values every n row with same id,"select computer, max(time), avg(cpu)
from
(
  select 
    @row_number := case when @computer = computer then @row_number + 1 else 0 end as row_number,
    @computer := computer as computer,
    time, 
    cpu
  from mytable
  cross join (select @row_number := -1, @computer := '') as t
  order by computer, time
) as t
group by computer, row_number div 3
order by computer, row_number div 3;
"
13617,Query/Database Optimization: How to optimize this? (and should I use a materialized view?),"select distinct computerId
from groupMemberships m1
join groupMemberships m2 on m2.groupId=m1.groupId
  and (m2.isSharing or m2.userId=m1.userId)
join computers c on c.userId=m2.userId
where m1.userId=?
"
7686,I need to find and replace \n in a mysql field,"UPDATE data set `value` = REPLACE(`value`,'\\n', CHAR(10)) WHERE `key`='shipping_address';
"
34759,TSQL Change column name in sql select statement based on parameter,"IF @DateExpired = 1
    SELECT sens.date1 AS Expired FROM sens
ELSE
    SELECT sens.date1 AS [Due Date] FROM sens
"
6067,How can I dump data that I want of some SQLite3 tables in SQL format?,"CREATE TABLE tmp AS SELECT (field1, field2 ... ) FROM yourTable WHERE ... ;
.dump tmp
DROP TABLE tmp
"
9452,Complex SQL statement forum topic listing,"SELECT ft.*, fr.lastpost_date
FROM forum_topics ft
INNER JOIN (
    SELECT
        fr.topic_id,
        MAX(fr.date) AS lastpost_date
    FROM forum_replies fr
    WHERE (fr.del = 0 OR fr.account_id = 5)
    GROUP BY fr.topic_id
) fr ON fr.topic_id = ft.id
ORDER BY fr.lastpost_date
LIMIT 20
"
6750,Create table to count visits per hour,"create table hits (id1 identity, 
customer_id  int,
visited_on datetime)
"
15107,Get data based on other row,"SELECT
  id,
  Name,
  MAX(CC_Type) OVER (PARTITION BY id, name) AS CC_Type,
  Voided
FROM
  yourtable
"
9025,query from database where aliases result is same with user input,"select *
from (
    SELECT callid, 
           CASE 
              WHEN callid like '%CA%' THEN 'call' 
           END as channel
   from call 
) t
where channel like '%$VEChan%';
"
25091,Is there a way to in Oracle to see what tables have data and which don't?,"SELECT num_rows FROM ALL_TAB_STATISTICS WHERE OWNER = 'user name';
"
21047,Utility to create sql statements,"select *
from INFORMATION_SCHEMA.COLUMNS
where TABLE_CATALOG = <my-db-name>
  and TABLE_SCHEMA  = <table-owner-schema>
  and TABLE_NAME    = <table-name>
order by ORDINAL_POSITION
"
27338,Trigger on every update or insert,"BEGIN
   NEW.ts := concat_ws(' ', NEW.a::text, NEW.b::TEXT, NEW.c::TEXT);
   RETURN NEW;
END;
"
34223,"Can I have a temp column with ""Y"" or ""N"" result?","select
  case when LastKnownWellDate is null then 'N' 
       else 'Y' end as TempColumnLastKnownWell
from 
  mytable
"
38523,Select column based on sum of another column,"SELECT SalesManagerId, ProductId, Total
FROM (
  SELECT SalesManagerId,
         ProductId, 
         SUM(SaleAmount) as Total,
         RANK() OVER(PARTITION BY SalesManagerId 
                     ORDER BY SUM(SaleAmount) DESC) as R
  FROM <Table name>
  GROUP BY SalesManagerId, ProductId) as InnerQuery
WHERE InnerQuery.R = 1
"
13866,"SQL UPDATE all rows, except some rows, in table with composite primary key","UPDATE Products SET Active = CASE WHEN
      (Id_A = 1 AND Id_B = 1 AND Id_C = 1) OR
      (Id_A = 1 AND Id_B = 2 AND Id_C = 1) OR
      (Id_A = 5 AND Id_B = 8 AND Id_C = 3) OR
       .
       .
       .
       THEN 1 ELSE 0 END
"
26982,How can I use an alias name in a SUM Statement?,"SELECT /*stuff*/
  , ISNULL (a.z, a.y) AS ""c1""
  , SUM(a.x - ISNULL (a.z, a.y)) AS ""c2""
/* more stuff */
"
31045,Oracle: select * from (select table_name from ... )?,"select
       table_name,
       to_number(
         extractvalue(
           xmltype(
             dbms_xmlgen.getxml('select count(*) c ' ||
                                ' from '||owner||'.'||table_name))
           ,'/ROWSET/ROW/C')) count
   from all_tables
  where table_name like 'MY_TABLE_%'
"
6001,SQL: Select A when in A and not B or select B when in A and B,"SELECT 
    CASE WHEN b.iPurchaseOrderLineId IS NOT NULL THEN 'b' ELSE 'a' END AS [Source],
    a.iPurchaseOrderLineId,
    ISNULL(b.sProductDescription, a.sProductDescription) AS [sProductDescription]
FROM PurchaseOrderLine AS a
    LEFT JOIN GoodsIn AS b ON a.iPurchaseOrderLineId = b.iPurchaseOrderLineId
                           AND b.dDateDelivered = GETDATE()
WHERE b.iPurchaseOrderLineId IS NOT NULL 
      OR a.dRequiredDate = CONVERT(DATE, GETDATE())
"
15004,How to COUNT column values differently in a VIEW?,"SELECT
    COUNT(*) AS Total,
    SUM(CASE WHEN Observation = 'Positive' THEN 1 ELSE 0 END) AS Positive,
    SUM(CASE WHEN Observation = 'Negative' THEN 1 ELSE 0 END) AS Negative,
    SomeOtherColumn
FROM your_view
GROUP BY SomeOtherColumn
"
17168,SQL - Outer join one table onto two others,"SELECT * FROM order_header
INNER JOIN order_line ON order_header.header_id = order_line.header_id
LEFT OUTER JOIN inventory ON order_line.product = inventory.product AND order_header.location = inventory.location
WHERE order_header.header_id = xxx
"
25685,trouble using count() and group by,"SELECT maker,
       MIN(type) AS type
FROM Products
GROUP BY maker
HAVING COUNT(DISTINCT type) = 1
       AND COUNT(DISTINCT model) >1
"
24039,SQL autoincrement in 'string',"id | log
1  | 345;234;234
"
10400,Summary of a day or run a query and sum the results?,"select EmpId, sum(Amount) as Amount, DateOfProduction 
from ProductionTable
group by EmpId, DateOfProduction.
"
37712,Tips to optimize this .NET crawler algorithm,"Dim myListOfLinks As New List(Of String)
...
TheCommand.Parameters.AddWithValue(""@listOfLowerCaseLinks"", myListOfLinks)
"
34211,Worst SQL Ever,"DELETE FROM table
"
39269,How to get the length of a database column?,"SELECT CHARACTER_MAXIMUM_LENGTH, NUMERIC_PRECISION, NUMERIC_SCALE FROM information_schema.columns WHERE TABLE_NAME = 'your_table_name'
"
1496,Need 8 characters form a lengthy RegKey path - Invalid length parameter passed to the LEFT or SUBSTRING,"SELECT left (Y.S, charindex ('\', Y.S) - 1)
from Table1
outer apply (
 select CHARINDEX ('\System\', KeyPath0) as pos
) X
outer apply (
 select substring (KeyPath0, X.pos + 8, 9999) as S
) Y
"
37095,Find duplicates within a specific period,";WITH cte AS
 (
  SELECT ID, Person, LOG_TIME,
         DATEDIFF(d, MIN(LOG_TIME) OVER (PARTITION BY Person), LOG_TIME) AS diff_date
  FROM dbo.Log_time
  )
SELECT *
FROM cte
WHERE diff_date BETWEEN 1 AND 6
"
7223,Need to get rows where combination of two columns both exist and don't exit,"select ac.id1, ac.id2, count(ac.id1) as cnt
from (select distinct id1 from AllCovered) ac1 cross join
     (select distinct id2 from AllCovered) ac2 left join
     AllCovered ac
     on ac.id1 = ac1.id1 and ac.id2 = ac2.id2
group by ac.id1, ac.id2;
"
32879,how to get excel to treat a date as a date not a string when doing CopyFromRecordset,"SELECT CAST(date_text AS DATE) FROM TestExcelDates;
"
169,Concat sql result in one row Oracle 10g,"SELECT (RTRIM(XMLAGG(xmlelement(X, comments||',')order by sortorder, F.id).extract('//text()'),',')) list
from ( 
SELECT DISTINCT  1 sortorder, 
       f.id,
       F.comments 
  from flight F, task 
  WHERE F.id = task.flight_id 
  and task.name like 'BO%' 
  AND F.comments IS NOT NULL
union all  
SELECT 2, f.id, T.comments 
  from  flight F, task T  
 where F.id = T.flight_id 
 and T.name like 'BOS%' 
 AND T.comments IS NOT NULL  )
"
37545,SQL Query - Combined rows with selective columns [MySQL],"SELECT
  players.Game AS Game,
  players.Name AS Name,
  'W' AS Result,
  'F' as Stage
FROM
  MyTable stage
  JOIN MyTable players
    ON stage.Game = players.Game
WHERE
  stage.stage = 'F'
  AND players.result = 'W'
"
9000,Update Query to match string to column Name,"DECLARE @sqlCommand varchar(1000)
DECLARE @column varchar(50)

SET @column = 'foo' 
SET @value = 'bar'

SET @sqlCommand = 'UPDATE TABLE SET ' + @column + ' = ' + @value 
EXEC (@sqlCommand)
"
24006,SQL select orders depending on status and date,"SELECT o.*
,SUM(os.name ='shipped') shipped
FROM 
orders o
LEFT JOIN orders_status os USING(order_status_id)
WHERE o.date_addded  < '2014-04-01'
GROUP BY o.order_id
HAVING shipped =0
"
29729,Find strings within text in SQL,"select ID from tablename
where 'Twinkle, twinkle, little star, How I wonder what you are! Up above the world so high, Like a diamond in the sky.'
LIKE CONCAT('%', word, '%');
"
24153,Transpose Pivot in T-SQL,";With cte As
(
  Select UnitID, WeekNumber,
    'Week'+cast(weeknumber as varchar(2)) wn
  From @temp

)
Select UnitID, [Week1], [Week2], [Week3]
From cte
Pivot
(
  Max(WeekNumber) 
  For wn In ([Week1], [Week2], [Week3])
) As pvt;
"
11187,sql query for generating user info,"select 
    T.userid,
    T.value as name,
    T1.value as age,
    T2.value as gender
from your_table as T
    left outer join your_table as T1 on T1.userid = T.userid and T1.key = 'age'
    left outer join your_table as T2 on T2.userid = T.userid and T2.key = 'gender'
where T.key = 'name'
"
13153,Constraint on subtype attribute (Oracle),"CREATE OR REPLACE TYPE x_typ AS OBJECT (record_type varchar2(1)) NOT FINAL;
/

CREATE OR REPLACE TYPE y_typ UNDER x_typ (attribute1 number) ;
/

create table x_table (x_col x_typ);


alter table x_table add constraint x_cons 
  check ( 1 = case when x_col is of (y_typ) then 
      treat (x_col as y_typ).attribute1 else 1 end);
"
20313,PostgreSQL: Create an index on timestamp::DATE,"CREATE INDEX event_creation_time_date_idx ON event ((creation_time::DATE));
"
35725,"How to get data from last hour, last day and last month with one query?","select sum(case when timestamp between now() - interval 1 hour and now() then 1 else 0) hourly,
       sum(case when timestamp between now() - interval 1 day and now() then 1 else 0) daily,
       sum(case when timestamp between now() - interval 1 month and now() then 1 else 0) monthly
from   your_table
"
18910,Strange behaviour for db2 query for timestamp data type,"SELECT * 
FROM Sample
WHERE lastModifiedDate >= TIMESTAMP('2012-04-03 07:59:50')
AND lastModifiedDate < TIMESTAMP('2012-04-03 07:59:50)' + 1 SECONDS
"
21190,Oracle SQL Case Statement in Where Clause,"select *
  from mrcontract2
 where term_date >= sysdate
   and eff_date <= sysdate
"
21218,Cannot get the updated field value from database in C#,"Session.Close();
"
13055,Compare rows and calculate column of same row,"SELECT add * ((CASE Fun1 WHEN 'Abc' THEN 1 ELSE 0 END) + 
              (CASE Fun2 WHEN 'Abc' THEN 1 ELSE 0 END) + 
              (CASE Fun3 WHEN 'Abc' THEN 1 ELSE 0 END)) AS total
FROM   mytable
"
18130,Concatenate columns if not equal,"SELECT IIf([colA] = [colB], [colA], [colA] & '(' & colB & ')') AS formattedCol 
FROM mytable WHERE
"
4099,How can I work out what curdate() in MySQL is returning?,"SELECT CURDATE();
"
21020,Update duplicate rows,"UPDATE YourTable p
       JOIN(SELECT t.id,t.name,count(*) as rnk
            FROM YourTable t
            INNER JOIN YourTable s on(t.name = s.name and t.id <= s.id)
            GROUP BY t.id,t.name) f
       ON(p.id = f.id)
SET p.name = concat(p.name,'-',f.rnk)
WHERE rnk > 1
"
22477,How to get an input (like firstname) from user in Telegram bot?,"$content    = file_get_contents(""php://input"");
$update     = json_decode($content, true);

$chatID         = $update[""message""][""chat""][""id""];
$userName       = $update[""message""][""from""][""first_name""];
$userMessage    = $update[""message""][""text""];
"
26083,How to trim text from SQL Server select statement for text consisting of two letters and five digits?,"SELECT 
    SUBSTRING(col, PATINDEX('%[a-zA-Z][a-zA-Z][0-9][0-9][0-9][0-9][0-9]%', '' + col), 7)
FROM TEST
WHERE PATINDEX('%[a-zA-Z][a-zA-Z][0-9][0-9][0-9][0-9][0-9]%', '' + col) <> 0
"
14204,Three columns in two tables to four columns in one table,"SELECT 
  COALESCE(i.location, e.location) AS Location
, COALESCE(i.[date], e.[date]) AS [date]
, SUM(i.amt_recd) AS amt_recd
, SUM(e.amt_spent) AS amt_spent
FROM income I
FULL OUTER JOIN expense e
  on i.location = e.location
  and i.date = e.date
GROUP BY 
  COALESCE(i.location, e.location)
, COALESCE(i.[date], e.[date]) 
"
16185,Sql query need code,"select E.Department_ID, count(*), max(E.Employee_Salary), avg(E.Employee_Salary), min(E.Employee_Salary)
    from employee E
    inner join department D on E.Department_ID = D.Department_ID
    group by E.Department_ID
"
26705,Getting the sum of a column based on another column,"select your_original_columns, 
sum(SumOfProfit) OVER(PARTITION BY Customer) AS 'Total'
...
"
21734,How do I delete all duplicate rows without a primary key?,"create table TempTable as
    select distinct * from MyTable;

truncate table MyTable;

insert into MyTable
    select * from TempTable;
"
17475,Using two databases for an application in grails,"class MyController {

   def dataSource_foo

   def list = {
      String nameSql = ""select name from emp where id=3345""
      Sql sql = new Sql(dataSource_foo)
      def rows = sql.rows(nameSql)
      ...
   }
}
"
24869,How to know (programmatically) when a query is done on PostgreSQL/Amazon Redshift?,"select pid, trim(user_name), starttime, query
from stv_recents
where status = 'Running'
order by starttime ASC; 
"
27855,Single SQL query with input tvp parameter when tvp doesn't contain any row,"select f.*
from FinDocument f
where f.id in (select id from @id_list) or
      not exists (select 1 from @id_list);
"
3827,Any way to get null(empty) columns using IN condition in oracle? without using is null?,"select empno, ename, job 
from employee 
where nvl(job, 'NULL') in('SALESMAN', 'MANAGER', 'NULL')
"
8440,Displaying score from sql android using textview,"String[] stringArray = hs.getAllScores();
String tempString = """";
    for(String string:stringArray){
tempString = tempString+string;//this will give you a string with all string
    }
score1.setText(tempString);//this will set the textView with everything
"
30340,How to combine 2 SQL statements into a single statement,"SELECT ...
FROM tableA
WHERE id IN (
   SELECT id from tableB...
   UNION ALL <---note this
   SELECT id from tableC...
)
"
31632,How to create excel export using sql query?,"c:\>sqlcmd -S servername -i c:\path\yourqueryfilename.sql -o C:\OutputPath\AFilename.csv -s"",""
"
22779,SQL Group rows based on column value,"SELECT count(EmployeeID) as EmployeeCount, Address FROM table GROUP BY Address
"
24775,Checking multiple rows against each other in MySQL,"SELECT b.*
FROM buildings b
INNER JOIN (SELECT DISTINCT building_id FROM reports WHERE status = 1) r
ON B.building_id = r.building_id
"
16413,SQL split a result properly,"Declare @recordsPerPage AS int
SELECT @recordsPerPage = 10000;
SELECT
    *,
    ROW_NUMBER() OVER (PARTITION BY NumeroDeclaration ORDER BY NumeroTransaction ASC) AS Tempnum,
    NumeroDeclaration+1 AS Page
FROM numbered
"
14222,How to optimize oracle query from partitioned table?,"SELECT * FROM TABLE T
WHERE T.FDATE BETWEEN TO_DATE('1.6.2011', 'DD.MM.YYYY') AND TO_DATE('30.6.2011', 'DD.MM.YYYY');
"
30356,android: final score and high score,"public long getHighScore(){
SharedPreferences pp = PreferenceManager
            .getDefaultSharedPreferences(context);


if(score>pp.getLong(""highscore"",0l)){
    Editor pe=(Editor) pp.edit();
    pe.putLong(""highscore"",score);
    pe.commit();
    return score;
 } else {return pp.getLong(""highscore"",0l);}

}
"
12844,Add an overall average row to Report Builder report,"=Sum(Fields!numOfStudents.Value * Fields!avgGpa.Value)
  / Sum(Fields!numOfStudents.Value)
"
7644,SQL How to get Player VS Player Game Count from a Games in a Relational Database,"select count(*) as NumOfGames
from
(
select gameid,count(*)
from 
(
    select gameId,playerId
    from PlayersByGame
    where gameId in
    (
        SELECT gameId from GameInformation
        where numberOfPlayer =2
    )
    AND
    playerId in
    (
        select id from Players
        where Name in('Dainon','Andy')
    ) 
) as A
group by A.gameId
having count(*) =2
) as B
"
37369,Can Oracle PL/SQL CASE statement include a SELECT query?,"SELECT a.number, 
       (CASE WHEN EXISTS (SELECT null FROM some_table b where b.num_val = a.number)
             THEN 'Y'
             ELSE 'N'
        END) AS YES_NO 
    FROM some_other_table a;
"
435,How to write a sql query that returns data if only there are enough rows of data,"WITH cte
     AS (SELECT *,
                Row_number()
                  OVER (
                    ORDER BY id) AS rowid
         FROM   <tablename>)
SELECT *
FROM   cte
WHERE  EXISTS(SELECT 1
              FROM   cte
              WHERE  rowid >= 5) 
"
8977,Limit the field that are syncronized,"ALTER TABLE Employee
ENABLE CHANGE_TRACKING
WITH (TRACK_COLUMNS_UPDATED = ON)
"
30364,To get date from datetime in sql,"WHERE YEAR(datecreated) = YEAR(GETDATE())
  AND MONTH(datecreated) = MONTH(GETDATE())
  AND DAY(datecreated) = DAY(GETDATE())
"
25412,Help with SQL query,"select a.DeviceID, a.RoomID, a.DateInstalled as fromDate, 
    ISNULL((select DATEADD(day,-1,MIN(DateInstalled)) from myTable
            where DeviceID = a.DeviceID
            and RoomID <> a.RoomID
            and DateInstalled > a.DateInstalled),'') as toDate
from myTable a
"
18103,SQL Server query syntax with single quote,"SELECT make,model FROM Cars WHERE model = 'CEE''D'
"
10518,how can I search string with double single quotes (sql),"select * from city where locationcity='St. John''''s'
"
7187,Help with SQL and table optimization,"CustomerFriend
customerFriendID  customerID  friendID
1                 1           2
2                 2           1
3                 3           1
"
34423,How to select and insert values in mysql using stored procedures,"DELIMITER //
CREATE PROCEDURE updateTableC()
BEGIN       
       INSERT INTO c (gender, purpose_abroad_as_per_recorded_travel, country_name)
       SELECT a.gender, b.purpose_abroad_as_per_recorded_travel, b.country_name 
       FROM b   LEFT JOIN a
       ON b.person_id=a.id;
END//
DELIMITER ;
"
14580,troubles with insert query,"insert into TClientPaymentHistory
select idcontract,
       idclient,
       last_paid_time,
       paid,
       CASE 
         WHEN DATEDIFF(day, last_paid_time, 'tell date here') <= something THEN 0
         ELSE 1
       END AS late     
from TClientsPayments
"
16493,update one table according to data from another table,"UPDATE table1
SET v2 = 99
WHERE v1 in (select v1 from table1
intersect select v3 from table2);
"
16733,"How to pass number of lines in ""select level from dual connect by level < ""?","SELECT t1.number 
FROM t t1
JOIN (SELECT LEVEL FROM dual CONNECT BY LEVEL<=(SELECT MAX(number) FROM t)) t2 
ON t2.level<= t1.number;
"
18624,Select the latest record for each category linked available on an object,"select *
from tblMachineReports t
where LogDate = (select max(LogDate) from tblMachineReports t2 where t.machineID = t2.machineID and t.category = t2.category)
"
32703,"SQL Using to_char(null), to_number(null), etc in set operators with Oracle","SELECT e.employee_id ""Employees with Dependents"",
  e.first_name,
  e.last_name,
  d.birthdate ""Dependent Birthdate""
FROM employees e join
     dependents d
     on d.relative_id = e.employee_id
"
36937,Oracle/SQL Couting multiple colums grouped by a common column,"select thing,
       count(case action when '_A_' then 1 end) as a,
       count(case action when '_B_' then 1 end) as b
from <table>
group by thing
"
23556,Using a function in a where-clause,"SELECT * FROM 
(
SELECT userId, SUM(costs) as sum_costs, 
(SELECT SUM(payed)
FROM payments p WHERE ta.userId=p.userId) as sum_payed
FROM ta 
GROUP BY ta.userId
)a
WHERE a.sum_costs <> a.sum_payed 
--ORDER BY a.userId;
"
5936,Sql -after group by I need to take rows with newest date,"SELECT * FROM (
    SELECT t.*,
    ROW_NUMBER() OVER ( PARTITION BY t.1st_num,t.2nd_num,t.3rd_num order by t.cancel_flag asc,t.opening_date desc) as row_num
    FROM YourTable t ) as tableTempName
WHERE row_num = 1
"
20810,What colums to index for a JOIN with WHERE,"SELECT *
FROM partners JOIN
     orders
     ON partners.partner_id = orders.partner_id
WHERE orders.date BETWEEN '2014-04-01' AND '2014-05-01';
"
19301,return all the columns in a MySQL table in a string format,"select group_concat(column_name separator ', ') 
from information_schema.columns 
where table_name = 'course' 
group by table_name
"
18295,Record filtration issue,"select * from agents a
where railenabled = 1     --assuming 1 means enabled
and not exists (select 1  --not exists to remove all agents whose users have RAL enabled
                from userpermissions b
                where a.companyid = b.companyid
                and b.modulecode = 'RAL'
                and b.enabled = 1
                );
"
668,rank over partition,"select 
     A. CUST_TYPE
    ,A.CINSERT_DT
    ,A.CNTCT_ID

from CONTACTINFO a

JOIN  CONTACTMAP B
ON A.CNTCT_ID = B.CNTCT_ID
JOIN custlist as c
ON b.CUSTNUM = c. CUSTNUM

--maybe remove the condition and add CUST_TYPE to PARTITION BY if you want one row per type
where A.CUST_TYPE in (PAYER)

qualify
  rank()
  over (partition by c.CUSTNUM 
        order by CINSERT_DT desc) = 1
"
39340,Unexpected results when using Replace(),"REPLACE(REPLACE(REPLACE(REPLACE(NetworkMemberId COLLATE 
Latin1_General_CS_AS,'','e'),'' COLLATE Latin1_General_CS_AS,'i'), 
'' COLLATE Latin1_General_CS_AS,'o'),'' COLLATE 
Latin1_General_CS_AS,'n')
"
37504,combining two case queries into one,"SELECT i, 
CASE 
WHEN ((MONTH(CURRENT_DATE )) = SUBSTRING(yearmonth,6))THEN 
  CASE
      WHEN DAY(CURRENT_DATE) = 1 THEN `day1_value`
      WHEN DAY(CURRENT_DATE) = 2 THEN `day1_value`
  END 
END Y
FROM dp;
"
5379,SQL Selecting based off largest date from different table,"SELECT ...,
    OR500100A.OR50004 AS TargetDate
FROM ...
INNER JOIN OR500100 AS OR500100A ON OR500100A.OR50001 = OR010100.OR01001 
    AND NOT EXISTS(SELECT 1 FROM OR500100 AS OR500100B 
                   WHERE OR500100B.OR5001 = OR010100.OR01001 
                   AND OR500100B.OR50004 > OR500100A.OR50004)
...
"
27864,MySQL : How to select record where begin date and end date between two dates of mysql,"select rate_discount 
from rate_eb 
where rate_min_stay <= abs( datediff( reb_date2, reb_date1 ) )
and reb_date1 between rate_starts and rate_ends
and reb_date2 between rate_starts and rate_ends
"
5327,Sum of Distinct count in Oracle,"select  count(distinct cust_id) as total_distinct_cust_id,
        count(distinct product_id) as total_distinct_prod_id
from    cust_product_dtl
"
11469,postgresql select query in procedure is not working with dynamic value,"server ilike '%'||server1||'%'
"
25236,SQL search column where one item in column is substring of another item,"select * 
from tbltest 
where ' '+platform+' ' like '% item %'
"
36281,"SQL update - leaving out MIN amount of records, based on multiple conditions","update NewsState set expired = news_id in (
  select news_id
  from (
    select *, row_number() over (order by date desc)
    from News
  ) n
  where  date > (now() - interval '24 hour')
     or  row_number <= 50
);
"
12773,SQLite (select): i don't get it,"select vocbox._id, vocbox.name, ln.name as native, lf.name as foreign, count(_id_vocbox) as count
from vocbox
left join vocable on vocable._id_vocbox=vocbox._id
left join language as ln on ln._id = vocbox.native
left join language as lf on lf._id = vocbox.foreign
group by vocbox._id;
"
36143,SQL Table return number of items with review number ID,"SELECT count(*) as TotalReview, ID  -- change ID to the unique id for the page
FROM gg_reviews
GROUP BY ID  -- change ID to the unique id for the page
"
35688,SQL Relationship Cardinality in Logical Design," Order table
 ----------------------------------------
 Orderid.  OrderDate. Customermnum
 ----------------------------------------
  1.       04/22/2013 101

 Order detail table
 ----------------------------------------
 Orderid.  Productid.  Qty.   quotedprice
 ----------------------------------------
  1.       T101       1       500
"
8898,Delete all rows except specifics,"INSERT INTO main_sec_new
SELECT
   *
FROM main_sec 
WHERE main_sec IN ('118','Companies')
and type = 'SWOT'
"
22900,Using COUNT and UNION to extract data and support a scenario,"select CustomerId, VoucherId, MinimumSpendAmount, ValidFromDate, ValidToDate
from dbo.discountvoucher
where ValidFromDate <= 15/11/2013
and ValidToDate >= 15/11/2013
and CustomerId in
    (select CustomerId
    from dbo.discountvoucher
    where ValidFromDate <= 15/11/2013
    and ValidToDate >= 15/11/2013
    group by CustomerId
    having sum(case when MinimumSpendAmount > 0 then 1 else 0 end) = 1
    and sum(case when MinimumSpendAmount = 0 then 1 else 0 end) = 1
    )
order by CustomerId
"
28272,SQL - Group By ID and transform Rows to Columns,"SELECT  ID, 
        MIN(CASE WHEN Cat = 'Small' THEN 'Small' END) Small,
        MIN(CASE WHEN Cat = 'Medium' THEN 'Medium' END) Medium,
        MIN(CASE WHEN Cat = 'Large' THEN 'Large' END) Large
FROM YourTable
GROUP BY ID
"
3868,Arranging Data according to their page number in reports,"select Code,Dense_Rank() Over (order by [Code]) Page from TableName
"
12554,Can I sacrifice consistency to allow concurrent 'insert or update' and read access to a single table with SQL Server?,"BEGIN TRY
  UPDATE tbl
  SET    tbl.AccessTime = GETDATE()
  FROM   SchemaName.TableName tbl
  WHERE  tbl.ResourceKey = @ResourceKey;

  IF (@@ROWCOUNT = 0)
  BEGIN
    INSERT INTO SchemaName.TableName (ResourceKey, AccessTime)
    VALUES (@ResourceKey, GETDATE());
  END;
END TRY
BEGIN CATCH
  IF (ERROR_NUMBER() <> 2627) -- 2627 = Violation of PRIMARY KEY constraint
  BEGIN
    ;THROW;
  END;
END CATCH;
"
21070,Execute stored procedure named as a string,"declare @sql varchar(512);
set @sql = 'exec ' + @GetDD;
EXEC (@sql);
"
37811,Converting date to string SQL,"SELECT a.*
FROM xx a, xy b
WHERE a.payment_date = TO_DATE(b.check_date, 'mm/dd/yyyy')
"
24462,different ways to perform this query?,"select e.Event_ID, t.*
from Events e
left join Tasks t ON e.Event_ID=t.RelatedGateID
where e.Event_IsPhase = 1 or t.RelatedGateID is not null
"
38799,SQL Programming,"$sql = ""SELECT (smt-smth) as diff, smth, smths, smthss FROM sometbl WHERE smt='$smt' AND smts='$smts'"";
"
4291,Update all columns with the value of NULL,"UPDATE SAMSUNG
SET description = 'square'
WHERE description IS NULL
"
7980,MySQL syntax for Join Update,"UPDATE Reservations r JOIN Train t ON (r.Train = t.TrainID)
SET t.Capacity = t.Capacity + r.NoSeats
WHERE r.ReservationID = ?;
"
35281,"SQL Server, Oracle8i syntax","select  '''' + convert(varchar,event_key) + '''' +',' as Event_K
from mytable
"
21488,SQL query with count() from another table,"SELECT  a.id, a.name, a.views,
        COUNT(b.pic_id) TotalVotes
FROM    pictures a
        LEFT JOIN votes b
            ON a.id = b.pic_id
GROUP   BY a.id, a.name, a.views
"
26614,Refactoring the a subquery within a select statement to a join,"select data.WidgetName,
     case when link.id is not null then 1 else 0 end as selected
from Widget_data data
left outer join Widget_link link
    on data.ID = link.data_id and link.productId = 1
where data.expired=0 or link.id is not null
"
27299,How to enumerate returned rows in SQL?,"SELECT
    ROW_NUMBER() OVER(ORDER BY age) AS RowNumber
        ,count(*) as usercount 
    from users 
    group by age
"
9099,SQL - assorting data,"SELECT  
    CONTACTS.name,
    EMAILS.email
FROM 
CONT_EMAIL INNER JOIN CONTACTS 
ON CONT_EMAIL.name_ID = CONTACTS.ID
INNER JOIN EMAILS
ON CONT_EMAIL.email_ID = EMAILS.ID
ORDER BY CONTACTS.name;
"
28309,SQL how to group by with a special condition,"GROUP BY CASE
             WHEN REGEXP_LIKE(username, '^\d+$') THEN 'GRP_OTHERS'
                                                 ELSE username
         END
"
35233,SQL using where contains to return rows based on the content of another table,"SELECT * FROM Stores s
WHERE EXISTS (
    SELECT * FROM Countries
    WHERE CONTAINS(s.Address1, Town) OR CONTAINS(s.Address2, Town)
)
"
32003,How to speed up this update sql statment,"merge into s_general
using (
  select county, id_section, rec_no, f306
  from upd_g307
  where id_section between 14000 and 15000    
) t on (t.id_section = s_general.Id_section and t.rec_no = s_general.rec_no and t.f306 = s_general.F306)
when matched then update 
    set g307 = upd_g307.county 
where g307 is null;
"
796,"SQLite - update (not replace) if exists, else insert","INSERT OR REPLACE INTO link (word1, word2, n)
SELECT 
    x.word1, x.word2, x.n + COALESCE(l.n, 0)
FROM ( SELECT '%s' AS word1, '%s' AS word2, %d AS n ) x
LEFT JOIN link l ON x.word1 = l.word1 AND x.word2 = l.word2
"
32724,Select 1 record where two records have the the same values in different columns,"select ""station_1_I"", ""station_2_I"" from mytable
intersect
select ""station_2_I"", ""station_1_I"" from mytable 
             where ""station_2_I"" < ""station_1_I""
"
21482,SSRS SQL I need to display data for dates used in the parameter and the previous month,"SELECT xxxx, yyyy, zzzz
, DATEADD(month, DATEDIFF(month, '2000-01-01', createdOnDate), '2000-01-01')  as MonthCol
FROM tables
WHERE (createdOnDate>= prevStart and createdOnDate<=prevEnd)
 OR (createdOnDate>= dateStart and createdOnDate<=dateEnd)
"
2620,How to show sub query columns,"SELECT * 
from switch_person 
join project on PTPK = PK
where TeamLead  = 1 and status = 1
"
20250,LinqPad4 does not show results,"testing.Dump();
"
32475,MySQL count columns in table by name,"SELECT COUNT(*) 
FROM INFORMATION_SCHEMA.COLUMNS 
WHERE COLUMN_NAME LIKE '%name%'
   AND table_schema = 'DB_NAME'
   AND table_name = 'TABLE_NAME'
"
8694,Coalescing rows based on field value in row,"SELECT 
    t1.year_end,
    t1.entity_type,
    t1.ratetype,
    COALESCE(t2.taxrate, t1.taxrate)
  FROM
    Rates AS t1
LEFT JOIN
    Rates AS t2 ON
        t1.year_end = t2.year_end
        AND t2.entitytype IS NULL
WHERE t1.year_end = @year
    AND t1.entitytype = @entitytype
"
30979,How to select possibly non-existant row in a mysql join,"select c.*, p1.PREFERENCE_VALUE as VALUE1, p2.PREFERENCE_VALUE as VALUE2 
  from 
    COMPANIES 
    inner join PREFERENCES p1 
      on c.ID = p1.COMPANY_ID and p1.PREFERENCE_VALUE = 1
    left outer join PREFERENCES p2 
      on c.ID = p2.COMPANY_ID and p2.PREFERENCE_VALUE = 2
   where 
     COMPANIES.ID = 1;
"
37638,Name column not matching in query,"SELECT
    w2001.Code AS Code2001,
    w2011.Code AS Code2011,
    w2001.Name
FROM
    w2001 LEFT JOIN w2011
    ON w2001.Name = w2011.Name
UNION
SELECT
    w2001.Code AS Code2001,
    w2011.Code AS Code2011,
    w2011.Name
FROM
    w2001 RIGHT JOIN w2011
    ON w2001.Name = w2011.Name;
"
30636,Best Isolation Level to avoid deadlocks using an UPDATE sentence in Sql Server 2005,"READ UNCOMMITTED
"
23022,Oracle SQL Count based on conditions,"select
  ass.VALUE as LOCATION,
  COUNT(DISTINCT cab.RECORD_ID) as CABLE_COUNT
from
  PROJECT_TABLE cab
  inner join PROJECT_TABLE ass on ass.RECORD_ID = cab.PARENT_RECORD_ID
where
  cab.FORM_NAME = 'cable' and
  ass.FORM_NAME = 'asset' and -- should always be the case?
  ass.FIELD_NAME = 'location'
group by
  ass.VALUE
"
1848,Insert Unique PRNG into Db column,"select @max := max( RandomId ) from Products;
update Products set RandomId = @max := @max + Rand() + 1;
"
34958,Mysql composite key order relevance,"mysql> create trigger insert_check_associations before insert on associations
-> for each row
-> begin
-> if new.email1>new.email2 then
-> set @a = new.email2;
-> set new.email2 = new.email1;
-> set new.email1 = @a;
-> end if;
-> end;//
"
35057,I have a excel file and want to delete some data before the first <br /> tag,"Sub sample()

    Dim str_Val As String
    Dim start As Long
    str_Val = ""Donkeys are <a href=""""#"""">also</a> humans <br /> hello hello hello <br /> hey hey hey""
    start = InStr(1, str_Val, ""<br />"", vbTextCompare) + Len(""<br />"")
    MsgBox Right(str_Val, Len(str_Val) - start)
End Sub
"
6056,Equivalent of SQL loader in MySQL,"LOAD DATA INFILE
"
4695,How to SELECT FROM WHERE last record = x?,"SELECT *
FROM dossiers B
JOIN dossiers_etat as C
ON B.id = C.id_dossier
WHERE B.disp = ""Y"" AND C.open = ""Y"" AND C.incharge = ""-""
AND C.date = (SELECT max(date) from dossiers_etat WHERE id_dossier = C.id_dossier)
ORDER BY B.id DESC
"
24930,how many types of joins are there in mysql or sql,"1. Inner Join or Equi join
2. Self Join
2. Outer Join
   outer join is again classified into
   a) Left Outer Join
   b) Right Outer Join
   c) Full Outer Join
3. Cross join
"
19296,SQL query to find duplicates,"select * 
from File 
where hash in (select 
               hash 
               from File
               group by hash
               having count(*) > 1)
"
35540,good way to store tags in relational database when there are variable numbers of tags associated with each piece of information,"SELECT tag_name FROM tags WHERE id IN (SELECT tag_id FROM sentence_tag WHERE sentence_id = $sID);
"
39117,Query issue (row values to columns) in PostgreSQL,"SELECT a.id
      ,max(CASE WHEN myorder = 1 THEN result END) AS result_1
      ,max(CASE WHEN myorder = 2 THEN result END) AS result_2
      ,max(CASE WHEN myorder = 3 THEN result END) AS result_3
FROM   mytab
GROUP  BY id
ORDER  BY id;
"
11696,SQL sort string with numbers certain pattern first,"SELECT * FROM category 
ORDER BY (CASE WHEN cat_name LIKE 'Level%' THEN 0
ELSE 1
END)ASC,
LEFT(cat_name,LOCATE(' ',cat_name)), CAST(SUBSTRING(cat_name,LOCATE(' ',cat_name)+1) AS SIGNED),
  cat_name ASC
"
17479,Assign Values of a column in SubQuery in SQL,"SELECT 
  Producer = p.PRODUCER_NAME, 
  Products = STUFF((
    SELECT ',' + pr.PRODUCT_NAME 
      FROM dbo.PRODUCT AS pr
      WHERE pr.PRODUCER_ID = p.PRODUCER_ID 
      FOR XML PATH('')).value('.[1]','nvarchar(max)'),1,1,'')
FROM dbo.PRODUCER AS p;
"
27396,Getting rid of duplicate subqueries in UNION in SQL,"with MatchWithScores as (
      select . . .
     )
select . . .
from ((select . . . from MatchWithScores)
      union all
      (select . . . from MatchWithScores)
     ) hv
"
8503,PL/SQL time segment calculation,"select extract(hour from numtodsinterval(to_date('14:00:00','HH24:MI:SS') - to_date('13:15:00','HH24:MI:SS'),'DAY'))
||':'|| extract(minute from numtodsinterval(to_date('14:00:00','HH24:MI:SS') - to_date('13:15:00','HH24:MI:SS'),'DAY')) diff
from dual
/

DIFF
------------------

0:45
"
8708,SQL query to get distinct rows from multiple tables,"SELECT c.id, c.name 
FROM Company c
WHERE EXISTS
(SELECT 1
 FROM Branch b
 WHERE c.id = b.cid AND b.profit > 100)
"
19815,Replacing multiple charcters in one field with one query,"UPDATE Table
    SET Table.Field = Replace(Replace(Replace(Field, '[', ''), ']', ''), '<', '')
"
29634,Updating rows from a list of values,"=""update table set status='"" & c2 & ""' where id_1 = '""& a2 & ""' and ID_2 = '"" & b2 ""'""
"
29786,How to insert data from one column into another column in a different table,"ALTER TABLE LESSON ADD SPORTNAME VARCHAR(30); // or whatever type it is
UPDATE LESSON l JOIN SPORT s USING(SPORTNO) SET l.SPORTNAME = s.SPORTNAME;
"
39862,Inserting data into sql from csv files or insert data direct from remote computer into SQL Server,"Import-Module -Name '\\SCRIPTSERVER\C$\Windows\system32\WindowsPowerShell\v1.0\Modules\Invoke-SQL'
"
21639,SQL Server: select query from multiple tables,"SELECT u.ID, u.Name 
FROM [User] u
WHERE NOT EXISTS ( SELECT *
                   FROM [project_employee] pe
                   WHERE pe.project_id = 9 
                     AND pe.employee_id = u.ID);
"
10595,SQL synonym to scalar function,"Assembly (CLR) Stored Procedure
Assembly (CLR) Table-valued Function
Assembly (CLR) Scalar Function
Assembly Aggregate (CLR) Aggregate Functions
Replication-filter-procedure
Extended Stored Procedure
SQL Scalar Function
SQL Table-valued Function
SQL Inline-table-valued Function
SQL Stored Procedure
View
Table1 (User-defined)
"
34150,SQL Server SUM of Multiple rows with where and group by,"select Items, SUM(TotalOrder) as [TotalOrder], SUM(CancelOrder)as [CancelOrder] 
from Details 
where Items NOT IN('Laptop','Desktop','Tablet')  group by Items 
UNION 
select 'Laptop',SUM(TotalOrder) as [TotalOrder], SUM(CancelOrder)as [CancelOrder] 
from Details 
where Items IN('Laptop','Desktop','Tablet')
"
37079,Unable to query between three tables,"SELECT m.table_id, table_name, table_image, table_image_big, table_description 
FROM tables m 
LEFT JOIN reservation ON reservation.selectedTable = m.table_id 
WHERE table_rest = '$restaurant_id' 
AND reservation.status is NULL"";
"
5791,select row from table and substitute a field with one from another column if it exists,"SELECT A.id, COALESCE(
  ( SELECT max(B.title) FROM B WHERE
    langcode = 'nl' AND B.table_a_id = A.id), A.name ) as name
FROM  A
WHERE A.id = 5
"
20157,Getting Specific Results in Output,"SELECT p.name, m.mags
FROM people p, peoplewhosub ms, magazines m 
WHERE p.portid = ms.line and ms.service = m.scode 
  AND p.portid IN (
    SELECT line
    FROM peoplewhosub 
    GROUP BY line
    HAVING COUNT(*) > 1
);
"
22614,sql server: Is this nesting in a transcation sufficient for getting a unique number from the database?,"declare @Result int
EXEC @Result =
sp_getapplock @Resource = 'holdit1', @LockMode = 'Exclusive', @LockTimeout = 10000 --Time to wait for the lock
IF @Result < 0
BEGIN
ROLLBACK TRAN
RAISERROR('Procedure Already Running for holdit1 - Concurrent execution is not supported.',16,9)
RETURN(-1)
END
"
33324,(My)SQL multiple in-depth left join,"SELECT DISTINCT s.PLATFORM_ID, l.GAME_ID
FROM Games g 
LEFT JOIN Links l ON g.ID = l.GAME_ID
INNER JOIN Stores ON l.STORE_ID = s.STORE_ID
INNER JOIN PLATFORMS p ON s.PLATFORM_ID = p.ID
"
22487,Join two similar tables,"SELECT * 
FROM Table1 
LEFT JOIN Table2 ON Table1.ITEM_ID = TABLE2.PRODUCT_ID AND Table1.BUYER_ID = Table2.USER_ID 
WHERE Table2.PRODUCT_ID IS NULL
"
35712,Common Record from 2 tables in SQL Server,"SELECT *
FROM table1 
JOIN (SELECT id, SUM(amt) as amt FROM table2 GROUP BY id) t2
ON t1.id = t2.id AND t1.amt=t2.amt
"
38181,MySQL Order by count of rows,"select id
from (
  select `to` id, `from` contact
  from msg
  union all
  select `from`, `to`
  from msg
  ) t
where contact = 2
group by id
order by count(1) desc
limit 2
"
6291,Oracle Syntax to Postgres Help,"CREATE VIEW PLANNED AS
   SELECT s.asp_space_nm,
          SUM(o.mo_tkr_total_off_scheduled) 'total_planned'
     FROM SPACE s
LEFT JOIN OBJECTIVE o ON o.asp_space_nm = s.asp_space_nm 
                     AND o.mo_msn_class_nm = 'EPIC'
 GROUP BY s.asp_space_nm
"
29042,Have a subquery return a row instead of a column,";WITH LastEmails
AS
(
   SELECT *, 
     ROW_NUMBER() OVER(ORDER BY Timestamp DESC) rownum
   FROM Emails
   WHERE Contact = @emailId
     AND (IsSent is null OR isSent = 0)
)
SELECT * FROM LastEmails
WHERE rownum = 1;
"
20905,oracle call stored procedure inside select,"BEGIN
   FOR c IN (SELECT field1, field2 FROM mytable) LOOP
       my_proc(c.field1, c.field2);
   END LOOP;
END;
"
34561,SQL SELECT distinct rows from a table by multiple columns ignoring columns order (significance),"select FirstName,LastName from People where FirstName <= LastName
union
select LastName,FirstName from People where LastName < FirstName
"
7398,"How to track which tables/views/etc depends from a table, in Oracle","SELECT NAME
from user_dependencies
where referenced_name = 'PRICE'
"
321,Query to update row which contains maximum column value in MS SQL 2008,";WITH CTE AS
(
    SELECT  *,
            MAX(C2) OVER(PARTITION BY C1) MaxC2
    FROM YourTable
)
UPDATE CTE 
SET C3 = CASE WHEN MaxC2 = C2 THEN 1 ELSE 0 END
"
36284,How to get values from the xml value without mentioning its attribute's name in select statement,"select
   Cust.value('*[1]', 'int') AS 'ItemID',
   Cust.value('*[2]', 'Varchar(50)') AS 'Customer Name'
from @xmlval.nodes('/ArrayOfCustomers/Customer') as AOC(Cust) 
"
4014,Database: delete specific data,"delete from user where last_online <= '2011-01-01'
"
27762,MongoDB selection with existing value,"db.testcoll.find({$where:""this.actor.languages.indexOf(this.language.value) >= 0""})
"
8123,SQL User Transactions,"SELECT UserId, MAX(TIMESTAMP) 
FROM ACCTRANS
GROUP BY UserId
"
26991,Find the distance between two points in MYSQL. (using the Point Datatype),"where GLength(LineStringFromWKB(LineString(asbinary(utm), asbinary(@mypoint)))) < 9999999999999;
"
4990,Get the remaining rows,"SELECT N.mobile, B.name, count(*) as Total FROM records as R
LEFT JOIN business as B ON B.id = R.business_id
LEFT JOIN numbers as N ON N.id  = R.numbers_id 
GROUP BY N.mobile, B.name

UNION

SELECT N.mobile, NULL, 0
FROM numbers AS N
LEFT JOIN records as R ON N.id = R.numbers_id
WHERE r.numbers_id IS NULL

UNION

SELECT NULL, B.Name, 0
FROM business AS B
LEFT JOIN records as R ON B.id = R.business_id
WHERE r.business_id IS NULL
"
20725,Suppress listagg date truncation/conversion,"listagg(to_char(application_date, 'DD/MM/YYYY HH:MI:SS'), ',')
"
5148,Setting multiple scalar variables from a single row in SQL Server 2008?,"SELECT
    @var1 = col1
    ,@var2 = col2
FROM
    Inserted;
"
20230,How to fetch data without a duplicate entry by using limit and order by,"CREATE TABLE likes_search_orders(search_id varchar(255) not null, post_id bigint(20) not null, order_id biging(20) not null)
"
19887,CASE still returns null,"SELECT @RecordType AS RecordType_1,
       AbstractData.AccountNumber AS AcctNum_2,
       COALESCE(AD.Diagnosis, '') AS Dx_3
FROM AbstractData
LEFT JOIN AbsDrgDiagnoses AD ON AD.VisitID = AbstractData.VisitID
WHERE AbstractData.PtStatus <> 'REF' AND AD.DiagnosisSeqID = '1'
"
21080,How to change a PG column to NULLABLE TRUE?,"ALTER TABLE mytable ALTER COLUMN mycolumn DROP NOT NULL;
"
10234,Help with a SQL query,"update tableContracts t2 set t2.ownerid=t1.id where exists( select t1.id from tableowner t1 where t1.name=t2.Name)
"
24966,Delete all rows in one table that aren't referenced by another table,"DELETE
    status
FROM
    status
    LEFT JOIN device ON (status.id = last_status_object_id)
WHERE
    device.id IS NULL
"
20583,Remove TIMESTAMP precision from NOW() result in PostgreSQL?,"UPDATE tbl SET col = DATE_TRUNC('second', NOW());
"
5952,finding maximum values using Oracle / SQL group by,";WITH q AS (
  SELECT *, ROW_NUMBER() OVER (PARTITION BY ID1 ORDER BY A DESC, B DESC) AS rn
  FROM YourTable
)
SELECT *
FROM   q
WHERE  rn = 1
"
5552,MYSQL: Vacant / occupied rooms as now,"select rct.room_category AS room_category,
       group_concat(rc.room_name separator ',') AS vacant_beds
from room_charges rc join
     room_category rct
     on rc.room_category = rct.id left join
     patient_detail pd
     on rc.id = pd.room_name and
        (pd. discharge_date_time is null or
         curdate() between admission_date_time and discharge_date_time)
where pd.id is null
group by rc.room_category ;
"
3368,how to subtract two columns which are times in access sql query,"SELECT Format(j.Leaving_time - j.Arrival_Time, ""hh:nn:ss"") AS Time_Difference
FROM Technicians AS t, Jobs AS j, Tech_Allocation AS ta
WHERE j.Job_ID = ta.Job_ID     
  AND ta.Technician_ID = t.Technician_ID
ORDER BY 1 ASC;
"
34447,MySQL COUNT and merge duplicate records,"SELECT  
    u.email, 
    COUNT(o.id) AS num_orders 
FROM users u 
    INNER JOIN orders o 
        ON o.user_id = u.id 
GROUP BY u.email
ORDER BY u.email 
"
7897,SQL: How to force the relational operator to consider NULL values,"WHERE IFNULL(a.entity_id, 0) = IFNULL(b.entity_id, 0);
"
18564,How to compare symbols by collation different from database default collation?,"declare @s1 nchar(1)=''
declare @s2 nchar(1)='a'
select   
  case 
    when @s1 <> @s2 collate latin1_General_CS_AS Then 'a is NOT equal '
    else 'a is equal to '
  end
"
6747,"column deleted, now want to add constraint back","CONSTRAINT grade_month_uniq UNIQUE (graded_to, graded_by, grade_month)
"
11065,Aggregate sum of a field when another row with the same ID is selected in SQL,"SELECT a1.v, SUM(a2.v) FROM users u
INNER JOIN attributes a1 ON a1.user_id = u.id
INNER JOIN attributes a2 ON a2.user_id = a1.user_id AND a2.k = 'k2'
WHERE a1.k = 'k1'
GROUP BY a1.v
"
26953,"SQL join, compare two column values, match col values","SELECT tb1.*
FROM Table1 AS tb1 LEFT JOIN Table2 AS tb2
        ON tb1.XID = tb2.ID
WHERE tb2.ID IS NULL
"
2036,"""If one-to-many table has value"" as column in SELECT","SELECT c.*,
       ISNULL((SELECT TOP 1 1 FROM Car_Fuel f WHERE f.Car_ID = c.Car_ID AND f.Fuel_ID = 1), 0) AS Can_Use_Gas
       ISNULL((SELECT TOP 1 1 FROM Car_Fuel f WHERE f.Car_ID = c.Car_ID AND f.Fuel_ID = 2), 0) AS Can_Use_Diesel
       ISNULL((SELECT TOP 1 1 FROM Car_Fuel f WHERE f.Car_ID = c.Car_ID AND f.Fuel_ID = 3), 0) AS Can_Use_Electric
FROM Car c;
"
3865,INSERT INTO based on result of WHERE in double JOIN,"INSERT INTO 
  tbl_his (a_fk, coef) 
SELECT 
  tbl_a.id, 
  CASE WHEN tbl_c.switch = 0 THEN 100 ELSE 50 END
FROM
  tbl_a
LEFT JOIN
  tbl_b
ON
  tbl_a.b_fk = tbl_b.id
LEFT JOIN
  tbl_c
ON
  tbl_b.c_fk = tbl_c.c_id
"
7943,How to add sub query in SQLITE Android along with 'IN'?,"Cursor cursor = myDataBase.rawQuery(""select * from contacts where id in (select cpk from mapping where gpk = ?)"", new String[]{grpName});
"
20171,sql direct way to get number of rows in table,"SELECT COUNT(*) FROM gallery
"
33273,MySQL multiple join and grouping,"    SELECT news.newsID, (SELECT SUM(votes.vote) FROM votes WHERE votes.newsID = news.newsID) AS total, (SELECT COUNT(comments.commentID)FROM comments WHERE comments.newsID = news.newsID) AS comment_count
FROM news 
GROUP BY newsID
"
22357,Copy row to same table with different ID,"INSERT INTO Match (Team1,Team2)
SELECT
  Team1,Team2
FROM
  Match
WHERE ID='1';
"
32258,Using a combination of fields in a WHERE clause,"DELETE b FROM TABLE_B b
LEFT JOIN TABLE_A a ON a.KEY1=b.KEY1 AND a.KEY2=b.KEY2...
WHERE a.SOMEID IS NULL
"
35765,MS Access query to get last 2 days,"SELECT [DATE_COLUMN]
FROM [TABLE]
WHERE [DATE_COLUMN] >= (SELECT DateAdd(""d"", -2, Max([DATE_COLUMN])) FROM [TABLE])
"
1748,Finding duplicates based on multiple fields,"SELECT 
  someCommongField 
FROM 
  biggerTempTable  
 WHERE NOT IN 
    (SELECT someCommonField FROM smallerTempTable)
"
12944,Grouping the data after fetching the query,"select DISTINCT month,product,sum(mod)/tot_cnt as mod_p,sum(sev)/tot_cnt as sev_p 
from table X 
group by month, product
"
27798,"Best way to query for items with the most ""upvotes""","SELECT col1, col2
FROM some_table
ORDER BY upvotes DESC
LIMIT 10
"
30974,Combine count group by queries into single table,"SELECT AccountId, SubaccountID,
    SUM(CASE WHEN SuccessFlag = 'false' THEN [Count] ELSE 0 END) AS Failed,
    SUM([Count]) AS Total
FROM MyTable
GROUP BY AccountId, SubaccountID
"
33214,"How to do the ""users who like X also like Y"" query?","select L2.product_id, count(L2.user_id) as num_users from likes L1
join likes L2
where L1.product_id=x and L1.rating='like'
and L2.user_id = L1.user_id
group by L2.product_id
order by num_users desc;
"
11148,HiveQL INNER JOIN,"SELECT order.id_producto,order.id_usuario,log.host,log.agent
FROM order 
JOIN log ON order.ip=log.host
WHERE order.ip is not null
"
1813,how to replace string values of column values by SQL Stored Procedure,"UPDATE MyTable SET ColumnNeedUpdate = 
    REPLACE(ColumnNeedUpdate, 'l:\xyz\sfd\', '')
WHERE UserId = 2565
"
19039,adding a new column SQL query,"select * from 
(select SUM(*) as ""tot1"" from table1 t, table2 t2 where t1.id=t2.id and t1.column=1) a,

(select SUM(*) as ""tot2"" from table1 t, table2 t2 where t1.id=t2.id and t1.column=2) b,

(select SUM(*) as ""tot3"" from table1 t, table2 t2 where t1.id=t2.id and t1.column=3) c
"
20881,SQL Server loop and insert in sql,";WITH Numbers (Number) AS 
(
    SELECT 0 
    UNION ALL
    SELECT 1 + Number FROM Numbers 
    WHERE 1 + Number <= 14
)
INSERT INTO [campusMap].[dbo].[zoom_levels] ([zoom_start],[zoom_end])
SELECT n1.Number, n2.Number 
FROM
    Numbers n1 CROSS JOIN
    Numbers n2
WHERE
    NOT (n1.Number = 0 AND n2.Number = 14)
"
34316,MySQL: This version of MySQL doesn't yet support 'LIMIT & IN/ALL/ANY/SOME subquery,"SELECT * FROM `MessageThreads`
LEFT JOIN `users` ON `users`.`id` = 
   (select SenderId from Messages where 
        Messages.MessageThreadId =  MessageThreads.MessageThreadId 
        and Messages.MessageId = (select max(Messages.MessageId) from Messages));
"
17459,Query on free text field,"<cfset NewQuery = QueryNew(""id,pagename"",""integer,varchar"")>
<cfloop query = ""ExistingQuery"">
  <cfif ListFirst(pagename) EQ 1>
    code to add row and set cell values for NewQuery
  </cfif>
</cfloop>
"
37862,SQL WHERE LIKE with tab,"CAST(X'09' AS TEXT)
"
32245,Paging with Oracle,"SELECT * FROM
(
    SELECT a.*, rownum r__
    FROM
    (
    	SELECT * FROM ORDERS WHERE CustomerID LIKE 'A%'
    	ORDER BY OrderDate DESC, ShippingDate DESC
    ) a
    WHERE rownum < ((pageNumber * pageSize) + 1 )
)
WHERE r__ >= (((pageNumber-1) * pageSize) + 1)
"
30716,multiple sql update queries,"for ($i = 1; $i <= 5; $i++) {
    mysql_query(""UPDATE turfs SET "" . $i . "" = '0' WHERE "" . $i . ""= '$corpse_gang'"");
    mysql_query(""UPDATE turfs SET color"" . $i . "" = '0' WHERE color"" .$i . "" = '$g_color'"");
}
"
31794,Excluding MYSQL query results with an INNER JOIN,"SELECT b.* 
FROM books_table b 
INNER JOIN keywords_table k 
ON b.book_id = k.book_id
WHERE b.is_hardcover = 1 
GROUP BY b.book_id
HAVING SUM(k.keyword_id = 1) =0
AND SUM(k.keyword_id = 2) =0
AND SUM(k.keyword_id = 3) =0
"
23306,How to remove the begining and ending characters if those are '0' in SQL Server,"declare @s varchar(15) = '00abc00efg000'
select substring(@s, 
                 patindex('%[^0]%', @s), 
                 len(@s)-patindex('%[^0]%', reverse(@s))-patindex('%[^0]%', @s)+2);
"
23349,multiple column subquery for update statement in mysql,"   UPDATE mytable  mt
   INNER JOIN myvalues mv
   ON STR_TO_DATE(mv.Date, '%m/%d/%Y') = mt.accident_dt
   SET mt.tmax = mv.tmax , mt.tmin=mv.tmin
   WHERE Longitude_MAX >= v_lng 
   and STR_TO_DATE(Date, '%m/%d/%Y') = v_date
   AND pkid = v_pkid;
"
21211,SQL select Distinct with where clause,"SELECT DISTINCT PersonID
FROM tableName
WHERE PersonID NOT IN
    (
        SELECT PersonID
        FROM tableName
        WHERE KvalifikationId = 2
    )
"
22041,SQL- how to find the top 1 row?,"SELECT account, MIN(dt_effective) FROM your_table
GROUP BY account
"
28530,Retrieve data from Sql Table according to described scenario,"select count(*) as cnt,
       year(date) year_of_date
from your_table
group by year_of_date
"
7946,Trouble with a JOIN,"SELECT VU.*, 
       COALESCE(UI.UserImg, 'dflt.jpg') as UserImg,
       COALESCE(CI.Interests, 0) as NumInterests 
FROM [vw_tmpUsers] VU LEFT JOIN
     (SELECT [tmpUserPhotos].UserID, MAX([tmpUserPhotos].uFileName) as UserImg 
      FROM [tmpUserPhotos] 
      GROUP BY UserID
     ) UI 
     ON VU.UserID = UI.UserID ;
"
30935,Oracle - determining whether a table exists,"declare
    v_tab_count number := 0;
begin
    select count(*)
    into v_tab_count
    from all_tables
    where table_name = 'MY_TABLE';

    if v_tab_count > 0 then
        execute immediate 'drop table my_table';
    else
        dbms_output.put_line('The table isn''t there! maybe you deleted it already?');
    end if;
exception
    when others then
        dbms_output.put_line( sqlerrm);
end if;
/
"
34687,Is primary key auto increment always needed in a table?,"alter table my_table drop column id;
"
20433,how can I multiply two fields then get avg of rows,"SELECT AVG(grade * unit) FROM ...
"
4133,SQL Server Where [column] <>,"SELECT
    t1.RESULT, t2.DESCRIPTION
FROM
    [TABLE 1] t1 LEFT OUTER JOIN
    [TABLE 2] t2 ON t1.RESULT = t2.ID
WHERE
    t2.DESCRIPTION IS NULL OR t2.DESCRIPTION <> 'CALL CLOSED'
"
15773,Should the cursor be closed in bind view?,"@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    Cursor c;
    //create cursor
    startManagingCursor(c);

    //create and display CursorAdapter
}
"
22178,Easy way to find out how many rows in total are stored within SQL Server Database?,"SELECT SUM(row_count)
    FROM sys.dm_db_partition_stats
    WHERE index_id IN (0,1)
    AND OBJECTPROPERTY([object_id], 'IsMsShipped') = 0;
"
2897,Nested SQL Count,"SELECT C.CountryID
FROM Country C
WHERE not exists(SELECT 1 FROM Member M WHERE M.PrCountryID = C.CountryID) 
"
32148,Using greater-than or equal/less-than or equal twice in one SQL query,"SELECT * FROM event WHERE ((begintime <= '$start' AND endtime >= '$end') OR (begintime >= '$start' AND endtime <= '$start')  OR (begintime >= '$end' AND endtime <= '$end')) AND room = '$room';
"
25942,Sql Query to get column name from another table,"@i_DocumentID varchar(MAX)   

 SELECT 
    a.DocumentID, 
    a.DocumentName,
    a.ClientID,
    b.AttachmentName
    from Documents  a 
    join Attachments b on a.DocumentId = b.DocumentId

    where a.DocumentID IN (SELECT * FROM dbo.CSVToTable(@i_DocumentID))
"
15707,SAP HANA: Minimum value of several columns,"select least(col_1, col_2, col3_3)
from . . .
"
27564,Sql GROUP BY conflict with the arrays,"SELECT * 
FROM `Projectos` 
JOIN `Projectos-Sectores` ON `ProjectID` = `Pid` 
JOIN `Sectores` ON `SectorID` = `Sectores`.`ID`
ORDER BY `Pid` 
"
39935,selecting digits right of the last zero in SQL Server,"declare @value varchar(20) = 'NA000000123456'

select substring(@value, patindex('%[1-9]%', @value), len(@value))
"
32351,Count records which occurs more than once in a column,"SELECT COUNT(*) FROM
(SELECT values 
 FROM table 
 GROUP BY values 
 HAVING COUNT(*) > 1) t
"
8099,SQL Group By custom range?,"SELECT CASE 
    WHEN Quantity <= 6 THEN CAST(Quantity as VARCHAR(1))
    ELSE '>6' 
    END AS Range, COUNT(Quantity) AS Amount
FROM  orders
GROUP BY (CASE 
    WHEN Quantity <= 6 THEN CAST(Quantity as VARCHAR(1))
    ELSE '>6' 
    END)        
"
18587,Need some help trying to do a simple SQL INSERT with some simple data checking,"INSERT INTO newtable (id,name)
SELECT IsNull(leftid,rightid), name
FROM oldtable
"
10867,Remove duplicated rows from large table,"delete from MyTable
where exists (
    select 1 from MyTable t2
    where MyTable.a=t2.a and MyTable.b=t2.b and MyTable.upd<t2.upd
)
"
5234,sql oracle sysdate: ignore weekends,"AND table.datum BETWEEN sysdate-7 and sysdate
AND TO_CHAR(to_date(substr(table.datum,1,10), 'DD-MM-YYYY'),
                         'D', 'NLS_DATE_LANGUAGE=ENGLISH') NOT IN ('1', '7')
"
36290,stuck with one query in SQL Server,"select sum(price) from calci  group by (rn- freq)
"
24870,"SQL Query to find difference in hours between first and last records of each day for a month, and sum each difference to find the total","select contactid, sum(hoursestimate) as total
from (select contactid, cast(TimeStamp as date) as dte,
             DATEDIFF(HOUR, min(TimeStamp), max(TimeStamp)) as hoursestimate
      from t
      where TimeStamp >= @start and TimeStamp < @end
      group by contactid, cast(TimeStamp as date)
     ) t
group by contactid;
"
13077,oracle group by using rank,"WITH cte AS (SELECT ""Id1"",""Lev"",""Type"",""Survey_Nr""
                    ,RANK() OVER (PARTITION BY ""Type"",""Survey_Nr"" ORDER BY CASE WHEN ""Lev"" = 'All Levels' THEN 0 ELSE 1 END) AS RN
             FROM Table1)
SELECT *
FROM cte
WHERE RN = 1
ORDER BY ""Id1""
"
34975,Select row matching a condition if no other rows match a different condition,"SELECT name FROM Table T1
WHERE activity_status != 'active'
AND
NOT EXISTS (SELECT *
        FROM Table T2
        WHERE
            T2.activity_status = 'active' AND T1.name = T2.name)
"
32264,How to edit multiple records in mysql using sql update,"UPDATE table
SET column2 = concat('Top/', column2)
WHERE column2 LIKE 'name_test/%'
"
20734,What should be the SQL query to get the desired result?,"select *
from thetable
where messageid in
(
  select max(messageid)
  from thetable
  where recipientid = 110
  group by senderid
)
order by senderid;
"
38796,Get the balance of my users in the same table,"select user_id,
       sum(case when type = 'income' then amount else - amount end) as balance
from t
group by user_id
"
27648,SQL date selecting,"SELECT *
FROM myTable
WHERE ( YEAR(myfield) = '2009')
  AND ( MONTH(myfield) = '1')
"
4154,Multiple AND conditions in a mysql query,"WHERE id_category IN (1,2) AND id_brand IN (110,105)
"
14633,SQL server database start/stop issue,"ALTER DATABASE <dbname> SEt AUTO_CLOSE OFF;
"
13777,Bulk change all entries for a particular field in SQL database,"UPDATE TABLE_NAME SET changeme = 0
"
9625,how to get latest record or record with max corresponding date of all distinct values in a column in mysql?,"select 
t1.* from table_name t1
left join table_name t2
on t1.Id = t2.Id and t1.Date >t2.Date
where t2.Id is null
"
14270,Filter for most recent client version in SQL table,"select t1.* 
from your_table t1
inner join (
  select `user id`, max(`app version`) as max_app_version
  from your_table 
  group by `user id`
) t2 
on t1.`user id` = t2.`user id` 
and t1.`app version` = t2.max_app_version;


select t1.* 
from your_table t1
where not exists (
  select 1 from your_table 
  where `app version` > t1.`app version`
  and `user id` = t1.`user id`
  and platform = t1.platform
);
"
33933,Issue with creating XMLQuery for given XPATH,"//OrderVal/Orderattrs/Orderattr/(@Ordername, OrderVals/OrderVal/listvalue)/data(.)
"
39888,MySQL get minimum from function,"SELECT D.id 
FROM (SELECT id , DISTANCE_BETWEEN (Latitude,Longitude,43.2560997009,-2.9078400135) AS distance FROM Locations) AS D
ORDER BY distance
LIMIT 1
"
37382,Select max from multiple tables using angularjs and sqlite,"SELECT MAX((SELECT MAX(_modification) FROM clientes),
           (SELECT MAX(_modification) FROM phones  )) AS lastS
"
19869,String Concatenation in T-SQL,"DECLARE @TESTPARAM varchar(20)
DECLARE @SQLQUERY varchar(250)
SET @TESTPARAM = 'test'
SET @SQLQUERY = 'SELECT ''' + @TESTPARAM + ''''
"
38768,SQL meta table help (mysql),"select  *
from    metas m
join    news n
on      m.rel_id = n.id
where   m.meta_type = 'category'
        and m.meta_id = 55
        and n.status = 1
order by
        n.id desc
limit   0, 10
"
38776,Row level sum of values,"with allDates (date) as
(
    select requestDate from dbo.bugs
    union select closedDate from dbo.bugs
)
select date,
    (select count(*) from dbo.bugs where requestDate = a.date) as bugsRequested,
    (select count(*) from dbo.bugs where closedDate = a.date) as bugsClosed,
    (select count(*) from dbo.bugs where a.date between requestDate and closedDate) AS bugsOpen,
    (select count(*) from dbo.bugs where closedDate<=a.date) AS totalClosed
from allDates a
"
20082,How do I assign a number to a set of results but re-start the numbering at the start of a new unique ID?,"select cust_id, date,
       row_number() over (partition by cust_id order by date) as assigned_value
from table t;
"
35158,Select name and surname in sql,"SELECT  pe.Name,
        pe.Surname
FROM Player AS pl
INNER JOIN PlayerContract AS pc
    ON pl.ID = pc.Player
INNER JOIN Team AS t
    ON pc.Team = t.ID
INNER JOIN Person AS pe
    ON pc.Person = pe.ID
WHERE t.Name = 'X'
"
23358,"Return type from DAL class (Sql ce, Linq to Sql)","NameOfYourDataContext dc = new NameOfYourDataContext();

var query = from row in dc.table
            where property == 0 //Filter if needed
            select row;

//OR var query = dc.table.where(row => row.Property == 0);

int i = 0;

foreach(var row in query)
{
   row.property = i++;
}

dc.SubmitChanges();
"
13944,join two table with a primary and foreign keys with a different format,"select e.name, p.position
from employee e join position p
    on p.employee_id = concat('e',e.id)
"
34699,SQL DML query - need assistance,"SELECT d.name, d.ic
FROM doctor d
JOIN work w ON d.ic = i.ic
JOIN hospital h ON w.hid = h.hid
WHERE YEAR(d.date_of_birth) >= 1980
AND UPPER(h.country) IN ('ENGLAND', 'SPAIN');
"
5726,SQL Subquery using HAVING COUNT,"select ArtistName from Artists where ArtistID in (
  select ArtistID from Tracks where StudioID in (
    select StudioID from Tracks where ArtistID in (
      select ArtistId from Artists where ArtistName='The Bullets'
    )
  )
)
"
22573,SQL problem with formulating a query where combinations are defined in another table,"SELECT 
    Loc1.Name AS Loc1,
    Loc2.Name AS Loc2
FROM
    PressureBox PB
    JOIN Location Loc1 ON Loc1.ID = PB.DD
    JOIN Location Loc2 ON Loc2.ID = PB.CR
"
280,SQL - search by beginning of a word,"SELECT * FROM tableName WHERE CompanyName LIKE 'Em%' or CompanyName LIKE '% Em%'
"
33557,"APEX - Create chart via ""group by"" query","SELECT null, TRUCK_CLASS, COUNT(1) 
  FROM TIC_TRUCK 
 GROUP BY TRUCK_CLASS
"
9702,Conditionally display image in Oracle Apex based on procedure,"<div style=""width: 290px; margin: 0 auto;"">
  <img src=""#WORKSPACE_IMAGES#&P1_ID..png"" width=""290"">
</div>
"
38045,How to use XPATH in MySQL select?,"SELECT * FROM xml
WHERE EXTRACTVALUE(data, '<xpath-expr>') != '';
"
37808,Sleep function in ORACLE,"IN_TIME INT; --num seconds
v_now DATE;

-- 1) Get the date & time 
SELECT SYSDATE 
  INTO v_now
  FROM DUAL;

-- 2) Loop until the original timestamp plus the amount of seconds <= current date
LOOP
  EXIT WHEN v_now + (IN_TIME * (1/86400)) <= SYSDATE;
END LOOP;
"
28830,MYSQL Brands list order by product count but,"ORDER BY bra IN (SELECT brand FROM Priority) DESC, cnt DESC
"
16393,Search for same data in two different columns,"SELECT user_id,
 user_firstname,
 user_lastname,
 user_profile_picture, 'users' as 'type'
FROM users 
WHERE user_firstname LIKE :user_firstname
OR user_lastname LIKE :user_lastname 
UNION ALL SELECT page_id, 
 page_firstname, 
 page_lastname, 
 page_profile_picture ,'pages' as 'type'
FROM pages 
WHERE page_firstname LIKE :page_firstname 
OR page_lastname LIKE :page_lastname
"
27943,Insert into table from stored procedure with different versions,"Insert into @tbl(col1, col2, col3) EXECUTE sp
WITH RESULT SETS (
    (col1 INT, 
     col2 INT,
     col3 nvarchar(50))
)
"
4762,Default column value based on the value of a different column,"ALTER TABLE YourTable ADD YourComputedColumn AS ColumnA*15
go
"
14745,Is there a way to find what accounts can execute xp_cmdshell?,"When first enabled, xp_cmdshell requires CONTROL SERVER
permission to execute and the Windows process created by
xp_cmdshell has the same security context as the SQL Server 
service account.
"
39124,Update employees table,"UPDATE emp
SET salary = salary * 1.15
WHERE empno IN (
    SELECT e.empno
      FROM emp e
      JOIN emp m ON e.mgr = m.empno
     WHERE e.salary < m.salary * 0.5
)
"
34656,SQL Duplicated Count Without Removing,"SELECT t.id1, t.id2, t.value, cnt
FROM   my_table t
JOIN   (SELECT   id1, count(*) AS cnt
        FROM     my_table
        GROUP BY id1) c ON t.id1 = c.id1
"
29564,T-SQL Reverse Pivot on every character of a string,"WITH cte AS
(
    SELECT 1 AS [week]
    UNION ALL
    SELECT [week] + 1
    FROM cte
    WHERE [week] < 53
)
SELECT t.event_id, t.staff_id, cte.[week]
FROM your_table AS t
    INNER JOIN cte
        ON LEN(ISNULL(t.weeks, '')) >= cte.[week]
            AND SUBSTRING(t.weeks, cte.[week], 1) = 'Y'
ORDER BY t.event_id, t.staff_id, cte.[week]
"
33856,T-SQL datetime conversion,"declare @val VARCHAR(8)

SET @val = '201212'

set @val = @val + '01'

print CONVERT(DATETIME, @val, 12)
"
32596,where clause on non-indexed column in sql," CREATE NON CLUSTERED INDEX ix_employees_firedEmployees ON employees (name) INCLUDE (mode) WHERE mode = 'fired';
"
19468,SUM() in WHERE in MYSQL statement,"SELECT
  quantity, price, 
  @rt:=@rt+quantity AS runningtotal
FROM
  `table`
  INNER JOIN (SELECT @rt:=0) AS init ON 1=1
WHERE
  price<26.00
  AND @rt<=90
"
31876,Populating two tables from another table using a trigger,"CREATE TRIGGER distributing_info_details AFTER INSERT ON Info FOR EACH ROW
BEGIN
  INSERT INTO Household (personID, sons, daughters, ...)
    VALUES (new.PersonID, new.sons, new.daughters, ...)
    # use    ^ this key word to access the newly inserted ID.
  INSERT INTO Person (firstName, lastName, ...)
    VALUES (new.firstName, new.lastName,...)
END;
"
34424,Database triggers for a historical view of a live table?,"CREATE TRIGGER trig ON tLiveTable AFTER UPDATE
AS
     INSERT INTO tPieceTracking select t.PieceID, getdate(), PrevLocation, 0
     FROM UPDATED t
     INNER JOIN
    (
        SELECT MAX(LocationRef) as PrevLocation, PieceID
        FROM tPieceTracking
        GROUP BY PieceID
    ) p on p.PieceID = t.PieceID

     INSERT INTO tPieceTracking select t.PieceID, getdate(), LocationRef, 1
     FROM UPDATED t
"
3896,How to structure SQL Query to allow for NULLs,"SELECT  
    t2.MyColumn     
FROM Table1 t1
JOIN Table2 t2 ON t2.Table2PK = t1.Table2FK AND 
    ((@MyColumn IS NULL AND MyColumn IS NULL) OR MyColumn = @MyColumn)
"
35920,database primary key based on variable number of customer subdivisions,"class Company {
    static hasMany = [subdivisions: Subdivision]
}

class Subdivision {
    static belongsTo = [company: Company, subdivision: Subdivision]
    static hasMany = [subdivisions: Subdivision]
}
"
27208,MySQL cursor not fetching inside procedure,"SELECT a.album_id, a.name, AVG(mr.rating) FROM albums a
  LEFT JOIN music_ratings mr
    ON a.album_id = mr.album_id
GROUP BY a.album_id
"
19416,SQL - UPDATE or INSERT by checking two columns,"create unique index idx_table_worker_date on table(worker_id, date);

insert into table(worker_id, date, shift_type)
    values (@worker_id, @date, @shift_type)
    on duplicate key update shift_type = values(shift_type);
"
31379,Display records in sequence from a table without relying on the id of the table?,"select id, x, y
  from test
 where g=true
 limit 4, 1;
"
11130,Searching Unique Id in Multiple Tables,"SELECT CASE WHEN EXISTS(SELECT 1 FROM TableC WHERE id = @id) THEN '3'
            WHEN EXISTS(SELECT 1 FROM TableB WHERE id = @id) THEN '2'
            WHEN EXISTS(SELECT 1 FROM TableA WHERE id = @id) THEN 'One'
       END AS ""Level""
"
16283,Ranking Students by Grade in SQL,"select
    date,
    student,
    rank() over (partition by date order by score desc) as rank
from
    grades
order by
    date, rank, student
"
18828,Trying to find values that are greater than the average. SQL Developer from ORACLE,"select *
from (select s.name, count(distinct p.idt) as vocsize,
             avg(count(distinct p.idt)) over () as avg_vocsize
      from series s join
           posting p
           on s.ids = p.ids
      group by s.name
     ) s
where vocsize > avg_vocsize;
"
35019,Identify groups of rows in close proximity,"SELECT 1 + count(step OR NULL) OVER (ORDER BY curr_rec) AS trip_id
FROM  (
   SELECT curr_rec
         ,lag(curr_rec) OVER (ORDER BY curr_rec) AS prev_rec
         ,curr_rec - lag(curr_rec) OVER (ORDER BY curr_rec)
                                        > interval '5 min' AS step
   FROM  timestamps
   ) x;
"
23854,searching for specific entity name in sql xml table columns,"SELECT @x.query('(//EntityPropertyOfString[./Name=""Bonus Day Rate""]/Value)').value('(.)[1]', 'int')
"
27676,SQL Query make 'groups' with MySQL,"SELECT s.*
FROM (
   select epi_nr, MIN(upload_date) As upload_date
    from Spalte
    group by epi_nr
 ) g
INNER JOIN Spalte s on s.epi_nr = g.epi_nr AND s.upload_date = g.upload_date
"
14596,How to fill `[Order]` column by order number in SQL Server?,"WITH CTE AS
(
   SELECT Id, Title, [Order] 
   , OrderNumber = ROW_NUMBER() OVER (ORDER BY Date)
   FROM Tbl 
)
UPDATE CTE SET [Order] = CTE.OrderNumber;
"
10247,Mysql join using date between,"SELECT
  l.count AS visitorsStatistics,
  r.count AS pageviewsStatistics
FROM
  (SELECT * FROM analytics_metrics WHERE metrics='visitorsStatistics') AS l
  LEFT JOIN
  (SELECT * FROM analytics_metrics WHERE metrics='pageviewsStatistics') AS r
    ON l.date=r.date
WHERE
  l.date BETWEEN @fromDate AND @tillDate
"
8735,Keeping one table or multiple table for similar type of data which one is best while considering high performance,"INSERT INTO sale_delivery
(orderId, clientId, ....)
SELECT orderId, clientId, ...
FROM sale_order;
"
32918,"How to check if a foreign column is part of a constraint with ""ON DELETE CASCADE"" option?","select ao.name,ao.type_desc,delete_referential_action_desc,*
from sys.foreign_keys fk 
inner join sys.all_objects ao 
on fk.parent_object_id = ao.object_id     
where delete_referential_action_desc <> 'CASCADE'
"
21264,Select On COUNT < x in a relational database,"SELECT TG.RecordNumber
FROM TestGroup TG
   LEFT JOIN Test T ON TG.RecordNumber = T.TestGroupRecordNumber 
   LEFT JOIN Result R ON T.RecordNumber = R.TestRecordNumber 
GROUP BY TG.RecordNumber
HAVING COUNT(R.TestRecordNumber) < X
"
23814,Achieving ANY() functionality in RORacle,"AND t1.level IN ('09','10','11','12'),
   AND t2.id2 IN ([Placeholder for long list of numeric IDs here]),
"
18711,Get records with more than one value and at least one of them is zero,"select Keyword,COUNT(distinct id) from #Tbl
group by Keyword
having COUNT(distinct id)>1 and MIN(id) = 0
"
12799,MYSQL IN statement,"SELECT Item
    FROM YourTable
    WHERE categories IN ('red', 'blue', 'green')
    GROUP BY Item
    HAVING COUNT(DISTINCT categories) = 3
"
33762,Select all data include another table even if null,"   SELECT e.employeeId,e.firstName,e.lastName,s.ShoeName,s.ShoeColor,s.ShoeBrand 
   FROM    Employee e
   LEFT JOIN Shoe s
   ON e.employeeID = s.Employee_employeeID
"
17480,NOT IN not working SQL,"SELECT b.userId 
FROM users b 
WHERE NOT EXISTS (
   SELECT * 
   FROM user_friend
   WHERE b.userId = user_friend.userId
);
"
6025,what is the meaning of this SQL query,"1001
1002
1001
1003
1002

count(person.person.BusinessEntityID) = 5 // all
count(distinct person.person.BusinessEntityID) = 3 //1001, 1002, 1003
min(person.person.BusinessEntityID) = 1001
min( distinct person.person.BusinessEntityID) = 1001
"
21579,Counting the number of rows based on like values,"SELECT 
    LEFT(customers.name,1) AS 'name',
    COUNT(*) AS NumberOfCustomers
FROM customers
WHERE
    customers.name LIKE '[a-z]%'
GROUP BY LEFT(customers.name,1)
"
4213,"mySQL like, but not like","REPLACE(str , 'foo.com', ' ') like '%.com%'
"
13219,Crystal reports ; How to change the format of a field,"totext(
CDate (
(ToNumber ({ELEC_.DOB_DROIT} [1 to 4])),
(ToNumber ({ELEC_.DOB_DROIT} [5 to 6])),
(ToNumber ({ELEC_.DOB_DROIT} [7 to 8]))
),""dd/MM/yyyy"")
"
22831,How to design a star schema,"DimBranch ( branchNo )
DimLoanManager ( empNo )
DimQuarter ( year, qNo )  -- qNo in (1,2,3,4)
DimWeek ( year, weekNo )  -- weekNo in (0..53), depending on business rules

Measures ( branchNo, empNo, year, qNo, weekNo, numContracts, sumLoans )
"
17097,updating a column in one table with value extracted from other table,"SET    val2 = t1.val1
FROM   table1 t1
WHERE  t2.table2_id = t1.table2_id
AND    t2.val2 IS DISTINCT FROM t1.val1  -- to avoid empty updates
"
17843,Quote multiple words in a selection for insert statement,":%s/\S\+/""&""/g
"
14811,How to identify all stored procedures refering a particular table,"SELECT Name
FROM sys.procedures
WHERE OBJECT_DEFINITION(OBJECT_ID) LIKE '%TableNameOrWhatever%'
"
16594,How can I backup a remote database schema in this environment?,"exp username/password@remotedb owner=ownername
"
6040,SQL: Separate column names after two inner joins,"SELECT banhammer_bans.id as bans_id, banhammer_players as players_id, ...
FROM banhammer_bans
INNER JOIN banhammer_players AS player
    ON banhammer_bans.player_id = player.id
INNER JOIN banhammer_players AS admin
    ON banhammer_bans.creator_id = admin.id
ORDER BY created_at DESC
"
39048,Send a HTTP Request Using SQL Server Agent Jobs,"EXEC sp_configure 'show advanced options', 1
GO

-- To update the currently configured value for advanced options.
RECONFIGURE
GO

-- To enable the feature.
EXEC sp_configure 'xp_cmdshell', 1
GO

-- To update the currently configured value for this feature.

RECONFIGURE
GO
"
37880,Using XQuery in Oracle,"SELECT XMLQuery('
    for $customer in ora:view(""customer"")/ROW
       return $customer/LAST_NAME
' RETURNING CONTENT) FROM DUAL;
"
35359,SQL Count() column values,"SELECT t.code, COUNT(*) AS `count`
FROM MyTable t
GROUP BY t.code
ORDER BY COUNT(*) DESC
"
30741,sql two columns of one table reference same column in another table,"SELECT l.link_desc, 
       s.[desc] description1,
       s2.[desc] description2
  FROM tbl_link l LEFT JOIN tbl_structure s 
    ON l.fID_a = s.pID LEFT JOIN tbl_structure s2 
    ON l.fID_b = s2.pID 
WHERE s.pID = 1
"
38592,SQL IN() operator with condition inside,"select *
from dbo.tbl_docs docs
where 
(
  (select count(*) from @states) > 0 
       AND 
   docs.doc_state in(select value from @states)
)
OR
(
  (select count(*) from @states)=0 
      AND 1=1
)
"
26531,Split data into a new line in oracle but in the same row,"WITH sample_data
AS ( select null      as ColumnA
     ,      'King'    as ColumnB
     ,      'Dog,Cat' as ColumnC
     FROM   dual
   )
SELECT ColumnA
,      ColumnB
,      REPLACE(ColumnC,',',CHR(10))
FROM   sample_data
"
34754,Equivalent of MySQL's \G in Oracle's SQL*Plus,"SQL> exec print_table ('select * from mytable where id_mytable=123');

And see results like:

ID_MYTABLE      : 123
YN_ENABLED      : Y
YN_SOMETHING    : N
...
"
19006,RETURN value from other table using foreign key retrieved in query in same query,"SELECT  D.[Hours], 
        D.TaskId,
        T.[Name],
        T.StoryId
FROM DailyTaskHours D
INNER JOIN Task T
    ON D.TaskId = T.TaskId
WHERE D.PointPerson = 'Dave Smith (smithd)' 
AND D.ActivityDate Between Cast('1/01/13 12:01:01' As DateTime) 
AND Cast('2/01/13 12:01:01' as DateTime)
"
25922,Multi table sql query,"select
  departure_time,
  arrival_time,
  depart.name,
  arrive.name
from trajects 
  inner join locations depart on (depart.location_id = trajects.departure_id)
  inner join locations arrive on (arrive.location_id = trajects.arrival_id)
"
32805,SQL Server Updating Multiple Columns,"update table
    set Column1 = coalesce(Column1, @blank),
        Column2 = coalesce(Column2, @blank),
        Column3 = coalesce(Column3, @blank)
    where Column1 IS NULL OR
          Column2 IS NULL OR
          Column3 IS NULL;
"
14022,Write Reserved Keywords into a file in Windows batch file,"echo.If @intA ^<^> @intB> ""C:\output_file.txt""
"
8998,Sql Server select datetime without seconds,"DECLARE @now [datetime]; 
SET @now = GETDATE();
SELECT
    CONVERT([varchar](10), @now, 105) + ' ' + 
    RIGHT('0' + CONVERT([varchar](2), DATEPART(HOUR, @now)), 2) + ':' +
    RIGHT('0' + CONVERT([varchar](2), DATEPART(MINUTE, @now)), 2);
"
30573,update from temp table to original table,"merge into original_table ot
using temp_table tp
  on (ot.cust_id = tp.cust_id)
when matched 
then update set ot.amount = tp. amount
"
15687,SQL find rows with multiple references,"SELECT street_name, store_id, count(*) 
FROM streets 
GROUP BY street_name
HAVING COUNT(DISTINCT store_id) > 1
"
21364,SQL Logic: When joining Child table B to Parent Table A on A.FID = B.ID,"Select *
From Table A Inner Join 
     B
     on A.FID = B.ID
WHERE B.ID IN (2, 5, 8);
"
20689,returning null values as something else from a query,"SELECT TEST_CODE, TEST_MDL,
    CONVERT(varchar(20),ISNULL(TEST_MDL,'null')) 
   FROM TEST;
"
15119,MySQL summing totals by state by year,"SELECT y.year, d.state, SUM(g.amount) AS total
FROM gift AS g
INNER JOIN year AS y ON y.year=g.year
INNER JOIN donor AS d ON d.donorno=g.donorno
GROUP BY y.year, d.state
"
20377,SQL-Injection + PDO_MySQL = Danger,"$sql = 'SELECT name, colour, calories FROM fruit
    WHERE calories < :calories AND colour = :colour';
$sth = $dbh->prepare($sql, array(PDO::ATTR_CURSOR => PDO::CURSOR_FWDONLY));
$sth->execute(array(':calories' => 150, ':colour' => 'red'));
"
8208,Query to group rows together then sort in those groups,"select PageName from Pages 
order by isnull(Parent,0),ISNULL(Predecessor,0)
"
39061,How to write this select statement?,"WITH tbl2 AS (SELECT DISTINCT ON (Name) Name,Nickname FROM table2 ORDER BY Name)

SELECT tbl1.Name, tbl2.Nickname, tbl1.col2, tbl1.col3 FROM
table1 tbl1 INNER JOIN tbl2 ON tbl1.Name = tbl2.Name
"
36093,ORACLE PL SQL : Select all and process every records,"FOR rec IN (SELECT * 
              FROM table a)
LOOP
  processMe( rec.field1,
             rec.field2,
             rec.field3 || 'test',
             rec.field4 );
END LOOP;
"
37498,MySQL position in recordset,"SELECT *, @ctr := @ctr + 1 AS RowNumber
FROM leaderboards, (SELECT @ctr := 0) c
ORDER BY time ASC, percent DESC
"
38226,apply an if condition in a sql query,"CASE WHEN IFNULL(birth_date,0)=0 THEN '' ELSE YEAR(CURDATE()) - YEAR(birth_date) END as age
"
22294,SQL: LIKE with OR vs IN,"WHERE NAME LIKE 'EXPRESSION_%' 
"
32021,Which Oracle privilege implicitly grant access to other schemas,"
begin
  for i in (select * from user_tables)
  loop
    execute immediate 'grant select, insert, update, delete on ' || i.table_name || ' to <target_schema>';
  end loop;
end;
/
"
22690,How to Find ALL Most Common Values in SQL?,"SELECT NAME, COUNT(*) AS POPULARITY 
FROM CATTWO 
GROUP BY NAME 
HAVING COUNT(*) = 
        (
            SELECT COUNT(*) AS MAX_POPULARITY 
            FROM CATTWO 
            GROUP BY NAME
            ORDER BY MAX_POPULARITY DESC
            LIMIT 1
        );
"
8182,Finding all the rows with 2 conditions using SQL (separate tables),"SELECT * FROM products AS p WHERE
       EXISTS (SELECT * FROM rules AS r WHERE p.ID = r.ProductID OR p.SectorID = r.SectorID)
"
35373,PL/SQL : How to extract data for any 5 days in a month,"select customerId
from actions a
where ActionDateTime >= '2014-01-01' and ActionDateTime < '2014-02-01'
group by customerId
having count(distinct trunc(ActionDateTime)) >= 5;
"
34407,Querying item that is NOT EQUAL in the second table,"Select A.Name, A.VAL1 AS VALUEA1, A.VAL2 AS VALUEB1 
From TableA as A, TableB As B
Where A.NAME = B.NAME AND A.VAL2 != B.VAL2
"
26469,Sqlite query to select similar unknown rows,"sqlite> create table t(item,price,quantity);
sqlite> insert into t select 'xyz',20,10;
sqlite> insert into t select 'xyz',20,10;
sqlite> insert into t select 'abc',10,40;
sqlite> insert into t select 'def',60,110;
sqlite> select *,count(*) from t group by item,price,quantity having count(*) > 1;
xyz|20|10|2
sqlite> 
"
15621,Update Sysdate - 10 min in Oracle,"select sysdate - 10/(24*60) from dual;
"
2911,SQL IF NULL From SELECT statement,"IF (SELECT NULL) IS NULL
    PRINT 1
ELSE
    PRINT 2
"
22088,how to get the SUM of certain rows based on an ID and populate column with the value without using a loop,"SELECT ID, CustomerID, PaymentID, ItemID, DeductionBucketID, Qty, Amount, Deductions
, SUM(Amount) OVER (PARTITION BY CustomerID, PaymentID) AS SumofAmount
FROM ... 
"
29890,How to optimize m:n relation query on 3 tables,"SELECT ListsId
FROM ListHasNames a
WHERE NamesId in (1, 2, 3)
AND NOT EXISTS
(SELECT * from ListHasNames b 
WHERE b.ListsId = a.ListsId 
AND b.NamesId not in (1, 2, 3))
GROUP BY ListsId
HAVING COUNT(*) = 3;
"
35362,SQL Special character,"select * from DTCountries where CountryCode like '%''%'
"
33972,Use distinct keyword with two tables,"SELECT DISTINCT Locationofwork, Locationofposting FROM Cand_details, Locationofposting
"
16821,Insert into using a default value if select returns null,"update Packages 
set PackageTypeId = coalesce((SELECT TOP 1 PackageTypeId FROM PackageTypes 
                              WHERE Packages.PackageTypeName = PackageTypes.Name 
                              ORDER BY PackageTypeId ASC), 0)
"
3149,How to filter Postgres enums by database?,"select typname, nspname 
from pg_type 
inner join pg_namespace on pg_type.typnamespace = pg_namespace.oid 
where nspname = 'public';
"
21490,mysql max(date) not working,"SELECT  *
FROM    History
WHERE   symbol = $symbol AND
        date = (SELECT MAX(date) FROM History)
"
19127,SQL - Oracle Functions using variables for schema names,"    execute immediate    'select count(*)  from '|| customer_schema 
                      || '.customer_registration where customer_ref= :b1' 
     into record_exists using incustomer_ref;
"
16152,Select smallest date after group by,"SELECT * 
FROM levelsloaded ll
INNER JOIN
    (SELECT id, MIN(mindate) AS finalmindate
     FROM levelsloaded
     GROUP BY id
) ill
ON ll.id = ill.id AND ll.mindate = ill.finalmindate
ORDER BY date DESC
"
14386,TSQL: how to write this query?,"WITH
  sampledata (A, B) AS (
    SELECT 1, 'a' UNION ALL
    SELECT 2, 'a' UNION ALL
    SELECT 1, 'b' UNION ALL
    SELECT 1, 'c' UNION ALL
    SELECT 3, 'd'
  ),
  counted AS (
    SELECT
      A,
      B,
      COUNT(*) OVER (PARTITION BY B) B_count
    FROM sampledata
  )
SELECT
  COUNT(*)
FROM counted
WHERE A = 1
  AND B_count = 1  /* change to ""> 1"" to get the other result */
"
15275,Query on all the people who has watched the same movies as I did,"select name
  from tbl
 where movid in (select movid from tbl where name = 'me')
   and name <> 'me'
 group by name
having count(*) = (select count(*) from tbl where name = 'me')
"
10379,SQL: Find the names of the people in at least the same clubs as one specific person,"SELECT DISTINCT C1.membername
FROM club C1 
WHERE NOT EXISTS (
    SELECT C2.membername
    FROM club C2 LEFT OUTER JOIN club C3 ON C2.clubname=C3.clubname 
    AND C3.membername=C1.membername
    WHERE C2.membername = 'Jim' AND C3.membername IS NULL
)
AND C1.membername !=  'Jim'
"
23984,Require one line SQL statement to copy data from one table to another table,"INSERT INTO t2
   SELECT name,
          ROWNUM AS record_number,
          approvers,
          area
     FROM ( SELECT DISTINCT name, approvers, area
               FROM t1
           ORDER BY approvers ) x
"
30327,How to display NULL when criteria not met,"SELECT column1, column2 = CASE 
  WHEN column2 = 'value2' THEN 'value2'
  ELSE NULL
END
FROM dbo.table;
"
36017,How to loop from one column cell to another cell in SQL,"<?php
    $query = ""SELECT dateCol from table"";
    $result = $mysqli->query( $query );
    while ($row = $result->fetch_assoc()){
        echo $row[""dateCol""];
    } 
?>
"
30425,How to update multiple duplicates with different values on the same table?,"UPDATE t
JOIN (
  SELECT MAX(t.id) AS maxid, lat, lon
  FROM t
  JOIN t AS duplicates
  USING (lat, lon)
  GROUP BY lat, lon
  HAVING COUNT(*) > 1
) AS maxima USING (lat, lon)
SET flag = IF(id = maxid, 1, 2);
"
23056,Table self related query,"WITH cte AS (
    SELECT * FROM table1 WHERE id = 7
    UNION ALL
    SELECT table1.* FROM table1 JOIN cte ON table1.id = cte.parentId
)
SELECT * FROM cte
"
29046,Include column names in the results of an Oracle SQL query?,"SELECT 'colname1',
       'colname2',
       'colname3',
       1 AS ordering
  FROM dual
UNION
SELECT colname1,
       colname2,
       colname3,
       2 AS ordering
  FROM yourtable
ORDER BY ordering;
"
10795,Update With SELECT FROM Table GROUP BY,"UPDATE `material` AS m  
INNER JOIN (
    SELECT m1.name
    FROM `material` m1
    GROUP BY m1.name
    HAVING COUNT(m1.name) > 1) m2   
ON m2.name = m.name
SET m.quantity = 0
"
30344,How to select a random result for each distinct item in MySQL,"SELECT a.question, a.answer_id, a.user_id, a.totalvotes
FROM
(
    SELECT a.question, b.answer_id, c.user_id, COUNT(d.vote_id) AS totalvotes
    FROM questions a
    LEFT JOIN answers b ON a.question_id = b.question_id
    LEFT JOIN users c ON b.user_id = c.user_id
    LEFT JOIN votes d ON b.answer_id = d.answer_id
    GROUP BY a.question, b.answer_id
    ORDER BY RAND()
) a
GROUP BY a.question
"
39442,Joining two tables with condition,"select a.name
from a
join b on a.id = b.aid
group by a.name
having sum(case when prp = 'visible' and prpvalue = 'true' then 1 else 0 end) > 0
"
16354,Sqlite: I need to update a data from one table to another,"UPDATE tableB
    SET
      Solution = (SELECT Solution FROM tableA WHERE ID = tableB.ID),
      SolutionImage = (SELECT Solution FROM tableA WHERE ID = tableB.ID);
"
33556,How do I generate random numbers to fill in empty rows?,"update t
    set exam = rand(checksum(newid())) * 101,
        assignment = rand(checksum(newid())) * 101;
"
729,SQL Server : GROUP BY clause to get comma-separated values,"SELECT ReportId, Email = 
    STUFF((SELECT ', ' + Email
           FROM your_table b 
           WHERE b.ReportId = a.ReportId 
          FOR XML PATH('')), 1, 2, '')
FROM your_table a
GROUP BY ReportId
"
26381,Select the first log in Time using from Table using SQL Server 2008 R2,"SELECT   last_name,
         first_name,
         CAST(field_time AS DATE) AS log_day,
         MIN(field_time) AS first_log
FROM     mytable
GROUP BY last_name, first_name, CAST(field_time AS DATE) 
"
28010,Could not connect to database postgres pg_hba (OSX),"$ sudo su
# su postgres -c 'createuser msf -P -h localhost'
"
10587,Designing A Database For User Friendship,"( SELECT u.id, u.name
  FROM friendship f, user u
  WHERE f.user1 = 1 AND f.user2 = u.id )
UNION ALL
( SELECT u.id, u.name
  FROM friendship f, user u
  WHERE f.user2 = 1 AND f.user1 = u.id )
"
22386,TSQL - Query to verify continuity,"select *
from mytable
where personid in
(
  select personid
  from
  (
    select personid, numberold, lag(number) over (partition by personid order by logdate, number) as numberbefore
    from mytable
  ) lookup
  where numberold <> numberbefore
)
order by personid, logdate, number;
"
11946,Re-writing the oracle sql query,"SELECT STATUS, 
       POSTAL_CODE, 
       CITY_STATE,
       max(case when SERVICE = 1 THEN org_id end) AS WATER,
       max(case when SERVICE = 2 THEN org_id end) AS COFFEE,
       max(case when SERVICE = 3 THEN org_id end) AS FILTRATION
FROM MAP
WHERE POSTAL_CODE = '02216'
GROUP BY status, postal_code, city_state
"
23579,SQL Select ISNULL not working," SELECT A.ID, AVG(ISNULL(B.score,0)) AS sc 
 FROM A 
     LEFT OUTER JOIN B ON A.ID = B.ID 
 WHERE A.aClass = '1st'
 GROUP BY A.ID
"
30016,Query to count distict on a field on multiple tables not working,"-- Step1. prepare your select query here
set @sqlQuery := 
(select
 GROUP_CONCAT(
  concat(' SELECT \'',table_name,'\' as col1,  COUNT(*) as countItem FROM ', table_name)
  SEPARATOR ' UNION ALL '
)  from information_schema.tables as t
where t.table_schema=""Log"" and t.table_name like ""%ERROR_%"");

-- Step2. execute the dynamic query
prepare stmt from @sqlQuery;
execute stmt;
drop prepare stmt;
"
479,Selecting row count from associated table without subselect,"select u.id, u.email, 
   count(distinct(s.id)) as total_schools, 
   sum(points) as total_points
from users u
left join schools s 
   on u.id = s.user_id 
group by u.id
"
26967,Update a third table from two other tables,"UPDATE
  table3 t
  LEFT JOIN (
    select     x.`1ID`, y.`2ID`
    from       table1 x
    inner join table2 y on x.orderid = y.orderid
  ) foo ON t.table2id = foo.`2ID`
SET
  t.table1id = foo.`1ID`
WHERE
  t.table1id IS NULL
"
24585,Does Sql Server 2008 has column display name?,"Select col1 as [Hello World] from table1
"
18573,Show empty cells in a join clause,"SELECT position_name, member_name
FROM   positions
       LEFT JOIN members USING(id_members);
"
33465,SQL insert to fill an associative table with conditions,"INSERT INTO ATab(Tab1Id, Tab2Id) 
(SELECT Tab1.Id, Tab2.Id
FROM Tab1, Tab2 WHERE Tab1.Name = 'Foo' AND Tab2.Name = 'Bar')
"
23963,SQL Parameters - where does expansion happens,"command.CommandText = string.Format(""DELETE FROM {0}"", tableName);
"
38076,SQL Query between 3 tables,"select RT.* 
from RoomType RT
where RT.TypeName not in (
   Select RM.TypeName 
   from Room RM
)
"
8972,Select one appointment before date for each patient (MySQL),"SELECT pat_id, MAX(date) FROM appts as a WHERE date < '2015-05-20' GROUP BY pat_id;
"
31530,Select values in SQL that have a colum value in one row and not a specific other column value in another,"SELECT DISTINCT book FROM TOPICS WHERE topic = 3 
EXCEPT
SELECT DISTINCT book FROM TOPICS WHERE topic = 4
"
33090,How can i do two groupings in single query in sql server 2008,"SELECT Operated_By,
       SUM(CASE WHEN Status = 'Aprove' THEN 1 ELSE 0 END) AS Aprove,
       SUM(CASE WHEN Status = 'Rejected' THEN 1 ELSE 0 END) AS Rejected
FROM MyTable
GROUP BY Operated_By  
"
267,User to location mapping with country state and city in the same table,"CREATE TABLE Country (CountryID int, Name varchar(50))
CERATE TABLE State (StateID int, CountryID int, Name varchar(50))
CREATE TABLE City (CityID int, StateID int, Name varchar(50))
"
11816,merging two SELECT queries,"SELECT `date`
   FROM `tasks` WHERE `user_id`=1
UNION
SELECT `t1`.`date`
   FROM `tasks` `t1`
   INNER JOIN `urls` `u1` ON `u1`.`id` = `t1`.`url_id`
   WHERE `u1`.user_id`=1;
"
38437,Sql Query condition based on column can holded bit,"select ProdID, 
       min(Qualified),
       case when min(Qualified) <> max(Qualified) 
            then 'YES'
            else 'NO'
       end as Has_different_results
from VarAnn_Data.dbo.tblOwnership
group by ProdID
"
11081,Select total of childrens in multiple tables in one query with mysql,"select u.name, w.uw as wins, l.ul as loses, d.ud as draws from user
    left join (select user, COUNT(id_won) uw from wons group by user) w on w.user = u.user_id
    left join (select user, COUNT(id_lose) ul from loses group by user) l on l.user = u.user_id
    left join (select user, COUNT(id_draw) ud from draws group by user) d on d.user = u.user_id
"
30770,create table with select syntax in mysql,"create table tbl1 (primary key (v1)) select a v1, b v2 from tbl2;
"
36341,INNER JOIN causes duplicated rows,"select SUM(TIME_TO_SEC((TIMEDIFF(t.end,t.start)))) from times AS t WHERE userid=8 AND deleted=0 AND t.id not in (select shiftID from changes);
"
25027,SQL command to LINQ (pivoting),"context.log_sales
.GroupBy(s => new {Year = OrderTime.Year, Month = OrderTime.Month})
.Select
( g => new {
  Date = new DateTime(g.Key.Year, g.Key.Month, 1),
  Location1 = g.Where(s => s.Location == ""Location1"").Sum(s => s.Charge),
  Location2 = g.Where(s => s.Location == ""Location2"").Sum(s => s.Charge),
  Location3 = g.Where(s => s.Location == ""Location3"").Sum(s => s.Charge),
  }
)
.OrderBy(x => x.Date);
"
2994,SQL Limit min and max value in database,"CREATE TABLE TBL_CD(
CDnr                int identity(1,1),
CDTitel             nvarchar(80) NOT NULL,
CDduur              int,
CDprijs             smallmoney,
check (CDprijs between 0 and 100),
"
23470,SQL to remove duplicated records by ignoring non-letters and non-digits,"SELECT DISTINCT REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(columnA, '/', ' '), '.', ' '), ',', ' '), '+', ' '), '-', ' '), '  ', ' '), '  ', ' ')
FROM tableA;
"
23904,How can I print the SQL query executed after Perl's DBI fills in the placeholders?,"$dbh->trace($dbh->parse_trace_flags('SQL|1|test'));
"
3629,"How to use a table variable in an ""update from select"" query?","UPDATE U SET U.Units = U.Units + CI.ItemUnits
    FROM @CurrentItems CI INNER JOIN U ON U.UId=CI.ItemId;
"
29409,MySQL - can't group by correctly in pivoted table,"select ad_st_id_state,
       avg(case when id_brand = 72 then vp_retail end) as Brand_72,
       avg(case when id_brand = 75 then vp_retail end) as Brand_75
from sf_product join
     sf_brand
     on fa_ba_id_brand = id_brand
where vi_pr_id_proyect = 5
group by ad_st_id_state;
"
5518,"SQL ""Join"" on null values","SELECT * 
FROM T1 JOIN T2 
ON T1.SOMECOL = T2.SOMECOL OR (T1.SOMECOL IS NULL AND T2.SOMECOL IS NULL)
"
17844,mysql avoiding subqueries,"SELECT userid, COUNT(entrytime)
FROM yourtable
GROUP BY userid
HAVING COUNT(entrytime) = 0
"
12031,How to subtract one row from another row in the same table?,"select RequisitionCode ,
(
ISNULL((select top 1 ApprovedCount from RequisitionHistory rh
where rh.RequisitionCode =r.RequisitionCode order by rh.RequisitionDate desc),0)
-
ISNULL(
(select top 1 ApprovedCount from RequisitionHistory rh1 where rh1.RequisitionHistoryCode
NOT IN 
  (select top 1 RequisitionHistoryCode from RequisitionHistory rh2 
    where rh2.RequisitionCode =r.RequisitionCode order by rh2.RequisitionDate desc) 
  and rh1.RequisitionCode = r.RequisitionCode order by rh1.RequisitionDate DESC),0))
as StructureChange 
from Requisition r
"
20167,SQL Query to select certain number of records with WHERE clause,"select * from ( 
  select top 500 * from (
    select top 1000 * FROM Records WHERE EntityType='Business' ORDER BY ID DESC 
  ) x
  order by id 
) y 
order by id desc 
"
5980,Use own tuples in JOIN statement,"declare @T table(ID int)
insert into @T values (1),(2),(3),(4),(5)

select *
from @T as T1 
  inner join (
              values (1, 'Row 1'), 
                     (2, 'Row 2')
             ) as T2(ID, Col1)
    on T1.ID = T2.ID
"
36169,SQL Server : select same colums count by date,"select 
    *, 
    (select COUNT(*) from YourTable b where b.L_Date<=a.L_Date) [Count (<=)] 
From YourTable a
"
9839,Select X random users per item,"SELECT Items.[ItemID],
       UserID
FROM   Items
       OUTER APPLY (SELECT TOP ([Num_Users]) *
                    FROM   Users
                    ORDER  BY Newid()) A 
"
33564,How to conditionally select properties of a table in PostgreSQL,"SELECT
    m.id
    , m.is_thing
    , m.color
    , t.volume
    , t.age
FROM main m
LEFT JOIN thing t
ON t.id = m.id
WHERE m.id = 1234;
"
36738,SQL query to select from two tables with if condition,"  SELECT    * 
    FROM    Notification n
            LEFT OUTER JOIN Acknowledgment a ON a.parent_id = n.id
  WHERE     (a.parent_id IS NULL OR a.status = @somevalue)
"
23665,I need a specific output,"select n.name, v.value, coalesce(nv.cnt, 0) as ""Number""
from (select distinct name from table t) n cross join
     (select distinct value from table t) v left outer join
     (select name, value, count(*) as cnt
      from table t
      group by name, value
     ) nv
     on nv.name = n.name and nv.value = v.value;
"
35348,MySQL - Update images name in database from .jpg to .png,"UPDATE question
  SET questionLink = REPLACE(questionLink, '.jpg', '.png');
"
15554,T-SQL 2008 Select first second and third row of group,"select
    Achievement,
    sum(case when RankNum = 1 then 1 else 0 end) as HighRank1,
    sum(case when RankNum = 2 then 1 else 0 end) as HighRank2,
    ...
from (
    select
        PersonId,
        Achievement,
        row_number() over(
            partition by PersonId order by Rank) as RankNum
    from sourcetable
) as t
group by Achievement
"
24813,SQL Query Grouping Two Columns Into One,"SELECT
Location,
SUM(CASE WHEN SaleDate = '2012-11-12' THEN DollarSales ELSE 0 END)'Sale on 11/12'
SUM(CASE WHEN SaleDate = '2012-11-19' THEN DollarSales ELSE 0 END)'Sale on 11/19'
FROM [TableName]
GROUP BY Location
ORDER BY Location
"
9505,Mysql set label to Rollup or a similar GROUPING function like sql server,"group by ifnull(ugr.group_name, '')
"
2862,Retrieve rows that matches with all the values listed,"SELECT user_id,count(group_id)
 FROM group_privilege_details g
WHERE g.group_id in (102,101) 
GROUP BY user_id
HAVING count(group_id) = 2
"
31633,SQL Conditional use of columns in where clause,"WHERE ((XAxis = 'Parcel' AND Orders.Issuedate = @DATE) OR
      (XAxis = 'Box' AND Orders.Packdate = @DATE))
"
6380,Returning Database values dependent on days not dates,"WHERE Datepart(dw, TaxDate) = 2
"
19682,Making an column auto increment through script,"`CREATE OR REPLACE TRIGGER table_a_BEFORE_INSERT_TRIGGER 
BEFORE INSERT ON table_a 
FOR EACH ROW
BEGIN
  SELECT increment_seq.NEXTVAL
  INTO   :new.id
  FROM   dual;
END;
/`
"
13753,Patindex in SQL Server 2008 R2,"Select substring(Data, PatIndex('%[0-9]%', Data), 1)
from(
    select 'Charged Hourly Fee for 3 CR for BCP202DL Personal Development II' as Data
)x
"
39688,Finding number of executions of Oracle SQL between two snap ids,"        Plan Hash           Total Elapsed                 1st Capture   Last Capture
     Value                    Time(ms)    Executions       Snap ID        Snap ID
    --- ---------------- ---------------- ------------- ------------- --------------
     54069910                   81,459           256         19864          19864
"
19667,How do I select single row in a group based upon date?,"select * from tb 
join (
        select tb.item, 
        MAX(tb.effDate) effDate
        from tb
        where tb.effDate <= currentDate
        group by tb.item
    ) tmp 
    on tb.item = tmp.item
    and tb.effDate = tmp.effDate
"
7024,Detecting changes within a dataset in mysql,"SELECT t.id, t.date, t.value, if( (

SELECT td.value AS last_value
FROM tab td
WHERE td.date < t.date
ORDER BY td.date DESC
LIMIT 1
) <> t.value, 'changed', 'unchanged' ) AS cstatus
FROM tab t order by date
"
18616,SQL strip text and convert to integer,"SELECT SUBSTRING(column, PATINDEX('%[0-9]%', column), 999)
FROM table
"
21592,What is the best way to enforce constraints across tables?,"CREATE TABLE customer (
  id   SERIAL PRIMARY KEY,
  type TEXT,
  -- other columns...
  constraint unique_cust_type unique (id, type) -- this makes the combination id/type ""referencable""
);


CREATE TABLE product_order 
(
  id          SERIAL PRIMARY KEY,
  customer_id INTEGER,
  type        TEXT default 'business',
  CHECK (type = 'business'),
  foreign key (customer_id, type) references customer (id, type)
);
"
9588,Select last N# of columns of a table from MySQL,"SELECT 
  CONCAT('SELECT ', 
         GROUP_CONCAT(COLUMN_NAME), 
         ' FROM test') 
FROM 
  (SELECT 
    COLUMN_NAME, 
    ORDINAL_POSITION 
  FROM 
    INFORMATION_SCHEMA.COLUMNS 
  WHERE 
    TABLE_SCHEMA='test' 
    AND 
    TABLE_NAME='test' 
  ORDER BY 
    ORDINAL_POSITION DESC LIMIT 10) AS ord_desc 
ORDER BY 
  ord_desc.ORDINAL_POSITION
"
22883,Finding what value was inserted into an auto-incrementing field,"ALTER PROCEDURE [dbo].[Create_Room]  
    @ManagerId varchar(50), 
    @Topic varchar(50)
AS
BEGIN
    DECLARE @NewRoomID INT

    insert into Rooms(ManagerId, Topic) values(@MangerId, @Topic)
    SELECT @NewRoomID = SCOPE_IDENTITY()

    insert into Rooms_Users(UserId, RoomId) values(@ManagerId, @NewRoomID)
END
"
20741,Merge user permissions,"select resource_ , decode(appl_access,3,'F',1,'A') from (
      select r1.resource_, max (decode(r1.access_,'F',3,'D',2,'A',1,0)) 
        appl_access from res r1
      group by r1.resource_)
where appl_access in (1,3);
"
31422,Select and aggregate last records base on order,"WITH recordsList
AS
(
    SELECT Type, Charges,
            ROW_NUMBER() OVER (PArtition BY TYPE
                                ORDER BY [ORDER] DESC) rn
    FROM tableName
)
SELECT  SUM(Charges) totalCharge
FROM recordsLIst
WHERE rn = 1
"
16420,"In SQL Server, finding in a string record with 7 but not 17, but could have both","where ' ' + col + ' ' like '% 7 %'
"
31611,Create oracle trigger that will update a new column with the concatenated values of the updated columns,"
  create or replace trigger pick_a_name
   before insert or update
   on mytable
   for each row
 begin
    :new.full_name := :new.firstName ||' '|| :new.lastName;
 end pick_a_name;
"
11942,Keeping Unique Rows with Group By Cube,"select campus,
(
    select avg(wage)
    from 
    (
        select ssn, campus, wage, row_number() over(partition by SSN order by wage) as RN
        from #thetable as inside
        where (inside.campus=outside.campus or outside.campus is null) 
    ) as middle
    where RN=1
)
from #thetable outside
group by cube(campus);
"
34774,Join two tables to get common data based on a column,"select Table1.colA,Table1.colB,Table1.colC from Table1 
WHERE EXISTS (SELECT 1 FROM Table2 WHERE Table1.colC = Table2.colZ)
"
16538,How to select the field that contains numbers and letters?,"^([0-9]+[A-Za-z]+[0-9]*)|([A-Za-z]+[0-9]+[A-Za-z]*)$
"
23594,Select date from timestamp SQL,"SELECT title, date(timestamp) AS MYDATE
FROM Team_Note TN
WHERE id = 1
"
10764,Assign daily work entries to contract dates without proper foreign keys,"WITH contract_range as (
     SELECT 
       ID ContractID,
       ContractDate, 
       LEAD(ContractDate, 1, GETDATE()) OVER (ORDER BY ContractDate) AS EndContract
     FROM Contract
)
select t.PersonID, cr.ContractID, cr.ContractDate, t.StartTime, t.EndTime, t.EntryDate
from contract_range cr
inner join Times t
   ON t.EntryDate >= cr.ContractDate
   AND t.EntryDate < cr.EndContract
"
10404,How to throw out WEEKENDS from calculation in SQL QUERY?," AND DAYOFWEEK(booked_date) <> 1 AND DAYOFWEEK(booked_date)<>7
"
36072,Triple Inner Join preserving headings,"SELECT
p.personName
,MAX(CASE WHEN f.featureName='Weight' THEN d.value END) Weight
,MAX(CASE WHEN f.featureName='Age' THEN d.value END) Age
,MAX(CASE WHEN f.featureName='Height' THEN d.value END) Height
FROM people p
LEFT JOIN data d ON(p.personId=d.pId)
LEFT JOIN features f ON(f.featureId=d.fId)
GROUP BY d.pId
"
28,how can i make database consistent in this situation?,"START TRANSACTION -- Or SET autocommit = 0
INSERT INTO two SELECT * FROM one WHERE ...;
DELETE FROM one WHERE ...;
COMMIT
"
22685,Query to analyze log-in data and intelligently identify a shift worked,"select t1.username, t1.end_dt_tm beforeBreak, t2.start_dt_tm afterBreak, t2.start_dt_tm - t1.end_dt_tm as diff 
from user_activity t1, user_activity t2
where t1.username = t2.username and t2.start_dt_tm = 
(
  select min(nxt.start_dt_tm) from user_activity nxt 
  where nxt.username = t1.username and nxt.start_dt_tm > t1.end_dt_tm
)
;
"
8693,how to convert the stored procedure to Linq,"var query = dbContext.DraftLOB
    .Where(u => u.AssemblyId.HasValue &&
                u.SessionId.HasValue &&
                @LOBID == null ? true : u.LOBId == @LOBID)
    .OrderBy(u => u.SrNo1)
    .ThenBy(u => u.SrNo2)
    .ThenBy(u => u.SrNo3)
    .ToList();
"
33581,How to make a macro function on filemaker pro?,"If [ Requests::nTickets > 40 ]  
Show Custom Dialog [ 
>>>Title: ""Limited Number of Tickets""; 
>>>Message: ""The number of tickets available for purchase is limited to 40. Please re-enter the amount of tickets you would like to purchase."";
>>>Default Button: OK, Commit: Yes;
]    
Go to Field [ FTS_Questions::nTickets ]
Exit Script
End If
"
26960,Sql query to find rating?,"SELECT RestaurantId
, SUM(FoodQuality+Service+Atmosphere+Value) rating1 -- the sum of total rating
, AVG(FoodQuality+Service+Atmosphere+Value) rating2 -- the average of total rating, max 20
, AVG((FoodQuality+Service+Atmosphere+Value)/4) rating3 -- the average of average rating, max 5
FROM table
GROUP BY RestaurantId
"
22552,"MySQL List Set theory, relational database","select *
from business
where not exists(
  SELECT 1 FROM 
  ( 
      -- nested query that retrieves values of list 1
      SELECT val FROM list1
  ) x
  JOIN
  (
    -- nested query that retrieves values of list 2
      SELECT val FROM list2
  ) y
  ON x.val = y.val
);
"
8027,Grails/Hibernate Batch Insert,"Hibernate disables insert batching at the JDBC level transparently if you use an identity identifier generator.
"
11859,Select multiple counts from one database table in one sql command,"SELECT   ItemScanPoint,
         SUM(CASE ItemType WHEN 1 THEN 1 ELSE 0 END) ,
         SUM(CASE ItemType WHEN 2 THEN 1 ELSE 0 END)   
FROM     ItemsScan 
GROUP BY ItemScanPoint
"
13381,MySQL: Create all the rows where at least one attribute belongs,"SELECT b.id, group_concat(c.a) a
FROM a_b
  JOIN a ON a.id = a_b.a
  JOIN b ON b.id = a_b.b
  JOIN a_b c on b.id = c.b
WHERE a.name = 'bob'
GROUP BY b.id
"
13111,SSRS group header expression,"=Switch(
  Fields!sCcy_Code.value = 1, ""Dollars""
  Fields!sCcy_Code.value = 2, ""Pounds""
  Fields!sCcy_Code.value = 3, ""Euro""
  1=1, ""Other Currency"")
"
33924,select minimum from two tables using left join,"select f.FOO_ID, f.A_STRING, min(d.dt) as 'MY_DATE'
from FOO f
left join (
  select FOO_ID, min(A_DATE) as dt from A_DATES group by FOO_ID
  union select FOO_ID, min(B_DATE) as dt from B_DATES group by FOO_ID
) d
  on f.FOO_ID = d.FOO_ID
group by
  f.FOO_ID, f.A_STRING
"
38092,sql optimize update and select queries,"SELECT
  id
INTO #ids
FROM table_1
WHERE
      atr_1 =  param_1
  AND atr_2 <= param_2
  AND atr_3 >  param_3
  AND ...

UPDATE
  t1
SET 
  atrDate_1 = date_1
FROM #ids    tmp
JOIN table_1 t1  ON id = tmp.id

SELECT
  t1.*
FROM #ids    tmp
JOIN table_1 t1  ON id = tmp.id
"
11779,Get all parents for given element and their siblings,"with parents as (
  select level lvl, id
  from t_hier
  start with id = 7
  connect by id = prior parent
)
select distinct id from t_hier
where id != 7
start with id in (select id from parents where lvl > 1)
connect by prior id = parent and level <= 2;
"
29523,Replace IN query in the sql server,"SELECT  *
FROM    TABLE1
WHERE   CONDITION1 <> TRUE -- CONDITION1 = FALSE 
    OR  (FIELD1 = 'TEXT1' OR FIELD1 = 'TEXT2')
"
19435,case statement in where clause SQLSERVER,"where (case when @onlyMM = 1 then man_zrdtyp else -1 end) not in (1616,2001)
"
30212,PostgreSQL search column for like strings,"select
  Col_2,
  count(*)
from 
  your_table
group by
  Col_2
having
  count(*) > 1
"
14126,I need to convert an existing date field in SQL to Month and Year and place them in a new table in two new columns,"INSERT INTO #TempTable(sCliNum, dtProc, sAssignNum, sCollectNum, cFees, cAdj1, cAdj2, year, month, day)
SELECT 
    sCliNum, 
    dtProc, 
    sAssignNum, 
    sCollectNum, 
    cFees, 
    cAdj1, 
    cAdj2,
    DATEPART(yyyy, dtProc), -- year
    DATEPART(mm, dtProc),   -- month
    DATEPART(dd, dtProc)    -- day
FROM DailyHist
"
23396,Subquery to get aggregate with different WHERE clause,"SELECT sum( CASE WHEN network = 'Search Network' THEN Ctr ELSE 0 END )
"
29318,SQL Server SQL Select: How do I select rows where sum of a column is within a specified multiple?,"WHERE MyField % 4 = 0 OR MyField % 8 = 0
"
6869,How does SQL Server retrieve a plan out of the plan cache?,"logical reads X, physical reads Y
"
37588,"mysql query, selecting from 3 tables","SELECT Ids.leadId
FROM
    Ids JOIN
    rlds ON rlds.leadId = Ids.LeadId AND recID = 999 AND rdate > '03-20-2012'
WHERE Ids.Status = 'ok'

UNION

SELECT leadId
FROM pIds
WHERE recID = 999 AND change IS NOT NULL AND pdate > '03-20-2012'
"
15779,Sum comma separated values in Oracle SQL,"create or replace function calc(i_str in varchar2)
  return number is l_result number;
begin
  execute immediate 'select ' || i_str || ' from dual'
    into l_result;
  return l_result;
exception
  when others then
    return null;
end;

select calc(replace('0,4,2,88,6', ',', '+')) from dual
--> 100
"
22630,"how to insert data into table from stored proc, manual values together in a single insert statement","DECLARE @TBL TABLE(
    	C1 INT,
    	C2 INT
)

INSERT INTO @TBL (C1, C2) EXEC sptemp

SELECT *, 34 FROM @TBL
"
5359,Handling versions,"release_id, 
version_id, --foreign key 
type, -- this is either UPDATE or PATCH
release_name, -- this is the full ver number 1.0.1, for instances
changelog,
download_link
"
37514,Set Foreign Key Column In Child Table To Null If Parent Foreign Key Deleted,"ON DELETE SET NULL
"
24299,count substring_index,"select *
from xxx
where char_length(replace(ABC, '.', '')) + 3 = char_length(ABC)
"
22292,update table using cursor?,"USE AdventureWorks
GO
DECLARE @ProductID INT
DECLARE @getProductID CURSOR
SET @getProductID = CURSOR FOR
SELECT ProductID
FROM Production.Product
OPEN @getProductID
FETCH NEXT
FROM @getProductID INTO @ProductID
WHILE @@FETCH_STATUS = 0
BEGIN
PRINT @ProductID
FETCH NEXT
FROM @getProductID INTO @ProductID
END
CLOSE @getProductID
DEALLOCATE @getProductID
GO
"
39012,Convert varchar to time,"SELECT CAST(STUFF('09:47:11:895799', 9,1,'.') AS TIME)
"
9776,How to update the 2nd and 3rd character in string with X,"update employee 
set last_name =  stuff(last_name, 2, 2, 'XX') 
where Employee_Id = 'A.Abrahams'
"
36285,How do you add a unique primary key field automatically in SQL Server?,"alter table database.schema.table_t
    add ID_column int identity(1,1)
    primary key (ID_column)
"
7911,Distinct for two columns using SQL Server 2008 R2,"WITH CTE AS
(
 select cola,colb,colc,cold,cole,colf,colg,colh,coli,colj,colk,
        rn = ROW_NUMBER() OVER (PARTITION BY cola, colb ORDER BY cola)
 from test
 where cola in (select colb from test)
)
SELECT  cola,colb,colc,cold,cole,colf,colg,colh,coli,colj,colk
FROM CTE
WHERE rn = 1
"
33383,multiple records due to yes/no,"SELECT 
  Roster.UserID, 
  Max(EventLog.Priority), 
  Max(IIf([EventLog]![Priority]=True, [EventLog]![Date], Date()-183)) AS [Review Date]
FROM EventLog 
INNER JOIN Roster 
ON EventLog.UserID = Roster.UserID
GROUP BY Roster.UserID
"
29784,Use Partition By to return the MAX record from Join SQL,"WITH records
AS
(
    SELECT  ....,
            ROW_NUMBER() OVER (PARTITION BY CompanyIDticketID
                               ORDER BY stepCompanyStepOrder DESC) rn
    FROM    ....
)
SELECT  *
FROM    records
WHERE   rn = 1
"
35180,How to set network adapter used by SQL Server Replication?,"   ping server1
   ping server2
"
9352,SQL - Calculated field base on calculated field?,"Column A
Column B
Column C = Column A & Column B
Column D = Case When (Column A & Column B) = 001-002 then XXXX
"
29740,In Subsonic 2.1 how do I get a strongly typed object from find?,"IDataReader result = Animal.Find(criteria);
AnimalCollection coll = new AnimalCollection();
coll.Load(result);
result.Close();

// do something with coll
foreach (Animal anm in coll)
{
    // do something with animal object
}
"
13796,value >= all(select v2 ...) produces different results from value = (select max(v2) ...),"create table t (f int null);

select 1 where 1 >= (select max(f) from t); -- 1
select 1 where 1 >= all(select f from t);   -- 2

insert into t values (null), (0);

select 1 where 1 >= (select max(f) from t); -- 3
select 1 where 1 >= all(select f from t);   -- 4
"
32081,How to cache data in a MVC application,"    public string[] GetNames()
    {
      string[] names = Cache[""names""] as string[];
      if(names == null) //not in cache
      {
        names = DB.GetNames();
        Cache[""names""] = names;
      }
      return names;
    }
"
11390,Left Join table only if another join passes some criteria,"SELECT
  A.* 
FROM
  TableA A
LEFT JOIN
  (
    TableB B 
  INNER JOIN
    TableC C
      ON  B.CID = C.CID 
      AND C.PassesTest
  )
    ON B.BID = A.BID
"
14380,Exploding Array of Struct using HiveQL,"SELECT  * FROM (select user_id, prod_and_ts.product_id as product_id,
regex_replace(prod_and_ts.timestamps, ""#\\d*"", """")  as timestamps FROM table2 LATERAL VIEW
explode(purchased_item) exploded_table as prod_and_ts) prod_and_ts;
"
16503,How do I list total number of records with similar name in SQL?,"SELECT Spec, SUM(Quantity) AS Quantity FROM Poles GROUP BY Spec
"
3306,LEFT JOIN (SELECT FROM WHERE >Values from another JOIN'ed table<),"FROM THeaders th
LEFT JOIN TItems ti ON th.rtid = ti.rtid
OUTER APPLY (SELECT TOP 1 MC, GH, GC, DI, DC FROM Prod WHERE ti.MC = MC) oa
"
13975,SQL Server to select conditional on what time of year it currently is,"SELECT Name, Position, StartTerm, EndTerm 
  FROM myTable 
 WHERE YearOfTerms = Year(DateAdd(mm, -4, GetDate()))
"
23908,Is there a way I can concatenate two columns with different functions?,"select ('Q' + datename(quarter, [Evaluation Date]) + ' ' +
        datename(year, [Evaluation Date])
       ) as QYYYY
"
15799,Banding a date range in oracle,"select a.A_FIELD, to_char(add_months(a.START_DATE,r), 'Mon-yy') as display_month
from MY_TABLE a, (
    select rownum-1 r 
    from all_objects
    where rownum <= 200) b
where add_months(trunc(a.START_DATE,'mm'),r) <= trunc(a.END_DATE,'mm')
order by A_FIELD, b.r
"
7532,how to do a sum in mysql,"SELECT
  p.Level AS LevelID,
  IFNULL(COUNT(DISTINCT p.playerID),0) AS nbPlayerPerLevel,
  IFNULL(COUNT(DISTINCT pp.playerID),0) AS totalPlayer
FROM
  Player AS p
  LEFT JOIN Player AS pp ON p.Level<=pp.Level
GROUP BY p.Level 
ORDER BY p.Level DESC 
"
30989,Grouping/aggregating SQL results into 1-hour buckets,"SELECT SLOT_HOUR, SUM(order_id)
FROM
    ONEHOURSLOTS
    LEFT JOIN ORDERS ON DATEPART(hh, order_date) = SLOT_HOUR
GROUP BY SLOT_HOUR
"
2125,rpad doest work correctly,"select replace(regexp_replace(COMERCIO,'[^[:print:]]', '!ACK!'),' ','.') as CAT_VET
from SIEBEL.transacciones_acumulaciones
where   ESTADO  = 'Procesado'
AND NUMERO in ( '20232385',
  '20225479', 
  '20265516');
"
25528,How do I add a space in front of my number if it is a single digit?,"LPAD(player_number, 2,' ')
"
9652,Query execution time in PL/SQL Developer,"set timing on;
select * from table_name where customer_id=1;
"
21040,"SQL Server: Insert if doesn't exist, else update and insert in another table","INSERT INTO PersonBackup
SELECT P.Name, P.Addr, P.SSN, P.PrimaryKeyID
FROM Person P
INNER JOIN source s ON P.SSD = s.SSD

MERGE Person AS target
USING (SELECT Name, Addr, SSN FROM SOURCE) AS source (NAME, Addr, SSN)
ON (target.SSN = source.SSN)
WHEN MATCHED THEN   
    UPDATE SET name = source.name, Addr = source.Addr
WHEN NOT MATCHED THEN
    INSERT(Name, Addr, SSN)
    VALUES(source.name, source.addr, source.SSN)
"
31395,column statement not working in Oracle,"core> column event heading ""This will work""
core> column v$session.event heading ""This will not""
core> select v$session.event from v$session where rownum=1;

This will work
----------------------------------------------------------------
VKTM Logical Idle Wait
"
1403,Is it possible to list attribute values for one column based on a common attribute value in another column,"select t1, t2, group_concat(concat(t3,'(',cateogoryId,')'),', ') x

from something

group by 1,2
"
27582,How to update Oracle Timestamp value from the current to a timestamp from the past,"UPDATE EVENT_TABLE_T 
SET LAST_UPDATE_DT = last_update_dt - interval '45' day
WHERE LAST_UPDATE_DT = TO_TIMESTAMP('01-JUL-2013 11:20:22:37448900','DD-MON-YYYY HH24: MI:SS:FF')
"
32939,SQLView not working,"WHERE start_date <= sysdate
AND closing_date >= sysdate
"
4729,Alternative to INTERSECT Given Arbitrary Number of conditions,"SELECT MyID
FROM tableName
WHERE MyValues IN ('Meat', 'Fruit', 'Veggies')
GROUP BY MyID
HAVING COUNT(DISTINCT myVAlues) = 3
"
35639,SQL Query to count how many jobs requested a combination of services,"select count(*) as jobsWithAandC from (
    select s.jobID
    from services as s
    where s.service in ('A', 'C') /* you didn't tell us this column */
    group by s.jobID
    having count(s.service) = 2 /* distinct probably isn't necessary */
    /* here are other equivalent options */
    --1) having min(s.service) = 'A' and max(s.service) = 'C'
    --2) having count(case when s.service = 'A' then 1 else null end) > 0
    --      and count(case when s.service = 'C' then 1 else null end) > 0
) as T
"
33837,SQL query to find resource containing more than one tag,"select t.MD5, r.Title, r.Link, t.Category
from Resource r inner join Tags t on r.MD5 = t.MD5
where exists (select category from Tags t1 where category = @tag and t1.MD5 = r.MD5)
and exists (select category from Tags t1 where category = @tag2 and t1.MD5 = r.MD5)
"
13731,SQL Multiple record : Time Scheduler,"select t.time, 
isnull(
(select c.studentCode 
from tbClassRsv c 
where c.transdate='2014-02-05 00:00:00' 
and c.class='ROOM 01'
and c.status<>'DEL' 
and DateAdd(MINUTE, 30, Convert(datetime, t.time))>= Convert(datetime, c.time) 
and Convert(datetime, t.time) <= Convert(datetime, c.until)
),'-') from [tbTime] t
"
30072,Oracle: Select time in HH:MI format eg: 30:00,"Select to_char(TRUNC(runtimeCol/3600),'09') || ':' || to_char(TRUNC(MOD(runtimeCol,3600)/60),'09')  from yourTable
"
39982,Oracle SQL View: Multiple rows to one with help of foreign key,"SELECT a.pk_id,a.value,
MAX(CASE WHEN b.key='key1' THEN b.value ELSE '0' END) AS key1,
MAX(CASE WHEN b.key='key2' THEN b.value ELSE '0' END) AS key2,
MAX(CASE WHEN b.key='key3' THEN b.value ELSE '0' END) AS key3
FROM table_b b 
LEFT OUTER JOIN table_a a on a.pk_id = b.fk_id
GROUP BY b.fk_id,a.pk_id,a.value
ORDER BY b.fk_id ASC
"
12468,How do I get the Identity field that results from an insert?,"DECLARE @ID INT

INSERT INTO MyTable (Field1, Field2)
VALUES ('test', 5)

SELECT @ID = SCOPE_IDENTITY() 
"
22101,MS SQL Grouping by day then count result for each day,"select 
   visitDate, 
   sum(case when customerType = 'A' then 1 else 0 end) as TypeA,
   sum(case when customerType = 'B' then 1 else 0 end) as TypeB,
   count(*) as Total
from (
    select distinct 
        customer, 
        cast(visitdate as date) as visitdate, 
        customertype from activity
    ) x
group by 
    visitdate
"
15680,SQL: highest order center for each customer,"WITH cte_centers AS
(SELECT DISTINCT cusid FROM orderdb)
SELECT cte_centers.cusid, x.numofcenter
FROM cte_centers 
CROSS APPLY
(SELECT TOP 1 
    count(centerid) numofcenter
 FROM orderdb
 WHERE isnumeric (cusid)=1
    AND estimate=0
    AND orderdb.cusid = cte_centers.cusid
 GROUP BY centered, cusid
 ORDER BY count(centerid) DESC
)x
"
35063,Check if a string contains a value from one table,"SELECT id, lib_type FROM (
  SELECT id, lib_type, 1 prio FROM mytable
  WHERE UPPER('Foch Highschool') LIKE UPPER('%'||lib_type||'%')
  UNION ALL 
  SELECT id, lib_type, 2 prio FROM mytable
  WHERE id=3
  ORDER BY prio
) z
WHERE ROWNUM=1;
"
12513,Escape underscore in LIKE,"SET @CheckStr = REPLACE(@salt, '_', '[_]') + '%'
"
38251,Why does MATCH AGAINST return different results than LIKE?,"SELECT * FROM object_search
WHERE MATCH (keywords)
    AGAINST ('+woman +man' IN BOOLEAN MODE); -- could return rows containing both ""man"" and ""woman"" (ignoring ft_min_word_len, see below)
"
8946,Preserving relational integrity with Mnesia,"-record(user, {id, name, salt, pass_hash, email, entries}).
-record(entry, {id, title, body, slug, users}).
"
18694,Supress stored procedure result,"IF @SlientExit = 1
  RETURN
"
28261,SQL join statement with where clause,"  SELECT name,ort FROM kunde WHERE name NOT IN (SELECT DISTINCT(pizzeria) FROM Liefervertrag WHERE product='salat')
"
27258,"""Join"" admins of different tables into a string","select id, name, topic, group_concat(owner_admin) from (
    select id, name, topic, owner owner_admin from rooms
    union
    select id, name, topic, account_id from rooms
    left join room_admins on id = room_id
) s
where name like ""%htm%"" or topic like ""%htm%""
group by id, name, topic
"
37953,Query a column and change value to numeric value,"SELECT
    CASE MyCol
       WHEN 'MN' THEN 1
       WHEN 'ABB' THEN 2
       WHEN 'BO' THEN 3
       WHEN 'BN' THEN 4
    END
FROM
    dbo.Yourtable
"
3873,Get SCOPE_IDENTITY value when inserting bulk records for SQL TableType,"declare @NewId table (MyNewId INT) 

 insert into Table_2(Table_A_Id,Table_1_Id)
 output INSERTED.MyNewId INTO @TempTable(MyNewID)
 SELECT SomeValue, SomeValueAsParameter FROM @TType_Table_A;

 SELECT * FROM @NewId
"
23528,SQL Oracle query to find receipts,"select trunc(ReceiptNo/1000) BookNumber, count(distinct PurchaseNo) NumPurchases
from PURCHASE
group by trunc(ReceiptNo/1000)
having count(distinct PurchaseNo) >= 10
order by 1
"
29212,SELECT all N between @min and @max,"select ROW_NUMBER() OVER (ORDER BY so1.id) from sysobjects so1,sysobjects
"
8740,Sort on foreign key table,"SELECT M.*, C.MostRecent
  FROM Message M
  JOIN (SELECT MessageID, MAX(Comment_DateTime) AS MostRecent
          FROM Comments
         GROUP BY MessageID
       ) AS C ON M.MessageID = C.MessageID
 ORDER BY C.MostRecent DESC
"
14590,changing selected values in INSERT statement,"INSERT INTO NEWTABLE (ID, VALUE, NEWVALUE)
SELECT
    ID,
    VALUE,
    CASE OLDVALUE
       WHEN 'A' THEN 'Y'
       WHEN 'B' THEN 'Z'
       ELSE OLDVALUE
    END
FROM OLDTABLE;
"
28596,MySQL Multiple updates using PK or one single update using IN (Maximum IN Size?),"Update MyTable set isDeleted = 1 where id IN (?IdList)
"
17119,MySQL Count mutual friends between multiple users,"SELECT r1.user_id AS first_user
, r2.user_id as second_user
, COUNT(r1.related_to) as mutual_friend_count
FROM relations r1
INNER JOIN relations r2
ON r1.related_to = r2.related_to AND r1.user_id <> r2.user_id
GROUP BY r1.user_id, r2.user_id
"
16183,PL/SQL Procedure Variable instead of column name in insert statement,"insert into mytable(user_id, name, col1, col2, col3)
values (v_user_id, v_name,
    case when mois1 = 1 then v_value else null end,
    case when mois1 = 2 then v_value else null end,
    case when mois1 = 3 then v_value else null end
);
"
3067,How can I write an update trigger to update the current table based on a value in another table in SQL Server 2008?,"UPDATE b
SET b.MemId = a.MemId
FROM dbo.Table_B AS b
INNER JOIN Inserted AS i ON b.EmpId = i.EmpId
INNER JOIN dbo.Table_A AS a ON b.EmpId = a.EmpId
"
36106,query that is splitting a column into two,"SELECT  id ,
        CASE WHEN amount >= 0 THEN amount
             ELSE NULL
        END AS debit ,
        CASE WHEN amount < 0 THEN amount
             ELSE NULL
        END AS credit
FROM    Test.dbo.Accounts
"
26394,How to Sum Columns From Two Result Sets in MySQL,"SELECT SUM(CASE WHEN rating_type = 'up' THEN 1 WHEN rating_type = 'down' THEN -1 END CASE)
FROM posts
GROUP BY post_id
"
15183,Load database table in controller cakephp,"$preset = $this->Preset->findAllByName('foo');
"
32478,SQL where field like ,"WHERE [value] like N'%%'?
"
4098,SQL Join query assistance,"SELECT dateadd(month, datediff(month,0, cna.impdate),0) as [Month], 
       count(*) as itemcount, 
       SUM(CASE WHEN emergency = 'Emergency' THEN 1 ELSE 0 END) AS EmergencyCount
FROM myTable
WHERE impdate BETWEEN '"" + fromDate + ""' AND '"" + toDate + ""'
GROUP BY dateadd(month, datediff(month,0, cna.impdate),0)
ORDER BY [Month] asc
"
27070,Get the last count result of last query,"CREATE FUNCTION bop() RETURNS INT DETERMINISTIC
BEGIN
  DECLARE cnt INT;

  SELECT COUNT(*) INTO cnt
  FROM service
  JOIN kit ON kit.id = service.kitid
  JOIN kit_has_part ON kit_has_part.kitid = kit.id
  JOIN part ON part.id =  kit_has_part.partid
  WHERE service.id = 1 AND part.stock > 0;

  IF cnt > 0 THEN
    RETURN 1;
  ELSE
    RETURN 0;
  END IF;
END;
//
"
4976,"Converting a nested ""select in"" statement to LINQ lambda","var queryUsers = dc.lkUsers.Where(p => p.UserID == userId);
var queryLinks = dc.lkDeptLinks.Where(p => queryUsers.ref.Any(x=>x== p));
var queryDept = dc.lkDepts.Where(p => queryLinks.deptid.Any(x=> x == p.deptid));
return  queryDept
        .Select(x=>new {ID = x.deptId, Name = x.deptName, Detail = x.Detail})
        .ToList();
"
5777,Oracle: insert without columns specification,"INSERT INTO table (column1) VALUES (default);
"
1756,How do I retrieve decimals when rounding an average in SQL,"SELECT ROUND(AVG(CAST(column_name AS FLOAT)), 2) FROM [database].[dbo].[table]
"
37743,Calculating minutes within a defined time window?,"select [task end] - [task start] as taskDuration
from tasktable
where [task start] > @WindowStart and [task end] < @WindowEnd
"
32218,comparing three variables,"DECLARE @firstcount INTEGER
DECLARE @secondcount INTEGER
DECLARE @thirdcount INTEGER

SET @firstcount = 1
SET @secondcount = 2
SET @thirdcount = 3

IF @firstcount <> @secondcount SELECT 0
ELSE IF @secondcount <> @thirdcount SELECT 0
ELSE SELECT 1
"
25161,Selecting non-duplicates based on date column - SQL Server,"WITH records AS
(
    SELECT  ID,cID,DateSaved,Address ,[Phone Number],
            ROW_NUMBER() OVER (PARTITION BY cid ORDER BY DateSaved DESC) rn
    FROM    ClientRecordEntries
)
SELECT  a.*, DateSaved,Address ,[Phone Number]
FROM    Clients a
        INNER JOIN records b
            ON a.ID = b.cid
WHERE   b.rn = 1
"
23390,How would I solve this SQL exercise?,"SELECT AVG(salary) - AVG(REPLACE(salary, '0', '')) AS mistake
FROM   employees
"
20244,"SQL Trouble working with long float numbers, math","with to_update as (
     select itemNumber, QtyOnHand, TransBal
     from t
)
update tb_table
    set offset = TransBal - QtyOnHand
    from to_update
    where to_udpate.itemNumber = tb_table.itemNumber
"
30087,How to update two columns in IF statement in SQL Server,"if (update(columnA) or update(columnB))...
"
2855,Use Oracle INSTR function to search for multiple strings,"WHERE (INSTR('500 Oracle Parkway, Redwood Shores, CA', 'Apple') > 0
      OR
      INSTR('500 Oracle Parkway, Redwood Shores, CA', 'Park') > 0
      OR
      INSTR('500 Oracle Parkway, Redwood Shores, CA', 'Shores') > 0)
"
39576,How to make order by a_datetime more important that datetime?,"SELECT * 
  FROM forum_question LEFT JOIN forum_answer 
    ON forum_question.id = forum_answer.question_id
 WHERE category =  '7'
   AND  `sticky` =0
 GROUP BY forum_question.id
 ORDER BY (reply = 0),
       CASE WHEN reply > 0 THEN a_datetime
            ELSE datetime
       END DESC 
"
30603,How to update a row automatically when the time is right?,"update mytable
set status = 'ongoing'
where status = 'new'
and time < getdate()
"
29848,Query to get one entry from multiple rows,"SELECT machinename, StatusCode, size, statusID
FROM (
    SELECT
        machinename,
        StatusCode,
        size,
        statusID,
        ROW_NUMBER() OVER (PARTITION BY MachineID ORDER BY size DESC) AS rn
    FROM machine
    WHERE MachineID IN ('33','22')
    AND StatusCode = 166 
) T1
WHERE rn = 1
ORDER BY size DESC 
"
38654,SQL database (Firebird): problem with a foreign key,"YourTable.SenderFK --> Intermediary.PK
    Intermediary.SenderBufferstockFK --> tBufferstock.ID
    Intermediary.SenderFacilityFK --> tFacility.ID
    Intermediary.SenderOutsideLocationFK --> tOutsideLocation.ID
"
2267,SQL count votes in one table include name from another table,"SELECT VotedFor, count(*) As Winners, P.Name
FROM Vote inner join PersonNames as P
on Vote.VotedFor = P.ID
GROUP BY VotedFor, P.Name
ORDER BY count(*) DESC;
"
12011,SELECT fields from one table with aggregates from related table,"SELECT id, j.description, d.start, d.finish
FROM   jobs j
LEFT   JOIN (
   SELECT job AS id, min(date) AS start, max(date) AS finish 
   FROM   dates 
   GROUP  BY job
   ) d USING (id);
"
38392,SQL Server: Return row numbers while keeping DISTINCT in effect,"SELECT 
[This]
,[That]
,row_num = ROW_NUMBER() OVER ( ORDER BY [This] )
FROM MyTable
group by [This],[That]
"
9184,SQL query to find out experience of employee in the format 'yy years mm months dd days',"SELECT 
    EMPID, EMPNAME, DEPARTMENT, DESIGNATION, 

    convert(varchar(3),DATEDIFF(MONTH, DOJ, GETDATE())/12) +' years '+
    convert(varchar(2),DATEDIFF(MONTH, DOJ, GETDATE()) % 12)+ ' months' 
    AS EXPERIENCE, 

    EMPSTATUS AS JOB_STATUS 
FROM EMPLOYEE
"
33093,"MS Access, Combobox, select fields bases on query, How do I weight the result fields","cbo1.RowSource = ""Select txtValue from tbl1 where (txtValue="" & [Forms]![Form1]![txtValue] & "" ORDER BY weight)""
"
33797,Delete SQL Query,"UPDATE table_name SET
column_name = null
WHERE another_column_name = 'some value'
"
15131,SQL SELECT DISTINCT and GROUP BY problem,";WITH Distincts AS
(
    SELECT ID, col1, col2,
        ROW_NUMBER() OVER (PARTITION BY col1 ORDER BY ID) AS 'RowNo'
    FROM dbo.Table
)
SELECT
    ID, col1, col2
FROM
    Distincts
WHERE
    RowNo = 1
"
10048,MS SQL Server: Generate sequential data in SQL,"insert INTO myTable
SELECT a, b, c, DATEADD(day, ROW_NUMBER() OVER(ORDER BY a,b,c)-1, GETDATE() ) AS d
FROM MyView
"
4642,How to make my MySQL SUM() query more faster,"SELECT CityCode,SUM(A),SUM(B),SUM(C),SUM(D), SUM(E),SUM(F),SUM(AA),SUM(BB),SUM(CC),SUM(DD),SUM(EE),SUM(FF)
FROM users 
GROUP BY CityCode,A,B,C,D,E,F,AA,BB,CC,DD,EE,FF
"
26735,select 10 greater than and 10 lesser than an integer value in db2.,"select t.*
from (select t.*,
             row_number() over (partition by (case when col < target_val then 'lower' else 'higher' end),
                                order by abs(target_val - col)
                               ) as seqnum
      from table t
     ) t
where seqnum <= 10;
"
21038,How to add XML data type in a GROUP BY clause?,"WITH Children(Cnt, ParentId)
     AS (SELECT COUNT(*),
                ParentId
         FROM   dbo.Post
         GROUP  BY ParentId)
SELECT P.PostId,
       P.[Body],
       ISNULL(Cnt, 0) AS Cnt
FROM   dbo.Post P
       LEFT JOIN Children /*To include childless posts*/
         ON Children.ParentId = P.PostId
ORDER  BY P.PostId  
"
10804,"Simulate a left join without using ""left join""","SELECT A.id, 
(select b.id where  A.name = B.name) as B_ID
FROM A 
"
33218,Merging rows from the same column in SQL,"SELECT coupon_code, order_id, im.meta_value, 
CONCAT((SELECT pm.meta_value FROM `youwp_postmeta` AS pm WHERE pm.meta_key = 
'_billing_first_name' AND order_id = pm.post_id), ' ',
(SELECT pm.meta_value FROM `youwp_postmeta` AS pm WHERE pm.meta_key = 
'_billing_last_name' AND order_id = pm.post_id)) AS name

FROM 
`youwp_woocommerce_order_items` AS i,
`youwp_woocommerce_order_itemmeta` AS im,
`youwp_postmeta` AS pm,
`you_ambassador` AS a
"
39512,Efficient way of running lots of Dynamic SQL,"select id 
  from keywords 
 where keyword = 'this' 
intersect 
select id 
  from keywords 
 where keyword in ( 'that','other')
"
14850,"many-to-many relationship,, querying one side depending on its elements","RETURN EXISTS SELECT SESSION_ID FROM 
SESSION_TEST
WHERE TEST_ID = @id
AND ORDINAL = 1
AND SESSION_ID NOT IN (SELECT SESSION_ID FROM SESSION_TEST WHERE ORDINAL > 1);
"
36219,Select most current data in grouped set in Oracle,"select Account, 
       sum ( Amt_Due), 
       sum (CASE WHEN Last_Payment_Date = last_dat THEN Last_payment ELSE 0 END), 
       Max (Last_Payment_Date)
from (
  SELECT t.*,
       max( Last_Payment_Date ) OVER( partition by Account ) last_dat
  FROM table1 t
)
group by Account
"
122,SQL Sort by group size,"SELECT *
FROM sampletable s1
INNER JOIN (SELECT count(type) AS iCount,type
        FROM sampletable
        GROUP BY type) s2 ON s2.type = s1.type
ORDER BY s2.iCount DESC, s1.type ASC
"
25955,Query to display the no. Of. 'L' present in employee name from employee table,"SELECT LEN(employeename) - LEN(replace(employeename, 'L', '')) as NumberOfL, employeename FROM employee
"
3780,Insert sequential numbers based on another field - MySQL,"set @p := -1;
set @i := 0;

UPDATE my_table t
    SET page_number = (CASE WHEN @p = t.`parent` THEN @i := @i+ 1 
                            WHEN (@p := t.parent) = NULL THEN NULL -- never happens
                            ELSE @i := 1
                       END)
    ORDER BY t.parent;
"
8543,inner join mySQL,"SELECT 
  receivers.username 'Task receiver',
  givers.username 'Task giver', 
  p.project_name, 
  t.task_content
FROM tasks t
INNER JOIN login   receivers ON receivers.user_id = t.task_receiver 
INNER JOIN login   givers    ON givers.user_id    = t.task_giver
INNER JOIN project p         ON t.project_id      = p.project_id
"
4539,retrieve second 10 UNIQUE rows in SQL,"SELECT col1, col2 FROM (
    SELECT col1, col2, ROW_NUMBER() OVER (ORDER BY MAX(ID)) AS RowNum
    FROM MyTable
    GROUP BY col1, col2
) AS MyDerivedTable WHERE MyDerivedTable.RowNum BETWEEN 10 AND 19
"
22133,SQL begin end print,"declare @ID INT  
    SET @ID = 0
    IF (@ID IS NOT NULL AND @ID <> 0) 
    begin
      print 'ID is not 0 or null'
    end
"
34486,SQL - Find records with similar value,"SELECT
    *
FROM
    Tasks
WHERE TypeID IN
    (SELECT TypeID FROM Tasks
     GROUP BY TypeID HAVING COUNT(*) > 1)
"
35068,Is it possible to update parentID as part of a move opperation without using temporary columns?,"SET IDENTITY_INSERT contract ON

INSERT INTO contract ( ID, contract_parent_id, [name] )
SELECT contract_pk, contract_parent_id, contract_name FROM dbo.tbl_contract

SET IDENTITY_INSERT contract OFF
"
4741,Change XML attribute values in SQL Server XML column,";WITH XMLNamespaces(DEFAULT 'http://mynamespace.com/')
UPDATE dbo.MyTable
SET Info.modify('replace value of (/CodesParameter/Data[1]/@Code)[1] with (""B1"")')
WHERE Id = 1
"
1911,SQL Case Statement with math in Where Clause,"SELECT 
    SUM(amount) amount
FROM
    accounting ac
WHERE
    (DATEPART(mm,ac.date) = @month and @onlymonth = 0)
OR
    (DATEPART(mm,ac.date) <= @month and @onlymonth = 1)
"
37440,Check if value is positive or negative,"CASE WHEN (value1 * value2) < 0 THEN 'DiffSign' ELSE 'SameSignOrOneIsZero' END
"
25368,SQL two tables distinct counts with join,"select o.customercode, 
       count(distinct o.orderid), 
       count(distinct i.orderid), 
       count(distinct i.orderid)/count(distinct o.orderid) ratio
from table1 o
      left join table2 i on o.orderid = i.orderid and i.issuecode = 'F'
group by o.customercode
"
25242,Join Two tables having different number of columns,"SELECT
  t1.businessid,
  t1.userid,
  t1.name,
  t2.systemid
FROM
  table1 t1
CROSS JOIN
  table2 t2
;
"
8705,Performing PostgreSQL LEFT OUTER JOINS and CASEs in Django,".extra(select={'user_vote': 'SUM(CASE WHEN links_vote.user_id = 1 THEN links_vote.karma_delta ELSE 0 END')})
"
21805,How to get the final parent id column in oracle connect by sql,"SELECT LEVEL,
           ITEM_ID,
           PARENT_ID, LPAD(' ', 4 * (LEVEL - 1)) || ITEM_DESC AS ITEM_DESC
           , connect_by_root item_id  AS SUPER_ID
      FROM ORACLE_CONNET_BY_TEST
     START WITH parent_Id = 0
    CONNECT BY PRIOR ITEM_ID = PARENT_ID
    ;
"
21928,Why is this difference in output ?,"> select 643/109;
5
> select round(643/109, 0);
5.0
> select 643/109.0;
5.89908256880734
> select round(643/109.0, 0);
6.0
"
36730,SQL query for the latest record for each day,"With RankedItems As
    (
    Select  Id, otherdata, submitted
        , ROW_NUMBER() OVER( PARTITION BY TO_CHAR(submitted, 'YYYY-MM-DD') ORDER BY submitted DESC ) ItemRank
    From MyTable
    )
Select
From RankedItems
Where ItemRank = 1
"
19807,Selecting multiple rows with a sub-query,"SELECT name, job 
    FROM Employer 
    WHERE job in (SELECT job FROM employer WHERE dept = sales);
"
25950,Sum columns with null values in oracle,"select type, craft, sum(nvl(regular,0) + nvl(overtime,0)) as total_hours
from hours_t
group by type, craft
order by type, craft
"
15284,How to display the names of my SQL Server tables in a listbox using vb.net?,"Using connection As New SqlConnection(connetionString)
    connection.Open()
    adapter = New SqlDataAdapter(""SELECT name FROM sys.tables"", connection)
    Using ds = new DataSet()
        adapter.Fill(ds)
        with ListBox1
            .DataSource = ds.Tables(0)
            .DisplayMember = ""name""
            .ValueMember = ""name""
        end with
    End Using
End Using
"
16091,Insert into table using result set of dual query?,"insert into edgar_t100 (col1) 
select rownum as ID 
from dual 
connect by rownum <= 100
"
38471,Sql query where date='2012-10-22' but has more info in database,"SELECT *
FROM Table
WHERE Date >= '2012-10-22 00:00:00'
AND Date < '2012-10-23 00:00:00'
"
27451,"How to tell SQL to return TRUE on ""positive value occurance"" rather than using SUM(field) >0 condition"," select *
    from a
    where a_id in (1,2,3,4)
    and
    (
      flag = 'Y' 
      or 
      EXISTS (select b.a_id from b where b.a_id = a.a_id and qty>0)
    )
"
26507,select n rows and return a row,"select group_concat(day,'|')
from your_table
"
11802,How to update multiple rows by one query?,"UPDATE user SET reputation = reputation + (CASE id WHEN :op THEN 2 WHEN :user THEN 15 ELSE 0 END) WHERE user in (:user, :op)
"
19868,How to combine two sql queries?,"SELECT a.item_id, a.stock_balance, b.pcs_ordered, b.number_of_orders
FROM
    (SELECT stock.item_id, Sum(stock.pcs) AS stock_balance 
    FROM stock 
    GROUP BY stock.item_id) a
LEFT OUTER JOIN
    (SELECT stock.item_id, Sum(stock.pcs) AS pcs_ordered, 
            Count(stock.item_id) AS number_of_orders 
    FROM stock
    WHERE stock.operation = ""order""
    GROUP BY stock.item_id) b
ON a.item_id = b.item_id
"
6408,No rowid or key need most recent row,"select t.*
from (select t.*,
             row_number() over (partition by a, b order by date desc) as seqnum
      from mylib.myfile t
     ) t
where seqnum = 1;
"
24735,How to display LEFT JOIN results with a condition coming from a third table?,"SELECT r.title, r.off_time, rlt.horse 
FROM racing.race r
  INNER JOIN racing.meeting m ON r.meeting_id = m.meeting_id
  LEFT JOIN racing.result rlt ON r.race_id = rlt.race_id AND rlt.position = 1
WHERE m.meeting_date = CURDATE()
"
34946,need help formatting a date parameter in Oracle BI Publisher RTF template,"<?xdoxslt:format_date($p_Date, 'MMM yyyy','MM-dd-yyyy', $_XDOLOCALE, $_XDOTIMEZONE)?>
"
27720,Search Multiple Columns Returned Most Matches,"select boxId, sum(matches) 
from (select boxID, 
      (case when styleId IN (4) then 1 else 0 end) + 
      (case when colorId in (1, 5) then 1 else 0 end) matches 
       from test) t1
group by boxId
order by sum(matches) desc;
"
7849,Is it viable to translate a table with view?,"create view v_table as
     select col1 as col_1, col2 as col_2
     from table t;
"
14716,SQL: Use one Table as Input for a 'Like' Statement on Another Table,"select t.ID, t.CompetitionName, r.competition
from table1 t, rules  
where CompetitionName like 
(case when ruletype = 'Contains' then '%' + RuleA + RuleB + '%' end)
or CompetitionName in (case when ruletype = 'Equals' then RuleA end)
"
9046,NHibernate LINQ BIGINT casting,"protected HqlTreeNode VisitNhMax(NhMaxExpression expression)
{
    return _hqlTreeBuilder.Cast(
        _hqlTreeBuilder.Max(
            VisitExpression(expression.Expression).AsExpression()), 
            expression.Type);
}
"
14182,NOT DISTINCT query in mySQL,"SELECT e1.ninumber,
       e1.fname,
       e1.lname,
       e1.superNiNumber,
FROM   employee AS e1,
       employee AS e2
WHERE  e1.dno = 8
       AND e1.superNiNumber = e2.ninumber
       AND e2.dno = 8
       and (select count(*) from employee e3
            where e3.superNiNumber = e1.superNiNumber) > 1;
"
22203,Is there an sql condition that can look for non integers in a column?,"SELECT  *
FROM    mytable  
WHERE   CASE WHEN IsNumeric(mycolumn) = 1 THEN CASE WHEN CAST(mycolumn AS FLOAT) <> CAST(CAST(mycolumn AS FLOAT) AS INT) THEN 1 END ELSE 1 END = 1
"
17253,How to update and select a row within one query in SqLite?,"//1.  Fetch the id into whatever language you are using:
SELECT id FROM DATA WHERE status = 'scheduled' LIMIT 1;

//2. Retrieve the id value from Step 1's resultset
int id = [id value from the resultset];

//3. Construct the update statement
parsed_sql_stmt stmt = parse_sql(UPDATE DATA SET STATUS = 'running' WHERE ID = ?);

//4. Execute update statement
exec_stmt(stmt, id);

//5. Select everything in the DATA table for that record
stmt = parse_sql(SELECT * FROM DATA WHERE id = ?);
exec_stmt(stmt, id);
"
25335,Sorting Database Records in Descending Order,".Sort = ""RunningSpeed desc""
"
14543,How to create a table using insert so columns are nullable?,"WITH    cte ( a )
        AS ( SELECT   CAST(1 AS INT)
        UNION ALL
        SELECT   2
            )
SELECT * INTO a_tmp FROM cte
"
8439,Select non-matching record in same table - SQL,"select distinct(report_number)
from reports 
where report_type='A' and report_number not in (select report_number from reports where report_type='B')
"
34205,TSQL Optimization - WHERE clause without LIKE,"where columnX = isnull(nullif(@Account, ''), columnX)
"
15026,Select the specific row from the DB having the date of tomorrow and day after tomorrow date from the present date,"...
WHERE
   cast(AptTime as date) 
   BETWEEN dateadd(day, 1, cast(getdate() as date)) 
       AND dateadd(day, 2, cast(getdate() as date))
"
8117,How can I always get Timestamp in certain format without having to explicitly define it everytime,"var statement = ""
    SET datestyle to SQL,MDY ;
    SET lc_time   to  'en_us.utf8' ;
    SELECT ...
"
12851,Update datetime timestamp minute value,"Dateadd(minute, -DATEPART(MINUTE, @ttest) % 10, @ttest)
"
34213,How to Create Trigger to Keep Track of Last Changed Data,"CREATE TRIGGER trg_Member_MemberUpdate
ON dbo.Member AFTER UPDATE
AS
    INSERT INTO dbo.MemberLastChanged(memberID, memberName)
    SELECT d.MemberID, d.MemberName
    FROM DELETED d
"
31208,Combined aggregated and non-aggregate query in SQL,"SELECT player, year, games,
       cyear = ROW_NUMBER () OVER (PARTITION BY player ORDER BY year),
       gamesPerMax = 1.0 * games / MAX(games) OVER (PARTITION BY player)
FROM dbo.TableName
"
622,Havning count(*) my sql,"SELECT 
  dnum, 
  COUNT(*) AS Employee
FROM project 
INNER JOIN works_on ON pno = pnumber
INNER JOIN employee ON dno = dnum
WHERE salary > 20000
GROUP BY dnum 
HAVING COUNT(*) >2;
"
20079,Can I name my constraints with JPA?,"@ManyToOne
@JoinColumn(foreignKey=@ForeignKey(name=""MY_FANCY_FK_NAME""))
Account account;
"
24319,Find most recent distinct records and sort by created_at in Postgresql,"select *
from (
    select distinct on (conversation_id) *
    from messages
    order by conversation_id, id desc
) t
order by id desc
"
36453,Oracle SQL get list of unique dates,"SELECT trunc(SALE_DATE) as sale_date
FROM sales
GROUP BY trunc(SALE_DATE)
ORDER BY trunc(SALE_DATE);
"
1607,Search with result priority based on different condtions,"select Id, Name
from
    (
         Select Id, Name, 1 as SearchRank from tables where (primary filter)
         union 
         Select Id, Name, 2 as SearchRank from tables where (secondary filter)
         union 
         Select Id, Name, 3 as SearchRank from tables where (tertiary filter)
    ) results
group by Id, Name
order by Min(SearchRank)
"
29111,SQL select query for ranking,"SELECT L.iUsername, 
((SELECT COUNT(1) FROM logs WHERE iUsername=L.iUsername) - 
(SELECT COUNT(1) FROM logs WHERE oUsername=L.iUsername)) as rank  
FROM logs L 
GROUP BY L.iUsername 
ORDER BY rank ASC
"
29546,manager names needed from ids,"select d.manager_id, e1.first_name, e1.last_name, count(e.employee_id)
from hr.departments d 
inner join hr.employees e on d.department_id = e.department_id  
inner join hr.employees e1 on d.manager_id = e1.employee_id
group by d.manager_id, e.first_name, e.last_name
having count(e.employee_id) > 5
"
10784,Table Conversion- Oracle,"  SELECT t.date,
         MAX(CASE WHEN t.colname = 'col1name' THEN t.value END) AS col1name,
         MAX(CASE WHEN t.colname = 'col2name' THEN t.value END) AS col2name,
         MAX(CASE WHEN t.colname = 'col3name' THEN t.value END) AS col3name
    FROM TABLE t
GROUP BY t.date
"
4084,Issue with FOR loop applied with SUBSTR & INSTR operations,"declare
  l_position pls_integer;
  l_string varchar2(100) := 'Thisissomestringwith spaces';
begin
  l_position := least(instr(l_string,' ')-1,20);
  dbms_output.put_line(substr(l_string,1,l_position));
end;
"
22851,MySQL SELECT statement to retrieve field value that is unique,"SELECT 
  MAX(id) as id,
  MAX(staff_id) as staff_id, 
  skill_id, 
  MAX(mainskill) as mainskill
FROM MyTable
GROUP BY skill_id
HAVING COUNT(1)=1
"
39331,Convert multiple sub-queries to on join,"SELECT MYTABLE1.*, MYTABLE2.*
  FROM MYTABLE1 
  LEFT OUTER JOIN MYTABLE2  
    ON same 
 WHERE XXX 
"
21992,Column comparison SQL issue in MS Access,"create table t3 as 
  select * from 
    (select * from t1 where not exists (select 1 from T2 where T1col1=t2col1 and t1col2=t2col2)) M1,
    (select * from t2 where not exists (select 1 from T1 where T1col1=t2col1 and t1col2=t2col2)) M2
    where M1.t1col1=M2.t2col1;
"
35028,How do I select columns which has a dot in their column names,"SELECT   * 
FROM     Users 
WHERE    `local.email` = 'burgundy@email.com' 
LIMIT    1
"
31640,looking up a file and getting the file path in vba,"Sub sheet_dialogue_box()

Dim intChoice As Integer
Dim strPath As String


Application.FileDialog(msoFileDialogOpen).AllowMultiSelect = False

intChoice = Application.FileDialog(msoFileDialogOpen).Show

If intChoice <> 0 Then
    strPath = Application.FileDialog(msoFileDialogOpen).SelectedItems(1)
    Application.Workbooks.Open (strPath)
End If

End Sub
"
1194,Are the IN statements in this query redundant?,"SELECT * 
FROM dayTable
LEFT JOIN ProcessTable firstprocess
  ON dayTable.id = firstprocess.daytablefkid 
    AND firstprocess.processid = 1234
LEFT JOIN ProcessTable secondprocess
  ON daytable.id = secondprocess.daytablefkid
    AND secondprocess.processid = 4567
WHERE 
  dayTable.DateFrom > @dateFrom 
  AND dayTable.DateTo < @dateTo
"
9266,SQL iterate for each group,"SELECT t1.ID, t1.GroupID, t1.Status, t1.Date
FROM MyTable t1
WHERE t1.Date IN (
    SELECT MAX(t2.Date)
    FROM MyTable t2
    WHERE t2.GroupID = t1.GroupID
    AND t2.Date <= '7/31/2011'
    UNION
    SELECT MIN(t3.Date)
    FROM MyTable t3
    WHERE t3.GroupID = t1.GroupID
    AND t3.Date >= '7/31/2011'
)
"
13369,SQL query not returning unique results. Which type of join do I need to use?,"SELECT * 
FROM user u 
WHERE EXISTS(SELECT * 
       FROM user_categories uc 
       WHERE u.user_id = uc.user_id AND  
       uc.category_id IN(1,3))
"
2933,SQLQuery - Counting Values For A Range Across 2 Values Grouped-By 3rd Value in A Single Table,"SELECT start_dsgn, COUNT(CASE WHEN min_cost_1 <= @cost_1 OR min_cost_2 <= @cost_2 THEN end_dsng END) as Cnt
FROM table
GROUP BY start_dsgn
"
5443,SQL Server : how to make multiple references to the same table substituting values,"SELECT R1.SomeColumn, R2.SomeColumn
FROM Master_table M 
         INNER JOIN Refrenced_Table R1  --<-- Alias R1
ON M.Column1 = R1.Pk                   -- JOIN Condition with Alias R1
       INNER JOIN Refrenced_Table R2      --<-- Alias R2
ON M.Column2 = R2.Pk                  -- JOin condition with Alias R2
"
11307,SQL to LINQ conversion for asp.net IQueryable,"var strings = _dataContext.Context.Detail.AsQueryable()
    .Where(n => n.DetailNr == 6)
    .Select(n => new [] {n.Str1, n.Str2, n.Str3, n.Str4});
    .SelectMany(s => s);

var result= _dataContext.Context.String.AsQueryable()
    .Where(s => strings.Contains(s)).ToList();
"
35827,How to convert date in .csv file into SQL format before mass insertion,"LOAD DATA LOCAL INFILE 'c:/scheduletest.csv' INTO TABLE game
FIELDS TERMINATED BY ','
ENCLOSED BY '""'
LINES TERMINATED BY '\n'
(@DATE_STR, `time`, `awayteam_id`, `hometeam_id`)
SET `date` = STR_TO_DATE(@DATE_STR, '%c/%e/%Y');
"
7697,How to approach the following query in oracle,"select last_trans_date,
       CASE
         WHEN last_trans_date < sysdate-180 THEN 'YES'
         ELSE 'NO'
       END as ""a"",
       CASE
         WHEN last_trans_date < sysdate-360 THEN 'YES'
         ELSE 'NO'
       END as ""b""
  from x;
"
6678,String Multiline - Android,"text.replaceAll(""\\r\\n|\\r|\\n"", """"); // the method removes all newline characters
"
24219,Iterate through row to compare with ascii value in sql?,"SELECT CHARINDEX((CHAR(97), fruit)
FROM MyTable
"
15774,SQL Server compare data,"select column1, column2,
       (case when column2 = replace(column1, '-', '') then 'same'
             else 'diff'
        end)
from table1;
"
8926,How to query SQL rows HAVING NOT (array values) in a field with comma separated values?,"SELECT DISTINCT id 
FROM YourTable
WHERE tag NOT IN (1, 3)
"
11175,"How can I join data like this in SQL Server, then display in my app?","Using dc As New DataClasses1
    Dim res = From pt In dc.project_table
              Join pc In dc.Project_codes On pc.ID Equals pt.Project_Code_ID
              Select New With {
                  .ProjectID = pc.ID,
                  .ProjectCode1 = pc.ProjCode1
                  } ' etc.
    DataGridView1.DataSource = res
End Using
"
39701,Eliminating duplicates.. and more fun,"SELECT DISTINCT [Loan Identifier], [ORIGINAL UNPAID PRINCIPAL BALANCE (UPB)] FROM TotalAcquisition
"
26080,where clause with Is null and not in,"WHERE  (   t1.column1 != 'test'
       AND (t2.column1 IS NULL OR t2.column2 IS NULL)
       )
    OR t1.column1 IS NULL
"
16096,How to order by other table?,"SELECT c.*,v.upvotes
FROM comments c
LEFT JOIN (SELECT postid,SUM(upvote) as upvotes
           FROM votes
           GROUP BY postid
           ) v
  ON c.id = v.postid
ORDER BY c.bestanswer DESC, upvotes DESC
"
34962,SQL Server replace all values before a colon and after a semi-colon,"declare @T table
(
  Col varchar(20)
)

insert into @T values
('asp:test;abca'), 
('asps:tesst;abcsa'), 
('asssp:tsest;assbca'),
('asssp:tsestassbca'),
('asssptsest;assbca'),
('asssptsestassbca'),
(':;')

select  left(T2.Col, charindex(';', T2.Col+';')-1) 
from @T as T1
  cross apply (select stuff(T1.Col, 1, charindex(':', T1.Col), '')) as T2(Col)
"
6394,Total a Value and Return Value in Same Column,"select
   SUM(ISNULL(CAST(A.ODENEN_ANAPARA AS FLOAT),0)+ISNULL(CAST(A.FAIZ AS FLOAT),0)+
      ISNULL(CAST(A.BSMV AS FLOAT),0)+ISNULL(CAST(A.GECIKME_FAIZ AS FLOAT),0)+
      ISNULL(CAST(A.GECIKME_BSMV AS FLOAT),0)) 
   + dbo.fngcodeme(@HESAP,@BAS,@BIT,@DOV)
from ...
"
7405,Grouping and counting issue,"select Id
from tbl
group by Id
having max(case when Code='a' then 0 else 1 end) = 0
"
30194,Oracle PL/SQL Tokenize String with empty position,"SELECT    trim(regexp_substr (replace('AAA,BBB,,DDD',',',', '), '[^,]+', 1, level)), level
FROM    dual
CONNECT BY LEVEL <= REGEXP_COUNT (replace('AAA,BBB,,DDD',',',', '), '[^,]+');
"
35908,SQL query to find Primary Key of a table?,"SELECT a.COLUMN_NAME
FROM all_cons_columns a INNER JOIN all_constraints c 
     ON a.constraint_name = c.constraint_name 
WHERE c.table_name = 'TBL'
  AND c.constraint_type = 'P';
"
239,MySQL SELECT value before MAX,"select max_name.name,before_max.count
from 
(SELECT type,max(count) as max
FROM `test` 
group by type) as type_max
join
(select type,name,count
from test 
) as max_name on (type_max.type = max_name.type and count = type_max.max )

left join
(select type,count
from test as t1
where count != (select max(count) from test as t2 where t1.type = t2.type)
group by type
order by count desc) as before_max on(type_max.type = before_max .type)
"
9218,SQl - select columns and group them,"select 
  title, 
  count(DISTINCT customerid) as `count`
from 
  yourTable
group by 
  title
order by 
  `count` desc
"
33903,Update multiple rows with max date for each foreign key,"SELECT t1.* FROM Table t1
INNER JOIN 
    (SELECT F_ID, max(date) maxDate 
     FROM Table 
     GROUP BY F_ID) t2 
ON t1.F_ID=t2.F_ID AND t1.date=t2.maxDate
"
34001,"Correct rows retrieved with group query, but need more columns with unique data","SELECT ip.* FROM
items_pricing ip
INNER JOIN (
    SELECT id_prod, item_type, id_item, max(date_time) maxdate 
    FROM items_pricing 
    WHERE id_prod IN (5,6) AND item_type IN (2,3) 
    GROUP BY id_prod, item_type, id_item 
    ORDER BY NULL
) sq ON sq.maxdate = ip.date_time;
"
24911,SQL subqueries calculations,"SELECT t.group,NVL(avg(s.value),0),(MAX(t.value)*100/NVL(avg(s.value),1)) as Perc
FROM(
    SELECT group,max(value) as value FROM MyTable WHERE ID = 'ID1' group by group) t
LEFT OUTER JOIN Mytable s
 ON(t.group = s.group and s.ID = 'ID2')
GROUP BY t.group
"
21168,SQL outer join in combination with MAX function in right table,"SELECT
    devname, 
    (SELECT TOP 1 dswsw_version FROM device_sw_history WHERE dswdevid = devid
     ORDER BY dswtimestamp DESC)
FROM device
"
30053,For each loop SQL,"INSERT INTO TABLE3 (TABLE1_ID,TABLE2_ID)
SELECT  T1.ID
        ,T2.ID
FROM    TABLE1 T1
CROSS JOIN
        TABLE2 T2
"
2090,PL/SQL: re-write SELECT statement using IN parameter in stored procedure,"PROCEDURE get_stat (gender IN VARCHAR2) 
AS
    v_sql   varchar2(1000);
    v_param varchar2(100) := 'AVG_WEIGHT';
    v_stat  number;
BEGIN
    v_sql := 'SELECT ' || gender || ' FROM survey WHERE parameter = :1';
    EXECUTE IMMEDIATE v_sql
                 INTO v_stat
                USING v_param;
END get_stat;
"
15757,PostgreSQL - Help Required in Creating View,"CREATE OR REPLACE VIEW queue_interval_wise AS 
SELECT DISTINCT 
    t1.Time,
    t1.Date,
    t1.Label,
    IFNULL(t2.Category, ''),
    t1.Count
FROM Table1 t1
LEFT JOIN Table2 t2 ON t1.Label = t2.Label
"
20980,Select from several partitions at once,"SELECT t.column1, t.column2
  FROM first_table t
 WHERE t.partitioned_date_column >= <<date that delimits fast partitions>>
   AND t.column3 = 'someVal'
"
7529,Grouping by dates with an error threshold,"with groups as (
  select
    auto_increment,
    last_modified_date,
    case when last_modified_date -
      lag(last_modified_date, 1, date '1900-01-01')
        over (order by last_modified_date) < (1 / 24 / 60 * 5) then 1 else 0
    end as starts_new_group
  from your_table
)
select
  auto_increment,
  last_modified_date
where
  starts_new_group = 1;
"
9202,Making MySQL IN Clause Case Sensitive,"SELECT *
FROM pages_table
WHERE CAST(topic AS CHAR CHARACTER SET latin1)
        COLLATE latin1_general_cs IN ('Food','NightLife','Drinks')
"
10680,How to group by week of the year dates or day dates that start on Sundays in oracle 10?,"select TRUNC(day_date)-TO_NUMBER(TO_CHAR(day_date,'D'))+1 week_start_date,
       MAX(column2), MAX(column3)
from yourtable
group by TRUNC(day_date)-TO_NUMBER(TO_CHAR(day_date,'D'))+1;
"
32872,Excluding a Null value returns 0 rows in a sub query,"select * 
from tbl_A A
where not exists (select distinct ID 
                  from tbl_B b
                  where a.id = b.id)
"
18264,select columns from different tables with different data type columns,"select Distinct a.Sequence, b.RELEASED_TITLE
from IncludedIn a inner join FinishedTrack b
 on a.OriginatesFrom = b.IIOriginatesFrom 
 Inner join CdInfo c on a.IIALBUM_ID = c.ALBUM_ID
Order By a.Sequence
"
20211,SQL Unique Identifiers in Where statement with nested clauses,"where (ID1 is not null or ID1 <> '-1' ) or (ID2 is not null or ID2 <> '-1' )
or  (ID3 is not null or ID3 <> '-1' )
"
8631,Update a column based on the primary id in this order,"update student2
set city_id =
    (select min(id) from student2 s where s.city_name = student2.city_name)
"
27499,How to count total id that answering a quiz in sql,"select
q.quizNum,
q.quizName,
count(sa.stuNum) as attempedstudent
from Quiz q
left join studentassessment sa on sa.quizNum = q.quizNum
group by q.quizNum;
"
14598,Join with 3 tables linked as parent child,"SELECT * 
FROM M_TRD trd
LEFT OUTER JOIN C_sub    sub ON trd.sk_trd = sub.sk_trd 
LEFT OUTER JOIN C_subdet det ON sub.subid  = det.subid
"
22693,differences between Use and DB.sp_execute,"select * from MyDatabase.dbo.MyTable
"
39311,oracle date issue,"    ...
    where
      nvl (cancel_date_time, date_value_for_empty_cancel_date) 
      not between ('20120214 10:00:00') and ('20120215 10:00:00')
"
2260,MySQl - Find Duplicates Cross Relational Table,"SELECT 
    b.`website_id`, a.sku, 
    group_concat(DISTINCT a.`product_id`) as sku_products 
FROM `products` AS a 
     LEFT JOIN `website_products` AS b 
         ON ( a.`product_id` = b.`product_id` ) 
GROUP BY b.`website_id`, a.`sku` 
HAVING count(distinct a.`product_id` ) > 1
ORDER BY b.`website_id`
"
16201,How to delay loading a property with linq to sql external mapping?,"    private System.Data.Linq.Link<String> _content;
    [Column(Name = ""content"", DbType = ""NVarChar(MAX) NOT NULL"", Storage = ""_content"")]
    public String Content
    {
        get { return this._content.Value; }
        set { this._content.Value = value; }
    }
"
12581,CoreData and NSPredicate,"[fetchRequest setPredicate:[NSPredicate predicateWithFormat:@""gameType == %i"", 0]];
"
13980,select name from customers as @myvariable // dynamic AS in sql,"DECLARE @myvariable VARCHAR(100)
SET @myvariable = 'mytext'

DECLARE @sql NVARCHAR(200)

SET @sql = 'SELECT Name AS ' + QUOTENAME(@MyVariable)  + ' FROM Customers'

EXEC sp_executesql @sql
"
1114,SQL ORACLE Sub query. need to fix my outcomes,"SELECT Initcap(Fname || ' ' || Lname) AS Name,
   Initcap(JobTitle) AS JobTitle, Salary
FROM Person11 p
WHERE Upper(Cat) = 'N' 
AND Salary >= 1.30 * ( 
  SELECT Avg(salary)
  FROM Person11
  WHERE Upper(Cat) = 'N' AND JobTitle = p.JobTitle)
ORDER BY Upper(Lname), Upper(Fname);
"
14041,Changing column from nvarchar to int and converting data,"update a set gender = case b.Gender
                                when 'Male' then 0
                                when 'Female' then 1
                          end
from users a inner join
    tempTable b on b.Username = a.Username
"
22074,Get list of table names in different schema of an Oracle database,"SELECT TABLE_NAME 
FROM ALL_TABLES 
WHERE OWNER='OTHER-SCHEMA'
"
26518,Difficult oracle query,"SELECT studentid, teacherid from students, teachers

EXCEPT

select studentid, teacherid from stu_cou natural join tea_cou;
"
611,How can I get data from from two different tables in a single MySQL query?,"SELECT t2.quote, t2.author, t1.profession
FROM table2 t2
  LEFT JOIN table1 t1 ON t2.author = t1.author
"
25371,MySQL complex SQL query showing empty values where a table-column doesn't match,"SELECT EN.page_title ENP, MW.page_title MWP
FROM 
    en_page AS EN
    LEFT OUTER JOIN mwpage AS MW ON EN.page_title = MW.page_title
WHERE EN.page_title =  'Main_Page'
LIMIT 0 , 30
"
8911,How to select titles and price where price is more then price of 'Movie3',"SELECT title,price FROM movies WHERE price >= (SELECT price FROM test WHERE title='Movie3')
"
26632,Can the performance of this SQL query be improved?,"SELECT 
  DISTINCT(friend_id)
FROM 
  user_friends
  JOIN users on users.id = friend_id
WHERE 
  users.id != #{self.id}
AND 
  relationship_status = 'Single'
AND 
  current_location_id IS NOT NULL
AND (
  signed_up IS NOT NULL 
  OR 
  user_id IN (
    SELECT 
      friend_id 
    FROM 
      user_friends 
    WHERE 
      user_id = #{self.id}
  )
) 
;
"
39125,Should I use indexes for a many-to-many database table?,"CREATE TABLE user_movies (
  user_id INT NOT NULL,
  movie_id INT NOT NULL,
  PRIMARY KEY (user_id, movie_id),
  FOREIGN KEY (user_id) REFERENCES users(user_id),
  FOREIGN KEY (movie_id) REFERENCES movies(movie_id)
) ENGINE=InnoDb;
"
35936,Mysql like search in reverse,"SELECT *
FROM   tableName
WHERE  'the animal is a fox' LIKE CONCAT('%', animal ,'%')
"
35889,Update Datime null value to not null,"declare @SomeDate datetime = GETDATE()

update Testingset 
set SomeDate = @SomeDate  
where  SomeDate  is null
or SomeDate  <> @SomeDate 
"
3305,Oracle 12c column_name inconsistency,"order by column_id;
"
1574,Oracle: Creating user which has all permissions on his/her own schema,"GRANT CREATE SESSION TO &2 
/
GRANT ALTER SESSION TO &2 
/
GRANT CREATE SEQUENCE TO &2 
/ 
GRANT CREATE SYNONYM TO &2
/
GRANT CREATE VIEW TO &2
/ 
GRANT CREATE TABLE TO &2 
/ 
GRANT GATHER_SYSTEM_STATISTICS TO &2 
/
GRANT CREATE PROCEDURE TO &2 
/ 
GRANT CREATE TRIGGER TO &2 
/
GRANT CREATE DATABASE LINK TO &2
/
GRANT CREATE TYPE TO &2
/
"
12998,Passing a list to SQL each row call Groovy,"sql.eachRow( someQuery, someParams ){ row ->
  render row as JSON
}
"
8652,Single SQL query required,"SELECT t2.state, t1.name,t2.powerconsumption
FROM table1 t1
INNER JOIN table2 t2 ON t1.companyId = t2.companyId
WHERE t2.month = 'jan'
ORDER BY t2.state ASC, t2.powerconsumption DESC;
"
11138,is this a setting failure? sql datatable changed but gridview not,"<asp:SqlDataSource ID=""SqlDataSource1"" runat=""server"" ConnectionString=""<%$ ConnectionStrings:database1ConnectionString %>""
SelectCommand=""SELECT column1 from yourtable""></asp:SqlDataSource>
"
30618,Fetch the records from current month,"SELECT TOTAL_PRICE
FROM CUST_CART_TABLE
WHERE USER_ID      = '""+userId+""'
AND (TRUNC(PURCHASED_DATE) BETWEEN TRUNC(SYSDATE, 'MM') AND TRUNC(LAST_DAY(SYSDATE)));
"
33354,"In Sql, how can one change a value using a case statement?","SELECT 
users.UserName,
users.phone,
users.email,
users.status,
CASE WHEN users.group_id=3 THEN 5 ELSE users.group_id END AS RoleId
...
"
34860,"Sorting deals by their revenue, which is sum of orders table rows in MySQL","SELECT  deals.ID, SUM(orders.amount) AS revenue 
FROM    deals
        INNER JOIN orders 
            ON orders.deal_id = deals.id
GROUP BY deals.ID
ORDER BY revenue DESC
"
33179,Can I replace values of bit field to text in creating Table,"CREATE TABLE Table1
(
  ID int 
  , name varchar(50)
  , YesNo bit
  , TrueFalse AS 
    (
      CASE WHEN YesNo = 1 Then 'True'
      ELSE 'False'
      END
    )      
);
"
22045,Joining records from same table,"select id1,id2,id3, date1, 
isnull(lead(date1) over(partition by id1,id2,id3 order by date1)-1, '99991231') as date2
from test
"
8566,sql grouping... thing,"SELECT MIN(ID),
    Country,
    City,
    SUM(Qty) AS Qty,
    MIN(SomeDate) AS SomeDate,
    MIN(SomeDate1) AS SomeDate1,
    MIN(SomeDate2) AS SomeDate2
FROM sourceTable
GROUP BY Country, City;
"
2151,How to select a column using SQL and then only use portion of the column to join with another table?,"SELECT 1
FROM
   TableA a
   INNER JOIN TableB b ON a.Ext = RIGHT(b.Phone, 7)
"
24796,"How to find classmates of student C who are taking any of the classes that C is taking, in SQL?","SELECT DISTINCT s2.ssn, s2.name
    FROM students s1
        INNER JOIN courses c1  /* Find all courses taken by student 'c' */
            ON s1.ssn = c1.ssn
        INNER JOIN courses c2  /* Find all students in all of c's courses */
            ON c1.course = c2.course
        INNER JOIN students s2 /* Get the details for each of those students */
            ON c2.ssn = s2.ssn
    WHERE s1.name = 'c'
"
7454,how to select max value and return many entries,"SELECT theme, module, MAX(changed)
FROM table_name
GROUP BY theme, module
"
39715,Eliminate all rows until certain value,"declare @marker datetime

SELECT TOP 1 @marker = Time 
FROM TableName 
WHERE Quantity > 1000 ORDER BY Row DESC

SELECT * 
FROM TableName 
WHERE Time > @marker
"
31149,Creating Tables,"create table person_organization
( ssn number(9)
, org_code varchar2(60)
, constraint person_organization_pk primary key (ssn, org_code)
, constraint person_organization_ssn_fk foreign key ( ssn )
    references person ( ssn )
, constraint person_organization_oc_fk foreign key ( org_code )
    references organization ( org_code )
 );
"
26871,Coldfusion Calculate Sum Total (Loop? ),"<cfset grandTotal = 0 />

<cfloop query=""getPrice"">
    #quantity# | #price# | #totalPrice#<br />
    <cfset grandTotal = grandTotal + ( price * quantity ) />
</cfloop>

<br /><br />

<cfoutput>#grandTotal#</cfoutput>
"
1775,Need help please with a mysql query,"Select asgn.user_id, asgn.ticket_id, answ.answer
from
Assigned asgn
inner join
Answers answ
on asgn.user_id = answ.id_per
and asgn.ticket_id = answ.id_ticket
and upper(answer) like '%YES%'
"
31061,Unable to add DOUBLE and VARCHAR columns with CAST(),"SELECT CONCAT_WS("""", ""$"", FORMAT(COALESCE(db.billing.cost_per_month, 0.00), 2)) AS ""Monthly Cost"",
  CONCAT_WS("""", ""$"", FORMAT(COALESCE(db.billing.additional_cost, 0.00),  2)) AS ""Additional Cost"",
  CONCAT_WS("""", ""$"", FORMAT(COALESCE(db.billing.cost_per_month, 0.00) AS DECIMAL(60, 2)) + COALESCE(db.billing.additional_cost, 0.00), 2)) AS ""Total Cost""
  FROM db.billing;
"
38500,SQL Selecting Distinct Count of items where 2 conditions are met,"SELECT  product_brandNAME
        , product_classNAME
        , COUNT(*)
FROM    products
        JOIN product_brand ON products.product_brandID = product_brand.product_brandID
        JOIN product_class ON products.product_classID = product_class.product_classID              
GROUP BY 
        product_brandNAME
        , product_classNAME
"
4901,pull mysql data for the last 60 minutes,"SELECT *
FROM Tablename
WHERE FirstAdded > CURRENT_TIMESTAMP - INTERVAL 1 HOUR
"
22057,Refactoring SQL to avoid using TABLOCKX,"alter table Table2 add TempID int

go

declare @SomeTempTable table(ID int identity, WhateverStuff int, WhateverElse int)

insert into @SomeTempTable values(1, 1)
insert into @SomeTempTable values(2, 2)

insert into Table2(SomeStuff, SomeOtherStuff, TempID)
select WhateverStuff, WhateverElse, ID
from @SomeTempTable

insert into Table1(Table2Id)
select Table2ID
from @SomeTempTable as S
  inner join Table2 as T2
    on S.ID = T2.TempID

go

alter table Table2 drop column TempID    
"
39831,applying a query as a filter on another query's result MySQL,"SELECT  A.meta_value, A.meta_id 
FROM `wp_postmeta` A
INNER JOIN wp_posts  B
ON meta_id = id
WHERE A.`meta_key`= 'destination'
AND B.post_status = 'publish' 
GROUP BY   A.meta_value
"
30924,Import an excel spreadsheet to oracle using Toad,"CREATE OR REPLACE TRIGGER trg_table_name_set_id
  BEFORE INSERT 
  ON table_name
  FOR EACH ROW
BEGIN

  SELECT table_seq.nextval INTO :new.id FROM DUAL; --id would be the id column in your table

--or, if you are on 11g, simply
--:new.id := table_seq.nextval;

END trg_table_name_set_id;
"
28561,Modify Date without DateAdd or DateDiff,"SET @ReturnDate = @ReturnDate + (@ModifyDay - DATEPART(day, @ReturnDate))
"
21503,Query using a SQL reference table,"SELECT dt.ID,dt.Title,dt.description,
       L1.Description as LocationDescription,
       L2.Description as CategoryDescription  ...

FROM data dt
JOIN Reference L1 on dt.location=L1.Reference and L1.ID=='LO'
JOIN Reference L2 on dt.category=L2.Reference and L2.ID=='CA'
"
23619,hibernate - HQL joins on many clauses,"SELECT m, c 
FROM Message m LEFT JOIN m.commands c WITH (lower(c.status) = 'failed')
WHERE m.sequenceReceived < 10
"
2334,How can I apply the loop statement into the temp table in sql?,"WITH testOne(dDate, Leave)
AS
( 
   SELECT CONVERT(DATE, '2013-05-06'), 1
   UNION ALL
   SELECT DATEADD(dd,1,ad.dDate), 1
   FROM testOne ad
   WHERE ad.dDate < CONVERT(DATE, '2013-05-08') 
)
INSERT INTO #testTwo ( dDate, Leave )
SELECT dDate, Leave
FROM testOne
"
39833,Proble with joining two tables on subquery condition,"SELECT
    pics.c_name,
    pics.e_post,
vac.e_dateTo
FROM et_pics pics
INNER JOIN et_division div on pics.e_division = div.ob_no
INNER JOIN(select e_pic, max(e_dateTo) from  et_vacations group by e_pic )vac on vac.e_pic = pics.ob_no
WHERE
    (pics.e_fireDate IS NULL OR pics.e_fireDate > getDate()) 
       ORDER BY pics.c_name;
"
31210,Determine installed sql server instances?,"Select @@version
"
39522,MySQL COUNT for days,"SELECT CAST(DATE(FROM_UNIXTIME(`Time`)) AS CHAR) as dateoftime, COUNT(Ip) as cnt
FROM tablename
WHERE DATE(FROM_UNIXTIME(`Time`)) > DATE_SUB(current_timestamp, INTERVAL 10 DAY)
GROUP BY CAST(DATE(FROM_UNIXTIME(`Time`)) AS CHAR)
"
20056,Mysql query on a single table,"SELECT   DATE(datetime),
         COUNT(*), 
         COUNT(CASE WHEN measure > 20 THEN 1 ELSE NULL END)
FROM     mytable
WHERE    type = 12 
GROUP BY date(datetime)
"
12342,Representing Id's based on a prefix Microsoft SQL Server 2008,"SELECT 
  Id,
  CoId,
  PartnerCoId,
  mc.Prefix as coPrefix,
  pc.Prifix as partnerPrefix
FROM Table t
JOIN PrefixTable mc
  ON t.CoId = mc.CoId
JOIN PrefixTable pc
  ON t.PartnerCoId = pc.CoId
"
5997,Conditional MySQL Column,"select i.item_code, i.item_name, 
    case when q.selltype_name = 'unit' then i.item_price else 0 end as unit,
    case when q.selltype_name = 'box' then i.item_price else 0 end as box,
    case when q.selltype_name = 'pound' then i.item_price else 0 end as pound,
    case when q.selltype_name = 'gallon' then i.item_price else 0 end as gallon
from qa_items i
inner join qa_selltypes q on i.selltype_code = q.selltype_code
"
37570,Strange behavior when checking for Null values in Access SQL,"WHERE WRT_Phone IS null;
"
18824,SQL insert data into a brand new column fails,"ALTER TABLE TableA ADD NewColumnA VARBINARY(300)
GO
--rest of the query
UPDATE TableA
SET 
    NewColumnA=b.OldColumnB,
FROM 
    TableA a, TableB b
WHERE a.myID=b.myID
"
10090,Filtering SQL Server sys.objects by database,"select from {dbname}.sys.objects
"
8707,select one row on condtion,"CREATE VIEW rklib.clspaytp AS 
    Select *
    from rklib.clspaytpp
    where ottrnc='001'
    union

    select *
    from 
    (
    select *
    from rklib.clspaytpp
    where ottrnc != '001'
    limit 1
    ) x
"
15819,MySQL - nested select statement for JOIN?,"SELECT *
FROM
(
    SELECT meter_id, supplier, MAX(end_date) end_date
    FROM contract 
    GROUP BY meter_id, supplier
) a
JOIN contract c ON c.meter_id = a.meter_id AND a.end_date = c.end_date
JOIN meter m ON m.meter-id = c.meter_id
JOIN invoice i ON i.contract_id = c.id
"
17090,Calculate proper total in query?,"SELECT SUM(price * amount) AS total
FROM table
GROUP BY customer_id;
"
16592,Can an SQL if else clause have a select inside?,"Select 
    CASE
        WHEN A.valueFromTable -B.ValueFromTable < 0 THEN A.valueFromTable 
    ELSE A.valueFromTable -B.ValueFromTable END As result
From table as A inner join table as B
on A.ValueID = B.ValueID
Where ValueID =5
"
21787,Updating multiple rows which are in conflict with unique index,"Move 2 to 99
Move 3 to 2
Move 99 to 3
"
19803,MySQL: Which indexes to use for a simple range select?,"CREATE TABLE IF NOT EXISTS `log` (
  ...
  KEY `user_timeLogged` (user, timeLogged),
  ...
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
"
11819,SQL Table Design Style:,"Animals (animalID, animalName)
Flags (flagID, flagName)
AnimalFlags (animalID, flagID)
"
29163,SQL Report - Group by Query for getting data from 12 months ago (this month included),"Select    count(*) 
FROM      Table_X 
WHERE     DATE > = DATEADD(YEAR,-1,GETDATE())
GROUP BY  month(DATE)
"
14693,"Selecting two referencing column and show them in one column, while adding string to it","SELECT mu.Name + ' kills ' + mu2.Name
FROM msUser mu
INNER JOIN difficultTable dt ON dt.UserIDA = mu.UserID
INNER JOIN msUser mu2 ON mu2.UserID = dt.UserIDB
"
11470,Retrieve rows which satisfy at least four of given seven conditions,"SELECT * FROM Alphabets where
CASE WHEN A=1 THEN 1 ELSE 0 END +
CASE WHEN B=2 THEN 1 ELSE 0 END +
CASE WHEN C=3 THEN 1 ELSE 0 END +
CASE WHEN D=4 THEN 1 ELSE 0 END +
CASE WHEN E=5 THEN 1 ELSE 0 END +
CASE WHEN F=6 THEN 1 ELSE 0 END +
CASE WHEN G=7 THEN 1 ELSE 0 END >= 4
"
36495,Find the time difference between two consecutive rows in the same table in sql,"select t1.EmpID, t1.TimeIn, t1.TimeOut, 
       datediff(minute, max(t2.TimeOut), t1.TimeIn) as minutes
from timesheet t1 left join timesheet t2 on t1.EmpID = t2.EmpID 
       and t2.TimeOut < t1.TimeIn
group by t1.EmpID, t1.TimeIn, t1.TimeOut
"
39206,Adding Columns (SQL Queries) to a CSV File in Ruby,"csv << [ 'Month', 'Day', 'Year' ]
csv << month.zip( day, year )
"
7758,SQL query to get average per group in two tables,"SELECT grade, 
       Avg(score) 
FROM   students 
       JOIN results using (student_id) 
GROUP  BY grade 
"
21832,Oracle Pattern matching,"select * 
  from someTable
 where regexp_like( someField, '=$' );
"
12791,Having trouble setting a computed column as not Null,"ALTER TABLE CreditCard ADD accountNo AS ISNULL('C'+right('000'+CONVERT([varchar](3),[idCreditCard],(0)),(3)),0)
"
9594,Mysql - Summing counts of multiple joined tables,"SELECT 
(select COUNT(*) from table_1 = where member_id = m.member_id) 
+ 
(select COUNT(*) from table_2 = where member_id = m.member_id)
as total

FROM members m
WHERE m.member_id = 27
"
39237,MySql command for selecting entries in a field which has certain sub strings at specific locations?,"select id from table
where id like ""FM____FEB%""
"
24810,MySQL index is not used when using SELECT ALL for binary lower,"SELECT k.*
FROM (SELECT k.*
      FROM `keywords` k
      WHERE name = 'Apple' and country = 'US'
     ) k
WHERE (BINARY LOWER(`name`) = BINARY LOWER('Apple') AND `country` = 'US');
"
6333,Monthly Birthday SQL Query,"SELECT c.name
FROM cust c
WHERE (
    MONTH(c.birthdate) = MONTH(@suppliedDate)
    AND DAY(c.birthdate) = DAY(@suppliedDate)
) OR (
    MONTH(c.birthdate) = 2 AND DAY(c.birthdate) = 29
    AND MONTH(@suppliedDate) = 3 AND DAY(@suppliedDate) = 1
    AND (YEAR(@suppliedDate) % 4 = 0) AND ((YEAR(@suppliedDate) % 100 != 0) OR (YEAR(@suppliedDate) % 400 = 0))
)
"
20976,Update column1 with identical column2,"UPDATE t
SET ID = (SELECT MIN(ID) FROM t AS t2 WHERE t.Num = t2.Num)
"
27475,Select into without touching the autoincrement ID field,"INSERT INTO destination (label) SELECT label FROM source
"
32108,Inner Join for list of records NOT in a second table (NOT Inner Join),"select p.* 
from products p 
left join orders o on p.Product = o.Product 
where o.product is null
"
8991,order the nested group based on date in SQLite,"select t1.* from @t t1
join (select grandparent, max(date) as date from @t group by grandparent) t2 
   on t2.grandparent = t1.grandparent
join (select parent, max(date) as date from @t group by parent) t3 
   on t3.parent = t1.parent
order by t2.date desc, t3.date desc, t1.date desc
"
12543,Return column names where they meet a specific value in sql,"Thanks Strawberry... I've Used Concat_ws here...  

select userid, username,  
concat_ws(', ',  
IF(Access1 = 1 ,'Access1', NULL),  
IF(Access2 = 1 ,'Access2', NULL),  
IF(Access3 = 1 ,'Access3', NULL),  
IF(Access4 = 1 ,'Access4', NULL),  
.  
.  
IF( AccessN = 1 ,'AccessN',NULL) as Access_Allowed  
from UserTable

Thanks
"
1609,Sorting by weighted rating in SQL?,"select * from event where id in (
   select top 3 eventid
   from ratings
   group by eventid having count(*)>100 order by avg(rating) desc
)
"
31961,MS Access: Limit a table's cell's values to two values?,"=""X"" Or =""Y""
"
24941,How to define table constraint to check non empty datetime?,"CREATE TABLE [dbo].[MyTable](
[ID] [int] NOT NULL,
[MyField] [DATETIME] NOT NULL)
"
30564,Find min(sal) along with employee name SQL Oracle,"SELECT * FROM emp 
WHERE SAL = (select MIN(SAL) sal from emp WHERE JOB ='CLERK')
and JOB ='CLERK';
"
39735,Call procedure with multilple values in one Parameter,"CREATE PROCEDURE get_all_featured
@page int,
@tipoleilao varchar(255)
AS BEGIN
. . . 

SELECT . . .
WHERE ','+@tipoleilao+',' like '%,'+cast(tipo_leilao as varchar(255))+'%,' . . ..
"
18083,Spread a table in a date time interval,"WITH DateRange(dt) AS
(
SELECT CONVERT(datetime, '2012-01-01') dt
UNION ALL
SELECT DATEADD(dd,1,dt) dt FROM DateRange WHERE dt < CONVERT(datetime, '2012-01-31')
)

SELECT dates.dt AS DatePlaying, PlayerName 
FROM MyTable t
JOIN DateRange dates ON dt BETWEEN t.BeginDate AND t.DateEnd
ORDER BY PlayerName, DatePlaying 
"
4863,Actual/history table: select by version number,"select * from (
select row_number() over (partition by id order by version desc) rn, 
       name 
from 
(
  select h.actual_id as id, h.name, h.version from history h
  union all
  select * from actual 
) x
where version <= 2 )  y
where rn = 1
"
35351,MySQL joins of small tables with huge tables in complex query - how consuming they are?,"  FROM people p
  JOIN education e ON p.education_id = e.education_id
"
30065,SQL: Hierarchical structure with n level,"WITH cte AS (
   {Anchor_Query}
   UNION ALL
   {Recursive part joining to cte}
 )
 SELECT * FROM cte
"
27753,MySQL query to select from multiple table and insert in one,"insert into a(email)
    select email
    from ((select email from c) union
          (select email from d) union
          (select email from e)
         ) cde
    where not exists (select 1 from b where b.email = cde.email);
"
20061,How to force id to increase automatically,"CREATE TABLE mytable(
     id INTEGER PRIMARY KEY AUTOINCREMENT,
     name CHAR(30) NOT NULL,
);
"
35598,Is it possible to access child information from parent in Postgresql Inheritance?,"SELECT
  action_id, action_type, somefield
FROM ONLY likes
SELECT
  action_id, action_type, null
FROM ONLY actions
UNION ALL
"
9403,How to assign correlative numbers to rows only using SQL?,"ROW_NUMBER() OVER (PARTITION BY InvoiceDate ORDER BY InvoiceNumber)
"
37344,How to determine the auto-generated primary key used as a foreign key for another table,"WITH ins_main AS (
   INSERT INTO main(col1)
   VALUES ('some value 1')
   RETURNING main_id    
   )
, ins_submain AS (
   INSERT INTO submain (main_id, col2)
   SELECT main_id, 'some value 2'
   FROM   ins_main
   RETURNING submain_id
   )
INSERT INTO subsub (submain_id, col3)
SELECT submain_id, 'some value 3'
FROM   ins_submain;
"
24103,"How to perform ""Select Count"" with complicated ""Where"" statement to compute co-occurrences?","SELECT t2.tag, count (distinct (t1.Tag)) - 1 as Co_occurrences
FROM Tags t1 inner join 
    Tags t2 on t1.UserId = t2.UserId 
GROUP BY t2.tag    
ORDER BY count (distinct (t1.Tag)) desc      
"
15273,Add row to Eloquent Collection by default based on raw query,"$results = YourModelClass::select(""*"")
    ->addSelect(DB::raw(""IF(condition,1,0) AS editable""))
    ->get();
"
6924,"MySQL rank calculation is failing, variable always null","SELECT *
FROM `MyTable` T JOIN
     (SELECT `id`, @rownum:=@rownum+1 AS `rank_calculated`
      FROM `MyTable`, (SELECT @rownum:=0) AS `inline_trick`
      ORDER BY `rating`
    ) R
    ON R.`id` = T.`id`;
"
20160,Last Record Of Each Group Using Multiple Joins In Sql Server,"SELECT A.Name,
       Sum(C.MoneyIN) - Sum(C.MoneyOut) AS Balance
FROM   #Customer A
JOIN   #Bank B ON A.Id = B.id
JOIN   #BankTransaction C ON B.Id = C.BankID
GROUP  BY A.Name
"
11051,"Access, Lookup unused values across multiple fields","SELECT *
FROM [Devices]
where [Devices].[ID] NOT IN
(
SELECT Slot1 FROM PDUs WHERE Slot1 IS NOT NULL
UNION ALL
SELECT Slot2 FROM PDUs WHERE Slot2 IS NOT NULL
UNION ALL
SELECT Slot3 FROM PDUs WHERE Slot3 IS NOT NULL
UNION ALL
SELECT Slot4 FROM PDUs WHERE Slot4 IS NOT NULL
UNION ALL
SELECT Slot5 FROM PDUs WHERE Slot5 IS NOT NULL
UNION ALL
SELECT Slot6 FROM PDUs WHERE Slot6 IS NOT NULL
)
"
8499,Select top 1 for distinct value according to time,"SELECT tblMyFriends.FriendID,
       tblMyFriends.GroupID,
       tblMessages.MyMessage,
       MAX(tblMessages.MyTime)
FROM tblMyFriends
LEFT JOIN tblMessages
       ON COALESCE(tblMyFriends.FriendID, tblMyFriends.GroupID) =
          COALESCE(tblMessages.FriendID,  tblMessages.GroupID)
GROUP BY tblMyFriends.FriendID,
         tblMyFriends.GroupID
"
16961,SQL query distinct - group by,"SELECT ChainId,
       ComponentId,
       count(distinct TransmitEndpointId)
FROM chain
where TransmitEndpointId is not null
GROUP BY ChainId, ComponentId

select sum(endPointNr) from 
(
SELECT count(distinct TransmitEndpointId) as     endPointNr
FROM chain
where TransmitEndpointId is not null
GROUP BY ChainId, ComponentId
) X
"
5207,SSRS Report Builder: Creating text color expression based on textbox value?,"=IIF(Me.Value < 0,""Red"",""Green"")
"
6452,Many Replace after each other in SELECT statement,"replace(replace(replace(varchar2, 'x', '1'), 'y', '2'), 'z', '3')
"
28128,Without using xml layout how to set background for listview,"ListView listView = getListView();

//set background to color
listView.setBackgroundColor(#FF888888);

//set background to Drawable
listView.setBackgroundDrawable(myDrawable);

//set background to Resource
listView.setBackgroundResouce(R.id.my_res_id);
"
4795,How can I select the the second last and last row from the database?,"SELECT TOP 2 * FROM Names ORDER BY Name DESC
"
23239,How can I compare two tables if I have type mismatches in Access 2003?,"WHERE CAST(A.col1 AS VARCHAR(100)) <> CAST(b.col1 AS VARCHAR(100)) 
"
9162,Retrieve rows in which a coloumn doesn't contain a value,"SELECT * FROM tablename  
WHERE find_in_set(1, userIDs) = 0
"
8174,Re Increment the Primary Column after deletion of the record in table in Sql?,"UPDATE dbo.table 
    SET splr_Slno=splr_Slno-1 
WHERE 
splr_Slno> @splr_Slno AND splr_Id= @Splr_Id
"
8954,MVC model and SQL table name are the same,"class Application_Model_DbTable_Poll extends Zend_Db_Table_Abstract
{
    protected $_name = 'Poll';
}
"
8028,Select only one record for each match,"SELECT MIN(Date) AS Date, ResID, Med, time, emar
from YourTable
WHERE Date > date_min and Date < date_max /*Might need >= and <= if inclusive*/
GROUP BY  ResID, Med, time, emar
"
37210,How to use T-SQL MERGE in this case?,"MERGE dbo.commissions_history AS target
USING (SELECT @amount, @requestID) AS source (amount, request)
ON (target.request = source.request)
WHEN MATCHED THEN
    UPDATE SET amount = source.amount
WHEN NOT MATCHED THEN
    INSERT (request, amount)
    VALUES (source.request, source.amount);
"
16330,MySQL query not pulling up records for next year,"STR_TO_DATE(ds_postmeta.meta_value, '%m/%d/%Y') >= CURDATE()
"
10181,How to create table and insert values in one statement,"SELECT Round(A.km, 4) as km, Round(X.y - A.y, 4)  as Diff
Into resultstable1_DIFF
FROM sourcetable_1_HQ100 as A INNER JOIN sourcetable_2 as X
ON Round(A.km, 4)  = Round(X.km, 4)
"
13798,SQL: Aggregate function returning 0's when using WHERE filter,"PERSON  DATE                 SUM(REQUESTS)  SUM(RESPONSE)
--------------------------------------------------------
Clinton March, 03 2013 00:00:00+0000    4   0
Mao     March, 03 2013 00:00:00+0000    5   0
Nixon   March, 03 2013 00:00:00+0000    3   3
Nixon   March, 04 2013 00:00:00+0000    17  2
"
29997,Crystal/Oracle parameterized query to use variable,"Select * 
from table
where field = decode
         (myvariable,'1900-01-01',ADD_MONTHS(LAST_DAY(SYSDATE), -1)
                    ,myvariable)
"
37052,how can I use loop 'for' through a table in SQL to check if a column is 0?,"INSERT INTO Table1 (ColList) 
     SELECT ColList 
       FROM SourceTable 
      WHERE Column1 = 0;

INSERT INTO Table2 (ColList) 
     SELECT ColList 
       FROM SourceTable 
      WHERE (Column1 <> 0 OR Column1 IS NULL);
"
14232,MySQL user-defined functions to generate primary key,"CREATE TRIGGER trigger1
  BEFORE INSERT
  ON table1
  FOR EACH ROW
BEGIN
  IF NEW.id = 0 THEN -- generate new ID if zero is set
    SET NEW.id = ...; -- write your code to generate new ID
  END IF;
END
"
24951,what should i index,"CREATE UNIQUE NONCLUSTERED INDEX IDX_IndexName ON dbo.TableName(ComponentId, TimeStamp) 
INCLUDE(Value)
"
26501,Sparql query to find football clubs in Spain and their stadiums,"SELECT ?club ?grounds WHERE
{
    # select a SoccerClub and it's grounds
    ?club a dbo:SoccerClub ;
          dbo:ground ?grounds . 

    # limit only to grounds which are in Spain
    ?grounds dbo:location dbr:Spain.
}
"
4442,SQL MIN Function with where clause,"select p.name from Project p, Shipment s where s.JNo=p.JNo and s.Qty in (select min(qty) from shipment)
"
24464,store only time in HH24:MM format in a table? is it possible?,"create table t1
   ( flight_date date,
     flight_time as (to_char(flight_date,'HH24:SS:MI')),
     flight_day as (to_char(flight_date,'dd/mm/yyyy'))
   ); 
"
68,SQL Update with CASE statement,"Create table tblDescription(
Animal varchar(20),
ID int,
Description varchar(20)
)

Insert into tblAnimal(Animal)
values ('Dog')

Insert into tblDescription
Select 'Dog',1,'Male' union all
Select 'Dog',92,'White'

Select * from tblAnimal

Select * from tblDescription

---Update

Update a
SET Colour = (Select d.description from tbldescription d where d.id =92),
Gender = (Select d.description from tbldescription d where d.id =1)

From tblAnimal a inner join
tblDescription d on d.Animal =a.Animal
"
21055,SQL Server 2005 Table-valued Function weird performance,"CREATE INDEX IX_call_company_date ON call (company_id, date)
"
11594,How to get a Detail ID when doing a Group By on the Master ID (SQL Server 2005),"WITH example AS (
  SELECT ad.applicantdetailid,
         ad.applicantmasterid, 
         ad.dateeffective,
         ROW_NUMBER() OVER(PARTITION BY ad.applicantmasterid
                               ORDER BY ad.dateeffective DESC) AS rank
    FROM #APPLICANTDETAIL ad)
  SELECT e.applicantdetailid
    FROM example e
   WHERE e.rank = 1
ORDER BY e.applicantmasterid, e.dateeffective
"
18907,having PL/SQL troubles,"SELECT discount_percentage
  INTO v_discount_percentage
  FROM your_table
 WHERE number_of_seats = p_number_of_seats;
"
6649,How to construct common table with multiple nested queries,"WITH 
ctTableA AS (Select * FROM tableA WHERE fldAID=A), 
ctTableB AS (Select * FROM tableB WHERE fldAID=A)

SELECT * FROM ctTableA INNER JOIN ctTableB ON ctTableA.fldX=ctTableB.fldX
"
32919,"Selecting top results from SQL Count query, including table join - Oracle","SELECT *
FROM
(
SELECT customer.company_name, COUNT (item.pickup_reference) as ""Number of Pickups"" 
FROM customer
JOIN item ON (customer.reference_no=item.pickup_reference) 
GROUP BY customer.company_name, item.pickup_reference
ORDER BY COUNT (customer.company_name) DESC
) 
WHERE rownum <= 10
"
13292,MySQL count row values WHERE column = value,"select
    name,
    sum(votes) as total_votes
from mytable
group by 1
order by 2 desc
"
13154,SQL Server query: Sum columns from 2 tables,"SELECT   A.CUST_ID 
       , SUM(ISNULL(P.PRICE,0) + ISNULL(S.PRICE,0)) Final_Price
FROM APPOINTMENT A 
INNER JOIN PRODUCT P   ON A.PROD_NUM = P.PROD_NUM
INNER JOIN SERVICE S   ON S.SERVICE_ID = A.SERVICE_ID
GROUP BY A.CUST_ID
"
27449,sql replace function that matches whole words,"...Your Current Query...
WHERE INV_DESCRIPTION LIKE '5ml%'
OR INV_DESCRIPTION LIKE '% 5ml%'
"
16509,How to create two variables refering the same nested table?,"declare
  type str_list_t is table of varchar2(32767);
  v_foos constant str_list_t := str_list_t('a', 'b', 'c');
  -- have some business logic to get the right indices
  i pls_integer := 1;
  j pls_integer := 3;
begin
  dbms_output.put_line(v_foos(i));
  dbms_output.put_line(v_foos(j));
end;
/
"
14993,SQL Aggregate Function Query not Producing Expected Results,"COUNT(CASE WHEN R.ReceivedDate BETWEEN @BeginDate AND @EndDate 
THEN R.Confirmed ELSE 0 END)
"
20441,INSERT to a table with a sub query,"INSERT INTO mytable
SELECT 'C'+inserted.exhid AS ExhId,inserted.exhname AS ExhName,
 inserted.exhid AS RefID  FROM inserted 
    WHERE inserted.altname IS NOT NULL
"
33954,how to get this result in sql?,"SELECT *
FROM tab1
-- Order records by ""master id groups"", first
ORDER BY CASE WHEN l2 = -1 THEN Masterid ELSE l2 END,
-- Within a ""master id group"", get the master first and then its children
         CASE WHEN l2 = -1 THEN 0        ELSE 1 END
"
27613,Excel/VBA/ADO - SQL query not returning correct results,"WITH A AS(SELECT * FROM [FoliosXXX])

SELECT * FROM A WHERE [Departure DATE] <= 30
UNION
SELECT * FROM A WHERE [Departure DATE] > 30 AND [Departure DATE] <= 60
UNION
SELECT * FROM A WHERE [Departure DATE] >= 60
"
3326,T-SQL : Access to any element of a table,"CREATE TABLE [dbo].[#storeTable] (
[path] varchar(1000) not null,
    [nbdays] int,
    [offset] int
) ON [PRIMARY]
"
15839,SQL get the count of rows in each group when it 's not null,"SELECT action_id,COUNT(action_id) FROM
table1 WHERE 
ID > (SELECT MIN(ID) FROM table1 WHERE action_id IS NULL) AND
ID < (SELECT MAX(ID) FROM table1 WHERE action_id IS NULL) AND
action_id IS NOT NULL GROUP BY action_id;
"
15176,How to create query who will be sum or not values from tables,"SELECT T1.Name, COALESCE(T1.VALUE,0) + COALESCE(T2.VALUE,0) 
FROM Table1 T1
LEFT JOIN Table2 T2 ON T1.fk_table = T2.ID
"
25061,"Using Groovy SQL for paging, sorting, and searching/filtering of rows","sql.eachRow('select * from VENDOR where vendorName like ? order by vendorName asc', ['%Alpha%'] ((pageNumber-1)*pageSize)+1, pageSize) { row -> 
...
}
"
30301,using ON DUPLICATE KEY with 2 unique columns,"create unique index idx_table_user_date on table(user, date)
"
21686,Delete subset of a table based on temp table,"DELETE FROM myTable
 WHERE primary_key IN ( SELECT primary_key FROM myTableTemp )
;
"
29638,Fully delete abandoned commit from Gerrit DB AND 'query',"$ java -jar path/to/gerrit.war reindex -d path/to/gerrit-site-dir
"
31204,How to create a stored procedure within another stored procedure in SQL Server 2008,"CREATE procedure parentSP
as 
exec('CREATE procedure childSP1 @inputArg varchar(50)
as 
--do something.')

--call child sp within parentSP
execute childSP1 '10'
Go
"
9802,Change the order of row selected in SQL Server,"ORDER BY
Action, 
CASE WHEN Control_ID = DataValue THEN 1 ELSE 0 END
"
25819,SQL: Variable to update a set of items,";WITH NameHelper AS 
(
    SELECT
        Name,
        SetID
    FROM MyTable
    WHERE Name IS NOT NULL
    GROUP BY Name, SetID
)

UPDATE MyTable SET Name = NameHelper.Name
FROM MyTable
    INNER JOIN NameHelper ON MyTable.SetID = NameHelper.SetID
"
15344,row number with random order of other field,"select @rownum:=@rownum+1 'rank',  r1.* FROM
    (SELECT  pgid, picfile from pages,
             (SELECT @rownum:=0) AS r2
     where pos= 23 
     order by Rand()  limit 5
   ) AS r1
ORDER BY rank
"
17558,Finding the rank or index of some name in an array returned by query,"SELECT t.*, 
       @rownum := @rownum + 1 AS rank
  FROM TABLE t, (SELECT @rownum := 0) r
"
7240,Aggregate results in MySQL statement,"SELECT DATE(created_at) date, 
       SUM(TIMESTAMPDIFF(SECOND, created_at, stopped_at)) time 
  FROM work_sessions 
 GROUP BY DATE(created_at);
"
20223,Where to find all activities of a account in crm 2011 SQL,"select distinct(pointer.ActivityId) from ActivityPointer pointer 
inner join ActivityParty party on pointer.ActivityId = party.ActivityId and 
party.PartyId= @accountId
order by  pointer.ActivityId
"
3173,Return Multiple Values from a Single Output Parameter,"--Transact-SQL Inline Table-Valued Function Syntax 
CREATE FUNCTION [ schema_name. ] function_name 
( [ { @parameter_name [ AS ] [ type_schema_name. ] parameter_data_type 
    [ = default ] [ READONLY ] } 
    [ ,...n ]
  ]
)
RETURNS TABLE
    [ WITH <function_option> [ ,...n ] ]
    [ AS ]
    RETURN [ ( ] select_stmt [ ) ]
[ ; ]
"
14706,Multi-condition OR in one AND with Zend_Db_Select,"$select->where('t.id = ?', '123456')
       ->where('t.param IN(?)', array('value1', 'value2', 'value3'));
"
33913,How do I get 1 year data in Jaspersoft SQL query,"Select
 ... date_sub($(Start_Date), interval 1 year)... ,
 ...date_sub($(end_date ), interval 1 year)... 
from ...
; 
"
6484,Split Comma Seperated Values into Rows with SQL Server,"delete from names n
    where exists (select 1
                  from names n2
                  where ',' + n2.nicknames + ',' like '%,' + n.name + ',%' and
                        n2.nameid <> n.nameid
                 );
"
19759,How to select firrst column date and second column time as Datetime,"SELECT CAST(CAST(@ReminderDate AS Date) AS DateTime) + CAST(DATEADD(HOUR,-3,@ReminderTime) AS TIME)
"
15057,SQL outer Join 3 tables merging data,"SELECT tblCustomer.CustomerID, tblEvents.EventID, null AS tblPending.PendingID FROM dbo.tblCustomer LEFT OUTER JOIN dbo.tblEvents ON dbo.tblEvents.CustomerID = dbo.tblCustomer.CustomerID 
UNION
SELECT tblCustomer.CustomerID, null AS tblEvents.EventID, tblPending.PendingID FROM dbo.tblCustomer LEFT OUTER JOIN dbo.tblPending ON dbo.tblCustomer.CustomerID = dbo.tblPending.CustomerID
"
36392,Declare var for IN statement in SELECT,"DECLARE @allNeededIds table(id int not null)
insert into @allNeededIds (id) values (1),(2),(3),(4),(5),(6)

SELECT * FROM table1
WHERE id IN (select id from @allNeededIds)
"
24421,Replace xml in SQL,"update table_name set xml='all content of your xml file here' where BarcodeID=123;
"
23513,If Table Exists with Dynamic Query in SQL Server,"...    
IF OBJECT_ID(@TABLENAME, 'U') IS NULL
BEGIN
"
28243,where condition in TSQL based on input parameters,"((@Jobtype = '' and [Type] is null) or
 (@Jobtype <> '' and [Type] = CAST(@Jobtype as int )))
"
7402,"how to optimize several ""WHERE (Select .... ) = value"" from same table","WHERE EXISTS (
    SELECT [ID_Line] FROM [Event] WHERE
        [Event].[Name]  = [A].[Col] AND
        [Event].[ID_Line] = 2 AND
        [Event].[DataType] = 2
)
"
39227,Inserting an increment number that initializes based on another column value,"SELECT QNo, ROW_NUMBER() OVER(PARTITION BY QNo ORDER BY ANo) AS IncrementalNo
FROM   TABLE
"
9024,how to check if table exist and if it doesnt exist create table in sql server 2008,"IF  NOT EXISTS (SELECT * FROM sys.objects 
WHERE object_id = OBJECT_ID(N'[dbo].[YourTable]') AND type in (N'U'))

BEGIN
CREATE TABLE [dbo].[YourTable](
    ....
    ....
    ....
) 

END
"
33599,Derived Column Error,"REPLACE(Department,""Soceity Office"",""S.O."")
"
37430,How to get the order distinct rows were last inserted into a database?,"SELECT 
    MAX([order]) AS MaxOrd
  , value
FROM Event
GROUP BY value
ORDER BY MaxOrd DESC
"
37429,delete row/entry based on duplicate column value,"delete from prospective_shop
where id not in
(
  select * from 
  (
    select min(id)
    from prospective_shop
    group by username
  ) x
)
"
14114,PostgreSQL loop through subquery,"SELECT alias, profile_picture 
FROM public.profile 
JOIN public.friends 
ON profile.user_id=friends.friend_user_id 
WHERE friends.user_id = 1059948007363671
"
26701,SQL Server query: tagging query,"SELECT m.Name, m.Description, m.EatsPeople
  FROM dbo.Monster AS m
  INNER JOIN dbo.TagLookup AS tl
    ON m.Name = tl.Name
  INNER JOIN dbo.Tags AS t
    ON t.ID = tl.ID
    AND t.Value = 'green-skin';
"
28762,How to get a value in a row when searching in a Database in delphi?,"var Query : TQuery;
    PIN   : string;

begin
  Query.Sql.Text := 'SELECT pin FROM table WHERE id = value'
  Query.Open;
  PIN :+ Query.FieldByName('pin').AsString;
  Query.Close
end;
"
27763,ORACLE SQL: Select records with time difference less than a minute,"select acct_number, trunc(LOG_EVENT_TMST)
from (select cl.*, lag(log_event_tmst) over (partition by acct_number order by log_event_tmst) as prev_let
      from customer_log cl
      where LOG_EVENT_TMST > to_date('03/01/2015 00:00:00','MM/DD/YYYY HH24:MI:SS')
     ) cl
where (log_event_tmst - prevlet) < 1.0 / (60 * 24)
group by acct_number, trunc(LOG_EVENT_TMST);
"
12932,Count of result of a sql query based on its return,"SELECT count([FILE_NO]) FROM [MY_FILE] WHERE [FILE_NO] LIKE '%s%';
"
17143,Displaying a sorted dataset from two tables,"SELECT  ItemID
        ,Price
FROM    ACTIVE
UNION
SELECT  ItemID
        ,Price
FROM    ARCHIVE AA
WHERE   AA.ArchiveDate = (SELECT MAX(ArchiveDate) FROM ARCHIVE AA1 WHERE AA1.ItemID = AA.ItemID)
AND     NOT EXISTS (SELECT 1 FROM ACTIVE A WHERE A.ItemID = AA.ItemID)
"
26219,MySQL: SELECTing by hash: is this possible?,"SELECT * FROM table WHERE MD5(column) = 'd41d8cd98f00b204e9800998ecf8427e'
"
940,mysql join with condition,"SELECT Category.id,
        COALESCE(a.lang, b.lang) lang,
        COALESCE(a.title, b.title) title
FROM   categories AS Category
      LEFT JOIN category_i18ns AS a
           ON a.category_id = Category.id AND a.lang = 'de'
      LEFT JOIN category_i18ns AS b
           ON b.category_id = Category.id AND b.lang = 'en'
"
33691,Multiplying a query value with multiple select from another table,"SELECT (a.Price * b.Factor_P * b.Factor_Q / b.Factor_R) AS num
FROM tableA a INNER JOIN tableB b
    ON a.Name = b.Name 
   AND TO_CHAR(a.Time, 'DD-MON-YYYY') = TO_CHAR(b.Date, 'DD-MON-YYYY')
WHERE a.Name = 'a'
  AND Time BETWEEN '2011/01/12 09.30.00' AND '2011/01/12 16.00.00'
"
3006,using SELECT INTO with multiple rows,";WITH cte (Col1, Col2, Col3) AS
(
Select 1, 'a','2001-01-01 12:00'
UNION ALL
Select 83, 'z','2011-09-30 13:27'
UNION ALL
Select 777, 'k','1997-04-25 09:27'
)
SELECT *
INTO NewTable
FROM cte
"
20034,How to select records that have multiple values in a related table?,"SELECT c.ContentId, c.ContentName
FROM ContentTag ct INNER JOIN
     Content c
     On ct.ContentID = c.ContentID 
WHERE ct.TagID IN (21, 54)
GROUP BY c.ContentId, c.ContentName
HAVING COUNT(Distinct ct.TagId) = 2;
"
1513,How to assign the max value across mulptiple fields to a single column in a select statement using MS-Access-2010 SQL?,"select max(v) as maggiore from (
select id,d1 as v from table
union all
select id,d2 from table
union all
select id,d3 from table
union all
select id,d4 from table
) as t
group by id
"
36548,Improve subselect query,"SELECT 
    b.*
FROM 
    messaging_messagethread a
INNER JOIN 
    messaging_message b ON a.id = b.thread_id
WHERE 
    b.timestamp =
    (
        SELECT MAX(timestamp)
        FROM messaging_message
        WHERE thread_id = a.id
    )
    AND b.status = 'unread'
    AND b.recipient_id = 4
"
9829,Concatenate a selected column in a single query?,"DECLARE @Names varchar(1000)
SELECT @Names = COALESCE(@Names + ', ', '') + Name
FROM Employees
"
11893,SQL Server : insert customer id into unrelated table,";WITH Cust AS
(
 SELECT row_number() over(order by (select 1)) rn,* FROM Customer
),Resp AS
(
  SELECT row_number() over(order by (select 1)) rn,* FROM #Responses
)
SELECT C.id,c.CustomerID,C.ResponseId 
FROM Cust C 
JOIN Resp R 
ON C.rn = R.rn
"
2654,Performance of SQL query with condition vs. without where clause," SELECT first_name FROM people WHERE last_name = 'Smith';
"
8479,DB2 date conversion,"SELECT CASE Month
            WHEN '1' THEN 'January'
            WHEN '2' THEN 'February'
            WHEN '3' THEN 'March'
            WHEN '4' THEN 'April'
            ...
      END+'-'+Year
FROM TABLE
"
27154,elasticsearch match two fields,"{
  ""query"": {
    ""filtered"": {
      ""filter"": {
        ""bool"": {
          ""must"": [
            {""term"": {""a"": -23.4807339}},
            {""term"": {""b"": -46.60068}}
          ]
        }
      }
    }
  }
}
"
12236,Pulling items out of a DB with weighted chance,"+---+--------+------------+
|row| weight | rollingsum |
+---+--------+------------+
| a |      3 |          3 |
| b |      3 |          6 |
| c |      4 |         10 |
| d |      1 |         11 |  
+---+--------+------------+
"
10725,Fastest postgreSQL equivalent to MySQL UTC_DATE() (getting UTC date)?,"SELECT 
    CAST(NOW() at time zone 'utc' AS date); 
"
3933,"SQLite, how to entities associations without foreign keys?","SELECT t.trackname, t.trackid
  FROM track t
 INNER JOIN artist a
    ON a.artistid = t.trackartist
 WHERE a.artistname = 'Alex'
"
2227,select sum of values: grouped by sign,"SELECT 
  YEAR(date), 
  SUM(CASE WHEN value > 0 THEN value ELSE 0 END) as positives_sum,
  SUM(CASE WHEN value < 0 THEN value ELSE 0 END) as negatives_sum
FROM 
  table 
GROUP BY
  YEAR(date)
"
33611,Is it possible to select the highest value of a DENSE_RANK() field as a field?,"select v.*, max(row_num) over () as max_row_num
from 
( select ...,
  DENSE_RANK() OVER(ORDER BY a.distance, a.state || a.idnum, a.taxid, a.location) row_num
  from ...
)
"
37674,sql to match number in string,"SELECT * FROM table WHERE activitiesids REGEXP '[[:<:]][0-9]+[[:>:]]';
"
28578,"MySQL, how can I select conversations from a list of messages","SELECT a.id, a.to_id, a.from_id, a.seen, a.date, a.message

FROM  `Chat_messages` a

INNER JOIN (
    SELECT MAX(  `id` ) AS id
    FROM  `Chat_messages` AS  `alt` 
    WHERE  `alt`.`to_id` =7
    OR  `alt`.`from_id` =7
    GROUP BY  least(`to_id` ,  `from_id`), greatest(`to_id` ,  `from_id`)
)b ON a.id = b.id
"
23187,"SQL Server : How to replace whitespaces(&nbsp, ASCII) in a string with numbers?","SELECT REPLACE('8 190','char(160)','')
"
39981,SQL group by steps,"SELECT   5 * CEIL(travel_time / 5.0) AS time_in_mn,
         MEAN(foo) AS mean_foo
FROM     my_table
GROUP BY 5 * CEIL(travel_time / 5.0)
"
38514,how to find records that violate referential integrity,"select *
from table2 t2
where not exists(
    select 1
    from table1 t1
    where t1.AccountId = t2.AccountId
)
"
20002,Is there a possibility to change the order of a string with numeric value,"01
02
03
..
10
11
..
99
"
2035,Group by two column with vice versa value,"SELECT LEAST(recipient_id, sender_id), GREATEST(recipient_id, sender_id), COUNT(*)
FROM messengers
WHERE recipient_id = 41 OR sender_id = 41
GROUP BY LEAST(recipient_id, sender_id), GREATEST(recipient_id, sender_id)
"
15369,"SQL selection based on two variables, exclusive of others","select * from your_table
where group_id in
(
  select group_id
  from your_table
  group by group_id
  having count(distinct service) = 1
)
"
23135,Script to merge four access tables,"INSERT INTO tableB (columns)
SELECT [values]
FROM tableA AS A
LEFT OUTER JOIN tableB AS B
ON (A.X = B.X AND A.Y = B.Y)
WHERE B.X IS NULL
"
28742,DB normalization 2NF & 3NF,"# orders
order_id (pk)
customer_id (fk)
ship_address_id (fk)
order_date
ship_date

# customers
customer_id (PK)
customer_field1
...

# addresses
address_id (PK)
customer_id (FK)
street
zip
...
"
207,PostgreSQL. Find max date range in records,"   SELECT user_id, 
          min(date), 
          max(date) 
     FROM test_table
 GROUP BY user_id 
 ORDER BY max(date) - min(date) DESC, 
          user_id;
"
16708,How can I set the value of a column for every row in a table using LINQ?,"myDataContext.ExecuteQuery(""UPDATE [File] SET File_ID = {0}"", 1);
"
38665,Best way to select SUM and a unique value from table,"SELECT p.postid, sum(v.value) AS charge,
v.value AS currentVote
FROM posts p,
     users u,
     votes v
WHERE p.userid=u.userid
  AND v.postid = p.postid
group by p.postid;
"
27205,sql to return unique list of UserID's based on 2 tables,"select distinct u.userID from Users u
left join OldUsers o on o.userId = u.userID
where o.userId is null
"
7092,Min and max by ID over group and other condition,"select id, active, min(TimeStamp), max(TimeStamp)
from (select t.*,
             (select min(timeStamp) from t t2 where t2.id = t.id and t2.timeStamp > t.timeStamp and t2.active <> t.active
             ) groupName
      from t
     ) t
group by id, groupName, active
"
20778,MYSQL: Two Table SELECT without common values,"( select a as FIRST_COL
  from table 1 
) 
union 
( select d as FIRST_COL
  from table2 
)
"
18512,Get rows product (multiplication),"SELECT 
    CASE WHEN EXISTS (SELECT 1 FROM test WHERE <condition> AND datasign = 0)
         THEN 0
         ELSE (SELECT 1-2*(SUM(datasign=-1)%2) FROM test WHERE <condition>)
    END AS resultsign,

    CASE WHEN EXISTS (SELECT 1 FROM test WHERE <condition> AND datasign = 0)
         THEN -1            -- undefined log for result 0
         ELSE (SELECT SUM(datalog) FROM test WHERE <condition> AND datasign <> 0)
    END AS resultlog
  ;
"
27900,How to determine if an employee is a manager?,"SELECT DISTINCT E.Employee, 
    CASE 
       WHEN M.Employee IS NOT NULL THEN 'IS MANAGER' 
       ELSE 'IS NOT MANAGER' END Status
FROM YourTable E
   LEFT JOIN YourTable M ON E.Employee = M.Manager
"
20897,"MySQL - how to group hour, offset by 30 minutes","TABLE timeslice
ID | FromHour | ToHour | NextDay
---+----------+--------+-------
1  | 00:30    | 01:30  | 0
2  | 01:30    | 02:30  | 0
<snip>
24 | 23:30    | 00:30  | 1

select date(date) aDate, ID ,date, bidOpen, max(bidHigh),min(bidLow)
from data inner join timeslice
    ON date >= CONCAT(date(Date),' ',FromHour) 
    and date < concat(date(DATEADD(day,NextDay,date),' ',ToHour)
group by aDate, ID
"
2612,How to restrict the length of INTEGER when creating a table in ORACLE?,"CREATE TABLE RegTable
(RegNumber NUMBER(8,0),
CONSTRAINT CheckRegNumber  CHECK (RegNumber > 9999999)
);
"
6833,Remove the multiple transactions and remain the first transaction,"; With Ordered as (
    select Transaction_Nr,Serial_Nr,Qty,
           ROW_NUMBER() OVER (PARTITION BY Serial_Nr
                              ORDER BY Transaction_Nr) as rn
    from TRANSACTION_TABLE
)
select Transaction_Nr,Serial_Nr,Qty
from Ordered
where rn = 1
"
39927,MySQL group by intervals in a date range,"Select FROM_UNIXTIME(stime), bytes 
from argusTable_2009_10_22 
where stime > (UNIX_TIMESTAMP()-600)
group by floor(stime /10)
"
31819,SQL: Exclude row if value in both columns,"SELECT * 
FROM table_name 
WHERE Login <> Alias
"
5438,Make a normal query from a stored procedure,"SELECT PERSONID FROM T_PERSON WHERE 
    CCODE = (
        CASE WHEN @CCODE = 'ALL'  THEN CCODE
        ELSE @CCODE END
        )
    AND
    EMPCODE = (
        CASE WHEN @EMPCODE = 'ALL'  THEN EMPCODE
        ELSE @EMPCODE
        END
        )
"
24513,"Trac - WHERE statement in SQL lite query is ""false"" for all tuples altough it should not be","SELECT
  id,
  changetime as modified,
  strftime('%s',""now"") as date,
  (strftime('%s',""now"") - changetime / 1000000) as 'DIFF'
FROM ticket
WHERE (CAST(strftime('%s',""now"") AS NUMERIC) - changetime / 1000000) < 86400.0
"
11667,True or False with Once SQL Command,"UPDATE article SET published = NOT published WHERE id = '1';
"
11546,Formatting pattern to numbers in Oracle,"select to_char(column_name, '000') from ...
"
31150,Select Combination of columns from Table A not in Table B,"Select wfcr.*
from 
  Final_Combined_Result wfcr 
  WHERE NOT EXISTS 
     (Select 1 --select values dont matter here, only the join restricts.
     from 
       Temp_WFCR t
     where t.Contact_ID = wfcr.Contact_InternalID
       and t.account_id = wfcr.Account_InternalID 
     ) 
"
1812,How to find count of transaction of type1 and type2 for each customer in mysql,"select c.id as customer_id
   , c.name as customer_name
   , sum(case when t.`type` = 'type1' then 1 else 0 end) as count_of_type1
   , sum(case when t.`type` = 'type2' then 1 else 0 end) as count_of_type2
from customer c
   left join `transaction` t
   on c.id = t.customer
group by c.id, c.name
"
14828,Join two tables in codeigniter,"if ($sql->num_rows () >0) {
    foreach($sql->result() as $row) {
    $this->db->where('state_id',$row->state_id);
    $r[] = $this->db->get('city')->row();
    }

return $r;
"
12121,How to select a single row when grouping by column and by max date?,"select col1, col2, date
from 
(
  select col1, col2, date,
    row_number() over (partition by col1 
                       order by date desc) as rn
  from yourtable
) x
where rn = 1
"
7699,How can I import a mysql dump?,"mysql -uroot -p database_name < backup.sql
"
26434,IFNull in MySQL,"(IFNULL(ces.EXPERT_SCORE,5) * IFNULL(cirm.CONSUMER_RATING,5)) + (12.5 * IFNULL(scs.SIMILARITY,5))
"
19539,Clause ORDER BY,"SELECT * 
FROM table1
ORDER BY 
CASE 
   WHEN col2>=100 THEN 1
   ELSE 0
END,
col1,
col2
"
22701,SQL Server Select erroneous records that do not have a matching valid record,"SELECT ERRONEOUS.PERSON_ADDRESS_ID
FROM PERSON_ADDRESS ERRONEOUS LEFT OUTER JOIN
     PERSON_ADDRESS VALID
     ON LEFT(ERRONEOUS.PERSON_ADDRESS_ID, 8) = LEFT(VALID.PERSON_ADDRESS_ID, 8) and
        ERRONEOUS.PERSON_ADDRESS_ID <> VALID.PERSON_ADDRESS_ID
WHERE valid.Person_Address_Id is null and
     LEN(ERRONEOUS.PERSON_ADDRESS_ID) = 8
"
34489,How to change mileage representation forms in sql,"select miles, fraction,
       nvl(to_number(miles), 0) + nvl(to_number(fraction), 0) as milepoint
  from (select regexp_substr(nrlg_milepoint, '[0-9]*') as miles,
               regexp_substr(nrlg_milepoint, '[+-][0-9.]*') as fraction
          from test);
"
22738,MSSQL Query to delete duplicate rows from a TABLE leaving distinct rows in table,"DELETE FROM Log WHERE LogId NOT IN 
 (SELECT Min(LogId) FROM Log GROUP BY customer_id, deactivation_date)
"
20478,Outputting specific rows from SQL database using Date format,"Date now = new Date();
Date before = DateUtils.addDays(now, -31);
long beforeAsLong = before.getTime();
String query = ""select * from TABLE_NAME where DATE_FIELD >= "" + beforeAsLong;
"
15104,How to use COUNT on two tables with WHERE clause,"      SELECT COUNT(*) total
      FROM   tblTicket_Engineer
      INNER JOIN  tblTicketDetail ON tblTicketDetail.TicketID = tblTicket_Engineer.TicketID AND tblTicketDetail.Status = 1
      WHERE tblTicket_Engineer.EngineerID = 1
"
36039,Multiple Where Clauses as Separate Columns,"select
SO.SalesOrderCode
,I.ITEMCODE
,sum(case when I.WAREHOUSECODE = 'MAIN' then  I.UNITSINSTOCK else 0 end) as MAIN
,sum(case when I.WAREHOUSECODE = 'PFC' then  I.UNITSINSTOCK else 0 end)
from
SalesOrder SO
inner join Inventory I
  ON SO.ITEMCODE = I.ITEMCODE
group by
SO.SalesOrderCode,
I.ITEMCODE
"
11392,Combining mysql statements from different table depending on the column value,"select a.*, coalesce(b.col1, c.col1) as col1, coalesce(b.col2, c.col2) as col2
from a left join
     b
     on a.categoryId = 'G' and a.bid = b.bid left join
     c
     on a.categoryid = 'B' and a.cid = c.cid;
"
9818,Query max time (latest) by id SQL Server,"WITH CTE AS
(
    SELECT Id, Name, Time, OtherColumns...,
           RN = ROW_NUMBER() OVER (PARTITION BY ID Order By Time DESC)
    FROM dbo.TableName
)
SELECT Id, Name, Time, OtherColumns...
FROM CTE
WHERE RN = 1
"
17398,Query not working as expected in stored procedure,"Select *  From callforwarding 
Where  Mastercode in (select SRFID from @SRFTable)
    and ApproverNo = @empID
    and ForwardDate in 
               (Select max(ForwardDate) from CallForwarding
                where Mastercode in (select SRFID from @SRFTable)
                and ApproverNo = @empID
                group by Mastercode)
"
30588,Very slow query where table have many records,"SELECT rRozklad.hour, rRozklad.minute, rRozklad.marks
FROM  rRozklad.idOkres=%i AND rRozklad.idPolaczeniaLinie=2
ORDER by rRozklad.hour, rRozklad.minute
"
942,Swapping two rows of the same table based on ROWID in Oracle,"merge into duty_rota d
using (select * from duty_rota ) s
on ((d.rowid = 'AA1' and s.rowid = 'AA2') or (d.rowid = 'AA2' and s.rowid = 'AA1'))
when matched then update set d.duty_date = s.duty_date 
"
2947,MySQL default value as query,"DELIMITER $$
CREATE TRIGGER after_data
AFTER UPDATE ON Data
FOR EACH ROW BEGIN
UPDATE Data
SET NEW.Sum = (SELECT OLD.Total * 0.15)
END$$
DELIMITER ;
"
28448,Selecting a mapping table with fields from two other tables,"SELECT a.field1, c.field2
FROM Table1 a
INNER JOIN Table3 b
ON a.id=b.Table1_id
INNER JOIN Table2 c
ON b.Table2_id = c.id
"
28112,mySQL: Insert meta_key into table when doesn't exist,"INSERT INTO wp_postmeta (meta_key, meta_value,post_id)
SELECT 'sidebar','chicago', object_id 
  FROM wp_term_relationships 
 WHERE term_taxonomy_id = 
       (
          SELECT term_id 
            FROM wp_terms 
           WHERE name = 'Chicago'
       ) 
   AND object_id > 5911
"
15207,Selecting top 5 most count countries in SQL,"select country, count(*) as cnt
from list_ots
group by country
order by cnt desc
limit 5;
"
39492,Alternative to inner join on very slow server 2,"   ALTER TABLE compute_us_gum_2013_digital_panelists ADD PRIMARY KEY(HHID, [other necessary fields (if any)])
"
838,SQL Cursor Processing Control Break logic,"select  [Company Name]
,       count(*) as RowsPerCompany
from    MyDB.dbo.AccountsToImport
group by
        [Company Name]
"
30505,Report generation by week between the given dates in SQL Server,"SET DATEFIRST 1    
SELECT tn.account, tn.customer, SUM(amount), DATEPART(ww,tn.dt) WeekNumber
FROM tablename tn
WHERE dt >= '12/01/2011 00:00:00' 
      and dt < '12/26/2011 00:00:00'
GROUP BY ta.account, ta.customer, DATEPART(ww,tn.dt)
"
7732,Can this sql query be simplified?,"SELECT *
FROM Person p INNER JOIN SportsPerPerson spp1 ON (p.PersonId = spp1.PersonId)
              INNER JOIN Sports s1 ON (s1.SportsIN = spp1.SportId)
              INNER JOIN SportsPerPerson spp2 ON (p.PersonId = spp2.PersonId)
              INNER JOIN Sports s2 ON (s2.SportId = spp2.SportId)
    WHERE s1.Name = 'Tennis' AND s2.Name='Soccer'
"
26139,"table with name ""order"" : invalid table name","SELECT count(*) 
FROM ""ORDER""
"
32285,Dynamic SQl throwing conversion issue with datetime,"DECLARE @TODELETEDATE DATETIME
  BEGIN
    SET @TODELETEDATE =GETDATE()-5

    PRINT '<' +  CONVERT(VARCHAR(19),@TODELETEDATE ,120)
 END
"
20990,Netezza- Concatenate Different Values from Single Column based on Order from another Column,"select heatid,
       (max(case when samplecounter = 1 then sample_type else '' end) ||
        max(case when samplecounter = 2 then '_' || sample_type  else '' end) ||
        max(case when samplecounter = 3 then '_' || sample_type  else '' end) ||
        max(case when samplecounter = 4 then '_' || sample_type  else '' end) ||
        max(case when samplecounter = 5 then '_' || sample_type  else '' end)
       ) as concat_code

from t
group by heatid;
"
37211,Oracle - How to get first Monday of the year?,"next_day(trunc(sysdate, 'YYYY') - 1, 'Monday')
"
16396,Django low-level many-to-many update without query,"field = A._meta.get_field_by_name('b')[0]
tablename = field.m2m_db_table()
column_a_name = field.m2m_column_name()
column_b_name = field.m2m_reverse_name()

from django.db import connection, transaction
cursor = connection.cursor()
for (id, related_ids) in related_map.iteritems():
    for related_id in related_ids:
        cursor.execute(""insert into %s (%s, %s) values (%s, %s)"", (tablename, column_a_name, column_b_name, id, related_id))
transaction.commit_unless_managed()
"
37561,Exit from the oracle user session when running a script,"su oracle
"
2052,"Top 3 rows based on score, but to handle ties","select * from studtable 
where score in (select distinct top(3) score from studtable order by score desc)
order by score desc
"
11850,SQL create table with integers,"SELECT 
row_number() over (order by message_id) num
into #Table
from sys.messages
"
16762,how to backup all DB info using mysqldump?,"mysqldump --opt dbname | gzip - > dump
"
28859,help with bucket data count sql,"SELECT sum(yes),sum(no),BMM, BYYYY, DMM, DYYYY FROM (
    SELECT   SUM(  CASE WHEN [insreported] IS NULL THEN 0 WHEN [insreported] = 'YES' THEN 1 ELSE 0 END ) as yes,  SUM(  CASE WHEN [insreported] IS NULL THEN 1 WHEN [insreported] = 'YES' THEN 0 ELSE 1 END )as no, USERID, BMM, BYYYY, DMM, DYYYY
       FROM dbo.agent_insurance_incentive_data
       GROUP BY USERID, BMM, BYYYY, DMM, DYYYY 
    ) derived
GROUP BY BMM, BYYYY, DMM, DYYYY
"
6623,How do I set 1st row value from sql in ssrs report?,"=IIf(IsNothing(Previous(Sum(Fields!CurrentMV.Value)))
    , Sum(Fields!PreviousMV.Value)
    , Previous(Sum(Fields!CurrentMV.Value)))
"
974,How to select the relative complement of a table B in a table A (A \ B) in an SQL-Query?,"select * from subjects where id not in (select subject.id from categories )
"
502,select between two many-to-many relations,";with cte as
(select id_tag
 from tag_hierarchy where id_tag = id_parent)

select l.name, t.id, t.name
from cte c
inner join tag t on t.id = c.id_tag
inner join tag_level tl on t.id = tl.id_tag
inner join level l on tl.id_level = l.id
where l.lid = @id
"
7471,Need to use SQL variable to define namespace for XML.Value selection,";WITH XMLNAMESPACES ('http://www.test.org/xml/' as test, 'http://www.test.org/xml/' as test2)
SELECT id,
       name,
       [XML].value('(//test:Address[1][test2:Global=1]/test:Street)[1] ', 'varchar(max)') AS streetLocation1,
       [XML].value('(//test:Address[2][test2:Global=1]/test:Street)[1] ', 'varchar(max)') AS streetLocation2 
FROM  TEST
"
27516,SQL Insert to Temp Table Without Specifying Values?,";WITH MY_OTHER_CTE AS
(
    // Logic here uses SELECT * from same table as first CTE.
)
INSERT INTO #Tasks
    SELECT *
    FROM MY_OTHER_CTE
"
20343,Aggregate SQL Function to grab only one from each grouping,"SELECT ID, Count(*) AS IDCounts, SUM(RATE) As Total 
INTO #Temp
GROUP BY ID

SELECT Total, IDCounts, MIN(ID) AS SomeID
INTO #uniques
FROM #Temp
GROUP BY Total, IDCounts
"
21105,Grouping columns into rows SQL,"SELECT ps_product_lang.name, GROUP_CONCAT(ps_feature_lang.name) AS feature, ps_feature_value_lang.value FROM ps_product LEFT JOIN ps_product_lang ON ps_product_lang.id_product = ps_product.id_product LEFT JOIN ps_feature_product ON ps_feature_product.id_product = ps_product.id_product LEFT JOIN ps_feature_lang ON ps_feature_lang.id_feature = ps_feature_product.id_feature LEFT JOIN ps_feature_value_lang ON ps_feature_value_lang.id_feature_value = ps_feature_product.id_feature_value GROUP BY ps_product_lang.name
"
24268,Performing date arithmetic while updating table value,"UPDATE contact_info
SET birthday = DATE_SUB(CURDATE(), INTERVAL (TIME_TO_SEC(NOW()) % 50000) DAY)
WHERE contactID = 1;
"
30944,Is using IN (...) the most efficient way to randomly access a MySQL table?,"SELECT id
  FROM transaction_table a
 WHERE EXISTS( SELECT *
                 FROM archive_table b
                WHERE a.id = b.id )
"
28031,Simple sql query does not return corresponding value needed,"AND users.user_id in ($userID, $senderID)
"
23176,SQL select sum from other table as a column via junction table,"SELECT E.EmployeeName, COUNT(T.TaskID) AS [Number of Tasks], SUM(T.Duration) as [Time Spent]
FROM Employee E, EmployeeTasks ET, Tasks T
WHERE ET.EmployeeID = E.EmployeeID AND ET.TaskID = T.TaskID
GROUP BY E.EmployeeName
"
30533,Count number of times value appears in column in MySQL,"select count(*) as numCustomersFromSydney from table where Suburb = ""Sydney"";
"
25551,SQL statement in creating view,"SELECT DISTINCT
    id,
    SUM(fborders.quantity * fbmenu.fbMenuUnitPrice) as revenue,
    YEAR(STR_TO_DATE(date, '%d/%m/%Y')) as year
FROM
    fb.fborders
        INNER JOIN
    fb.fbmenu ON fborders.fbMenuId = fbmenu.fbMenuId
GROUP BY
    id,
    YEAR(STR_TO_DATE(date, '%d/%m/%Y'))
"
19135,issue with subquery,"select id, 
   case activate
      when 0 then 'inactive'
      when 1 then username
   end as username
from users
WHERE email = '{$email}'
   AND (activate = 0 or password = '{$password}')
"
23924,Is there a better way to writing tsql query?,"SELECT *  FROM table 
WHERE Zone = 1
AND (CutOffDate > '2013-05-23 00:00:00.001' OR status = 1)
"
28633,How to dump mysql table structure without data with a SQL query?,"SHOW CREATE TABLE MyTablename
"
22366,SQL find in Table A where not in Query B,"select a.*
from a left join
     b
     on b.tablea_id = a.id and b.active = true
where b.id is null;
"
11718,Function that can be used in sql statement," select * from emp_history where emp_no in (select * from table(your pipelined function))
"
37042,How would I write a SQL query to retrieve closest match to my parameters?,"SELECT *
FROM RulesTable
WHERE ISNULL([Type], @Param1) = @Param1
AND ISNULL(SubType1, @Param2) = @Param2
AND ISNULL(SubType2, @Param3) = @Param3
ORDER BY [Type] DESC,
SubType1 DESC,
SubType2 DESC
"
29896,msql replace links in database,"UPDATE Stores SET MapView = concat(MapView,'&a=b');
"
578,calling a sql stored procedure using the rows() method in grails?,"sql.call(""{call EmployeeQueryClient(?, ?, ?, ?)}"", ['SomeClient', 1, 1, 0])
"
12508,How to filter rows on nested values in a json column?,"SELECT t.*
FROM   things t, json_each(t.blueprint) b
WHERE  b.value->>'name' ILIKE 'azamund';
"
941,Mysql group by day in a date_time field,"SELECT  DATE(date_time) datetime,
        SUM(sr13) total_sr13,
        SUM(r4) total_4
FROM    TableName
GROUP   BY DATE(date_time)
"
39251,How to filter SQL join to records that have multiple matches only,"SELECT [User_Id] 
FROM USERROLE UR
WHERE Role_Id IN (1,2,3)
GROUP BY [User_Id] 
HAVING COUNT(DISTINCT Role_Id) = 3
"
7638,Multiple max values from joined tables,"SELECT d.name, e.name,e.pay
FROM employees e
JOIN departments d ON e.department_id = d.id
WHERE NOT EXISTS (
    SELECT 42 FROM employees x
    WHERE x.department_id = e.department_id -- same dept
    AND x.pay > e.pay                       -- higher pay
    );
"
30104,Select minimum value in group,"with minpay as
(
  select *
    , payrank = row_number() over (partition by name order by pay1 + pay2, ID)
  from pay
)
select ID
  , name
  , pay1
  , pay2
from minpay
where payrank = 1
order by name
"
19144,Django ManyToManyField Custom Structure,"from django.db import models

class Person(models.Model):
    name = models.CharField(max_length=50)

class Group(models.Model):
    name = models.CharField(max_length=128)
    members = models.ManyToManyField(Person, through='Membership', through_fields=('group', 'person'))

class Membership(models.Model):
    group = models.ForeignKey(Group)
    person = models.ForeignKey(Person)
    inviter = models.ForeignKey(Person, related_name=""membership_invites"")
    invite_reason = models.CharField(max_length=64)
"
30091,Query to View new/updated tables,"CREATE TRIGGER mark_changes AFTER UPDATE ON my_table FOR EACH ROW
BEGIN
  INSERT INTO tracking_table VALUES ""Change in table my_table"", OLD.id, NEW.id
END$$
"
31127,Correlated subquery in SQL,"SELECT  *
FROM    Patients p
        CROSS APPLY ( SELECT    MAX(ModifiedAt) AS ModifiedAt
                      FROM      ResultsStored rs
                      WHERE     p.RowId = rs.RowId
                    ) a
WHERE   a.ModifiedAt > p.ModifiedAt
"
23332,"SQL MATCH LIKE, make the id equal to each other","UPDATE ingredient_aliases
SET a.ingredient_id = 
     (SELECT MAX(ingredient_id) AS max_id
      FROM ingredient_aliases
      WHERE name LIKE '%WATER%'
        AND ingredient_id IS NOT NULL)
WHERE name LIKE '%WATER%' 
    AND ingredient_id IS NULL
"
37698,SQL Server query results as INSERT,"UPDATE table
SET username = SubString(lastName, 1, 3) + SubString(firstName, 1, 2);
"
9770,SQL Like query to get closest match to the parameter,"select * from t WHERE DIFFERENCE(ProductName,'watches')>=3
"
35112,"Linq to sql, aggregate columns ,group by date into listview","Dim results = db.Orders.Where(Function(n) n.CustomerId = customerId).GroupBy(Function(n) n.Date.Year, Function(key, values) New With {.Year = key, .NetTotal = values.Sum(Function(n) n.NetPurchase * n.Quantity * (1 + (n.Discount/100))), .GrossTotal = values.Sum(Function(n) n.GrossPurchase)})
"
16834,Find a value after a point or before apoint,"SELECT         FLOOR(23.25) FROM dual
SELECT 23.25 - FLOOR(23.25) FROM dual
"
25897,How to increase/replace all numbers in a script,"Enable Regex Searching in Notepad++. 
Search for   :([0-9]*[0-9])
Replace with :\10
( \1 is the value that was found )
"
37793,Split numeric from character data," select 
    substring(data, 1, PATINDEX('%[0-9]%',data)-1) as ename,
    substring(data, PATINDEX('%[0-9]%',data), len(data)) as sal
 from 
     table
"
25356,Calculating average time between events in a flat table with SQL,"SELECT avg(datediff(t2.activity_date, t1.activity_date))
FROM table t1
JOIN table t2 ON t1.email = t2.email
WHERE t1.activity_type = 'email_sent'
  AND t2.activity_type = 'email_click'
"
33897,INNER JOIN on greatest value,"SELECT *
FROM Vehicle v
INNER JOIN VehicleCost vc 
   ON (case
         when VehicleWeightTotal > VehicleWeight then VehicleWeightTotal
         else VehicleWeight
       end) between vc.WeightFrom AND vc.WeightTo;
"
15112,SQL: How to relate duplicate rows to unique rows and remove them from another table?,"select id 
from table_a
where not exists (
  select 1 from table_b 
  where table_b.id = table_a.id 
  and table_b.alphabet = 'Z')
"
30464,"T-SQL: ""Compress"" rows with equal values to one","Try this :

With cte As
( Select  * , row_number() over (partition by ColumnA, ColumnB,ColumnC
 order by ID ) as myrownumber from myTable
)
Select * from cte where myrownumber=1
"
11,How can I use full outer join?,"SELECT df.numCode as 'numCode', 
       coalesce(tf.dateCurr, '2012-10-29') as 'dateCurr'
FROM dateFile df Full Outer join Contact ct 
On ct.numCode = df.numCode and df.dateCurr = '2012-10-29'
"
24160,Postgres count items by interval,"select a.id, a.log_at, max(b.log_at), count(1)
from logs a
join logs b on b.log_at >= a.log_at and b.log_at <= a.log_at+ '20 m'::interval
group by 1, 2
having count(1) > 1
order by 1
"
9800,Multiple where selection (high number of params) in SQLite,"select * from tables where id in (2, 5, 7, 32, ...)
"
5482,SQL Query to Count Number of Responses Matching Certain Criteria over a Date Range and Display as Grouped per Day,"SELECT cast(booking_date as date) as [booking_date], 
       sum(case when friendly = 0 then 1 else 0 end) as [FriHappy],
       sum(case when friendly = 1 then 1 else 0 end) as [FriNeutral],
       sum(case when friendly = 2 then 1 else 0 end) as [FriSad]
FROM [u-rate-gatwick-qsm].[dbo].[Questions]
WHERE booking_date >= '2014-02-01' AND booking_date <= '2014-03-01'
GROUP BY cast(booking_date as date) 
ORDER BY min(booking_date);
"
34597,How do I iterate through hierarchical data in a Sql Server 2005 stored proc?,";WITH KeyValue AS
(
SELECT G.Id, G.Name, D.Key, D.Value, 0 AS level
FROM Group G
LEFT JOIN Data D ON G.Id = D.GroupID
WHERE G.Id = @your_top_level_root

UNION ALL

SELECT G.Id, G.Name, D.Key, D.Value, K.level + 1
FROM KeyValue K
JOIN Group G ON G.ParentId = K.Id
LEFT JOIN Data D ON G.Id = D.GroupID
)
SELECT * FROM KeyValue
"
28366,Select Query in sql with testing on each row,"SELECT favorite_id,MO,name,
b.image_id,
image_path = case when b.image_id ='0' then i1.image_path else i.image_path end

FROM buddies b, registration r 
left join images i  on b.image_id=i.image_id
left join images i1 on r.image_id=i1.image_id
where b.reg_id=@regID and  r.reg_id=@regID 
"
20053,How to pull same row from another table by date in mysql,"SELECT first.f_id, first.date, second.s_id, second.name
  FROM first JOIN second ON second.f_id = first.f_id
"
9176,Inserting data - Mysql workbench,"insert into target (col1, col2)
select source1.col1, source2.col2
from source1
inner join source2 on source1.id=source2.s1_id
"
3838,SQL Count total unique values,"DECLARE @StartDate DateTime;
DECLARE @EndDate DateTime;

-- Date format: YYYY-MM-DD
SET @StartDate = '2013-11-06 00:00:00'
SET @EndDate = GETDATE()  -- Today


SELECT Username, Count(Ticket.Id) as Count
FROM  Ticket
INNER JOIN TicketStatus ON Ticket.TicketStatusID = TicketStatus.TicketStatusID
INNER JOIN Membership ON Ticket.CompletedBy = Membership.UserId
WHERE TicketStatus.TicketStatusName = 'Completed' and Ticket.ClosedDate >= @StartDate
      and Ticket.ClosedDate <= @EndDate
GROUP BY Username
"
224,Single line query for copying data from 3 tables to a empty table,"insert into <emplty_table>
select * from table1
union all
select * from table2
union all
select * from table3
"
29841,grant user in another database,"create database link to_my_database connect to guest_in_my_database identified by 'bigsecret' using tns_alias_to_my_database;
"
7128,How to disable the format characters in MySql searching results?,"mysql -u<user> -p<userpwd> --silent <dbname>
"
4454,Howto build a SQL statement with using IDs that might not be available in the table?,"SELECT tbl1.province, tbl1.district, tbl1.commune, tbl1.village 
FROM dbo.table2 AS tbl2 
INNER JOIN dbo.table1 AS tbl1
ON tbl1.province = tbl2.province_id 
AND tbl1.district = tbl2.district_id 
AND (tbl1.commune is NULL OR (tbl1.commune = tbl2.commune_id)) 
AND (tbl1.village is NULL OR (tbl1.village = tbl2.village_id))
"
8614,t-sql datetime question,"select *
  from TableName
  where OrderNo = 'AB103' and SendDate between '4/1/2010' and '4/30/2011'
"
12593,Creating a workload on a sample database,"Declare @MyRow as bigint = 0
Create table dbo.StupidBigTable ( obj_id bigint identity(1,1),
        StupidBigField nchar(1024) )

While @MyRow <= 999999999 --I don't remember how big bigint can get
Begin
    Insert into dbo.StupidBigTable (StupidBigField)
    Cast(@MyRow as nchar)
    Set @MyRow = @MyRow + 1
End
"
31262,Transform SQL data set,"select y1.* from YourTable y1
join
(select Columnid,max(versionid) versionid from YourTable 
group by Columnid) as y2
on y1.Columnid = y2.Columnid and y1.versionid = y2.versionid
"
28239,comparing averages in mysql,"SELECT s.sid, s.fname, s.lname, AVG(t.grade) AS average
FROM student AS s
JOIN take AS t ON t.sid = s.sid
GROUP BY s.sid
HAVING average > (
    SELECT AVG(t2.grade)
    FROM student AS s2
    JOIN take AS t2 ON t2.sid = s2.sid
    WHERE s2.fname = 'Peter' and s2.lname = 'Parker'
)
"
30273,How to select and update selected rows in a single sql query?,"UPDATE Car
SET    sent_to_server = 1 
OUTPUT Inserted.id, Inserted.plate
WHERE  sent_to_server = 0;
"
8109,How can I write a message to SQL profiler from Sql a query?," -- My message
select * from table1
"
32201,select query in oracle,"select 
   ref, 
   sum(weight) over (partition by ref order by dated) as weight,
   no,
   address
from
   ...
"
36725,Using DISTINCT in SQL Query,"SELECT DISTINCT 
    Suppliers.SupplierID, Customers.CompanyName, Products.ProductName,    
    Orders.OrderDate
FROM         
    Suppliers INNER JOIN
    Products ON Suppliers.SupplierID = Products.SupplierID CROSS JOIN
    Customers INNER JOIN
    Orders ON Customers.CustomerID = Orders.CustomerID
WHERE 
    Orders.OrderDate <='1/1/1999'
ORDER BY     
    Suppliers.SupplierID
"
12346,"Get only results from table ""products"" if they have entries in two other tables (identified by ID and product type columns)","SELECT * FROM products p
LEFT JOIN tvs tvs ON tvs.id=p.idProduct AND p.type=""tv""
LEFT JOIN phones phones on phones.id=p.idProduct AND p.type=""phone""
WHERE (tvs.id IS NOT NULL OR phones.id IS NOT NULL)
"
4183,convert varchar(8) values and use ASC in T-SQL,"SELECT 
    Total 
FROM Table A
ORDER BY CAST(Total AS FLOAT) ASC
"
5009,Add Column To List Records Sequentially By Date,"select *, row_number() over(order by date desc) as [order] from tablename
"
20684,SQL: Delete old messages except the last X messages for each user,"delete x
where x.mid not in ( select mid
                     -- where top n per group criteria
                   )
"
28086,How to count based on multiple columns in SQL Server?,"SELECT race + '-active : ' + CAST(count(active) OVER(PARTITION BY race) AS VARCHAR) output
FROM Your_Table WHERE active='true'
union all
SELECT race + '-inactive : ' + CAST(count(active) OVER(PARTITION BY race) AS VARCHAR) output
FROM Your_Table WHERE active='false'
"
28436,Getting a list of data based on Items associated with User,"SELECT b.item, b.item_id, a.review_id, a.review, c.category, u.username, c.cat_id 
FROM reviews a
INNER JOIN items b
     ON a.item_id = b.item_id
INNER JOIN master_cat c
     ON c.cat_id = b.cat_id
INNER JOIN profile_follow pf
     ON pf.follow_id = a.user_id
WHERE profile_follow.user_id = '{$user_id}'
ORDER BY a.review_id DESC;
"
5459,Automatically create record when another is created,"CREATE TRIGGER TRI_USERS_INSERT on Users
AFTER INSERT
AS
SET NOCOUNT ON

-- If you have a Default RoleID, select that into a variable and use it in the INSERT below.
-- For this example, I am using just the number 1
-- Also assumes that the ID for Memberships table is AUTO GENERATED, so it's not in INSERT list.
INSERT INTO Memberships (UserID, RoleID)
    SELECT ID, 1 FROM INSERTED
GO
"
24780,How do I query for something that starts with certain characters?,"WHERE SRV_NAME LIKE 'AA%'
"
23551,Eclipselink cache and Session object,"entityManager.unwrap(UnitOfWork.class).executeQuery(readAllQuery);
"
15310,Second maximum and minimum values,"select  id
,       max(case when rnAsc = 2 then number end) as SecondLowest
,       max(case when rnDesc = 3 then number end) as ThirdHighest
from    (
        select  ID
        ,       row_number() over (partition by ID order by number) as rnAsc
        ,       row_number() over (partition by ID order by number desc) as rnDesc
        ) as SubQueryAlias
group by
        id
"
36536,"Fetch Id's that are related to a specific set of items, but not others","SELECT service_id
FROM t1
GROUP BY 1
HAVING
   SUM(CASE WHEN Product IN ('Traffic', 'Weather', 'Travel') THEN 1 ELSE -1 END = 3
"
18045,split group by two 2 by number,"select avg(blocks), to_char(dat,'yy-mm-dd hh24')
from tab
group by to_char(dat,'yy-mm-dd hh24'),
        (case when blocks > 1000 then 1
              else 2
         end);
"
1137,"Check if field is numeric, then execute comparison on only those field in one statement?","select * from purchaseorders
where (case when IsNumeric(purchase_order_number) = 1
       then cast(purchase_order_number as int)
       else 0 end) >= 7
"
22400,MySQL UNION print every other,"select @rownum1 := @rownum1+2 as rownum, name
from (select @rownum1:=0) r, table1
union all
select @rownum2 := @rownum2+2 as rownum, name
from (select @rownum2:=1) r, table2
order by rownum;
"
2446,Android - Show first ten entries in my sql database,"SELECT * FROM `your_table` LIMIT 10
"
16428,Copy a table to another table with different structure,"insert into table1 (col1, col2, col3)
select cast(col1 as signed), col5, col7
from Table1_Temp
"
5754,boolean check for empty date field,"SELECT TOP 1 ordersTable.startDate, ordersTable.endDate
, IIF(ordersTable.endDate Is Null, ""Yes"", ""No"") As IsEmpty
FROM ordersTable 
WHERE ordersTable.customerID=1 
ORDER BY ordersTable.startDate DESC;
"
22111,How the cdc retention value can be changed for the cleanup job?,"sp_cdc_change_job @job_type='cleanup', @retention=minutes
"
17411,SQL: SQL Exclusive Or,"select username,
       max(case when role = 'internal' then 1 else 0 end) as internal,
       max(case when role = 'admin' then 1 else 0 end) as admin
from t
where role in ('internal', 'admin')
group by username
having count(*) = 1;
"
16343,How to count total comment?,"select 
p.post_id,count(*) 'comment_count'
from
fss_post p
left join fss_comment c on p.post_id = c.post_id
group by p.post_id
"
11144,SQLiteDatabase SELECT from 3 tables,"SELECT aa.FOOD_ADDITIVE
FROM FOOD_ADDITIVE_TABLE AS aa
INNER JOIN SUPER_TABLE AS bb
ON aa.ID = bb.FOOD_ADDITIVE_ID
INNER JOIN PRODUCT_INFO AS cc
ON bb.PRODUCT_ID = cc.ID
WHERE cc.CODE = 100;
"
35683,insert a column from one table to another with constraints,"UPDATE legend
JOIN temp
SET legend.account_id = temp.account_id
WHERE(temp.id = legend.advent_id);
"
12156,SQL: Filter based on criteria,"select points_for
from fantasysports.leagues.standings
where league_key='331.l.777399'
and standings.teams.team.%.team_id='2'
"
30776,"Mysql, ranking users by percentage","SET @total= (SELECT COUNT(*) FROM stud);
select s1.*, concat('TOP ', floor(nge / @total * 100), '%') as percent 
from stud s1
join (select s1.id, count(s2.id) as nge
    from stud s1
    join stud s2
    on s1.history <= s2.history
    group by s1.id) as s2
on s1.id = s2.id
order by history desc
"
20338,"multiplying two columns, different tables... one column null","SELECT   parent.*,
         (COALESCE(premiumtable.bid,1) * pointstable.points) as total 
FROM strings parent
LEFT JOIN premium premiumtable 
   on parent.sid=premiumtable.sid AND premiumtable.paid='1'
LEFT JOIN points pointstable 
   on parent.sid=pointstable.`string-id`
WHERE parent.category=:category 
AND (parent.submittype='0' OR parent.submittype='3') 
GROUP BY parent.id 
ORDER BY total LIMIT 5
"
5491,PostgreSQL - Joining 3 tables returning too many results,"select 
requirements.description
from requirements 
inner join advancement_requirements on requirements.requirement_id = advancement_requirements.requirement_id 
inner join advancements on advancement_requirements.advancement_id = advancements.id
WHERE advancements.id = 1;
"
33488,"SQL query with multiple ""IN"" on same many-to-many table","SELECT ""products_product"".""id"",""products_product"".""name"",
FROM ""products_product""
WHERE (
    EXISTS (SELECT 1 FROM ""products_ingridientproductbound"" WHERE ""products_product"".""id"" = ""products_ingridientproductbound"".""product_id"" AND ""products_ingridientproductbound"".""ingridient_id"" IN (16, 17, 18, 19))
    	AND
    EXISTS (SELECT 1 FROM ""products_ingridientproductbound"" WHERE ""products_product"".""id"" = ""products_ingridientproductbound"".""product_id"" AND ""products_ingridientproductbound"".""ingridient_id"" IN (43, 44, 45))
)
LIMIT 21
"
38899,SQL: Increment for every GROUP BY,"select
        exerciseid
      , count(distinct date) as exercise_count
from user_exercises
group by
        exerciseid
;

| EXERCISEID | EXERCISE_COUNT |
|------------|----------------|
|         54 |              1 |
|         85 |              3 |
|        420 |              2 |
"
27783,In SQL Joins - one to many select one column multiple times based upon context,"select r.*, ls.DTStamp as StartTask, le.DTStamp as EndTask
from MyRecord r left join
     MyLog ls
     on r.recNumber = ls.recNumber and ls.TaskName = 'StartTask' left join
     MyLog le
     on r.recNumber = le.recNumber and le.TaskName = 'EndTask;
"
17352,Between two tables how does one SELECT the table where the id of a specific value exists mysql (duplicate),"SELECT Temperature as Value FROM Mountain WHERE Trip_id = 74
Union All
SELECT Atmosphere as Value FROM Forest WHERE Trip_id = 74
"
27463,Simple TSQL table referencing," CREATE PROCEDURE [dbo].[report
(
 @Date DATETIME='11/11/2011'
)
AS
BEGIN

SELECT *
INTO #Temp
FROM  dbo.vwview
WHERE
        Date = @Date
DECLARE @tblnewReport TABLE
(IS varchar(8))

INSERT
INTO @tblnewReport
SELECT SubreportIS FROM #Temp
"
7829,select rows satisfying some criteria and with maximum value in a certain column,"select distinct on (name) id, name, version
from metadata
where name in ('foo', 'bar')
order by name, version desc
"
27246,Select where user bought every year,"select COUNT(distinct ss.year_ordered) as sales_count, ss.userID 
from subscriber_sub ss
where ss.date_deleted is null
  and ss.year_ordered > 2007
group by ss.userID
having  COUNT(distinct ss.year_ordered) >= ( select 2014 - 2008 )  
"
37142,Where clause SQLite android,"Cursor dbCursor = db.query(TABLE_COLOURS, null, null, null, null, null, null);
String[] columnNames = dbCursor.getColumnNames();
"
11209,Merge the common rows in SQL,"select case when Code = lag(Code) over(order by Code, Manager, Employee)
         then null
         else Code
       end as Code,
       case when Manager = lag(Manager) over(order by Code, Manager, Employee)
         then null
         else Manager
       end as Manager,
       Employee
from YourTable Y
order by Y.Code, Y.Manager, Y.Employee
"
22438,Implement IF & MIN logic in Access SQL,"SELECT f1, f2, f3, IIF(Minimum(f1, f2-f3)>0,Minimum(f1, f2-f3),0)  AS f4
FROM tempDb
"
1453,resolving string (read from database) to list python,"str_db_bins_list = eval(str_db_bins)
str_db_lov_list  = eval(str_db_lov)
"
511,Getting the last record in a TOP n PERCENT query,"SELECT  TOP 1 Time
FROM    (    
        SELECT  TOP 10 PERCENT [Time] 
        FROM    Scores 
        WHERE   Lesson = 1 
        ORDER BY 
                Time
        ) as Top10
 ORDER BY
        Time DESC
"
25802,Combine same column name data of two different tables in sql to a result set including null,"select 
  ResourceI as rs, sum (CreatedLogin) as CountCreated,
 sum (DeletedLogin) as CountDeleted
from 
(select 
 ObjDate,
 Resource ,
 1 as DeletedLogin,
 0 as CreatedLogin 
 from  Resource_Deleted
 union all
 select ObjDate,
 Resource ,
 0 as DeletedLogin,
 1 as CreatedLogin  
 from  Resource_Created
)  TABLE_ALL
where ObjDate between TO_DATE('4-Oct-12') and TO_DATE('6-Oct-12')
group by Resource
"
13308,How do I Create a Comma-Separated List using a SQL Query?,"select 
  r.name as ResName, 
  a.name as AppName
from 
  Resouces as r, 
  Applications as a, 
  ApplicationsResources as ar
where
  ar.app_id = a.id 
  and ar.resource_id = r.id
"
33424,SQL Server: aggregate to single result,"SELECT      Client.ClientNo,
            Client.ContactName,
            Deal.Currency,
            Deal.DealDate
FROM        Deal
JOIN        Client ON Deal.ClientNo = Client.ClientNo
WHERE       Deal.DealDate = (select max(DealDate) from Deal
                             where ClientNo = Client.ClientNo)
"
26803,how to perform inner join on same table in mysql,"select switch,GROUP_CONCAT(port_no) from sla group by switch;
"
26007,Condition over a column that i just create,"select col1, col2, min(col3) as col3
from the_table
group by col1, col2
having count(distinct col3) = 1
"
28417,Creating a SQL Script that inserts several items into a table but checking if each exist first,"INSERT [dbo].[Product] ([Id], [Name])
    SELECT id, name
    FROM (VALUES (1, N'Product 1'),
                 (2, N'Product 2')
                 (3, N'Product 3')
         ) v(Id, Name)
    WHERE NOT EXISTS (SELECT 1 FROM Product P2 WHERE p2.id = v.id);
"
31004,Is there a way to avoid this loop in SQL Server 2008 R2?,"with cte as (
    select id_task, id_next_version, 1 as lev
    from task
    where id_task = @id
    union all
    select t.id_task, t.id_next_version, cte.lev + 1
    from task t join
         cte
         on t.id_task = cte.id_next_version
   )
select top 1 *
from cte
order by lev desc;
"
10177,Copying Primary key to another field in Access,"DoCmd.RunSQL ""UPDATE Korut SET [Tarkiste]=[Tunniste]""
"
22301,Selectively inserting into a mysql table," INSERT INTO table_name(name,qty,code) VALUES 
 ( 
    SELECT i.name,i.qty,i.code FROM table2 i
    WHERE (i.code = 'abcd' AND i.name = 'def') OR i.code != 'abcd'
 )
"
16139,SQL Developer pivot with unknown number of values into one column,"select *
from
(
  select id, name, country, state, ""DATE"", amount,
    case 
      when type in ('Red', 'Blue', 'Black') then type
      else 'Other' end type
  from yt
) 
pivot
(
  sum(amount)
  for type in ('Red', 'Blue', 'Black', 'Other')
);
"
14472,How to get all parent names,"WITH C AS
(
  SELECT T.id, 
         T.name, 
         T.pid
  FROM @tblPagePath AS T
  WHERE T.id = 3
  UNION ALL
  SELECT T.id, 
         T.name, 
         T.pid
  FROM @tblPagePath AS T
    INNER JOIN C
      ON C.pid = T.id

)
SELECT *
FROM C
--WHERE C.id <> 3
"
20252,"How to select rows from a database that do not match a criteria, unless they do match another","SELECT * FROM MYTABLE
WHERE id > 1000
AND (name not like 'abc_%'
OR name like 'abc_def%')
"
32707,Combine two rows based on common ID,"select ID, max(ColumnA) ColumnA, max(ColumnB) ColumnB 
from TableName
group by ID
"
32892,SQL: Find non-unique records in one column that are also non-unique in another column,"SELECT p.*, rp.cnt
FROM Places p join
     (SELECT RegionName, PlaceName, COUNT(*) as cnt
      FROM Places
      GROUP BY  RegionName, PlaceName
      HAVING COUNT(*) > 1
     ) rp
     on p.RegionName = rp.RegionName and p.PlaceName = rp.PlaceName;
"
26708,How to explorer temp table content when procedure debugging,"    INSERT INTO #tmp_file EXEC ('RESTORE FILELISTONLY FROM DISK = N''' + @database_bak_path + '''') 
    select * from #tmp_file--this can be diaplay on debugging result
    set @database_mdf_oldname = (select LogicalName from #tmp_file where Type = 'D')
    set @database_log_oldname = (select LogicalName from #tmp_file where Type = 'L')
"
10798,Round to .5 or 1.0 in SQL,"SELECT ROUND(2.2 * 2,0) / 2 
"
3264,To find the date when a threshold is reached in SQL,"select t1.*, 
     (select count(t2.name) from customer t2 
         where t2.date_in <= t1.date_in and (t2.date_out is null or t2.date_out >= t1.date_in))
     from customer t1
     order by t1.date_in
"
7918,Checking if record matches another MS Access VBA/SQL,"strSQL = ""SELECT CFRRRID, [Program], [language], "" & _
    ""DCount('*', 'CFRRR', 'CFRRRID=' & CFRRRID) AS CountOfCFRRRID "" & _
    ""FROM CFRRR WHERE assignedto Is Null""
"
21086,Filter by belongsToMany relation field,"include: [ { 
      model: models.Club, 
      as: 'Clubs', 
      through: { attributes: [] },
      where: { 'Clubs.id': 10 }
} ]
"
1563,Mysql remove duplicate using group by?,"SELECT *
FROM   meber NATURAL JOIN (
  SELECT   latitude,longitute,MAX(position) AS position
  FROM     meber
  GROUP BY latitude,longitute
) AS t
"
27111,Comparing two variables in SQL,"DECLARE @A INT = 1,
        @B INT = NULL;

IF (@B != @A or @B is  null )
    SELECT 1;
ELSE IF (@B = @A)
    SELECT 2;
ELSE
    SELECT 3;
"
2903,Delete multiple objects from a SQL Server database,"declare @sql nvarchar(max) = N''

select @sql = @sql + N'drop table ' + QUOTENAME(s.name) + N'.' + QUOTENAME(t.name) + N'; ' 
from sys.tables t
inner join sys.schemas s on t.schema_id = s.schema_id
where left(t.name, 1) = '_'

exec sp_executesql @sql
"
4657,MySQL sub-query listing information on one line,"SELECT    Event_ID,
          GROUP_CONCAT(IF(place = 1, `money`, NULL)) `First`,
          GROUP_CONCAT(IF(place = 2, `money`, NULL)) `Second`,
          GROUP_CONCAT(IF(place = 3, `money`, NULL)) `Third`
FROM      tableName
GROUP BY  event_id
"
11431,How can I count repeat rows in SQL Server 2012?,"SELECT Row1, Row2, Row3, 
    ROW_NUMBER() OVER (
        PARTITION BY Row1, Row2, Row3, 
        ORDER BY Row1
    )
FROM Table
"
36170,Select a column and add its amount with other rows,"SELECT SUM(YourColumn) as Sum
FROM YourTable
"
19727,creating a pseudo linked list in sql,"select 
  id, 
  location, 
  order_id,
  lag(id) over (order by order_id desc) as next_id
from your_table
"
19056,Select unexist date yyyy/mm,"declare @StartDate date = cast(dateadd(month, -12, GetDate()) as date)
declare @EndDate date = cast(GetDate() as date)
declare @YMList TABLE (YYYYMM INT)

;with dates as (
    SELECT cast(@StartDate as Date) [date]
    UNION ALL
    SELECT DATEADD(month,1,t.date)
    FROM dates t
    WHERE t.[date] < @EndDate
)
insert @YMList (YYYYMM)
select 
    YEAR([Date]) * 100 + MONTH([Date]) AS YYYYMM
from dates
WHERE [Date] < @EndDate
OPTION (MAXRECURSION 10000)
"
34985,SQL update multiple rows based on multiple where conditions,"UPDATE dossiers SET print_flag = 1 
WHERE id IN(1013997, 1020799, 1020800);
"
38890,Should I choose MySQL or MongoDB for this design,"_id 
productId 
productName,
product description,
product category,
product
rating 
comment 
dateCreated 
userId 
username,
userGenger (male/female/unknow)
userAge
userRegisteredDate
"
1495,Recursive calls to database in perl,"sub getChildren {
  my $id = shift;
  my $depth = shift;
  my $sql = qq/SELECT id,label,child_id FROM table WHERE id=?/;
  my $sth = $db->prepare($sql);
  my $sth->execute($id);
  while(my ($id,$label,$child_id)=$sth->fetchrow_array) {
    print "" ""x$depth,$label;
    getChildren($child_id,$depth++);
 }
}
getChildren($id);
"
4943,how to get orphans from a join table in mysql,"select * from products p 
left join product_categories pc on p.id=pc.product_id 
where pc.product_id is null
"
39635,Updating column based on another column's value,"update cats
    set position = c2.newpos
    from (select c2.*, c2.ctid as c_ctid,
                 row_number() over (partition by c2.parent_id order by NULL) as seqnum
          from cats c2
         ) c2
    where cats.parent_id = c2.parent_id and cats.ctid = c2.c_ctid;
"
315,simply sql boolean condition,"WHERE ( mo.startyear <= r.year OR mo.startyear IS NULL )
  AND ( mo.endyear >= r.year OR mo.endyear IS NULL )
"
39766,Find patients with multiple gender,"select distinct p1.[hospital number]
FROM patients AS p1
INNER JOIN patients AS p2
  ON  p1.[hospital number] = p2.[hospital number]
  AND p1.[Sex code] <> p2.[Sex code]
"
14478,MySQL HAVING Clause return empty set?,"mysql> SELECT * FROM test;
+------+--------+
| code | budget |
+------+--------+
|   14 |  65000 |
|   37 |  15000 |
|   59 | 240000 |
|   77 |  55000 |
+------+--------+
4 rows in set (0.00 sec)

mysql> SELECT code, budget, AVG(budget) FROM test;
+------+--------+-------------+
| code | budget | AVG(budget) |
+------+--------+-------------+
|   14 |  65000 |  93750.0000 | we got one row.
+------+--------+-------------+
1 row in set (0.00 sec)
"
11637,SQL Order by posts containing occurences of string in another table,"SELECT TOP 10 *
FROM (
    SELECT tag,COUNT(tag) AS Total
    FROM tags t
    JOIN posts p ON p.post LIKE '%' + t.tag + '%'
    GROUP BY tags
) totals
ORDER BY Total Desc
"
10896,How to retrieve or read comments of particular column in SQL,"SELECT comments
FROM user_col_comments
WHERE TABLE_NAME = 'STUDENT' AND COLUMN_NAME = 'STUDENT_NAME'
"
29945,Detect what computer/server I'm using in VB,"Dim ComputerName As String
ComputerName = System.Net.Dns.GetHostName
If ComputerName = Computer01 Then
    'Connection String 1
Else
    'Connection String 2
End If
"
738,SQL join with references to references,"SELECT Sites.site_code, Sites.site_name,
    ( SELECT site_code FROM Sites WHERE ID =
        ( SELECT HUB FROM Hubs WHERE DialPlan.HUB = Hubs.ID )
    ),
DialPlan.OC
FROM DialPlan
LEFT JOIN Sites
ON DialPlan.site = Sites.ID;
"
6110,SQLite ORDER BY month number in a 'yyyy-mm-dd' format,"select * from myTable order by CAST(strftime('%m', call_date) AS INTEGER);
"
36076,sql smallest value with left join,"SELECT *
FROM   Article LEFT JOIN (
         Images NATURAL JOIN (
           SELECT   article_id, MIN(position) AS position
           FROM     Images
           GROUP BY article_id
         ) AS t
       ) USING (article_id)
"
11622,Using HAVING with COUNT to restrict results,"SELECT Teacher
FROM Students 
GROUP BY Teacher
HAVING COUNT(Student) > 3
"
7836,Selecting the second row of a table using rownum,"select empno
from
    (
    select empno, rownum as rn 
    from (
          select empno
          from emp
          order by sal desc
          )
    )
where rn=2;
"
7375,SQL Server DateDiff Vs .Net DateDiff,"SELECT @Date1, @Date2, DATEDIFF(ss,@Date1,@Date2) /86400.0
"
23151,A query to get list of records whose ids exist in another table but with a different value for other column,"SELECT t2.*
FROM table2012 t1
INNER JOIN table2013 t2 ON t1.tableID = t2.tableID
WHERE t1.position <> t2.position;
"
23518,SQl queries searching by date range,"SELECT * from Table1 WHERE (CDATE(ColumnDate) BETWEEN #03/26/2010# AND #03/19/2010#)
SELECT * from Table1 WHERE (CINT(ColumnAge) between 25 and 40)
"
30420,"How do I add Hours, mins, seconds to dateadd sql?","DECLARE @start DATETIME
DECLARE @end DATETIME

SET @start = DATEADD(dd, 0, DATEDIFF(dd, 0, GETUTCDATE()))
SET @end = DATEADD(dd, 1, DATEADD(ms, -3, @start))
"
1487,Conversion failed when converting the nvarchar value 'newValue' to data type int,"CREATE VIEW [dbo].[vSomeView] WITH SCHEMABINDING
AS
SELECT
id,
CAST(Code AS INT) AS [Code],
myTableCode
FROM dbo.[myTable.Values]
WHERE myTableCode LIKE '%ABC'
AND ISNUMERIC(Code) = 1
"
4891,Calculate non-standard auto-increment automatically,"CREATE TRIGGER mkuuid BEFORE INSERT ON SomeTable
 FOR EACH ROW BEGIN
   SET NEW.primary_key = UUID_SHORT();
 END
"
26107,how to perform a count on a column where a value is X,"SELECT COUNT(val='X'), COUNT(val='Y'), COUNT(val='Z') FROM ...
"
38069,Group by multiple colums request with result on a single line - Android SQLite,"select 
 month, 
 sum(case when ""Type"" = 'A' then 1 else 0 end) as ""count(a)"",
 sum(case when ""Type"" = 'B' then 1 else 0 end) as ""count(b)"",
 sum(case when ""Type"" = 'C' then 1 else 0 end) as ""count(c)""
from 
 mytable 
group by 
 month 
"
34132,Get Unique Results in a query,"SELECT t.idMain, sub_t.minSecondary, t.textValue
FROM   your_table t
JOIN   (SELECT   idMain, MIN(idSecondary) minSecondary
        FROM     your_table
        GROUP BY idMain) sub_t ON (sub_t.idMain = t.idMain);
"
9364,SQL statement not returning all fields,"select Result      = result.Result ,
       ResultCount = count(field.fieldID)
from      dbo.Results result
left join dbo.Fields field   on field.Results  = result.ID
                            and field.RegionID = @RegionID
group by result.Results
"
29938,Mysql size of tables is not immediately updated after delete," OPTIMIZE TABLE Log
"
18204,PostgreSQL How to add WHERE where is count() and GROUP,"SELECT count(*), date_trunc('year', ""createdAt"") AS txn_year 
FROM tables
WHERE active = '1'
GROUP BY txn_year;
"
24134,DB Schema Organization,"User (UserID, firstname, lastname, etc.)
Event (EventID, Name, Date, Location, Capacity, etc.)
EventRegistration (EventRegistrationID, UserID, EventID, ParticipantTypeID, etc.)
ParticipantType (ParticipantTypeID, Name)
"
16905,Inserting T-SQL query text into SQL Server table,"EXEC sp_s_saveReportSearch 'x= r ','[HOD_DESC] LIKE ''%r%'''
"
20269,Joining multiple tables on one join statement?,"SELECT *
FROM table1
INNER JOIN table2 
   ON table1.pk = table2.fk
INNER JOIN table3 
   ON table1.pk = table3.fk
   AND table2.pk = table3.fk
"
9696,SQL Command Search For Single Word vs. Two,"SELECT * FROM jos_users WHERE name NOT LIKE '% %';
"
3948,How can I get the month number (not month name) from a date in SQL Server?,"SELECT DATEPART(m, getdate())
"
38877,SQL Server - Grabbing distinct values with two dates,"Select StartDate, Min(EndDate) EndDate
From TableDates
Group by StartDate
"
33666,Special date conversion,"SQL> select TO_CHAR(SYSDATE, 'fmMM/YYYY')
  2    from dual
  3  ;

TO_CHAR(SYSDATE,'FMMM/YYYY')
----------------------------
8/2013
"
28315,oracle trigger select updated row,"CREATE OR REPLACE TRIGGER Z_ONUPDATELOGIN
  AFTER UPDATE OF LAST_LOGGED_IN_DATE ON CMN_SEC_USERS
  FOR EACH ROW
BEGIN
    INSERT INTO Z_LOGIN (name, login_date) 
    VALUES (:NEW.first_name || :NEW.last_name, 
            :NEW.last_logged_in_date);  
END;
"
15317,Regarding sql query,"INSERT INTO TEST_DETAILS
  (seqnbr, trpid, type)
 SELECT '&seqid', rd.rep_id, '3'
     FROM (SELECT LEVEL + 13
             FROM DUAL
       CONNECT BY LEVEL <= 13) x
LEFT JOIN REF_DETAILS rd ON rd.rep_id = x.level
                        AND rd.rep_id > 13
"
6326,How to use array of values in SQL Select - SQL Server 2005,"EXECUTE('SELECT * 
         FROM   Region R 
         WHERE  R.RegionID IN (' + @regions + ')')
"
4791,Pick Values from Grouped Rows in Postgres,"Select Z.Code, Z.PrevCode
From (
     Select Id, Code, Year
        , lag( Code, 1 ) Over ( Partition By Id Order By Year ) As PrevCode
     From tbl
     Where Year In(2016,2015)
     ) As Z
Where Z.Year = 2016
"
10256,optimization of mysql select (bad performance),"SELECT *
FROM ((
  SELECT NULL AS post_subject, t1.id_rec, t1.NAME, t1.id_cat, t1.date_of_record
  FROM records AS t1
  INNER JOIN categories AS t3
    ON t1.id_cat = t3.id_cat
      AND t3.private = 0
  ORDER BY date_of_record DESC LIMIT 10)      
  UNION      
  (SELECT post_subject, NULL, NULL, NULL, post_time
  FROM posts
  ORDER BY post_time DESC LIMIT 10)
  ) a
ORDER BY date_of_record DESC LIMIT 10
"
35594,Selecting the last set of records in SQL Server that match certain criteria,"select s.*
from (select shp_rev.ShpNum, shp_rev.RevTime,
             dense_rank() over (partition by revdate, valafter, shipnum order by revtime desc) as seqnum
      from shp_rev
      where shp_rev.RevDate  = '2015-10-01' and
            shp_rev.ValAfter = 'O' and
            shp_rev.ShpNum   = 732809
     ) s
where seqnum = 1;
"
4470,Selecting only the top 10 of a count in Oracle,"SELECT col, cnt
FROM   (SELECT   col , COUNT(col) AS cnt
        FROM     table_name 
        WHERE    col IS NOT NULL
        GROUP BY col
        ORDER BY 2 DESC)
WHERE  rownum <= 10
"
9630,Group Dates by month,"SELECT TRUNC(DATE,'MM'), SUM(NET_FLOWS/1000000.00) AS YTD_NET_FLOWS
FROM HISTORY_TBL 
WHERE DATE >= TO_DATE ('12312014','MMDDYYYY') 
GROUP BY TRUNC(DATE,'MM') 
ORDER BY DATE
"
19656,Select records in table A with *only* certain corresponding records in table B,"SELECT DISTINCT files.*
FROM
  files INNER JOIN transfers t1
  ON files.id = t1.file_id AND t1.status='failed'
  LEFT JOIN transfers t2
  ON file.id = t2.file_id AND t2.status<>'failed'
WHERE
  t2.id IS NULL
"
26551,How to get 2 id from tow column and get all records from another table,"select t1.*
from FWTable t1
join FriendsList t2 on t1.mid = t2.mid
where t2.friend_id = 1
and status = 1

union

select t1.*
from FWTable t1
join FriendsList t2 on t1.mid = t2.friend_id
where t2.mid = 1
and status = 1
"
24888,How to use case statement to declare a local variable for a subsequent subquery?,"DECLARE @variable  varchar(10)

SELECT  @variable = 
CASE
  WHEN t.TYPE = 'STUDENT'  THEN 'UNIVERSITY'
  WHEN t.TYPE = 'EMPLOYEE' THEN 'EMPLOYER'
  ELSE 'Undefined'
END
FROM TableName t
"
18463,query to get the monthly amount using mysql,"     SELECT 
         member_id, 
         30*membership_total_amount/DateDiff(membership_enddate, membership_startdate) As monthly_amount
     FROM
         member
"
10523,specify view's column type,"CREATE VIEW [dbo].[myview] (a,b,c)
AS
SELECT a,b,CAST(NULL AS NVARCHAR(100)) c;
"
35266,SQL Server - update only when values are different,"update TableA 
set FirstName = 'Roger Moore' 
where ID = '007' 
    and FirstName <> 'Roger Moore' 
"
39937,How to setup MySQL Database Relationship,"tbl_location
ID: int
Name: Varchar(20)

tbl_class
ID: int
Name: Varchar(20)


tbl_classlocation
ID: int
locationID: int
classID: int
"
20740,sqlite: how to find all rows in a table where ANY of the columns are null?,"void Main()
{
 string input = ""adasda|sadasd|adasd|"";
 char delim = '|';
 StringBuilder sql = new StringBuilder();
 sql.AppendLine(""SELECT * FROM table WHERE "");
 foreach (string s in input.Split(delim))
 {
     if (!String.IsNullOrEmpty(s))
    sql.Append(s).AppendLine("" IS NULL OR "");
 }
 sql.ToString().Trim('\r', '\n', 'O', 'R',' ').Dump();
}
"
39437,Sybase 12 LEFT JOIN Performance issue for CrystalReports,"SELECT
    A.*,
    B.*,
    C.*,
    D.*,
    GET_E(A.""PK""),
    GET_F(A.""PK""),
    GET_G(A.""PK"")
FROM
    A
LEFT OUTER JOIN B ON
    A.""PK"" = B.""FK""
LEFT OUTER JOIN C ON
    A.""PK"" = C.""FK""
LEFT OUTER JOIN D ON
    A.""FK"" = D.""PK""
WHERE A.PK = ####
"
18663,Calling a materialized view from another materialized view in Postgres,"create materialized view first_view
as
select a.column_one, b.column_two, c.column_three
from table_a a 
   join table_b b on a.id = b.aid
   join table_c c on b.id = c.bid;

create materialized view second_view
as
select x.some_column, f.*
from other_table x
   join first_view f on x.id = f.column_one;
"
31681,SQL Server delete and increment,"declare @max int;  
select @max = coalesce(max(key), 1) from table;
dbcc checkident(table,reseed,@max)
"
36803,Sql Query to Linq,"    string[] statuses = new string[] { ""Parts Arr"", ""NA"", ""New Call"", ""Parts Ord"", ""Parts Req"", ""F Work"" };
    var x = (from ro in db.tbl_repair_order
             where ro.contract == ""con""
                && statuses.Contains(ro.status)
             group 0 by ro.status into grouping
             select new { Status = grouping.Key, Count = grouping.Count() });
"
26673,select fields using formatted date,"SELECT date FROM user 
    WHERE date 
        BETWEEN STR_TO_DATE('13/01/2011','%d/%m/%Y %h:%i:%s') 
        AND STR_TO_DATE('28/01/2014','%d/%m/%Y %h:%i:%s')
"
19318,date time range,"NOT (
       `date` < 20120102
    OR `date` > 20120204
    OR ( `date` = 20120102 AND `time` < 1000 )
    OR ( `date` = 20120204 AND `time` >  930 )
)
"
19828,Count group by across multiple tables,"count(distinct dlr.id)
"
11862,"Update first row with oldest, the next with second oldest, and so forth","update table set ocr = 

(select l.ocr
from 
(select l.customer as customer, l.ocr as ocr, l.amount as amount, l.date as date, ROW_NUMBER() OVER (partition by l.customer, l.amount Order BY l.date) as RowNum
from lookuptable l
order by l.date
)a

(select t.customer as customer, t.amount as amount, ROW_NUMBER() OVER (PARTITION BY t.customer, t.amount order by t.customer) as RowNum
from table t
)b
where a.customer = b.customer and a.amount=b.amount and a. rowNum = b.RowNum
)
"
30578,unable to form SQL,"SELECT *
FROM [orders]
WHERE orderReceived >= @startDate
    AND orderReceived < @endDate
    AND (strftime(""%H"", orderReceived) = ""14""
        OR strftime(""%H"", orderReceived) = ""15"")
"
34955,Call stored procedure fail due to Incorrect syntax,"select  dbo.GetHighestDrop( ((clmnA/clmnB)-1)*100, 2, 3) as Col1
from    dbo.tstTable
"
7640,VBA EXCEL SQL CREATE TABLE syntax,"""CREATE TABLE ["" & tblName & ""] ([P_Id] integer not null IDENTITY)""
"
12913,How to fetch limited rows by grouping item in one table in MySQL table,"set @num := 0, @group := 0;

select channel_id, `news_id`, `read`
from 
(
   select channel_id, `news_id`, `read`,
      @num := if(@group = `channel_id`, @num + 1, 1) as row_number,
      @group := `channel_id` as dummy
  from news_box
  order by `channel_id`
) as x where x.row_number <= 3;
"
5149,SQL - setting two different values in one line of SQL,"UPDATE Zones
SET Zones.Zone = Zones_New.Zone,
    Zones.Name = Zones_New.Name
FROM Zones
INNER JOIN Zones_New ON Zones.ZONENO = Zones_New.ZONENO
"
10322,UPDATE row when matching row exists in another table,"UPDATE A
SET A.[ResponseLetterSent] = 1 
FROM [LenqReloaded].[dbo].[Enquiry] A
WHERE A.[ResponseLetterSent] IS NULL 
    AND EXISTS ( SELECT * FROM [LenqReloaded].[dbo].[Attachment] B WHERE A.[EnquiryID] = B.[EnquiryID] )
"
13253,How to ignore the first zeros in the result of a query,"SELECT d_date, produce
FROM production
WHERE
    d_date >= (
        SELECT MIN(d_date)
        FROM production
        WHERE
            produce != 0
    )
;
"
12936,How can I execute a SQL query after 10 seconds?,"CREATE EVENT DO_INSERT_OP
ON SCHEDULE
AT CURRENT_TIMESTAMP + INTERVAL 1 SECOND
DO INSERT INTO mytable (name,surname)
VALUES ('john','john');
"
39022,Adding Values Per Preceeding Row,"select GraderName, 
       sum(Graded_Items) over(order by GraderName) As Graded_Items
From yourtable  
"
32791,How to get column difference between 2 rows in DB in SQL,"select p.id, 
       c.time  - p.time as time_difference
from the_table p
  join the_table c on c.id = p.child_id
where p.child_id is not null;
"
39897,Software packages to create graphs or charts from a database full of numbers?,"# on Ubuntu:
sudo apt-get install rrdtool
"
33680,Incorrect syntax near 'order' in insert query,"insert into shop_stats (dt, NumberOfOrders) 
select * 
  from (select top 30 dt, count(*) as NumberOfOrders 
        from shoptable 
        where (name like '%shop%') 
        group by dt 
        order by dt)
"
24388,PostgreSQL query select all but these,"SELECT ""reference"", 
       ""row"", 
       ""count"", 
       ""xxx"" 
FROM   a 
       LEFT JOIN b 
              ON a.reference = b.reference 
                 AND a.row = b.row 
WHERE  b.row IS NULL 
"
5981,How to substring a MySQL table column,"SELECT SUBSTR(R.regnumber, 4)
FROM registration AS R
"
35237,MySQL multiple values join to one table - better query?,"SELECT z.*, k1.name AS katHOME, k2.name AS katPP, k3.name AS katP 
FROM z_import_kategorie AS z 
LEFT JOIN tm_category_lang AS k1 ON k1.id_category = z.kategorieHOME AND k1.lang_id = 1
LEFT JOIN tm_category_lang AS k2 ON k2.id_category = z.kategoriePP AND k2.lang_id = 1
LEFT JOIN tm_category_lang AS k3 ON k3.id_category = z.kategorieP AND k3.lang_id = 1
ORDER BY z.id ASC
"
28110,How can I compare tuples using MySQL?,"select
    i.Name_1, i.Name_2
from
    association a
inner join
    identical_with i
    on i.Name_1 = a.Name
inner join
    association a2
    on i.Name_2 = a2.Name
where
    a2.Fachname <> a1.Fachname 
"
14374,using distinct doesn't work in sql server,"SELECT Email,Lat_From,Lon_From
FROM
(
    SELECT t.Email,t.Lat_From,t.Lon_From, rn=row_number() over(
        partition by t.Email order by t.Lat_From)
      FROM tbl_Trip t,tbl_User u
      WHERE t.Email like u.Email AND u.Member_Of like 'yahoo'
) X
WHERE rn=1
"
17797,Postgis ST_Contains polygon one table,"SELECT st_contains(a.way, b.way)
FROM yourtable AS a, yourtable AS b
WHERE 
    a.gid = yourfirstid
    AND b.gid = yoursecondid
"
2698,ORACLE Select from 3 tables,"select s.name,
  m.mark,
  c.definition
from students s
inner join marks m
  on s.id = m.id
inner join classes c
  on m.code = c.code
"
33650,Postgresql complicated case statement,"select cust_id, indicator, date,
       max(case when indicator = 'y' then date end) over (partition by cust_id
                                                          order by date) as NewCol
from table t;
"
29292,Filter Row using Oracle SQL in Multiple Data Rows,"     select Record_ID,product from
        (
        select Record_ID, product ,row_number() over(partition by product order by Record_ID ) as r_no
        from ss
        where product not  in (select product from ss where status='Defect'))
        where R_no=1
"
17395,How to perform an update using ObjectContext,"PeopleEntities entities = ObjectContextFactory.GetPeopleEntities();
var person  = entities.People.Single(p => p.Id == id); // or some other way to get the person in question
// make changes to person ...
entities.SaveChanges();
"
13641,Aggregating/Grouping a set of rows/records in MySQL,"select min(datetime) as datetime,
       min(val) as minval, max(val) as maxval, avg(val) as avgval,
       substring_index(group_concat(val order by datetime desc), ',', 1) as lastval
from table t
group by floor(to_seconds(datetime) / (60*60));
"
38385,"SQL - JOIN on two result tables, ideas to refactor?","SELECT DISTINCT
       u.host
      ,first_value(usage) OVER w AS first_usage
      ,last_value(usage) OVER w AS last_usage
FROM   usage u
WINDOW w AS (PARTITION BY host ORDER BY logtime, usage
             ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)
"
13047,How to display matrix cursor using list adapter in Android?,"mx.newRow().add(0).add(""value of second column"").add(""value of third column"");
mx.newRow().add(1).add(""value of second column"").add(""value of third column"");
"
31512,Importing data from CSV file in MySQL,"LOAD DATA LOCAL INFILE 'H:/countries.csv' INTO TABLE ListOfCountries
    FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '""'
    LINES TERMINATED BY '\n'
    IGNORE 1 LINES (CountryName, CountryCode);
"
34166,"View Column length Changed,when created with case and replace","create view v_testing as
    select Postcode = CASE WHEN LEN(A.RealPostcode) = 0 THEN NULL
                           ELSE CAST(REPLACE(A.RealPostcode,' ','') AS VARCHAR(8))
                      END,
           A.RealPostcode
    from dbo.Table A;
"
25545,execute once a day per user until expire,"Set kollar = ObjConn.execute (""Select * from events where uid='""& slut(""id"") &""' AND checkday='""& Date() &""'"")
If kollar.eof Then

<<THE SQL INSERTION HERE >>

Else

Response.write ""Already sent""

End if
"
38323,How to get the records based on the given dates in SQL,"select t.*,
       datediff(day, (case when t.from_date < @StartDate then @StartDate else t.from_date and),
                (case when t.to_date > @EndDate then @EndDate else t.to_date end)
               ) + 1 as diff
from table t
where t.from_date <= @EndDate and t.to_date >= @StartDate
"
18860,sql table join?,"SELECT members.*, accounts.level, accounts.name FROM members
  JOIN accounts ON members.name = accounts.name
 WHERE accounts.id = '$user_ID';
"
39599,mySQL - Combining result from rows depending on count in first row?,"select order_number, dr_amount, dr_speed, oi_amount, oi_up
from data
where order_number in (select order_number
                       from data
                       where oi_amount IS NOT NULL
                       group by order_number
                       having count(*) < 2
                      ) and
      dr_amount is not null;
"
18372,Insert into table with one column value as select query,"insert into table (A,B,C,D) values
('abb'
,'select appCode,pkid from table where party_id=''' || party_id || ''''
,sysdate
,user);
"
22543,What SQL access layer to use for simple reading in Play-Scala?,"sql""select * from coffees where name = $name"".as[Coffee]
"
35116,Dependent SSRS parameters with a multi value parameter and another null allowable parameter,"where PartId = @ProductID
and (@Customer IS NULL OR (Customer = @Customer))
"
1522,SQL Server Inserting a previous value into the new column,"select T.CustomerName, isnull(TP.BillDate, '20130701') as CycleStartDate
from Table1 as T
   outer apply (
       select top 1 T2.BillDate
       from Table1 as T2
       where T2.CustomerName = T.CustomerName and T2.BillDate < T.BillDate
       order by T2.BillDate desc
   ) as TP
"
34545,SQL generating a set of dates,"SELECT CAST (s || ' seconds' AS INTERVAL) + TIMESTAMP 'now'
FROM generate_series(0, -60, -5) s
"
37061,Regex to match test<not ABC>test,"test([^A].*|.[^B].*|..[^C].*)test
"
12135,Does Yii CActiveForm automatically sanitize user input?,"'components'=>array(
 'log'=>array(
  'class'=>'CLogRouter',
    'routes'=>array(    
      array(
        'class'=>'CFileLogRoute',
        'levels'=>'trace, info',
        'categories'=>'system.db.*',
        'logFile'=>'db.log',
      ),
     ...
"
17492,Same Query MySQL User Defined Variables,"SELECT
  Total
FROM
  (SELECT (Some Really Taxing Calculation) AS Total, * FROM Purchases) AS Purchases
WHERE Total < 55 AND itemName = ""Bananas""
   OR Total > 90 AND itemName = ""Apples""
   OR Total = 30 AND itemName = ""Peaches""
ORDER BY
  Total
"
604,MYSQL: Counting category instances only if the user is unique,"SELECT cust.nearestbranch,
    COUNT(distinct case when cust.category = 'Engineer' then customer_id end) eng,
    COUNT(distinct case when cust.category = 'Developer'then customer_id end) dev
    FROM customers cust
    LEFT JOIN orders ON cust.id = orders.customer_id
    WHERE DATE_FORMAT(orders.delivery_date, '%Y-%m') = '2014-09'
    GROUP BY cust.nearestbranch
"
27779,Fectching data in oracle table which has common value in other column in same table,"select ColumnA, ColumnB From YourTable
where ColumnC in (177, 178, 179, 180)
group by ColumnA, ColumnB
having count(distinct ColumnC)=4
"
29273,Subtract 2 rows in Oracle,"SELECT MAX(DateTime) - MIN(DateTime),No FROM table
GROUP BY No
"
33308,SQL Group By question - choosing which row gets grouped,"select p.id, c.id as priorid, p.numusers-c.numusers AS dif, p.date, c.date as priordate    
from licenses p
join licenses c on c.serial=p.serial
  and c.date=(select max(date) from licenses ref where ref.serial=p.serial
    and ref.date<p.date)
order by p.serial
"
14853,How to join my tables?,"select e.id as employeeid,
       d.id as documentid,
       de.state as state     
from employee e
--this could be an inner join but your example is confusing
left join document d on e.id = d.id 
left join docemp de on e.id = de.empid 
                   and d.id = de.docid;
"
3575,combine results from calling same function multiple times,"select f.partid, sum(f.qty)
from unnest(array[1,2]) i, func1(i) f
group by f.partid;
"
14600,Update multiple row values to same row and different columns,";with cte (rn, id, inst_id, person_name, email) as (
    select row_number() over (partition by inst_id order by id) rn, * 
    from person
    )

update f
set 
  person1 = cte1.person_name, 
  email1  = cte1.email, 
  person2 = cte2.person_name, 
  email2  = cte2.email
from firm f
left join cte cte1 on f.inst_id = cte1.inst_id and cte1.rn = 1
left join cte cte2 on f.inst_id = cte2.inst_id and cte2.rn = 2
"
25210,"SQL update function, know which cell I want, how to find row","UPDATE table
SET AttributeB='value'
WHERE AttributeA = 'X'
"
24906,Get top 1 max row of more than 1 order_id,"select * 
from (
  select wh.*, 
         row_number() over (partition by wh.ordernumber order by wh.orderdatetime desc) rn
  from wh_orders_report wh
)
where rn = 1
"
28476,How to query count over 2 columns,"SELECT Team1, Team2, SUM(num) FROM (
   SELECT Team1, Team2, COUNT(*) num
   FROM table_name
   GROUP BY Team1, Team2
  UNION ALL
   SELECT Team2, Team1, COUNT(*) num
   FROM table_name
   GROUP BY Team2, Team1
) combined
WHERE Team1 < Team2
GROUP BY Team1, Team2
"
23878,SQL: Records on same day but different time,"SELECT *
FROM (
   SELECT *,
      RANK() OVER(PARTITION BY CAST(DateTime_Column AS DATE) ORDER BY DateTime_Column DESC) AS R
   FROM Your_Table) AS Tb
WHERE R = 1
"
36481,Need help building SQL Query (simple JOIN),"SELECT *
  FROM Quests
 WHERE Quest_ID NOT IN (
       SELECT DISTINCT(Quest_ID)
         FROM Questing
        WHERE User_ID = 14)
"
8642,How to do get a row from database in VB?,"Dim dr As OracleDataReader = cmd.ExecuteReader() ' VB.NET
Dim userObject As New User()
Dim name As String =  dr.Read()
Dim address As String dr.Read()
userObject.Name = name
userObject.Address = address
"
3543,Advanced SQL Query Struggles,"SELECT  DISTINCT 
    dbo.incidents.id, 
    MAX(severities1.[level]) AS severities
FROM    dbo.incidents INNER JOIN 
    dbo.incident_consequence ON dbo.incidents.id = dbo.incident_consequence.incident_id INNER JOIN 
    dbo.consequences ON dbo.incident_consequence.consequence_id = dbo.consequences.id INNER JOIN 
    dbo.severities AS severities1 ON dbo.consequences.severity = severities1.id 
GROUP BY dbo.incidents.id
"
26163,Datetime sorting very slow on postgresql,"select *
from reviews
where app_id = '2332223'
order by review_updated_at
offset 200
limit 100;
"
5675,Need SQL Query for accessing different serial numbers present in a table,"SELECT min(id) from tablename group by SUBSTRING(id, 1, 1)
"
17070,Fetch first 5 and last 5 records through a single statement,"(SELECT * FROM `something` order by some_column_name
limit 0,5)
union
(SELECT * FROM `something` order by some_column_name desc
limit 0,5
)
"
14989,Count of Sums possibly using group_by,"SELECT COUNT(*) AS `Number of Users`, `Sum of Items` 
FROM (
    SELECT u.UserID, SUM(ItemCount) AS `Sum of Items`
    FROM User u
    INNER JOIN Order o ON u.UserID = o.UserID
    GROUP BY u.UserID
) g
GROUP BY `Sum of Items`
"
23179,"Counting customers from different countries, country table will not join to customer table (Oracle)","SELECT country.country, count(customer_details.customer_id) AS customer_count
FROM country
INNER JOIN customer_details
ON customer_details.country_id = country.country_id
GROUP by country.country
ORDER by country.country;
"
25333,Return row when one of many conditions is not met,"SELECT  q.id, m.status
FROM    (
        SELECT  4567 AS id
        FROM    dual
        UNION ALL
        SELECT  7777 AS id
        FROM    dual
        ) q
LEFT JOIN
        mytable m
ON      m.id = q.id
"
23987,Oracle Join View - which rowid is used,"select * from user_updatable_columns where table_name = 'EVENT_LOCATION'
"
7786,"selecting rows that are the same in one column, but different in another","SELECT *
FROM YourTable
WHERE X IN (
  SELECT T1.X
  FROM YourTable T1 INNER JOIN
       YourTable T2 ON T1.X = T2.X
  WHERE T1.DATE <> T2.DATE
);
"
22315,"Should I combine these queries, and if so, how?","select
    foo.*       -- of course, specific columns is better
    ,bar.*      -- of course, specific columns is better
    ,c.*        -- of course, specific columns is better
    ,d.*        -- of course, specific columns is better

from
    foo
        inner join bar on foo.pk = bar.fooId
            left join charlie c on bar.fooId = c.fooId
            left join delta d on bar.fooId = c.fooId
"
27102,"Sql Server, how can I identify a result column so I can use it in a where clause","SELECT StudentID, COUNT(StudentID)
FROM educators
GROUP BY StudentID
HAVING COUNT(StudentID) > 1
"
24864,How to group by a column and return SUM of other columns?,"SELECT
      anchor, 
      SUM(value) 
 FROM 
      infodata 
 WHERE 
      infoid IN (1,2,3)
 GROUP BY
      anchor
 ORDER BY 
      anchor ASC
"
38602,SELECT different users from same table in single JOIN,"SELECT * FROM tasks 
LEFT JOIN users u1 ON tasks.user1 = u1.id 
LEFT JOIN users u2 ON tasks.user2 = u2.id 
... 
"
39330,How can I make compatible SQL query between Oracle and SQL Server?,"SELECT COUNT(*) 
FROM ( 
   SELECT count(*) 
   FROM TABLE 
   WHERE id IS NOT NULL 
   GROUP BY id 
)  a
"
34990,Swapping row values efficiently,"UPDATE `users` SET `rank_id` = CASE  WHEN `rank_id` = '1' THEN 2 WHEN `rank_id` = '2' THEN 1 ELSE `rank_id` END WHERE `group_id` = '43'
"
38777,"Difference of ""FROM a LEFT JOIN b"" vs. ""FROM a, b""","SELECT a.*, b.id AS b_id
FROM table_a a
INNER JOIN table_b b 
ON a.id = b.id
"
23767,Delete from <tablename> where <columname> Like <value> MS Access,"DELETE 
FROM TagSubs
WHERE TAGNAME LIKE '*\CMD\*' OR 
      TAGNAME LIKE '*\PAR\*'
"
4453,sql to remove repeating data,"WITH MostRecentData AS
(
    SELECT MAX(dateImported) dateImported, month, year
    FROM header
    GROUP BY month, year
)
SELECT ...
FROM detail d
INNER JOIN header h ON h.[key] = d.[key]
INNER JOIN MostRecentData r ON h.month = r.month AND h.year = r.year 
    AND h.dateImported = r.dateImporter
"
35447,I need to merge date rows to a snapshot month row in SQL Server 2008 R2,"SELECT ...
       SUM( CASE WHEN MONTH(DATEADD(DAY, -1, MyTable.Date)) != MONTH(MyTable.Date) THEN MyTable.Opening ELSE 0 END ) AS Opening,
       SUM( CASE WHEN MONTH(DATEADD(DAY, 1, MyTable.Date)) != MONTH(MyTable.Date) THEN MyTable.Closing ELSE 0 END ) AS Closing
FROM MyTable
....
"
23043,How to determine the place of a row in ordered SQL table?,"SET @rownum = 0; 
Select sub.*, sub.rank as Rank
FROM
(
   Select *,  (@rownum:=@rownum+1) as rank
   FROM   users
   ORDER BY points 
) sub
WHERE rank = 15
"
17710,mysql - sum columns from multiple tables based on multiple id's,"SELECT id, id2, SUM(views), SUM(hits)
FROM
(
    SELECT id, id2, views, hits
    FROM Table1
    UNION ALL
    SELECT id, id2, views, hits
    FROM Table2
    UNION ALL
    SELECT id, id2, views, hits
    FROM Table3
) x
GROUP BY id, id2
"
8427,MySQL Update field of set IF NULL or other value,"UPDATE Table1 
SET 
    field1 = field1 + 1, 
    field2 = NOW(),
    field3 = IF(field3 < '2011-00-00 00:00:00' OR field3 IS NULL, NOW(), field3)
WHERE id = $id;
"
12501,"Get hierarchy from ""parent linked"" database","with recursive group_tree as (
  select id_group, 
         id_parent, 
         sequence
  from groups
  where id_parent = 0 -- marks the start of your tree
  union all
  select c.id_group, 
         c.id_parent,
         c.sequence
  from groups p
    join group_tree c on p.id_group = c.id_parent
) 
select *
from group_tree;
"
25336,oracle materialized view refresh time,"SQL> alter session set nls_date_format = 'yyyy-mm-dd :hh24:mi:ss';

Session changed.

SQL> select sysdate from dual;

SYSDATE
--------------------
2008-12-19 :12:18:28

SQL> select (round(sysdate) + 1/24) + 1  from dual;

(ROUND(SYSDATE)+1/24
--------------------
2008-12-21 :01:00:00
"
34633,Sql query percentate change of two data,"select name,
       ((max(case when number = 1 then price end) - 
         max(case when number = maxn then price)
        ) /
         max(case when number = maxn then price end)
       )
from (select t.*,
             max(number) over (partition by name) as maxn
      from t
     ) t
group by name;
"
9790,How to get substring from given character?,"print substring(@s, charindex('\', @s) + 1, len(@s));
"
28391,PostgreSQL: Selecting a DateTime that matches a whole day,"WHERE date_trunc('day', NOW() + INTERVAL '1 day') = date_trunc('day', the_column)
"
15319,Loop and group by only when some conditions occur,"With TB AS (select t1.*
  ,sum(decode(t1.stop,t1.prev_stp,0,1)) over (partition by trip order by time) new_seq
from  
 (select t.*
        ,lag(stop) over (order by t.trip, t.time) prev_stp
  from   test t
  order  by tm) t1)

SELECT trip,stop,new_seq,min(etime) as Etime1, (max(etime)-min(etime)) wait time from TB 
group by trip,stop,new_seq
order by trip,new_seq
"
31578,Alter sql table with new foreign key values,"UPDATE uszips
JOIN   usstates ON uszips.stateCode = usstates.state
SET    uszips.stateCode = usstates.id
"
6698,Multi-level aggregation from a table,"with t as 
 (select stage from metrics where name = 'member')
select 
 (select count(*) from t) as total,
 stage, count(*) 
from t
group by stage
"
30834,Delete rows from A matching rows in B in SAS,"proc sql;
delete from TableA as a
where a.v1 = (select b.v1 from TableB as b where a.primaryKey = b.foreignKeyForTableA)
"
24187,MySQL record existence optimization,"SELECT q.title,
       CASE 
         WHEN uq.who_asked = @user_id THEN 1 
         ELSE 0 
       END AS isYourQuestion
  FROM QUESTIONS q
  JOIN USER_QUESTIONS uq ON uq.question_id = q.question_id
"
23914,Trouble Excluding Nodes from Graph,"MATCH p=(:Collective:Company)<-[tree*0..4]-(downline:Collective)
WHERE
  ALL(x in relationships(p) WHERE x.activeFrom <= '2015-08-31 23:59:59'
  AND (x.activeTo IS NULL OR x.activeTo > '2015-08-31 23:59:59'))
  AND ALL(x in nodes(p) WHERE x.activeFrom <= '2015-08-31 23:59:59'
  AND (x.activeTo IS NULL OR x.activeTo > '2015-08-31 23:59:59'))
RETURN p
"
27446,How to retrieve specific rows from SQL Server table?,"SELECT * FROM (
  SELECT
    ROW_NUMBER() OVER (ORDER BY ColumnName ASC) AS rownumber
    FROM TableName
)  as temptablename
WHERE rownumber IN (2,5)
"
2541,Extract only 1 message from all senders,"SELECT u.uacc_username, max(m.msg_id) as LatestMsg
FROM messages m JOIN user_accounts u on m.msg_from_uacc_fk = u.uacc_id
WHERE m.msg_to_uacc_fk = ?
GROUP BY u.uacc_username
"
30299,SQL Junction Query - How To Get Exact Match,"SELECT F.fruitName 
FROM tblFruits as F INNER JOIN
     tblFruitTagJunc AS FTJ
     on F.fruitID = FTJ.fruitID INNER JOIN
     tbltag as T
     ON FTJ.tagID = T.tagID
GROUP BY F.fruitName
HAVING SUM(iif(t.tag in ('Orange'), 1, 0) > 0 AND
       COUNT(t.tag) = 1;
"
5506,Calculating LTV Accurately,"select avg(custavg) from (SELECT tblservice.customerid, Avg(tblservice.total) AS custavg FROM tblservice GROUP BY tblservice.customerid);
"
17038,MySQL Query to Get Single Item and Latest Associated Item,"SELECT
  t1.*,
  t2.*
FROM Table1 t1
INNER JOIN table2 t2 on t2.table1_id = t1.id
INNER JOIN (SELECT Max(time_added) as time_added, table1_id FROM Table2 Group by table1_id) t2a on 
    t2a.time_added = t2.time_added AND t2a.table1_id = t2.table1_id
"
31649,How to show an specific number of rows based on starter point,"DELETE FROM CHAT_TABLE WHERE ID IN (
     SELECT ID FROM (
        SELECT ID    
        FROM CHAT_TABLE
        ORDER BY TIME DESC
        LIMIT 50) TEMPTBL
);
"
21509,"SQL, find which of array entries doesn't exist in DB","DECLARE @Temp TABLE (
  Filename VARCHAR(255)
)

INSERT INTO @Temp VALUES ('file1')
INSERT INTO @Temp VALUES ('file2')
INSERT INTO @Temp VALUES ('file3')
INSERT INTO @Temp VALUES ('file4')
INSERT INTO @Temp VALUES ('file5')
INSERT INTO @Temp VALUES ('file6')
INSERT INTO @Temp VALUES ('file7')
INSERT INTO @Temp VALUES ('file8')
INSERT INTO @Temp VALUES ('file9')
INSERT INTO @Temp VALUES ('file10')

SELECT t.Filename
FROM @Temp t
LEFT JOIN MyFiles mf ON t.Filename = mf.Filename
WHERE mf.Filename IS NULL
"
22801,how to delete a row with an empty column in android database?,"sql.delete(TBL_ITEMS, KEY_TOTAL_AMOUNT + "" IS NULL"", null);
"
8081,how to represent one-to-one relationship in db design?,"Laptop
-------------
LaptopId (PK)
...

LCD
-------------
LCDId (PK)
LaptopId (FK, Non-null, Unique constraint)
"
2768,SELECT Statement - Date Criteria,"SELECT *
from trialevent
where date <= CURDATE()"";
"
18959,Update a constraint in postgresql 9.1 database,"ALTER TABLE T1 DROP CONSTRAINT fk_T1;

ALTER TABLE T1 ADD CONSTRAINT fk_T1 FOREIGN KEY (id1)
REFERENCES T2 (id1) MATCH SIMPLE
ON UPDATE CASCADE ON DELETE CASCADE;
"
4228,Query to select subcategories of categories of destinations which are active?,"SELECT

subcategories.name AS subcategory_name,
subcategories.slug AS subcategory_slug,
categories.name AS category_name,
categories.slug AS category_slug

FROM

destination 

INNER JOIN destinations_subcategories on destination.id = destinations_subcategories.destination_id and destination.active = 1

LEFT JOIN subcategories ON destinations_subcategories.subcategory_id = subcategories.id

LEFT JOIN categories ON destinations_subcategories.category_id = categories.id

WHERE 1=1 
AND subcategories.is_active = 1 
AND categories.is_active = 1
"
4200,Write multiple labels from sql database,"Dim index as integer

while sqldr.read
   Select case index
      Case 0
        label1.text = sqldr(0)
      Case 1
        label2.text = sqldr(0)
   End Select
   index += 1
end while
"
34302,SQL: Split a row into multiple rows based on certain rules,"SELECT ""Original"" As [Type], [TerrPrim] AS [Terr], Qty
FROM t
UNION ALL
SELECT ""50-50 Give"" As [Type], [TerrPrim] AS [Terr], -Qty
FROM t
WHERE [TerrPrim] <> [TerrSec]
UNION ALL
SELECT ""50-50 take"" As [Type], [TerrSec] AS Terr, Qty
FROM t
WHERE [TerrPrim] <> [TerrSec];
"
1926,SQL - how to select where column contains string separated by space,"select *
from yourtable
where concat(' ', field, ' ') like '% 235 %';
"
35770,Can you insert with a mix of of subquery and values?,"Insert into table
    select value1, value2, value3, testdata
    from dual;
"
32907,Weighted Keyword Search,"select p.sku, sum(case k.keyword_en when 'Dog' then 1001 when 'Cat' then 1002 when 'Mouse' then 1003 else 0 end) as totalscore
from products p
left join product_keyword pk on p.sku = pk.sku
inner join keywords k on k.kid = pk.kid
where k.keyword_en in ('Dog', 'Cat', 'Mouse')
group by p.sku
"
6515,Display count 0 values in SQL Server,"Select Col1, Col2, Count(case when Col3 = 1 then 1 end) as CountOfRecords
From TableA
Group By Col1, Col2
"
39962,Complex query over two tables,"SELECT t1.id, SUM(IFNULL(t2.cond, 0) = 1) AS c1, (SELECT SUM(cond = 1) FROM table2 WHERE id2 = 2) AS c2
FROM table1 t1
LEFT JOIN table2 t2 ON t1.id = t2.id2
GROUP BY t1.id
ORDER BY ABS(SUM(IFNULL(t2.cond, 0) = 1) - c2) * RAND();
"
34567,Split database to different SQL Server,"ALTER TABLE dbo.MyTable
MOVE TO MyNewFileGroup
"
36529,How do I group my cfquery on multiple columns?,"<cfoutput query=""myQry"" group=""date"">
 <cfoutput group=""category"">
  <cfoutput group=""description"">
   #date# #category# #description#
   <cfoutput>
    #detail#
   </cfoutput>
  </cfoutput>
 </cfoutput>
</cfoutput>
"
14842,VB.NET Multiple Selects at once using SQL Server CE,"SqlCeCommand = SqlCeConnection.CreateCommand()

SqlCeCommand.CommandType = CommandType.Text
Dim sb As New StringBuilder()
Dim i As Integer = 1

For Each id As Integer In ArrayListOfIds
    ' IN clause
    sb.Append(""@Id"" & i.ToString() & "","")

    ' parameter
    SqlCeCommand.Parameters.Add(""@Id"" & i.ToString(), DbType.Int32, id, ParameterDirection.Input)

    i += 1
Next
"
6603,Looking for options other than MySQL,"from flask import Flask
app = Flask(__name__)

@app.route('/')
def hello_world():
    return 'Hello World!'

if __name__ == '__main__':
    app.run()
"
18241,sql custom generated week ranges,"declare @offset int (case when @DateFirst = 'Mon' then 1
                          when @DateFirst = 'Tue' then 2
                          ...
                          when @DateFirst = 'Sun' then 0
                     end);

select dateadd(dd, @offset - (datepart(wd, thedate) - 1)
               thedate) as WeekStartDate
"
39777,Groovy SQL ignores order by clause in dynamic select statement,"sql.eachRow( ""select * from mytable where type = 'SUMMARY' and acolumn=${columnValue} order by ${Sql.expand(sortColumn)} ${Sql.expand(sortOrder)}"") { row ->
  results << row.toRowResult()
}
"
27185,Mysql - INSERT INTO table IF table exists otherwise CREATE TABLE,"CREATE TABLE IF NOT EXISTS `table` (
id INT(10),
word VARCHAR(500)
);
INSERT INTO `table` VALUES (NULL,""1234"");
"
28649,"MySQL, select rows if column equals ? else select using default value","select t.optionName, t.optionValue
from (
    SELECT optionName, max(languageID) as MaxLanguageID
    FROM tbl_options   
    WHERE optionName IN ('opt1', 'opt2') 
        AND languageID in (1, 2)  
    group by optionName
) tm
inner join tbl_options t on tm.optionName = t.optionName
    and tm.MaxLanguageID = t.LanguageID
order by t.optionName
"
16764,Joining empty table to return all rows,"SELECT * FROM Table1 T1
LEFT JOIN Table2 T2 ON T1.Id = T2.FK
"
10186,Insert statement with a NON-NULLABLE column,"if(@loginHtml is not null)
begin
    insert dbo.ApplicationLogin(ApplicationID, Title, Html)
    select @appID, @loginTitle, @loginHtml
end
"
25621,how to get the sum of the rows before the current row in MYSQL?,"select
      PreAgg.ID,
      PreAgg.Amount,
      @PrevBal := @PrevBal + PreAgg.Amount as Total
   from 
      ( select
              YT.id,
              YT.amount
           from
              YourTable YT
           order by
              YT.id ) as PreAgg,
      ( select @PrevBal := 0.00 ) as SqlVars
"
17209,Get top ranked values across multiple fields,"SELECT DISTINCT
    FIRST_VALUE(age) OVER (ORDER BY count1 DESC) AS top1,
    FIRST_VALUE(sex) OVER (ORDER BY count2 DESC) AS top2
    FROM (
        SELECT age,
               sex,
               COUNT(age) OVER (PARTITION BY age) AS count1,
               COUNT(sex) OVER (PARTITION BY sex) AS count2
               FROM some_table
    ) some_table
"
28299,How do i unpivot or flatten this table,"SELECT *
FROM tablename AS t
unpivot
(
  FruitValue
  FOR FruitName IN([Apple], [Orange], [Banana], [Grape])
) AS u;
"
6847,Bypass last INNER JOIN in query,"FROM dbo.Activities act INNER JOIN ConvertCodeListToTbl(@Codes) i 
ON (act.ActivityCode = i.code OR @Codes = '')
"
19915,Subquery function inside trigger when clause,"  CREATE OR REPLACE TRIGGER DeleteStudentResults
  BEFORE DELETE ON SESSION_RESULTS
  REFERENCING OLD AS old NEW AS new
  FOR EACH ROW
  declare 
  avg_result number;
  BEGIN
  (SELECT AVG(RESULT) into avg_result from session_results where STUDENT_ID = :old.STUDENT_ID);
  if(avg_result>=3) then
   raise_application_error (-20100, 'You can not delete initial record');
   end if;
 END;
"
28583,Count and select all dates for a specific field in MySQL,"SELECT
  GROUP_CONCAT(ID) as IDs,
  utente,
  COUNT(*) as cnt,
  GROUP_CONCAT(data ORDER BY data) AS Dates
FROM
  tablename
GROUP BY
  utente
"
37450,SQL Table Locking,"set transaction isolation level REPEATABLE READ
begin transaction
select top 1 @catalog_number = catalog_number
  from catalog_numbers with (updlock,rowlock)
  where assigned = 0
update catalog_numbers set assigned = 1 where catalog_number = :catalog_number
commit transaction
"
24819,Postgres NULLIF greater than x,"select LEAST(sum(field), 1) from ...
"
18453,SQL server - Select all items with a date on the previous month,"select *
from items
where datepart(yy,dateFinished) = datepart(yy,dateadd(m,-1,getdate()))
and datepart(m,dateFinished) = datepart(m,dateadd(m,-1,getdate()))
"
35533,LINQ to SQL updates,"db.FileEntities.
    Where(x => ids.Contains(x.ID)).
    Select(x => x.DateDeleted = DateTime.Now; return x; );

db.SubmitChanges();
"
1108,creating a table with a primary key and an unique key,"CREATE TABLE [dbo].[TestTable]
(
    [id] [int] NOT NULL,
    [otherValue] [int] NOT NULL,
 CONSTRAINT [IX_OtherValye] UNIQUE NONCLUSTERED 
(
    [otherValue] ASC
)WITH (IGNORE_DUP_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
"
28487,Show only the first column which has the same value on next record,"select t1.id,
case when t1.name = t2.name and t1.phone = t2.phone
then
'-'
else
t1.name
end as name,
case when t1.name = t2.name and t1.phone = t2.phone
then
'-'
else
t1.phone
end as phone,t1.address from test t1 left join test t2 on t2.id = t1.id-1
order by t1.id
"
15302,Join questionn - Select must return only one record,"SELECT *
from CONTACT c inner join
     CONTACT_DETAILS cd
     on cd.DKEY = c.DKEY left join
     PLANS pp
     on pp.PKEY = c.PKEY AND PP.STATUS = 'Active' left join
     PLANS_DETAILS pd
     on pd.PDKEY = p.PDKEY
WHERE c.KEY = '267110' ;
"
24977,SQL Server queries,"sql =""select * from account WHERE convert(varchar(50),siteid) like '%""+a+""%' or refrenceno like '%""+a+""%' or oldrefrenceno like '%""+a+""%' ""; 
"
29753,Deleting with 3 verifiers,"""DELETE FROM comments WHERE comment_id='$comment' AND p_id='$pid' AND for_w = '$z'""
"
17887,How to make a SQL query for an ordered list with sub-groups?,"Select whatever
from mytable my1
left join mytable my2 on my1.id = my2.parent_id
where whatever
order by case when parent_id is null then id else parent_id end, 
case when parent_id  is null then 0 else order_n end
"
10038,SQL query to get columns and records of that columns using like operator,"Select 'KEYWORD' as KEYWORD, 'PART1_D1' as PART1_D1, 'PART1_D2' as PART1_D2, 
  'PART1_D3' as PART1_D3, 'PART1_D4' as PART1_D4, 'PART2_D5' as PART2_D5,
UNION
Select KEYWORD, cast(PART1_D1 as varchar(50), cast(PART1_D2 as varchar(50), 
  cast(PART1_D3 as varchar(50), cast(PART1_D4 as varchar(50), 
  cast(PART2_D5 as varchar(50)
From sample
"
15824,More elegant SQL?,"SELECT username  
FROM 
  (SELECT username  
   FROM table  
   ORDER BY userid DESC)
WHERE rownum <= 50
"
13420,Count Distinct Assistance,"select c2.Responsible, c.deliveryname,
COUNT(DISTINCT (case..... --conditions here end)) as 'Unique PortStatus(es)'
from table p
join table c on p.OwnerContactID = c.ContactID
join table c2 on c.ContactID = c2.ContactID
where p.PortfolioStatus <>'' and c2.responsible <> ''
group by c.deliveryname,  c2.responsible
"
16128,Group ages by city,"SELECT CodiceComune
     , CONCAT(FLOOR((Eta+0.5)/10)*10,'-',(CEILING((Eta+0.5)/10)*10)-1) Age_group
     , SUM(TotMaschi) m
     , SUM(TotFemmine) f 
  FROM my_table 
 GROUP 
    BY CodiceComune
     , FLOOR(Eta/10);
"
12916,ORDER BY the IN value list,"select c.*
from comments c
join (
  values
    (1,1),
    (3,2),
    (2,3),
    (4,4)
) as x (id, ordering) on c.id = x.id
order by x.ordering
"
13287,SQL query containing unmatched quotation marks,"sqlite> create table t (f1 string, f2 string, f3 string, f4 string);
sqlite> insert into t values ('starships', 'spacecr""aft', 'snoo""py', 'rhythm');
sqlite> select * from t;
starships|spacecr""aft|snoo""py|rhythm
sqlite> select * from t where f2 = 'spacecr""aft';
starships|spacecr""aft|snoo""py|rhythm
"
17338,Slick lifted update on an Object,"def updateContact(id: Int, firstName: Option[String], lastName:Option[String], ...): Unit = {
  val q1 = Query(Contacts).filter(_.id === id)
  val c = q1.first
  val modifiedC = c.copy(
    firstName = firstName.getOrElse(c.firstName),
    lastName = lastName.getOrElse(c.lastName),
    ...
  )
  q1.update(modifiedC)
}
"
20047,How to update table in sqlite android," String where = fname+ ""="" + ""ekanta"" + "" and "" + lname + ""="" + ""your lastname"";
"
36311,"SQL: Group by on value1 and ""not"" value1?","Select Case OrderType When 'Type1' Then 'Type1'
            Else 'NotType1' End OrderType, 
       Count(*) OrderCount
From Table
Group By Case OrderType When 'Type1' Then 'Type1'
              Else 'NotType1' End
"
1532,Sum IF Query for Multiple Tables,"    SELECT a.[Country] As Country, 
SUM(IIF(a.[Month] = ""Jan"", b.[Headcount],0)) As January 
SUM(IIF(a.[Month] = ""Feb"", c.[Headcount],0)) As February

FROM     (
SELECT [Headcount], [Country], ""Jan"" AS [Month] FROM [January 2014]
 UNION ALL
SELECT [Headcount], [Country], 'Feb' AS [Month]  FROM [February 2014]
UNION ALL
...
) AS a
GROUP BY a.[Country]
"
8410,Function REGEXP with a list of numbers,"SELECT id FROM my_list WHERE FIND_IN_SET('8', id_list) AND FIND_IN_SET('44', id_list)
"
38622,Case insensitive string compare in LINQ-to-SQL,"String.Equals(row.Name, ""test"", StringComparison.OrdinalIgnoreCase)
"
6737,Select Average of Top 25% of Values in SQL,"select AVG(t.Value)
from (select top 25 percent Value
      from @TempGroupTable
      where FormulaID = @PassedInFormulaID
      order by Value desc) as t
"
35538,How to see stored procedure output on command line via sqlplus,"SET SERVEROUTPUT ON
"
8645,Select records based on other column condition,"SELECT *
FROM yourtableName
WHERE UID NOT IN (SELECT UID
                  FROM #test
                  WHERE PID = 2)
"
12349,Counting Distinct Columns Based on Count of third column,"SELECT job_id, cust_id, count(distinct a.skill_id)
FROM aaa.jp_job_skill_ref a INNER JOIN
     aaa.jp_cust_skill_ref b
     ON a.skill_id = b.skill_id
GROUP BY `job_id`, `cust_id`;
"
38717,"SQL: query contains at least one ""true"" value","SELECT idt, nome, bool1 FROM path
WHERE idt IN (
  SELECT idt FROM path WHERE bool1 = 'true');

SELECT path.idt, nome, bool1 FROM path
INNER JOIN
  (SELECT DISTINCT idt FROM path WHERE bool1 = 'true') q ON path.idt = q.idt;
"
15540,Counting non-zero values in sql,"SELECT drivername,
     COUNT(NULLIF(over_rpm,0)) AS RPMViolations,
     COUNT(NULLIF(over_spd,0)) AS SpdViolations,
     COUNT(NULLIF(brake_events,0)) AS BrakeEvents
FROM performxbydriverdata
GROUP BY drivername;
"
7693,MySQL: counts by week.,"select  
concat(cast(DATE_ADD(yourdate, INTERVAL(1-DAYOFWEEK(yourdate)) DAY) as char), ' - ',
cast(DATE_ADD(yourdate, INTERVAL(7-DAYOFWEEK(yourdate)) DAY) as char))
as period, count(*) 
from tablename 
group by week(yourdate)
"
8436,Need some help with SQL GroupBY,"select
    id,
    group_concat(emp_id)
from
    foo
group by id
"
22680,"How to create a self iterating, conditional Select Statement in SQL server","with ref(id, refId, name ) as(
  select id, refId, cast((name + ' ') as varchar(max))
  from test
  where id = 37
  union all
  select t.id, t.refId, cast((r.name + t.name + ' ') as varchar(max))
  from test t
  join ref r 
  on r.id = t.refId
)
select top 1 name from ref
order by len(name) desc
"
20038,Prevent SSRS Filter Criteria From Removing Results with a Blank Field,"SELECT Name AS Territory
FROM            Territory
UNION
SELECT 'Unknown'
"
37310,sql group by where statement,"SELECT [group], SUM(CASE acceptance WHEN -1 THEN 0 ELSE 1 END) AS [count]
FROM MyTable
GROUP BY [group]
"
38825,the default value must be a constant; why?,"CREATE TRIGGER yourtable_insert BEFORE INSERT ON `yourtable`
    FOR EACH ROW SET NEW.youraddedcolumn = NOW(), NEW.yourupdatedcolumn = NOW();
"
25547,Oracle SQL Adding IF statement,"UPDATE PS_Z_TREND_NOW_TBL a 
  SET STATUS = ( CASE WHEN COUNT(SEC.IS_AW_AUTH_NAME)  > 0 then 'M'
                 ELSE null END )
FROM PS_IS_AW_SECURITY sec 
WHERE sec.IS_AW_AUTH_NAME LIKE '%Manager%'
"
18726,Mysql: Look for specific letter in comma separated list,"select * from TableName where FIND_IN_SET(""c"", column)
"
13894,How can I write a query that returns a row for every distinct value in one column and returns an arbitrary value from another column?,"Select [name], min([GUID]) as mGuid
FROM tableLikeThis
Group by [Name]
"
8270,SQL Conditional JOIN column,"INNER JOIN
exchange_rate c1
ON c1.date = coalesce(j.offer_date, j.accepted_date, j.start_date, j.reported_date)
"
26698,How do I specify that values in a column must already exist in another table?,"CREATE TABLE t1 (
    id integer PRIMARY KEY,
    txt character varying(30));

CREATE TABLE t2 (
    id integer PRIMARY KEY,
    t1_id integer,
    FOREIGN KEY (t1_id) REFERENCES t1(id));

CREATE VIEW t2ANDt1
AS
   SELECT 
     id,
     t1_id,
     t1.txt
   FROM t2
   INNER JOIN t1 ON t2.t1_id = t1.id
"
2793,SQL Selecting average of rating from another table,"SELECT l.AnimeID, 
       l.Name, 
       l.AnimeImage, 
       l.Synopsis, 
       l.Type, 
       l.Episodes, 
       l.Genres, 
       (SELECT ISNULL(AVG(Rating), 0) Rating
          FROM Anime_Reviews 
         WHERE AnimeID = l.AnimeID)
  FROM Anime_List l
"
34448,SQL foreach loop,"insert SiteCrawl
(
    Site_ID
)
select
 s.Site_ID
from Site as s
where s.Site_ID not in (select Site_ID from SiteCrawl)
"
28984,T-SQL Get File Extension Name from a Column,"SELECT CASE 
         WHEN filepath LIKE '%.%' THEN RIGHT(filepath, Len(filepath) - 
                                                       Charindex('.', filepath)) 
         ELSE filepath 
       END FilePath 
FROM   tbl1 
"
19332,Sort by date + pull up by boolean,"select * from table_name 
  order by 
        date desc, 
        case when new='true' then 1 else 0 end desc
"
3882,SQL: Key-Value: values in columns?,"select 
  key
, max( case value-name when 'color' then value else NULL end)      as color
, max( case value-name when 'heght' then value else NULL end)      as height
, max( case value-name when 'whatever' then value else NULL end)   as whatever
from 
  table
group by key
"
24600,Adding and subtracting sum columns in mysql queries,"HAVING op.stock+recd_total-issue_qty=0
"
5211,Fetching data from two tables matching a criteria,"SELECT  a.Name, b.IncomeGroupName
FROM    Person a
        INNER JOIN IncomeGroups b
            ON a.income BETWEEN b.minIncome AND b.maxIncome
"
21239,SQL sales report by calendar week,"SELECT o.date_purchased, CONCAT(YEAR(o.date_purchased), LPAD(WEEK(o.date_purchased), 2, '0')) as weekyear, op.products_id, SUM( op.products_quantity )
FROM orders_products op
LEFT JOIN orders o ON op.orders_id = o.orders_id
WHERE op.products_id = 331
GROUP BY weekyear
ORDER BY weekyear
"
4888,MySQL query a query and return a count,"SELECT   HOSTS.*, COUNT(gid)
FROM     HOSTS LEFT JOIN GUESTS USING (hid)
GROUP BY hid
"
4883,How to count fields on WHERE Clause,"Select t1.instanci From table1 t1 inner join table2 t2 on t1.table1id=t2.table2id
Group by t2.table2id Having count(t2.table2id)<2
"
35703,sql update column 2 with column 1 data,"UPDATE wp_posts
SET post_modified= post_date
"
5602,Need to fetch Total Rows Count and Rows count based on Group by in single Query,";WITH x AS
(
  SELECT ProductID, total = COUNT(*) OVER()
  FROM dbo.REQUEST
)
SELECT 
  ProductID, 
  COUNT(*), 
  MAX(total), 
  1.0*COUNT(*)/MAX(total)
FROM x
GROUP BY ProductID;
"
8510,select group_concat vs group_concat on left join,"SELECT
    u.id AS user_id, GROUP_CONCAT(s.subscription_id) AS subscription_ids
FROM 
    users u
    LEFT JOIN subscriptions s ON s.user_id = u.id
GROUP BY
    u.id
LIMIT 10
"
23220,sql parent child table interview question,"select id,name,parentid
from table
where parentid = 1
union
select id,name,parentid
from table
where parentid in (select id
from table
where parentid = 1)
"
19855,SQL query - filter primary keys,"Select table1.A, table1.B, table2.C, Table3.D
from table1 T1
left outer join table2 on table1.A = table2.A
left outer join tabl3 on table1.B = table3.B
where not exists (select 1 from badTable where A = T1.A and B = T1.B)
"
21203,sequence duplicate table renumbering,"select 
    id, 
    time,
    row_number() over(partition by id order by time) sequence,
    (case when (lag(id) over (order by id, time)) = id
         then time - (lag(time) over (order by id, time))
         else 0
    end) diff
from mytable t1
order by id, time
"
9552,Performance of Local PL/SQL Array Vs SQL Call,"select horoscope 
from horoscopeTable 
where (select get_birthdayFromID(employeeID) 
       from employeeTbl 
       where t.rownum = 1) between l_horoscope.fromDate and l_horoscope.toDate;
"
6080,SQL - select top 10 rows with the highest number (counted)," SELECT TOP 10 
      playerID, 
      SUM([number]) as goals,
      [league],
      [yearID],
      SUM([YellowCard]) as YellowCards,
      SUM([RedCard]) as RedCards,
  FROM [ms4033].[dbo].[Shooter]
  WHERE yearID=28 AND league=4
  GROUP BY playerID, league, yearID
  ORDER BY goals DESC
"
15552,Am I using update correctly?,"update WebCatalog.Published.DemoTracking
set Purchased = 1
where Purchased = 0 and RCompanyLink in (select Link as RCompanyLink from WebCatalog.Published.RCompany where RC.Expiration >= GETDATE() and RC.DemoLicense = 0)
"
2104,Calculations in a SQL query,"SELECT EmpNo, Ename, Job, Sal,
       Comm,
       Sal * 25 / 100 AS [house rent],
       Sal * 15 / 100 AS [medical allowance], 
       Sal * 10 / 100 AS [transport allowance],
       Sal + Comm + (Sal  * (25 + 15 + 10) / 100) AS Net
FROM Emp
"
32950,Get all rows apart from first and last,"SELECT * FROM waypoint 
WHERE ID NOT IN(
    (SELECT MIN(ID) FROM waypoint WHERE booking_id=""1""), 
    (SELECT MAX(ID) FROM waypoint WHERE booking_id=""1"")
  )
AND booking_id=""1"";
"
21320,Use each row in one table by joining it to another table,"SELECT 
    * 
FROM 
(
    SELECT 
        TOP 10 ROW_NUMBER() OVER(ORDER BY EmployeeId) AS join_id,* 
    FROM 
        HumanResources.Employee
) t1
INNER JOIN
(
    SELECT 
        TOP 10 ROW_NUMBER() OVER(ORDER BY DepartmentId) AS join_id,* 
    FROM 
        HumanResources.Department
) t2 ON t1.join_id = t2.join_id
"
15550,Dynamic WHERE clauses in SQL Query,"select * from locations 
where region=1 
or (region=2 and @checkRegion2=1)
"
35989,How to Have an empty row if query result couldn't find anything with one assigned value under one column?,"
select b.client_name,
       sum(a.credit_used) total_usage,
       sum(a.debit) total_amount,
       b.nickname
  from MyTable a
       right outer join
       (select 123 account_id, 'John' client_name, 'J' nickname union all
        select 234, 'Doe','D') b
       on
       (a.account = b.account_id)
 where a.year = 2015
 group by b.client_name, b.nickname
"
25299,How join 2 SQL queries: SELECT from table and DELETE from another?,"DELETE FROM rent WHERE name IN (
    SELECT name FROM `pstone_cuboids` 
    WHERE `last_used` >= UNIX_TIMESTAMP('2012-09-04')
)
"
31719,Reseed identity column in SQL Compact,"ALTER TABLE [MyTable] ALTER COLUMN [Id] IDENTITY (1,1)
"
25785,Find most frequent record in WHOLE table,"SELECT val, COUNT(*) ttl FROM
(
SELECT date, 'A' type, a val FROM my_table
UNION ALL
SELECT date, 'B', b val FROM my_table
UNION ALL
SELECT date, 'C', c val FROM my_table
UNION ALL
SELECT date, 'D', d val FROM my_table
UNION ALL
SELECT date, 'E', e val FROM my_table
UNION ALL
SELECT date, 'F', f val FROM my_table
) x
GROUP BY val ORDER BY ttl DESC LIMIT 1;
"
27876,get list of available servers in SQL server group,"osql -L
"
39463,Where Clause in SQL QUERY,"select * from  table
where
    (@Sample='1' and table.column1 = '500') or
    (@Sample='0' and table.column1 = '600') or
    (@Sample not in ('0','1') and COALESCE(table.column1,'') <> '500')
"
981,Remove distinct records from sql query output,"with cte as (
      select sb.case, sb.Trace, sb.Amount, sp.edge, sp.UserId,
             count(*) over (partition by sp.edge) as cnt
      from Budget sb join
           Sap sp 
           on sb.Trace = sp.Trace
      where sb.Trace in (select Trace from Sap where sb.UserId in ('R5', 'HB'))
     )
select cte.*
from cte
where cnt > 1
order by edge desc;
"
11710,Possible to call Oracle FUNCTION from .Net using Enterprise Library?,"Public Function GetNextJobNumber() As Object
    Dim db As Database = DatabaseFactory.CreateDatabase()
    Using cmd As DbCommand = db.GetStoredProcCommand(""CORPHIER_PKG.get_job_no"")
        db.AddParameter(cmd, ""retval"", DbType.Int32, 0, ParameterDirection.ReturnValue, True, 0, 0, String.Empty, DataRowVersion.Current, Convert.DBNull)
        db.ExecuteNonQuery(cmd)
        Return db.GetParameterValue(cmd, ""retval"")
    End Using
End Function
"
1334,"SQL: Sort by priority, but put 0 last","order by case priority when 0 then 2 else 1 end, priority
"
29068,Use a second ORDER by in MySQL query,"select t.*
from (<your query here>) t
order by expiry_date desc
"
24229,Counting twice within one query,"SELECT Department,
   COUNT(DISTINCT ID) AS total, 
   COUNT(DISTINCT CASE WHEN course LIKE 'AS%' THEN id END) Total_AS 
FROM schedule 
GROUP BY Department 
ORDER BY Department ASC 
"
7596,"Assign variable value within select, among other columns",";WITH limtis AS
(
   SELECT Limit, ClientId
   From tClient 
   Where tClient.clientId = tbl.ClientId
)
select ...
from batch
INNER JOIN Limtis On ...
WHERE ...
"
2187,MySQL - Reserving ID's before the initial auto_increment value,"
  id    username  

    1   something 
  999   something 
 1000   new value 

"
32423,SQL NOT IN (Do not know anyone who smokes),"SELECT p.name 
FROM Persons p
WHERE NOT EXISTS (                -- there does not exist
   SELECT * FROM Knows k          -- a person I know
   JOIN smokes s ON s.id = k.b_id -- who smokes
   WHERE k.A_id = p.id
   );
"
8326,cakephp url not retrieving data,"debug($fields);
"
8412,Composite foreign key in SQL Server,"create table Publisher
(
    PublisherId int not null primary key clustered,
    PublisherName varchar(100) not null,
    IsInternal bit not null
)
go
"
3916,SQL command to concatenate several rows into one cell?,"SELECT foo, GROUP_CONCAT(DISTINCT bar ORDER BY bar) AS bars
FROM foo_table
LEFT JOIN bar_table ON bar_table.foo_id = foo_table.foo_id
"
17909,Ormlite OR key in query,"Where<Account, String> where = queryBuilder.where();
where.or(
      where.and(
      where.eq(Account.NAME_FIELD_NAME, ""foo""),
      where.eq(Account.PASSWORD_FIELD_NAME, ""_secret"")),
where.and(
      where.eq(Account.NAME_FIELD_NAME, ""bar""),
      where.eq(Account.PASSWORD_FIELD_NAME, ""qwerty"")));
"
2844,Oracle sql order by not working as expected?,"order by trunc(MODIFIED_DATE) desc, CITY asc
"
22323,regular expression in oracle for including number and period,"     REGEXP_REPLACE('your text 12.133', '[^0-9\.]','')
"
26076,Order Results By Occurrence,"SELECT Tag.Title 
FROM `Tag` t
INNER JOIN BookmarkTag b ON (t.tagid = b.tagid)
WHERE B.BookmarkID = 1
GROUP BY t.tagid
ORDER BY count(*) DESC
"
23634,sql select rows with time range,"select * 
from yourtable 
where '11:00' between ""begin"" and ""end""
"
13207,MySQL Query to return zero against attribute if not present on particular day,"select d.dte, r.category_rating, count(f.modified_date)
from (select distinct date(modifed_date) as dte from fms_process_feedback) d cross join
     (select distinct category_rating from fms_process_feedback) r left join
     fms_process_feedback pf
     on date(pf.modified_date) = d.dte and
        pf.category_rating = r.category_rating
group by d.dte, r.category_rating;
"
27665,Shorten and compact this small SQL snippet (Count and most recent date),"Select max(datecreated) as [ViewedLast], COUNT(*) AS ViewCount
FROM UserViewHistory uvh1
WHERE (UserID = @UserID) AND (ViewedByUserID = @RequestingUserID)
"
37547,i18n database tables get value of a field by culture,"select tp.id, NVL( t.description, tp.description)
from task_priority tp 
  left outer join task_priority_i18n t 
    on t.id = tp.id 
    and t.culture = :culture
"
38729,Multiple date differences,"SELECT [staffname], DATEDIFF(""d"", min([date]), GETDATE()) as [Days Sick]
FROM sicknesslog
WHERE [Start/Return] != 0
GROUP BY [staffname]
"
22168,How to subtract result of 2 queries grouped by a field,"SELECT year,
       SUM(CASE WHEN type = 'in' THEN amount ELSE 0 END) AS sum_in,
       SUM(CASE WHEN type = 'out' THEN amount ELSE 0 END) AS sum_out,
       SUM(CASE WHEN type = 'in' THEN amount ELSE -amount END) AS in_out
    FROM table
    GROUP BY year;
"
17727,select record in one table that are not in another with a pattern match,"select kywd
from from_client
where not exists (
    select 1
    from from_me
    where position(from_client.kywd, kywd) > 0
)
"
34644,INNER JOIN Query three tables,"SELECT m.member_first_name, cr.c_id 
FROM classregistration cr
  INNER JOIN clases c ON cr.c_id = c.class_id
  INNER JOIN members m ON m.member_id = cr.m_id
WHERE cr.c_id = 1
"
36145,Join with DateTime and Latest Value from another Table,"SELECT  s.id,
        s.name,
        r.value,
        r.timestamp

FROM    station as s
        INNER JOIN reading as r
        on s.id = r.station_id

WHERE   r.timestamp = (

    SELECT max(timestamp)
    FROM reading
    where reading.station_id = s.station_id

)
"
39447,Which SQL clause should be used?,"select
    serviceno,
    (select username
       from usernames
      where services.user1 = usernames.code) as user1,
    (select username
       from usernames
      where services.user2 = usernames.code) as user2,
    (select username
       from usernames
      where services.user3 = usernames.code) as user3
from
    services
"
18035,SQL filter from many-to-many relationship,"select 
    Location_ID 
from CategoryLocations
where Category_ID in (2,3)
group by Location_ID
having COUNT(distinct Category_ID) = 2  -- this 2 is the number of items in the IN list above
"
13856,Hive to Hive ETL,"select a.key,b.lookupvalue
table a join lookuptable b
where a.key=b.lookupKey
"
24590,Strange behaviour of JOIN,"create index idx2 on rel_pl_es( espid,polid);
"
22063,How to design a message/comment table in MySQL?,"create table comments (
comment_id int (PK),
parent_id int,
user_id_1 int,
user_id_2 int,
comment text,
created datetime
);
"
575,How to query against a large list of words with an IN clause,"SELECT x, y
FROM Table1
WHERE 
   x IN (SELECT word FROM word_table) OR
   y IN (SELECT word FROM word_table)
"
34044,Reading a particular line by line number in a very large file,"use Config qw( %Config );
my $off_t = $Config{lseeksize} > $Config{ivsize} ? 'F' : 'j';

...
print $index_file pack($off_t, $offset);
...
"
21996,How to grant execute permissions to the stored procedures in a specific schema?,"CREATE ROLE db_executor
GRANT EXECUTE ON SCHEMA::schema_name TO db_executor
exec sp_addrolemember 'db_executor', 'Username'
"
37875,Mysql query joining data from several tables,"SELECT 
    DISTINCT(s.stop_id),
    s.stop_name,
    r.route_short_name
FROM stops s 
     INNER JOIN stop_times st ON st.stop_id = s.stop_id
     INNER JOIN trips t ON t.trip_id = st.trip_id
     INNER JOIN routes r ON r.route_id=t.route_id 
WHERE r.route_short_name='42'
GROUP BY s.stop_id;
"
36378,sqlite3 table with limited max lines (by choice) efficiency,"[Ring Pointer]
[Time Stamp][Latitude][Longitude]
[Time Stamp][Latitude][Longitude]
...
[Time Stamp][Latitude][Longitude]
"
5121,Search by LIKE not working in database vb.net," Private Sub BTN_Search_Click(sender As Object, e As EventArgs) Handles BTN_Search.Click
      'If txtbox is blank then show all records, else do the search by first name.
      If TBX_Search.Text = """" Then
           DoctorsDataGridView.DataSource = Me.RecordsDataSet.Doctors.Select(""FirstName LIKE '%'"")
      Else
           DoctorsDataGridView.DataSource = Me.RecordsDataSet.Doctors.Select(""FirstName LIKE '%"" & TBX_Search.Text & ""%'"")
      End If
 End Sub
"
22586,Date format in HTML cfgrid or SQL date format,"<cfgridcolumn mask=""m/d/Y"" type=""date"" ... >  
"
22170,how to replace multiple strings together in Oracle,"SET mycol = replace( replace(mycol, '{1}', 'myoneval'), '{2}', mytwoval)
"
3275,Inserting a new column into SQL,"SELECT name, 
  description, 
  project,
  CostCategoryId, 
  right(CostCategoryId,14) as CostBreak 
FROM dbo.GRAUD_ProjectsByCostCategory 
"
10275,Fullcalendar SQL to get events that start before the view starts and end after the view ends,"$query = $conn->prepare('SELECT * FROM calendar WHERE start < :end AND :start < end ORDER BY start ASC');
$query->bindValue(':start', $_POST['start']);
$query->bindValue(':end', $_POST['end']);
$query->execute();
"
2021,Joining SQL tables on the column that has a value,"select c.CollectionID, isnull(d.MovieId, s.MovieId) MovieID
from Collection c
left join Director d on d.Director=c.DirectorId
left join Studio s on s.Studio=c.StudioId
"
12558,Is there a BEFORE SELECT trigger in pl/sql?,"CREATE OR REPLACE VIEW customer_v AS
SELECT c.*, 
       CASE WHEN SYSDATE > add_months(c.start_date, 12) 
          THEN 'FALSE' 
          ELSE 'TRUE' 
       END is_member
  FROM customer c
"
21865,Select rows with Max Value grouped by two columns,"select t1.* from attachments t1
left join attachments t2
on t1.entity_id = t2.entity_id and t1.group_id = t2.group_id and
   t1.version_number < t2.version_number
where t2.version_number is null
"
6780,want to insert duplicate data in mysql table with new relations id's,"INSERT INTO mytable
(tag_id, w_id)
SELECT 28, w_id
FROM   mytable
WHERE  tag_id = 25
"
1978,How to Load CSV file into Apex 5 for particular columns?,"update your_table_name
set 
x=20
where x is null;
"
2263,Oracle Query - Selecting records using column data from first table,"select *
from table1 as t1
where dbms_xmlgen.getxmltype('select * from ' || 
                             t1.table2name ||
                             ' where datetocheck > add_months(sysdate, -6)
').extract('//text()').getstringval() is not null
"
31069,SQL server Last Inserted ID,"DECLARE @ID BIGINT

INSERT INTO dbo.TABLE_ID (Table_NAME) 
SELECT 'Table_Products'

SELECT @ID = SCOPE_IDENTITY()

INSERT INTO dbo.Table_Products (ID, Product_Name)
SELECT @ID, 'SomeProduct'
"
36558,Remove duplicates with a criteria,"select id, website
from table t
where website is not null;
"
28725,Remove last char if it's a specific character,"UPDATE table 
SET field = SUBSTRING(field, 1, CHAR_LENGTH(field) - 1) 
WHERE field LIKE '%+'
"
19101,How can I limit the results extracted by a query in Acces?,"SELECT TOP 1 t_Campioni_CAMPIONE, t_Campioni.[DATA ARRIVO], t_Campioni.PRODUTTORE, t_Campioni.CodF, t_Fornitori.[Nome Fornitore]
FROM t_Campioni INNER JOIN t_Fornitori ON t_Campioni.CodF = t_Fornitori.CodF
WHERE (((t_Campioni.CAMPIONE)=[Forms]![m_Campioni_modifica]![CAMPIONE]))
ORDER BY t_Campioni.[DATA ARRIVO] DESC;
"
33550,SQL Count to include zero values,"WITH CTE_Dates AS
(
    SELECT @START AS cte_date
    UNION ALL
    SELECT DATEADD(DAY, 1, cte_date)
    FROM CTE_Dates
    WHERE DATEADD(DAY, 1, cte_date) <= @END
)
SELECT
cte_date as TIME_STAMP,
ISNULL(COUNT(*), 0) AS counted_leads, 
FROM CTE_Dates
LEFT JOIN HL_Logs ON DATEADD(dd, 0, DATEDIFF(dd, 0, Time_Stamp)) = cte_date
WHERE Time_Stamp between @BEGIN and @END and ID_Location = @LOCATION
GROUP BY cte_date
"
10875,How to combine sum by same id in sql,"select id, sum(count)
from your_table
group by id
"
27048,(Oracle) Joining all_tab_columns and all_cons_columns,"SELECT atc.TABLE_NAME, 
       atc.DATA_TYPE, 
       count(distinct atc.column_name) cols, 
       count(distinct acc.constraint_name) cons
 FROM all_tab_columns atc 
INNER JOIN all_cons_columns acc 
   ON acc.COLUMN_NAME = atc.COLUMN_NAME AND 
      acc.TABLE_NAME = atc.TABLE_NAME
WHERE atc.OWNER = 'PARRANDEROS'
GROUP BY atc.DATA_TYPE, 
         atc.TABLE_NAME;
"
18224,Creating a SQLITE table with a fixed number of items,"CREATE TRIGGER batterystat_trigger AFTER INSERT ON batterystat 
BEGIN 
    DELETE FROM batterystat where _id NOT IN (SELECT _id from batterystat ORDER BY insertion_date DESC LIMIT 100)
END
"
5633,"Rename SQL Result file to Date format ""MMDDYYYY"" Automatically?","DECLARE @FileName varchar(20)
SELECT @FileName = 'Results' +  REPLACE(CONVERT(varchar(10),GETDATE(),101),'/','') + '.csv'
EXEC sp_send_dbmail @profile_name='default',
@recipients='dev@null.com',
@subject='test mail',
@query= 'SELECT * from testtable',
@attach_query_result_as_file=1,
@query_attachment_filename = @FileName ,
@query_result_separator = ','
"
12576,How to join two tables with two conditions?,"SELECT Count(c.CompanyID) 
FROM dbo.LLOAN As LL
LEFT JOIN dbo.Company As C 
ON (C.CountryID = LL.SourceID) 
AND (C.CompanyID = LL.LOAN_COMPANY) 
"
13041,Assistance with simple JOIN,"SELECT  con.EmpName AS consigneeName,
        ho.EmpName AS handOverName
FROM    consignation a
        INNER JOIN employee con
            ON a.ConSignee = con.empID
        INNER JOIN employee ho
            ON a.handoverby = ho.empID
"
20418,MySQL Having clause ignore id,"INSERT INTO (job_id) 
SELECT A.job_id
FROM jobs A 
WHERE NOT EXISTS (SELECT * 
         FROM review_jobs RJ
         WHERE A.job_id=RJ.job_id)
ORDER BY A.post_date
LIMIT 1;
"
19778,SQL Query - Select Statement,"SELECT DISTINCT Y.CusID, Y.Name, ISNULL (Y.S1, Y.S0) AS State
FROM
(
SELECT
X.CusID,
X.Name,
( SELECT MAX ( State ) FROM Address T WHERE T.PhyAddress = 1 AND T.CusID = X.CusID ) AS S1,
( SELECT MAX ( State ) FROM Address T WHERE T.PhyAddress = 0 AND T.CusID = X.CusID ) AS S0
FROM Address AS X
) AS Y
"
566,Change primary key (id) of a row in a table and shift the others downwards,"update mytable set sequence = -sequence where sequence = 15 -- hide the original 15
update mytable set sequence = sequence+1 where sequence >= 8
update mytable set sequence = 8 where sequence = -15
"
38326,Make SQL query that rename output entries,"select distinct SUBSTRING_INDEX(value,'_',1) from category;
"
14310,"how to save ""Total Rows Affected"" as an integer variable","DECLARE @TOTAL int

select @TOTAL = COUNT(DISTINCT TRADE_REP_ORIG)
from trade_archive
where error_code = 'r'

print @TOTAL
"
37818,Selecting numbers into array and then looping over them,"declare 
    type idArray is table of number index by pls_integer;
  theIdArray idArray;
begin

  select id bulk collect into theIdArray from table_name_here where report_id = 3449;
end;
"
28670,SQL - using SELECT Alias in WHERE,"SELECT *
FROM (
  SELECT
    LastName
    , Company
    , Status
    , CASE
        WHEN NickName IS NULL OR NickName = '' THEN FirstName
        ELSE NickName
      END AS FName
  FROM database
  WHERE Status = 'Active'
  AND  Company = '@Company'
) FNames
WHERE FName + ' ' + LastName LIKE '%@search%'
   OR LastName + ', ' + FName LIKE '%@search%'
"
8821,Unique Count (Print out 0) within Time Range,"SELECT
    ((Time - 1) / 2) + 1 as NewTime,
    COUNT(DISTINCT case when state = 'DC' then User_id end) as Count
FROM ... 
GROUP BY ((Time - 1) / 2) + 1
"
36147,factoring SQL code - MS SQL Server,"SELECT
    s.PACK AS software_packs_on_than_on_pc
FROM software s
INNER JOIN pc p ON
    s.TAGNUM = p.tagnum
GROUP BY s.PACK
HAVING COUNT(p.tagnum) > 1
"
39211,"postgres sql, date_trunc without extra zeroes","SELECT date_trunc(...)::date;
"
7993,SQL Server how to make a good structured database with different tables,"CREATE TABLE dbo.Salary
(
    fkEmployeeId int,
    Salary decimal,
    SalaryYear int,
    SalaryMonth int
);

CREATE INDEX IX_Salary_Employee_Date ON Salary(fkEmployeeId, SalaryYear, SalaryMonth)

DECLARE @Year int = 2016
DECLARE @Month int = 1

SELECT *
FROM Salary s
INNER JOIN MyEmployeeTable e on e.pkEmployeeId = s.fkEmployeeId
WHERE SalaryYear = @Year and SalaryMonth = @Month
"
1288,Create a linked server on a remote server ? SQL Server 2008,"EXEC [linked_server_name_for_0.0.0.2].master.dbo.sp_addlinkedserver @server = @name, @srvproduct=N'oracle', @provider=N'MSDAORA', @datasrc= @sursadate

EXEC [linked_server_name_for_0.0.0.2].master.dbo.sp_addlinkedsrvlogin @rmtsrvname=@nume,@useself=N'False',@locallogin=NULL,@rmtuser=@username,@rmtpassword=@password
"
31971,counting rows that have join matches,"select count(*) from tbl1 
where code in (select code1 from tbl2) 
"
31989,Simple Oracle JOIN (+) to HSQLDB,"SELECT * 
FROM DUAL D1
   left outer join DUAL D2 on D1.dummy = D2.dummy;
"
27476,"When using DbSet<T>.SqlQuery(), how to use named parameters?","var param = new ObjectParameter("":p0"", ""Bob"");
MyRepository.Users.SqlQuery(""Select * from Users where Name = :p0"", param);
"
28805,SQL - Compare Date in a same Columnn,"SELECT
  d.customer,
  CASE WHEN DATEDIFF(c.trans_date, d.trans_date) <= 30 THEN d.debit ELSE 0.0 END AS `0-30`,
  CASE WHEN DATEDIFF(c.trans_date, d.trans_date) > 30 AND DATEDIFF(c.trans_date, d.trans_date) <= 60 
       THEN d.debit ELSE 0.0 END AS `31-60`
FROM table AS d
INNER JOIN table AS c ON c.trans_code = d.trans_code and c.customer = d.customer
WHERE d.credit = 0.0 and c.debit = 0.0
"
962,How can I return a result set of records with duplicate columns in SQL,"select first_name, last_name, count(*) as DupeCount 
from table
group by first_name, last_name
having count(*) > 1
"
5689,SQL - include this record if these other records are included,"SELECT p.*, o.* 
FROM Policy p
    JOIN OtherPolicyFile o on o.PolicyId = p.PolicyId 
    LEFT JOIN OtherPolicyFile o9or10 
        on o9or10.PolicyId = p.PolicyId and o9or10.Status IN (9,10)
WHERE o.Status IN (9,10)
    OR o.Status = 11 AND o9or10.PolicyId is NOT NULL
GROUP BY <whatever key you need>
"
11350,How to create a file system directory in a SQL Server 2005 call/query,"declare @Path varchar(100)
set @Path = 'c:\CreatedFromSQL'
EXEC master.dbo.xp_create_subdir @Path
"
25879,Keeping track of web application usage in an SQL Database (Need Suggestions),"select 
  users.id, 
  (users.msg_limit - subq.msgs_used) as msgs_available
from users
inner join (select
              sum(msg_log.cnt) as msgs_used
              from msg_log
              where weekofyear(msg_log.date) = weekofyear(now())
                and msg_log.user = :user_id_param) as subq;
"
28823,Compute table name to join from row value,"SELECT products.product_id, type , price, cpu, ram, author, year_published
FROM products
LEFT JOIN products_computer ON products.product_id = products_computer.product_id
LEFT JOIN products_book ON products.product_id = products_book.product_id
ORDER BY price
"
8183,Select a subgroup of records by one distinct column,"SELECT a.ID, sub.Poss_Phone, CELL_FLAG
FROM TableA as a
INNER JOIN (SELECT ID, MAX(POSS_PHONE) as [Poss_Phone]
            FROM TableA
            GROUP BY ID) Sub
    ON Sub.ID = a.ID and SUB.Poss_Phone = A.Poss_Phone
"
27291,Alternative for MAX operator on bit fields,"MAX(CAST(Permisssion1 AS tinyint))
"
2946,Query between datetime columns,"SELECT id, description, 
CASE
   WHEN _dateUpdate IS NULL THEN _dateEntry
   WHEN _dateUpdate > _dateEntry THEN dateUpdate
   ELSE _dateEntry
END as date 
FROM mytable 
ORDER BY 
CASE
   WHEN _dateUpdate IS NULL THEN _dateEntry
   WHEN _dateUpdate > _dateEntry THEN dateUpdate
   ELSE _dateEntry
END desc
"
3745,Inserting a record into a table with a column declared with the SERIAL function,"INSERT INTO dataset (id, age, name, description)
VALUES (DEFAULT, 42, 'fred', 'desc');

INSERT INTO dataset (age, name, description)
VALUES (42, 'fred', 'desc');
"
19106,mysql update is so slow - is there any faster way to update data?,"UPDATE processed 
inner join DumpTable on processed.id = DumpTable.id
SET number1=DumpTable.value1 , number2=DumpTable.value2, timestamp=unix_timestamp()
"
27143,PostgreSQL: Casting two separate numeric values to a point,"INSERT INTO New_Table (my_id, my_point)
SELECT
    my_id,
    POINT(x, y)
FROM
    Old_Table
"
15579,mysql custom auto increment field with pre/suffix text,"CREATE TABLE my_table (
  prefix CHAR(2),
  number INT(5) ZEROFILL AUTO_INCREMENT,
  PRIMARY KEY (number)
);

INSERT INTO my_table (prefix) VALUES ('XX'), ('XX'), ('XX');

SELECT CONCAT(prefix, number) FROM my_table;
"
3676,sql duplicate removal from report,"Select MainAcc.Name, MainAcc.Date, MainAcc.Status, MainAcc.Type, 
       as subAcc where MainAcc.Id = subAcc.Id

From DimAccounts as MainAcc inner join
      (select id, ROW_NUMBER() OVER (PARTITION BY ID
                            ORDER BY Date DESC) rn
      from DimAccounts) as subAcc on subAcc.Id = MainAcc.Id and subAcc.rn = 1
"
938,"Analog of ""select level from dual connect by level < 10"" for Sybase?","SELECT row_num FROM sa_rowgenerator( 1, 255 );
"
19501,"Sum of revenue everyday, for last 30 days on each day","SELECT a.Date, SUM(b.Revenue)
FROM revenue_table a, revenue_table b
WHERE b.Date <= a.Date AND b.Date > a.Date - 30
GROUP BY a.Date;
"
39776,How to query a table in the database and copy it's data into one one?,"SELECT name, max(qty), min(price), avg(year), isbn
FROM book_book bb 
WHERE name = 'sample PR' and isbn = 'PH019BN'
GROUP BY name, isbn
"
33168,Populate Total Sales in Mysql,"SELECT Name AS Product, SUM(Quantity) AS QuantitySold, SUM(Quantity * Price) as TotalAmount
FROM sales
GROUP BY Name;
"
26101,Remote Database access,"ANDROID -> SERVER-SIDE-SERVICE -> DATABASE
DATABASE -> SERVER-SIDE-SERVICE -> ANDROID
"
18644,Connecting ASP.NET MVC2 App to SQL Server,"Data Source=Scott-PC;Initial Catalog=DatabseName;User Id=Scott;Password=password;
"
36426,How do I find departments with higher average salary than the average salary of the company?,"SELECT D.DEPARTMENT_NAME
FROM Employees E
INNER JOIN Departments D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
GROUP BY D.DEPARTMENT_NAME
HAVING AVG(CAST(E.Salary AS decimal)) > 
  (SELECT AVG(CAST(Salary AS decimal)) FROM Employees)
"
18891,Multiple join associations in hibernate,"BLOCK (BLOCK_ID primary key, CURRENT_SHAPE_ID foreign key references SHAPE.SHAPE_ID)
SHAPE (SHAPE_ID primary key, SHAPE_VERSION, BLOCK_ID foreign key references BLOCK.BLOCK_ID)
"
12160,How to format date in a SQL query?,"SQL = ""SELECT COUNT(Date)"" & vbcr & _
""FROM [Orders]"" & vbcr & _
""WHERE [Orders].[Date] BETWEEN #Format("" & StartDate & ""], 'MM/dd/yyyy')# AND #Format("" & EndDate & "",'MM/dd/yyyy')#""
"
14964,how to take dump of a table in parts and save it on different server?,"mysqldump --host=myserver -u backup mydb > test.sql
"
17343,"Return all rows from one table, and match with a subset of rows from another table?","select rp.rsrpID as ID, rp.rsrpName as Name, ri.rsrisesdID
  from resourcepool rp 
  left outer join resourcesintroduced ri on (ri.rsrirsrpID = rp.rsrpID and ri.rsrisesdID = 243)
"
24797,Ratio of matching rows per group,"select groupid ,
       cast(sum(flag) as float)/count(*) as ratio
from tableA
group by groupid
"
19125,SQL - remove multiple entries by a non-unique id,"delete from t
where t.billid in (select billid from t where transaction = 'TestValue')
"
11639,"How to return a DECIMAL(4,0) in TEXT keeping the 0000 format?","RETURN(LPAD(_RESTRICTEDROUTE, 4, ""0""))
"
17765,Relational Database Design - Create an Entity Class for Payment Type?,"CREATE TABLE `SALE` (
`SALE_ID`  int(11) NOT NULL AUTO_INCREMENT ,
`SALE_TYPE`  enum('Cash','Card') CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL ,
`SALE_AMOUNT`  decimal(18,4) NULL DEFAULT NULL ,
`CUSTOMER_ID`  int(11) NULL DEFAULT NULL ,
PRIMARY KEY (`SALE_ID`)
)
ENGINE=InnoDB
DEFAULT CHARACTER SET=utf8 COLLATE=utf8_general_ci
AUTO_INCREMENT=1
ROW_FORMAT=COMPACT
;
"
12348,Return the total rows affected by SQL Transaction,"DECLARE @totalRows INT
SET @totalRows = 0
INSERT INTO TABLE_A VALUES(/*Some Values*/)
SET @totalRows =@totalRows + @@ROWCOUNT

INSERT INTO TABLE_B VALUES(/*Some Values*/)
SET @totalRows =@totalRows + @@ROWCOUNT

INSERT INTO TABLE_C VALUES(/*Some Values*/)
SET @totalRows =@totalRows + @@ROWCOUNT

Update Table Set Values A = A WHERE id = @id /* Some thing like that*/
SET @totalRows =@totalRows + @@ROWCOUNT

SELECT @totalRows As TotalRowsAffected
"
19929,No idea how to write complex SQL query,"SELECT f1.*
FROM Permissions p -- this is the many-to-many table
JOIN FileRevision f1
  ON (f1.file_id = p.file_id)
LEFT OUTER JOIN FileRevision f2 
  ON (f2.file_id = p.file_id AND f1.created_on < f2.created_on)
WHERE p.user_id = ? AND f2.file_id IS NULL;
"
8790,MySQL Nested Sets adding node above selected node,"LOCK TABLE `categories` WRITE;

SELECT @myLeft := `lft` FROM `categories`
WHERE `id` = '. $where .';

UPDATE `categories` SET `rght` = `rght` + 2 WHERE `rght` > @myLeft;
UPDATE `categories` SET `lft` = `lft` + 2 WHERE `lft` > @myLeft OR `lft` = @myLeft;

INSERT INTO `categories`(`name`, `lft`, `rght`) VALUES(""'. $name .'"", @myLeft, @myLeft + 1);

UNLOCK TABLES;
"
33906,Sqlite database retreival of multiple data,"Cursor cursor1 = myDB.query(""SimSerial"", null, null, null, null, null, null);

cursor1.moveToFirst();
while(!cursor1.isAfterLast()){
   cursor1.getString(....);
   cursor1.moveToNext();
}
"
11564,Oracle Installed Operating system,"
select dbms_utility.port_string from dual;
"
16417,Query to find if the rows in which a subset of larger set exists,"select a_id from table_A_B
where b_id in ('a','c')
group by a_id having count(distinct b_id) = 2
"
283,aggregate query without group by,"SELECT JNumber,
       (SELECT SUM(Quantity * Weight) / SUM(Quantitiy)
        FROM SPJ
        JOIN Part USING (PNumber)
        WHERE JNumber = Project.JNumber
       ) AS AvgParts
FROM Project
"
10623,MYSQL: select a set matching a condition generated by same set,"select t.*
from (select t.*, (@cume := @cume + value) as cume
      from table t cross join
           (select @cume := 0) vars
      order by id
     ) t
where cume < 40;
"
19832,Comma separated string into two column,"select max(case when id % 2 = 1 then value end) as value1,
       max(case when id % 2 = 0 then value end) as value2       
from (select id, value, (id-1)/2 as grp
      from dbo.fs_1_fn_split(@datap, ',') 
     ) t
group by grp
"
22070,count multiple columns with group by in one query,"SELECT 
     SUM(CASE WHEN column1 IS NOT NULL THEN 1 ELSE 0 END) AS column1_count
    ,SUM(CASE WHEN column2 IS NOT NULL THEN 1 ELSE 0 END) AS column2_count
    ,SUM(CASE WHEN column3 IS NOT NULL THEN 1 ELSE 0 END) AS column3_count
FROM table
"
23292,How to write this MySQL Query?,"select T1.Id,
       T1.Category,
       T1.Value,
       T1.Data
from YourTable as T1
  inner join (
               select Category,
                      min(Value) as Value
               from YourTable
               group by Category
             ) as T2
    on T1.Category = T2.Category and
       T1.Value = T2.Value
"
21830,MySQL - Search and replace table1.field's contents with contents of table2.otherfield,"update players, teams set players.team = teams.id where players.team = teams.name
"
30894,returning table.column in a SQL select statement,"SELECT deal.deal_id ""deal.deal_id""
FROM deal 
WHERE deal.deal_id= '1';
"
9372,SQL self-referencing query. JOIN,"SELECT 
    u.unit_code, 
    u1.name + ' is a prerequisite of ' + u2.name AS unit_prerequisite 
FROM 
    units AS u1
    inner join units u2 on u2.RefId = u1.RefId 
"
34026,How do I check if a directory exists using SQL Server?," CREATE TABLE ResultSet (Directory varchar(200))

 INSERT INTO ResultSet
 EXEC master.dbo.xp_subdirs 'c:\'

 Select * FROM ResultSet where Directory = 'testing'
"
32503,sql SELECT IN with like,"select distinct s.* 
from salary s
join employee e on s.employeename like '%' + e.name + '%'
"
20883,How to find the default location in which Oracle DBF files are created?,"select value from v$parameter where name = 'db_create_file_dest'
"
39794,Using One Field Of table Derived SampleID and Number,"SELECT DISTINCT substring( substring(sampleid,1,charindex(' - ',sampleiD)) ,1,charindex('X',sampleid)-1) AS SampleID,
substring(sampleid,charindex('X',sampleid)+1,3) AS Number
FROM ROWDATA WHERE SampleID LIKE '%X%'
"
31460,MySQL CurDate() format to use MySQL EVENT for deleting (cleaning table) data after a day?,"CREATE EVENT delete_registration_data
ON SCHEDULE EVERY 1 DAY
DO
DELETE FROM `registered` where date(time) < DATE_SUB(CurDate(), INTERVAL 1 DAY);
"
29684,how do I make a table that is creating itself from another table in SQL Server,"Insert into tRestituiri (DataRestituire,CodCD , CodCV,CodAB)
SELECT DataScadenta,CodCD , CodCV,CodAB FROM tImprumuturi WHERE DataScadenta>GETDATE()-60
"
25419,How can I put validations on a SQL table column?,"CREATE TABLE MyTable
(
 Id INTEGER NOT NULL IDENTITY, 
 Name VARCHAR(20) NOT NULL UNIQUE, -- presumably a candidate key
 Number CHAR(10) NOT NULL
    CHECK (Number LIKE '4[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]')
)
"
33391,A nicer way to write a CHECK CONSTRAINT that checks that exactly one value is not null,"ALTER TABLE [dbo].[MyTable]  WITH CHECK 
ADD CONSTRAINT [CK_ReportTemplateAttributes] CHECK  
(3 = ISNULL([Col1] - [Col1],1) + 
     ISNULL([Col2] - [Col2],1) + 
     ISNULL([Col3] - [Col3],1) + 
     ISNULL([Col4] - [Col4],1)) ;
"
4594,How to update row with the contents of that specific row + new data,"UPDATE table SET column = REPLACE(column, 'g.', 'gatan') WHERE ...
"
2447,SQL Server 2008 select top 100 defined by a variable,"SELECT top (@top)
"
30028,Splitting numbers and letters in SQL Server 2005 table,"SELECT SUBSTRING(YourCol, 0, P),
       SUBSTRING(YourCol, P, 8000)
FROM   YourTable
       CROSS APPLY(SELECT PATINDEX('%[^0-9]%', YourCol + 'A')) Split(P) 
"
23321,How should my query be?,"SELECT
    [date]
    SUM(CASE WHEN tbl.flag=0 THEN 1 ELSE 0 END) AS flag0,
    SUM(CASE WHEN tbl.flag=1 THEN 1 ELSE 0 END) AS flag1
FROM
    tbl
GROUP BY
    tbl.[date]
"
37176,Logging SELECT statements in PostgreSQL 8.4,"log_statement = 'all'                   # none, ddl, mod, all
"
6680,Optimize sql update,"update t
set EndTimeKey = DATE_NO
from TableToUpdate t
Join Dates D on t.EndTime = d.DATE
where EndTimeKey <> DATE_NO
"
38088,Concatenate values when greater than 0,"select
  Case When Video > 0     Then Video +     ' Video|'     else '' end +
  Case When Internet  > 0 Then Internet  + ' Internet|'  else '' end +
  Case When Phone > 0     Then Phone +     ' Phone|'     else '' end +
  Case When Security > 0  Then Security +  ' Security|'  else '' end +
  Case When Basic > 0     Then Basic +     ' Basic|'     else '' end +
from source
"
18251,How can one iterate over stored procedure results from within another stored procedure....without cursors?,"CREATE TABLE #t (uniqueid int)
INSERT INTO #t EXEC p_YourStoredProc

UPDATE TargetTable 
SET a.FlagColumn = 1
FROM TargetTable a JOIN #t b 
    ON a.uniqueid = b.uniqueid

DROP TABLE #t
"
18668,SQL Join - Calculate weighted students grades based on grade type,"SELECT S.stu_fname, S.stu_lname, GT.grade_type_name, 
(sum(SG.grade_earned)/sum(G.grade_possible) * GT.grade_weight) AS Calculated Grade 
FROM Student S
    INNER JOIN StudentGrade SG ON SG.stu_id = S.stu_id
    INNER JOIN Grade G ON SG.grade_id = G.grade_id
    INNER JOIN GradeType GT ON G.grade_type = GT.grade_type
GROUP BY S.stu_fname, S.stu_lname, GT.grade_type_name;
"
10312,Reverse aggregation inside of common table expression,"WITH RECURSIVE cte AS (
   SELECT id, parent_id, name, NULL::JSON AS children
   FROM   people p
   WHERE  NOT EXISTS (  -- only leaf nodes; see link below
      SELECT 1 FROM people
      WHERE  parent_id = p.id
      )
   UNION ALL
   SELECT p.id, p.parent_id, p.name, row_to_json(c) AS children
   FROM   cte c
   JOIN   people p ON p.id = c.parent_id
   )
SELECT id, name, json_agg(children) AS children
FROM   cte
GROUP  BY 1, 2;
"
26542,"Find the Friday that a particular date is ""closest"" to in T-Sql","SET NOCOUNT ON
SET DATEFIRST 3

Declare @DateValue DateTime

SET @DateValue = '1/1/2010'

While @DateValue < '2/1/2011'
BEGIN
    PRINT DateAdd (Day, 3 - DatePart (dw, @DateValue), @DateValue)
    SET @DateValue = @DateValue + 1
END
"
33534,Select by Convert data to show them,"select * from mp_log
where trunc(START_TIME) = to_timestamp( '20120224', 'yyyymmdd')
"
9259,How do I get a trailing week count for every day over a given period (on Postgres)?,"select dd.dte,
       sum(cnt) over (order by dd.dte rows between 6 preceding and current date) as avg_7daymoving
from generate_series('2015-01-01'::timestamp, '2015-04-01'::timestamp, '1 day'::interval) dd(dte) left join
     (select date_trunc('day', occurred) as dte, count(*) as cnt
      from events e
      group by date_trunc('day', occurred)
     ) e
     on e.dte = dd.dte
"
5175,"get last time activity with sum, group and subquery","  select EMPLOYEE_ID, NAME, sum(PIECES) PIECES, MAX(SL_TIME)
  from DB_SCHEMA.TBL_SALES   
  group by EMPLOYEE_ID, NAME
  having sum(PIECES) > 100
"
945,How to get the MAX result even if the MAX is different,"SELECT a.Employee_ID, a.Accept_International_Assignment, a.Plan_Year
FROM  dbo.v_sc08_CD_Employee_Availabilities a
INNER JOIN (SELECT Employee_ID, MAX(Plan_Year) maxPlanYear
            from dbo.v_sc08_CD_Employee_Availabilities
            GROUP BY Employee_ID) m
   ON a.Plan_Year = m.maxPlanYear AND a.Employee_ID = m.Employee_ID
"
14733,SQL to group on maximum of two columns,"select * from (
    select p.*, g.schoolyear, g.term,
        row_number() over (partition by PupilID order by SchoolYear desc, Term desc) rn
    from pupils p
    join grades g on g.PupilID = p.PupilID
) t1 where rn = 1
"
22338,How to select top records in multiple columns in Microsoft Access or SQL?,"select *
from table_name
where column_x in (
    select top 100 column_x
    from table_name 
    order by column_x )
and column_y in (
    select top 100 column_y
    from table_name
    order by column_y );
"
35466,Number of times a record shows up : SQL Server,"select Numbers, count(*) as Count
from MyTable
group by Numbers
"
20126,"table with ""."" in its name","sqlQuery(dbhandle, ""SELECT * FROM [HelloWorld.40]"") 
"
39386,SQL find exact date after 1 year,"DATEADD (datepart , number , date )

SELECT DATEADD(YEAR, 1, CreatedDateTime) 
FROM dbo.YOURTABLE
"
19745,How to indirectly join two tables,"SELECT * 
FROM table1 t1
  JOIN table2 t2 ON t2.name LIKE '%'||t1.firstname||'%' 
                AND t2.name LIKE '%'||t1.lastname||'%'
"
13859,Is it possible to deny access to SQL Server from specific programs?,"CREATE TRIGGER application_limit_trigger
ON ALL SERVER WITH EXECUTE AS '...'
FOR LOGON
AS
BEGIN
IF EXISTS (SELECT *
   FROM sys.dm_exec_sessions
   WHERE session_id = @@SPID
   AND program_name IN (N'Bad Program', N'Worse Program', N'Unmentionable')
    ROLLBACK;
END;
"
29674,Merge data in two row into one,"SELECT ServerName, Country, contact = STUFF((SELECT '; ' 
    + ic.contact FROM dbo.Customer AS ic
  WHERE ic.ServerName = c.ServerName AND ic.Country = c.Country
  FOR XML PATH(''), TYPE).value('.','nvarchar(max)'), 1, 2, '')
FROM dbo.Customer AS c
GROUP BY ServerName, Country
ORDER BY ServerName;
"
12724,Alter NVARCHAR column from NULL to NOT NULL in sql server,"UPDATE AAElement 
SET RateValue = ''
WHERE RateValue IS NULL
GO
ALTER TABLE dbo.AAElement
ALTER COLUMN RateValue NVARCHAR(50) NOT NULL
"
16971,Best practice for designing user/roles/people in database,"user (id, email, username, password)
company (id, user_id, name, ...)
client (id, user_id, first_name, last_name, ...)
employee (id, user_id, first_name, last_name, start_date, end_date, ...)
"
18566,Regarding sql reporting,"SET PAGESIZE 0
"
5599,SQL query returning same value for both tables colums,"SELECT SUM(VisitsCount) + SUM(VotesCount) AS TOTAL,  SUM(VisitsCount) AS VISITS, SUM(VotesCount) AS VOTES
FROM (

  SELECT COUNT(id) AS VotesCount, 0 AS VisitsCount, 1 AS Gr
  FROM votes

  UNION 

  SELECT 0 AS VotesCount, COUNT(ID) AS VisitsCount, 1 AS Gr
  FROM visits

  ) t 

GROUP BY Gr
"
36603,Select values with duplicate max values sql,"select
   max(sales),
   max(date_) keep (dense_rank first order by sales desc),
   sum(sales),
   min(date_)
from
   table_
"
25254,Sorting in SQLite,"CREATE TABLE temp_table1 
AS SELECT * 
FROM table1 
ORDER BY column1;
"
32346,"How do I convert a database row into a struct, in Go?","func getUser(name string) (*User, error) {
    var u User
    // this calls sql.Open, etc.
    db := getConnection()
    // note the below syntax only works for postgres
    err := db.QueryRow(""SELECT * FROM users WHERE name = $1"", name).Scan(&u.Id, &u.Name, &u.Score)
    if err != nil {
        return &User{}, err
    } else {
        return &u, nil
    }
}
"
9816,Exclusive table (read) lock on Oracle 10g?,"LOCK TABLE whatever
/
"
24088,Updating database row for a group of people,"update tblCustomer 
set IsHappy = 1 
where country = 1 
  and firstname in ('ian', 'bob', 'sam', 'joe')
"
12795,Mysql: return true when all selected rows match a given criteria,"SELECT not exists (
  select *
  FROM order_rows O
  WHERE O.order_id = 'INSERT_ORDER_ID_HERE'
  AND O.ordered_quantity != O.shipped_quantity)
"
1134,How can I clean up this report using LISTAGG?,"select
*
from
(
SELECT doc_number, LISTAGG(field || '=' || text, '; ') 
WITHIN GROUP (ORDER BY field) OVER (PARTITION BY doc_number) as Bob
FROM record
) t1
group by
doc_number,
bob
"
8064,SQL Server 2005: How to join table rows only once,";WITH cte AS
(SELECT Id,
        RelationalId,
        year,
        row_number() 
        over (partition by RelationalId, year
              order by Id) as rn
FROM [YourTable] 
)
select t1.id as Id_2014,t2.id as Id_2015, t1.RelationalId
from cte as t1 left join cte as t2
on t1.RelationalId = t2.RelationalId
and t1.rn = t2.rn
and t2.year = 2015 
where t1.Year = 2014 
"
35744,Conditional aggregate with Group By clause," SELECT concat(id1,'-', id2) `key`, count(*) , 
 sum( case when category = 1 then 1 else 0 end) category1count , 
 sum( case when category = 2 then 1 else 0 end) category2count
 FROM table1 
 GROUP BY concat(id1,'-', id2)
"
8942,rewriting persian date in instead of normal Date format,"CultureInfo farsi = new CultureInfo(""fa-IR"");
farsi.DateTimeFormat.Calendar = new PersianCalendar(); 
DateTime date1 = new DateTime(1867, 1, 1);

Console.WriteLine(date1.ToString(farsi));
"
4757,SQL Sorting table based on two interchangeable fields,"SELECT *
FROM   tbl
ORDER  BY (GREATEST(source, recipient), LEAST(source, recipient), ""time"";
"
3411,SQL SELECT multiple columns into one,"SELECT Id, (Cast([Year] as varchar(4)) + ' ' + Manufacturer + ' ' + Model) AS MyColumn 
FROM   Tablename
"
6436,Oracle's dbms_metadata.get_ddl for object_type JOB,"select dbms_metadata.get_ddl('PROCOBJ', 'yourJobNameGoesHere') from dual;
"
19562,mysql query to count number of times each Id has been used,"SELECT UserId, COUNT(*)
FROM badges
GROUP BY UserId
ORDER BY COUNT(*) DESC
"
18887,How to write a query to get number of queries per minute in a database which is fed with the log files ,"select  convert(nvarchar(16), TimeLog, 120) requestTime,
        count(*)
from    LogData
group by convert(nvarchar(16), TimeLog, 120)`
"
11372,get result by category with count for each category,"SELECT Category AS 'Category/SubCategory', COUNT(*) AS 'Count'
FROM  Categories
GROUP BY Category

UNION

SELECT SubCategory AS 'Category/SubCategory', COUNT(*) AS 'Count'
FROM  Categories
GROUP BY SubCategory
"
9204,SQL query optimisation,"SELECT * FROM a WHERE (status = 'x' AND a_date < NOW()) OR (status = 'y')
ORDER BY status ASC, a_date ASC LIMIT 1;
"
107,How to split strings in SQL Server,"SELECT substring(data, 1, CHARINDEX(',',data)-1) col1,
substring(data, CHARINDEX(',',data)+1, LEN(data)) col2
FROM table
"
19260,"SQL Server 2005, wide indexes, computed columns, and sargable queries","Alter Table Add NameHash Hashbytes('SHA1', [Name])
"
22893,How do I select every row from a table based on a string containing the name of the table?,"SET @stat = CONCAT('SELECT * FROM ', @tab'); 

PREPARE stat1 FROM @stat; 
EXECUTE stat1; 
DEALLOCATE PREPARE stat1; 
"
19113,Sum on subqueries on SQL Server,"SELECT ID, col1, col2, [Total] = (col1 + col2)
FROM (
    SELECT Id,
    (SELECT COUNT(*) FROM table1 LEFT JOIN table2 on ...) as col1,
    (SELECT COUNT(*) FROM table3 LEFT JOIN table4 on ...) as col2
    FROM [TABLE]) T
"
24651,update data in table based on data in another table,"update table1 
set table1.dt = table2.dt2 
from table1 join (
       select id,max(dt2) as maxDT
       from table2
       group by id) as derivedTable2 on derivedTable2 .id = table1.id
"
6445,Retrieve records using SQL Query,"SELECT 
   *
FROM 
   undefined_table_name
GROUP BY 
   image_type 
ORDER BY
   image_type ASC;
"
33497,Return a unique row based on a single column,"select id, name, salary, department
from (select t.*,
             row_number() over (partition by department order by department) as seqnum
      from t
     ) t
where seqnum = 1
"
23541,Mysql Unique record 2 columns,"ALTER TABLE Persons
ADD CONSTRAINT pk_PersonID PRIMARY KEY (FirstName,LastName)
"
25594,Noob SQL Inserting and selecting in same query,"INSERT INTO Log 
  (ID, LogType, Status, Priority, LoggedTime, UserID, ProblemID) 
VALUES 
  (2, 'test', 'test', 3, '2012-03-14 10:30',  2, 1)
RETURNING *;
"
23828,select rows if all meets same criteria and only one meets a criteria,"select orderid,
       (case when min(status) = max(status) and min(status) in ('NEW', 'CLOSED')
             then min(status)
             when sum(case when status = 'PENDING' then 1 else 0 end) > 0
             then 'PENDING'
             else 'This case is not described in the question'
        end)
from t
group by orderid;
"
11454,I want to write a query to print sum of data for all TC into single table,"  SELECT TCName, sum(BS.BLDOS) as BLDOS, sum(BS.CollectedAmount) as CollectedAmount
  FROM [Customer] C INNER JOIN
       [dbo].[BillingStatus] BS
       ON BS.CustomerID = C.CustomerID INNER JOIN
       [dbo].[TCDetails] TC 
       ON TC.CustomerID = BS.CustomerID
  WHERE TCName in (Select distinct(TCName) FROM [dbo].[TCDetails])
  GROUP BY TCName;
"
27600,How to use subquery result as the column name of another query,"select item,
       item_type,
       ..
       decode(fore_column_name, 'foo', 1, 2) * 0.9 as finalforcast,
       decode(fore_column_name, 'foo', 1, 2) * 0.8 as newforcast
  from sales_data,
       (
          select fore_column_name
            from forecast_history 
           where ...
       ) inlineTable
"
21196,Mysql Auto increment goest 10 by 10,"SHOW VARIABLES LIKE 'auto_inc%';
"
36080,Basic SQL Query without using subquery,"SELECT  T.EmployeeID,
        COUNT(*) AS MinDays
FROM    YourTable T
        INNER JOIN
        (   SELECT  DailyDate, MIN([Sales#]) AS MinSales
            FROM    YourTable
            GROUP BY DailyDate
        ) T2
            ON T2.DailyDate = T.DailyDate
            AND T2.[MinSales] = T.[Sales#]
GROUP BY T.EmployeeID;
"
12030,Design Patterns: Should a factory update and delete too?,"EntityManager manager = entityManagerFactory.create();
MyEntity entity = manager.findById(someid);
entity.setName(""new name"");
manager.save(entity);
"
28817,Update all parent id's in a SQL mptt table,"UPDATE node 
SET parent_id=ss.id 
FROM (
    SELECT id, lft, rgt 
    FROM node ORDER BY lft DESC) ss 
WHERE ss.lft < node.lft AND ss.rgt > node.rgt;
"
9710,Loop through all schemas in Talend,"tFlowToIterate_1----(iterate)-----tOracleRow_1------(OnComponentOk)------tOracleInput_1
"
28210,build a formatted string in oracle,"select to_char (datecol, 'FMMM') from mytable;
"
22731,how to have a column count the number of times a BIT field is zero and another column counting the number of time it is one?,"SELECT
    part_id,
    COUNT(CASE WHEN construction = 1 THEN 1 END) OVER () AS CountConstructionIs1,
    COUNT(CASE WHEN destruction = 1 THEN 1 END) OVER () AS CountDestructionIs1
FROM
   [dbo].[PartsWork]
WHERE
    experiment_id = @experiment_id
    AND
    partition_id = @partition_id
"
6013,SQL REPLACE statement to replace some numbers not all,"update YourTable
set DepartmentId = left(DepartmentId, 4) + '9999' + right(DepartmentId, 4)
"
13977,Long to timestamp for historic data (pre-1900s),"select to_timestamp('1-JAN-1970 00:00:00', 'dd-mon-yyyy hh24:mi:ss') +
         numtodsinterval(val /(1000*60*60*24),'DAY' ) +
         numtodsinterval(
           ((val /(1000*60*60*24)) - (trunc(val /(1000*60*60*24))) ) * 60*60*24,'SECOND')
from (select -2177452812340 val from dual);
"
9751,How do you count the frequency of a word in a column?,"select count(*),substr(col,1,(instr(col,'.')-1) from tab group by  substr(col,1,(instr(col,'.')-1) order by 2;
"
35060,SQL Server Set Digit,"SELECT RIGHT('00000' + CAST(column_name AS VARCHAR(5)), 5) AS my_column FROM table_name
"
2307,MySQl creating Self joins,"select 
  a.id
  , b.id as id2
  , a.ccc
from table1 a
inner join table1 b on (b.span = a.rank)
"
26232,Assign a row a number from 1 to X then loop - In SQL,"select 
   id,
   (ROW_NUMBER() OVER(order by id) - 1) % 4 + 1 As nr 
from 
   tbl
"
19751,SQL Query to get only those rows with only 1 value in another colum,"SELECT  ProjectID
FROM    table t1
        INNER JOIN (
          SELECT  ProjectID
          FROM    table
          WHERE   state = 21
        ) t2 ON t2.ProjectID = t1.ProjectID
GROUP BY
        ProjectID
HAVING  COUNT(*) = 1        
"
6493,In SQL using Todays date get the week date (mon-sun),"CREATE FUNCTION dbo.WeekCommenceMondayDate(@MidWeekDate DateTime)
RETURNS DateTime AS
BEGIN
DECLARE @WeekCommence DateTime
    SET @WeekCommence = DateAdd(d, -((@@DATEFIRST + DatePart(dw, @MidWeekDate) -2) % 7), @MidWeekDate)
    RETURN @WeekCommence
END


declare @today datetime = '2010-12-04' 
declare @weekstartdate datetime

set  @weekstartdate = dbo.WeekCommenceMondayDate(@today)
select @weekstartdate as weekstartdate
select  DATEADD(DD, 6, @weekstartdate) as weekenddate
"
25552,inserting records using a transaction,"$user = new User();
$user->fill(Input::all());
try {
    DB::beginTransaction();
    $user->save();
    $profile = new Profile();
    $user->profile()->save($profile);
    DB::commit();
    return Response::json(array('message' => 'Your account has been created.'));
}
catch (QueryException $e) {
    DB::rollBack();
    return Redirect::to('url')->withInput()
            ->with('error', 'Error occurred. Try again or contact administrator');
}
"
13546,"MySQL ""For Each""","SELECT
    p.id,
    SUM(IF(s.correct, 1, 0)) AS correct_submissions,
    COUNT(s.id) AS total_submissions
FROM problems p
        LEFT JOIN submissions s ON p.id = s.problem_id
GROUP BY
    p.id
"
17901,how to regex match string escaped with sql style?,"'(?:[^']|'')*'|""(?:[^""]|"""")*""
"
7041,SSRS limit length of text but keep full words,"SELECT ID, SUBSTR(FIELD1,1, regexp_instr(FIELD1, '[ ]', 70)) FROM....
UNION
SELECT ID, SUBSTR(FIELD1, regexp_instr(FIELD1, '[ ]', 70)) FROM ...
"
33380,SQL and distinct,"SELECT MONTH(birthday), COUNT(*) AS BirthdayCount
FROM user
GROUP BY MONTH(birthday)
"
39497,Get top highscores AND scores 3 next and previous after you,"SELECT * 
FROM (
  SELECT u.id, u.score,
        @curRow := @curRow + 1 AS POSITION
  FROM    b_users u
  JOIN    (SELECT @curRow := 0) r
  ORDER BY u.score DESC , u.id ASC) origQuery
WHERE origQuery.position <= 10
   OR (origQuery.position >= (17 - 5) AND origQuery.position <= (17 + 5))
"
14597,How to loop through more than one values of select statement and perform some operations using those values in stored procedure?,"WHILE (SELECT COUNT(*) FROM SalaryHead WHERE Total IS NULL AND EmployeeID = @EmpID) > 0
BEGIN

  /*Calculate Salary Head */

END
"
13903,Conditions in SQL subqueries,"   SELECT CompanyName, COUNT(Orders.OrderID) Orders
   FROM Customers JOIN Orders ON Customers.CustomerID = Orders.CustomerID
   WHERE Country IN('Germany','Brazil') 
   GROUP BY CompanyName 
   HAVING COUNT(Orders.OrderID) >= 10
   ORDER BY Orders ASC;
"
38141,Insert multiple rows from two tables into one table,"INSERT INTO Table3
(ID,Version)
SELECT Id,Version
FROM Table1 CROSS JOIN Table2
"
24120,Cut string after first occurrence of a character,"SELECT split_part('first:last', ':', 1) AS first_part
"
15537,Select count of 0 from a table,"SELECT c.column_name + ' = 0 and '
  FROM information_schema.columns c
 WHERE c.table_name = 'table'
"
13340,join elements from three unrelated tables,"SELECT * FROM companies
JOIN sites ON sites.company = companies.id
JOIN domains ON domains.site = sites.id
WHERE 
    sites.is_supercharged = 1 AND sites.is_deleted = 0 AND 
    domains.is_primary = 1 AND domains.is_deleted = 0
"
23162,Oracle SQL Custom sorting,"select Status, Description
from Status
order by case when Status in (3,4,5) then 1 else 2 end, Status
"
9338,How to sql select a product with two status?,"SELECT ProductId 
FROM products
WHERE status IN (1, 2)
GROUP BY ProductId
HAVING COUNT(distinct status) = 2
"
12753,table with multiple IDs but seperate notes need sorting (Tried SQL code to make a union query),"SELECT TBL_1.[ID], TBL_1.info, TBL_2.info As Info2
FROM TBL_1 
LEFT JOIN Tbl_2 ON(Tbl_1.[ID] = Tbl_2.[ID])
"
16779,How to insert character in between a string in SQL server 2008,"DECLARE @String NVARCHAR(20) = '031613 05:39 AM'

SELECT STUFF(STUFF(@String,3,0,'/'),6,0,'/')
"
29688,Convert or cast varchar MM/DD/YYYY data into datetime MM/DD/YYYY,"DECLARE @s DATETIME, @e DATETIME;

SELECT @s = CONVERT(DATETIME, '03/13/2013', 101),
       @e = CONVERT(DATETIME, '03/26/2013', 101);

SELECT <cols>
FROM dbo.table_name
  WHERE datetime_column >= @s
  AND datetime_column < DATEADD(DAY, 1, @e);
"
16014,Add Decimal to data in table,"UPDATE TABLE 
   SET ColumnName = SUBSTRING ( ColumnName, 1, 3 ) + '.' 
                       + SUBSTRING ( ColumnName, 4, LEN ( ColumnName ) - 3 )
 WHERE LEN ( ColumnName ) > 3;
"
25035,How to design multiple child tables against a single parent table?,"Table master
- master_id
- created_by
- created_time
- notification_text

Table child1
- id
- master_id
- data1 (used to generate notification_text in master)

Table child2
- id
- master_id
- data21 (collectively used to generate notification_text in master)
- data22 (collectively used to generate notification_text in master)
- data23 (collectively used to generate notification_text in master)

...
"
721,"decompose source data into new, many-to-many schema","SELECT DISTINCT rxcui, [name] INTO drugwordsConsoJunction FROM words
"
32653,Select row from table where column value is subset of value passed in stored procedure,"BEGIN
    SELECT *
    FROM tableName
    WHERE @parameter LIKE concat('%', search_name, '%')
END
"
33930,How to call this stored procedure?,"DECLARE
    in_param  sales_type;
    out_param description_type;
BEGIN
    -- First set up in_param
    in_param := sales_type.someConstructor();
    -- Now make call
    getquote( in_param, out_param );
    -- out_param should now be populated
END;
/
"
19044,SQL For Loop query,"INSERT
INTO    mac
SELECT  DEVICES_ID_SEQ.nextval, mac, 'abc', 123
FROM    (
        SELECT  DISTINCT
                mac
        FROM    devices
        )
"
23675,SQL COUNT with WHERE clause,"SELECT COUNT(user_id), company.*
FROM `company` 
LEFT JOIN `company_owners`
ON company_owners.company_id = company.company_id 
WHERE EXISTS
(
    SELECT *
    FROM company_owners AS co2
    WHERE company_owners.company_id = co2.company_id
    AND co2.user_id = 3
)
GROUP BY company_id
"
35553,Fetching Columns of a multiple rows in one row,"SELECT *
FROM (
   SELECT attr_name, attr_value
   FROM   test
)
PIVOT
(  MIN(attr_value)
   FOR attr_name IN ( 'ABC','GHI','MNO' )
)
"
18981,SAS: Compute mean by grouping variable excluding observation,"proc sql;
    select t.*,
           (sumr - r) / (cnt - 1) as re,
           (sumi - i) / (cnt - 1) as ie
    from t left join
         (select cat, count(*) as cnt, sum(r) as sumr, sum(i) as sumi
          from t
          group by cat
          having count(*) > 1
         ) tt
         on t.cat = tt.cat;
"
37976,SQL like for like orders a year ago,"SELECT
  CustomerID,
  ThisYear = COUNT(CASE Year WHEN YEAR(GETDATE()) THEN 1 ELSE NULL END),
  LastYear = COUNT(CASE Year WHEN YEAR(GETDATE()) THEN NULL ELSE 1 END)
FROM data
WHERE Year >= YEAR(GETDATE()) - 1
  AND Month = MONTH(GETDATE())
GROUP BY
  CustomerID
"
32765,Index on which tablespace,"select tablespace_name
from all_indexes
where owner = 'MYSCHEMA'
and index_name = 'MYINDEX';
"
19155,SQL Unique Values Numbering Sequence for Pivot,"SELECT Q1.customer_name, Q1.order_date, Q1.price, 
       (
        SELECT COUNT(*) + 1
          FROM MyQuery AS Q2
         WHERE Q2.customer_name = Q1.customer_name
               AND Q2.order_date < Q1.order_date
       ) AS pivot_id
  FROM MyQuery AS Q1;
"
1007,"Transforming a 2 column SQL table into 3 columns, column 3 lagged on 2","select a.id, a.i, coalesce(min(b.i),'0') from
test a
left join test b on b.id=a.id and a.i<b.i
group by a.id,a.i
order by a.id, a.i
"
30286,"How to format a date to ""MM/dd""","SELECT CONVERT(VARCHAR(5), GETDATE(), 101)
"
37582,OrientDB how to get a result set of vertices and its edges in one query,"select expand($c)
let $a=(traverse both(),bothE() from (select from V where label=""project"")),
$b=(traverse bothE() from (select from V where label=""project"")),
$c=difference($a,$b)
"
33598,What does this query means?,"SELECT column1 FROM t1 WHERE EXISTS (SELECT * FROM t2);
"
3428,"sql-server, count rows where column matches string and id is not repeated","SELECT count(id), state
FROM table_name
WHERE id IN (SELECT id FROM table_name GROUP BY id having count(id) = 1) and state = 'Alabama'
GROUP BY state
"
31216,How to return the values that do not appear in both columns?,"SELECT title
 FROM movie m
 WHERE m.mid NOT IN (SELECT mid
                       FROM rating)
"
35715,SQL:selecting rows matching certain criteria in a specific field,"select project
from MyTable
group by project
having count(*) = sum(case when status = 'complete' then 1 else 0 end)
"
3188,How do I accumulate arrays into maps?,"SELECT cookie,
   union_vector_sum( keyword_map),
   union_vector_sum( map( fqdn, 1 ) ),
   collect_set( pixel)
FROM (
  SELECT cookie, fqdn, pixel,
         collect( keyword, 1 ) as keyword_map
  FROM T
  LATERAL VIEW explode( keywords ) k as keyword
  GROUP BY cookie, fqdn, pixel ) xk
GROUP BY cookie;
"
27156,SQL query doesnt bring out results when queried using date,"Select Submit_Dt From Siebel.S_Order_Dtl
where TRUNC(submit_dt) = TO_DATE('18-May-2012','dd-MON-yyyy')
"
13487,"many to many relation select where=""specific""","    select
    u.username,
    t.title,
    t.Thread,
    t.catagory
    from 
    post p
    join user u on u.username_id = p.user_id
    join Threads t on t.who_id = p.Threads_id
    where t.catagory = 'some specific category'
"
20567,SQL query to get average values over a list of time ranges,"SELECT AVG(case when dateColumn > startRange1 && dateColumn < endRange1 then column1 end) as range1Avg,
       AVG(case when dateColumn > startRange2 && dateColumn < endRange2 then column1 end) as range2Avg
FROM Table1 
"
30650,Add a row number to result set of a SQL query,"SELECT t.A, t.B, t.C, number = ROW_NUMBER() OVER (ORDER BY t.A)
  FROM dbo.tableZ AS t
  ORDER BY t.A;
"
15240,"Need MySQL query that gets orders from main table, then a count of individual items associated with it as well as total rows from another table","SELECT o.order_number, COUNT(DISTINCT i.item_id) AS SkuCnt, COUNT(*) AS LineCnt
FROM Orders o
INNER JOIN OrdersItems i ON o.order_number = i.order_number_id
GROUP BY o.order_number
"
16172,Is it a good practice to have last_update field in MySQL,"last_update=NOW()
"
36812,How to Extract Numeric Range from Text in SQL,"with cte as
(
    select 'p.G12_V14insR' as AA_SYNTAX from dual
)

select 
    REGEXP_SUBSTR(AA_SYNTAX,'p\.[[:alpha:]]+([[:digit:]]+)', 1, 1, NULL, 1) as Bottom 
    ,REGEXP_SUBSTR(AA_SYNTAX,'\_[[:alpha:]]+([[:digit:]]+)', 1, 1, NULL, 1) as Top 
from cte
"
16277,SQL Select from multiple tables where Name contains query,"SELECT Name, Description
    FROM TableA
    WHERE Name LIKE '%YourSearch%'
UNION ALL
SELECT Name, Description
    FROM TableB
    WHERE Name LIKE '%YourSearch%'
UNION ALL
SELECT Name, Description
    FROM TableC
    WHERE Name LIKE '%YourSearch%'
"
12099,VB.NET - Why does this sql command work as a string but not as a parameterized query?,"For Each match As Long In choices
 command_sbsp.Parameters.Clear()
 command_sbsp.Parameters.AddWithValue(""@ID"", match)
 command_sbsp.Parameters.AddWithValue(""@Subsp"", word)
"
19849,What is the correct way to query two columns in a table using AND OR in SQL?,"SELECT * FROM products WHERE category1 = 2 OR category2 = 2
"
29415,REGEXP_SUBSTR-Oracle,"select substr(col1, instr(col1, '/', 1, 4) + 1)
from ...
"
15939,Dynamic Like Statement in SQL,"SELECT column 
  FROM table AS T1
       INNER JOIN Params AS P1
          ON T1.column LIKE '%' + P1.param + '%';
"
9191,find row number in left join,"WITH cte AS(
    SELECT id
    , visitdate 
    , ROW_NUMBER()OVER(Partition By id Order By visitdate DESC)As VisitNum
   FROM TableT2 
)
select  TableT1.id, TableT1.name
       ,cte.visitdate , cte.VisitNum
 from TableT1 INNER JOIN cte 
    ON TableT1.id=cte.id  AND cte.VisitNum=1 
        AND EXISTS(SELECT NULL FROM cte c2 WHERE c2.id=cte.id AND c2.VisitNum>1)
"
32357,Select from certain categories,"SELECT * 
FROM posts 
WHERE category <> 1
    AND category IN (2, 7, 8, 9)
ORDER BY RAND()
"
9606,Determine SQL Server version of linked server,"select * from openquery(MyLinkedServer,'SELECT SERVERPROPERTY(''productversion'')')
"
3059,Unique filtered index and indexed view are ignored by optimizer,"select
    P.ID
from dbo.Partners as P
    left outer join dbo.vw_Partners_Codes2 as PC with (noexpand) on PC.Partner_ID = P.ID;
"
39703,SQL Query to fetch all the tasks where Level 0 is C but all the other levels(if any) are in W,"SELECT TaskID
FROM tasks_tbl
GROUP BY TaskID
HAVING MAX(CASE WHEN Level = 0 AND Status = 'C' THEN 1 ELSE 0 END) = 1
AND MAX(CASE WHEN Level > 0 AND Status <> 'W' THEN 1 ELSE 0 END) = 0
"
7404,How do I Concatenate entire result sets in MySQL?,"SELECT A,B,C, ""query 1"" as origin FROM table WHERE field LIKE 'query%'UNIONSELECT A,B,C, ""query 2"" as origin FROM table WHERE field LIKE '%query'UNIONSELECT A,B,C, ""query 3"" as origin FROM table WHERE field LIKE '%query%'GROUP BY origin, B ORDER BY origin, B ASC LIMIT 5"
5334,SQL Insert column names as data,"    INSERT INTO B    
    SELECT COLUMN_NAME
    FROM INFORMATION_SCHEMA.Columns
    WHERE TABLE_NAME = 'A'
"
35660,MYSQL Stored Procedure Query Fallback Logic,"SELECT FeeName, Amount, Category, VariableName 
FROM client_rates
WHERE state_abv=state_abvIN 
AND Purchase=purchaseIN AND Category=CategoryIN
AND client_id=client_idIN AND agent_id=agent_idIN
AND CASE WHEN (lender_id=lender_idIN AND county=countyIN) THEN 1
    WHEN (lender_id=lender_idIN AND county='NA') THEN 1
    WHEN (lender_id=1 AND county=countyIN) THEN 1
    ELSE (lender_id=1 AND county='NA')
    END;
"
23267,Get multiple id on multiple value in string with sql?,"SELECT id, name
FROM yourtable
WHERE (user = '2' OR user LIKE '2,%' OR user LIKE '%,2' OR user LIKE '%,2,%')
"
16515,"Need SQL Query Help, matching a stored procedure list parameter against individual columns","declare @sql as nvarchar(max)

set @sql = 'select * from table where col' + 
           replace(@list, ',', '=1 or col') + '=1'
sp_executesql @sql
"
1837,Distinct on two columns (separately) and MIN on another column,"select distinct t.master_id,
  t.slave_id,
  t.distance
from join_table t
inner join
(
  SELECT ID, min(Distance) dist
  FROM 
  (
    SELECT master_ID ID, MIN(distance) AS Distance
    FROM join_table
    GROUP BY master_ID
    UNION
    SELECT slave_ID ID, MIN(distance) AS Distance
    FROM join_table
    GROUP BY slave_ID
  ) src
  GROUP BY ID
) md
  on t.distance = md.dist
  and (t.master_id = md.id or t.slave_id = md.id)
"
5015,Conditional sum in SQL Server,"SELECT Id, OP1, OP2, OP3, 
       (CASE WHEN OP1 > 0 THEN 1 ELSE 0 END +
        CASE WHEN OP2 > 0 THEN 1 ELSE 0 END +
        CASE WHEN Op3 > 0 THEN 1 ELSE 0 END) AS T
FROM MyTable
"
28853,checking the adjacent column value in mySQL,"SELECT
    *
FROM
    films 
WHERE
    (
        director_sirname = 'wilson'
        AND director_firstname = 'john'
    ) OR
    (
        producer_sirname = 'wilson'
        AND producer_firstname = 'john'
    )
;
"
39504,Querying to show all rows with a max value SQL,"SELECT (f.F_FIRST || ' ' || f.F_LAST) AS STAFF, CNT as STUDENTCOUNT
FROM FACULTY f INNER JOIN
     (SELECT s.F_ID, COUNT(*) as CNT,
             DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) as seqnum
      FROM STUDENT s
      GROUP BY s.F_ID
     ) s
     ON s.F_ID = f.F_ID
WHERE seqnum = 1;
"
13000,How to keep unrounded number in result from arithmetic operations in a SELECT statement?,"select ((100 - 10) / 100.0) * 100000.00 as number;
"
29130,SQL Sum in Multiple join query,"select 
  inquiry.inquiry_id,
  SUM(logmins),
  catname,
  proddesc
from
   timelog
    inner join inquiry on timelog.inquiry_id=inquiry.inquiry_id
    inner join category on inquiry.category_id = category.category_id
    inner join prod on inquiry.prod_id = prod.prod_id
group by
  inquiry.inquiry_id,
  catname,
  proddesc
"
38001,"Filter Blood Pressure for Hypertension Categories, While Returning Higher Category","CASE 
    WHEN BP_Systolic >= '160' OR BP_Diastolic >= '100' THEN 'Stage 2 Hypertension'
    WHEN BP_Systolic BETWEEN '140' AND '159' OR BP_Diastolic BETWEEN '90' AND '99' THEN 'Stage 1 Hypertension'
    WHEN BP_Systolic BETWEEN '120' AND '139' OR BP_Diastolic BETWEEN '80' AND '89' THEN 'Prehypertension'
    WHEN BP_Systolic < '120' AND BP_Diastolic < '80' THEN 'Normal'
END AS BP_Category
"
6892,How to use inner join and cross join in one query?,"select T.PRICE, S.ROW, S.NUMBER, M.TITLE  
    from [cinema_no_keys].[dbo].[TICKET] T 
    inner join [cinema_no_keys].[dbo].[SEAT] S on
        T.ID_SEAT = S.ID_SEAT
    inner join [cinema_no_keys].[dbo].[SHOW] SH on
        SH.DATE_HOUR = T.DATE_HOUR
    inner join [cinema_no_keys].[dbo].[MOVIE] M on
        M.ID_MOVIE = SH.ID_MOVIE
"
1130,SQLite - How to pass a field value to a WHERE clause,"UPDATE LookUpWrkflwTemp
    SET SpiralUniverse = (SELECT Count(*)
                          FROM SpiralUniverse su
                          WHERE su.Date = LookUpWrkflwTemp.Date
                         )
    WHERE SprialUniverse IS NULL;
"
6783,Remove extra space from column values,"UPDATE YourTable
SET YourColumn = REPLACE(YourColumn, ' ', '')
"
17410,Trying to store multiple values from a SELECT to use in a DELETE,"BEGIN TRANS
delete from OrderItems where OrderId in ( SELECT OrderId FROM Orders WHERE CustomerName like '%peter%'); 
DELETE FROM Orders WHERE CustomerName like '%peter%'; 
COMMIT; 
"
21461,SQL Server Update trigger not working properly on batch update,"ALTER TRIGGER [gc].[T_UpdateObservation] 
ON [gc].[GCUR_OBSERVATION] 
AFTER UPDATE
AS 
BEGIN
    SET NOCOUNT ON;

    UPDATE g SET LastUpdatedDate = CURRENT_TIMESTAMP
    FROM gc.GCUR_OBSERVATION AS g
    -----^^ why is the schema missing from your version of the trigger?
    INNER JOIN inserted AS i
    ON g.ObservationID = i.ObservationID;
END
GO
"
3743,Selecting data where fields matches,"Update fixed the HAVING clause...
SELECT * FROM table WHERE id IN (
  SELECT id FROM table GROUP BY to_user, from_user HAVING sent = MAX(sent)
);
"
12939,Node.js and MSSQL stored procedures,"var request = new sql.Request(connection);
    request.input('input_parameter', sql.Int, 10);
    request.output('output_parameter', sql.VarChar(50));
    request.execute('procedure_name', function(err, recordsets, returnValue) {
        // ... error checks

        console.dir(recordsets);
    });
"
32968,Country/Region/City Data Model,"AreaID     Name             Type    ParentID
001    'UnitedKingdom'    'Country'   NULL
002    'West Midlands'    'Region'    001
"
10289,Oracle SQL - Combine Two Results from Two Queries Into One,"select '2013-03-03' As ""Week_Of"",
count(player_id) as cohort_size ,
count(case 
        when trunc(init_dtime)-trunc(create_dtime) >= 0 
        then player_id 
      end) as Day_0_Ret
from player
where trunc(create_dtime) > To_Date('2013-Mar-03','yyyy-mon-dd')-7
and trunc(create_dtime) <= To_Date('2013-Mar-03','yyyy-mon-dd')
and world_flag != '1'
;
"
36528,cannot get xp_seller and bcp to play nice with stored procedure with parameter,"EXEC xp_cmdshell 'bcp ""EXEC DatabaseName.dbo.pn_FlatProductXML ''KA-0009'' "" queryout ""C:\test.txt"" -T -c '
"
7779,convert varchar field data in date format in oracle,"where created_dte >= '2014-07-21' and created_dte < '2014-08-05'
"
6925,How to store record changes in a mysql table,"select p.id,p.name,p.added_date,p.is_removed,
case when S.id is null then 'Insert' 
else when S.name <> P.name or S.added_date <> P.added_date or S.is_removed <> P.is_removed
then 'Update'
else 'No Change' end as RecordStatus
from Product P
left outer join S
on P.id=S.id
"
31011,Creating a function out of a select statement in SQL,"CREATE FUNCTION daysPlayed (@ParticipantID int)
RETURNS INT
AS
BEGIN
    DECLARE @result INT
    SELECT @result=DATEDIFF(day, (select min(startdatetime) from GamePlay), enddatetime) from GamePlay where ParticipantID = @ParticipantID
    RETURN @result

END
"
8317,compare time using sql query,"select uid,count(uid) as no_of_days from presence 
where (time_to_sec(timediff(timeout, timein )) / 3600)<9  
and date> $date1 and date< $date2 
group by uid. 
"
17165,SQL sum for date range while showing all stock,"SELECT     STOCK.NUMBER, SUM(ITEMS.QUANTO) AS USAGE, STOCK.DESC1, STOCK.UNITS, STOCK.LOW
FROM
    STOCK 
     LEFT JOIN
    ITEMS ON 
        ITEMS.ITEM = STOCK.NUMBER AND 
        ITEMS.IT_SDATE BETWEEN '3/31/14' AND '4/5/14'
GROUP BY STOCK.NUMBER, STOCK.DESC1, STOCK.UNITS, STOCK.LOW
"
31173,Mixing an IF-statement in an UPDATE statement in SQL,"UPDATE bc
SET IsFlagged = CASE WHEN b.ID IS NULL THEN 0 ELSE 1 END
FROM
    BookCategory bc LEFT JOIN
    Book b ON b.BookCategoryID = bc.ID AND b.IsFlagged = 1
"
35379,Query to find all FK constraints and their delete rules (SQL Server),"SELECT name, delete_referential_action_desc
FROM sys.foreign_keys
"
8047,left join including where on main table,"   SELECT SQL_CALC_FOUND_ROWS available.*
     FROM available
LEFT JOIN cart  
       ON available.id = cart.item_id
    WHERE cart.item_id IS NULL
      AND `fname` LIKE '%de%'
 ORDER BY  `id` asc
"
7152,Can't write query using SQL Server,"SELECT *
FROM
(
SELECT ROW_NUMBER() OVER (PARTITION BY UserId ORDER BY Date DESC) AS RowNo, *
FROM UserTypedText
) x
WHERE x.RowNo <= 10
"
21290,Update a record based on a related column from another table,"UPDATE table1 AS t1 
SET lev = LEVENSHTEIN(t1.string,t2.title)
FROM table2 as t2
WHERE t1.articleid = t2.id
"
31271,Compare Count From Outer SELECT in a Nested SELECT?,"SELECT * FROM
(SELECT c1,c2,c3,..,Cn,COUNT(*) AS myCount
 FROM YourTable
 GROUP BY c1,c2,c3,..,Cn
) A
WHERE 1 = CASE myCount WHEN 1 THEN 1 ELSE... END
"
23999,update column data mysql,"UPDATE  tableName
SET     courseName  = REPLACE(courseName, 'seaadventures', 'sea adventures')
"
39749,SQL ordering with inner join on same table and rename columns,"SELECT postid, max(CASE WHEN meta_key = 'number' THEN meta_value END) AS `time`,
       max(CASE WHEN meta_key = 'key_a' THEN meta_value END) AS `other`,
       max(CASE WHEN meta_key = 'key_b' THEN meta_value END) AS `another`,
       max(CASE WHEN meta_key = 'key_c' THEN meta_value END) AS `yet_another`
FROM postmeta pm
GROUP BY pm.post_id
HAVING max(pm.meta_key = 'key_c' AND pm.meta_value = '111') = 1
ORDER BY time desc;
"
16159,"Msg 102, Level 15, State 1, Line 3 Incorrect syntax near '='","SELECT PurDate,
       CASE ReceiveNote.FromLOC
            WHEN '1' THEN 'Factory'
            WHEN '2' THEN 'Other'
            ELSE ''
       END AS FromLOC 
  FROM tbl1
"
19034,SQL not allowing foreign key if it's a multiple candidate key?,"CREATE TABLE SessionDuration__Record
(
    c_id      CHAR(3)    NOT NULL  REFERENCES Club_Record(c_id),
    sess_id   NUMBER(4)  NOT NULL  CHECK (sess_id >0),
    ""DAY""     CHAR(9)    NOT NULL,
    duration  NUMBER(3)  NOT NULL,
    UNIQUE(c_id, sess_id),
    FOREIGN KEY (c_id, sess_id) REFERENCES Session_Record(c_id, sess_id)
);
"
8519,Join a dynamic number of rows in postgres,"SELECT b.id AS batch_id
     , count(i.quality < 4 OR NULL) AS broken_item_count
FROM   batch b
LEFT   JOIN (
    SELECT batch_id, quality
         , row_number() OVER (PARTITION BY batch_id ORDER BY id DESC) AS rn
    FROM   items
    ) i ON i.batch_id = b.id
       AND i.rn <= b.size
GROUP  BY 1
ORDER  BY 1;
"
34787,Pagination of large dataset,"SELECT *
  FROM (SELECT *
          FROM table
         ORDER BY date DESC)
 WHERE rownum <= 40
"
32274,Why sql case is not working on null condition of int column,"SELECT T.ID,T.ACCEPTED,
(CASE WHEN T.ACCEPTED IS NULL THEN 'NOT ACCEPTED' END) AS STATUS
FROM #TEMP_A T
"
7105,How do I select all the rows where a varchar field contains non-digit characters?,"select *
from yourTable
Where ISNUMERIC(yourField) = 0
"
10120,change the size of datatype in sql,"alter table tablename modify 
( 
   column_name    varchar2(13)
);
"
19068,select rows from main table based on highest date in child table between a date range,"Select  A.ApplicantId, A.[Applicant Name]
From    ApplicantTableName  A
Join
(
    Select  D.ApplicantId, Max(D.Dt) DT
    From    DetailsTableName    D
    Group By D.ApplicantId
) B On A.ApplicantId = B.ApplicantId
Where   B.DT Between '03/05/2014' And '04/20/2014'
"
24170,Call display value for choices with SQL,"STUDENT_CHOICES=(
    ('None', 'None'),
)
"
956,How to use variable in SQL statements and assign answer to variable,"name = db.execute ""SELECT price FROM Products WHERE product_code = ?"", bind_variable_here
"
20879,Search command to search for Column/field in SQLPLUS for Oracle 10.2,"select owner, table_name
  from dba_tab_columns
 where column_name = 'ACC'
"
36559,Adding Constraints to Attributes,"create table Children
(
  child_id int not null primary key,
  fname varchar(24),
  lname varchar(24),
  phone int,
  grade varchar(24),
  CONSTRAINT chk_Grade check grade IN ('Beginner' ,'Novice' ,'Skilled' ,'Expert')
)
GO
"
6103,How to reverse a string in SQL Server,"select (parsename(replace(@result, ' >> ', '.'), 1) + ' >> ' +
        parsename(replace(@result, ' >> ', '.'), 2) + ' >> ' +
        parsename(replace(@result, ' >> ', '.'), 3) + ' >> ' +
        parsename(replace(@result, ' >> ', '.'), 4)
       )
"
37664,"How do I join two tables ON a column, that has the same name in both tables?","select  *
from    Table1
        inner join
        Table2
        on Table1.ColumnName = Table2.ColumnName
"
18744,sqlcmd with output file and screen output,"@echo off

:: this will execute the script into PROCESS.log
sqlcmd -i Scripts\STEP01.sql -o PROCESS.log -S MYSERVER -E -d MYDATABASE

:: this present the contents of PROCESS.log to the screen
echo The result of the query was:
type PROCESS.log

pause
CHOICE /C:YN /M ""Is the result accord?""
IF ERRORLEVEL 2 GOTO ENDWITHERROR
IF ERRORLEVEL 1 GOTO STEP2
"
26455,How to specify a query for COUNT?,"SELECT TOP (SELECT COUNT (DISTINCT Name) FROM Logg WHERE Id= 1) * -- Need to specify columns
FROM Logg WHERE Id= 1;
"
32617,varchar2 to timestamp,"SELECT to_char(to_date(T.FEED_TIME,'dd:HH:MI AM')+1, 'dd:HH:MI AM')
FROM FEED_TYPE T WHERE T.FEED_CODE = 'CREDIT';
"
35974,"Can MySQL / SQL's short hand of ""Using"" be used without saying ""Inner Join""?","join_table:
    table_reference [INNER | CROSS] JOIN table_factor [join_condition]
  | table_reference STRAIGHT_JOIN table_factor
  | table_reference STRAIGHT_JOIN table_factor ON conditional_expr
  | table_reference {LEFT|RIGHT} [OUTER] JOIN table_reference join_condition
  | table_reference NATURAL [{LEFT|RIGHT} [OUTER]] JOIN table_factor

join_condition:
    ON conditional_expr
  | USING (column_list)
"
38517,Deleting Records Based on Criteria,"DELETE FROM 
    Users
WHERE 
    UserName IN 
    (SELECT UserName FROM Users GROUP BY UserName HAVING COUNT(UserName) > 1)
    AND
    CreatedOn != 
    (SELECT MIN(CreatedOn) FROM Users T1 WHERE UserName = T1.UserName);
"
36349,Create an ORACLE query - View and union with default value,"select c.id_contract
     , p.id_pfo
     , nvl(l.budget,0) value
  from contracts c
 cross join portfolios p
  left outer join ""contract_Linked_pfo"" l
      on l.id_contract = c.id_contract
     and l.id_pfo = p.id_pfo
;
"
20118,SQL - join up two separate sql queries,"select 1.page_name, count(*) as ExitPageCount
from WebLog l
inner join (
    select http_session_id, max(page_hit_timestamp)
    from WebLog
    group by session
) lm on l.http_session_id = lm.http_session_id and l.page_hit_timestamp = lm.page_hit_timestamp
group by 1.page_name
"
13215,Dynamic SQL query to list all master table's data,"DECLARE @DynamicSql AS VARCHAR (MAX) = '';

SELECT @DynamicSql = @DynamicSql + 'SELECT * FROM ' + name + '; ' 
FROM sysobjects WHERE xtype = 'U' AND name LIKE '%Master' 

-- PRINT @DynamicSql

EXEC (@DynamicSql)
"
38688,Oracle SQL Constraint where clause,"CREATE UNIQUE INDEX ApplicationId_Default_Y ON tester (
  CASE WHEN IsDefault = 'Y'
       THEN ApplicationId
       ELSE NULL
  END
);
"
6973,How can I use the results from 1 column as a part of another column,"SELECT 
   ROUND( i.events / (i.totalMiles / 1000), 1) as events_perlk
FROM (
   SELECT 
      sum(miles)  as totalMiles,
      sum(events) as events
   FROM 
   ...
) i;
"
21217,Unable to understand LIKE behavior,"SELECT *
FROM `tickets`
WHERE (
    SELECT count( * )
    FROM `series`
    WHERE `series`.`deleted_at` IS NULL
    AND `tickets`.`series_id` = `series`.`id`
    AND (screen_name LIKE '%series name%' OR name LIKE '%series name%')
    AND `series`.`deleted_at` IS NULL
)
"
2551,"mysql - double join (one from same table, one from different table)","select m.member_name as memb, c.member_name as corp,
  (select max(b.billing_expiration) from billing b
  where b.member_id = c.member_id
  or b.member_id = m.member_id) as expiration
from member m
left outer join member c on c.voter_id = m.member_id
"
3879,Ordering of data when summarizing with cube/grouping sets,"DECLARE @test TABLE (STATE CHAR(2));

INSERT @test (STATE)
SELECT NULL
UNION ALL
SELECT 'AK'
UNION ALL
SELECT 'AL'
UNION ALL 
SELECT 'AR';

/*Returns null first*/
SELECT * FROM @test ORDER BY STATE

/*Returns null last*/
SELECT * FROM @test ORDER BY ISNULL(STATE,'ZZ');
"
19022,record addition in sql,"--Product info--
CREATE TABLE PRODUCT
(
PRODUCTID INT NOT NULL,
PRODUCT_NAME VARCHAR2(20) NOT NULL,
CONSTRAINT PRODUCT_PK PRIMARY KEY(PRODUCT_ID)
);

--sales info--
CREATE TABLE SALES
(
RECIPT_ID SMALLINT DEFAULT (0) NOT NULL,
PRODUCTID INT DEFAULT (0) NULL,
CONSTRAINT SALES_PK PRIMARY KEY(RECIPT_ID),
CONSTRAINT SALES_PRODUCT_FK FOREIGN KEY(PRODUCTID) REFERENCES PRODUCT(PRODUCT_NAME)
);
"
32232,Access 2003 Query Dilemma,"    GROUP BY Roster.UserID, 
        EventLog.Type, 
        IIf([EventLog]![LogType] Like ""Acc*"" And 
[EventLog]![Action] Like ""Wri*"",[EventLog]![Date],Date()-183)
"
2799,How to get time part from GetDate() As hh:mm tt in SQL Server,"select CONVERT(VARCHAR(5), GETDATE(), 108) + ' ' + 
       RIGHT(CONVERT(VARCHAR(30), GETDATE(), 9),2)
"
13364,How to write a sql query returning the count of data from a table that meet requirements,"SELECT
    ID,
    count(1)
FROM Table
GROUP BY ID, City
HAVING count(1) > 1
"
16704,Preserve order from subquery (with GROUP BY and ORDER BY),"SELECT 
latitude, 
longitude, 
count(1) as ""Count"", 
min(timestamp) as ""Start"",
max(timestamp) as ""End""

FROM table 
GROUP BY latitude, longitude
ORDER BY min(timestamp) asc
"
11624,assigning results of sql query to local variables,"select @address = address , 
       @serialNumber = serialNumber 
from dummyTable where id = 10
"
25745,insert data from table to another table phpmyadmin,"update episodes set
embed = (
    select group_concat(embed)
    from embeds
    where episode_id = episodes.id
)
"
36887,Grouping data based on two columns in sql server,"with cte as (
    select
        case when Country1 < Country2 then Country1 else Country2 end as Country1,
        case when Country1 < Country2 then Country2 else Country1 end as Country2
    from Table1
)
select
    Country1, Country2, count(*)
from cte
group by Country1, Country2
"
14226,How do I perform a simple string mapping as part of a t-sql select?,"SELECT 
  CASE column1 
    when 'A' THEN 'B' 
    when 'F' THEN 'Z' 
  END 
FROM Tbl
"
36037,SQL Join with Group By,"select cm._Descriptor,
       min(cu.customerid)
from CustomerMake cm
  join Customer cu on cuo.CustomerId  = cm.CustomerId and cu.StatusId = 1
group by cm._Descriptor
"
12996,SQL: how to extract the month from a date time field,"UPDATE your_table
SET some_column = MONTH(date_column)
WHERE some_column IS NULL
"
35791,Converting to date with multiple possible masks in Oracle,"SQL> select to_date('2009.12.31','YYYY/MM/DD') from dual;

TO_DATE('20
-----------
31-DEC-2009
"
21571,How to do distinct by first column,"select
    wpg.ID as id1,
    min(wr.ID) as id2
from
    Table1 wpg
    inner join Table2 wp on wp.WpgId = wpg.ID
    inner join Table3 wr on wr.WpId = wp.ID
group by
    wpg.ID
"
36077,SQL query / data version check,"select t.*
from t
where exists (select 1
              from t t2
              where t.id = t2.id and
                    (t2.start_date < t.start_date and
                     t2.end_date > t.start_date or t2.end_date is null)
             );
"
27577,DELETE row based on the column value,"DELETE FROM TABLE 
WHERE UPPER(COLUMN) LIKE '%.WAV' 
      OR UPPER(COLUMN) LIKE '%.GIF' 
      OR UPPER(COLUMN) LIKE '%.JPEG'
"
32234,SQL Server 2008 Finding the user,"SELECT Q.user_id
FROM
(
  SELECT DISTINCT item_name FROM item WHERE item_name LIKE 'Gun%'
) P,

(
 SELECT DISTINCT X.name_item,Y.user_id
 FROM userinventory X, 
  (SELECT user_id,COUNT(DISTINCT name_item) as count_guns_userid
  FROM userinventory
  WHERE name_item LIKE 'Gun%'
  GROUP BY user_id
 )Y
WHERE X.user_id=Y.user_id  
) Q
WHERE P.item_name=Q.name_item
GROUP BY Q.user_id
HAVING COUNT(Q.name_item)=3;
"
11777,Which index is used ? ORACLE DB SQL,"select *
from sometable
where column1 = 'somevalue' or
selet *
from sometable
where column2 = 'someothervalue' and column1 > 'somevalue';
"
2574,MySQL: Get all rows if specific value reached after date,"select * from yourTable where value = 0 and date > '2015-10-01' and cat in (
  select distinct cat where value > 0 and date < '2015-11-1'
)
"
13188,MS Access Selecting Distinct Records,"select e.*
from Events as e
where not exists (select 1
                  from Events as e2
                  where e2.event_date = e.event_date and e2.event_type_id = e.event_type_id and
                        e2.event_id > e.event_id
                 );
"
24584,Where should I place Indexes in MySQL Tables,"SELECT 'allEqual' AS COL1, COUNT(*) AS imgCount FROM (
    SELECT imgId AS primaryId FROM primary_images pi
    WHERE pi.ImgId = '$imgId' 
      AND pi.imgWidth = '$maxImageWidth' 
      AND pi.imgHeight = '$maxImageHeight'
    UNION ALL 
    SELECT primaryId FROM secondary_images si
    WHERE si.primaryId = '$imgId' 
      AND si.imgWidth = '$maxImageWidth'    
      AND si.imgHeight = '$maxImageHeight'  
) AS union_table                      
"
29897,Sql server statement ordering ASC,"SELECT  *
FROM    tableName
ORDER   BY CASE WHEN lastlogin IS NULL THEN 1 ELSE 0 END, lastlogin
"
18926,Update query: Sum divided by Count between 2 different columns in 2 different tables,"select count(MasterTable.Acct1)
"
38524,Between Two Date Condition in Sql Server,"SELECT ID 
FROM master M 
WHERE ((M.FromDate BETWEEN '10/03/2014' AND '17/03/2014') 
     OR (M.ToDate BETWEEN '10/03/2014' AND '17/03/2014'))
"
3014,SQL Join using floating Where Date,"Select Distinct AccountId
From Accounts a
Where Exists
    (Select * From contracts
     Where AccountId = a.AccountId
       And ContractDate >= a.ActivityDate
       And DateDiff(day, a.ActivityDate, ContractDate) <= 30)
"
25779,Perform an action within a stored procedure depending on the result of another action within the stored procedure?,"declare @myVarChar varchar(1);

Select @myVarChar=MyCol From MyTable Where MyOtherCol = @myKey;

If @myVarChar = 'A'
Begin
End
"
27465,Get count for each record mysql,"SELECT e.d, COUNT(c.event_id) AS check_count
FROM event e LEFT OUTER JOIN checkin c ON c.event_id = e.id
GROUP BY e.event_id
"
30336,"Oracle 11g PL/SQL cursor,intersect query","var table.col%type;

BEGIN
OPEN c1;
LOOP    
BEGIN

FETCH c1 into var;    
exit when c1%NOTFOUND;    
INSERT INTO table values (col1, var);
commit;   
EXCEPTION
WHEN DUP_VAL_ON_INDEX THEN         
CONTINUE;  
END;
END LOOP;    
END;
"
33476,Identity key on varchar column - T-SQL,"CREATE TABLE Questions(
  QuestionID int IDENTITY NOT NULL, 
  QuestionNo as 'Q'+Cast(QuestionID as Varchar(10)) PERSISTED PRIMARY KEY, 
  Question Varchar(200)
)
"
11864,find unique rows using SQL?,"SELECT name FROM myTable GROUP BY name HAVING COUNT(name) = 1
"
14906,SELECT sales by user pairs,"SELECT  ss1.userid, ss2.userid, SUM(sales)
FROM    session ss1
JOIN    session ss2
ON      ss2.sessionid = ss1.sessionid
        AND ss2.userid < ss1.userid
JOIN    sales s
ON      s.sessionid = ss1.sessionid
GROUP BY
        ss1.userid, ss2.userid
"
23050,SQL: Query based on multiple records,"   select a.PERSON_NO
   from personTable a
   where exists (select 1 from personTable where PERSON_NO = a.PERSON_NO
                 and CITY_NAME = 'City A')
   and exists (select 1 from personTable where PERSON_NO = a.PERSON_NO
                 and CITY_NAME = 'City B')
   and exists (select 1 from personTable where PERSON_NO = a.PERSON_NO
                 and CITY_NAME = 'City C')
"
20425,SQL min / max group by question,"select
    Category,
    min(StartDateTime) [MinStartDateTime],
    max(EndDateTime) [MaxDateTime]
from MyTable
group by
    Category
order by
    Category,
    MinStartDateTime,
    MaxDateTime
"
24542,Android: MySQL database SQL statements,"$result = mysqli_query($con, ""SELECT userid FROM users WHERE unique_id = '$userid'"");
$row = mysqli_fetch_row($result);

if ($row){
    $id = $row[0];
    ...
    $result = mysqli_query($con, ""INSERT INTO file_info (userid, name, mod_date)  VALUES('$id','$name', NOW())"");    
} 
"
8246,What should the Primary Key be?,"PRIMARY KEY(game_id, platform)
"
11442,SQL Server : Casting a decimal value to nvarchar,"SELECT CAST(YourColumn AS VARCHAR(3)) + '%' 
FROM YourTable
"
20385,Check if SQL integer field is empty,"int score; 
if (c.isNull(11)) { 
  score = 100; 
} else { 
  score = c.getInt(11); 
} 
q.setScore(score);
"
3080,Executing procedure with ruby-oci8,"require 'oci8'

conn = OCI8.new('AAA/AAA@//10.112.68.14:1521/dptedp0')
conn.exec(""begin reset_seq( 'mytable_id_seq', 'mytable', 'id'); end;"")
"
34612,SQL: select rows where sum of a column satisfies a condition,";with  CTE1 as 
(
    SELECT 
        ID, Price, Price as CUM_SUM 
    FROM YourTable 
    WHERE ID=1

    UNION ALL

    SELECT 
        c.ID, c.Price, c.Price+c1.CUM_SUM as CUM_SUM 
    FROM CTE1 c1 INNER JOIN 
        YourTable c on c.ID=c1.ID+1
    WHERE 10 >c1.CUM_SUM
)
select * from CTE1
"
19077,get previous row id using stored procedure,"select max(ID) from YourTable where ID < @YourID
"
15304,SQL: finding double entries without losing the ID,"SELECT min(ID), Product, Color FROM table GROUP BY Product, Color;
"
34471,How To Create Table with Identity Column,"CREATE TABLE [dbo].[History](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [RequestID] [int] NOT NULL,
    [EmployeeID] [varchar](50) NOT NULL,
    [DateStamp] [datetime] NOT NULL,
 CONSTRAINT [PK_History] PRIMARY KEY CLUSTERED 
(
    [ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON)
) ON [PRIMARY]
"
1215,How can I list all foreign keys referencing a given table in SQL Server?,"EXEC sp_fkeys 'TableName'
"
17042,How do I get 5 latest comments (SQL query for SQL Server ) for each user?,";with cteRowNumber as (
    select comment_id, user_id, comment, last_updated, ROW_NUMBER() over (partition by user_id order by last_updated desc) as RowNum
        from comments
)
select comment_id, user_id, comment, last_updated
    from cteRowNumber
    where RowNum <= 5
    order by user_id, last_updated desc
"
18930,Using hibernate as backing for large dataset in JTable,"Query q = entityManager.createQuery(""from someTable tbl order by tbl.id asc"");
q.setFirstResult((pageNum -1)*pagesize).setMaxResults(pagesize); 
"
2109,How would you display the manager name from employee table in an SQL query?,"select 
  emp.ename as ""Employee"", 
  emp.empno as ""Emp#"", 
  emp.mgr as ""Mgr#"",
  m.ename as ""Manager""
from 
 emp
  LEFT OUTER JOIN emp m ON
   emp.mgr = m.empno
"
36557,Workaround for unsupported date format when it comes to BETWEEN?,"SELECT price
  FROM `table`
 WHERE STR_TO_DATE(`date`, '%d.%m.%y')
       BETWEEN STR_TO_DATE(...) AND STR_TO_DATE(...)
"
12500,db2 merge seems to fail on correct where clause,"    MERGE INTO DLP.RESERVATION AS e
USING (select * from LOADDLP.RESERVATION_INSERT WHERE LOADTABLETIME = '2012-06-09 10:44:17.42236') as et 
   on e.TICKET_SERVER = et.TICKET_SERVER 
  and e.RES_ID = et.RES_ID  
 WHEN MATCHED THEN UPDATE SET (foo) = (bar) 
 WHEN NOT MATCHED THEN INSERT (xyz) VALUES (;akdjf)
"
18026,SQL Tree / Hierarchial Data,"WITH tree (id, parentid, level, name) as (    
    SELECT id, parentid, 0 as level, name 
    FROM test    
    WHERE name = @category AND
        parentId is null
    UNION ALL
    SELECT c2.id, c2.parentid, tree.level + 1, c2.name    
    FROM test c2 
        INNER JOIN tree ON tree.id = c2.parentid 
) 
SELECT * 
FROM tree 
order by parentid
"
36804,Explain COUNT and GROUP BY,"SELECT eteam.teamname 'Team Name', COUNT(goal.teamid) 'Total Goals'
  FROM eteam JOIN goal ON eteam.id=goal.teamid
  GROUP BY goal.teamid
  ORDER BY eteam.teamname
"
15941,MySQL Join Syntax,"SELECT s.id, s.story, s.userid, u.username FROM stories AS s INNER JOIN users AS u ON s.userid=u.id
"
36549,Getting the next bill date using TSQL,"select o.*
from orders o
where datediff(day, StartedAt, getutcdate()) % @period = 0;
"
22299,Conditional Where statement on a table valued parameter?,"   DECLARE @UseTVP int
   SET @UseTVP = (SELECT COUNT(*) FROM @TVP) 

   SELECT TOP 1 *
        FROM dbo.SomeTable tbl
            LEFT JOIN @TVP tvp
                ON tbl.SomeVar = tvp.SomeVar
        WHERE (tvp.SomeVar IS NOT NULL
               OR @UseTVP = 0)
"
38131,How to update a group of rows by a criteria of one row in the same table,"update yt
set status = 1
where exists (select name
              from yt t1
              where status = 1
                 and yt.name = t1.name);
"
7880,Last word in a sentence: In SQL (regular expressions possible?),"WITH q AS (SELECT 'abc def ghi' AS sentence FROM DUAL)
SELECT SUBSTR(sentence, INSTR(sentence,' ',-1) + 1)
FROM q;
"
23329,Select the value for each first day of the month,"WITH cte AS
(
  SELECT MIN(ExecuteTime) AS Monthly
  FROM tbl_Test
  GROUP BY DATEADD(m, DATEDIFF(m, 0, ExecuteTime), 0)
)
SELECT t.ExecuteTime, t.[UsedSpace(MB)]
FROM tbl_Test AS t
JOIN cte AS m
ON t.ExecuteTime = m.Monthly
ORDER BY t.ExecuteTime
"
